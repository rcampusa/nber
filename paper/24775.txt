                              NBER WORKING PAPER SERIES




                        MARKET FAILURE IN KIDNEY EXCHANGE

                                         Nikhil Agarwal
                                           Itai Ashlagi
                                        Eduardo Azevedo
                                     Clayton R. Featherstone
                                        Ömer Karaduman

                                       Working Paper 24775
                               http://www.nber.org/papers/w24775


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                             June 2018, Revised July 2019




We thank Alex Garza, Sarah Taranto, and Jennifer Wainwright of the United Network for Organ
Sharing; Jonathan Kopke and Michael Rees of the Alliance for Paired Kidney Donation; Cathi
Murphey and Adam Bingaman of Methodist Hospital at San Antonio; and Garet Hill of the
National Kidney Registry for their expertise and access to data. We thank Glenn Ellison, Amy
Finkelstein, Parag Pathak, Al Roth, Jean Tirole, Utku Ünver, Mike Whinston, and seminar
participants for helpful discussions. Abigail Ostriker provided excellent research assistance.
Azevedo acknowledges support from Wharton's Dean's Research Fund, and Agarwal and Ashlagi
from the National Science Foundation (SES-1729090 and SES-1254768, respectively). The data
reported here have been supplied by the United Network for Organ Sharing (UNOS) as the
contractor for the Organ Procurement and Transplantation Network (OPTN). The interpretation
and reporting of these data are the responsibility of the author(s) and in no way should be seen as
an official policy of or interpretation by the OPTN, the U.S. Government, or the National Bureau
of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Nikhil Agarwal, Itai Ashlagi, Eduardo Azevedo, Clayton R. Featherstone, and Ömer
Karaduman. All rights reserved. Short sections of text, not to exceed two paragraphs, may be
quoted without explicit permission provided that full credit, including © notice, is given to the
source.
Market Failure in Kidney Exchange
Nikhil Agarwal, Itai Ashlagi, Eduardo Azevedo, Clayton R. Featherstone, and Ömer Karaduman
NBER Working Paper No. 24775
June 2018, Revised July 2019
JEL No. D42,D47,L11

                                           ABSTRACT

We show that kidney exchange markets suffer from market failures whose remedy could increase
transplants by 30%–63%. First, we document that the market is fragmented and inefficient: most
transplants are arranged by hospitals instead of national platforms. Second, we propose a model
to show two sources of inefficiency: hospitals only partly internalize their patients' benefits from
exchange, and current platforms suboptimally reward hospitals for submitting patients and
donors. Third, we calibrate a production function and show that individual hospitals operate
below efficient scale. Eliminating this inefficiency requires either a mandate or a combination of
new mechanisms and reimbursement reforms.

Nikhil Agarwal                                   Clayton R. Featherstone
Department of Economics, E52-460                 The Wharton School
MIT                                              University of Pennsylvania
50 Memorial Drive                                3620 Locust Walk, Suite 1400
Cambridge, MA 02142                              Philadelphia, PA 19104
and NBER                                         claytonf@wharton.upenn.edu
agarwaln@mit.edu
                                                 Ömer Karaduman
Itai Ashlagi                                     MIT Department of Economics
Management Science and Engineering               77 Massachusetts Ave
Huang Engineering Center, 262                    Cambridge, MA 02139
Stanford University                              omerk@mit.edu
475 Via Ortega
Stanford, CA 94305
iashlagi@stanford.edu

Eduardo Azevedo
University of Pennsylvania
Wharton School, SHDH 1400
Philadelphia, PA 19104-6302
eazevedo@wharton.upenn.edu




A data appendix is available at http://www.nber.org/data-appendix/w24775
                                                                                                             1


1      Introduction
The kidney exchange market in the United States enables approximately 800 transplants per
year for kidney patients who have a willing but incompatible live donor. Exchanges are orga-
nized by matching these patientdonor pairs into swaps that enable transplants. Each such
transplant extends and improves the patient's quality of life and saves hundreds of thousands
of dollars in medical costs, ultimately creating an economic value that is estimated at more
                            1
than a million dollars.         Since monetary compensation for living donors is forbidden and
deceased donors are in increasingly short supply, kidney exchange markets play an important
                                                                              2
role in mitigating the shortage of organs available for transplant.

This paper shows that, despite signicant success, US kidney exchange suers from market
failures that result in hundreds of lost transplants per year. Our descriptive evidence shows
that the market is fragmented and operates ineciently.                 The ineciency arises from two
standard market failures. First, kidney exchange platforms use inecient mechanisms: hos-
pitals are not rewarded for submitting high social value patients and donors to the platform.
Second, there are signicant agency problems: hospitals face most of the costs of participat-
ing in national platforms but receive only a fraction of the benets. These market failures
are serious, but xable. We show how to combine theory and data to design ecient mech-
anisms, and discuss policies such as reimbursement reforms and mandates. Our estimates
suggest that xing these problems would generate between 200 to 440 additional transplants
per year (25% to 55% of the current total).

Our argument has three parts. First, we use administrative datasets to show that the market
is fragmented, inecient, and shows signs of agency problems. Second, we develop a simple
model to explain the market failures and propose solutions. Third, we combine the model
and data to estimate the magnitude of the ineciencies and to design practical alternative
mechanisms and policies.

The rst part documents three key facts using data on all transplants in the United States
and proprietary data from the three largest US kidney exchange platforms. First, the market
is highly fragmented. Instead of most transactions being arranged by a few large platforms,
62% of kidney exchange transplants involve patients and donors from the same hospital.
Second, we nd direct evidence of inecient exchanges in the market.                     Kidney exchanges
performed within hospitals often transplant kidneys from easy-to-match donors to easy-to-

    1 Kidney exchange is among a handful of recent innovations that both improve health care delivery and
save costs (see Chandra and Skinner 2012). Transplantation roughly doubles the life expectancy of patients
with end-stage renal disease and is cheaper than the alternative treatment of dialysis.     Medicare provides
nearly universal coverage, irrespective of age, for patients with end-stage renal disease, which comprises of
about 7% of Medicare's annual budget (see United States Renal Data System 2016).          The cost savings of
transplantation relative to dialysis alone have been estimated to be over $270,000 (see Section 2).
    2 There are over 97,000 patients currently waiting for a kidney from a deceased donor, but less than a fth
are expected to be transplanted in the next year. Becker and Elias (2007) argue that the waitlist could be
completely eliminated if there were monetary compensation for live donors. However, this type of transaction
is widely panned by bioethicists, and almost all countries forbidit.    The National Organ Transplantation
Act prohibits compensating donors to acquire organs in the United States, but explicitly allows for kidney
exchange through the Charlie W. Norwood Living Organ Donation Act.
                                                                                             2


match patients, a practice which existing theory has shown to be inecient (Roth et al.
2007). Third, hospital behavior is inconsistent with pure maximization of patient welfare.
Evidence suggests that hospitals are sensitive to the nancial and administrative transaction
costs of participating in kidney exchange, even though these costs are small relative to the
social value of transplants. Many hospitals do not participate in national platforms, and even
when they do, the typical hospital does not conduct all kidney exchanges through a national
platform.

The second part develops a model to explain these facts and design policy responses. Al-
though kidney exchange markets do not directly use monetary incentives to acquire organs,
we can analyze them with standard neoclassical producer theory. A kidney exchange plat-
form produces a nal good (transplants) from intermediate goods (submissions of patients
and donors) supplied by a competitive fringe (hospitals) according to a production function.
This model is motivated by three key institutional features.     First, hospitals are the key
decision-makers steering participants towards kidney exchange (Roth et al. 2005; Ashlagi
and Roth 2014; Rees et al. 2009). Second, due to biological compatibility constraints, some
patients and donors generate considerably more transplants than others when they join a
platform.   Third, the structure of optimal matches makes transplants a natural numeraire
good. Platforms can eectively transfer transplants from one hospital to another by choosing
which hard-to-match patients to match.

Much of the economics of kidney exchange is determined by the shape of the production
function. Returns to scale determine how large a platform must be to attain eciency, which
tells us whether a fragmented market can be ecient.       Marginal products determine the
values of dierent types of patients and donors to the platform, which are key factors in
designing ecient mechanisms.

Theorem 1 shows that ineciency comes from the two market failures we discussed. First,
platforms use inecient mechanisms.     When a hospital submits a patient or a donor to a
platform, current mechanisms reward hospitals according to the    probability   with which that
hospital's patient is matched.   But the theorem shows that, to maximize hospital welfare,
hospitals should be rewarded with the   marginal product   of their submissions (the expected
number of additional transplants enabled), plus a small adjustment term. Because existing
platforms do not reward hospitals based on the marginal product of their submissions, even
a hospital that maximizes the number of own-patient transplants has to perform socially
inecient matches. This problem can be addressed by using a points mechanism that rewards
hospitals according to marginal products. Without making the connection between kidney
exchange and neoclassical producer theory, it is not obvious that this market failure exists,
much less how to x it. The second market failure is that hospital objectives may dier from
pure social welfare maximization, a problem which we refer to as an agency problem. For
example, hospitals may participate too little in kidney exchange because they face most of
the costs but only receive a fraction of the benets.   This problem can be addressed with
subsidy policies and mandates.

The third part of this paper combines theory and data to quantify ineciency in the market
and to suggest policy responses. To do so, we recover the production function using admin-
                                                                                             3


istrative data from the largest US kidney exchange platform and detailed information on
matching algorithms and operational procedures.

The production function yields three sets of results. First, we measure the returns to scale
and estimate the ineciency from market fragmentation.       We nd that the largest kidney
exchange platform is well above the minimum ecient scale, while almost all single-hospital
platforms are far below the ecient scale. We estimate that the gains from moving all produc-
tion to the ecient scale is at least 200 transplants per year, and likely closer to 400. These
improvements correspond to an economic value of between $220 million and $440 million
annually, of which approximately a quarter is due to savings on healthcare costs. Thus, con-
sistent with the descriptive evidence and the shape of the production function, fragmentation
has a large eciency cost. Under certain assumptions, mandating that hospitals participate
in national kidney exchange platforms could realize most of these gains. Our results suggest
that the market can support two to three national platforms at close to the ecient scale.
Therefore, a stronger mandate that additionally restricts participation to a single platform
would not generate further gains.

Second, we use the estimated production function to design more ecient mechanisms. Op-
timal mechanisms should reward submissions approximately according to marginal products,
while current mechanisms reward submissions according to probabilities of matching.        We
nd that marginal products are considerably dierent from probabilities of matching, which
implies that existing mechanisms are far from optimal. We discuss how optimal points mech-
anisms based on our estimates could be used to improve hospital incentives.

Third, we study the importance of the two market failures. The loss in hospital welfare due
to the inecient mechanism depends on the wedge between current and optimal rewards,
and on the elasticity of supply from hospitals.     We have estimated the wedges and the
marginal products, but our data do not have enough information to credibly estimate supply
elasticities. Therefore, we calculate this deadweight loss under a broad range of assumptions
on elasticities. Except under the most extreme of these, the deadweight loss is signicant but
lower than the ineciency due to market fragmentation. Hence, both the current mechanism
and agency problems contribute signicant ineciency in the market. This nding suggests
a two-pronged policy approach:      improve mechanisms and encourage participation.       This
approach is particularly appealing if a mandate is not politically feasible.



Relation to the Literature.         We build upon several earlier contributions.    In kidney
exchange, Roth et al. (2004, 2007) and a large subsequent literature have studied optimal
matching algorithms and the technology of kidney exchange.         In particular, Roth et al.
(2007) calculates the marginal products of dierent types of pairs in a simplied theoretical
model. Our empirical estimates of marginal products are, to our knowledge, the rst test of
their theoretical predictions. We nd qualitatively similar marginal products for most types,
with dierences because the empirical model accounts for features like immune sensitivity
and matching frictions. Based on anecdotal evidence, other papers in the kidney exchange
literature have theoretically analyzed the problem of hospital participation.      Roth et al.
(2005) showed that hospitals may have incentives to match patients outside of an exchange
                                                                                                            4


and that this may compromise eciency.              Ashlagi and Roth (2014) propose a mechanism
that addresses this issue in a stylized static model by only considering exchanges in which all
                                                                            3
patients that a hospital can transplant on its own are matched.                 Hospital rewards in their
mechanism dier from long-run marginal products in a dynamic and stochastic setting when
patients and donors are registered over time. Thus, Theorem 1 suggests that even if their
                                                                                                     4
mechanism provides good incentives in static models, it can be inecient in practice.                    Rees
et al. (2012) advocate for reimbursement policy reform based on the argument that costs of
kidney exchange are a barrier to participation in the market.

We also draw on other areas of economics that are not traditionally used in market design.
Theorem 1 describes linear rewards that maximize hospital welfare. The key idea is based
on analogies to linear commodity taxation (Ramsey 1927) and regulation of multi-product
monopolists (Boiteux 1956). Our theoretical contribution is to apply these classic ideas and
proofs to kidney exchange.         A dierence is that we recognize the possibility that hospital
welfare and social welfare dier, which we model as a general wedge between the two, as
in the modern behavioral public nance literature (Farhi and Gabaix 2017). Our paper is
also related to the industrial organization literature on platforms. Platforms bring together
market participants, much like kidney exchange platforms.                A key issue in this literature
is the structure of optimal prices, commonly studied for two-sided platforms (Rochet and
Tirole 2003; Weyl 2010). Our analysis of kidney exchange involves pricing to only one side
of the market: hospitals. Finally, we measure the total number of transplants lost due to
market fragmentation using a misallocation analysis. This exercise is similar in spirit to the
literature documenting and quantifying the eciency implications of productivity dispersion
(see Bartelsman and Doms 2000; Hsieh and Klenow 2009).




2      Background and Data
2.1 Basics of Kidney Exchange
End-stage renal disease (ESRD) aicts more than half a million Americans. The disease is
almost universally covered by Medicare, even for patients under the age of 65. The Medicare
ESRD program accounts for 7% of its budget, mostly spent on patients undergoing dialysis
(United States Renal Data System 2016).              The preferred treatment for ESRD patients is
transplantation, which increases the quality and length of life by several years and is cheaper
than dialysis. Transplantation saves approximately $270,000 per Medicare beneciary and
even more for privately insured patients (Wolfe et al. 1999; Irwin et al. 2012; Held et al.
2016).    Moreover, the health risks to living donors are small.            Taken together, these facts
indicate that a living-donor kidney transplant has large economic value. Held et al. (2016)

    3 Toulis and Parkes (2015) propose an alternative algorithm in the same lines as Ashlagi and Roth (2014).
    4 Hajaj et al. (2015) also propose a dynamic credit mechanism for kidney exchange; however, their
mechanism rewards each hospital based on the total number of pairs that it submits, irrespective of type. In
this way, their suggested rewards dier from the marginal-product rewards that we suggest in Section 4.3.
                                                                                                            5


                                                                                       5
estimates this value at $1.1 million with a detailed cost-benet analysis.

There is a severe shortage of organs for transplantation. Each year, approximately 13,000
patients are transplanted using organs from deceased donors and another 5,500 from living
donors. Demand far outstrips this supply with approximately 35,000 patients added to the
deceased donor kidney waitlist in each of the recent few years. The shortage has resulted in
the kidney waitlist growing to almost 100,000 patients, with about 8,000 patients per year
                                                               6
dying or being categorized as too sick to transplant.              Monetary compensation cannot be
used to address this shortage because of ethical and legal reasons: it is forbidden in almost
every country, including the United States (Becker and Elias 2007).

Kidney exchange is an innovative way to ameliorate this shortage (Roth et al. 2004; Sönmez
and Ünver 2013). It serves patients who have a willing live donor with whom they are not
biologically compatible. Such patients can swap donors with others in the same situation,
enabling transplants for many patients. These swaps are organized by                   kidney exchange
platforms     that match patients and donors registered with them.                The platforms receive
three types of    submissions.     The most common type is a        pair, consisting of a patient and a
living donor. The second type is an         altruistic donor, who is willing to donate a kidney to
a stranger without requiring a transplant for an associated patient. Finally, there are some
unpaired patients, who do not have a willing live donor.
Platforms organize transplants in two ways. The rst, called a            cycle, involves a set of pairs.
The kidney from one pair's donor is transplanted into the patient in the next pair, and so
on, until the cycle is closed.      All transplants are carried out simultaneously to reduce the
risk that a pair donates a kidney without also receiving one. Cycles are usually limited to at
most three pairs due to logistical constraints. The second type, called a                  chain, is initiated
when an altruistic donor donates to a patient in an incompatible pair. The donor from this
pair can then continue the chain by donating to the next pair, and so on, until the chain
terminates with an unpaired patient. Chains can be very long in principle because transplants
                                                                                   7
do not have to be performed simultaneously, easing medical logistics.                      However, our data
from the National Kidney Registry (NKR), the largest US kidney exchange platform, show
that most chains involve four to ve transplants. Initially, cycles were the most common type
of transaction, but chains became more important over time and now account for about 90%
of transplants.

There are two types of biological compatibility constraints on kidney transplants:                    blood-
type and tissue-type compatibility (Danovitch 2009).               A donor is blood-type incompatible

   5 Most of the $1.1 million comes from gains in quality-adjusted life-years (QALYs), valued at $200,000.
Even if each QALY is valued at only $100,000, the estimated economic value only drops to $660,000. This
drop is less than than 50% because the cost savings on dialysis are also signicant: in 2014, Medicare paid
$87,638 per year per dialysis patient but only $32,586 in post-transplant costs per year per patient (United
States Renal Data System 2016, Chapters 7 and 11).
   6 Statistics taken from https://optn.transplant.hrsa.gov/data/view-data-reports/national-data/
(accessed December 21, 2017).
   7 Rees et al. (2009) report on an early chain involving ten transplants conducted over the course of eight
months. One reason chains can be executed over a long period of time is that donors rarely renege (Cowan
et al. 2017). This trust allows chains in which a patient can receive a transplant before her related donor
donates to the next patient in the chain.
                                                                                                          6


with a patient if the donor has a blood antigen that the patient lacks. There are two blood
antigens, known as A and B. Blood type is A or B if the blood has only the A or the B
antigen, respectively, AB if it has both, and O if it has neither.               A donor is tissue-type
incompatible with a patient if the donor has human leukocyte antigens (HLA) to which the
patient has an immune response.
                                         8
                                             The most common measure of          sensitization,    that is,
how likely a patient is to reject a transplant due to tissue-type incompatibility, is the           Panel
Reactive Antibody (PRA)                score.   A patient's PRA is between 0 and 100 and denotes
the percentage of a representative population of donors with whom a patient is tissue-type
incompatible. Because this measure depends on the choice of representative population, the
NKR's algorithm uses an alternative measure tailored to its own pool called               match power.
It measures, for a given recipient (donor), the fraction of donors (recipients) on the platform
that are both blood-type and tissue-type compatible.




2.2 Institutional Features and the Economics of Kidney Exchange
There are three institutional features that are crucial for the economics of kidney exchange.
First, kidney exchange takes place both in large, national platforms and within individual
hospitals. There are three major national platforms currently operating in the United States:
the National Kidney Registry (NKR), which is the largest; the Alliance for Paired Kidney
Donation (APD); and the United Network for Organ Sharing (UNOS) Kidney Paired Dona-
tion Pilot Program. These large platforms match patients using optimization software that
maximizes a weighted number of transplants. They dier in terms of exact algorithms and
                         9
operational details.         Once an exchange has been arranged, standard medical procedures are
used to conduct the transplant with no known dierences across the platforms. Platforms
also do not inuence a patient or donor's surgeon choice. Besides these major platforms, there
are small regional platforms and individual hospitals that also organize kidney exchanges.

Hospitals are not forced to participate in platforms. In fact, most hospitals that participate
in large national platforms also match patients outside those platforms. When multi-hospital
kidney exchange platforms were conceived, hospital participation was assumed to be all or
nothing. As the market developed, it became clear that platforms eectively reward hospitals
with transplants in order to receive submissions. For this reason, most platforms explicitly
                                                                                                         10
reward hospitals that submit altruistic donors by matching one of their unpaired patients.

   8 Each patient has a list of antibodies to some, possibly large, subset of HLA antigens. If the recipient
has an antibody to one of the donor kidney's antigens, the recipient's immune system will attack the kidney,
leading to immediate rejection.    A recipient is tissue-type compatible with a donor's kidney if she has no
antibodies corresponding the major HLA antigens of the donor's kidney (Danovitch 2009). Note that recent
developments in desensitization techniques have allowed some of these incompatibilities to be overcome
(Orandi et al. 2014).
   9 See Abraham et al. (2007), Ashlagi et al. (2016), Anderson et al. (2014), Dickerson et al. (2012), and
Agarwal et al. (2018).
  10 Until recently, matching an unpaired patient in return for submitting an altruistic donor has been the
only form of reward used by these platforms. After the end of our sample, the NKR started experimenting
with a more complex rewards system to encourage the registration of easy-to-mach patients and donors. This
system was adopted after the end of our dataset. To our knowledge, it is not based on the marginal products.
                                                                                                         7


The second important institutional feature is that biological compatibility creates substantial
variation in the social value of dierent submissions. One reason for this variation is blood-
type compatibility. To simplify exposition, assume that there are only two blood types, O
and A. These two types together are a signicant majority of patients and donors in the
United States. Denote a pair with patient blood type X and donor blood type Y as XY,
and let   qXY   be the number of such pairs in a pool. Assume that         qAO < qOA ,      which is the
                             11
empirically relevant case.        For this simplied case, Roth et al. (2007) showed that, in the
large market limit, the number of transplants that can be performed,             f (q),   is


                           f (q) = 2 · qAO + 1 · (qAA + qOO ) + 0 · qOA .                           (1)


This result follows because AA and OO pairs can be matched with pairs of the same type.
Roth et al. (2007) calls these pairs      self-demanded.       Self-demanded pairs have a marginal
product of   1,   in the sense that they generate      1   additional transplant when they join the
pool. However, an OA pair can only be transplanted using a cycle with one of the valuable
AO pairs.       Thus, there will be many leftover OA pairs that can only be transplanted if
more AO pairs join the pool. AO pairs are called    over-demanded and have a marginal
product of   2.    OA pairs are called   under-demanded and have a marginal product of 0.
An under-demanded pair competes with another under-demanded pair and adds no value to
the pool. Roth et al. (2007) showed that this qualitative pattern holds even in a model with
all possible blood types.

Current platform rules largely ignore this variation in the social value of submissions, inducing
hospitals to perform socially inecient matches. Consider a hospital with two over-demanded
pairs. The hospital could perform a pairwise exchange to conduct two transplants. However,
if the hospital submits both pairs to the platform, then in expectation, the hospital receives
a number of transplants equal to twice the probability that one of them is matched.                    Ac-
cording to our data, this probability is 0.8, so the hospital expects only 1.6 transplants from
submitting, which pushes it to match its patients outside the platform. However, each pair
the hospital submits to the platform generates its marginal product, which the Roth et al.
(2007) model puts at 2. This suggests that the platform could generate four transplants if
the hospital would submit both its pairs. Using a more realistic empirical model, we estimate
only three additional transplants (Section 5). Either way, matching these two pairs within
the hospital is socially inecient despite the hospital acting in the best interest of its patients.

An important corollary of Roth et al. (2007)'s results is that transplants are a natural nu-
meraire in a kidney exchange platform.          Because hospitals have a large number of under-
demanded pairs, it is easy for a platform to transfer transplants from one hospital to another
without compromising eciency, simply by choosing which under-demanded pairs to match.

The third important institutional feature is that hospitals do not necessarily maximize a
utilitarian measure of the welfare of the patients and third-party payers who they represent.
We refer to such behavior as a broadly dened agency problem, since hospitals incur most
of the transaction costs of kidney exchange. The social value from one transplant is more

  11 This fact is conrmed for patients and donors registered in the NKR. See Table 2 below.
                                                                                                            8


than $1,000,000, of which the majority is savings in healthcare costs and gains in quality-
                                                                                                           12
adjusted life years. But, hospital revenues are between $100,000 to $160,000 per transplant.
Variable prots are likely much smaller. Thus, even socially insignicant transaction costs
of performing kidney exchange through a platform can be important for hospitals. Conver-
sations with hospital sta indicate that participation in kidney exchange platforms involves
logistical and administrative hassle in addition to direct costs arising from biological testing
                     13
and platform fees.        Previous surveys and interviews have found that these transaction costs
are commonly cited barriers to participation (Ellison 2014; American Society of Transplant
Surgeons 2016). Besides costs, hospitals may also have behavioral reasons for not perfectly
maximizing patient welfare. For example, there is considerable heterogeneity regarding hos-
pital sophistication: some hospitals use optimization software to match patients while others
do so manually.




2.3 Data
We assembled two datasets for this paper. The rst, the transplant dataset, records all kidney
exchange transplants in the United States. We use this dataset to document fragmentation,
ineciency, and participation in the kidney exchange market. The second, the NKR dataset,
records all patients and donors that registered with the largest US kidney exchange platform,
the NKR. We use this dataset to estimate a transplant production function.

The transplant dataset consists of anonymized records of every kidney transplant conducted
in the United States from January 1, 2008 and December 4, 2014. We obtained this dataset
from the Organ Procurement and Transplantation Network (OPTN), a contractor for the US
                                                    14
Department of Health and Human Services.                 The OPTN dataset includes each transplant's
date and location; whether it is part of a kidney exchange; the age, sex, weight, height,
body mass index (BMI), blood type, and HLA antigens of the donor and recipient; and the
unacceptable antigens and days on dialysis of the recipient. See Appendix C for details.

Although a comprehensive source for data on transplants, the only eld in the OPTN dataset
that specically pertains to kidney exchange is an indicator for which transplants were part
of such an exchange. Therefore, the OPTN dataset does not identify which, if any, multi-
hospital kidney exchange platform organized a given transplant.

  12 See Held et al. (2016) and United States Renal Data System (2013). The revenues include payments for
surgery teams, drugs, equipment, and capital.
  13 Platforms require extensive biological testing, which is particularly complicated because donors and
patients are in dierent hospitals.   Platforms also charge fees, which are paid by hospitals.   NKR charges
an annual fee of about $10,000 plus about $4,000 per transplant. See National Kidney Registry (2016) for
NKR's fees, and Rees et al. (2012) and Wall et al. (2017) for a broader discussion of the kidney exchange
costs borne by hospitals.
  14 This study uses data from the Organ Procurement and Transplantation Network (OPTN). The OPTN
data system includes data on all donor, wait-listed candidates, and transplant recipients in the US, submitted
by members of the Organ Procurement and Transplantation Network (OPTN). The Health Resources and
Services Administration (HRSA), US Department of Health and Human Services provides oversight to the
activities of the OPTN contractor.
                                                                                                        9


To address this limitation, we separately obtained anonymized records of all transplants
organized by each of the three largest multi-hospital kidney exchange platforms in the United
States: NKR, APD, and UNOS. By merging the data from these platforms with the OPTN
data, we identied which transplants were organized through NKR, APD, UNOS, or other
avenues.     This merge is not straightforward because all of our datasets are anonymized.
Fortunately, the rich biological data allow us to match transplants across datasets on the
blood type, sex, and HLA antigens of the recipient and donor; and the date and location
of the transplant. See Appendix C for more details. We were able to match approximately
94% of transplants at these platforms to the corresponding OPTN data with a high degree
                15
of certainty.

The transplant dataset contains information on transplants that were performed, but not on
the pool of patients and donors that were available for kidney exchange. This information
is needed to estimate a platform's transplant production function. Therefore, we assembled
the NKR dataset. It records all patients and donors that registered with the NKR between
April 2, 2012 and December 4, 2014. This dataset is sourced from the administrative records
the NKR uses to organize transplants.           It includes the registration date, blood type, age,
sex, and HLA antigens for both patients and donors.              It also records whether the patient
or donor left NKR's system, and the date and reason for departure (transplantation or
otherwise). In addition, it includes information on pairings between donors and patients (if
any), unacceptable antigens, and all the restrictions a patient places on which organs are
acceptable.      These elds allow us to determine the set of transplants the NKR considers
acceptable and medically feasible. We also have detailed data on how the transplants were
organized, including the donors and patients involved, and the chain or cycle conguration.
Appendix C provides details on how we assembled the NKR dataset.




3       Descriptive Evidence
We now document three key facts: the kidney exchange market is highly fragmented, this
fragmentation leads to ineciency, and there is evidence of agency problems.




3.1 Fragmentation
We rst document that the market is highly fragmented. Most kidney exchange transactions
are matched internally by individual hospitals, as opposed to by large, national kidney ex-
change platforms. A kidney exchange transplant is dened as     within hospital if the donor's
operation took place in the same hospital as the patient's, and across hospitals if the donor's

    15 Of the matches, 90% were within 1 day on the transplant date, within 5 years on donor and recipient
age, and agreed on the hospital where the transplant was conducted as well as the blood type, sex, and all
six major human leukocyte antigen (HLA) alleles relevant for kidney transplantation (2 alleles each at the
HLA-A, B and DR loci) for both the donor and recipient.
                                                                                                                                                              10


                                                                                                          16
and patient's operations took place in dierent hospitals.                                                     We also classify transplants based
on which platform coordinated the exchange: NKR, APD, or UNOS. Transplants that were
not organized by one of these platforms are classied as being performed by other platforms,
including single-hospital programs and small regional platforms.



                                      800




                                      600
              Number of Transplants




                                      400




                                      200




                                        0

                                            2008                           2010                           2012                                2014
                                                                                          Year

                                                    NKR across hospitals      APD/UNOS across hospitals    Other platforms across hospitals
                                                    NKR within hospital       APD/UNOS within hospital     Other platforms within hospital



                                      Figure 1: Market fragmentation and trends in kidney exchange

           Notes:                      The gure displays the number of kidney exchange transplants in dierent categories.                          The
           category Other represents transplants that were not facilitated by NKR, APD, or UNOS. Single-
           hospital platforms fall under this category. Within hospital and across hospital classify a transplant
           into whether the donor's hospital was the same as the patient's hospital.



Figure 1 shows that the market is highly fragmented. The three largest multi-hospital plat-
forms together only account for a minority share of the kidney exchange market.                                                                            Of all
kidney exchange transplants, 62% are within-hospital transplants that are not facilitated by
the NKR, APD or UNOS. Over 100 hospitals performed kidney exchanges outside these three
platforms during this period.

Unlike the dominance of within-hospital exchanges in the overall market, a large majority
of the transplants facilitated by multi-hospital platforms are across hospitals. This contrast
between the overall market and the platforms is striking as the platforms do not prioritize
across-hospital exchanges as a rule; such exchanges are a by-product of maximizing the total
number of transplants. This suggests that coordinating across hospitals has potential gains.

Figure 1 also shows that the total number of kidney exchange transplants grew from about
                                                                  17
400 in 2008 to about 800 in 2014.                                         However, overall market growth seems to have slowed in

  16 The common practice is to transport the organ after recovery instead of transporting the donor and
recovering the organ elsewhere. Conversations with surgeons suggest that the primary motivation for this
practice is to safeguard the donor's interestsshe has built relationships at her hospital, and the donation
surgery requires extensive pre-planning and follow-up care.
  17 Our data for the NKR extend until December 4, 2014. This censoring may account for the slight drop
in transplants in the last year of this gure.
                                                                                                            11


                                                                            18
recent years. The total number in 2017 remains at around 800,                    well below some estimates
of the potential size of the market (Bingaman et al. 2012; Massie et al. 2013).

The growth in kidney exchange between 2010 and 2014 is concurrent with the NKR becoming
the dominant kidney exchange platform.              The NKR accounted for 33.1% of all kidney ex-
change transplants in 2014 and facilitated more than 5 times as many transplants as the APD
                           19
and UNOS combined.              The importance of the NKR during our sample period motivates
our focus on the platform in the subsequent sections.




3.2 Evidence of Ineciency
Market fragmentation creates ineciency if there are increasing returns to scale and hospitals
are operating below ecient scale. We now present direct evidence of hospitals conducting
exchanges that are inecient from a social perspective.

One easily detectable ineciency is a transplant between a blood-type O donor and a non-O
patient. As explained in Roth et al. (2007) and in Section 2, O donors are scarce while O
patients are abundant. If all transplants are of equal social value, optimal matches in a large
market should only transplant organs from O donors to O patients because O patients cannot
                                20
accept other blood types.            The exception to this rule is for a highly sensitized patient, that
is, one with a very high PRA. The platform might want to match an O donor with such a
patient if it were the only way to get her transplanted.

Figure 2 displays the fraction of O donors that are used to transplant non-O patients, cate-
gorized into NKR transplants, APD/UNOS transplants, across-hospital transplants at other
platforms, and within-hospital transplants at other platforms.                   Among NKR transplants,
only 6.5% of O donors are used for non-O patients.                 In contrast, among within-hospital
transplants outside the three platforms, this gure is 22.8%. The dierence is statistically
signicant (p    < 0.01)   and constitutes strong evidence that hospitals often perform inecient
matches outside the platform. The gures for APD, UNOS, and across-hospital transplants
at other platforms are in between these two categories, but much closer to the NKR.

An alternative explanation for inecient matching is that within-hospital transplants use
O donors to help highly sensitized patients who would otherwise remain untransplanted.
However, Figure 2 shows that almost none of the potentially inecient transplants in the
Other (within hospital) category involve highly sensitized patients. In contrast, about half
of the potentially inecient NKR transplants involve highly sensitized patients.

This exercise treats the value of all transplants as equal, irrespective of patient or donor
blood type and whether the exchange was organized through a platform. The total number

  18 Source:   https://optn.transplant.hrsa.gov/data/view-data-reports/national-data/                (accessed
December 21, 2017).
  19 The APD has grown in recent years, signicantly closing the gap.
  20 Strictly speaking, eciency as discussed here means maximizing the total number of transplants. How-
ever, transplanting an O donor to a non-O patient is also likely to be Pareto inecient: if a pairwise exchange
between two over-demanded AO pairs were replaced by two AO to OA exchanges, then all parties would
be better o (assuming the under-demanded OA pairs would otherwise be unmatched).
                                                                                                                 12




       Table 1: Summary Statistics for Kidney Exchange Transplants



                                                  NKR           APD / UNOS             Other platforms
                                                                               Across Hospital Within Hospital

   N                                                    1118            198               341             2719

  Patient Blood Type
       A                                            34.7%             36.4%             37.2%            37.1%
       B                                            19.0%             21.2%             17.6%            17.0%
       AB                                            5.7%              3.5%              7.0%             5.7%
       O                                            40.6%             38.9%             38.1%            40.2%
  Donor Blood Type
       A                                            36.8%             35.4%             37.5%            33.4%
       B                                            18.2%             20.2%             14.7%            13.8%
       AB                                            3.9%              1.5%              6.7%             2.9%
       O                                            41.1%             42.9%             41.1%            49.9%

  Panel Reactive Antibody (PRA) (Sensitization)

       Mean                                           35.0              43.0              30.4            17.6
       Standard deviation                             39.7              40.8              37.5            30.8
       Percent >90                                  16.4%             20.6%             12.0%            5.1%

  Transplant Ourcomes and Quality Measures
       Donor Age
             Mean                                        44.1           44.6              44.1            43.2
             Standard deviation                          11.8           11.1              11.3            11.8
       Donor Body Mass Index (BMI)
             Mean                                        26.5           27.0              26.6            26.5
             Standard deviation                           4.0            4.0               4.1             4.2
       Donor Height (cm)
             Mean                                       169.4          168.0            169.6            169.3
             Standard deviation                           9.8            9.6             10.3              9.8

       Donor Weight (kg)
             Mean                                        76.3           76.3              76.9            76.3
             Standard deviation                          15.1           13.9              15.4            15.1
       Tissue Type Mismatch (0-6)
              Mean                                        4.2            4.2               4.2             4.4
              Standard deviation                          1.3            1.4               1.2             1.2
       Mean Days on Dialysis
             Mean                                   1026.6            1048.4           1063.1            969.1
             Standard deviation                     1088.1             848.1           1269.5            990.9



Notes : Sample of all Kidney Exchange Transplants between January 1, 2008 and December 4, 2014.
                                                                                                                                                13


                                                    25%




             % O donors matched to non-O patients
                                                    20%




                                                    15%




                                                    10%




                                                    5%




                                                    0%

                                                                NKR              APD/UNOS               Other platforms     Other platforms
                                                                                                       (across hospitals)   (within hospital)



                                                                                  Recipient PRA ≥ 90   Recipient PRA < 90




                                                    Figure 2: Evidence of hospitals performing inecient matches

         Notes:                                     The bars display the percentage of transplanted O donors whose kidneys were transplanted
         into non-O patients for dierent categories of transplants. Other indicates a transplant not organized
         by NKR, APD, or UNOS. This category includes transplants organized by single-hospital platforms.
         Within hospital and across hospital classify a transplant into whether the donor hospital was
         the same as the patient hospital.                                    The colors decompose this total into highly sensitized patients
         (PRA > 90) and non-highly sensitized patients. The error bars depict 95% condence intervals for the
         totals.




of transplants provides a transparent and economically relevant measure of market outcomes.
Although not reported, our data show that indicators of the life-years benet of kidney
exchange, such as patient or donor age, do not signicantly dier by blood type.

The remaining concern is that transplants organized through a platform may dier in quality
or costs. However, Section 2.1 argues that that transaction costs of conducting transplants
through a platform are negligible relative to the value of transplants lost by matching O
donors to non-O patients. Morever, Table 1 shows that there are no substantial dierences
in donor or match quality across our platform types. One reason patients considering a multi-
hospital platform need not worry about donor quality is that the platforms allow patients and
doctors to specify donor acceptability criteria. They also allow patients to refuse proposed
transplants if the donor is unsuitable. The only noticable dierence in Table 1 is that patients
who receive a transplant through a platform typically spend only two more months on dialysis
than patients who receive a within-hospital transplant. Given the average patient wait time
of about 32 months, this dierence represents only an 8% increase. The longer waiting time
at the platforms should be expected because, as we discuss below, patients transplanted
through the platform are, on average, harder to match.

If each of these inecient transplants from O donors to non-O patients comes at the cost of
one other transplant, as in the Roth et al. (2007) model, then achieving the level of eciency
obtained by the NKR would have resulted in about 250 additional transplants between 2008
                                                                                                          14


            21
and 2014.        The advantage of considering only the clearly inecient transplants is that the
results provide transparent evidence of ineciency. The total ineciency can be much larger.




3.3 Hospital Participation and Evidence of Agency Problems
Why do hospitals fail to participate more in national platforms? We start by documenting key
facts about hospital behavior and argue that hospitals do not purely maximize the number of
transplanted patients. Instead, they seem to maximize complex and heterogeneous objectives,
including, but not limited to, prots and patient welfare.



3.3.1 Descriptive Evidence
We focus on participation behavior at the NKR because it is the primary multi-hospital
kidney exchange platform during our sample period (Table 1). Figure 3a depicts the extensive
margin of participation among hospitals conducting kidney exchange transplants. A hospital
is considered an NKR participant if it conducted at least one transplant through the NKR
during our sample period.        The gure is a binned scatterplot of the fraction of hospitals
that participate in the NKR versus hospital size (measured by the total number of kidney
                                                             22
transplants performed, both living and deceased).                 Figure 3b depicts the intensive margin
of participation.     The vertical axis in this scatterplot is the fraction of kidney exchange
transplants that a hospital performs through the NKR. The results are qualitatively similar
if we consider participation at any of the three largest kidney exchange platforms because
the APD and UNOS are relatively small during our sample period.

The gures reveal four key facts about participation. First, both the extensive and intensive
margins are important drivers of market fragmentation. Only 41.4% of hospitals participate
in the NKR. Within those participating hospitals, only 59.1% of transplants are conducted
through the NKR. These results are qualitative similar if participation in any of the three
national platforms (NKR, APD, or UNOS) is considered because only a few hospitals par-
                                    23
ticipate in multiple platforms.          Second, larger hospitals are considerably more likely to
participate in the NKR. The probability of participating at all is about 80% for a hospital
that performs approximately 250 transplants per year but only about 30% for a hospital that
performs about 50 transplants per year (Figure 3a).                 Third, conditional on participating,
large hospitals conduct more of their matches outside the platform (Figure 3b). Although
size positively correlates with the fraction of kidney exchange transplants performed in the

  21 Table 1 shows that within-hospital platforms have a larger gap between the fraction of O donors and
patients than the NKR. The dierence in this gap, multiplied by the number of within-hospital transplants,
is a measure of transplants lost due to inecient use of O donors in within-hospital transplants.
  22 This broad measure of size limits the endogenous eect of NKR participation on hospital size since
deceased donor and direct living-donor transplants form the bulk of kidney transplants. During our sample
period, the total number of kidney transplants has remained stable relative to the growth in kidney exchange.
  23 Only 10 hospitals out of the 64 that participated in the NKR between 2012 and 2014 also conducted a
transplant through the APD or UNOS. Most of these hospitals did not do so in all three years and conducted
only a handful of transplants through the other platforms.
                                                                                                                                                                                                                        15




                                                                                                                                 100%
                                                                                                                                                                                               UCLA
              1




                                                                                         Live Exchanges Facilitated through the NKR
                                                                                                                                                                                            Wisconsin




                                                                                                                        75%
                               .8
Fraction of Hospitals in the NKR




                                                                                                                                                                          Cornell                        UCSF
                     .6




                                                                                                           50%
          .4




                                                                                                                                                                                Hopkins




                                                                                                 25%
.2




                                                                                                                                                                                              UC Davis




                                                                                        0%
                                                                                                                                                                                          Methodist      Jackson Memorial

                                                                                                                                        0   25 50 75 100 125 150 175 200 225 250 275 300 325 350 375 400
                                                                                                                                                      Hospital Size (# Transplants per year)
              0




                                    0      100                       200         300
                                        Hospital Size (# Transplants per year)                                                                            All hospitals                   NKR Participants



(a) Any transplant conducted through the NKR                                           (b) Reliance on the NKR for living-donor exchanges


                                                     Figure 3: Heterogeneity in participation in the NKR



NKR, the relationship is negative if we focus exclusively on hospitals that participate at all
(Figure 3b). Fourth, there is a high degree of heterogeneity in intensive margin participation.
Even among hospitals with similar size, participation varies considerably (Figure 3b). For
example, among the ve transplant hospitals that perform more than 300 transplants per
year, one does not participate at all (Jackson Memorial), one has a participation rate close
to zero (UC Davis Medical Center), one has a rate in the 50%60% range (UCSF Medical
Center), and two have rates greater than 75% (UCLA Medical Center and the University of
Wisconsin Hospital).

The data also provide information on the characteristics of patients submitted to the NKR
and of the patients transplanted by each hospital, categorized by how the transplant was
facilitated. Tables 1 and 2 reveal three main facts.

First, the NKR receives submissions that are very hard to match compared to the general
population (Table 2).                                          The blood types of both altruistic and paired donors skew away
from O donors and toward A donors relative to the US population.                                                                                                                The deceased donor
population has about 45% O donors and 40% A donors. In contrast, patients in pairs are
disproportionately likely to have blood type O (58.6%), and their related donors are unlikely
to have blood type O (31.9%). Only a small fraction of pairs (13.8%) are over-demanded.
Interestingly, unpaired patients are much more likely to have an easy-to-match blood type
(the majority having A). The average PRA for patients registered with the NKR is 47.6,
which corresponds to tissue-type incompatibility with almost half the reference population.

Second, the NKR transplants patients who are considerably harder to match than patients
transplanted by single hospitals (Table 1). Approximately 40% of the patients and 41% of
donors transplanted through the NKR are blood type O. The PRA of the patients trans-
planted through the NKR is approximately 35, and about one in six patients have a PRA
above 90. These statistics are similar for across-hospital kidney exchanges not facilitated by
the NKR and transplants facilitated by APD or UNOS. In contrast, among within-hospital
kidney exchanges not conducted by a large platform, almost 50% of the donors are blood type
                                                                                                                              16


                          Table 2: Summary Statistics for NKR Submissions




                                                                 Altruistic Donors        Pairs        Unpaired Patients

                   N                                                   164                1265                   501

                 Patient Blood Type
                        A                                                –               23.8%                  51.1%
                        B                                                –               15.0%                  16.0%
                        AB                                               –                2.6%                  19.0%
                        O                                                –               58.6%                  14.0%
                 Donor Blood Type
                        A                                             44.5%              44.4%                    –
                        B                                             14.0%              18.5%                    –
                        AB                                             3.7%               5.2%                    –
                        O                                             37.8%              31.9%                    –

                 Match Power
                        Recipient/Pair
                                Mean                                     –                0.218                 0.431
                                Standard deviation                       –                0.210                 0.392
                        Donor
                                Mean                                   0.279              0.258                   –
                                Standard deviation                     0.162              0.159                   –
                 Panel Reactive Antibody (PRA) (Sensitization)
                                Mean                                     –                48.8                  44.4
                                Standard deviation                       –                41.1                  45.1
                 Pair Type
                        Overdemanded                                     –               13.8%                    –
                        Underdemanded                                    –               41.9%                    –

                 Note: A pair is overdemanded if the patient is blood-type compatible with the related donor.
                Underdemanded
         Notes: A              pairs either are
                  pair is over-demanded         O-patients
                                             if the patientwithout O-donors orcompatible
                                                              is blood-type    are AB-donors without
                                                                                          with   the AB-patients.
                                                                                                     related donor, but not
                 Sample of all patients and donors registered in the NKR between April 4, 2012 and December 1, 2014.
         of the same blood type. Under-demanded pairs are either blood-type O patients without blood-type
         O donors or are blood type-AB donors without blood-type AB patients. Sample is all patients and
                 NKR
         donors registered in the NKR between April 2, 2012 and December 4, 2014.




O, but only 40% of the patients. The average PRA of patients transplanted through within-
hospital exchanges is only 18. This is almost half the mean PRA for patients transplanted
through one of the three national platforms.

Third, transplants on all platforms look similar in donor quality measures that do not af-
fect compatibility, such as weight, body mass index, and age (Table 1). This supports our
equal treatment of all transplants for welfare calculations, irrespective of whether they are
facilitated though a national platform.



3.3.2 Implications for Hospital Behavior
The facts above have implications for dierent hypotheses about hospital behavior. In the
discussion that follows, we approximate total patient welfare with the total number of trans-
plants since, as we argued in Section 2, kidney exchange transaction costs are small relative
to the benets of transplantation.
                                                                                                          17


The rst hypothesis is that that hospitals maximize the total welfare of all patients in the
system, regardless of which hospital a patient belongs to. This hypothesis is strongly rejected
by several features of the data, such as the evidence of socially inecient matches (Figure 2).

A second hypothesis is that hospitals only maximize the welfare of their own patients. This
hypothesis was investigated theoretically by Ashlagi and Roth (2014), who argue that hos-
pitals will try to match as many of their patients internally as possible and only submit
the remaining patients to a multi-hospital kidney exchange platform.                 This hypothesis ts
some qualitative patterns in the data, but not others. For example, it explains why larger
hospitals in the NKR perform fewer transplants through the platform: these hospitals have
more opportunities to match patients outside the platform (Figure 3b). However, it does not
explain why many hospitals do not participate in a national platform at all, even though all
                                                                24
hospitals likely have patients who cannot be matched.                Moreover, many small hospitals do
not participate in the NKR, even though these hospitals, due to their size, are least likely to
nd matches within the hospital. The patterns suggest that hospitals respond to xed costs
of participating in kidney exchange platforms, even though these transaction costs are small
relative to benets to patients and cost savings from dialysis to insurers.

A third hypothesis is that hospitals are prot maximizers. This hypothesis is consistent with
the fact that small hospitals are less likely to participate in the NKR (Figure 3a) because
the xed costs of participation may not compensate for the gains in prots from additional
transplants. However, this theory alone cannot fully explain the large variation in the degree
of participation, especially among large hospitals. For example, transplant coordinators at
Cornell Medical Center (a large hospital with a high NKR participation rate), report that
a primary reason for participating is the importance of contributing to a national kidney
exchange platform (Ellison 2014).

Taken together, the evidence on hospital participation suggests that hospitals maximize com-
plex and heterogeneous objectives. This nding is consistent with the anecdotal evidence on
kidney exchange reviewed in Section 2, as well as the standard view in healthcare economics
(Arrow 1963) and more recent ndings about the behavior of healthcare providers (Kolstad
2013; Clemens and Gottlieb 2014).

The facts about selection into which patients and donors are submitted to the NKR also
indicate that two of these theoriesmaximizing prots and maximizing their own patients'
welfarecan explain many hospitals' behavior.             These theories' shared implication is that
pairs submitted to national platforms are negatively selected, in the sense of being hard to
match. In both cases, a hospital only submits a pair to a platform if an internal match is not
possible. Unfortunately, we cannot directly test this prediction because we do not have data
on the entire pool of patients available to individual hospitals. But, it is reassuring that the
results on selection do not falsify the two theories that best t the participation behavior.

To summarize, these ndings have two important implications. First, there is clear evidence
of agency problems, as we dened broadly in Section 2. Second, the data indicate that none
of the simple models describe the behavior of all hospitals.

  24 Recall that over-demanded pairs are typically scarce. We will see in Section 5 that even the NKR is able
to match only about 50% of its donors.
                                                                                                                 18


4      Theory
The evidence above shows that kidney exchange markets are fragmented, which leads to
real eciency loss. We now build a model similar to one of a traditional market in which
the platform procures submissions (donors and patients) from hospitals and rewards these
hospitals with transplants. We use the model to explain how ineciency arises, to quantify
it, and to develop responses. In particular, under certain assumptions, policy responses like
participation mandates and providing incentives can improve outcomes.



4.1 Model
A kidney exchange platform procures submissions from hospitals and rewards them with
transplants.   The platform's ability to produce transplants is described by a                       production
function f .   We consider       types of submissions
                                                    i = 1, . . . , I . A vector of                  submissions
         I       I
q = (qi )i=1 in R+ species a quantity qi of each submission type available to the platform,
where R+ is the set of non-negative real numbers. Given a vector of submissions q , the
platform can produce       f (q)   transplants.    The model can be interpreted as either static or
as a steady-state from a dynamic model. We will use the steady-state interpretation in the
empirical analysis. All variables are measured in ows (i.e., transplants per year).

The production function         f (q)   summarizes what matches are possible.                 Roth et al. (2007)
calculated the production function using a simple model that we described in Section 2. Since
that paper assumed that all submissions are pairs and that only blood-type compatibility
matters, its model has     I = 16 types.    Our analysis applies both to such theoretically tractable
production functions as well as to more complex ones. Section 5 uses an empirical production
function that allows submissions to dier by whether they are patientdonor pairs, altruistic
donors, or unpaired patients, and by a host of variables including blood type and antigen
and antibody proles. Thus, the number of types              I    is potentially large.

We say that the production function          f   has   constant returns to scale at q if its elasticity
                                                                    α         ∂f (αq)
with respect to scale at    q   is equal to one. That is,
                                                                 f (αq)
                                                                          ·
                                                                         = 1, which is equivalent
                                                                                ∂α
                                                                     α=1
to   ∇f (q) · q = f   (q). The Roth et al. (2007) model considers a large platform with constant
returns to scale. Our empirical production function in Section 5 will measure the returns to
scale for the NKR.

The platform produces transplants using submissions provided by                         hospitals h = 1, . . . , H .
Hospitals are rewarded for these submissions with transplants. We assume these rewards are
linear in submissions and anonymous. That is, there exists a                     vector of rewards
                                                                                p = (pi )Ii=1
     I
in R where the ith component denotes the (expected) number of transplants awarded to the
hospital per submission of type i. The units of pi are transplants per submission. A hospital
                      h      I                                     h
that submits a ow q in R+ of submissions receives a ow p · q of transplants. Since all
transplants that are performed must be allocated to some hospital, a platform must satisfy
                       P h P
the constraint that f    hq    = h p · qh.
This linear reward schedule is a good approximation of current platforms' rules because their
matching algorithms maximize a weighted sum of the number of matches without considering
                                                                                                                         19


which patients and donors are submitted by each hospital (Sönmez and Ünver 2013; Anderson
et al. 2015).     That is, when a hospital submits an additional pair, the probability that
the platform matches a dierent pair from the same hospital does not signicantly change.
Therefore, the current reward for submitting a type                       i   pair is equal to the probability     pi   that
the pair is matched.

We assume that hospital utility equals the number of transplants received from the platform
          private cost                   h
                                              
minus a                of submissions, C   q h , measured in transplant units. For instance,
                                                                                       h  h
if a hospital maximizes the number of its own patients that are transplanted, then C (q )
is the number of within-hospital transplants that the hospital must forgo in order to submit
q h . However, C h (q h ) could also include a weight on additional hospital prots from within-
                                                                                          h  h
hospital transplants. Our analysis will remain agnostic about the specic form of C (q ),
except when explicitly noted.

Welfare is dened over an         allocation (qh )Hh=1 that species the quantity of pairs supplied by
each hospital. We will use two welfare notions, both of which use transplants as a numeraire
because platforms can eectively transfer transplants between hospitals by choosing which
under-demanded submissions to match (see Section 2).

The rst notion is       hospital welfare W H (q1 , . . . , qH ), which is the total welfare measured
from the point of view of hospitals. Hospital welfare equals the total number of transplants
produced (which is the same number of transplants that hospitals receive) minus the private
costs. That is,
                                                                          !       H
                                                             X                    X
                                 H     1          H                   h
                               W (q , . . . , q ) = f             q           −         C h (q h ).                      (2)
                                                              h                   h=1

This is a compelling notion of welfare if the goal is to help key market participants (hospitals,
in this case) achieve their objectives.

Hospital welfare is not compelling if hospitals do not purely maximize patient and insurer
welfare. As discussed in Sections 2.1 and 3, there is anecdotal and empirical evidence of such
agency problems. For this reason, we also consider a utilitarian welfare measure, which we
                         25
term social welfare.

Dene   SC h (q h )   as the   social cost for hospital h to supply a vector qh submissions.                      If there
are agency problems, then social and private costs are dierent, and there is an agency                                 ex-
ternality                                            h h        h   h                    h
           from hospital h's submissions because C (q ) 6= SC (q ). For example, C (q ) is
                                                                                             h
               h  h
larger than SC (q ) if hospital h acts as though the nancial and logistical costs of participat-
ing in kidney exchange platforms are signicant relative to the private value of a transplant.
The externality represents the benets to stakeholders other than the hospital itself. We will
                                                                                         26
refer to any such wedge as a (broadly dened) agency problem.                                 In the particular case where

  25 The theory does not make specic assumptions about social welfare. In the empirical application, we will
consider social welfare to be equal to the number of transplants performed because the costs of organizing
exchanges and transplants are small relative to the social benet of a transplant.
  26 The wedge between    Ch   and   SC h   includes all reasons why hospitals' objectives deviate from social goals.
But, it can be decomposed into behavioral reasons why hospitals do not maximize social welfare (such as
inattention) and dierences in payos if hospitals were rational.                 We follow the behavioral public nance
                                                                                                                  20


there are no agency problems, we have           C h (q h ) = SC h (q h )     for all    h.    Dene   social welfare
to be
                                                                   H
                                                                   X
                               SW (q 1 , . . . , q H ) = f (q) −         SC h (q h ).
                                                                   h=1

Dene rst-best hospital welfare as the supremum of                    WH   and rst-best social welfare as the
supremum of     SW .
Given these primitives, for a vector of rewards             p,   the   hospital supply of hospital h is
                                 S h (p) = arg max p · q h − C h (q h ) .
                                                                      
                                                 q h ∈RI+


Dene the  aggregate cost, C (q), to be the
                                         P minimum   sum of hospital private costs neces-

                                           h q in aggregate. Let the aggregate supply
                                              h
sary to ensure that hospitals supply q ≡
correspondence be
                                    S(p) = arg max [p · q − C(q)] .
                                                   q∈RI+


We assume that the production function, social and private costs, and aggregate cost func-
tions are dened over all non-negative real vectors and are smooth. The maximum of each
hospital's objective is attained for some quantity for every vector of rewards. Quantities are
column vectors, and vectors of rewards and gradients are row vectors. Further, assume that
aggregate cost is strictly convex.

Appendix B shows that aggregating individual hospital supplies yields S(p). Denote the
aggregate inverse supply
                                          
                          with P S (q) =    p ∈ RI | q ∈ S (p) . Further, Appendix B
shows that, for strictly positive    q , the aggregate inverse supply is single-valued and P S (q) =
∇C (q) .    This result is similar to how rms supply at price equal to marginal cost in a
competitive market.




4.2 Illustrative example: Agency and the wedge between private
    and social costs
Our model of the kidney exchange market is framed in terms of transplants as a numeraire,
and captures agency problems as a wedge between private and social costs. We now present
a particular example to clarify these two features of the model. The specic assumptions in
this section are not necessary for our results.

Let   K h (q h ) be the monetary costs borne by hospital h of sending q h                    submissions to a kidney
exchange platform.        These can include platform fees, costs of rearranging the hospital's
schedule around the platform, and funds for hiring additional transplant coordinators (see

literature (Farhi and Gabaix 2017) in letting the wedge include all of these dierences.              We use the term
agency for two reasons. First, Section 2 argues that hospitals represent patients and insurers, and that the
additional costs of participating in kidney exchange are negligible when compared to the value of a transplant.
Second, survey and anecdotal evidence suggests that these costs inuence decisions, indicating that agency
problems are important. We cannot rule out behavioral biases resulting in suboptimal hospital behavior.
                                                                                                                                 21


Section 2.1). Let   T h (q h ) be the ow of kidney                    exchange transplants that hospital                h   forgoes
                      h
when     submitting q to the platform because                          it cannot match these patients and donors
              27
internally.

To combine the monetary costs and the transplant costs of submitting, we need a rate of
exchange between the two. Let hospitals value each transplant at                                       v   dollars, which includes
prots and the value that hospitals place on transplanting their patients.                                         Gross revenues
from a transplant are approximately $150,000 (United States Renal Data System 2013; Held
et al. 2016). For illustrative purposes, take                  v   to be $50,000, which represents a generous 50%
mark-up on costs. In transplant units, hospital                         h's   cost function is


                                                                              K h (q h )
                                          C h (q h ) = T h (q h ) +                      .
                                                                                 v
The private value of a transplant just discussed does not account for any benets that fall
to non-hospital stakeholders. Such benets include the value a patient has for a transplant
beyond the value the hospital places on it and the savings in healthcare costs to insurers.
Hospitals contract with these agents, but may not account for all of their benets because
they are not incentivized to do so. For this reason, the social value of a transplant may dier
from the private value to a hospital, creating agency problems.

Let society value transplants at          V >v        dollars. The cost-benet analysis in Held et al. (2016)
                                 28
places   V   at $1.1 million.         But, even half that value is much higher than hospital prots.
This ts our model with social costs


                                                  h   h      K h (q h )
                                                                   h   h
                                          SC (q ) = T (q ) +            .
                                                                V
Hence, the wedge between private and social costs equals
                                                                                     
                                      h   h               h   h            1   1
                                  C (q ) − SC (q ) =                         −            · K(q h ).
                                                                           v V
The dierence is how much more hospitals care about the costs of participating in a kidney
exchange platform than society does, measured in transplant units.

To develop intuition for this wedge's magnitude, assume that the monetary cost is linear in the
                                h  h
                                         PI      h
                                                                                      PI     h
number of submissions, i.e., K (q ) = k     i=1 qi . Then, the wedge is roughly (k/v)   i=1 qi ,
where the approximation holds because the social value of a transplant                                      V   is much larger than
the monetary cost         k.   The wedge is large because it depends on the platform participation
costs borne by the hospitals as a fraction of a transplant's private value, not its social value.

For example, if      k   is $10,000 and       v   is $50,000, then the wedge is                   k/v = 0.20 transplants        per
submission.        Hospitals compare this wedge to the rewards vector                               p, which is equal to        the
probability of matching various submissions in the current mechanism. In eect, the wedge

  27 If the hospital cannot supply a quantity         qh ,    dene    T h (q h )   as innity.
  28 Even if a kidney exchange patient would have otherwise received an organ from a deceased donor, the
kidney exchange enables some other patient to receive the deceased donor organ. Therefore, the social benet
of each kidney exchange transplant should still be the same as the gain from one transplant.
                                                                                                          22


creates an incentive for the hospital to not submit a patient or donor to a national platform.
The calculation above suggests that, because of agency problems, rewards have to be 20
percentage points higher in order to induce a given submission. Therefore, it is likely that
agency problems are an important part of the kidney exchange market.




4.3 Optimal Incentives
The following theorem describes optimal rewards.


Theorem 1        (Optimal Rewards)   . Consider a vector of rewards p and an allocation (qh )Hh=1
with strictly positive aggregate quantity q that maximizes hospital welfare subject to all hos-
pitals choosing q h ∈ S h (p) and subject to the total rewards allocated being the same as the
number of transplants produced, that is, f (q) = p · q . Then:

  1. The platform rewards each type of submission with its marginal product minus an ad-
     justment term. Specically,
                                             p = ∇f (q) − A (q) ,
      where
                                            ∇f (q) · q − f (q)
                                                                 
                              A (q) =                                 q 0 · DP S (q) ,
                                             q 0 · DP S (q) · q
      and DP S (q) is the Jacobian matrix of the inverse supply.
  2. If the production function has constant returns to scale at q , then the reward for each
     type of submission is equal to its marginal product, p = ∇f (q). Moreover, the alloca-
     tion (q h )H
                h=1 attains rst-best hospital welfare.

  3. If, in addition, social cost is equal to private cost (C h q h = SC h q h for all h), then
                                                                                        

     this allocation attains rst-best social welfare.

The rst part shows that to maximize hospital welfare, the reward for each submission must
be approximately equal to its marginal product. To build intuition, ignore the constraint that
the platform cannot allocate more transplants than it produces. The platform is similar to a
rm that produces a consumption good (transplants) using intermediate goods (submissions).
Since the supply of intermediate goods equates prices           p   with marginal costs      ∇C ,   the rst-
order condition for maximizing hospital welfare implies that ecient prices              p   must equal to
marginal products      ∇f .
The only complication is the constraint that a platform cannot allocate more rewards than
the number of transplants produced, which binds if          f     does not exhibit constant returns to
scale. If   f   exhibits increasing returns to scale, then the average product is lower than the
marginal product. In this case, A (q) · q , the optimal level of shading relative to marginal
products, summed over all ows, equals ∇f (q) · q − f (q). Thus, the optimal level of shading
depends on the returns to scale. The formula for A (q) shows that the platform should
                                                                                                                                      23


                                                                                                   29
shade more aggressively on submissions with less elastic supply.                                          Our formula is similar
to standard formulas in optimal linear commodity taxation (Ramsey 1927), regulation of
monopolies (Boiteux 1956), and optimal pricing (Lerner 1934). The proofs are identical for
kidney exchange platforms, but provide new insight in an application where monetary prices
are not paid to acquire submissions.

The theorem shows that current platform rules are inecient. Instead of rewarding submis-
sions with their marginal products, current rules reward submissions with the probability
of being transplanted. Therefore, there is a wedge between the social and private benets
of submissions. Under current rules, a hospital chooses between serving its own patients or
providing a service to the system as a whole. A clear example of this dilemma, described in
Section 2.2, is of a hospital with two over-demanded pairs. This hospital could match the
pairs internally instead of submitting them to a platform, but doing so would cause the type
of ineciency documented in Section 3.

The second part of the theorem shows that, when returns to scale are constant, the optimal
mechanism rewards submissions exactly according to marginal products.                                              The adjustment
term in this case equals zero, and optimal rewards achieve rst-best hospital welfare. As we
will show in Section 5, this case is empirically relevant because the NKR is well within the
region of approximately constant returns to scale.                              Therefore, optimal mechanisms can be
calculated in practice by estimating marginal products.

Moreover, when there are constant returns to scale, there is no need to consider non-linear
rewards because we can achieve rst-best hospital welfare with linear rewards. One approach
for using these results in practice is to introduce a dynamic points mechanism.                                              For each
submission, a platform can credit a hospital points equal to the marginal product. Then a
point can be subtracted whenever a hospital conducts a transplant. The platform performs
optimal matches with a constraint that no hospital's point balance falls below a certain level.
We discuss the design of this type of mechanism in Section 6.1. Another approach is to use
a mandate that forces hospitals to make the ecient level of submissions. We discuss this
type of policy response in Section 6.3.

The third part of the theorem states that if the production function exhibits constant returns
to scale and there are no agency problems, then the optimal mechanism achieves rst-best
social welfare. This result claries that there are two possible sources of ineciency: sub-
optimal platform incentives (i.e., rewards that deviate from marginal products,                                             p 6= ∇f )
and agency problems (hospitals failing to fully internalize the welfare of the parties they
            h     h
represent, C 6= SC ).

Figure 4 depicts these two market failures in a graphical framework reminiscent of supply and
demand. It ignores the adjustment term because estimates in Section 5 will show that NKR
is at approximately constant returns to scale.                             The horizontal axis plots aggregate supply
q.    The vertical axis plots marginal products, social costs, and social benets. The current

     29 To see why, consider the case when the cross-elasticities of supply are zero so that                              DP S   is a di-
agonal matrix.
                            Then, for each type        i,   the reward is marked down from marginal product according to
1        ∂f                       λ
pi       ∂qi   (q) − pi       =   εi , where   εi   is the own-price supply elasticity and   λ   is the Lagrange multiplier on the

constraint that all transplants produced must be given out as rewards, that is,                         f (q) = p · q .
                                                                                                                                   24



                              ∇f (Marginal Social Product)                                      P S = ∇C
                                                                                                (Marginal
                                                                                                 Private Cost
                                                                                                 and Supply)
                                                                 b


                                                                                        b
                                                                                               ∇SC           (Marginal
                                                                                                              Social Cost)


            p0                  b




                              q0                              q∗                     q ∗∗
                                    Figure 4: The Two Sources of Market Failure

           Notes:   The horizontal axis represents aggregate quantity of submissions into the kidney exchange
           platform.   The curves represent the marginal product of submissions,            ∇f (q),   the marginal private
           cost of submissions from the perspective of hospitals,           ∇C(q)   (which is equal to   P S (q),   the inverse
           aggregate supply), and the marginal social cost of submissions,             ∇SC(q)    (see footnote 30).       Both
           axes represent     I -dimensional   vectors. The gure depicts the current quantity, with agency problems
           and a suboptimal mechanism,          q0 ;   the quantity from a hospital-optimal mechanism, but with agency
           problems,   q∗ ;   and the rst-best quantity, with an ecient mechanism and no agency problems,              q ∗∗ .



vector of rewards, which is equal to the probability of matching each pair, is denoted by                                        p0 .
The current quantity supplied,  q 0 , is determined by the aggregate supply                                          curve evaluated
at current rewards. The curve ∇SC (q) is the marginal aggregate social                                               cost if hospitals
                                                           30
choose privately optimal quantities given rewards P S (q).

The hospital-optimal quantity                  q∗      equates       ∇f   with marginal aggregate private costs. Thus,
the rst market failure is that the platform gives inecient incentives. The second market
failure is that there are agency problems because hospitals do not fully account for the costs
                                     h      h                             ∗∗
and benets of other parties (i.e., C 6= SC ). The aggregate quantity q      maximizes social
welfare subject to hospitals responding optimally given a rewards vector. It attains the rst-
                                                                             h       h
best social and hospital welfare if we also solve agency problems so that C = SC , which
makes the two welfare notions coincide.

In the example above, agency problems can be solved by reimbursing hospitals for the costs
                                          h
                                               
of kidney exchange through the platform K   q h . Note that it is not possible to reach the
rst-best social welfare by only improving the mechanism because there are often not enough
transplants to set rewards that are high enough to solve agency problems (see Proposition
A.2, for details). Alternatively, under certain assumptions, a regulator can simply enforce
the rst-best allocation with a mandate.

These arguments suggest two alternative approaches for policy. One is to implement a man-
date that, for example, requires that hospitals submit all patients and donors to a national

                               H                     
  30 Formally,   SC (q) ≡
                               P
                                    SC h S h (P S (q)) is the reward-moderated social cost.                  The gure assumes that
                        h=1
each individual hospital supply is uniquely dened and that                   SC (q)    is dierentiable. See Appendix A.2.
                                                                                                        25


platform. Under certain assumptions, this is socially optimal. Another approach is both to
have exchanges use ecient mechanisms and to create policies that solve agency problems.
This approach avoids the political barriers that a mandate might face and is also optimal,
ender certain assumptions. Section 6 elaborates on these issues.

The upshot of this analysis is that, much like in traditional markets, many key questions
about kidney exchange depend on the production function, which we turn to next.




5       Production Function Estimates and Results
We now recover the production function using data from the dominant kidney exchange
platform during our sample period, the NKR (see Table 1).                  We use these estimates to
measure the ineciency due to market fragmentation, calculate the rewards in an optimal
mechanism, and assess the eciency gain from moving to an optimal mechanism.




5.1 An Engineering Approach
Production functions are commonly estimated using data on inputs and outputs from several
rms. The key econometric challenges in this literature are endogeneity in the chosen inputs
and selection in the set of operating rms (see Marschak and Andrews 1944; Olley and Pakes
1996). Unfortunately, this approach is not appropriate in our setting for three reasons. First,
the standard methods are best suited for low-dimensional production functions that only
depend on a few inputs, such as capital and labor.              In our case, the inputs are dierent
submission types, which are numerous (they vary by blood type, sensitization, and whether
the patient or donor is paired).        Second, commonly used functional forms, such as Cobb-
Douglas, restrict all inputs to be substitutes, a property that may not be appropriate in the
                              31
kidney exchange context.           Third, the standard methods depend on a panel dataset with
inputs and outputs of multiple rms and exogenous variation of inputs. However, we only
have data from a single, large platform.

We circumvent these econometric issues by using an engineering approach based on detailed
institutional knowledge and administrative data on the processes involved in organizing kid-
ney exchange. This approach was rst introduced within economics by Chenery (1949), but
fell out of favor due to its complexity and because some relevant inputs (e.g., managerial re-
sources) were often dicult to measure (Walters 1963). However, it is particularly well suited
for our study because we have detailed data on NKR's operations, and the composition and
                                                  32
biological compatibility of its patient pool.

We simulate the various steps involved in organizing kidney exchange to evaluate the number
of transplants,   f (q; θ), that can be produced with a ow of submissions, q , given parameters,
    31 In a transplant production function, one input type may either be a substitute or a complement with
another. For example, an AO pair and an OA pair are complementary since they together produce one
pairwise kidney exchange. However, an OA pair is a substitute input for an OO pair in this setting.
    32 One of us (Ashlagi) developed the matching software for several platforms and has worked with NKR.
                                                                                                                          26


θ. The simulation is dynamic, with each period representing one day.                      There are four steps that
take place: hospital submissions, transplant proposal, nal review and transplantation, and
departure. The parameters governing the rst and last steps are directly estimated from the
NKR data; the parameters involved in the second step are known; and the parameters from
the third step are calibrated to t observed transplantation probabilities for various patient
and donor types, as well as the average length of chains.                       Our estimation and calibration
methods are described in the following paragraphs, with details provided in Appendix D.


    1.   Submissions:          Hospitals submit patients and donors, either individually or in pairs, to
         the platform. These submissions are added to the current pool of patients and donors
         already registered with the exchange. Patients and doctors, at this time, can submit
         minimal acceptance criteria for a donor.

         Submissions arrive according to a Poisson process with arrival rates given by a vector
         q,   whose dimension equals the number of submission types,                      I.   The NKR baseline is
         represented byq 0 . We estimate the daily arrival rate of each submission type i as
         average number of arrivals per year. An identical arrival process with Poisson arrival
         rates   q   allows us to calculate the production function at other arrival rates                   q 6= q 0 .
         Our exercises will start by treating each submission as a separate type (I                            =   1930).
         We will then aggregate types to best predict probabilities of matching and marginal
         products using biological characteristics that are relevant for kidney exchange (e.g.,
         blood type and patient PRA).


    2.   Transplant Proposal:               Each day, the NKR identies an optimal weighted set of po-
         tential exchanges within the stock of patients and donors. This algorithm incorporates
         four constraints. First, none of the proposed transplants should be (known to be) bio-
         logically incompatible or ruled out by pre-set acceptance criteria. These constraints are
         directly observed in the data. Second, no donor or recipient can be involved in more
         than one transplant. Third, a donor in a pair is only asked to donate an organ if her
         associated recipient is proposed a transplant. Finally, the cycle size is limited, because
                                                                                                                 33
         of the logistical diculties inherent in organizing many simultaneous surgeries.

         The parameters of this algorithm are the weights used by the NKR for a transplanting a
         given donor and patient and the maximum cycle size. Consistent with NKR policy and
         observed data, we prohibit all cycles of length four or greater. The weights are known
         to one of the authors (Ashlagi) and are detailed in Appendix D. They prioritize unlikely
         matches in an attempt to utilize hard-to-match donors and transplant hard-to-match

  33 Formally, the NKR maximizes       P
                                            jk cjk wjk xjk by picking xjk ∈ {0, 1}, where xjk = 1 denotes a proposed
transplant from donor      k   to patient   j ; wjk is the weight given to the transplant by the NKR; and cjk is
an indicator for whether the transplant is biologically compatible and acceptable. This problem is subject
to three additional constraints.              First, no donor or patient is involved in more than one transplant, i.e.,
                                                                                                                          0
P                        P
  j xjk  ≤   1 and          k  x jk ≤ 1 . Second,   if donor k and patient j belong to a pair, then xj 0 k = 1 for some j
                                            0
only if xjk0 = 1 for some donor k . To write the third constraint, note that a cycle of length n is an ordered
tuple, (j1 , j2 , . . . , jn ) where xjk jk+1 = 1 for k < n and xjn j1 = 1. We impose the constraint n ≤ 3. Because
there are a very large number of cycle length constraints, we rst solve a relaxed problem without this last
constraint and iteratively add the constraints to prohibit large cycles. Appendix D provides further details.
                                                                                                                   27


        patients whenever possible. The weights typically only break ties between two matches
        with the same number of transplants in favor of retaining patients and donors who are
        more likely to match in the future.


   3.   Final Review and Transplantation:                  Each proposed transplant is reviewed by doc-
        tors, patients, and donors, and approved before it is performed.                   Both approval and
        biological testing can take several days.            Moreover, patients and donors in proposed
        transplants that are under review on a given day are excluded from the maximal match-
        ing algorithm on that day. This step also involves a nal set of blood tests to ensure
                                     34
        biological compatibility.         Cycles in which any patient refuses or is found to be in-
        compatible with the proposed donor are abandoned. NKR usually abandons chains in
        which the second patient cannot be transplanted. For other chains, all proposals until
        the rst failure are consummated. The donor belonging to the nal patientdonor pair
        in such a chain may initiate new chains in the future, much like an altruistic donor.
        This donor is often referred to as the bridge donor. Consistent with NKR policy, un-
        paired patients are prioritized according to the net dierence between altruistic donors
        and unpaired patients previously transplanted by the patient's hospital.

        This step results in frictions within the system that reduce transplantation rates (Agar-
        wal et al. 2018). The parameters that govern these frictions are the time required for
        each of the two approval steps, the probability that a proposed transplant is abandoned
        in each step, and the duration for which a bridge donor is retained in the pool before
        donating her kidney to a patient on the deceased donor list.

        Unfortunately, we do not have detailed data on which transplants were refused, how
        often transplants were aborted due to biological testing, or how long each review phase
        takes. Additionally, the NKR does not seem to have clear-cut algorithmic policies on
        how to use bridge donors.            Chains would be indenitely long if bridge donors were
        allowed to initiate new chains forever but too short if bridge donors were not used.
        Although cases of donors reneging are rare (Cowan et al. 2017), platforms try to trans-
        plant bridge donors quickly, to an unpaired patient if necessary, to them.

        We calibrate these parameters by simulating our model to nd values that most closely
        replicate the match probabilities, durations, pool size and chain lengths observed in
        our data. We match average values of each of these variables (except for chain length)
        for altruistic donors, patientdonor pairs, and unpaired patients, each partitioned by
                                             35
        coarse blood type categories.             Moments based on match probabilities and durations
        are motivated by their close relationship to the ow of transplants produced and the
        incentives for hospitals.     Pool size seeks to capture aggregate information about the
        productivity of the NKR. Finally, chain lengths capture the importance of altruistic
        donors.

        Our simulations suggest that the best t to these moments is, for both the acceptance

  34 Failures are recorded by setting c      =0   (see previous footnote) for future iterations if the donor   k   was
                                        jk
refused by patient   j.
  35 In principle, we could have estimated these parameters using simulated minimum distance. However, a
simulation for each parameter value can take weeks, making optimization over the parameter set infeasible.
                                                                                                                          28


         and the biological testing phases, a two-week period and a one-fth failure rate. Reduc-
         ing the failure rates in simulations primarily increases chain length and transplantation
         rates, while reducing the duration of either phase increases the transplantation rates
         without having a large eect on chain length. For the bridge donor policy, we nd that
         a hold period of 30 days best ts the data.


         Details on the t of our calibrated parameters are provided in Appendix D.5.                                  Fur-
         ther, Appendix E repeats all of our analyses under alternative parameters to examine
         robustness of our results.

   4.    Departure:          Patients and donors often depart the NKR without a transplant. A pa-
         tient and his/her associated donor may leave the platform because the patient dies,
         becomes too sick to transplant, or receives a kidney transplant elsewhere. Therefore,
         we need to estimate the probability that a patient or a donor leaves the NKR without
                            36
         a transplant.

         We estimate an exponential hazard model of departures by maximum likelihood, using
         the registration and transplantation dates (if transplanted) for each patient and donor,
         and data on how long the patient or donor was registered in the NKR without a trans-
                   37
         plant.         The departure rates in the model depend on the fraction of donors (patients)
         ever registered with the NKR who are compatible with a patient (donor), blood type,
         and age at registration. Appendix D.2.2 presents the estimates for the model.

This procedure allows us to evaluate a transplant production function for any vector of
inputs       q   by simulating each of these events for each calendar day. Given any initial pool of
patients and donors in the NKR, these simulations generate a Markov chain with a sequence
of registrations, transplants, and departures.                        We initialize the NKR pool with the set of
patients and donors registered on April 1, 2012, and burn-in 2,000 simulation days in each
run. The dependence on the initial pool eventually fades away. We compute the time average
of the total number of transplants to estimate                     f   by
                                                                        T
                                                           1X
                                                  fˆ (q) =       yt ,
                                                           T t=1
  36 Our approach will treat all donor departures as a lost opportunity for a transplant if a better design can
use that donor for a transplant. To validate this assumption, we tried to determine the outcome of paired
patients who leave the NKR without a transplant by matching them to the OPTN data on all living- and
deceased-donor transplants.        Our ability to follow these patients is not perfect, but approximately three-
quarters of patients could be perfectly matched on the HLA-A, B, and DR loci; gender; and blood type.
A majority of patients either remained untransplanted or received a deceased-donor transplant, eectively
crowding out a kidney from another patient. Of those that received a living-donor transplant, most received
direct donations and the vast majority did not utilize a multi-hospital kidney exchange platform. These facts
support our treatment of departures as an appropriate approximation.
  37 Specically, the departure rate for registration        j   is given by   λgj exp (zj β) , where gj denotes whether j is
an altruistic donor, a patientdonor pair, or an unpaired patient;               λgj is a group-specic constant departure
risk;   zj   denotes a vector of characteristics for   j;   and   β    is a conformable vector of coecients. We t with
the censored observations of departure times for each registration in the NKR, where censoring can occur
because we only observe a lower bound for the departure time if                j   was transplanted or remained in the NKR
pool at the end of our sample period.
                                                                                                                       29


where T    is the total number of days simulated and                    yt   is the total number of transplants in
period t   of our simulation. In what follows, we report estimates based on an average of 100
simulations. Standard errors are calculated using the non-overlapping batch means estimator
described in Appendix D.4.




5.2 Returns to scale and misallocation
5.2.1 Returns to scale
We rst document the estimated returns to scale in the transplant production function by
evaluating it for submission vectors               q   with the same composition as the NKR (i.e scalar
multiples of    q 0 ).   We then consider average products, where scale is measured by the total
ow of donors submitted per year, which we denote as                          x(q).    This measure is also the ow
of transplants that a platform could perform if all donors were utilized. Figure 5 plots the
average product measured as             f (q)/x(q).




                               Figure 5: Production Eciency versus Scale

           Notes:   The line plot represents the average product of a kidney exchange platform versus its scale.
           The histogram is based on the estimated scale of various hospitals. The left vertical axis represents
           average products, dened as the share of pairs and altruists who are transplanted. The right vertical
           axis is the scale for the histogram. The horizontal axis represents scale, measured as the yearly arrival
           rate of pairs and altruists. The error bars on the estimated production function show a 95% condence
           interval. The plot uses the baseline parameters and the pool composition from the NKR.



The gure shows that there are increasing returns to scale, but that productivity eventually
plateaus. With a scale of 534 donor arrivals per year, the NKR is well within the region of
                                                                                                              30


                                                 38,39
approximately constant returns to scale.                 The NKR has an average product of 0.51 trans-
plants per donor, which varies only slightly once the scale is suciently large. A platform
that is half the size of NKR has an average product of 0.46 transplants per donor, while
a platform that is double the size has an average product of 0.547 transplants per donor.
Therefore, the market can operate at a high level of eciency even if there are a handful
of competing platforms. These estimates suggest that mergers of suciently large platforms
would have small eects on eciency.

Next, we use these estimates to calculate whether individual-hospital platforms operate at an
ecient scale. Recall that within-hospital transplants collectively account for the majority of
kidney exchanges. A challenge with this exercise is that we observe neither the number nor
the composition of patients and donors available to a hospital. To make progress, assume for
the moment that hospitals have the same production technology and composition as the NKR.
Further, assume that hospitals conducting within-hospital transplants do not participate in
the NKR. Under these assumptions, one can use an individual hospital's observed rate of
                                                                     h
kidney exchange transplants to infer its scale. Specically, let y be the ow of within-
                                                                                           h
hospital kidney exchange transplants conducted at hospital h. We estimate the ow x of
                                                               h
donors available to hospital h as the ow necessary to produce
                                                            y with     the same composition
and technology as the NKR. That is, x solves y = fˆ x ·
                                          h         h        h   q 0
                                                                        , where q 0 is the ow
                                                               x(q 0 )
of submissions received by the NKR. The potential biases and robustness of our results to
altering these assumptions are discussed in Section 5.2.2.

This exercise suggests that almost all individual hospitals operate far below the ecient scale.
The histogram in Figure 5 shows the estimated distribution of hospital scale. The median
hospital has a scale of 9 donor arrivals per year.             The 90th percentile is 27 donor arrivals
per year. The largest, Methodist Hospital in San Antonio, has a scale of 109 donor arrivals
per year. The average product at these scales is 0.16, 0.29 and 0.42 transplants per donor,
respectively.    Thus, at our estimated production function, even the largest single-hospital

  38 The error bars use a non-overlapping batch-means estimator from a simulation of 20,000 periods. These
errors account for sampling variance in the patient and donor registration process, and simulation error in the
transplant proposal, refusal, and departure process, but hold the parameters of the simulation model xed,
ignoring rst-stage estimation error. Accounting for this source of uncertainty is burdensome because we do
not have a closed-form solution for the asymptotic variance of the production function. Moreover, a bootstrap
procedure that simulates the entire production function several times is computationally prohibitive. To assess
whether rst-stage estimation error is important, we simulated the production function at NKR's scale and
composition using ten bootstrapped estimates of hazard rate parameters. The resulting standard error in
the average product across these draws was only 0.01 transplants per donor.
  39 We assessed whether this nding is driven by our approach to calculating the production function by
conducting two complementary exercises. First, we directly investigated the returns to scale at the NKR by
examining the relationship between the number of transplants conducted by the NKR per quarter and the
number of donors submitted per quarter. Our estimates are noisy and do not rule out constant returns to
scale. This nding is not sensitive to other partitions of time or the use of moving averages. Unfortunately,
the variation in the number of donors registered is limited because our registration data starts in April 2012.
Second, we carried out a simplied static simulation of a kidney exchange platform with no matching frictions
and only a few types of pairs. As in Figure 5, the returns to scale rapidly increase and plateau, consistent with
the model in Roth et al. (2007), where the number of transplants produced grows linearly in the platform's
size. Details of our simulation and the descriptive evidence are available upon request.
                                                                                                               31


platform does not operate at an ecient scale.               UNOS and APD both have an estimated
average product of approximately0.40 transplants per donor. Hence, the implied eciency
losses are considerable, even for the largest platform other than the NKR. These results are
consistent with the evidence presented in Section 3.2 that hospitals often perform matches
that are socially inecient and that UNOS and APD are also less ecient than the NKR.



5.2.2 Misallocation: ineciency due to small production scale
We start by using the baseline approach in the previous section to estimate ineciency due
to market fragmentation. That is, we estimate how many additional transplants would be
performed if the entire kidney exchange market functioned at NKR's eciency. We use a
hospital's estimated scale to calculate the dierence in average product between the hospital
and NKR. Because NKR operates at constant returns to scale, this dierence multiplied
by the hospital scale is the total number of transplants that are lost due to the hospital
conducting kidney exchange at an ineciently small scale. The aggregate lost transplants
equals the total deadweight loss because our social welfare function is the total number of
transplants nationwide.         The estimated deadweight loss presented in Table 3 shows that
500.1 transplants are lost per year due to market fragmentation (panel A, column 1). This
number is large relative to the 800 transplants conducted through kidney exchange each year.
Furthermore, the economic value of these lost transplants exceeds $500 million per year based
on the Held et al. (2016) estimates of a transplant's value. The cost savings alone are on the
order of $150 million per year.

This baseline approach is simple but suers from four potential biases. First, the composi-
tion of submissions in hospitals may dier from that of the NKR. We assess robustness to
this assumption by estimating ineciency using patient and donor compositions from three
dierent groups of hospitals: all hospitals (column 1), hospitals in the top quartile of in-
tensive margin participation rate (column 2), and hospitals in the bottom quartile (column
      40
3).        If heterogeneity in participation policies is correlated with composition, then estimates
from a production function using patients and donors from each of these groups helps as-
sess robustness to potential compositional dierences between single-hospital platforms and
the NKR. For example, one hypothesis is that hospitals in the top quartile of participation
should submit a less selected pool if heterogeneity in participation rates is driven primarily
                        41
by hospital policy.          Comparing estimates across these three groups suggests that overall
ineciency exceeds 430 transplants per year under alternative assumptions on composition.

  40 We measure participation rate as donors submitted to NKR divided by donors submitted to NKR plus
donors transplanted in a within-hospital exchange.
  41 Some large hospitals submit most of their pairs to NKR as a matter of policy. Smaller hospitals that have
incurred the costs becoming an NKR member often submit all their patients to the platform because they
have few possibilities of organizing an exchange independently. These facts suggest that the group of hospitals
in the top quartile should submit a less selected pool if heterogeneity in these policies and hospital size is not
correlated with composition. It is also possible that hospitals that participate in the NKR exclusively do so
precisely because they have a particularly hard to match pool. While it is dicult to test these hypotheses
without data on the patients and donors available to a hospital, our data indicate that hospitals with high
NKR participation rates submit easier to match patients in terms of PRA (Figure E16). This limited evidence
points to the former arguments as more important.
                                                                                                            32


Second, our baseline approach assumes that all within-hospital transplants are produced
by hospitals in isolation from the rest of the market.             The bias due to hospitals that also
participate in national platforms does not have a clear direction. We address this issue by
disaggregating the eciency losses by whether a hospital participates in the NKR, APD
or UNOS and by the fraction of the hospital's paired kidney exchanges that are conducted
through the NKR. If we restrict attention to the 96 hospitals that do not participate in NKR,
the eciency loss in column 1 is 243.5 transplants per year (panel C, excluding the NKR row).
Some of these hospitals participate in UNOS or APD and may be producing transplants at a
more ecient scale. Even if we assume that each of the hospitals that participate in UNOS
or APD produce transplants at the estimated scales for the two platforms, we still estimate
                                                                                          42
that the deadweight loss in column 1 would be 143.7 transplants per year.                      However, this
extremely conservative calculation is likely at slack for two reasons. First, even among the
non-NKR hospitals that participate in either UNOS or APD, two-thirds of kidney exchange
transplants are performed within hospital (panel C), while the deadweight loss lower bound of
143.7 assumes that all transplants are produced at the APD/UNOS scale. Second, it ignores
deadweight loss from hospitals that participate in NKR. Among the set of NKR participants,
just the 17 hospitals in the lowest quartile of fraction of transplants performed in NKR
contribute an eciency loss of 103.1 transplants per year (panel D). In summary, despite
potential bias due to some hospitals participating in large platforms, this decomposition
suggests that a loss of 240 transplants per year is a conservative estimate for the costs of
market fragmentation.

Third, hospitals may use a dierent matching technology than the NKR. For example, Binga-
man et al. (2012) reports that Methodist Hospital in San Antonio, which is now perhaps the
most sophisticated single-hospital program, initially used a Microsoft Access Database and
that their algorithm was stratied by ABO compatibility and then by HLA compatibility.
                                                                                                            43
Such algorithms are less ecient than the linear-programming algorithms used by the NKR.
On the other hand, single-hospital programs face simpler logistical constraints, which may
increase their productivity vis-à-vis our estimates. The direction of this bias is not unambigu-
ous, but it is more likely that single-hospital platforms are less ecient than our estimated
                        44
production function.

Fourth, these exercises keep the set of patients and donors interested in kidney exchange
xed. However, this ow is endogenous and aects the magnitude of the deadweight loss.
Although the direction of this bias is ambiguous, our baseline approach likely yields a con-
servative estimate of overall market ineciency. The most likely bias comes from hospitals
valuing transplants at less than the social value and, due to administrative costs, expending
ineciently low eort in recruiting patients and donors. If incentives were optimal, hospitals

  42 The deadweight loss from hospitals that do not participate in any of the three national platforms alone is
125.6 transplants per year. For hospitals that participate only in UNOS or APD, this gure is 18.1 transplants
per year, assuming that all kidney exchange transplants from these hospitals are produced at the scale of the
platform in which they participate.
  43 In 2013, Methodist Hospital in San Antonio adopted software written by one of us (Ashlagi).
  44 See Agarwal et al. (2018) for an analysis of how various logistics inuence the productivity of a kidney
exchange platform. NKR's practices are optimized to maximize the number of transplants given the available
patients and donors.
                                                                                                                                      33


                                         Table 3: Total Eciency Loss



                                                                Within Hospital Kidney                  Efficiency Loss
                          Number of      Kidney Exchange
                                                                Exchange Transplants
                          Hospitals    Transplants Per Year                                  Additional Kidney Exchange Transplants
                                                                       Per Year
                                                                                              (1)            (2)            (3)

                                                                    Panel A: All Hospitals
       All Hospitals         164              800.5                    465.4                 500.1          432.4          644.7

                                                      Panel B: By hospital size (number of PKEs per year)
       Top Quartile          42               598.8                     358.3                257.1          213.5          343.1
       2nd Quartile          48               143.2                      73.4                139.7          122.2          169.7
       3rd Quartile          40                45.7                      27.7                76.6            73.4          101.0
       Bottom Quartile       34                12.7                       6.0                26.8            23.4          31.0

                                                              Panel C: By Platform Membership
       NKR                   68               580.5                    297.2             256.6              217.7          335.5
       Only UNOS or APD      45               133.0                     90.7             117.9              101.9          149.8
       None                  51                86.9                     77.6             125.6              112.8          159.4

                                      Panel D: By NKR Participation Rate (Fraction of PKEs facilitated through the NKR)
       Top Quartile          17               65.2                      8.2                16.9             15.5           21.5
       2nd Quartile          17              102.3                     27.0                47.9             42.9           60.0
       3rd Quartile          17              196.7                     98.2                88.7             75.7           114.6
       Bottom Quartile       17              216.2                    163.8               103.1             83.6           139.4




           Notes: Column 1 assumes that the typical transplant hospital has a composition of patientdonor pairs
           and altruistic donors given by the average registration in the NKR. Column 2 assumes a composition
           based on hospitals in the top quartile of NKR participation. Column 3 assumes a composition based
           on hospitals in the lowest quartile of participation rate. Transplants per year is calculated using data
           between April 1, 2012 and December 4, 2014.




might try to recruit moreand more valuabledonors into kidney exchange. Our approach
does not account for this margin because we do not observe recruitment eorts; therefore,
we are likely to underestimate overall market ineciency.

Table 3 also points to which types of hospitals produce most of the ineciency. Consider
column 1 and, for the purposes of this decomposition, ignore the biases discussed above.
Even though they perform internal exchanges more eciently, large hospitals account for
most of the ineciency because their market share is higher (panel B). Indeed, 51.4% of the
losses come from hospitals that have a number of kidney exchange transplants in the top
quartile. Moreover, both the intensive and extensive margins of participation are important.
A little less than half of the eciency losses are due to hospitals that do not participate in the
NKR at all, and a quarter are from hospitals that do not participate in any of the national
platforms (panel C). Among hospitals that do participate in the NKR, a large share of the
eciency loss is due to the hospitals with low participation (panel D).

To summarize, although the baseline estimate of 500.1 lost transplants is potentially biased,
a battery of robustness exercises suggest the deadweight loss from market fragmentation is
at least 240 transplants a year. Additionally, these estimates do not appear to be driven by
compositional dierences in the kidney exchange pool. Table E9 in Appendix E further eval-
uates these results' robustness to alternative choices for the production function parameters
that were calibrated. Across various specications, we continue to nd that an estimated 240
lost transplants is conservative.
                                                                                                   34


These results are consistent with our descriptive nding that hospitals often perform ine-
cient matches, and they are robust to moderately large levels of misspecication. Even the
most conservative estimates are signicant because the baseline estimates suggest ineciency
of 63% of the market size. The robustness of the shape of the production function is driven,
in large part, by basic biological compatibility constraints. Finding matches is hard with few
patients and donors because of both blood-type and tissue-type compatibility constraints.
And, as suggested in the large market limit of Roth et al. (2007), tissue-type compatibility
constraints become less of a barrier in a large market.




5.3 Ineciency of current mechanisms
Theorem 1 shows that optimal rewards are approximately equal to marginal products. That
  p∗ = ∇f (q ∗ ) − A (q ∗ ), where q ∗ and p∗ are the aggregate quantities and rewards that
is,
maximize hospital welfare. We will test this equality at the aggregate supply and rewards in
our data.

Current rewards,   p0 ,   equal the probabilities of matching for each kind of submission. These
probabilities can be easily estimated from our simulations, and the estimated probabilities
closely match those from the data (see Appendix D.5). Marginal products,          ∇f (q 0 ), can be
estimated by numerically dierentiating the production function.          In principle, calculating
the adjustment term requires estimates of the supply elasticity matrix, which is not feasible
with our data. But, the adjustment term is small because returns to scale are approximately
constant for NKR's size. Therefore, optimal rewards are approximately equal to marginal
products. Formally, Theorem 1 implies that the quantity-weighted average of the adjustment
term is given by
                                    A (q) · q   ∇f (q) · q f (q)
                                              =           −      .
                                     kqk1        kqk1       kqk1
That is, the average level of shading equals the dierence between the average marginal
product and the average product.           Evaluating this formula using using the estimated pro-
duction function and numerical derivatives for each of the 1930 submission types yields an
                                 −4
average shading of only 2.16 × 10   transplants per submission. In what follows, we simply
approximate optimal rewards with marginal products.

Figure 6 plots current rewards (the probabilities of matching,         p0 ) versus optimal rewards
(marginal products,       ∇f (q 0 )).   Following Roth et al. (2007), the patient and donor cate-
gories are aggregated by under-demanded, over-demanded, and self-demanded types, split
by sensitization level.

The marginal products are qualitatively similar to the Roth et al. (2007) theoretical predic-
tions discussed in Section 2. The marginal product of an under-demanded pair is             0,   both
in our estimates and in the model. The estimates dier for other types. For example, the
marginal product of an over-demanded pair with low sensitization is         2   transplants per sub-
mission in the Roth et al. (2007) model, but 1.34 transplants per submission in our estimates.
One reason for this dierence is that, in our data, these pairs are only matched with proba-
bility 0.80. Our empirical model also renes the predictions from the theoretical models by
                                                                                                                                       35


                                1.00



                                                             ●                      ●
                                0.75                                                                       Category
                                                                                                           ●   Altruist non−O
                                                                                                           ●   Altruist O
            Match Probability                                                                              ●   Overdemanded
                                                                                                           ●   Selfdemanded
                                                                                                           ●   Underdemanded
                                                                                                           ●   Unpaired
                                0.50
                                                                                                           PRA
                                                                                                               [0,10)
                                         ● ●                                                               ●   [10,90)
                                                                                                               [90,100]
                                0.25                                                                           Altruist




                                0.00
                                         0.0           0.5              1.0             1.5        2.0
                                                                 Marginal Product


         Figure 6: Private versus Socially Optimal Rewards for Submission Types

         Notes:                   The vertical axis is the probability of a submission being matched, which are the private
         rewards that hospitals receive according to current exchange rules.                  The horizontal axis plots the
         marginal product of a submission (in transplants per submission), which equals the social contribution
         of the submission in terms of transplants. Matching probabilities and marginal products are calculated
         in the baseline simulation.




showing how marginal products vary with sensitization. For example, the marginal products
of over-demanded and self-demanded pairs are considerably lower if these pairs are sensitized.
These ner results can be important when designing practical mechanisms.

The gure shows a large wedge between current and optimal rewards.                                              If current rewards
were optimal, all points on these two gures would be on the 45-degree line.                                                    Altruistic
donors and over-demanded pairs with low PRA are far below this line. Over-demanded pairs
with low sensitization have marginal products of 1.34 transplants per submission, but the
probability of matching them is only 0.80. Even more extreme, altruistic O donors have a
marginal product of 1.74 transplants per submission, but their probability of matching is only
0.93. Therefore, hospitals are not rewarded enough for submitting these types, which may
explain why we see relatively few of them submitted to the NKR. Other submission types are
drastically overpriced. Under-demanded pairs with low sensitization have marginal products
of approximately 0.05 transplants per submission but have a probability of being matched
of around 0.36.                        Similarly, unpaired patients have low marginal products but a signicant
probability of being matched.                          These dierences suggest the platform can do considerably
better by increasing rewards to the productive and undervalued submissions while reducing
rewards to the unproductive submissions.

These marginal products are of independent interest as well.                                      For example, Sönmez et al.
(2018) analyzes policies that incentivize compatible pairs to join the platform by prioritizing
patients on the deceased donor list in case they need a second transplant in the future. While
we cannot directly compute the value of a compatible pair using the NKR data, such pairs
are most similar to over-demanded or self-demanded pairs with low PRA patients. Indeed,
                                                                                                        36


                                                                                   45
our results indicate that these pairs have the highest marginal products.               Another result of
interest to a platform is that altruistic donors have a marginal product that is much lower
than the length of a typical chain, which is four. This is because many patients transplanted
through a chain could have otherwise been transplanted through a cycle.




6      Discussion
6.1 Implementing a point mechanism
Theorem 1 and the small magnitude of the adjustment term                 A(q)   suggest that platforms
should set rewards close to marginal products.           We will now show that marginal products
are highly predictable using a small number of patient and donor categories. Then, we will
discuss the design of point mechanisms that are both approximately ecient and simple
enough for practical application.

We use a regression tree to construct categories that best predict marginal products, allow-
ing for the tree to depend on the patient's PRA, submission type (altruistic, patientdonor
pair, unpaired patient), and blood type. Figure 7 shows the categories found by a standard
algorithm for nding the best cross-validated predictor for the marginal products. These cate-
gories are intuitive, as they split submissions based primarily on submission type, whether the
patient/donor is blood type O, and immune sensitivity. The within-category mean marginal
products, ∇f , and probabilities of matching, p0 , are dispersed relative to the (appropri-
ately shrunk) within-category standard deviation. This suggests that marginal products and
probabilities of matching are approximated with a small number of categories.

A mechanism that assigns points to a hospital based on these categories can be explained to
participants with this tree or a simple table (see Appendix Table D8). One implementation
of the mechanism is as follows. Each time the hospital conducts a transplant for one of its
patients, a point is subtracted from its account. Points are awarded when a submission is
transplanted, since awarding them at time of submission creates an incentive for shill sub-
missions. To account for the chance a submission is not transplanted, the marginal products
should be divided by the probability of matching, p0 , to give the appropriate incentives in
                                            ∗
expectation. These rewards are denoted by r in Figure 7.

While our analysis suggests that a low-dimensional point mechanism would likely achieve
substantial eciency gains, it abstracts away from several implementation issues. For exam-
ple, our simplied steady-state model does not specify an extensive-form game, and hence it
cannot be used to fully specify optimal mechanisms or to evaluate them. This raises practical
and theoretical questions about how to design and implement a dynamic points mechanism.
While resolving these details is beyond our present scope, we discuss some of the issues.

    45 The average marginal product of self-demanded pairs with PRA less than 50 is 0.74 transplants per
submission and the average match probability is 0.83. Over-demanded types with PRA less than 50 have an
average marginal product of 1.35 transplants per submission and an average match probability of 0.82. These
marginal products may dier from those of compatible pairs because a patient with a compatible donor may
be more selective than incompatible pairs.
                                                                                                                                                                                                                              37




                                                                                                                          Pairs



                                                                                                                                                                                                     Unpaired
                  Altruists                                                               O Patient                                                  Non-O Patient
                                                                                                                                                                                                     Patients




                                                                            O Donor                                                        PRA < 95
                                                                                                                                                                                                         Unpaired
   O Donor                   Non-O Donor                                                                                                                                                                  Patient
    N = 62                     N = 102                                                                                                                                                                   N = 501




                                                            PRA >= 89           PRA < 89            Non-O Donor              O Donor            Non-O Donor          PRA >= 95
                                                             N = 104             N = 135              N = 502                N = 102              N = 284             N = 138




           mean std                    mean std                     mean std            mean std              mean std              mean std             mean std            mean std                            mean std

   p0      0.93 0.00           p0      0.84 0.04            p0      0.30 0.22   p0      0.79 0.01     p0      0.27 0.16     p0      0.82 0.01    p0      0.85 0.03   p0      0.31 0.23               p0          0.22 0.11

   ∇f      1.74 0.11           ∇f      0.86 0.20            ∇f      0.14 0.21   ∇f      0.67 0.20     ∇f      0.02 0.18     ∇f      1.24 0.29    ∇f      0.67 0.24   ∇f      0.09 0.21               ∇f          -0.03 0.16

                                                                    -0.51               -0.15                 -0.91                 0.52                                     -0.71                               -1.13
       ∗                           ∗                            ∗                   ∗                     ∗                     ∗                    ∗                   ∗                                   ∗
   r       1.88                r       1.02                 r                   r                     r                     r                    r       -0.21       r                                   r




                                                   Figure 7: Regression Tree for Marginal Products

                       Notes: Categories are determined by regression tree analysis to predict marginal products as a function
                       of whether a submission is a pair, an altruistic donor, or an unpaired patient; blood types; and
                       the patient's PRA. Our procedure followed standard recommendations in Friedman et al. (2001).
                       Specically, we used 10-fold cross-validation to pick the penalty parameter on the number of nodes,
                       required each leaf to have at least 20 observations, and pruned a leaf if it did not increase the overall t
                       by at least 2%. Standard errors for the simulations are calculated by following Chapter 12 of Robert
                       and Casella (2004).            The within-category standard deviation is estimated using shrinkage methods
                       recommended in Morris (1983). The match probabilities in the current mechanism are denoted by                                                                              p0 ,
                       the marginal products are denoted by                       ∇f , and the optimal rewards at transplantation                                                        are denoted
                       by   r∗ .       We calculate   r∗   by dividing          ∇f by p0 , component-wise, and then subtracting 1                                                        for all types
                       except altruistic donors.




In both theory and practice, the point system described above is a natural mechanism for
solving this problem. The dynamic mechanism design literature calls such a system a chip,
scrip, or token mechanism. Relevant papers include Möbius (2001), Hauser and Hopenhayn
(2008), and Abdulkadiro§lu and Bagwell (2013), which consider dynamic favor exchange, and
Guo and Hörner (2015), which considers provision of goods to a consumer with stochastic
valuations. The general nding of this literature is that token mechanisms, as proposed in
Möbius (2001), do better than autarky but not as well as an optimal dynamic mechanism.
In fact, token mechanisms are close to rst-best if players are patient and there are many
time periods.                           Results in Jackson and Sonnenschein (2007) imply that the ineciency of
token mechanisms declines as the square root of the number of periods (see also Guo and
Hörner 2015). Thus, the theoretical literature suggests that point systems, while not exactly
optimal, are simple and achieve a high level of eciency.

Another motivation for using a point mechanism is its simplicity and similarity to at money.
                                                                                                           38


Similar mechanisms have been previously used in market design applications. For example,
Prendergast (2017) describes how a similar mechanism was used to increase the eciency of
food distribution across food banks.

An important issue with point systems is that they require several plumbing decisions
(Duo 2017). Should the matching algorithm impose a strict bound on negative balances?
If so, what is the optimal minimum balance constraint? A tight constraint provides stronger
incentives to hospitals but prior theory suggests that it may reduce eciency (Möbius 2001;
                                             46
Friedman et al. 2006; Kash et al. 2007).          How often should marginal products be recalculated
as the composition of patients and donors in the platform changes? Recalculating them often
is complex and reduces transparency, but recalculating infrequently can reduce eciency if
changes in composition aect marginal products. An analysis of this issue requires a non-
steady state dynamic model. However, previous work on kidney exchange and experiments
with our simulations suggest that marginal products are not sensitive to the distribution of
types. For example, marginal products are constant for a wide range of type compositions
in the theoretical model of Roth et al. (2007).

As in other market design applications, it is important to consider whether a proposed
system is fair and ethically compelling (Roth 2007; Kominers et al. 2017; Li 2017).                     It is
important to clarify that a points system involves no use of monetary payments to donors.
Fundamentally, the point system ensures that, in the long run, the contributions of each
hospital to the exchange are commensurate with the transplants performed. Nonetheless, in
practice, legal clarication with respect to the National Organ Transplantation Act of 1984
                                                                                     47
and careful explanation of the system to participants may be necessary.



6.2 Importance of each market failure
The misallocation analysis of Section 5.2.2 yields a conservative lower bound for the dead-
weight loss of about 240 transplants per year, or 30% of the market. The true deadweight
loss is potentially much larger, as most specications yield numbers approximately twice as
large.   Therefore, it must be the case that at least one of the two market failures (ine-
cient platform incentives and agency problems) is quantitatively important. We now report
suggestive evidence that both market failures are important.

  46 In models where agents can exchange favors over time through a scrip currency, for any amount of
scrip per capita, with suciently patient players, there are ecient equilibria with a high level of exchange.
However, for a xed discount factor, increasing the amount of scrip only increases eciency up to a point
too much scrip leads to inecient equilibria with no exchange. Similarly, Möbius (2001), shows that token
mechanisms with less restrictive budget constraints are more ecient, but that these budget constraints must
be suciently strict relative to the level of impatience in order to give agents incentives to provide favors.
These results suggest that it is important to give participants incentive to trade favors, but that as long as
this constraint is satised, it is more ecient to have point mechanisms with more exible budget constrants.
In kidney exchange, there are often a large number of dierent maximum cardinality matches, because of the
large number of under-demanded pairs. This suggests that eciency may not be severely compromised even
if budget constraints are strict.
  47 There are two reasons to believe that a points mechanism would be well-received. First, previous NKR
experimentation with the concept was found to be acceptable in practice. Second, we have discussed this
issue with a few kidney exchange platforms, and all feel that a points mechanism is acceptable.
                                                                                                            39


Appendix A.1 shows that the deadweight loss from inecient platform incentives is given
by a multidimensional version of the Harberger triangle formula. We cannot calculate this
deadweight loss because we do not have data to reliably estimate the elasticity of hospital
supply.    Nevertheless, the large wedge between the current private and social incentives
suggests the deadweight loss is signicant unless the supply elasticity is extremely small.

To formalize this point, Appendix A.1 estimates the deadweight loss in hospital welfare under
dierent assumptions on supply elasticities.           We calculated the worst-case deadweight loss
given a maximum bound on own elaticity. With own elasticities bounded by 2, the deadweight
loss is over 40 transplants per year.         With own elasticities bounded by 6, the deadweight
loss is as high as 100 transplants per year. These estimates are robust to assumptions on
cross-elasticities. Because hospitals undervalue transplants if agency problems are important,
the loss in social welfare is considerably larger. Specically, if hospital costs are ignored, we
estimate a loss in social welfare of at least 55 transplants per year and at most 120 transplants
per year for elasticities between 2 and 6.

These results suggest that addressing inecient platform incentives has a signicant positive
impact unless supply is extremely inelastic. The evidence in Section 3 is typical of markets
with elastic supply: most hospitals only register a subset of their patients with the NKR,
and many other hospitals do not participate. Both facts are consistent with many hospitals
being on the margin, suggesting that hospitals respond to incentives and that supply is at
                             48
least moderately elastic.

Moreover, the results also imply that agency problems are important unless supply is ex-
tremely elastic. Under the hypothesis that there are no agency problems, hospital welfare
equals social welfare, and the optimal mechanism reaches rst-best (Theorem 1). Thus, the
total deadweight loss in the misallocation analysis must be completely accounted for by the
deadweight loss from the Harberger triangle analysis. Yet, even for a high elasticity bound of
6, our social deadweight loss estimate is at most 120 transplants per year. This is still below
our lower bound result of 240 from the misallocation analysis. The only way these estimates
can overlap is if we have high elasticities and our rst-order approximation of deadweight loss
is signicantly downward biased. Thus, attributing all the deadweight loss to inecient plat-
form incentives requires that supply is very elastic, our approximation is suciently convex,
and the downward bias in the estimated lower bound on ineciency is small.

While the quantitative magnitudes should be interpreted carefully due to data limitations,
the upshot is that policies that address either market failure are likely to be valuable and
generate gains on the order of hundreds of transplants per year. But, implementing optimal
rewards alone will not eliminate most of the ineciency. Proposition A.2 in Appendix A.2

  48 Additionally, Ellison (2014) surveys transplant coordinators and nds three pieces of qualitative evidence
that suggest that elasticities are not low. First, hassle costs are an often cited reason for not participating
in kidney exchange platforms. Second, many transplant coordinators carefully consider whether to submit
particular pairs to a platform and which platforms to partner with, which suggests that many decisions are be
marginal. Third, coordinators often mention that the time exchanges take to transplant patients is a major
concern.   Because time to transplant depends on the ow of transplants, it is closely related to matching
probabilities in the current mechanism. This evidence suggests that coordinators are sensitive to changes in
rewards.
                                                                                              40


formally shows that, typically, the platform does not produce enough transplants to correct
for agency problems.




6.3 Mandate
The previous subsection showed that agency problems appear to be rst order.         Hence, a
points system of the sort described in Secition 6.1 should be complemented by subsidies
for platform participation. An alternative to this two-pronged approach is a mandate that
requires hospitals to perform all kidney exchanges in large, national platforms. Indeed, par-
ticipation in a single national platform is required in the United Kingdom, the Netherlands,
and Canada (Johnson et al. 2008; de Klerk et al. 2005; Malik and Cole 2014). A perfectly
enforced mandate achieves the rst-best welfare if all hospitals and platforms have the same
production function, and that function exhibits (weakly) increasing returns to scale. While
design details of a mandate are beyond the scope of our paper, we now consider four basic
issues.

First, there are dierent types of mandate, with dierent welfare impacts. One form requires
all hospitals to participate fully in one of several national platforms. A more heavy-handed
mandate could also require existing national platforms to merge into a single platform. Our
results suggest that most of the gains would come from the lighter regulation, since returns to
scale are constant once a platform has reached NKR's size. Using the baseline approach from
Section 5.2, we estimate that the yearly ow of donors in the US kidney exchange market is
1840 (ranging from 1711 to 2115 if we vary the assumptions used in Table 3 to estimate a
hospital's scale). These estimates are between three and four times the current NKR scale.
Even at four times NKR's scale, the average product of a monopoly kidney exchange with
NKR's composition is 0.555 transplants per donor. If instead, there were two platforms twice
the size of the NKR, the average product of each would be 0.547 transplants per donor. Both
of these estimates are not much larger than the current average product of 0.51 transplants
per donor. The gains of mandating a single platform instead of a having a few are minimal.

Second, a mandate might dull competition across platforms, slowing the pace of innovation.
The history of kidney exchange has several examples of important innovations, such as the
widespread use of altruistic pairs in non-simultaneous chains (Rees et al. 2009); global kidney
exchange (Rees et al. 2017); voucher programs to encourage donation by giving future priority
(Veale et al. 2017; Wall et al. 2017); and improved operational procedures and matching
algorithms (Anderson et al. 2015). These innovations weigh in favor of preserving a market
structure with multiple platforms, especially since the eciency cost of doing so is small.

Third, there is the issue of enforcement. Hospitals could dodge a ban on internal exchanges
by reporting them as direct donations.    But, even if such a ban were possible, a mandate
could have unintended consequences. For instance, it could reduce hospital eort to recruit
patients, or in extreme cases, move patients from being transplanted internally to not being
transplanted at all.  To see how this is possible, consider a model similar to the one in
                                                                             h
Section 4 with a single type of submission. Hospital h has a ow of pairs, q̄ , of which it
                                      h
can internally transplant a fraction t . Through the platform, the per-transplant reward is
                                                                                                                                                  41


p, which is also the fraction of submissions that get transplanted.                                           The average cost of a
               h                                        h
submission is k dollars, and transplants are valued at v dollars.

First, consider hospital behavior without a mandate, as in Section 4. Hospital decisions are
driven by the (transplant-denominated) private cost,

                                                                         
                                      h   h                  th + k h /v h · q h        if   q h ≤ q̄ h ,
                                     C (q ) =
                                                                    ∞                   if   q h > q̄ h .

Therefore, hospital       h     submits all its pairs to the platform if                           p > th + k h /v h ;           otherwise, it
transplants all pairs internally.

Now, consider a mandate that prohibits hospitals from performing internal transplants, but
that cannot force hospitals to submit their pairs. The eect of this policy is to reduce the
                                        h
opportunity cost of a submission by t . This leads hospital h to submit all pairs to the
                 h  h
platform if p > k /v ; otherwise, it performs                          .no kidney exchanges at all
                                                                         49



Although the stark predictions on hospital behavior are driven by the stylized assumptions,
the example illustrates two points. First, enforceability is important. This goes beyond the
                                                                                                                                                  50
ability to ban internal exchanges, especially if referrals and patient recruiting are important.
Second, mandates can be complementary to other policies. In the example, subsidies to
                             h
kidney exchange could lower k enough to ensure that hospitals submit all pairs, which
would allow the mandate to achieve rst-best welfare.

Finally, a mandate poses political challenges: it would likely require an act of Congress, and a
regulator would have to decide which platform(s) to authorize. All of the currently operating
national platforms are private entities, and in fact, only UNOS, the smallest of the three, is
formally linked with the US government.

     49 As an illustration, consider the case where the platform can transplant half of pairs (i.e.,                                 p = 0.5,
approximately NKR's average product), hospital                   h   can internally match 30% of pairs (i.e.,                th = 0.3), and its
value for a transplant is      v h = $50, 000.   Then, without the mandate, hospital                   h will submit all pairs to the
platform if its cost of submission is less than $10,000 (i.e., when                    k h < (p − th ) · v h ). With the mandate, this
threshold increases to $25,000 (i.e.,     p · v h ).     Therefore, if hospital        h's submission cost is less than $10,000, the
mandate makes no dierence. If hospital                h's   submission cost is between $10,000 and $25,000, the mandate
causes it to submit pairs to the platform that it would have otherwise transplanted internally, improving
welfare.    But, if hospital   h's   submission cost is greater than $25,000, the mandate results in the hospital
doing no kidney exchange transplants whatsoever,                     reducing   welfare.
     50 Consider a variation of the example above in which hospital                      h   gets a ow      (1 − rh )q̄ h   of pairs actively
                                               h h
seeking kidney exchange, and a ow            r q̄       of pairs that can be recruited to participate in kidney exchange,
but only if the hospital expends eort. Assume a mandate that sees all pairs that ultimately come to the
hospital and requires them to be submitted. Let                      ph < k h /v h ,   so that hospital       h   prefers to submit as few
pairs as possible. Without a mandate, hospital                  h    would have recruited         q̄ h   pairs and transplanted       th · q̄ h   of
                                                                                                                             h   h
them. With the mandate, the hospital does not recruit, and the platform arranges    p(1 − r )q̄ transplants.
                                      h   h h                                                   h      h
Hence, the mandate produces (p − p · r − t )q̄ more transplants, which is only positive if 1 − t /p > r , that
is, if the fraction of pairs that require recruitment is less than one minus the ratio of hospital and platform
productivity.
                                                                                                           42


7       Conclusion
Kidney exchange improves a patient's quality of life and extends life expectancy while reduc-
ing costs. We demonstrate that fragmentation in the US market results in an eciency loss
of between 30 and 63 percent of the roughly 800 kidney exchange transplants performed per
year, implying a waste of hundreds of transplants per year.

The ineciency arises from two standard market failures.                 First, platforms use inecient
mechanisms that do not reward hospitals according to the marginal products of their contri-
butions. This induces hospitals to perform inecient within-hospital matches, even if hos-
pitals solely maximize the welfare of their own patients. Second, there are agency problems
                                                                                                           51
that make hospitals too sensitive to the costs of participating in kidney exchange platforms.
Our analysis shows that both market failures are likely important.

These ndings have both short-term policy implications and broader implications for the
design of kidney exchange markets.            There are two short-term policy implications.            First,
there could be returns to existing platforms experimenting with point systems. Such systems
can be implemented by individual platforms, and doing so will likely help them expand.
Second, third-party payers should consider subsidizing kidney exchange at platforms.                      We
argued that hospitals are likely responsive to the cost of participating in kidney exchange
platforms, a behavior that leads to signicant welfare loss.               Subsidies from Medicare and
private payers could mitigate this problem. Moreover, our analysis suggests that this two-
pronged approach, which addresses the two market failures separately, is likely to be more
robust than approaches that address both market failures simultaneously.

Consistent with our results, there are initiatives moving in the direction of these policy
changes. The NKR recently started experimenting with a points system through their Center
Liquidity Contribution Program. Some private insurers have started covering the costs of
participating in kidney exchange platforms. Our results indicate that there could be large
gains from continuing to move in this direction. Further, all platforms could use data-driven
rewards system. Future research can contribute to the design and evaluation of these policies.

The kidney exchange market currently represents 15% of all living-donor kidney transplants.
Therefore, kidney exchange is important in absolute terms, but is presently small relative
to the total shortage of organs discussed in Becker and Elias (2007).                  There are ongoing
eorts in expanding the set of patients and donors participating in this market. For example,
Mathur et al. (2018) reports on the eorts of the National Living Donor Assistance Center
to reduce the nancial burden on donors by reimbursing some of the costs of donating an
organ; Sönmez et al. (2018) proposes incentives for compatible pairs to join kidney exchange
platforms; and Nikzad et al. (2017) reports on eorts for expanding kidney exchange to a
global scale. The designs suggested by our analysis are complementary to these innovations
because xing the market failures identied above makes better use of the available donors.

    51 This decomposition of market failure sources is consistent with long-standing concerns of surgeons, in-
surers, platforms, and researchers, and with recent policy changes. Roth et al. (2005) and Ashlagi and Roth
(2014) recognized that hospitals may have incentives to match patients internally in static models. Surgeons
and insurers have noted that it may be in the interest of insurers to subsidize exchanges and have proposed
that they do so (Rees et al. 2012).
                                                                                            43


Alternatively, a participation mandate might increase welfare under certain assumptions.
And, the mandate can be simpler than the short-run policies that we discussed, even though
it may be politically more dicult to implement.     The United Kingdom, the Netherlands,
and Canada have mandated participation in a single national program (Johnson et al. 2008;
de Klerk et al. 2005; Malik and Cole 2014). One concern is that mandating participation in
a single platform can reduce competition between platforms, which has arguably contributed
to innovation. However, our estimates indicate that it would be close to ecient to have a
few large platforms in the United States, because most of the potential eciency gain would
come from moving the market from individual hospitals to national platforms, rather than
merging the largest platforms.

Although our study focuses on the US kidney exchange market, similar market failures arise
when countries with independent kidney exchange platforms try to arrange cross-border
exchanges.     Such arrangements are being made between the Czech Republic and Austria
                                                                 52
(Böhmig et al. 2017) and between Italy, Spain and Portugal.           In the latter case, these
countries rst matched their patients and donors internally before attempting to cooperate.
This problem bears resemblance to fragmentation in the US system, suggesting that our
insights on returns to scale and optimal rewards may be useful more broadly.




References
Abdulkadiro§lu, Atila and Kyle Bagwell, Trust, Reciprocity, and Favors in Cooperative
  Relationships,   American Economic Journal: Microeconomics, 2013, 5 (2), 213259.
Abraham, David J., Avrim Blum, and Tuomas Sandholm, Clearing Algorithms for
  Barter Exchange Markets: Enabling Nationwide Kidney Exchanges, in Proceedings of
  the 8th ACM conference on Electronic Commerce ACM 2007, pp. 295304.


Agarwal, Nikhil, Itai Ashlagi, Eduardo Azevedo, Clayton Featherstone, and
 Ömer Karaduman, What Matters for the Productivity of Kidney Exchange?, AEA
  Papers & Proceedings, 2018, 108.
American Society of Transplant Surgeons,  Kidney Paired Donation:            Community Per-
  spectives and Best Practices, 2016.


Anderson, Ross, Itai Ashlagi, David Gamarnik, and Yash Kanoria,                   A Dynamic
  Model of Barter Exchange, in Proceedings of the Twenty-Sixth Annual ACM-SIAM Sym-
  posium on Discrete Algorithms SIAM 2014, pp. 19251933.


  ,       ,   , Michael Rees, Alvin E. Roth, Tayfun Sönmez, and M. Utku Ünver,
  Kidney Exchange and the Alliance for Paired Donation: Operations Research Changes
  the Way Kidneys Are Transplanted,     Interfaces, 2015, 45 (1), 2642.
 52 See     http://ekha.eu/blog/italy-and-spain-achieve-first-international-cross-kidney-
transplantation/.
                                                                                               44


Arrow, Kenneth,         Uncertainty and the Welfare Economics of Medical Care,        American
  Economic Review, 1963, 53 (5), 941973.
Ashlagi, Itai and Alvin E. Roth, Free Riding and Participation in Large Scale, Multi-
  Hospital Kidney Exchange,         Theoretical Economics, 2014, 9 (3), 817863.
  , Maximillien Burq, Patrick Jaillet, and Vahideh Manshadi,                  On Matching and
  Thickness in Heterogeneous Dynamic Markets,          arXiv preprint arXiv:1606.03626, 2016.
Bartelsman, Eric J. and Mark Doms, Understanding Productivity:                Lessons from Lon-
  gitudinal Microdata,        Journal of Economic Literature, September 2000, 38 (3), 569594.
Becker, Gary S. and Julio Jorge Elias, Introducing Incentives in the Market for Live
  and Cadaveric Organ Donations,         Journal of Economic Perspectives, 2007, 21 (3), 324.
Bingaman, A.W., F.H. Wright, Jr., M. Kapturczak, L. Shen, S. Vick, and C.L.
  Murphey, Single-Center Kidney Paired Donation: The Methodist San Antonio Experi-
  ence,    American Journal of Transplantation, 2012, 12 (8), 21252132.
Böhmig, Georg A., Ji°í Fronek, Antonij Slavcev, Gottfried F. Fischer, Gabriela
 Berlakovich, and Ondrej Viklicky, Czech-Austrian kidney paired donation: rst Eu-
  ropean cross-border living donor kidney exchange,       Transplant International, 2017, 30 (6),
  638639.


Boiteux, Marcel,        Sur la Gestion des Monopoles Publics Astreints à l'Équilibre Budgé-
  taire,   Econometrica, 1956, 24 (1), 2240.
Chandra, Amitabh and Jonathan Skinner,                    Technology Growth and Expenditure
  Growth in Health Care,         Journal of Economic Literature, 2012, 50 (3), 645680.
Chenery, Hollis B., Engineering Production Functions, Quarterly Journal of Economics,
  1949,     63 (4), 507531.
Clemens, Jerey and Joshua D. Gottlieb, Do Physicians' Financial Incentives Aect
  Medical Treatment and Patient Health?,         American Economic Review, 2014, 104 (4).
Cowan, Nigel C., H. A. Gritsch, Nima Nassiri, Joseph Sinacore, and Jerey L.
 Veale, Broken Chains and Reneging: A Review of 1748 Kidney Paired Donation Trans-
  plants.,    American Journal of Transplantation, 2017, 17 9, 24512457.
Danovitch, Gabriel M., Handbook of Kidney Transplantation,                Lippincott Williams &
  Wilkins, 2009.


de Klerk, Marry, Karin M. Keizer, Frans H.J. Claas, Marian Witvliet,
  Bernadette J.J.M. Haase-Kromwijk, and Willem Weimar, The Dutch National
  Living Donor Kidney Exchange Program,           American Journal of Transplantation,    2005,   5
  (9), 23022305.
                                                                                             45


Dickerson, John P., Ariel D. Procaccia, and Tuomas Sandholm, Dynamic Matching
  via Weighted Myopia with Application to Kidney Exchange, in AAAI 2012.


Duo, Esther, Richard T. Ely Lecture:       The Economist as Plumber,    American Economic
  Review, 2017, 107 (5), 126.
Ellison, Blake, A Systematic Review of Kidney Paired Donation:         Applying Lessons from
  Historic and Contemporary Case Studies to Improve the US Model,          Mimeo, University
  of Pennsylvania, 2014.
Farhi, Emmanuel and Xavier Gabaix,               Optimal Taxation with Behavioral Agents,
  Mimeo, Harvard University, 2017.
Friedman, Eric J., Joseph Y. Halpern, and Ian Kash, Eciency and Nash Equilibria
  in a Scrip System for P2P Networks, in Proceedings of the 7th ACM conference on
  Electronic commerce ACM 2006, pp. 140149.


Friedman, Jerome, Trevor Hastie, and Robert Tibshirani, The Elements of Statistical
  Learning, Vol. 1, Springer Series in Statistics, New York, 2001.
Guo, Y. and J. Hörner, Dynamic Mechanisms with Money,              Technical Report, Mimeo,
  Yale University 2015.


Hajaj, Chen, John P. Dickerson, Avinatan Hassidim, Tuomas Sandholm, and
 David Sarne, Strategy-Proof and Ecient Kidney Exchange Using a Credit Mechanism,
  in  AAAI 2015, pp. 921928.


Hauser, Christine and Hugo Hopenhayn,                Trading Favors:   Optimal Exchange and
  Forgiveness,   Collegio Carlo Alberto Carlo Alberto Notebooks, 2008, 88.
Held, Philip J., F. McCormick, A. Ojo, and John P. Roberts, A Cost-Benet Analy-
  sis of Government Compensation of Kidney Donors,      American Journal of Transplantation,
  2016,   16 (3), 877885.
Hsieh, Chang-Tai and Peter J. Klenow,              Misallocation and Manufacturing TFP in
  China and India,   Quarterly Journal of Economics, 2009, 124 (4), 14031448.
Irwin, F.D., A.F. Bonagura, S.W. Crawford, and M. Foote, Kidney Paired Donation:
  A Payer Perspective,      American Journal of Transplantation, 2012, 12 (6), 13881391.
Jackson, Matthew O. and Hugo F. Sonnenschein, Overcoming Incentive Constraints
  by Linking Decisions,     Econometrica, 2007, 75 (1), 241257.
Johnson, Rachel J., Joanne E. Allen, Susan V. Fuggle, J. Andrew Bradley, Chris
  Rudge et al., Early Experience of Paired Living Kidney Donation in the United King-
  dom,   Transplantation, 2008, 86 (12), 16721677.
                                                                                              46


Kash, Ian A., Eric J. Friedman, and Joseph Y. Halpern, Optimizing Scrip systems:
  Eciency, Crashes, Hoarders, and Altruists, in Proceedings of the 8th ACM Conference
  on Electronic commerce ACM 2007, pp. 305315.


Kolstad, Jonathan T., Information and Quality When Motivation Is Intrinsic:           Evidence
  from Surgeon Report Cards,    American Economic Review, 2013, 103 (7), 28752910.
Kominers, Scott D., Alex Teytelboym, and Vincent P. Crawford, An Invitation to
  Market Design,   Oxford Review of Economic Policy, 2017, 33, 541571.
Lerner, A.P., The Concept of Monopoly and the Measurement of Monopoly Power, Review
  of Economic Studies, 1934, 1 (3), 157175.
Li, Shengwu,  Ethics and market design, Oxford Review of Economic Policy, 2017, 33 (4),
  705720.


Malik, Sha and Edward Cole,            Foundations and Principles of the Canadian Living
  Donor Paired Exchange Program,       Canadian Journal of Kidney Health and Disease, 2014,
  1 (1), 6.
Marschak, Jacob and William H. Andrews, Random Simultaneous Equations and the
  Theory of Production,   Econometrica, 1944, pp. 143205.
Massie, Allan B., Sommer E. Gentry, Robert A. Montgomery, Adam A. Binga-
 man, and Dorry L. Segev, Center-Level Utilization of Kidney Paired Donation, Amer-
  ican Journal of Transplantation, 2013, 13 (5), 13171322.
Mathur, Amit K., Jiawei Xing, David M. Dickinson, Patricia H. Warren, Kim-
 berly A. Giord, Barry A. Hong, Akinlolu Ojo, and Robert M. Merion, Return
  on Investment for Financial Assistance for Living Kidney Donors in the United States,
  Clinical Transplantation, 2018, 32.
Möbius, Markus, Trading Favors, Mimeo, Microsoft Research, 2001.
Morris, Carl N., Parametric Empirical Bayes Inference:         Theory and Applications,   Jour-
  nal of the American Statistical Association, 1983, 78 (381), 4755.
National Kidney Registry,         Member      Center   Terms    &   Conditions,   http://www.
  kidneyregistry.org/docs/NKR_MC_Terms_Conditions.pdf,               2016.


Nikzad, Afshin, Mohammad Akbarpour, Michael A. Rees, and Alvin E. Roth,
  Financing Transplant Costs of the Poor: A Dynamic Model of Global Kidney Exchange,
  2017.


Olley, G. Steven and Ariel Pakes, The Dynamics of Productivity in the Telecommuni-
  cations Equipment Industry,   Econometrica, 1996, 64 (6), 12631297.
                                                                                          47


Orandi, B.J., J.M. Garonzik-Wang, Allan B. Massie, Andrea A. Zachary, J.R.
 Montgomery, K.J. Van Arendonk, Mark D. Stegall, S.C. Jordan, J. Oberholzer,
 T.B. Dunn et al., Quantifying the Risk of Incompatible Kidney Transplantation: A
  Multicenter Study,   American Journal of Transplantation, 2014, 14 (7), 15731580.
Prendergast, Canice,         The Allocation of Food to Food Banks,   University of Chicago,
  mimeo, 2017.
Ramsey, Frank P., A Contribution to the Theory of Taxation, The Economic Journal,
  1927,   37 (145), 4761.
Rees, Michael A., Jonathan E. Kopke, Ronald P. Pelletier, Dorry L. Segev,
 Matthew E. Rutter, Alfredo J. Fabrega, Jerey Rogers, Oleh G. Pankewycz,
 Janet Hiller, Alvin E. Roth et al., A Nonsimultaneous, Extended, Altruistic-Donor
  Chain,   New England Journal of Medicine, 2009, 360 (11), 10961101.
  , Mark A. Schnitzler, E.Y. Zavala, James A. Cutler, Alvin E. Roth, Frank D.
  Irwin, Stephen W. Crawford, and Alan B. Leichtman, Call to Develop a Standard
  Acquisition Charge Model for Kidney Paired Donation,     American Journal of Transplan-
  tation, 2012, 12 (6), 13921397.
  , Ty B. Dunn, Christian S. Kuhr, Christopher L. Marsh, Jerey Rogers, Su-
  san E. Rees, Alejandra Cicero, Laurie J. Reece, Alvin E. Roth, Obi Ekwenna
  et al., Kidney Exchange to Overcome Financial Barriers to Kidney Transplantation,
  American Journal of Transplantation, 2017, 17 (3), 782790.
Robert, Christian and George Casella, Monte Carlo Statistical Methods, New York,
  2004.


Rochet, Jean-Charles and Jean Tirole, Platform Competition in Two-Sided Markets,
  Journal of the European Economic Association, 2003, 1 (4), 9901029.
Roth, Alvin E., Repugnance as a Constraint on Markets, Journal of Economic Perspec-
  tives, 2007, 21 (3), 3758.
  , Tayfun Sönmez, and M. Utku Ünver,              Kidney Exchange,    Quarterly Journal of
  Economics, 2004, 119 (2), 457488.
  , , and       , Transplant Center Incentives in Kidney Exchange,   Mimeo, Boston College,
  2005.


  ,   , and        , Ecient Kidney Exchange:      Coincidence of Wants in Markets with
  Compatibility-Based Preferences,    American Economic Review, 2007, pp. 828851.
Sönmez, Tayfun and M. Utku Ünver, Market Design for Kidney Exchange, Handbook
  of Market Design, 2013, pp. 93137.
  ,   , and M. Bumin Yenmez, Incentivized Kidney Exchange, Boston College, mimeo,
  2018.
                                                                                          48


Toulis, Panos and David C. Parkes,          Design and Analysis of Multi-Hospital Kidney
  Exchange Mechanisms Using Random Graphs,        Games and Economic Behavior, 2015, 91,
  360382.


United States Renal Data System, 2013 USRDS Annual Data Report: Epidemiology
  of Kidney Disease in the United States,   Vol. 2, National Institutes of Health, National
  Institute of Diabetes and Digestive and Kidney Diseases, Bethesda, MD, 2013.


  ,   2016 USRDS Annual Data Report: Epidemiology of Kidney Disease in the United States,
  Vol. 2, National Institutes of Health, National Institute of Diabetes and Digestive and
  Kidney Diseases, Bethesda, MD, 2016.


Veale, Jerey L., Alexander M. Capron, Nima Nassiri, Gabriel Danovitch,
 H. Albin Gritsch, Amy Waterman, Joseph Del Pizzo, Jim C. Hu, Marek Py-
 cia, Suzanne McGuire et al., Vouchers for Future Kidney Transplants to Overcome
  'Chronological Incompatibility' Between Living Donors and Recipients,     Transplantation,
  2017.


Wall, Anji E., Jerey L. Veale, and Marc L. Melcher,                Advanced Donation Pro-
  grams and Deceased Donor Initiated Chains2 Innovations in Kidney Paired Donation,
  Transplantation, 2017.
Walters, A. A., Production and Cost Functions:     An Econometric Survey,    Econometrica,
  1963,   31 (1,2), 166.
Weyl, E. Glen, A Price Theory of Multi-Sided Platforms, American Economic Review,
  2010,   100 (4), 16421672.
Wolfe, Robert A., Valarie B. Ashby, Edgar L. Milford, Akinlolu O. Ojo, Robert E.
 Ettenger, Lawrence Y.C. Agodoa, Philip J. Held, and Friedrich K. Port, Com-
  parison of Mortality in All Patients on Dialysis, Patients on Dialysis Awaiting Transplan-
  tation, and Recipients of a First Cadaveric Transplant,   New England Journal of Medicine,
  1999,   341 (23), 17251730.
