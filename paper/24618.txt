                             NBER WORKING PAPER SERIES




                    ESTIMATING LATENT ASSET-PRICING FACTORS

                                        Martin Lettau
                                        Markus Pelger

                                     Working Paper 24618
                             http://www.nber.org/papers/w24618


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                            May 2018, Revised June 2018




We thank Svetlana Bryzgalova, John Cochrane, Jianqing Fan, Kay Giesecke, Bob Hodrick, Per
Mykland, Serena Ng, Viktor Todorov, Dacheng Xiu and seminar participants at Columbia,
Chicago, UC Berkeley, UC Irvine, Zürich, Toronto, Boston University, Humboldt University,
Ulm, Bonn, Frankfurt and the conference participants at the NBER-NSF Time-Series Conference,
SoFiE, Western Mathematical Finance Conference and INFORMS for helpful comments. The
views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Martin Lettau and Markus Pelger. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Estimating Latent Asset-Pricing Factors
Martin Lettau and Markus Pelger NBER
Working Paper No. 24618
May 2018, Revised June 2018
JEL No. C14,C38,C52,G12

                                          ABSTRACT

We develop an estimator for latent factors in a large-dimensional panel of financial data that can
explain expected excess returns. Statistical factor analysis based on Principal Component
Analysis (PCA) has problems identifying factors with a small variance that are important for
asset pricing. We generalize PCA with a penalty term accounting for the pricing error in expected
returns. Our estimator searches for factors that can explain both the expected return and
covariance structure. We derive the statistical properties of the new estimator and show that our
estimator can find asset-pricing factors, which cannot be detected with PCA, even if a large
amount of data is available. Applying the approach to portfolio data we find factors with Sharpe-
ratios more than twice as large as those based on conventional PCA and with significantly smaller
pricing errors.


Martin Lettau
Haas School of Business
University of California, Berkeley
545 Student Services Bldg. #1900
Berkeley, CA 94720-1900
and NBER
lettau@haas.berkeley.edu

Markus Pelger
312 Huang Engineering Center
Department of Management Science
& Engineering
Stanford University
Stanford, CA 94305
mpelger@stanford.edu
1. Introduction

      Approximate factor models have been a heavily researched topic in ﬁnance and macroeconomics in
the last years (see Bai and Ng (2008), Stock and Watson (2006) and Ludvigson and Ng (2010)). The most
popular technique to estimate latent factors is Principal Component Analysis (PCA) of a covariance or
correlation matrix. It estimates factors that can best explain the co-movement in the data. A situation
that is often encountered in practice is that the explanatory power of the factors is weak relative to
idiosyncratic noise. In this case conventional PCA performs poorly (see Onatski (2012)). In some cases
economic theory also imposes structure on the ﬁrst moments of the data. Including this additional
information in the estimation turns out to signiﬁcantly improve the estimation of latent factors, in
particular for those factors with a weak explanatory power in the variance.
      We suggest a new statistical method to ﬁnd the most important factors for explaining the varia-
tion and the mean in a large dimensional panel. Our key application are asset pricing factors. The
fundamental insight of asset pricing theory is that the cross-section of expected returns should be
explained by exposure to systematic risk factors.1 Hence, asset pricing factors should simultaneously
explain time-series covariation as well as the cross-section of mean returns. Finding the “right” risk
factors is not only the central question in asset pricing but also crucial for optimal portfolio and risk
management.2 Traditional PCA methods based on the covariance or correlation matrices identify fac-
tors that capture only common time-series variation but do not take the cross-sectional explanatory
power of factors into account.3 We generalize PCA by including a penalty term to account for the
pricing errors in the means. Hence, our estimator Risk-Premium PCA (RP-PCA) directly includes the
object of interest, which is explaining the cross-section of expected returns, in the estimation. It turns
out, that even if the goal is to explain the covariation and not the mean, the additional information
in the mean can improve the estimation signiﬁcantly.
      This paper develops the asymptotic inferential theory for our estimator under a general approx-
imate factor model and shows that it dominates conventional estimation based on PCA if there is
information in the mean. We distinguish between strong and weak factors in our model. Strong fac-
tors essentially aﬀect all underlying assets. The market-wide return is an example of a strong factor
in asset pricing applications. RP-PCA can estimate these factors more eﬃciently than PCA as it ef-
ﬁciently combines information in ﬁrst and second moments of the data. Weak factors aﬀect only
a subset of the underlying assets and are harder to detect. Many asset-pricing factors fall into this
category. RP-PCA can ﬁnd weak factors with high Sharpe-ratios, which cannot be detected with PCA,
even if an inﬁnite amount of data is available.
      We build upon the econometrics literature devoted to estimating factors from large dimensional
panel data sets. The general case of a static large dimensional factor model is treated in Bai (2003)

  1
     Arbitrage pricing theory (APT) formalized by Ross (1976) and Chamberlain and Rothschild (1983) states that in an
approximate factor model only systematic factors carry a risk-premium and explain the expected returns of diversiﬁed
portfolios. Hence, factors that explain the covariance structure must also explain the expected returns in the cross-section.
   2
     Harvey et al. (2016) document that more than 300 published candidate factors have predictive power for the cross-
section of expected returns. As argued by Cochrane (2011) in his presidential address this leads to the crucial questions,
which risk factors are really important and which factors are subsumed by others.
   3
     PCA has been used to ﬁnd asset pricing factors among others by Connor and Korajczyk (1988), Connor and Korajczyk
(1993) and Kozak et al. (2017). Kelly et al. (2017) and Fan et al. (2016) apply PCA to projected portfolios.


                                                             1
and Bai and Ng (2002). Forni et al. (2000) introduce the dynamic principal component method. Fan
et al. (2013) study an approximate factor structure with sparsity. Aït-Sahalia and Xiu (2017) and Pelger
(2017) extend the large dimensional factor model to high-frequency data. All these methods assume
a strong factor structure that is estimated with some version of PCA without taking into account the
information in expected returns, which results in a loss of eﬃciency. We generalize the framework of
Bai (2003) to include the pricing error penalty and show that it only eﬀects the asymptotic distribution
of the estimates but not consistency.
   Onatski (2012) studies principal component estimation of large factor models with weak factors.
He shows that if a factor does not explain a suﬃcient amount of the variation in the data, it cannot be
detected with PCA. We provide a solution to this problem that renders weak factors with high Sharpe-
ratios detectable. Our statistical model extends the spiked covariance model from random matrix
theory used in Onatski (2012) and Benaych-Georges and Nadakuditi (2011) to include the pricing error
penalty. We show that including the information in the mean leads to larger systematic eigenvalues of
the factors, which reduces the bias in the factor estimation and makes weak factors detectable. The
derivation of our results is challenging as we cannot make the standard assumption that the mean
of the stochastic processes is zero. As many asset pricing factors can be characterized as weak, our
estimation approach becomes particularly relevant.
   Our work is part of the emerging econometrics literature that combines latent factor extraction
with a form of regularization. Bai and Ng (2017) develop the statistical theory for robust principal
components. Their estimator can be understood as performing iterative ridge instead of least squares
regressions, which shrinks the eigenvalues of the common components to zero. They combine their
shrinked estimates with a clean-up step that sets the small eigenvalues to zero. Their estimates have
less variation at the cost of a bias. Our approach also includes a penalty which in contrast is based on
economic information and does not create a bias-variance trade-oﬀ. The objective of ﬁnding factors
that can explain co-movements and the cross-section of expected returns simultaneously is based
on the fundamental insight of arbitrage pricing theory. We show theoretically and empirically that
including the additional information of arbitrage pricing theory in the estimation of factors leads to
factors that have better out-of-sample pricing performance. Our estimator depends on a tuning pa-
rameter that trades oﬀ the information in the variance and the mean in the data. Our statistical theory
provides guidance on the optimal choice of the tuning parameter that we conﬁrm in simulations and
in the data.
   Our work is closely related to the paper by Fan and Zhong (2018) which allows estimating latent
factors based on an over-identifying set of moments. We combine the ﬁrst and second moments to
estimate factors while their approach allows the inclusion of additional moments. Their analysis is
based on a generalized method of moment approach under the assumption of a ﬁnite cross-section.
Our strong factor model formulation can be similarly related to a general method of moment problem.
We consider a large number of assets and include the additional perspective of a weak factor model
which we think is particularly relevant in the context of asset pricing factors.
   We apply our methodology to monthly returns of 370 decile sorted portfolios based on relevant
ﬁnancial anomalies for 55 years. We ﬁnd that ﬁve factors can explain very well these expected returns
and strongly outperforms PCA-based factors. The maximum Sharpe-ratio of our ﬁve factors is more

                                                   2
than twice as large as those based on PCA; a result that holds in- and out-of-sample. The pricing
errors out-of-sample are sizably smaller. Our method captures the pricing information better while
explaining the same amount of variation and co-movement in the data. Our companion paper Lettau
and Pelger (2018) provides a more in-depth empirical analysis of asset-pricing factors estimated with
our approach.
      The rest of the paper is organized as follows. In Section 2 we introduce the model and provide
an intuition for our estimators. Section 3 discusses the formal objective function that deﬁnes our
estimator. Section 4 provides the inferential theory for strong factors, while 5 presents the asymptotic
theory for weak factors. Section 6 provides Monte Carlo simulations demonstrating the ﬁnite-sample
performance of our estimator. In Section 7 we study the factor structure in a large equity data set.
Section 8 concludes. The appendix contains the proofs.


2. Factor Model

      We assume that excess returns follow a standard approximate factor model and the assumptions
of the arbitrage pricing theory are satisﬁed. This means that returns have a systematic component
captured by 𝐾 factors and a nonsystematic, idiosyncratic component capturing asset-speciﬁc risk.
The approximate factor structure allows the non-systematic risk to be weakly dependent. We observe
the excess4 return of 𝑁 assets over 𝑇 time periods:

                                    𝑋𝑡,𝑖 = 𝐹𝑡 Λ⊤
                                               𝑖 + 𝑒𝑡,𝑖        𝑖 = 1, ..., 𝑁 𝑡 = 1, ..., 𝑇.

In matrix notation this reads as

                                                    𝑋
                                                    ⏟ = 𝐹
                                                        ⏟ Λ
                                                          ⏟ ⊤ + ⏟
                                                                𝑒 .
                                                  𝑇×𝑁      𝑇×𝐾 𝐾×𝑁     𝑇×𝑁


Our goal is to estimate the unknown latent factors 𝐹 and the loadings Λ. We will work in a large
dimensional panel, i.e. the number of cross-sectional observations 𝑁 and the number of time-series
observations 𝑇 are both large and we study the asymptotics for them jointly going to inﬁnity.
      Assume that the factors and residuals are uncorrelated. This implies that the covariance matrix
of the returns consists of a systematic and idiosyncratic part:

                                            Var(𝑋) = ΛVar(𝐹)Λ⊤ + Var(𝑒).

Under standard assumptions the largest eigenvalues of Var(𝑋) are driven by the factors. This moti-
vates Principal Component Analysis (PCA) as an estimator for the loadings and factors. Essentially all
estimators for latent factors only utilize the information contained in the second moment, but ignore
information that is contained in the ﬁrst moment.
      Arbitrage-Pricing Theory (APT) has a second implication: The expected excess return is explained
by the exposure to the risk factors multiplied by the risk-premium of the factors. If the factors are

  4
      Excess returns equal returns minus the risk-free rate.


                                                               3
excess returns APT implies

                                                    𝐸[𝑋𝑖 ] = Λ𝑖 𝐸[𝐹].

Here we assume a strong form of APT, where residual risk has a risk-premium of zero. In its more
general form APT requires only the risk-premium of the idiosyncratic part of well-diversiﬁed portfo-
lios to go to zero. As most of our analysis will be based on portfolios, there is no loss of generality
by assuming the strong form.
    Factors constructed by PCA explain as much common time-series variation as possible. Conven-
                                                                              1
tional statistical factor analysis applies PCA to the sample covariance matrix 𝑋⊤ 𝑋 − 𝑋̄𝑋̄⊤ where       𝑇
𝑋̄ denotes the sample mean of excess returns. The eigenvectors of the largest eigenvalues are pro-
portional to the loadings Λ̂ PCA . Factors are obtained from a regression on the estimated loadings. It
can be shown that conventional PCA factor estimates are based on the time-series variation objective
            5
function:

                                                            𝑁    𝑇
                                                  1                       ⊤ 2
                                          min              ∑ ∑ (𝑋𝑡𝑖 − 𝐹𝑡 Λ𝑖 )
                                           Λ,𝐹    𝑁𝑇       𝑖=1 𝑡=1


      We call our approach Risk-Premium-PCA (RP-PCA). It applies PCA to a covariance matrix with
overweighted mean

                                                      1
                                                          𝑋⊤ 𝑋 + 𝛾𝑋̄𝑋̄⊤
                                                      𝑇

with the risk-premium weight 𝛾. The eigenvectors of the largest eigenvalues are proportional to the
loadings Λ̂ RP-PCA . We show that RP-PCA minimizes jointly the unexplained variation and pricing error:

                                          𝑁   𝑇                               𝑁
                                     1                              ⊤    1                         2
                            min          ∑ ∑ (𝑋𝑡𝑖 − 𝐹𝑡 Λ𝑖 )2 +𝛾             ∑ (𝑋𝑖̄ − 𝐹Λ      ̄ ⊤𝑖 ) ,
                            Λ,𝐹    𝑁𝑇 𝑖=1 𝑡=1                            𝑁 𝑖=1
                                   ⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟ ⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
                                         unexplained variation                    pricing error


where 𝐹 ̄ denotes the sample mean of the factors. Factors are estimated by a regression of the returns
                                                   −1
on the estimated loadings, i.e. 𝐹 ̂ = 𝑋Λ̂ (Λ̂ ⊤ Λ)
                                                 ̂    .
      We develop the statistical theory that provides guidance on the optimal choice of the key param-
eter 𝛾. There are essentially two diﬀerent factor model interpretations: a strong factor model and a
weak factor model. In a strong factor model the factors provide a strong signal and lead to exploding
eigenvalues in the covariance matrix. This is either because the strong factors aﬀect a very large
number of assets and/or because they have very large variances themselves. In a weak factor model
the factors’ signals are weak and the resulting eigenvalues are large compared to the idiosyncratic
spectrum, but they do not explode.6 In both cases it is always optimal to choose 𝛾 ≠ −1, i.e. it is
better to use our estimator instead of PCA applied to the covariance matrix. In a strong factor model,

  5
    The variation objective function assumes that the data has been demeaned.
  6
    Arbitrage-Pricing Theory developed by Chamberlain and Rothschild (1983) assumes that only strong factors are non-
diversiﬁable and explain the cross-section of expected returns. As pointed out by Onatski (2012), a weak factors can be


                                                                 4
the estimates become more eﬃcient. In a weak factor model it strengthens the signal of the weak
factors, which could otherwise not be detected. Depending on which framework is more appropriate,
the optimal choice of 𝛾 varies. A weak factor model usually suggests much larger choices for the
optimal 𝛾 than a strong factor model. However, in strong factor models our estimator is consistent
for any choice of 𝛾 and choosing a too large 𝛾 results in only minor eﬃciency losses. On the other
hand a too small 𝛾 can prevent weak factors from being detected at all. Thus in our empirical analysis
we opt for the choice of larger 𝛾’s.
    The empirical spectrum of eigenvalues in equity data suggests a combination of strong and weak
factors. In all the equity data that we have tested the ﬁrst eigenvalue of the sample covariance matrix
is very large, typically around ten times the size of the rest of the spectrum. The second and third
eigenvalues usually stand out, but have only magnitudes around twice or three times of the average
of the residual spectrum, which would be more in line with a weak factor interpretation. The ﬁrst
statistical factor in our data sets is always very strongly correlated with an equally-weighted market
factor. Hence, if we are interested in learning more about factors besides the market, the weak factor
model might provide better guidance.


3. Objective Function

    This section explains the relationship between our estimator and the objective function that is min-
imized. We introduce the following notation:           1 is a vector 𝑇 × 1 of 1’s and thus 𝐹⊤ 1/𝑇 is the sample
mean estimator of 𝐹. The projection matrix 𝑀Λ = 𝐼𝑁 − Λ(Λ⊤ Λ)−1 Λ⊤ annihilates the 𝐾−dimensional
vector space spanned by Λ. 𝐼𝑁 and 𝐼𝑇 denote the 𝑁- respectively 𝑇-dimensional identity matrix.
   The objective function of conventional statistical factor analysis is to minimize the sum of squared
errors for the cross-section and time dimension, i.e. the estimator Λ̂ and 𝐹 ̂ are chosen to minimize
the unexplained variance. This variation objective function is

                     𝑁   𝑇
                1                   ⊤ 2               1
         min         ∑ ∑ (𝑋𝑡𝑖 − 𝐹𝑡 Λ𝑖 ) = min             trace(𝑋𝑀Λ )⊤ (𝑋𝑀Λ ))        s.t. 𝐹 = 𝑋(Λ⊤ Λ)−1 Λ⊤ .
          Λ,𝐹   𝑁𝑇   𝑖=1 𝑡=1                    Λ   𝑁𝑇

The second formulation makes use of the fact that in a large panel data set the factors can be esti-
mated by a regression of the assets on the loadings, 𝐹 = 𝑋(Λ⊤ Λ)−1 Λ⊤ , and hence the residuals equal
𝑋 − 𝐹Λ⊤ = 𝑋𝑀Λ . This is equivalent to choosing Λ̂ proportional to the eigenvectors of the ﬁrst 𝐾
                                1
largest eigenvalues of         𝑁𝑇
                                  𝑋⊤ 𝑋.7
                                  In most applications the data is ﬁrst demeaned, which means that
the estimator applies PCA to the estimated covariance matrix of 𝑋. Thus Λ̂ is proportional to the
                                                   1          11⊤
eigenvectors of the ﬁrst 𝐾 largest eigenvalues of 𝑁𝑇 𝑋⊤ (𝐼𝑇 − 𝑇 ) 𝑋.
    Arbitrage-pricing theory predicts that the factors should price the cross-section of expected excess


regarded as a ﬁnite sample approximation for strong factors, i.e. the eigenvalues of factors that are theoretically strong
grow so slowly with the sample size that the weak factor model provides a more appropriate description of the data.
   7
     Factor models are only identiﬁed up to invertible transformations. Therefore there is no loss of generality to assume
that the loadings are orthonormal vectors and that the inner product of factors is a diagonal matrix.




                                                            5
returns. This yields a pricing objective function which minimizes the cross-sectional pricing error:

                    𝑁                                       2                                              ⊤
                1              1              1                   1              1                1
                    ∑(             𝑋𝑖⊤ 1 −        𝐹𝑖⊤ 1Λ⊤
                                                        𝑖 ) =         trace ((       1⊤ 𝑋𝑀Λ ) ( 1⊤ 𝑋𝑀Λ )       ).
                𝑁   𝑖=1
                           𝑇                  𝑇                   𝑁              𝑇                𝑇

   We propose to combine these two objective functions with the risk-premium weight 𝛾. The idea
is to obtain statistical factors that explain the co-movement in the data and produce small pricing
errors:
                                                                                                                    ⊤
                     1                                                    1              1            1
             min           trace (((𝑋𝑀Λ )⊤ (𝑋𝑀Λ )) + 𝛾                        trace ((       1⊤ 𝑋𝑀Λ ) ( 1⊤ 𝑋𝑀Λ )        )
              Λ,𝐹   𝑁𝑇                                                𝑁𝑇                 𝑇            𝑇
                     1                                     𝛾
           = min           trace (𝑀Λ 𝑋⊤ (𝐼 +                   11⊤ ) 𝑋𝑀Λ )           s.t. 𝐹 = 𝑋(Λ⊤ Λ)−1 Λ⊤ .
               Λ    𝑁𝑇                                     𝑇

Here we have made use of the linearity of the trace operator. The objective function is minimized
by the eigenvectors of the largest eigenvalues of
                                                                       1
                                                                      𝑁𝑇
                                                                         𝑋⊤    (𝐼𝑇 +
                                                                                       𝛾
                                                                                           11⊤ ) 𝑋.
                                                                           Hence the factors and load-
                                                                                       𝑇
ings can be obtained by applying PCA to this new matrix. The estimator for the loadings Λ̂ are the
eigenvectors of the ﬁrst 𝐾 eigenvalues of 𝑁𝑇 𝑋⊤ (𝐼𝑇 + 𝑇 11⊤ ) 𝑋 multiplied by √𝑁. 𝐹 ̂ are 𝑁 𝑋Λ.̂ The
                                           1          𝛾                                      1


estimator for the common component 𝐶 = 𝐹Λ is simply 𝐶 ̂ = 𝐹Λ    ̂ ̂ ⊤ . The estimator simpliﬁes to PCA
of the covariance matrix for 𝛾 = −1.
   In practice conventional PCA is often applied to the correlation instead of the covariance matrix.
This implies that the returns are demeaned and normalized by their standard-deviation before apply-
ing PCA to their inner product. Hence, factors are chosen that explain most of the correlation instead
of the variance. This approach is particularly appealing if the underlying panel data is measured in
diﬀerent units. Usually estimation based on the correlation matrix is more robust than based on the
covariance matrix as it is less aﬀected by a few outliers with very large variances. From a statistical
perspective this is equivalent to applying a cross-sectional weighting matrix to the panel data. Af-
ter applying PCA to the inner product, the inverse of the weighting matrix has to be applied to the
estimated eigenvectors. The statistical rationale is that certain cross-sectional observations contain
more information about the systematic risk than others and hence should obtain a larger weight in
the statistical analysis. The standard deviation of each cross-sectional observation serves as a proxy
for how large the noise is and therefore down-weighs very noisy observations.
   Mathematically, a weighting matrix means that instead of minimizing equally weighted pricing
errors we apply a weighting function 𝑄 to the cross-section resulting in the following weighted com-
bined objective function:

                                   1
                     min                trace(𝑄⊤ (𝑋 − 𝐹Λ⊤ )⊤ (𝑋 − 𝐹Λ⊤ )𝑄)
                         Λ,𝐹       𝑁𝑇
                                                       1
                                                  +𝛾       trace (1⊤ (𝑋 − 𝐹Λ⊤ )𝑄𝑄⊤ (𝑋 − 𝐹Λ⊤ )⊤ 1)
                                                       𝑁

                                                                                𝛾
                                       = min trace (𝑀Λ 𝑄⊤ 𝑋⊤ (𝐼 +                   11⊤ ) 𝑋𝑄𝑀Λ )
                                          Λ                                     𝑇
                                                  s.t. 𝐹 = 𝑋(Λ⊤ Λ)−1 Λ⊤ .


                                                                      6
Therefore factors and loadings can be estimated by applying PCA to 𝑄⊤ 𝑋⊤ (𝐼 +
                                                                                                      𝛾
                                                                                                      𝑇
                                                                                                          11⊤ ) 𝑋𝑄.   In our
empirical application we only consider the weighting matrix 𝑄 which is the inverse of a diagonal
matrix of standard deviations of each return. For 𝛾 = −1 this corresponds to using a correlation
matrix instead of a covariance matrix for PCA.
      There are four diﬀerent interpretations of RP-PCA:
      (1) Variation and pricing objective functions: Our estimator combines a variation and pricing error
criteria function. As such it only selects factors that are priced and hence have small cross-sectional
alpha’s. But at the same time it protects against spurious factors that have vanishing loadings as it
requires the factors to explain a large amount of the variation in the data as well.8
      (2) Penalized PCA: RP-PCA is a generalization of PCA regularized by a pricing error penalty term.
Factors that minimize the variation criterion need to explain a large part of the variance in the data.
Factors that minimize the cross-sectional pricing criterion need to have a non-vanishing risk-premia.
Our joint criteria is essentially looking for the factors that explain the time-series but penalizes factors
with a low Sharpe-ratio. Hence the resulting factors usually have much higher Sharpe-ratios than those
based on conventional factor analysis.
      (3) Information interpretation: Conventional PCA of a covariance matrix only uses information
contained in the second moment but ignores all information in the ﬁrst moment. As using all available
information in general leads to more eﬃcient estimates, there is an argument for including the ﬁrst
moment in the objective function. Our estimator can be seen as combining two moment conditions
eﬃciently. This interpretation drives the results for the strong factor model in Section 4.
                                         1
  (4) Signal-strengthening: The matrix 𝑋⊤ 𝑋 + 𝛾𝑋̄𝑋̄⊤ should converge to9
                                                  𝑇


                                         Λ (Σ𝐹 + (1 + 𝛾)𝜇𝐹 𝜇𝐹⊤ ) Λ⊤ + Var(𝑒),

where Σ𝐹 = Var(𝐹) denotes the covariance matrix of 𝐹 and 𝜇𝐹 = 𝐸[𝐹] the mean of the factors. After
normalizing the loadings, the strengths of the factors in the standard PCA of a covariance matrix
are equal to their variances. Larger factor variances will result in larger systematic eigenvalues and a
more precise estimation of the factors. In our RP-PCA the signal of weak factors with a small variance
can be “pushed up” by their mean if 𝛾 is chosen accordingly. In this sense our estimator strengthens
the signal of the systematic part. This interpretation is the basis for the weak factor model studied
in Section 5.


4. Strong Factor Model

      In a strong factor model RP-PCA provides a more eﬃcient estimator of the loadings than PCA.
Both RP-PCA and PCA provide consistent estimator for the loadings and factors. In the strong factor

  8
     A natural question to ask is why do we not just use the cross-sectional objective function for estimating latent factors,
if we are mainly interested in pricing? First, the cross-sectional pricing objective function alone does not identify a set of
factors. For example it is a rank 1 matrix and it would not make sense to apply PCA to it. Second, there is the problem
of spurious factor detection (see e.g. Bryzgalova (2017)). Factors can perform well in a cross-sectional regression because
their loadings are close to zero. Thus “good” asset pricing factors need to have small cross-sectional pricing errors and
explain the variation in the data.
   9
     In this large-dimensional context the limit will be more complicated and studied in the subsequent sections.


                                                              7
model, the systematic factors are so strong that they lead to exploding eigenvalues. This is captured
                                1 ⊤
by the assumption that          𝑁
                                  Λ Λ   → ΣΛ where ΣΛ is a full-rank matrix.10 This could be interpreted as
the strong factors aﬀecting an inﬁnite number of assets.
                                                                                                     1    1
   The estimator for the loadings Λ̂ are the eigenvectors of the ﬁrst 𝐾 eigenvalues of               𝑁
                                                                                                         ( 𝑇 𝑋⊤ 𝑋 + 𝛾𝑋̄𝑋̄⊤ )
multiplied by √𝑁. Up to rescaling the estimators are identical to those in the weak factor model setup.
The estimator for the common component 𝐶 = 𝐹Λ is 𝐶 ̂ = 𝐹Λ    ̂ ̂ ⊤.
    Bai (2003) shows that under Assumption 1 the PCA estimator of the loadings has the same asymp-
totic distribution as an OLS regression of the true factors 𝐹 on 𝑋 (up to a rotation). Similarly, the
estimator for the factors behaves asymptotically like an OLS regression of the true loadings Λ on
𝑋⊤ (up to a rotation). Under slightly stronger assumptions we will show that the estimated loadings
under RP-PCA have the same asymptotic distribution up to rotation as an OLS regression of 𝑊𝐹 on
                      11⊤
𝑊𝑋 with 𝑊2 = (𝐼𝑇 + 𝛾 𝑇 ). Surprisingly, estimated factors under RP-PCA and PCA have the same
distribution.
    Assumption 1 is identical to Assumptions A-G in Bai (2003) plus the additional assumption in
                          1     𝑇
E.4 that relates to      √𝑇
                              ∑𝑡=1 𝑒𝑡,𝑖 . See Bai (2003) for a discussion of the assumptions. The correlation
structure in the residuals can be more general in the strong model than in the weak model. This comes
at the cost of larger values for the loading vectors. The residuals still need to satisfy a form of sparsity
assumption restricting the dependence. The strong factor model provides a distribution theory which
is based on a central limit theorem of the residuals. This is satisﬁed for relevant processes, e.g. ARMA
models.


Assumption 1: Strong Factor Model
                                                                𝑝
                                                1    𝑇
  A: Factors: 𝐸[‖𝐹𝑡 ‖4 ] ≤ 𝑀 < ∞ and            𝑇
                                                    ∑𝑡=1 𝐹𝑡 𝐹𝑡⊤ → Σ𝐹 for some 𝐾 × 𝐾 positive deﬁnite matrix Σ𝐹
                          𝑝
             1       𝑇
      and    𝑇
                 ∑𝑡=1 𝐹𝑡 → 𝜇𝐹 .

   B: Factor loadings: ‖Λ𝑖 ‖ ≤ 𝜆̄ < ∞, and ‖Λ⊤ Λ/𝑁 − Σ𝜆 ‖ → 0 for some 𝐾 × 𝐾 positive deﬁnite matrix
      ΣΛ .

  C: Time and cross-section dependence and heteroskedasticity: There exists a positive constant 𝑀 < ∞
      such that for all 𝑁 and 𝑇:

         1. 𝐸[𝑒𝑡,𝑖 ] = 0, 𝐸[|𝑒𝑡,𝑖 |8 ] ≤ 𝑀.
                         𝑁                                                                                    𝑇
         2. 𝐸[𝑁−1 ∑𝑖=1 𝑒𝑠,𝑖 𝑒𝑡,𝑖 ] = 𝛾(𝑠, 𝑡), |𝛾(𝑠, 𝑠)| ≤ 𝑀 for all 𝑠 and for every 𝑡 ≤ 𝑇 it holds ∑𝑠=1 |𝛾(𝑠, 𝑡)| ≤
             𝑀

         3. 𝐸[𝑒𝑡,𝑖 𝑒𝑡,𝑗 ] = 𝜏𝑖𝑗,𝑡 with |𝜏𝑖𝑗,𝑡 | ≤ |𝜏𝑖𝑗 | for some 𝜏𝑖𝑗 and for all 𝑡 and for every 𝑖 ≤ 𝑁 it holds
                 𝑁
             ∑𝑖=1 |𝜏𝑖𝑗 | ≤ 𝑀.
                                                     𝑁           𝑇     𝑇
         4. 𝐸[𝑒𝑡,𝑖 𝑒𝑠,𝑗 ] = 𝜏𝑖𝑗,𝑡𝑠 and (𝑁𝑇)−1 ∑𝑖=1 ∑𝑗=1 ∑𝑡=1 ∑𝑠=1 |𝜏𝑖𝑗,𝑠𝑡 | ≤ 𝑀.
                                              𝑁
         5. For every (𝑡, 𝑠), 𝐸 [|𝑁−1/2 ∑𝑖=1 (𝑒𝑠,𝑖 𝑒𝑡,𝑖 ) − 𝐸[𝑒𝑠,𝑡 𝑒𝑡,𝑖 ]|4 ] ≤ 𝑀.

  10
     In latent factor models only the product 𝐹Λ is identiﬁed. Hence without loss of generality we will normalize ΣΛ to the
identity matrix 𝐼𝐾 and assume that the factors are uncorrelated.


                                                            8
  D: Weak dependence between factors and idiosyncratic errors:
           1    𝑁     1   𝑇
     𝐸 [ 𝑁 ∑𝑖=1 ‖ √𝑇 ∑𝑡=1 𝐹𝑡 𝑒𝑡,𝑖 ‖2 ] ≤ 𝑀.

  E: Moments and Central Limit Theorem: There exists an 𝑀 < ∞ such that for all 𝑁 and 𝑇:
                                  1        𝑇           𝑁                                     2
          1. For each 𝑡, 𝐸 [‖ √𝑁𝑇 ∑𝑠=1 ∑𝑘=1 𝐹𝑠 (𝑒𝑠,𝑘 𝑒𝑡,𝑘 − 𝐸[𝑒𝑠,𝑘 𝑒𝑡,𝑘 )]‖ ] ≤ 𝑀
                                                               1       𝑇       𝑁
          2. The 𝐾 × 𝐾 matrix satisﬁes 𝐸 [‖ √𝑁𝑇 ∑𝑡=1 ∑𝑖=1 𝐹𝑡 Λ⊤       2
                                                              𝑖 𝑒𝑡,𝑖 ‖ ] ≤ 𝑀

          3. For each 𝑡 as 𝑁 → ∞:

                                                                       𝑁
                                                                   1                𝑑
                                                                       ∑ Λ𝑖 𝑒𝑡,𝑖 → 𝑁(0, Γ𝑡 ),
                                                               √𝑁      𝑖=1

                                       1       𝑁           𝑁
               where Γ𝑡 = lim𝑁→∞       𝑁
                                           ∑𝑖=1 ∑𝑗=1 Λ𝑖 Λ⊤
                                                         𝑗 𝐸[𝑒𝑡,𝑖 𝑒𝑡,𝑗 ]

          4. For each 𝑖 as 𝑇 → ∞:

                                           1       𝑇
                                           ∑    𝐹𝑡 𝑒𝑡,𝑖 𝐷                                       Ω11,𝑖     Ω12,𝑖
                                      ⎛ √𝑇1 𝑡=1
                                             𝑇
                                                       ⎞ → 𝑁(0, Ω𝑖 )                     Ω𝑖 = ⎛                 ⎞
                                      ⎝ √𝑇 ∑𝑡=1 𝑒𝑡,𝑖 ⎠                                        ⎝Ω21,𝑖      Ω22,𝑖 ⎠


                                           1    𝑇    𝑇       𝐹𝑡 𝐹𝑠⊤ 𝑒𝑠,𝑖 𝑒𝑡,𝑖            𝐹𝑡 𝑒𝑠,𝑖 𝑒𝑡,𝑖
               where Ω𝑖 = 𝑝 lim𝑇→∞         𝑇
                                               ∑𝑠=1 ∑𝑡=1 𝐸 ⎡⎛ ⊤                                     ⎞⎤.
                                                           ⎣⎝ 𝐹𝑠 𝑒𝑠,𝑖 𝑒𝑡,𝑖                𝑒𝑠,𝑖 𝑒𝑡,𝑖 ⎠⎦

  F: The eigenvalues of the 𝐾 × 𝐾 matrix ΣΛ Σ𝐹 are distinct.


   Theorem 1 provides a complete inferential theory for the strong factor model.


Theorem 1: Asymptotic distribution in strong factor model
Assume Assumption 1 holds. Then:

  1. If min(𝑁, 𝑇) → ∞, then for any 𝛾 ∈ [−1, ∞) the factors and loadings can be estimated consis-
     tently pointwise.

          √𝑇
  2. If   𝑁
               → 0, then the asymptotic distribution of the loadings estimator is given by

                                               𝐷
                    √𝑇 (𝐻⊤ Λ̂ 𝑖 − Λ𝑖 ) → 𝑁(0, Φ𝑖 )

                                       −1                                                                                         −1
     Φ𝑖 = (Σ𝐹 + (𝛾 + 1)𝜇𝐹 𝜇𝐹⊤ )                (Ω11,𝑖 + 𝛾𝜇𝐹 Ω21,𝑖 + 𝛾Ω12,𝑖 𝜇𝐹 + 𝛾2 𝜇𝐹 Ω22,𝑖 𝜇𝐹 ) (Σ𝐹 + (𝛾 + 1)𝜇𝐹 𝜇𝐹⊤ )
                           1                       1
                    𝐻=(        𝐹⊤ 𝑊2 𝐹) (                   −1
                                                         ̂ 𝑉𝑇𝑁
                                                       ΛΛ)
                          𝑇                     𝑁

                                                                                              1                               11⊤
     and 𝑉𝑇𝑁 is a diagonal matrix of the largest 𝐾 eigenvalues of                            𝑁𝑇
                                                                                                 𝑋⊤ 𝑊2 𝑋   and 𝑊2 = (𝐼𝑇 + 𝛾   𝑇
                                                                                                                                    ).
     For 𝛾 = −1 this simpliﬁes to the conventional case                            Σ−1       −1
                                                                                    𝐹 Ω11,𝑖 Σ𝐹 .

          √𝑁
  3. If    𝑇
               → 0, then the asymptotic distribution of the factors is not aﬀected by the choice of 𝛾.

  4. For any choice of 𝛾 ∈ [−1, ∞) the common components can be estimated consistently if

                                                                           9
     min(𝑁, 𝑇) → ∞. The asymptotic distribution of the common component depends on 𝛾 if and only
     if 𝑇/𝑁 does not go to zero. For 𝑇/𝑁 → 0

                                                                       𝐷
                                                    ̂ − 𝐶𝑡,𝑖 ) → 𝑁 (0, 𝐹𝑡⊤ Φ𝑖 𝐹𝑡 ) .
                                               √𝑇 (𝐶𝑡,𝑖


                                                                                                   −1
   Note that Bai (2003) characterizes the distribution of √𝑇 (Λ𝑖 − 𝐻⊤                                   Λ̂ 𝑖 ), while we rotate the
estimated loadings √𝑇 (𝐻⊤ Λ̂ 𝑖 − Λ𝑖 ). Our rotated estimators are directly comparable for diﬀerent
choices of 𝛾. The proof of the theorem is essentially identical to the arguments of Bai (2003). The key
argument is based on an asymptotic expansion. Under Assumption 1 we can show that the following
expansions hold
                                 1              −1    1                        √𝑇
  1. √𝑇 (𝐻⊤ Λ̂ 𝑖 − Λ𝑖 ) = ( 𝑇 𝐹⊤ 𝑊2 𝐹)               √𝑇
                                                        𝐹⊤ 𝑊2 𝑒𝑖   + 𝑂𝑝 (      𝑁
                                                                                  )   + 𝑜𝑝 (1)

              −1                     1         −1     1                    √𝑁
  2. √𝑁 (𝐻⊤        𝐹𝑡̂ − 𝐹𝑡 ) = ( 𝑁 Λ⊤ Λ)            √𝑁
                                                        Λ⊤ 𝑒𝑡⊤   + 𝑂𝑝 (     𝑇
                                                                              )   + 𝑜𝑝 (1)

                           √𝛿 ⊤           1             −1    1                √𝛿 ⊤      1         −1    1
          ̂ − 𝐶𝑡,𝑖 ) =
  3. √𝛿 (𝐶𝑡,𝑖                𝐹
                           √𝑇 𝑡
                                         ( 𝑇 𝐹⊤ 𝑊2 𝐹)        √𝑇
                                                                𝐹⊤ 𝑊2 𝑒𝑖   +     Λ
                                                                               √𝑁 𝑖
                                                                                       ( 𝑁 Λ⊤ Λ)        √𝑁
                                                                                                           Λ⊤ 𝑒𝑡⊤   + 𝑜𝑝 (1)
     with 𝛿 = min(𝑁, 𝑇).

We just need to replace the factors and asset space by their projected counterpart 𝑊𝐹 and 𝑊𝑋 in
Bai’s (2003) proofs. Conventional PCA, i.e. 𝛾 = −1 is a special case of our result, which typically
leads to ineﬃcient estimation.


Lemma 1: If 𝜇𝐹 ≠ 0, then it is not eﬃcient to use the covariance matrix for estimating the loadings and
common components, i.e. the choice of 𝛾 = −1 does not lead to the smallest asymptotic covariance
matrix for the loadings and common components.


   In order to get a better intuition we consider an example with i.i.d. residuals over time. This
simpliﬁed model will be more comparable to the weak factor model in the next section.


Example 1: Simpliﬁed Strong Factor Model
                            𝑁
  1. Rate: Assume that      𝑇
                                → 𝑐 with 0 < 𝑐 < ∞.

  2. Factors: The factors 𝐹 are uncorrelated among each other and are independent of 𝑒 and Λ and
     have bounded ﬁrst two moments.


                                          𝑇                                          𝜎𝐹21               ⋯   0
                                     1          𝑝                      1          𝑝⎛                          ⎞
                         𝜇𝐹̂ ∶=          ∑ 𝐹𝑡 → 𝜇𝐹            Σ̂𝐹 ∶= 𝐹𝑡 𝐹𝑡⊤ → Σ𝐹 = ⎜
                                                                                   ⎜
                                                                                   ⎜⋮                   ⋱  ⋮⎟ ⎟
                                                                                                              ⎟.
                                     𝑇   𝑡=1                        𝑇                                      2
                                                                                   ⎝ 0                  ⋯ 𝜎𝐹𝐾 ⎠

                             𝑝
  3. Loadings: Λ⊤ Λ/𝑁 → 𝐼𝐾 and all loadings are bounded. The loadings are independent of the
     factors and residuals.


                                                                  10
                                                                                         𝑖.𝑖.𝑑.
   4. Residuals: Residual matrix can be represented as 𝑒 = 𝜖Σ with 𝜖𝑡,𝑖 ∼ 𝑁(0, 1). All elements and
      all row sums of Σ are bounded.


Corollary 1: Simpliﬁed Strong Factor Model:
The assumptions of example 1 hold. The factors and loadings can be estimated consistently. The
asymptotic distribution of the factors is not aﬀected by 𝛾. The asymptotic distribution of the loadings
is given by

                                                                 𝐷
                                       √𝑇 (𝐻⊤ Λ̂ 𝑖 − Λ𝑖 ) → 𝑁(0, Ω𝑖 ),

         2
where 𝐸[𝑒𝑡,𝑖 ] = 𝜎𝑒2𝑖 and

                                               −1                                                          −1
              Ω𝑖 = 𝜎𝑒2𝑖 (Σ𝐹 + (1 + 𝛾)𝜇𝐹 𝜇𝐹⊤ )       (Σ𝐹 + (1 + 𝛾)2 𝜇𝐹 𝜇𝐹⊤ ) (Σ𝐹 + (1 + 𝛾)𝜇𝐹 𝜇𝐹⊤ )               .

The optimal choice for the weight minimizing the asymptotic variance is 𝛾 = 0. Choosing 𝛾 = −1, i.e.
the covariance matrix for factor estimation, is not eﬃcient.


   The estimator in the strong factor model can be formulated as a GMM problem. Up to a remainder
term that vanishes under appropriate rate conditions the loading estimator is given by

                                                                 −1
                                       𝐻⊤ Λ̂ 𝑖 = (𝐹⊤ 𝑊2 𝐹)            𝐹⊤ 𝑊2 𝑋𝑖 .

This is equivalent to combining the OLS and the pricing moment conditions with a weight 𝛾. More
speciﬁcally, we deﬁne the following 𝐾 + 1 population and sample moments

                                                    −1/2                           1               ⊤                −1/2
                     𝑋𝑡,𝑖 − 𝐹𝑡 Λ⊤            ⊤
                                𝑖 )𝐹𝑡 (𝐸[𝐹𝑡 𝐹𝑡 ])                                      (𝑋𝑖 − 𝐹Λ⊤       ⊤
                                                                                               𝑖 ) 𝐹 (𝐹 𝐹)
     𝐺(Λ𝑖 ) = 𝐸 ⎡⎛                                         ⎞⎤         ̂ 𝑖 ) = ⎛ √𝑇
                                                                     𝐺(Λ                                                   ⎞
                ⎣⎝           𝐸[𝑋𝑖 − 𝐹𝑡 Λ𝑖⊤ ]               ⎠⎦                 ⎝
                                                                                         1
                                                                                         𝑇
                                                                                             (𝑋𝑖 − 𝐹Λ⊤
                                                                                                     𝑖 )
                                                                                                           ⊤
                                                                                                               1           ⎠

The ﬁrst 𝐾 moments are identical to the OLS ﬁrst order condition of a regression of 𝑋 on 𝐹. The last
moment is the APT pricing moment equation. The GMM estimator

                                                      𝐼               0
                                                   ̂ ⎛𝐾
                                           argmin 𝐺⊤                   ⎞ 𝐺̂
                                                     ⎝0               𝛾⎠

has the solution 𝐻⊤ Λ̂ 𝑖 .


5. Weak Factor Model

   If factors are weak rather than strong RP-PCA can detect factors that are not estimated by conven-
tional PCA. Weak factors aﬀect only a smaller fraction of the assets. After normalizing the loadings,
a weak factor can be interpreted as having a small variance. If the variance of a weak factor is below
a critical value, it cannot be detected by PCA. However, the signal of RP-PCA depends on the mean
and the variance of the factors. Thus, RP-PCA can detect weak factors with a high Sharpe-ratio even

                                                            11
if their variance is below the critical detection value. Weak factors can only be estimated with a bias
but the bias will generally be smaller for RP-PCA than for PCA.
                                                                                                                  1 ⊤
      In a weak factor model Λ⊤ Λ is bounded in contrast to a strong factor model in which                        𝑁
                                                                                                                    Λ Λ   is
bounded. The statistical model for analyzing weak factor models is based on spiked covariance mod-
els from random matrix theory. It is well-known that under the assumptions of random matrix the
eigenvalues of a sample covariance matrix separate into two areas: (1) the bulk spectrum with the
majority of the eigenvalues that are clustered together and (2) some spiked large eigenvalues sepa-
rated from the bulk. Under appropriate assumptions the bulk spectrum converges to the generalized
Marchenko-Pastur distribution. The largest eigenvalues are estimated with a bias which is charac-
terized by the Stieltjes transform of the generalized Marchenko-Pastur distribution. If the largest
population eigenvalues are below some critical threshold, a phase transition phenomena occurs. The
estimated eigenvalues will vanish in the bulk spectrum and the corresponding estimated eigenvectors
will be orthogonal to the population eigenvectors.11
                                                                                  1 ⊤
    The estimator of the loadings Λ̂ are the ﬁrst 𝐾 eigenvectors of               𝑇
                                                                                    𝑋 𝑋 + 𝛾𝑋̄𝑋̄⊤ .    Conventional PCA
                                                                         12
of the sample covariance matrix corresponds to 𝛾 = −1.                        The estimators of the factors are the
regression of the returns on the loadings, i.e. 𝐹 ̂ = 𝑋Λ.̂

5.1. Assumptions
      We impose the following assumptions on the approximate factor model:


Assumption 2: Weak Factor Model

  A: Rate: Assume that N/𝑇 → 𝑐 with 0 < 𝑐 < ∞.

   B: Factors: The factors 𝐹 are uncorrelated among each other and are independent of 𝑒 and Λ and
        have bounded ﬁrst two moments.


                                        𝑇                                      𝜎𝐹21         ⋯     0
                                    1         𝑝               1           𝑝  ⎛                    ⎞
                           𝜇𝐹̂ ∶=       ∑ 𝐹𝑡 → 𝜇𝐹       Σ̂𝐹 ∶= 𝐹𝑡 𝐹𝑡⊤ → Σ𝐹 = ⎜
                                                                             ⎜
                                                                             ⎜⋮             ⋱  ⋮⎟ ⎟
                                                                                                  ⎟.
                                    𝑇   𝑡=1                   𝑇                                2
                                                                             ⎝ 0            ⋯ 𝜎𝐹𝐾 ⎠

                           𝑝
  C: Loadings: Λ⊤ Λ → 𝐼𝐾 and the column vectors of the loadings Λ are orthogonally invariant (e.g.
        Λ𝑖,𝑘 ∼ 𝑁(0, 1/𝑁) and independent of the factors and residuals.

  D: Residuals: The empirical eigenvalue distribution function of Σ converges almost surely weakly to
        a non-random spectral distribution function with compact support. The supremum of the support
        is 𝑏 and the largest eigenvalues of Σ converge to 𝑏.

 11
     Onatski (2012) studies weak factor models and shows the phase transition phenomena for weak factors estimated with
PCA. Our paper provides a solution to this factor detection problem. It is important to notice that essentially all models in
random matrix theory work with processes with mean zero. However, RP-PCA crucially depends on using non-zero means
of random variables. Hence, we need to develop new arguments to overcome this problem.
  12
     The properties of weak factor models based on covariances have already been studied in Onatski (2012), Paul (2007) and
Benaych-Georges and Nadakuditi (2011). We replicate those results applied to our setup. They will serve as a benchmark
for the more complex risk-premium estimator.


                                                            12
      Assumption 2.C can be interpreted as considering only well-diversiﬁed portfolios as factors. It
essentially assumes that the portfolio weights of the factors are random with a variance of 1/𝑁.
                                                                                                                              𝑖.𝑖.𝑑.
The orthogonally invariance assumption on the loading vectors is satisﬁed if for example Λ𝑖,𝑘 ∼
𝑁(0, 1/𝑁). This is certainly a stylized assumption, but it allows us to derive closed-form solutions
that are easily interpretable.13 Assumption 2.D is a standard assumption in random matrix theory.14
The assumption allows for non-trivial weak cross-sectional correlation in the residuals, but excludes
serial-correlation. It implies clustering of the largest eigenvalues of the population covariance matrix
of the residuals and rules out that a few linear combinations of idiosyncratic terms have an unusually
large variation which could not be separated from the factors. It can be weakened as in Onatski
(2012) when considering estimation based on the covariance matrix. However, when including the
risk-premium in the estimation it seems that the stronger assumption is required. Many relevant
cross-sectional correlation structures are captured by this assumption e.g. sparse correlation matrices
or an ARMA-type dependence.

5.2. Asymptotic Results
      In order to state the results for the weak factor model, we need to deﬁne several well-known objects
from random matrix theory. We deﬁne the average idiosyncratic noise as 𝜎𝑒2 ∶= trace(Σ)/𝑁, which
is the average of the eigenvalues of Σ. If the residuals are i.i.d. distributed 𝜎𝑒2 would simply be their
variance. Our estimator will depend strongly on the dependency structure of the residual covariance
matrix which can be captured by their eigenvalues. Denote by 𝜆1 ≥ 𝜆2 ≥ ... ≥ 𝜆𝑁 the ordered
                  1 ⊤
eigenvalues of    𝑇
                    𝑒 𝑒.   The Cauchy transform (also called Stieltjes transform) of the eigenvalues is the
almost-sure limit:

                                               𝑁                                                           −1
                                          1              1                  1                   1
                  𝐺(𝑧) = 𝑎.𝑠. lim             ∑              = 𝑎.𝑠. lim         trace ((𝑧𝐼𝑁 −       𝑒⊤ 𝑒))         .
                                   𝑇→∞    𝑁   𝑖=1
                                                    𝑧 − 𝜆𝑖            𝑇→∞   𝑁                   𝑇

This function is well-deﬁned for 𝑧 outside the support of the eigenvalues. This Cauchy transform is
a well-understood object in random matrix theory. For simple cases analytical solutions exist and for
general Σ it can easily be simulated or estimated from the data.
      A second important transformation of the residual eigenvalues is

                                   𝑁                                                                  −2
                               𝑐              𝜆𝑖                      𝑐                    1                   1
           𝐵(𝑧) = 𝑎.𝑠. lim         ∑                     = 𝑎.𝑠. lim       trace (((𝑧𝐼𝑁 −       𝑒⊤ 𝑒))      (       𝑒⊤ 𝑒)) .
                        𝑇→∞   𝑁    𝑖=1
                                         (𝑧 − 𝜆𝑖    )2         𝑇→∞    𝑁                    𝑇                   𝑇

The function 𝐵(𝑧) is proportional to the derivative of 𝐺(𝑧). For special cases a closed-form solution
is available and for the general case it can be easily estimated.
      The crucial tool for understanding RP-PCA is the concept of a “signal matrix” 𝑀. The signal matrix
essentially represents the largest true eigenvalues. For PCA estimation based on the sample covari-

 13
     Onatski (2012) does not impose orthogonally invariant loadings, but requires the loadings to be the eigenvectors of
1 ⊤
𝑇
  𝑒 𝑒.  In order to make progress we need to impose some kind of assumption that allows us to diagonalize the residual
covariance matrix without changing the structure of the systematic part.
  14
     Similar assumptions have been imposed in Onatski (2010), Onatski (2012), Harding (2013) and Ahn and Horenstein
(2013).


                                                                13
ance matrix the signal matrix 𝑀PCA equals:

                                                       𝜎𝐹21 + 𝑐𝜎𝑒2        ⋯        0
                                                  ⎛                                           ⎞
                          𝑀PCA   = Σ𝐹 + 𝑐𝜎𝑒2 𝐼𝐾 = ⎜
                                                  ⎜
                                                  ⎜           ⋮           ⋱        ⋮          ⎟
                                                                                              ⎟
                                                                                              ⎟
                                                   ⎝          0           ⋯ 𝜎𝐹2𝐾 + 𝑐𝜎𝑒2 ⎠

and the “signals” are the 𝐾 largest eigenvalues 𝜃1PCA , .., 𝜃𝐾
                                                             PCA
                                                                 of this matrix. The “signal matrix” for
RP-PCA 𝑀RP-PCA is deﬁned as

                                                                    1/2
                                       Σ𝐹 + 𝑐𝜎𝑒2       Σ𝐹 𝜇𝐹 (1 + 𝛾)
                                                                   ̃
                          𝑀RP-PCA = ⎛ ⊤ 1/2                              ⎞.
                                    ⎝𝜇𝐹 Σ𝐹 (1 + 𝛾)
                                                 ̃ (1 + 𝛾)(𝜇𝐹 𝜇𝐹 + 𝑐𝜎22 )⎠
                                                            ⊤



We deﬁne 𝛾̃ = √𝛾 + 1 − 1 and note that (1 + 𝛾)          ̃ 2 = 1 + 𝛾. The RP-PCA “signals” are the 𝐾 largest
eigenvalues 𝜃1RP-PCA , .., 𝜃𝐾
                            RP-PCA
                                   of 𝑀RP-PCA . Intuitively, the signal of the factors is driven by Σ𝐹 + (1 +
𝛾)𝜇𝜇⊤ , which has the same eigenvalues as

                                                              1/2
                                            Σ𝐹       Σ𝐹 𝜇𝐹 (1 + 𝛾) ̃
                                   ⎛                                   ⎞.
                                       ⊤ 1/2                   ⊤
                                   ⎝ 𝜇𝐹 Σ 𝐹  (1 + 𝛾)
                                                   ̃ (1 + 𝛾)(𝜇𝐹  𝜇𝐹  ) ⎠

                                                               𝑐𝜎𝑒2      0
This is disturbed by the average noise which adds the matrix ⎛                  ⎞. Note that the dis-
                                                             ⎝ 0    (1 + 𝛾)𝑐𝜎𝑒2 ⎠
turbance also depends on the parameter 𝛾. We denote the corresponding orthonormal eigenvectors
of 𝑀PCA by 𝑈:̃

                                                       𝜃1RP-PCA     ⋯         0
                                                   ⎛                              ⎞
                                 𝑈̃ ⊤ 𝑀RP-PCA 𝑈̃ = ⎜
                                                   ⎜
                                                   ⎜     ⋮          ⋱         ⋮   ⎟
                                                                                  ⎟
                                                                                  ⎟.
                                                                       RP-PCA
                                                  ⎝       0         ⋯ 𝜃𝐾+1    ⎠

Unlike the conventional case of the covariance matrix with uncorrelated factors we cannot link the
eigenvalues of 𝑀RP-PCA with speciﬁc factors. The rotation 𝑈̃ tells us how much the ﬁrst eigenvalue
contributes to the ﬁrst 𝐾 factors, etc..


Theorem 2: Risk-Premium PCA under weak factor model
Assume Assumption 2 holds. We denote by 𝜃1 , ..., 𝜃𝐾 the ﬁrst 𝐾 largest eigenvalues of the signal matrix
                                                                             1            11⊤
𝑀 = 𝑀PCA or 𝑀 = 𝑀RP-PCA . The ﬁrst 𝐾 largest eigenvalues 𝜃𝑖̂ 𝑖 = 1, ..., 𝐾 of 𝑋⊤ (𝐼𝑇 + 𝛾      ) 𝑋 satisfy
                                                                                              𝑇   𝑇


                                        1                                               1
                               𝑝 ⎧ 𝐺−1 ( )              if 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡 = lim𝑧↓𝑏
                           𝜃𝑖̂ → ⎨      𝜃𝑖                                             𝐺(𝑧)

                                 ⎩ 𝑏                    otherwise.




                                                        14
      The correlation of the estimated with the true factors15 converges to

                                                              𝜌1        0    ⋯    0
                                                            ⎛
                                                            ⎜                      ⎞
                                                            ⎜0          𝜌2   ⋯    0⎟
                                                                                   ⎟
                                     ̂
                                     Corr(𝐹, 𝐹)̂ =    ⏟̃
                                                      𝑄     ⎜
                                                            ⎜                      ⎟
                                                                                   ⎟        ⏟̃
                                                                                            𝑅
                                                            ⎜
                                                            ⎜0          0    ⋱    ⋮⎟
                                                                                   ⎟
                                                   𝑟𝑜𝑡𝑎𝑡𝑖𝑜𝑛                              𝑟𝑜𝑡𝑎𝑡𝑖𝑜𝑛
                                                            ⎝0          ⋯    0    𝜌𝐾 ⎠

with

                                                        1
                                               𝑝 ⎧         ̂             if 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡
                                           𝜌𝑖2 → ⎨ 1+𝜃𝑖 𝐵(𝜃𝑖 ))
                                                 ⎩ 0                     otherwise



For 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡 the correlation 𝜌𝑖 is strictly increasing in 𝜃𝑖 . If 𝜇𝐹 ≠ 0, then for any 𝛾 > −1 RP-PCA has
higher correlations 𝜌𝑖 than PCA and RP-PCA strictly dominates PCA in terms of detecting factors, i.e.
𝜌𝑖 > 0.
      The rotation matrices satisfy 𝑄̃ ⊤ 𝑄̃ ≤ 𝐼𝐾 and 𝑅̃ ⊤ 𝑅̃ ≤ 𝐼𝐾 . Hence, the correlation 𝐶𝑜𝑟𝑟(𝐹
                                                                                           ̂ 𝑖 , 𝐹𝑖̂ ) is not
necessarily an increasing function in 𝜃. For 𝛾 > −1 the rotation matrices equal:

                                                                              1/2 −1/2
                                           𝑄̃ = (𝐼𝐾         ̃
                                                        0) 𝑈1∶𝐾         𝑅̃ = 𝐷𝐾 Σ̂𝐹 ̂ ,

       ̃
where 𝑈1∶𝐾 are the ﬁrst 𝐾 columns of 𝑈̃ and

                                            ⊤
                           𝜌     ⋯     0                           𝜌1    ⋯    0
                       ⎛⎛ 1           ⎞                          ⎛            ⎞   1 − 𝜌12           ⋯    0     ⎞
                       ⎜⎜                                                                                      ⎟
                   1/2 ⎜⎜  ⋮     ⋱ ⋮⎟ ⎟        𝐼𝐾         0      ⎜
                                                                 ⎜⋮      ⋱ ⋮⎟ ⎟ ⎛
                                                                                ⎜ ⋮                          ⎞
                                                                                                             ⎟ ⎟ 1/2
          Σ̂𝐹 ̂ = 𝐷𝐾 ⎜ ⎜⎜⎜            ⎟
                                      ⎟ 𝑈̃ ⊤ ⎛              ⎞ 𝑈̃ ⎜
                                                                 ⎜            ⎟
                                                                              ⎟+⎜
                                                                                ⎜                   ⋱   ⋮ ⎟  ⎟⎟
                                                                                                               ⎟𝐷
                         ⎜
                       ⎜⎜ 0           ⎟
                                 ⋯ 𝜌𝐾 ⎟      ⎝0           0⎠ ⎜   ⎜0      ⋯ 𝜌𝐾 ⎟
                                                                              ⎟                                ⎟ 𝐾
                       ⎜                                                                                   2 ⎟
                                                                                ⎝ 0                 ⋯ 1 − 𝜌𝐾 ⎠
                       ⎝⎝ 0      ⋯ 0⎠                            ⎝0      ⋯ 0⎠                                  ⎠
          𝐷𝐾 = 𝑑𝑖𝑎𝑔 ((𝜃1̂        ⋯ 𝜃𝐾̂ ))

For PCA (𝛾 = −1) the rotation matrices simplify to 𝑄̃ = 𝑅̃ = 𝐼𝐾 .


      Theorem 2 states that the asymptotic behavior of the estimator can be completely explained by
the signals of the factors for a given distribution of the idiosyncratic shocks. The theorem also states
that weak factors can only be estimated with a bias. If a factor is too weak then it cannot be detected
at all. Weak factors can always be better detected using Risk-Premium-PCA instead of covariance PCA.
The phase transition phenomena that hides weak factors can be avoided by putting some weight on
the information captured by the risk-premium. Based on our asymptotic theory, we can choose the
optimal weight 𝛾 depending on our objective, e.g. to make all weak factors detectable or achieving
the largest correlation for a speciﬁc factor. Typically the rotation matrices 𝑈̃ and 𝑉̃ are decreasing in
𝛾 while 𝜌𝑖 is strictly increasing in 𝛾, yielding an optimal value for the largest correlation.


 15   ̂               1        11⊤    −1/2
                                             1        11⊤        1         11⊤     −1/2
      Corr(𝐹, 𝐹)̂ = ( 𝑇 𝐹⊤ (𝐼 − 𝑇 ) 𝐹)     ( 𝑇 𝐹⊤ (𝐼 − 𝑇 ) 𝐹)̂ ( 𝑇 𝐹⊤̂ (𝐼 − 𝑇 ) 𝐹)̂     .


                                                                  15
5.3. Examples
   In order to obtain a better intuition for the problem we consider two special cases. First, we
analyze the eﬀect of 𝛾 in the case of only one factor. Second, we study PCA for the special case of
cross-sectionally uncorrelated residuals.


Example 2: One-factor model
Assume that there is only one factor, i.e. 𝐾 = 1. We introduce the following notation
                                    𝑐⋅𝜎𝑒2
   • Noise-to-signal ratio: Γ𝑒 =     𝜎𝐹2
                           𝜇
   • Sharpe-ratio: 𝑆𝑅 = 𝜎𝐹 .
                             𝐹

   • Φ(𝜃𝑖 ) ∶= 𝐵(𝜃𝑖̂ (𝜃𝑖 )).

The signal matrix 𝑀𝑅𝑃−𝑃𝐶𝐴 simpliﬁes to

                                                1 + Γ𝑒    𝑆𝑅√1 + 𝛾
                               𝑀RP-PCA = 𝜎𝐹2 ⎛            2
                                                                        ⎞
                                             ⎝𝑆𝑅√1 + 𝛾 (𝑆𝑅 + Γ𝑒 )(1 + 𝛾)⎠

and has the largest eigenvalue:

                      1
                   𝜃 = 𝜎𝐹2 (1 + Γ𝑒 + (𝑆𝑅2 + Γ𝑒 )(1 + 𝛾)
                      2
                       + √(1 + Γ𝑒 + (𝑆𝑅2 + Γ𝑒 )(1 + 𝛾))2 − 4(1 + 𝛾)Γ𝑒 (1 + 𝑆𝑅2 + Γ𝑒 ).


Corollary 2: One-factor model
Assume Assumption 2 holds and 𝐾 = 1. The correlation between the estimated and true factor has the
following limit:

                                                𝑝                           1
                                 ̂
                                 Corr(𝐹, 𝐹)̂ 2 →                                              2
                                                                             𝜃
                                                                        (     2   −(1+Γ𝑒 ))
                                                        1 + 𝜃Ψ(𝜃) ⎛                               + 1⎞
                                                                            𝜎𝐹
                                                                  ⎜          𝑆𝑅2 (1+𝛾)
                                                                                                     ⎟
                                                                  ⎝                                  ⎠

and the estimated Sharpe-ratio converges to

                                                    𝜃
                                            𝑝       𝜎𝐹2
                                                          − (1 + Γ𝑒 )
                                        ̂→
                                        𝑆𝑅                              ̂
                                                                        Corr(𝐹,  ̂
                                                                                𝐹).
                                                     𝑆𝑅(1 + 𝛾)

For 𝛾 → ∞ these limits converge to

                                                    𝑝          1
                                  ̂
                                  Corr(𝐹, 𝐹)̂ 2 →                     Γ𝑒2
                                                          1 + Γ𝑒 +   𝑆𝑅2
                                                    𝑝              Γ𝑒                  1
                                            ̂ → (𝑆𝑅 +
                                            𝑆𝑅                          )                                .
                                                                   𝑆𝑅                              Γ𝑒2
                                                                             1 + Γ𝑒 +
                                                                            √                     𝑆𝑅2




                                                              16
In the case of PCA, i.e. 𝛾 = −1 the expression simpliﬁes to

                                                                𝑝      1
                                             ̂
                                             Corr(𝐹, 𝐹)̂ 2 →
                                                                    1 + 𝜃Ψ(𝜃)

with 𝜃PCA = 𝜎𝐹2 (1 + Γ𝑒 ).


    A smaller noise-to-signal ratio Γ𝑒 and a larger Sharpe-ratio combined with a large 𝛾 lead to a more
precise estimation of the factors. In the simulation section we ﬁnd the optimal value of 𝛾 to maximize
                                                                                                                              2
                                                                                                                 𝜃
                                                                                                            (     2   −(1+Γ𝑒 ))
                                                                                                                𝜎𝐹
the correlation. Note that a larger value of 𝛾 decreases 𝜃Ψ(𝜃), while it increases                               𝑆𝑅2 (1+𝛾)
                                                                                                                                  , creating
a trade-oﬀ. In all our simulations 𝛾 = −1 was never optimal.
    Now we study PCA for the special case of cross-sectionally uncorrelated residuals but many fac-
tors16


Example 3: PCA for model with independent residuals
Assume that 𝑒𝑡,𝑖 i.i.d. 𝑁(0, 𝜎𝑒2 ), i.e. Σ = 𝜎𝑒2 𝐼𝑁 . In this case the residual eigenvalues follow the well-
                                                                          𝑁
known Marcenko-Pasteur Law. For simplicity assume that                    𝑇
                                                                              → 𝑐 with 𝑐 > 1. The results can be easily
extended to the case 0 < 𝑐 < 1.
    The maximum residual eigenvalue equals 𝑏 = 𝜎𝑒2 (1 + √𝑐)2 . The Cauchy transform takes the form

                                        𝑧 − 𝜎𝑒2 (1 − 𝑐) − √(𝑧 − 𝜎𝑒2 (1 + 𝑐))2 − 4𝑐𝜎𝑒2
                             𝐺(𝑧) =                                                               .
                                                                2𝑐𝑧𝜎𝑒2

                                                                                1
Hence, the critical value for detecting factors is now 𝜃𝑐𝑟𝑖𝑡 =                𝐺(𝑏+ )
                                                                                       = 𝜎𝑒2 (𝑐 + √𝑐). The inverse of the
Cauchy transform and the B-function are given explicitly by

                                                𝜎𝑒2 (1−𝑐)
                                1            1+
                         𝐺−1 ( ) = 𝑧 ⎛               𝑧
                                                   𝑐𝜎2
                                                            ⎞
                              𝑧      ⎝ 1        − 𝑧𝑒        ⎠
                                                      𝑧 − 𝜎𝑒2 (1 + 𝑐)                             1
                              𝐵(𝑧) =                                                         −          .
                                         2𝜎𝑒2 √𝑧2   − 2(1 +     𝑐)𝜎𝑒2 𝑧   + (𝑐 −   1)2 𝜎𝑒4       2𝜎𝑒2


Corollary 3: PCA for model with independent residuals
Assumption 2 holds and 𝑒𝑡,𝑖 i.i.d. 𝑁(0, 𝜎𝑒2 ). The largest 𝐾 eigenvalues of the sample covariance matrix
have the following limiting values:
                                    2
                     𝑝  ⎧
                        ⎪ 𝜎𝐹2𝑖 + 𝜎𝑒2 (𝑐 + 1 + 𝜎𝑒2 )             if 𝜎𝐹2𝑖 + 𝑐𝜎𝑒2 > 𝜃𝑐𝑟𝑖𝑡 ⇔ 𝜎𝐹2 > √𝑐𝜎𝑒2
                                 𝜎𝐹𝑖
                 𝜆̂ 𝑖 → ⎨
                        ⎪ 𝜎𝑒2 (1 + √𝑐)2                         otherwise.
                        ⎩

  16
     These results have already been shown in Onatski (2012), Paul (2007) and Benaych-Georges and Nadakuditi (2011). We
present them to provide intuition for the model.




                                                            17
The correlation between the estimated and true factors converges to

                                                      𝜌1            ⋯     0
                                                  𝑝 ⎛                      ⎞
                                       ̂        ̂   ⎜
                                       Corr(𝐹, 𝐹) → ⎜                     ⋮⎟
                                                                           ⎟
                                                    ⎜⋮              ⋱      ⎟
                                                    ⎝0              ⋯ 𝜌𝐾 ⎠

with

                                               𝑐𝜎𝑒4
                                   ⎧
                                   ⎪
                                   ⎪         1−  4
                               𝑝   ⎪
                                   ⎪
                                               𝜎𝐹
                                                  𝑖
                                                                if 𝜎𝐹2𝑖 + 𝑐𝜎𝑒2 > 𝜃𝑐𝑟𝑖𝑡
                                       𝑐𝜎2    𝜎𝑒4
                           𝜌𝑖2 → ⎨ 1+ 𝜎𝐹2𝑒   + 4 (𝑐2 −𝑐)
                                              𝜎𝐹
                                 ⎪
                                 ⎪
                                 ⎪       𝑖      𝑖
                                 ⎪ 0                            otherwise.
                                 ⎩


   Note that for 𝜎𝐹2𝑖 going to inﬁnity, we are back in the strong factor model and the estimator be-
comes consistent.


6. Simulation

   Next, we illustrate the performance of RP-PCA and its ability to detect weak factors with high
Sharpe-ratios using a simulation exercise. We simulate factor models that try to replicate moments
of the data that we are going to study in section 7. The parameters of the factors and idiosyncratic
components are based on our empirical estimates. We analyze the performance of RP-PCA for diﬀer-
ent values of 𝛾, sample size and strength of the factors. Conventional PCA corresponds to 𝛾 = −1.
In a factor model only the product 𝐹Λ⊤ is well-identiﬁed and the strength of the factors could be
either modeled through the moments of the factors or the values of the loadings. Throughout this
                                                      𝑝
section we normalize the loadings to Λ⊤ Λ/𝑁 → 𝐼𝐾 and vary the moments of the factors. The factors
are uncorrelated with each others and have diﬀerent means and variances. The variance of the fac-
tor can be interpreted as the proportion of assets aﬀected by this factor. With this normalization a
factor with a variance of 𝜎𝐹2 = 0.5 could be interpreted as aﬀecting 50% of the assets with an average
loading strength of 1. The theoretical results for the weak factor model are formulated under the
                     𝑝
normalization Λ⊤ Λ → 𝐼𝐾 . The PCA signal in the weak factor framework corresponds to 𝜎𝐹2 ⋅ 𝑁 under
the normalization in the simulation.


   The strength of a factor has to be put into relationship with the noise level. Based on our theo-
                                             𝜎𝐹2                1     𝑁
retical results the signal to noise ratio    𝜎𝑒2
                                                   with 𝜎𝑒2 =   𝑁
                                                                          2
                                                                    ∑𝑖=1 𝜎𝑒,𝑖 determines the variance signal of a
factor. Our empirical results suggest a signal to noise ratio of around 5-7 for the ﬁrst factor which is
essentially a market factor. The remaining factors in the diﬀerent data sets seem to have a variance
signal between 0.04 and 0.8. Based on this insight we will model a four-factor model with variances
Σ𝐹 = 𝑑𝑖𝑎𝑔(5, 0.3, 0.1, 𝜎𝐹2 ). The variance of the fourth factor takes the values 𝜎𝐹2 ∈ {0.03, 0.1}. The
ﬁrst factor is a dominant market factor, while the second is also a strong factor. The third factor
is weak, while the fourth factor varies from very weak to weak. We normalize the factors to be un-
correlated with each other. The Sharpe-ratios are deﬁned as 𝑆𝑅𝐹 = (0.12, 0.1, 0.3, 𝑠𝑟), where the



                                                           18
                           1. Factor                                                       2. Factor
150                                                                20
             True factor
             RP-PCA =0                                             15
100          RP-PCA =10
             RP-PCA =20
             PCA                                                   10
 50
                                                                    5

  0
                                                                    0


-50                                                                 -5
      0      50       100           150    200       250                 0     50        100          150    200       250
                             Time                                                              Time

                           3. Factor                                                       4. Factor
 25                                                                25

 20                                                                20

 15                                                                15

 10                                                                10

  5                                                                 5

  0                                                                 0

 -5                                                                 -5
      0      50       100           150    200       250                 0     50        100          150    200       250
                             Time                                                              Time



Figure 1: Sample paths of the cumulative returns of the ﬁrst four factors and the estimated factor processes. The fourth
factor has a variance 𝜎𝐹2 = 0.03 and Sharpe-ratio 𝑠𝑟 = 0.5. 𝑁 = 74 and 𝑇 = 250.


Sharpe-ratio of the fourth factor varies between the following values 𝑠𝑟 ∈ {0.2, 0.3, 0.5, 0.8}. These
parameter values are consistent with our data sets.
      The properties of the estimation approach depend on the average idiosyncratic variance and de-
pendency structure in the residuals. We normalize the average noise variance 𝜎𝑒2 = 1, which implies
that the factor variances can be directly compared to the variance signals in the data.17 We use two
diﬀerent set of residual correlation matrices.



      First, the correlation matrix of our simulated residuals is set to the empirical correlation that
we observe in the data. In more detail, we have estimated the residual correlation matrix based
on 𝑁 = 25 size and value double-sorted portfolios, 𝑁 = 74 extreme deciles sorted portfolios and
𝑁 = 370 decile sorted portfolios as described in the empirical Section 7.18 In each case we have ﬁrst
regressed out the systematic factors and then estimated the residual covariance matrix with a hard

  17
     For the empirical data sets with 𝑁 = 370 assets the average noise variance is around 𝜎𝑒2 = 2.5. Instead of normalizing
𝜎𝑒2 = 1 we could also multiply Σ𝐹 by 2.5 and obtain the same factor model that is consistent with the data.
  18
     We use the same data set as Kozak, Nagel and Santosh (2017) to construct 𝑁 = 370 decile-sorted portfolios of monthly
returns from 07/1963 to 12/2017 (T=650). We use the lowest and highest decile portfolio for each anomaly to create a
data set of 𝑁 = 74 portfolios. The 𝑁 = 25 double-sorted portfolios are from Kenneth-French website for the same time
period.


                                                           19
        1. Factor Corr. (IS) for 2F =0.03          1. Factor Corr. (OOS) for 2F =0.03         1. Factor Corr. (IS) for 2F =0.1           1. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                                         0.6
       0.4                                         0.4                                      0.4                                         0.4
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20


        2. Factor Corr. (IS) for 2F =0.03          2. Factor Corr. (OOS) for 2F =0.03         2. Factor Corr. (IS) for 2F =0.1           2. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                                         0.6
       0.4                                         0.4                                      0.4                                         0.4
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20


        3. Factor Corr. (IS) for 2F =0.03          3. Factor Corr. (OOS) for 2F =0.03         3. Factor Corr. (IS) for 2F =0.1           3. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                                         0.6
       0.4                                         0.4                                      0.4                                         0.4
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20


        4. Factor Corr. (IS) for 2F =0.03          4. Factor Corr. (OOS) for 2F =0.03         4. Factor Corr. (IS) for 2F =0.1           4. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
                                                                                                                   SR=0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                    SR=0.5               0.6
       0.4                                         0.4                                      0.4                    SR=0.3               0.4
                                                                                                                   SR=0.2
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20




Figure 2: 𝑁 = 370, 𝑇 = 650: Correlation of estimated rotated factors in-sample and out-of-sample for diﬀerent variances
and Sharpe-ratios of the fourth factor and for diﬀerent RP-weights 𝛾. We use the empirical residual correlation matrix.


thresholding approach setting small values to zero.19 . This provides a consistent estimator of the
residual population covariance matrix. We have regressed out the ﬁrst 3 PCA factors for the ﬁrst data
set and the ﬁrst 6 PCA factors for the last two data sets.20 The remaining correlation structure in the
residuals is sparse. In particular the estimated eigenvalues of the simulated residuals coincide with
the empirical estimates of the eigenvalues. Second, for 𝑁 = 370 assets we create a sparse residual
correlation matrix based on Σ = 𝐶𝐶⊤ , where C is a matrix with where the ﬁrst 13 oﬀ-diagonal elements
take the value 0.7. The resulting covariance matrix is normalized to the corresponding correlation
matrix. The residuals are then generated as 𝑒𝑡 = 𝜖Σ where 𝜖𝑡 are i.i.d. draws from a multivariate
standard normal distribution.
         In the main part we consider only the cross-sectional dimension 𝑁 = 370 and time dimension
𝑇 = 650, but in the appendix we also study the combinations {𝑁 = 74, 𝑇 = 650} and {𝑁 = 25, 𝑇 =
240} motivated by our empirical analysis. The loadings are i.i.d draws from a standard multivariate
normal distribution. The factors are i.i.d. draws from a multivariate normal distribution with means

   19
   See Bickel and Levina (2008) and Fan, Liao and Mincheva (2013))
   20
   Our results remain unchanged when we calculate residuals based on more PCA factors or using RP-PCA factors. The
additional results are available upon request.


                                                                                  20
           1. Factor SR (IS) for 2F =0.03         1. Factor SR (OOS) for 2F =0.03              1. Factor SR (IS) for 2F =0.1           1. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
                                                                                                                  SR=0.8
     0.6                                         0.6                                     0.6                                         0.6
                                                                                                                  SR=0.5
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                      SR=0.3             0.4
                                                                                                                  SR=0.2
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20


           2. Factor SR (IS) for 2F =0.03         2. Factor SR (OOS) for 2F =0.03              2. Factor SR (IS) for 2F =0.1           2. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
     0.6                                         0.6                                     0.6                                         0.6
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                                         0.4
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20


           3. Factor SR (IS) for 2F =0.03         3. Factor SR (OOS) for 2F =0.03              3. Factor SR (IS) for 2F =0.1           3. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
     0.6                                         0.6                                     0.6                                         0.6
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                                         0.4
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20


           4. Factor SR (IS) for 2F =0.03         4. Factor SR (OOS) for 2F =0.03              4. Factor SR (IS) for 2F =0.1           4. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
     0.6                                         0.6                                     0.6                                         0.6
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                                         0.4
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20




Figure 3: 𝑁 = 370, 𝑇 = 650: Sharpe ratios of estimated rotated factors in-sample and out-of-sample for diﬀerent variances
and Sharpe-ratios of the fourth factor and for diﬀerent RP-weights 𝛾. We use the empirical residual correlation matrix.


and variances speciﬁed as above. The idiosyncratic components are i.i.d. draws from a multivari-
ate normal distribution with mean zero and covariance matrix based on a consistent estimation of
the empirical residual correlation matrix respectively the parametric band-diagonal matrix. For each
setup we run 100 Monte-Carlo simulations. For the out-of-sample results we ﬁrst estimate the loading
vector in-sample and then obtain the out-of-sample factor estimates by projecting the out-of-sample
returns on the estimated loadings.
      Figure 1 provides some intuition for our estimator. It illustrates the sample path estimates for
diﬀerent values of 𝛾. If the fourth factor is weak with a high Sharpe-ratio, then conventional PCA or
RP-PCA with a too small value of 𝛾 cannot detect it while RP-PCA with a suﬃciently large 𝛾 is able to
detect the factor.
      Figures 2 and 3 show correlations and Sharpe-ratios in the four-factor model for 𝑁 = 370 and
𝑇 = 650 based on the empirical residual correlation structure. A.10 and A.11 show the results for
𝑁 = 74.21 The risk-premium weight 𝛾 has the largest eﬀect on estimating the fourth factor if it is
weak (𝜎𝐹2 = 0.03) and has a high Sharpe ratio (𝑠𝑟 ≥ 0.3). The second takeaway is that the estimates

 21
      All simulation results in the appendix are based on the empirical residual correlation matrix.


                                                                               21
of the strong factors is essentially not aﬀected by the properties of the weak factors and vice versa.
Hence, one could ﬁrst estimate the strong factors and project them out and then estimate the weak
factors from the projected data. Motivated by this ﬁnding we will study a one-factor model in more
detail.
        Figure 4 compares the prediction of our weak factor model theory with the Monte-Carlo simulation
for the empirical and the band-diagonal residual correlation matrix. We consider one factor with
Sharpe-ratio 0.8, but increasing variance. The prediction of our statistical model is conﬁrmed by the
Monte-Carlo simulation. It convincingly shows how weak factors can be better estimated with RP-
PCA with a large 𝛾 when the Sharpe-ratio is high. In Figure 5 we plot the value of 𝜌𝑖2 in the weak
factor model which determines the detection and correlation of the factors. We vary the signal 𝜃
which among others depends on the choice of 𝛾. We compare uncorrelated residuals with our weak
dependency structures. It is apparent that increasing the signal strength for detecting weak factors
becomes more relevant for correlated residuals.


                         Statistical Model                                                    Statistical Model
        1                                                                         1


                                                   PCA ( =-1)                                                           PCA ( =-1)
                                                                          Corr
Corr




       0.5                                         RP-PCA ( =0)                  0.5                                    RP-PCA ( =0)
                                                   RP-PCA ( =10)                                                        RP-PCA ( =10)
                                                   RP-PCA ( =50)                                                        RP-PCA ( =50)
        0                                                                         0
             0        0.05                   0.1                   0.15                0   0.05                   0.1                   0.15
                                 2                                                                    2
                                 F                                                                    F
                      Monte-Carlo Simulation                                               Monte-Carlo Simulation
        1                                                                         1
                                                                          Corr
Corr




       0.5                                                                       0.5



        0                                                                         0
             0        0.05                   0.1                   0.15                0   0.05                   0.1                   0.15
                                 2                                                                    2
                                 F                                                                    F




Figure 4: Correlations between estimated and true factor based on the weak factor model prediction and Monte-Carlo
simulations for diﬀerent variances of the factor. Left plots: The residuals have cross-sectional correlation deﬁned by the
band-diagonal matrix. Right plots: The residuals have the empirical residual correlation matrix. The Sharpe-ratio of the
factor is 0.8, i.e. the mean equals 𝜇𝐹 = 0.8 ⋅ 𝜎𝐹 . We have 𝑇 = 650 and 𝑁 = 370, i.e. the normalized variance of the factors
in the weak factor model corresponds to 𝜎𝐹2 ⋅ 𝑁.




                                                                     22
      1                                                                 1


    0.8                                                                0.8


    0.6                                                                0.6
2




                                                                   2
    0.4                                                                0.4


    0.2                                                                0.2
                                     dependent residuals                                             dependent residuals
                                     i.i.d residuals                                                 i.i.d residuals
      0                                                                 0
          0     10        20         30                 40   50              0   10       20         30        40          50
                            signal                                                          signal


                                                    1
Figure 5: Model-implied values of 𝜌𝑖2 ( 1+𝜃 𝐵(𝜃 ̂ )) if 𝜃𝑖 > 𝜎𝑐𝑟𝑖𝑡
                                                              2
                                                                   and 0 otherwise) for diﬀerent signals 𝜃𝑖 . The average noise
                                                𝑖       𝑖
level is normalized in both cases to      𝜎𝑒2
                                         = 1. Left plots: The residuals have cross-sectional correlation deﬁned by the
band-diagonal matrix. Right plots: The residuals have the empirical residual correlation matrix.


    Figures 6 and 7 provide more reﬁned results for the one-factor model for 𝑁 = 370 and 𝑇 = 650
for the empirical and band-diagonal residual correlation matrix. We consider a factor variance 𝜎𝐹2 ∈
{0.03, 0.05, 0.1, 0.3, 1.0} which ranges from weak to strong factors. Figures A.12 to A.16 show the
results for 𝑁 = 74 and 𝑁 = 25 and include estimates of the root-mean-squared pricing errors. The
risk-premium weight 𝛾 has the largest eﬀect on correlations, Sharpe-ratios and pricing errors if the
factors are weak (𝜎𝐹2 = 0.03 or 0.05) and have a high Sharpe ratio (𝑠𝑟 ≥ 0.3). Note, that if there is not
much information in the mean, i.e. the Sharpe-ratio of the factor is low, a too high value 𝛾 > 10 can
lead to an overestimation of the Sharpe-ratio in-sample. This makes sense as if too much weight is
given to an uninformative mean, the estimator will pick up some of the non-zero residuals. Note, that
the out-of-sample results provide reliable estimates that are not aﬀected by overﬁtting issues. Our
estimator has a larger eﬀect for smaller values of 𝑁 as this implies a weaker signal for the factors.




                                                                  23
                                      2                                                      2                                                      2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                            Statistical Model   F
                                                                                               =0.05                            Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1
        1                                                      1                                                      1                                                       1                                                       1

                                       SR=0.8
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                             SR=0.5                 0.5                                                    0.5                                                     0.5                                                     0.5
                                       SR=0.3
                                       SR=0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                   0        5      10      15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03                  Monte-Carlo Simulation        F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                   0        5      10      15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                   0        5      10      15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                      2                                                      2                                                      2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                            Statistical Model   F
                                                                                               =0.05                            Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1

       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                   0        5      10      15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03                  Monte-Carlo Simulation        F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1

       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                   0        5      10      15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1

       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                   0        5      10      15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20




Figure 6: 𝑁 = 370, 𝑇 = 650: Correlations and Sharpe-ratios as a function of the RP-weight 𝛾 for diﬀerent variances and
Sharpe-ratios. The residuals have cross-sectional correlation deﬁned by the band-diagonal matrix.




                                                                                                                                        24
                                      2                                                     2                                                       2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                           Statistical Model   F
                                                                                              =0.05                             Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1
        1                                                      1                                                      1                                                       1                                                       1

                                       SR=0.8
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                             SR=0.5                 0.5                                                    0.5                                                     0.5                                                     0.5
                                       SR=0.3
                                       SR=0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03              Monte-Carlo Simulation            F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                      2                                                     2                                                       2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                           Statistical Model   F
                                                                                              =0.05                             Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1
       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03              Monte-Carlo Simulation            F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1
       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1
       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20




Figure 7: 𝑁 = 370, 𝑇 = 650: Correlations and Sharpe-ratios as a function of the RP-weight 𝛾 for diﬀerent variances and
Sharpe-ratios. The residuals have the empirical residual correlation matrix.



7. Empirical Application

             We apply our estimator to a large number of anomaly sorted portfolios. The same data is studied
in more detail in our companion paper Lettau and Pelger (2018). Based on the universe of U.S. ﬁrms in
CRSP, we consider 37 anomaly characteristics following standard deﬁnitions in Novy-Marx and Velikov
(2016), McLean and Pontiﬀ (2016) and Kogan and Tian (2015). We use the same data set as Kozak,
Nagel and Santosh (2017)22 who have sorted the stock returns in yearly rebalanced decile portfolios.
This gives us a total cross-section of 𝑁 = 370 portfolios of monthly returns from 07/1963 to 12/2017
(T=650).23 The risk-free rate to obtain excess returns is from Kenneth French’s website. We estimate
statistical factors for diﬀerent choices of 𝛾 and evaluate the maximum Sharpe-ratio, average pricing
error and explained variation in- and out-of-sample.
             Table 1 reports the results for 𝐾 = 3 and 𝐾 = 5 factors for RP-PCA with 𝛾 = 10 and PCA (𝛾 = −1).
𝑆𝑅 denotes the maximum Sharpe-ratio that can be obtained by a linear combination of the factors, i.e.

       22
    We thank the authors for sharing the data.
       23
    Kozak, Nagel and Santosh (2017) create a data set based on 50 anomalies, but 13 of these anomalies are only available
for a signiﬁcantly shorter time horizon. We choose only those anomalies that are available for the whole time horizon of
𝑇 = 650 observations.


                                                                                                                                        25
it combines the factors with the weights Σ−1
                                          𝐹 𝜇𝐹 . It measures how well the factors can approximate the
                                                                                               1   𝑁
stochastic discount factor. The root-mean-squared pricing error (𝑅𝑀𝑆𝛼) equals √ 𝑁 ∑𝑖=1 𝛼𝑖2 , where
the pricing error 𝛼𝑖 is the intercept of a time-series regression of the excess return of asset 𝑖 on the
factors. The idiosyncratic variation is the average variance of the residuals after regressing out the
factors. The in-sample analysis is based on the whole time horizon of 𝑇 = 650 months. The out-
of-sample analysis estimates the loadings with a rolling window of 20 years (𝑇 = 240). With these
estimated loadings including information up to time 𝑡 we predict the systematic return and obtain
a pricing error out-of-sample at 𝑡 + 1. This corresponds to a cross-sectional pricing regression with
out-of-sample loadings. The mean and variance of the out-of-sample errors are used to calculate the
average pricing error and the idiosyncratic variation. We use the optimal portfolio weights for the
maximum Sharpe-ratio portfolio estimated in the rolling window period to create an out-of-sample
optimal return giving us the maximum Sharpe-ratio portfolio out-of-sample.



                                              In-sample                     Out-of-sample
                                       SR    RMS 𝛼 Idio. Var.         SR     RMS 𝛼 Idio. Var.
                RP-PCA 3 factors      0.23     0.17      12.75%      0.18     0.15      14.57%
                   PCA 3 factors      0.17     0.17      12.68%      0.14     0.15      14.66%

                RP-PCA 5 factors      0.53     0.14      10.76%      0.45     0.12      12.70%
                   PCA 5 factors      0.24     0.14      10.66%      0.17     0.14      12.56%

Table 1: Maximal Sharpe-ratios, root-mean-squared pricing errors and idiosyncratic variation for diﬀerent number of
factors. RP-weight 𝛾 = 10.


   RP-PCA and PCA diﬀer the most in terms of the maximum Sharpe-ratio. For 𝐾 = 5 factors the
in- and out-of-sample Sharpe-ratio of RP-PCA is twice as large as for PCA. For 𝐾 = 3 factors there
is still a sizeable diﬀerence in Sharpe-ratios, but it is less pronounced than for a larger number of
factors. A possible reason is that the 4th or 5th factor is weak with a high Sharpe-ratio and only
picked up by RP-PCA, while the ﬁrst four factors are stronger and hence can be detected by PCA.
Surprisingly, the pricing errors and the unexplained variation are very close for the two methods.
Only the out-of-sample pricing error of RP-PCA is smaller than for PCA. It seems that RP-PCA selects
high Sharpe-ratio factors with smaller out-of-sample pricing errors without sacriﬁcing explanatory
power for the variation.


   Figure 8 analyzes the eﬀect of 𝛾 and the number of factors on the three criteria maximum Sharpe-
ratio, pricing error and variation. The Sharpe-ratio and pricing error change signiﬁcantly when includ-
ing the 5th factor. This 5th factor is also strongly aﬀected by the choice of 𝛾 and seems to require
𝛾 > 5 to be detected by RP-PCA. Adding the 6th factor has only a very minor eﬀect on the three cri-
teria. That is why we opt for a 5-factor model. The ﬁgure illustrates that the amount of unexplained
variation is insensitive to the choice of 𝛾. Hence, our factors capture more pricing information while
explaining the same amount of variation in the data.
   Table 2 shows that the variance signal for diﬀerent factors suggests the existence of weak factors.
Here we extract the ﬁrst 6 factors with RP-PCA (𝛾 = 10) and PCA. In addition, we include the pop-

                                                        26
                                   SR (In-sample)                                                           SR (Out-of-sample)

             0.6                                                                         0.6


             0.4                                                                         0.4
SR




                                                                             SR
             0.2                                                                         0.2


              0                                                                           0
                   0          5          10           15           20                          0           5          10         15          20

                                  RMS   (In-sample)                                                       RMS     (Out-of-sample)
             0.4                                                                         0.4

             0.3                                                                         0.3

             0.2                                                                         0.2

             0.1                                                                         0.1

              0                                                                           0
                   0          5          10           15           20                          0           5          10         15          20

                        Idiosyncratic Variation (In-sample)                                        Idiosyncratic Variation (Out-of-sample)


             15                                                                          15
 Variation




                                                                             Variation
                                                           1 factor
             10                                            2 factors                     10
                                                           3 factors
                                                           4 factors
              5                                            5 factors                      5
                                                           6 factors
              0                                                                           0
                   0          5          10           15           20                          0           5          10         15          20




Figure 8: Deciles of 37 single-sorted portfolios from 07/1963 to 12/2016 (𝑁 = 370 and 𝑇 = 650): Maximal Sharpe-ratios,
root-mean-squared pricing errors and unexplained idiosyncratic variation for diﬀerent values of 𝛾.


ular Fama-French 5 factors (marke, size, value, proﬁtability and investment) from Kenneth French’s
website. The variance signal is deﬁned as the largest eigenvalues of ΛΣ𝐹 Λ⊤ . We normalize these
                                                           1      𝑁
eigenvalue by the same constant 𝜎𝑒2 =                      𝑁
                                                                     2
                                                               ∑𝑖=1 𝜎𝑒,𝑖 based on the residuals from 6 PCA factors.24 This
makes the variance signals comparable to our simulation design. The 5th factor has a variance signal
around 0.05 which based on our simulation is well described by a weak factor model. The simu-
lations also predict that these weak factors can be better estimated by RP-PCA if they have a large
Sharpe-ratio. This is exactly what we observe in the data.
                                                                                               1     1
             The left plot in Figure 9 shows the eigenvalues of the matrix                     𝑁
                                                                                                   ( 𝑇 𝑋⊤ 𝑋 + 𝛾𝑋̄𝑋̄⊤ ) normalized by the
average idiosyncratic variance. Our weak factor model predicts that the signal of this matrix should
be larger for RP-PCA compared to PCA. The eigenvalue curves conﬁrm that the signal for the weaker
factors clearly separates from the PCA signal. 𝛾 = 10 seems to be suﬃcient for strengthening the
signal. The right plot in Figure 9 normalizes the eigenvalues by the corresponding PCA eigenvalues.
In particular the signal for the 6th factor is strengthened.

   24
             The results do not change if we regress out more PCA or RP-PCA factors and are available upon request.


                                                                        27
                                                                  PCA         RP-PCA (𝛾 = 10)                                   FF5
                                                           𝜎12    8.05                   8.05                                   8.00
                                                           𝜎22    0.27                   0.27                                   0.21
                                                           𝜎32    0.21                   0.21                                   0.17
                                                           𝜎42    0.14                   0.14                                   0.03
                                                           𝜎52    0.05                   0.05                                   0.02
                                                           𝜎62    0.03                   0.04                                   0.00

Table 2: Deciles of 37 single-sorted portfolios: Variance signal for diﬀerent factors: Largest eigenvalues of ΛΣ𝐹 Λ⊤ normal-
                                                  1   𝑁
ized by the average idiosyncratic variance 𝜎𝑒2 = 𝑁 ∑𝑖=1 𝜎𝑒,𝑖
                                                           2
                                                             .




                                             Eigenvalues                                                                                   Eigenvalues

                                                                        =-1                                           1.5                                      =0
                         0.25
                                                                        =0                                                                                     =1
                                                                        =1                                                                                     =5
Normalized Eigenvalues




                                                                                             Normalized Eigenvalues
                                                                        =5                                            1.4                                      =10
                          0.2
                                                                        =10                                                                                    =20
                                                                        =20
                                                                                                                      1.3
                         0.15


                          0.1                                                                                         1.2


                         0.05                                                                                         1.1


                           0                                                                                           1
                                2   4    6      8    10      12     14         16                                           2      4   6      8    10    12   14     16
                                               Number                                                                                        Number



Figure 9: Deciles of 37 single-sorted portfolios from 07/1963 to 12/2016 (𝑁 = 370 and 𝑇 = 650): Largest normalized
                           1   1
eigenvalues of the matrix 𝑁 ( 𝑇 𝑋⊤ 𝑋 + 𝛾𝑋̄𝑋̄⊤ ) for diﬀerent RP-weights 𝛾. Left plot: Eigenvalues are normalized by di-
                                                                                    1    𝑁
vision through the average idiosyncratic variance 𝜎𝑒2 = 𝑁 ∑𝑖=1 𝜎𝑒,𝑖
                                                                  2
                                                                    estimated by the average of the non-systematic PCA
eigenvalues. Right plot: Eigenvalues are normalized by the corresponding PCA (𝛾 = −1) eigenvalues.




8. Conclusion

                          We develop a new estimator for latent asset pricing factors from large data sets. Our estimator
is essentially a regularized version of PCA that puts a penalty on the pricing error. We derive the
asymptotic distribution theory under weak and strong factor model assumptions and show that our
estimator RP-PCA strongly dominates conventional PCA. We can detect weak factors with high Sharpe-
ratios which are undetectable with PCA. Strong factors are estimated more eﬃciently with RP-PCA
compared to PCA.




                                                                                        28
Appendix A. Simulation

Appendix A.1. Multi-Factor Model



        1. Factor Corr. (IS) for 2F =0.03          1. Factor Corr. (OOS) for 2F =0.03         1. Factor Corr. (IS) for 2F =0.1           1. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                                         0.6
       0.4                                         0.4                                      0.4                                         0.4
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20


        2. Factor Corr. (IS) for 2F =0.03          2. Factor Corr. (OOS) for 2F =0.03         2. Factor Corr. (IS) for 2F =0.1           2. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                                         0.6
       0.4                                         0.4                                      0.4                                         0.4
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20


        3. Factor Corr. (IS) for 2F =0.03          3. Factor Corr. (OOS) for 2F =0.03         3. Factor Corr. (IS) for 2F =0.1           3. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                                         0.6
       0.4                                         0.4                                      0.4                                         0.4
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20


        4. Factor Corr. (IS) for 2F =0.03          4. Factor Corr. (OOS) for 2F =0.03         4. Factor Corr. (IS) for 2F =0.1           4. Factor Corr. (OOS) for 2F =0.1

       0.8                                         0.8                                      0.8                                         0.8
                                                                                                                   SR=0.8
Corr




                                            Corr




                                                                                     Corr




                                                                                                                                 Corr
       0.6                                         0.6                                      0.6                    SR=0.5               0.6
       0.4                                         0.4                                      0.4                    SR=0.3               0.4
                                                                                                                   SR=0.2
       0.2                                         0.2                                      0.2                                         0.2
             0   5      10     15     20                 0   5     10     15    20                0   5      10     15      20                0   5      10    15     20




Figure A.10: 𝑁 = 74, 𝑇 = 650: Correlation of estimated rotated factors with true factors in-sample and out-of-sample for
diﬀerent variances and Sharpe-ratios of the fourth factor and for diﬀerent RP-weights 𝛾.




                                                                                  29
           1. Factor SR (IS) for 2F =0.03         1. Factor SR (OOS) for 2F =0.03              1. Factor SR (IS) for 2F =0.1           1. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
                                                                                                                  SR=0.8
     0.6                                         0.6                                     0.6                                         0.6
                                                                                                                  SR=0.5
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                      SR=0.3             0.4
                                                                                                                  SR=0.2
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20


           2. Factor SR (IS) for 2F =0.03         2. Factor SR (OOS) for 2F =0.03              2. Factor SR (IS) for 2F =0.1           2. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
     0.6                                         0.6                                     0.6                                         0.6
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                                         0.4
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20


           3. Factor SR (IS) for 2F =0.03         3. Factor SR (OOS) for 2F =0.03              3. Factor SR (IS) for 2F =0.1           3. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
     0.6                                         0.6                                     0.6                                         0.6
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                                         0.4
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20


           4. Factor SR (IS) for 2F =0.03         4. Factor SR (OOS) for 2F =0.03              4. Factor SR (IS) for 2F =0.1           4. Factor SR (OOS) for 2F =0.1
     0.8                                         0.8                                     0.8                                         0.8
     0.6                                         0.6                                     0.6                                         0.6
SR




                                            SR




                                                                                    SR




                                                                                                                                SR
     0.4                                         0.4                                     0.4                                         0.4
     0.2                                         0.2                                     0.2                                         0.2
      0                                           0                                       0                                           0
            0      5     10     15     20              0   5     10    15     20               0      5     10     15      20              0   5     10     15    20




Figure A.11: 𝑁 = 74, 𝑇 = 650: Sharpe ratios of estimated rotated factors in-sample and out-of-sample for diﬀerent
variances and Sharpe-ratios of the fourth factor and for diﬀerent RP-weights 𝛾.




                                                                               30
Appendix A.2. Single-Factor Model with 𝑁 = 74 and 𝑇 = 650


                                      2                                                     2                                                       2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                           Statistical Model   F
                                                                                              =0.05                             Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1
        1                                                      1                                                      1                                                       1                                                       1

                                       SR=0.8
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                             SR=0.5                 0.5                                                    0.5                                                     0.5                                                     0.5
                                       SR=0.3
                                       SR=0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03              Monte-Carlo Simulation            F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                      2                                                     2                                                       2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                           Statistical Model   F
                                                                                              =0.05                             Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1
       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03              Monte-Carlo Simulation            F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1
       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1
       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20




Figure A.12: 𝑁 = 74, 𝑇 = 650: Correlations and Sharpe-ratios as a function of the RP-weight 𝛾 for diﬀerent variances and
Sharpe-ratios.




                                                                                                                                        31
Appendix A.3. Single-Factor Model with 𝑁 = 25 and 𝑇 = 240


                                      2                                                     2                                                       2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                           Statistical Model   F
                                                                                              =0.05                             Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1
        1                                                      1                                                      1                                                       1                                                       1

                                       SR=0.8
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                             SR=0.5                 0.5                                                    0.5                                                     0.5                                                     0.5
                                       SR=0.3
                                       SR=0.2
        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03              Monte-Carlo Simulation            F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1
        1                                                      1                                                      1                                                       1                                                       1
Corr




                                                       Corr




                                                                                                              Corr




                                                                                                                                                                      Corr




                                                                                                                                                                                                                              Corr
       0.5                                                    0.5                                                    0.5                                                     0.5                                                     0.5


        0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                      2                                                     2                                                       2                                                       2                                                      2
                  Statistical Model   F
                                        =0.03                           Statistical Model   F
                                                                                              =0.05                             Statistical Model   F
                                                                                                                                                      =0.1                              Statistical Model   F
                                                                                                                                                                                                              =0.3                             Statistical Model   F
                                                                                                                                                                                                                                                                     =1

       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
         0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                           2                                                      2                                                      2                                                       2                                                        2
             Monte-Carlo Simulation        F
                                             =0.03              Monte-Carlo Simulation            F
                                                                                                    =0.05                  Monte-Carlo Simulation        F
                                                                                                                                                           =0.1                    Monte-Carlo Simulation        F
                                                                                                                                                                                                                   =0.3                    Monte-Carlo Simulation         F
                                                                                                                                                                                                                                                                            =1

       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
         0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20

                                             2                                                      2                                                        2                                                       2                                                       2
       Monte-Carlo Simulation OOS            F
                                               =0.03          Monte-Carlo Simulation OOS            F
                                                                                                      =0.05          Monte-Carlo Simulation OOS              F
                                                                                                                                                               =0.1          Monte-Carlo Simulation OOS              F
                                                                                                                                                                                                                       =0.3           Monte-Carlo Simulation OOS             F
                                                                                                                                                                                                                                                                               =1

       0.8                                                    0.8                                                    0.8                                                     0.8                                                     0.8
       0.6                                                    0.6                                                    0.6                                                     0.6                                                     0.6
SR




                                                       SR




                                                                                                              SR




                                                                                                                                                                      SR




                                                                                                                                                                                                                              SR
       0.4                                                    0.4                                                    0.4                                                     0.4                                                     0.4
       0.2                                                    0.2                                                    0.2                                                     0.2                                                     0.2
         0                                                      0                                                      0                                                       0                                                       0
              0        5      10      15        20                  0        5      10       15        20                   0       5      10       15        20                    0       5      10       15        20                   0       5      10       15        20




Figure A.13: 𝑁 = 25, 𝑇 = 240: Correlations and Sharpe-ratios as a function of the RP-weight 𝛾 for diﬀerent variances and
Sharpe-ratios.




                                                                                                                                        32
Appendix A.4. Pricing Errors for Single-Factor Model


                                 2                                               2                                                2                                               2                                               2
            Pricing Error (IS)   F
                                   =0.03                    Pricing Error (IS)   F
                                                                                   =0.05                     Pricing Error (IS)   F
                                                                                                                                    =0.1                     Pricing Error (IS)   F
                                                                                                                                                                                    =0.3                     Pricing Error (IS)   F
                                                                                                                                                                                                                                    =1
 0.14                                            0.14                                            0.14                                            0.14                                            0.14
                                  SR=0.8                                          SR=0.8                                          SR=0.8                                          SR=0.8                                          SR=0.8
 0.12                             SR=0.5
                                                 0.12                             SR=0.5
                                                                                                 0.12                             SR=0.5
                                                                                                                                                 0.12                             SR=0.5
                                                                                                                                                                                                 0.12                             SR=0.5
                                  SR=0.3                                          SR=0.3                                          SR=0.3                                          SR=0.3                                          SR=0.3
  0.1                                             0.1                                             0.1                                             0.1                                             0.1
                                  SR=0.2                                          SR=0.2                                          SR=0.2                                          SR=0.2                                          SR=0.2
 0.08                                            0.08                                            0.08                                            0.08                                            0.08

 0.06                                            0.06                                            0.06                                            0.06                                            0.06

 0.04                                            0.04                                            0.04                                            0.04                                            0.04

 0.02                                            0.02                                            0.02                                            0.02                                            0.02

   0                                               0                                               0                                               0                                               0

        0        5      10       15         20          0        5       10       15        20          0         5        10     15        20          0         5      10       15        20          0        5      10        15       20



                                  2                                               2                                                2                                               2                                               2
        Pricing Error (OOS)       F
                                    =0.03               Pricing Error (OOS)       F
                                                                                    =0.05                   Pricing Error (OOS)    F
                                                                                                                                     =0.1                   Pricing Error (OOS)    F
                                                                                                                                                                                     =0.3                   Pricing Error (OOS)    F
                                                                                                                                                                                                                                     =1
 0.14                                            0.14                                            0.14                                            0.14                                            0.14

 0.12                                            0.12                                            0.12                                            0.12                                            0.12

  0.1                                             0.1                                             0.1                                             0.1                                             0.1

 0.08                                            0.08                                            0.08                                            0.08                                            0.08

 0.06                                            0.06                                            0.06                                            0.06                                            0.06

 0.04                                            0.04                                            0.04                                            0.04                                            0.04

 0.02                                            0.02                                            0.02                                            0.02                                            0.02

   0                                               0                                               0                                               0                                               0

        0        5      10       15         20          0        5       10       15        20          0         5        10     15        20          0         5      10       15        20          0        5      10        15       20




Figure A.14: 𝑁 = 370, 𝑇 = 650: Root-mean-squared pricing errors as a function of the RP-weight 𝛾 for diﬀerent variances
and Sharpe-ratios.




                                 2                                               2                                                2                                               2                                               2
            Pricing Error (IS)   F
                                   =0.03                    Pricing Error (IS)   F
                                                                                   =0.05                     Pricing Error (IS)   F
                                                                                                                                    =0.1                     Pricing Error (IS)   F
                                                                                                                                                                                    =0.3                     Pricing Error (IS)   F
                                                                                                                                                                                                                                    =1

 0.15                             SR=0.8         0.15                             SR=0.8         0.15                             SR=0.8         0.15                             SR=0.8         0.15                             SR=0.8
                                  SR=0.5                                          SR=0.5                                          SR=0.5                                          SR=0.5                                          SR=0.5
                                  SR=0.3                                          SR=0.3                                          SR=0.3                                          SR=0.3                                          SR=0.3
                                  SR=0.2                                          SR=0.2                                          SR=0.2                                          SR=0.2                                          SR=0.2
  0.1                                             0.1                                             0.1                                             0.1                                             0.1



 0.05                                            0.05                                            0.05                                            0.05                                            0.05



   0                                               0                                               0                                               0                                               0

        0        5      10       15         20          0        5       10       15        20          0         5        10     15        20          0         5      10       15        20          0        5      10        15       20


                                  2                                               2                                                2                                               2                                               2
        Pricing Error (OOS)       F
                                    =0.03               Pricing Error (OOS)       F
                                                                                    =0.05                   Pricing Error (OOS)    F
                                                                                                                                     =0.1                   Pricing Error (OOS)    F
                                                                                                                                                                                     =0.3                   Pricing Error (OOS)    F
                                                                                                                                                                                                                                     =1

 0.15                                            0.15                                            0.15                                            0.15                                            0.15



  0.1                                             0.1                                             0.1                                             0.1                                             0.1



 0.05                                            0.05                                            0.05                                            0.05                                            0.05



   0                                               0                                               0                                               0                                               0

        0        5      10       15         20          0        5       10       15        20          0         5        10     15        20          0         5      10       15        20          0        5      10        15       20




Figure A.15: 𝑁 = 74, 𝑇 = 650: Root-mean-squared pricing errors as a function of the RP-weight 𝛾 for diﬀerent variances
and Sharpe-ratios.




                                                                                                                      33
             Pricing Error (IS) 2F =0.03                       Pricing Error (IS) 2F =0.05                      Pricing Error (IS) 2F =0.1                        Pricing Error (IS) 2F =0.3                      Pricing Error (IS) 2F =1
 0.25                                            0.25                                               0.25                                              0.25                                            0.25
                                  SR=0.8                                            SR=0.8                                          SR=0.8                                            SR=0.8                                         SR=0.8
                                  SR=0.5                                            SR=0.5                                          SR=0.5                                            SR=0.5                                         SR=0.5
  0.2                             SR=0.3            0.2                             SR=0.3           0.2                            SR=0.3             0.2                            SR=0.3           0.2                           SR=0.3
                                  SR=0.2                                            SR=0.2                                          SR=0.2                                            SR=0.2                                         SR=0.2
 0.15                                            0.15                                               0.15                                              0.15                                            0.15


  0.1                                               0.1                                              0.1                                               0.1                                             0.1


 0.05                                            0.05                                               0.05                                              0.05                                            0.05



        0       10    20    30     40      50             0       10    20    30     40       50           0        10   20    30    40      50              0      10    20     30    40       50           0     10    20     30    40      50



            Pricing Error (OOS) 2F =0.03                      Pricing Error (OOS) 2F =0.05                     Pricing Error (OOS) 2F =0.1                       Pricing Error (OOS) 2F =0.3                     Pricing Error (OOS) 2F =1
 0.25                                            0.25                                               0.25                                              0.25                                            0.25


  0.2                                               0.2                                              0.2                                               0.2                                             0.2


 0.15                                            0.15                                               0.15                                              0.15                                            0.15


  0.1                                               0.1                                              0.1                                               0.1                                             0.1


 0.05                                            0.05                                               0.05                                              0.05                                            0.05



        0       10    20    30     40      50             0       10    20    30     40       50           0        10   20    30    40      50              0      10    20     30    40       50           0     10    20     30    40      50




Figure A.16: 𝑁 = 25, 𝑇 = 240: Root-mean-squared pricing errors as a function of the RP-weight 𝛾 for diﬀerent variances
and Sharpe-ratios.


Appendix B. Proofs for the Weak Factor Model

        We only prove the statements for RP-PCA. The statements for the conventional PCA based on the
covariance matrix are a special case. Given an 𝑁 × 𝑁 matrix 𝐴 we denote the sorted eigenvalues by
𝜆1 (𝐴) ≥ ... ≥ 𝜆𝑁 (𝐴). Let 𝜙𝐴 (𝑧) be the empirical eigenvalue distribution, i.e. the probability measure
                                                1         𝑁
deﬁned as 𝜙𝐴 (𝑧) =                              𝑁
                                                    ∑𝑖=1 𝛿𝜆𝑖 (𝐴) where 𝛿𝑥 is the Dirac measure. In our case the probability measure
                                                                                                                                                                                               𝑁
𝜙𝐴 converges almost surely weakly for 𝑇 → ∞ (and therefore also 𝑁 → ∞ as                                                                                                                       𝑇
                                                                                                                                                                                                     → 𝑐 > 0 and 𝑁 and
𝑇 are asymptotically proportional).
Proof of Theorem 2:
Instead of using
                                        1 ⊤
                                        𝑇
                                          𝑋 𝑊2 𝑋                  we study
                                                                                       1
                                                                                       𝑇
                                                                                         𝑊𝑋𝑋⊤ 𝑊                      with 𝑊 = 𝐼𝑇 +
                                                                                                                                                       𝛾̃
                                                                                                                                                       𝑇
                                                                                                                                                             11⊤ and 𝛾̃ = √𝛾 + 1 − 1.                                    Deﬁne the
orthonormal matrix 𝑈 = (𝑈1 , 𝑈2 ) consisting of the 𝑇 × 𝐾 + 1 matrix 𝑈1 and the 𝑇 × 𝑇 − 𝐾 − 1 matrix
𝑈2 by


                                                                                                                1         (𝐹⊤ (𝐼𝑇 −
                                                                                                                                                  1
                                                                                                                                                      11⊤ )𝐹)−1/2                     0
                                                𝑈1 = ((𝐼𝑇 −
                                                                               1
                                                                               𝑇
                                                                                   11     ⊤
                                                                                              )
                                                                                                    𝐹
                                                                                                   √𝑇          √𝑇
                                                                                                                  )⎛                              𝑇                                    ⎞ 𝑈,̃
                                                                                                                   ⎝                              0                                   1⎠

where the 𝐾 + 1 × 𝐾 + 1 matrix 𝑈̃ consists of the orthonormal eigenvectors of the “signal matrix”
𝑀RP-PCA :

                                                                                           𝜃1           1/2                                                                    ⋯            0
                                                               Σ𝐹 + 𝑐𝜎𝑒2                 ⎛
                                                                                         ⎜          Σ𝐹 𝜇𝐹 (1 + 𝛾)
                                                                                                                ̃                                                                      ⎞
                                            ̃⊤
                                           𝑈 ⎛ ⊤ 1/2                              ⎞ 𝑈̃ = ⎜ ⋮
                                                                                         ⎜                                                                                     ⋱  ⋮ ⎟  ⎟
                                                                                                                                                                                       ⎟
                                             ⎝𝜇𝐹 Σ𝐹 (1 + 𝛾)
                                                          ̃ (1 + 𝛾)(𝜇𝐹⊤ 𝜇 + 𝑐𝜎22 )⎠
                                                                                         ⎝0                                                                                    ⋯ 𝜃𝐾+1 .⎠

𝑈2 are orthonormal vectors orthogonal to 𝑈1 , i.e. 𝑈1⊤ 𝑈2 = 0 and 𝑈2⊤ 𝑈2 = 𝐼𝑇−𝐾−1 .




                                                                                                                         34
                                                   1 ⊤                                                             1
   We now analyze the spectrum of 𝑆 ∶=             𝑇
                                                     𝑈 𝑊𝑋𝑋⊤ 𝑊𝑈,          which has the same eigenvalues as 𝑇 𝑋⊤ 𝑊2 𝑋.

                                  1                                                 1 ⊤
             𝑆11        𝑆12           𝑈1⊤ 𝑊(𝐹Λ⊤ + 𝑒)(𝐹Λ⊤ + 𝑒)⊤ 𝑊𝑈1                   𝑈 𝑊(𝐹Λ⊤ + 𝑒)𝑒⊤ 𝑊𝑈2
                                                                                    𝑇 1
         𝑆=⎛                ⎞ = ⎛𝑇        1 ⊤                                           1 ⊤
                                                                                                        ⎞.
           ⎝𝑆21         𝑆22 ⎠ ⎝            𝑈 𝑊𝑒(Λ𝐹⊤
                                          𝑇 2
                                                              + 𝑒)𝑊𝑈1                    𝑈 𝑊𝑒𝑒⊤ 𝑊𝑈2
                                                                                        𝑇 2             ⎠

An eigenvalue of 𝑆 that is not an eigenvalue of 𝑆22 satisﬁes

                         0 = det(𝜆𝐼𝑇 − 𝑆) = det(𝜆𝐼𝑇−𝐾−1 − 𝑆22 )det(𝜆𝐼𝐾+1 − 𝜅𝑇 (𝜆))

with

                                      𝜅𝑇 (𝜆) = 𝑆11 + 𝑆12 (𝜆𝐼𝑇−𝐾−1 − 𝑆22 )−1 𝑆21 .

For suﬃciently large 𝑇 it holds det(𝜆𝐼𝑇−𝐾−1 − 𝑆22 ) ≠ 0 for the ﬁrst 𝐾 + 1 eigenvalues. Therefore the
ﬁrst 𝐾 + 1 eigenvalues satisfy

                                               det(𝜆𝐼𝐾+1 − 𝜅𝑇 (𝜆)) = 0.

We want to study the limiting behavior of 𝜅𝑇 (𝜆) for 𝑇 → ∞.

                                                                                                        −1
                   1                                   1                            1
        𝜅𝑇 (𝜆) =       (𝑈1⊤ 𝑊(𝐹Λ⊤ + 𝑒)) (𝐼𝑁 +               𝑒⊤ 𝑊𝑈2 (𝜆𝑇−𝐾−1 −            𝑈2⊤ 𝑊𝑒𝑒⊤ 𝑊𝑈2 )       𝑈2⊤ 𝑒𝑊)
                   𝑇                                   𝑇                            𝑇
                                           ⊤
                   ⋅ (𝑈1⊤ 𝑊(𝐹Λ⊤ + 𝑒))
                                                                              −1
                   𝜆                                    1                                               ⊤
               =       (𝑈1⊤ 𝑊(𝐹Λ⊤ + 𝑒)) (𝜆𝑁 −               𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)         (𝑈1⊤ 𝑊(𝐹Λ⊤ + 𝑒)) ,
                   𝑇                                   𝑇

where we have used the identify that for 𝜆 ≠ 0 which is not an eigenvalue of 𝐴⊤ 𝐴 it holds 𝐼𝑇 +𝐴(𝜆𝐼𝑁 −
𝐴⊤ 𝐴)−1 𝐴⊤ = 𝜆(𝜆𝐼𝑁 − 𝐴𝐴⊤ )−1 .
                                                                               𝑖.𝑖.𝑑.
   Because of the orthonormality we have 𝑈2 𝑒 =∶ 𝑒 ̃ with 𝑒𝑡̃ ∼ 𝑁(0, Σ). Note that 𝑈2 𝑊 = 𝑈2 by
construction. For any matrix 𝐶 independent of 𝑈1⊤ 𝑊𝑒 we have

                       𝐸 [𝑈1⊤ 𝑊𝑒𝐶𝑒⊤ 𝑊𝑈1 ] = trace(Σ) ⋅ trace(𝐶) ⋅ 𝑈1⊤ 𝑊𝑈1

                                                                              𝐼𝐾              0
                                               = trace(Σ) ⋅ trace(𝐶) ⋅ 𝑈̃ ⊤ ⎛                    ⎞ 𝑈.̃
                                                                            ⎝0              1 + 𝛾⎠

By the law of large numbers and Lemma A.2 in Benaych-Georges and Nadakuditi (2011) it holds ﬁrst

                                                                         −1
                   𝜆                               1                                           ⊤
                       (𝑈1⊤ 𝑊(𝐹Λ⊤ )) (𝜆𝐼𝑁 −            𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)         (𝑈1⊤ 𝑊(𝐹Λ⊤ ))
                   𝑇                               𝑇
                                                                                             −1
                        1                      1                     1
               =𝜆 (         𝑈1⊤ 𝑊𝐹𝐹⊤ 𝑊𝑈1 )         trace ((𝜆𝐼𝑁 −         𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)           ) + 𝑜𝑝 (1),
                        𝑇                      𝑁                     𝑇




                                                              35
second
                                                                            −1
                    𝜆                          1                                             ⊤
                        (𝑈1⊤ 𝑒)) (𝜆𝐼𝑁 −            𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)                (𝑈1⊤ 𝑊𝑒)
                    𝑇                      𝑇
                                                                                                               −1
                                       trace(Σ) 𝑁 1                                      1
                 =𝜆 (𝑈1⊤ 𝑊𝑈1 ) ⋅                                   trace ((𝜆𝐼𝑁 −             𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)         ) + 𝑜𝑝 (1)
                                              𝑁         𝑇𝑁                               𝑇

and last but not least
                                                                                          −1
                         𝜆                                      1                                         ⊤
                             (𝑈1⊤ 𝑊(𝐹Λ⊤ )) (𝜆𝐼𝑁 −                      𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)          (𝑈1⊤ 𝑊𝑒)) = 𝑜𝑝 (1).
                        𝑇                                       𝑇
             1
Note that   √𝑁
               𝜖⊤   has orthogonally invariant column vectors by the properties of the normal distribution
and Lemma A.2 in Benaych-Georges and Nadakuditi (2011) applies. In summary the limit value of 𝜅𝑇
is described by

                                                                   1/2
                                   Σ𝐹       Σ𝐹 𝜇𝐹 (1 + 𝛾)̃    𝑐 ⋅ trace(Σ) 𝐼𝐾                                           0
              𝜅𝑇 (𝜆) =𝜆𝑈̃ ⊤ ⎛⎛ ⊤ 1/2          ⊤
                                                           ⎞+             ⎛                                                 ⎞⎞ 𝑈̃
                            ⎝⎝𝜇𝐹 Σ𝐹 (1 + 𝛾)
                                          ̃ 𝜇𝐹 𝜇𝐹 (1 + 𝛾) ⎠         𝑁     ⎝0                                          1 + 𝛾 ⎠⎠
                                                                                  −1
                             1                         1
                         ⋅       trace ((𝜆𝑁 −              𝑒⊤ 𝑊𝑈2 𝑈2⊤ 𝑊𝑒)              ) + 𝑜𝑝 (1).
                             𝑁                         𝑇

                                     𝑖.𝑖.𝑑.
As 𝑈2 𝑊𝑒 = 𝑈2 𝑒 = 𝑒 ̃ with 𝑒𝑡̃ ∼ 𝑁(0, Σ) for 𝑡 = 1, ..., 𝑇 − 𝐾 − 1 we have

                                                           𝑝
                                              𝜅𝑇 (𝜆) → 𝜅(𝜆) = 𝜆𝑈̃ ⊤ 𝑀RP-PCA 𝑈𝐺(𝜆).
                                                                             ̃


                                 𝜃1                 ⋯          0
                               ⎛
                               ⎜                                 ⎞
Therefore 𝜆 is eigenvalue of 𝜆 ⎜
                               ⎜⋮                   ⋱          ⋮ ⎟
                                                                 ⎟
                                                                 ⎟ 𝐺(𝜆) which is equivalent to
                               ⎝0                   ⋯ 𝜃𝐾+1 ⎠

                                                   1                                                 1
                                    𝐺(𝜆) =                     respectively              𝜆 = 𝐺−1 (        ).
                                                   𝜃𝑖                                                𝜃𝑖

If a solution outside the support of the spectrum of 𝑆22 exists, then it must satisfy the equation
         1
𝐺(𝜆) =   𝜃𝑖
              for some 𝑖 = 1, ..., 𝐾 + 1. Otherwise by Weil’s inequality and the same arguments as in
                                                                   𝑏                                                                   1
Benaych-Georges and Nadakuditi (2011) 𝜆 → 𝑏. For 𝑧 > 𝑏 we have 𝐺′ (𝑧) < 0. Therefore if 𝜃𝑖 >                                          𝐺(𝑏)
                                                                                                 𝑝
                                         1
then a solution exists. If 𝜃𝑖 <         𝐺(𝑏)
                                                  then no solution exists and 𝜆 → 𝑏.
    Recall that the estimators for the loadings and factors are deﬁned as follows: Λ̂ are the ﬁrst 𝐾
                 1
eigenvectors of 𝑋⊤ 𝑊2 𝑋 and 𝐹 ̂ = 𝑋Λ.̂ For the proofs we will use an equivalent formulation. Denote
                    𝑇
                                            1 ⊤                             −1/2
by 𝑉 the ﬁrst 𝐾 eigenvectors of             𝑇
                                              𝑈 𝑊𝑋𝑋⊤ 𝑊𝑈. Then Λ̂ = 𝑋⊤ 𝑊𝑈𝑉𝐷𝐾 ,                                       where 𝐷𝐾 is a diagonal
                                                        1
matrix with the ﬁrst 𝐾 largest           eigenvalues of 𝑇 𝑈⊤ 𝑋⊤ 𝑊2 𝑋𝑈, i.e.

                                                    1
                                                           𝑉⊤ 𝑈⊤ 𝑊𝑋𝑋⊤ 𝑊𝑈𝑉 = 𝐷𝐾 .
                                                    𝑇
                                                          1/2
The factors estimator takes the form 𝐹 ̂ = 𝑋Λ̂ = √𝑇𝑊−1 𝑈𝑉𝐷𝐾 .


                                                                           36
                                                       1 ⊤
      We analyze the 𝐾 + 1 eigenvectors of             𝑇
                                                         𝑈 𝑊𝑋𝑋⊤ 𝑊𝑈.                Assume 𝑢𝑖 is an eigenvector of 𝑆 associated
with 𝜆𝑖 :

                                         𝜆𝑖 𝐼𝐾+1 − 𝑆11              −𝑆12       𝑢𝑖,1    0
                                     ⎛                                      ⎞⎛      ⎞=⎛ ⎞
                                     ⎝      −𝑆21            𝜆𝑖 𝐼𝑇−𝐾−1 − 𝑆22 ⎠ ⎝𝑢𝑖,2 ⎠ ⎝0⎠

where 𝑢𝑖,1 and 𝑢𝑖,2 are the ﬁrst 𝐾 + 1 respectively last 𝑇 − 𝐾 − 1 components of the vector 𝑢𝑖 . Hence

                                                                                   −1
                                                𝑢2,𝑖 = (𝜆𝑖 𝐼𝑇−𝐾−1 − 𝑆22 )               𝑆21 𝑢𝑖,1
                                                  0 = (𝜆𝑖 𝐼𝐾+1 − 𝜅𝑇 (𝜆𝑖 )) 𝑢𝑖,1 .

Assume that 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡 , i.e. 𝜆𝑖 𝐼𝐾+1 − 𝜅𝑇 (𝜆𝑖 ) = 0 has a solution. Consequently

                                                     𝜃1            ⋯        0
                                       ⎛
                                       ⎜           ⎛
                                                −1 ⎜
                                                                              ⎞⎞
                                       ⎜
                                       ⎜𝐼𝐾+1 − 𝜃𝑖 ⎜⎜⋮              ⋱        ⋮ ⎟
                                                                              ⎟
                                                                              ⎟⎟
                                                                                ⎟ 𝑢 = 𝑜 (1).
                                                                                ⎟ 𝑖,1  𝑝

                                       ⎝           ⎝0              ⋯ 𝜃𝐾+1 ⎠⎠

As a consequence the vector 𝑢𝑖,1 has all elements equal to zero except at the 𝑖th position:

                                             𝑢⊤
                                              𝑖,1 = (0 ⋯ 0 ‖𝑢𝑖,1 ‖ 0 ⋯ 0)


where ‖𝑢𝑖,1 ‖ denotes the length of the vector which is completely determined by the 𝑖th element. The
vector 𝑢𝑖,2 satisﬁes

                                                           −2
           𝑢⊤           ⊤
            𝑖,2 𝑢𝑖,2 = 𝑢𝑖,1 𝑆12 (𝜆𝑖 𝐼𝑇−𝐾−1 − 𝑆22 )              𝑆21 𝑢𝑖,1
                              1                                                                 −2                         ⊤
                    = 𝑢⊤
                       𝑖,1        𝑈1⊤ 𝑊 (𝐹Λ𝑇 + 𝑒) (𝑒⊤ 𝑊𝑈2 (𝜆𝑖 𝐼𝑇−𝐾−1 − 𝑆22 )                         𝑈2⊤ 𝑊𝑒) (𝐹Λ𝑇 + 𝑒) 𝑊𝑈1 .
                              𝑇

By similar arguments as in the ﬁrst part of the proof showing the convergence of 𝜅𝑇 (𝜆) it follows that

                                       𝜃1   ⋯      0
                                     ⎛
                                     ⎜               ⎞
                 𝑢⊤
                  𝑖,2 𝑢𝑖,2   =𝑢⊤
                               𝑖,1   ⎜
                                     ⎜⋮     ⋱      ⋮ ⎟
                                                     ⎟
                                                     ⎟ 𝑢𝑖,1
                                     ⎝0     ⋯ 𝜃𝐾+1 ⎠
                                                                                                     −2
                                                                            1
                               ⋅ trace (𝑒⊤ 𝑊𝑈2 (𝜆𝑖 𝐼𝑇−𝐾−1 −                     𝑈2⊤ 𝑊𝑒𝑒⊤ 𝑊𝑈2 )            𝑈2⊤ 𝑊𝑒) + 𝑜𝑝 (1).
                                                                            𝑇

Recall that 𝑈2⊤ 𝑊𝑒 = 𝑒 ̃ can be interpreted as 𝑇 − 𝐾 − 1 independent draws of a 𝑁(0, Σ). Denote
                                         1                       1
the eigenvalue distribution function of 𝑒⊤                            ̃ by 𝜙̃ 𝑇 (𝑧). By assumption both
                                           ̃ 𝑒 ̃ by 𝜙𝑇 (𝑧) and of 𝑒𝑒̃ ⊤
                                                       𝑇                                    𝑇
                                                                            ̃
converge to limit spectral distribution functions that are related through 𝜙(𝑧) − 𝑐𝜙(𝑧) = (1 − 𝑐)𝛿0
where 𝛿0 is the Dirac-measure with point-mass at zero.25 By the properties of the trace operator

                                                                                  −2
                                                       1                                                      𝑧
                trace (𝑒⊤ 𝑊𝑈2 (𝜆𝑖 𝐼𝑇−𝐾−1 −                 𝑈2⊤ 𝑊𝑒𝑒⊤ 𝑊𝑈2 )              𝑈2⊤ 𝑊𝑒) = ∫                    𝑑𝜙̃ 𝑇 (𝑧)
                                                       𝑇                                                  (𝜆𝑖 − 𝑧)2


 25
      See Chapter 2 in Yao, Zheng and Bai (2015).


                                                                       37
which converges almost surely to

                                  𝑧                          𝑧
                           ∫                 ̃
                                           𝑑𝜙(𝑧) =∫                𝑑(𝑐𝜙(𝑧) + (1 − 𝑐)𝛿0 )
                               (𝜆𝑖 − 𝑧)2                 (𝜆𝑖 − 𝑧)2
                                                               𝑧
                                                      = 𝑐∫           𝑑𝜙(𝑧) = 𝐵(𝜆𝑖 ).
                                                           (𝜆𝑖 − 𝑧)2

Consequently

                           1 = ‖𝑢𝑖,1 ‖2 + ‖𝑢𝑖,2 ‖2 = 𝑢⊤
                                                      𝑖,1 𝑢𝑖,1 (1 + 𝜃𝑖 𝐵(𝜆𝑖 )) + 𝑜𝑝 (1)


and therefore

                                                                 𝑝            1
                                                   ‖𝑢𝑖,1 ‖2 →                         .
                                                                      1 + 𝜃𝑖 𝐵(𝜆𝑖 )

Assume that 𝜃𝑖 < 𝜃𝑐𝑟𝑖𝑡 , i.e. 𝜆𝑖 𝐼𝐾+1 − 𝜅𝑇 (𝜆𝑖 ) = 0 has no solution. It still holds

                                                            𝜃1       ⋯        0
                                                          ⎛
                                                          ⎜                    ⎞
                                  𝑢⊤
                                   𝑖,2 𝑢𝑖,2   =    𝑢⊤
                                                    𝑖,1   ⎜
                                                          ⎜⋮         ⋱       ⋮ ⎟
                                                                               ⎟
                                                                               ⎟ 𝑢𝑖,1 lim 𝐵(𝑧)
                                                                                      𝑧↓𝑏
                                                          ⎝0         ⋯ 𝜃𝐾+1 ⎠

                                                                                                   𝑝
as 𝜆𝑖 converges in probability to 𝑏. If lim𝑧↓𝑏 𝐵(𝑧) = −∞, then ‖𝑢𝑖,1 ‖ → 0 and

                                                      𝑢⊤
                                                       𝑖,1 = (0 ⋯ 0) .


All we need to show is that 𝜃𝑖 < 𝜃𝑐𝑟𝑖𝑡 implies lim𝑧↓𝑏 𝐵(𝑧) = −∞. This follows for the largest eigen-
value 𝜆1 by the same argument as in the proof of theorem 2.3 in Benaych-Georges and Nadakuditi
(2011). If 𝐾 > 1 we need in addition eigenvalue repulsion to show the result for 𝜆𝑖 for 𝑖 = 2, ..., 𝐾
(see Nadakuditi (2014), appendix 7). Assume that the distance between the largest eigenvalues of the
         1 ⊤
matrix   𝑇
           𝑒 𝑒   decays with a certain rate

                                              𝑒⊤ 𝑒                   𝑒⊤ 𝑒                 log(𝑁)
                                  |𝜆𝑖+1 (            ) − 𝜆𝑖 (               )| ≤ 𝑂𝑝 (              ).
                                               𝑇                      𝑇                    𝑁2/3

This is satisﬁed for normally distributed residuals as in our case (see Onatski (2012)). Hence,

                                                      𝑧
                               𝐵(𝜆𝑖 ) = 𝑐 ∫          𝑑𝜙̃ 𝑇 (𝑧) + 𝑜𝑝 (1)
                                           (𝜆𝑖 − 𝑧)2
                                            1                 1
                                      ≤ 𝑂𝑝 ( ) ⋅                             + 𝑜𝑝 (1)
                                            𝑁     (𝜆1 (𝑆22 ) − 𝜆𝐾+1 (𝑆22 ))2
                                                     𝑁1/3
                                      ≤ 𝑂𝑝 (                 ).
                                                   log(𝑁)2

which satisﬁes the explosion condition.




                                                                     38
   We can now go back to the original problem: Deﬁne

                                                          1
                                               ⎧                             if 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡
                                                   √1+𝜃𝑖 𝐵(𝐺−1 (𝜃𝑖 ))
                                   𝜌𝑖 = ⎨
                                        ⎩ 0                                  otherwise.

The estimator for the factors can now be written as

                                                                  1/2
                                        𝐹 ̂ = √𝑇𝑊−1 𝑈𝑉𝐷𝐾

                                                     𝜌1                 0    ⋯    0
                                                   ⎛
                                                   ⎜                              ⎞
                                                   ⎜ 0                  𝜌2   ⋯  0⎟⎟
                                                   ⎜
                                                   ⎜                              ⎟
                                                                                  ⎟ 1/2
                                               −1
                                          = √𝑇𝑊 𝑈1 ⎜
                                                   ⎜ 0                  0    ⋱ ⋮⎟ ⎟ 𝐷𝐾
                                                   ⎜
                                                   ⎜                              ⎟
                                                   ⎜0                   ⋯    0 𝜌𝐾 ⎟
                                                                                  ⎟
                                                               ⎝0       ⋯       0⎠

with

                          𝜃1̂      ⋯       0
                        ⎛               ⎞                             ⎧ 𝐺−1 ( 1 )            if 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡
                   𝐷𝐾 = ⎜
                        ⎜
                        ⎜⋮         ⋱ ⋮⎟ ⎟
                                        ⎟                ,      𝜃𝑖̂ = ⎨      𝜃𝑖

                                                                      ⎩ 𝑏                    otherwise.
                                      ̂
                        ⎝0         ⋯ 𝜃𝐾 ⎠

                       ̂
   The calculation for Corr(𝐹, 𝐹)̂ is straightforward. Note that the mean can be estimated by

                                                                       𝜌1    0    ⋯   0
                                                                     ⎛
                                                                     ⎜                 ⎞
                                                                     ⎜ 0     𝜌2   ⋯  0⎟⎟
                                           1                         ⎜
                                                                     ⎜                 ⎟
                                                                                       ⎟ 1/2
                              𝜇𝐹̂ ̂ =              (𝑂𝐾       1𝐾 ) 𝑈 ⎜
                                                                   ̃
                                                                     ⎜ 0     0    ⋱ ⋮⎟ ⎟ 𝐷𝐾 .
                                        1 + 𝛾̃                       ⎜                 ⎟
                                                                     ⎜
                                                                     ⎜0      ⋯         ⎟
                                                                                  0 𝜌𝐾 ⎟
                                                                     ⎝0      ⋯       0⎠

Here we used that 𝑊−1 = 𝐼𝑇 −
                                         𝛾̃
                                        1+𝛾̃
                                               11⊤ and (1 + 𝛾)̃ 2 = 1 + 𝛾.
Proof for i.i.d. residuals:
                                                                                                1 ⊤
For the special case where 𝑒𝑡,𝑖 i.i.d. 𝑁(0, 𝜎𝑒2 ), i.e. Σ = 𝜎𝑒2 𝐼𝑁 , the matrix                 𝑇
                                                                                                  𝑒 𝑒   follows the Marcenko-
Pasteur law:

                                   1                                                                    1
                  𝑑𝜙(𝑧) =                       (𝑏 − 𝑧)(𝑧 − 𝑎)1{𝑧∈(𝑎,𝑏)} 𝑑𝑧 + max (0, 1 −                   ) 𝛿0
                              2𝜋𝑐𝜎𝑒2 𝑧 √                                                                𝑐

with

                                                       𝑎 = 𝜎𝑒2 (1 − √𝑐)2
                                                        𝑏 = 𝜎𝑒2 (1 + √𝑐)2

𝑎 and 𝑏 are the smallest respectively largest eigenvalue. For simplicity take 𝑐 > 1, but the results
can be easily extended to the case 0 < 𝑐 < 1. The object of interest is the Cauchy transform of the




                                                                  39
eigenvalue distribution function. Calculations as outlined in Bai and Silverstein (2010) lead to

                                      𝑧 − 𝜎𝑒2 (1 − 𝑐) − √(𝑧 − 𝜎𝑒2 (1 + 𝑐))2 − 4𝑐𝜎𝑒2
                             𝐺(𝑧) =                                                       .
                                                                2𝑐𝑧𝜎𝑒2

Simple but tedious calculations show that

                                                            𝑧𝜎𝑒2 (1 − 𝑐) + 1
                                             𝐺−1 (𝑧) =                          .
                                                               𝑧 − 𝑐𝜎𝑒2 𝑧2

Proof of Corollary 2: Plugging the eigenvalues and eigenvector formulas into Theorem 2 yields:

                                             𝑝           𝜌1  1/2 ̂
                                 ̂
                                 Corr(𝐹, 𝐹)̂ → (1 0) 𝑈̃ ⎛ ⎞ 𝜃1̂ Var( 𝐹)̂ 1/2
                                                         0
                                                        ⎝ ⎠
                                                𝑝
                                      ̂ 𝐹)̂ → 𝜃1̂ (𝑈1,1
                                      Var(          ̃ 2 ‖𝑢1,1 ‖2 + ‖𝑢1,2 ‖2 )
                                                𝑝       1
                                             𝜇̂2 →             ̃ 2 𝜌1 𝜃1̂ .
                                                              𝑈1,2
                                                     1+𝛾

The proof for the limit for 𝛾 → ∞ is based on the insight that

                                                  lim 𝐵(𝜃)𝜃2 → 𝑐𝜎𝑒2 .
                                                  𝜃→∞



Lemma 2: Detection of weak factors
If 𝛾 > −1 and 𝜇𝐹 ≠ 0, then the ﬁrst 𝐾 eigenvalues of 𝑀RP-PCA are strictly larger than the ﬁrst 𝐾
eigenvalues of 𝑀PCA , i.e.

                                                𝜃𝑖RP-PCA > 𝜎𝐹2𝑖 + 𝑐𝜎𝑒2 .

For 𝜃𝑖 > 𝜃𝑐𝑟𝑖𝑡 it holds that

                                      𝜕𝜃𝑖̂              𝜕𝜌𝑖
                                             >0               >0         𝑖 = 1, ..., 𝐾.
                                      𝜕𝜃𝑖               𝜕𝜃𝑖

Thus, if 𝛾 > −1 and 𝜇𝐹 ≠ 0, then 𝜌𝑖RP-PCA > 𝜌𝑖PCA .


Proof of Lemma 2:
See result (12) on page 75 in Lütkepohl (1996) and straightforward calculations.




                                                              40
References

Ahn, S. C., Horenstein, A. R., 2013. Eigenvalue ratio test for the number of factors. Econometrica 81,
  1203–1227.
Aït-Sahalia, Y., Xiu, D., 2017. Principal component estimation of a large covariance matrix with high-
  frequency data. Journal of Econometrics 201, 384–399.
Bai, J., 2003. Inferential theory for factor models of large dimensions. Econometrica 71, 135–171.
Bai, J., Ng, S., 2002. Determining the number of factors in approximate factor models. Econometrica
  70, 191–221.
Bai, J., Ng, S., 2008. Large dimensional factor analysis. Foundations and Trends in Econometrics 3 (2),
  89–163.
Bai, J., Ng, S., 2017. Principal components and regularized estimation of factor models. Working Paper.
Benaych-Georges, F., Nadakuditi, R. R., 2011. The eigenvalues and eigenvectors of ﬁnite, low rank
  perturbations of large random matrices. Advances in Mathematics 227, 494–521.
Bryzgalova, S., 2017. Spurious factors in linear asset pricing models. Technical report, Stanford Uni-
  versity.
Chamberlain, G., Rothschild, M., 1983. Arbitrage, factor structure, and mean-variance analysis on
  large asset markets. Econometrica 51, 1281–1304.
Connor, G., Korajczyk, R., 1988. Risk and return in an equilibrium apt: Application to a new test
  methodology. Journal of Financial Economics 21, 255–289.
Connor, G., Korajczyk, R., 1993. A test for the number of factors in an approximate factor model.
  Journal of Finance 58, 1263–1291.
Fan, J., Liao, Y., Mincheva, M., 2013. Large covariance estimation by thresholding principal orthogonal
  complements. Journal of the Royal Statistical Society 75 (4), 603–680.
Fan, J., Liao, Y., Wang, W., 2016. Projected principal component analysis in factor models. The Annals
  of Statistics 44 (1), 219–254.
Fan, J., Zhong, Y., 2018. Optimal subspace estimation using overidentifying vectors via generalized
  method of moments. Working paper.
Forni, M., Hallin, M., Lippi, M., Reichlin, L., 2000. The generalized dynamic-factor model: Identiﬁcation
  and estimation. Review 82, 540–554.
Harding, M., 2013. Estimating the number of factors in large dimensional factor models. Working
  paper.
Kelly, B., Pruitt, S., Su, Y., 2017. Instrumented principal component analysis. Working Paper.
Kozak, S., Nagel, S., Santosh, S., 2017. Shrinking the cross section. Technical Report, Chicago Booth.
Lettau, M., Pelger, M., 2018. Factors that ﬁt the time series and cross-section of stock returns. Working
  paper.
Ludvigson, S., Ng, S., 2010. A factor analysis of bond risk premia. Handbook of the Economics of
  Finance.
Lütkepohl, H., 1996. Handbook of Matrices. John Wiley & Sons.
Onatski, A., 2010. Determining the number of factors from empirical distribution of eigenvalues.
  Review of Economic and Statistics 92, 1004–1016.


                                                   41
Onatski, A., 2012. Asymptotics of the principal components estimator of large factor models with
  weakly inﬂuential factors. Journal of Econometrics (168), 244–258.
Paul, D., 2007. Asymptotics of sample eigenstructure for a large dimensional spiked covariance model.
  Statistica Sinica 17 (4), 1617–1642.
Pelger, M., 2017. Large-dimensional factor modeling based on high-frequency observations large-
  dimensional factor modeling based on high-frequency observations. Working paper.
Ross, S. A., 1976. The arbitrage theory of capital asset pricing. Journal of Economic Theory 13, 341–
  360.
Stock, J., Watson, M., 2006. Macroeconomic Forecasting Using Many Predictors. Handbook of Economic
  Forecasting. North Holland.




                                                 42
