            A SYS1 OF SUBROIJrD'JES FOR ITERATIVELY
             REWEIGH'rEa) LEAST SQUARES COUATIONS


                         avid Coleman*
                         Paul Fb11and*
                         Neil Kadent
                         Virginia KLelna*

                    Working Paper No. 189


          National Bureau of Economic Research, Inc.
                    575 Teci-no1ogy Square
                Cambridge, Massachusetts 02139


                           July 1977

 This research was supported by the National Science Foundation under
 Grants DCR75—08802 arid MCS76—11989.

*Natjonal Bureau of Economic Research, Inc., Computer Research Center,
 575 Teciinoiogy Square, Cambridge, Massachusetts 02139.
*duatjonal Testing Service, Fosedale Read, Princeton, N. J. 085Ll0.
tDeparthient of Computer Science, University of Toronto, Toronto,
 Canada M5S 1 A7.
                              ABSTRAC1'




     A description of a system of subroutines to compute solutions
to the iteratively reweighted least squares problem is presented.
The weights are determined from the data and linear fit arid are
computed as functions of the scaled residuals. Iteratively
reweighted least squares is a part of robust statistics where
vvrobustnessfl nans relative insensitivity to iroderate departures
from assumptions. The software for iteratively reweighted least
squares is cast as semi-portable Fortran code whose performance
is unaffected (in the sense that performance will not be deaded)
by the computer or operating-system environment in which it is used.
An    start and an    s-tart are provided. Eight weight functions,
a numerical rank determination, convergence criterion, arid a
stem-and-leaf display are included.




Key Words and Phrases: least squares, data analysis, mathematical software,
portability, linear algebra, curve fitting, robust estimation, weight functions.
CR Categories 5.114 and 5.5
                    , . 3
                                  TABLE OF CONTTS




Introduction


Section 2 .
Section 1 .


Section 3     ,    ...8
.Ac)ciow1edne.rits .
                        6
                  . . . . ,   •   . .




                                                                                •   ,   •
                                                                                            .1


                                                                                             26

                                        .   . .   .   .   .   . . . . .   ...   . . ,       . 27
Introduction

      The purpose of this paper is to describe a system of Fortran
subroutines written as modular mathematical software to solve the
iteratively reweighted least squares problem. The software includes
documentation for use and flow of control as comments in the subroutines.
The specifications from which the software was writ-ten are contained in
[12]. The collection of subroutines uses orthogonal factorizations by
Householder transformations or the singular value decomposition from
EISPACI( II [ 7] to compute the        start and iterations for reweighted
least squares. CL1 C 2] computes the £1 start, an overdeterrnined solution
in the
      The computational tools that     we   provide include an   interactive   driver,
eight   weight functions, John Tukey's stem-and-leaf display [15, 9] the diagonal
of the "hat" matrix     [10]   which is the projection matrix A effectively computed

as   uzz+uT from the   singular   value decomposition [7] or   QQT from QR,

the   Householder transformations. Optionally, the          condition of the
matrix, the weights, residuals, and the convergence criterion can         be

displayed.     Two forms of equilibration are also provided [16].
      The usual statistics information to display the number of observations,
number of    variables, maximum diagonal element of the "hat" matrix, condition
number of the weighted data matrix, the maximum absolute value of the

residuals, and    the minimum weight is optionally available. There is an

option   to provide the (weighted) sum of squared residuals, and the           sum of

absolute   residuals. Also available is the (weighted) R-squared statistic,
the (weighted) standard error, and the (weighted) F statistic.
                                     —2—


     The   software is presented in the form of a basis tape suitable for use
by the Fortran converter [1] from ThISL to produce target Fortran code
for CDC, Burroughs, Honeywell, PEP-i0, and Univac machines. The source
code is long precision IBM code acceptable to the Fortran converter,
The PFO1' verifier [lii.] was used to check the software,
     We do not discuss the theoretical properties of iteratively
reweighted least squares or the tuning constants for the weight functions
in this paper. Father we refer the reader to Holland and Welsch [11]
for such information,
     The organization of this paper is as follows,' Section 1 defines
the iteratively reweighted least squares problem. Section 2 describes
the selection of rank for the data matrix and the re-weighted data matrix.
Section 3 gives some numerical results. The weight functions are listed
in Table 1 of Section 1. The subroutines for the computation are listed
in Table 2 of Section 3. A copy of the subroutine to compute one of the
weight   functions, i.e., the Biweight weight function, is listed at the

end of   Section 3.
                                       —3—


Section 1


      The method of least squares has been the prim3ry technique for
fitting rrodels to data for many years and is versatile and numerically
stable when computationafly stable methods are used [13] Despite its
central role in the past, much work has been done by statisticians
to improve least squares in the sense of getting rrre information
about the data than is available from just the least squares solution or
from the matrix factorizations that are used to obtain it,
    The area of work that our software addresses is robust regression
which is aimed at analyzing and    improving   the behavior of least squares
estimation when   the   disturbances are not well-behaved. We focus our
attention   on one of the computational procedures for robust linear
regression, iteratively reweighted least squares.

      Consider the rrrdel b Ax + r where b is an nod, vector of observations,

A is an nrom data or desi-i matrix, x is an nxl vector of parameters,

and   r   is an mx]. vector, The notation b Ax + r corresponds to the

statistical notation y X8 + C where y is nxl, X is nxp,                         is pxl,
and C is nxl,

      The ordinary least squares problem is
                                               mn !, ((r1 (x)   ) / )2 where

r is a vector of residuals b - Ax,     and   s is a constant or fixed scale.
                                                                                 2
      The weighted least squares problem is
                                                n4n J1 W,    ((r1   (x) ) / s        whicii

is solved by using ordinary least squares with W'2A and W'2b where W
is a diagonal matrix of weights that are functions of scaled residuals,
      The iteratively reweighted least squares problem assumes a start
                                             —




 (
     0),   which can be obtained from 22, ordinary, least squares, least
absolute residuals, that is to say) the overdetermined solution in
the   norm, previous iterations of iteratively reweighted least
squares, or a start specified by the user. Given x
                                                           (0)
                                                                 , the problem
is iterated to obtain the least squares solution, "(k+l)
                                                                          (k+l)-'2         (k+1)l/2
                                                  x                  (W       ) A +   (W       ) b
where the diagonal matrix          W   is computed as a function of scaled residuals-•

The residual scaling function we use is the maxiraim absolute deviation,

i,e,, the median of the absolute values of the non—zero residuals. The

modularity of the software makes readily possible the inclusion of

additional residual scaling functions such as the inner-quartile--range

of the residuals.          The software to -compute the weights includes the

eight weight functions listed in Table 1,

           To test convergence of iteratively reweighted least squares we use

the    convergence criterion suggested by John Dennis [k], After the kth
iteration, we compute a scale.independent measure of the adient,
ATr, where r is the residuals b x, which. i,

                                                                                      rlI2
                   T(k+l))l/2          r0))/ii (wk÷1))u'2 AII2 ii(w+1 )112


where '           is the   Euclidean norm,

           The problem of iteratively reweighted least squares is a problem

in    optimization in      the sense that one is minimizing a function of scaled

residuals,
                                          —5—


                                      Table 1



Weight functions (where u scaled residual), range and default tuning constants.

Ne            W(u)                               Range          Tuning Constant

ANDREWS
              wA(u)           sifl(u/A)/(u/A)                   A 1.339
                         [
                                                  lul   >A
____
BIWEIGHT
              w3(u)
                              [1 — (u/B) 22
                                          ]       lul     B     B   4.685
                              0                   luI>B

CAUCHY
              wc(u)           11(1+    (U/C)2)                  C 2.385
FAIR
              wF(u)           l/(1÷ lw/Fl)                      F 1.400
HUBER
              wH(u)      [    1                   lul    H      H 1.345
                         H/lul                    lul>H
LOGISTIC
              wL(u)          (tanh(u/L)Y(u/L)                   L   1.205

TALWAR
              wT(u)          1                   lul    < T     T 2.795
                         [
                                                 lul>T
WELSCH                       e
              wR(u)                                             R 2.985
                                        —6




Section   2


     Starting points for the iterations include 22, ordinary least squares
and Li, the overdetermined solution in the     norm [2] which corresponds
to least-absolute-residuals regression, The £2 start and iterations subsequent
to the     L2 or user-supplied start are computed by orthogonal fractorizations,
i,e, Householder transfon'na.tions or a cornbina-tjon of Householder
transformations    and the singular value decomposition.
      The way in which we decide to use the QR (Householder transformations)
or a combination of QR and MINFIT [7] (least-squares solution by singular
value decomposition) needs some explanation, Frequently the data matrix, A,
in the statistical rrydel b Ax + r has some variables (colurr-is) that are
close in the numerical sense to being linear combinations of other columns
of A. Since such a situation may occur the numerical rank [8 ] of A must
be determined before proceeding with the least-squares computation, The
numerical rank should be determined by the user, and the determination of
rank should be made with respect to the certainty of the data. Since the
rank must be determined at every iteration (reweighting may down-weight rows, i. e.,
observations, to the extent     that the effective deletion of observations creates
rank degeneracy) it    is   necessary to estimate the condition of the weighted A
as inexpensively as possible. For the £2 start arid for all iterations after any
start we default to a QR factorization with column pivoting. Unless A is
exactly singular   the completion of the QR factorization of A provides
the upper triangular factor R whose condition is that of A. The condition
estimate using R [ 3] is only 0(n2) operations, gives a reliable measure of the
ill-conditioning of A, and Is used to determine whether QR is computationally
sufficient or whether the computationally rrre expensive singular value
decomposition, MINFIT, is necessary,
                                      —7—




       We strongly believe that the user should determine the rank of his
data   or desig-i matrix    inspecting the singular values of A (which are
                           by
the    sai as those of R). However we provide a conservative default
deternjnatjon of rank associated with the condition of the matrix at each
iteration relative to the square-root     of   the precision of the computing machine
that   is used. Explicitly, the condition estimate of R as obtained by [3 ]
is   an estimate of the largest arid smallest singular values, a and
of A. If the ratio (amm
                      . Iamax     )   < C1'2   where c is the relative precision
of   the arithmetic of the computing machine, the computation is continued
by using the singular value decomposition. When the. singular value
decomposition is used the number, k, of singular values
such that         a1
                          > . .
                                . a] > O         . • . a           0, is
                                                ak+l
detenthied from the certainty of the data or from the square root of the
precision of the computing machine, whichever is larger.
                                      —8—,


Section 3


       The software to compute the solutions to the iteratively reweighted

least squares problem consists of 17,500 lines of code, comments, and

documentation   for use. The 17,500 lines includes all of the software

that   is required for the interactive driver and its options for use plus
a selection of test matrices, The software includes ThelptT corrmands
to give on-line information to users. The interactive driver is desied
to operate effectively on any computer system that permits the transmission
of four characters to and from a terminal. The subroutines, however,
can also be used in a batch environment. With the exception of CU, all
of the software is desiied to be processed by the Fortran         converter.

       We have included a selection of test matrices including those from

C   5]. We chose this particular   collection   of matrices   because   of the
widespread use of £ S ] as   a reference and    text. The matrices are cast
in integer form and then assi-ied as floating point numbers to insure
that there is uniform input to a variety of computing machines.
     The name and a brief description of the subroutines that are needed
for an options of the iteratively reweighted least squares problem are
listed in Table 2 of this section.
       Selected results from one of the weight functions, Biweight, and
the terminal   session used to compute the results applied to C 6        ]   follows
Table 2.
                                            —9—



 The data   iratrix given in C   6 J   is



            1      .499        11.1                   11.111.
            1      .658         8.9                   12.71+
            1      .601+         8.8                  13.13
            1      .4141         8.9                  11.51
      A —   1      .550          8.8                  12.38
            1      .528         9.9                   12.60
            1      .14.18      10.7                   11.13
            1      .480        10.5                   11.70
            1      .406        10.5                   11.02
            1      .467        10.7
                                                      11.41_J



and   has singular values   31.6,   .109, and .395.
                                               —10—

                                              Thbl. 2



C                NAME        DESCRIPTION                                                  HEAOO37O
C                                                                                     .   HEAOO38O
C                                                                                HEAOOZVO
C                EQOl        MODIFIED ROW—INF—EOUILIBRAT!ON                      HEAOO400
C                £002        COLUMN (MAX. ELEMENT) EQUILIBRATION                 HEAOO41'O
C                E003        ROW (MAX. ELEMENT) EQUILIBRATION                    HEAOO42O
C                EQO4        COLUMN (SORT. SUM OF SQUARES) EQUILIBRATION         HEAOO43O
C                £005        ROW CSQRT. SUM OF SQUARES) EQUILIBRATION            HEAOO44'O
C                EUNORM      EUCLIDIAN (SORT. SUM OF SQUARES) NORM               HEAOO4SO
C                GETXLI      GET THE LI START VECTOR                             HEAOO46O
C                HMATSV      FORMS DIAG OF H—MATuU*SIGMA*SIGMA—PSEUDO—INV*U—TRANS HEAOO47O
C                HMATQR      FORMS DIAG OF H—MAT—O*Q—TRANS                       HEAOO4SO
C                IERRIO      WRITES IERR PARAMETER ON DSET                       HEAOO49O
C                IFLOOR      INTEGER FUNCTION FINDS FLOOR(REAL) $$               HEAOO500
C.               IRLSOR      SUBROUTINE TO DO ONE I R L S ITERATION (ORSOL)      HEAOO5SO
                 IRLSSV      SUBROUTINE TO DO ONE I R L S ITERATION (MINSOL)     HEAOOS2O
C                NATIOI      WRITES MATRIX ON DSETr OPTIONAL HEADING             HEAOO5ZO
C                MINFIT      SINGULAR VALUE DECOMPOSITION AU*SIGMA*V—TRANSP      HEAOOS4O
C            .   NINSOL      SOLVES AX—B GIVEN OUTPUT FROM MINFIT                HEAOOSSO
C                MSG1        WRITES VARIABLE—LENGTH MESSAGE ON DSET              HEAOO$60
C                PERMUT      MATRIX COLUMN PERMUTATION                           HEAOO57O
C                ORI         OR DECOHPOSITION. 0 ORTHOGONAL TRANSFORMATIONS    . HEAOO5SO
                                                                                  .


C                ORISOL      SCtVES AXwB USING OR1          .                    HEAOO5PO
C                RESTOR      RESTORE HATRIX WEIGHTS                              HEAOOÔOO
C                RESIDL      COMPUTES RESIDUAL B—AX                              HEAOO6IO
C        .
                 SCLMAD      SCALE RESIDUALS BY SCALING FACTOR                   HEAOO62O
C                SLDSPY      DOES STEM AND LEAF DISPLAY (CALLS OTHERS) St        HEAOO6ZO
C                SLLEAF      DETERMINES STEMS AND LEAVES $5                      HEAOO64O
C                SLPRHT      PRINTS STEM AND LEAF DISPLAY $5                     HEAOO6ZO
C                SLSCAL      DETERMINES SCALE FACTOR AND UNIT FOR DISPLAY $5     HEAOO66O
C                SLSORT      SHELL SORT IN INCREASING ORDER $5                   HEAOO67O
C                SMAD        DETERMINED MAD SCALING FACTOR                       HEAOO680
C                STARTO      USER START FOR I R L S                              HEAOO6PO
C                STARTS      Li START (FROM CLI) FOR I R L S                     HEAOO700
C                START2      L2 START CFROM MINSOL) FOR I R L S                  HEAOO7SO
C                START3      L2 START (FROII ORS) FOR I R L S                    HEAOO72O
C                SVMAX       ESTIMATES LARGEST S.V. OF UPPER TRIANGULAR MATRIX   HEAOOflO
C                SVMIN       ESTIMATES SMALLEST S.V. OF UPPER TRIANGULAR MATRIX HEAO074
C                UNIFOS      UNIFORM (O,.) RANDOM NUMBER GENERATOR FUNCTION      HEAOO75O
C                WANDPW      ANDREWS WEIGHTING UNCTI0N S                         HEAOO76O
C                WBIWGT      BI4JEIGHT (BISQUARE) WEIGHTING FUNCTION S           HEAOO77O
C                WCAUCH      CAUCHY WEIGHTING FUNCTION S                  S
                                                                                 HEAOO1SO
C                WELSCH      WELOCH WEIGHTING.FUNCTION $        .                HEAOO79O
C                WFAIR       FAIR WEIGHTING FUNCTION $                           HEAOOSOO
C                WGRADS      COMPUTES GRADIENT                                   HEAOOSSO
C                WGRAD2      COMPUTES SCALE INDEPENDANT MEASURE OF GRADIENT      HEAOOG2O
C                WHUBER      HUBER WEIGHTING FUNCTION $                          HEAOOG3O
C                WLOGIS      LOGISTIC WEIGHTING FUNCTION $                       HEA0040
C                WTALWR      TALWAR (ZERO—ONE) WEiGHTING FUNCTION S              HEA0085O
C                WUSER       USER—DEFInED WEIGHTING FUNCTION $                   HEAOOS6O
C                                                                                HEAOOG7O
C    .
                                                                                          HEA000SO
C                                                                                         HEA0089O
C                $ — WEIGHTING FUNCTIONS USED IN WEIGHTED LEAST SQUARES                   HEAOO900
C                                                                                         HEAOO9IO
C                $5 — PART or STEM AND LEAF                                   .
                                                                                          HEAOO92O
C                                                                                         HEAOOP3O
                                                 — 11   —




                                            Table   2 con't.


 C   NAME              DESCRIPTION                                                                 HEAOO37O
 C                                                                                                 HEAOO300
 C
                                                                                                   HEAOO39O
C    CL1               DOES AN Li START                                                            HEAOO400
C    IJELP1            PRINTS HELP FOR I R L S                                                     HEAOO41O
C    IRHELP            I r L S HELP COMHANt'                                                       H11A00420
C    IRLDR             INTERACTIVE DRIVER FOR I R L S                                              HEAOO43O
C    IROPN             GETS Ii OPTION FOR I R L S                                                  HEAOO44O
C    IROPNN            GETS 12 OPTION GR I R L S                                                   HEA00'30
C    IROPR             GETS REAL OPTION FOR I           RLC                                        HEAOO46O
C.   IRPRNT            I R L S PRINT COMMAND                                                       HEAOO47O
C    IRPROP            IR   L S OPTIONS COMNti                                                     HEA00'E0
C    IRSTAT            I R L S STATISTICS COMMAND                                                  HEAOO49O
C    IRSTLF            I R L S STEHaLEcF COMMAND                                                   HEA00oO
C    MATOA             GETS DATA MAT[JX FOR I R L S                                                HEAOO51.i)
C    MATOE             GETS RHS VECTOR FOR I R L S                                                 HEAOOZ2()
C    MAY01             A(I,J) = J * SURT(R)                                                        HEA000
C    MAY02             A(I,J) J / D                                                                HEA00'10
C    MAT0              A(IJ)    (I ' J) / Li                                                       HEAOO55.:I
C    MATO4             A(I,J) = 1 / C 1 + ABS(J—I) )                                               HEA005o
     MATO5             TLONGLEY riAT(,                                                             HEAO07O
C    MATO6             TLONGLEY F:HS                                                               HEA0OO
C    IIATO7            SLONOLEY DATA                                                               HEA003O
C    MATO8             LONGLIY Rt'IS                                                               HEA00.cO
C    HAlO?             LONGLEY DATA                                                                HEAOO61O
C    MATIO             1JPFE[   TRIANCL'L ACM) MATRYX                                              HEAOO62O
C    MATh              AUCJ FS                                                                     HEAO06:o
C    MAY12             DAUERII DATA                                                                HEAOO64D
C    tiAii3            BA(iEr DATA                                     HEA006:)
C    tIAT14        IDEU ITY EIAIRIX p cQN6rAT ROLlS OR COLS AFENDED    HEAO0.')
C    MAT15         (I--2/.E;:ET) SIGMA * (I—2/N*EET M(TR:':X           HEAOO67O
C    OTHER MA rxx fOUTfl'E (MAT1ó — MAY47) INCLUDE t'RAPEkSITH FROfiLISHAOCO
C                                                                                                   HEA000',9O
1    •,. ••, • • • •11
                     •. ** •0400+00.0
                             , •,s,* , * •*,,I 4•4(
                                                 • I 0*4110*
                                                         0*40*044•l••4• * *4I*l*t4$ III 00
                                                                                         •. *• 4
                                                                                               c •LrrAm(
                                                                                                 • oriL 4 ii—i'
     ••,40t,00                            • *                  * 4*444401*04.1,,,,.,,
C'
U    •*4 •0•t*
     4,4,0,0,,    00*4
               ••4•t     It*P0**400•e4*,,,,.•,
                     *44*144,00,40. 4•4040444** I 444001404*44 • 0*I400•*•44 •P4Af/'o.
                                                                                r14J./
                                                                — 12    —

 Sairp1e Terminal                Session   with some            Nunrical Results
      load        irlsdr (start
 EXECUTION BEGINS,.,
 I R L S ENVIRONMENT IWITIALIZEII
 FOR LISTING OF COMMANDS TYPE HELP
   SPECIAL OPTION NUMBERS:
              9 (Ii) OR 99 (12) PRINTS HELP
              8 (Ii) OR 9 (12) KEEPS OLD OPTION
 TYPE OPTIONS ON A NEW LINE
 IRLS COMMAND (A4)

 OPTION NJMDER? (Ii):                                (9 GETS HELP)
 IRLS COMMAND (A4):
 OPTION NUMBER? (Ii):                                (9   GETS HELP)
 IRLS COMMAND (A4:
 OPTION NUMBER? (12):                            (95'      GETS HEL.P)
 IRLS COMMAND (A4)
 OPTION NLJtII3ER? (Ii):                         (9 GETS HELP)
 IRLS COMMAND (A4)
 oPnoN NUMBER'? (Ii)                             (9 GETS IELF
 I RLS CONAND (A4 )
 OPTION NUMLERT (Ii)                             (9 GETS Fk.LP)
 I RLS COMMANO ( 4
 OPTION NUtIE:ERT (Ii)                           (9       GETS MELt)
 IER          =          1   OUTPUT FROM Li START
 IRLS COMHANi                 ((
• )iter
          ITERATION                1 T'fl[
 IRL3 COi1i-L (A4
>prcoO•prin
OPTION            NUMBER? (1fl (9 GETS                          HELI:
IRLS COMMAND A4:
AFTER ITERATION        1 X =
 o , 8992O67l:fcJ. 0. 93i9223):i+o —O 1 Yi652!+00
PREVIOUS X =
 O.9OS3?C4t'O1 O,9109109tt4•Oi --O.17090.2DO0
          I        RESIflUL (I)                           WtIAC ( I)
          1                 O546r±O' 0 1O9-O29r.•O0
               0. 59701901f'jO
               Q,747j! —•Di 0 7722D400 0
                                                                               lit X'G .t

          2                                                                  .25400;'D+3Q
          3  0. 100i.23:?r--ol                 0. 10000000+31               0. 44615?D00
          4 —O • 649T91:r-o1                   0, 9o769:n•          0 • 6OY•"0tHO0
          5 •O , 227OiS+OO                     (•i   • 92H2O57Li+0) 0. 251.0203D00
          6    0 • 3SS9'oEt;•oo         o . o12For.'1oo 0. 14i'427r•fo0
          7    0. 7O°c7715D-Oj          0, 99071 0: ri+0o 0, 2O73i7I:+o0
          8    0. 34):rv            01 0. io000o1'tc 0.2111 ?300i•o0
          9    0         773'.i-- 01           0•     100O0O000: 0 * 32i07OD+0O
      10 —o •      92A76L0i 0 97127:;2u uO 0. 2'.3o72D+0O
GRAIl) ENT ( rU              c'F;G:N: :...:vt.L )
 ()   •                            0. 29IJ57r+oc 0
I I.LS CLJW('Ni              (
                   1
OPTION Jr.C)T (Ifl (9 GLIS HELP
                                    5 IP   i          S




                       s'TEt•c.:'-L.r t'IiftI.. AV                     N        10
                                                           - 13   —


           1              LO I          —0.5978

                    C UNIT =          O.1000D—01       )


       2                 —2     12
       2                 —1. I
       2                 —1     I
       4                 —0. I 96
       4                 —0 I
       3                  0 1134
       3                  0. I 77
       I                  HI    I       0.3359
IERR =     0 F01 R[SIDULS
IRLS CONNE.ND (A4).
> stem . 2
OPTION NUER? (1U (9 GETS                 HELP)
                              TR IX




               STEh—i4t-Lr:Lr DISPIJY            N =          10



       1                  Ui I          0.554?

                    ( UNIT =          0.1000t'-Ol      )


       2                      F15
       2                      SI
       2
       2
       3
                          91
                          Ii. I

                           112
       3                   Fl
       4                   017
       3                  9. I 099
       3                10      1 000
1ERR            0 FO1 rirnNAL.        LL[Em. Q[: W-'TRT
IRLS COMHNI (ñ4)
>stci•3
OPTION NtThtEF.? (ii): (9 GETS EI.F)
                     H-iATRIX



               STEI•:—LEAr rtIs:L(y r         N               10




                    ( tfl'!IT         O.1000T,01
       1                  1 14
                                            — 1k   —




         2               1.18
         5               2 1134
         5               2.158
         3               3 £2
         2               3.1
         2               4 14
         1               HI I      0.6808
KERR      •     0 FOR DIAGONAL ELEHENTS or H—MATRIX
IflLS COMMAND (A4)8
bsta$09*tter
OPTION NUMSIfl C12fl (99 GETS HELP)
IRLS COMMAND A4):
** ITERATION       2 bOUE
**   ITERATION    3 DOUE
** ITERATION      4 DONE
** ITERATION      5 DONE
$* ITERATION      6 DONE
** ITERATION      7 DONE
** ITERATION      8 DONE
** ITERATION      9 bONE
** ITERATION     10 DONC
AFTER ITERATION       10 X a
 0.9483807Dt01 0.896?400D+01 —0. 2055357D+00
PREVIOUR X
 0 • 94005020+01  0 • C96971 90+01 —04 2053066D+00


     I        RESIDLIALCI)      WDIAGCI)      HDIAGCI)
     I   —0.53709Z08+00 0.47796650+00 0.26O1124D+00
     2   0.8163179)3-01 0.99257340+00 0 • 2529899D+00
     3   0.3059782)3—01 0.99O3490D+00 0.4461462D+00
     4   —0.99624OD—01 0.9890925D+OO 0.6597202D+O0
     5   —0.2271626D+Q0 O.9424843D+O0 0.23770270+00
     6   0.416209r1n+oo 0.8070726D: 00 0. 1199851D+00
     7   0.9705210)3—01 0 •9O?5256D+00 0.27201000+00
     8   0.69966150—01 0. 9945766D+00 0.1957716)3400
   9     O.5335376D—01 0 .9960091D+O0 0.3197170D+00
  10     —O.62350S0D-01 0.99063440+00 0.23554 1 D+00
CRDIENT CCONVERREHCC LEVEL) —
?0.8010088U—03. —0. 70?30c2D-c.3 —0.10262000-02
                                                     — 15 —

    IRLS COMMAND (A4)
    >ma>ci*20tstep*10$jter
    OPTION NUMBER? (12): (99 GETS HELP)
    IRLS COMMANt' (A4):
    OPTION NUMBER? (12): (99 GETS HELF)
    IRLS COMMAND CM):
    ** ITERATION    11 DONE
    ** ITERATION    12 DONE
    ** ITERATION    13 DONE
    ** ITERATION    14 DONE
    ** ITERATION 15 DONE
    ** ITERATION    16 DONE
    ** ITERATION    17 DONE
    ** ITERATION    18 DONE
    ** ITERATION    19 DONE
    ** ITERATION    20 DONE
    AFTER ITERATION    20 X =
     O.9488401t'+Oi 0,8964120t'+Ol —0 • 205e397t'+00
    PREVIOUS X =
•
     O.94O34D+O1 0.8964131D+01 —0 • 20535C6D+00
       I    RESIDUAL(t)              WDIAG( I)            HDIAO( I)
       1 —0.5365333fl+00      0 •   67910S1D+00      0 • 2607970t1+00
       2 0.8169217t'-Ol       0. 9925609D+00         0. 2530 100D+O0
       3 0,3875669D—01        0 •   998375711+00     0. 446120DF00
       4 —0,9950503D—01       0 •   9639630D+00      0 • 6594á30tl+00
       5 —0.2271803D+00       0 • 9 ' 246 SE' + 00   0.2377160t1+00
       6 0,416475D+00         0 • E06ó322D+00 0. 1i9Gi3rlfoo
       7 0,9721647ti-01       0, 9894.49D1-00 0. 2719496tI+.)0
       8 0,702.cj(J:—oj       0. 99445'601.t+00      0. i556213ri+oo
       9 0.53619tT-o1         0. 996798t'+00         0.3197342D 00
      10 —0.62O254oD—         0 .9971 14D+00         0 23s736sri-oo
                                                      •




    GRADIENT (CONVFSGLHCE LEV:T..) =
    —0 ,4263579Ll—0 —0 3806967D—(j —0. 496056D--05
    IRLS CO .N1) (A'i
• >Steff 1
    OPTION NU1J[RT (Ii (9 GE1L3 HELP)
                    RESIt'UALS



               STEM— v—LF DISPLAY, N                       10



           1             LO I          —0,5365

                   ( UNIT =          0.1000D-01 )
           2            —2 I 2
           2            —1.   I
                        —1    I
        4               —0. I 96
           4            —0 I
        S                0I3
        5                0. I 5789

           1             HI I           0.416'.5
                                                        — 16 —


IERR =    0 FOR RESIDUALS
IRLS COMMANI) (A4)
>ster2
OPTION NuMEER? (Ii): (9 GETS HELP)

                     U—MATRIX



               STEM—AND—LEAF DISPLAY, N =                   10



       2                      LO I         0.6791        0,0067


                    ( UNIT=              O.1000D—02
       3                  94 12
       3                  95 I
       3                  96 I
       3                  97 I
       5                  98 189
       5                  99 I 24563
ILir
IRLS c:L 4)
)stem3
                0 FOR IGONAL ELEMENTS OF w—MATRIX

OPTION N1JMIER?      (Ii):       9 GETS HELP)
                     H—MATRIX




               STEM (;?!HLEAF         DISPLAY N             10




                      uNIT =            o,iooo1:••-(i
       1                      1 Ii
      2                       1.19
       4                      2 133
      3                       2.I67
       3                      311
                              HI I         0,462        0.695
TERR           0 rO J1(GJNi. ELI EN1S OF H—MATRIX
I1t.S COMMAWr,
>sti01
OPT icni
                      >



           Nu:;EE' ( 17)
                          :
                              r3( 9 GETS HELP
I RLS CO' ( ('1
OPT TON NUTE? Ti.                    9 rJriS IflJ.r
Iii... S c n
OT I UN NUN!LR        Ii): ( 9         GLTS H:L_P
                                                        — 17 —

IERR =   0 FROM QR START AND RANK TEST
IRLS COMMAND A4:
>iter
** ITERATION    1 DONE
IRLS COMMAND (A4):
>prco*0*priri
OPTION NUMDER? (lU: (9 GETS HELP)
IRLS COMMAND (A4):
AFTER ITERATION    1 X =
 0,807929D+01 0,9728491D+01 —0,2274461D+00
PREVIOUS X =
 0.1030152D+02 0,8494711D+01 —0.2663214D+00
       I    RESIJ:'UALfl                 WDIAG( I)            Hr.'IAG( I)
       1 —0.4987939Ti+00          0.7268122D+00         0 •   296944tiUi0
       2       0,058436411—01     0 • 9934683 ti + 00   0 •   2609452t1 F00
       3       0,513E344Li—01     0 • 99763F37t1+00     0 .4560911D+00
       4       —0.1229230D+O0     0 • 961 190 1D+00     0 • 64194!8D+00
       5       —0.2270730D; 00    0. 9134825r1•:00      o .230144311+00
       6 0.43314451itO0           0. 7190397D+00        0.964341811—01
       7
       0.1072354D+0O              0.9775559tt+00        0 • 267898611+00
    8 0,9057973D—01               0. 9009222P+00        0.109230911+00
    9 0.64C()4D--0l               0 • 99396'6t'+00      0,324567111+00
   10 —0.40'606Th—Cl              0 • 9998'O0ti+00      0 •   235798311+00

GRADIENT C vEr3:wCE LEVEL) =
 o,38612;3D--oi 0,2549i3ti—01 ,62O052D—01
IRLS COt1HAND (Al)
  3t(i 1
OPTiON NtJiEE? ( 11 )             (9 GEM HELP)
                         RES ID U .L S




                   STDH(iND—LE(F LiPLY, N                       10


           1                 LO I          -0.4980

                          UNIT            0.100011—01

           2                —2 12
           2                —1. I
           3                —1 12
           3                —0. I
           4                —0 14
           4                 01
           4                 0, I 5J'
           2                 1 10

           1                 HI   I         0.4351

IE1d                0 FO FFSILIUALB
I1L tc)t;(:r' (4
>t-:-2
01.1   1ti4 NtJML.h:? (Il) (9 1TS HELl)
                         W—iiAT x
                                              — 18   —




            STEM—AND—LEAF DISPLAY, N =               10



        2            LO I          0.7198      0.7260

                 ( UNIT =       0.l000t'-02
       3            91 13
       3            92      1
       3            93      I
       3            94 I
       3            95 I
       4
       5
                    96  Ii
                    97 I?
       5            90 10
       4            99   I 3:379
IERR =   0 FOR t'IOL ELEHENTS OF W—i'IATRIX
IRLS COMM(WD (A'
>stefflZ
OPTION NUMDER? (Ii)      (9 GETS HELl')
                  H—MATRIX




            SIEN-AND--LEAF DISPLAY9 N                10




                  UNIT =        O,1000D-O1
    1               0.19
    1
    2
                    11
                    1.10
   4                2 133
   3                2. I 669
   3                3 12
   2                3, I
   2
   2
                    41
                    4.15
   1                Ill I        0.6419
                                                          — 19 -




• IERR =    0 FOR DIAGONAL ELEMENTS or H-MATRIX
 IRLS COMMAND (A4':
 >ste*O9* i ter
 OPTION NUHER? (12) (99 GETS HELP)
 IRLS COMMAND (A1)
 ** ITERATION     2 DONE
 ** ITERATION     3 Li ONE
 ** ITERATION     4 DONE
 ** ITERATION       DONE
 ** ITERATION     6 [lONE
 ** ITERATION     7 DO NE
 ** ITERATION     8 ['ONE
 ** ITERATION     9 DO NE
 **. ITERATION    10   LION E
AFTER ITERATION     10 X =
 o 8800965D+O1   0. 941993 ti+0i -0, i37072D+O0
PREVIOUS X =
 0 .8827831D+Ol 0 ,94014O7L:0i. —'O 1 'c956D{00

    I    RESIDhiL(I)            wr'ic; ( I i                   HDIAC I)
    1 —0,6179779t'+OO      0 4 7 o EJ 3 u7   ii   + 00   0, i42304D00
    2 0.8068059Lt—O1       0•   999421it+00              0. 233161fl+     00
    3 0.2165610r1—01       o • 9992975t'+OO              0 • 4526957D0')
    4 —0.4718711L'--Ol     O • 99   6 V D + 00           o * 699060(Ef 00
    5 —O.219667SDOC        0 93311721,1+00               0 • 234376)'f 00
    6 0.3803538t' 0        O.79i0O5t' Oo                 o i 23/706Li-00
                                                           •

    7   O,722067iiT'-Ol    O • 992 t l :1.0 Li + 00        2Gi56;r+00
                                                         0 *
    8 0.26Th57J'—01        0 • 99Cfl?3Li+O0              0.222i32r;o0
    9 0.43830SD-01         0 • 9'72916DI00               o • 320000'?'il+C'O
   10 —0,1O937Ofl1O0       O,914OJ i7D+0                 0.2Z/31J2Li•:;o
GRADIENT (COUVEEWCE LEVEL) =
  0.7703324D—07 0.67699i3:-o2 0.9:i.670301)--02
                                                    — 20 —
.IRLS COMMAND A4):
>step*lOtiter
OPTION NUMBER? <12): (99 GETS HELP>
IRLS COMMAND (A4)
** ITERATION      ii DONE
** ITERATION      12 DONE
** ITERATION     13 DONE
** ITERATION      14 DONE
** ITERATION     15 DONE
** ITERATION     16 DONE
** ITERATION     17 DONE
** ITERATION 18 tIONE
$* ITERATION     19 DONE
** ITERATION 20 DONE
AFTER ITERATION      20 X =
 0.8720285D+01 0,9475467tt+01 —0,1511232t'+OO
PREVIOUS X
 O,8722084t1+01 0,9474230D+01 —0,1515493D+00
    I    RESIDUAL(I)                 UDIAG (I)              HDIAG(I)
    1 —0.62774S7DO0          0 .4540247D+00         0, 13650070+00
   2 0.8007077F1"-O1         0.991 1210D+00         0,2530704D+00
   3 0.1905696D--Oi          0 • 9994942D+00        0 425619D+00
                                                        •


   4 —0,41299O.--0i          0 • 9976236t1+00       0 • 7029458t1+00
   5 —0.219267Ei0            0.9 34 z 3 It + 00     0.2343049D+00
   6 0.37570I:•00            0 • 004420411+00       0 1316020D+00
   7        0.691979011-01   0 • 993iQ0t+00         0. 2027640D+00
   8        0.2143430L—0i    o.9993S69rJ••oo        0 • 2252373Df 00
   9 0.42618070—01           0. 9974U221i+00        0 .3200544D+00
  10 —0,115i000t'i00         0 * 901 o993'+00       0 2608286t1+00
GRADIENT (CONVERGENCE LEVEL) =
 0.5199742t1—03 0. 456i387D-03 0 .6202752D—03
IRLS COIMAND (A4)
> stm 1
OPTION NUMDER? (I1)           (9 GETS HfLP)
                     R ES : DUAL S




               STEMLI LEA ttISLAYr N =                       10



        1                LO I          —0.6277

                       UNIT =         0,1000tl—01   )



        2               —211
        2               —1. I
        3               —1 Ii
        3               —0. I
        4               —0 14
        3                0 1124
        3                0. I 68
        1                HI I           0.3758
I LRR           0 FÜR JS 1 ULS
                                                 — 2]. —




IRLSCOMMAND (A4).
>stem$2
OPTION NUMBER? (I1) (9 GETS HELP)
                    W—MATRIX




              STEM—AND-LEAF DISPLAY, N             10



       2               LO I         O,454ii     0.8044


                   ( UNIT =       O.1000D—02

       3              93 13
       3              94 I
       3              95 I
       3              96 I
       3              97 I
       4              9811
       6              99   I 137799
IERR =   0 FOR DIA6WAL ILEIIEg4IS OF L4—MATRIX
IRLS COMMAM[ .A4):
> stern*3
OPTION      NUli:ER? (I1) (9 GETS HELP)
                    H—MATRIX




             STEM—AND—LEAF DISPLAY,                10




                    UNIT =        0.l000ti—O1
                       1   I 33
       2               1, I
       4              2 123
       3              2,1568
       3              3 12
       2              3. I
       2
       -,
                      41
                       ¶4 T£ J
                       A




       1              HI 1         0.7029
TERR          0 FOr JYiC(L ELEMENTS OF H-MATRIX
                                   — 22




    In conclusion we show the listing of one subroutine - the Biweight
weight function. The software on tape for the iteratively reweighted
least squares problem is available from the Algorithms Distribution
Service, The authors of this paper are responsible for any modifications
that subsequent use may show to be necessary.
                                                                — 23 —


          SUDROUTINE WBIWGT(N,U,CONST,sQW)                                                           WBI0001O
    C *****PARAHE.TERS                                                                               WBI0002O
          INTEGER N                                                                                  (48100030
          REAL*8 U(N)CONST,SQW(N)                                                                    un 100040
    C *****LOCAL VARIABLES:                                                                          WBI000,0
           IN TEGER      I                                                                           WDI0006O
           REAL*8       OFLIM,UFETA,U1,PROD                                                          WBI0007O
    C *****FUNCTI ONS:                                                                               WBI000Bo
          REALY 8 DABS                                                                               WBI0009O
    C                                                                                                WBIOO1C'O
    c
    S..
           •, ,, •5 • • + +545i••, •s ,,,,5 5i•,s4•d .5,,,., ii,,,,,, •i,•,,,•, ii,,,,,,
           ••i+•**$I•I+++t4t5et$t444+dtst••t4*•d••d*•e44i.•+4,4,+,,,,,,4,,+,.wLVv
                                                                                                     WDIOO1IO
           dffdtd +444i4 444.4 f idi •i+d 4d5 45 6+14 544544 .5*44, 54*6544 54 III +554(5
           •t 4, ++t + .4, 4+, 4 •4iG+• + 4i•••• 64•tittt•t• *5,4*4 •+•54+++ee •++ i • 4+t* •WL'L'JViJ.j'J
    C                                                                                                WrJIooJ.io
    C                                                                                                WBI00150
    C ***puRrosE:                                                                                    UET00160
    c     THIS 6I'rRouTINE PRODUCES THE SfWARE ROOTS OF THE WEIGHTS          WBIOOI?0
    C     DETERU:Nri J3Y THE INFIJI VECTOR U OF PREVIOUSLY COMPUTED          WBIOOJ.8O
    C     SCALED HESIDUALS AND THE DIWEIGHT (t'ISOUARE) WEIGHT FUNCTiON, (1) WEI00190
    C                                                                                                Wt'I00200
    C                               r'EscRIPTIo:                                                     WtsIOO2i3
    c                                                                                                WEI002;C'
    C     ON I14UT:                                                                                  WDI002O
C
C               N MUST )E SET TO THE NUiiTR OF ELEMENTS IN THE V[CTORS U AND
                                                                                                    t4DI002'
                                                                                                     (4B100250
C                    SQWS                                                                           WBI002O
C                                                                                                   WB100270
C               U CONTAINS THE STANDARDIZED RESIDUALS FROI A PREVIOUS LIHAR                         tJDIOO200
C                       En,            THAT IS, WI)   R(I) / S WHERE ri) IS 111 1-TH                WII002)
C                       RESIDUAL          ROH A LINEAR FIT, R(I) = YCI) — YFITTEJI),                WDIOO300
C                       ANi) S  S(R) IS A RESIDUAL SCALING FINcrION CE, C • S COUL1 L)tI0OJ.0
C                       DE THE OUTPUT OF THE FORTRAN SUFIROUTINE SMAI:).
C                                                                                                   L4DIoo3:o
C               CONSI 75 THE 'TUNING COHSIAUT' FOR THE WEISHT FUL!CT ION                            WDIU0O
C                       UCU) •          CONST IUST LE iUi;xriva (SEE APPLICATION                    WDIOO3L)
C                       ANJ) USACE RES1R!CTIO'6),
C                                                                                                   tiflI0070
C         ON OhiTrUT:                                                                               wiIoo:sco
C                                                                                                   WDIOo3qo
C               SOW CONTAINS A VECT0 OF THE SQUARL ROOTS OF THF L.FGHTS                             WSI0 C0
C                   DETERMINED DY THE SCALED RE3IDUAS AND TIE ifl TGHTI.1t                          WBIO61O
C                       FUNCTION,                                                                   WEI00•'2j
C
C **$:(FrI_i            c              ANn IJsca;f: RFSTI<ICt   IONS:
                                                                                                    Wtt10043(
                                                                                                    WEI004'O
C         THE LO r•—•E1;HrS (R iEEDDi FUR THE CO;UTnTIciH or iic                                    Wtioo5c•
C         ]TFRATI VEI...y 1LLE:. Ii;HTLLs LEAST SfltiAtES LSTXHArLs USIN ii 5                       WDIO0 tO
C
C
          FORTr:N SUfCJU lINES MI I:FIT
          SOW
                                           HINSOL •     (ti
                                                       lrJ TI (IS CONUTTJ:cJN
               ) NULTIFLILS •IHE CoRrEsr•oin:'i:jo ROWS (IF THE XMATRIx
                                                                                                    WtIO047c
C
                C

          AND IRL Y—VECTOH. (1
                                                                                                    WBIOO4
                                                                                                    WEI0I9C
C
                                                                                                    (Jt'I00)'
C         THE I..AfCr R         TH Vi':LIIE OF CUS1 TILE MORE NEARJ_Y ALL THE V(LUS                 W5100510
C         or    LJ(U)   (jILL EQLJ(L UNITY                                                          WDIOOS2C
C
                                                                                                    WDI005C
C         IF CON         .i.   s    T\L: 1(i .:E VERY ShALL. IT IS POSSTT:L[: TO PROJc          A
C         VECTOR UF RUST -HF:
          zrRo, (                      'JILL i.r
                                                   ALI_ O,   LII I CII EfIU:L HR NEARLY EflWL       UEI00
C                              TI,V,                  LI      , INI U' TO THE UFi • H L' LLi        WttI 00/(
C         SP')AkHS CO              ,'TA I IONS.                                                     WBIOOS;'c
C
                                                                                                    U DI 0(15 U
C         IF A EHN 5 C5TcI VAL LIE 01 '1, tO IS I.JSEII , u;!rEr: TI                                       1005
                                   I R'k 1UF RI U '0 1 Tlh TUR
                                                                                                    U T.
C                r 11 t'I Ct II
C         JILL II•;VL 9., I•L1L.LI!1 ,J',':.-1r(: rr:IcsirY                                         U I 100 tIC
C
                                                                                                    WEf I ooo:;
e                                            — 211   —.                          .
                                                                                             148100630
C *****ALGORIThM NOTES                                                                       118100640
C        THE INPUT PARAMETERS ARE CHECKED TO AVOID UNDERFLOWS AND                            148100650
C        OVERFLOWS.
C
                                                                                             148100660
                                                                                             148100670
C    *****REFERENCES:                                                                    s
                                                                                             wexooaeo
C       (1)     BEATON.A.E. AND TUKEYpJ.W4(1974), TECHNOMETRICS 16,                          148100690
C               147—192.                                                                     148100700
C                                                                                            148100710
C    ***$*HI STORY S                                                                         148100720
C        ROSEPACK RELEASE 0.4           MARCH 1977             .
                                                                                             148100730
CS       IF (IBM) THEN             .
                                             .                                       .       148100740
CC       IBM 360/370 VERSION                                                                 148100750
CS       ELSE IF (XEROX) THEN                .

CC                                                                                           148100769
         XEROX VERSION                                                                       148100770
CS       ELSE IF (UNIVAC) THEN                                                               148100780
CC       UNIVAC VERSION                                                                      148100799
CS       ELSE IF (HIS) THEN                                                                  148100800
CC       HONEYWELL VERSION                                                                   148100810
CS       ELSE IF (DEC) THEN                                                                  148100820
CC       POP 10 VERSION                                                                      148100930
CS       ELSE IF (CDC) THEN                                                                  140100040
CC       CONTROL DATA VERSION                                                                1481008W
CS       ELSE IF (BGH) THEN                                                                  148100960
CC       BURROUGI iS VERSION                                                                 148100070
         ELSE, 1 CARD                                                                        unooSao
CC   S   ********$* MACHINE VERSION          ****t***tS                                      148100390
CS       IF (SINGLE) 1 CARD, 1 CARD                                                          148100900
CC       SINGLE PRECISION DECK                                                               148100910
CC       DOUBLE PRECISION DECK                                                               148100920
C                                        .                                                   148100930
C    *$*CtGEHERALS                                                                           148100940
C        QUESTIONS AND COMMENTS SHOuLD BE DIRECTED TO:                                       148100950
C           ROSEPACK STAFF MANAGER                                                           148100960
C           COMPUTER RESEARCH CENTER FOR ECONOMICS AND HANAGEMENT SCIENCE                    11D100970
C           NATIONAL BUREAU OF ECUNUMIC RESEARCH                                             148100980
C           575 TECHNOLOGY SQUARE                                                            wnoocto
C           CAMBRIDGE, MASS. 02139.                                                          WBTOIC'OO
C                                                                                            148101010
C        RESEARCH AND DESIGN OF THIS PROGRAM SUPPORTED IN PART BY                            148101020
C        NATIOUAL SCIENCE FOUNDATION GRANT GJ—1154X3 AND                                     80101030
C        NATIONAL SCIENCE FOUNDATION GRANT DCR75—08802                                       140101040
C        TO NATIONAL DUZAU OF ECc'Nfl;f XC RESEARCH, INC.                                    148101050
C                                                                                            W8I01060
C                                                                                            140101070
C
C        ::::::::::n ::::::::::::::t::::s ::::::: t::::::::::s:s::::: $ttl ::::lmIo.Locq
C                                                                                            WBI0fl00
C                                                                                            88101110
C        :::::::::: OFLXH IS THE LARGEST POSITIVE FLOATING POINT NUflBEk                     WDIOI 124
CS       iF (1DHL) THEN                                                                      148101130
CC          IBM 360/37(fl 011.111 —    (16.5t63)E(1. — 16.t*—6) :::fl:zu:                    WBIC't140
CS       ELSE IF (18142) THEN                                                                14010.1150
CC          1DM 370/360: OFLIII   a C1/.**63)*(1, — 16.**—14) ::t:zm::                       8810L160
CS       ELSE IF CXE1OX)    THEN                                                             IJDI01.L70
CC          XEROX: OFLXM    = (16.t*63)tCi. — 16.*t—6) :unu:::                               88101180
CS       ELSE IF CUNIVtC) thEN                                                               88101190
CC          (INIVACI OFLI!, a   (2.*t127)*C1.        —   2.*t—27)   ::::::::::               140101200
CS       ELSE IF (HIS) THCN                                                                  WDI0210
CC          HOUCYIJELL:   OFLIM (2.tt227tU. — 2.**—27) UflU flu                              140101220
CS       ELSE iF (DCC) THCN                                                                  148I0}230
CC          POP 101 On.IH —     (2.**127)*(1.        — 2.**—27)     :1:1::::::               148101240
CS       ELSE IF (CDC) THEN                                                                  110101250
CC          CUNTflOL nnm; nrLxii        2.fl1922)*(2.fl40 — 1.) :u:s::u:                     88101260
CS       ELSE IF (7;GH) TibtN                                                                WDIOJ 270
CC          kumwucius:    WLIH = (8.**63)*(8.t*11 — 1.)             :::uu:::                 88101200
                                                                       — 25 —

    Cs         ELSE, 1 CARD                                                                                       WD10129C
    CC         ********** DATA STATEMENT **********                                                               WBIOI3OC
    CS         DATA OFLIM /SINFP/                                                                                 WB10131C
               DATA OFLIM /Z7FFFFFFFFFFFFFFF/                                                                     W810132C
    C                                                                                                             WB 10
    C          :::::::::: UFETA IS THE SMALLEST POSITIVE FLOATING POINT NUiiBEF                                   WB1013(
    C              S.T. UFETA AND -UFETA CAN BOTH BE REPRESENTED.                                                 WB 101 3
    Cs         IF (IBM) ThEN                                                                                      WD 101 3 C
    CC             IBM 360/370: UFETA = 16.*—6 ::u:::u:                                                           UB 1013? C)
    CS         ELSE IF (XEFWX) THEN
                   UIUA
                   A r.r 4 IrrrA
                         4 ur E I Fl --IL      J 444444444+
                                        JO, .t'UJ
    L
    LL

    CC
               ElSE IF (UNIVAC) THEN
                    UNIVAC: UFETA = 2.**—129 :::::
                                                   4 ••4444444                                                    Wti101320
                                                                                                                  WBIO14Ot)
    C          ELSE It         (UTS) THEN
                                                                                                                  WB 10141 'D
                                                                                                                  14 DI 01
 CC                 HONEYWLLL UFE1A = (2.**—126)                              :      : :1::::                     UIZU14Ci
 CS            ELSE IF (DEC) TH.:N                                                                               WBIOI4/rC
 cc               Pup 10: UFETA                   2,*—129          : : : : : : : : : :                           W B 1014 0
 Cs            ELSE IF (CDC) THEN
 CC
                                                                                                                 WDT010
                    CON1OL DATA UFETA = 2,i*—973                                  ::::::::::                     UB 101.470
 Cs            ELSE IF (BGH) THEN                                                                                WBI01CC.
 cc                 riuRr.ouc3Hs: (JFETA           = o.*x<--i           :::       : : ::::                       WBIO149Ct
 Cs           ELSE, 1 CAD                                                                                        [48101          0
 CC                                   DATA SIATEHENr :***                                                        WBI011.'
Cs            rIATA 11FET( /SETA/                                                                                WDI01;.j
              DATA UrLTA /Z0010000000000000/                                                                     WDXO.1       ¶9
C
C                                                                                                                WJI0 Itt
C **.iODY                 OF FFOGRA11                                                                            Li B I 01 :;:
              ir (COOST , LE •          1   •   01:0) PROD         OFLTH * CONET                                 Wi )T   01 ;•,•
              IF (CO(T .01, 1.Ot'O) FFOD                           UFETA >< CONST                                WD
C
                                                                                                                 013 101
              DC 100 IN                                                                                          WB 101 c 0::
                    Ui         t'Ars( UC1)                                                                       WD101(
                    IF (Ui •LE. COSI) GO TO [0
C                   •+444*4*4I  r,r4—.Ifr        r-I r'rI—r 4144441441
                                     U .1. ) / • U
                                                                                                                 wr 1016


         i
                                                            ••4444•4••
                                                                   •
                    S0t4(I) = 0.0130
                    GO   IC)    100                                                                              WI) 016:
                    Coi11i:UUE


C                   ,c
                    IF (COST •LiT. 1.0130) GO TO 20
                    IF   (UJ •LE. ,Irr.ev..
                    SQW(I)
                    Go rn ioo
                                  PROL) ( i'p't
                                   0.0130
                                            IC) 20
                                                          •1
                    +44,4,444+ L1J4L,Li. IUUL?.' LJ\I.I'.LL,:                            •44,4tt•tt
                                                                                                                 UB 10 :.
                                                                                                                 U L' ro.; 7
                                                                                                                 WlI01Y'
                                                                                                                 1)   :ro
                                                                                                                 l)R:. Of.
         20         CONTINUE
                    IF (CONST +L4I 1.0130) GO TO 30                                                              (t 10177
                    IF (Ui •GE, PROD) (30 TO 30
C                    : : : : : : : : : DIVISIc           WOULD UN::RrLc'j                :::::::
                    500(I)            1.0130                                                                     Wb 10   i.
                    GO   TO 100
         30         CONTINUE                                                                                     t21 72
c                   :::::::::           FUNCTION CAN 1;L CONPuIEI: NURJ1AU_y                          :::        wioi;           -
                    Ui   U(T)
                    SGU(1)
                                      / CO1
                                   ((0,.,t:       ••   Ui)   •-   O4Lo)       ': ((O.:.,I:io    — Ui) + 0.130>
                                                                                                                 I)0
                                                                                                                 w;Ioi .i
        100 C0TIN:                                                                                               1!I'D1 r;:)
C
              lETUf:ii
c             :::::t:
              [Nb
                                                                          ::::ti.::
R;       T=0I0c/o(6o
                                   — 26   —




Acc-iowlednents

     The authors are grateful to many people for their assistance in
doing this work. Especially we thank Jol'n Dennis, Gene G3lub, and
Roy Welsch for their helpful suggestions. Da.vid Hoaglin and Stan Wassern
provided the software for the stem-and-leaf display which gives a useful
sury of computational results. Richard Bartels made available the
software for the  start. Alan Cline, Cleve Moler, G. W. Stewart, and
J. H. Wilkinson shared with us their technique for estimating the
condition number of a matrix. David Gay, with valuable advice from
David Hoaglin. on random number generators, wrote th code for the condition
estimate.
     Michael Sutherland and Richard Becker helped to check the software
on CDC and Honeywell computers, ]uglas Raynor ran several versions of
the code on the PDP 10, T. J, Aird and Ed Battiste supplied the Fortran
converter from D4SL,
     Paul Velleman, after using the interactive driver from its own
documentation, made valuable suggestions concerning documentation for use.
Maurice Herlihy and Steve Peters independently used the software, checked
parts of the program and documentation for use. Sandra Mori.rty has provided
technical assistance throughout the period in which this work was done.
                                              — 27 —




 References

 1.   Aird,    T. J., "The Fortran Converter User's Guide," IMSL,              1975k

 2.   Bartels,    R.,   and   Conn,   A., "Linearly   Constrained Discrete

      Problems,"    Johns     Hopkins University,     Technical   Report   #248,

      June 1976.
 3. Clime, A., 1bler, C., Stewart,           G.   W., and   Wilkinson,   J.   H.,

      "On   an Estñate for the Condition Number of a M3±rix," inforrr.].
      nnuscript, 1977.
 4.   Dennis, J., private conlrruinica-tion, June 1976.

 5. Draper, N, R., arid Smith, H., Applied Regression Analysis,

      John Wiley arid Sons, Inc., 1966.

 6.   Draper, N. R., and Stoneman, D., "Residuals and Their Variance

      Patterns," Technometrics, 8, 1966, p. 695—699.

 7. Garbow, B.      S.,.   Boyle, J. M., DDngarra, J.       J., and Moler,    C. B.,
      Matrix   Eigensystem     Routines   - EISPACI< Guide Ectension, Springer-Verlag,
      Lecture   Notes in Computer Science,         51, 1977.
 8. Golub,     G., Kiema, V., and Stewart, G. W., "Rank           Degeneracy and       Least

      Squares   Problems," University       of Maryland,    TR-456,   1976, Stanford
      University,    STAN-C5-7 6—559,      1976, National Bureau    of Economic

      Research, Inc., Working Paper 165, 1977.

 9. Hoaglin, D. C., and Wasserriri, S., "Autonting Stem—and-Leaf Displays,"

      National Bureau of Economic Research, Inc., Working Paper 109, 1975.

10. Hoaglin, D. C., and Welsch, R. E., "The Hat Matrix in Regression

      and ANOVA," Harvard University, Deparnent of Statistics, Men. NS 341,
      December 1976.
                                             — 28   —




11.     Holland, P., and      Welsch, R., "Robust Reession Using Iteratively
        Reweighted Least Squares," Communications in Statistics: Theory

        arid   Methods, 1977.

12.     Ka.den, N., and Kiema, V., "Guidelines for Writing Semi-portable
        Fortran," National Bureau of       Economic Research, Inc.,   Working
        Paper 130,    1976.

13. Lawson, C. L., and          Hanson, R. J., Solving Least Squares    Problems,

        Prentice-Hall,    Inc., 1971.1..
ill..   Ryder; B. G., The Fortran Verifier: User's Guide, Computing
        Science Tech. Report 12, Bell Telephone Labs., 1975.
15.     Tukey, J. W., Exploratory ta        Analysis, Addison-Wesley, 1977.
16. Van Der Sluis, A., "Condition, Equilibration and Pivoting in
        Linear    Algebraic Systems," Number.   Math. 15   (1970).
&'rata Sheet to Working Paper #189.

Table of Contents: replace lines 2, 3, and 4 with
                    Section 1, Iteratively Reweighted Least Squares . . . 3
                    Section 2, Selecting the Rank of the Data Matrix. . . 6
                    Section 3, Some Numerical Results .                   8

page   1,           Introduction:       para'aph 2, line 5: replace
                    "Optionally"     with   "Displaying".
                   paraaph 2, line 6, 7: replace "can be displayed" with
                    "is   an option".
                   paraph 3, line 1:             "The usual     statistical   information -
                   thenumber. . . ."
                   paraaph 3, line 4: Insert a dash                (-)   between "weight"
                   and    "is".

page 2,            pare'aph 2, line 3: replace "Rather" with "For such
                   information".
                   paraaph 2, line 4: !?and the references therein".
                   para'aph 3, line 3: renove the hyphen.
page 3,            insert subheading: "Iteratively Reweighted Least Squares"
                   line 2: "...years. It is..."
page   4,          line 5 from top:         equation 'si-oud read
                   =      w+1l/2A+(w'2b
                   Line4frcmbot-tom: addasubscript                 2, to
                   Shouldread:        II'112•
                   Insert after last line: "The function that is       being
                   minimized      determines the formfl.a for the weight function
                                                            m
                   used. In general,        we   nu.niize   E   p(r.1 (x)/s) so that   the

                   weight   function is given by a W(u)            p' (u).

page 5,            line 2: Tuning Constant" (should have elava-ted asterisk).

                   line   6 from top:    function is 11(1+        u/Ff).
                      —2—




page 5,    insert as footnote;
                 These are default values for the tuning constants
           •
                 which are desied to have 95% asymptotic efficiency
           •     with respect to ordinary least squares when the
                 distrubances frcrn the nonnal or Gaussian distribution
            -    and a scaling fmction converge to the standard
                 deviation of that disturbance distribution.
page 6,    insert subheading: "Selecting the Pank of the ta Matrix"
           para'aph 2, line 6: insert a corrma after "occur".
page 8,    insert subheading: "Some Numrical Results"
page 28,   reference !4: replace "private corrffrrunication, June 1976"
           with "Non-linear Least Squares and Equations," The State
           of the Art in Numerici Analysis, Academic Press, 1977.
