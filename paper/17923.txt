                                NBER WORKING PAPER SERIES




            PRICE SETTING WITH MENU COST FOR MULTI-PRODUCT FIRMS

                                        Fernando E. Alvarez
                                          Francesco Lippi

                                        Working Paper 17923
                                http://www.nber.org/papers/w17923


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     March 2012




We thank Andy Abel, Ricardo Caballero, Carlos Carvalho, John Leahy, Bob Lucas, Virgiliu Midrigan,
Luigi Paciello, Ricardo Reis, Rafael Schoenle, Kevin Sheedy, Rob Shimer, Paolo Surico, Nancy Stokey,
Harald Uhlig, Ivan Werning, as well as seminar participants at EIEF, the University of Chicago, the
ASSA 2012, the Federal Reserve Banks of Chicago, Minneapolis, New York and Philadelphia, the
Bank of Italy, the European Central Bank, the London Business School, the Bank of Norway, and
the 2012 NBER Monetary Economics Meeting in NY for their comments. Alvarez thanks the ECB
for the Wim Duisenberg fellowship. We are grateful to Katka Borovickova for her excellent assistance.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this research.
Further information is available online at http://www.nber.org/papers/w17923.ack

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2012 by Fernando E. Alvarez and Francesco Lippi. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Price Setting with menu cost for Multi-product firms
Fernando E. Alvarez and Francesco Lippi
NBER Working Paper No. 17923
March 2012
JEL No. E31,E4,E52,E60

                                              ABSTRACT

We model the decisions of a multi-product firm that faces a fixed “menu” cost: once it is paid, the
firm can adjust the price of all its products. We characterize analytically the steady state firm’s decisions
in terms of the structural parameters: the variability of the flexible prices, the curvature of the profit
function, the size of the menu cost, and the number of products sold. We provide expressions for the
steady state frequency of adjustment, the hazard rate of price adjustments, and the size distribution
of price changes, all in terms of the structural parameters. We study analytically the impulse response
of aggregate prices and output to a monetary shock. The size of the output response and its duration
increase with the number of products, they more than double as the number of products goes from
1 to ten, quickly converging to the ones of Taylor’s staggered price model.


Fernando E. Alvarez
University of Chicago
Department of Economics
1126 East 59th Street
Chicago, IL 60637
and NBER
f-alvarez1@uchicago.edu

Francesco Lippi
University of Sassari
Department of Economics
and
EIEF
via Sallustiana, 62
00184 Rome - Italy
and CEPR
flippi@uniss.it
1       Introduction and Summary
The “small” price changes observed in the micro data challenge a basic prediction of classic
menu-cost models, such as e.g. Barro (1972), Dixit (1991), Golosov and Lucas (2007): when
calibrated to yield infrequent price adjustment, as observed in the data, these models pre-
dict price changes that are “large”. Motivated by this evidence, Lach and Tsiddon (1996,
2007) introduced the hypothesis of economies of scope in price setting: a firm pays a fixed
menu cost to simultaneously adjust the price of n goods. In this case small adjustments
occur because, once the firm decides to take action as some goods are misspriced, then it
will also find it convenient to adjust the prices of all other goods at no extra cost. There
is some evidence consistent with this hypothesis: Lach and Tsiddon (1996) show that price
changes are synchronized within stores, but staggered across stores, Cavallo’s (2010) study
of online large supermarket chains finds that price changes of similar goods are synchronized
within a store, and Bhattarai and Schoenle (2010) document that firms selling more goods
display a higher frequency of price adjustment as well as smaller size adjustments.1 Midrigan
(2011) studies numerically a model which departs from Golosov and Lucas (2007) by having
economies of scope in adjusting the price for two goods as well as fat-tailed shocks. Interest-
ingly he finds that with both of these modifications the real effects of monetary policy shocks
are substantially larger.
   Our paper contributes to this literature by developing an analytically tractable model of
the optimal price setting decisions of firms that face a fixed cost of price adjustment common
to n ≥ 1 goods. The challenges involved with modeling the propagation of monetary shocks
in canonical menu cost problems have led many authors to resort to numerical methods.
Our contribution is to present a simple analytical solution to the general equilibrium of an
economy where firms face a non-convex and multidimensional control problem. There are
two sets of results. First, we characterize analytically the firm’s optimal policy, as well as
many of the implied steady state statistics. This is useful to guide the empirical literature
using micro data to test the hypothesis on the economies of scope in price setting, and to
identify and estimate the relevant parameters. For instance the distribution of price changes
for the case of n = 1 and n = 2 are bimodal, and instead for n ≥ 4 it is bell shaped, with a
large mass of small price changes, which better describes most empirical distributions.
    Second, we develop an analytical characterization of the whole impulse response function
of the aggregate price level (and of output) to a monetary shock. This characterization
extends the pioneering contributions of Caballero and Engel (1991, 1993, 2007) by (i) going
    1
     An incomplete list of additional contributions documenting this type of behavior includes Lach and
Tsiddon (1992), Baudry et al. (2007), Dhyne and Konieczny (2007), Dutta et al. (1999), Midrigan (2007,
2011), and Neiman (2010).


                                                  1
beyond their analysis of the impact effect, (ii) allowing for any number of goods (n ≥ 1),
and (iii) justifying their simplifying assumption of using the steady-state decision rules to
analyze the transition dynamics. The results illustrate how the effects of monetary shocks
depend on n, and on two simple statistics: the standard deviation and the frequency of price
changes. These findings identify what observable statistics are informative for answering
the important question on the effectiveness of monetary policy in actual economies, provide
guidance to compare across economies. Moreover, the results help interpreting the source
of the different results in the numerical investigations of Golosov and Lucas (2007) and
Midrigan (2011). Compared to the previous literature, which focussed almost exclusively on
the frequency of price changes as a measure of aggregate stickiness, our analysis suggests
that the dispersion of price changes is an equally important determinant of the real effects
of monetary shocks.

Summary of the firm’s problem and steady state statistics

We study a stylized version of the problem of a multi-product firm that can revise prices
only after paying a fixed cost. The key assumption is that once the fixed menu cost is paid
the firm can adjust the price of all its products. The analytical solution of this problem,
whose formulation was outlined in Lach and Tsiddon (1996, 2007), is novel in the literature.
Section 2 sets up the firm problem as to minimize the deviations of the profits incurred relative
to the flexible price case, i.e. the case with no menu cost. We assume that the static profit
maximizing prices for each of the n products, i.e. the price that would be charged absent
menu cost, follow n independent random walks without drift and with volatility σ per unit
of time. We refer to the vector of the difference between the frictionless prices and the actual
prices as the vector of the price gaps. The period return function is shown to be proportional
to the sum of the squares of the price gaps. The proportionality constant B measures the
second order per period losses associated with charging a price different from the optimum,
i.e. it is a measure of the curvature of the profit function.2 We assume that if a fixed cost ψ
is paid the firm can simultaneously change all the prices. The firm minimizes the expected
discounted cost, which includes the stream of lost profits from charging prices different from
the frictionless as well as the fixed cost at the time of adjustments. Alternatively, as explained
below, this setup can be interpreted as Reis’s (2006) inattentiveness or Abel, Eberly, and
Panageas’s (2007) optimal inattention problem, where ψ represents an information gathering
cost.3 We completely characterize the optimal firm’s decisions in terms of the structural
parameters: the variability of the flexible prices σ, the curvature of the profit function B,
  2
      The first order losses are zero since per-period profits are maximized at the frictionless price.
  3
      For a multi-product problem using Sims’s rational inattention type of setup see Pasten (2012).


                                                       2
the size of the menu cost ψ, the discount rate r, and the number of products n. Our
characterization is slightly more general than the seminal work of Barro (1972), Karlin and
Taylor (1981) and Dixit (1991) for the case of n = 1 and, more importantly, it includes the
multi-product case of n ≥ 1.
   The technical challenges in the analytical study of price setting problems with menu
cost have led researchers to consider simple environments. For instance a quadratic profit
function, or a quadratic approximation to it, has been used in the seminal work on price
setting problems with menu cost by Barro (1972), Tsiddon (1993), section 5 of Sheshinski
and Weiss (1992), Caplin and Leahy (1997), and chapter 12 of Stokey (2008), among others.
Moreover the idiosyncratic shocks considered are stylized, e.g. random walks with constant
volatility, as used in Barro (1972), Tsiddon (1993), Gertler and Leahy (2008) and Danziger
(1999) among others. Facing the same challenges, we adopt similar assumptions for each
of the goods, which allows the complete characterization mentioned above. Regretfully, the
simplifications needed preclude the analysis of the case of asymmetric demands for goods,
and/or of the case with general correlated shocks across products.
   The solution of the firm’s problem in Section 3 involves finding the set over which prices
are adjusted, and the set where they are not, i.e. the inaction set. Due to the lack of drift,
when prices are adjusted they are set equal to the frictionless prices, i.e. the price gaps are
set to zero in all dimensions. To our knowledge this is the first fixed cost adjustment problem
in n-dimensions whose solution is analytically characterized. We believe that this is because
of the difficulty of finding a tractable boundary condition and a candidate solution that is
smooth enough on the boundary of the inaction region. Somewhat surprisingly, the solution
to this complex problem turns out to have a simple form in our case: the optimal decision is
to control the price gap as to remain in the interior of the n-dimensional ball centered at the
origin. The economics of this is clear: the firm will adjust either if many of its price gaps have
a medium size, or if a few gaps are very large, since at the margin a larger gap hurts profits
more. The size of this ball, whose square radius we denote by ȳ, is chosen optimally. We solve
for the value function and completely characterize the size of the inaction set ȳ as a function
of the parameters of the problem. We also obtain a very accurate approximation for a small
                                                                                              1/2
cost ψ, which shows that ȳ takes the form of a square root function, ȳ ≈ [2(n + 2)σ 2 B/ψ] .
The special case of n = 1 gives the same quartic root as in Barro, Karlin-Taylor, and Dixit,
since ȳ is the square of the price threshold.
   In Section 4 we explore several steady-state implications of the model. First, we show
that the expected number of price adjustments per unit of time, denoted by Na , is given by
nσ 2 /ȳ, which together with our result for ȳ gives a complete characterization of the frequency
of price adjustments. Second, we solve in closed form for the hazard rate of the price changes


                                                3
as a function of the time elapsed since the last change. The shape of this function, except
for its scale, depends exclusively on the number of products n. The scale of the function is
completely determined by the expected number of adjustment per unit of time Na , which
we have already solved for. For a given n, the hazard rates are increasing in duration, have
an elongated S shape, with a finite asymptote. Comparing across values of n, while keeping
the expected number of adjustment constant, we show that the asymptote of the hazard
rate is increasing in n. As n increases, an adjustment becomes more likely later on. As
n → ∞ the hazard rate function converges to an inverted L shape, i.e. to the one of models
with deterministic adjustments as in Taylor’s (1980) or in Reis’s (2006) models.4 Third,
we characterize the shape of the distribution of price changes. While price changes occur
simultaneously for the n products, we characterize the marginal distribution of prices, i.e.
the statistic that is usually computed in actual data sets. A closed form expression for the
density of the marginal distribution of price changes as a function of ȳ and n is given. Using
this density we compute several statistics that have been computed in the data, such as the
standard deviation of price changes Std(∆p), and other moments which are only functions
of n, such as the coefficient of variation and the excess kurtosis of the absolute value of price
changes. We show that, as the number of products increases, the size of the adjustments
decreases monotonically, i.e. with more products the typical adjustment is smaller in each
product. These cross-section predictions can be used to identify the parameters of the model
and test its implications. When compared to the tabulations for US data by Bhattarai
and Schoenle (2010) we find matching patterns: higher values of n imply higher dispersion,
smaller average price changes, and higher kurtosis.
    We show that once the size of price changes is controlled for, the shape of the size-
distribution is exclusively a function of the number of products n. For n = 2 the distribution
                                                    √
is bimodal, with modes at the absolute value of ȳ, for n = 3 it is uniform, for n = 4 it
peaks at zero and it is concave, and for larger n it is bell-shaped. As n → ∞, the density of
price changes converges to a Normal. We find the sensitivity of the shape of price changes
with respect to n an interesting result to identify different models of price adjustments. In
particular bimodality is only predicted for n = 1 or n = 2, as in the models of Golosov
and Lucas (2007) and Midrigan (2011) respectively.5 Furthermore, this helps to discriminate
   4
     Midrigan’s (2011) comments that “Economies of scope flatten the adjustment hazard and thus weaken
the strength of the selection effect even further ” (pp. 1167). Figure 1 shows that, without fat tailed shocks,
the hazard rate steepens with n, and indeed the economy converges to Taylors’ staggered adjustment model,
not Calvo’s random adjustment model.
   5
     Midrigan’s (2011) writes that “economies of scope generate many price changes that are very small”
(pp. 1167) referring to his model with n = 2. While a model with n = 2 does generate some small price
changes, we show that this is actually a minimal amount, as the density of the price changes is U shaped,
with a minimum at 0 and the modes are the extreme values. We also show that, in order to get a bell shaped
density for price changes, it is required that n ≥ 4.


                                                      4
with respect to other theories of price adjustments, such as e.g. Alvarez, Lippi, and Paciello
(2011b), which is based on a mixture of information and menu cost.

Summary of the impulse response to a monetary shock

In Section 5 we use the firm’s optimal decisions to characterize the impulse response of the
aggregate price level and of output to a monetary shock. In doing this we keep the decision
rules of the firms constant, an approximation used in some of the calculations by Golosov and
Lucas (2007), Caballero and Engel (1991, 1993, 2007) among many others. Indeed, we justify
this practice in our model by showing that the general equilibrium feedback effects have a
third or smaller order effect on the firm’s objective function, so when aggregate shocks as
well as adjustment cost are small, these effects have negligible consequences on the size of the
inaction region –a result closely related to the one in Gertler and Leahy (2008).6 In particular,
we characterize analytically the effect on aggregate prices of a permanent unexpected increase
in money supply in an economy that starts at the cross sectional stationary distribution of
price gaps under zero inflation. This impulse response has been tackled numerically by
Midrigan (2007) for a model with n = 2 (as well as fat-tailed shocks), and compared with
the case of n = 1 case, analyzed by Golosov and Lucas (2007). We study analytically the
price setting problem for any integer n = 1, 2, ..., ∞.
   The analytical impulse response function (IRF for short) of prices to a monetary shock is
made of two pieces: an impact effect (a jump in the price level), and the remaining part. The
IRF depends only on two parameters, or equivalently on two observables: the steady state
frequency of price changes, Na , and the steady state standard deviation of price changes,
Std(∆p), two statistics that are readily available for actual economies. More precisely, the
IRF is homogenous of degree one in the size of the shock, δ, and in Std(∆p). Instead the
duration of the impulse response is inversely proportional to the steady state frequency of
price changes, Na , i.e. time can be measured relative to the steady state average duration of
prices. When monetary shocks are larger than twice Std(∆p) the economy features complete
price flexibility. Instead, for small monetary shocks the impact effect on prices is second order
compared to the shock size −and hence the impact effect on output is of the order of the
monetary shock. These results, together with the homogeneity, characterize the precise sense
in which the size of the shocks matters. Fixing the two steady state parameters –Na and
Std(∆p)– the whole shape of the impulse response depends only on the number of products
n and the normalized size of the shock δ/Std(∆p).
       For empirically relevant sizes of monetary shocks –i.e. small relative to Std(∆p)– economies
   6
     Our result that a permanent change in real interest rates has only second order effect on ȳ as ψ → 0
follows a similar logic.


                                                    5
with more products display a smaller impact effect on prices and a more protracted response,
i.e. they are “stickier”. As we move from n = 1 to a large number of products (say n ≥ 10)
the impact effect on prices as well as the half life of a monetary shock more than doubles.
Indeed as n → ∞ the IRF converges to the one corresponding to the staggered price setting
of Taylor’s (1980) model, or the inattentiveness model of Caballero (1989), Bonomo and Car-
valho (2004) and Reis (2006). In this case there is absolutely no selection and the impulse
response is linear in time, and has -for small shocks- a half-life of 1/(2 Na ), i.e. half the
average duration of steady state price changes. In the language of Golosov and Lucas (2007),
economies with higher values of n have a smaller amount of “selection”.7
   Finally, we analyze the implied effect on output which, in general, has a longer half-life
than the impact on prices. We use the area under the IRF as a summary measure of the
output effect. We show that this area is proportional to the ratio of the two steady state
statistics, Std(∆p)/Na and, for a given n, depends on the size the (normalized) monetary
shock. We show that the largest cumulated effect on output is small, in the order of 1 per
cent, and that it is increasing in n, more than doubling as n goes from 1 to ∞, which is
almost achieved for n ≈ 10.


2       The firm’s problem: setup and interpretation
Let n be the number of products sold by the firm. The mathematical model we use has an
n-dimensional state p that we refer to as the vector of price gaps, whose interpretation is
discussed below. Each price gap pi , while it is not controlled, evolves according to a random
walk without drift, so that dpi = σ dWi where dWi is a standard Brownian Motion. The n
Brownian Motions (BM henceforth) are independent, so E [Wi (t)Wj (t′ )] = 0 for all t, t′ ≥ 0
and i, j = 1, ..., n. The value function V (p) is the minimum value of the function V0 defined
over the processes {τj , ∆pi (τj )}∞
                                   j=1 :

                                "   ∞                                        n
                                                                                       !                 #
                                    X                   Z       ∞            X
               V0 (τ, ∆p) ≡ E             e−rτj ψ +                 e−rt B         p2i (t) dt p(0) = p       (1)
                                    j=1                     0                i=1


where
                                          X
                  pi (t) = σWi (t) +                ∆pi (τj ) for all t ≥ 0 and i = 1, 2, ..., n,            (2)
                                          j:τj <t

    7
     Midrigan’s (2011) interpretation of the selection effect in his model with n = 2 (Section 4.B, pages
1165-1168) uses the techniques developed by Caballero and Engel for the case of n = 1. This is incorrect for
the multi-product case (n > 1) because the threshold condition for price adjustments involves a vector of
price gaps, not just one. We discuss the appropriate extension in Section 5.



                                                                6
∆pi (τj ) ≡ limt↓τj pi (t) − limt↑τj pi (t) and p(0) = p.
   So that τj are the (stopping) times at which control is exercised. At these times, after
paying the cost ψ, the state can be changed to any value in Rn . We denote the vector of
changes in the price gaps as ∆p(τj ) ∈ Rn . This is a standard adjustment cost problem subject
to a fixed cost, with the exception that after paying the adjustment cost ψ the decision maker
can adjust the state in the n dimensions.
   Next we discuss two interpretations of the problem, that can be summarized by saying
that the firm “tracks” the prices that maximize instantaneous profits from the n products.
In both interpretations a monopolist sells n goods with additively separable demands; in the
first one subject to costs shocks, and in the second subject to demand shocks. For the first
interpretation consider a system of n independent demands, with constant elasticity η for each
product, random multiplicative shifts in each of the demand, and a time varying marginal
(and average) cost W Zi (t). This is a stylized version of the problem introduced by Midrigan
(2011) where the elasticity of substitution between the products sold within the firm is the
same as the one of the bundle of goods sold across firms. The instantaneous profit maximizing
price is proportional to the marginal cost, or in logs p∗i (t) = log W +log Zi (t)+log (η/(η − 1)).
In this case we assume that the log of the marginal cost evolves as a random walk with drift
so that p∗i (t) inherits this property. The period cost is a second order expansion of the profit
function with respect to the vector of the log of prices, around the prices that maximize
current profits (see Appendix B for a detailed presentation of this interpretation). The units
of the objective function are loss profits relative to the the value of the current maximum
profits for the n goods. The first order price-gap terms in the expansion are zero because we
are expanding around p∗ (t). There are no second order cross terms due to the separability of
the demands. Thus we can write the problem in terms of the gap between the actual price
and the profit maximizing price: p(t) = p̂(t) − p∗ (t). Under this approximation the constant
B is given by B = (1/2)η(η − 1)/n, where n appears in the denominator since the cost of
the deviations for the n price gaps is divided by the total profits generated by the n goods.8
The fixed cost relative to the profit of the n products is then ψ/n. Clearly all that matter to
characterize the decision rules is the ratio of B to ψ, thus in equation (1) we omit the terms
that are common (such as n and the expression for total profits) which only scales the units of
the value function. For the second interpretation of the model, consider a monopolist facing
identical demands for each of the n products that she sells. The demands are linear in its
own price, and have zero cross partials with respect to the other prices. The marginal cost of
producing each of the products are also identical, and assumed to be linear. The intercepts
   8
     The terms with η appear since the curvature of profits depends on the elasticity of demand, the term
1/2 comes from the second order expansion.



                                                    7
of each of the n demands follow independent standard BMs. In this interpretation the firm’s
profits are the sum of the n profit functions derived in the seminal work by Barro (1972), so
that our ψ is his γ and our B is his θ, as defined in his equation (12).
   Alternatively, the same set-up can be interpreted as an optimal inattention or inatten-
tiveness similar to the one studied by Reis (2006), Abel, Eberly, and Panageas (2007) and
Alvarez, Lippi, and Paciello (2011b). The firm has the same demand system for n products,
and hence the same total period losses B||p(t)||2 , which are assumed to be continuously and
freely observed. Furthermore, if the firm pays an observation cost ψ, it observes the determi-
nants of the profits of each of the products separately, and is able to set prices based on this
information. In this case ψ represents the cost of gathering and processing the information,
in addition to (or instead of) the menu cost of changing prices.
   To understand the mechanics of the model and to interpret differences in behavior in a
cross section of firms, we will consider two technologies for scaling the cost of adjustment ψ
as n varies. The first one, which we refer to as constant returns to scale technology (CRS),
scales the cost linearly with n, so that ψ = n ψ1 . The second one, which we refer to as the
constant fixed cost technology (CFC), assumes ψ = ψ1 , so that the cost does not vary with
n. We think that these two extreme cases bracket all of the interesting setups.


3      Characterization of the solution
We first note the following basic properties of the value function and the optimal policy.

    1. Given the symmetry of the BM and of the objective function around zero, and the
       independence of the BM’s, one can use reflection around zero to show that the value
       function only depends on the absolute values of pi , i.e. V (p) = V (|p1 |, |p2 |, ..., |pn |) for
       all p ∈ Rn .

    2. Given the lack of drift of price gaps and the symmetry of the return function, of the
       law of motion and of target prices, it is easy to see that after an adjustment the state
       is reset at the origin, i.e. p(τj+ ) = 0, or ∆p(τj ) = −p(τj− ). See Lemma 1 in Appendix A
       for a formal argument.

    3. The state space Rn can be divided in two open sets: an inaction region I ⊂ Rn and
       control region C ⊂ Rn . We use ∂I for the boundary of the inaction region. We have
       that C ∩ I = ∅, that inaction is strictly preferred in I, that control is strictly preferred
       in C, and that in ∂I the agent is indifferent between control and inaction.



                                                    8
       We write down the conditions for the solution of the problem, provided that the value
function is smooth enough, i.e. we look for a solution of the “strong” formulation of the
problem with: V ∈ C 1 (Rn ) and V ∈ C 2 (Rn \∂I), so the function is once differentiable in
the whole domain, and twice differentiable everywhere, but in the boundary of the inaction
set. In the range of inaction the cost for the firm is given by the following Bellman equation:
                                                     n                n
                                                     X             σ2 X
                      r V (p1 , p2 , ..., pn ) = B         p2i   +       Vii (p1 , p2 , ..., pn )          (3)
                                                     i=1
                                                                   2 i=1

for all p ∈ I. In the control region we have:

                                       V (p1 , p2 , ..., pn ) = V (0) + ψ                                  (4)

for all p ∈ C. The optimality of returning to the origin implies that,

                                 Vi (0, 0, ..., 0) = 0 for all i = 1, 2, ..., n.                           (5)

Finally, differentiability in the boundary of the inaction region gives

                      Vi (p1 , p2 , ..., pn ) = 0 for i = 1, 2, ..., n and for all p ∈ ∂I,                 (6)

We refer to this condition as smooth pasting.
  We briefly comment on the control theory results that apply to our problem. A recent
statement of the general problem, and an existence results of a viscosity solution, is given
in Baccarin (2009). Instead we look for a strong solution, i.e. a smooth one.9 Øksendal
(2000) and Aliev (2007) analyze a general class of slightly simpler stopping time problem in
n dimensions. They consider a problem with a one time decision of when to collect a given
reward function of the state, denoted by g. Before that time the decision maker has either
zero flow returns or, in the case of Øksendal (2000), she receives a flow return f that depends
on the state. The decision maker maximizes the expected discounted value of the reward.10
Their problem maps into ours by making the reward g(p) = V (0) + ψ and the flow return
f (p) = B||p||2 . Aliev (2007) shows that equation (6) is necessary for optimality, provided that
   9
     Theorem 1 in Baccarin (2009) shows the existence of a continuous value function V and a policy described
by a continuation and control region for a class of problems that includes ours. His set-up includes a
more general form of adjustment cost, period return function, and law of motion for the state, as well as
weaker differentiability assumption on these functions. Strictly speaking, our problem does not fit one of the
assumptions for Theorem 1. In particular, Assumption (2.4) requires that the cost diverges to infinity as the
norm of the adjustment diverges. Nevertheless, we can artificially modify our problem by incorporating a
proportional adjustment cost that applies only when ||p|| is very large, without altering our solution.
  10
     Discounting, not included in this analysis, is easy to introduce it by taking time as one of the n states.


                                                           9
p ∈ ∂I is a regular point for the stopping set C with respect to the process {σW(t)} and that
the derivatives of the value function in a neighborhood of ∂I are bounded. Theorem 10.4.1
in Øksendal (2000) is a verification theorem in term of variational inequalities which, when
adapted to our set-up, says that if there exists a function V that satisfies equations (3)-(6)
and some additional conditions −which we state and check in our proof− then this function
solves the stopping time problem.
  Before presenting the solution of this problem we change the state space, which we sum-
marize using a single variable. Let
                                             Xn
                                         y=     p2i                                    (7)
                                                       i=1

measure the deviation of prices from their optimal value across the n goods. We consider
policies summarized by a single number ȳ. In this class of policies the firm controls the state
so that if y < ȳ, there is inaction. The first time that y reaches ȳ, all prices are adjusted to
the origin, so that y = 0. We will find the optimal policy in this class. Then we will show
that the optimal policy of the original problem is of this form.
   The variable y measures the square of the ray of a sphere centered on the origin. Since
each price gap follows an identical independent standard BM (when uncontrolled), then y
follows a simple diffusion in the inaction region. Using Ito’s Lemma on equation (7) the
evolution of y is
                                                             n
                                                             X
                                                2
                                     dy = nσ dt + 2σ               pi (t)dWi
                                                             i=1

This implies that the quadratic variation of y is:

                                                           n
                                                                      !
                                                           X
                                      E(dy)2 = 4σ 2              p2i (t) dt
                                                           i=1


Thus we can define a stochastic differential equation for y with a new standard BM {W(t)}
that solves:
                                             √
                          dy = nσ 2 dt + 2σ y dW for y ∈ [0, ȳ].                     (8)

We note that for the unregulated process, i.e. when ȳ = ∞, if y(0) > 0 then y(t) > 0 for
t > 0 with probability one provided that n ≥ 2, see Karatzas and Shreve (1991) Proposition
3.3.22.11
  11
    This result was obtained for Bessel processes, which are the square root of y(t). Additionally, Karatzas
and Shreve (1991) have shown in Problem 3.3.23 and 3.3.24 that if y(0) > 0, then for n = 2 the unregulated
process can become arbitrarily close to zero but for n ≥ 3 almost every path remains bounded away from
zero. Furthermore, for the regulated process the classification for the boundaries of a diffusion gives that for
n ≥ 2 the point y = 0 is an entrance boundary, as verified in Karlin and Taylor (1999) Example 6, Chapter
12.6.


                                                      10
   Note that the drift and diffusion terms in equation (8) are only functions of y. We also
note that the instantaneous return is a function of y, so we can write the following
                                 "   ∞
                                                                                                 #
                                     X                 Z       ∞
                  v(y) = min E             e−rτj ψ +               e−rt B y(t) dt     y(0) = y               (9)
                           ȳ                              0
                                     j=1


subject to equation (8) when y ∈ [0, ȳ], where τj are the first time that y(t) hits ȳ. The
function v solves:

                   r v(y) = By + nσ 2 v ′ (y) + 2σ 2 y v ′′ (y),               for y ∈ (0, ȳ) .            (10)

Since policy calls for adjustment at values higher than ȳ we have:

                                v(y) = v(0) + ψ,                   for all y ≥ ȳ .                         (11)

If v is differentiable at ȳ we can write the two boundary conditions:

                                v(ȳ) = v(0) + ψ           and v ′ (ȳ) = 0 .                               (12)

These conditions are typically referred to as value matching and smooth pasting. For y = 0
to be the optimal return point, it must be a global minimum, and thus we require that:

                                                 v ′ (0) ≥ 0 .                                              (13)

Note the weak inequality, since y is non-negative.
   The next proposition finds an analytical solution for v in the range of inaction.

Proposition 1. Let σ > 0. The ODE given by equation (10) is solved by the following
analytical function:
                              ∞
                              X
                       v(y) =   βi y i , for y ∈ [0, ȳ] .                     (14)
                                           i=0

where the coefficients {βi } solve:

            nσ 2           rβ1 − B                     r
     β0 =        β1 , β2 = 2         , βi+1 =                      βi ,                       for i ≥ 2 .   (15)
             r            2σ (n + 2)          (i + 1) σ 2 (n + 2i)

for any β0 .

  The proof follows by replacing the function in equation (14) into the ODE (10) and
matching the coefficients for the powers of y i . By the Cauchy-Hadamard theorem, the power

                                                       11
series converges absolutely for all y > 0 since limi→∞ βi+1 /βi = 0. The next proposition
shows that there exists a unique solution of the ODE (10) satisfying the relevant boundary
conditions (see Appendix A for the proof).

Proposition 2.         Assume r > 0, σ > 0, n ≥ 1. There exists ȳ and a unique solution of the
ODE (10) satisfying the two boundary conditions described in equations (12) for which v(·)
satisfies: i) it is minimized at y = 0, ii) it is strictly increasing in (0, ȳ), and iii) ȳ is a local
maximum, i.e. limy↑ȳ v ′′ (y) < 0.

  The next proposition uses a slightly modified version of the verification theorem in
Øksendal (2000) to show that value function v and threshold policy ȳ that we found in
Proposition 2 for the one-dimensional representation indeed characterize the inaction I = {p :
||p||2 < ȳ} and control sets C, as well as the value function V for the original n-dimensional
problem (see Appendix A for the proof).

Proposition 3. Let v be the solution of the restricted problem in equations (8) and (9).
Let V (p) = v ( ni=1 p2i ). This is the solution of the problem described equations (1) and (2).
               P



   For completeness we comment on how the n = 1 products and the case of n > 1 perfectly
correlated target prices look like. In the case of one product, i.e. n = 1, the solution to V is
easily seen to be the sum of a quadratic and of two exponentials

                               B 2                                σ 2
                        V (p) = p + β (exp (ζp) + exp (−ζp)) + B
                               r                                   r
             √
where ζ =        2r/σ. The constant β and the boundary value ȳ (equal to p̄2 for n = 1) are
chosen to enforce smooth pasting and value matching. Moreover, it is easy to see that in that
               √
case v(y) = V ( y) solves the ODE in (10) and its boundary conditions. We note that the
solution for the n = 1 case and the expression for the approximation for ȳ are the same ones
derived in Karlin and Taylor (1981) chapter 15, section 3.F and Dixit (1991) expression (11).
In the case of n perfectly correlated target prices the problem has a single state variable after
the first adjustment. In this case, in terms of the threshold policy and value function, the
problem is identical to the one with only one price. The static return is thus nBp(t)2 where
p(t) is, when uncontrolled, a one dimensional brownian motion. The only difference with the
n = 1 problem is that the constant B is multiplied by n, so that B/ψ is proportional to n.
The economics is that since the adjustment has the same effectiveness for all products, it
is as if each adjustment was cheaper. Note that in the case of the CRS assumption (where
ψ = nψ1 ) the value of the adjustment threshold, and hence the frequency of adjustment, is
independent of n. Instead, in terms of the implication for price changes, the problem with

                                                  12
perfectly correlated shocks features no small price changes. When adjustment takes place,
all products have the same price gap.
    We finish this section by characterizing the optimal policy ȳ in terms of the structural
parameters of the model ( Bψ , σ 2 , n, r).
                                                                                                   2
                                                                                        σ2
Proposition 4.         The optimal threshold is given by a function ȳ =                 r
                                                                                           Q( Bψ σr 2 , n)   so that
                                      ψ                       ψ                       ψ
  (i) ȳ is strictly increasing in    B
                                          with ȳ = 0 if      B
                                                                  = 0 and ȳ → ∞ as   B
                                                                                          → ∞,

 (ii) ȳ is strictly increasing in n and ȳ → ∞ as n → ∞,
                                 q
                                                        2
(iii) ȳ is bounded below by 2(n + 2)σ 2 Bψ and as Bψ σr 2 → 0 then √                     ȳ
                                                                                               ψ
                                                                                                   → 1,
                                                                                      2(n+2)σ2 B

          ψ r2                   ȳ                           ψ/B ∂ ȳ       1
(iv) as   B σ2
                 → ∞ then √            ψ
                                            → ∞, and           ȳ ∂ψ/B
                                                                         >   2
                              2(n+2)σ2 B

 (v) the elasticity of ȳ with respect to r and σ 2 satisfy:

                  r ∂ ȳ     (ψ/B) ∂ ȳ                              σ 2 ∂ ȳ     (ψ/B) ∂ ȳ
                         = 2             − 1 and                            2
                                                                              =1−             .
                  ȳ ∂r        ȳ ∂(ψ/B)                             ȳ ∂σ          ȳ ∂(ψ/B)


   See Appendix A for the proof. For the case of n = 1 this characterization is slightly more
general than the one in Barro (1972), Karlin and Taylor (1981), and in Dixit (1991), but
more importantly it holds for any number of products n ≥ 1.12 That ȳ is only a function of
the ratio ψ/B is apparent from the definition of the sequence problem. That, as stated in
part (i), ȳ is strictly increasing in the ratio of the fixed cost to the benefit of adjustment ψ/B
is quite intuitive. Item (ii) says that the threshold is increasing in the number of products n.
This is because as n increases, equation (8) shows that the drift of y = ||p||2 increases, thus
if ȳ would stay constant there will be more adjustments per unit of time, and hence higher
menu cost will be paid. Additionally, if ȳ remains unchanged, the average cost per unit of
time also increases. One can show that the second effect is smaller, and hence an increase
in n makes it optimal to increase ȳ. Part (iii) gives an expression for a lower bound for ȳ,
which becomes arbitrary accurate for either a small value of the cost ψ/B, so that the range
of inaction is small, or a small value of the interest rate r, so that the problem is equivalent
to minimize the steady state average net cost. We note that in the approximation:
                                                  r
                                                      ψ σ 2 2 (n + 2)
                                           ȳ =                       ,                                          (16)
                                                             B
  12
    See expression (19) in Barro (1972), Chapter 15, Section 3.F of Karlin and Taylor (1981) for the case
of undiscounted returns and expression (11) in Dixit (1991) for an approximation to the threshold for the
discounted case.


                                                         13
the effect of ψσ 2 /B is exactly the same as in the case of one product. Indeed the quartic root
                                          √
(implied for the optimal threshold p̄ = ȳ) is the one obtained by Barro (1972), Karlin and
Taylor (1981) and Dixit (1991) in a model with n = 1. Part (iv) shows that the approximation
                                                                                       2
worsens, and that the elasticity of ȳ with respect to ψ/B increases above 1/2 as Bψ σr 2 becomes
large. Note that the approximation in part (iii) implies that the elasticity of ȳ with respect
to ψ/B is 1/2 for small values of the ψ/B ratio. Then, using part (v), we obtain that ȳ has
elasticity 1/2 with respect to σ 2 and also that it is independent of r. Moreover, for small
normalized adjustment cost, i.e. as ψ/(Bσ 2 ) ↓ 0, (iii) and (v) imply that ∂ ȳ/∂r → 0, so
that interest rates have only second order effects on the range of inaction, a result that we
find useful to study the impulse responses to aggregate (i.e. monetary) shocks in Section 5.
Finally, despite the result in Part (iv), we found that the quadratic approximation to v(·),
which amounts to a quartic approximation to V (·), gives very accurate values for ȳ across a
very large range of parameters, as documented in Appendix D. What happens is that for any
realistic application the values of r and ψ are small relative to Bσ 2 , hence the approximation
given in part (iii) applies.


4     Implications for frequency and size of price changes
In this section we explore the implications for the frequency and distribution of price changes.
    We let the expected time for y(t) to hit the barrier ȳ starting at y by the function T (y).
This function satisfies:

            0 = 1 + n σ 2 T ′ (y) + 2 y σ 2 T ′′ (y) for y ∈ (0, ȳ) and T (ȳ) = 0 ,

where the first condition gives the law of motion inside the range of inaction and the second
one imposes the terminal condition on the boundary of the range of inaction. The unique
solution of this ODE that satisfies the relevant boundary condition is:

                                           ȳ − y
                                 T (y) =          for y ∈ [0, ȳ] .                         (17)
                                            n σ2

Thus T (0) gives the expected time between successive price adjustments, so that the average
                                                1
number of adjustments, denoted by Na is       T (0)
                                                    .   We summarize this result in:

Proposition 5.         Let Na be the expected number of price changes for a multi-product




                                                 14
firm with n goods. It is given by
                                                                  s
                                nσ 2     nr                           B σ 2 n2
                           Na =      =  2      ∼
                                                 =                                .                   (18)
                                 ȳ     ψr
                                      Q B σ2 , n                      2 ψ (n + 2)



   The second equality in equation (18) uses the function Q(·) derived in Proposition 4,
while in the last equality we use the approximation of ȳ for small ψr 2 /(Bσ 2 ) (see Appendix D
for more documentation on the accuracy of the approximation). It is interesting that this
expression extends the well known expression for the case of n = 1, simply by adjusting the
value of the variance from σ 2 to nσ 2 . The number of products n affects Na through two
opposing forces. One is that with more products the variance of the deviations of the price
gaps increases, and thus a given value of ȳ is hit sooner in expected value. This is the “direct
effect”. On the other hand, with more products, the optimal value of ȳ is higher. Expression
equation (18) shows that, as often happens in these models, the direct effect dominates, and
the frequency of adjustment increases with n.
    We use this expression to study how the bundling of menu costs, i.e. the fact that a
single menu cost relates to several products, affects the frequency of adjustment of individual
prices. This is interesting because recent evidence in Bhattarai and Schoenle (2010) shows
that the frequency of price adjustment is higher for firms that sell a larger number of goods.13

                               Table 1: Frequency of Price changes Na

                                                        number of products n              implied
                                                  1       2   4     6   10 50               ψ1

              Na for CRS model ψ = n ψ1           2         2.4   2.8 2.9 3.1 3.3          0.02

              Na for CFC model: ψ = ψ1           1.4 2.4          3.9 5.1 6.9     17       0.04

              Na for US Data:                      -        2.4   2.3 2.8 3.5         -      -
                   ψ1
          Value of Bσ 2 chosen to match the size of price changes at n = 2. US data from Bhattarai

          and Schoenle (2010) Figure 1. Implied ψ1 using B = 20 and σ = 0.15.



       This pattern is qualitatively consistent with the formula in equation (18), which shows
  13
    See Figures 1 and 2 in their paper. These authors group firms into 4 bins, according to the number of
items sold (and recorded by the BLS), from 1 to 3 goods in the first bin to more than 7 goods in the fourth
bin. They first measure the frequency of price changes at the good level, then compute the median frequency
across the goods produced in the firm. Finally, they average these medians inside each of the 4 bins.


                                                       15
that Na is increasing in n. Notice however that in this comparison we are keeping ψ constant,
so that as n increases the menu cost per good is decreasing. One may wonder whether the
increased activity by the firms follows from the fact that the menu cost is smaller (per good)
or because of the bundling of the goods prices. To separate the effects of the economies of
scale in the menu cost from the bundling of the goods, consider the case where the cost ψ
grows linearly with the number of goods n, i.e. : ψ = ψ1 n. This gives
                                           s
                                               B σ2 n
                                    Na ∼
                                       =                    .                               (19)
                                               2 ψ1 (n + 2)

which is also increasing in n, although at a lower rate. Thus, even under “CRS” for the menu
cost, the bundling of the goods pricing induces more frequent adjustments than in the case
where the menu costs are dissociated, i.e. when n = 1. We explain the economics behind this
result for the CRS case. Define N1 as the optimal number of adjustments per year for a firm
selling only 1 good, i.e. with n = 1. Consider a multi-product firm with n > 1 that follows a
policy of doing N1 adjustments per year. Since we are considering the CRS case, the expected
amount spent in adjustment per year is the same for both firms: N1 ψ1 . But the one good
firm tailors all adjustments to those instances where the deviations of the optimal price are
large. Instead, due to the fact that all prices are adjusted at the same time, the goods sold by
the multiproduct firm will be adjusted sometimes when the price has small deviations, and
other times when they have large deviations. Since the profit function is concave in price,
it is profitable for the multiproduct firm to increase the number of adjustment to decrease
the per-good expected price deviation from its optimal price relative to the firm with only
one good. This is exactly what the expression in equation (19) shows for the optimal policy,
since this expression is increasing in n. In the case with constant fixed cost the effect is even
stronger, since in addition mechanically the cost of adjustment per good decreases. Table 1
uses equation (19) for the case of constant returns to scale (CRS) and equation (18) for the
case of constant fixed cost (CFC) to calculate hypothetical values of Na for different values of
n. For both cases we have selected the values of B σ 2 /ψ1 so that its value is 2.4 adjustments
per year, the value estimated by Bhattarai and Schoenle (2010) for the US for firms with
n = 2. Table 1 also includes a row with US data. Comparing the case of CRS with the one
with CFC, the former displays a pattern much closer to the one in the US data.
   Next we characterize the hazard rate of price adjustments (see Appendix A for the proof)

Proposition 6.        Let t denote the time elapsed since the last price change. Let Jν (·) be




                                                16
the Bessel function of the first kind. The hazard rate for price changes is given by
                                              ∞                               2
                                                                                  σ2
                                                                                          2 2 
                                              X                ξn,k          qn,k           qn,k σ              n
       h(t) =                                                      2 2             exp  −        t , where ν = − 1 ,
                                                    P∞              qn,s σ     2ȳ            2ȳ               2
                                              k=1    s=1 ξn,s exp − 2ȳ    t
                                ν−1
                       1       qn,k
       ξn,k      = ν−1                    , and qn,k are the positive zeros of Jν (·),
                  2 Γ(ν + 1) Jν+1 (qn,k )
                                                                                 2
                                                                                qn,1
                                                                                            n               o
                                                                                                   (n−1)2
which asymptotes to T (0) limt→∞ hn (t) =                                        2n
                                                                                       > max 1 ,     2n
                                                                                                                .

   Proposition 6 compares the asymptote of the hazard rate with the expected time until
adjustment, which equals T (0) = ȳ/(nσ 2 ), as derived above. Notice that for a model with
a constant hazard these two quantities are the reciprocal of each other, i.e. the expected
duration is the reciprocal of the hazard rate. We use the product T (0) limt→∞ hn (t), which
is larger than one, as a measure of how close the model is to have a constant hazard rate,
or equivalently as a summary measure of how increasing the hazard function is. Also notice
that the expression in Proposition 6 immediately shows that, keeping the expected time until
adjustment T (0) fixed, the hazard rate is only a function of n. Thus the shape of the hazard
function depends only on the number of products n. Changes in σ 2 , B, ψ only stretch the
horizontal axis linearly.

                            Figure 1: Hazard rate of Price Adjustments for various choices of n


                                          8


                                          7
              Instantaneous hazard rate




                                          6

                                                                                                                          n   =   1
                                          5
                                                                                                                          n   =   2
                                                                                                                          n   =   4
                                          4                                                                               n   =   10
                                                                                                                          n   =   50
                                          3


                                          2


                                          1


                                                                 E xp e c te d D u ra ti o n
                                          0
                                              0           0.5         1                1.5         2                2.5                3
                                                                Tim e elapsed since last adj ustm ent

 For each n the value of σ 2 /ȳ is chosen so that the expected time elapsed between adjustments is one.




                                                                                    17
   Figure 1 plots the hazard rate function h for different choices of n keeping the expected
time between price adjustment fixed at one. As Proposition 6 shows the function h has an
asymptote, which is increasing in the number of products n. Moreover, since the asymptote
diverges to ∞ as n increases with no bound, the hazard rate converges to a an inverted L
shape, as the one for a model where adjustment are done exactly every T (0) = 1 periods,
like in Taylor’s (1980) model. To see this note that, defining ỹ ≡ y/ȳ and fixing the ratio
T (0) = ȳ /(n σ 2 ) so that for any n the expected time elapsed between price changes is T (0),
we have:                                    s
                                  1                1
                          dỹ =       dt + 2 ỹ         dW for ỹ ∈ [0, 1].                (20)
                                T (0)           n T (0)

As n → ∞ the process for the normalized size of the price gap ỹ described in equation (20)
converges to the deterministic one, in which case the hazard rate is zero between times 0
and below T (0) and ∞ precisely at T (0). For completeness, Table 2 computes the first zero
-denoted by qn,1 - for the relevant Bessel functions and the (normalized) asymptotic hazard
rate for several value of n.

                 Table 2: Normalized limit hazard rates for various values of n


                                                         number of products n
                                          1     2    3      4     6     8     10    20     50    100

       first zero of J n2 −1 (·) : qn,1   1.6   2.4 3.1 3.8 5.1        6.4 7.6      13     30    56

       T (0) limt→∞ hn (t)                1.2   1.4 1.6 1.8 2.2        2.5 2.9 4.5 8.8           16

                                                           2
 T (0) is the expected duration and T (0) limt→∞ hn (t) = qn,1 / (2n) is the normalized limit hazard rate.



   The shape of estimated hazard rates varies across studies, but many have found flat or
decreasing ones, and some have found hump-shape ones. As can be seen from Figure 1 the
hazard rate for the case of n = 1 is increasing but rapidly reaches its asymptote. As n is
increased, the shape of the hazard rate becomes closer to the inverted L shape of its limit as
n → ∞. For instance, when n = 10 the level of the hazard rate evaluated at the expected
duration is about twice as large as the one for n = 2. This is a prediction that can be tested
in the cross section using the data set in Bhattarai and Schoenle (2010) or Wulfsberg (2010).
   Finally we discuss the distribution of price changes. This distribution is characterized by
two parameters: the number of goods n, and the optimal boundary of the inaction set ȳ.
The value of ȳ, as discussed above, depends on all the parameters. Since after an adjustment

                                                    18
price gaps are reset to zero, price changes coincide with the value of p(τ ) ∈ ∂I ⊂ Rn , the
                                              √
surface of an n-dimensional sphere of radius ȳ. Let τ , be a time where y hits the boundary
of the range of inaction: then given that each of the (uncontrolled) pi (t) is independently and
identically normally distributed, price changes ∆p(τ ) = −p(τ ) are uniformly distributed in
                                                    √
the n-dimensional surface of the sphere of radius ȳ.14 The next proposition characterizes
the marginal distribution of price changes.

Proposition 7.        Let ∆p ∈ ∂I ⊂ Rn denote a vector of price changes for the n goods.
The distribution of the price change of an individual good, i.e. the marginal distribution of
         √ √
∆pi ∈ [− ȳ, ȳ ], has density:

                                                                                      2 !(n−3)/2
                                                   1                            ∆pi
                       w(∆pi) =                   n−1 1
                                                           √          1−       √                                    (21)
                                       Beta        2
                                                     ,2          ȳ               ȳ

where Beta(·, ·) denotes the Beta function. The standard deviation and kurtosis of the
price changes, the expected value of the absolute value of price changes and its coefficient of
variations are given by:

                                                     3n
               q 
 Std ( ∆pi ) =  ȳ n ,              Kurt ( ∆pi ) =          ,
                                                    n+2 s
                              √                                                   2
                                             Std ( |∆pi | )
                                                              
                                                                n−1
                                                                         
                                ȳ                                         n−1 1      1
  E [ |∆pi | ] =      n−1          n−1 1
                                          ,                =       Beta      ,         −1 .
                       2
                            Beta 2 , 2        E ( |∆pi | )       2          2   2     n

As n → ∞ the distribution of ∆pi /Std(∆pi ) converges point-wise to a standard normal.

  The proof uses results from the characterization of spherical distributions by Song and
Gupta (1997) (see Appendix A for the details). Using the previous proposition and the
approximation for ȳ we obtain the following expression for the standard deviation of price
                        2         1/4                                    2           1/4
                        σ ψ 2(n+2)                                          σ ψ1 2(n+2)
changes: Std ( ∆pi ) = B n2              and in the CRS case Std ( ∆pi ) = B        n
                                                                                             ,
where both expressions are decreasing in n. The expression for the kurtosis of the price
changes shows that this statistic is an increasing function of n.
       Some of the statistics for |∆pi | in Proposition 7 can be approximated to obtain:15
                                          q                                                q
                                              2         1
                                                                      Std( |∆pi | )           π    2n
                                                                                                          
             E [ |∆pi | ] ≈ Std ( ∆pi )       π
                                                  1+   2 n
                                                                 and    E( |∆pi | )
                                                                                       ≈       2   1+2n
                                                                                                              −1 .

The expression for the approximate value of E [|∆pi |] is given by Std (∆pi ) times a decreasing
  14
      The distribution of ∆p(τ ) is uniform in the surface of the sphere. To see this notice that the p.d.f. of a
jointly normally distributed vector of n identical and independent normals is given by a constant times the
exponential of the square radius of the sphere, divided by half of the common variance.
   15
      The approximation errors for E [ |∆pi | ] and Std ( |∆pi | ) /E ( |∆pi | ) are smaller than 0.26% and 0.91%.


                                                          19
function of n. The expression for the approximate value of Std (|∆pi |) /E (|∆pi |) shows that
this statistic is an increasing function of n.
    We note that the shape of the distribution h for price changes differs substantially for
small values of n. For n = 2 is U-shaped, for n = 3 is uniform, for n = 4 it has the shape of
a half circle, and for n ≥ 6 it has bell shape.16 Proposition 7 establishes that when n → ∞
the distribution converges to a normal: this can be seen in Figure 2 by the comparison of
the distribution for n = 50 and the p.d.f of a standard normal distribution with standard
deviation equal the one obtained when n = 50.

                Figure 2: Density w(·) of the price changes for various choices of n


                                n=2                                                                                                     n=5
 18                             n=3                                                                                                     n = 10
                                n=4                                4.5                                                                  n = 50
 16                                                                                                                                     normal
                                                                    4

 14
                                                                   3.5

 12
                                                                    3

 10
                                                                   2.5

  8
                                                                    2

  6
                                                                   1.5

  4                                                                 1

  2                                                                0.5

  0                                                                 0
       −0.15   −0.1   −0.05     0      0.05    0.1     0.15              −0.2   −0.15   −0.1   −0.05     0     0.05    0.1      0.15   0.2
                 values of the price change, in logs                                      values of the price change, in logs

Parameter values: B = 20 , σ = 0.15 , ψ1 = 0.02. Menu cost proportional to n. Solid lines are the p.d.f for w
for different n. Circles denote the p.d.f. of a normal with standard deviation equal to that of ∆pi for n = 50.



    Table 3 computes the size of the price adjustments, measured as E[|∆p|], as a function
of n. We do so for the two extreme technologies, the constant returns to scale (CRS) and
the constant fixed cost (CFC) case. In each case we fix the value of the parameter Bσ 2 /ψ1
so that this statistic is 0.085, the value estimated by Bhattarai and Schoenle (2010) in US
data. We also report the values estimated for the US for other values of n. Comparing both
assumptions, it seems that the US data is somewhere in the middle, but closer to the case
of CRS. The better fit of the CRS case for the size of price changes is consistent with the
better bit obtained for the frequency of price changes as reported in Table 1.
  16
    For n equal to 2, 3 and 4 one can grasp the shape of the distribution h from geometrical considerations,
together with the fact the maximum of a density of a univariate normal is at one.


                                                              20
                               Table 3: Size of Price changes E[|∆p|]
                                                     number of products n                             implied
                                            1      2       4      6      10                  50         ψ1

 E[|∆p|] for CRS model ψ = n ψ1 :            10% 8.5%                7.5%    7.1%   6.8%    6.4%           0.03

 E[|∆p|] for CFC model: ψ = ψ1 :             12% 8.5%                6.3%    5.4%   4.6%    2.9%           0.02

 E[|∆p|] for US Data:                            -        8.5%       7.75% 6.75% 6.5%            -          -

           ψ1
 Value of Bσ 2 chosen to match the size of price changes at n = 2. US data from Bhattarai and Schoenle

 (2010), Figure 4. Implied ψ1 using B = 20 and σ = 0.15.



   Furthermore, from the expressions in Proposition 7 the distribution of price changes ∆p,
and of their absolute value |∆p| depend only on n and ȳ. Thus, any normalized statistics
such as ratio of moments (kurtosis, skewness, etc) or a ratio of points in the c.d.f. depends
exclusively on n. Indeed the kurtosis is given in Proposition 7, as Kurtosis(∆pi ) = 3n/(2+n),
which is an increasing concave function, starting at 1 and converging to 3. Table 4 uses the
expressions of the model to compute several moments of interest. These moments have been
estimated using two scanner data sets by Midrigan (2011) and also using BLS producer data
by Bhattarai and Schoenle (2010). A summary of the selected statistics from these papers is
reproduced in Table 5.

  Table 4: Statistics for price changes as function of number of products: Model economy

 statistics \ number of products n          1         2          3      4     5     6      10        20         50

 Std(|∆pi |) / E(|∆pi |)                    0        0.48 0.58 0.62 0.65 0.67              0.70 0.74 0.75

 Kurtosis(∆pi )                            1.0       1.7       2.0     1.9   2.1    2.3    2.5       2.8        2.9

 Fraction: |∆pi | < 21 E(|∆pi |)            0        0.21 0.25 0.27 0.28 0.28              0.30 0.31 0.31

 Fraction: |∆pi | < 41 E(|∆pi |)            0        0.10 0.12 0.13 0.14 0.14              0.15 0.16 0.16

 ∆pi denotes the log of the price change, and |∆pi | the absolute value of the log of price changes. They are
 computed using the results in Proposition 7. All statistics in the table depend exclusively on n. Kurtosis
 defined as the fourth moment relative to the square of the second.



   We briefly comment on the reasons why the statistics chosen in Table 4 with Table 5 are

                                                          21
                                                                              √       √
of interest. Note that the case of n = 1, price changes are binomial, either − ȳ or + ȳ
with the same probability, so its absolute value has a degenerate distribution. As the number
of goods increases the dispersion of the absolute value increases. The distribution includes
larger price changes, so that its kurtosis also increases with n. As there are more goods, some
goods will be adjusted even if their price is almost optimal, and hence the fraction of small
price changes increases with n. We draw two conclusions from the comparison of Table 4
with Table 5. First, for the four moments computed our model falls short from the data. In
particular, as shown in Proposition 7 the distribution in the model converged to a normal as
n goes to ∞. Yet the data displays values for the four moments even larger than the ones
corresponding to a standard normal. Second, our model reproduces the pattern of the four
moments in terms of their variation with respect to the number of products n.

    Table 5: Statistics for price changes as function of the number of products: US data

                                     Bhattarai and Schoenle                   Midrigan
 Statistics                          Number of products n            AC Nielsen      Dominick’s
                                      2     4      6    10          All No Sales All No Sales

 Std(|∆pi |) / E(|∆pi |)             1.02 1.15 1.30         1.55 0.68         0.72      0.84       0.81

 Kurtosis(∆pi )                       5.5    7.0     11      17     3.0        3.6       4.1       4.5

 Fraction: |∆pi | < 12 E(|∆pi |) 0.39 0.45 0.47             0.50 0.24         0.25      0.34       0.31

 Fraction: |∆pi | < 14 E(|∆pi |) 0.27 0.32 0.35             0.38 0.10         0.10      0.17       0.14
 Sources: For the Bhattarai and Schoenle (2010) data: the number of product n is the mean of the
 categories considered based on the information in Table 1, the ratio Std(|∆pi |) / E(|∆pi |) is from Table
 2 (Firm-Based), the fraction of |∆pi | which are small is from Table 14, the Kurtosis is from Figure 7.
 The data from Midrigan (2007) are taken from distribution of standardized prices in Table 2a.




5    Impulse responses to a monetary shock
In this section we study the response of the aggregate price level to an unexpected permanent
monetary shock. Understanding this impulse response is useful to quantify the real effects
of monetary policy shocks in the presence of menu costs, identify its determinants, and how
this effect varies with the number of products n sold by the firm. We will show how these
determinants map into simple observable statistics about the size and frequency of price
changes, that are available for many economies, and provide an analytical characterization

                                                    22
of the output effect caused by the monetary shock.
    The general equilibrium set up where we embed our price setting problem is an adaptation
of the one in Golosov and Lucas (2007) to multiproduct firms. The representative household
has preferences given by (see Appendix B for details)
                                                                                                                     η
                                                                                                                  ! η−1
     ∞                                                                 1   n
                                      M(t)
Z                                                                   Z        X                         η−1
          −rt
         e     u (c(t)) − αℓ(t) + log         dt where c(t) =                      (Zk,i(t) ck,i(t))    η    dk
 0                                    P (t)                          0       i=1


where u(c) = (c1−ǫ − 1)/(1 − ǫ), ck,i(t) is the consumption of product i produced by firm k,
ℓ(t) are labor services, M(t) is the nominal quantity of money, P (t) is the nominal ideal price
index of one unit of aggregate consumption, and r > 0, ǫ ≥ 1, α > 0, η > 1 are parameters.
The elasticity of substitution between any two products η is the same, regardless of the firms
that produced them. The production function for product i in firm k at time t is linear in
labor –the only input in the economy– with productivity 1/Zki(t), so the marginal cost of that
product is W (t)Zik (t), where W (t) is the nominal wage. We assume that the idiosyncratic
productivity and demand shocks are perfectly correlated, and that Zik (t) = exp (σWki (t))
where Wki are standard BM independent across all i, k.17 Firm k can adjust one of more
of its n nominal prices paying a fixed menu cost equal to a number of labor service units,
which we express as ψ times the steady state profits from producing n goods evaluated at the
profit maximizing price. Markets are complete, and all firms are owned by the representative
household. We use R(t), W (t) and Pik (t) for the time t nominal interest rate, nominal wage,
and nominal price of firm k product i respectively. As before we use pki (t) for the price gap:
the log of the ratio of the nominal price of firm k on product i to the frictionless optimal
price, or
                      pki (t) = log Pki(t) − log(W Zki(t)) − log (η/(η − 1))             .                         (22)

We study an economy that starts at time zero with the invariant distribution of firm’s prices
that correspond to the steady state with constant money supply equal to M̄ . We assume
that at time t = 0 there is an unanticipated permanent increase in the level of the money
supply by δ log points, so log M(0) = log M̄ + δ, where we use a bar to denote the initial
steady state values.
    The next proposition gives a characterization of the equilibrium for this economy, and
the circumstances under which the aggregation of the decision rules studied so far provides
an accurate approximation of the effect of a monetary shock δ in a general equilibrium (see
Appendix B for the proof which is standard). We use p ≡ {pi(t)}t≥0,i=1,...,n to denote the
    17
    The permanent nature of the productivity shocks and the presence of a perfectly correlated preference
shocks are departures from Golosov and Lucas’s (2007) model which considerably simplify the analysis and
are used by many others, e.g. Midrigan (2011).


                                                   23
stochastic process for the n price gaps, and τ ≡ {τj }j=1,... the stopping times, for a generic
firm that starts with price gap p (so we omit the firm-subindex k). We use c ≡ {c(t)/c̄−1}t≥0
for the path of aggregate output deviations from the steady state. Finally, we let V0 (p, τ ) be
the (negative of the) expected profits of the firm in equilibrium, and V0 (p, τ ) the objective
function in equation (1) (the choice of signs is to make V0 comparable to V0 in the cost
minimization problem).

Proposition 8.         Let δ ≥ 0. Assume that | d logdδP (t) | ≤ κ for all t ≥ 0. An equilibrium
satisfies for all t ≥ 0:
                                                               
                    W (t)           c(t)      1           P (t)
     R(t) = r , log       = δ , log      =        δ − log                                                             (23)
                     W̄              c̄       ǫ            P̄
                Z 1 X  n
                                !                n
                                                        !                                n
                                                                                                                     !
                                            1                   Z 1
     P (t)
                                        Z       X                                        X
 log       = δ+           pki(t) dk −               p̄ki dk +                                      o(||pki(t) − p̄ki ||) dk
      P̄          0   i=1                 0     i=1              0                           i=1


Then the objective function of the firm in a general equilibrium can be written as:
                                           Z       ∞                                                      
                            δ                           −rt                          2
                                                                                         
        V0 (p, τ, c) = Υe V0 (p, τ ) + E                e     o || ( p(t) , δ ) ||             p(0) = p + ι(δ)         (24)
                                                0


where ι(·) does not depend on (p, τ ), and Υ > 0 are the per product maximum (frictionless)
nominal profits in steady state (immediately before the monetary shock), a constant that
depends on η, α, ǫ, c̄ and W̄ .

   The first part of Proposition 8 shows that a permanent increase in the (log of) money of
size δ > 0, increases permanently (the log of) nominal wages, and hence marginal cost, by
δ at time zero. The effect on output on the other hand is gradual, and at each t it depends
on how much the aggregate price level P (t) has risen up to that date. This mechanism is
common to other general equilibrium sticky price model, such as Danziger’s (1999) or Golosov
and Lucas’s (2007). The second line of equation (23) then shows that the effect of the shock
on P (t) can be approximated by analyzing the response of the price gaps: each coordinate
of the vector of price gaps falls by a constant δ, i.e. pki(0) = p̄ki − δ, before any adjustment
takes place.
   The second result of the proposition is that for small shocks δ and small adjustment cost
ψ, the general equilibrium feedback effect is negligible, so that ignoring the effect of the
shock on the firm’s decision rules (e.g. on the value of ȳ) gives a good approximation of
the firm’s behavior during the convergence to the steady state. This aspect of our analysis
provides a foundation to Caballero and Engel (1991, 1993, 2007) who pioneered the analytical
study of the impulse response in Ss models while ignoring the general equilibrium feedback


                                                    24
effects on the decision rules. To see why this approximation holds note that, as Golosov
and Lucas (2007) remark, the general equilibrium feedback on the firms’ decision rules is
completely captured, at each time t, by the effect of the aggregate output c(t) on profits.
These authors report that such feedback effects on the optimal decision rules of the firms are
small.18 The approximation displayed in equation (24) in Proposition 8 explains this finding:
the objective function V0 in the partial equilibrium set-up of equation (1) is proportional
to the objective function in the general equilibrium setup V0 . The difference between these
functions involves third or higher order terms, so that the general equilibrium feedback effect
on the form of the inaction set is second order. The logic of this result is similar to the result
in the neo-keynesian model with Calvo pricing that the forward looking Phillips curve does
not include interest rate effects; or much closer to our set-up, the analysis in Section IV of
the sS foundation of a Phillips curve by Gertler and Leahy (2008). The main idea of the
proof is that firm’s discounted period t profits from selling product i is the product of a term
including the GE feedback – a function of c(t)–, and a term whose maximum is achieved by
the frictionless price. Hence discounted time t profits have zero first derivative w.r.t. to the
(log of the) price gap pi (t) and zero second cross derivative w.r.t. to the i-th (log of the)
price gap pi (t) and c(t); see Section B.1 in Appendix B for a detailed proof.
   Next, we use the results of Proposition 8 to study the effect of an aggregate monetary
shock of size δ on the aggregate price level P (t) at t ≥ 0 periods after the shock, which
we denote by Pn (δ, t). As commonly done in the sticky price literature, we characterize
the first order approximation to the price index, so in particular we study Pn (δ, t) ≡ δ +
R 1 Pn
 0
   ( i=1 pki (t)) dk ≈ log P (t)/P̄ . Once we characterize the effect on the price level, we
describe the effect on employment and output.
   This impulse response is made of two parts: an instantaneous impact adjustment (a jump)
of the aggregate price level which occurs at the time of the shock, denoted by Θn (δ), and a
continuous flow of adjustments from t > 0 on, denoted by θn (δ, t). The cumulative effect of
the price level t ≥ 0 periods after the shock is
                                                           Z       t
                                 Pn (δ, t) = Θn (δ) +                  θn (δ, s)ds .                     (25)
                                                               0


We also study the impact effect on the fraction of firms that change prices, denoted by Φn (δ).
  18
     Figure 7 in Golosov and Lucas (2007) compares an impulse response that includes the general equilibrium
feedback effect with one computed ignoring this effect, i.e. keeping the firms decision rules constant. The
authors conclude that “Evidently, the approximation works very well for the effects of a one-time shock, even
a large one.” In Alvarez, Lippi, and Paciello (2011a) we also solve numerically a model with the general equi-
librium structure of Golosov and Lucas but where the idiosyncratic shocks and adjustment cost corresponds
to the quadratic case studied in this paper for n = 1 and also find that the general equilibrium feedback
effects are very small.


                                                     25
   We focus on the cumulative price response because its difference with the monetary shock,
i.e. δ − Pn (t, δ), is proportional to the effect on aggregate output at time t, as discussed in
Section 5.5. Next we present our main results on Pn (δ, t) and Φn (δ) following an aggregate
shock.

Proposition 9. Fix n, the number of goods produced by each firm.
                                                                                   √
  1. Parameters. The impulse response Pn (δ, t) depends only on two parameters: ȳ and
     σ, which we re-parameterize as functions of two steady state statistics: the standard
      deviation of price changes Std[∆p] and the frequency of price changes Na .

  2. Scaling and Stretching: The IRF of an economy with steady state Std[∆p], Na and a
      shock δ at horizon t ≥ 0 is a scaled version of the one of an economy with unit steady
      state parameters, normalized monetary shock δ/Std[∆p], and a stretched horizon Na t:
                                                                                       
                                                                    δ
                  Pn (δ, t; Na , Std[∆p] ) = Std[∆p] Pn                  , Na t; 1, 1
                                                                 Std[∆p]

  3. Impact Effects: the impact effects P(δ, 0) = Θn (δ) and Φn (δ) are strictly increasing
     in δ, they are respectively strictly below δ and 1, in the interval (0, 2 Std[∆p]) and
      achieve these values outside this interval. Moreover, impact effects are second order on
      the monetary shock: Θ′n (0) = Φ′n (0) = 0.

    Part 1 of Proposition 9 provides an interesting re-parameterization of the impulse response
for three reasons: (i) the steady state statistics Std[∆p] and Na are readily available for actual
economies, (ii) the results of Section 3 and Section 4 imply that, even fixing n, one can always
choose two parameters values of ψ/B and σ 2 to match these two statistics, and (iii) keeping
fixed these two observable statistics and just changing n we can isolate completely the role
of the number of products n.
    Part 2 of Proposition 9 states a useful “scaling” property of the impulse response function.
First notice that at t = 0, the impact effect of a monetary shock Θn is the same for any
two economies with the same steady state average size of price changes Std[∆p], and is
independent of the value of the steady state frequency of price adjustment Na . Moreover,
for all times following the impact (t > 0) the effect of a monetary shock δ, in an economy
characterized by steady state statistics Std[∆p] and Na depend only on n. This means that
for a fixed n, the whole profile of the impulse response functions in economies with different
values of Std[∆p] and Na are simply scaled version of each other. For instance, fixing n, δ
and Std[∆p], the impulse response functions in two economies that differ in the frequency
of price adjustments, say Na vs 2 Na , will have exactly the same values of Pn but will

                                               26
reach these values at different times, respectively 2 t vs t, i.e. an economy with twice more
flexible prices in steady state has an impulse response that reaches each value in half of the
time. Furthermore, keeping Na fixed, the height of the whole impulse response function Pn
is proportional to the scaled value of the monetary shock. We find this characterization
interesting in itself, i.e. even interesting for the n = 1 case, but more importantly it will
allow us to compare the impulse response for economies that feature different values of n.
    Part 3 of Proposition 9 shows that the size of the monetary shock matters, so for large
shocks there is instantaneous full price flexibility (Θn = δ), but for small shocks the size
of the initial jump in price is second order compared to the shock. This, together with
part 2, implies that whether a monetary shock is large or not is completely characterized by
comparing it with the typical price change in steady state, i.e. it is a function of δ/Std[∆p].

                         Figure 3: The impact effect of an aggregate shock on the price level: Θn


                               Impact effect on the price level                                                                Impact effect relative to the n = 1 case

                2                                                                                                    1.6



               1.8

                                                                                                                     1.4
                                                                                                                                                                          δ
               1.6                                                                                                                                                    S t d [ ∆ p ]=   1
                                                                                                                                                                          δ
                                                                                                                     1.2                                              S t d [ ∆ p ]=   0.5
               1.4
  / S td[∆p]




                                                                                                                                                                          δ
                                                                                                                                                                      S t d [ ∆ p ]=   0.1
               1.2
                                                                                                                                                                          δ
                                                                                                                                                                      S t d [ ∆ p ]=   0.01
                                                                                                                      1
                                                                                                          Θ n /Θ 1
  ´




                1
  S td(∆p
     δ




                                                                                                                     0.8
               0.8
  ³
  Θn




               0.6
                                                                                                                     0.6
                                                                                n   =     1
               0.4                                                              n   =     2
                                                                                n   =     10
                                                                                                                     0.4
               0.2                                                              n   =     30

                0
                     0   0.2      0.4      0.6     0.8    1      1.2    1.4         1.6        1.8   2               0.2
                                                                                  δ                                        0        5      10            15             20                    25   30
                                        Size of normalized monetary shock ,   S td[ ∆ p ]                                                       Numbe r of Produc t s, n


Normalized impact response of the aggregate price level to a permanent shock in the level of money of size
δ/Std[∆p]. The normalization in the left panel consists of dividing the impact response of the price level by
Std[∆p], the steady state standard deviation of price changes. See the text for more details.



   For the reader who is not interested in the derivation of the impulse responses, and an
explanation of the different effects behind it, we include two figures that summarize the
quantitative conclusions of our analysis. Before getting to these figures, we note that its
computation for large value of n would have been extremely costly without the characteri-
zation given in the sections below. Figure 3 has two panels that illustrate the impact effect
on prices of monetary shocks of different size for economies with different values of n. The
left panel shows the normalized impact on the aggregate price level, Θn /Std[∆p] (on the

                                                                                                     27
vertical axis), of a normalized monetary shock, i.e. a shock δ/Std[∆p] (on the horizontal
axis). Each line plotted in this panel corresponds to a different number of products n. Recall
that if Θn (δ) = δ the shock is neutral, and that instead when Θn (δ) < δ the shock implies
                                                                   p
an increase in real output. As stated in Proposition 9, if δ ≥ 2 ȳ/n = 2 Std[∆p], then all
firms adjust prices, and hence the shock is neutral. This explains the range of the normalized
shock, between 0 and 2. For the quantification of this figure it is helpful to notice that on the
one hand a typical estimate of the standard deviation of price changes for US or European
countries is 10% or higher, i.e. Std[∆p] ≈ 0.1. On the other hand to quantify δ note that
in a short interval -say a month- changes of the money supply or prices in the order 1% are
very rare.19 This figure also shows that for small δ the aggregate price effects are of order δ 2 ,
as stated in Proposition 9. Interestingly, the impact response of a monetary shock changes
order with respect to n as the value of δ increases, as can be seen for shocks smaller or larger
than δ/Std[∆p] ≈ 0.7. Note that using Std[∆p] = 0.1 this means that shock for which they
reverse order is higher than 7%, a very large value. The right panel of Figure 3 displays four
lines, each corresponding to a different value of δ. Each line shows the aggregate effect on
prices as n changes, relative to the n = 1 case. From these two panels it can be seen that, for
monetary shocks in the order of those experienced by economies with inflation close to zero,
i.e. for increases in money δ/Std[∆p] smaller than a 0.5 (or for the benchmark value, for δ
smaller than 5%), economies with more products are more sticky than those with fewer.
    Figure 4 plots the impulse response function Pn (δ, t) for economies with different n keeping
fixed the steady state deviation of price changes to 10%, i.e. Std[∆p] = 0.1 and an average
of one price change per year, i.e. Na = 1. The size of the monetary shock is 1%, so that
δ/Std[∆p] = 0.1. In this figure we have time aggregated the effect on the aggregate price
level up to daily periods. As required, all impulse responses display impact effect on the first
period, and a monotone convergence to the full adjustment of the shock. The impact effect
of the monetary shock during the first periods is to increase prices about 5% of the long run
value (i.e. 5 basis points) for n = 1. This effect is smaller in economies where firms produce
more products, i.e. the impact at t = 0 is decreasing in n. This difference is small between
one and two products, but the effect is almost halved for firms with 10 products, as shown
in Figure 3 for a monetary shock of the same size.
    Likewise, the shape and duration of the shocks depend on n. The half-life of the shock
more than doubles as the number of products goes from 1 to 10. The shape of the impulse
responses for n = 1 is quite concave, but for large n it becomes almost linear, up to a value of
t of about 1/Na . This pattern of the shape is consistent with the result of Proposition 6 which
  19
    For instance, the monthly innovations on a time series representation of M1 are on the order of 50 basis
points, and that is without any conditioning. Presumably exogenous monetary shocks are much smaller.



                                                    28
shows that for large n the model becomes a version of either Taylor (1980) staggering price
model or of Caballero (1989), Bonomo and Carvalho (2004) and Reis (2006) inattentiveness
model, where the staggering lasts for T (0) = 1/Na periods. Indeed, in Proposition 13 below
we show that as n → ∞ the impulse response becomes linear up to time 1/Na because there
is no “selection effect”. Summarizing, we find that extending the analysis from n = 1 to a
larger number of product (say n ≈ 10) almost halves the impact effect on the aggregate price
level and doubles the half-life of the shock, for empirically reasonable monetary shocks.20

                                                     Figure 4: Impulse response of the aggregate price level

                                                           1 p ercent mon etary sh ock, N a = 1, S td[∆p ] =0.1

                                            1
             CPI response, in percentage




                                           0.8


                                                                                                   δ
                                                                                                S td[∆p] =   0.1

                                           0.6




                                           0.4




                                           0.2

                                                                                                                    n   =   1
                                                                                                                    n   =   2
                                                                                                                    n   =   3
                                                                                                                    n   =   10
                                                                                                                    n   =   30
                                            0
                                                 0     2      4      6     8     10     12    14       16          18        20
                                                                               months




      The rest of this section is organized as follows. First, we obtain a closed form solution for
the IRF in the case of n = 1. This result, which is novel and interesting in its own right, is
also helpful to better understand the derivation for the n ≥ 2 case as well as to compare the
results. After that, we develop the analytical expressions for the n ≥ 2 case, concentrating
first on the impact effects and then on the remaining part of the impulse response. The proof
of Proposition 9, as well as explicit expressions for the impulse responses, are presented as
separate propositions in the next subsections. We conclude the section by discussing the real
effect of the monetary shocks.
 20
      The results are very similar for shocks of 1/2 and 2 percent, as reported in the Appendix F.3.




                                                                               29
5.1    Impulse response for the n = 1 case
In the n = 1 case, which, abusing a bit the analogy, we refer to as the Golosov and Lucas
(GL) case, the firms controls the price gap between two symmetric thresholds, ±p̄, and when
the price gap hits either of them it returns it to zero. Hence, in the GL case the invariant
distribution of price gaps is triangular: the density function has a maximum at the price gap
p = 0 and decreases linearly on both sides to reach a value of zero at the thresholds p̄ and
−p̄, since firms that reach the thresholds will adjust upon a further shock. An example of
such a distribution is depicted by the solid line in the left panel Figure 5. A straightforward
computation gives that the slope of this density is ±(1/p̄)2 . Consider an aggregate shock
that displaces the distribution by reducing all price gaps by δ. If the value of δ > 2p̄ then
all the firms will adjust their price, so that Φ = 1, and after a simple calculation one can see
that the aggregate price level is increased by δ. Instead, if the value of δ is smaller than 2p̄,
only the firms with a sufficiently small price gap will adjust. Denoting the price gap right
after the shock by p0 , these are the firms that end up with p0 < −p̄. The density of the
distribution of the price gaps immediately after the shock, denoted by λ, is depicted by the
dotted line of Figure 5 and it is given by:
                                                  
                                     1 1 + δ + p0       if   p0
                                                                   ∈ [−1 − p̄δ , − p̄δ ]
                                      p̄    p̄  p̄            p̄
                    λ(p0 , δ; p̄) =                                                       (26)
                                     1 1 − δ − p0       if   p0
                                                                   ∈ (− p̄δ , 1 − p̄δ ]
                                      p̄    p̄   p̄           p̄


For a shock of size δ the mass of such firms is Φ = (1/2)(δ/p̄)2 , which uses the slope of the
density given above (to simplify notation we suppress the n = 1 subindex). Note that the
magnitude of this fraction is proportional to the square of the shock, a feature that is due
to the fact that there are a few firms close to the boundary of the inaction set. This case
is depicted by the dotted line in the left panel of Figure 5. Firms that change prices “close
the price gap” completely, so that price increase will be δ + p̄ for the firm that prior the
shock had price gap −p̄ and it will be equal to p̄ for the firm with pre-shock price gap equal
to −p̄ + δ. Using the triangular distribution of price gaps we have that the average price
increase among those that adjust prices equals p̄ + δ/3. Let’s denote by Θ the impact effect
on aggregate prices of a monetary shock of size δ, the product of the number of firms that
adjust times the average adjustment among them. Note that in steady state the average size
of price changes, as measured by the standard deviation of price changes Std[∆p], is given
by p̄. Thus for δ ≤ Std[∆p] = p̄ we can write
                                                     2              
                                    1          δ             1    δ
                        Θ = Std[∆p]                       1+                                (27)
                                    2       Std[∆p]          3 Std[∆p]


                                                30
so that for an economy with one good, the impact effect on prices, normalized by the steady
state average price change, depends on the normalized monetary shock, and it is locally
quadratic, at least for a small shock. Note that the degree of aggregate stickiness is indepen-
dent of the steady state fraction of price changes.

                                    Figure 5: The selection effect on impact for the n = 1 and n = 2 case


                                                             n=1                                                                                                       n=2


                      2

                                                                                                                                                   1




                                                                                                                pr i c e gap for go o d 2: p 2
                     1.5
                                                                                                                                                  0.5
 Dens ity function




                      1                                                                                                                            0




                                                                                                                                                 −0.5
                     0.5




                                                                                                                                                  −1

                      0
                             −( p̄ + δ )    − p̄                                     p̄

                      −1   −0.8      −0.6      −0.4   −0.2       0       0.2   0.4        0.6       0.8    1                                            −1   −0.5             0                 0.5   1
                                                             Price gap                                                                                              price gap for good 1: p 1




   We now develop expression for the impulse response at horizons t > 0. The density of
the price gaps p0 right after the monetary shock δ is the displaced, triangular distribution λ
is displayed in Figure 5 and described in equation (26), and hence it has p̄ as a parameter. It
peaks at −δ, it has support [−p̄ − δ, p̄ − δ]. Note that the impact adjustment is concentrated
on the firms whose price gap is smaller than −p̄. Now consider the contribution to the change
in aggregate prices of the firms whose price gap is p0 ∈ [−p̄, p̄ − δ], so they have not adjusted
on impact, and of which there are λ(p0 ; δ) dp0 . Let G− (t; p0 ) be the probability that a firm
with price gap p0 at time zero will increase price before time t, i.e. the probability that
its price gap will hit −p̄ before time t without first hitting p̄. Likewise define G+ (t; p0 , )
as the corresponding probability of a price decrease, let G(t; p0 ) = G− (t; p0 ) − G+ (t; p0 ) the
difference between these probabilities, and we let g be its density. We note that these function
have (p̄, σ 2 ) as parameters. We can now define the contribution to the change in the price
level of the adjustments that take place between t and t + dt as:
                                                                                                Z   p̄−δ
                                                                         θ(δ, t) = p̄                      g(t; p0) λ(p0 ; δ)dp0                                                                          (28)
                                                                                                −p̄


                                                                                                           31
The integral excludes the initial price gaps p0 that are below −p̄. These correspond to firms
that adjusted on impact. Note that θ(δ, t) have (p̄, σ 2 ) as parameters. Expressions for the
densities of g + and g − can be found in equations (15)-(16) of Kolkiewicz (2002). This gives
                         ∞
                   σ 2 X − k22p̄π22 σ2 t
                                                                      
                                                       p0                 p0
      g(t; p0 ) =           e            kπ sin kπ 1 +       − sin kπ 1 −                         (29)
                  2 p̄2 k=1                            p̄                 p̄

    Four remarks are in order. First, by substituting our expressions for g and λ we have a
closed form solution for each expression in equation (28). Second, note that we did not need
to compute the evolution of the whole cross section distribution. Instead, we just follow each
firm until the first time that it adjusted its price. This is because the subsequent adjustments
have a zero net contribution to aggregate prices, since after the adjustment every firm price
gap returns to zero, and the subsequent adjustments are as likely to be increases as decreases.
Third, note that the role of the monetary shock is just to displace the initial distribution,
i.e. δ is not an argument of g. Fourth, note that this function has two interesting forms of
homogeneity. The first type of homogeneity is that it is homogenous of degree one in σ, p̄
and δ. This follows because scaling p̄ and δ will just scale proportionally the distribution λ of
the initial price gaps. Furthermore, scaling p̄ and σ keeps the probabilities of hitting any two
scaled up values in the same elapsed time to be the same. The second type of homogeneity
uses that a standard Brownian Motion at time t started at time zero has a normal distribution
with variance t. So scaling the variance of the shock, the price gaps will hit any given value
in a scaled time. These two homogeneity properties can be seen by integrating the previous
expression gives an IRF which satisfies the properties stated in Proposition 9:
                                                      2 2
                                          ∞       k π
                                          X 1 − e− 2        Na t
       P(δ, t) = Θ(δ) + Std[∆p]                                    ×
                                                   kπ
                                          k=1
                             δ
                       1− Std(∆p)                                                          
                                                                                    δ
                   Z
                                    [sin (kπ (1 + x)) − sin (kπ (1 − x))] λ x,           ; 1 dx
                       −1                                                        Std[∆p]

5.2    Invariant distribution of y = ||p||2
Here we study the invariant distribution of the sum of the squares of the price gaps y ≡ ||p||2 =
Pn 2
  i=1 pi (t) under the optimal policy. This will be used to describe the starting point of the
economy before the monetary shock. We will denote the density of the invariant distribution
by f (y) for y ∈ [0, ȳ]. This is interesting to study the response of firms that are in the
steady state to an unexpected shock to their target that displaces the price gaps uniformly.
The density of the invariant distribution for y is found by solving the corresponding forward
Kolmogorov equation, and the relevant boundary conditions (see Appendix A for the proof).

                                                   32
Proposition 10.                                       The density f (·) of the invariant distribution of the sum of the squares
of the price gaps y, for a given thresholds ȳ in the case of n ≥ 1 products is for all y ∈ [0, ȳ]

                              1
                                 [log(ȳ) − log(y)] if n = 2, and
                                                    f (y) =
                              ȳ
                                             h
                                  −n       n          n          n
                                                                     i
                  f (y) = (ȳ) 2                 (ȳ) 2 −1 − (y) 2 −1 otherwise.           (30)
                                        n−2
   The density has a peak at y = 0, decreases in y, and reaches zero at ȳ. The shape
depends on n. The density is convex in y for n = 1, 2, 3, linear for n = 4, and concave for
n ≥ 5. This is intuitive, since the drift of the process for y increases linearly with n, hence
the mass accumulates closer to the upper bound ȳ as n increases. Indeed as n → ∞ the
distribution converges to a uniform in [0, ȳ]. Proposition 10 makes clear also that the shape
of the invariant density depends exclusively on n, the value of the other parameters, ψ, B, σ 2
only enters in determining ȳ, which only stretches the horizontal axis proportionally.

        Figure 6: f (·) density of invariant distribution of y, for various choices of n

                                           10

                                                                                                                   n    =   1
                                            9
                                                                                                                   n    =   2
                                                                                                                   n    =   4
                                                                                                                   n    =   10
                                            8
                                                                                                                   n    =   50
              density of invariant f (y)




                                            7



                                            6



                                            5



                                            4



                                            3



                                            2



                                            1



                                            0
                                                0      0.1    0.2   0.3        0.4     0.5    0.6     0.7   0.8   0.9            1
                                                                          y as fracti on of threshol d ȳ




5.3    Impact response in the n ≥ 2 case
Now we turn to studying the economy-wide impact effect of the aggregate shock. To find out
what is the fraction of firms that will adjust prices under the invariant we need to characterize
some features of the invariant distribution of p ∈ Rn . We assume that the aggregate shock
happens once and for all, so that the price gap process remains the same and the firms

                                                                                     33
solve the problem stated above. First we find out which firms choose to change prices and,
averaging among their n products, by how much. A firm with price gap p ∈ Rn and state
||p||2 = y ≤ ȳ before the shock, will have its price gaps displaced down by δ in each of its n
goods, i.e. its state immediately after the shock is ||p − 1n δ||, where 1n is a vector of ones.
This firm will change its prices if and only if the state will fall outside the range of inaction,
i.e. ||p − 1n δ|| ≥ ȳ, or equivalently if and only if:

                        n
                                    !                        Pn
               2
                        X
                                             2                i=1 pi            y − ȳ  δ
          ||p|| − 2δ           pi       + nδ ≥ ȳ     or      √      ≤ ν(y, δ) ≡ √ + n √ .            (31)
                         i=1
                                                                y               2δ y   2 y

Thus ν(y, δ) gives the highest value for the sum of the n price gaps for which a firm with
                                                                         √
state y will adjust the price. The normalized sum of price gaps ni=1 pi / y takes values on
                                                                P
   √ √
[− n, n]. The right panel of Figure 5 shows the n = 2 case by plotting a circle centered at
zero that contains all the pre-shock price gap, and showing the “displaced” price gaps right
after the δ shock, which are given by a circle centered at (−δ, δ). The (red) shaded area
contains all the price gaps of the firms that, after the shock, will find it optimal to adjust
their prices, i.e. firms for which equation (31) holds.
                                                                       √ P
    A firm whose price gap p satisfies equation (31), i.e. one with (1/ y) ni=1 pi ≤ ν(y, δ),
will change all its prices. The mean price change, averaging across its n products, is δ −
(1/n) ni=1 pi .21 Thus we can determine the fraction of firms that change its prices, and
      P

the amount by which they change them, analyzing the invariant distribution of the squared
price gaps, f (y). Let S(z) denote the cumulative distribution function of the sum of the
coordinates of the vectors distributed uniformly in the n dimensional unit sphere. Formally
we define S : R → [0, 1] as

                            1
                                         Z
                   S(z) =                                 I {x1 + x2 + ... + xn ≤ z} L(dx) .
                          L(Sn )          x∈Rn ,||x||=1


where Sn is the n−dimensional sphere and where L denotes its n − 1 Lebesgue measure.
                                                  √                   √
Note that S(·) is weakly increasing, that 0 = S (− n), S(0) = 1/2, S ( n) = 1 and that
                                    √ √
it is strictly increasing for z ∈ (− n, n). Remarkably, as shown in Proposition 11, the
distribution of the sum of the coordinates of a uniform random variable in the unit n-
dimensional sphere is the same, up to a scale, than the marginal distribution of any of
the coordinates of a uniform random variable in the unit n-dimensional sphere (which we
  21
    Recall that pi are the price gaps, thus in order to set them to zero the price changes must take the
opposite sign. Moreover, since δ has the interpretation of a cost increase, it decreases the price gap, and
hence its correction requires a price increase.




                                                            34
discussed in Proposition 7), i.e. the c.d.f. satisfies:

                                                                      2 !(n−3)/2
                                                                                             √ √ 
                                                            
                                  1                              z
      S ′ (z) ≡ s(z) =          n−1   1
                                         √            1−       √                   for z ∈ − n, n   (32)
                         Beta    2
                                    ,2             n              n

for n ≥ 2, and for n = 1 the c.d.f. S has two points with mass 1/2 at −1 and at +1. Now
we are ready to give expressions for the effect of an aggregate shock δ. First consider Φn ,
the fraction of firms that adjust prices. There are f (y)dy firms with state y in the invariant
distribution; among them the fraction S(ν(y, δ)) adjusts. Integrating across all the values
of y we obtain the desired expression. Second, consider Θn , the change in the price level
across all firms. There are f (y)dy firms with state y in the invariant distribution; among
them we consider all the firms with normalized sum of price gaps less than ν(y, δ), for which
                                         √
the fraction s(z)dz adjust prices by δ − y z/n. Considering all the values of y we obtain
the relevant expression. This gives:

Proposition 11.            Consider an aggregate shock of size δ. The fraction of price changes
on impact, Φn , and the average price change across the n goods among all the firms in the
economy, Θn , are given by:
                                      Z       ȳ
                         Φn (δ) =    f (y) S (ν(y, δ)) dy                                            (33)
                                          0
                                            Z ȳ       √ "Z ν(y,δ)         #
                                                        y
                         Θn (δ) = δΦn (δ) −      f (y)      √
                                                                   z s(z)dz dy                       (34)
                                             0         n   − n


where s(·) is given by equation (32) which depends on n, and where f (·) and ν(·), which are
also functions of ȳ and n, are given in equation (30) and equation (31) respectively.

   See Appendix A for the proof. Appendix F gives a closed form solution and the numerical
evaluation of equation (33) and equation (34), and a lemma with the analytical characteri-
zation of Θn and Φn stated in part 3 of Proposition 9.


5.4      Impulse response at horizons t > 0 in the n ≥ 2 case
We develop an expression for the impulse responses at horizon t > 0 for the general case
of n ≥ 1, in particular we derive an expression for the flow impact on the price level at
horizon t which we denote as θn (δ, t). As in the case of one good, we start by describing the
distribution of firms indexed by their price gaps, immediately after the monetary shock δ but
before any adjustment takes place. The cdf Λn (p0 ) gives the fraction of price gaps smaller or
equal to p0 at time zero right after the impact adjustment caused by the monetary shock δ.

                                                            35
Note that Λn (p0 ) ≤ Θn (δ) for all p0 . To understand this expression, let p̃0 ∈ Rn be the price
gap before the monetary shock, which has y = ||p̃0 ||2 distributed according to the density
f (y) described in equation (30). The price gaps with a given value of ||p̃0 ||2 ≡ y ≤ ȳ have
a uniform distribution on the sphere, so its density depends only of ||p̃0 ||2, and integrates
to the area of the sphere with square radius y. The surface area of this sphere is given by
2π n/2 y (n−1)/2 Γ(n/2). Right after the monetary shock these price gaps become p0 = p̃0 − 1n δ,
where 1n is an n dimensional vector of ones. So we have that the density of the distribution
of the price gaps immediately after the monetary shock, but before any adjustment is

                                                                              Γ (n/2)
                          λ(p0 , δ) = f ||p0 + 1n δ||2
                                                                
                                                                                                           (35)
                                                                    2 π n/2   ||p0 + 1n δ||n−1

and recall that f (y) = 0 for any y > ȳ. We note that λ is a function of ȳ and δ, but it is
independent of σ 2 .
   The next step is to find the contribution of those firms with price gap p0 to the change
in aggregate prices at horizon t. As in the case of one good, it suffices to consider the
contribution of those firms that have the first price change exactly at t. This is because all
the subsequent adjustment have a zero net contribution to prices, since after the adjustment
the firm start with a zero price gap. Since firms will adjust a price when the square radius
of the price gap vector first reach ȳ at time t, we use the distribution of the corresponding
hitting times and place in the sphere. In particular let G(p; t, p0 ), the probability that if a
                                                                                    √
firm has a price gap p0 at time zero, it will hit the surface of a sphere of radius ȳ at time
t or before, with a price gap smaller or equal than p. Note that G is a function of σ 2 and
ȳ but it is independent of δ. Explicit expressions for the joint density g of the hitting time
t and place p can be found in Wendel (1980) and Yin and Wang (2009). When the price
                                          √
gap of the firm hits the sphere of radius ȳ with a price gap p, the average change of its n
prices is given by “closing” each of the n price gaps, i.e. the average price change is given by
−(p1 + ... + pn )/n. Thus the contribution to the change in aggregate prices at time t after a
shock δ at time zero is given by
                                      Z
                                                    − (p1 + p2 + ... + pn )
                      Z                                                                   
        θn (δ, t) =                                                         g(p, t, p0) dp λ(p0 , δ) dp0   (36)
                       ||p0 ||2 ≤ȳ    ||p||2 =ȳ             n

Note that the outer integral is computed only for the firms that have not adjusted on impact,
i.e. for the price gaps ||p0 ||2 ≤ ȳ. Given the knowledge of the closed form expressions for
both λ and g we can compute the multidimensional integrals in θn (δ, t) by Monte Carlo.
   We adapt the expression for the density g of hitting times and places in Theorem 3.1 of
Yin and Wang (2009) to the case of a BM with variance σ 2 . Using the expression for the


                                                           36
surface area of an n dimensional sphere into equation (36) we obtain:

Proposition 12. Fix n ≥ 2, then the impulse response can be written as
                                         ∞ X
                                           ∞                                    2
                                                              √                   qm,k n σ 2
                                         X                                                   
                                                                       
              Pn (δ, t) − Θn (δ) =                 em,k δ,        ȳ, n 1 − exp −            t             (37)
                                         m=0 k=1
                                                                                   2 n ȳ

where the coefficients qm,k are the ordered (positive) zeroes of the Bessel function Jm+ n2 −1 (·).
                                                                               √
The coefficients em,k (·, ·, n) are functions homogeneous of degree one in (δ, ȳ) and do not
depend on σ 2 . Furthermore ∞
                                P      P∞
                                   m=0    k=1 em,k (δ, ·, ·) = δ − Θn (δ) ≤ δ.

       See Appendix A for the proof. Using the properties of Θn from Proposition 11, and the
homogeneity property of em,k from Proposition 12, in equation (37) one verifies part 1 and
part 2 of Proposition 9.22
   Figure 4 displays some impulse responses for Pn (δ, ·). The figure uses equation (36) and
is computed by Monte Carlo integration.23 For each firm i we draw a path of the price gap
for a discrete time approximation to the n dimensional BM’s. We stop this path the first
time τi at which ||pi (τi )||2 ≥ ȳ. We then have the following estimate of θn :

                                      K
                                   1 X            − (pi1 (τi ) + pi2 (τi ) + · · · + pin (τi ))
                      θ̂n (δ, t) =       I{τi =t}
                                   K i=1                               n

We obtain an estimate of the value of Pn by adding the corresponding values of θ̂n (δ, s).
  We end this section with a full characterization of the impulse response function in the
limit case in which n → ∞.

Proposition 13. Assume that δ < Std(∆p). We will let n → ∞ adjusting ȳ and σ 2 to
              p
keep Std(∆p) = ȳ/n and Na fixed. Then the fraction of immediate adjusters Φn (δ) →
(δ/Std(∆p))2 , the immediate impact in the price level Θn (δ) → δΦn (δ), and the impulse
response becomes linear, i.e. Pn (δ, t) → Θn (δ) + δ Na t for 0 < t < T ≡ (1 − Φn (δ)) / Na
and Pn (δ, t) → δ for t ≥ T . Furthermore, the average price change across firms at every
0 ≤ t ≤ T is equal to δ.

       See Appendix A for the proof. The proposition shows that when n is large the impulse
response takes a linear form, identical to the exogenous staggering model of Taylor (1980)
  22                                                                                  2
     Note that the coefficient of the exponentials can be written as the product of qm,k /(2 n) and Na t. Table 2
reports the smallest zeroes for each value of m + n/2 − 1.
  23
      In particular we start with a (large number) K of firms whose price gap pi0 are drawn from the distribution
λ(·, δ). For this we first draw y i from√the known distribution f (·), then draw an n dimensional vector Z i of
                                         yi
independent normals and take pi0 = ||Z i || Z i . Alternatively the computations might use equation (37), which
in practice also involves numerical integration.


                                                         37
and to the model of Reis (2006), where the staggering emerges from the optimal choice of
adjustment subject to costly information gathering. The impact effect on the price level is
of the order δ 3 , and hence for small values of δ it is negligible compared to the the impact
for the n = 1 case, i.e. Θn /Θ1 ↓ 0 for δ ↓ 0, as shown in Figure 3. Moreover, Figure 4 shows
that the half life of the shock is (1/2 − (δ/Std(∆p))2 ) /Na , which converges to 1/(2Na ) for
small shocks. In Figure 4, describing a 1% shock in the money supply, the half life is three
times greater than the one produced by the n = 1 case. A main consequence of the large
n is that there is no selection effect. This is to be compared with the case of n = 1 where
the selection effect is strongest and where, in the periods right after the shock (small t), all
price adjustments are price increases. The reason for the lack of selection when n is large is
that for a firm selling many products there are, upon adjustment, many cancellations since
some prices will be increased and others decreased, so that the average price change across
the firms’ good is simply δ.


5.5       On the output effect of monetary shocks
This section discusses how the impulse response for prices are informative about the inter-
pretation, time-profile and size of the output effect of a monetary shock. In the general
equilibrium set-ups discussed at the beginning of this section the deviation of output from its
steady state value is proportional to the deviation of the real balances, δ − Pn (δ, t), as shown
in equation (23) and common to the models of Golosov and Lucas (2007); Caplin and Leahy
(1997); Danziger (1999). From now on we refer to δ − Pn (δ, t) as to the impulse response of
output, which is the expression predicted by our model in the case of log preferences (ǫ = 1).24
   The half life of the output response is identical to the half life of the price level only in
the case in which Θn = 0, i.e. when there is no jump of the price level on impact, a condition
that holds for infinitesimal shocks. When the price level jumps on impact (Θn > 0), the
half-life of the output response is longer than the half-life of the price level. The reason is
that the jump shortens the time required for the price level to reach its half-life value (i.e.
δ/2), whereas the half-life target of the real output effect, given by ( δ − Θn (δ) )/2 shifts, and
so its half life is longer. To picture this effect in Figure 4, notice that different impact levels
(corresponding to e.g. different values of n) do not shift the half-life line (whose position
is at 0.5%), but will shift the half life line of the real-output effect (this line is not drawn
in the figure, it is above 0.5 and shifts up as Θn increases). The impact effect on output
also depends on the size of the shock: on one hand for very large shocks there is full price
flexibility and hence no effect on output regardless of n; on the other hand for small monetary
 24
      If ǫ 6= 1 then the effect on output should be divided by ǫ, as shown in equation (23).



                                                       38
shocks the impact effect on prices is of order smaller than δ, and hence the impact effect on
output is approximately δ for all values of n.
   As a summary statistic of the real effect of monetary shock we use the area under the
impulse response for output, i.e.
                                          Z    ∞
                               Mn (δ) =            (δ − Pn (δ, t)) dt
                                           0


which can be interpreted as the cumulative effect on output following the shock. This measure
combines the size of the output deviations from the steady state with the duration of these
deviations. Since Pn (δ, t) depends only on the parameters Std(∆p) and Na , so does Mn (δ).
Because of the homogeneity of Pn (δ, t) discussed in part 2 of Proposition 9, and the way time
(Na t) enters Pn (δ, t) shown in Proposition 12, we can thus write
                                                                                    
                                            Std(∆p)                    δ
                 Mn ( δ ; Na , Std(∆p ) ) =         Mn                      ; 1, 1        (38)
                                              Na                    Std(∆p)

so that the effect of a shock of size δ in an economy characterized by parameters Std(∆p)
and Na can be readily computed using the “normalized” effect for an economy with unit
parameters and a standardized shock.
   The determinants of the real effects of monetary shocks identified by equation (38) offer
a new insight to measure the degree of aggregate price stickiness in menu cost models. The
previous literature has focused almost exclusively on the frequency of price changes, Na ,
as a measure of stickiness, and hence of the effect of monetary policy. But equation (38)
shows that the dispersion of price changes, Std(∆), is an equally important determinant.
Indeed the area under the impulse response of output is proportional to the ratio of these
two quantities, where the constant of proportionality depends on the (normalized) size of the
monetary shock, δ/Std(∆p) and, in our set-up, on the number of products n.
  Figure 7 illustrates how the real output effect of a monetary shock varies with the size of
the shock (δ) and the number of goods sold by the firm (n). The figure plots the summary
impact measure as a function of δ for an economy with Std(∆p) = 0.10 and Na = 1, for four
values of n. It is shown that for each value of n the cumulative real effect of a monetary
shock is hump-shaped in the size of the shock (δ). The effect is nil at extremes, i.e. at δ = 0
and at 2 Std(∆p) (not shown), as a reflection of the fact that large shocks induce full price
flexibility (see part 3 of Proposition 9). The picture shows that the real effect is maximum
for a shock size δ that is about 1/2 of the standard deviation of prices. More interestingly,
for the purpose of this paper, the size of the real effects varies with the number of goods n.
Larger values of n, i.e. firms selling more goods, produce larger cumulative effects for small


                                                   39
       Figure 7: Cumulative Output effect M(δ) ; Parameters: Na = 1 , Std(∆p) = 0.10

                                                        1.6




               Cumulative “Output” effect M(δ), in %
                                                        1.4




                                                        1.2       n   =   1
                                                                  n   =   2
                                                         1        n   =   10
                                                                  n   =   ∞
                                                        0.8




                                                        0.6




                                                        0.4




                                                        0.2




                                                         0




                                                       −0.2
                                                              0   1        2    3      4        5    6      7        8   9   10
                                                                               monetar y s ho ck δ in p er centage




values of the shock and also larger maximum values of the effect. In this sense the stickiness
of the economy is increasing in n. The maximum cumulative effect on output, in the order
of 1.5% output points, is obtained as n → ∞, a similar value though obtains already for
n = 10. On the other hand, smaller effects are produced in models with n = 1 or n = 2.


6       Concluding remarks
We solved analytically a stylized model of price setting, giving a full characterization of the
steady state predictions as well as of the economy’s aggregate response to a once and for all
unexpected monetary shock. A summary of the main findings was given in the Introduction.
We conclude with a comment on two extensions.
   The problem assumed a zero inflation, that all goods entered symmetrically and that the
shocks to the price gaps of the different goods were uncorrelated. These assumptions deliver
a spherical problem that turns out to be analytically tractable. Appendix E shows that the
zero inflation assumption provide a good approximation to the true rules for inflation rates
that are small relative to the variance of idiosyncratic shocks, an assumption that seems
appropriate for developed economies (see Gagnon (2009); Alvarez et al. (2011) for related
evidence).25 We think that relaxing the independence of the shocks is both interesting and
  25
    We thank Ricardo Caballero, and especially Carlos Carvalho, for suggesting a two dimensional state
representation that may allow a tractable analysis of the problem with high inflation.



                                                                                           40
realistic. We leave these challenging tasks for future work.
    Second, the maximum level of kurtosis for the distribution of price changes predicted by
the model is 3, as in the Normal distribution, obtained for a firm selling a large number
of goods. This value is larger compared to the prediction of the classical Barro’s (1972) or
Dixit’s (1991) menu cost models (where kurtosis is 1), but it is still small compared to the
large excess kurtosis that are measured in micro datasets. Larger values of the kurtosis can
be obtained by introducing the possibility of random adjustment opportunities, as in models
where the size of the menu cost is stochastic. We explore this problem in Alvarez, Le Bihan,
and Lippi (2011) and show that this assumption improves the empirical fit of the model cross
section to the micro data, and it reduces the “selection” effect in the event of a monetary
shock.




References
Abel, Andrew B., Janice C. Eberly, and Stavros Panageas. 2007. “Optimal Inattention to
 the Stock Market.” American Economic Review 97 (2):244–249.
Aliev, Amir F. 2007. “On the smooth-fit principle in Rn .” Russian Mathematical Surveys
  62 (4):781–783.
Alvarez, Fernando, Martin Gonzalez-Rozada, Andres Neumeyer, and Martin Beraja. 2011.
  “From Hyperinflation to Stable Prices: Argentinas evidence on menu cost models.”
  manuscript, University of Chicago.
Alvarez, Fernando E., Herve Le Bihan, and Francesco Lippi. 2011. “A note on price setting
  with a random menu cost.” in preparation, EIEF.
Alvarez, Fernando E., Francesco Lippi, and Luigi Paciello. 2011a. “Monetary shocks with
  information and menu costs.” in preparation, EIEF.
———. 2011b. “Optimal price setting with observation and menu costs.” The Quarterly
 Journal of Economics 126 (4):1909–1960.
Baccarin, Stefano. 2009. “Optimal impulse control for a multidimensional cash manage-
  ment system with generalized cost functions.” European Journal of Operational Research
  196 (1):198–206.
Barro, Robert J. 1972. “A Theory of Monopolistic Price Adjustment.” Review of Economic
  Studies 39 (1):17–26.
Baudry, L., H. Le Bihan, P. Sevestre, and S. Tarrieu. 2007. “What do Thirteen Million Price
  Records have to Say about Consumer Price Rigidity?” Oxford Bulletin of Economics and
  Statistics 69 (2):139–183.

                                              41
Bhattarai, Saroj and Raphael Schoenle. 2010. “Multiproduct Firms and Price-Setting: The-
  ory and Evidence from U.S. Producer Prices.” Working papers, Princeton University.

Bonomo, Marco and Carlos Carvalho. 2004. “Endogenous Time-Dependent Rules and Infla-
  tion Inertia.” Journal of Money, Credit and Banking 36 (6):1015–41.

Caballero, Ricardo J. 1989. “Time Dependent Rules, Aggregate Stickiness And Information
  Externalities.” Discussion Papers 198911, Columbia University.

Caballero, Ricardo J. and Eduardo M.R.A. Engel. 1991. “Dynamic (S, s) Economies.” Econo-
  metrica 59 (6):1659–86.

———. 1993. “Heterogeneity and output fluctuations in a dynamic menu-cost economy.”
 The Review of Economic Studies 60 (1):95.

———. 2007. “Price stickiness in Ss models: New interpretations of old results.” Journal of
 Monetary Economics 54 (Supplement):100–121.

Caplin, Andrew and John Leahy. 1997. “Aggregation and Optimization with State-Dependent
  Pricing.” Econometrica 65 (3):601–626.

Cavallo, Alberto. 2010. “Scraped Data and Sticky Prices.” Tech. rep., MIT Sloan.

Ciesielski, Z. and SJ Taylor. 1962. “First passage times and sojourn times for Brownian
  motion in space and the exact Hausdorff measure of the sample path.” Transactions of the
  American Mathematical Society 103 (3):434–450.

Danziger, Leif. 1999. “A Dynamic Economy with Costly Price Adjustments.” American
 Economic Review 89 (4):878–901.

Dhyne, Emmanuel and Jerzy Konieczny. 2007. “Temporal Distribution of Price Changes:
 Staggering in the Large and Synchronization in the Small.” Working Paper Series 01-07,
 Rimini Centre for Economic Analysis.

Dixit, Avinash. 1991. “Analytical Approximations in Models of Hysteresis.” Review of
  Economic Studies 58 (1):141–51.

Dutta, Shantanu, Mark Bergen, Daniel Levy, and Robert Venable. 1999. “Menu Costs,
 posted prices and multiproduct retailers.” The Journal of Money, Credit and Banking
 31 (4):683–703.

Gagnon, Etienne. 2009. “Price Setting During Low and High Inflation: Evidence from
 Mexico.” Quarterly Journal of Economics 124 (3):1221–1263.

Gertler, Mark and John Leahy. 2008. “A Phillips Curve with an Ss Foundation.” Journal of
 Political Economy 116 (3):533–572.

Golosov, Mikhail and Robert E. Jr. Lucas. 2007. “Menu Costs and Phillips Curves.” Journal
 of Political Economy 115:171–199.


                                           42
Hethcote, H.W. 1970. “Bounds for zeros of some special functions.” Proceedings of the
  American Mathematical Society :72–74.

Karatzas, I. and S.E. Shreve. 1991. Brownian motion and stochastic calculus. Springer-Verlag.

Karlin, S. and H.M. Taylor. 1981. A second course in stochastic processes, vol. 2. Academic
 Pr.

———. 1999. A second course in stochastic processes. Academic press.

Khokhlov, VI. 2006. “The Uniform Distribution on a Sphere in RS . Properties of Projections.
 I.” Theory of Probability and its Applications 50:386.

Kolkiewicz, A.W. 2002. “Pricing and hedging more general double-barrier options.” Journal
 of Computational Finance 5 (3):1–26.

Lach, Saul and Daniel Tsiddon. 1992. “The Behavior of Prices and Inflation: An Empirical
  Analysis of Disaggregated Price Data.” The Journal of Political Economy 100 (2):349–389.

———. 1996. “Staggering and Synchronization in Price-Setting: Evidence from Multiproduct
 Firms.” The American Economic Review 86 (5):1175–1196.

———. 2007. “Small price changes and menu costs.” Managerial and Decision Economics
 28 (7):649–656.

Midrigan, Virgiliu. 2007. “Menu Costs, Multi-Product Firms, and Aggregate Fluctuations.”
 CFS Working Paper Series 2007/13, Center for Financial Studies.

———. 2011. “Menu Costs, Multi-Product Firms, and Aggregate Fluctuations.” Economet-
 rica, 79 (4):1139–1180.

Neiman, Brent. 2010. “Stickiness, synchronization, and passthrough in intrafirm trade
  prices.” Journal of Monetary Economics 57 (3):295–308.

Øksendal, Bernt K. 2000. Stochastic differential equations: an introduction with applications.
 Sixth Edition, Springer Verlag.

Pasten, Ernesto. 2012. “Rational Inattention, Multi-Product Firms and the Neutrality of
  Money.” Working paper, Central Bank of Chile.

Reis, Ricardo. 2006. “Inattentive producers.” Review of Economic Studies 73 (3):793–821.

Sheshinski, Eytan and Yoram Weiss. 1977. “Inflation and Costs of Price Adjustment.” Review
  of Economic Studies 44 (2):287–303.

———. 1992. “Staggered and Synchronized Price Policies under Inflation: The Multiproduct
 Monopoly Case.” Review of Economic Studies 59 (2):331–59.

Song, D. and A. K. Gupta. 1997. “Lp-Norm Uniform Distribution.” Proceedings of the
  American Mathematical Society 125 (2):595–601.


                                             43
Stokey, Nancy L. 2008. Economics of Inaction: Stochastic Control Models with Fixed Costs.
  Princeton University Press.

Taylor, John B. 1980. “Aggregate Dynamics and Staggered Contracts.” Journal of Political
  Economy 88 (1):1–23.

Tsiddon, D. 1993. “The (mis) behaviour of the aggregate price level.” The Review of Eco-
  nomic Studies 60 (4):889.

Wendel, J.G. 1980. “Hitting spheres with Brownian motion.” The annals of probability
 :164–169.

Wulfsberg, F. 2010. “Price adjustments and inflation-evidence from Norwegian consumer
 price data 1975-2004.” Working paper, Bank of Norway.

Yin, C. and C. Wang. 2009. “Hitting Time and Place of Brownian Motion with Drift.” The
  Open Statistics and Probability Journal 1:38–42.



A      Proofs

Lemma 1.       The origin is the optimal return point.
Proof. (of Lemma 1 ) By contradiction, suppose that it is not and assume without loss
of generality that t = 0 is a period where an adjustment takes place and that p̂i > 0.
Call this “policy A”. Then, consider an alternative plan where p̂′i = 0 and where I ′ =
I + {(0, 0, ..., −p̂i, ..., 0)} so that the next adjustment happens exactly with the probabilities
dictated by policy A. Letting τ be the next stopping time, then for 0 ≤ t ≤ τ we have
E0 [||p(t)||2 ] = E0 [||p(t)′ ||2] + p̂2i , and thus setting p̂i > 0 shows that policy A is not optimal.

Proof. (of Proposition 2 ) Notice that v ′ (0) = β1 and that v(0) = β0 , so that we require
β1 > 0, which implies β0 > 0. Moreover, if β1 > B/r then v is strictly increasing and strictly
convex. If β1 = B/r then v is linear in y. If 0 < β1 < B/r, then v is strictly increasing at
the origin, strictly concave, and it reaches its unique maximum at a finite value of y. Thus,
a solution that satisfies smooth pasting requires that 0 < β1 < B/r, and the maximizer is ȳ.
In this case, y = 0 achieves the minimum in the range [0, ȳ]. Thus we have verified i), ii) and
iii).
     Next we prove uniqueness. Let βi (β1 ) be the solution of equation (15), as a function of β1 .
Note that for 0 < β1 < B/r, all the βi (β1 ) < 0 for i ≥ 2 and are increasing in β1 , converging
to zero as β1 goes to B/r. Smooth pasting can be written as
                                                   ∞
                                                   X
                                        ′
                               0 = v (ȳ; β1 ) ≡          i βi (β1 ) ȳ i−1 ,
                                                    i=1

where the notation emphasizes that all the βi can be written as a function of β1 . From the
properties of the βi (·) discussed above it follows that we can write the unique solution of

                                                  44
0 = v ′ (ρ̄(β1 ); β1 ) as a strictly increasing function of β1 , i.e. ρ̄′ (β1 ) > 0. The value matching
condition at ȳ gives:
                                                                       ∞
                                                                       X
                ψ = v(ȳ, β1 ) − v(0, β1 ) = v(ȳ, β1 ) − β0 (β1 ) =         βi (β1 ) ȳ i .
                                                                       i=1

We note that, given the properties of βi (·) discussed above, for any given y > 0 we have that
v(y, β1) − β0 (β1 ) is strictly increasing in β1 , as long as 0 < β1 < B/r. Thus, define
                                                             ∞
                                                             X
                    Ψ(β1 ) = v(ρ̄(β1 ), β1 ) − v(0, β1 ) =         βi (β1 ) ρ̄(β1 )i .
                                                             i=1

From the properties discussed above we have that Ψ(β1 ) is strictly increasing in β1 and that
it ranges from 0 to ∞ as β1 ranges from 0 to B/r. Thus Ψ is invertible. The solution of the
problem is given by setting: β1 (ψ) = Ψ−1 (ψ) and ȳ(ψ) = ρ̄(β1 (ψ)) .

Proof. (of Proposition 3) We establish the following properties of V (p) = v(y):

         only depends on the absolute value of the prices, since for all p ∈ Rn : v ( ni=1 p2i ) =
                                                                                     P
   1. It P
      v ( ni=1 |pi |2 ) for all p ∈ Rn .
                                                      Pn 2
   2. The range of inaction is given by I = {p ∈ Rn     i=1 pi < ȳ}.

   3. It solves
         Pn the     ODE given by equationPn (3).2 This2 can ′ bePseen  by computing: Vi (p) =
       ′        2                     ′′                         n    2
      v ( i=1 pi ) 2pi and Vii (p) = v ( i=1 pi ) (2pi ) + v ( i=1 pi ) 2 , replacing this into
      the ODE equation (3) we obtain the ODE equation (10), which v solves by hypothesis.

   4. It satisfies value matching equation (4), which is immediate since it satisfied the value
      matching condition for v given in equation (11).

   5. It satisfies smooth pasting equation (6). Using the form of the solution for v, namely:
                                                              j−1
      Vi (p) = v ′ ( ni=1 p2i ) 2 pi = nj=1 βj j ( nk=1 p2k )
                    P                 P           P
                                                                  2 pi . Using that v satisfies smooth
                                                       2 j−1
                                    Pn          Pn
                                                                for any p with nk=1 p2k = ȳ, which
                                                                                 P
      pasting we have: 0 = j=1 βj j ( k=1 pk )
      establishes that Vi (p) = 0 for all i = 1, .., n and for any p ∈ ∂I.

   6. It satisfies optimality of the origin as return point, as given by equation (5). Direct
                                                                                 j−1
      computation gives: Vi (p) = v ′ ( ni=1 p2i ) 2 pi = nj=1 βj j ( nk=1 p2k )
                                         P                 P          P
                                                                                     2 pi which
      equals zero when evaluated at p = 0. Notice also that Vii (0) = 2 β1 > 0 for all i =
      1, ..., n and Vij (0) = 0 , thus, p = 0 is a local minimum.

    In Appendix C we show that a function V (p) with these properties is a strong solution
to the variational inequality of the problem, and hence it is the value function.

Proof.    (of Proposition 4 ) Using the expression for {βi } obtained in Proposition 1 value




                                                  45
matching and smooth pasting can be written as two equations in β2 and ȳ:
                               "                                ∞
                                                                               #
                    B            2σ 2 (n + 2)                  X
              ψ =      ȳ + β2                ȳ + ȳ 2 + ȳ 2     κi r i ȳ i
                     r                 r                       i=1
                               "                                 ∞
                                                                                        #
                                    2
                    B            2σ (n + 2)                     X
              0 =      ȳ + β2                ȳ + 2ȳ 2 + ȳ 2     κi (i + 2) r i ȳ i
                     r                 r                        i=1

                          Qi
where κi = r −i ββ2+i
                   2
                      =                1
                           s=1 σ2 (s+2)(n+2s+2) .   This gives an implicit equation for ȳ:

                                              2σ2 (n+2)
                           "                                                                        #
                                                        ȳ + ȳ 2 + ȳ 2 ∞          i i
                                                                         P
                       B                           r                        i=1 κi r ȳ
                   ψ =   ȳ 1 −        2σ2 (n+2)
                                                                                                        (39)
                       r                           ȳ + 2ȳ 2 + ȳ 2 ∞
                                                                    P                    i
                                            r                           i=1 κi (i + 2) r     ȳ i

Since the right hand side of equation (39) is strictly increasing in ȳ, and goes from zero
to infinity, then we obtain Part (i). Since the right hand side of equation (39) is strictly
decreasing in n, and goes to zero as n → ∞, then we obtain Part (ii).
    Rearranging this equation and defining z = ȳ r/σ 2
                                       P∞                i−1
                                                                    P∞                  i
                                         i=1 ωi (i + 1) z P− 2 −
                                                                                         
    ψ 2(n + 2) 2      2    3 2(n + 2)                                  i=1 ωi (i + 2) z
                 r =z +z                                                                    (40)
        Bσ 2                           2(n + 2) + 2z + z ∞   i=1 ωi (i + 2) z
                                                                              i


where ωi = is=1 (s+2)(n+2s+2)
                       1
                               . Using the expression for ωi and co llecting terms on z i one
          Q

can show
    p that the square bracket of equation        (40) that multiplies z 3 is negative, and hence
ȳ > ψ 2(n + 2)σ /B. Letting b = ψr 2(n + 2)/(Bσ 2 ) we can write equation (40) as:
                 2                      2


                           2(n + 2) ∞
                                                                 P∞
            z2                                        i−1                            i
                                 P
                                      i=1 ωi (i + 1) z P− 2 −
                                                                                       
                                                                    i=1 ωi (i + 2) z
         1=      1+z                                                                        (41)
             b                     2(n + 2) + 2z + z ∞    i=1 ωi (i + 2) z
                                                                           i


Since z ↓ 0 as b ↓ 0, then z 2 /b ↓ 1 as b ↓ 0, establishing Part (iii). Inspection of equation (41)
reveals that as b ↑ ∞, then z 2 /b ↑ ∞ since the term in the round parenthesis that multiplies
z 2 /b on the right hand side goes to zero. Let Ω(z) denote this term. Taking logs on both
                                                                                  h                i−1
                                                                          ∂ log z       ∂ log Ω(z)
sides of equation (41) and differentiating with respect to b gives ∂ log b = 2 + ∂ log z               .
Noting that Ω(z) > 0 and that it is decreasing in z implies that the elasticity is ∂∂ log     z
                                                                                          log b
                                                                                                is
increasing in b. This establishes Part (iv). From equation (40) it is clear that the optimal
                           2   ψ
threshold satisfies ȳ = σr Q Bσ    2
                                 2 r , n . Differentiating this expression we obtain Part (v).



Proof. (of Proposition 6 ) The proof uses probability theory results on the first passage time
of an n-dimensional brownian motion by Ciesielski and Taylor (1962), and a characterization
of the zeros of the Bessel function by Hethcote (1970). Let τ be the stopping time defined
by the first time when ||p(τ )||2 reaches the critical value ȳ, starting at ||p(0)|| = 0 at time
zero. Let Sn (t, ȳ) be the probability distribution for times t ≥ τ , alternatively let Sn (·, ȳ) be




                                                      46
the survival function. Theorem 2 in Ciesielski and Taylor (1962) shows that for n ≥ 1:
                    ∞           2                                         ν−1
                                  qn,k 2                                  qn,k
                                          
                    X                                          1
      Sn (t, ȳ) =     ξn,k exp −      σ t , where ξn,k = ν−1                        .                                             (42)
                   k=1
                                   2ȳ                   2    Γ(ν + 1) J ν+1 (qn,k )


where Jν (z) is the Bessel function of the first kind, where ν = (n − 2)/2, where qn,k are the
positive zeros of the Bessel function Jν (z), indexed in ascending order according to k, and
where Γ is the gamma function. The hazard rate is then given by:
                                                                                      2
                                1      ∂Sn (t, ȳ)                                   qn,1 σ2
           hn (t, ȳ) = −                          , with asymptote lim hn (t, ȳ) =         .                                     (43)
                            Sn (t, ȳ)    ∂t                        t→∞                2 ȳ

Hethcote (1970) provides a lower bound for the zeroes of the Bessel function qn,k for n ≥ 2,
                   2           2
       2
given qn,k > k − 41 π 2 + n2 − 1 .

Proof. (of Proposition 7 ) We first establish the following Lemma.

Lemma 2.     Let z be distributed uniformly on the surface of the n-dimensional sphere of
radius one. We use x for the projection of z in any of the dimension, so zi = x ∈ [−1, 1].
The marginal distribution of x = zi has density:
                R∞                                    2       2 )]
                        s(n−3)/2 e−s/2        /[2(1−x
                                         e−sx √                         s1/2                   Γ(n/2)
     fn (x) =   0    2(n−1)/2 Γ[(n−1)/2]        2π                   (1−x2 )3/2
                                                                                   ds =   Γ(1/2) Γ[(n−1)/2]
                                                                                                            (1     − x2 )(n−3)/2

where the Γ function makes the density integrate to one.
    This lemma is an application of Theorem 2.1, part 1 in Song and Gupta (1997), setting
p = 2, so it is euclidian norm, and k = 1 so it is the marginal of one dimension. We give a
simpler proof below. Now we consider the case where the sphere has radius different from
                                                     √     √
one. Let p ∈ ∂I, then p = Pnp p2 ȳ = √Ppn 2 ȳ = z ȳ where z is uniformly distributed
                                 i=1 i        i=1 pi
                                                                                          √
in the n dimensional sphere of radius one. Thus each pi has the same distribution than x ȳ.
Using the change of variable formula we obtain the required result.
    Part 2 of Theorem 2.1 in in Song and Gupta (1997) shows that if x the marginal of a
uniform distributed vector in the surface of the n-dimensional sphere, then x2 is distributed
as a Beta( 21 , n−1
                 2
                    ). If y is distributed as a Beta(α, β) then it has E(y) = α/(α + β) and
    2
E(y ) = (α + 1)/(α + β + 1)E(y). Using these expressions for α = 1/2 and β = (n − 1)/2 we
obtain the results for the standard deviation of ∆pi and its kurtosis. For the expected value
of the absolute value of price changes we note that

                                             R √ȳ
                                                                             2 (n−3)/2                        √
                                2                                        ∆p                                         ȳ
        E[|∆pi |] =     Beta(
                                                     ∆pi 1 −             √i                  d∆pi =
                                n−1 1
                                 2
                                   ,2    )    0                           ȳ                              n−1
                                                                                                           2
                                                                                                                Beta( n−1
                                                                                                                       2
                                                                                                                          , 21 )


where we use equation (21) for the density w(·) and, in the last equality, the following result:

                                                                      (n−1)/2                     b
                                    b
                                                            (1 − x2 )
                             Z
                                             2 (n−3)/2
                                              
                                        x 1−x          dx =                                           .
                                a                               1−n
                                                                                                  a



                                                                     47
Then, using the fundamental property of the Gamma function, we have

                                            Γ n2                Γ n2
                                                                    
                       1
                n−1
                                   = n−1                 =
                    Beta n−1 , 21         Γ n−1             Γ n+1
                                                                 
                 2        2            2     2
                                                   Γ(1/2)      2
                                                                    Γ(1/2)

Thus                                                 √                              n
                                                                                        
                                               ȳ          √               Γ        2
                       E[|∆pi |] =   n−1          n−1 1
                                                         = ȳ           n+1
                                                                                
                                      2
                                           Beta 2 , 2          Γ          2
                                                                                    Γ(1/2)
                                                                                                 q √
                                                                                Γ( n
                                                                                   2)             2    n+1/2
We can approximate these ratio of Gamma functions as                      Γ( n+1
                                                                                             ≈                 from
                                                                              2 )
                                                                                  Γ(1/2)          π     n
which we obtain our expression.
    For Std ( |∆pi | ) / E ( |∆pi | ) we use that, given the symmetry around zero we have:
                                    r                    s                      2
                q       2
                                                 2          n−1
                                                                 Beta( n−1 , 21 )
                                                                                           q
Std( |∆pi | )      E[∆pi ]             Std(∆pi )                                             π  2n
                                                                                                    
 E( |∆pi | )
              =   E[|∆pi |] 2 − 1 =    E[|∆pi |]
                                                    − 1 =     2
                                                                   √
                                                                     n
                                                                        2
                                                                                     − 1 ≈   2 1+2n
                                                                                                      −1


    For the convergence of ∆pi /Std(∆pi ) to a normal, we show that y = x2 n converges to a
chi-square distribution with 1 d.o.f., where x is the marginal of a uniform distribution in the
surface of the n-dimensional sphere. The p.d.f of y ∈ [0, n], the square of the standardized
               Γ( n )              (n−3)/2 y −1/2
x, is n Γ n−12 Γ 1 1 − ny                            , and the p.d.f. of a chi-square with 1 d.o.f. is
            ( 2 ) (2)                        n
exp(−y/2) y   −1/2
    √
      2 Γ( 12 )
                     . Then, fixing y, taking logs in the ratio of the two p.d.f.’s, and taking the limit
                                      √
                                   2)
                                Γ( n    2
as n → ∞, using that Γ n−1             √ → 1 as n → ∞ we obtain that the ratio of the two p.d.f.’s
                                ( 2 ) n
converges to one.

Proof. (of Proposition 10 ) The forward Kolmogorov equation is:

                      1 ∂2  √ 2             ∂     2
                                                            
                   0=        [2σ y] f (y)   −    nσ   f (y)   for y ∈ (0, ȳ) ,                                (44)
                      2 ∂y 2                  ∂y
with boundary conditions:
                                       Z       ȳ
                                  1=                f (y) dy and f (ȳ) = 0 .                                  (45)
                                           0

The first boundary conditions ensures that f is a density. The second is implied by the fact
that when the process reaches ȳ it is returned to the origin, so the mass escapes from this
point. Equation (45) implies the second order ODE: f ′ (y)( n2 − 2) = yf ′′(y). The solution of
this ODE for n 6= 2 is f (y) = A1 y n/2−1 + A0 for two constants A0 , A1 to be determined using
                                                                      A1
the boundary conditions equation (45): 0 = A1 (ȳ)n/2−1 + A0 , 1 = n/2   (ȳ)n/2 + A0 ȳ. For n = 2
the solution is f (y) = −A1 log(y) + A0 subject to the analogous conditions. Solving for the
coefficients A0 , A1 gives the desired expressions.

Proof. (of Proposition 11) The only result to be established is that the distribution of
the sum of the coordinates of a vector uniformly distributed in the n−dimensional sphere

                                                           48
has density given by equation (32). Using the result in page 387 of Khokhlov (2006), let
c : R → R be measurable, and let L be the Lebesgue measure in n dimensional sphere, then

                                                   2π (n−1)/2 1 √ 
            Z                                                Z
                          c(x1 + ... + xn )dL(x) =     n−1        c nu (1 − u2 )(n−3)/2 du
                n
             x∈R ,||x||=1                           Γ(  2
                                                           )   −1
                                   √
                                                              2 (n−3)/2
                                                                !
                                     n    √                              √ 
                  2π n/2
                                                     √      
                                                          nu
                                Z
        = √          1
                        n−1           c    nu   1 −    √               d  nu
              n Γ 2 Γ( 2 ) −√n                            n

Consider a function c(x1 + · · · + xn ) = 1 if α ≤ x1 + · · · + xn ≤ β. Dividing by the surface
area of the n−dimensional sphere we obtain the desired result in equation (32).              

Proof. (of Proposition 12) We use the expression (3.1) in Theorem 3.1 of Yin and Wang
(2009) into equation (36) to obtain for n ≥ 3:
                            ∞ X
                              ∞                                            2
                            X                          √            2 −
                                                                          qm,k
                                                                               n σ2
                                                                                    t
             θn (δ, t) =                    ̺m,k (δ,        ȳ, n) σ e     2n    ȳ     where                                        (46)
                            m=0 k=1
             √                                                                                 √
                                            Z                                                           
                                                            (p1 + p2 + ... + pn )
                            Z
  ̺m,k (δ,       ȳ, n) =                                                         ̟m,k (p, p0 , ȳ, n) dp λ(p0 , δ) dp0
                             ||p0 ||2 ≤ȳ      ||p||2 =ȳ            n

where ̟m,k are given by
                                                                            n                                                            
                                                                                −1                                        ||p||
                  √                Γ( n2 − 1) (m +             n
                                                               2
                                                                   − 1) Zm2          (cos (∠p0p0 )) qm,k Jm+ n2 −1       ||p0 ||
                                                                                                                                   qm,k
     ̟m,k (p, p0 , ȳ, n) =                                         n       n             n
                                                               2 π 2 ||p|| 2 +2 ||p0|| 2 −1 Jm+
                                                                                             ′
                                                                                                n
                                                                                                  −1 (qm,k )
                                                                                                   2

           ν
where Zm     (x) are the Gegenbauer polynomials of degree m and ν, where ∠p0p0 ≡ (p · p0 ) / (||p|| ||p0||)
is the angle between p0 and p, where qm,k is the k-th (ordered) zero of the Bessel function
                            ′
Jm+ n2 −1 (·), and where Jm+  n
                                −1 (·) is the derivative of the Bessel function. The expression in
                              2
Proposition 12 follows from integrating the right hand side of equation (46) with respect to
                                                          √                √            2
t, and thus the coefficients em,k are given by em,k (δ, ȳ, n) = ̺m,k (δ, ȳ, n) ȳ 2/ qm,k . Using
this expression, it is immediate that the homogeneity of degree one of em,k (·, n) is equivalent
to the homogeneity of degree −1 of ̺m,k (·, n). To show this homogeneity we first prove two
                                   √
properties: i) Writing λ (p0 , δ, ȳ), where we include ȳ as an argument, since it is an argu-
                                                                                             √
ment of f , see equation (30). Direct computation on equation (35) gives λ (p0 , aδ, a ȳ) =
             √
λ (p0 /a, δ, ȳ) /an+1 for any a > 0. ii) Direct computation on ̟m,k gives the following:
                √                           √
̟m,k (p, p0 , a ȳ, n) = ̟m,k (p/a, p0 /a, ȳ, n)/an+1 for any a > 0. Using i) and ii) into the
expression for ̺m,k and the change of variables p′0 = p0 /a and p′ = p/a, and that the deter-
minant of the Jacobian in each of the two integrals is an , we obtain the desired result, i.e.
the −1 homogeneity of ̺m,k .
    The derivation of the results for n = 2 follows exactly the same steps but it uses the
expression (3.2) in Theorem 3.1 of Yin and Wang (2009) into equation (36). Appendix F.4
displays the exact expressions.                                                                  

Proof. (of Proposition 13). Let ỹ ≡ y/ȳ be the initial values under the invariant distribution
f displayed in equation (30), and let ỹ(δ) be value that correspond to the same price gaps

                                                                     49
right after the monetary shock but before any adjustment has taken place. Thus for ỹ
there is a price gap vector p for which ỹ = ||p||2/ȳ and hence for this price gap vector
ỹ(δ) = ||p − δ1n ||2 /ȳ. Take a value of y ∈ (0, ȳ), developing the square in the expression for
                                                                                     √
the corresponding value of ỹ(δ), multiplying and dividing the second term by y, and using
the definition of ỹ we have:
                             r Pn                                    Pn
                                y    i=1 pi 1    n 2                   i=1 pi 1    n
                                                                p
             ỹ(δ) = ỹ − 2δ         √     √ + δ = ỹ − 2δ ỹ √              √ + δ2
                                ȳ     y     ȳ ȳ                       y     ȳ ȳ
                   p
Using Std(∆p) =     ȳ/n we write:
                                          Pn                           2
                                            i=1 pi 1     1           δ
                                   p
                 ỹ(δ) = ỹ − 2δ       ỹ   √     √           +                               (47)
                                              y     n Std(∆p)     Std(∆p)

Conditional on ỹ, we can regard ỹ(δ) as a random variable, whose realizations correspond to
each of the price gaps with ||p||2/ȳ = ỹ, and where the price gaps p are uniformly distributed
on
Pn the sphere with square radius y. Proposition 11 gives the density of the random variable
      pi
  i=1
  √
    y
         , and using Proposition 7 it follows that for all n its standard deviation is equal to one
                                                Pn
                                                     pi 1
and its expected value equal to zero. Thus       i=1
                                                 √
                                                   y
                                                       √
                                                         n
                                                             have expected value equal to zero and
variance 1/n. Hence
                                                                   2
                                                             δ
                                   lim ỹ(δ) = ỹ +                                           (48)
                                   n→∞                    Std(∆p)
where the convergence to a (degenerate) random variable is on distribution.
    Proposition 10 shows that as n → ∞ the distribution of ỹ converges to a uniform
distribution in [0, 1]. Combining this result with equation (48) for each ỹ ∈ [0, 1], we
obtain
      that the distribution    of ỹ(δ) converges to a uniform distribution in the interval
           2              2 
      δ                δ
   Std(∆p)
              , 1 + Std(∆p)     . Immediately after the monetary shock any firm with y > ȳ,
or equivalently any firm with ỹ(δ) > 1, adjust its prices. From here we see that the fraction
of firms that adjusts immediately after the shock, denoted by Φn , converges to (δ/Std(∆p))2 .
     To characterize Pn for t ≥ 0 we establish three properties: i) the expected price change
conditional on adjusting at time t = 0 is equal to δ, ii) the fraction of firms that adjusts for
the first time after the shock between 0 and t < [δ − Θn (δ)] / [δ Na ] equals Na t, and iii) the
expected price change conditional on adjusting at time 0 ≤ t < [δ − Θn (δ)] / [δ Na ] is equal
to δ. To establish i), note that, as argued above, as n → ∞ firms adjust its price if and
only if they have a price gap p before the monetary shock with square radius larger than
1 − (δ/Std(∆p))2 . Since in the invariant distribution price gaps are uniformly distributed
on each of the spheres, the expected price change across the firms with the same value of y
equals to δ. To establish ii) note that, keeping constant Na as n becomes large, the law of
motion for ỹ in equation (20) converges to a deterministic one, namely ỹt = ỹ0 + Na t. This,
together with the uniform distribution for ỹ0 implies the desired result. Finally, iii) follows
from combining i) and ii).                                                                     




                                                 50
ADDITIONAL MATERIAL
(NOT FOR PUBLICATION)



Price setting with menu cost
for multi-product firms

Fernando Alvarez and Francesco Lippi

March 8, 2012
B     General Equilibrium Set-Up
This appendix outlines the general equilibrium set-up that underlies our approximation. The
preferences of the representative agents are given by:
                         Z ∞                                      
                              −rt                             m(t)
                             e      U (c(t)) − α ℓ(t) + log            dt               (49)
                          0                                   P (t)

where c(t) is an aggregate of the goods produced by all firms, ℓ(t) is the labor supply, m(t)
the nominal quantity of money, and P (t) the nominal price of one unit of consumption,
formally defined below (all variables at time t). We will use U(c) = (c1−ǫ − 1)/(1 − ǫ). There
is a unit mass of firms, index by k ∈ [0, 1], and each of them produces n goods, index by
i = 1, ..., n. There is a preference shock Ak,i (t) associated with good i produced by firm k
at time t, which acts as a multiplicative shifter of the demand of each good i. Let ck,i (t) be
the consumption of the product i produced by firm k at time t. The composite Dixit-Stiglitz
consumption good c is
                                                                                     η
                                           n
                                  "Z                                     !        # η−1
                                       1   X             1         η−1
                         c(t) =                  Ak,i(t) ck,i(t)
                                                         η          η        dk              (50)
                                   0       i=1

     For firm k to produce yk,i(t) of the i good at time t requires ℓk,i(t) = yk,i(t)Zk,i(t) units
of labor, so that W (t)Zk,i(t) is the marginal cost of production. We assume that Ak,i (t) =
Zk,i(t)η−1 so the (log) of marginal cost and the demand shock are perfectly correlated. We
assume that Zk,i(t) = exp (σWk,i(t)) where Wk,i are standard BM’s, independent across all
i, k.
     The budget constraint of the representative agent is
        Z ∞       "                                               Z 1X                     #
m(0)+        Q(t) Π̄(t) + τ (t) + (1 + τℓ )W (t)ℓ(t) − R(t)m(t) −         Pk,i (t)ck,i(t)dk dt = 0
        0                                                                         0   i=1
                                                       R            
                                                            t
where R(t) is the nominal interest rates, Q(t) = exp − 0 R(s)ds the price of a nominal
bond, W (t) the nominal wage, τ (t) the lump sum nominal transfers, τℓ a constant labor
subsidy rate, and Π̄(t) the aggregate (net) nominal profits of firms.
   The first order conditions for the household problem are (with respect to ℓ, m, c, ck,i):

                  0 = e−rt α − λ0 (1 + τℓ )Q(t)W (t)
                             1
                  0 = e−rt       − λ0 Q(t)R(t)
                           m(t)
                  0 = e−rt c(t)−ǫ − λ0 Q(t)P (t)
                  0 = e−rt c(t)−ǫ c(t)1/η ck,i(t)−1/η Ak,i(t)1/η − λ0 Q(t)Pk,i(t)

where λ0 is the Lagrange multiplier of the agent budget constraint. If the money supply




                                                     1
follows m(t) = m(0) exp (µt), then in an equilibrium
                  1                                               α
      λ0 =               and for all t : R(t) = r + µ , W (t) =        (r + µ)m(t)                                       (51)
             (µ + r)m(0)                                        1 + τℓ

Moreover the foc for ℓ and the one for c give the output equation

                                                                 α P (t)
                                              c(t)−ǫ =                                                                   (52)
                                                               1 + τℓ W (t)

    From the household’s f.o.c. of ck,i(t) and ℓ(t) we can derive the demand for product i of
firm k, given by:                                                   −η
                                         1−ǫη             α Pk,i(t)
                         ck,i (t) = c(t)      Ak,i(t)                                   (53)
                                                        1 + τℓ W (t)
    In the impulse response analysis of Section 5 we assume µ = 0, τℓ = 0, and that the initial
value of m(0) is such that m(0)/P (0), computed using the invariant distribution of prices
charged by firms, is different from its steady state value.
    The nominal profit of a firm k from selling product i at price Pk,i, given the demand shock
is Ak,i , marginal cost is Zk,i , nominal wages are W and aggregate consumption c, is (we omit
the time index):
                                                                      −η
                                       1−ǫη                α Pk,i
                                   c          Ak,i                           [Pk,i − W Zk,i]
                                                         1 + τℓ W
                                           1−η
or, collecting W Zk,i and using that Ak,i Zk,i = 1, gives
                                                                   −η                 
                                   1−ǫη         α     Pk,i                   Pk,i
                              Wc                                                   −1
                                              1 + τℓ W Zk,i                 W Zk,i

so that the nominal profits of firm k from selling product i with a price gap pk,i is
                                                                                  −η                              
                1−ǫη                                                  α      η           −η pk,i             η
   W (t) c(t)          Π(pk,i(t)) where Π(pk,i) ≡                                        e          epk,i       −1
                                                                    1 + τℓ η − 1                            η−1

where we rewrite the actual markup in terms of the price gap pk,i, defined in equation (22), i.e.
  Pk,i
W Zk,i
       = epk,i η−1
                η
                   . This shows that the price gap pk,i is sufficient to summarize the value of prof-
its for product i. Note also that, by simple algebra, Π(pk,i )/Π(0) = e−η pk,i [1 + η epk,i − η],
which we use below.
     Next we show that the ideal price index P (t), i.e. the price of one unit of the composite
good, can be fully characterized in terms
                                        R1P of the price gaps. Using the definition of total expen-
diture (omitting time index) P c = 0 ni=1 (Pk,i ck,i ) dk, replacing ck,i from equation (53),
and using the first order condition with respect to c to substitute for the c−ǫ term, gives
                                                                                       1
                                                                                    ! 1−η
                                                         1    n         1−η
                                                                   Pk,i
                                                 Z           X
                                 P =W                                         dk                                         (54)
                                                     0       i=1
                                                                  W Zk,i


                                                                  2
which is the usual expression for the ideal price index, and can be written in terms of the
                  P
price gaps using W Zk,ik,i = epk,i η−1
                                    η
                                       .

B.1     The firm problem
We assume that if firm k adjusts any of its n nominal prices at time t it must pay a fixed
cost equal to ψℓ units of labor. We express these units of labor as a fraction ψ of the steady
state frictionless profits from selling one of the n products, i.e. the dollar amount that has to
be paid in the event of a price adjustment at t is ψℓ W (t) = ψ W (t)c̄1−ηǫ Π(0). To simplify
notation, we omit the firm index k in what follows, and denote by p the vector of price gaps
and by pi its i − th component.
    The time 0 problem of a firm selling n products that starts with a price gap vector p
is to choose {τj , ∆pi (τj )}∞
                             j=1 to minimize the negative of the expected discounted (nominal)
profits net of the menu cost (the signs are chosen so that the value function is comparable
to the loss function in equation (1)):
               "Z             n
                                                          !     ∞
                                                                                           #
                   ∞         X                                  X
           −E        e−rt        W (t) c(t)1−ǫη Π (pi (t)) dt −    e−rτj W (t) ψℓ p(0) = p
                 0            i=1                                                   j=1


Letting Π̂(pi ) ≡ Π(pi )/Π(0), and using that equilibrium wages are constant W (t)/W̄ = eδ ,
and using the parameterization of fixed cost in terms of steady state profits: ψℓ = ψ c̄1−ηǫ Π(0)
gives (where bars denote steady state values):
                            "Z           n
                                                            !      ∞
                                                                                         #
                                ∞       X                         X
  V0 ≡ −W̄ eδ c̄1−ǫη Π(0) E       e−rt      S (c(t), pi (t)) dt −     e−rτj ψ p(0) = p       (55)
                                        0               i=1                                  j=1


s.t. equation (2), ∆pi (τj ) ≡ limt↓τj pi (t) − limt↑τj pi (t) for all i ≤ n and j ≥ 0, and where
                                c 1−ηǫ                             c 1−ηǫ
                S(c, pi ) ≡                   Π̂ (pi ) =                         e−η pi [1 + η epi − η] .
                                   c̄                                c̄
Expanding S(c, pi ) around c = c̄, pi = 0 and using that:

              ∂S(c, pi )                ∂ 2 S(c, pi )                     ∂ 2 S(c, pi )
                                   =                            =0,                                    = η(1 − η)
                ∂pi        pi =0           ∂pi ∂c       pi =0               ∂pi ∂pi       pi =0,c=c̄




                                                                3
into equation (55), we obtain:
                                                     
                                        1−ηǫ      δ        1
            V0 = W̄ Π(0) c̄                       e × V0 −
                                                           r
                                   ∞                                              2                                  3 !
                                                  c(t) − c̄ 1
                                                                  
                                                                      c(t) − c̄
                                                                                                      
                                                                                        1                 c(t) − c̄
                           Z
       − (1 − ǫη)                      e−rt                + ηǫ                        − ηǫ(1 + ηǫ)                          dt
                               0                      c̄    2             c̄            6                     c̄
              "Z                                            n
                                                                            !              #
                       ∞
                           −rt (2η        − 1)η(η − 1)      X
       − E                 e                                      pi (t)3         p(0) = p
                 0                           6              i=1
              "Z                                  n
                                                                                        !               #
                       ∞
                 −rt       η(η − 1) c(t) − c̄ X
       + E      e (1 − ǫη)                           pi (t)2                                 p(0) = p
             0                  2           c̄   i=1
           Z ∞                                      
                 −rt                     3
       + E      e o(||(p(t), c(t) − c̄)|| ) p(0) = p
                   0



where V0 is given by equation (1) where we let B = (1/2)η(η − 1). If furthermore we assume
that log P (t) have a bounded derivative, then |c(t) − c̄|/c̄ = δ| (1−κ(t))
                                                                      ǫ
                                                                            | + o(δ) ≤ δ |1−κ|
                                                                                           ǫ
                                                                                               + o(δ)
and hence we can write:
                                 Z ∞                                         
                         δ              −rt                   2
                                                                
               V0 = Υe V0 + E          e o || ( p(t) , δ ) ||     p(0) = p + ι(δ)
                                                       0

where Υ = W̄ Π(0) c̄1−ηǫ are the per product maximum (frictionless) nominal profits in steady
state (immediately before the monetary shock).


C       The verification theorem
To prove that V (p) = v(y) we recall and adapt a version of the Verification Theorem 10.4.1
(page 233) by Øksendal (2000):

Theorem 1. A function V ∈ C 1 (Rn ) and V ∈ C 2 (Rn \∂I), that satisfies equations (3)-(6)
and the conditions listed below solves the problem in equation (1) and equation (2).
                                                                   2
                                                                      
  1. 0 ≤ V (p) ≤ A(p) for all p ∈ Rn where A(p) = Br ||p||2 + nσr       is the expected dis-
     counted value of never-adjusting,
                           2 Pn
  2. rV (p) ≤ B ||p||2 + σ2   i=1 Vii (p) for all p ∈ C,

    3. V (p) ≤ minp̂ V (p̂) + ψ for all p ∈ Rn ,
    4. ∂I is a Lipschitz surface: i.e. it is locally the graph of a Lipschitz function,
    5. the process {p(t)} spends no time in the boundary of the inaction region:
                          Z ∞                          
                        E      χ{∂I} (p(t)) dt |p(0) = p = 0, for all p ∈ Rn .
                                              0


                                                                   4
  6. The second derivatives of V are bounded in a neighborhood of ∂I,

  7. the stopping times τi∗ that achieve the solution are finite,

  8. Let τ ∗ be the optimal stopping time starting from p(0), the family {e−rτ V (p(τ )); τ ≤ τ ∗ }
     is uniformly integrable for all p(0).

   For completeness we state the definition of a Lipschitz surface.

Definition 1. The boundary of a bounded set I ⊂ Rn denoted by ∂I has Lipschitz domain
(or it is a Lipschitz surface) if there is constant K > 0 such that for all p ∈ ∂I there is
a neighborhood Bǫ (p) ∩ I and a system of coordinates x = (p1 , p2 , ..., pn−1 ), y = pn and a
function hp such that:
  1. |hp (x1 ) − hp (x2 )| < K|x1 − x2 | for all x1 , x2 ,

  2. Bǫ (p) ∩ I = Bǫ (p) ∩ {(x, y) : y < hp (x)}, and

  3. Bǫ (p) ∩ ∂I = Bǫ (p) ∩ {(x, y) : y = hp (x)}.


     Finally, we verify that our candidate solution V satisfies the conditions of Theorem 1.
                                                                          √
     Item (1). Notice that A(p), as a function of y, can be written as A( y) = Br (y + nσ 2 /r).
We have for all y > 0 or p 6= 0: V (p) < A(p) since the constant and first order coefficient
terms of V (p), namely (β0 , β1 ) are smaller than those of A(p) and all other coefficients
(βj , j = 2, 3, ...) are negative, where we used that β1 < B/r, see the proof of Proposition 2.
Item (2) holds as inequality in C. To see why

                Vi (p) = v ′ (||p||2)2pi and Vii (p) = v ′′ (||p||2)4(pi )2 + v ′ (||p||2)2 ,

but using Proposition 2 at p ∈ ∂I we have v ′ (||p||2) = 0 and v ′′ (||p||2) < 0. Additionally,
||p||2 > ȳ ∈ C, thus

                                     σ 2 ′′
                  rV (ȳ) = B ȳ +      v (ȳ)n4ȳ < rV (p) = B||p||2 for all p ∈ C .
                                     2

Item (3) holds since by Proposition 2 we have v(y) is strictly increasing in (0, ȳ) and v(ȳ) −
v(0) = ψ, thus V (p) < V (0) + ψ for all p 6= 0. q
                                                           Pn−1 2
Item (4) holds by taking h(p1 , p2 , ..., pn−1 ) = ȳ − i=1       pi for p2n > 0, otherwise take a
different coordinate system, i.e. solve for the i-th coordinate for which p2i > 0. Clearly h is
Lipschitz.
                                                                                 √
Item (5) holds by considering the uncontrolled process dy = nσ 2 dt + 2σ y dW and thus
E0 [y(t)] = nσ 2 t + y(0).
Item (6) holds since, as shown above, Vii (p) = v ′′ (ȳ) 4 p2i and
                                                ∞
                                                X
                                      ′′
                                     v (ȳ) =         βi i (i − 1) (ȳ)i−2
                                                i=2


                                                        5
and since, as shown in Proposition 1, limi→∞ βi+1 /βi = 0 and thus the function v is analytical
for all y > 0.
Item (7) holds, since y(t) has a strictly positive drift nσ 2 .
Item (8) holds since e−rτ V (p(τ )) ≤ e−rτ (ψ + V (0)) .
                                          ∗
                                                                                             


D                              Numerical accuracy of the approximation
In this section we present some evidence on the numerical accuracy of the approximation.
We compare the value of ȳ obtained from the quadratic approximation to v described above,
with what we call the “exact” solution, which is the numerical solution using up to 30 terms
for βi in its the expansion. The approximation are closer for smaller values of σ and ψ, which
we regard as more realistic.

 Figure 8: Ratio of ȳ ′ s and of v(0)′ s for the approximation relative to the “exact” solution


                              1                                                                                                                  1


                          0.9998
                                                                                                                                             0.9998
                                                                                                        ratio of v(0) approx to v(0) exact




                          0.9996
                                                                                                                                             0.9996
  ȳ approx. / ȳ exact




                          0.9994


                          0.9992                                                                                                             0.9994
                                                                                    ψ constant                                                                                      ψ constant
                                                                                    ψ linear in n                                                                                   ψ linear in n
                           0.999                                                                                                             0.9992

                          0.9988
                                                                                                                                              0.999
                          0.9986

                                                                                                                                             0.9988
                          0.9984


                          0.9982                                                                                                             0.9986
                                0   10   20   30     40    50    60       70   80       90      100                                                0   20     40         60        80           100
                                                   number of products n                                                                                     number of products n

                           Note: parameter values are B = 20 , σ = 0.25 , ψ1 = 0.03 and r = 0.03.



   The next figure shows the value of Na (n) for various n when the menu cost are constant
returns to scale, so ψ = ψ1 n using the approximation and using the “exact” expression.


E                              Sensitivity to inflation
In this section we analyze the effect of inflation on the frequency of price adjustments and
the size distribution of price changes under the assumption that the inflation rate, which we
denote by µ, is small.


                                                                                                    6
                                                             Figure 9: Frequency of adjustment Na for the CRS ψ1 n and constant ψ.
                                                                CRS: ψ proportional to n                                                                                      Constant ψ

                                                      3.6                                                                                                          30
  Freq. of adjustment N a , exacct and approx. case




                                                                                                                Freq. of adjustment N a , exact and approx. case
                                                      3.4
                                                                                                                                                                   25

                                                      3.2

                                                                                                                                                                   20
                                                       3


                                                                                             exact CRTS                                                                                             exact CRTS
                                                      2.8                                                                                                          15
                                                                                             approx. CRTS                                                                                           approx. CRTS


                                                      2.6
                                                                                                                                                                   10

                                                      2.4

                                                                                                                                                                   5
                                                      2.2


                                                       2                                                                                                           0
                                                        0       10       20        30        40         50                                                          0   10      20        30        40         50
                                                                      number of products n                                                                                   number of products n

                                                       Note: parameter values are B = 20 , σ = 0.20 , ψ1 = 0.03 and r = 0.03.



    We model inflation as introducing a constant common drift on each of the n target prices
{p∗i (t)}.
         Equivalently, this means that each of the price gaps {pi (t)} has a negative drift µ,
so equation (2) becomes
                                     X
            pi (t) = −µt + σWi (t) +      ∆pi (τj ) for all t ≥ 0 and i = 1, 2, ..., n.  (56)
                                                                                             j:τj <t


We were not able to characterize the solution of the problem for arbitrary values of µ.
Recall that in the case of µ = 0 the time t conditional distribution of ||p(t + ∆t)||2 at time
t + ∆t depends only on ||p(t)||2 . Thus, since in the objective function is proportional to
y(t) ≡ ||p(t)||2, the state of the problem can be taken to be the scalar y(t), and hence the
shape of the control and inaction regions are all functions of y(t). In the case of µ 6= 0 the
time tPconditional distribution of ||p(t + ∆t)||2 at time t + ∆t depends on ||p(t)||2 as well as
on µ [ ni=1 pi (t)]. Thus the state of the problem will not be solely y, and hence the control
and inaction sets will not be functions exclusively of y = ||p||2. Also in the case of µ 6= 0 it
will not be the case that at a time τ where the firm adjust prices: ∆pi (τ ) = −pi (τ ). In other
words, conditional on an adjustments, firms will not set the price gap equal to the static
optimal value, since the state has a drift. Yet, even though we have not solved the model for
positive inflation, the next proposition shows that for many statistics inflation has a second
order effect.
    For the next proposition we explicitly write µ as an argument of the value function V (p, µ),
and of the statistics such as the frequency of price changes Na (µ), the hazard rate of price

                                                                                                            7
changes h(t, µ), the moments of the distribution of price changes E[∆pi , µ], etc. We also define
the density of the marginal distribution of the absolute value of price changes ℓ(|∆p− i|, µ)
and the average value function: E[V ](µ), i.e. the expected value
                                                                R of the value function under
the invariant distribution of the price gaps g(p) as E[V ](µ) ≡ Rn V (p, µ)g(p, µ)dp. We have:

Proposition 14. Assume that all the functions below are differentiable. Then
         ∂                             ∂
  (i)   ∂µ
             Na (µ)|µ=0 = 0, and      ∂µ
                                           h (t, µ)|µ=0 = 0 for all t ≥ 0 ,
         ∂                                            2
 (ii)   ∂µ
             E [∆pi , µ]|µ=0 = Na1(0) > 0 and ∂µ
                                               ∂
                                                 2 E [∆pi , µ]|µ=0 = 0 ,

                h                      i
(iii)    ∂
        ∂µ
             E (∆pi − E[∆pi ])2k , µ        = 0, for k = 1, 2, ...,
                                           µ=0

         ∂                                            √
(iv)    ∂µ
             ℓ (|∆pi |, µ)|µ=0 = 0 for all |∆pi | <       ȳ and
         ∂
 (v)    ∂µ
             E[V ](µ)|µ=0 = 0 .

    Part (i) shows that the average number of adjustments per unit of time, Na (µ), is insensi-
tive to inflation at µ = 0. Indeed, the whole hazard rate function of price adjustment, h(t, µ)
is insensitive to inflation at µ = 0. Part (ii) states that the expected value of price changes
increases linearly with µ with slope 1/Na (0), at least for small values of µ = 0. This follows
from (i) and from the identity: µ = na (µ) E [∆pi , µ], i.e. that the product of the average
price change times the number of adjustments equals the inflation rate.
    The result that the “intensive” margin of price adjustment is insensitive to inflation at
µ = 0 applies to the special case of models with only one product, i.e. n = 1, as it is illustrated
in the numerical results reported in Figure 3 of Golosov and Lucas (2007), when σ > 0. The
proof of each of these results, as well as of the other parts of this proposition, is based on
the symmetry of the problem. For instance it is easy to see that given the symmetry of the
objective function and the distribution of the BMs {Wi (t)}, then for all p ∈ Rn and µ ∈ R
we have: V (p, µ) = V (−p, −µ) and that p ∈ I(µ) if and only if −p ∈ I(−µ), where I(µ) is
the control set, viewed as a correspondence of inflation. This implies that Na (µ) = Na (−µ),
as well as h(t, µ) = h(t, −µ). Thus, if Na (µ) is differentiable at µ = 0, then it must be flat.
We skip a proof of the symmetry and of the proposition, since it follows the same lines than
the proof for the analogous results in the model with n = 1 but with observation and menu
cost in Alvarez, Lippi, and Paciello (2011b).26
    The theoretical result about the insensitivity of Na -and the associated linearity of E[∆p]-
is supported by the evidence in Gagnon (2009) who, among others, finds that when inflation
is low (say below 10-15%), the frequency of price changes is almost unrelated to inflation,
and that the average magnitude of price changes has a tight linear relationship with inflation.
    To understand (iii) and (iv) it is useful to realize that for µ = 0 the marginal distribution
of price changes is symmetric around zero, a consequence of the symmetry of the loss function
  26
     The case of σ = 0, which corresponds to the model in Sheshinski and Weiss (1977), the “insensitivity
result” does not hold, since while the function na is symmetric, it has a kink at µ = 0. We conjecture, but
have not proven, that as long as σ > 0, all these functions are differentiable at µ = 0. The economics are
clear: the effect of small inflation is swamped by idiosyncratic shocks when σ > 0.


                                                          8
and of the distribution of the shocks. Part (iii) shows that all the even centered moments are
approximately the same for zero and low inflation. Importantly, this includes the variance
and the kurtosis which is one of the moments that researchers have focused in the analysis
of the effect of multi-products firms. Yet we are pretty sure that inflation will have a first
order effect on other aspects of the distribution of price changes such as skewness. Part (iv)
shows that the whole distribution of the absolute value of price changes is approximately the
same for low and zero inflation. Finally part (v) shows that inflation has only a second order
effect on the expected value function. Equivalently, inflation causes a second order increase
in the unconditional expectation of losses for the firm.
    These results show that the expected losses of the firm as well as the frequency and several
moments of the size distribution of price changes are insensitive to inflation at µ = 0. Thus,
the analysis of the problem in a low inflation environment is well approximated by studying
the case of zero inflation.


F     Details on the Impulse response to Monetary Shocks
F.1    Numerical Evaluation of Impact Effects
The expression in equation (33) is readily evaluated by either numerical integration, or using
that S(z) is proportional to the hypergeometric function 2 F1 (·). Likewise, equation (34) is
easy to evaluate, since it has the following closed form solution:
                                                                                       (n−1)/2
                           1 3−n 3 z 2                                               ν2
                2 F1       2
                             , 2 , 2, n             Z   ν                     n 1−   n
       S(z) =               n−1  1
                                    √        and    √
                                                            z s(z)dz = −                  n−1 1
                                                                                                   √       .
                Beta         2
                                ,2        n         − n                    (n − 1)Beta     2
                                                                                             ,2         n

F.2    Analytical Characterization of Impact Effects
The next lemma characterize the impact effect of an aggregate shock in terms of properties
of the Θn and Φn functions.

Lemma 3. Let Φn and Θn be, respectively, the fraction of firms that change prices and the
average price change across the n goods after a monetary shock of size δ. We have:
                                    p
  (i) Fix n ≥ 1 and ȳ > 0. If δ ≥ 2 ȳ/n (large shocks) then Φn (δ, ȳ) = 1 and Θn (δ, ȳ) = δ .
                                    √                   
                                                           δ
                                                               
                                                                       1
                                                                                      
                                                                                          δ
                                                                                              
 (ii) Φn , Θn are homogenous in (δ, ȳ): Φn (δ, ȳ) = Φn ȳ , 1 and ȳ Θn (δ, ȳ) = Θn ȳ , 1 .
                                                          √           √                  √


(iii) Φn and Θn are both weakly increasing in δ; the function Φn is decreasing in ȳ and, for
      small δ, Θn is decreasing in ȳ.

(iv) Impact effects are second order

                                          ∂Φn (0, ȳn)   ∂Θn (0, ȳn )
                                                       =               =0,
                                             ∂δ             ∂δ



                                                            9
Proof. (of Lemma 3 )
    Point (i): follows by noting that the “last” firm to be pushed out of the inaction
                                                                                    p       region
is a  firm  with  a price  gap   y =   ȳ and  all individual price gaps  equal  to   ȳ/n so that
Pn          √
   i=1 pi =   nȳ. Intuitively, this is the firm with the largest possible positive price gaps and
the shock is helping pthe firm to reduce them. Using this assumption in equation (31) gives
the smallest δ = 2 ȳ/n such that all prices adjust, so that Φn = 1. The symmetry of the
density of price changes immediately gives the result Θn = δ.
   Point (ii): Let us start by stating the homogeneity property, and defining two related
functions Φ̂n and Θ̂n :
                                                                
         δ                δ                          δ             δ         Θn (δ, ȳ)
   Φ̂n √        ≡ Φn √ , 1 = Φn (δ, ȳ) and Θ̂n √          ≡ Θn √ , 1 = √               .
           ȳ              ȳ                         ȳ            ȳ            ȳ

The homogeneity follows from a change of variables in equation (33) and equation (34), taking
into account that f (y) is homogenous of degree −1 in (ȳ, y) as displayed in equation (30),
                                                   √ √
and that ν(y, δ) is homogenous of degree zero in ( y, ȳ, δ), as displayed in equation (31).
In contrast S(z) and s(z), evaluated at a given z, do not depend on δ nor on ȳ.
    Point (iii): The monotonicity of Φn and Θn with respect to δ follows, after manipulating
the derivatives, from the monotonicity of ν(·) and S(·). To show that for small δ the func-
tion Θn is decreasing in ȳ, differentiate totally with respect to ȳ the expression stating the
homogeneity of this function obtaining
                                                                     
                                           Θ    √δ , 1               
                                    1 δ      n    ȳ             δ
                      Θn,2 (δ, ȳ) = √                  − Θn,1 √ , 1  ,
                                    2 ȳ        δ                 ȳ

where Θn,i denote the derivative with respect to the ith argument of this function. Use that,
                                                √
for small values of δ, the function Θn (δ/ ȳ, 1) is increasing and convex on Θ̂, so that the
expression in squares brackets is negative. That this function is increasing and convex follows
since its first derivative is zero at δ = 0 and the function is increasing. For Φn it follows from
differentiating with respect to ȳ the definition of homogeneity, obtaining:
                                                                
                                                 1 δ        δ
                                 Φn,2 (δ, ȳ) = − √ Φn,1 √ , 1 ,
                                                 2 ȳ        ȳ

hence this function is decreasing in ȳ in its domain. That Φ is strictly increasing in δ follows
from the monotonicity of S and ν.
    Point (iv): The zero derivative of Φn and Θn with respect to δ at zero can be obtained
by considering two related functions, Φ̄n and Θ̄n which are obtained by replacing ν with
          √
ν̄ = δ/(2 y) and, without loss of generality, by √replacing the lower extreme of integration
w.r.t. y by the y(δ), which solves ν(y(δ), δ) = − n. Note that y(δ) goes to ȳ as δ ↓ 0, and
that, by monotonicity, these functions are upper bounds for Φn and Θn . The result follows
by differentiating Φ̄n and Θ̄n w.r.t. δ and letting δ go to zero.




                                               10
Zero first derivatives of the Φ̂n and Θ̂n functions at δ = 0
To show that Φ′ (0) = 0 we use the following. i) equation (31) implies that
                                                                          √         √      2
                S(ν(y, δ)) = 0 for 0 ≤ y ≤ y(δ) ≡ max                          ȳ − δ n , 0    ,   (57)

hence the integration with respect to y in equation (33) and equation (34) can be done
between y(δ) and ȳ. ii) note that y(δ) → ȳ as δ ↓ 0, iii) once we have defined the integral
w.r.t y in Φ in the interval (y, ȳ), we can replace the function ν by an upper bound ν̄(y, δ) ≡
      √
nδ/(2 y) and define upper bounds for Φ as
                        Z    ȳ                                  Z   ȳ
                 Φ̄ ≡              f (y) S (ν̄(y, δ)) dy ≤ Φ =            f (y) S (ν(y, δ)) dy     (58)
                            y(δ)                                 y(δ)


iv) the density f (ȳ) = 0. Then differentiating the expression for Φ̄ w.r.t. δ, evaluating the
                                            √
derivative at δ = 0 we obtain that Φ̄′ (0, ȳ) = 0. v) since Φ̄ ≥ Φ ≥ 0 this establishes the
desired result.
    To show that Θ̂′ (0) = 0 notice that Θ = Φ × Eδ [∆p|∆p 6= 0], i.e. the change in prices is
equal to the fraction of firms that change prices times the expectation that of a price change,
                                                        √            √
conditional on having a price change. Using that Φ(0, ȳ) = Φ′ (0, ȳ) = 0 we obtained that
      √
Θ′ (0, ȳ) = 0.
                                                                                               
    As a benchmark, note that in a flexible price economy all firms change prices, i.e. Φn (δ) =
1 and hence the average price change equals the monetary impulse,  p i.e. Θn (δ) = δ for all δ.
Part (i) of the lemma states that, for large shocks i.e. for δ ≥ 2 ȳ/n, all the firms adjust
prices change on average by δ, so that the economy behaves like one with no frictions.
    Part (ii) illustrates a convenient homogeneity property of the Φn , Θn functions: after
normalizing the monetary shock in terms of the price gap, these functions have only one
argument. Part (iii) states that the fraction of adjusters and the response of the aggregate
price level are increasing in the size of the shock.

F.3    Sensitivity analysis of the IRF to the size of monetary shock
We report here the sensitivity of the impulse responses of considering different values for the
monetary shock, by considering the case when the monetary shock is half and twice as large
as in the benchmark case of Figure 4.

F.4    Expressions for em,k for the n = 2 case
Here we collect the expression for the coefficients em,k of the impulse response for the case of
n = 2.




                                                      11
                                        Figure 10: Impulse Response of CPI, smaller shock δ

                                             0.5 p ercent mon etary sh ock, N a = 1, S td[∆p ] =0.1

                              0.5
CPI response, in percentage




                              0.4


                                                                                     δ
                                                                                  S td[∆p] =   0.05

                              0.3




                              0.2




                              0.1

                                                                                                       n   =   1
                                                                                                       n   =   2
                                                                                                       n   =   3
                                                                                                       n   =   10
                                                                                                       n   =   30
                               0
                                    0    2       4     6      8     10     12    14      16           18        20
                                                                  months




                                        Figure 11: Impulse Response of CPI, larger shock δ

                                             2 p ercent mon etary sh ock, N a = 1, S td[∆p ] =0.1

                               2
CPI response, in percentage




                              1.5
                                                                                     δ
                                                                                  S td[∆p] =   0.2



                               1




                              0.5



                                                                                                       n   =   1
                                                                                                       n   =   2
                                                                                                       n   =   3
                                                                                                       n   =   10
                                                                                                       n   =   30
                               0
                                    0    2       4     6      8     10     12    14      16           18        20
                                                                  months




                                                                  12
              ∞                                     2                ∞ X
                                                                       ∞                                       2
              X                √                   q0,k
                                                        2 σ2         X                    √                   qm,k
                                                                                                                   2 σ2
θ2 (δ, t) =         ̺0,k (δ,       ȳ, 2) σ 2 e−    22    ȳ
                                                             t
                                                                 +             ̺m,k (δ,       ȳ, 2) σ 2 e−    22    ȳ
                                                                                                                        t
                                                                                                                            where
              k=1                                                    m=1 k=1
                                                                                                                     
                                                                                                            ||p||
        √
                       Z               Z
                                         (p1 + p2 )     cos  (m∠p0p   0 ) qm,k  J m           qm,k         ||p0 ||
̺m,k (δ, ȳ, 2) =                                                                                  dp λ(p0 , δ) dp0
                  ||p0 ||2 ≤ȳ ||p||2=ȳ       2                  2 π ||p||3 Jm′ (q
                                                                                    m,k )
                                                                                                 
                                                                                       ||p||
                         √                                     (p1 + p2 ) q0,k J0 ||p0 || q0,k
                                     Z             Z
for m ≥ 1 and ̺k,0 (δ, ȳ, 2) =                   
                                                                                      3 J ′ (q )
                                                                                                   dp λ(p0 , δ) dp0 .
                                             2
                                      ||p0 || ≤ȳ         2
                                                     ||p|| =ȳ     2       2 π  ||p||     0   0,k

                                                                 √                        √                 2
The coefficients em,k are given by em,k (δ,                           ȳ, 2) = ̺m,k (δ,       ȳ, 2) ȳ 2/ qm,k .




                                                                     13
