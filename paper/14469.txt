                                NBER WORKING PAPER SERIES




   IDENTIFICATION AND ESTIMATION OF 'IRREGULAR' CORRELATED RANDOM
                          COEFFICIENT MODELS

                                          Bryan S. Graham
                                           James Powell

                                        Working Paper 14469
                                http://www.nber.org/papers/w14469


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    November 2008




We would like to thank seminar participants at UC - Berkeley, UCLA, USC, Harvard, Yale, NYU,
Princeton, Rutgers, Syracuse, Penn State, members of the Berkeley Econometrics Reading Group
and participants in the Conference in Economics and Statistics in honor of Theodore W. Anderson’s
90th Birthday (Stanford University), the Copenhagen Microeconometrics Summer Workshop and
the JAE Conference on Distributional Dynamics (CEMFI, Madrid) for comments and feedback. Discussions
with Manuel Arellano, Stéphane Bonhomme, Gary Chamberlain, Iván Fernández-Val, Jinyong Hahn,
Jerry Hausman, Bo Honoré, Michael Jansson, Roger Klein, Arthur Lewbel, Ulrich Müller, John Strauss,
and Edward Vytlacil were helpful in numerous ways. This revision has also benefited from the detailed
comments of a co-editor as well as three anonymous referees. Max Kasy and Alex Poirier provided
research assistance. Financial support from the National Science Foundation (SES #0921928) is gratefully
acknowledged. All the usual disclaimers apply. The views expressed herein are those of the author(s)
and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2008 by Bryan S. Graham and James Powell. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Identification and Estimation of 'Irregular' Correlated Random Coefficient Models
Bryan S. Graham and James Powell
NBER Working Paper No. 14469
November 20085HYLVHG2FWREHU
JEL No. C14,C23,I1,O1,O15

                                              ABSTRACT

In this paper we study identification and estimation of a correlated random coefficients (CRC) panel
data model. The outcome of interest varies linearly with a vector of endogenous regressors. The coefficients
on these regressors are heterogenous across units and may covary with them. We consider the average
partial effect (APE) of a small change in the regressor vector on the outcome (cf., Chamberlain, 1984;
Wooldridge, 2005a). Chamberlain (1992) calculates the semiparametric efficiency bound for the APE
in our model and proposes a ¥N consistent estimator. Nonsingularity of the APE’s information bound,
and hence the appropriateness of Chamberlain’s (1992) estimator, requires (i) the time dimension of
the panel (T) to strictly exceed the number of random coefficients (p) and (ii) strong conditions on
the time series properties of the regressor vector. We demonstrate irregular identification of the APE
when T = p and for more persistent regressor processes. Our approach exploits the different identifying
information in the subpopulations of ‘stayers’ — or units whose regressor values change little across
periods — and ‘movers’ — or units whose regressor values change substantially across periods. We
propose a feasible estimator based on our identification result and characterize its large sample properties.
While irregularity precludes our estimator from attaining parametric rates of convergence, it limiting
distribution is normal and inference is straightforward to conduct. Standard software may be used
to compute point estimates and standard errors. We use our methods to estimate the average elasticity
of calorie consumption with respect to total outlay for a sample of poor Nicaraguan households.


Bryan S. Graham
New York University
19 W 4th Street, 6FL
New York, NY 10012
and NBER
bsg1@nyu.edu

James Powell
UC, Berkeley
Department of Economics
508-1 Evans Hall #3880
Berkeley, CA 94720-3880
powell@econ.berkeley.edu
    That the availability of multiple observations of the same sampling unit (e.g., individual, firm,
etc.) over time can help to control for the presence of unobserved heterogeneity is both intuitive and
plausible. The inclusion of unit-specific intercepts in linear regression models is among the most
widespread methods of ‘controlling for’ omitted variables in empirical work (e.g., Card, 1996).
The appropriateness of this modelling strategy, however, hinges on any time-invariant correlated
heterogeneity entering the outcome equation additively. Unfortunately, additivity, while statisti-
cally convenient, is diﬃcult to motivate economically (cf., Imbens, 2007).2 Browning and Carro
(2007) present a number of empirical panel data examples where non-additive forms of unobserved
heterogeneity appear to be empirically relevant.
    In this paper we study the use of panel data for identifying and estimating what is arguably the
simplest statistical model admitting nonseparable heterogeneity: the correlated random coeﬃcients
(CRC) model. Let Y = (1       )0 be a  × 1 vector of outcomes and X = (X1      X )0 a  × 
matrix of regressors with X ∈ X ⊂ R and X ∈ X where X = ×∈{1 } X  We assume that
X is strictly exogenous. This rules out feedback from the period  outcome  to the period  ≥ 
regressor X . One implication of this assumption is that lags of the dependent variable may not
be included in X . Our model is a static one.
    Available is a random sample {(Y  X )}  =1 from a distribution 0 . The 
                                                                                   period outcome is

given by
                                             = X0  (  )                                      (1)

where  is time-invariant unobserved unit-level heterogeneity and  a time-varying disturbance.
Both  and  may be vector-valued. The ×1 vector of functions  (  ), which we allow to vary
over time, map  and  into unit-by-period-specific slope coeﬃcients. By ‘random’ coeﬃcients we
mean that  (  ) varies across units. By ‘correlated’, we mean that the entire path of regressor
values, X, may have predictive power for  (  ). This implies that an agent’s incremental return
to an additional unit of X may vary with X . In this sense X may be endogenous.
    Equation (1) is structural in the sense that the unit-specific function

                                                (x ) = x0  (  )                                           (2)

traces out a unit’s period  potential outcome across diﬀerent hypothetical values of x ∈ X 3
Let X = (1 0 )0 ; setting 1 (  ) =  1 +  +  (with  and  scalar and mean zero) and
 (  ) =   for  = 2      yields the textbook linear panel data model:

                                              (x ) = x0  +  +                                              (3)

Equation (2), while preserving linearity in X , is more flexible than (3) in that it allows for time-
   2
     Chamberlain (1984) presents several well-formulated economic models that do imply linear specifications with
unit-specific intercepts.
   3
     Throughout we use capital letters to denote random variables, lower case letters specific realizations of them, and
blackboard bold letters to denote their support (e.g.,   and X)..



                                                           1
varying random coeﬃcients on all of the regressors (not just the intercept). Furthermore these
coeﬃcients may nonlinearly depend on  and/or  
    Our goal is to characterize the eﬀect of an exogenous change in X on the probability distribution
of   By ‘exogenous change’ we mean an external manipulation of X in the sense described by
Blundell and Powell (2003) or Imbens and Newey (2009). We begin by studying identification and
estimation of the average partial eﬀect (APE) of X on  (cf., Chamberlain, 1984; Blundell and
Powell, 2003; Wooldridge, 2005a). Under (1) the average partial eﬀect is given by
                                                ∙       ¸
                                            (x )
                                    β0   ≡ E             = E [ (  )]                                   (4)
                                                x

    Identification and estimation of (4) is nontrivial because, in our setup, X may vary systemati-
cally with  and/or  . To see the consequences of such dependence observe that the derivative of
the mean regression function of  given X does not identify a structural parameter. Diﬀerentiating
through the integral we have

                      E [  | X = x]
                                       = β0 (x) + E [  (X ) S (   | X)| X = x]                      (5)
                            x

with β0 (x) = E [  (  )| X = x] and S (   | X) = ∇ log  (   | X). The second term is
what Chamberlain (1982) calls heterogeneity bias. If the (log) density of the unobserved hetero-
geneity varies sharply with x — corresponding to ‘selection bias’ or ‘endogeneity’ in a unit’s choice
of x — then the second term in (5) can be quite large.
    Chamberlain (1982) studies identification of β0 ≡ β00 using panel data (cf., Mundlak, 1961,
1978b). In a second paper, Chamberlain (1992, pp. 579 - 585) calculates the semiparametric vari-
ance bound for β0 and proposes an eﬃcient method-of-moments estimator.4 His approach is based
on a generalized within-group transformation; naturally extending the idea that panel data allow
the research to control for time-invariant heterogeneity by ‘diﬀerencing it away’.5 Under regular-
ity conditions, which ensure nonsingularity of β0 ’s information bound, Chamberlain’s estimator
                              √
converges at the standard  rate.
    Nonsingularity of I (β0 ), the information for β0 , generally requires the time dimension of the
panel to exceed the number of random coeﬃcients (  ). Depending on the time series properties
of the regressors,  may need to substantially exceed . In extreme cases I (β0 ) may be zero
for all values of  . In such settings Chamberlain’s method breaks down. We show that, under
mild conditions, β 0 nevertheless remains identified. Our method of identification is necessarily
                                                                        √
‘irregular’: the information bound is singular and hence no regular  consistent estimator exists
(Chamberlain, 1986). We develop a feasible analog estimator for β 0 and characterize its large
sample properties. Although its rate of convergence is slower than the standard parametric one,
   4
     Despite its innovative nature, and contemporary relevance given the resurgence of interest in models with het-
erogenous marginal eﬀects, Chamberlain’s work on the CRC model is not widely known. The CRC specification is
not discussed in Chamberlain’s own Handbook of Econometrics chapter (Chamberlain, 1984), while the panel data
portion of Chamberlain (1992) is only briefly reviewed in the more recent survey by Arellano and Honoré (2001).
   5
     Bonhomme (2010) further generalizes this idea, introducing a notion of ‘functional diﬀerencing’.


                                                        2
its limiting distributions is normal. Inference is straightforward.
     Our work shares features with other studies of irregularly identified semiparametric models
(e.g., Chamberlain, 1986; Manski, 1987; Heckman, 1990; Horowitz, 1992; Abrevaya, 2000; Hon-
oré and Kyriazidou, 1997; Kyriazidou, 1997; Andrews and Schafgans, 1998; Khan and Tamer,
2009). A general feature of irregular identification is its dependence on the special properties of
small subpopulations. These special properties are, in turn, generated by specific features of the
semiparametric model. Consequently these types of identification arguments tend to highlight the
importance, sometimes uncomfortably so, of maintained modelling assumptions (cf., Chamberlain,
1986, pp. 205 - 207; Khan and Tamer, 2009).
     Our approach exploits the diﬀerent properties, borrowing a terminology introduced by Cham-
berlain (1982), of ‘movers’ and ‘stayers’. Loosely speaking these two subpopulations respectively
correspond to those units whose regressors values, X , change and do not change across periods
(a precise definition in terms of singularity of a unit-specific design matrix is given below). We
identify aggregate time eﬀects using the variation in  in the ‘stayers’ subpopulation. A common
trends assumption allows us to extrapolate these estimated eﬀects to the entire population. Hav-
ing identified the aggregate time eﬀects using stayers, we then identify the APE by the limit of a
trimmed mean of a particular unit-specific vector of regression coeﬃcients.

Connection to other work on panel data In order to connect our work to the wider panel
data literature it is useful to consider the more general outcome response function:

                                       (x ) =  (x    ) 

Identification of the APE in the above model may be achieved by one of two main classes of
restrictions. The correlated random eﬀects approach invokes assumptions on the joint distribution
of (U )| X; with U = (1       )0  Mundlak (1978a,b) and Chamberlain (1980, 1984) develop
this approach for the case where  (X    ) and  ( U | X) are parametrically specified. Newey
(1994a) considers a semiparametric specification for  ( U | X) (cf., Arellano and Carrasco, 2003).
Recently, Altonji and Matzkin (2005) and Bester and Hansen (2009) have extended this idea to the
case where  (X    ) is either semi- or non-parametric along with  ( U | X).
    The fixed eﬀects approach imposes restrictions on  (X    ) and  ( U| X ), while leaving
 ( | X), the distribution of the time-invariant heterogeneity, the so-called ‘fixed eﬀects’, unre-
stricted. Chamberlain (1980, 1984, 1992), Manski (1987), Honoré (1992), Abrevaya (2000), and
Bonhomme (2010) are examples of this approach. Depending on the form of  (X    ), the fixed
eﬀect approach may not allow for a complete characterization of the eﬀect of exogenous changes in
X on the probability distribution of  . Instead only certain features of this relationship may be
identified (e.g., ratios of the average partial eﬀect of two regressors).
    Our methods are of the ‘fixed eﬀect’ variety. In addition to assuming the CRC structure for
 (x ) we impose a marginal stationarity restriction on  (  | X )  a restriction also used by
Manski (1987), Honoré (1992) and Abrevaya (2000), however, other than some weak smoothness


                                                   3
conditions, we leave  ( | X) unrestricted.
     Wooldridge (2005b) and Arellano and Bonhomme (2009) also analyze the CRC panel data
model. Wooldridge focuses on providing conditions under which the usual linear fixed eﬀects (FE)
estimator is consistent despite the presence of correlated random coeﬃcients (cf., Chamberlain,
1982, p. 11). Arellano and Bonhomme (2009) study the identification and estimation of higher-order
moments of the distribution of the random coeﬃcients. Unlike us, they maintain Chamberlain’s
(1992) regularity conditions as well as impose additional assumptions.
     Chamberlain (1982) showed that when X is discretely valued the APE is generally not iden-
tified (p. 13). However, Chernozhukov, Fernández-Val, Hahn and Newey (2009), working with
more general forms for E [  | X ]  show that when  has bounded support the APE is partially
identified and propose a method of estimating the identified set.6 In contrast, in our setup we show
that the APE is point identified when at least one component of X is continuously-valued.
     Section 1 presents our identification results. We begin by (i) briefly reviewing the approach
of Chamberlain (1992) and (ii) characterizing irregularity in the CRC model. We then present
our method of irregular identification. Section 2 outlines our estimator as well as its large sample
properties. Section 3 discusses various extensions of our basic approach.
     In Section 4 we use our methods to estimate the average elasticity of calorie demand with
respect to total household resources. Our sample is drawn from a population that participated in a
pilot of the Nicaraguan conditional cash transfer program Red de Protección Social (RPS). Hunger
is widespread in the communities from which our sample is drawn; we estimate that immediately
prior to the start of the RPS program over half of households had less then the required number
of calories needed for all their members to engage in ‘light activity’ on a daily basis.7
     A stated goal of the RPS program is to reduce childhood malnutrition, and consequently increase
human capital, by directly augmenting household income. The eﬃcacy of this approach to reducing
childhood malnutrition largely depends on the size of the average elasticity of calories demanded
with respect to income across poor households.8 While most estimates of the elasticity of calorie
demand are significantly positive, several recent estimates are small in value and/or imprecisely
estimated, casting doubt on the value of income-oriented anti-hunger programs (Behrman and
Deolalikar, 1987).9
   6
     They consider the probit and logit models with unit-specific intercepts (in the index) in detail. They show how to
construct bounds on the APE despite the incidental parameters problem and provide conditions on the distribution
of X such that these bounds shrink as  grows.
   7
     We use Food and Agricultural Organization (FAO, 2001) gender- and age-specific energy requirements for ‘light
activity’, as reported in Appendix 8 of Smith and Subandoro (2007), and our estimates of total calories available
at the household-level to calculate the fraction of households suﬀering from ‘food insecurity’. Worldwide, the FAO
estimates that 854 million people suﬀered from protein-energy malnutrition in 2001-03 (FAO, 2006). Halving this
number by 2015, in proportion to the world’s total population, is the first United Nations Millennium Development
Goal. Chronic malnutrition, particularly in early childhood, may adversely aﬀect cognitive ability and economic
productivity in the long-run (e.g., Dasgupta, 1993).
   8
     Another motivation for studying this elasticity has to do with its role in theoretical models of nutrition-based
poverty traps (see Dasgupta (1993) for a survey).
   9
     Wolfe and Behrman (1983), using data from Somoza-era Nicaragua, estimate a calorie elasticity of just 0.01.
Their estimate, if accurate, suggests that the income supplements provided by the RPS program should have little
eﬀect on caloric intake.


                                                          4
    Disagreement about the size of the elasticity of calorie demand has prompted a vigorous method-
ological debate in development economics. Much of this debate has centered, appropriately so, on
issues of measurement and measurement error (e.g., Bouis and Haddad, 1992; Bouis, 1994; Sub-
ramanian and Deaton, 1996). The implications of household-level correlated heterogeneity in the
underlying elasticity for estimating its average, in contrast, have not been examined. If, for example,
a households’ food preferences, or preferences towards child welfare, co-vary with those governing
labor supply, then its elasticity will be correlated with total household resources. An estimation
approach which presumes the absence of such heterogeneity will generally be inconsistent for the
parameter of interest. Our statistical model and corresponding estimator provides an opportunity,
albeit in a specific setting, for assessing the relevance these types of heterogeneities.
    We compare our CRC estimates of the elasticity of calorie demand with those estimated using
standard panel data estimators (e.g., Behrman and Deolalikar, 1987; Bouis and Haddad, 1992),
as well as those derived from cross-sectional regression methods as in Strauss and Thomas (1990,
1995), Subramanian and Deaton (1996), and others. Our preferred CRC elasticity estimates are 10
to 20 percent smaller than their corresponding textbook linear ‘fixed eﬀects’ estimates (FE-OLS).
Our results are consistent with the presence of modest ‘correlated random coeﬃcients bias’.
    Section 5 summarizes and suggests areas for further research. Proofs are in the Appendix. The
                           
notation 0     and = respectively denotes a  × 1 vector of zeros, a  × 1 vector of ones, the
 ×  identity matrix, and equality in distribution.


1    Identification
Our benchmark data generating process combines (1) with the following assumption.

Assumption 1.1 (Stationarity and Common Trends)
                                                                          0   0 )0
(i)  (  ) = ∗ (  ) +  (2 ) for  = 1      and  = (1   2
                
(ii)  | X  =  | X  for  = 1      ,  6= 
                  
(iii) 2 | X  = 2
(iv) E [  (  )| X = x] exists for all  = 1      and x ∈ X .

     Part (i) of Assumption 1.1 implies that the random coeﬃcient consists of a ‘stationary’ and
‘nonstationary’ component. The stationary part, ∗ (  ), does not vary over time so that if
 =  we have ∗ (  ) = ∗ (  ). The non-stationary part, which is a function of the
subvector 2 alone, may vary over time so that even if 2 = 2 we may have  (2 ) 6=  (2 ).
     Part (ii) imposes marginal stationarity of  given X and  (cf., Manski, 1987). Marginal
stationarity, while allowing for serial dependence in   is restrictive. For example it rules out time-
varying heteroscedasticity. Part (iii) requires that 2 is independent of both X and . Maintaining
(ii) and (iii) is weaker than assuming that  is i.i.d. over time and independent of X and  as
is often done in nonlinear panel data research (e.g., Chamberlain, 1980). Part (iv) is a technical
condition. Note that Assumption 1.1 does not restrict the joint distribution of X and . Our
model is a ‘fixed eﬀects’ one.

                                                         5
       Under Assumption 1.1 we have

                         E [  (  )| X] = E [ ∗ (  )| X] + E [  (2 )| X]
                                              = E [ ∗ ( 1 )| X] + E [ (21 )]
                                              =  0 (X) + δ 0        = 1                           (6)

where first equality uses part (i) of Assumption 1.1, the second parts (ii) and (iii), and the third
establishes the notation  0 (X) = E [ ∗ ( 1 )| X] and δ 0 = E [ (2 )]. In what follows we
normalize δ01 = 0
    Equation (6) is a ‘common trends’ assumption. To see this consider two subpopulations with
diﬀerent regressor histories (X = x and X = x0 ). Restriction (6) implies that10
                                                           £               ¤   £                ¤
              E [  (  )| x] − E [  (  )| x] = E  (  )| x0 − E  (  )| x0
                                                       = δ0 − δ 0 

Now recall that a unit’s period  potential outcome function is  (x ) = x0  (  )  Let τ be any
point in the support of both X and X  we have for all x ∈ X

                    E [  (τ ) −  (τ )| X = x] = E [ (τ ) −  (τ )] = τ 0 (δ 0 − δ 0 )              (7)

Equation (7) implies that while the period  (linear) potential outcome functions may vary arbitrar-
ily across subpopulations defined in terms of X = x, shifts in these functions over time are mean
independent of X. A variant of (7) is widely-employed in the program evaluation literature (e.g.,
Heckman, Ichimura, Smith and Todd, 1998; Angrist and Krueger, 1999). It is also satisfied by the
linear panel data model featured in Chamberlain (1984).11
                                                                            ¡                  ¢0
    Let the ( − 1) ×1 vector of aggregate shifts in the random coeﬃcients δ 02      δ 0 be denoted
by δ with the corresponding  × ( − 1)  matrix of time shifters given by
                                                 ⎛                    ⎞
                                              00                 00
                                            ⎜ 0                       ⎟
                                            ⎜ X2                  00 ⎟
                                          W=⎜
                                            ⎜                ..
                                                                      ⎟
                                                                      ⎟                                      (8)
                                            ⎝                   .     ⎠
                                              00                 X0


Under Assumption 1.1 we can write the conditional expectation of Y given X as:

                                         E [ Y| X] = Wδ 0 +Xβ 0 (X)                                         (9)
  10
    We use the notation E [  | X = x] = E [  | x] 
  11
    In an NBER working paper we show how to weaken (6) while still getting positive identification results. As we
do not use these additional results when considering estimation they are omitted.




                                                         6
    In some cases it will be convenient to impose a priori zero restrictions on δ 0 (which would
imply restrictions on how E [ (x )] is allowed to vary over time). In order to accommodate such
situations (without introducing additional notation) we can simply redefine W and δ 0 accordingly.
For example a model which allows only the intercept of E [ (x )] to shift over time is given by (9)
                    ¡           ¢0
above with W = 0 −1   −1 and δ0 equal to the  −1 vector of intercept shifts. To accommodate
a range of options we hereon assume that W is a known  ×  function of X
    Equation (9), which specifies a semiparametric mean regression function for Y given X, is the
fundamental building block of the results that follow. Our identification results are based solely on
diﬀerent implications of (9). The role of equation (1) and Assumption 1.1 is to provide primitive
restrictions on 0 which imply (9). We emphasize that our results neither hinge on, nor necessarily
fully exploit, all of these assumptions. Rather they flow from just one of their implications.

1.1      Regular identification
The partially linear form of (9) suggests identifying δ 0 using the conditional variation in W given
X as in, for example, Engle, Granger, Rice and Weiss (1986).12 In our benchmark model, however,
W is a  ×  function of X and hence no such conditional variation is available. Nevertheless
Chamberlain (1992) has shown that δ 0 may be identified using the panel structure.
   Let Φ (X) be some function of X mapping into  ×  positive definite matrices (in practice
Φ (X) =  will often suﬃce) and define the  ×  idempotent ‘residual maker’ matrix:
                                                £            ¤−1 0 −1
                                 Φ (X) =  − X X0 Φ−1 (X) X   X Φ (X)                                     (10)

Using the fact that Φ (X) X = 0 Chamberlain (1992) derived, for    and other regularity
conditions, the pair of moment restrictions
                             "                                                     #
                                       W0 Φ−1 (X) Φ (X) (Y − Wδ 0 )
                         E       £ 0 −1      ¤−1 0 −1                                  = 0
                                  X Φ (X) X     X Φ (X) (Y − Wδ 0 ) − β0

which identify δ 0 and β0 by
                                 h              i−1    h              i
                                    0                    0
                          δ 0 = E WΦ Φ−1 (X) WΦ     × E WΦ Φ−1 (X) YΦ                                        (11)
                                 h¡           ¢−1 0 −1              i
                          β0 = E X0 Φ−1 (X) X    X Φ (X) (Y − Wδ 0 )                                        (12)

where WΦ = Φ (X) W and YΦ = Φ (X) Y
   Note that Φ (X) may be viewed as a generalization of the within-group transform. To see this
                                                                                                  −1        
 12                      = W − E [ W| X] has a covariance matrix of full rank, then  0 = E W
      To be specific if W                                                                      0W
                                                                                                      ×E W 0Y .




                                                         7
note that premultiplying (9) by Φ (X) yields
                             £   ¯ ¤
                            E YΦ ¯ X = WΦ δ 0 + Φ (X) Xβ0 (X)
                                         = WΦ δ 0 

so that Φ (X) ‘diﬀerences away’ the unobserved correlated eﬀects, β0 (X). Equation (11) shows
that δ 0 is identified by the remaining ‘within-group’ variation in W .
    With δ 0 asymptotically known, the APE is then identified by the (population) mean of the
unit-specific generalized least squares (GLS) fits
                             ¡               ¢
                        b  = X0 Φ−1 (X ) X −1 X0 Φ−1 (X ) (Y − W δ 0 ) 
                        β                                                                      (13)
                                                 


Chamberlain (1992) showed that setting Φ (X) = Σ (X) = V ( Y| X) is optimal; resulting in esti-
mators with asymptotic sampling variances equal to the variance bounds:
                              h              i−1
                                  0
                I (δ 0 )−1 = E WΣ Σ−1 (X) WΣ                                                   (14)
                                          h¡            ¢−1 i
                I (β0 )−1 = V (β0 (X)) + E X0 Σ−1 (X) X       + I (δ 0 )−1  0               (15)
              h¡            ¢−1 0 −1    i
where  = E     X0 Σ−1 (X) X   X Σ (X) W 

1.2   Irregularity of the CRC panel data model
Chamberlain’s approach requires nonsingularity of I (δ 0 ) and I (β 0 )  In this section we discuss
                                                                   √
when this condition might not hold and, consequently, no regular  consistent estimator exists.
We begin by noting that singularity I (δ 0 ) is generic if  =  our primary case. The following
proposition specializes Proposition 1 of Chamberlain (1992) to our problem.

Proposition 1.1 (Zero Information) Suppose that (i) (0  δ 0  β0 (·)) satisfies (9), (ii) Σ (x) is
                                          £            ¤
positive definite for all x ∈ X  (iii) E W0 Σ−1 (X) W  ∞ and (iv)  =  then I (δ 0 ) = 0

Proof. From Chamberlain (1992) the information bound for δ 0 is given by
                                               h              i
                                                 0
                                   I (δ 0 ) = E WΣ Σ−1 (X) WΣ

so that 0 I (δ 0 )  = 0 is equivalent to WΣ  = 0 with probability one. If  = , then X is square
so that                           ³                                        ´
                                           £            ¤−1 0 −1
                       WΣ = W  − X X0 Σ−1 (X) X          X Σ (X) (X) = 0

such that WΣ  = 0.
   An intuition for Proposition 1.1 is that when  =  Chamberlain’s generalized within-group
transform of W eliminates all residual variation in W over time. This is because the  predictors
X perfectly (linearly) predict each element of W when  = . Consequently the deviation of

                                                  8
W from its ‘within-group mean’ is identically equal to zero; any approach based on within-unit
variation will necessarily fail.
    As a simple example consider the one period ( =  = 1) ‘panel data’ model where, suppressing
the  subscript,
                                        = δ 0 + (  )                                  (16)

with  scalar. Under Assumption 1.1 this gives (9) with W = 1 and X = . The generalized
                                                      ³ 2 ´−1
                                                              
within-group operator for this model is  (X) = 1 −  Φ(X)   Φ(X) = 0 Consequently Y  =
W = 0 and (11) does not identify δ 0 . By Proposition 1.1 I (δ 0 ) = 0 We show that δ 0 and β 0 are
irregularly identified in this model below.
                                                              √
    We do not provide a general result on when regular  estimation of β0 is possible. However
some insight into this question can be gleaned from a few examples. First, when  = , it appears
as though β0 will not be regularly identifiable unless δ 0 is known. This can be conjectured by the
form of (15) which will generally be infinite if I (δ 0 )−1 is. Even if δ 0 is known regular identification
can be delicate. Consider the  =  = 1 model given above. In this model the right-hand-side of
(12) above specializes to E [( − δ 0 ) ], which will be undefined in  has positive density in the
neighborhood of zero.
    Less obviously, regular estimation may be impossible in heavily overidentified models (i.e., those
where  substantially exceeds ).13 To illustrate again consider (16) with δ 0 known, but with  ≥ 2.
Assume further that Σ (X) =  and  =  ·  where

                                                                  
                                          ∼ U [ ]     ∼ N (0 1) 

Variation in  over time in this model is governed by , which varies across units. For those units
with  close to zero,  will vary little across periods. The unit specific design matrix in this model
                             P
is given by X0 Σ−1 (X) X =  2 ·  ∼ 2 · U [ ]. If 0     then
                                                              (
                               h¡           ¢−1 i                  ln()−ln()
                                                                                  ≥3
                              E X0 Σ−1 (X) X      =                     −2           
                                                                   ∞              3

so the right-hand-side of (12) will be well-defined if  ≥ 3. If  ≤ 0, then it is undefined regardless
of the number of time periods. If  ≤ 0 the support of  will contain zero, ensuring a positive
density of units whose values of X do not change over time. These ‘stayers’ will have singular
design matrices in (13), causing the variance bound for β0 to be infinite.
    To summarize regular identification of β0 requires suﬃcient within-unit variation in X for
all units. This is a very strong condition. Many microeconometric applications are characterized
by a preponderance of stayers.14 While time series variation in X is essential for identification,
  13
     In contrast the variance bound for  0 will be finite when    as long as there is some variation in X over
time.
  14
     In Card’s (1996) analysis of the union wage premium, for example, less than 10 percent of workers switch between
collective bargaining coverage and non-coverage across periods (Table V, p. 971).



                                                          9
persistence in its process is common in practice. This persistence will often imply that the right-
hand-side of (12) is undefined.

1.3   Irregular identification
In this section we show that, under weak conditions, δ 0 and β0 are irregularly identified when
 =  We show how to extend our methods to the irregular    (overidentified) case in Section
3 below. Let
                                         = det (X)

and
                                                  X∗ = adj (X)
                                                                        1
respectively denote the determinant and adjoint of X such that X−1 =     X∗ when the former
exists. In what follows we will often refer to units where  = 0 as stayers. To motivate this
terminology consider the case where  =  = 2 with W and X in (9) equal to
                                          Ã       !             Ã             !
                                              0                     1 1
                                 W=                       X=                     
                                              1                     1 2

with  scalar. This corresponds to a model with (i) a random intercept and slope coeﬃcient and
(ii) a common intercept shift between periods one and two. In this model

                                           = 2 − 1 = ∆;

hence  = 0 corresponds to ∆ = 0, or a unit’s value of  ‘staying’ fixed across the two periods.
More generally  = 0 if two or more rows of X coincide, which occurs if X does not change across
adjacent periods or reverts to an earlier value in a later period. Loosely-speaking, we may think of
stayers as units whose value of X changes little across periods.
    Let Y∗ = X∗ Y and W∗ = X∗ W equal Y and W after premultiplication by the adjoint of X.
In the  =  = 2 example introduced above we have
                    Ã             !                Ã                      !                 Ã         !
               ∗        2 −1                ∗           2 1 − 1 2                ∗        −1
             X =                         Y =                                        W =                 
                        −1  1                                  ∆                                1

    In an abuse of notation let β 0 () = E [ β0 (X)|  = ]  Our identification result, in addition to
(9), requires the following assumption.

Assumption 1.2 (Smoothness and Continuity)
                                                                Z   
(i) For some 0  0  = det (X) has Pr (||  ) =           () d with  ()  0 for all  ≤ 0 ;
       h       i                                         −
(ii) E kW∗ k2  ∞ and E [ W∗0 W∗ |  = 0] is nonsingular; and
(iii) the functions β0 ()  (), E [ W∗ |  = ]  and E [ W∗0 W∗ |  = ] are continuous in  for


                                                          10
−0 ≤  ≤ 0 .

    Part (i) of Assumption 1.2 is essential as our approach involves conditioning on diﬀerent values
of . While the requirement that  has positive density near zero is indispensable, the implication
that Pr ( = 0) = 0 can be relaxed. In Section 3 we show how to deal with the case where the
distribution  has a point mass at zero. This may occur if the distribution of X has mass points
at a finite set of values, while being continuously distributed elsewhere. If there is overlap in the
mass points of X and X ( 6= ), then the distribution of  will have a mass point at zero.
    Part (ii) of Assumption 1.2 is required for identification of δ 0 . It will typically hold in well-
specified models and is straightforward to verify. Part (iii) is a smoothness assumption which, in
conjunction with (i), allows us to trim without changing the estimand.

Identification of the aggregate time eﬀects, δ 0 : We begin by premultiplying (9) by X∗ to
get
                              E [ Y∗ | X] = W∗ δ 0 +β0 (X) 

where we use the fact that  = X∗ X. Conditioning on the subpopulation of ‘stayers’ yields

                                      E [ Y∗ | X = 0] = W∗ δ 0                                   (17)

Under Assumption 1.2 equation (17) implies that δ 0 is identified by the conditional linear predictor
(CLP)
                             £        ¯       ¤−1        £        ¯       ¤
                      δ 0 = E W∗0 W∗ ¯  = 0       × E W∗0 Y∗ ¯  = 0                           (18)

Equation (18) shows that the subpopulation of stayers is used to tie down the aggregate time eﬀects,
δ 0 . Since stayer’s correspond to units whose values of X change little over time, the evolution of
 among these units is driven by the aggregate time eﬀects. This approach to identifying δ 0 is
reminiscent of Chamberlain’s (1986) ‘identification at infinity’ result for the intercept of the censored
regression model (p. 205). Both approaches use a small subpopulation to tie down a feature of
the entire population. An important diﬀerence is that our result does not require X to have
unbounded support. Consequently, our identification result is not sensitive to the ‘tail properties’
of the distribution of X Our key requirement, that  have positive density in a neighborhood
about zero, is straightforward to verify. We do this in the empirical application by plotting a kernel
density estimate of  (), the density of .
      In the  =  = 2 example we have, conditional on  = 0 the equality Y∗ = W∗ ∆ so that
(18) simplifies to, recalling that  = ∆,

                                        δ 0 = E [ ∆ | ∆ = 0]                                     (19)

The common intercept shift is identified by the average change in  in the subpopulation of
stayers. Identification of δ 0 is irregular since Pr ( = 0) = 0; δ 0 corresponds to the value of the
nonparametric mean regression of ∆ given  at  = 0 Note the importance of the (verifiable)

                                                   11
requirement that 0  0 for this result.
   As a second example of (18) consider the one period ‘panel data’ model introduced above. From
(16) we have
                                         E [  |  = 0] = δ 0 ,

or ‘identification at zero’.

Identification of the average partial eﬀects, β0 : Treating δ 0 as known we identify β0 (x)
for all x such that  is non-zero by
                                            £               ¯      ¤
                                  β0 (x) = E X−1 (Y − Wδ 0 )¯ X = x                             (20)

It is instructive to consider the  =  = 2 case introduced above. In that model the second
component of the right-hand side of (20), corresponding to the slope coeﬃcient on  , evaluates to

                                           E [ ∆ | X = x] − δ 0
                               β20 (x) =                                                         (21)
                                                 2 − 1
                                           E [ ∆ | X = x] − E [ ∆ | ∆ = 0]
                                      =
                                                        2 − 1

where the second, diﬀerence-in-diﬀerences, equality follows by substituting in (19) above. Equation
(21) indicates that the average slope coeﬃcient, in a subpopulation homogenous in X = x, is equal
to the average ‘rise’ — E [ ∆ | X = x] — over the common ‘run’ — 2 − 1 . The evolution of 
amongst stayers is used to eliminate the aggregate time eﬀect from the average rise (i.e., to control
for ‘common trends’) in this computation.
    Using (21) we then might try, by appealing to the law of iterated expectations, to identify β 20
by                                          ∙           ¸
                                              ∆ − δ 0
                                          E                                                     (22)
                                                ∆
An approach based on (22) was informally suggested by Mundlak (1961, p. 45). Chamberlain (1982)
considered (22) with δ 0 = 0, showing that it identifies β20 if E [|∆ ∆|]  ∞. However, if ∆ has
a positive, continuous density at zero — and if E[|∆ | | ∆ = ]−δ0 does not vanish at  = 0 — then
(22) will not be finite. For example, if ∆ and ∆ are independently and identically distributed
according to the standard normal distribution, then ∆ ∆ will be distributed according to the
Cauchy distribution, whose expectation does not exist.
   More generally the expectation
                                            £               ¤
                                           E X−1 (Y − Wδ 0 )

will be undefined if the distribution of X is such that  has a positive density in the neighborhood
of  = 0 (i.e., there is a positive density of ‘stayers’) This will occur when, for example, at least
two rows of X ‘nearly’ coincide for ‘enough’ units (i.e., when part (i) of Assumption 1.2 holds).


                                                    12
   To deal with the small denominator eﬀects of stayers we trim. Under parts (i) and (iii) of
Assumption 1.2 we have the equalities (see equation (42) in the Appendix)

                           β0 = E [β0 (X)]
                               = lim E [β0 (X) · 1 (||  )]
                                 ↓0
                                       £                            ¤
                               = lim E X−1 (Y − Wδ 0 ) · 1 (||  )                           (23)
                                   ↓0


so that β0 is identified by the limit of the trimmed mean of X−1 (Y − Wδ 0 ). Trimming elimi-
nates those units with near-singular design matrices (i.e., stayers); by taking limits and exploiting
continuity we avoid changing the estimand.
    Note that if there is a point mass of stayers such that Pr ( = 0) =  0  0, then (23) does not
equal β0 , instead it equals
                                      β
                                       0 = E [ β 0 (X)|  6= 0] 

or the movers average partial eﬀect (MAPE). Let β0 = E [ β0 (X)|  = 0] equal the corresponding
stayers average partial eﬀect (SAPE). In Section 3 we show how to extend our results to identify
the full average partial eﬀect β0 =  0 β 0 + (1 −  0 ) β
                                                           0 in this case.
    The following proposition, which is proven in the Appendix as a by-product of the consistency
part of Theorem 2.1 below, summarizes our main identification result.

Proposition 1.2 (Irregular Identification) Suppose that (i) (0  δ0  β0 (·)) satisfies (9), (ii)
Σ (x) is positive definite for all x ∈ X  (iii)  =  and (iv) Assumption 1.2 holds, then δ 0 and
β0 are identified by, respectively, (18) and (23).


2    Estimation
Our approach to estimation is to replace (18) and (23) with their sample analogs. We begin by
discussing our estimator for the common parameters δ 0  Let  denote some bandwidth sequence
such that  → 0 as  → ∞. We estimate δ 0 by the nonparametric conditional linear predictor
fit:
          ∙                                  ¸−1 ∙                                ¸
     b=         1 X                    ∗0 ∗         1 X                    ∗0 ∗
     δ                 1 (| | ≤  ) W W    ×           1 (| | ≤  ) W Y              (24)
                =1                               =1


This estimator has asymptotic properties similar to a standard (uniform) kernel regression fit for a
one-dimensional problem. In particular, in the proof to Lemma A.2 in the Appendix we show that
                                  ³ ´   µ      ¶    µ ¶
                                            1        1
                                 V b
                                   δ =          À     
                                                  

so that its mean squared error (MSE) rate of convergence is slower than 1 when  → 0. We
also show that the leading bias term in b
                                        δ is quadratic in the bandwidth so that the fastest rate of


                                                 13
               b to δ 0 will be achieved when the bandwidth sequence is of the form
convergence of δ

                                                       ∗ ∝  −15 
                                                √    ³       ´
To center the limiting distribution of                b − δ 0 at zero we use a bandwidth sequence that
                                                   δ
approaches zero faster than the MSE-optimal one. In particular we assume that (  )12 2 → 0
as as  → ∞. We discuss our chosen bandwidth sequence in more detail below.
    With b
         δ in hand we then estimate β0 using the trimmed mean15
                                           X                             ³           ´
                                     1
                                                   1 (| |   ) X−1      Y − W
                                                                                    b
                                                                                    δ
                                                                      
                               b=
                               β               =1
                                                      X                                         (25)
                                                   1
                                                            1 (|  |    )
                                                             =1

                                       b we begin by considering those of the infeasible estimator
To derive the asymptotic properties of β
based on the true value of the time eﬀects, δ 0 :
                                           X
                                       1
                                                    1 (| |   ) X−1  (Y − W δ 0 )
                              b =
                              β                =1
                                                        X                                       (26)
                                
                                                     1
                                                              1 (|  |    )
                                                             =1

Like b
     δ the variance of βb is of order 1  , however its asymptotic bias is linear, not quadratic,
                          
in  . The fastest feasible rate of convergence of β  b to β is consequently slower than the that
                                                              0
                                                                                    √    ³         ´
   b to δ 0 ( −23 versus  −45 ). In order to center the limiting distribution of   β
of δ                                                                                       b −β
                                                                                                0

at zero we assume that (  )12  → 0 as as  → ∞ This is stronger than what is needed to
appropriately center the distribution of the aggregate time eﬀects. ³        ´
                                                            √
    The value of studying the large sample properties of   β       b −β     is that our feasible
                                                                          0
                                     b and δ:
estimator is a linear combination of β       b
                                                
                                                         ³       ´
                                               b=β
                                               β b +Ξb 
                                                          b
                                                          δ − δ 0                                (27)
                                                   


with
                                                     X
                                                1
                                                           1 (| |   ) X−1
                                                                              W
                                  b
                                  Ξ        =               =1
                                                           X                                     (28)
                                                       1
                                                               1 (| |   )
                                                                 =1
                                                     X
                                                1
                                                           1 (| |   ) −1 W∗
                                                           =1
                                           =               X                        
                                                       1
                                                                1 (| |   )
                                                                 =1

              b  and δ
    Note that β       b are respectively computed using the | |   and | | ≤  subsamples,
so they are conditionally independent given the {X }. This independence exploits the fact that
 15
      The denominator in (25) could be replaced by 1.



                                                                 14
the same bandwidth sequence is used to estimate δ b and β;
                                                         b it also results from our choice of the
uniform kernel, which has bounded support. We proceed under these maintained assumption,
                                                            b to δ 0 is well below its optimal one.
acknowledging that it means that the rate of convergence of δ
We view the gains from using the same bandwidth sequence for both δb and βb — in terms of simplicity
and transparency of asymptotic analysis — as worth the cost in generality.
    Lemma A.3 in the Appendix shows that

                                          £                      ¤
                            b →
                            Ξ    Ξ0 ≡ lim E 1 (| |  ) −1 W∗ 
                                          ↓0


We therefore recover the limiting distribution of the feasible estimator βb from our results on β b
    b using a delta method type argument based on (27).
and δ
   To formalize the above discussion and provide a precise result we require the following additional
assumptions.

Assumption 2.1 (Random Sampling) {(Y  X )}
                                             =1 are i.i.d. draws from a distribution 0
which satisfies condition (9) above.
                                     h                      i
Assumption 2.2 (Bounded Moments) E kX∗ Y k4 + kX∗ W k4  ∞

Assumption 2.3 (Smoothness) β0 () (), E [ W∗ |  = ]  E [ W∗0 W∗ |  = ], E [ X∗ Σ (X) X∗0 |  = ] 
and  () = E [ kX∗ Y k + kX∗ W k |  = ] exist and are twice continuously diﬀerentiable for 
in a neighborhood of zero and 0 ≤  ≤ 4.

Assumption 2.4 (Local Identification) E [ X∗ Σ (X) X∗0 |  = 0] is positive definite.

Assumption 2.5 (Bandwidth) As  → ∞ we have  → 0 such that   → ∞ and
(  )12  → 0.

    Assumption 2.1 is a standard random sampling assumption. Our methods could be extended
to consider other sampling schemes in the usual way. Assumptions 2.2 and 2.3 are regularity
conditions that allow for the application of Liapunov’s central limit theorem for triangular
                                                                                          ³ arrays´
                                                                                   √
(e.g., Serfling, 1980). Assumption 2.5 is a bandwidth condition which ensures that   β  b − β0
is asymptotically centered at zero with a finite variance as discussed below.
    The smoothness imposed by Assumption 2.3 can be restrictive. For example if  =  = 2 with
X = (1  )0 and 1 and 2 independent exponential random variables with parameter 1, then
 = ∆ will be a Laplace(0 ) random variable (the density of which is non-diﬀerentiable at zero).
Non-diﬀerentiablility of the density of  at  = 0 will prevent us from consistently estimating the
common time eﬀects, δ (and, consequently, also β0 ). To gauge the restrictiveness of Assumption 2.3
note that twice continuous diﬀerentiability is required for nonparametric kernel estimation of, for
example, () and E [ W∗ |  = ], and is, consequently, a standard assumption in the literature on
nonparametric density and conditional moment estimation (e.g., Pagan and Ullah, 1999; Chapters
2, 3).

                                                 15
Theorem 2.1 (Large Sample Distribution) Suppose that (i) (0  δ 0  β0 (·)) satisfies (9), (ii)
Σ (x) is positive definite for all x ∈ X  (iii)  =  and (iv) Assumptions 1.2 to 2.5 hold, then
b           b→ 
δ → δ 0 and β     β0 with the normal limiting distribution
                     Ã            !                                Ã                 Λ0 Ξ00
                                                                                                   !
             p           b − δ0
                         δ            
                                                                        Λ0
                                                                        20           20
                                   → N (0 Ω0 )         Ω0 =                          Ξ Λ Ξ0
                         b − β0
                         β                                             Ξ0 Λ0
                                                                               2Υ0 0 + 020 0
                                                                        20                  0


   where
              £       ¯      ¤−1 £ ∗0 ∗               ¯     ¤ £     ¯      ¤−1
        Λ0 = E W∗0 W∗ ¯  = 0   E W X Σ (X) X∗0 W∗ ¯  = 0 E W∗0 W∗ ¯  = 0
                                    £             ¯      ¤
                              Υ0 = E X∗ Σ (X) X∗0 ¯  = 0 

     We comment that, in contrast to the irregularly identified semiparametric models discussed in
Heckman (1990), Andrews and Schafgans (1998), and Khan and Tamer (2009), the rate of conver-
gence for our estimator does not depend on delicate ‘relative tail conditions’. Our identification
approach is distinct from the type of ‘identification and infinity’ arguments introduced by Cham-
berlain (1986) and leads to a somewhat simpler asymptotic analysis.
     It is instructive to compare the asymptotic variances given in Theorem 2.1 with Chamberlain’s
regular counterparts (given in (14) and (15) above). First consider the asymptotic variance of b        δ.
In our setup W∗ plays a role analogous to the generalized within-group transformation of W used
by Chamberlain (i.e., WΦ = Φ (X) W). Viewed in this light the form of Λ0 is similar to that of
I (δ 0 )−1 in the regular case. The key diﬀerence is that (i) the expectations in Λ0 are conditional on
 = 0 (i.e., averages over the subpopulation of stayers) and (ii) the variance of b     δ varies inversely
                                                                              b
with 0 . The greater the density of stayers, the easier it is to estimate δ. We comment that we
could estimate b  δ more precisely if we replaced (24) with a weighted least squares estimator. We do
not pursue this idea here as it would require pilot estimation of Σ (X), a high dimensional object,
and hence is unlikely to be useful in practice.
     The asymptotic                 b
                        variance of β                                    −1
                h¡              ¢   i also parallels the form of I (β 0 ) . The first term, 2Υ0 0 , plays
                                 −1
the role of E X0 Σ−1 (X) X            in (15). This term corresponds to the average of the conditional
sampling variances of the unit specific slope estimates. The ‘better’ the typical unit-specific design
matrix, the greater the precision of the average β.   b In the irregular case 2Υ0  captures a similar
                                                                                     0
eﬀect. There the average is conditional on  = 0 In contrast to the aggregate time eﬀects, the
first term in the variance of β b varies linearly with  ; suggesting that a small density of stayers is
                                                          0
better for estimation of β0 
     The second term in β’s  b variance is analogous to the I (δ 0 )−1  0 term in (15). This term
captures the eﬀect of sampling variation in δ    b on that of β.
                                                               b Note that  is equal to the average
of the  ×  matrix of coeﬃcients associated with the unit-specific GLS fit of the  × 1 vector W
given the  × 1 vector of regressors X . It is instructive to consider an example where there is
                                                                          ¡          ¢0
no asymptotic penalty associated with not knowing δ 0  Let W = 0 −1   −1 and X = (1  )0
with  scalar such that  = 2 and δ 0 corresponds to a  =  − 1 vector of time-specific intercept


                                                       16
shifts. If the distribution of  is stationary over time, then realizations of  cannot be used to
predict the time period dummies. In that case each column of  will consist of a vector of zeros
with the exception of the first element (which will equal 1 ) . The lower-right-hand element of
I (δ 0 )−1  0 will equal zero so that ignorance of δ 0 does not aﬀect the precision which which the
second component of β0 , corresponding to the average slope, may be estimated.16
    Now consider the irregular case where  =  = 2. We have
                                             "                      Ã         !#
                                                           1            −1
                                  Ξ0 = lim E 1 (|∆|  )                           
                                       ↓0                ∆             1

so that the lower-right-hand element of Ξ0 Λ0 Ξ00 will equal zero if lim E [1 (|∆|  ) ∆] = 0.
                                                                              ↓0
This condition will hold if, for example, 1 and 2 are exchangeable, so that ∆ is symmetrically
distributed about zero (at least for |∆| in a neighborhood of zero). This will ensure the asymptotic
equivalence of the feasible estimator b and its infeasible counterpart 
                                                                        b .
    Chamberlain’s variance bound for β0 contains a third term the analog of which is not present
in the irregular case. This term, V (β0 (X)), captures the eﬀect of heterogeneity in the conditional
average of the random coeﬃcients on the asymptotic variance of .    b In the irregular case a term
equal to V (β 0 (X))  also enters the expression for the sampling variance of   b (see the calcula-
tions immediately prior to Equation (45) in the Appendix). However this term is asymptotically
dominated by the two terms listed in Theorem 2.1 (which are of order 1  ). The variance
estimator described in Theorem 2.2 below implicitly accounts for this asymptotically dominated
component.
    The conditions of Theorem 2.1 place only weak restrictions on the bandwidth sequence. As
is common in the semiparametric literature we deal with bias by undersmoothing. The appendix
shows that the fastest rate of convergence of β  b for β in mean square is achieved by bandwidth
                                                         0
sequences of the form,
                                           ∗ = 0  −13 

where the mean squared error minimizing choice of constant is
                         µ        ¶13 ½h                        ∙               ¸¾
                     1       1           ¡      
                                                  ¢¡      ¢ i−1
                                                         0             Ξ0 Λ0 Ξ00 13
                0 =                      β0 − β0 β0 − β0       × 2Υ0 +                                     (29)
                     2       0                                           220

and β0 = E [ β0 (X)|  = 0] equals the average of the random coeﬃcients in the subpopulation
of stayers. While the bandwidth sequence ∗ achieves the fastest rate of convergence for our
estimator, the corresponding asymptotic normal distribution for (b ∗ ) will be centered at a bias
                                                                       
          ¡        ¢
term of 2 β0 − β0 0  To eliminate this bias Assumption 2.5 requires that  → 0 fast enough
such that (  )12  → 0 as  → ∞, but slow enough such that (  )12 → ∞. A bandwidth
sequence which converges to zero slightly faster than ∗ is suﬃcient for this purpose. In particular
  16
   Sampling error in the estimated time eﬀects does aﬀect the precision with which the common intercept, the first
component of 0  may be estimated



                                                       17
if
                                            = ( −13 )
     √       ³         ´
then  β     b − β will be asymptotically centered at zero.
                     0
    An alternative to undersmoothing would be to use a plug in bandwidth based on a consistent
                       b Such an approach is taken by Horowitz (1992) in the context of smoothed
estimate of (29), say .
maximum score estimation. Denote the resulting estimate by β  b (PI for ‘plug in’). Let βb be the
                                                               PI
                                                         
consistent undersmoothed estimate of Theorem 2.1 and β  b and  b estimates of β and  . The
                                                                  0               0       0
bias corrected estimate is then
                                          ³      ´
                                 b =β
                                 β    b −2 β   b 
                                            b −β   b 
                                                      b −13 
                                   BC  PI           0


Unlike undersmoothing, this does not slow down the rate of convergence of β    b
                                                                                 BC to β 0 . A dis-
advantage is that it is more computationally demanding. In the empirical application below we
experiment with a number of bandwidth values. A more systematic analysis of bandwidth selection,
while beyond the scope of this paper, would be an interesting topic for further research.

Computation and consistent variance estimation: The computation of b            δ and βb is facilitated
by observing that the solutions to (24) and (25) above coincide with those of the linear instrumental
variables fit                  ∙ X              ¸−1 ∙ X                ¸
                           b      1         0          1         0 ∗
                           θ=              Q R     ×            QY 
                                       =1                 =1  
        ¡       ¢0
for θ = δ 0  β0 and
            µ                                       ¶
              −1                ∗ 1 (| |   )
       Q =  1 (| | ≤  ) W                          R = (W∗  1 (| |   )   ) 
      ×+                                                  ×+


where the dependence of Q and R on  is suppressed.
                                             b when the bandwidth is held fixed at ; then, by
   Let θ () denote the probability limit of θ
standard GMM arguments,
                     ∙              ¸−1 ∙ X               ¸ ∙ X        ¸−1
                         1 X                0 b + b +0    1 
          b () =              0
                               Q R    ×      Q U U Q ×          0
                                                                  Q R                                 (30)
                           =1          =1              =1 

                                                           √  ³          ´
is a consistent estimate of the asymptotic covariance of     θb − θ () with

                                                         b
                                          b + = Y∗ − R θ
                                          U 


Conveniently, this covariance estimator remains valid when, as is required by Theorem 2.1, the
bandwidth shrinks with  .
                                                                      h                    i
Theorem 2.2 Suppose the hypotheses of Theorem 2.1 hold, and that E kX∗ Y k8 + kX∗ W k8 


                                                  18
                                                               
∞ and that Assumption 2.3 holds for  ≤ 8 Then b ≡ b ( ) → Ω0 .

    Relative to a direct estimate of Ω0 , (30) implicitly includes estimates of terms that, while asymp-
totically negligible, may be sizeable in small samples. Consequently confidence intervals constructed
using it may have superior properties (cf., Newey, 1994b; Graham, Imbens and Ridder, 2009).
    Operationally estimation and inference may proceed as follows. Let Y     ∗  R and Q denote the
                                                                                          
 
 rows of their corresponding matrices. Using standard software compute the linear instrumental
                   ∗ onto R using Q as the instrument (exclude the default constant term from
variables fit of Y                  
this calculation). By Theorem 2.2 the ‘robust/clustered’ (at the unit-level) standard errors reported
by the program will be asymptotically valid under the conditions of Theorem 2.1.


3         Extensions
In this section we briefly develop three direct extensions of our basic results. In Section 5 we discuss
other possible generalizations and avenues for future research.

3.1         Linear functions of β0 (X)
In some applications the elements of X may be functionally related. For example
                                                 ³                           ´0
                                             X = 1   2      −1                     (31)

In such settings β0 indexes the average structural function (ASF) of Blundell and Powell (2003).
To emphasize the functional dependence write X = x ( ), then

                                                ( ) = x ( )0 (β0 + δ 0 ) 

gives the expected period  outcome if (i) a unit is drawn at random from the (cross sectional)
population and (ii) she is exogenously assigned input level  =  . Similarly, diﬀerences of the
form
                                           ¡ ¢
                                          0 −  ( ) 

give the average period  outcome diﬀerence across two counterfactual policies: one where all units
are exogenously assigned input level  =  0 and another where they are assigned  =  . Since it
is a linear function of β0 and δ 0 Theorem 2.1 can be used to conduct inference on  ( ).
    In the presence of functional dependence across the elements of X the derivative of  ( ) with
respect to  does not correspond to an average partial eﬀect (APE).17 Instead such derivatives
characterize the local curvature of the ASF. In such settings the average eﬀect of a population-wide
    17
         We thank a referee for several helpful comments on this point.




                                                              19
unit increase in  (i.e., the APE) is instead given by
                                 ∙                   ¸         ∙µ                ¶0              ¸
                         (x ( ))                            x ( )
                γ 0   ≡ E                               = E                           (  )                (32)
                                                                    
                                                               ∙µ                ¶0                         ¸
                                                                     x ( )
                                                         = E                          (β0 (x ( )) + δ0 ) 
                                                                       

where the second equality follows from iterated expectations and Assumption 1.1. Because x ( ) 
may covary with β 0 (x ( )) Theorem 2.1 cannot be directly applied to conduct inference on γ 0 .
Fortunately it is straightforward to extend our methods to identify and consistently estimate pa-
rameters of the form

                                           γ 0 = E [Π (X) (β0 (X) + δ 0 )]
                                                    = γ 0 + E [Π (X)] δ 0 

where Π (x) is a known function of x and γ 0 = E [Π (X) β0 (X)]  If X is given by (31), for example,
then to estimate the APE we would choose

                                           x ( ) ³                                      ´
                             Π (x) =                = 0 1 2  32     ( − 1) −2 
                                             

   In order to estimate γ 0 we proceed as follows. First, identification and estimation of δ 0 is
unaﬀected. Second, using (20) gives for any x with  =
                                                     6 0
                                                      £               ¯      ¤
                                     γ 0 (x) = Π (x) E X−1 (Y − Wδ 0 )¯ X = x 

so that
                                        £                                   ¤
                             γ 0 = lim E Π (X) X−1 (Y − Wδ 0 ) · 1 (||  ) 
                                         ↓0

This suggests the analog estimator
                                         X                                      ³          ´
                                     1
                                                   1 (| |   ) Π (X ) X−1    Y − W
                                                                                          b
                                                                                          δ
                                              =1                           
                             b=
                             γ                            X                                  
                                                       1
                                                                1 (| |    )
                                                             =1

   An argument essentially identical to that justifying Theorem 2.1 then gives
                             Ã                 !         ⎛ ⎛                                             ⎞⎞
                                                                                    Λ0 Ξ0Π0
               p                 b
                                 δ − δ0            
                                                                     Λ0
                                                → N ⎝0 ⎝        20
                                                                   ΞΠ0 Λ0
                                                                                      20
                                                                                         ΞΠ0 Λ0 Ξ0Π0
                                                                                                         ⎠⎠     (33)
                                 b − γ0
                                 γ                                           2ΥΠ0 0 +
                                                                    20                      20


with
                                          £                         ¯      ¤
                                 ΥΠ0 = E Π (X) X∗ Σ (X) X∗0 Π (X)0 ¯  = 0
                                             £                         ¤
                                 ΞΠ0 = lim E 1 (||  ) Π (X) X−1 W 
                                                   ↓0


                                                               20
   We can then estimate γ 0 by
                                            b = γ
                                            γ      bb
                                                 b+Πδ

with Πb = P Π (X )  . To conduct inference on γ 0 we use the delta method treating Π b as
              =1
known. We may ignore the eﬀects of sampling variability in Πb since its rate of convergence to
E [Π (X)] is 1

3.2   Density of  has a point mass at  = 0
                                                                                  
In some settings a positive fraction of the population may be stayers such that  0 ≡ Pr ( = 0)  0
This may occur even if all elements of  are continuously-valued. If the only continuous component
of X is the logarithm of annual earnings, for example, a positive fraction of individuals may have
the same earnings level in each sampled period. This may be especially true if many workers are
salaried.
    A point mass at  = 0 simplifies estimation of δ 0 and complicates that of β 0 . When  0  0
the estimator
                   ∙                           ¸−1 ∙ X                     ¸
              b=       1 X               ∗0 ∗      1                ∗0 ∗
              δ               1 ( = 0) W W    ×       1 ( = 0) W Y 
                         =1                        =1

        √
will be  -consistent and asymptotically normal for δ,b as would be the (asymptotically equivalent)
estimator described in Section 2 above.
    The large sample properties of the infeasible estimator βb  — see equation (26) — are unaﬀected
by the point mass at  = 0 with two important exceptions. First its probability limit is no longer
β0  the (full population) average partial eﬀect, but β 0 = E [ β 0 (X)|  6= 0], the movers’ APE
introduced in Section 1. Second, its asymptotic
                                         ³         variance
                                                    ´       ³is scaled ´up by 1 −  0 , the population
                                  √                    
                                           b
proportion of movers. This gives   β − β0 → N 0 2Υ
                                                                   0 0
                                                                  1− 0 
                                      b  equal the feasible estimator defined by (25). Using
   Reflecting the change of plims let β
decomposition (27) we have
               p    ³      ´   p     ³          ´     p     ³        ´
                     b − β
                  β        =     βb  − β + Ξ
                                                   b    
                                                              b
                                                              δ − δ 0
                          0                    0
                                p     ³          ´       ³p ´
                              =    β b − β + Ξ0      
                                              0
                                p     ³          ´
                              =    β b − β +  (1) 
                                              0


                                   b  are unaﬀected by those of b
so that the sampling properties of β                             δ In particular, adapting the
argument used to show Theorem 2.1 yields

                              p    ³      ´     µ          ¶
                                    b − β →        2Υ0 0
                                 β    0     N  0          
                                                     1 − 0




                                                 21
      If a consistent estimator of the stayers eﬀect

                                                 β0 ≡ E[ β 0 (X)|  6= 0]

can be constructed, a corresponding consistent estimator of the APE β0 =  0 β0 + (1 −  0 )β0
would be
                                         b≡
                                         β     b  + (1 − 
                                              bβ          b)βb 
           P                             √
      b≡ 
where         =1 1(| | ≤  ) is a    -consistent estimator for  0 
   Inspection of the equation immediately preceding (17) in Section 1 suggests one possible esti-
mator for β0  We have
                                    E [ Y∗ | X] = W∗ δ 0 +β0 (X) 

so that
                                                   E [ Y∗ |  = ] − E [ Y∗ |  = 0]
                                    β0 = lim                                        
                                             ↓0                   
which suggests the estimator
            Ã         !               
                 δ                    X                    ¡                 ¢0 ¡              ¢
                         = arg min         1 (| | ≤  ) Y∗ − W∗ δ− β Y∗ − W∗ δ− β 
                b
                β                 =1

                       √
with δ an alternative -consistent estimator for δ0 . Since the rate of convergence of a nonpara-
metric estimator of the derivative of a regression function is lower than for its level, the rate of
convergence of the combined estimator β  b ≡  b  + (1 − 
                                              bβ            b  will coincide with that of β
                                                          b)β                               b   and
the asymptotic distribution of the latter would dominate the asymptotic distribution of β  b in this
setting. We comment that part (iii) of assumption 1.2 may be less plausible in settings where
Pr ( = 0)  018 It such settings ‘stayers’ may be very diﬀerent from ‘near stayers’ such that a
                                               b  would be problematic.
local linear regression approach to estimating β

3.3      Overidentification (  )
                                                           √
When    the vector of common parameters δ 0 may be  consistently estimated, as first
suggested by Chamberlain (1992), by the sample counterpart of (11) above:
                                "
                                                         #−1      "
                                                                                   #
                            b  1 X 0       −1                    1 X 0
                            δ=     WΦ Φ WΦ                  ×     WΦ Φ (X) YΦ 
                                                                
                                      =1                             =1

with Φ ≡ Φ(X ) positive definite with probability one.
    The discussion in Section 1, however, suggests that Chamberlain’s (1992) proposed estimate of
β0 , the sample average of

                                      b  ≡ (X0 Φ−1 X )−1 X0 Φ−1 (Y − W δ)
                                      β                                    b
                                                           
 18
      We thank a referee for this observation.


                                                             22
         √
    b a  -consistent estimator of δ 0 , may behave poorly and will be formally inconsistent when
for δ
I (β 0 ) = 0
    Adapting the trimming scheme introduced for the just identified  =  case, a natural modifi-
cation of Chamberlain’s (1992) estimator is
                       P          0 −1                 0 −1     −1 0 −1
                        =1 1(det(X Φ X )   ) · (X Φ X ) X Φ (Y         − W b
                                                                                         δ)
                β̂ =                   P                                                     
                                                      0 −1
                                        =1 1(det(X Φ X )   )

If                                        ∙               ¸
                                                 1
                                        E                    ∞                                       (34)
                                          det(X0 Φ−1
                                                    X )

then the introduction of trimming is formally unnecessary but may still be helpful in practice. It
is straightforward to show asymptotic equivalence of the (infeasible) trimmed mean
                       P          0 −1                  0 −1    −1 0 −1
                        =1 1(det(X Φ X )   ) · (X Φ X ) X Φ (Y         − W δ 0 )
               β̂ =                    P                                                        
                                                       0 −1
                                         =1 1(det(X Φ X )   )

with Chamberlain’s (1992) proposal when E[ β(X)| det(X0 Φ−1   X ) ≤ ] is smooth (Lipschitz-continuous)
                                               √
in  condition (34) holds, and  = (1  ) Since ̂ will still be consistent for  even when
(34) fails, a feasible version of the trimmed mean ̂ may be better behaved in finite samples if the
design matrix (X0 Φ−1 X ) is nearly singular for some observations.



4    Application
In this section we use our methods to estimate an elasticity of calorie demand. Our goal is to
provide a concrete illustration of our methods, to compare them with alternatives which presume
the absence of any nonseparable correlated heterogeneity, and to highlight the practical importance
of trimming.

Model specification: We assume that the logarithm of total household calorie availability per
capita in period , ln (Cal ), varies according to

                              ln (Cal ) = 1 (  ) + 2 (  ) ln(Exp )                      (35)

where Exp denotes real household expenditure per capita in year  and 1 (  ) and 2 (  ) are
random coeﬃcients; the latter equals the household-by-period-specific elasticity of calorie demand.
Let  (  ) = (1 (  ) 2 (  ))0  X = (1 ln(Exp ))0  and  = ln (Cal ) with X and Y as
defined above. We allow for common intercept and slope shifts over time (i.e., Assumption 1.1).
The 2000 to 2002 period coincided with a coﬀee crisis in Nicaragua, so there is some a priori reason
to believe that macro-shifts in the demand elasticity may be important.




                                                      23
       Defining W as in (8) gives a general semiparametric regression model of

                                         E[Y|W X] = Wδ + Xβ(X)

with δ containing the common intercept and slope time shifts. The second element of β(x) equals
the average (base year) elasticity of calorie demand in the subpopulation of households with X = x
(i.e., a subpopulation with a common income/aggregate expenditure history).
     Relative to prior work, the distinguishing feature of our model is that it allows for the elasticity
of calorie demand to vary across households in a way that may co-vary with total outlay. This
allows household expenditures to co-vary with the unobserved determinants of calorie demand. For
example both expenditures and calorie consumption are likely to depend on labor supply decisions
(cf., Strauss and Thomas, 1990). Allowing the calorie demand curve to vary across households
also provides a ‘nonparametric’ way to control for diﬀerences in household composition; a delicate
modelling decision in this context (e.g., Subramanian and Deaton, 1996).19

Data description: We use data collected in conjunction with an external evaluation of the
Nicaraguan conditional cash transfer program Red de Protección Social (RPS) (see IFPRI, 2005).
The RPS evaluation sample is a panel of 1,581 households from 42 rural communities in the depart-
ments of Madriz and Matagalpa, located in the northern part of the Central Region of Nicaragua.
Each sampled household was first interviewed in August/September 2000 with follow-ups attempted
in October of both 2001 and 2002. Here we analyze a balanced panel of 1,358 households from all
three waves.20
    The survey was fielded using an abbreviated version of the 1998 Nicaraguan Living Standards
Measurement Survey (LSMS) instrument. As such it includes a detailed consumption module with
information on household expenditure, both actual and in kind, on 59 specific foods and several
dozen other common budget items (e.g., housing and utilities, health, education, and household
goods). The responses to these questions were combined to form an annualized consumption ag-
gregate,  . In forming this variable we followed the algorithm outlined by Deaton and Zaidi
(2002).
    In addition to recording food expenditures, actual quantities of foods acquired are available.
Using conversion factors listed in the World Bank (2002) and Instituto Nacional de Estadísticas y
Censos (2005) (henceforth INEC) we converted all food quantities into grams. We then used the
caloric content and edible percent information in the Instituto de Nutrición de Centro América y
  19
     A limitation of our model is its presumption of linearity at the household level. Strauss and Thomas (1990) argue
that the elasticity of demand should structurally decline with household income. As we have three periods of data we
can, in principal, include an additional function of Exp in the X vector. We briefly explore this possibility below.
  20
     A total of 1,359 households were successfully interviewed in all three waves. One of these households reports
zero food expenditures (and hence calorie availability) in one wave and is dropped from our sample. The prepa-
ration of our estimation sample from the raw public release data files involved some complex and laborious data-
processing. We outline the procedures used in this section. A sequence of heavily commented STATA do files, which
read in the IFPRI (2005) release of the data and output a text file of our estimation sample is available online at
https://files.nyu.edu/bsg1/public/



                                                         24
Panamá (2000) (henceforth INCAP) food composition tables to construct a measure of daily total
calories available for each household.21 The logarithm of this measure divided by household size,
 , serves as the dependent variable in our analysis.
     The combination of both expenditure and quantity information at the household-level also
allowed us to estimate unit prices for foods. These unit values were used to form a Paasche cost-
of-living index for the  household in year  of
                             ∙ ½X                     ³          ´¾                  ¸−1
                                                       
                         =                       + (1 −  )                         (36)
                                           =1


where  is the fraction of household spending devoted to food,  the share of overall food
spending devoted to the   specific food,  the year  unit price paid by the household for food
 , and  its ‘base’ price (equal to the relevant 2001 sample median price). We use 2001 as our base
year since it facilitates comparison with information from a nationwide LSMS survey fielded that
year. Following the suggestion of Deaton and Zaidi (2002) we replace household-level unit prices
with village medians in order to reduce noise in the price data. In the absence of price information
on nonfood goods we set  equal to one in 2001 and to the national consumer price index (CPI)
in 2000 and 2002. Our independent variable of interest is real per capita consumption in thousands
of Cordobas: Exp = ([  ]) ;  is total household size.
     Tables 1 and 2 summarize some key features of our estimation sample. Panel A of Table 1
gives the share of total food spending devoted to each of eleven broad food categories. Spending on
staples (cereals, roots and pulses) accounts for about half of the average household’s food budget
and over two thirds of its calories (Tables 1 and 2). Among the poorest quartile of households an
average of around 55 percent of budgets are devoted to, and over three quarters of calories available
derived from, staples. Spending on vegetables, fruit, and meat accounts for less than 15 percent of
the average household’s food budget and less than 3 percent of calories available. That such a large
fraction of calories are derived from staples, while not good dietary practice, is not uncommon in
poor households elsewhere in the developing world (cf., Smith and Subandoro, 2007).
     Panel B of the table lists real annual expenditure in Cordobas per adult equivalent and per
capita. Adult equivalents are defined in terms of age- and gender-specific FAO (2001) recommended
energy intakes for individuals engaging in ‘light activity’ relative to prime-aged males. As a point
of reference the 2001 average annual expenditure per capita across all of Nicaragua was a nominal
C$7,781, while amongst rural households it was C$5,038 (World Bank. 2003). The 42 communities
in our sample, consistent with their participation in an anti-poverty demonstration experiment, are
considerably poorer than the average Nicaraguan rural community.22
  21
     In forming our measure of calorie availability we followed the general recommendations of Smith and Subandoro
(2007).
  22
     In October of 2001 the Cordoba-to-US$ exchange rate was 13.65. Therefore per capita consumption levels in our
sample averaged less than US$ 300 per year.




                                                         25
           Panel A:                                                          Expenditure Shares (%)
                                                    All                           Lower 25%                            Upper 25%
                                        2000       2001       2002          2000     2001       2002         2000        2001       2002
           Cereals                        491       360       327           533      409       357       457        316       294
           Roots                           13        31        27            13       26        20        15         36        36
           Pulses                         116       125       136           112      138       165       106        107       113
           Vegetables                      32        49        45            28       43        34        38         58        53
           Fruit                           06        09        11            05       07        09        08         12        12
           Meat                            31        69        77            22       40        51        53         99       104
           Dairy                          112       147       173            90      120       150       131        168       192
           Oil                             40        50        50            35       52        50        39         47        47
           Other foods                    158       160       154           162      167       165       154        157       149
           Staples♦                       621       516       490           658      573       541       578        459       443
           Panel B:                                                     Total Real Expenditure & Calories
           Expenditure per  adult       5 506     4 679     4 510       2 503      2 397     2 200     9 481      7 578     7 460
           (Expenditure per capita)    (4 277)   (3 764)   (3 887)     (2 016)    (2 130)   (2 102)   (7 302)    (5 845)   (6 114)
           Food share                      712       692       688         738        691       686       670        679       676
           Calories per adult           2 701     3 015     2 948       1 706      2 127     2 013     3 737      3 849     3 758
           (Calories per capita)       (2 086)   (2 435)   (2 529)     (1 351)    (1 854)   (1 873)   (2 842)    (2 962)   (3 041)
           Percent energy deficient       510       393       397         850        697       762       198        145       130

Table 1: Real expenditure food budget shares of RPS households from 2000 to 2002
NOTES: Authors’ calculations based on a balanced panel of 1,358 households from the RPS evaluation dataset (see IFPRI (2005)). Real
household expenditure equals total annualized nominal outlay divided by a Paasche cost-of-living index. Base prices for the price index
are 2001 sample medians. The nominal exchange rate in October of 2001 was 13.65 Cordobas per US dollar. Total calorie availability
is calculated using the RPS food quantity data and the calorie content and edible portion information contained in INCAP (2000).
Lower and upper 25 percent refers to the bottom and top quartiles of households based on the average of year 2000, 2001 and 2002 real
consumption per adult equivalent and thus contains the same set of households in all three years.
♦ Sum of cereal, roots and pulses.
 "Adults" correspond to adult equivalents based on FAO (2001) recommended energy requirements for light activity.
 Percentage of households with estimated calorie availability less than FAO (2001) recommendations for light activity given household

demographics.



                                                                          26
                                                 Calorie Shares (%)
                                    All              Lower 25%           Upper 25%
                            2000   2001   2002   2000 2001 2002       2000 2001 2002
              Cereals       577   603   599   607   639   620   555   571   574
              Roots          15    15    16    19    15    12    16    18    21
              Pulses        131   113   128   121   113   133   131   110   121
              Vegetables     07    07    06    06    06    04    08    09    08
              Fruit          03    05    04    03    03    04    05    07    58
              Meat           07    13    13    05    07    07    13    19    19
              Dairy          41    43    45    34    30    34    47    52    55
              Oil            69    76    75    58    69    67    74    81    80
              Other foods   150   126   114   147   119   119   152   132   115
              Staples♦      723   731   743   747   767   766   702   699   717

Table 2: Calorie shares of RPS households from 2000 to 2002
NOTES: Authors’ calculations based on a balanced panel of 1,358 households from the RPS
evaluation dataset (see IFPRI (2005)). Total calorie availability is calculated using the RPS food
quantity data and the calorie content and edible portion information contained in INCAP (2000).
Lower and upper 25 percent refers to the bottom and top quartiles of households based on the
average of year 2000, 2001 and 2002 real consumption per adult equivalent and thus contains the
same set of households in all three years.
♦ Sum of cereal, roots and pulses.



    Using the FAO (2001) energy intake recommendations for ‘light activity’ we categorized each
household, on the basis of its demographic structure, as energy deficient or not. By this criterion
approximately 40 percent of households in our sample are energy deficient each period. Amongst
the poorest quartile this fraction rises to over 75 percent. These figures are reported in Panel B of
Table 1.

Results: Table 3 reports our point estimates. Our first estimate corresponds to the pooled
ordinary least squares (OLS) fit of ln (Cal ) onto ln (Exp ) using all three waves of the RPS data.
Aggregate shifts in the intercept and slope coeﬃcient are included. Also included in the model,
to control for variation in food prices across markets, is a vector of 42 village-specific intercepts.
Variants of this specification are widely employed in empirical work (e.g, Subramanian and Deaton,
1996; Table 2). The pooled OLS calorie elasticities are reported in Column 1. The elasticity
approximately equals 0.7 in 2000 and 0.6 in both 2001 and 2002. All three elasticities are precisely
determined. The estimates are high relative to others in the literature, but realistic given the
extreme poverty of the households in our sample.
    Column 2 augments the first model by allowing the intercept to vary across households. This
‘fixed eﬀects’ estimator (FE-OLS) is also widely used in empirical work when panel data are avail-
able (e.g., Behrman and Deolalikar, 1987; Bouis and Haddad, 1992). Allowing for household-specific
intercepts increases the elasticity by about 10 percent in all three years. The standard errors almost
double in size.


                                                 27
                                       Panel A: Calorie Demand Elasticities                Panel B: Sensitivity to Trimming
                             (1)          (2)          (3)          (4)          (5)         (1)         (2)           (3)
                             OLS          FE         R-CRC         MDLK        I-CRC       I-CRC       I-CRC         I-CRC
                            06837       07550      06617       −00133      07125     06867       06352        06993
         2000 Elasticity
                           (00305)     (00441)    (00424)      (02571)    (00763)   (00906)     (00639)      (00522)
                            06105       06635      05861
         2001 Elasticity                                               −         −           −            −            −
                           (00383)     (00608)    (00565)
                            05959       06466      05521                    05062     05299       04690        05368
         2002 Elasticity                                               −
                           (00245)     (00416)    (00476)                  (00791)   (00928)     (00583)      (00421)
         Percent trimmed      −            −           −                0       6.5          5           10           20
         Time shifters?       Yes         Yes          Yes             No       Yes         Yes          Yes          Yes

Table 3: Estimates of the calorie Engel curve: linear case
NOTES: Estimates based on the balanced panel of 1,358 households described in the main text. "OLS" denotes least squares applied
to the pooled 2000, 2001, and 2002 samples, "FE-OLS" least squares with household-specific intercepts, "R-CRC" Chamberlain’s (1992)
estimator with identity weight matrix, "MDLK" the Mundlak (1961)/Chamberlain (1982) estimator described in the main text, and
"I-CRC" our irregular correlated random coeﬃcients estimator (using the 2000 and 2002 waves only). All models, with the exception of
"MDLK", include common intercept and slope shifts across periods. The standard errors are computed in a way that allows for arbitrary
within-village correlation in disturbances across households and time.




                                                                  28
    In Column 3 we use Chamberlain’s (1992) regular correlated random coeﬃcients (R-CRC)
estimator with an identity weight matrix. Since we have three years of data and only two random
coeﬃcients his methods, at least in principle, apply. The top panel of Figure 1 plots a histogram of
det (X0 X), which shows a reasonable amount of density in the neighborhood of zero. This suggests
that the right-hand-side of (12) may be undefined in the population. In practice the R-CRC
estimator generates ‘sensible’ point estimates with estimated standard errors approximately equal
to those of the corresponding FE-OLS estimates. The R-CRC point estimates are smaller than
both the OLS and FE-OLS ones.
    Columns 4 and 5 are based on only the 2000 and 2002 waves of data. By dropping the middle
wave of data we artificially impose that  =  = 2; this ensures irregularity (Proposition 1.1). The
lower panel of Figure 1 plots a histogram of  = ln(Exp2002 ) − ln(Exp2000 ); the figure indicates
a substantial amount of density in the neighborhood of zero. Column 4 reports the ‘Mundlak’
estimate of the demand elasticity

                                     
                                   1 X ln(Cal2002 ) − ln(Cal2000 )
                                                                   
                                      ln(Exp2002 ) − ln(Exp2000 )
                                      =1

This average, as expected, is poorly behaved. It implies a nonsensical elasticity estimate with
a very large standard error. Column 5 implements our estimator (I-CRC) with a bandwidth of
 =   −13 where  = min (   134) is a robust estimate of the sample standard deviation
of  ( is the sample standard deviation and  the interquartile range). This implies that we
trim, or categorize as ‘stayers’, about 7 percent of our sample. The I-CRC point estimate is sensible
and well-determined. While the estimated year 2000 elasticity is close to its OLS counterpart, the
2002 elasticity is 20 percent lower in magnitude. Panel B of the table explores the sensitivity of our
point estimates to trimming. Overall we find that the Column 5 point estimates are insensitive to
modest variations in the bandwidth.

A nonlinear model: As we have three periods of data we can modify our model to allow the
calorie elasticity to vary non-linearly with income. Nonlinearity in the calorie demand curve has
been emphasized by Strauss and Thomas (1990, 1995) and Subramanian and Deaton (1996). We
consider the model

                   ln (Cal ) = 1 (  ) + 2 (  ) ln(Exp ) + 3 (  )Exp−1
                                                                                        


so that a household’s period-specific demand elasticity is given by 2 (  ) − 3 (  )Exp−1
                                                                                                   
We estimate the average of this elasticity in 2000, 2001 and 2002 using the approach outlined in
                                                            ¡                 ¢0
Section 3. Figure 2 plots the a histogram of  with X = 1 ln(Exp ) Exp−1
                                                                                 Because ln(Exp )
         −1
and Exp are highly correlated within-units, the density of  is substantial in the neighborhood
of zero.
    Table 4 reports average elasticity estimates based on the extended model. The average elastici-


                                                     29
Figure 1: Histogram of the distribution of det (X0 X) (top panel,  = 3  = 2) and  (bottom
panel,  =  = 2)
Notes: The two vertical blue lines in the lower panel correspond to the portion of the sample that
is trimmed in our preferred estimates (Table 3, Column 5).




Figure 2: Histogram of the distribution of  ( =  = 3)
Notes: The smallest and largest 10 percent of the  ’s are excluded from the histogram. The
two vertical blue lines correspond to the portion of the sample that is trimmed in our preferred
estimates (Table 4, Column 3).


                                               30
                                          Panel A: Calorie Demand Elasticities
                               (1)           (2)           (3)          (4)         (5)
                               OLS           FE          I-CRC        I-CRC       I-CRC
                              06671       07385        02180       01429      02319
         2000 Elasticity
                             (00262)     (00370)      (02846)     (02872)    (02900)
                              05992       06514        08889       06150      11262
         2001 Elasticity
                             (00380)     (00584)      (06342)     (12170)    (08696)
                              05943       06425        05570       06629      04954
         2002 Elasticity
                             (00238)     (00396)      (05739)     (03741)    (05162)
         Percent trimmed        −            −            18.8         15           25
         Time shifters?        Yes          Yes           Yes          Yes          Yes

Table 4: Estimates of the calorie Engel curve: nonlinear case
NOTES: Estimates based on the balanced panel of 1,358 households described in the main text.
"OLS" denotes least squares applied to the pooled 2000, 2001, and 2002 samples, "FE-OLS" least
squares with household-specific intercepts, and "I-CRC" our irregular correlated random coeﬃcients
estimator (now using all three waves). All models include common intercept and slope shifts
across periods. The standard errors are computed in a way that allows for arbitrary within-village
correlation in disturbances across households and time. The average elasticity estimates in the
OLS and FE-OLS columns are computed using the delta method. Those in the I-CRC columns as
described in Section 3.

ties associated with the OLS and FE-OLS parameter estimates of the nonlinear model are virtually
identical to their linear model Table 3 counterparts. Although the coeﬃcients on Exp−1     and its
interactions with the 2001 and 2002 time dummies are jointly significant in both models (not re-
ported), the eﬀect of their inclusion on the average elasticity estimates is negligible. Column 3
reports I-CRC estimates with  =   −13 (which, given the large density in the neighborhood
of zero, results in the trimming of 20 percent of the sample). In contrast to the linear case, the
I-CRC estimates are imprecisely determined; they are also more sensitive to variations in the band-
width (Columns 3 and 4). We conclude that we are unable to reliably fit the nonlinear CRC model
with the data available.


5    Conclusion
In this paper we have outlined a new estimator for the correlated random coeﬃcients panel data
model. Our estimator is designed for situations where the regularity conditions required for the
method-of-moments procedure of Chamberlain (1992) do not hold. We illustrate the use of our
methods in an exploration of the elasticity of demand for calories in a population of poor Nicaraguan
households. This application is highly irregular, with many ‘near stayers’ in the sample. This
implies that elasticity estimates based on the textbook FE-OLS estimator may be far from the
relevant population average. We find that our methods work well in this setting, generating point
estimates that are 10 to 20 percent smaller in magnitude that their FE-OLS counterparts (Table
3, Columns 5 versus 2).


                                                   31
    While our procedure is simple to implement, it does require choosing a smoothing parameter.
As in other areas of semiparametric econometrics, our theory places only weak restrictions on this
choice. Developing an automatic, data-based, method of bandwidth selection would be useful.
    Irregularity arises in other fixed eﬀects panel data models (e.g., Manski, 1987; Honoré and
Kyriazidou, 1997; Kyriazidou, 1997; Chamberlain 2010). It is an open question as to whether
features of our approach could be extended to more complex nonlinear and/or dynamic panel
data models. In ongoing work we are studying how to extend our methods to estimate quantile
partial eﬀects (e.g., unconditional quantiles of the distribution of the random coeﬃcients) and to
accommodate additional ‘triangular endogeneity’.




                                               32
                                                      Appendix

A      Proofs and derivations
A.1     Proof of Theorem 2.1
                                                                          utilizes the decomposition
As noted in the main text our derivation of the limiting distribution of 

                                                              
                                                =
                                                  +Ξ    − 0 
                                                                                                           (37)
                                                    



      ,
with           
        , and Ξ respectively equal to (26), (24), and (28) of the main text. The proof proceeds in three steps.
                                                                       . Second that of the common parameters 
First we derive the limiting distribution of the infeasible estimator                                         
                                                                        

Third we show that Ξ                                                                        then follows from the
                      has a well-defined probability limit. The limiting distribution of 

delta method and the independence of  and  .
                                           


                           b  : We begin with the infeasible estimator (26) which treats 0 as known.
Large sample properties of β
Recentering (26) yields

                                                                                           
                                       1
                                       
                                                     1 (| |   ) X−1
                                                                        (Y − W  0 ) −  0
                            − =
                                              =1
                                                                                                           (38)
                              0
                                                          1
                                                                  1 (| |   )
                                                                 =1


First consider the expected value of the term entering the summation in the denominator of (38):


                                      E [1 (| |  )]      =     1 − Pr{| | ≤ }
                                                                         1
                                                             =     1−       () d
                                                                         −1
                                                             =     1 − 20 + ()                            (39)

                                                             =     1 + (1)                                  (40)


where the third equality follows from Assumption 1.2 and the change of variables  =  (with Jacobian dd = )
    Define  to be the term entering the summation in the numerator of (38):

                                                                              
                                    ≡ 1 (| |  ) X−1
                                                          (Y − W  0 ) −  0                              (41)


Taking its expectation yields


                                   E [ ]   =      E [1 (| |  ) · (0 (X ) − 0 )]                    (42)

                                               =      E [1 (| | ≤ ) (0 − 0 ( ))]
                                                       
                                               =          (0 − 0 ()) () d
                                                       −
                                                                  
                                               =      2 0 −    0 0  +  () 



where 
       0 ≡  0 (0), again using Assumption 1.2.




                                                              33
     Turning to the variance of  we use the ANOVA decomposition


                                             V ( ) = V (E [  |  ]) + E [V (  |  )]                            (43)


The first term in (43) equals

                                                                                                   
                                        V (E [  |  ])   =   E 1 (| | ≤ ) (0 ( ) − 0 )2

                                                              =   V (0 ( )) +  (1) 


Now consider V (  |  ); using (42) above and recalling the equality X−1 =                  1
                                                                                                 X
                                                                                                   ∗
                                                                                                       when ||  0, we have

                                                                                                              
                           − E [  |  ]    =    1 (| |  ) X−1 (Y − W ) − − ( 0 ( ) −  0 )
                                                         1 (| |  )
                                                    =                  {Y∗ − W∗  −  0 ( )}
                                                              
                                                         1 (| |  ) ∗
                                                    =                  X (Y − W  − X 0 ( )) 
                                                              

Again defining


                                     U     ≡      Y − W  − X 0 (X )

                                            =      Y − W  − X 0 ( ) + X (0 (X ) − 0 ( ))


it follows from iterated expectations that

                          1 (| |   )  ∗                                                           
V (  |  )       =                  E X (Y − W  − X 0 ( )) (Y − W  − X 0 ( ))0 X∗0 
                                                                                                       
                                   2
                               
                          1 (| |   )  ∗                                                                             
                      =                  E X Σ (X ) X∗0                                                                 0
                                                         + 1 (| |   ) E ( (X ) −  0 ( )) ( (X ) −  0 ( )) 
                                   2
                               
                          1 (| |   )  ∗              
                      =                  E X Σ (X ) X∗0 
                                                         + 1 (| |   ) V (  (X )|  ) 
                               2

where Σ(X ) ≡ V ( U | X ). Averaging the first term in V (  |  ) over the distribution of  gives

                                                                     
                      1 (| |   )  ∗                                −
                                                                             1  ∗                         
             E                       E X Σ (X ) X∗0 
                                                               =             E X Σ (X ) X∗0  
                                                                                                  =   () d              (44)
                               2                                              2
                                                                      −∞   
                                                                         ∞
                                                                               1  ∗                         
                                                                       +          E X Σ (X ) X∗0  
                                                                                                   =   () d
                                                                                2
                                                                           
                                                                         
                                                                       1 −1 1  ∗                              
                                                                  =                E X Σ (X ) X∗0    
                                                                                                     =   () d
                                                                        −∞ 2
                                                                           
                                                                         1 ∞ 1  ∗                               
                                                                       +            E X Σ (X ) X∗0     
                                                                                                        =   () d
                                                                          1 2
                                                                       2E [ X∗ Σ (X ) X∗0
                                                                                          |  = 0] 0
                                                                  =                                        +  (1)
                                                                                       
                                                                  =    (−1 )


where the third equality exploits Assumptions 1.2 and 2.3.




                                                                      34
    Averaging the second term over the distribution of  yields


                                  E [1 (| |   ) V (  (X )|  )]     ≤   E [V (  (X )|  )]

                                                                            =   V ( (X ))

                                                                            =    (1) 


Thus, combing terms,
                                                          2E [ X∗ Σ (X ) X∗0
                                                                             |  = 0] 0
                                  E [V (  |  )] =                                    +  (1) 
                                                                          
    Combing this result with the expression for V (E [  |  ]) derived above yields a variance term of

                                                      2E [ X∗ Σ (X ) X∗0
                                                                         |  = 0] 0
                                     V ( )   =                                     +  (1)                      (45)
                                                                      
                                                        −1 
                                                 =            


    Together (42), (45), and the independence generated by random sampling (Assumption 2.1) imply that
                                                                                        
                            1                                       1                 1
                    E               =  (1)             V               =          =  (1)            (46)
                              =1                                      =1             

                                                                                   for  (and indirectly
under the bandwidth assumption (Assumption 2.5). This implies weak consistency of      0

Proposition 1.2).
    To show asymptotic normality we check the conditions for Liapunov’s Central Limit Theorem (CLT) for triangular
arrays. Observe that

                                                                            3 
              E k k3         =    E 1 (| |  )  X−1
                                                           (Y − W  0 ) −  0
                                                                                   
                                                                                                           3 
                                                       1 ∗                                                  
                                 =    E 1 (| |  )     X
                                                          (Y  − W  
                                                                        0 ) −  0 (   ) − ( 0 −  0 ( ))
                                                                                                           
                                                                                                              
                                                                                   3 
                                                       1 ∗                          
                                 =    E 1 (| |  )                               
                                                        X U + (0 (X ) − 0 ) 


Application of the triangle inequality and the fact that E [ X∗ (Y − W 0 − X0 )| ] = 0 yields
                                                                                      3  
                                      1 ∗                                               
                                E                                                      
                                       X (Y − W  0 ) − 0 ( ) − (0 − 0 ( ))  
                                                                                            3  
                                         1 ∗                                                      
                                                                          
                            ≤   E         X (Y − W  0 − X 0 ( )) + k0 − 0 ( )k  
                                                                            
                                 1                                       3
                                            ∗                                                       3
                            =    3  E kX (Y − W  0 − X 0 ( ))k   + k0 − 0 ( )k
                                    
                                                                           
                                   3E kX∗ (Y − W  0 − X 0 ( ))k2  
                                +                                               k0 − 0 ( )k 
                                                       2




                                                                      35
    Now note that

                                                                                                                        
                                   2                                                                                          
E kX∗ (Y − W  0 − X 0 ( ))k          =    E   X∗ (Y − W  0 − X 0 ( )) (Y − W  0 − X 0 ( ))0 X∗0
                                                                                                                         
                                                           ∗                                                                  
                                                =      E X (Y − W  0 − X 0 ( )) (Y − W  0 − X 0 ( ))0 X∗0  
                                                                                                                          
                                                                          
                                                =      E X∗ Σ (X ) X∗0 
                                                                             


This gives
                                                                                3  
                             1 ∗                                                  
                        E                                                        
                              X (Y − W  0 ) − 0 ( ) − (0 − 0 ( ))  
                            
                         1                                3  (E [ X∗ Σ (X ) X∗0
                                                                                     |  ])
                                                      3
                    ≤    3   ( ) + k0 − 0 ( )k +                 2
                                                                                              k0 − 0 ( )k 
                           


with  ( ) as defined in Assumption 2.3. Using the above inequality yields

                                                            
                           ∞                                   
     E k k3     ≤            k0 − 0 ()k3  () d −           k0 − 0 ()k3  () d
                           −∞                                −
                            −                                                            
                                  1                     ∗          ∗0
                         +           () + 3  (E [ X Σ (X ) X |  = ]) k0 − 0 ()k  () d
                                   3                        2
                             −∞
                           ∞                                                             
                                 1                     ∗          ∗0
                         +          () + 3  (E [ X Σ (X ) X |  = ]) k0 − 0 ()k  () d
                                  3                        2
                             
                                                1
                                         
                    =    E k0 − 0 ()k3 −        k0 − 0 ()k3  () d
                                                     −1
                                                                                                                  
                              −1       1
                                       1                              ∗            ∗0
                         +                () + 3  (E [ X Σ (X ) X |  = ]) k0 − 0 ()k  () d
                                        3 
                                       2                                   2 
                             −∞
                           ∞                                                                                     
                                      
                                   1 1               3  (E [ X Σ (X ) X∗0
                                                                     ∗
                                                                                   |  = ])
                         +                     () +                                             k    −     ()k   () d
                             1     2  3                                 2                        0      0

                                                                3                            
                                                                                       −2
                                                                                                  ∞
                                                                                                     1
                    =    E k0 − 0 ( )k3 − 2 0 −        0  0  +  (0) 0           2          d
                                                                                                1   3
                           6  (E [ X∗ Σ (X ) X∗0                            ∞ 1                     
                                                    |  = 0])             
                         +                                       0 − 0  0              2
                                                                                              d +  −2
                                                                                     1   
                                                                               
                                                                                    
                                                                                                
                                                                                               
                    =     (0) 0 −2 + 6  E X∗ Σ (X ) X∗0     
                                                                         =   0     0 −  0  0 
                                                                                                       −1

                                                 
                                                                      3
                         −2 0 −   0  0  + E k 0 −  0 ( )k
                                
                    =     −2 

                                                                                                
                                                                                            
    Using the above result we can verify the Liapunov condition. Let  =                   
                                                                                                  , then

                                     1                                  
                                                                           
                                                                                
                                            V ( ) → 2E X∗ Σ (X ) X∗0
                                                                          = 0 0 
                                      =1




                                                                 36
and also
                                                           13                          13
                                         E k − E [ ]k3                     8   E k k3
                                   =1                                                  =1
                                                                             ≤
                                              ( )12                                   ( )12
                                                                                          13 
                                                                                       −2
                                                                             =   
                                                                                    (−1 )12
                                                                                           
                                                                             =    ()−16

                                                                             =    (1) 


Application of the Liapunov CLT for triangular arrays, equation (39) above, and Slutsky’s Theorem, then yields the
follow Lemma.


Lemma A.1 Suppose that (i) (0   0  0 (·)) satisfies (9), (ii) Σ (x) is positive definite for all x ∈ X  (iii)  = 
                                               
                                            →
and (iv) Assumptions 1.2 to 2.5 hold, then      0 with the normal limiting distribution
                                             


                                                √          
                                                   − →  
                                                                N (0 2Υ0 0 ) 
                                                         0



for Υ0 = E [ X∗ Σ (X ) X∗0
                           |  = 0] 


                           b : Recall that the non-random coeﬃcients 0 are estimated by a uniform
Large sample properties of δ
conditional linear predictor (CLP) estimator. Recentering (24) yields

                                                           −1                                                          
            − 0 =        1                                              1 
                                 1 (| | ≤ ) W∗0 W∗           ×               1 (| | ≤ ) W∗0 ( 0 (X ) + U∗ )    (47)
                            =1                                            =1


where


                                                U∗   =     Y∗ − W∗  0 −0 (X)                                                (48)

                                                     =     X∗ (Y − W 0 − X0 (X))

                                                     =     X∗ U


    First consider the expected value of the matrix being inverted in (47). Manipulations similar to those used to
         above yield
analyze  


                                                                                           
                              E 1 (| | ≤ ) W∗0 W∗      =      E 1 (| | ≤ ) E W∗0 W∗  
                                                                    
                                                                                        
                                                            =          E W∗0 W∗   =   () d
                                                                    −
                                                                     1
                                                                                           
                                                            =          E W∗0 W∗   =   () d
                                                                     −1
                                                                                      
                                                            =      2E W∗0 W∗   = 0 0  +  ()                          (49)




                                                                       37
while for any fixed -dimensional vector  the variance of a quadratic form in that matrix satisfies
                                                                                                      
                 1                  0 ∗0 ∗                              1                           4
              V         1 (| | ≤ )  W W                      ≤         2
                                                                                E 1 (| | ≤ ) E kW∗ k   kk4    (50)
                  =1                                                   
                                                                                                             
                                                                          2E kW∗ k4   = 0 0 kk4          1
                                                                    =                                   +
                                                                                                            
                                                                                  
                                                                                1
                                                                    =     
                                                                               

under Assumptions 2.3 and 2.5 so that

                           1                                               
                                  1 (| | ≤ ) W∗0 W∗ = 2E W∗0 W∗   = 0 0 +  (1)                          (51)
                            =1


    Now redefine  to equal the term entering the summation in the numerator of (47):


                                           ≡ 1 (| | ≤ ) W∗0 ( 0 (X ) + U∗ ) 


Using the fact that E [ W∗0 U∗ |  ] = E [ W∗0 X∗ E [ U| X]|  ] = 0 yields an expected value of  equal to

                                                                  
          E [ ]   =   E 1 (| | ≤ ) W∗0 ( 0 (X ) + U∗ )
                                                            
                      =   E 1 (| | ≤ )  E W∗0 0 (X ) 
                           
                                                     
                      =       E W∗0  0 (X )  =   () d
                           −
                            1
                                                           
                      =           E W∗0 0 (X )  =   () d
                              −1
                                                            
                                                             1
                      =   E W∗0 0 (X )  = 0 0 2             d
                                                             −1
                                                                                         1
                              E [ W∗0 0 (X )|  = 0]        ∗0                0                  
                          +                                                 
                                                          0 + E W 0 (X )  = 0 0 3      2 d +  3
                                                                                          −1
                                                                                       
                          2 E [ W∗0 0 (X )|  = 0]          ∗0                0         
                      =                                   0 + E W 0 (X )  = 0 0  +  3 
                                                                                          3
                          3               

where we use the following Taylor approximation and Assumption 1.2 and 2.3 in deriving the second to last equality
above:

                                                                       
E W∗0 0 (X )  =   ()          =   0 + E W∗0 0 (X )  = 0 0 
                                                                                                              
                                                   E [ W∗0 0 (X )|  = 0]                                         
                                               +                               0 + E W∗0 0 (X )  = 0 00 ()2 +  2 
                                                               

    The numerator (47) therefore equals

                           1 
                                    1 (| | ≤ ) W∗0 (  0 (X ) + U∗ )                                          (52)
                          
                                =1
                                                                                        
                          2 E [ W∗0 0 (X )|  = 0]                                       
                      =                                 0 + E W∗0 0 (X )  = 0 00 2 +  2 
                          3             




                                                                    38
                                                               −  0 of
Using the ratio of (52) and (51) yields a bias expression for 
                                                                                                                      
                                              E [ W∗0 0 (X )|  = 0]                         0                         
  −  0 = 1 E W∗0 W∗   = 0 −1 ×
                                                                            + E W∗0 0 (X )  = 0 0                   2 +  2  (53)
           3                                                                                          0

                                                                                 √          
This implies that we can center the asymptotic distribution of                         −  0 at zero by choosing  such that
                                                                                   
( )12 2 → 0 (Assumption 2.5).
      Now consider the variance of   As before we proceed by evaluating the two terms in in the variance decom-
position (43) separately. The first of the two terms evaluates to

                                                                      
        V (E [  |  ])   =     V 1 (| | ≤ )  E W∗0 0 (X ) 
                                                                                       0 
                              =     E 1 (| | ≤ ) 2 E W∗0 0 (X )  E W∗0 0 (X ) 
                                                                                                        0
                                    −E 1 (| | ≤ )  E W∗0 0 (X )  E 1 (| | ≤ )  E W∗0 0 (X )  


      Evaluating the two expectations entering the above expressions yields
                                                                       
                                                                                                
                 E 1 (| | ≤ )  E W∗0 0 (X )          =               E W∗0 0 (X )  =   () d
                                                                        −
                                                                               1                           
                                                                =      2            E W∗0 0 (X )  =   () d
                                                                                −1
                                                                         
                                                                =       2 


and

                                                                            0 
                        E 1 (| | ≤ ) 2 E W∗0 0 (X )  E W∗0 0 (X ) 
                            
                                                                             0
                        =      2 E W∗0 0 (X )  =  E W∗0  0 (X )  =   () d
                              −
                               1
                                                                                      0
                         =         ()2 E W∗0 0 (X )  =  E W∗0 0 (X )  =   () d
                               −1
                                                                                                
                                                                     0                        1             
                         = E W∗0 0 (X )  = 0 E W∗0 0 (X )  = 0 0 3                        2 d +  3
                                                                                                 −1
                          2                                          0         
                         = E W∗0 0 (X )  = 0 E W∗0 0 (X )  = 0 0 3 +  3 
                          3
                                         
We conclude that V (E [  |  ]) =  3 .
      Now consider the second term in (43). The conditional variance, using the conditional moment restriction (9), is

                                                                                     
                  V (  |  )    =   1 (| | ≤ ) V  W∗0 0 (X ) + W∗0 U∗  
                                                                                                       
                                     =   1 (| | ≤ ) 2 V W∗0 0 (X )  + 1 (| | ≤ ) V W∗0 U∗   


Using an ANOVA decomposition to evaluate V ( W∗0 U∗ |  ) gives

                                                                                 
                          V W∗0 U∗        =    E V W∗0 U∗  X   + V E W∗0 U∗  X  
                                                                            
                                               =    E W∗0 X∗ Σ (X) X∗0 W∗   + 0




                                                                  39
and hence
                                                                     
                                                                                                     
        E 1 (| | ≤ ) E W∗0 X∗ Σ (X) X∗0 W∗           =               E W∗0 X∗ Σ (X) X∗0 W∗   =   () d
                                                                         −
                                                                          1
                                                                                                          
                                                             =           E W∗0 X∗ Σ (X) X∗0 W∗   =   () d
                                                                       −1
                                                                                                     
                                                             =       2E W∗0 X∗ Σ (X) X∗0 W∗   = 0 0  +  () 


Similarly
                                                                 
                                                                                           
            E 1 (| | ≤ ) 2 V W∗0 0 (X )       =               2 V W∗0 0 (X )  =   () d
                                                                  −
                                                                   1
                                                                                                         
                                                         =                  ()2 V W∗0 0 (X )  =   () d
                                                                     −1
                                                                                                     
                                                                                                      1             
                                                         =       V W∗0 0 (X )  = 0 0 3               2 d +  3
                                                                                                      −1
                                                                 2  ∗0                          
                                                         =         V W 0 (X )  = 0 0 3 +  3 
                                                                 3

    Collecting terms we conclude that

                                                                         
                              V ( ) = 2E W∗0 X∗ Σ (X) X∗0 W∗   = 0 0  +  ()                                   (54)


Applying Liapunov’s Central Limit Theorem for triangular arrays, we have

                            1                                               
                          √          → N 0 2E W∗0 X∗ Σ (X) X∗0 W∗   = 0 0 
                             =1


Slutsky’s Theorem and (51) above then give the following Lemma.


Lemma A.2 Suppose that (i) (0   0  0 (·)) satisfies (9), (ii) Σ (x) is positive definite for all x ∈ X  (iii)  = 
                                               
                                           →
and (iv) Assumptions 1.2 to 2.5 hold, then       0 with the normal limiting distribution

                                                                                    
                                            √                                      Λ0
                                                  − 0 →
                                              
                                                         
                                                           N                    0       
                                                                                   20

where
                                     −1  ∗0 ∗                                      −1
               Λ0 = E W∗0 W∗   = 0   E W X Σ (X) X∗0 W∗   = 0 E W∗0 W∗   = 0    

                           b : The following lemma characterizes the probability limit of Ξ
Large sample properties of β                                                               

                                                                                          
                                                                                        →
Lemma A.3 If (0   0  0 (·)) satisfies (9) and Assumptions 1.2 to 2.5 hold we have Ξ    Ξ0 , where

                                                                            
                                       Ξ0    =    lim E 1 (| |   ) X−1
                                                                          W 
                                                  ↓0

                                             ≡    lim Ξ 
                                                  →∞




                                                             40
    To verify this result, we must first establish that the defined limit exists. For  suﬃciently small, we can
decompose the expectation Ξ as

                                                                                         
                           Ξ    =   E 1 (| | ≥ 0 ) X−1                             −1
                                                         W + E 1 (  | |  0 ) X W
                                                                           
                                 =   (1) + E 1 (  | |  0 ) −1 W∗
                                             0                
                                                    () − (−)
                                 =   (1) +                        
                                                        

where
                                                  () ≡ ()E[∗ | = ]

is twice continuously diﬀerentiable for ||  0 by Assumption 1.2. Using the Taylor’s series expansion
                                                                     2                      2
                                                          (0)       (∗ )   2 (−∗ )    
                         () − (−) = (0) − (0) + 2         ·+           −             ·     
                                                                     2          2        2

for ∗ some intermediate value between  and 0  it follows that
                                                                                2           
                                                                                          
                    1 (    0 ) · () − (−)  ≤ 1( ≤ 0 ) 2  (0)  + max   ()  · 0 
                                                                      ||≤0  2 

and since the right-hand side is integrable, Ξ → Ξ0 by dominated convergence. Then, taking  to be an arbitrary
                                       
                                     →
(fixed) -vector, verification that Ξ    Ξ0 follows from the convergence of the covariance matrix of the numerator
      to zero:
of Ξ
                                                                                     
                                                                                            
V 1                                               V 1
                                                            
         1 (|  |    ) X−1
                             W              =                  1  (|  |    )  −1
                                                                                       W ∗
                                                                                              
   =1
                                                      =1
                                                                                           
                                                   2 kk2                                   
                                                                                           2
                                              ≤           E 1 (| |   ) | |−2 kW∗ k
                                                     
                                                   2 kk2                                 2
                                                                                                    
                                                                                                                                   2
                                                                                                                                     
                                              =            E 1 (| | ≥ 0 ) | |−2 kW∗ k + E 1 (  | |  0 ) | |−2 kW∗ k
                                                     
                                                                                          
                                                       1      2 kk2 0 () + (−)
                                              =           +                                     
                                                                                2

where kW∗ k2 ≡  [W∗0 W∗ ] and
                                                                       2
                                               () ≡ ()E[k∗ k | = ]

is bounded for ||  0 , so
                                                                                                                 
                                                                                4 kk2                      0
           V 1                                                       1                                                1
                
                    1 (|  |    ) X−1
                                        W               ≤                  +                max k()k                       
              =1
                                                                                    ||≤0                      2
                                                                                                          
                                                                                                            
                                                                      1         4 kk2                    1   1
                                                          =                  +             max k()k      −
                                                                                         ||≤0           0
                                                                             
                                                                       1
                                                          =   
                                                                      
                                                          =   (1)


under Assumption 2.5.
    Lemmas A.1, A.2, and A.3 as well as the decomposition (37) then give Theorem 2.1.



                                                              41
A.2     MSE-optimal bandwidth sequence:
The MSE-optimal bandwidth sequence given in equation (29) of the main text may be derived as follows. Using (42),
                                                                     
(53) and Lemma A.3 yields a leading asymptotic bias term of 2 0 − 0 0  The asymptotic variance is given in

the statement of Theorem 2.1. The asymptotic MSE of   is thus

                                                                                Ξ Λ Ξ                          0
                                                           0        2Υ0 0 + 020 0
                                        4 0 − 
                                                0    0 −  
                                                            0    2 2
                                                                   
                                                                  0  +             0
                                                                                        
                                                                             

Minimizing this object with respect to  gives the result in the main text.


A.3     Proof of Theorem 2.2:
Rewriting equation (30) we have

                                              −1                                     −1
                                 1                         +           1 
                       =              Q0 R    ×          Q0 U U +0
                                                                        Q  ×       Q0
                                                                                       R                                                  (55)
                                   =1                 =1                    =1


                                                             −1                            
for U+    ∗                                1
                                                       Q0 R                 1                                         0
                                                                                           Q0 Y∗  for  = ( 0  0 ) and
      = Y − R  0  with  =             
                                                                      ×       
                                                 =1                                 =1

                                                                      
                                                 ∗ 1 (| |   )
              Q      =    −1
                              1 (| | ≤  ) W                                           R     = (W∗  1 (| |   )   ) 
              ×+                                                                          ×+


The dependence of Q and R on  is suppressed to simplify the notation.
                                                                                         ,
    Starting with the ‘Jacobian’ term in  we get, by the definitions of Q , R  and Ξ
                                                                                      
            1                             1    1 (| | ≤  ) W                                           
                                                            −1                      ∗0
                   Q0 R           =                                                     W∗ 1 (| |   )  
              =1                               =1           1(|  |  )
                                                                               
                                                                     
                                                                                                                 
                                                1
                                                             1 (| | ≤  ) W∗0 W∗            0 00
                                    =          
                                                   =1                                                          
                                                1
                                                
                                                           1 (| |   ) X−1    W
                                                                                         1
                                                                                         
                                                                                                 1 (| |   ) 
                                                       =1                                   =1
                                                                                      
                                                         ∗0    ∗
                                                 2E [ W W |  = 0] 0 0
                                            →                                         
                                                              Ξ0                   

                                                                      
by (51) and A.3. Decomposing the middle term                                         + U
                                                                                  Q0 U     +0 Q , yields
                                                                                             
                                                                          =1

                                                                               
                              0  +  +0                               
                                Q  U    U    Q    −              Q0
                                                                     U+ +0
                                                                        U    Q                                                             (56)
                           =1
                                              
                                                            =1
                                                                            

                       2                                                         2
                 ≤               U+ 
                                        kQ k2           
                                                  ̂ − 0  +
                                                                                  
                                                                            kQ k2 ̂ − 0 
                                                                                             
                            =1
                                                                     =1
                                                                                                             
                          2                                 
                                                          ∗ 2  +
                                                                                        2 U+  
                                                                                                               
                 =                  1 (| | ≤  ) kW k U + 1 (| |   )                         ̂ −  0 
                           =1                                                           | |2
                                                                                                  2
                           1                                 2                     2             
                       +               1 (| | ≤  ) kW∗ k + 1 (| |   )  2 ̂ − 0  
                             =1                                                | |




                                                                              42
By a similar argument as for (50) above,

                                                                                                             
                                  ∗ 2 
                                       U+ +1                                                 ∗ 2 
                                                                                                    U+
                                                                                                              
                                                                                                          + 1 | 
           E −1
               1 (| | ≤  ) kW k                       =     E −1 1 (| | ≤  ) E kW k      
                                                                                                   
                                                                              2          
                                                            →      2E kW∗ k U+    
                                                                                       + 1 |  = 0 0 


and the same reasoning as (44) yields


                                                                                                                        
                            2                                                                  ∗ 2 
                                                                                                                    
    E 1 (| |   ) kW∗ k U+ 
                                    + 1                    =     E −1
                                                                       1 (|  |    )        E  kW k   U+
                                                                                                                 + 1  | 
                                         | |2                                           | |2
                                                                                                  
                                                                  2E kW∗ k U+        + 1 |  = 0 0 
                                                                            2
                                                            →                       



Thus, by Markov’s inequality, (56) yields

                                                                                          
                                   +  +0                                                         
                               Q0 U U Q             =               Q0 U+  +0
                                                                              U Q +  ̂ −  0 
                          =1                                     =1
                                                                 
                                                        =               Q0 U+  +0
                                                                              U Q +  (1) 
                                                                   =1


Finally,

  
         Q0 U+  +0
               U Q       =
    =1
                                          
                                      1
                                                       1 (| | ≤  ) W∗0 (Y∗ − W∗  0 ) (Y∗ − W∗  0 )0 W∗
                                             =1
                                                                           0 00
                                                                                                                                   
                                                                                 0 00
                                  
                                                                                        −1                    0  
                                  
                                                 1 (| |   ) X−1
                                                                   (Y − W  0 ) −  0    X (Y − W  0 ) − 0
                                           =1


    By the calculations yielding (54), the expected value of the first diagonal submatrix is

                                                        0 ∗     ∗0 ∗           
                                                                                 ∗     
    E −1                 ∗0  ∗    ∗         ∗    ∗                           ∗0
        1 (| | ≤  ) W (Y − W  0 ) (Y − W  0 ) W = 2E W X Σ (X) X W  = 0 0 +  (1) 


                                                         
while the variance of any term in the matrix is  ( )−1 = (1) by Assumptions 2.3and 2.5 (with  ≤ 8).
Similarly, the expectation of the second diagonal submatrix is

                                             −1                    0                                         
E  1 (| |   ) X−1
                       (Y − W  0 ) −  0    X (Y − W  0 ) − 0                    =   2E X∗ Σ (X) X∗0   = 0 0 +  (1)

                                                                                          =   2Υ0 0 + (1)


while similar calculations to those leading to (46) yield

                                                                                                                            
                         −1                     −1                  0 
                                                                                                     48 (0)0           1
    V  1 (| |   ) X (Y − W  0 ) − 0 X (Y − W  0 ) −  0                        ≤              +
                                                                                                                      
                                                                                                 =    (1)




                                                                   43
where 8 () is defined in Assumption 2.3, Thus
                                                                                                         
                                           2E [ W∗0 X∗ Σ (X) X∗0 W∗ |  = 0] 0      0 00
                            Q0 U+  +0
                                  U Q →
                                                                                                         
                     =1
                                                                 0 00                   2Υ0 0 + (1)

            
ensuring  → 0 



References
 [1] Abrevaya, Jason. (2000). “Rank estimation of a generalized fixed-eﬀects regression model,”
     Journal of Econometrics 95 (1): 1 - 23.

 [2] Altonji, Joseph G. and Rosa L. Matzkin (2005). “Cross section and panel data estimators for
     nonseparable models with endogenous regressors,” Econometrica 73 (4): 1053 - 1102.

 [3] Angrist, Joshua D. and Alan B. Krueger. (1999). “Empirical strategies in labor economics,”
     Handbook of Labor Economics 3 (1): 1277 - 1366 (O. C. Ashenfelter & D. Card, Eds.). Ams-
     terdam: North-Holland.

 [4] Andrews, Donald W. K. and Marcia M. A. Schafgans. (1998). “Semiparametric estimation of
     the intercept of a sample selection model,” Review of Economic Studies 65 (3): 497 - 517.

 [5] Arellano, Manuel and Stephanne Bonhomme. (2009). “Identifying distributional characteristics
     in random coeﬃcients panel data models,” Mimeo.

 [6] Arellano, Manuel and Raquel Carrasco. (2003). “Binary choice panel data models with prede-
     termined variables,” Journal of Econometrics 115 (1): 125 - 157.

 [7] Arellano, Manuel and Bo Honoré. (2001). “Panel data models: some recent developments,”
     Handbook of Econometrics 5: 3229 - 3298 (J. Heckman & E. Leamer, Eds.). Amsterdam:
     North-Holland.

 [8] Behrman, Jere R. and Anil B. Deolalikar. (1987).“Will developing country nutrition improve
     with income? A case study for rural south India,” Journal of Political Economy 95 (3): 492 -
     507.

 [9] Bester, C. Alan and Christian Hansen. (2009). “Identification of Marginal Eﬀects in a Non-
     parametric Correlated Random Eﬀects Model,” Journal of Business and Economic Statistics
     27 (2): 235 - 250.

[10] Blundell, Richard W. and James L. Powell. (2003). “Endogeneity in nonparametric and semi-
     parametric regression models,” Advances in Economics and Econometrics: Theory and Ap-
     plications II : 312 - 357. (M. Dewatripont, L.P. Hansen, S. J. Turnovsky, Eds.). Cambridge:
     Cambridge University Press.


                                                            44
[11] Bonhomme, Stephane. (2010). “Functional diﬀerencing,” Mimeo.

[12] Bouis, Howarth E. (1994). “The eﬀect of income on demand for food in poor countries: are our
     food consumption databases giving us reliable estimates? Journal of Development Economics
     44(1): 199-226.

[13] Bouis, Howarth E. and Lawrence J. Haddad. (1992).“Are estimates of calorie-income elasticities
     too high? A recalibration of the plausible range,” Journal of Development Economics 39 (2):
     333 - 364.

[14] Browning, Martin and Jesus Carro. (2007). “Heterogeneity and microeconometrics modelling,”
     Advances in Economics and Econometrics: Theory and Applications III : 47 - 74. (R. Blundell,
     W. Newey & T. Persson, Eds.). Cambridge: Cambridge University Press.

[15] Card, David. (1996). “The eﬀect of unions on the structure of wages: a longitudinal analysis,”
     Econometrica 64 (4): 957 - 979.

[16] Chamberlain, Gary. (1980). “Analysis of covariance with qualitative data,” Review of Economic
     Studies 47 (1): 225 - 238.

[17] Chamberlain, Gary. (1982). “Multivariate regression models for panel data,” Journal of Econo-
     metrics 18 (1): 5 - 46.

[18] Chamberlain, Gary. (1984). “Panel data,” Handbook of Econometrics 2: 1247 - 1318 (Z.
     Griliches & M.D. Intriligator, Eds.). Amsterdam: North-Holland.

[19] Chamberlain, Gary. (1986). “Asymptotic eﬃciency in semi-parametric models with censoring,”
     Journal of Econometrics 32 (2): 189 - 218.

[20] Chamberlain, Gary. (1992). “Eﬃciency bounds for semiparametric regression,” Econometrica
     60 (3): 567 - 596.

[21] Chamberlain, Gary. (2010). “Binary response models for panel data: identification and infor-
     mation,” Econometrica 78 (1): 159 - 168.

[22] Chernozhukov, Victor, Iván Fernández-Val, Jinyong Hahn and Whitney Newey. (2008). “Identi-
     fication and estimation of marginal eﬀects in nonlinear panel data models,” CEMMAP Working
     Paper CWP25/08.

[23] Dasgupta, Partha. (1993). An Inquiry into Well-Being and Destitution. Oxford: Oxford Uni-
     versity Press.

[24] Deaton, Angus and Salman Zaidi. (2002). “Guidelines for constructing consumption aggregates
     for welfare analysis,” LSMS Working Paper Number 135.




                                                45
[25] Engle, Robert F., C. W. J. Granger, John Rice, and Andrew Weiss. (1986). “Semiparametric
     estimates of the relation between weather and electricity sales,” Journal of the American
     Statistical Association 81 (394): 310 - 320.

[26] Food and Agricultural Organization (FAO). (2001).“Human energy requirements: report of a
     joint FAO/WHO/UNU expert consultation,” FAO Food and Nutrition Technical Report Series
     1.

[27] Food and Agricultural Organization (FAO). (2006). The State of Food Insecurity in the World
     2006. Rome: Food and Agricultural Organization.

[28] Graham, Bryan S., Guido W. Imbens, Geert Ridder. (2009). “Complementarity and aggregate
     implications of assortative matching: a nonparametric analysis,” Mimeo.

[29] Heckman, James, Hidehiko Ichimura, Jeﬀrey Smith and Petra Todd. (1998). “Characterizing
     selection bias using experimental data,” Econometrica 66 (5): 1017 - 1098.

[30] Heckman, James J. (1990). “Varieties of selection bias,” American Economic Review 80 (2):
     313 - 18.

[31] Honoré, Bo E. (1992). “Trimmed LAD and least squares estimation of truncated and censored
     regression models with fixed eﬀects,” Econometrica 60 (3): 533 - 565.

[32] Honoré, Bo E. and Ekaterini Kyriazidou. (1997). “Panel data discrete choice models with
     lagged dependent variables,” Econometrica 68 (4): 839 - 874.

[33] Horowitz, Joel L. (1992). “A smoothed maximum score estimator for the binary response
     model,” Econometrica 60 (3): 505 - 531.

[34] Imbens, Guido W. (2007). “Nonadditive models with endogenous regressors,” Advances in
     Economics and Econometrics: Theory and Applications III : 17 - 46. (R. Blundell, W. Newey
     & T. Persson, Eds.). Cambridge: Cambridge University Press.

[35] Imbens, Guido W. and Whitney K. Newey. (2009). “Identification and estimation of triangular
     simultaneous equations models without additivity,” Econometrica 77 (5): 1481 - 1512.

[36] Instituto Nacional de Estadísticas y Censos (INEC). (2005). Metodología de con-
     strucción del agregado de consumo, de las líneas de pobreza y del agregado de
     ingreso en Nicaragua. Retrieved January 22, 2008, from the World Wide Web:
     http://www.inec.gob.ni/Pobreza/pubmetodol.htm.

[37] Instituto de Nutrición de Centro América y Panamá (INCAP) and Organi-
     zación Panamericana la Salud (OPS). (2000). Tabla de Composición de Ali-
     mentos de Centroamérica. Retrieved January 2008, from the World Wide Web:
     http://www.tabladealimentos.net/tca/TablaAlimentos/inicio.html


                                              46
[38] International Food Policy Research Institute (IFPRI). (2005). Nicaraguan RPS evaluation
     data (2000-02): overview and description of data files (April 2005 Release). Washington D.C.:
     International Food Policy Research Institute.

[39] Khan, Shakeeb and Elie Tamer. (2009). “Irregular identification, support conditions, and in-
     verse weight estimation,” Mimeo.

[40] Kyriazidou, Ekaterini. (1997). “Estimation of a panel sample selection model,” Econometrica
     65 (6): 1335 - 1364.

[41] Manski, Charles F. (1987). “Semiparametric analysis of random eﬀects linear models from
     binary panel data,” Econometrica 55 (2): 357 - 362.

[42] Mundlak, Yair. (1961). “Empirical production function free of management bias,” Journal of
     Farm Economics 43 (1): 44 - 56.

[43] Mundlak, Yair. (1978a). “On the pooling of time series and cross section data,” Econometrica
     46 (1): 69 - 85.

[44] Mundlak, Yair. (1978b). “Models with variable coeﬃcients: integration and extension,” An-
     nales de l’Insee 30-31: 483 - 510.

[45] Newey, Whitney K. (1994a). “The asymptotic variance of semiparametric estimators,” Econo-
     metrica 62 (6): 1349 - 1382.

[46] Newey, Whitney K. (1994b). “Kernel estimation of partial means and a general variance esti-
     mator,” Econometric Theory 10 (2): 233 - 253.

[47] Pagan, Adrian and Aman Ullah. (1999). Nonparametric Econometrics. Cambridge: Cambridge
     University Press.

[48] Serfling, Robert J. (1980). Approximation Theorems of Mathematical Statistics. New York:
     John Wiley & Sons, Inc.

[49] Smith, Lisa C. and Ali Subandoro. (2007). Measuring food security using household expenditure
     surveys. Washington D.C.: International Food Policy Research Institute.

[50] Strauss, John and Duncan Thomas. (1990). “The shape of the calorie-expenditure curve,” Yale
     University Economic Growth Center Discussion Paper No. 595.

[51] Strauss, John and Duncan Thomas. (1995). “Human resources: empirical modeling of house-
     hold and family decisions,” Handbook of Development Economics 3 (1): 1883 - 2023. (J.
     Behrman & T.N. Srinivasan). Amsterdam: North-Holland.

[52] Subramanian, Shankar and Angus Deaton. (1996). “The demand for food and calories,” Journal
     of Political Economy 104 (1): 133 - 162.

                                               47
[53] Wolfe, Barbara L. and Jere R. Behrman. (1983). “Is income overrated in determining adequate
     nutrition?” Economic Development and Cultural Change 31 (3): 525 - 549.

[54] Wooldridge, Jeﬀrey M. (2005a). “Unobserved heterogeneity and estimation of average partial
     eﬀects,” Identification and Inference for Econometric Models: Essays in Honor of Thomas
     Rothenberg: 27 - 55 (D.W.K. Andrews & J.H. Stock, Eds.). Cambridge: Cambridge University
     Press.

[55] Wooldridge, Jeﬀrey M. (2005b). “Fixed-eﬀects and related estimators for correlated-random
     coeﬃcient and treatment-eﬀect panel data models,” Review of Economics and Statistics 87
     (2): 385 - 390.

[56] World Bank. (2002). Basic information document: Nicaragua living standards measurement
     survey 1998. Washington D.C.: The World Bank.

[57] World Bank. (2003). Nicaragua Poverty Assessment: Raising Welfare and Reducing Vulnera-
     bility. Washington D.C.: The World Bank.




                                              48
