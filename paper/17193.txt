                                NBER WORKING PAPER SERIES




             CONNECTED SUBSTITUTES AND INVERTIBILITY OF DEMAND

                                           Steven T. Berry
                                            Amit Gandhi
                                             Philip Haile

                                        Working Paper 17193
                                http://www.nber.org/papers/w17193


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      July 2011




This paper combines and expands on selected material first explored in Gandhi (2008) and Berry and
Haile (2009a). We thank Jean-Marc Robin for helpful discussions. We received useful comments from
participants in the 2011 "Econometrics of Demand" conference at MIT. Adam Kapor provided capable
research assistance. Financial support from the National Science Foundation is gratefully acknowledged.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2011 by Steven T. Berry, Amit Gandhi, and Philip Haile. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Connected Substitutes and Invertibility of Demand
Steven T. Berry, Amit Gandhi, and Philip Haile
NBER Working Paper No. 17193
July 2011
JEL No. C3,D01

                                               ABSTRACT

We consider the invertibility of a nonparametric nonseparable demand system. Invertibility of demand
is important in several contexts, including identification of demand, estimation of demand, testing
of revealed preference, and economic theory requiring uniqueness of market clearing prices. We introduce
the notion of "connected substitutes" and show that this structure is sufficient for invertibility. The
connected substitutes conditions require weak substitution between all goods and sufficient strict substitution
to necessitate treating them in a single demand system. These conditions are satisfied in many standard
models, have transparent economic interpretation, and allow us to show invertibility without functional
form restrictions, smoothness assumptions, or strong domain restrictions.


Steven T. Berry                                        Philip Haile
'HSDUWPHQWRI(FRQRPLFV                                Department of Economics
Yale University                                        Yale University
Box 208264                                             37 Hillhouse Avenue
37 Hillhouse Avenue                                    P.O. Box 208264
New Haven, CT 06520-8264                               New Haven, CT 06520
and NBER                                               and NBER
steven.berry@yale.edu                                  philip.haile@yale.edu

Amit Gandhi
University of Wisconsin
1180 Observatory Drive
Madison, WI 53706-1393
agandhi@ssc.wisc.edu
1     Introduction

We consider the invertibility of a nonparametric nonseparable demand system. Invertibility
of demand is important in several theoretical and applied contexts, including identi…cation of
demand, estimation of demand systems, testing of revealed preference, and economic theory
exploiting the uniqueness of market clearing prices. We introduce the notion of “connected
substitutes”and show that this structure is su¢ cient for invertibility.
    We consider a general setting in which demand for goods 1; : : : ; J is characterized by


                           (x) = (   1   (x) ; : : : ;   J   (x)) : X       RJ ! S                   (1)


where x = (x1 ; : : : ; xJ ) is a vector of demand shifters associated with each good. All other
arguments of the demand system are held …xed.                       This setup nests a number of special
cases of interest. Points in S may be vectors of quantities demanded, choice probabilities,
market shares, or expenditure shares. The demand shifters x might be prices, unobserved
characteristics of the goods, or latent preference shocks. Several examples below illustrate.
    The connected substitutes structure requires two conditions. First, goods must be weak
substitutes in x in the sense that when xj increases (e.g., price falls) only for a subset of
goods j, demand for the remaining goods (taken as a whole) does not increase. Second, there
must be su¢ cient strict substitution among the goods to require treating them all in one
demand system. These conditions are weaker than other notions of substitution (e.g., strict
gross substitutes) and allow us to show invertibility without functional form restrictions,
smoothness assumptions, or domain restrictions relied on previously.
    Important to our approach is the explicit treatment of a “good 0” whose “demand” is
de…ned by the identity
                                                             X
                                                             J

                                         0 (x) = 1                 j (x):                            (2)
                                                             j=1

The interpretation will vary with the application.                  When demand is expressed in shares
(e.g., choice probabilities or market shares), good 0 can be a “real”good— e.g., a numeraire


                                                         1
good, an “outside good,” or a good relative to which utilities are normalized. The identity
(2) will then follow from the fact that shares sum to one. In other applications, good 0 will
be a purely arti…cial notion introduced only as a technical device (see the examples below).
         It is clear from (2) that even when good 0 is a real good, (1) characterizes the full demand
system. Nonetheless, explicitly accounting for the demand for good 0 simpli…es imposition
of the connected substitutes structure on all goods.                  When good 0 is an arti…cial good,
including it in the connected substitutes conditions proves useful as well. As will be clear
below, it strengthens the weak substitution requirement in a natural way while weakening
the requirement of minimal strict substitution.
         Invertibility is naturally considered only on the interior of S.1 In some cases, one may
wish to restrict the domain of interest further. For example, one might restrict attention to
values of x observed in a particular data set, or consider only positive prices even when
is de…ned on RJ (e.g., multinomial logit or probit). Let X denote the domain of interest,
where
                                     X      X~    fx 2 X :     (x) 2 int (S)g :

Let
                                                    :X !       (X )                                          (3)

denote the restriction of           to X . Our goal is to provide su¢ cient conditions for invertibility
of        ; i.e., such that for every s 2 int(S) there is at most one x 2 X satisfying                (x) = s.2
         Prior results on invertibility of demand have often relied on conditions that can be dif-
…cult to motivate and rule out important models of demand for di¤erentiated products. A
central result is the “univalence”theorem of Gale and Nikaido (1965), which showed global
invertibility of a di¤erentiable mapping when the domain X is a rectangle (a product of
intervals) and the Jacobian is everywhere a P matrix (i.e., all principal minors are strictly

     1
     In our examples, S is either the unit J-simplex or RJ+ , so int(S) excludes only points in S with zero
demand for some real good. When demand is on a boundary, invertibility will generally fail. For example,
if a good j has zero demand, an increase in its price typically will have no e¤ect. When is di¤erentiable,
                                               @ (x)
a good j with zero demand will typically have @xj k = 08k, yielding a singular Jacobian matrix.
     2
         Equivalently, such that for every s 2   (X ) there is a unique x 2 X satisfying   (x) = s:


                                                          2
positive). These su¢ cient conditions (see also the variations in, e.g., Garcia and Zangwill
(1979) and Mas-Colell (1979)) can be problematic in applications to demand. Di¤erentia-
bility is essential, but fails in some important models. Examples include those de…ned on a
discrete domain (e.g., a grid of prices) or a random utility model with discrete distributions.
Even when di¤erentiability is assumed, the Jacobian conditions can be di¢ cult to interpret
or to derive from widely applicable primitive conditions (see the examples below). Moreover,
the Jacobian conditions can be problematic when combined with the requirement of a rectan-
gular domain.3 The Jacobian will generally be singular (and, thus, certainly not a P -matrix)
outside the set X~ (recall footnote 1). Unless X~ is a rectangle, this limits the applicability
of the Gale-Nikaido result.4        Our connected substitutes conditions avoid these limitations.
Although they rule out some models as well— most important, they require either indivisible
goods or the absence of strict gross complements— they are easily interpreted, hold in wide
range of models studied in practice, and avoid any smoothness requirement or restriction on
the shape of the set X .
       The plan of the paper is as follows. In section 2 we present several examples that motivate
our interest, tie our general formulation to more familiar special cases, and provide further
connections to prior work. In section 3 we set up the model and discuss the connected
substitutes conditions.        Our invertibility result is given in section 4.           In section 5 we
examine a link between the connected substitutes conditions and the Jacobian condition of
Gale and Nikaido (1965) when demand is di¤erentiable.

   3
   It is well known that the Gale and Nikaido (1965) result does not generally extend to non-rectangular
domains (e.g., Parthasarathy and Ravindran (2003), Aleksandrov (1994)).
   4
     Consider, for example, a market with vertically di¤erentiated goods (e.g., Mussa and Rosen (1978)),
where a lower quality good has no demand unless its price is strictly lower than that of all higher quality
goods. If x is the price vector, the domain of interest X (e.g., X~ or the set of observed prices) generally
will not be a rectangle. Other examples in which the natural domain of interest X~ is nonrectangular include
models of spatial di¤erentiation (e.g., Salop (1979)) or the “pure characteristics” model of Berry and Pakes
(2007).




                                                     3
2         Examples

Estimation of Discrete Choice Demand Models. A large empirical literature uses
random utility discrete choice models of demand to study di¤erentiated products markets,
building on pioneering work of McFadden (1974, 1981), Bresnahan (1981, 1987) and others.
Conditional indirect utilities are normalized relative to that of a good 0, often an outside
good representing purchase of goods not explicitly under study.
        Much of the recent literature follows Berry (1994) in modeling price endogeneity through a
vector of product-speci…c unobservables x, with each xj shifting tastes for good j monoton-
ically.5 Holding observables …xed,          (x) gives the vector of choice probabilities (or market
shares). Typically each        j   is a nonlinear function of the the entire vector of unobservables
x. Invertibility is therefore nontrivial, and it is critical to estimation approaches, including
those of Berry, Levinsohn, and Pakes (1995) and Dube, Fox, and Su (2009).6 Berry (1994)
provided su¢ cient conditions for invertibility that include linearity (the conditional indirect
utility for good j is linear in xj ), di¤erentiability of      j   (x), and strict gross substitutes.7 Our
result relaxes all three conditions, avoiding any functional form restriction or di¤erentiability
requirement, and imposing the weaker connected substitutes structure.
        Note that a discrete choice framework can allow consumers to demand multiple indivisible
goods (including complements), since every bundle can be rede…ned as a distinct good (e.g.,

    5
     Examples include studies of the US automobile industry (e.g., Berry, Levinsohn and Pakes (1995, 1999,
2004), Petrin (2002)), the European automobile industry (e.g., Verboven (1996), Goldberg and Verboven
(2001)), the breakfast cereal industry (e.g., Nevo (2000), Nevo (2001)), newspapers (e.g., Fan (2008)), movies
(e.g., Davis (2001), Einav (2007)), radio (Berry and Waldfogel (1999)), airlines (e.g., Berry, Carnall, and
Spiller (1996), Berry and Jia (2010)), pharmaceuticals (e.g., Azoulay (2002)), and banking (e.g., Dick (2008)).
    6
     The Berry, Levinsohn, and Pakes (1995) estimation algorithm also exploits the fact that, in the models
they consider, (X ) = int(S) : Given invertibility, this ensures that even at wrong values (i.e., trial values)
of the model parameters, the observed choice probabilities can be inverted. This property is not necessary
for all estimation methods or for other purposes motivating interest in the inverse. However, Gandhi (2010)
provides su¢ cient conditions for a nonparametric model and also discusses a solution algorithm.
    7
     Although Berry (1994) assumes strict gross substitutes, his proof only requires that each inside good
strictly substitute to the outside good. Hotz and Miller (1993) provide an invertibility theorem for a similar
class of models, although they provide a complete proof only for local, not global, invertibility. Berry and
Pakes (2007) state an invertibility result for a discrete choice model relaxing some assumptions in Berry
(1994), while still assuming the linearity of utility in xj . Their proof is incomplete, although adding the
second of our two connected substitutes conditions would correct this de…ciency.



                                                      4
Gentzkow (2004)). Thus, the key restriction of a discrete choice setting is the indivisibility
of goods.8 Further, anything that raises the choice probability for good (or bundle) j must
lower the aggregated choice probabilities over all other goods. Thus the restriction to weak
substitutes (Assumption 2 below) is particularly mild in a discrete choice setting.

Nonparametric Identi…cation of Discrete Choice Demand. Separate from practical
issues of estimation, there has been growing interest in the question of whether discrete choice
demand models in the spirit of Berry, Levinsohn, and Pakes (1995) are identi…ed without
the strong functional form and distributional assumptions typically used in applications.
Berry and Haile (2009b, 2010) have recently provided a¢ rmative answers for nonparametric
random utility models in which each consumer’s conditional indirect utilities for the “inside
goods”have joint distribution
                                           Fv (vi1t; : : : ; viJt jcit )

given characteristics cit of the consumer i, the goods j, and the market t. Included in cit
is a vector xt = (x1t ; : : : ; xJt ) of unobservables re‡ecting latent tastes in market t and/or
unobserved characteristics of the goods. By conditioning out all other components of cit ,
one obtains nonparametric choice probabilities of the form (1).                Berry and Haile (2009b,
2010), relying on the invertibility result below, show that identi…cation can be obtained
using standard instrumental variables conditions or extensions of classical arguments for
identi…cation of supply and demand to a system of nonparametric simultaneous equations.

Inverting for Preference Shocks in Continuous Demand Systems. A recent paper
considering invertibility of a nonparametric continuous demand system is Beckert and Blun-
dell (2008). In their model, utility from a bundle of consumption quantities q = (q0 ; : : : ; qJ )

   8
    In a recent working paper, Azevedo, White, and Wyl (2011) consider a setting with indivisible goods,
demand for bundles, and a continuum of consumers. They focus on existence of market clearing prices
but also consider uniqueness. They require quasilinear utility and a strong notion of “large support” for
preferences. Their uniqueness result can be interpreted as demonstrating invertibility of demand (in prices)
under linear pricing of the elementary goods— a restriction on X in our notation. Each of those conditions
would have analogs when x is the vector of product-speci…c unobservables. Our result requires neither
quasilinearity nor large support, and does not limit attention to a set X consistent with linear pricing (or,
analogously, linearity of bundle preferences in the product-speci…c unobservables).



                                                        5
is given by a strictly increasing C 2 function u (q; ), with                      2 RJ denoting latent demand
shocks. The price of good 0 is normalized to 1 for simplicity. Given total expenditure m
and prices p = (p1 ; : : : ; pJ ) for the remaining goods, quantities demanded are given by


                                            qj = hj (p; m; )   j = 1; : : : ; J

                 P
with q0 = m         j>0   p j qj .
    Beckert and Blundell (2008) consider invertibility of this demand system in the latent
vector , pointing out that this is a necessary step toward identi…cation of demand or testing
of stochastic revealed preference restrictions (e.g., Block and Marschak (1960), McFadden
and Richter (1971, 1990), Falmagne (1978), McFadden (2004)). They provide several in-
vertibility results. One requires requires marginal rates of substitution between good 0 and
goods j > 0 to be multiplicatively separable in , with an invertible matrix of coe¢ cients.
Alternatively, they provide conditions (on functional form and/or on derivative matrices of
marginal rates of substitution) that imply the Gale-Nikaido Jacobian conditions.
    When gross complementarities between goods can be ruled out, we provide alternative
su¢ cient conditions for invertibility that may be more widely applicable. A natural (but
hardly necessary) way to translate their model to ours is through expenditure shares. To
do this, …x p and m, let             j   ( ) = pj h (p; m; ) =m for j > 0, and relabel x = . Expenditure
shares sum to one, implying the identity (2).
    In the Beckert and Blundell (2008) model, the goods j = 0; 1; : : : ; J under study represent
all goods in the economy. A common alternative is to consider demand for a more limited
set of goods— for example, goods in a particular product category.                            In that case, there
will no longer be a good whose demand is determined from the others’through the budget
constraint. Further, here it is natural to have a demand shock                        j   for every good j. This
situation is also easily accommodated in our framework. Again let x denote the vector
demand shock ( 1 ; : : : ;    J ).       Holding prices and all other demand shifters …xed, let         j   (x) give
the quantity demand of good j, for j = 1; : : : ; J. To complete the mapping to our model,



                                                           6
we let (2) de…ne the object        0   (x). A hint at the role this arti…cial good 0 plays below can
be seen by observing that a rise in         0   (x) represents a fall in the demand for goods j > 0 as
a whole.

Inverting for Prices in Continuous Demand Systems. One could instead investigate
invertibility in prices. Let xj =        pj , where pj is the price of good j. Conditional on all other
demand shifters, let     j   (x) give the quantity of good j demanded for the goods j = 1; : : : ; J
under consideration. Invertibility of the demand system then implies uniqueness of market
clearing prices, an important property of demand in several contexts. For example, it is
required for Cournot competition to be well de…ned and, typically, for the derivation of
equilibrium comparative statics.           Once again, the result of Gale and Nikaido (1965) has
often been employed to show uniqueness. Cheng (1985) provided more easily interpretable
conditions (and a connection to earlier results on uniqueness of Walrasian equilibrium prices,
e.g., Arrow, Block, and Hurwicz (1959)) by showing that the Gale and Nikaido (1965)
Jacobian condition holds under a standard dominant diagonal condition and a restriction
to goods that are strict gross substitutes.                The limitations of requiring di¤erentiability
and a rectangular domain are again a concern.9 Further, the requirement of strict gross
substitutes (here and in several other results cited above) rules out many standard models
of di¤erentiated products, which feature substitution that is only “local” — i.e., between
goods that are adjacent in the product space (see, e.g., Figure 1 and Appendix A below).
Our formulation avoids these limitations, once again using the identity (2) to introduce an
arti…cial good 0 as a technical device capturing aggregate demand responses.
   9
    The requirement of a rectangular domain is unstated in Cheng (1985), but required by the results relied
on in the proof (in particular, Theorem 20.4 of Nikaido (1968)).




                                                       7
3          Model

3.1         Demand

Let J = f0; 1; : : : ; Jg denote the set of all goods. Recall that x 2 X                     RJ is a vector of
demand shifters and that all other determinants of demand are held …xed.10 Demand for each
good is given by         j   (x), j 2 J , where we impose (2). Although we postpone assumptions on
    to section 3.2, one should think of xj as a monotonic shifter of demand for good j. In the
examples above, xj is either (minus) the price of good j, the unobserved quality of good j,
or a shock to taste for good j. In all of these examples, monotonicity is a standard property.
         Given (2), the demand system can be characterized by              = ( 1; : : : ;    J)   : X ! S. For
X          X~   fx 2 X :       (x) 2 int (S)g, we seek conditions such that for every s 2 int(S) there
is at most one x 2 X satisfying             (x) = s.
         Our …rst assumption is a condition on X , the set on which          is de…ned. This assumption
is required only to ensure that (x) is de…ned at all x used in our argument.                         Thus, the
requirement is that X include a su¢ ciently rich set of points. Su¢ cient conditions include X
being open (in the Euclidean topology) or a Cartesian product, the latter allowing a discrete
domain.

Assumption 1. For all distinct x; x0 2 X and all j such that xj 6= x0j , there exists                 j   2 (0; 1]
such that X contains either (a) x~, where 8k, x~k = xk +         j   x0j   xj 1 fk = jg, or (b) x~0 , where
8k, x~0k = x0k +     j   xj     x0j 1 fk = jg.

         Leading cases satisfying Assumption 1 are when either X or X is open (take                       j   su¢ -
ciently small) or when either X or X is a Cartesian product (take                      j    = 1). These cases
may capture most environments of interest.11 Even if this condition fails, it may often hold
    10
    When good 0 is an real good relative to which prices or utilities are normalized, this includes all char-
acteristics of this good. For example, we do not rule out the possibility that good 0 has a price x0 , but are
holding it …xed (e.g., at 1).
    11
    A more general su¢ cient condition, nesting these and others, is that X  Y    X , where Y is either
open or a Cartesian product. Examples of other sets satisfying Assumption 1 include the convex cone
 x 2 [0; 1)J : xj > xj 1 8j , the “quarter-disk” fx : xj 0 8j, kxk < 1g, and a rectangle with an open
hole, such as x 2 [0; 1]J : kxk > 21 .


                                                       8
under an extension of the domain X (e.g., to an open cover) or with a slightly smaller X .
    We contrast this assumption with Gale and Nikaido’s (1965) requirement of a rectangular
X .     Our assumption is much weaker: rectangular X is a special case of Cartesian X .
Further, our assumption need not place any restriction on the shape or other properties of
the set X on which invertibility of     is considered. Finally, Assumption 1 plays the role of
a regularity condition for our result, whereas a rectangular domain is integral to the proof
strategy in Gale and Nikaido (1965).


3.2     Connected Substitutes

Our main requirement for invertibility is a pair of conditions characterizing the notion of
connected substitutes. The …rst is that the goods are weak substitutes in x in the sense that
when xj increases (e.g., price falls) for only a subset of goods j, demand for the remaining
goods, taken as a whole, does not increase.

Assumption 2. For any I J and any x; x0 2 X such that x0j                xj 8j 2 I and x0j       xj
       P         0
                    P
8j 2
   = I, j 2I
          =  j (x )  j 2I
                       =  j (x).


    Observe than when good 0 is an arti…cial good, its presence in J adds to the requirements
of Assumption 2 in a natural way. Taking the case where x is (minus) price, all else equal, a
fall in the price of some/all goods j > 0 cannot cause the total demand (over all goods) to
fall.
    An alternative notion of weak substitution (that of weak gross substitutes) is that      k   (x)
is nonincreasing in xj for all k; j 6= k. It is easy to see that this is implied by Assumption
2 (take x0j    xj , x0i = xi 8i 6= j; and I = J n fkg). In many models these conditions are
equivalent— for example, when X is a Cartesian product (see Appendix C). In a discrete
choice model, it is easily veri…ed that both notions of weak substitution are implied by the
standard assumptions that xj is excluded from the conditional indirect utilities of goods
k 6= j and that the conditional indirect utility for good j is increasing in xj .
    To state the second condition characterizing connected substitutes, we …rst de…ne a


                                                9
directional notion of (strict) substitution.

De…nition 1. Good j substitutes to good k at x if               k   (x) is strictly decreasing in xj .

       Consider a decline in xj with all else held …xed. Assumption 2 implies that this weakly
raises     k   (x) for all k 6= j. The goods to which j substitutes are those whose demands              k   (x)
strictly rise. If xj is (minus) the price of good j, this is a standard notion of strict gross
substitution from j to k. De…nition 1 merely extends this notion to other demand shifters
that may play the role of x. Although this is a directional notion, substitution (as de…ned
here) is typically symmetric; i.e., j substitutes to k i¤ k substitutes to j. An exception is
substitution to good 0: since any demand shifters for good 0 are held …xed, good 0 does not
substitute to other goods.12
       It will be useful to represent substitution among the goods with the directed graph of
the matrix         (x) whose elements are

                                  8
                                  < 1 fgood j substitutes to good k at xg           j>0
                      j+1;k+1   =
                                  : 0                                               j = 0:


The directed graph of           (x) has nodes (vertices) representing each good and a directed edge
from node k to node ` whenever good k substitutes to good ` at x.

Assumption 3. For all x 2 X , the directed graph of                    (x) has, from every node k 6= 0, a
directed path to node 0.

       Figure 1 illustrates the directed graphs of         (x) at generic x 2 X         for some standard
models of di¤erentiated products, letting x = ( p1 ; : : : ; pJ ), where pj is the price of good j,
and assuming (as usual) that conditional indirect utilities are strictly decreasing in price. In
all of these models, Assumptions 2 and 3 hold. As panel f illustrates, they hold even when
  12
    If good 0 is a real good designated to normalize utilities or prices, one can imagine expanding x to
include x0 and de…ning substitution from good 0 to other goods prior to the normalization that …xes x0 . If
Assumption 3 holds under the original designation of good 0, it will hold for all designations of good 0 as
long as substitution (using the expanded vector x = (x0 ; : : : xJ )) is symmetric at all x 2 , a property that
would hold in all the examples below.


                                                      10
Figure 1: Directed graphs of (x) for x 2 X      ~ (x equals minus price) in some standard
models of di¤erentiated products. Panel a: multinomial logit, multinomial probit, mixed
logit, etc.; Panel b: models of pure vertical di¤erentiation, (e.g., Mussa and Rosen (1978),
Bresnahan (1981b), etc.); Panel c: Salop (1979) with random utility for the outside good;
Panel d: Rochet and Stole (2002); Panel e: independent goods with either an outside good
or an arti…cial good 0.




                                            11
J is comprised of independent goods and either an outside good or an arti…cial good 0. Each
of these examples has an extension to models of discrete/continuous demand (e.g., Novshek
and Sonnenschein (1979), Hanemann (1984), Dubin and McFadden (1984)), multiple discrete
choice (e.g., Hendel (1999), Dube (2004)), and models of di¤erentiated products demand
(e.g., Deneckere and Rothschild (1992), Perlo¤ and Salop (1985)) that provide a foundation
for representative consumer models of monopolistic competition (e.g., Spence (1976), Dixit
and Stiglitz (1977)).13
       It may be useful to compare the connected substitutes conditions to a strict gross substi-
tutes assumption, where       j   (x) is strictly decreasing in xk for all k 6= j. The latter obviously
implies Assumption 2, and it further implies that every good j > 0 substitutes to every other
good at all x 2 X — a strong su¢ cient condition for Assumption 3. In Figure 1, however,
only the models represented in panel a satisfy the strict gross substitutes condition (see also
Appendix A).
       The following lemma provides a helpful interpretation of Assumption 3 and is useful
below.

Lemma 1. Assumption 3 holds i¤ for all x 2 X and any nonempty K                              J n0, there exist
k 2 K and ` 2
            = K such that          `   (x) is strictly decreasing in xk .

Proof. (necessity of Assumption 3) Let I0 (x)                   J be comprised of 0 and the indexes of all
other goods whose nodes have a directed path to node 0 in the directed graph of                         (x). If
Assumption 3 fails, then for some x 2 X the set K = J nI0 (x) is nonempty. Further, by
construction there is no directed path from any node in K to any node in I0 (x).                          Thus,
there do not exist k 2 K and ` 2
                               = K such that                `   (x) is strictly decreasing in xk :
(su¢ ciency) Assumption 3 implies that for all x 2 X and any nonempty K                              J n0, every

  13
    Mosenson and Dror (1972) used a graphical representation to characterize the possible patterns of sub-
sitution for Hicksian demand. Suppose x is minus the price vector, expanded to include the price of good
zero (see footnote 12 ). Suppose further that       is di¤erentiable and represents the Hicksian (compen-
sated) demand of an individual consumer. Let + (x) be the expanded subsitution matrix, with elements
  +
  j+1;k+1 = 1 fgood j substitutes to good k at xg : Mosenson and Dror (1972) show that the directed graph
of + (x) must be strongly connected. This is a su¢ cient condition for Assumption 3.



                                                       12
node k 2 K has a directed path in            (x) to node 0 2
                                                           = K. This is impossible unless there
exist k 2 K and ` 2
                  = K such that good k substitutes to good `.

       Thus, Assumption 3 requires that there be no way to partition J into subsets of goods
that substitute only among themselves.           Note that when good 0 is an arti…cial good, its
presence in J weakens the requirements of Assumption 3. In particular, taking the case
where x is (minus) price, when the price of some good j > 0 falls, it may be only the
demand for good zero that strictly declines.
       Finally, when introducing the model we suggested that xj should be thought of as a
monotonic shifter of demand for good j. The following remark shows that we have implicitly
imposed this monotonicity with the connected substitutes conditions.

Remark 1. Suppose Assumptions 2 and 3 hold. Then for all x 2 X and j > 0,                       j   (x) is
strictly increasing in xj :

Proof. Take x 2 X and x0 2 X such that x0j > xj ; x0k = xk 8k 6= j. Assumption 2 implies

 k   (x0 )       k  (x) 8k =6 j: Further, by Lemma 1, ` (x0 ) <        `   (x) for some ` 6= j. Thus,
P                0
                      P
     k6=j    ` (x ) <   k6=j ` (x). The claim then follows from (2).




4           Invertibility of Demand

We now establish our main result. We begin with a key lemma.14

Lemma 2. Let Assumptions 1–3 hold. If x; x0 2 X are such that I +                      j : x0j > xj     is
              P               P
nonempty, then j2I + j (x0 ) > j2I + j (x) :

               = I + , Lemma 1 ensures that for some k 2 I + and some ` 2
Proof. Since 0 2                                                        = I +,                  `   (x) is
strictly decreasing in xk . Take one such pair (k; `). Taking case (a) of Assumption 1, suppose
  14
     If X is open then, given Assumptions 1 and 2, Assumption 3 is necessary for the conclusion of this
lemma. Suppose Assumption 3 fails. Then by Assumption 2 and Lemma 1 there is some x 2           and some
nonempty K J n0, such that ` (x) is constant in xk for all k 2 K and all ` 2  = K. For some > 0 and each
           0                   0                       +
k
P2 K let xk0 = xPk + , while xj = xj for j 2
                                           = K.
                                              P Now I =0 K. P  For su¢ ciently small we have x0 2 X and
    = + j (x ) =
  j 2I               = + j (x), which implies
                   j 2I                         j2I + j (x ) =   j2I + j (x).


                                                   13
that for some      2 (0; 1] the point x~ lies in X , where x~j = xj + (x0k                                                 xk ) 1 fj = kg 8j. By
Assumption 2,      j   (~
                        x)      j   (x) for all j 6= k. Further,                              `   (~
                                                                                                   x) <         `   (x) by our choice of (k; `).
            = I +;
So, since ` 2
                                                 X                          X
                                                          j    (~
                                                                x) <                    j   (x) :
                                                   = +
                                                 j 2I                         = +
                                                                            j 2I
                                    P                             P
Assumption 2 also implies                  = +
                                         j 2I      j   (x0 )              = +
                                                                        j 2I        j    x), so we obtain
                                                                                        (~

                                    X                          X                             X
                                             j   (x0 )                      j   (~
                                                                                 x) <                   j   (x)
                                      = +
                                    j 2I                         = +
                                                               j 2I                           = +
                                                                                            j 2I


and the result follows from (2).                       If x~ 2
                                                             = X , so that case (b) of Assumption 1 applies,
instead take k 2 I + and ` 2
                           = I + for which                              `   (x0 ) is strictly decreasing in xk (such a pair
being sure to exist by Lemma 1). For some                                       2 (0; 1], the point x~0 must lie in X , where
x~0j = x0j + (xk       x0k ) 1 fj = kg 8j. By a symmetric argument we obtain

                                     X                         X                            X
                                             j    (x)                   j   (~
                                                                             x) >                   j   (x0 )
                                     j 2I
                                       =                       j 2I
                                                                 =                          j 2I
                                                                                              =


and the result follows from (2).

    To demonstrate invertibility of demand under the connected substitutes conditions, we
will …rst show that          (recall 3) is inverse isotone. Below we use                                             to denote the component-
wise weak partial order on Rn . Thus for y; y 0 2 Rn , y                                          y 0 i¤ yi          yi0 for all i = 1; : : : ; n:

De…nition 2. A mapping F : D                              Rn ! Rm is inverse isotone if for any y; y 0 2 D,
F (y 0 )   F (y) implies y 0        y:

Theorem 1. Under Assumptions 1–3,                                : X ! S is inverse isotone.

Proof. Take any x; x0 2 X such that


                                                               (x0 )              (x)                                                                (4)


and suppose, contrary to the claim, that the set I + =                                                  j : x0j > xj        is non-empty.            By

                                                                       14
Lemma 2 this requires
                                           X                        X
                                                             0
                                                         j (x ) >              j   (x)
                                           j2I +                    j2I +

which contradicts (4).

         The following remark documents a well known connection between inverse isotone map-
pings and invertible mappings (see, e.g., Rheinboldt (1970)).15

Remark 2. If F : D             Rn ! Rm is inverse isotone, it is injective.

Proof. Suppose F (y) = F (y 0 ) for y; y 0 2 D. Since F is inverse isotone this implies both
y        y 0 and y 0   y; hence y 0 = y:

         Given Remark 2, our invertibility result follows as a corollary to Theorem 1.

Corollary 1. Under Assumptions 1–3, for any s 2 int(S) there is at most one x 2 X such
that        (x) = s.



5          Connected Substitutes and the Jacobian Matrix

It is possible to provide a connection between our connected substitutes conditions and the
global Jacobian condition required by the univalence theorem of Gale and Nikaido (1965).
Suppose          is di¤erentiable on X and let J (x) denote the Jacobian matrix

                                           2                                       3
                                               @    1 (x)            @    1 (x)
                                                             :::
                                           6       @x1                   @xJ       7
                                           6        ..       ...          ..       7
                                           6         .                     .       7:
                                           4                                       5
                                               @    J (x)            @    J (x)
                                                   @x1
                                                             :::         @xJ


Recall that a square matrix is said to be a P -matrix if all its principal minors are positive.
    15
    Another application of Theorem 1 appears in a recent paper by Gandhi, Lu, and Shi (2011). They
exploit the inverse isotone property shown here in studying identi…cation and estimation of multinomial
choice demand models under mismeasurement of market shares.




                                                              15
Theorem 2. Suppose that Assumptions 1–3 hold. Suppose further that for all x 2 X ,
is di¤erentiable and substitution is symmetric between all goods j; k > 0. Then J (x) is a
P -matrix for all x 2 X .

Proof. See Appendix B.

       One would never use this result to establish invertibility— if the connected substitutes
conditions hold, Corollary 1 establishes invertibility without the additional di¤erentiability
and domain restrictions Gale and Nikaido (1965) require.16 However, Theorem 2 is useful for
understanding the relationship between the two results. Ours avoids the smoothness and
domain restrictions of Gale and Nikaido (1965) while imposing restrictions on substitution
that, given di¤erentiability and a weak symmetry condition, are su¢ cient for the Gale-
Nikaido Jacobian requirement.
       Conditions ensuring that the Jacobian of       is a P matrix are of independent interest
as well. Berry and Haile (2010) use this result in establishing the identi…ability of supply
in di¤erentiated products markets— i.e., identi…cation of marginal costs and of the model
of oligopoly competition. In particular, the P -matrix property ensures invertibility of the
derivative matrix of market shares with respect to prices for goods produced by the same
…rm— a matrix appearing in the …rst-order conditions for each …rm. Their identi…cation
results generalize immediately to oligopoly supply models with continuous demand.               The
P -matrix property can also be applied instead to the matrix of derivatives of market shares
with respect to the latent demand shocks, which is su¢ cient to ensure a key condition used
in Berry, Linton, and Pakes (2004) (and con…rmed there for special cases) to provide the
asymptotic distribution theory for a class of estimators for discrete choice demand models.
In particular, it ensures the Jacobian of demand is always full rank over X .
  16
    Note that Assumption 2 implies that the matrix J (x) is of the “Leontie¤ type.” Thus, given the
connected substitutes conditions we used to show that was inverse isotone in Theorem 1, one could use
Theorem 5 in Gale and Nikado (1965) to show this same property under the additional requirements of
di¤erentiability and rectangular domain.




                                                 16
6    Conclusion

We have introduced the notion of “connected substitutes” and shown that this structure is
su¢ cient for invertibility in a large class of nonparametric nonseparable demand systems.
The connected substitutes conditions are satis…ed in a large class of models used in prac-
tice, have transparent economic interpretation, and allow us to show invertibility without
functional form restrictions, smoothness assumptions, or strong domain restrictions.   We
have also provided a link between the connected substitutes conditions and the Jacobian
condition required by the classical univalence result of Gale and Nikaido (1965).




                                             17
Appendix A. An Example

Here we present a simple variation of Lancaster’s (1966) “diet example,”illustrating a contin-
uous demand system with only local substitution, with a non-rectangular domain of interest
, and where the introduction of an arti…cial good 0 is useful even though an outside good is
already modeled.
      A representative consumer has a budget of y and chooses consumption quantities (q1 ; q2 ; q3 )
of three goods: wine, bread, and cheese, respectively. Her preferences are given by a utility
function
                              u (q1 ; q2 ; q3 ) = ln(z1 ) + ln (z2 ) + ln (z3 ) + m

where (z1 ; z2 ; z3 ) are consumption of calories, protein, and calcium, and m is money left to
spend on other goods. The mapping of goods consumed to characteristics consumed is given
by17


                                             z1 = q1 + q2 + q3

                                             z2 = q2 + q3

                                             z3 = q3 :


We assume y > 3 and that prices (p1 ; p2 ; p3 ) are such that all goods are purchased, i.e.,


                                        0 < p1 < p2      p1 < p 3    p2 :                                    (5)


Since p plays the role of x here, (5) also de…nes X~ . X~ is not a rectangle; however, because
X~ is open Assumption 1 holds for any X                X~ (see footnote 11).

 17
      Unlike Lancaster (1966), we sacri…ce accuracy of nutritional information for the sake of simplicity.




                                                       18
               Figure 2: The directed graph of            (x) for the “diet example.”



   It is then easily veri…ed that demand for each inside good is given by

                                               1              1
                                 1   (p) =
                                               p1       p2        p1
                                                    1                  1
                                 2   (p) =                                                    (6)
                                               p2       p1        p3       p2
                                                    1
                                 3   (p) =
                                               p3       p2

for p 2 X .   These equations fully characterize demand for all goods.           We introduce the
arti…cial quantity of “good 0”, de…ned by

                                                        X
                                                        3
                                        q0     1              qj :                            (7)
                                                        j=1


Observe that this arti…cial good is not the outside good m. Further, the connected substitutes
conditions would not hold if the outside good were treated as good 0:
   With (6), (7) implies
                                                              1
                                         0   (p) = 1             :
                                                              p1

From these equations, it is now easily con…rmed that Assumption 2 holds Further, goods 2
and 3 substitute to each other, goods 1 and 2 substitute to each other, and good 1 substitutes
to good 0. Thus, Assumption 3 also holds. Figure 2 illustrates.




                                                   19
Appendix B. Proof of Theorem 2

We prove Theorem 2 by showing that, under its hypotheses, every principal submatrix of
J (x) is invertible at all x 2 X . We …rst review some de…nitions.
   A square matrix is reducible if it can be placed in block upper triangular form by permu-
tations of rows and columns. A square matrix that is not reducible is irreducible. A square
matrix A with elements aij is diagonally dominant if for all i

                                                       X
                                            jaii j            jaij j:
                                                       j6=i


An irreducibly diagonally dominant matrix is a square matrix that is irreducible and diag-
onally dominant, with at least one diagonal being strictly dominant, i.e., with at least one
row such that
                                                       X
                                            jaii j >          jaij j:                                      (8)
                                                       j6=i

A directed graph G is strongly connected if for every pair of distinct nodes (i; j) in G there
exists a directed path from i to j.
   We will rely on the following well known result (see, e.g., Taussky (1949) or Horn and
Johnson (1990), p. 363).

Lemma 3. An irreducibly diagonally dominant matrix is invertible.

   For nonempty K          f1; 2; : : : ; Jg, let DK (x) denote the principal submatrix of J (x)
obtained by deleting rows r 2
                            = K and columns c 2
                                              = K.

Lemma 4. Suppose        is di¤erentiable on X and that Assumptions 1–3 hold. Then for all
x 2 X and nonempty K           f1; 2; : : : ; Jg, DK (x) is diagonally dominant, with at least one
strictly dominant diagonal.

                                 P                             P         @    k (x)
Proof. Take x 2 X . Because           k2J    k   (x) = 1,          k2J       @xj
                                                                                      = 0. By Assumption 2 and




                                                       20
              @    j (x)                   @    k (x)
Remark 1,         @xj
                           > 0 while           @xj
                                                            0 for all k 6= j. Thus, for any j 2 K,


                                 @     (x)
                                       j
                                                            X      @   k (x)   X @ ` (x)
                                           =                                 +           :                        (9)
                                     @xj                               @xj        @xj
                                                         k2K fjg                  `2K
                                                                                   =


which implies
                                                   @    j (x)          X     @   k (x)
                                                                                       :                         (10)
                                                        @xj                      @xj
                                                                   k2K fjg

Furthermore, since 0 2
                     = K, Lemma 1 implies that for some j 2 K the second sum in (9) is
strictly positive. For that j the inequality (10) must be strict.

    The following lemma states a useful elementary result in matrix theory (see, e.g., Horn
and Johnson (1990), p. 362).

Lemma 5. The directed graph of a square matrix A is strongly connected i¤ A is irreducible.

    We now complete the proof of Theorem 2. Take arbitrary x 2 X                                      and nonempty
K    f1; 2; : : : ; Jg.       We will show that DK (x) is invertible.                      First suppose the directed
graph of DK (x) is strongly connected. By Lemmas 4 and 5 it is then an irreducibly diag-
onally dominant matrix and, therefore, invertible by Lemma 3. So suppose instead that
the directed graph of DK (x) is not strongly connected. Since substitution is symmetric on
X , all edges in the directed graph of DK (x) must be bidirectional. Since this graph is not
strongly connected, it must then be possible to partition it into isolated strongly connected
subgraphs, each of which corresponds to a subset of goods that substitute only among them-
selves in K. We can therefore rearrange the order of goods in K, with those in one strongly
connected subset coming …rst, another subset following, and so on. The resulting permuta-
tion of DK (x) is block diagonal, with each block being irreducible by Lemma 5. Further, by
Lemma 4, each block is diagonally dominant with at least one strictly dominant diagonal.
Therefore, by Lemma 3, each block is invertible. This implies that the entire DK (x) matrix
is invertible. Since K and x 2 X were arbitrary, every principal submatrix of J (x) is
invertible for all x 2 X .


                                                                    21
Appendix C

We pointed out in the text that our notion of weak substitution always implies the alternative
notion, that   j   (x) is weakly decreasing in xk for all k 6= j. The following result provides
one su¢ cient condition for the two notions to be equivalent.

Proposition 1. Suppose X is a Cartesian product and that for all x 2 X ,                      j   (x) is weakly
decreasing in xk for all k 6= j. Then Assumption 2 holds.

Proof. Suppose x0j        xj for all j 2 I, while x0j          xj for all j 2
                                                                            = I. Let x~ be such that x~j = xj
for j 2 I and x~j = x0j for j 2
                              = I. Since X is a Cartesian product, x~ 2 X . Because                     j   (x) is
weakly decreasing in xk for k 6= j

                                         X                    X
                                                j (~
                                                   x)                j (x):
                                         j2I                  j2I


With (2), this implies
                                         X                    X
                                                j (~
                                                   x)                j (x);
                                         j 2I
                                           =                  j 2I
                                                                =

Further, because      j   (x) is weakly decreasing in xk for k 6= j,

                                         X                    X
                                                    0
                                                i (x )               i (~
                                                                        x)
                                         j 2I
                                           =                  j 2I
                                                                =


and the result follows.




                                                         22
References

Aleksandrov, V. (1994): “On the Gale-Nikaido-Inada Fundamental Theorem on Univa-
  lence of Mappings,”Siberian Mathematical Journal, 35, 637–639.

Arrow, K. J., H. D. Block, and L. Hurwicz (1959): “On the Stability of the Com-
  peetitive Equilibrium. II,”Econometrica, 27, 82–109.

Azevedo, E., A. White, and E. G. Wyl (2011): “Walrasian Equilibrium without Gross
  Substitutes,”Discussion paper, Harvard University.

Azoulay, P. (2002): “Do Pharmaceutical Sales Respond to Scienti…c Evidence?,”Journal
  of Economics and Management Strategy, 11, 551–594.

Beckert, W., and R. Blundell (2008): “Heterogeneity and the Non-Parametric Analysis
  of Consumer Choice: Conditions for Invertibility,”Review of Economic Studies, 75, 1069–
  1080.

Berry, S. (1994): “Estimating Discrete Choice Models of Product Di¤erentiation,”RAND
  Journal of Economics, 23(2), 242–262.

Berry, S., M. Carnall, and P. Spiller (1996): “Airline Hubs: Costs, Markups and the
  Implications of Consumer Heterogeneity,”Discussion Paper 5561, NBER.

Berry, S., and P. Jia (2010): “Tracing the Woes: An Empirical Analysis of the Airline
  Industry,”American Economic Journals: Microeconomics.

Berry, S., J. Levinsohn, and A. Pakes (1995): “Automobile Prices in Market Equilib-
  rium,”Econometrica, 60(4), 889–917.

          (1999): “Voluntary Export Restraints on Automobiles: Evaluating a Strategic
  Trade Policy,”American Economic Review, 89(3), 189–211.

          (2004): “Di¤erentiated Products Demand Systems from a Combination of Micro
  and Macro Data: The New Vehicle Market,”Journal of Political Economy, 112(1), 68–105.

                                           23
Berry, S., O. Linton, and A. Pakes (2004): “Limit Theorems for Di¤erentiated Product
  Demand Systems,”Review of Economic Studies, 71(3), 613–614.

Berry, S., and J. Waldfogel (1999): “Free Entry and Social Ine¢ ciency in Radio Broad-
  casting,”RAND Journal of Economics, 70(3), 397–420.

Berry, S. T., and P. A. Haile (2009a): “Identi…cation in Di¤erentiated Products Markets
  Using Market Level Data,”Discussion paper, Yale University.

         (2009b): “Nonparametric Identi…cation of Multinomial Choice Demand Models
  with Heterogeneous Consumers,”Discussion paper, Yale University.

         (2010): “Identi…cation in Di¤erentiated Products Markets Using Market Level
  Data,”Discussion paper, Yale University.

Berry, S. T., and A. Pakes (2007): “The Pure Characteristics Demand Model,”Discus-
  sion paper, Yale University.

Block, H., and J. Marschak (1960): “Random Orderings and Stochastic Theories of
  Responses,” in Contributions to Probability and Statistics: Essays in Honor of Harold
  Hotelling, ed. by I. Olkin, S. Ghurye, W. Hoe¤ding, W. G. Mado, and H. B. Mann.
  Stanford University Press.

Bresnahan, T. (1981a): “Departures from Marginal Cost Pricing in the American Auto-
  mobile Industry,”Journal of Econometrics, 17, 201–227.

         (1981b): “Departures from Marginal Cost Pricing in the Auomobile Industry,”
  Journal of Econometrics, 17, 457–482.

         (1987): “Competition and Collusion in the American Automobile Oligopoly: The
  1955 Price War,”Journal of Industrial Economics, 35, 457–482.

Cheng, L. (1985): “Inverting Systems of Demand Functions,”Journal of Economic Theory,
  37, 202–210.

                                             24
Davis, P. (2001): “Spatial Competition in Retail Markets: Motion Theaters,” Discussion
  paper, London School of Economics.

Deneckere, R., and M. Rothschild (1992): “Monopolistic Competition and Preference
  Diversity,”Review of Economic Studies, 59, 361–373.

Dick, A. (2008): “Demand Estimation and Consumer Welfare in the Banking Industry,”
  Journal of Banking and Finance, 32, 1661–1676.

Dixit, A., and J. E. Stiglitz (1977): “Monopolistic Competition and Optimum Product
  Diversity,”American Economic Review, 67, 297–308.

Dube, J.-P. (2004): “Multiple Discreteness and Product Di¤erentiation: Demand for Car-
  bonated Soft Drinks,”Marketing Science, 23, 66–81.

Dube, J.-P., J. Fox, and C.-L. Su (2009): “Improving the Numerical Performance of
  BLP StaticCoe¢ cients Demand Estimation,”Discussion paper, University of Chicago.

Dubin, J., and D. McFadden (1984): “An Econometric Analysis of Residential Electric
  Appliance Holdings and Consumption,”Econometrica, 52(2), 345–62.

Einav, L. (2007): “Seasonality in the U.S. Motion Picture Industry,” Rand Journal of
  Economics, 38, 127–145.

Falmagne, J.-C. (1978): “A Representation Theorem for Finite Random Scale Systems,”
  Journal of Mathematical Psychology, 18, 52–72.

Fan, Y. (2008): “Market Structure and Product Quality in the U.S. Daily Newspaper
  Market,”Discussion paper, Yale University.

Gale, D., and H. Nikaido (1965): “The Jacobian Matrix and Global Univalence of Map-
  pings,”Mathematische Annalen, 159, 81–93.

Gandhi, A. (2008): “On the Nonparametric Foundations of Discrete Choice Demand Esti-
  mation,”Discussion paper, University of Wisconsin-Madison.

                                          25
        (2010): “Inverting Demand in Product Di¤erentiated Markets,” Discussion paper,
  University of Wisconsin-Madison.

Gandhi, A., Z. Lu, and X. Shi (2011): “Estimating Discrete Choice Models with Market
  Level Data: A Bounds Approach,”Discussion paper, University of Wisconsin-Madison.

Garcia, C., and W. Zangwill (1979): “On Univalence and P-Matrices,”Linear Algebra
  and Its Applications, 24, 239–250.

Gentzkow, M. (2004): “Valuing New Goods in a Model with Complementarity: Online
  Newspapers,”Working paper, Chicago GSB.

Goldberg, P., and F. Verboven (2001): “The Evolution of Price Dispersion in the
  European Car Market,”The Review of Economics Studies, 68(4), 811–848.

Hanemann, W. M. (1984): “Discrete/Continuous Models of Consumer Demand,” Econo-
  metrica, 52, 541–561.

Hendel, I. (1999): “Estimating Multiple-Discrete Choice Models: An Application to Com-
  puterization Returns,”Review of Economic Studies, 66(2), 423–46.

Horn, R. A., and C. R. Johnson (1990): Matrix Analysis. Cambrige University Press.

Hotz, J., and R. A. Miller (1993): “Conditional Choice Probabilites and the Estimation
  of Dynamic Models,”Review of Economic Studies, 60, 497–529.

Lancaster, K. J. (1966): “A New Approach to Consumer Theory,” Journal of Political
  Economy, 74, 132–157.

Mas-Colell, A. (1979): “Homeomorphisms of Compact, Convex Sets and the Jacobian
  Matrix,”Siam Journal of Mathematics, 10, 1105–1109.

McFadden, D. (1974): “Conditional Logit Analysis of Qualitative Choice Behavior,” in
  Frontiers of Econometrics, ed. by P. Zarembka. Academic Press, New York.



                                          26
         (1981): “Econometric Models of Probabilistic Choice,” in Structural Analysis of
  Discrete Data with Econometric Applications, ed. by C. Manski, and D. McFadden. MIT
  Press, Cambridge, MA.

         (2004): “Revealed Stochastic Preference: A Synthesis,” Discussion paper, UC
  Berkeley.

McFadden, D., and M. K. Richter (1971): “On the Extension of a Set Function on a
  Set of Events to a Probabiliyt on the Generated Boolean -Algebra,” Discussion paper,
  UC Berkeley.

        (1990): “Stochastic Rationality and Revealed Stochastic Preference,”in Preferences,
  Uncertainty, and Rationality, ed. by J. Chipman, D. McFadden, and M. Richter, pp. 161–
  186. Westview Press.

Mosenson, R., and E. Dror (1972): “A Solution to the Qualitative Substitution Problem
  in Demand Theory,”Review of Economic Studies, 39, 433–441.

Mussa, M., and S. Rosen (1978): “Monopoly and Product Quality,”Journal of Economics
  Theory, 18, 301–307.

Nevo, A. (2000): “Mergers with Di¤erentiated Products: The Case of the Ready-to-Eat
  Cereal Industry,”RAND Journal ofEconomics, 31(3), 395–421.

         (2001): “Measuring Market Power in the Ready-to-Eat Cereal Industry,” Econo-
  metrica, 69(2), 307–42.

Nikaido, H. (1968): Convex Structures and Economic Theory. Academic Press.

Novshek, W., and H. Sonnenschein (1979): “Marginal Consumers and Neoclassical
  Demand Theory,”Journal of Political Economy, 87, 1368–1376.

Parthasarathy, T., and G. Ravindran (2003): “Global Univalence and the Jacobian
  Conjecture,”in Applicable Mathematics in the Golden Age, ed. by J. Misra. Narosa Pub-
  lishing House.

                                            27
Perloff, J. M., and S. C. Salop (1985): “Equilibrium with Product Di¤erentiation,”
  Review of Economic Studies, 52, 107–120.

Petrin, A. (2002): “Quantifying the Bene…ts of New Products: The Case of the Minivan,”
  JPE, 110(4), 705–729.

Rheinboldt, W. C. (1970): “On M-Functions and Their Application to Nonlinear Gauss-
  Seidel Iterations and to Network Flows,” Journal of Mathematical Analysis and Applica-
  tions, 32, 274–307.

Rochet, J.-C., and L. A. Stole (2002): “Nonlinear Pricing with Random Participation,”
  The Review of Economic Studies, 69(1), 277–311.

Salop, S. (1979): “Monopolistic Competition with Outside Goods,” RAND Journal of
  Economics, 10, 141–156.

Spence, M. (1976): “Product Selection, Fixed Costs and Monopolistic Competition,” Re-
  view of Economic Studies, 43, 217–236.

Taussky, O. (1949): “A Recurring Theorem on Determinants,”The American Mathemat-
  ical Monthly, 56(10), 672–676.

Verboven, F. (1996): “International Price Discrimination in the European Car Market,”
  Rand Journal of Economics, 27, 240–268.




                                             28
