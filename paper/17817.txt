                                NBER WORKING PAPER SERIES




OPTIMAL ASSET TAXES IN FINANCIAL MARKETS WITH AGGREGATE UNCERTAINTY

                                           Florian Scheuer

                                        Working Paper 17817
                                http://www.nber.org/papers/w17817


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     February 2012




Previous versions of this paper have been circulated under the title "Pareto-optimal Taxation with
Aggregate Uncertainty and Financial Markets.'' I am especially grateful to Daron Acemoglu and Ivan
Werning for ongoing support and discussions. I also thank Abhijit Banerjee, Felix Bierbrauer, Peter
Diamond, Emmanuel Farhi, Mike Golosov, Christian Hellwig, Casey Rothschild, Alp Simsek, Robert
Townsend, Aleh Tsyvinski, Matthew Weinzierl and seminar participants for helpful comments. The
views expressed herein are those of the author and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2012 by Florian Scheuer. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Optimal Asset Taxes in Financial Markets with Aggregate Uncertainty
Florian Scheuer
NBER Working Paper No. 17817
February 2012
JEL No. D8,E2,E6,G1,H2

                                              ABSTRACT

This paper studies Pareto-optimal risk-sharing arrangements in a private information economy with
aggregate uncertainty and ex ante heterogeneous agents. I show how to implement Pareto-optima as
equilibria when agents can trade claims to consumption contingent on aggregate shocks in financial
markets. The first result is that if aggregate and idiosyncratic shocks are independent, the implementation
of optimal allocations does not require any interventions in financial markets. This result can be extended
to dynamic settings in the sense that, in this case, only savings need to be distorted, but not trades in
financial markets. Second, I characterize optimal trading distortions in financial markets when aggregate
and idiosyncratic shocks are not independent. In this case, optimal asset taxes must be higher for those
securities that pay out in aggregate states in which consumption is more volatile. For instance, this
can provide an efficiency justification for the frequently observed differential tax treatment of different
asset classes, such as debt and equity claims.


Florian Scheuer
Department of Economics
Stanford University
579 Serra Mall
Stanford, CA 94305
and NBER
scheuer@stanford.edu
1     Introduction
Individual households face substantial economic risk over their lifetimes in the form of
both idiosyncratic and aggregate uncertainty. For instance, individuals’ employment, in-
come, health status and mortality are all subject to idiosyncratic shocks and to economy-
wide shifts in unemployment rates, wages, technology and life-expectancies. The two
kinds of shocks have very different implications for risk-sharing, though. Whereas in-
dividuals can influence their idiosyncratic uncertainty by taking unobservable actions,
aggregate risk is not typically related to such private information problems. Moreover,
aggregate uncertainty is harder to smooth by pooling risks than idiosyncratic uncertainty.
Yet there do exist opportunities for smoothing even aggregate risk when aggregate shocks
have different effects on different agents in the economy. For instance, country-specific
aggregate shocks may only affect agents in one country, not those abroad. A recession
may increase unemployment rates in some sectors of the economy more than in others,
and changes in wages and mortality rates have different impacts on elderly, retired agents
than on young workers.1
    In this paper, I ask how idiosyncratic and aggregate risk should be shared optimally
among different groups in the economy. I consider a model where ex ante heterogeneous
agents are subject to both aggregate and idiosyncratic shocks. Individuals can influence
their probability distribution over idiosyncratic shocks by choosing some hidden effort,
leading to a standard moral hazard problem. Aggregate shocks, by contrast, are assumed
to be exogenous and to affect all agents’ outputs and probability distributions over id-
iosyncratic shocks, but in potentially different ways. If agents’ preferences over consump-
tion and effort are separable, any Pareto-optimal risk-sharing arrangement in this private
information economy has to be such that the ratios of expected inverse marginal utilities
between different agents are independent of aggregate shocks.
    I use this efficiency condition to study the role of financial markets in my economy,
where agents exchange claims to consumption contingent on aggregate shocks. In prac-
tice, agents are able to insure considerable parts of the aggregate risk that they are exposed
to by trading such financial assets. For instance, agents can hedge country-specific risk by
buying foreign assets, and workers in a given sector can buy shares of companies in other
sectors to reduce their overall exposure to the effects of aggregate shocks on their own
sector. In general, Pareto-optimal risk-sharing arrangements are inconsistent with agents
having free access to such financial markets since trading in financial markets leads to
    1 Attanasio
              and Davis (1996) provide overwhelming empirical evidence for consumption insurance op-
portunities between birth cohorts and education groups in the US. Storesletten et al. (2004) also find that
intergenerational sharing of aggregate risk is quantitatively important.


                                                    1
the equalization of ratios of expected marginal utilities across different agents rather than
expected inverse marginal utilities.
     However, I show that there exists an important benchmark case where this conflict
disappears: If aggregate and idiosyncratic shocks are stochastically independent, so that
aggregate shocks may affect individual outputs in arbitrary ways, but not the distribu-
tions of idiosyncratic risk, then any Pareto-optimum in my economy can be implemented
without interventions in financial markets. Simple group-specific income transfers that
condition on aggregate shocks and individual outputs are sufficient in this case. I also
show that this result generalizes to a dynamic setting where agents can save in capital in
addition to trading in financial markets. In this case, the result is that only savings need
to be distorted in order to implement constrained-efficient allocations, but not trades in
financial markets, whenever aggregate and idiosyncratic risk are independent.
     The intuition relies on the fact that, in any Pareto optimum, marginal utilities depend
on aggregate shocks through two channels. First, as in standard moral hazard models,
it is optimal to allocate marginal utilities to agents according to likelihood ratios, which
generally vary with aggregate shocks. However, if aggregate and idiosyncratic shocks
are independent, aggregate uncertainty leaves the distribution of likelihood ratios un-
changed. Second, aggregate shocks affect aggregate output in the economy. Variations in
aggregate output, however, shift marginal utilities uniformly across agents at any Pareto-
optimum. Hence, if aggregate and idiosyncratic shocks are independent, aggregate states
are symmetric in terms of the marginal resource costs of providing incentives, and it is
optimal to leave marginal rates of substitution between aggregate states undistorted. This
in turn is consistent with free trading in financial markets.
     Second, I characterize optimal distortions in financial markets when aggregate shocks
do affect distributions of idiosyncratic shocks. In this case, taxes on transactions in finan-
cial markets are able to implement Pareto-optima. In particular, I show that the resulting
marginal taxes must be higher for those financial assets that pay out in aggregate states in
which likelihood ratios and hence consumption are more risky. With undistorted financial
markets, agents would “self-insure” against this risk by buying additional consumption
for these aggregate states in financial markets. The optimal distortions are designed to
prevent agents from doing so.
     In particular, the optimal asset tax schedule derived here can provide an efficiency
based justification for a differential tax treatment of different asset classes, a feature shared
by many real-world tax systems. For instance, I discuss an example in which equity
claims pay out relatively more in aggregate states with more volatile consumption com-
pared to fixed income securities, which pay out in states in which it is optimal to provide


                                               2
more insurance across idiosyncratic shocks. In this case, optimal asset taxes are higher on
equity claims compared to debt claims. Indeed, the deductibility of interest on debt pay-
ments from the corporate tax base in many tax systems leads to a situation where equity
claims are effectively taxed at a higher rate than debt claims, consistent with the optimal
pattern derived here.
    Related Literature. This paper builds on the literature studying and testing optimal
risk-sharing arrangements in economies with heterogeneous agents but without private
information, as pioneered by Borch (1962), Wilson (1968), Townsend (1994) and Attanasio
and Davis (1996). I demonstrate how the first-best risk-sharing rules derived there have
to be modified when idiosyncratic risk is subject to moral hazard, so that risk-sharing
has to be traded-off against the provision of incentives. In that respect, this paper shares
a common goal with the contribution by Demange (2008) who also considers a moral
hazard model with aggregate uncertainty and discusses properties of risk-sharing rules
under various assumptions on preferences and for a numerical example. However, finan-
cial markets are absent from her analysis, so that the implications of efficient risk-sharing
for optimal tax policy in financial markets presented here are not considered.
    My analysis of a moral hazard model with aggregate uncertainty and of its implica-
tions for tax policy in financial markets is also related to a large literature that studies
the optimal taxation of capital income in dynamic private information economies with
idiosyncratic shocks. In these models, the Inverse Euler equation is derived as an in-
tertemporal optimality condition and used to obtain implications for optimal savings dis-
tortions.2 I establish an analogous optimality condition with respect to sharing aggregate
risk across heterogeneous agents in a completely static environment. More importantly,
due to the absence of aggregate shocks, no financial markets as discussed here emerge in
these models.
    An important exception are the contributions by Kocherlakota (2005) and Kocher-
lakota and Pistaferri (2009). Kocherlakota (2005) generalizes the Inverse Euler equation
to allow for aggregate shocks in a dynamic optimal taxation model. However, since all
agents are ex ante identical in his model, no restriction similar to the purely intratem-
poral Pareto-optimality condition for the sharing of aggregate risk across heterogeneous
groups derived here can be obtained in his framework. Also, agents in his model can
   2 See, for instance, Diamond and Mirrlees (1978), Rogerson (1985), Ligon (1998), Golosov et al. (2003),
Farhi and Werning (2009) and Weinzierl (2011). With the exception of Rogerson (1985) and Ligon (1998),
these contributions consider optimal tax models with private skill shocks rather than moral hazard mod-
els. While the Inverse Euler equation has been shown to emerge in both private information and hidden
action models, the hidden action framework considered here allows to derive the implications of aggregate
uncertainty for constrained-efficiency and financial markets in a particularly transparent way (see section
4.1 for a discussion).


                                                    3
only trade capital, so that implications for optimal tax policy in financial markets do not
arise. Kocherlakota and Pistaferri (2009) consider incomplete markets equilibria in which
individuals can trade securities contingent on aggregate shocks, but are interested in their
asset pricing implications in comparison to Pareto optimal allocations. They do not char-
acterize tax systems that implement Pareto optima as incomplete markets equilibria with
such taxes, which is the focus of this paper.
    Golosov et al. (2006) also consider optimal savings and labor wedges with aggregate
uncertainty, but have to rely on numerical simulations to obtain results on how aggre-
gate shocks affect wedges. In contrast, I analytically derive transparent conditions that
allow me to characterize optimal distortions in financial markets with aggregate uncer-
tainty. The asset taxes that I construct to implement Pareto-efficient allocations when
aggregate and idiosyncratic shocks are not independent are inspired by Werning (2009),
even though his implementation concerns capital taxes in a dynamic Mirrlees economy
as opposed to the static environment with financial markets considered here.
    For a Bewley economy with aggregate uncertainty and uninsured idiosyncratic risk,
Krueger and Lustig (2010) show that, if aggregate risk is independent of idiosyncratic
risk, individuals do not trade in bond markets, only in stock markets, and asset prices
are unaffected by aggregate risk. However, their focus on equilibria in an incomplete
markets model is quite different from the characterization of constrained-efficient allo-
cations in the private information economy that I consider, where the tradeoff between
incentives and insurance is central. Moreover, their results crucially depend on a utility
function with constant relative risk aversion. In contrast, the results in the present paper
do not rely on functional form restrictions of preferences other than separability between
consumption and effort.
    The paper is structured as follows. In section 2, I introduce the economic environment
and characterize constrained-efficient allocations (Lemma 1). Section 3 begins with the
definition of equilibria in financial markets and the observation that, in general, trading
distortions in financial markets are required to implement constrained-efficient alloca-
tions. The first result in Theorem 1 is, however, that these are zero if aggregate shocks
affect individual outputs only but are stochastically independent from idiosyncratic risk.
In section 4, this result is first generalized to a dynamic setting (Theorem 2). Moreover,
section 5 characterizes optimal trading distortions in financial markets when aggregate
and idiosyncratic risk are not independent (Theorems 3 and 4). Finally, section 6 con-
cludes.




                                             4
2    Constrained-Efficient Allocations
In order to address the issues discussed in the introduction formally, I consider a contin-
uum of agents of unit mass where each individual belongs to one of N groups. These
groups may be thought of as workers in different sectors of the economy, individuals of
different age (such as workers and retired agents) or even agents in different countries, so
that the assignment of individuals to groups is public information. The mass of a given
group i ∈ I ≡ {1, ..., N } is given by ni . Individuals within a group are ex ante identical in
terms of both preferences and technology. In particular, let agents of group i be endowed
with separable preferences Ui (c, a) = ui (c) − vi ( a) over consumption c ∈ R+ and an ac-
tion (effort) a ∈ Ai , where Ai is a finite action set available to agents of group i. I assume
ui (c) to be twice continuously differentiable with ui0 (c) > 0, ui00 (c) < 0 ∀c ∈ R+ .
    The agents’ technology is affected by two kinds of shocks: aggregate shocks s ∈ S
and idiosyncratic shocks θ ∈ Θ, where both S and Θ are finite sets. An agent of group i
who experiences an idiosyncratic shock θ in aggregate state s produces output yi (θ, s). In
addition, if an agent of group i chooses some action a and the aggregate shock is s, then
the pdf over idiosyncratic shocks is given by pi (θ | a, s). Idiosyncratic shocks θ within a
given group i are iid across agents conditional on the aggregate shock s. Let the pdf over
aggregate shocks s ∈ S be given by π (s). I assume both the realizations of idiosyncratic
shocks θ and of aggregate shocks s to be publicly observable, but an agent’s action a to
be private information. Observe that the dependency of both outputs and probability
distributions on aggregate shocks are indexed by i, so that aggregate shocks can affect
different groups in the economy differently.
    The timing of events is as follows. In a first stage, a social planner offers agents a
consumption schedule {ci (θ, s)} that specifies consumption levels for the agents in each
group i contingent on the realization of both s and θ. Observing that, agents in each group
privately choose an action ai ∈ Ai . Next, an aggregate shock s ∈ S is realized according
to the distribution π (s) and, conditional on this realization, idiosyncratic shocks θ ∈ Θ
are drawn from the distribution pi (θ | ai , s) for all agents and all groups i ∈ I. This deter-
mines outputs yi (θ, s), which are used by the social planner to implement the promised
consumption schedule {ci (θ, s)}.
    I define an allocation {ci (θ, s), ai } in this economy as a consumption schedule {ci (θ, s)}
and an action profile { ai } that specifies an action ai for each group i ∈ I. An allocation
{ci (θ, s), ai } is feasible if it satisfies the resource constraint for each aggregate state s, i.e.

               ∑ ni ∑ ci (θ, s) pi (θ |ai , s) ≤ ∑ ni ∑ yi (θ, s) pi (θ |ai , s)   ∀s ∈ S.       (1)
                i    θ ∈Θ                         i       θ ∈Θ


                                                      5
It is incentive compatible if

             ∑ ∑ Ui (ci (θ, s), ai ) pi (θ |ai , s)π (s) ≥ ∑ ∑ Ui (ci (θ, s), ãi ) pi (θ |ãi , s)π (s)                      (2)
             s∈S θ ∈Θ                                                           s∈S θ ∈Θ

∀i ∈ I, ãi ∈ Ai . I will say that a consumption schedule {ci (θ, s)} implements an effort pro-
file { ai } if it satisfies the incentive compatibility constraints (2) given { ai }. The following
definition introduces a notion of optimality in this economy:

Definition 1. An allocation {ci∗ (θ, s), ai∗ } is constrained-efficient if it solves

                               max         ∑ ψi ∑ ∑ Ui (ci (θ, s), ai ) pi (θ |ai , s)π (s)
                            {ci (θ,s),ai } i
                                                                                                                              (3)
                                                    s∈S θ ∈Θ

subject to the feasibility constraints (1) and the incentive compatibility constraints (2) for some set
of Pareto-weights {ψi }, ψi ≥ 0 ∀i ∈ I.

     Hence, an allocation is constrained-efficient if it is Pareto-optimal within the class of
feasible and incentive compatible allocations. I also refer to a consumption schedule
{ci∗ (θ, s)} as constrained-efficient given an effort profile { ai } if it solves (3) subject to (1)
and (2) for some given { ai } (which may not be the optimal one), i.e. it is feasible and
implements a given action profile optimally.
     I next ask how aggregate and idiosyncratic risk are shared optimally among the het-
erogeneous groups in the present moral hazard economy. The result is a restriction that
any constrained-efficient allocation has to satisfy.

Lemma 1. Any constrained-efficient consumption schedule {ci∗ (θ, s)} that solves problem (3)
subject to (1) and (2) for a given action profile { ai } must be such that
                                                                                    h                                 i
                            Ei 1/ui0 (ci∗ (θ, s))                               E j 1/u0j (c∗j (θ, s))        aj, s
                                                                   
                                                          ai , s
                                                                     =                                                       (4)
                            Ei 1/ui0 (ci∗ (θ, s̃))
                                                                                   h                                 i
                                                          ai , s̃               E j 1/u0j (c∗j (θ, s̃)) a j , s̃

∀i, j ∈ I, s, s̃ ∈ S, where Ei 1/ui0 (ci∗ (θ, s)) ai , s ≡ ∑θ ∈Θ pi (θ | ai , s)/ui0 (ci∗ (θ, s)).
                                                       

Proof. Consider a constrained-efficient consumption schedule {ci∗ (θ, s)} that implements action profile
{ ai }. Let me perform a change in variables from {ci (θ, s)} to {ui (θ, s)}. Then {ui∗ (θ, s)} must solve

                                           max     ∑ ψi ∑ ∑ ui (θ, s) pi (θ |ai , s)π (s)
                                         {ui (θ,s)} i
                                                                                                                              (5)
                                                          s∈S θ ∈Θ

subject to
                        ∑ ni ∑       pi (θ | ai , s)Ci (ui (θ, s)) ≤    ∑ ni ∑             pi (θ | ai , s)yi (θ, s) ∀ s ∈ S   (6)
                        i     θ ∈Θ                                          i       θ ∈Θ


                                                                        6
and
                  ∑ ∑ ui (θ, s) pi (θ |ai , s)π (s) − vi (ai ) ≥ ∑ ∑ ui (θ, s) pi (θ |ãi , s)π (s) − vi (ãi )   (7)
                  s∈S θ ∈Θ                                           s∈S θ ∈Θ

∀i ∈ I, ãi ∈ Ai , where I have defined the cost function Ci (u) ≡ ui −1 (u). The necessary first order condition
for ui (θ, s), integrated over θ, is given by

                                       π (s)  n              pi ( θ | ai , s )
                                       ξ (s)
                                             = i
                                              ψi     ∑      ui0 (ci∗ (θ, s))
                                                                               ∀i ∈ I, s ∈ S,
                                                     θ ∈Θ

where I used Ci0 (.) = 1/ui0 (.) and ξ (s) is the Lagrange multiplier on the resource constraint for state s in
equation (6). Hence,                                           "                       #
                                                           nj
                                                        
                              ni           1                              1
                                 E                  a , s = Ej                    a ,s                      (8)
                              ψi i ui0 (ci∗ (θ, s)) i      ψj    u0j (c∗j (θ, s)) j

∀i, j ∈ I, s ∈ S. Condition (4) in the theorem follows from the fact that equation (8) holds for all aggregate
states s ∈ S.

    The risk-sharing condition (4) in the lemma requires any constrained-efficient con-
sumption schedule {ci∗ (θ, s)} to be such that the ratios of expected inverse marginal util-
ities between different aggregate states are equalized across all agents (equivalently, the
condition could also be written as requiring that the ratios of expected inverse marginal
utilities between different agents be independent of aggregate shocks). Since this has to
hold for arbitrary effort profiles { ai }, it must notably hold for any constrained-efficient
allocation {ci∗ (θ, s), ai∗ }. The intuition behind the result is that Ei [1/ui0 (ci∗ (θ, s))| ai , s] is
the expected marginal resource cost of providing additional utility to an agent in group
i in aggregate state s without affecting incentives. In any given aggregate state s, the
constrained-efficient consumption schedule must equalize this cost across agents, weigh-
ted by population shares ni and Pareto-weights ψi . Taking ratios for different aggregate
states, these weights cancel out and the condition in the lemma results.
    Condition (4) is related to the Inverse Euler equation, which has received much at-
tention in the framework of dynamic models with private information or hidden actions,
where expected inverse marginal utilities are equalized across time periods, accounting
for interest rates and discounting (see, for instance, Rogerson (1985) and Ligon (1998)
for hidden action models and Diamond and Mirrlees (1978), Golosov et al. (2003) and
Kocherlakota (2005) for private information models). In the context of age-dependent
taxation, Weinzierl (2011) derives a similar condition labeled “symmetric Inverse Euler
equation” for optimal consumption allocations across different age groups. Lemma 1 es-
tablishes an analogous optimality condition with respect to sharing aggregate risk across
heterogeneous agents in a static environment.3
   3 See   Demange (2008) for a related result in an economy in which the hidden action is taken after aggre-


                                                                 7
3     Implementation with Financial Markets

3.1    Competitive Equilibria with Financial Markets
In this section, I ask under what conditions constrained-efficient allocations {ci∗ (θ, s), ai∗ }
are consistent with agents having undistorted access to financial markets, in the sense that
they can buy and sell a complete set of claims to consumption contingent on aggregate
shocks s. In particular, let me consider the following modified timing. In the first stage, a
transfer system { Ti (θ, s)} is announced that specifies group-specific transfers contingent
on idiosyncratic and aggregate shocks. In stage 2, agents then simultaneously choose
an action ai ∈ Ai and competitively trade s-contingent Arrow-Debreu securities among
themselves, where a security for aggregate state s pays one unit of consumption if state s
is realized and zero otherwise. Finally, risks are realized and consumption takes place as
before, accounting for both transfers and traded financial assets.
    Let {q(s)} be the set of prices of the s-contingent claims to consumption. Then, in
stage 2, agents in group i ∈ I solve, taking transfers { Ti (θ, s)} and prices {q(s)} as given,

                                  max           ∑ ∑ Ui (ci (θ, s), ai ) pi (θ |ai , s)π (s)
                            {ci (θ,s),∆i (s),ai } s∈S θ ∈Θ
                                                                                                    (9)


subject to
                                                    ∑ q(s)∆i (s) ≤ 0,                              (10)
                                                    s∈S

where
                        ci (θ, s) = yi (θ, s) − Ti (θ, s) + ∆i (s) ∀θ ∈ Θ, s ∈ S,                  (11)

and ∆i (s) is the amount of securities for state s bought by agents in group i. I call {∆i (s)}
a trading profile, which specifies a trading strategy ∆i (s) for each group i ∈ I. Then an
equilibrium without distortions in the financial markets is defined as follows.

Definition 2. An equilibrium in financial markets with the transfer system { Ti (θ, s)} and with-
out taxes is an allocation {cie (θ, s), aie }, a trading profile {∆ie (s)} and prices {qe (s)} such that
{cie (θ, s), ∆ie (s), aie } solves the agents’ problem (9) to (10) taking prices {qe (s)} and transfers
{ Ti (θ, s)} as given, the financial markets clear, i.e.

                                               ∑ ni ∆ie (s) = 0 ∀s ∈ S,                            (12)
                                                i

gate shocks are realized.




                                                             8
and the goods market clears, i.e.

                 ∑ ni ∑        pi (θ | aie , s)cie (θ, s) =   ∑ ni ∑         pi (θ | aie , s)yi (θ, s) ∀s ∈ S.   (13)
                    i   θ ∈Θ                                  i       θ ∈Θ

    Note that the market clearing conditions (12) and (13) imply that the social planner’s
budget constraints ∑i ni ∑θ ∈Θ pi (θ | aie , s) Ti (θ, s) = 0 ∀s ∈ S are satisfied. From this defini-
tion and the necessary conditions of the agents’ problem (9) subject to (10), it immediately
follows that any equilibrium without taxes in the financial markets {cie (θ, s), ∆ie (s), aie }
must be such that
                                                  h                           i
               Ei ui (ci (θ, s)) aie , s       E j u j (c j (θ, s)) a j , s
                                                    0    e            e
                  0 e                     
                                             =                                i ∀i, j ∈ I, s, s̃ ∈ S. (14)
               Ei ui (ci (θ, s̃)) aie , s̃
                  0 e                           h
                                               E j u0j (cej (θ, s̃)) aej , s̃

Undistorted trading in financial markets thus leads to the equalization of ratios of ex-
pected marginal utilities between aggregate states across agents of different groups. This
generally conflicts with the condition for constrained-efficiency (4), which requires the
equalization of ratios of expected inverse marginal utilities, as I will further explore in the
following.4


3.2    Independent Aggregate and Idiosyncratic Shocks
The comparison between the optimality condition (4) and the equilibrium condition (14)
indicates that, in general, distortions have to be introduced in financial markets in order
to implement constrained-efficient allocations as competitive equilibria in the sense of
Definition 2. In particular, taxes may be required such that the agents’ trading in financial
markets does not necessarily lead to an equalization of the marginal rates of substitution
between aggregate states across groups, as in (14). However, it turns out that there exists
an important benchmark case where such interventions are in fact not necessary and no
distortions in financial markets are required to be consistent with constrained-efficiency:

Theorem 1. Consider a constrained-efficient allocation {ci∗ (θ, s), ai∗ } and suppose that aggregate
and idiosyncratic shocks are independent, so that aggregate shocks s affect outputs yi (θ, s) only,
but not probability distributions, i.e. pi (θ | ai , s) = pi (θ | ai , s̃) for all i ∈ I, θ ∈ Θ, s, s̃ ∈ S and
   4 Kocherlakota and Pistaferri (2009) compare the asset pricing implications of the equivalents of (4) and
(14) in a dynamic Mirrlees environment, comparing incomplete markets equilibria with Pareto efficient al-
locations. They do not consider tax systems that implement Pareto optima as incomplete markets equilibria,
which will be my focus in the following.



                                                                  9
ai ∈ Ai . Then it can be implemented as an equilibrium in financial markets using the transfers
{ Ti (θ, s)} only and without tax interventions in financial markets.
Proof. Set transfers Ti∗ (θ, s) = yi (θ, s) − ci∗ (θ, s) for all i ∈ I, θ ∈ Θ, s ∈ S and prices q∗ (s) = ξ (s) ∀s ∈ S,
where ξ (s) is the multiplier on the resource constraint (1) for state s ∈ S in the Pareto-problem (3) s.t. (1)
and (2). Any constrained-efficient allocation {ci∗ (θ, s), ai∗ } is feasible, and hence by (1) the goods market
clearing condition (13) is satisfied. Hence, all that remains to be shown is that, given the transfers Ti∗ (θ, s)
and prices q∗ (s), {ci∗ (θ, s), ai∗ } and ∆i (s) = 0 ∀i ∈ I, s ∈ S solve the agents’ problem (9) to (11). Then the
financial market clearing condition (12) is satisfied trivially.
      To prove this, I proceed in two steps: First, I show that, given any effort choice ãi ∈ Ai , it is optimal
for all agents to set ∆i (s) = 0 ∀i ∈ I, s ∈ S. This implies by condition (11) and the design of the transfers
{ Ti∗ (θ, s)} that agents choose the constrained-efficient consumption schedule {ci∗ (θ, s)} ∀i ∈ I, θ ∈ Θ, s ∈ S
in equilibrium. The second step then involves demonstrating that agents also find it optimal to choose the
constrained-efficient action ai∗ ∀i ∈ I.
      Step 1. Fix some ãi ∈ Ai . Then the optimization problem for an agent of group i ∈ I reduces to
                                                                      
                 max
                {∆ (s)}
                        ∑ ∑ ui          yi (θ, s) − Ti∗ (θ, s) + ∆i (s) pi (θ | ãi , s)π (s) s.t.                ∑ q∗ (s)∆i (s) ≤ 0.
                   i     s   θ                                                                                     s

The objective function is strictly concave and the constraint is linear, so that first order conditions are nec-
essary and sufficient. I therefore only need to show that ∆i (s) = 0 ∀s ∈ S satisfies the budget constraint
(10) and first order conditions. The budget constraint is satisfied trivially. The first order conditions imply
that, for all s, s̃ ∈ S,            h                                              i
                            π (s)Ei ui0 yi (θ, s) − Ti∗ (θ, s) + ∆i (s) ãi , s         q∗ (s)
                                    h                                              i = ∗ .                (15)
                            π (s̃)Ei ui0 yi (θ, s̃) − Ti∗ (θ, s̃) + ∆i (s̃) ãi , s̃    q (s̃)

Setting ∆i (s) = 0 ∀s ∈ S and substituting Ti∗ (θ, s) = yi (θ, s) − ci∗ (θ, s) yields

                                                 π (s)Ei ui0 (ci∗ (θ, s)) ãi , s     q∗ (s)
                                                                                  
                                                                                    = ∗ .                                                         (16)
                                                 π (s̃)Ei ui (ci (θ, s̃)) ãi , s̃
                                                          0 ∗
                                                                                      q (s̃)

    Note that the necessary first order condition of the Pareto-problem (3) subject to (1) and (2) for ci (θ, s)
can be rearranged to
                                                                                                             
                                                                                               | ˜
                                                                                                           
                                         1           π (s)                             p  ( θ   ã   , s )
                                                  =              ψi + ∑ µi ( ã˜ i ) 1 − i          i         ,                                   (17)
                                 ui0 (ci∗ (θ, s))   ni ξ ( s )       ˜ã ∈ A            pi (θ | ai∗ , s)
                                                                            i    i


where ξ (s) is the Lagrange-multiplier on the aggregate resource constraint in state s and µi ( ã˜ i ) on the
incentive constraint for group i and action ã˜ i ∈ Ai . Inverting and taking expectations over θ on both sides
yields
                                    Ei [ui0 (ci∗ (θ, s))| ãi , s] = Ψ(s)Φi ( ãi , s)

with
                          ξ (s)                                                                     ni pi (θ | ãi , s)
               Ψ(s) ≡
                          π (s)
                                     and      Φi ( ãi , s) ≡   ∑      ψi + ∑ ã˜ i ∈ Ai µi ( ã˜ i ) 1 − pi (θ | ã˜ i , s)/pi (θ | ai∗ , s)
                                                                                                                                              .
                                                                θ ∈Θ

If pi (θ | ai , s) = pi (θ | ai , s̃) for all i ∈ I, θ ∈ Θ, s, s̃ ∈ S and ai ∈ Ai , it is clear that Φi ( ãi , s) is in fact independent


                                                                           10
of s. Let me therefore write Φi ( ãi ) in the following. Then (16) implies

                        π (s)Ei ui0 (ci∗ (θ, s)) ãi , s      π (s)Ψ(s)Φi ( ãi )             q∗ (s)
                                                         
                                                                                      ξ (s)
                                                           =                       =        = ∗ .
                        π (s̃)Ei ui (ci (θ, s̃)) ãi , s̃     π (s̃)Ψ(s̃)Φi ( ãi )
                                 0 ∗
                                                                                      ξ (s̃)  q (s̃)

But this is satisfied by having set prices q∗ (s) = ξ (s) ∀s ∈ S.
    Step 2. Step 1 implies that, for any action choice ãi ∈ Ai , agents find it optimal to set ∆i (s) = 0 ∀s ∈
S and hence, by construction of the transfers { Ti∗ (θ, s)}, to choose the constrained-efficient consumption
schedule {ci∗ (θ, s)}. The fact that the constrained-efficient allocation {ci∗ (θ, s), ai∗ } is incentive-compatible
and satisfies (2) for all ãi ∈ Ai then implies that the action that agents choose is the constrained-efficient
action ai∗ ∀i ∈ I. This completes the proof.

    Theorem 1 implies that if aggregate shocks affect outputs but not probability distribu-
tions over idiosyncratic risk, then all agents’ marginal rates of substitution are equalized
in any constrained-efficient allocation. No distortions in the financial markets are there-
fore required. Note that, for this result to hold, no restrictions on how aggregate shocks
may affect outputs nor on individuals’ preferences other than separability are required.
    The intuition for the result can be understood by considering the inverse of equation
(17), which characterizes marginal utilities in any constrained-efficient allocation:
                                               "                                            # −1
                                                                              |
                                                                  
                                    n  ξ ( s )                        p   ( θ   ã   , s )
                  ui0 (ci∗ (θ, s)) = i           ψi + ∑ µi ( ãi ) 1 − i           i
                                                                                  ∗ , s)          .            (18)
                                     π (s)           ã ∈ A
                                                                      p i ( θ | a i
                                                          i    i


As can be seen from (18), aggregate shocks affect marginal utilities through two chan-
nels. First, they influence individual outputs yi (θ, s) and thus aggregate output Y (s) ≡
∑i ∑θ ni pi (θ | ai∗ , s)yi (θ, s). Moreover, since the only place where individual outputs enter
the Pareto-problem is in the feasibility constraints (1), individual outputs yi (θ, s) can-
not affect the solution other than through aggregate output Y (s) in state s. This is re-
flected in (18) in the term ξ (s)/π (s), the (normalized) shadow price of the resource con-
straint in state s. However, (18) makes clear that variations in aggregate output and
thus ξ (s)/π (s) only scale marginal utilities up and down uniformly across agents in a
constrained-efficient allocation, even in the present moral hazard economy. The second
channel results from the fact that, as in standard moral hazard models, it is optimal to al-
locate marginal utilities to agents according to the likelihood ratios pi (θ | ãi , s)/ pi (θ | ai∗ , s)
(see, for instance, Holmström (1979) and Milgrom (1981)). By the results in Milgrom
(1981), the likelihood ratio is a measure of the “favorableness” of the information that
output provides about the hidden effort choice. An output realization with a low likeli-
hood ratio is “good news” about hidden effort choice and hence leads to higher optimal
consumption. These likelihood ratios also generally depend on aggregate states. How-


                                                              11
ever, if aggregate and idiosyncratic shocks are independent, aggregate shocks leave the
distribution of likelihood ratios unchanged, and thus the ratios of expected marginal util-
ities between different agents must be independent of aggregate states, which is the result
in Theorem 1. In other words, if the distributions of likelihood ratios do not depend on
s, aggregate states are symmetric in terms of the marginal resource costs of providing in-
centives, and it is optimal to provide incentives without distortions in the marginal rates
of substitution between aggregate states.
    As the proof of Theorem 1 shows, this property not only holds when agents choose
the constrained-efficient action ai∗ , but for any action ai ∈ Ai they may choose, so that
profitable double-deviations (where agents deviate to some action ãi 6= ai∗ and trade in
financial markets) do not exist. No interventions whatsoever are therefore required in
financial markets, and any constrained optimum is consistent with agents freely trading
financial securities. This is particularly interesting in comparison to dynamic contracting
models. Not only are non-zero wedges between the return to saving and marginal rates
of intertemporal substitution required in order to implement constrained-efficient alloca-
tions,5 but also double-deviations (where agents deviate to a suboptimal action and save
at the same time) are typically profitable, so that linear savings taxes equal to optimal
wedges cannot implement the optimum (see, for instance, Kocherlakota (2005), Albanesi
and Sleet (2006), and Golosov and Tsyvinski (2006)).
    Moreover, Theorem 1 implies that unobservability of individual trades in financial
markets does not put a further restriction on Pareto-optimal risk-sharing arrangements:
constrained-efficient allocations with observable and unobservable trades fall together if
aggregate shocks affect outputs only. This contrasts with a large literature on unobserv-
able side trades in other settings. For instance, Acemoglu and Simsek (2009) consider a
moral hazard model with anonymous side trades and show that the planner does not
distort these trades if preferences between effort and consumption are separable. Even
with separable preferences, double-deviations are generally binding in my framework,
however, unless Theorem 1 applies.6 Note also that the result in Theorem 1 is very dif-
ferent from those in dynamic models with unobservable savings such as in Golosov and
Tsyvinski (2007). They show that, if the social planner cannot observe individual trades
in a bond market, it is generally optimal to introduce a non-zero capital tax. An analogy
to the result in Theorem 1 therefore does not exist in their framework. In order to be
able to understand the driving forces behind these differences, I will consider a dynamic
   5 SeeRogerson (1985) and Ligon (1998) for moral hazard models and Diamond and Mirrlees (1978) and
Golosov et al. (2003) for private skill shock models with this property.
   6 The main difference is that there is no aggregate uncertainty in Acemoglu and Simsek (2009) and they

assume that all trades take place after all (idiosyncratic) uncertainty is realized.


                                                   12
extension of the model in the next section.


4    A Dynamic Extension
In this subsection, I explore to what degree the result in Theorem 1 extends to dynamic
settings where agents can save in addition to trade in financial markets. It will turn
out that Theorem 1 generalizes to such economies in the sense that, whenever aggre-
gate and idiosyncratic risk are independent, then while savings need to be distorted in
order to implement constrained-efficient allocations, tax interventions in financial mar-
kets continue to be unnecessary. To formalize this claim, I consider the following dy-
namic extension of the model. There are two periods t = 0, 1. In the first period, in-
dividuals in group i consume c0i and exert effort ai . There is an aggregate endowment
of capital k0 , and aggregate savings at the end of period 0 are denoted k1 . A linear
savings technology transforms k1 units of capital in period 0 into Rk1 units in period
1. Both aggregate and idiosyncratic shocks are realized in period 1, so that outputs
yi (θ, s) are produced with probability distributions π (s) and pi (θ | ai , s). Consumption
in period 1 is denoted by c1i (θ, s). With a discount factor β, preferences are given by
ui (c0i ) − vi ( ai ) + β ∑s∈S ∑θ ∈Θ ui (c1i (θ, s)) pi (θ | ai , s)π (s) and the Pareto-problem becomes
                                             "                                                                           #
                    max
          { ai ,c0i ,c1i (θ,s),k1 }
                                      ∑ ψi       ui (c0i ) − vi ( ai ) + β ∑     ∑ ui (c1i (θ, s)) pi (θ |ai , s)π (s)       (19)
                                      i∈ I                                   s∈S θ ∈Θ

subject to
                                                          ∑ ni c0i + k1 ≤ k0,                                                (20)
                                                          i∈ I

             ∑ ni ∑ c1i (θ, s) pi (θ |ai , s) ≤ ∑ ni ∑ yi (θ, s) pi (θ |ai , s) + Rk1                       ∀ s ∈ S,         (21)
             i∈ I      θ ∈Θ                                      i∈ I   θ ∈Θ



                                  β∑         ∑ ui (c1i (θ, s)) pi (θ |ai , s)π (s) − vi (ai )
                                       s∈S θ ∈Θ
                          ≥ β∑               ∑ ui (c1i (θ, s)) pi (θ |ãi , s)π (s) − vi (ãi )   ∀ ãi ∈ Ai .               (22)
                                       s∈S θ ∈Θ

(20) and (21) are the resource constraints in periods 0 and 1, respectively, and (22) is
the set of incentive constraints. The resulting constrained-efficient allocation is denoted
{c0i ∗ , c1i ∗ (θ, s), k1∗ , ai∗ }.
     The purpose of this subsection is to show that, if θ and s are stochastically indepen-
dent, then any Pareto optimal allocation can be implemented as an equilibrium with fi-

                                                                        13
nancial markets, where agents face transfers Ti0 in period 0 and Ti1 (θ, s) in period 1, and
only savings in capital are distorted by taxes, but not trades in financial markets. In par-
ticular, let agents now make two trading decisions in period 0: First, they decide about
trades in financial securities, which pay out ∆i (s) in state s in period 1 and have prices q(s)
as before. Second, they choose how much to save in capital, whereby saving a unit k1i in
period 0 yields R(1 − ti (θ, s))k1i in period 1. Here, ti (θ, s) is a linear but shock-contingent
tax on the return to saving imposed in period 1. Given this, agents of group i ∈ I solve

                              max                     ui (c0i ) − vi ( ai ) + β ∑     ∑ ui (ci (θ, s)) pi (θ |ai , s)π (s)   (23)
                  { ai ,c0i ,c1i (θ,s),k1i ,∆i (s)}                               s∈S θ ∈Θ

subject to
                                                                 c0i = k0i − Ti0 − k1i ,                                     (24)

                              c1i (θ, s) = yi (θ, s) − Ti (θ, s) + ∆i (s) + R(1 − ti (θ, s))k1i ,                            (25)

                                                                   ∑ q(s)∆i (s) = 0.                                         (26)
                                                                   s∈S

Here, k0i denotes the capital endowment of agents in group i in period 0, with ∑i∈ I ni k0i =
k0 . Note that this asset structure transparently separates intertemporal from intratem-
poral trading: Agents move resources across periods by saving in capital, and across
aggregate states within periods by trading in financial markets. Then the definition of an
equilibrium with financial markets is a straightforward extension of Definition 2:

Definition 3. An equilibrium in financial markets with transfers { Ti0 , Ti1 (θ, s)} and savings
                                            i , ci ( θ, s ), k i , ai }, a trading profile { ∆i ( s )} and prices { q ( s )}
taxes {ti (θ, s)} is an allocation {c0e           1e           1e e                           e                      e

              i , ci ( θ, s ), k i , ai , ∆i ( s )} solves the agent’s problem (23) to (26) taking prices { q ( s )},
such that {c0e     1e            1e e      e                                                                         e

transfers { Ti0 , Ti1 (θ, s)} and saving taxes {ti (θ, s)} as given, financial markets clear

                                                            ∑ ni ∆ie (s) = 0 ∀ s ∈ S,                                        (27)
                                                            i∈ I

and the goods market clears in both periods

                                                          ∑ ni c0ei = ∑ ni (k0i − k1ei ),                                    (28)
                                                          i∈ I             i∈ I

and
           ∑ ni ∑ c1ei (θ, s) pi (θ |aie , s) = ∑ ∑ yi (θ, s) pi (θ |aie , s) + ∑ ni Rk1ei ∀ s ∈ S.                          (29)
           i∈ I        θ ∈Θ                                         i ∈ I θ ∈Θ                        i∈ I

    Note that this again implies budget balance for the government by Walras’ law. This

                                                                            14
leads to the following result:

Theorem 2. Consider a constrained-efficient allocation {c0i ∗ , c1i ∗ (θ, s), k1∗ , ai∗ } and suppose that
aggregate shocks and idiosyncratic shocks are independent. Then it can be implemented as an
equilibrium in financial markets using transfers { Ti0 , Ti1 (θ, s)} and savings taxes {ti (θ, s)} only
and without tax interventions in financial markets.

Proof. Fix some {k1i ∗ } such that ∑i∈ I ni k1i ∗ = k1∗ and set the savings taxes such that

                                               1 − ti∗ (θ, s) = ui0 (c0i ∗ )/( βRui0 (c1i ∗ (θ, s))),                                            (30)

and transfers Ti0∗ = k0i − c0i ∗ − k1i ∗ and Ti1∗ (θ, s) = yi (θ, s) − c1i ∗ (θ, s) + R(1 − ti∗ (θ, s))k1i ∗ for all i ∈ I, s ∈
S, θ ∈ Θ. To see that we can implement the Pareto-optimal allocation {c0i ∗ , c1i ∗ (θ, s), k1∗ , ai∗ } as an equilib-
rium with these taxes and transfers, let prices be q∗ (s) = ξ 1 (s), where ξ 1 (s) is the shadow price of the
resource constraint (21) in period 1 of the Pareto-problem (19) to (22), and rewrite the agents’ problem for a
given effort ãi ∈ Ai substituting out consumption as follows:
                                     
  max               Γi {k1i , ∆i (s)}
{k1i ,∆i (s)}
                                                                                                                              
                ≡ ui (k0i − Ti0∗ − k1i ) + β ∑             ∑ ui         yi (θ, s) − Ti1∗ (θ, s) + ∆i (s) + R(1 − ti∗ (θ, s))k1i pi (θ | ãi )π (s)
                                                   s∈S θ ∈Θ

such that ∑s∈S q∗ (s)∆i (s) = 0. Note that I already used the fact that θ and s are stochastically independent
by writing pi (θ | ãi ), dropping the dependence on s.
     Observe that the objective function Γi {k1i , ∆i (s)} is strictly concave and the constraint is linear, so
                                                          

that first order conditions are necessary and sufficient for an optimum.7 First, the first order condition for
k1i evaluated at k1i ∗ and ∆i (s) = 0 ∀ s ∈ S is

                                  ui0 (c0i ∗ ) = βR ∑        ∑ (1 − ti∗ (θ, s))ui0 (c1i ∗ (θ, s)) pi (θ |ãi )π (s)
                                                         s∈S θ ∈Θ

and substituting ti∗ (θ, s) from (30) shows that it is satisfied for all i ∈ I. Next, the first order condition for
∆i (s), evaluated at ∆i (s) = 0 ∀ s ∈ S and k1i ∗ , implies

                                                   π (s)Ei [ui0 (c1i ∗ (θ, s))| ãi , s]           q∗ (s)
                                                                                              =            .                                     (31)
                                                   π (s̃)Ei [ui0 (c1i ∗ (θ, s̃))| ãi , s̃]        q∗ (s̃)

Note that, from the necessary first order condition for c1i ∗ (θ, s) from the Pareto-problem (19) to (22),

                                                         ξ 1 (s)                                     ni pi (θ | ãi )
                    Ei [ui0 (c1i ∗ (θ, s))| ãi , s] =
                                                         βπ (s)     ∑      ψi + ∑ ã˜ i ∈ Ai µi ( ã˜ i ) 1 − pi (θ | ã˜ i )/pi (θ | ai∗ )
                                                                                                                                            ,
                                                                    θ ∈Θ


where ξ 1 (s) is the multiplier on the resource constraint in period 1 for state s ∈ S (21) and µi ( ãi ) the

                                                                                                       ˆ i (s)}, the function
    7 To see that Γ { k1 , ∆ ( s )} is strictly concave, note that for any { k1 , ∆ ( s )} and { k̂1 , ∆
                                   
                  i   i    i                                                 i   i               i
Hi (λ) ≡ Γi {λk1i + (1 − λ)k̂1i , λ∆i (s) + (1 − λ)∆  ˆ i (s)} is strictly concave.




                                                                              15
multiplier on the incentive constraint for action ãi ∈ Ai (22). Hence,

                                        π (s)Ei [ui0 (c1i ∗ (θ, s))| ãi , s]          ξ 1 (s)
                                                                                   =
                                        π (s̃)Ei [ui0 (c1i ∗ (θ, s̃))| ãi , s̃]       ξ 1 (s̃)

whenever θ and s are stochastically independent. Substituting this in (31) reveals that (31) is always satisfied
when prices are set such that q∗ (s)/q∗ (s̃) = ξ 1 (s)/ξ 1 (s̃) for all s, s̃ ∈ S.
    This shows that, for any given ãi ∈ Ai , agents find it optimal to set ∆i (s) = 0 ∀ s ∈ S and k1i = k1i ∗ ∀i ∈ I.
Finally, incentive compatibility of the constrained-efficient allocation implies that agents also find it optimal
to set ai = ai∗ for all i ∈ I, which completes the proof.

    As is common for a large class of dynamic incentive problems, any Pareto-optimal
allocation in the present model satisfies the Inverse Euler equation. Indeed, the necessary
first order conditions for the Pareto-problem (19) to (22) can be combined to

                                                1/ui0 (c0i ∗ )
                           ∑ π (s) 1/( βR) × E  1/u0 (c1∗ (θ, s)) a∗ , s = 1,
                           s∈S                i        i i          i

which is the generalized version of the Inverse Euler equation accounting for aggregate
uncertainty derived by Kocherlakota (2005). It immediately implies that a wedge between
the marginal rate of intertemporal substitution ui0 (c0i ∗ )/ β ∑s π (s)Ei ui0 (c1i ∗ (θ, s)) ai∗ , s
                                                                                                     

and the return to saving R needs to be introduced in the agent’s Euler equation. As was
pointed out by Kocherlakota (2005), due to double-deviations, simple linear taxes on the
return to savings that only depend on the group i ∈ I and the aggregate state s ∈ S do
not implement a constrained-efficient allocation, however. Extending his insights to the
present setting reveals that any Pareto-optimum is implementable as an equilibrium with
group-specific linear savings taxes

                                                                          ui0 (c0i ∗ )
                                       ti∗ (θ, s) = 1 −                                                         (32)
                                                                  βRui0 (c1i ∗ (θ, s))

that depend on both the aggregate and the idiosyncratic shock for each agent. The key
additional result in Theorem 2 is that these are in fact sufficient even when agents can
trade in financial markets rather than just save, and further tax interventions in these
financial markets are not required if aggregate and idiosyncratic shocks are independent.
    Even though the aggregate savings technology is assumed to be risk-free for simplic-
ity, the savings taxes ti∗ (θ, s) in (32) generally depend on the aggregate shock s ∈ S.8
However, in the special case where there exists a risk-neutral group, it can be shown that
   8 It
      is easy to see that the setup and the result in Theorem 2 are straightforward to generalize to a savings
technology that is nonlinear and/or contingent on s ∈ S, or to more than two periods.


                                                                16
they are in fact independent of s.

Proposition 1. Suppose there exists a risk-neutral group i ∈ I and aggregate shocks and idiosyn-
cratic shocks are independent. Then any constrained-efficient allocation can be implemented as
an equilibrium in financial markets without tax interventions, using transfers { Ti0 , Ti1 (θ, s)} and
savings taxes {ti (θ )} only, where the latter do not depend on aggregate shocks.

Proof. The necessary first order conditions of the Pareto-problem (19) to (22) imply that ui0 (c0i ∗ ) = ξ 0 ni /ψi ,
where ξ 0 is the multiplier on the period 0 resource constraint, and

                                                                                               pi (θ | ã˜ i )
                                                                                                              
                          1          βπ (s)
                                   =              φi (θ ) with φi (θ ) ≡ ψi + ∑ µi ( ãi ) 1 −
                                                                                     ˜                           .   (33)
                ui0 (c1i ∗ (θ, s))   ni ξ 1 ( s )                            ã˜ ∈ A
                                                                                               pi (θ | ai∗ )
                                                                                       i   i


Substituting this in the construction of the saving taxes in (30) yields

                                                                 ui0 (c0i ∗ )       π (s) ξ 0 φi (θ )
                                   1 − ti∗ (θ, s) =                             =                     .              (34)
                                                        βRui0 (c1i ∗ (θ, s))        ξ 1 (s) ψi R

Assuming that group i = 1 ∈ I is risk neutral, integrating equation (33) for group 1 over θ ∈ Θ implies

                                                                 βπ (s)             βπ (s)ψ1
                             const. =     ∑     p1 (θ | a1∗ )       1
                                                                n1 ξ ( s )
                                                                           φ1 (θ ) = 1
                                                                                     ξ ( s ) n1
                                                                                                ∀s ∈ S,
                                         θ ∈Θ


so that π (s)/ξ 1 (s) in is in fact independent of s in this case. Using this in (34) completes the proof.

    If there exists a group of risk-neutral investors in the financial market, then in addi-
tion to the previous results, the taxes ti∗ (θ ) that are required to discourage savings at the
optimum do not need to condition on the realized aggregate state s ∈ S. Hence, in this
case, not only do financial markets not put an additional constraint on the social planner,
but in addition aggregate uncertainty does not even affect the way in which the social
planner provides intertemporal incentives.
    This is in contrast to Golosov et al. (2006) who find that optimal savings taxes move
with aggregate government spending shocks, even though they do not affect the distribu-
tion of private skill shocks. The difference is a result of the moral hazard model studied
here rather than the skill shock model that they consider. Here, the unobservable action
is chosen before shocks are realized. In skill shock models, agents choose their actions,
such as labor supply, after all shocks have been realized and optimal consumption is not
determined by likelihood ratios, so that results similar to Theorems 1 and 2 have not been
derived in this case.




                                                                       17
5     Non-independent Aggregate and Idiosyncratic Shocks

5.1   Implementation with Non-linear Asset Taxes
Let me next turn to the case where aggregate and idiosyncratic shocks are not stochas-
tically independent, so that aggregate shocks do affect probability distributions over id-
iosyncratic risk. In this case, it is necessary to introduce tax distortions in financial mar-
kets in order to implement constrained-efficient allocations as competitive equilibria in
the sense of Definition 2. Moreover, similar to the observation for savings taxes in the
previous subsection, simple linear taxes on transactions in the financial markets that only
depend on the group i ∈ I and the aggregate state s ∈ S do not implement Pareto-optima.
Building upon the insights derived by Werning (2009) for capital taxation in a dynamic
Mirrlees model, I construct a non-linear asset tax system for the present static moral haz-
ard model with aggregate uncertainty that implements constrained efficient allocations.
The resulting asset taxes on financial trades also exhibit interesting properties that further
clarify the underlying economics of the implementation problem with aggregate uncer-
tainty, particularly in comparison to earlier results on capital taxation in dynamic models,
as I demonstrate in the following.
    For the analysis in this subsection, it is useful to return to the static model of section
3 and to index the set S of aggregate states with h = 0, ..., H, where H = kSk. Let me
also use the Arrow-Debreu security for state s0 ∈ S as the numeraire asset and normalize
q(s0 ) = 1. Then the idea is that, when an agent chooses some trading strategy ∆i (s) in the
financial markets, she is required to pay an asset tax κi (∆i (s1 ), ..., ∆i (s H )) in terms of the
numeraire asset for state s0 (and the tax schedule does not condition on ∆i (s0 ) without
loss of generality). Agents in group i ∈ I take the asset tax κi and the transfers { Ti (θ, s)}
as well as the prices {q(s)} of the Arrow-Debreu securities as given and solve

                           max           ∑ ∑ ui (ci (θ, s)) pi (θ |ai , s)π (s) − vi (ai )
                     {ci (θ,s),∆i (s),ai } s
                                                                                                (35)
                                               θ

subject to their budget constraint in the financial market

                      ∆i (s0 ) + κi (∆i (s1 ), ..., ∆i (s H )) +    ∑         q(s)∆i (s) ≤ 0,   (36)
                                                                   s 6 = s0


where ci (θ, s) is given by

                                  ci (θ, s) = yi (θ, s) − Ti (θ, s) + ∆i (s)                    (37)



                                                       18
for all θ ∈ Θ, s ∈ S. An equilibrium with the asset tax κi (∆i (s1 ), ..., ∆i (s H )) in the financial
market and transfers { Ti (θ, s)} can then be defined analogously to the previous subsec-
tion, namely as an allocation {cie (θ, s), aie }, a trading profile {∆ie (s)} and prices {qe (s)}
such that {cie (θ, s), ∆ie (s), aie } solve the agents’ problem (35) to (37) given prices {qe (s)},
the asset tax κi (∆i (s1 ), ..., ∆i (s H )) and transfers { Ti (θ, s)}, financial markets clear for each
aggregate state (equation (12)), and the the goods market clears in each state (equation
(13)). The following theorem constructs a tax system with a non-linear asset tax sched-
ule κi (∆i (s1 ), ..., ∆i (s H )) and transfers { Ti (θ, s)} that implements a constrained-efficient
allocation {ci∗ (θ, s), ai∗ } as an equilibrium with financial markets.

Theorem 3. Consider any constrained-efficient allocation {ci∗ (θ, s), ai∗ } that solves (3) subject to
(1) and (2). Let

                            Wi∗ ≡   ∑ ∑ ui (ci∗ (θ, s)) pi (θ |ai∗ , s)π (s) − vi (ai∗ ) ∀i ∈ I                                               (38)
                                    s∈S θ ∈Θ

and fix prices {q∗ (s)}. For each i ∈ I and each trading profile {∆i (s)}, let the asset tax schedule
κi (∆i (s1 ), ..., ∆i (s H )) be implicitly defined by
                    (                                                                                              !
Wi∗ = max
          ai ∈ Ai
                        ∑ ui      ci∗ (θ, s0 ) − κi (∆i (s1 ), ..., ∆i (s H )) −    ∑         q ∗ ( s ) ∆i ( s )       p i ( θ | a i , s0 ) π ( s0 )
                        θ                                                          s 6 = s0
                                                                                         )
          +    ∑∑           ui (ci∗ (θ, s) + ∆i (s)) pi (θ | ai , s)π (s) − vi ( ai )           .                                             (39)
              s 6 = s0 θ


If ui (c) is unbounded, strictly increasing and continuous, then there exists a unique and continu-
ous asset tax schedule κi (∆i (s1 ), ..., ∆i (s H )) solving (39). Set transfers { Ti (θ, s)} such that

                               Ti∗ (θ, s) = yi (θ, s) − ci∗ (θ, s) ∀i ∈ I, θ ∈ Θ, s ∈ S.                                                      (40)

Then the allocation {ci∗ (θ, s), ai∗ }, the trading profile {∆i (s) = 0} and prices {q∗ (s)} are an
equilibrium given the asset tax κi (∆i (s1 ), ..., ∆i (s H )) and transfers { Ti∗ (θ, s)}.

Proof. See the Appendix.

    The result in Theorem 3 is that, for any constrained efficient allocation, there exists
a continuous asset tax schedule that conditions only on an individual’s trades, not on
idiosyncratic shocks, and implements it as an equilibrium. Thus, when asset taxes are not
constrained to be linear, information about individual outputs is not necessary to impose
asset taxes. Moreover, the implementation does not rely on sharp penalties in the form


                                                              19
of discontinuous taxes. This is in contrast to a direct mechanism that would completely
prevent agents from trading in financial markets, which can be thought of imposing an
infinite tax whenever agents deviate from ∆i (s) = 0 ∀s ∈ S.
    The construction of the asset tax in equation (39) makes clear how the implementa-
tion works: For any trading strategy ∆i (s), the asset tax schedule κi (∆i (s1 ), ..., ∆i (s H )) is
such that, when choosing the optimal action given this trading strategy, the agent is just
indifferent to the constrained efficient allocation {ci∗ (θ, s), ai∗ }. There therefore exists no
deviation that could make the agent better off.


5.2     Properties of Optimal Asset Taxes
Let me finally emphasize some properties of the asset tax schedule κi (∆i (s1 ), ..., ∆i (s H ))
that are particularly useful to further illuminate the intuition behind the previous results
and to relate it to the literature on optimal dynamic taxation. Notably, the marginal asset
taxes are quite closely related to what has been termed “wedges” there (see e.g. Golosov
et al. (2006)). To illustrate this, let me set prices such that q∗ (s)/q∗ (s̃) = ξ (s)/ξ (s̃) ∀s, s̃ ∈
S, i.e. let relative prices equal the social marginal rate of substitution between aggre-
gate states s and s̃ given by the ratio of the shadow costs of the aggregate resource
constraints in the two states at the constrained-efficient allocation to be implemented9 .
For any trading strategy ∆i (s), let the solution of the maximization in (39) be given by
αi∗ (∆i (s1 ), ..., ∆i (s H )), so that αi∗ is the set of actions ai ∈ Ai maximizing the RHS of (39)
given ∆i (s). If αi∗ (∆i (s1 ), ..., ∆i (s H )) is single-valued, then a standard Envelope Theorem
implies that for h ∈ {1, ..., H },

      ∂κi (∆i (s1 ), ..., ∆i (s H ))          π (sh )Ei [ui0 (ci∗ (θ, sh ) + ∆i (sh ))|αi∗ , sh ]   ξ (sh )
                                     =                                                        ∗ −          ,
                                       π (s0 )Ei ui ci (θ, s0 ) − κi − ∑s6=s0 ∆i (s) αi , s0
                                                  0 ∗
               ∂∆i (sh )                                                                            ξ ( s0 )

where κi stands short for κi (∆i (s1 ), ..., ∆i (s H )) and αi∗ for αi∗ (∆i (s1 ), ..., ∆i (s H )).10 The mar-
ginal tax is thus equal to the “wedge,” namely the difference between the private and
social marginal rate of substitution. In particular, at the implemented trading profile
   9 Note    that Theorem 3 allows us to fix prices in this way.
  10 This would be typically the case when      ai is chosen from a continuum of possible actions and αi∗ satisfies
a first-order condition. However, when Ai is a discrete set, this is not the case since the optimal allocation
{ci∗ (θ, s), ai∗ } is such that an agent of group i is just indifferent between ai∗ and a deviation ãi ∈ Ai . In this
case, the asset tax schedule actually has a kink and is not differentiable at the equilibrium trading strategy
∆i (s) = 0. Nevertheless, left and right derivatives can still be computed using Envelope Theorems (see
e.g. Milgrom and Segal (2002)), leading to the same results on (directional) marginal asset taxes as derived
below.




                                                         20
{∆i (s) = 0} and with the transfers { Ti (θ, s)} defined in (40), this reduces to

                          ∂κi∗        π (sh )Ei [ui0 (ci∗ (θ, sh ))| ai∗ , sh ] ξ (sh )
                                   =                               ∗ −                 .                     (41)
                                     π (s0 )Ei ui ci (θ, s0 ) ai , s0
                                               0 ∗
                         ∂∆i (sh )                                              ξ ( s0 )

     In the following, I demonstrate how these marginal asset taxes can be signed. In par-
ticular, it turns out that the asset taxes impose higher marginal tax rates on those assets
that pay out in aggregate states in which optimal consumption is more volatile due to a
more severe moral hazard problem: If for group i consumption at the constrained efficient
allocation is more risky in state sh compared to state s0 (as will be formalized below), then
∂κi∗ /∂∆i (sh ) > 0.
     Recall that optimal consumption is determined by likelihood ratios according to equa-
tion (18). For later use, I therefore denote the likelihood ratio of group i ∈ I for a given
constrained-efficient allocation {ci∗ (θ, s), ai∗ }, a deviation ãi ∈ Ai and for all θ ∈ Θ and
s ∈ S by
                                                       p (θ | ãi , s)
                                    li (θ | ãi , s) ≡ i               .                    (42)
                                                      pi (θ | ai∗ , s)
Let me denote the cumulative distribution function of li (θ | ãi , s) given the constrained-
efficient action ai∗ by Gi (l | ãi , s) ≡ Pri (li (θ | ãi , s) ≤ l | ai∗ , s) and the corresponding probabil-
ity density function by gi (l | ãi , s). Note that the mean of li (θ | ãi , s) given the constrained-
efficient action is one for all groups i ∈ I, states s ∈ S and deviations ãi ∈ Ai because

                                                                       pi (θ | ãi , s)
               ∑ lgi (l |ãi , s) = Ei [li (θ |ãi , s)|ai∗ , s] = ∑                    p (θ | ai∗ , s) = 1.
                                                                       pi (θ | ai∗ , s) i
                l                                               θ ∈Θ

Aggregate shocks therefore cannot shift the mean of the distribution of likelihood ratios,
but only change higher moments. The following general result shows that it is the volatil-
ity of this distribution that is crucial for optimal asset taxes in financial markets.

Theorem 4. Consider a constrained-efficient allocation {ci∗ (θ, s), ai∗ }. Suppose that Gi (l | ãi , sh ) is
a mean-preserving spread of Gi (l | ãi , s0 ), i.e. it is more risky in the sense of second-order stochas-
tic dominance (SOSD), for all ãi for which group i’s incentive constraint (2) is binding. Then
∂κi∗ /∂∆i (sh ) ≥ 0.

Proof. See the Appendix.

   To understand the claim in Theorem 4, consider for simplicity the typical case where
the incentive constraint is binding for only a single deviation ãi ∈ Ai , so that only one
distribution of likelihood ratios needs to be considered. Then the claim is that group i


                                                         21
faces a positive marginal asset tax on assets that pay out in state sh if state sh leads to a
riskier distribution of likelihood ratios than state s0 for group i in the sense of a mean-
preserving spread.
    Intuitively, since the social planner varies consumption according to likelihood ratios
at the optimum, consumption will be more volatile in those aggregate states that involve
a more volatile likelihood ratio. Whereas the planner spreads consumption in all aggre-
gate states such that ratios of expected inverse marginal utilities are the same across states
by Theorem 1, individuals’ trading incentives in the financial market are determined by
expected marginal utilities. By the convexity of the function f ( x ) = 1/x, individuals
have a higher expected marginal utility and thus an incentive to buy additional con-
sumption in financial markets for those aggregate states in which the likelihood ratio and
hence consumption vary more. One may think of this as individuals buying additional
consumption to ‘self-insure’ against their more volatile consumption in those states. To
prevent this, the social planner needs to introduce a positive marginal asset tax on the
corresponding security.
    In particular, Theorem 4 has the following immediate Corollary:

Corollary 1. Consider a constrained-efficient allocation {ci∗ (θ, s), ai∗ }. Suppose there is a group
i ∈ S for which consumption in state s0 is deterministic, i.e. ci∗ (θ, s0 ) = ci∗ (s0 ) for all θ ∈ Θ.
Then ∂κi∗ /∂∆i (sh ) ≥ 0 ∀ sh 6= s0 ∈ S, with strict inequality whenever consumption in state sh
is not deterministic for group i.

     There are two important cases in which optimal consumption is deterministic in state
s0 : The first arises when the agents’ action does not affect probability distributions in state
s0 , i.e. pi (θ | ai∗ , s0 ) = pi (θ | ãi , s0 ) ∀ ãi ∈ Ai , θ ∈ Θ (no moral hazard state). Then the likeli-
hood ratios are flat with pi (θ | ãi , s0 )/pi (θ | ai∗ , s0 ) = 1 ∀ ãi ∈ Ai , θ ∈ Θ, and full insurance
is optimal since output contains no information about agents’ effort. The second case re-
sults when output is deterministic for the optimal action in state s0 , i.e. pi (θ | ai∗ , s0 ) = 1
for some θ ∈ Θ, which immediately implies full insurance. In either case, Corollary 1 im-
plies that all the securities for the other states that involve stochastic consumption must
be taxed at the margin.
     The special case with an aggregate state that leads to deterministic consumption is
particularly interesting because it illustrates the relationship of the results about wedges
in the present model to those that arise in the dynamic models discussed in the preceding
subsection. There, it was noted that the Inverse Euler equation
                                                                     
                                         1        1          1
                                               =     Et 0
                                      u0 (ct )   βRt     u ( c t +1 )

                                                     22
implies the equalization of expected inverse marginal utilities across time periods. Sim-
ilarly to financial markets here, agents equalize expected marginal utilities over time,
however, when they can freely save, as implied by a standard Euler equation

                                        u0 (ct ) = βRt Et [u0 (ct+1 )].

This conflict also generates a wedge between agents’ intertemporal marginal rate of sub-
stitution and the marginal return to saving Rt , which can be thought of as an (implicit) tax
on the return to saving that has to be introduced to implement the optimum. It is straight-
forward to see (based on Jensen’s inequality) that this implicit tax is always positive in
these models.11 The reason can be understood from Corollary 1: Current consumption
ct is deterministic from the point of view of period t, whereas future consumption ct+1
is typically stochastic. Agents would buy too much consumption for the risky state (or
the future) by buying securities in the financial market (or saving) if there were no distor-
tions. The social planner therefore needs to tax the Arrow-Debreu securities for the risky
state (the return to saving).


5.3    An Example and Implications for Differential Asset Taxation
Consider a situation with two aggregate states, “good times” s0 and “bad times” s1 (for
instance a recession). Let the idiosyncratic uncertainty of group i be unemployment risk,
described by two states as well with θu for the state in which the worker is unemployed
and θe when he is employed. Finally, let there be two possible effort levels a ∈ { al , ah },
where low effort al corresponds to shirking, which raises the risk of unemployment (both
in good and bad times). For example, one could think of this as the unobservable com-
ponent of some ex ante human capital investment decision that is undertaken before the
aggregate state of the economy is realized. Suppose that, in good times, the unemploy-
ment risk when putting high effort is very low, and becomes high only when the agent
has shirked, i.e.
                                 p i ( θ u | a h , s0 )  p i ( θ u | a l , s0 ),

capturing the idea that, in good times, essentially only people who shirked face layoff
risk. In contrast, suppose that, in a recession, even agents who put high effort ah face
considerable layoff risk, so that

                                       p i ( θ u | a l , s1 ) ≈ p i ( θ u | a h , s1 ).
 11 See,   for instance, Diamond and Mirrlees (1978), Golosov et al. (2003), Farhi and Werning (2009).


                                                            23
  From Theorem 4, we know that what matters for asset taxes is the likelihood ratio,
which by the above assumptions is very volatile in good times because

                                           1 − p i ( θ u | a l , s0 )  p ( θ u | a l , s0 )
                 li ( θ e | a l , s0 ) =                               i                     = li ( θ u | a l , s0 ).
                                           1 − p i ( θ u | a l , s0 )  p i ( θ u | a l , s0 )

Accordingly, at a constrained-efficient allocation {ci∗ (θ, s), ah } (assuming that it is opti-
mal to implement high effort ah ), the social planner varies consumption considerably in
good times: ci∗ (θu , s0 )  ci∗ (θe , s0 ) by equation (18). This is because, in good times, being
unemployed is a strong signal that the worker shirked, which is punished by low con-
sumption. However, in bad times, the likelihood ratio is much less informative about
effort, so that li (θe | al , s1 ) ≈ li (θe | ah , s1 ) and the planner provides much more insurance
with ci∗ (θu , s1 ) ≈ ci∗ (θe , s1 ). Intuitively, during a recession, even many agents who put
high effort end up unemployed, so it becomes optimal for the planner to provide more
generous unemployment benefits than in good times.12
    If the objective is to implement such an optimal insurance system over the business
cycle while allowing agents to trade in financial markets, by the above arguments they
would want to self-insure against their more risky consumption profile during good times
by purchasing assets that pay out in good rather than bad times, unless the planner im-
poses taxes on these assets. For instance, one could think of the asset that pays out rel-
atively more in state s0 as a stock market index as opposed to fixed income securities,
which would pay out relatively more in state s1 . Then, by Theorem 4, the optimal asset
tax schedule would involve taxing the purchase of such equity claims relative to fixed
income assets at the margin.
    Hence, the present framework and the derived properties of the optimal asset tax
schedule provide an efficiency based justification for a differential tax treatment of differ-
ent asset classes that is indeed observed in many countries. For instance, the deductibility
of interest on debt payments from the corporate tax base in many tax systems effectively
leads to a situation where equity claims are taxed at a higher rate than debt claims, con-
sistent with the optimal pattern derived in Theorem 4.


6       Conclusion
I have derived optimality conditions for allocations in a moral hazard economy with het-
erogeneous agents and aggregate shocks and characterized their implications for optimal
    12 See
      for instance Landais et al. (2011) for a less stylized model that generates such a pattern of optimal
unemployment insurance over the business cycle.


                                                                   24
tax policy in financial markets. As a benchmark result, I have first shown that financial
markets should be undistorted at the optimum if aggregate and idiosyncratic shocks are
independent. I have also demonstrated that this result generalizes in a natural way to a
dynamic setting where agents can save in addition to trade in financial markets. When ag-
gregate and idiosyncratic risk are correlated, then in order to decentralize Pareto-optimal
allocations as competitive equilibria with financial markets, the government may impose
nonlinear asset taxes in financial markets. They are such that financial assets that pay
out in aggregate states with more risky consumption are taxed, preventing agents from
self-insuring against these shocks.
    Given that consumption is taken to be observable, the tax decentralization developed
here is one of many possible implementations. For instance, Pareto-optima could also
be implemented by private insurance companies that competitively provide insurance
contracts, prohibiting their customers from trading in financial markets. Alternatively, the
government could provide all the insurance and completely shut down financial markets.
The implementation considered here, with agents trading in financial markets, but subject
to tax distortions, is an intermediate case that may be more closely related to real-world
tax systems. For instance, I have shown that a differential tax treatment of debt and equity
claims can be justified, a feature shared by many real-world corporate tax systems. In
addition, in a multi-country setting, the tax implementation discussed here would share
features of transaction taxes on international financial flows that have been discussed
recurrently.


References
Acemoglu, D., and Simsek, A. (2009), “Moral hazard in general equilibrium with anony-
    mous trading,” Mimeo, MIT.

Albanesi, S., and Sleet, C. (2006), “Optimal dynamic taxation with private information,”
    Review of Economic Studies, 73, 1–30.

Attanasio, O., and Davis, S. (1996), “Relative wage movements and the distribution of
    consumption,” Journal of Political Economy, 104, 1227–1262.

Borch, K. (1962), “Equilibrium in a reinsurance market,” Econometrica, 30, 424–444.

Demange, G. (2008), “Sharing aggregate risks under moral hazard,” PSE Working Paper
   No. 2008-27.


                                            25
Diamond, P.A., and Mirrlees, J.A. (1978), “A model of social insurance with variable re-
    tirement,” Journal of Public Economics, 10, 295–336.

Farhi, E., and Werning, I. (2009), “Capital taxation: Quantitative explorations of the in-
     verse euler equation,” Mimeo, MIT.

Golosov, M., and Tsyvinski, A. (2006), “Designing optimal disability insurance: A case for
    asset testing,” Journal of Political Economy, 114, 257–269.

     (2007), “Optimal taxation with endogenous insurance markets,” Quarterly Journal of
     Economics, 122, 487–532.

Golosov, M., Kocherlakota, N., and Tsyvinski, A. (2003), “Optimal indirect and capital
    taxation,” Review of Economic Studies, 70, 569–587.

Golosov, M., Tsyvinski, A., and Werning, I. (2006), “New dynamic public finance: A user’s
    guide,” NBER Macroeconomics Annual.

Holmström, B. (1979), “Moral hazard and observability,” Bell Journal of Economics, 10, 74–
    91.

Kocherlakota, N. (2005), “Zero expected wealth taxes: A mirrlees approach to dynamic
    optimal taxation,” Econometrica, 73, 1587–1621.

Kocherlakota, N., and Pistaferri, L. (2009), “Asset pricing implications of pareto optimal-
    ity with private information,” Journal of Political Economy, 117, 555–590.

Krueger, D., and Lustig, H. (2010), “When is market incompletemens irrelevant for the
    price of aggregate risk (and when is it not)?,” Journal of Economic Theory, 145, 1–41.

Landais, C., Michaillat, P., and Saez, E. (2011), “Optimal unemployment insurance over
    the business cycle,” NBER Working Paper No. 16526.

Ligon, E. (1998), “Risk sharing and information in village economies,” Review of Economic
    Studies, 65, 847–864.

Milgrom, P. (1981), “Good news and bad news: Representation theorems and applica-
    tions,” Bell Journal of Economics, 12, 380–391.

Milgrom, P., and Segal, Ilya (2002), “Envelope theorems for arbitrary choice sets,” Econo-
    metrica, 70, 583–601.

Rogerson, W. (1985), “Repeated moral hazard,” Econometrica, 53, 69–76.

                                            26
Storesletten, K., Telmer, C., and Yaron, A. (2004), “Cyclical dynamics in idiosyncratic
     labor-market risk,” Journal of Political Economy, 112, 695–717.

Townsend, R. (1994), “Risk and insurance in village india,” Econometrica, 62, 539–591.

Weinzierl, M. (2011), “The surprising power of age-dependent taxes,” Review of Economic
    Studies, 78, 1490–1518.

Werning, I. (2009), “Non-linear capital taxation,” Mimeo, MIT.

Wilson, R. (1968), “The theory of syndicates,” Econometrica, 36, 113–132.


A      Appendix

A.1      Proof of Theorem 3
I start with showing that the asset tax schedule defined in (39) is unique and continuous if ui (c) is un-
bounded, strictly increasing and continuous. To do so, note that, for any given trading strategy ∆i (s), (39)
is equivalent to requiring that
                                                                                                                              !
                      ∑ ui              ci∗ (θ, s0 ) − κi (∆i (s1 ), ..., ∆i (s H )) −           ∑          ∗
                                                                                                           q ( s ) ∆i ( s )       p i ( θ | a i , s0 ) π ( s0 )
                       θ                                                                        s 6 = s0

                 ≤ Wi∗ −               ∑ ∑ ui (ci∗ (θ, s) + ∆i (s)) pi (θ |ai , s)π (s) + vi (ai )                                                                (43)
                                      s 6 = s0 θ


for all ai ∈ Ai , with equality for some ai ∈ Ai . Given the consumption schedule {ci∗ (θ, s0 )} for state s0 , I
define
                          W̃i (∆i (s0 ), ai ) ≡ ∑ ui (ci∗ (θ, s0 ) + ∆i (s0 )) pi (θ | ai , s0 )π (s0 ).
                                                                   θ

The function W̃i (∆i (s0 ), ai ) is unbounded, continuous and strictly increasing in ∆i (s0 ) by the assumed prop-
erties of ui (c). It is therefore invertible w.r.t. its first argument and the inverse function W̃i−1 (Wi , ai ) is
continuous and strictly increasing in Wi on an unbounded domain. Using this to rewrite (43) yields the
following explicit expression for the asset tax schedule:

                     κi (∆i (s1 ), ..., ∆i (s H ))
                           (                                                                                                                                !
                =    max
                     ai ∈ Ai
                                      −W̃i−1        Wi∗      −    ∑∑          ui (ci∗ (θ, s) + ∆i (s)) pi (θ | ai , s)π (s) + vi ( ai ), ai
                                                                 s 6 = s0 θ
                                                         )
                     −      ∑          ∗
                                      q ( s ) ∆i ( s )       .                                                                                                    (44)
                           s 6 = s0


This proves that there is a unique solution κi (∆i (s1 ), ..., ∆i (s H )) to (39) for each trading strategy ∆i (s).
Moreover, κi (∆i (s1 ), ..., ∆i (s H )) is defined as a maximization and the RHS of (44) is continuous in both
∆i (s1 ), ..., ∆i (s H ) (by continuity of ui (c) and W̃i−1 in its first argument) and in ai (since ai ∈ Ai and Ai is a


                                                                                   27
finite and thus discrete set).13 Berge’s Maximum Theorem therefore implies that κi (∆i (s1 ), ..., ∆i (s H )) is a
continuous function.
     I next prove the second part of the theorem. The market clearing conditions (12) and (13) are satisfied
by feasibility of {ci∗ (θ, s), ai∗ } and construction of {∆i (s) = 0}. It thus remains to be shown that given the
prices {q∗ (s)}, the asset tax schedule κi (∆i (s1 ), ..., ∆i (s H )) defined in (39) and the transfers { Ti (θ, s)} in (40),
the solution to the agents’ problem (35) to (37) is given by {ci∗ (θ, s), ai∗ } and ∆i (s) = 0 ∀i ∈ I, s ∈ S.
     To see this, observe that, by construction of the transfers { Ti (θ, s)} in (40) and the fact that the budget
constraint (36) is binding at the optimum, the agent’s problem given prices {q∗ (s)} can be written as

                                        max    ∑ ∑ ui (ci∗ (θ, s) + ∆i (s)) pi (θ |ai , s)π (s) − vi (ai )
                                      ∆i (s),ai s
                                                                                                                                                                  (45)
                                                    θ

subject to
                                        ∆i (s0 ) + κi (∆i (s1 ), ..., ∆i (s H )) +    ∑         q∗ (s)∆i (s) = 0.                                                 (46)
                                                                                     s 6 = s0

Substituting ∆i (s0 ) from (46) yields the following problem that agents solve:
                             (                                                                                                !
                  max
                 ∆i (s),ai
                                 ∑ ui     ci∗ (θ, s0 ) − κi (∆i (s1 ), ..., ∆i (s H )) −         ∑             ∗
                                                                                                           q ( s ) ∆i ( s )       p i ( θ | a i , s0 ) π ( s0 )
                                  θ                                                             s 6 = s0
                                                                                                    )
                 +    ∑ ∑ ui (ci∗ (θ, s) + ∆i (s)) pi (θ |ai , s)π (s) − vi (ai )                          .                                                      (47)
                     s 6 = s0 θ


The construction of the asset tax schedule κi (∆i (s1 ), ..., ∆i (s H )) in (39) implies that all agents are indifferent
between any trading strategy ∆i (s) when they are able to choose their optimal action given ∆i (s). By
incentive compatibility of the allocation {ci∗ (θ, s), ai∗ }, the maximum in (47) is therefore attained for all i ∈ I
by setting ∆i (s) = 0 ∀s ∈ S and ai = ai∗ , which produces expected utility Wi∗ as defined in (38) and
completes the proof.


A.2      Proof of Theorem 4
By the definition of optimal marginal taxes in (41), ∂κi∗ /∂∆i (sh ) ≥ 0 if

                                                Ei [ui0 (ci∗ (θ, sh ))| ai∗ , sh ]   ξ (sh )/π (sh )
                                                                                   ≥                 .                                                            (48)
                                                Ei [ui (ci (θ, s0 ))| ai , s0 ]
                                                      0    ∗              ∗          ξ (s0 )/π (s0 )

Substituting from (18) yields

                                                    ξ (sh )                                 pi (θ | ai∗ , sh )
             Ei [ui0 (ci∗ (θ, sh ))| ai∗ , sh ]     π (sh )   ∑   ψi + ∑ ãi ∈ Ai µi ( ãi ) 1 − pi (θ | ãi , sh )/pi (θ | ai∗ , sh )
                                                                                                                                       
                                                           θ ∈Θ
                                                =                                                                                        .                        (49)
             Ei [ui0 (ci∗ (θ, s0 ))| ai∗ , s0 ]   ξ ( s0 )                                pi (θ | ai∗ , s0 )
                                                  π (s0 ) θ∑                                                                  ∗
                                                             ∈Θ ψi + ∑ ãi ∈ Ai µi ( ãi ) 1 − pi ( θ | ãi , s0 ) /pi ( θ | ai , s0 )
                                                                                                                                       

  13 Otherwise,    continuity in ai could be guaranteed by imposing continuity of pi (θ | ai , s) and vi ( ai ) in ai
∀θ ∈ Θ, s ∈ S.




                                                                         28
Hence, (48) is satisfied if

                                         pi (θ | ai∗ , sh )                                                      pi (θ | ai∗ , s0 )
                    ∑                               
                                                               pi (θ | ãi ,sh )
                                                                                    ≥     ∑                                
                                                                                                                                      pi (θ | ãi ,s0 )
                                                                                                                                                          .   (50)
                   θ ∈Θ   ψi + ∑ ãi ∈ Ai µi ( ãi ) 1 −       pi (θ | ai∗ ,sh )          θ ∈Θ    ψi + ∑ ãi ∈ Ai µi ( ãi ) 1 −      pi (θ | ai∗ ,s0 )


By the definition of li (θ | ãi , s) in (42), I can write

                                           pi (θ | ai∗ , s)                                                      pi (θ | ai∗ , s)
                     ∑                                
                                                                 pi (θ | ãi ,s)
                                                                                    =     ∑      ψi + ∑ ãi ∈ Ai µi ( ãi )(1 − li (θ | ãi , s))
                                                                                                                                                   .           (51)
                    θ ∈Θ   ψi + ∑ ãi ∈ Ai µi ( ãi ) 1 −        pi (θ | ai∗ ,s)          θ ∈Θ


Let me define the new random variable

                                                        Li ( θ | s ) ≡         ∑        µi ( ãi )li (θ | ãi , s),                                            (52)
                                                                             ãi ∈ Ai


which, for each θ ∈ Θ, is a weighted sum of the likelihood ratios of the actions ãi for which the incentive
constraint of group i binds.14 Its cumulative distribution function given the constrained-efficient action
ai∗ is denoted by Γi (L|s) ≡ Pri (Li (θ |s) ≤ L| ai∗ , s) and the corresponding probability density function by
γi (L|s). The following result will be useful.

Lemma 2. Suppose Gi (l | ãi , sh ) is riskier than Gi (l | ãi , s0 ) in terms of SOSD for all ãi ∈ Ai for which (2) is binding.
Then Γi (L|sh ) is riskier than Γi (L|s0 ) in terms of SOSD.

Proof. Since Gi (l | ãi , sh ) is a mean-preserving spread of Gi (l | ãi , s0 ), it can be constructed as a compound
lottery, where in a first stage, l is drawn from Gi (l | ãi , s0 ) and, subsequently, each possible outcome of l
is further randomized so that the final likelihood ratio is l + z ãi where z ãi has a cumulative distribution
function Hil (z ãi | ãi ) and a corresponding probability density function hil (z ãi | ãi ) with mean zero for all l (i.e.
∑zã z ãi hil (z ãi | ãi ) = 0 ∀l). I want to show that Γi (L|sh ) is a mean-preserving spread of Γi (L|s0 ), where
    i
Γi (L|s0 ) is the cumulative distribution function of Li (θ |s0 ) = ∑ ãi µi ( ãi )li (θ | ãi , s0 ) by (52). To see this, note
that Γi (L|sh ) can be constructed as a compound lottery where, first, L is drawn from Γi (L|s0 ), and, in a
second stage, each possible realization of L is further randomized so that the final outcome is L + Z with
Z = ∑ ãi ∈ Ai µi ( ãi )z ãi . The mean of Z is ∑ ãi ∈ Ai µi ( ãi ) ∑zã z ãi hil (z ãi | ãi ) = 0 ∀L, so that Γi (L|sh ) is a mean-
                                                                            i
preserving spread of Γi (L|s0 ), as claimed in the lemma.

     Substituting the definitions of Li (θ |s) and γi (L|s) in (51), I can write

                                   pi (θ | ai∗ , s)                                              γi (L|s)
             ∑                                
                                                      pi (θ | ãi ,s)
                                                                         =        ∑     ψi + ∑ ãi ∈ Ai µi ( ãi ) − L
                                                                                                                        = ∑ Λi (L)γi (L|s)                     (53)
            θ ∈Θ   ψi + ∑ ãi ∈ Ai µi ( ãi ) 1 −     pi (θ | ai∗ ,s)          L∈ Li                                     L∈ L          i



with
                                                                                              1
                                                      Λi (L) ≡                                                        .
                                                                         ψi + ∑ ãi ∈ Ai µi ( ãi ) − L

Note first that ψi + ∑ ãi ∈ Ai µi ( ãi ) − L > 0 because of (18) and ui0 (ci∗ (θ, s)) > 0 for all i ∈ I, θ ∈ Θ, s ∈ S.
Hence L must always lie in the interval Li ≡ [0, ψi + ∑ ãi ∈ Ai µi ( ãi )). It is then straightforward to verify that
Λi (L) is strictly convex in this domain.
  14 Inthe generic case where the incentive constraint (2) only binds for one action ãi ∈ Ai , Li is just a
rescaling of li with Li (θ |s) = µi ( ãi )li (θ | ãi , s) ∀θ ∈ Θ.

                                                                                    29
     Since Γi (L|sh ) is a mean preserving spread of Γi (L|s0 ) by Lemma 2, it can be constructed from a com-
pound lottery where, in the first stage, L is drawn from Γi (L|s0 ) and, in the second stage, each possible
outcome of L is further randomized so that the final likelihood ratio is L + Z , where Z has a cumulative
distribution function HiL (Z ) and a corresponding probability density function hiL (Z ) with mean zero for
all L (i.e. ∑Z Z hiL (Z ) = 0 ∀L). Then convexity of Λi (L) and Jensen’s inequality imply that
                                                                                          
                        ∑      Λi (L)γi (L|sh )   =    ∑ ∑ Λi (L + Z )hiL (Z )                 γi (L|s0 )
                       L∈ Li                          L∈ Li        Z
                                                                                          
                                                  ≥    ∑      Λi       ∑(L + Z )hiL (Z )       γi (L|s0 )
                                                      L∈ Li            Z
                                                  =    ∑      Λi (L)γi (L|s0 )
                                                      L∈ Li


since ∑Z Z hiL (Z ) = 0 ∀L ∈ Li . Using this together with (53) yields the desired inequality (50) for group i
and thus completes the proof.




                                                           30
