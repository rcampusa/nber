                              NBER WORKING PAPER SERIES




                                      NETWORK DATA

                                       Bryan S. Graham

                                      Working Paper 26577
                              http://www.nber.org/papers/w26577


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                   December 2019




Prepared for the Handbook of Econometrics, Volume 7A. Financial support from NSF grants
SES #1357499 and SES #1851647 is gratefully acknowledged. I am grateful for comments
provided by the co-editors and other participants at a conference held at the University of
Chicago in August of 2017. Portions of the material presented below benefited from
conversations with Peter Bickel, Michael Jansson and Jim Powell. I am especially grateful to Eric
Auerbach, Seongjoo Min, Chris Muris, Fengshi Niu and Konrad Menzel, as well as an
anonymous referee, for written feedback which greatly improved the chapter. All the usual
disclaimers apply. The views expressed herein are those of the author and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Bryan S. Graham. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Network Data
Bryan S. Graham
NBER Working Paper No. 26577
December 2019
JEL No. C1,C23,C25,C31,D85

                                        ABSTRACT

Many economic activities are embedded in networks: sets of agents and the (often) rivalrous
relationships connecting them to one another. Input sourcing by firms, interbank lending,
scientific research, and job search are four examples, among many, of networked economic
activities. Motivated by the premise that networks' structures are consequential, this chapter
describes econometric methods for analyzing them. I emphasize (i) dyadic regression analysis
incorporating unobserved agent-specific heterogeneity and supporting causal inference, (ii)
techniques for estimating, and conducting inference on, summary network parameters (e.g., the
degree distribution or transitivity index); and (iii) empirical models of strategic network
formation admitting interdependencies in preferences. Current research challenges and open
questions are also discussed.


Bryan S. Graham
University of California - Berkeley
530 Evans Hall #3880
Berkeley, CA 94720-3880
and NBER
bgraham@econ.berkeley.edu
Contents
1 Introduction and summary                                                                    3

2 Examples, questions and notation                                                            6
  2.1 Empirical analysis of trade flows . . . . . . . . . . . . . . . . . . . . . . . . .      7
  2.2 Corporate governance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       8
  2.3 Production networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        8
  2.4 Research collaboration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      11
  2.5 Risk-sharing across households . . . . . . . . . . . . . . . . . . . . . . . . . .      11
  2.6 Insurer-provider and referral networks for healthcare       . . . . . . . . . . . . .   13
  2.7 Employment search . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       13
  2.8 Questions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     13

3 Basic probability tools: random graphs, graphons, graph limits and sam-
  pling                                                                   14
  3.1 Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    15
  3.2 Exchangeable random graphs . . . . . . . . . . . . . . . . . . . . . . . . . .          17
  3.3 Conditionally independent dyad (CID) models and the graphon . . . . . . .               20
  3.4 Aldous-Hoover representation theorem and the graphon . . . . . . . . . . . .            22
  3.5 Network moments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       23
  3.6 Graph limits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    29
  3.7 Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    30
  3.8 Adding sparsity: the Bickel & Chen (2009) model . . . . . . . . . . . . . . .           32
  3.9 Further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     33

4 Dyadic regression                                                                           33
  4.1 Population and sampling framework . . . . . . . . . . . . . . . . . . . . . . .         34
  4.2 Composite likelihood . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      37
  4.3 Limit distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    38
  4.4 Variance estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     42
  4.5 Bootstrap inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     47
  4.6 Further reading and open questions . . . . . . . . . . . . . . . . . . . . . . .        49


                                              1
5 Policy analysis                                                                           50
  5.1 Dyadic potential response . . . . . . . . . . . . . . . . . . . . . . . . . . . .      51
  5.2 Average structural function (ASF) . . . . . . . . . . . . . . . . . . . . . . . .      52
  5.3 Identification under exogeneity . . . . . . . . . . . . . . . . . . . . . . . . . .    54
  5.4 Estimation of the average structural function . . . . . . . . . . . . . . . . . .      58
  5.5 Further reading and open questions . . . . . . . . . . . . . . . . . . . . . . .       61

6 Incorporating unobserved heterogeneity                                                     61
  6.1 A parametric dyadic potential response function . . . . . . . . . . . . . . . .        62
  6.2 Triad probit: a correlated random effects estimator . . . . . . . . . . . . . .        63
  6.3 Fixed effects approaches . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     65
  6.4 Further reading and open questions . . . . . . . . . . . . . . . . . . . . . . .       67

7 Asymptotic distribution theory for network statistics                                      68
  7.1 Large network estimation of the transitivity index . . . . . . . . . . . . . . .       71
  7.2 Moments of the degree distribution . . . . . . . . . . . . . . . . . . . . . . .       85
  7.3 Further reading and open questions . . . . . . . . . . . . . . . . . . . . . . .       88

8 Strategic models of network formation                                                      89
  8.1 A fixed point approach with increasing preferences . . . . . . . . . . . . . . .       90
  8.2 Directed links with private information . . . . . . . . . . . . . . . . . . . . .      94
  8.3 Bounded degree and restricted heterogeneity . . . . . . . . . . . . . . . . . .        96
  8.4 Many agent approximations . . . . . . . . . . . . . . . . . . . . . . . . . . .        98
  8.5 Models with (unobserved) sequential meeting processes . . . . . . . . . . . .          99
  8.6 Further reading and open questions . . . . . . . . . . . . . . . . . . . . . . . 103

9 The bright and happy future of network econometrics                                       104

A Appendix                                                                                  106




                                             2
                          Figure 1: World Trade Network in 1928




Notes: This figured appeared in Folke Hilgerdt's 1943 American Economic Review article
"The case for multilateral trade". The figure shows aggregate trade balances between selected
large countries and different regions of the world. The paper includes a narrative discussion
of how the patterns of trade depicted in weighted digraph drawn in the figure developed
historically.
Source: Reproduced from Hilgerdt (1943, Chart 1).

1    Introduction and summary
Many economic activities are embedded in networks : sets of agents and the (often) rivalrous
relationships connecting them to one another. Firms generally buy and sell inputs not in
anonymous markets, but via bilateral contracts (Kranton & Minehart, 2001). In addition
to public listings, individuals gather information about job opportunities from friends and
acquaintances (Granovetter, 1973). We similarly poll friends for information about new
products, books, movies and so on (e.g., Jackson & Rogers, 2007; Banerjee et al., 2013; Kim
et al., 2015). Banks generally meet reserve requirements through peer-to-peer interbank
lending. The structure of this interbank lending network has profound implications for the
vulnerability of the financial system to large negative shocks (Bech & Atalay, 2010; Gofman,
2017). Additional examples abound (cf., Jackson et al., 2017).
Although important exceptions exists, some highlighted below, economists historically


                                             3
avoided the study networks (see Figure 1).2 This is now changing, very quickly, and for
several reasons. First, starting in the 1990s economic theorists applied the tools of game
theory to formally study network formation (e.g., Jackson & Wolinsky, 1996). In the result-
ing models agents add, maintain, and subtract links in order to maximize utility, with the
realized network satisfying a pairwise stability equilibrium condition.3 Second, in parallel
to this theoretical work, a lively empirical and methodological literature on peer group and
neighborhood effects also arose (e.g., Manski, 1993; Brock & Durlauf, 2001; Graham, 2008;
Angrist, 2014). Finally, largely driven by questions in empirical industrial organization,
econometricians made substantial progress on the econometric analysis of games (cf., Bajari
et al., 2013; de Paula, 2013). Each of these literatures serve as foundations for material
introduced below.
Outside of economics, two key initiators have been (i) the increasing availability of datasets
with natural graph theoretic structure (see below for examples) and (ii) innovations in applied
probability and theoretical statistics pertaining to random graph models (e.g., Diaconis &
Janson, 2008). These innovations provide a foundation upon which recent work in statistics
and machine learning on networks is largely based.
A consequence of these developments is the emergence of a small methodological literature
on the econometrics of networks. Empirical applications with substantial network content,
spurred largely by access to new datasets, arose more quickly (e.g., Fafchamps & Minten,
2002; De Weerdt, 2004; Conley & Udry, 2010; Atalay et al., 2011; Acemoglu et al., 2012;
Banerjee et al., 2013; Barrot & Sauvagnat, 2016). Furthermore, these applications now span
the major fields of our discipline. Nevertheless many open questions in the econometrics of
networks remain. In this chapter I attempt to provide an account of recent progress as well
as make suggestions for future research. My audience is both econometricians and empirical
researchers.
I divide my discussion into five parts. The discussion draws from recent contributions to
the analysis of networks made in probability, econometrics, and statistics (including machine
learning); approximately in that order. After an initial outline of recent empirical research
with a network dimension in economics, Section 3 introduces some basic probability tools
that will prove useful for what follows. Several of these tools are of quite recent origin.
Next, in Sections 4 to 6 I turn to the analysis of dyadic regression models. Such models go
back, at least, to the pioneering work of Tinbergen (1962, Appendix VI) on gravity trade
   2
      In contrast our colleagues in sociology studied networks from the outset of their discipline in its modern
form. The monograph by Wasserman & Faust (1994) provides a somewhat dated introduction to this
literature. See also Granovetter (1985).
    3
      Other equilibrium concepts have been explored as well (cf., Bloch & Jackson, 2006).



                                                       4
models. Although dyadic regression is a core empirical method in international trade, as
well as in certain areas of political science and development economics, a coherent inferential
foundation for empirical practice is only now emerging. My discussion, in addition to covering
methods of inference, discusses how to incorporate unobserved heterogeneity into dyadic
regression models (Section 6). Here I appropriate and extend insights from panel data
(Chamberlain, 1980, 1984, 1985; Hahn & Newey, 2004; Arellano & Hahn, 2007). This section
also sketches out how to answer causal questions in dyadic settings.
Section 7 turns to the large network properties of several common network statistics. I focus
on so-called network moments, or the frequencies with which certain low order subgraph
configurations (e.g., triangles ) occur within a network. Subgraph counts, in the form
of the triad census, were introduced by Holland & Leinhardt (1970) almost a half-century
ago. Recent developments in probability and statistics have substantially improved our
understanding of these counts (e.g., Diaconis & Janson, 2008; Bickel et al., 2011).
Subgraph counts may be of direct interest, but also serve as the building blocks of sev-
eral popular network statistics, such as transitivity or moments of the degree distribution.
Jackson et al. (2017) survey the mapping between different network statistics and economic
phenomena and questions. My interest in network moments also stems from their value as
inputs into structural model estimation in a manner akin to the way sample moments are
paired with model moments in the simulated method of moments (e.g., Gourieroux et al.,
1993). This idea is developed in Section 8.
The discussion of dyadic regression in Sections 4 to 6 rules out interdependencies in link
formation. In dyadic models the utility two agents generate by forming a link is invariant
to the presence or absence of links elsewhere in the network. Beginning with the seminal
work of Jackson & Wolinsky (1996), the relaxation of this assumption is a central preoc-
cupation of both theoretical and econometric researchers. When link formation decisions
are interdependent, inefficient network structures may occur in equilibrium, making policy
analysis interesting. Empirical network formation models allowing for interdependencies are
also challenging to study. In a typical model many equilibrium network configurations can
arise for any given parameter value; such models are incomplete (e.g., Tamer, 2003). In
principle, standard tools developed in the context of economic games between a small num-
ber of agents apply. Practically speaking such methods are computationally infeasible in
the many agent context of networks. Recent research proposes a variety of ways of getting
around this conundrum.
Economists' interest in networks stems from the belief that their structure is consequen-
tial. For example, Loury (2002) argues that differences in social networks across Blacks and
Whites drives, in part, racial inequality (cf., Graham, 2018b). Acemoglu et al. (2012) argue

                                              5
that the Leontief input-output structure of the economy shapes technology shock propaga-
tion. Alatas et al. (2016) show that network structure influences the flow and aggregation of
information within rural villages. Theorists also study the interplay between network struc-
ture and agent behavior on that structure (Jackson & Yariv, 2011; Jackson & Zenou, 2015).
Methodological research relating network structure to economic outcomes builds-upon the
line of peer effects research initiated by Manski (1993). The paper by Bramoullé et al. (2009)
is a nice, and influential, example of recent work along such lines.
This survey, however, does not review methods for the empirical analysis of behavior on
networks. Instead I focus on modeling their formation. My motivation for this emphasis is
two-fold. First, Blume et al. (2011) already survey work at the intersection of peer group
effect identification and networks (cf., Blume et al., 2015; de Paula, 2017). Second, the
current state of research in this area suggests that a better understanding of how networks
form is a prerequisite for more credible research on their consequences.
Current research on the effects of network structure on outcomes largely treats it as exoge-
nously given (although this is not always made explicit). This decision is one reason why
research on peer effects and networks remains controversial a quarter century after Man-
ski's foundational paper.4 The focus maintained here, on formation, therefore seems to be
a natural one. Ultimately, of course, the goal is to study the formation of networks and
their consequences jointly, but such an integrated treatment remains largely aspirational at
this stage. Although, Goldsmith-Pinkham & Imbens (2013) provide one recent "proof of
possibilities" example of such an integrated approach. Qu & Lee (2015), Auerbach (2016),
Badev (2017), and Johnsson & Moon (2017) represent other steps in this direction.



2       Examples, questions and notation
The analysis of datasets with natural graph theoretic structure has a long history in the other
social sciences (e.g., Moreno, 1934), and more recently emerged as an area of focus within the
statistics and machine learning community (e.g., Goldenberg et al., 2009; Kolaczyk, 2009).
Although we were late adopters, interest in these types of datasets now also extends across
virtually all fields of economics. Nevertheless, as already noted, appropriate methods for the
analysis of network data are not widely available. Ad hoc and/or heuristically motivated
approaches to estimation and inference abound in empirical work. Networks are characterized
by complex dependencies across agents, as well as other difficult modeling, estimation and
    4
    For example, Jackson et al. (2017, p. 81) argue that endogenous network formation, the tendency for
the unobserved drivers of link formation and the behavior of interest to the econometrician to covary, poses
a key challenge to "accurately estimating interactive effects in networked settings".


                                                     6
inferential challenges. These challenges are just starting be understood and solved. Before
discussing methods for the analysis of network data, I briefly introduce some recent examples
of empirical network research in economics. These examples also serve to introduce some
basic notation.


2.1       Empirical analysis of trade flows
Figure 2 visually depicts international trade in bananas, a widely-eaten tropical fruit, in
2015. Each dot or node in the figure corresponds to a country. If, for example, Honduras,
exports at least 50,000 tons of bananas to the United States, then there exists a directed
edge      from Honduras to the United States.5 The exporting country (left node) is called
the tail of the edge, while the importing country (right node) is its head. The set of all
such exporter-importer relationships forms G (V , E ), a directed network or digraph defined
on N = |V| vertices or agents (here countries). The set V = {1, . . . , N } includes all agents
(countries) in the network and E  V × V the set of all directed links (exporter-importer
relationships of 50,000 tons or greater) among them.6 Let N be the order of the digraph
and |E| its size. In what follows nodes may be equivalently referred to as vertices, agents,
individuals, countries and so on depending on the context. Likewise edges may be called
links, friendships, ties, arcs, relationships and so on.
There are N = 220 countries in the banana network and hence up to 2 220  2
                                                                            = 48, 180 directed
trading relationships among them. How might an econometrician model the presence or
absence of a trading relationship from country i to j ? Over fifty years ago Tinbergen (1962,
Appendix VI) introduced gravity models, suitable for data of the type shown in Figure 2.
In a gravity model trade between two countries, a dyad in network parlance, is modeled
as a function of exporter and importer attributes (e.g., their gross domestic products), as
well as dyad-specific covariates (e.g., physical distance between them). Generalizations of
Tinbergen's approach are workhorses of modern empirical trade research (e.g., Santos Silva
& Tenreyro, 2006; Helpman et al., 2008; Anderson, 2011).
Their ubiquity notwithstanding, serious open questions remain about how to estimate, and
conduct inference on, the parameters of gravity trade models. Questions of particular interest
here include how to account for the dependence across dyads sharing a country in common,
how to incorporate country-specific (correlated) unobserved heterogeneity, and how to for-
malize causal policy effects in dyadic settings. As an example of the latter challenge, consider
the effects of participation in multi-lateral trading agreements, such as the General Agree-
  5
      In constructing this network, I binarized the underlying trade flow data to determine edge placement.
  6
      Here U × V denotes the Cartesian product of the set U and V (i.e, U × V = {(u, v ) : u  U , v  V}).


                                                      7
ment on Tariffs and Trade (GATT) or its successor, the World Trade Organization (WTO),
on trade flows. Does trade increase across participating countries (Rose, 2004; Helpman
et al., 2008)? While a mature literature on program evaluation suitable for single agent set-
tings now exists (cf., Heckman & Vytlacil, 2007; Imbens & Wooldridge, 2009), a networked
counterpart has yet to emerge.


2.2    Corporate governance
Next consider the affiliation network of (corporate board) directors and firms. This bipartite
network B (U , V , E ) consists of two sets of agents, the set of possible directors, U , and the
set of firms, V . Edges, E , match directors to firms (i.e., corporate boards), and hence may
only run between V and U . A longstanding interest among corporate governance researchers
centers on the implications of so-called board interlocks. When a single director sits on
multiple corporate boards, then these corporations have interlocking directorates (Dooley,
1969). Interlocking directorships may facilitate collusion and other anti-competitive activities
as well as, perhaps more positively, the diffusion of innovations in corporate governance
(Davis, 1991, 1996).
Figure 3 plots the one-mode projection of the directors-to-firms bipartite network for S&P
1,500 firms in 2016. This projection generates an undirected network G (V , E ) on the set
of all firms, with an edge between any two firms sharing at least one director in common
(i.e., with interlocking corporate boards). Large firms in United States are inter-connected
via overlapping corporate board membership. On average firms share at least one board
member in common with four other firms and over 80 percent of S&P 1,500 firms form a
giant connected component of board interlocks. The board interlock network is also highly
transitive : two firms are much more likely to share a director in common, if they also share
one in common with a third firm.
Chu & Davis (2016) and Gualdani (ming) provide recent analyses of board interlocks as well
as references to earlier work.


2.3    Production networks
Atalay et al. (2011) study the production network of the United States economy. The sale and
purchase of intermediate inputs between firms joins virtually all publicly traded corporations
in the United States into one giant buyer-supplier network.
Serpa & Krishnan (2017) present evidence of productivity spillovers across firms linked to-
gether via supply chain relationships (cf., Acemoglu et al., 2016a). Acemoglu et al. (2012)

                                               8
study the effect of the Leontief input-output structure of the US economy on shock propaga-
tion. Their analysis suggests that idiosyncratic technology shocks to critical input suppliers
may have macro-level effects.
Bernard et al. (2018), using detailed supply-chain data from Japan, show how lowering
supplier search costs allows firms to source inputs more efficiently, in turn lowering marginal
production costs. The rich supply-chain data underlying the analysis of Bernard et al.
(2018) is emblematic of the increasing availability of detailed supply chain network data
from different countries (e.g., Dhyne et al., 2015). These datasets have the potential to
dramatically improve our understanding of, for example the sources of heterogeneity in
productivity across firms (e.g., Atalay et al., 2014) and the upstream and downstream
implications of (horizontal) mergers (e.g., Fee & Thomas, 2004; Bhattacharya & Nain, 2011;
Ahern & Harford, 2014), among many other areas of industrial organization and regulation
policy.




                                              9
                                                   Figure 2: World Trade in Bananas, 2015
10




     Source: BACI-CEPII International Trade Database (cf., Gaulier & Zignago, 2010; De Benedictis et al., 2014) and author's calculations.
     Notes: International trade of bananas in 2015 (HS6 code 080390). Each node in the figure represents a country (nodes are positioned
     at capital cities) and an edge between two nodes indicates the presence of at least 50,000 tons of directed banana flows (the head of each
     directed edge corresponds to the importing nation). In the left-hand panel node size is proportional to the total exports of bananas by
     the relevant nation, while in the right it is proportional to its total imports.
2.4    Research collaboration
Jaffe (1986), in a classic study, presented evidence of research and development (R&D)
spillovers across technologically adjacent firms (Bloom et al., 2013; Acemoglu et al., 2016b).
Such spillovers provide a motivation for firms to undertake collaborative R&D, a tendency
which has increased over time (Hagedoorn, 2002; Tomasello et al., 2017). König et al.
(2019) model the formation of R&D partnerships across firms theoretically and empirically,
exploring the implications of network structure for optimal R&D subsidy policies. The
structure of spillovers across firms, as well as the mechanisms whereby they form R&D
partnerships, determines optimal policies.
Ductor et al. (2014) study collaboration and research output among and across economists.
Newman (2001) explores collaboration networks in the various sciences.


2.5    Risk-sharing across households
A classic question in development economics is whether households efficiently share risk
through informal agreements (Townsend, 1994; Udry, 1994). Recently economists have di-
rectly collected information on risk-sharing relationships across households. For example,
De Weerdt (2004) collected data on risk-sharing links across households in a village in Tan-
zania and empirically modeled the determinants of these links (cf., Fafchamps & Lund, 2003;
Fafchamps & Gubert, 2007). Ambrus et al. (2014) investigate how the precise structure of
links across households determines the amount of risk that can be insured, as well as the
form of second best, more local, network structures.
Network structure now informs many other areas of development economics, including re-
search on technology adoption and program take-up in rural settings (e.g., Banerjee et al.,
2013; Kim et al., 2015), the productivity of small traders and firms (e.g., Fafchamps &
Minten, 2002), and post-migration employment outcomes (Beaman, 2011; Munski, 2003),
among other examples.




                                             11
                                         Figure 3: United States Corporate Board Interlocks, 2016
12




     Source: Wharton Research Data Services (WRDS) - Institutional Shareholder Services (ISS) Directors dataset and author's calculations
     (cf., Chu & Davis, 2016).
     Notes: The figure plots the largest connected component of the corporate board interlock network in 2016 among S&P 1,500 firms.
     The top 10 Fortune 500 firms in 2016 are the larger `Rose Garden' colored nodes. A total of 1,216 firms belong to the largest connected
     component. See Newman (2010, p. 124 - 127) for details on how to construct one-mode projections of bipartite graphs.
2.6     Insurer-provider and referral networks for healthcare
Many features of the health care market naturally map into graphs. For example, physicians
may have admitting privileges across multiple hospitals, insurers typically offer preferential
terms to selected networks of providers, and doctors vary in the intensity with which they
refer patients to one another.7
The welfare and economic implications of these networks are likely immense, given the
magnitude of the health care sector in the United States economy. Ho (2009) represents one
attempt to grapple with the network structure of healthcare markets.


2.7     Employment search
Ioannides & Loury (2004) survey the substantial literature on the interplay between social
networks and job acquisition, a topic that has fascinated both sociologists and economists
at least since Granovetter (1973). The growing availability of longitudinal register data
from various countries provides an opportunity to study the interface between networks and
inequality in the labor market more carefully.
For example, Saygin et al. (2014) use the Austrian Social Security Database to construct
a co-worker network for middle aged workers in Austria. A co-worker is anyone who an
individual has ever worked with previously. They find that the structure of these co-worker
networks predict the ease with which workers find employment after establishment closures
(i.e., mass layoffs). This paper provides a nice example of how new data may facilitate the
re-visiting of a classic networks question (cf., Hensvik & Skans, 2016).


2.8     Questions
The examples outlined above represent only a small sample of recent appearances of net-
work data in empirical economic research.8 What do we hope to learn from this growing
body of research? As noted in the introduction, empirical research on networks can usefully
be divided between that which studies the consequences of networks and that which stud-
ies their formation. The premise of this chapter is that network linkages across agents are
consequential. That is, I take as given that networks are important venues for shock prop-
agation, information diffusion, learning and various types of peer interactions. Maintaining
this premise justifies my focus on the econometric modeling of network formation.
   7
     Barnett et al. (2011) and An et al. (2018) use patient referral patterns to map out relationships among
physicians.
   8
     de Paula (2017) and Jackson et al. (2017) provide additional references.


                                                    13
An analogy with the development of single agent models of discrete choice is useful. McFad-
den (1974), in a pioneering paper, initiated a research program on identifying and estimating
random utility models of discrete choice. Empirical application, computation, semiparamet-
ric identification and estimation, the inclusion of unobserved choice attributes, and allowing
for strategic behavior, all have been important accomplishments of this research program.
These econometric models are, in turn, routinely used in virtually all areas of economics.
The goal here is analogous. Relational data are ubiquitous in economics, but econometric
models for such data are not. The goal, therefore, is to develop models for these data,
preferably with (i) strong microeconomic foundations, (ii) that allow for unobserved agent-
level heterogeneity, and (iii) incorporate interdependencies in preferences over links. Also
required are feasible methods of estimation and inference (and in this area interesting and
challenging questions are abundant). The availability of econometric methods for network
analysis will, in turn, allow for counterfactual policy and welfare analysis. How would a
particular horizontal merger affect upstream supply chain structure? What is the effect on
trade flows of Eurozone membership? Could a school principal increase friendships across
races, or raise average achievement, by structuring classrooms under her purview differently?
Some readers may wish to skip Section 3 initially and instead start with Sections 4 to 6.
They could then return to Section 3 before tackling Sections 7 and 8. Graph theoretic
concepts and notation appears throughout the chapter. While many terms and definitions
are formally defined, others are not. Missing definitions can be found in any basic graph
theory textbook.



3     Basic probability tools: random graphs, graphons,
      graph limits and sampling
This section provides an informal introduction to key ideas from the applied probability
literature on exchangeable random graphs. The main concepts are (i) exchangeable random
graphs and their representation, (ii) subgraph densities or network moments, (iii) limits
of sequences of exchangeable random graphs, and (iv) sampling. These ideas underlie a
substantial share of recent research on the statistics of networks (e.g., Airoldi et al., 2008;
Diaconis et al., 2008; Bickel & Chen, 2009; Bickel et al., 2011; Bhamidi et al., 2011; Chatterjee
et al., 2011; Olhede & Wolfe, 2014; Orbanz & Roy, 2015; Gao et al., 2015).
Much of this statistics work has been motivated by research questions in computational
biology and neuroscience (e.g., Picard et al., 2008). Link formation in these settings is not
driven by purposeful agents. Consequently this research may initially appear rather distant

                                               14
from the concerns of econometricians. Nevertheless my view is that recent developments in
probability and statistics have much to offer econometricians interested in networks (and
also vice-versa, although making this second argument this is not on my agenda here).
The basic concepts introduced in this section appear frequently in later portions of the
chapter.


3.1     Notation
Let G (V , E ) be a finite undirected network or graph defined on N = |V (G)| vertices or agents;
here V (G) = {1, . . . , N } denotes the set of all agents in the network.9 Any two agents may be
connected or not. The set of such links is recorded in the edge list E (G) = {(i, j ) , (k, l) , . . .},
consisting of the (unordered) indices of all connected agent pairs. Call N the order of the
network and |E (G)| its size. We can represent G (V , E ) by the N × N adjacency matrix
D = [Dij ]i,j V (G) with ij th element

                                                  1, (i, j )  E (G)
                                       Dij =                        .
                                                  0, otherwise

For an undirected network, with self-ties or loops ruled out, such that Dii = 0 for i  V (G),
D is a symmetric binary matrix with a diagonal of structural zeros. I focus on undirected
networks initially, but also present some results for directed networks and bipartite networks.
Specific notation for these special cases will be introduced as needed.
In settings where it is useful to emphasize the order of G, I use the notation GN . This is
especially useful when considering sequences of graphs. Let (i, j )  E (G) be an edge in G;
sometimes I will abbreviate (i, j ) as ij . The complete graph on p vertices is denoted by Kp .
Following Jackson (2008), let G - ij denote the network obtained by deleting edge ij from
G (if present), and G + ij the network one gets after adding this link. Let D ± ij denote
the adjacency matrix associated with the network obtained by adding/deleting edge (i, j )
from G. Let DN denote the set of all 2( 2 ) possible adjacency matrices and IN the set of all
                                        N



possible N -dimensional binary vectors.
Let N (i) = {j  V : ij  E} be the set of agent i's neighbors: agents to which she is directly
linked. The degree of agent i is given by the cardinality of this set. Equivalently agent i's
degree may be computed by summing the elements of the ith row of the adjacency matrix.
Let N be an N × 1 vector of ones. The vector D+ = DN is called the degree sequence of the
    9
      If X is a set, then |X| denotes the cardinality of that set. If X is a matrix of reals, then |X| equals its
(element-wise) absolute value.


                                                       15
network (typically we re-arrange the order of agents such that the elements of this vector
are in ascending order).
I informally call a network dense if its size, or number of edges, is "close to" N 2 and sparse
if its size is "close to" N . More precisely a sequence of graphs is sparse in the limit if the
number of edges in it grows linearly with N , dense if this growth is quadratic.
             def
There are n  N    2
                     = 12
                          N (N - 1) pairs of agents, or dyads, in a network consisting of N
agents. Triples, quadruples and quintuples of agents are call triads, tetrads and pentads
respectively. A tuple of 17 agents, which arises rather rarely in everyday empirical work, is
evidently called a septendecuple. Not having formally studied Latin, I offer the reader no
guidance on pronunciation.
                               N -1    N
Let i<j be shorthand for       i=1     j =i+1   with             i<j<k   similarly defined. The density of a
network,
                                      def       def       2
                            PN (   )  ^N                                       Dij ,
                                                      N (N - 1)          i<j

equals the proportion of connected dyads. Let Di+ be the ith element of the degree sequence.
Average degree,
                                                      N
                                               def 1
                             ^ N def
                                  (N - 1)   ^N           D i+ ,
                                                   N i=1

equals the average number of links per agent in the network.
In what follows random variables are (generally) denoted by capital Roman letters, specific
realizations by lower case Roman letters and their support by blackboard bold Roman letters.
That is Y , y and Y respectively denote a generic random draw of, a specific value of, and
the support of, Y . The abbreviations i.i.d., CLT , LLN and GGP stand for, respectively,
"independent and identically distributed", "central limit theorem", "law of large numbers"
and "graph generating process". For the vector b, b 2 denotes the Euclidean norm; for the
matrix B, B F denotes the Frobenius norm. I use IN to denote the N × N identity matrix.
N denotes the set of natural numbers and [Yij ]i,j N an infinite two-dimensional array with
ij th element Yij .
I use the big-Omega notation XN =  (YN ) to denote that XN = O (YN ) and YN = O (XN ).
              D                                            def
The notation = denotes equality in distribution,  a mathematical definition. Let  be some
parameter value in the space . Let SN () be some statistic indexed by this parameter with
population value 0 . I let SN = SN (0 ) denote the statistic evaluated at  = 0 . To
economize on space I sometimes abbreviate Pr ( Y = y | X = x) as Pr ( Y = y | x) or Pr ( y | x)
and similarly for E [ Y | x], V ( Y | x) etc.



                                                      16
3.2    Exchangeable random graphs
Initially assume the unavailability of agent-specific covariates, making it natural to assume
that agents are exchangeable (models with covariates, and a correspondingly weaker notion
of exchangeability, feature in Sections 4, 5, 6 and 8). Let  : {1, . . . , N }  {1, . . . , N } be
a permutation of the node labels of G (V , E ) and  the set of all such permutations. The
random graph G is jointly exchangeable if

                                             D
                                       [Dij ] = D(i)(j )                                      (1)

for every permutation   .
In settings where node labels have no meaning, exchangeability is an implication of a priori
researcher belief (and hence a natural modeling assumption). Consider a researcher ana-
lyzing the adjacency matrix associated with a set of friendship links among adolescents in
a high school (e.g., Currarini et al., 2009), in the absence of node-specific covariates, there
is no reason to change one's modeling approach after simultaneously applying a particular
reshuffling of agents to both the rows and columns of D (cf., Rubin, 1981). Put differently,
when node labels have no meaning, the probability attached to any isomorphism of G should
be the same as that attached to G itself.
There are many interesting statistics of D which are invariant to simultaneous row and col-
umn permutations. Examples include a network's density, diameter and triangle ( ) count.
A family of such statistics, network moments, is introduced below. Exchangeability suggests
that a statistical model should attach different probabilities to networks with different values
of such (permutation invariant) statistics, but the same probability to two networks which
are isomorphic (which will share common values of any permutation invariant statistic).


An exchangeable model with strategic interaction

Most extant models of network formation satisfy condition (1). As an example, which will
help to fix some ideas, consider the model of strategic network formation with bilateral
transfers studied by Graham & Pelican (2020). Let i : DN  R be a utility function for
agent i, which maps networks into utility. Define the marginal utility of edge ij for agent i
as
                                    i (D) - i (D - ij ) if Dij = 1
                     M Uij (D) =                                      .                   (2)
                                    i (D + ij ) - i (D) if Dij = 0

From Bloch & Jackson (2006), a network is pairwise stable with transfers if the following
condition holds.

                                                 17
Definition 1. (Pairwise stability with Transfers) The network G (V , E ) is pairwise
stable with transfers if
(i)  (i, j )  E (G) , M Uij (D) + M Uji (D)  0
(ii)  (i, j ) / E (G) , M Uij (D) + M Uji (D) < 0

If the network in hand is a pairwise stable one, then any links actually present generate
(weakly) positive utility (on net for the two agents on each side of a link). Unobserved links,
in contrast, would not generate net positive utility if present.
Graham & Pelican (2020) focus on a general family of parametric utility functions which
includes, among others, the specification


                   i ( d|A, B, V ; 0 ) =          dij Ai + Bj + 0              dik djk         
                                                                                           - Vij          (3)
                                              j                            k


with V = Vij     
                    , A = [Ai ] and B = [Bi ]. Under (3), assuming 0 > 0, dyad {i, j } will
generate more utility when forming a link if they already share many links or "friends"
in common (i.e., if k dik djk is large). Here Ai and Bj are agent-specific "extroversion"
and "popularity" parameters, the effect of which is to generate degree heterogeneity (cf.,
                                   
Graham, 2017). The term Vij          is an idiosyncratic dyad-specific utility shifter. Graham &
Pelican (2020) leave the joint distribution of A and B unrestricted, but here I will assume
                                                                               
that {(Ai , Bi )}N
                 i=1 is an i.i.d. sequence which is independent of     Vij , Vji i,j {1,...,N },i<j
                                                                                                    , also
assumed i.i.d.
When the utility function is of the form given in (3) the marginal utility agent i gets from
a link with j is


                      M Uij ( d| A, B, V ; 0 ) = Ai + Bj + 0               dik djk           
                                                                                         - Vij .
                                                                       k


Pairwise stability then implies, conditional on the realizations of A, B, V , and the value of
externality parameter, 0 , that the observed network must satisfy, for i = 1, . . . , N - 1 and
j = i + 1, . . . , N

                             Dij = 1 Ui + Uj + 20               Dik Djk         Vij                       (4)
                                                            k

                                     
with Ui = Ai + Bi and Vij = Vij  + Vji . Equation (4) defines a system of N
                                                                          2
                                                                            = 12
                                                                                 N (N - 1)
nonlinear simultaneous equations. Any solution to this system ­ and there will typically be
multiple ones ­ constitutes a pairwise stable (with transfers) network.10
  10
       Note that in this example existence of an equilibrium is easy to show using Tarski's (1955) fixed point


                                                       18
As written, model (4) is incomplete (cf., de Paula, 2013). Even if we assume that the
observed network is a pairwise stable one, we have not specified a mechanism for selecting,
when there are multiple ones, a specific equilibrium configuration. To complete the model,
following the more careful development in Pelican & Graham (2019), let Nd (V; U,  ) equal
the probability that configuration D = d is selected. If d is not an equilibrium ­ given U,
V and  ­ then Nd (V; U,  ) = 0. If d is the unique equilibrium then Nd (V; U,  ) = 1. If
d is one of several equilibria, then 0  Nd (V; U,  )  1 etc.
For DN the net of all N × N undirected adjacency matrices, we have that
   dDN Nd (V; U,  ) = 1. The conditional likelihood of observing network wiring D = d
is therefore
                    Pr ( D = d| U;  ) =      Nd (v; U,  ) fV (v) dv.
                                                     vRn
         N
The      2
              equilibrium conditions (4) indicate that if d = [dij ] is an equilibrium, then so is
   def
d  d(i)(j ) . Hence as long as the equilibrium selection mechanism is also invariant to
index permutations, as is natural to require, condition (1) holds.
Under the null of no strategic interaction,  = 0, the likelihood simplifies to

                           Pr ( D = d| U; 0) =                Nd (v; U, 0) fV (v) dv                         (5)
                                                        vRn


with
                                                 N -1    N
                             Nd (v; U, 0) =                   1 (Ui + Uj  vij )dij
                                                 i=1 j =i+1

                                                 × 1 (Ui + Uj < vij )1-dij .

Since {(Vij )}i,j {1,...,N },i<j is i.i.d., if we further assume that fV12 (v ) = ev / [1 + ev ]2 , the
logistic density, explicitly evaluating the integral in (5) yields

                                   N -1   N                           dij                        1-dij
                                                  exp (Ui + Uj )                    1
             Pr ( D = d| U; 0) =                                                                         ,   (6)
                                   i=1 j =i+1
                                                1 + exp (Ui + Uj )          1 + exp (Ui + Uj )

which is the likelihood associated with the so-called  -model of Frank (1997) and Chatterjee
et al. (2011).
A feature of the  -model is that links form independently conditional on the latent agent-
specific effects {Ui }N                                           N
                      i=1 . Equation (6) consists of a product of 2 conditionally independent

theorem.



                                                        19
likelihood contributions.
Evidently, this conditional independence structure is not typically a feature of the model
when  > 0, such that strategic interaction is present. To see why by means of a simple
example, consider a network consisting of just three homogenous agents (i.e., U1 = U2 =
U3 = 0). Initially assume that both V12 and V13 are less then zero, but that 0 < V23  20 .
This corresponds to edges (1, 2) and (1, 3) generating so much intrinsic utility that they
will form irrespective of what other edges may or may not be present in the network. In
contrast, the intrinsic utility attached to edge (2, 3) falls in an intermediate range: the edge
forms if edges (1, 2) and (1, 3) are present ­ such that agents 2 and 3 share agent 1 as a friend
in common ­ and does not form if they are absent. This configuration of utility shocks is
depicted in the left-hand panel of Figure 4. The unique equilibrium outcome in this case is
a triangle ( ) network.
If, instead, V12 and V13 are both greater than 2 , such that the (1, 2) and (1, 3) edges never
form because of their low intrinsic utility (again irrespective of what other edges may or may
not be present in the network), then the (2, 3) edge will not form either. This scenario is
depicted in the right-hand panel of Figure 4. The unique equilibrium outcome in this case
is an empty ( ) network.
This simple example shows that D23 need not vary independently of D12 and D13 conditional
on (U1 , U2 , U3 ) in the presence of strategic interaction ( > 0) . Such conditional indepen-
dence is a feature of the  -model ( = 0). While the model is exchangeable both when  > 0
and when  = 0, the conditional independence of edges only obtains under the no strategic
interaction null.


3.3    Conditionally independent dyad (CID) models and the
       graphon
Having established that a network probability model should satisfy the joint exchangeability
condition (1), it is important to articulate classes of models that do so. One such family
of models, suggested by the last example, are conditionally independent dyad (CID) models
(Chandrasekhar, 2015; Shalizi, 2016). In these models each agent is characterized by an
unobserved latent attribute, Ui . The N agents in the network in hand are viewed as inde-
pendent random draws from some population, such that the {Ui }N     i=1 are independently and
identically distributed. Conditional on the agent-specific latent variables U = (U1 , . . . , UN )
edges form independently with

                              Dij | Ui , Uj  Bernoulli (h (Ui , Uj )) ,

                                                 20
                              Figure 4: Dependent link formation




Notes: Both panels depict the unique pairwise stable equilibrium associated with the shown
triple of dyad-level utility shifters V12 , V13 and V23 and agent-level heterogeneity parameters
U1 , U2 and U3 identically equal to zero. In both panels the realized value of V23 is the same,
but whether D23 = 1 or 0 varies with the realized values of V12 and V13 . If V12 and V13 are
sufficiently low, then D23 = 1; if they are sufficiently high, then D23 = 0. Links are not
conditionally independent given {Ui }i=1,2,3 .


for every dyad {i, j } with i < j . Here h (u, v ) = h (v, u) for all (u, v )  U × U is a symmetric
edge probability function. In anticipation of results to come, call this function a graphon :
short for graph function.
Conditional on the latent agent-specific effects the likelihood of the network is

                   Pr ( D = d| U = u) =             h (ui , uj )dij [1 - h (ui, uj )]1-dij .
                                              i<j


Unconditional on U, the likelihood equals

                                                                                       N
                                                                               1-dij
         Pr (D = d) =       ···           h (ui , uj )   dij
                                                               [1 - h (ui, uj )]             fU (ui ) dui ,   (7)
                                    i<j                                                i=1


where fU (u) is the density of U . Importantly (7) allows for dependence across dyads which
share agents in common. Independence holds only conditional on the latent agent attributes
(Graham, 2017). Similar independence restrictions play a prominent role in the econometrics
of panel data (Chamberlain, 1984; Arellano & Honoré, 2001).
It is an easy exercise to show that (7) is compatible with the finite joint exchangeability
restriction (1).


                                                     21
The  -model, introduced above, belongs to the family of CID models with a graphon of

                                                      exp (u + v )
                                      h (u, v ) =                    .
                                                    1 + exp (u + v )

Random threshold graphs (e.g., Diaconis et al., 2008) are also members of this family with
graphon
                          h (u, v ) = 1 (FU (u) + FU (v )  ) ,

and FU (u) the CDF of U .
It is important to realize that CID models constitute only a subset of all jointly exchangeable
random graph models when N ­ the number of agents in the network ­ is finite. As shown
by means of the example introduced above, strategic interaction in link formation can induce
dependence across elements of the adjacency matrix that evidently cannot be eliminated by
conditioning (see Figure 4 above). Although not all exchangeable models are CID ones, this
family of models plays an outsized role in extant large sample theory for networks.


3.4        Aldous-Hoover representation theorem and the graphon
Joint exchangeability imposes more structure on the network probability distribution when
there are an infinite number of agents. Specifically, if we strengthen (1) to hold for any
permutation of a finite number of the indices of the infinite sequence N = {1, 2, 3, . . .},
we have a generalization of de Finetti (1931) type exchangeability of an infinite sequence,
appropriate for infinite random graphs. In independent work Aldous (1981) and Hoover
(1979) showed the following representation result for infinite random adjacency matrices
(cf., Kallenberg, 2005).

Theorem 1. (Aldous-Hoover) A random adjacency matrix [Dij ]i,j N is jointly exchange-
able if and only if there is a measurable function g : [0, 1]4  {0, 1} such that

                                             D
                                       [Dij ] = [g (, Ui , Uj , Vij )]

for , {Ui }iN , and {Vij }i,j N,i<j independently and identically distributed U [0, 1] random
variables with Vij = Vji .

Here  is a mixing parameter, analogous to the one appearing in de Finetti's (1931) classic
representation theorem for exchangeable binary sequences.11 Theorem 1 implies that if
  11
    To make the connection with de Finetti (1931) transparent Aldous (1981, Lemma 1.5) also shows that
                          
an infinite sequence {Yi }i=1 is exchangeable if and only if there exists a measurable function f such that
       D
[Yi ] = [f (, Ui )].


                                                     22
network agents are exchangeable for all N , then we can proceed `as if' edges formed according
to a CID model or a mixture of such models.
Exploiting the fact that the elements of D are binary, we can simplify Theorem 1 as follows.
Averaging over Vij yields

                                                    1
                                          def
                             h (, ui , uj )             g (, ui , uj , v ) dv
                                                0


from which we get the more convenient representation, for i < j ,

                                     D
                               [Dij ] = [1 (Vij  h (, Ui , Uj ))] .                       (8)

This is, of course, just a conditional edge independence model (or, more precisely, a mixture
of such models). In what follows I focus on inference which conditions on the empirical
distribution of the data; consequently  can often safely be ignored. When this is the case I
suppress the  argument in the graphon, writing h (Ui , Uj ). See Bickel & Chen (2009) and
Menzel (2017) for additional discussion.
Theorem 1 motivates an approach to nonparametric modeling of large networks that pro-
ceeds `as if' links form independently conditional on the agent-specific latent variables
U = (U1 , . . . , UN ) . This is convenient because CID models induce a very particular de-
pendence structure across the rows and columns of the network adjacency matrix.
Consider, without loss of generality, agents 1, 2 and 3. In a CID model D12 and D13 may
covary; the dyads {1, 2} and {1, 3} share the agent 1 in common and hence both links form, in
part, based on the value of U1 . However D12 and D13 vary independently conditional on U1 ,
U2 and U3 (hence the conditionally independent dyad nomenclature). Links involving pairs
of dyads which share no agents in common, for example D12 and D34 , form independently.
The structured pattern of dependence, independence and conditional independence associ-
ated with CID models facilitates the development of LLNs and CLTs that can be applied
to statistics of the adjacency matrix. A group of statistics for which some large network
distribution theory is available are network moments.


3.5    Network moments
Almost fifty years ago Holland & Leinhardt (1970) suggested that a network's architec-
ture could be usefully summarized by its average local structure. Agent exchangeability,
in conjunction with Theorem 1, also motivates an approach to network modeling based on
the frequency of low order subgraph configurations (i.e., the number of edges, two stars,

                                                23
triangles, squares, k-stars etc).
Consider, for example, the set of all N    3
                                              triads ­ unordered triples of agents ­ in a net-
work; what fraction of these triads take two-star         or triangle      configurations? These
frequencies, called network moments by Bickel et al. (2011), feature prominently in research
by sociologists (e.g., Granovetter, 1973; Coleman, 1988; Gould & Fernandez, 1989) and com-
putational biologists (e.g., Milo et al., 2002; Przulj et al., 2004); albeit in the context of two
largely independent and desynchronized literatures.
In economics, network moments play an increasingly important role in empirical research
as well. Examples include Jackson et al. (2012), who explore, theoretically and empirically,
how different triad configurations can support infrequent favor exchange between agents;
Atalay et al. (2011), who calibrate a model of buyer-seller networks to the US economy by
modeling its degree distribution12 ; and de Paula et al. (2018), who present conditions under
which (a variant of) network moments (partially) identify preferences in a structural model
of strategic network formation.
Network moments, in addition to being important summary statistics for graphs, play an
important role in (i) the distribution theory for dyadic regression discussed in Sections 4
and 5, (ii) understanding the degree distribution and (iii) structural model estimation. The
material which follows is dense.


Subgraphs and isomorphisms

The exact sense in which a network is summarized by its moments can be made precise using
the graphon, as introduced above, and the notion of a graph limit, which will be introduced
below (Diaconis & Janson, 2008; Lovász, 2012). First we require a formal definition of a
subgraph. There are two definitions used by empirical network researchers.

Definition 2. (Partial Subgraph) Let V (S )  V (G) be any subset of the vertices of G
and E (S )  E (G)  V (S ) × V (S ), then S = (V (S ) , E (S )) is a partial subgraph of G.

A partial subgraph S of G consists of a subset of agents in G and a subset of all edges among
V (S ) also appearing in G. Counts of partial subgraphs are often referred to as network motif
counts (e.g., Milo et al., 2002), although this terminology is not used consistently. The two
star motif S =      is a partial subgraph of G = . Note that in this example S does not
include the edge between agents, numbered clockwise from the top, 2 and 3.

Definition 3. (Induced Subgraph) Let V (S )  V (G) be any subset of the vertices of G
and E (S ) = E (G)  V (S ) × V (S ), then S = (V (S ) , E (S )) is an induced subgraph of G.
  12
       Below I show that network moments and moments of the degree distribution are closely connected.


                                                     24
An induced subgraph S includes all edges in G connecting any two agents in V (S ). Although
S =      is a partial subgraph of G =       , it is not an induced one. Counts of induced
subgraphs are often referred to as graphlet counts (e.g., Przulj et al., 2004), although again
not consistently so.
Consider two graphs, R and S , of the same order. Let  : V (R)  V (S ) be a bijection
from the nodes of R to those of S . The bijection  : V (R)  V (S ) maintains adjacency
if for every dyad i, j  V (R) if (i, j )  E (R), then ( (i) ,  (j ))  E (S ); it maintains non-
adjacency if for every dyad i, j  V (R) if (i, j ) / E (R), then ( (i) ,  (j ))  / E (S ). If the
bijection maintains both adjacency and non-adjacency we say it maintains structure.

Definition 4. (Graph Isomorphism) The graphs R and S are isomorphic if there exists
a structure-maintaining bijection  : V (R)  V (S ).

In what follows I use the notation R = S to denote that "R is isomorphic to S ."
Two special families of motifs/graphlets will play a prominent role in the analysis of network
summary statistics presented in Section 7 below. First, a p-cycle is pth order graphlet with
nodes labeled (or relabeled) such that its edges form a cycle:

                            E (S ) = {(i1 , i2 ) , (i2 , i3 ) , . . . , (ip , i1 )} .

A p-cycle is a connected graphlet with p edges on p nodes. As one transverses a p-cycle
graphlet no vertex is crossed more than once except for the first/last one. Important examples
of p-cycles are triangles (S = ) and 4-cycles (S = ).
Second, a tree is a connected graph with no cycles. The number of edges on a pth order
tree is p - 1; a feature which will prove highly convenient. Important examples of trees are
p-star graphlets, such as two-stars (S = ) and three-stars (S = ). Trees will feature in
the analysis of the degree distribution given below. Trees are also called connected acyclic
graphs.


Induced subgraph density

Using Definitions 3 and 4 we can formally introduce the induced subgraph density. This will
be our first measure of the frequency with which a specific low-order local configuration of
links appears within a network. Let S be a pth -order graphlet of interest (e.g., S =          or
S = ), iso (S ) the group of isomorphisms of S , and |iso (S )| its cardinality. It is helpful to
observe that |iso (S )| equals the number of (partial) subgraphs of Kp that are isomorphic to
S . For example, |iso ( )| = 3 since there are three ways to draw a two-star configuration
on three vertices. GN is the real world network under study.

                                                      25
Let ip  {1, 2, . . . , N } be a set of p integers. If we require that i1 < i2 < · · · < ip , then there
are N p
         such integer sets; denote this set of integer sets by Cp,N . If all that is required is that
ik = il for k = l, then there are (N N     !
                                         -K )!
                                               such integer sets; denote this set of integer sets by
Ap,N .
Let the vertex set of S be {1, . . . , p}. Let G [ip ] denote the induced subgraph of G associated
with vertex set ip . Since we wish to compare S and G [ip ] it will be convenient to relabel
the latter. Let G  ~ [ip ] be a relabelling of G [ip ] such that i1 = 1, i2 = 2, . . . , ip = p so that
kl  E G  ~ [ip ] if ik il  E (G [ip ]). Let ip  Uniform(Ap,N ); the frequency with which G       ~ N [ip ]
equals S is then
                                  def
                          PN (S )  Pr S = G    ~ N [ip ] , ip  Uniform(Ap,N ).                       (9)

Call (9) the induced subgraph density of S in GN . Alternatively we can write

                                      Pr (S  = GN [ip ])
                          PN (S ) =                      , ip  Uniform(Cp,N )                               (10)
                                          |iso (S )|

The induced subgraph frequency of S in GN equals the fraction of injective mappings  :
V (S )  V (GN ) that preserve both edge adjacency and non-adjacency. Direct computation
of this fraction yields the equalities

                                             N!                       ~ N [ip ]
                            PN (S ) =                             1 S=G                                     (11)
                                           (N - p)! i
                                                       p Ap,N

                                                  1
                                      =                                 1 (S = GN [ip ])
                                            N
                                            p
                                                |iso (S )| ip C
                                                                  p,N

                                     def
                                      tind (S, GN )

In order to understand the mechanics of computing (11) it is useful to reformulate, one again,
its definition. Let D[ip ,ip ] be the p × p sub-adjacency matrix constructed by removing all rows
and columns of D except those in ip = {i1 , . . . , ip } . We can check for whether G [ip ] is an
isomorphism of S by inspecting the elements of the D[ip ,ip ] sub-adjacency matrix.
Consider the two star triad S =            , we can express 1 (S = GN [ip ]) in terms of D[i ,i ] as  p p




 1(    = GN [ip ]) = Di1 i2 Di1 i3 (1 - Di2 i3 )+ Di1 i2 (1 - Di1 i3 ) Di2 i3 +(1 - Di1 i2 ) Di1 i3 Di2 i3 . (12)

We have |iso ( )| = 3 with the three terms to the right of the equality in (12) equal to
indicators for these three possible isomorphisms (on triad/vertex set {i1 , i2 , i3 }). In general
1 (S = GN [ip ]) may be defined in terms of D[ip ,ip ] with the number of components equal
to the number of possible isomorphisms of S . There is only one isomorphism of the

                                                        26
configuration, yielding a second example of

                                   1(     = GN [ip ]) = Di1 i2 Di1 i3 Di2 i3 .

Recognizing that tind (S, GN ) is a functional of the adjacency matrix of GN allows us to
easily compute its expectation when edges form according to the conditional edge indepen-
dence model (8). Once again consider the two star configuration; iterated expectations and
conditional independence of edges given U = (U1 , . . . , UN ) yield

             E [Di1 i2 Di1 i3 (1 - Di2 i3 )] = E [E [ Di1 i2 Di1 i3 (1 - Di2 i3 )| U]]
                                            = E [h (Ui1 , Ui2 ) h (Ui1 , Ui3 ) [1 - h (Ui2 , Ui3 )]]

                                            =                 h (t, u) h (t, v ) [1 - h (u, v )] dtdudv

(and also that the value of E [Di1 i2 Di1 i3 (1 - Di2 i3 )] is invariant to permutations of its indices).
Finally we have, recalling that |iso ( )| = 3,

             E [1 (     = GN [ip ])] = 3 ·                  h (t, u) h (t, v ) [1 - h (u, v )] dtdudv,

for ip  Uniform(Cp,N ). For a generic graphlet configuration we have

                E [tind (S, GN )] = |iso (S )|-1 E [1 (S = GN [ip ])]                                       (13)
                                                                                                       
                                                                                                         
                                   = E                    h (Ui , Uj )                 [1 - h (Ui , Uj )]
                                           {i,j }E (S )                  {i,j }E (S
                                                                                  ¯)

                                   def
                                     P (S )

where G¯ denotes the complement of the graph G: the graph defined on the same nodes as
                                                                                       ¯
G with an edge present if, and only if, it is not present in G. The graph sum of G and G
therefore coincides with the complete graph K|V (G)| .
Call the expectation of tind (S, GN ) the induced subgraph density of S in the graphon h (·)
and write it as, in an abuse of notation, E [tind (S, GN )] = tind (S, h) = P (S ). Clearly PN (S )
is an unbiased estimate of tind (S, h) = P (S ) when the true network generating process is of
the CID type. Notice how the graphon provides a language for connecting empirical graphlet
counts, first studied by Holland & Leinhardt (1970), with well-defined probabilistic objects.
This connection will prove useful for developing a procedure for conducting inference on P (S )
using the sample graph GN . Since P (S ) generally varies with the graphon h (u, v ), the idea

                                                           27
is that by identifying P (S ) for enough specific configurations (e.g., S =                         ,   ,   ,   etc.),
we may be able to identify h (u, v ) itself (cf., Bickel et al., 2011).


Injective homomorphism density

A second notion of subgraph density also appears in some of the results which follow. Let
S  G denote that S is a partial subgraph of G. Using Definitions 2 and 4, we can also
define what I will call, following Lovász (2012), the injective homomorphism density.13 The
homomorphism density gives the probability that a (partial) subgraph of GN [ip ], for ip chosen
uniformly at random from Ap,N , is equal to S . Alternatively the homomorphism density
equals the fraction of injective mappings  : V (S )  V (GN ) that preserve edge adjacency.
These mappings do not need to preserve non-adjacency.14 The injective homomorphism
density of S in GN equals

                                       1
                   QN (S ) =                             1 (R  GN )                                              (14)
                                 N
                                 p
                                     |iso (S )| RKN ,R=S
                                       1
                           =                                        1 (R = S)                 Dij
                                 N
                                     |iso (S )| RK
                                 p                   N ,|V (R)|=p               {i,j }E (R)
                           def
                             tinj (S, GN )

The two equivalent definitions are given to develop familiarity with notation. To un-
derstand expression (14) it is helpful to calculate the injective homomorphism density of
S=        in GN = . There are three isomorphisms of the two star configuration such that
 4
 3
    |iso ( )| = 4 · 3 = 12. Next consider the summation in the first line of (14). This sum-
mation is over all 3rd order partial subgraphs of K4 which are isomorphic to S = . There
are exactly 12 two star partial subgraphs in K4 (three for each of its four triads), a total
                                                                            8
of 8 of these configurations are subgraphs of GN such that tinj ( , ) = 12    . Note that the
                                                          2
induced subgraph density of S =        in GN =    is just 12 .
  13
     The Lovász (2012) monograph presents several different notions of a subgraph density. The two in-
troduced here were chosen for their connection to actual empirical practice. See also Diaconis & Janson
(2008).
  14
     In contrast the induced subgraph density requires preservation of both adjacency and non-adjacency.




                                                      28
Under an Aldous-Hoover GGP we have
                                                                                                                  
                               1
  E [tinj (S, GN )] =                                             1 (R = S ) E E                  Dij U1 , . . . , UN 
                        N
                             |iso (S )| RK
                        p                       N , |V   (R)|=p                     {i,j }E (R)
                                                          

                  = E                      h (Ui , Uj )
                            {i,j }E (S )
                  def
                    Q (S ) .

Call the expectation of tinj (S, GN ) the injective homomorphism density of S in the graphon
h (·) and write it as E [tinj (S, GN )] = tinj (S, h) = Q (S ).


3.6    Graph limits
Let GN be a finite exchangeable graph with adjacency matrix D. Let
                                          
                                           1                 if ( uN , vN )  E (GN )
                        hGN     (u, v ) =                                                     .
                                           0                           otherwise

Observe that hGN (u, v ) is a valid graphon and further that

                                            tind (S, GN ) = tind (S, hGN )

for any S of order K  N (Chatterjee, 2017, p. 28). This equality connects the definition
of the induced subgraph frequency of S in GN , denoted by PN (S ) in equation (11), with its
"population" counterpart ­ equation (13). It also motivates the idea of the graphon as the
appropriate limit object for a sequence of graphs, GN . If the subgraph frequency

                                                    lim tind (S, hGN )
                                                  N 


converges to some limit for all fixed subgraphs S , then we say that GN has a limit. Lovász
& Szegedy (2006) showed the natural limiting object is a graphon (i.e, heuristically, hGN 
h as N  ). Diaconis & Janson (2008) connect this finding with the Aldous-Hoover
representation theorem. Collectively these results motivate an approach to summarizing a
network by the frequency of different low order subgraph configurations within it; by its
average local structure. Lovász (2012) provides a rigorous and compresensive introduction
to theory of graph limits.


                                                                  29
3.7    Sampling
In this chapter I will adopt two perspectives on "sampling". In the first we view the network
in hand as the one induced by a random sample of agents from some large (i.e., infinite)
population. Let G be an (infinite) exchangeable random graph. Let V be a random sample
of agents of size N from G . We assume that the observed network, GN , coincides with the
subgraph induced by this random sample of vertices:

                                          GN = G [V ] .                                        (15)

Let D = [Dij ] with i, j  1 be the adjacency matrix of G . Exchangeability implies the
characterization
                             Dij = 1 (h (, Ui , Uj )  Vij )                       (16)

with , Ui and Vij = Vji independent U [0, 1] random variables (cf., Aldous, 1981; Hoover,
1979). Here h : [0, 1]3  [0, 1] is symmetric in its second and third arguments.
Under (15) the elements of D, the adjacency matrix for the network in hand, also obey
the characterization (16). The "sampling distribution" of some statistic of D, say tN (D), is
simply the one induced by repeated random sampling from the underlying infinite population.
We calculate limit distributions by studying the sampling distribution of tN (D) as N  .
An advantage of this first perspective it that is allows the econometrician to fully exploit
the independence/dependence structure associated with the Aldous-Hoover Theorem. If
the graph in hand is the one induced by a random sample of agents from some infinite
exchangeable population, then we can proceed "as if"

                                Dij | Ui , Uj  Bernoulli (h (Ui , Uj ))                        (17)

for i = 1, . . . , N - 1 and j = i + 1, . . . , N . Although (17) is a nonparametric data generating
process, it is a structured one. We can use this structure to our advantage.
An unattractive feature of this perspective is that if the density of the population graph is
very low, then that of the sampled graph may be zero with high probability. To see this
point heuristically assume that the population consists of N  agents, with N  very large.
Assume that average degree, , is some small positive constant that does not dependent on
N  . The probability of observing an edge between the two independent random draws from
the population is thus
                                                1
                                                  N        
                                Pr (D12 = 1) = N    .
                                                2

                                                  2
                                                          N


                                                 30
Boole's inequality then gives a probability of observing at least one edge in our sampled
                                 
                                                                               
network no greater than N  2
                             /N    , which  will be  close to zero when N <<    N  . When
the population graph is "sparse", it is quite likely that the subgraph induced by a random
sample of agents from it will be empty and hence completely uninformative. See Crane
(2018, Chapter 3) for more discussion and examples.
This example raises two questions. First, how does one sample from a large sparse graph in
practice? I ignore this question here, but flag it as an interesting one which merits thought.
The monograph by Crane (2018) surveys extant work in this area. Second, if the sampling
is fictitious (i.e., analysis is based upon the full graph), what mistakes might be made by
proceeding "as if" we had randomly sampled from some (now entirely hypothetical) large
graph?
To answer the second question is useful to return to an empirical example. Atalay et al. (2011)
study the supply chain network of large publicly traded firms in the United States. Their
network is not sampled, but rather constructed from Securities and Exchange Commission
(SEC) reports filed by the entire universe of publically trade firms. If the model of network
formation of interest is a conditional independent dyad (CID) one, then we are free to
proceed "as if" the observed network were generated according to (17). If, instead, we
view the network in hand as, for example, an equilibrium of a finite N -player supply chain
formation game, then it may be difficult to justify (17); strategic interaction may induce
dependence across links that cannot be conditioned away. We cannot appeal directly to the
Aldous-Hoover Theorem.
As in de Finetti (1931), the Aldous-Hoover Theorem requires that the agent indices constitute
an infinite sequence. However, just as the de Finetti result fails for finite sequences (e.g.,
Diaconis, 1977), but approximately holds when the sequence is large enough (e.g., Diaconis
& Freedman, 1980), the hope is that in large (but finite) networks Theorem 1 remains useful
(cf., Volfosky & Airoldi, 2016).
One possibility would be to assume that N is large enough such that a representation like (17)
"approximately" holds. One could then conduct inference on model parameters by comparing
observed network moments with model generated ones. The sampling distribution of the
observed network moments would be calculated assuming an Aldous-Hoover DGP (which is
appropriate for N large enough). I sketch this idea in a bit more detail in Section 8 below.
Many gaps in this discussion remain. Alternatively we could proceed along the lines of
Menzel (2016). In this approach we would approximate our finite player network formation
game, with a limit game which is easier to deal with (see Section 8).




                                              31
3.8    Adding sparsity: the Bickel & Chen (2009) model
For any finite network of unlabelled agents, exchangeability is a natural, indeed unavoidable,
modeling assumption. Unfortunately its extension to infinite exchangeability, as needed for
Theorem 1, has the unattractive implication that the network is either empty or dense in the
limit. Specifically a (random) agent will either never form links or do so infinitely often as
N  . Denseness and sparseness are limit properties of infinite sequences of graphs. Any
empirical network is neither "dense" nor "sparse", it just is what it is. However, in most real
world networks the numbers of agents and links are of similar magnitudes. This suggests
that approximation results based on sequences of graphs that are sparse in the limit may be
more useful than those with dense limits. Whether this is, in fact, the case remains an open
question (Green & Shalizi, 2017).
One way to model sequences of graphs with sparse limits, while still preserving the ana-
lytic convenience of conditional independence across edges, was proposed by Bickel & Chen
(2009). The Bickel-Chen model is the default one in the nonparametric statistics and ma-
chine learning literatures on random graphs.
Let GN be a random network of order N generated according to (8). The expected average
number of links an agent has in this network, that is average degree, equals

                                         N = (N - 1)                                       (18)

for  = h (, u, v ) dudv . Average degree (18) either tends toward infinity or is zero,
depending on whether  is greater than or equal to zero.
To extend model (8) so that it can accommodate sparse graph sequences Bickel & Chen
(2009) define the conditional density

                           w (u, v ) = f Ui ,Uj |Dij , ( u, v | Dij = 1, ) .

Next observe that since f Ui ,Uj | ( u, v | ) = 1 on [0, 1]2 we get can decompose the graphon as

                                    h (, u, v ) =  w (u, v ) .                             (19)

With this parameterization, Bickel & Chen (2009) and Bickel et al. (2011) argue that it is
natural to let  = ,N , but retain independence of w (u, v ) from N . Suppressing the 
argument (it is never identifiable), they write

                    Pr ( Dij = 1| Ui = u, Uj = v ) = hN (u, v ) = N w (u, v ) .            (20)


                                                  32
The rate at which N  0 then controls the rate of average degree growth as N grows
large. If N = (N - 1) N   with 0 <  <  as N  , then the graph is sparse.
If N =  (N ) we say the graph is dense, N =  (ln N ) semi-dense etc. Many of the
results presented below require that N =  (N  ) for some 0 <   1, despite the fact that
N =  (1) might best describe real world networks (where average degree is generally low
even when N is very large). In what follows I will try to highlight those few known results
which can accommodate sparse graph sequences.


3.9     Further reading
Orbanz & Roy (2015) provide a non-technical introduction to the probability literature
on exchangeable random arrays; the monograph by Kallenberg (2005) a more complete
development. Crane (2018) also surveys this material, at a fairly accessible level, and with
a somewhat contrarian point of view.
Lovász (2012) provides an overview of the theory of graph limits. Diaconis & Janson (2008)
connect much of this theory to the older literature on exchangeable random arrays.


4      Dyadic regression
Jan Tinbergen's 1962 report Shaping the World Economy, commissioned by Twenty Century
Fund, featured, along with its sculptural title, a remarkable empirical analysis of trade flows
(Tinbergen, 1962). Table VI-1 in that report presented the results of a least squares fit of the
logarithm of exports from country i to country j onto a constant, the (log) Gross National
Product (GNP) of both countries i and j , the (log) distance between i and j , and a variety
of other covariates capturing different relationships between i and j . Tinbergen's (1962)
analysis was based upon a sample of N = 18 countries, or N (N - 1) = 306 directed trading
relationships.15
Table VI-1 of Tinbergen (1962) presents the results of what I will call a dyadic regression
analysis. This particular analysis continues to serve as prototype for a substantial body
of empirical work in international trade (Anderson, 2011). Dyadic regression analyses also
appear in other areas of social science research. They have been used, to give just a few
recent examples, to study the onset of war among nation states (e.g., Russett & Oneal, 2001),
risk-sharing across households (e.g., De Weerdt, 2004; Fafchamps & Gubert, 2007; Attanasio
et al., 2012), supply chain linkages across firms (e.g., Atalay et al., 2011, Table S3), the
  15
    A second analysis, based upon a larger sample of countries, was also reported upon in Table VI-4 of the
report.


                                                    33
formation of commercial R&D collaborations (König et al., 2019, Table 4), and co-camping
behavior among hunter-gathers (Apicella et al., 2012, Tables S2 to S49).
Familiar methods of econometric analysis appropriate for single agent models, typically uti-
lizing a random sample from the population of interest, are ill-suited for dyadic settings
(cf., Cameron & Golotvina, 2005). Consequently, considerable confusion and controversy is
associated with dyadic analyses in practice (e.g., Erikson et al., 2014). It is remarkable that,
over a half-century after Tinbergen's (1962) pioneering analysis of trade flows across coun-
tries, and also given the considerable empirical work that has followed, a textbook treatment
of estimation and inference methods for gravity and other dyadic regression models remains
unavailable.


4.1    Population and sampling framework
Let i  N index agents in an infinite population of interest. Associated with each agent is
the observable attribute Xi  X = {x1 , . . . , xL }. This attribute partitions the population
into L = |X| subpopulations which I will refer to as "types". Let N (x) = {i : Xi = xl }
be the index set for type l agents. Although L may be very large, I assume that the size
of each subpopulation, |N (x)|, is infinite with positive frequency (i.e., Pr (Xi = xl ) > 0 for
l = 1, . . . , L).
When all observable agent attributes are discretely-valued, then X simply enumerates all
distinct combinations of these attributes (e.g., X = xl might correspond to a Hispanic
female, living in the Florida, with 12 years of schooling and two college-educated parents).
More heuristically we can think of X as consisting of the support points of a multinomial
approximation to the support of a bundle of attributes, some of which might be continuously-
valued. The finite support restriction is made in order to invoke a representation result due
to Crane & Towsner (2018); I do not think it is essential.
Associated with each ordered pair of agents is the scalar directed outcome Yij  Y  R.
I will refer to agent i as the "ego" of the directed dyad and agent j as its "alter". In the
context of the trade example the ego agent is the exporting country, the alter the importing
one. The adjacency matrix [Yij ]i,j N collects all such outcomes into an infinite random array.
From the standpoint of the econometrician, the indexing of agents within subpopulations
homogenous in Xi is arbitrary: agents of the same type are exchangeable. Exchangeability of
agents within subpopulations homogenous in Xi induces a particular form of exchangeability
on the adjacency matrix. This form of exchangeability, in turn, induces a particular form
of dependence across the rows and columns of [Yij ]i,j N . The structure of this dependence
allows for the formulation of LLNs and CLTs.

                                              34
Let x : N  N be any permutation of a finite number of the agent indices which satisfies
the restriction
                               Xx (i) iN = [Xi ]iN .                              (21)

Condition (21) constrains index permutations to occur among agents of the same type (i.e.,
we may permute the indices in N (x), but not those within, for example, N (x)  N (x )).
Crane & Towsner (2018) call a network relatively exchangeable with respect to X (or X -
exchangeable) if
                                                    D
                                 Yx (i)x (j ) i,j N = [Yij ]i,j N                   (22)

for all permutations x satisfying (21). X -exchangeablility is a natural generalization of
joint exchangeability, as introduced in the context of the Aldous (1981) and Hoover (1979)
Theorem earlier.
A insightful way to think about condition (22) is in terms of vertex colored graphs. Associate
Xi with the color of a vertex; condition (22) states that all colored graph isomorphisms
are equally probable. Since, when vertices of the same color are exchangeable, there is
no reason to attach more or less probability to particular isomorphisms of a given vertex
colored graph, any probability model for [Yij ]i,j N should be consistent with condition (22).
As long as Xi encodes all the vertex-specific information available to the econometrician,
then X -exchangeability is a nature a priori modeling restriction.
Let , {(Ui , Xi )}i1 and {(Vij , Vji )}i1,j 1 be (sequences of ) i.i.d. random variables, ad-
                                                                             
ditionally independent of one another, and consider the random array Yij      i,j N
                                                                                    generated
according to the rule
                                        ~ (, Xi , Xj , Ui , Uj , Vij )
                                Yij  =h                                                  (23)
     ~ : [0, 1] × X × X × [0, 1]3  Y a measurable function (we normalize , Ui and Vij
with h
to have support on the unit interval without loss of generality). Clearly a graph generated
according to (23) is X -exchangeable (cf., Crane, 2018, Chapter 8).
Here  is a mixing parameter analogous to the one appearing in de Finetti's (1931) original
representation theorem. Since this parameter is unidentified, and the focus here is upon
inference conditional on the realized data distribution, I will depress the dependence of h               ~
                                                        def
on , defining the notation h (Xi , Xj , Ui , Uj , Vij )  h  ~ (, Xi , Xj , Ui , Uj , Vij ). Consistent with
earlier terminology, the function h : X × X × [0, 1]3  Y will be referred to as a graphon.
Because doing so is convenient for the discussion of causal inference in dyadic settings which
follows, (23) makes no presumption of independence between Xi and Ui . Of course we can




                                                    35
always write

                      
                    Yij = h Xi , Xj , F U1 |X1 ( Ui | Xi ) , F U1 |X1 ( Uj | Xj ) , Vij
                        def
                         h Xi , Xj , Ui , Uj , Vij

with Ui = F U1 |X1 ( Ui | Xi ) equal to unit i's rank among all those units of her type. The
resulting {Ui }i1 sequence of 0-to-1 uniform random variables is independent of {Xi }i1 by
construction (cf., Graham et al., 2010).
Depending on the context, it is fine to work with either h or h , but, as explained below, the
former is more useful for making causal arguments; hence I allow for dependence between
the observed covariate vector Xi and the unobserved unit-specific effect Ui in what follows
(akin to a correlated random effects panel data analysis). The nuances involved will become
clear as we proceed.
Networks generated by (23) exhibit a very particular pattern of dependence across the rows
and columns of [Yij ]i,j N . Consider, without loss of generality, agents 1, 2, 3 and 4. The
outcomes Y12 and Y34 are independent of one another; the outcomes Y12 and Y13 are, however,
dependent. These two outcomes share agent 1 in common; the value of X1 and U1 influences
both Y12 and Y13 , inducing dependence. But conditional on (X1 , X2 , X3 ) and (U1 , U2 , U3 ),
Y12 and Y13 are independent; if we condition on the observed covariates (X1 , X2 , X2 ) alone,
however, they remain dependent. Finally Y12 and Y21 are dependent, this dependence holds
even conditional on (X1 , X2 ) and (U1 , U2 ) because V12 and V21 may covary.
In words we have independence across dyads sharing no agents in common (exports from
Japan to the United States and from Turkey to Germany), dependence across those sharing
at least one agent in common (exports from Japan to the United States and from Japan
to the United Kingdom), and "even more" dependence across dyads sharing both agents in
common (e.g., exports from Japan to the United States and vice-versa).
Models with this type of dependence structure, as already noted, are called conditionally
independent dyad (CID) models. The "conditionally independent" terminology reflects the
fact that the outcomes Y12 and Y13 , associated with a pair of dyads sharing one agent
in common, can be rendered independent of one another by conditioning on the observed
covariates (X1 , X2 , X2 ) as well as the unobserved latent attributes (U1 , U2 , U3 ).
Crane & Towsner (2018), in an extension of the Aldous-Hoover representation result de-
scribed earlier, show that for any X -exchangeable random array [Yij ]i,j N there exists an-
                
other array Yij   i,j N
                        generated according to (23) such that the two arrays have the same



                                                    36
distribution:
                                                     D    
                                          [Yij ]i,j N = Yij   i,j N
                                                                       .                                  (24)

We can therefore use (23) as an `as if' non-parametric data generating process for [Yij ]i,j N ;
this will facilitate a variety of probabilistic calculations (e.g., computing conditional expec-
tations, variances and, especially, covariances).
Let i = 1, . . . , N index a simple random sample from the target population. For each of the
N sampled units the econometrician observes Xi and for each of the N     2
                                                                           sampled dyads she
observes (Yij , Yji ). From hereon I will assume that Yii is undefined (normalized to zero for
convenience). Adapting what follows to accommodate self-loops is straightforward.


4.2     Composite likelihood
Let f Y12 |X1 ,X2 ( Y12 | X1 , X2 ; ) :     Rdim() be a parametric family of distributions for
the conditional distribution of Y12 given X1 and X2 . For example, Santos Silva & Tenreyro
(2006) model trade from exporter i to importer j given covariates as a Poisson random
variable:                                                                       y
                                                                             
                                                                  
                                                                     exp Wij    ij
                  f Y12 |X1 ,X2 ( yij | Xi , Xj ; ) = exp - exp Wij                      (25)
                                                                         yij !
                                   def
with yij = 0, 1, 2, . . . and Wij  w (Xi , Xj ) a known J × 1 vector of functions of Xi and Xj .
As an example, if Xi = (ln GDPi , LATi , LONGi ) , then setting
                                                                                         
                                                       ln GDPi
                                                                                         
                      Wij =                            ln GDPj                           
                                                                                   1/2
                                  ln (LATi - LATj )2 + (LONGi - LONGj )2

results in a basic gravity trade model specification.16
Similar to Russett & Oneal (2001), a researcher might model the conditional probability that
country i attacks country j using logistic regression such that

                                                                 yij                     1-yij
                   f Y12 |X1 ,X2 ( yij | Xi , Xj ; ) = F Wij               1 - F Wij                      (26)

                                                  
with yij = 0, 1 and F Wij  = exp Wij  / 1 + exp Wij  .
An important feature of both (25) and (26) is that they only specify the marginal distribution
  16
    In practice distance is measured using the so-called great circle formula; which accounts for the curvature
of the Earth's surface.




                                                      37
of Yij given Xi and Xj . The econometrician is not asserting, for example, that

f Y12 ,Y13 |X1 ,X2 ,X3 ( y12 , y13 | X1 , X2 , X3 ; ) = f Y12 |X1 ,X2 ( y12 | X1 , X2 ; ) f Y12 |X1 ,X2 ( y13 | X1 , X3 ; ) ,

since doing so would imply independence of Y12 and Y13 given covariates; but such dependence
is precisely the complication under consideration. Formulating a conditional likelihood for
                                        def                          def
the entire adjacency matrix Y  [Yij ]1i,j N,i=j given X  [Xi ]1iN would require an
explicit specification of the dependence structure across dyads sharing agents in common.
In contrast f Y12 |X1 ,X2 ( Y12 | X1 , X2 ; ), which is a model for the marginal distribution of Y12
alone, does not require modeling this dependence.
Let lij () = ln f Y |X ,X ( Yij | Xi , Xj ; ) and consider the estimator which chooses    ^ to max-
                       12   1   2

imize:
                                                                      N
                                    ^ = arg max          1
                                                                                lij () .                               (27)
                                                     N (N - 1)       i=1 j =i

Because its summands are not independent of one another ­ at least those sharing indices
in common are not ­ (27) does not correspond to a log-likelihood function for Y given X.
Instead it corresponds to what is sometimes called a composite log-likelihood (e.g., Lindsey,
1988; Cox & Reid, 2004). A composite likelihood "is an inference function derived by multi-
plying a collection of component likelihoods" (Varin et al., 2011, p. 5). Although (27) fails
to correctly represent the dependence structure across the elements of the adjacency matrix,
if it is based upon a correctly specified marginal density,  ^ generally will be consistent for
0 . This follows because the derivative of composite log-likelihood is mean zero at  = 0
under correct specification of its components. While an appropriately specified composite
log-likelihood typically delivers a valid estimating equation, accurate inference is more chal-
lenging, since the unmodeled dependence structure in the data does need to be explicitly
taken into account at the inference stage.


4.3      Limit distribution
Consider a mean value expansion of the first order condition associated with the maximizer
of (27).17 Such an expansion yields, after some re-arrangement,
                                                                          +   
                                    N ^ - 0 = -HN ¯                           N SN (0 )

  17
    A general result on consistency of ^ could be constructed by adapting the results of Honoré & Powell
(1994).




                                                            38
with ¯ a mean value between ^ and 0 which may vary from row to row and the + superscript
denoting a Moore-Penrose inverse. Here SN (0 ) is the "score" vector

                                               1 1
                                 SN () =                                       sij (Zij , )               (28)
                                               N N -1         i       j =i


                                                                                                    2 l ()
with s (Zij , ) = lij () / for Zij = Yij , Xi , Xj
                                                 
                                                   and HN () = N  1 1
                                                                    N -1  i
                                                                                   ij
                                                                              j =i   . If
the Hessian matrix HN     ¯ converges in probability to the invertible matrix 0 , as I will
assume, then
                                                
                           N  ^ - 0 = --1 N SN (0 ) + op (1)
                                            0

                                                             
so that the asymptotic sampling properties of                N ^ - 0 will be driven by the behavior
   
of N SN (0 ).
                                                                          
As with the composite log-likelihood criterion function, the summands of N SN (0 ) are not
independent of one another (cf., Cameron & Golotvina, 2005; Fafchamps & Gubert, 2007).
A standard central limit theorem cannot be used to demonstrate asymptotic normality of

  N SN (0 ). Fortunately SN (0 ), although not a U-Statistic, has a dependence structure
                                                                          
similar to one. This insight can be used to derive the limit properties of N ^ - 0 .

Begin by re-writing SN (0 ) as

                                                      N -1        N
                                               N -1                 sij + sji
                                     SN =      2
                                                                              ,                           (29)
                                                      i=1    j =i+1
                                                                        2

            def                          def
where sij  s (Zij , 0 ) and SN  SN (0 ) . While (29) has the cursory appearance of a
U-Statistic it is, in fact not one: Yij , which enters sij , varies at the dyad level, hence SN is
not a function of N i.i.d. random variables.
Let U = [Ui ]1iN ; the projection of SN onto the observed covariate matrix X and the
unobserved vector of unit-specific effects U equals:

                                   def                            N -1               s
                                                                                     ¯ij + s
                                                                                           ¯ji
                              VN  E [ SN | X, U] =                2
                                                                                                          (30)
                                                                               i<j
                                                                                         2

          def                                                            def
with s¯ij  s                            ¯ (Xi , Ui , Xj , Uj )  E [ s (Zij , 0 )| Xi , Ui , Xj , Uj ] . The ex-
             ¯ (Xi , Ui , Xj , Uj ) and s
pression to the right of the equality in (30) follows from the Crane & Towsner (2018) repre-
sentation (23) and independence of Vij from (X, U).
An important observation is that the projection (30) is a U-statistic of order two: specif-
ically it is a summation over all N2
                                      dyads that can be formed from the i.i.d. sample

                                                       39
{(Xi , Ui )}1iN . Unusually our U-statistic is defined in terms of a combination of both
observed {Xi }1iN and unobserved {Ui }1iN random variables.
The projection error TN = SN - VN consists of a summation of N            2
                                                                            conditionally uncorre-
                                       N -1
lated summands; hence V (TN ) = 2           E V   s12 +s21
                                                      2
                                                           X1 , U1 , X2 , U2 = O (N -2 ) (as long
as V s12 +
         2
           s21
               X1 , U1 , X2 , U2 does not change as N  ). We also have that TN and VN
are uncorrelated by construction.
Although we cannot numerically compute VN ­ even if 0 is known ­ because the {Ui }1iN
are unobserved, we can use the theory of U-statistics to characterize its sampling properties
as N  . Decomposing VN into a Hájek projection and a second remainder term yields
(e.g., Lehmann, 1999; van der Vaart, 2000):

                                                  VN = V1N + V2N

                ¯e (x, u) = E [¯
where, defining s                                      ¯a (x, u) = E [¯
                               s (x, u, X1 , U1 )] and s              s (X1 , U1 , x, u)],

                              N
                         2             ¯e
                                       s                ¯a
                                         1 (Xi , Ui ) + s 1 ( Xi , U i )
                 V1N   =                                                                                    (31)
                         N   i=1
                                                      2
                         N -1              s
                                           ¯ij + s
                                                 ¯ji
                 V2N =   2
                                    i<j
                                               2
                             ¯e
                             s                  ¯a
                                   (Xi , Ui ) + s 1 ( Xi , U i )                  ¯a
                                                                  ¯e (Xj , Uj ) + s
                                                                  s                 1 (Xj , Uj )
                         -     1
                                                                 - 1                                 .      (32)
                                              2                                 2

The superscript `e' denotes `ego' since it is the ego unit's attributes which are being held
fixed in the average used to compute s¯e (x, u). Similarly the `a' denotes `alter', since it is that
unit's attributes which are held fixed when defining s  ¯a (x, u). Conveniently V1N is a sum of
                                                    
i.i.d. random variables to which, after scaling by N , a CLT may be applied. Furthermore
it can be shown that V (V2N ) = O (N -2 ).
Putting these results together yields the asymptotically linear representation
                                 
                 N ^ - 0 = - -1 N (V1N + V2N + TN ) + op (1)
                             0
                                 
                         = - -
                             0
                               1
                                  N V1N + op (1)
                                                      N
                                         1 2                 ¯e
                                                             s 1 (Xi , Ui ) + s
                                                                              ¯1a
                                                                                  (Xi , Ui )
                                   = - -
                                       0                                                       + op (1) ,
                                           N         i=1
                                                                            2




                                                            40
                                          
and hence a limit distribution for           N ^ - 0 of

                                                                             -1
                                              N 0, 4 0 -
                                      ^ - 0 D            1
                                    N                  1 0                                                      (33)

                  ¯e (X ,U )+¯
                  s          sa (X ,U )
where 1 = V 1 1 1 2 1 1 1 . Although SN is not a U-statistic, under the assumptions
maintained here, its limit distribution coincides with that of VN (which is a U-statistic).
Before turning to practicalities of variance estimation I will present a useful property of
the kernel entering the Hájek Projection, V1N above. By the usual conditional mean zero
property of the score function we have that E [ s (Z12 ; 0 )| X1 = x1 , X2 = x2 ] = 0 as long as
marginal density of Y12 given X1 and X2 is correctly specified. This property can be used to
                        ¯e
show that the averages, s                  ¯a
                          1 (X1 , U1 ) and s 1 (X1 , U1 ), are also conditionally mean zero. Taking
the former we have that

E [s
   ¯e1 (X1 , U1 )| X1 = x1 ] =             ¯ (x1 , u1 , x2 , u2 ) fX1 ,U1 (x2 , u2 ) dx2 du2 f U1 |X1 ( u1 | x1 ) du1
                                           s

                            =              ¯ (x1 , u1 , x2 , u2 ) f U1 |X1 ( u2 | x2 ) fX1 (x2 ) dx2 du2 f U1 |X1 ( u1 | x1 ) du1
                                           s

                            =              ¯ (x1 , u1 , x2 , u2 ) f U1 |X1 ( u1 | x1 ) du1 f U1 |X1 ( u2 | x2 ) du2 fX1 (x2 ) dx2
                                           s

                            =       E [s
                                       ¯ (X1 , U1 , X2 , U2 )| X1 = x1 , X2 = x2 ] fX1 (x2 ) dx2

                            =       E [ s (Z12 ; 0 )| X1 = x1 , X2 = x2 ] fX1 (x2 ) dx2

                            =0

where the first equality follows from the definition of s      ¯e1 (X1 , U1 ), the third from a change in
the order of integration, and the second to last from iterated expectations. These calculations
imply that
                      E [s
                         ¯e1 (X1 , U1 )| X1 , X2 ] = E [ s
                                                         ¯a1 (X1 , U1 )| X1 , X2 ] = 0

and hence that [¯se              ¯a
                  1 (X1 , U1 ) + s 1 (X1 , U1 )] /2 is conditionally mean-zero given X1 and X2 .
This property will be helpful for understanding the asymptotic precision of estimates of
various causal parameters introduced below.




                                                      41
4.4     Variance estimation
In order to conduct inference on the components of 0 , an estimate of the variance of

   N   ^ - 0 is required. Although the distribution theory outlined above is novel18 , the
history of variance estimation for "dyadic statistics" goes back at least to Holland & Lein-
hardt (1976). In economics, a variance estimator first proposed by Fafchamps & Gubert
(2007), is widely ­ although not universally ­ used for dyadic regression analysis. In order
to understand extant approaches to variance estimation, as well as to propose new ones, it
is helpful to examine the structure of SN 's variance in detail.
                                                          
The arguments used to derive the limit distribution of N         ^ - 0 above suggest that it
may be insightful to think about the variance of SN in terms of the ANOVA decomposition

                             V (SN ) = V (E [ SN | X, U]) + E [V ( SN | X, U)]
                                       = V (VN ) + V (TN )
                                       = V (V1N ) + V (V2N ) + V (TN ) ,                                             (34)

where the second and third equalities follow from the decomposition for SN developed in the
previous subsection.
Let p = 1, 2 equal the number of agents dyads {i1 , i2 } and {j1 , j2 } share common and define
the matrix p as

          def      s
                   ¯ (Xi1 , Ui1 , Xi2 , Ui2 ) + s ¯ (Xi2 , Ui2 , Xi1 , Ui1 )
       p  C                                                                  ,                                       (35)
                                              2
          ¯ (Xj1 , Uj1 , Xj2 , Uj2 ) + s
          s                             ¯ (Xj2 , Uj2 , Xj1 , Uj1 )
                                      2
                                                                                                              
                      si1 i2 + si2 i1                                 sj1 j2 + sj2 j1
          =C E                         Xi1 , U i1 , X i 2 , U i2 , E                  Xj1 , Uj1 , Xj2 , Uj2      .
                             2                                               2

When p = 1 we have
                                                                                                       
                             s12 + s21                          s13 + s31
            1 = C E                    X1 , U 1 , X 2 , U 2 , E           X1 , U 1 , X 3 , U 3
                                 2                                  2
                         s12 + s21 s13 + s31
                 =C                ,              ,
                             2         2

with the second equality an implication of conditional independence of s12 + 2
                                                                               s21
                                                                                   and s13 +
                                                                                           2
                                                                                             s31

given (X1 , X2 , X3 ) and (U1 , U2 , U3 ). Hence 1 equals the covariance between any pair of
  18
   See Tabord-Meehan (2018), Davezies et al. (2019) and, especially, Menzel (2017) for related independent
work.


                                                         42
summands in SN ­ see equation (28) above ­ sharing an index in common. There are many
such pairs of summands in SN (actually 12
                                          N (N - 1) (N - 2) such pairs-of-dyads). It is the
preponderance of these non-zero covariances that drives their importance for understanding
                            
the sampling distribution of N    ^ - 0 .

In a slight abuse of notation, additionally define the matrix

                                 def          s12 + s21
                             3  E V                     X1 , U 1 , X 2 , U 2   .                      (36)
                                                  2

Calculations analogous to those use in variance analyses for U-statistics (e.g., Hoeffding,
1948; Lehmann, 1999) yield

                                               41
                                  V (V1N ) =                                                          (37)
                                                N
                                                 2
                                  V (V2N ) =           (2 - 21 )                                      (38)
                                             N (N - 1)
                                                 2
                                   V (TN ) =           3 ,                                            (39)
                                             N (N - 1)

                                        def      
such that, defining the notation   V                N SN , from (34), (37), (38) and (39):

                                                 2
                                 = 41 +             (2 + 3 - 21 ) .                                   (40)
                                               N -1

Consistent with the form of the limit distribution given in (33), the variances of V2N and TN
                                                                                                  
are of smaller order. Although the contribution of these terms to the variance of N SN is
asymptotically negligible, their contribution for finite N need not be. As alluded to earlier,
the appearance of the covariance 1 as the leading term in (40) reflects the large number
of non-zero covariance terms that arise when the variance operator is applied to the sum
            -1  N -1    N      sij +sji
SN = N    2     i=1     j =i+1     2
                                        . In practice, especially if h (x1 , x2 , u1 , u2 , v12 ) is nearly
constant in u1 and u2 , 1 may be small in magnitude. In such cases it may be that 41 and
  2
N -1
     (2 + 3 - 21 ) are of comparable magnitude for modest N . Using a variance estimator
which includes estimates of both these terms may therefore result in tests with better size
and power properties (cf., Hoeffding, 1948; Graham et al., 2014; Cattaneo et al., 2014). To
construct such an estimator I propose using analog estimates of the terms appearing to the
right of the equality in (40).




                                                     43
A benchmark analog variance estimate

A natural analog estimate of 1 , the leading variance term, is

                              N -2 N -1      N                                              
                ^1 =   N -1                       1                ^ji
                                                             ^ij + s
                                                             s                 s
                                                                               ^ik + s
                                                                                     ^ki
                       3
                              i=1   j =i+1 k=j +1
                                                  3              2                 2
                                                                                                      
                        s
                        ^ij + s
                              ^ji         s
                                          ^jk + s
                                                ^kj                s
                                                                   ^ik + s
                                                                         ^ki         s
                                                                                     ^jk + s
                                                                                           ^kj
                                                             +                                           ,       (41)
                            2                 2                        2                 2

         def
with s ^ij  s Zij ,    ^ . Equation (41) is a summation over all N = 1 N (N - 1) (N - 3)
                                                                        3    6
triads in the dataset. Each triad ijk can be further divided into three pairs of dyads,
{ij, ik }, {ij, jk } and {ik, jk }, with each such pair sharing exactly one agent in common.
Equation (41) corresponds to the sample covariance of (^   sij + s
                                                                 ^ji ) /2 and (^
                                                                               sik + s
                                                                                     ^ki ) /2 across
these 3 N  3
              pairs of dyads.
                                     
To construct an estimate of V          N SN separate estimates of 2 and 3 are not required,
only their sum is needed. Using an ANOVA decomposition we can express this sum as

                         s12 + s21                                              s12 + s21
     2 + 3 = V E                   X1 , U 1 , X 2 , U 2            +E V                   X1 , U 1 , X 2 , U 2
                             2                                                      2
                     s12 + s21
               =V                .
                         2

This suggests the analog estimate

                                             N -1     N                                        
                                      N -1                       s
                                                                 ^ij + s
                                                                       ^ji      s
                                                                                ^ij + s
                                                                                      ^ji
                     2 + 3 =          2
                                                                                                  .              (42)
                                             i=1 j =i+1
                                                                     2              2


From (40), (41) and (42) we get the variance estimate
                                                                                -1
                                 ^
                                 V        N ^ - 0              = ^ ^ -1 ^                                        (43)

where

                                ^ =HN 
                                      ^                                                                          (44)
                                                   2
                               ^ =4
                                   ^1 +               2 + 3 - 2^1 .                                              (45)
                                                 N -1




                                                          44
Fafchamps & Gubert (2007) variance estimate

Just over a decade ago, Fafchamps & Gubert (2007) presented a variance-covariance esti-
mator for ^ that they informally argued leads to asymptotically correct inference.19 They
                                   
proposed estimating the variance of N SN by

                                     1
                        ^ FG =
                                                                      C i1 i2 j1 j2 s      ^j1 j2 ,
                                                                                    ^i1 i2 s              (46)
                                 N (N - 1)2     i1 i2 =i1 j1 j2 =j1


where Ci1 i2 j1 j2 = 1 if i1 = j1 , i2 = j2 , i1 = j2 or i2 = j1 and zero otherwise (here the `or'
is inclusive).20 Equation (46) is a summation across N        2
                                                                 × N2
                                                                       "pairs-of-pairs" or pairs of
dyads. As noted above, there are 3 3 = 2 N (N - 1) (N - 2) unique pairs of dyads sharing
                                          N      1

one agent in common; but each of these pairs of dyads is counted eight different times in
(46). Likewise there are N    2
                                   = 12
                                        N (N - 1) pairs of dyads sharing both agents in common
(i.e., straight up dyads) and each of these pairs is counted four different times in (46). From
this observation we have that

                      1         1                         1
                           2 8 × N (N - 1) (N - 2) 1 + 4 × N (N - 1) 2 + 3
         ^ FG =
                                                   ^
                 N (N - 1)      2                         2

               = 4^1 + 2       2 + 3 - 2^1 ,
                        N -1

which exactly coincides with expression (45) above. Not only does   ^ FG include a consis-
                                          
tent estimate of the leading term in V     N SN , but it also includes an estimate of the
asymptotically negligible higher order component.
Fafchamps & Gubert (2007) is widely-cited in the context of covariance estimation by em-
pirical researchers, with a STATA implementation for linear and logistic dyadic regression
freely available (cf., Cameron & Miller, 2014). Consequently considerable practical experi-
ence and Monte Carlo evidence on the properties of standard error estimates based on (46)
exists. Among empirical researchers, the consensus is that such standard errors are often
much larger than those based on the (possibly erroneous) assumption of independence across
dyads.
  19
      This estimator has been further explored by Cameron & Miller (2014), Aronow et al. (2017) and Tabord-
Meehan (2018).
   20
      My definition of ^ FG actually differs slightly from the one given by Fafchamps & Gubert (2007), due to a
finite sample correction term introduced in the latter. Their expression also appears to include a notational
inconsistency with N (apparently) denoting both the number of agents as well as the number of dyads (here
n= 1  2 N (N - 1)) in different components of the expression. Once these typos are corrected (46) agrees with
their expression up to a finite sample correction.




                                                      45
Snijders & Borgatti (1999) jackknife variance estimate

Snijders & Borgatti (1999), inspired by the prior work of Frank & Snijders (1994), suggest21
                                     
a jackknife variance estimate for V    N SN of


              ^ SB =    N -2                         ^ - SN ^                       ^ - SN ^
                                                                                                           
                                               SN,-i                          SN,-i                           ,          (47)
                          2            i


                                                                                N -1
where SN,-i () is the average of the dyadic scores over the                      2
                                                                                       dyads which do not include
agent i:

                                N -1       N
                  def N -1 -1                 s (Zjk ; ) + s (Zkj ; )                  s (Zil ; ) + s (Zli ; )
       SN,-i ()    2                                                  -                                        .
                                j =1   k=j +1
                                                         2                       l=i
                                                                                                  2

The Snijders & Borgatti (1999) proposal, the basis of which they acknowledge was primarily
                                                       
intuitive, does not provide a consistent estimate of V   N SN , but, as I will now show, a
slight modification of their proposal does.
                                                                        def                   s(Zij ;)+s(Zji ;)
                                              ¯1i () 
                                              ^
With some manipulation we can write, defining s                                1
                                                                              N -1     j =i           2
                                                                                                                  (in a slight
abuse of notation),

                                           N -1 -1
              SN,-i () - SN () =            2
                                                       N
                                                       2
                                                            SN () - (N - 1) s
                                                                            ¯1i () - SN ()
                                                                            ^
                                                 2
                                       =-           ¯1i () - SN () .
                                                    ^
                                                    s                                                                    (48)
                                               N -2

                  def
Observe that s¯1i  s
              ^       ^1i 
                      ¯   ^ would be the usual estimate of the the ith summand in the Hájek
projection given in (31) above (see, for example, Callaert & Veraverbeke (1981) or Cattaneo
et al. (2014) and the references therein). Indeed, on the basis of the limit theory outlined
above, a natural estimate of 1 would be

                                                            N
                                                ~ 1 def 1
                                                                  ^
                                                                  s   ¯1i .
                                                                      ^
                                                                  ¯1i s                                                  (49)
                                                        N   i=1

  21
    They actually propose a jackknife estimate for the variance
                                                            of SN . I have multiplied their expression by
N to get the corresponding expression for the variance of N SN (see Equation (2) of Snijders & Borgatti
(1999)).




                                                        46
After some tedious manipulation it is possible to show that

                                              ^ 1 + 2 + 3 - 1
                                                             ^
                                         ~1 = 
                                                                                           (50)
                                                        N -1
                                            = ^ 1 + O p N -1

with ^ 1 and 2 + 3 as defined in (41) and (42) above.

Equations (48), (50) and the observation that SN ^ = 0 implies that the jackknife variance
estimate

               ^ JK def (N - 2) 2                ^ - SN ^                  ^ - SN ^
                                                                                        
                                           SN,-i                     SN,-i                 (51)
                          N          i

                      = 4~1

                                4 2 +  3 - ^1
                      = 4^1 +                         ,
                                         N -1
                                                                     
provides a consistent estimate of the asymptotic variance               N SN .
Furthermore, inspired by Efron & Stein (1981) and, especially, Cattaneo et al. (2014), we
can bias correct (51):

                              ^ JK-BC def            2
                                          ^ JK -        2 +  3 = ^ FG                      (52)
                                                   N -1

with 2 + 3 as defined by (42) and the equality an implication of (50). Equation (52)
implies that the Fafchamps & Gubert (2007) variance estimator, or equivalently the analog
estimator proposed above, coincides with a bias corrected jackknife variance estimate. This
is awesome.


4.5    Bootstrap inference
Relative to analytic variance estimation, the theory of the bootstrap for dyadic regression is
comparatively less well-understood. Rewriting our dyadic regression coefficient estimate in
pseudo-U-Process form yields

                                                     N -1   N
                        ^ = arg max          2                    lij () + lji ()
                                                                                    .
                                         N (N - 1)   i=1 j =i+1
                                                                         2

                N
Next let Vib    i=1
                      be a sequence of i.i.d. mean one random weights independent of the data.

                                                      47
One such sequence is drawn for each of b = 1, . . . , B bootstrap replications. In the bth such
replication we compute

                                               N -1   N
                   ^b = arg max       2                               lij () + lji ()
                                                            Vib Vjb                     .
                                  N (N - 1)    i=1 j =i+1
                                                                             2

                                     B
The bootstrap distribution    ^b     can then be used to approximate the sampling distri-
                                 b=1
bution of ^. Letting V b be an exponential random variable with rate parameter 1 results in
                         i
a Bayesian bootstrap which is, of course, preferred. The above algorithm was proposed in
the context of U-statistics by Janssen (1994). If we let Vib equal the number of times agent
i is sampled from the set {1, . . . , N } across N draws with replacement, we get the proposal
of Davezies et al. (2019), who show ­ under certain assumptions ­ validity for the dyadic
regression case considered here.
Snijders & Borgatti (1999) proposed a bootstrap procedure for jointly exchangeable ran-
dom arrays which is very close to the proposal of Davezies et al. (2019). As with
their jackknife variance estimator, their development was intuitive and informal. For
simplicity consider the application of their proposal for inference on the dyadic mean
 ¯ =           2      N -1     N      Yij +Yji
Y         N (N -1)    i=1      j =i+1     2
                                               . Let ib            b
                                                      1 , . . . , iN be N indices drawn uniformly at ran-
dom (with replacement) from {1, . . . , N }. Let Yb be the adjacency matrix induced by
  ib            b                                         b             b
   1 , . . . , iN . If agent j is sampled twice, say i1 = j and i2 = j we face the practical problem
that the outcome Yib          b = Yjj is undefined. Snijders & Borgatti (1999) propose filling in such
                           1 i2

cells with independent random draws from {Y12 , Y21 , . . . , YN -1N , YN N -1 }; they note that the
expected fraction of bootstrap dyads constructed from a single underlying agent in the orig-
inal sample will be vanishingly small as N   (suggesting that this problem may not
matter for asymptotic properties). Snjiders and Borgatti's (1999) algorithm essentially coin-
cides with the pigeon-hole bootstrap proposed by Owen (2007) for separately exchangeable
random arrays (in which the problem of "zero diagonals" does not arise).
A final bootstrap procedure is proposed by Menzel (2017). He is particularly concerned
with formulating a procedure that adaptively handles the possibility that there is, in fact,
no dyadic correlation in the data (i.e., 1 = 0). Degeneracy of this type occurs, in our
regression setting, when the graphon h (x1 , x2 , u1 , u2 , v12 ) is constant in both u1 and u2 (but
also in more exotic situations where there is dyadic dependence in higher order moments,
but no correlation). The arguments in Menzel (2017) suggest that the weighted bootstrap
of Janssen (1994) and Davezies et al. (2019) will be inconsistent under degeneracy.
Menzel (2017) proposes several different bootstraps; what I sketch here is a simplified version


                                                   48
of his `BS-N' procedure (adapted to the dyadic regression case). Let

                                                 N                                N
                                         1                                1
                               ^e
                               s     =                  ^ij ,
                                                        s       ^a
                                                                s     =               s
                                                                                      ^ij
                                 i
                                       N -1      j =1
                                                                  j
                                                                        N -1    i=1


be estimates of the average dyadic score for `ego' i and `alter' j . Let

                                               e     ^ij - s
                                               ^ij = s     ^ei -s
                                                                ^aj


equal the residual for s ^ij after subtracting off these ego and alter means. Menzel (2017)
actually suggests subtracting off rescaled versions of s^e     ^a
                                                         i and s j when forming e^ij . Rescaling
improves the accuracy of his procedure when dyadic correlation is, in fact, absent. I omit
this detail since describing it requires introducing substantial additional notation. The styl-
ized version sketched here will be conservative under degeneracy (similar to the pigeonhole
bootstrap).
          N
Let Vib i=1 be a sequence of i.i.d. mean zero random weights with unit variance (and
unit third moment as well). Let ib                b
                                     1 , . . . , iN be N indices drawn uniformly at random (with
replacement) from {1, . . . , N }. For all N     2
                                                    dyads induced by the bth such bootstrap sample
construct the scores


                       ^e     ^a                  b , j = 1 , . . . , N - 1 & k = j + 1, . . . , N
                                       b b
              ^ib
              s    b = s
                j ik     ib + s ib + Vib Vib e
                                             ^ib
                                               j ik
                         j     k       j   k


and compute their mean

                                                        N -1     N      s
                                                                        ^ib  b + s
                                                                                 ^ib
                             ^b =         2                               j ik
                                                                                      b
                                                                                   k ij
                             S                                                              .
                              N
                                      N (N - 1)         j =1 k=j +1
                                                                              2

                 
The variance of N S   ^b across the b = 1, . . . , B bootstrap replications can be used to con-
                       N
                              
struct an estimate of  = V      N SN . Menzel's (2017) preferred procedures involve an addi-
tional "model selection" step, not described here, as well as pivotizing using  ^ FG = ^ JK-BC .


4.6    Further reading and open questions
A special case of the Fafchamps & Gubert (2007) variance estimator was first proposed by
Holland & Leinhardt (1976) in the context of inference on network density; the equivalent
of the dyadic mean µY12 = E [Y12 ] here (estimated by Y    ¯ =     1
                                                                N (N -1)
                                                                         N
                                                                         i=1   j =i Yij ). The
Holland & Leinhardt (1976) variance estimate was used with some regularity in empirical
social network analysis in the 1980s and 1990s (cf., Wasserman & Faust, 1994). The reference

                                                           49
distribution was assumed to be normal, but no proof for this was available. Bickel et al.
                                                                    
(2011) appear to be the first to have shown asymptotic normality of N Y   ¯ - µY12 under
dyadic dependence. The double projection argument used to produce the SN = V1N +
V2N + TN decomposition used above is implicit in their work. A similar decomposition was
used by Graham (2017) to show asymptotic normality of the Tetrad Logit estimator, which
is described further below. The bootstrap procedure of Menzel (2017) is also based upon
this decomposition. Tabord-Meehan (2018) demonstrates asymptotic normality of dyadic
regression coefficients estimated by ordinary least squares. His method of proof is very
different from the argument outlined here.
Cameron & Miller (2014), Aronow et al. (2017) and Tabord-Meehan (2018) provide further
results on variance estimation for dyadic regression; each building upon the proposal of
Fafchamps & Gubert (2007).
Menzel (2017) and Davezies et al. (2019) provide large sample theory in some generality ­
including for cases not covered here. Both these papers provide formal results on inference
using the bootstrap as well. The presentation here is based upon Graham (2018a), a revised
and expanded version of which appears as a chapter in Graham & de Paula (2020).
When dyadic correlation is weak limit theory can be non-standard. Menzel (2017) provides
examples and discussion. Related issues arise in Graham et al. (2019), who study nonpara-
metric density and regression estimation with dyadic data. Developing inference procedures
with good properties across a range of (dyadic) data generating processes remains largely
open.
Open research problems include extending the material summarized here to accommodate
regressor endogeneity and settings where the number of regressors is comparable to, or even
exceeds, the number of agents (or dyads).



5    Policy analysis
One motivation for Tinbergen's (1962) dyadic regression analysis was to evaluate the effect
of preferential trade agreements on export flows. Rose (2004) explores the related question
of whether membership in the General Agreement on Trade and Tariffs (GATT) or its
successor, the World Trade Organization (WTO), promoted trade (see also Rose (2005)).
Baldwin & Taglioni (2007) and Santos Silva & Tenreyro (2010) use gravity models to assess
whether common currency zones, such as the Eurozone, promote trade. As with conventional
regression analysis, a desire to assess different programs or policies underlies many dyadic



                                            50
regression analyses.22
While the logic and mechanics of program evaluation are well understood in the context of
single agent models (cf., Heckman & Vytlacil, 2007; Imbens & Wooldridge, 2009), a compa-
rable framework for causal reasoning is not, to my knowledge, available in the dyadic setting
considered here. In this section I make a start at formulating such a framework. In doing
so I will attempt to follow the notation and language of the standard single agent causal
inference framework reviewed in, for example, Imbens & Wooldridge (2009). What follows
are some initial ideas and results; much work remains to be done.


5.1     Dyadic potential response
Let Wi  W = {w1 , . . . , wK } and Xi  X = {x1 , . . . , xL } be a finite set of ego and alter
policies. For example W might enumerate different export promotion policies (e.g., tax sub-
sidies or preferential credit schemes for exporting firms), while X might enumerate different
combinations of protectionist policies (e.g., tariff levels). The goal is to understand how
different counterfactual combinations of ego and alter policy pairs map into (distributions
of) outcomes.
I begin with an assumption about the form of the potential response function for (directed)
dyad ij .

Assumption 1. (Dyadic Potential Response Function) For any ego-alter pair i, j 
N with i = j , the potential (directed) outcome associated with adopting the pair of policies
Wi = w and Xj = x is given by

                         Yij (w, x) = h (w, x, Ai , Bj , Vij ) , x  X, w  W                         (53)

with {(Ai , Bi )}iN and {(Vij , Vji )}i,j N,i<j both i.i.d. sequences additionally independent of
each other and h : W × X × A × B × V  Y a measurable function.

The ego and alter effects, respectively Ai and Bi , induce dependence across any pair of
potential outcomes whose corresponding dyads share at least one agent in common. This
implies a type structured "interference" between units, and hence a violation of SUTVA (cf.,
Rosenbaum, 2007).
  22
    Other examples of recent attempts to reason about causal questions with dyadic data include Schwartz
and Sommers' (2014) and Goodman's (2017) analyses of whether Medcaid expansion states experienced
in-migration from neighboring states which chose to forgo the Affordable Care Act's expansion of Medicaid
and Mayda's (2010) and Oretega and Peri's (2013) studies of the relationship between immigration entry
tightness and cross-country migration.


                                                   51
Since assignment to treatment is at the `ego' or `alter' level, setting Xi = x and Wj = w
shapes not just the realized outcome for dyad ij , but also those of all other dyads which
include either agent i or agent j . It is because of its implications for dependence across the
rows and columns of [Yij (w, x)]i,j N that I label Assumption 1 an "assumption". More than
just notation is involved.
It is possible that Assumption 1 could be derived from a more primitive exchangeability type
restriction; for example by viewing [Yij (w, x)]i,j N as a jointly exchangeable random array
and appealing to the Aldous-Hoover Theorem. There may be some deep subtleties involved
in such an approach, so I prefer to maintain (53) as an explicit assumption in this initial
exploration.
I could have also written Yij (w, x) = h (w, x, (1, 0) Ui , (0, 1) Uj , Vij ) = h (w, x, Ui , Uj , Vij )
with Ui = (Ai , Bi ) . Explicitly separating out an `ego' and `alter' effect, however, is con-
ceptually useful and also facilitates, as will be demonstrated by example below, parametric
modeling.
In some cases of interest the support of the ego and alter policies will coincide (i.e., W = X).
Following Santos Silva & Tenreyro (2010), for example, both Xi and Wj might be indicators
for Eurozone membership. This example implies the additional restriction that Xi = Wi for
all i  N, since a country belongs to the Eurozone in both their exporter (ego) and importer
(alter) role. These special cases can be deduced from the more general results which follow.


5.2     Average structural function (ASF)
Dyad-level treatment effects are defined in the usual way. The effect on ij 's outcome of
adopting policy pair (w , x ) vs. (w, x) is

                                       Yij (w , x ) - Yij (w, x).

As in the standard case, identification of such effects at the dyad-level is infeasible. This is
because the econometrician only observes the outcome associated with the policy pair actu-
ally adopted. Specifically, for each of N randomly sampled units she observes the assigned or
chosen ego and alter policies, {(Wi , Xi )}N
                                           i=1 and the N (N - 1) realized (directed) outcomes
{(Yij , Yji )}i<j , where
                                             def
                                         Yij  Yij (Wi , Xj )                                       (54)

equals (directed) dyad ij 's realized outcome. No counterfactual outcomes are observed.
Although dyad-level treatment effects are not identified, averages of such effects over agents


                                                   52
and/or dyads are (under certain assumptions). Here I will focus on identifying average
treatment effect (ATE) type parameters. Consider the following thought experiment: (i)
draw an ego unit at random from the target population and exogenously assign it policy
Wi = w, (ii) independently draw an alter unit at random and assign it policy Xj = x. The
(ex ante) expected outcome associated with this directed dyad, so configured, is

                            def
              mASF (w, x)  E [Y12 (w, x)]                                                          (55)

                            =            h (w, x, a, b, v ) fA1 (a) fB2 (b) fV12 (v ) dadbdv
                            def
                                          ¯ (w, x, a, b) fA (a) fB (b) dadb,
                                          h                1      2




                    def
where the second `  ' in (55) follows from defining h       ¯ (w, x, a, b) def
                                                                            E [h (w, x, a, b, V12 )] 
                                                                                                     def

¯ij (w, x). Note also that E [ h (w, x, a, b, V12 )| A1 = a, B2 = b] = E [h (w, x, a, b, V12 )] by inde-
Y
pendence of A1 , B2 and V12 (Assumption 1).
Differences of the form mASF (w , x ) - mASF (w, x) measure the expected effects of different
combinations of policies on the directed dyadic outcome. If Wi  {0, 1} and Xi  {0, 1} are
both binary indicators for GATT/WHO membership, as in Rose (2004), then the contrast

                                      mASF (1, 1) - mASF (0, 0)                                    (56)

gives differences in export flows between a random pair of countries in the GATT/WHO
vs. non-GATT/WHO states of the world. This is an average treatment effect (ATE) type
parameter, adapted to the dyadic setting.
The dyadic setting also raises new questions. For example the double difference

                     mASF (1, 1) - mASF (0, 1) - mASF (1, 0) - mASF (0, 0)                         (57)

measures complementarity in a binary policy/treatment across the two agents in the dyad.
Other estimands beside the ASF may be of interest. The difference of sample means

                                    1
                                                [Yij (1, Xj ) - Yij (0, Xj )]
                                  N -1   j =i


measures the average effect ­ for unit i alone ­ of adopting ego policy Wi = 1 versus Wi = 0;
the average is over the status quo distribution of alter polices. Additionally averaging over




                                                      53
ego units gives
                            1 1
                                                     [Yij (1, Xj ) - Yij (0, Xj )] .
                            N N -1        i   j =i

This equals the average effect, across all units in the sample, of adopting ego policy Wi = 1
versus Wi = 0, again given the status quo distribution of alter policies. The population
counterparts of these two sample averages may also be of interest.
For the purposes of illustration, assume that W = X = {0, 1}. A parametric form for
Yij (w, x) that will be helpful for both understanding extant empirical work and interpreting
some of the assumptions which follow is:

                       Yij (w, x) =  + w + x + wx + Ai + Bj + Vij .                                  (58)

Response (58) implies that treatment effects are constant across units, for example,

                                       Yij (1, 0) - Yij (0, 0) = ,

which is constant in i  N. Under (58) we also have estimand (56) equaling  +  +  and
(57) equal to  .
The average structural function (ASF) estimand is a leading case and will be emphasized
here. However, as I hope the brief sketch above makes clear, other estimands merit ex-
ploration and, I conjecture, will involve interesting identification, estimation and inference
issues.


5.3    Identification under exogeneity
In order to identify the ASF I will assert the existence of the observable proxy variables,
Ri and Si , respectively for the ego and alter effects Ai and Bi . These proxy variables will
satisfy two key restrictions, the first of which is:

Assumption 2. (Redundancy) For Ri  R  Rdim(R) a proxy variable for Ai , and
Si  S  Rdim(S ) a proxy variable for Bi , we have that

             E [ Yij (w, x)| Wi , Xj , Ai , Bj , Ri , Sj ] = E [ Yij (w, x)| Wi , Xj , Ai , Bj ] ,

for any w  W and x  X.

Assumption 2 is a redundancy assumption of the type introduced by Wooldridge (2005);
it simply asserts that Ri and Sj have no predictive power (in the conditional mean sense)

                                                        54
for the dyadic potential outcome Yij (w, x) conditional on the latent ego and alter attributes
Ai and Bj . Adapting Wooldridge's (2005) example, it asserts that ego and alter Armed
Forces Qualification Test (AFQT) scores, Ri and Sj , do not predict Yij conditional on the
unobserved cognitive abilities, Ai and Bj . Assumption 2 is a weak requirement since we
are free to conceptualize the latent attributes, Ai and Bj , such that Ri and Sj are clearly
redundant.

Assumption 3. (Strict Exogeneity) The ij ego-alter treatment assignment (Wi , Xj ) is
independent of Vij conditional on the latent ego Ai and alter Bj effects:

                                 Vij  (Wi , Xj )| Ai = a, Bi = b, a  A, b  B.                                                (59)

While conditional independence assumptions feature prominently in the causal inference
literature, Assumption 3, which involves conditioning on unobservables, has no clear analog
in the standard program evaluation model. The closest analog of this assumption I can
think of is Chamberlain's (1984) definition of strict exogeneity of a time-varying regressor
conditional on a latent (time-invariant) unit-specific effect in the context of panel data. To
see the parallel return to parametric potential response function (58) and note that (54) and
(59) imply that

                      E [ Yij | Wi , Xj , Ai , Bj ] =  + Wi  + Xj  + Wi Xj  + Ai + Bj                                        (60)

since Assumption 3 gives E [ Vij | Wi , Xj , Ai , Bj ] = E [ Vij | Ai , Bj ] and E [ Vij | Ai , Bj ] = E [Vij ]
by independence of {(Ai , Bi )}Ni=1 and {(Vij , Vji )}i<j (setting E [Vij ] = 0 is a normalization).
Equation (60) looks a lot like the definition of strict exogeneity in Chamberlain (1984, Equa-
tion 1.2 on p. 1248). Equation (60) implies, for example, that

                 E [ Yij - Yil - (Ykj - Ykl )| Wi , Xj , Ai , Bj ] = (Wi - Wk ) (Xj - Xl ) ,

such that "within-tetrad" variation identifies  . Similar to how within-group variation in a
strictly exogenous regressor identifies its corresponding coefficient in the panel context.
Under Assumption 3 we have the density factorization

     fV12 ,A1 ,W1 ,B2 ,X2 (v12 , a1 , w1 , b2 , x2 ) =f V12 |A1 ,W1 ,B2 ,X2 ( v12 | a1 , w1 , b2 , x2 )
                                                        × fA1 ,W1 (a1 , w1 ) fB2 ,X2 (b2 , x2 )
                                                    =f V12 |A1 ,B2 ( v12 | a1 , b2 ) fA1 ,W1 (a1 , w1 ) fB2 ,X2 (b2 , x2 )
                                                    =fV12 (v12 ) fA1 ,W1 (a1 , w1 ) fB2 ,X2 (b2 , x2 )

                                                               55
with the first equality an implication of units 1 and 2 being independent random draws,
the second equality following from Assumption 3, and the third from independence of
{(Ai , Bi )}N
            i=1 and {(Vij , Vji )}i<j (i.e., Assumption 1).

This factorization clarifies that the effect of Assumption 3 is to ensure that all "endogeneity"
in treatment choice is reflected in dependence between Wi and Ai and/or Bj and Xj . Con-
ditional on these two latent variables, variation in treatment is "idiosyncratic" or exogenous.
To deal with dependence between Wi and Ai , and Bj and Xj , I make a familiar selection of
observables type assumption.

Assumption 4. (Conditional Independence) An ego's (alter's) treatment choice varies
independently of their latent effect Ai (Bj ) given the observed proxy Ri (Sj ):

                              Ai  Wi | Ri = r, r  R  Rdim(R)                               (61)
                               Bi  Xi | Si = s, s  S  Rdim(S ) .                           (62)

Assumption 4 is a standard one in the context of single agent program evaluation prob-
lems, asserting ­ for example ­ that Ai and Wi vary independently within subpopulations
homogenous in the proxy variable Ri . Extensive discussions of selection-on-observables type
assumptions like these, including assessments of their appropriateness in different settings
of interest to empirical researchers, can be found in Blundell & Powell (2003), Heckman &
Vytlacil (2007), Imbens & Wooldridge (2009) and Imbens & Rubin (2015). Their invocation
here can raise new issues, but, for the most part familiar approaches to reasoning apply; see
Graham et al. (2018) for a related discussion.
Assumptions 1 to 4, plus an additional support condition described below, are sufficient to
show identification of the ASF. To develop the argument first let

                    q (w, x, r, s) = E [ Yij | Wi = w, Xj = x, Ri = s, Sj = s]             (63)

be the dyadic proxy variable regression (PVR). Under Assumptions 1 through 4 the PVR




                                               56
                        ¯ (w, x, A1 , B2 ) as follows:
           ¯12 (w, x) = h
relates to Y

      q (w, x, r, s) =E [ h (Wi , Xj , Ai , Bj , Vij )| Wi = w, Xj = x, Ri = r, Sj = s]
                    =E [E [ h (Wi , Xj , Ai , Bj , Vij )| Wi = w, Xj = x, Ai , Bj , Ri = r, Sj = s]
                        |Wi = w, Xj = x, Ri = r, Sj = s ]
                    =E [E [ h (Wi , Xj , Ai , Bj , Vij )| Wi = w, Xj = x, Ai , Bj ]
                     |Wi = w, Xj = x, Ri = r, Sj = s ]
                       ¯ (w, x, Ai , Bj ) Wi = w, Xj = x, Ri = r, Sj = s
                    =E h

                    =            ¯ (w, x, a, b) f A|R ( a| r) f B |S ( b| s) dadb
                                 h
                         a   b

                    =E Y
                       ¯12 (w, x) R1 = r, S2 = s .                                                               (64)

where the first equality follows from Assumption 1 and equation (54), the second from
iterated expectations, the third from the redundancy condition (Assumption 2), the fourth
from Assumption 3, independence of {(Ai , Bi )}N                                               ¯
                                               i=1 and {(Vij , Vji )}i<j and the definition of h,
and the fifth from selection on observables (Assumption 4).
Equation (64) gives the identification result


      ER [ES [q (w, x, Ri , Sj )]] =                          ¯ (w, x, a, b) f A|R ( a| r) f B |S ( b| s) dadb
                                                              h                                                  (65)
                                            r   s     a   b

                                           × fR (r) fS (s) drds

                                       =            ¯ (w, x, a, b) fA (a) fB (b) dadb
                                                    h
                                            a   b

                                       =E Y
                                          ¯12 (w, x)

                                       =mASF (w, x) .

Since q (w, x, r, s) is only identified at those points where f R|W ( r| x) f S |X ( s| x) > 0, while
the integration in (65) is over R × S , we require a formal support condition:

                                 def
                    S (w, x)            r, s : f R|W ( r| w) f S |X ( s| x) > 0 = R × S .                        (66)

When Wi and Xj are discretely-valued, with a finite number of support points, as assumed
here, (66) can be expressed in a form similar to the overlap condition familiar from the
program evaluation literature (e.g., Heckman et al., 1997; Imbens & Wooldridge, 2009).




                                                                57
Assumption 5. (Overlap) For (w, x) the ego-alter treatment combination of interest

                            pw (r) px (s)   > 0 for all (r, s)  R × S

              def                                      def
where pw (r)  Pr ( Wi = w| Ri = r) and px (s)  Pr ( Xi = x| Si = s) .

We have shown.

Theorem 2. Under Assumptions 1 through 5 the ASF is identified by

                       mASF (w, x) =          q (w, x, r, s) fR (r) fS (s) drds.                   (67)


Theorem 2 shows that the ASF is identified by double marginal integration over the dyadic
proxy variable regression function. Double marginal integration also features in Graham et al.
(2018), in the context of identifying an average match function (AMF), and Brown & Newey
(1998), in their discussion of efficient expectation estimation under independence restrictions.
However the random array structure present here is absent in both these examples, which
accounts for many of the differences in underlying arguments.


5.4     Estimation of the average structural function
Let q (w, x, r, s;  ) be a (flexibly) parametric model for the dyadic proxy variable regression
function. For example, if the outcome of interest is export flows, we might specify that

                                  q (w, x, r, s;  ) = exp t (Qi )  ,

                      
with Qi = (Wi , Xi , Ri , Si ) and t (Qi ) a finite (and pre-specified) set of basis functions (prefer-
ably including interactions of terms in the treatment variables ­ W, X ­ and proxy variables
­ R, S ). We can estimate  use the Poisson dyadic regression estimator described in Section
                                                                                               
4. Proceeding in this way delivers an asymptotically linear representation for N (^                - 0 )
of
                                 -1 2
                                           N
                                                 ¯e
                                                 s                    ¯a
                                                   1 (Qi , Ui ; 0 ) + s 1 (Qi , Ui ; 0 )
                 - 0 ) = -0 
             N (^                                                                        + op (1)   (68)
                                      N i=1                         2

with Ui = (Ai , Bi ) , 0 the probability limit of the Hessian matrix associated with the dyadic
Poisson composite log-likelihood, and s  ¯e                     ¯a
                                           1 (Qi , Ui ; 0 ) and s 1 (Qi , Ui ; 0 ) as defined on page 40
(with Qi playing the role of Xi ).
With an estimate of  in hand, form the fitted values {q (w, x, Ri , Sj ; ^ )}i<j and, invoking


                                                  58
Theorem 2, compute the analog estimate

                                           N -1     N
                                  N -1                   q (w, x, Ri , Sj ; ^ ) + q (w, x, Rj , Si ; ^)
             ^ ASF (w, x; 
             m            ^) =    2
                                                                                                        .   (69)
                                           i=1    j =i+1
                                                                                2

                                     ^ ASF (w, x; 
To present the limit distribution of m            ^ ) I impose a regularity condition on the
proxy variable regression function:

Assumption 6. (i)   C  Rdim( ) with C compact, (ii) q (w, x, r, s;  ) is twice continu-
ously differentiable in  , and (iii) the expectations E [|q (w, x, R1 , S2 ;  ) + q (w, x, R2 , S1 ;  )|],
                                                  2                  2
E q(w,x,R  
            1 ,S2 ; )
                      + q(w,x,R
                             
                                2 ,S1 ; )
                                          and E  q(w,x,R
                                                      
                                                         1 ,S2 ; )
                                                                   +  q(w,x,R
                                                                          
                                                                              2 ,S1 ; )
                                                                                        are finite.
                                       2                                                          F

Under this assumption we have the following Lemma.
                                                                                     
Lemma 1. (ASF Estimation) Under Assumption 6, with ^a                                   N consistent estimate of
0 , we have that

                                                          2
                                                                        N
             N m
               ^   ASF
                         (w, x; ^) - m ASF
                                             (w, x; 0 ) =                    0 (w, x, Ri , Si ; 0 )         (70)
                                                           N           i=1
                                                                                 
                                                                 + M0 (w, x)            - 0 ) + op (1)
                                                                                    N (^

where

                                 q e (w, x, R1 ;  ) + q a (w, x, S1 ; 0 )
            0 (w, x, R1 , S1 ;  ) =                                       - mASF (w, x;  )
                                                    2
                              1     q (w, x, R1 , S2 ; 0 ) q (w, x, R2 , S1 ; 0 )
                   M0 (w, x) = E                            +
                              2                                           

with

                                 q e (w, x, r;  ) = ES [q (w, x, r, S ;  )]
                                 q a (w, x, s;  ) = ER [q (w, x, R, s;  )] .

Proof. The result follows from Assumption 6 and an application of Lemma 1 in Appendix
A.

Lemma 1 and equation (68) yields an asymptotically linear representation for




                                                          59

     ^ ASF (w, x; 
   N m            ^ ) - mASF (w, x; 0 ) of

                                                      2
                                                                      N
       N m
         ^   ASF
                   (w, x; ^) - m   ASF
                                         (w, x; 0 ) =                      0 (w, x, R1 , S1 ; 0 )
                                                       N             i=1

                                                              - M0 (w, x) -
                                                                          0
                                                                            1

                                                                           N
                                                               2                    ¯e
                                                                                    s                    ¯a
                                                                                      1 (Qi , Ui ; 0 ) + s 1 (Qi , Ui ; 0 )
                                                              ×
                                                               N           i=1
                                                                                                       2
                                                              + op (1) .                                                      (71)

Under correct (enough) specification of the composite likelihood, which will typically follow if
the parametric form of the the PVR function is itself correctly specified, both s  ¯e1 (Q1 , U1 ; 0 )
      a
and s¯1 (Q1 , U1 ; 0 ) will be conditional mean zero given Q1 , hence the first and second terms
in (71) will be uncorrelated with each other such that a CLT will imply a limit distribution
of
                                                                                                                      -1
                  ^ ) - mASF (w, x; 0 )  N 0, 40 (w, x) + 4M0 (w, x) 0 -                                                   M0 (w, x)
                                                       D
     ^ ASF (w, x; 
   N m                                                                   1
                                                                       1 0


                                                                               ¯e
                                                                               s1 (Qi ,Ui ;0 )+¯sa
                                                                                                 1 (Qi ,Ui ;0 )
with 0 (w, x) = V (0 (w, x, R1 , S1 ; 0 )) and 1 = V                                          2
                                                                                                                  .
The first term in the asymptotic variance reflects the econometrician's imperfect knowledge
                                             
of the distribution of the proxy variables (Ri , Si ) . The second term reflects the asymptotic
penalty associated with not knowing the conditional distribution of Y12 given W1 , X2 , R1 , S2 .
See Graham (2011) and Graham et al. (2018) for more expansive discussions in related
contexts (see also Chamberlain (1992)).
In order to conduct inference an asymptotic variance estimate is required. Estimation of
                                                -1
covariance matrix V         - 0 ) = 0 -
                        N (^                1
                                           1 0     can proceed using one of the methods
described in Section 4. The 0 (w, x) term may be estimated by

                                               N
                        ^ (w, x) = 1
                                                     ^ (w, x, Ri , Si ; 
                                                                        ^) ^ (w, x, Ri , Si ; ^ )
                                   N           i=1


       ^ (w, x, Ri , Si ;                          q (w,x,Ri ,Sj ;^
                                                                   )+q (w,x,Rj ,Si ;^
                                                                                    )
where                     ^) = N1
                                -1 j =i                             2
                                                                                        -m
                                                                                         ^ ASF (w, x; ^ ). The Jacobian,
M0 (w, x), is naturally estimated by

                                     N -1          N
                        2                             1 q (w, x, Ri , Sj ; ^ ) q (w, x, Rj , Si ; ^)
        M0 (w, x) =                                                           +                      .
                    N (N - 1)            i=1   j =i+1
                                                      2                                  




                                                               60
In practice, for reasons analogous to those discussed in Section 4, it may be preferable to
replace the estimate of 1 with one for  (as defined in equation (40)) and use a "Fafchampfs
                                  
and Gubert" type estimate of V      Nm ^ ASF (w, x; 0 ) in place of ^ (w, x).


5.5    Further reading and open questions
I am aware of no extant work on causal inference in the setting considered here. There is
a large, and rapidly growing, literature on causal inference and interference, some of which
makes connections to networks (e.g., Athey et al., 2018); VanderWeele & An (2013) provide
a review of some relevant research.
The approach to estimation outlined above builds upon the dyadic regression material al-
ready introduced. A natural extension would to replace the parametric proxy variable regres-
sion function estimate with a non-parametric one (perhaps estimated using machine learning
procedures). Inverse probability weighting (IPW) type estimators are also easily constructed
(cf., Graham et al., 2018). I conjecture that augmented inverse probability weighting estima-
tors (AIPW), exhibiting double robustness type properties, could also be constructed. The
maximal asymptotic precision with which mASF (w, x; 0 ) may be estimated under Assump-
tions 1 through 5 is also unknown. This semiparametric efficiency bound calculation, as in
other network problems with likelihoods that don't easily factor into independent compo-
nents, does not appear to be straightforward.



6     Incorporating unobserved heterogeneity
In its natural to associate the agent-specific Ui and Uj terms appearing in the Crane &
Towsner (2018) representation result for X -exchangeable networks with unobserved corre-
lated heterogeneity. In Section 4 I introduced methods for parametric estimation of the
                                       def
dyadic regression function q (x, x )  E [ Yij | Xi = x, Xj = x ]. The relationship between
q (x, x ) and the graphon h (x, x , u, u , v ) depends, of course, on the dependence structure
between Xi and Ui . Assumptions about this dependence structure played a prominent role
in identifying the average structural function (ASF) in Section 5. In both Sections 4 and
5, however, the focus was on direct modeling of the conditional mean of Yij given observed
covariates.
In this section I wish to explore the advantages of a modeling approach which directly
specifies a parametric form for the graphon. This idea, at least implicitly, goes back to the
work of Holland & Leinhardt (1981) and van Duijn et al. (2004).


                                             61
The analysis in Sections 4 and 5 requires that the researcher directly specify the correct para-
metric form of the dyadic regression function. In contrast, the exact structure of (conditional)
dependence across dyads sharing agents in common was left unspecified. To understand how
such dependence might arise, it is useful to specify a structural correlated random effects
model, analogous to those familiar from single-agent discrete choice panel data settings (e.g.,
Chamberlain, 1980, 1984).


6.1     A parametric dyadic potential response function
For the purposes of illustration, I will focus on modeling a directed binary outcome variable.
The generalization to non-binary outcomes is straightforward. Refer to the dyadic potential
response function introduced in Assumption 1. Consider the following parametric form for
this function

       Y12 (w1 , x2 ) = 1 te (w1 ) 0
                                   e
                                     + ta (x2 ) 0
                                                a
                                                  +  (w1 , x2 ) 0 + A1 + B2 + V12 > 0         (72)
                   = h (w1 , x2 , A1 , B2 , V12 )

with
                                                                     0       1 
                  (V12 , V21 )| Q1 , Q2 , A1 , B1 , A2 , B2  N           ,                    (73)
                                                                     0        1
and independently distributed across dyads. As in Section 5, Xi and Wj correspond to the
chosen ego and alter treatments; Ai and Bj are unobserved ego and alter heterogeneity,
which may be correlated with these treatment choices, and Ri and Sj are proxy variables
(recall that Qi = (Wi , Xi , Ri
                              
                                , Si ) ). The vectors te (w1 ), ta (x2 ) and  (w1 , x2 ) consist of
known basis functions in the underlying treatment variables. In the case where both Wi and
Xj are binary we would set te (w1 ) = w1 , ta (x2 ) = x2 and  (w1 , x2 ) = w1 x2 .
Next posit the correlated random effects specification for the joint distribution of the ego
and alter heterogeneity

            Ai                                 e
                                               0 + k e (Ri ) 0
                                                             e
                                                                         A2
                                                                             A B
               Wi , Xi , Ri , Si  N                              ,                      ,     (74)
            Bi                                 e
                                               0 + k a (Si ) 0
                                                             a
                                                                         A B B2



with k e (Ri ) and k a (Si ) vectors of known functions of the proxy variables. Note that (72) and
(74) jointly imply the selection on observables, Assumption 4 introduced earlier. Redundancy
and strict exogeneity, respectively Assumptions 2 and 3, also hold in this set-up.




                                                    62
Averaging over Ai and Bj gives a dyadic proxy variable regression function of

                                                                   
                                   q (Wi , Xj , Ri , Sj ; 0 ) =  Tij 0                                     (75)

             2   2        -1/2   e   a    e      a          e      a        
for 0 = (1 + A + B )             0 + 0 , (0 ) , (0 ) , 0 , (0 ) , (0 )          and

                                                                                        
                     Tij = 1, te (Wi ) , ta (Xj ) ,  (Wi , Xj ) , k e (Ri ) , k a (Sj ) .

It is possible to estimate 0 along the lines outlined in Section 4 above. Alternatively one
could attempt to directly maximize the integrated likelihood implied by (72), (73) and (74).
This would be computationally non-trivial since the integral does not easily factor. van
Duijn et al. (2004) and Zijlstra et al. (2009) develop this approach using Markov Chain
Monte Carlo (MCMC) methods.


6.2     Triad probit: a correlated random effects estimator
An intermediate approach, which is more efficient than the basic dyadic regression estimator
introduced earlier, and additionally recovers more features of the graph generation process,
is what I will call triad probit. Triad probit is also a composite likelihood estimator. In-
stead of modeling the dyadic outcome, Y12 | Q1 , Q2 , marginally however, it is composed of
component likelihoods for the joint outcome (Y12 , Y21 , Y13 , Y31 )| Q1 , Q2 , Q3 . That is I model
the outcome configuration associated with a pair-of-dyads sharing one agent in common. An
overall criterion function is constructed by summing over the component log-likelihoods, so
constructed, for all 3 N3
                           pairs-of-dyads sharing one agent in common.23
The probability of the event Y12 = y12 , Y21 = y21 , Y13 = y13 , Y31 = y31 given the parameters
and regressors is



  Pr ( Y12 = y12 , Y21 = y21 , Y13 = y13 , Y31 = y31 | Q1 , Q2 , Q3 ) =                            4 ( t| ) dt
                                                                          A12    A21   A13   A31
                                                                                                           (76)

with 4 ( t| ) the density of a tetra-variate normal distribution with mean zero and covari-
  23
    This approach is related to the pairwise likelihood estimator for models with crossed random effects
discussed by Bellio & Varin (2005) and Cattelan & Varin (2013).




                                                     63
ance matrix . The intervals of integration are given by

                                                    
                                            -, Tij   0           if yij = 1
                                Aij =         
                                                                            ,
                                            Tij 0 ,              if yij = 0

with the covariance matrix, which is in correlation form (a scale normalization), taking the
form                                                         A2                  
                                                +2A B                 A B
                                        1          2 + 2     2 + 2       2 + 2
                                                1+A     B 1+A    B   1+A      B 
                                  +2       A B
                                                   1       A B           B2
                                                                                 
                                 1+A    2 + 2             1+A2 + 2   1+A 2 + 2   
            =  (, A , B , ) =                B                   B            B
                                                                                 .
                                                                                 
                                        A2
                                                                      +2      
                                
                                                   A  B
                                                              1             A  B
                                                                              B 
                                    1+  2 + 2   1+ 2 + 2             1+  2 + 2
                                        A    B     A    B                A
                                                   B2
                                      A B                  +2A B
                                    1+ 2 + 2    1+ 2 + 2  1+ 2 + 2
                                                                         1
                                             A   B           A     B          A   B


The integral (76) does not have a closed form expression. Fortunately a large economet-
rics and statistics literature suggest various methods for its numerical evaluation; see, for
example, Keane (1994) and Chib & Greenberg (1998).
     
Let l123 () equal the logarithm of (76) with  = (  , , A , B , ) . To induce symmetry in
the criterion function summands I form the average

                                         1                      
                             lijk () =     lijk () + ljik () + lkij () .
                                         3

The triad probit estimate ^TP of 0 is the maximizer of the sum of the lijk () kernels over
all N
    3
       triads in the network:

                                                 N -1
                                   LN () =       3
                                                                  lijk () .                                 (77)
                                                          i<j<k


Note that (4) sums over all 3 N3
                                  pairs-of-dyads sharing one agent in common. It does this
                       N
by summing over all 3 triads in the network and, for each such triad, summing over the
three pairs-of-dyads sharing an agent in common that can be constructed from it.
The criterion (77) is not a U-process-minimizer, although, as in the other contexts intro-
duced above, it shares similarities with one. The results of Honoré & Powell (1994) do not
immediately characterize the asymptotic sampling properties of ^TP . Nevertheless arguments
similar to those outlined in Sections 4 and 5 above can be applied to also analyze ^TP .
                                                                                      N -1
A quick outline of these arguments goes as follows. Let SN () =                       3      i<j<k   sijk () with
                                             2 lijk ()
                                                       and, as earlier, q = E si1 i2 i3 sj1 j2 j3 to be
           lijk ()
sijk () =    
                   Also define 0 = E
                   .                          
the covariance of si1 i2 i3 and sj1 j2 j3 when they share q = 0, 1, 2, 3 indices in common.



                                                     64
Calculation then gives
                                     18                     6
         V      N SN () = 91 +           (2 - 21 ) +                 (3 + 31 )                (78)
                                    N -1             (N - 1) (N - 2)

which suggests, under regularity conditions, the limiting distribution
                            
                                           N 0, 9-   -1
                                 ^TP - 0 D         1
                               N                 0 1 0  .                                     (79)

Associated with the triad probit is a proxy variable regression function estimate of

                                                                
                              q (Wi , Xj , Ri , Sj ; ^TP ) =  Tij ^TP

from which an estimate of the ASF (or differences thereof) can be directly constructed
according to equation (69). This corresponds (essentially) to a dyadic generalization of the
average partial effect (APE) estimator introduced by Chamberlain (1984) in the context of
a correlated random effects probit panel data model.


6.3    Fixed effects approaches
The models introduced above, while allowing for dependence in outcomes across dyads shar-
ing agents in common, restrict its structure. In contrast, Graham (2017) provides a fixed
effects analysis of a model where a undirected binary dyadic outcome is determined according
to
              Yij = 1 [t (Xi ) + t (Xj )] 0 +  (Xi , Xj ) 0 + Ai + Aj - Vij  0 ,        (80)

with Vij standard logistic and independent across dyads. Specifically he studies identifica-
tion and estimation of 0 , leaving the joint distribution of Xi and Ai unrestricted (without
restrictions on this distribution 0 is unidentified (cf., Hausman & Taylor, 1981; Arellano
& Bover, 1995). The parameter of interest, 0 , indexes the strength of any homophilous
sorting on the observables agent attributes in Xi , while {Ai }N
                                                               i=1 indexes unobserved degree-
heterogeneity. Since real world network degree distributions often have high variance (and in
particular fat right tails), incorporating degree heterogeneity may be important in practice
(Barabási & Albert, 1999; Barabási & Bonabau, 2003). Graham (2017) shows how failing to
accommodate degree heterogeneity may attenuate measured homophily (i.e., bias estimates
of 0 ).
Conditional on X = (X1 , . . . , XN ) and A = (A1 , . . . , AN ) , the likelihood for the adjacency
matrix D factors into N
                      2
                           conditionally independent components. Absorbing t (Xi ) 0 into


                                                65
the individual effect Ai , the model consists of the finite dimensional parameter of interest,
0 , and the N incidental heterogeneity parameters, A0 . Let K = dim (0 ); in this model the
number of parameters, K + N , is a function of the order of the network. Since this number
grows with N , the model is non-standard (cf., Holland & Leinhardt, 1981; Chatterjee et al.,
2011).
Graham (2017) analyzes the large network properties of two estimates of 0 . The first esti-
mate, leveraging the implicit "large-N, large-T" structure of dense networks, is the joint
maximum-likelihood one, which also simultaneously estimates the incidental parameters
A0 = (A01 , . . . , A0N ) . The second exploits the exponential family structure of the model and
conditions on a sufficient statistic for A0 . Both estimates have antecedents in the literature
on panel data.


Joint estimators

Let Tij be an N × 1 vector with a one in the ith and j th elements and zeros elsewhere.
The joint-MLE coincides with the logit fit of Yij onto  (Xi , Xj ) and Tij for all i < j .24
Although this estimator involves K + N parameters, it is based upon a criterion function with
  N
  2
     = O (N 2 ) summands. This feature is similar to joint maximum likelihood estimation
in a panel data setting where both N and T are allowed to grow. Here each of N agents
make N - 1 linking decisions; the latter is analogous to "T " in the "large-N, large-T" panel
data setting. As the number of agents in the network grows, so to does the number of
link decisions observed for each of them. This feature of the model allows for consistent
estimation of both 0 and A0 , although, as in the panel data case, there is a bias in the
limit distribution of ^ which must be corrected in order to undertake asymptotically valid
inference (Hahn & Newey, 2004; Arellano & Hahn, 2007).25
Graham's (2017) assumptions imply that the limiting network will be dense. Yan et al. (2018)
show that it is possible to weaken his assumptions somewhat, but it appears impossible to
accommodate asymptotic sequences with sparse limits. In Monte Carlo experiments the joint
MLE works poorly in networks with low density. Researchers are advised to be cautious when
applying this estimator to low density networks.
Dzemski (2018) and Yan et al. (2018) study joint estimation of a directed version of (80).
The former paper presents a method of testing for reciprocity in links as well as for neglected
transitivity.
  24
     Graham (2017) outlines a more convenient nested-fixed-point approach to estimation based upon an
insight due to Chatterjee et al. (2011).
  25
     A technical difficultly involving the inverse Hessian arises in the network setting. A similar challenge is
also present in panel data models with time effects (Fernández-Val & Weidner, 2016).


                                                      66
Conditional estimators

Under the logistic assumption, the likelihood associated with (80) is a member of the expo-
nential family. It turns out that the degree sequence of the network is a sufficient statistic
for A0 (Snijders, 2002). A conditional maximum likelihood estimator could be constructed,
however, unlike in the panel case considered by Chamberlain (1980), the likelihood does
not nicely factor into independent components. It would also be non-trivial to evaluate and
maximize the conditional likelihood (cf., Blitzstein & Diaconis, 2011).
Graham (2017) instead builds a criterion involving tetrads ­ quadruples of agents. A tetrad
is the smallest subgraph that is not completely determined by its degree sequence. For
example, there are three isomorphisms of the two edge graphlet       on four vertices, each
                                                          
with an identical subgraph degree sequence of (1, 1, 1, 1) . If 0 = 0, then conditional on
the event that a randomly sampled tetrad takes one of these three forms, any one of them
occurs with an equal probability of one third. Deviations from this benchmark are possible
when 0 = 0, depending on the configuration of covariates across agents in the sampled
tetrad. Graham's (2017) conditional estimator, which he calls tetrad logit, is based upon
this insight.
The large network properties of the tetrad logit estimate of 0 may be derived in a way
roughly analogous to that of the dyadic regression estimators introduced above. The analysis
in Graham (2017), however, allows for sequences of graphs which are sparse in the limit. This
affects the rate-of-convergence of the tetrad logit estimate. Conveniently its limit distribution
remains normal under both dense and sparse sequences.
Jochmans (2018) provides a conditional analysis, including several worked empirical exam-
ples, of a directed analog of tetrad logit. Nadler (2015) proposes a related estimator for
bipartite networks and presents an empirical application.


6.4    Further reading and open questions
Varin et al. (2011) survey the statistics literature on composite likelihoods. A standard ref-
erence on U-Process minimizers is Honoré & Powell (1994). Many of the results presented in
this section, as well as the previous ones, utilize ideas coming from the theory of composite
likelihood and U-Process minimizers. Connections to panel data have also featured promi-
nently; here I recommend Chamberlain (1980), Chamberlain (1984), Arellano & Honoré
(2001), and Arellano & Hahn (2007).
                                                                                   
The triad probit estimator introduced above has a rate of convergence equal to N . In the
                                                               N
simplest setup the the tetrad logit estimator has a faster     2
                                                                   rate of convergence. This is

                                               67
peculiar because, invoking intuitions familiar from panel data, one would generally expect
an estimate based upon an integrated/random effects likelihood to be more efficient than
one based upon a conditional/fixed effects likelihood. Here the two estimators have different
rates of convergence with, perhaps, a ranking reverse of what one might expect a priori.
van Duijn et al. (2004) use MCMC methods to (essentially) maximize the network likelihood
implied by (72), (73) and (74). Their approach to inference is Bayesian; it would be inter-
esting to formally study the maximum integrated likelihood estimator proper (as opposed
to the triad probit composite likelihood estimator introduced here). What is the rate of
convergence associated with the true random effects maximum likelihood estimator (MLE)?
Likewise, tetrad logit, while inspired by conditional likelihood ideas, is not a conditional
MLE (it is akin to a conditional composite MLE). Graham (2017) describes the conditional
MLE, but does not formally analyze it. Such a formal analysis could be insightful. More
generally we know very little about efficiency in even the simplest of network problems.
The introduction of heterogeneity in this section is restrictive in nature. It allows for what
Graham (2017) calls degree heterogeneity. Methods for incorporating assortative matching
on latent agent-specific attributes would also be useful. For inspiration see, for example,
Krivitsky et al. (2009). Recent ideas from panel data may be useful here too; especially
the work on discrete heterogeneity done by Bonhomme & Manresa (2015). Ideas from the
stochastic block literature ­ which is not surveyed in this chapter ­ might also be useful for
incorporating richer heterogeneity structure into econometric models for dyadic outcomes.



7      Asymptotic distribution theory for network statis-
       tics
Wasserman & Faust (1994) exposit a large post World War II literature on the computation
and interpretation of different statistics of the adjacency matrix. Researchers routinely
report statistics like reciprocity, transitivity, moments of the degree sequence, and diameter
when presenting real world network data. Measures of statistical uncertainty almost never
accompany these reports. The leading approach to assessing whether a reported network
statistic is unusual is to informally compare it with its expected value under an Erdös-
Renyi null or, alternatively, a reference sample of real world networks (e.g., Milo et al.,
2002; Newman, 2010; Graham, 2015).26 Informal simulation-based approaches to "inference"
abound.
  26
    Blitzstein & Diaconis (2011) present an elegant approach based on comparing statistics of the network
in hand to those of the reference set of all graphs with the same degree sequence (i.e., a  -model null).


                                                   68
Large network approaches to hypothesis testing only recently emerged (e.g., Bobollas et al.,
2007; Picard et al., 2008; Bickel et al., 2011). This is currently an active research area (e.g.,
Gao & Lafferty, 2017; Green & Shalizi, 2017; Menzel, 2017), with many open questions.
To be fair, work on the distributional properties of network statistics under specific graph
generation processes, generally the Erdös-Renyi one or close variants, was undertaken earlier.
This work arose largely in response to the seminal papers by Holland & Leinhardt (1970,
1976). Examples include the work of Frank (1979; 1980; 1988), Wasserman (1977) and
Nowicki (1991). The last reference is a useful survey of such analyses.
This section presents results on the large network distribution of induced subgraph frequen-
cies (and various statistics constructed from them). I begin, in Subsection 7.1, with a detailed
analysis of triad counts and their application to inference on the transitivity index or global
clustering coefficient (e.g., Kolaczyk, 2009, p. 96). This is a classic, practically important,
and pedagogically valuable, example. Results on counts of trees and cycles of any order are
available in the Appendix. In Subsection 7.2, I turn to moments of the degree distribution,
an area of intense focus in applied work (e.g., Barabási & Bonabau, 2003; Atalay et al.,
2011; Acemoglu et al., 2012).
Not all common network statistics are covered by the results presented in this section. Statis-
tics such as diameter and average path length, for example, have, to my knowledge, unknown
sampling properties. Subsection 7.3 discusses open questions.
The work surveyed in this section dates to the papers by Holland & Leinhardt (1970, 1976).
More recent contributions, generally by statisticians, were often motivated by examples from
computational biology (e.g., Picard et al., 2008). An especially important contribution is
the paper by Bickel et al. (2011). This section draws heavily from the work by Bickel and
coauthors. Related ideas were used in the discussion of dyadic regression in Section 4. Recent
work on strategic models of network formation, where econometricians play the leading role,
arose separately. However, in Section 8 I argue that ideas from research on subgraph counts
could be valuable there as well. Specifically for structural estimation of strategic network
formation models.
The results in this section are based on the following hypothetical repeated sampling ex-
periment. Let G,N be an infinite exchangeable random graph of interest. The network in
hand, GN , is the one induced by a random sample of N vertices from G,N . Let hN (u, v )
denote the Aldous-Hoover graphon characterizing the infinite graph G,N from which the
econometrician samples N agents independently at random. Note I suppress dependence of
this graphon on the mixing parameter, , since I seek to conduct inference conditional on it
(i.e., conditional on the empirical distribution of [Dij ]i,j N,i<j ).


                                               69
Using the observed network, GN , we construct the statistic tN (GN ). The sampling distribu-
tion of this statistic is the one induced by repeated sampling of N agents from the underlying
infinite graph G,N . To derive a limit distribution I assume there is a sequence of infinite
random graphs {G,N } ­ indexed by N ­ such that

                                    hN (u, v ) = N w (u, v )

with N (possibly) approaching zero as N  . In this way I pair a sequence of increas-
ingly larger "sampled" networks with a corresponding sequence of infinite networks that are
allowed to become increasingly sparser. With this set-up we can study the distribution of
tN (GN ), appropriately scaled, as N  .
As noted earlier, the above thought experiment does not mirror how empirical networks are
constructed in practice. Typically one of two cases obtain. In the first, the network under
study really is a very large graph (e.g., the Facebook graph) and the econometrician really
does sample from it. However, due to spareness, sampling is rarely conducted as described
above. Instead snowball sampling, edge sampling, path sampling etc. are typically used
(Crane, 2018). Understanding how to consistently estimate network statistics and their
sampling distributions under these more exotic data collection schemes is an interesting
topic for future research. In the second case the econometrician works with the complete
graph on some finite population of vertices. In this cases the idea of sampling from an infinite
graph is a thought experiment used to get results that are hopefully useful in practice. It is
this latter, rather commonplace case, which I have in mind here.
There is a subtlety in this second case, already touched upon in Section 3 in the context of
my discussion of the Aldous-Hoover Theorem. A jointly exchangeable random graph with
a finite number of agents need not have a probability law with a conditionally independent
dyad (CID) structure. The pattern of dependence across links in such a network may be
more complicated than that implied by the Aldous-Hoover representation. I conjecture,
by speculative extrapolation based upon the example introduced in Section 3, that this is
especially the case when agents form links strategically. We know, however, that, for N
large enough, joint exchangeability will deliver a probability law for the network that is
of the Aldous-Hoover form. This suggests that, to derive limit theory, it is reasonable to
proceed in the way I do here; but there are missing steps in the argument. Menzel (2016)
represents the only attempt I am aware of to struggle with these issues in a disciplined way.
A more rigorous pairing of the game theoretic models of network formation of interest to
many economists, with the theory of graph limits would be a high priority topic for future
research.


                                              70
7.1     Large network estimation of the transitivity index
In the social sciences, hypothesis formulation often involves graphlet counts (e.g., Holland
& Leinhardt, 1970; Bearman et al., 2004; Choi & Wu, 2009; Jackson et al., 2012; Isakov
et al., 2019).27 Graphlet counts are also used to construct important network statistics like
the transitivity index. It is this last statistic that is studied in this subsection.
After introducing some notation and definitions, I apply the basic approach outlined by
Bhattacharya & Bickel (2015, Proposition 6) to calculate variance expressions for induced
subgraph counts of two-stars ( ) and triangles ( ). While this is a relatively straightfor-
ward extension, it does require some carefully constructed notation.28 Asymptotic normality
of these counts, appropriately scaled, follows from their results. An analysis of transitivity
in the Nyakatoke risk-sharing network studied by De Weerdt (2004) illustrates the practical
application of these ideas.
A special case of a CID model is the Erdös-Renyi graph generation process (i.e., h (u, v ) = 
for some 0 <  < 1 and all (u, v )  [0, 1]2 ). The behavior of subgraph counts under this
GGP were studied by Nowicki and co-authors in the late 1980s and early 1990s (Nowicki &
Wierman, 1988; Janson & Nowicki, 1991; Nowicki, 1991). It turns out that this case exhibits
a form of degeneracy. Specifically, the leading terms in the variance expressions presented
below are identically zero under the Erdös-Renyi graph generation process. Subgraph fre-
quencies remain asymptotically normal in this case, but with a faster rate of convergence.
A separate treatment of this case is provided below.


Notation and estimation

Recall from Section 3 that the induced subgraph frequency of S in GN is

                                                1
                            PN (S ) =                                 1 (S = GN [ip ]) .                   (81)
                                          N
                                          p
                                              |iso (S )| ip C
                                                                p,N


Under the maintained sampling scheme it is easy to see that (81) is an unbiased estimate of
P (S ) = tind (S, h), the "population" induced subgraph density.
Consider the two-star (        ) and triangle (       ) triad configurations. Applying (81) gives the
  27
     In practice it is easier to derive results for homomorphism frequencies and, not coincidentally, the theory
of graph limits generally works with homomorphisms.
  28
     One could even argue that these expressions are already implicit in Holland & Leinhardt (1976), although
they did not explore the properties of their expressions under sparse versus dense graph sequences, nor did
they analyze rates of convergence. Indeed, Wasserman & Faust (1994, p. 580), referring to the covariance
calculations of Holland & Leinhardt (1976), comment that they "can be time-consuming to calculate (and
maybe even difficult to comprehend)".


                                                       71
estimates

                           N -1 1
               PN (   )=   3
                                              [Di1 i2 Di1 i3 (1 - Di2 i3 ) + Di1 i2 (1 - Di1 i3 ) Di2 i3         (82)
                                  3i
                                     3 C3,N


                           + (1 - Di1 i2 ) Di1 i3 Di2 i3 ]
                           N -1
               PN (   )=   3
                                            Di1 i2 Di1 i3 Di2 i3 .                                               (83)
                                  i3 C3,N


From (82) and (83) we can construct an estimate of the transitivity index or global clustering
coefficient:

                        3 × (# of triangles)                  PN ( )                               QN (    )
       TIN =                                           =                                       =             .   (84)
               (# of two-stars) + 3 × (# of triangles)   P N ( ) + PN (                    )       QN (    )

Under an Erdös-Renyi graph generation process it is easy to show that (84) should be close to
the density of the network (e.g., Graham, 2015). Gao & Lafferty (2017) develop a test based
                                                                                             
on this idea. If, suitably normalized, the limit distribution of the vector (PN ( ) , PN ( ))
can be characterized, then delta methods can be used to conduct large network inference on
transitivity. This idea is developed in detail below.
Distribution theory for induced subgraph counts may also be useful for structural model
estimation via the method of (simulated) minimum distance. In this approach model pa-
rameters are estimated by matching model-implied values of subgraph counts with their em-
pirical counterparts. Sampling uncertainty in such estimates, stems from the corresponding
uncertainty about the reduced form subgraph counts being matched. This idea is developed
more completely in Section 8.


Graphlet Stitchings

In developing an interpretable expression for the variance of graphlet counts, it is helpful to
introduce something I will call a graphlet stitching.29
Let R and S be two pth order subgraphs of interest to the econometrician. Furthermore, let
ip and jp be two p-tuples drawn independently at random from Cp,N (as defined in Section
3.5 above). The (scaled) covariance of the events "GN [ip ] is isomorphic to R" and "GN [jp ]
  29
    After completing the initial draft of this Chapter I discovered independent work by Green & Shalizi
(2017) that develops a closely related concept which they call "merged copy sets". Graphlet stitchings, as
I define them, are more suited to my specific needs; although both approaches lead to the same answer in
the end. The basic idea is already implicit in Bhattacharya & Bickel (2015) (and really even Holland &
Leinhardt (1976)). Essentially the same idea is also used in Graham (2017) to derive large network theory
for Tetrad Logit.



                                                            72
is isomorphic to S ", when there are q integers/vertices common to ip = {i1 , i2 , . . . , ip } and
jp = {j1 , j2 , . . . , jp }, is

                                  q (R, S ) =  (Wq,R,S ) - P (R) P (S )                                        (85)

where P (R) is the induced subgraph density defined in equation (11) and

                                         def E [1 (R   = GN [ip ]) 1 (S  = GN [jp ])]
                             (Wq,R,S )                                                                         (86)
                                                        |iso (R)| |iso (S )|

Here Wq,R,S is notation for a set of what I call graphlet stitchings. In order to understand
the structure of  (Wq,S,R ) further we need a formal definition.

Definition 5. (Graphlet Stitching) Let Wq,R,S be the graph union of R and S , labelled
isomorphisms of two graphlets of interest, if
(i) V (R)  V (G) and V (S )  V (G);
(ii) |V (R)| = |V (S )| = p vertices each;
(iii) |V (R)  V (S )| = q vertices in common;
(iv) identical structure across all vertices in common (i.e., (i, j )  E (R)  (i, j ) 
E (S )  i, j  V (R)  V (S )),
then Wq,R,S is a graphlet stitching of R and S .

Next define the set of all feasible stitchings of R and S which satisfy Definition 5 as Wq,S,R .
When R and S belong to the same isomorphism class write Wq,S,S = Wq,S .
Requirement (iv) of Definition 5 is constraining. It implies, for example, that some pairs of
labelled two-stars cannot be stitched together. For example R = ({1, 2, 3} , {(1, 2) , (1, 3)})
and S = ({1, 2, 4} , {(1, 4) , (2, 4)}) cannot be logically stitched together because the (1, 2)
edge is present in R but not S . This violates requirement (iv) of Definition 5. Note also that
the set Wq,S,R may contain elements which are isomorphic to one another.
For simplicity consider the vertices 1, 2, . . . , p, p + 1, . . . , 2p - q in GN .30 If R, defined on
vertices 1, 2, . . . , p , is isomorphic to the subgraph of GN induced by vertices {1, . . . , p} and
S , defined on vertices vertices p - q, . . . , 2p - q , is isomorphic to the subgraph of GN induced
by vertices {p - q, . . . 2p - q }, then it must be the case that the union of these two induced
subgraphs is an element of Wq,S,R . This gives the equality

                                       Pr (W = GN [{1, . . . , p}]  GN [{p - q, . . . , 2p - q }])
            (Wq,S,R ) =                                                                            .           (87)
                           W Wq,S,R
                                                        |iso (R)| |iso (S )|

  30
    Since GN is induced by a random sample of vertices, vertices 1, 2, . . . , p, p + 1, . . . , 2p - q correspond to
a random 2p - q tuple.


                                                         73
Note that the graph union of GN [{1, . . . , p}] and GN [{p - q, . . . , 2p - q }] may differ from
the subgraph induced by the union of the two overlapping vertex sets:

               GN [{1, . . . , p}]  GN [{p - q, . . . , 2p - q }] = GN [{1, . . . , 2p - q }] .

This is because the union of GN [{1, . . . , p}] and GN [{p - q, . . . , 2p - q }] will not include
any edges between {1, . . . , p - q - 1}, the vertices in R alone, and {p + 1, . . . , 2p - q }, the
vertices in S alone, while GN [{1, . . . , 2p - q }] may. By exchangeability the right-hand-side
of (87) is the same for any vertex sets ip = {i1 , i2 , . . . , ip } and jp = {j1 , j2 , . . . , jp } sharing,
as is implicitly assumed in what follows, q vertices in common.
To check whether R    = GN [ip ] and S    = GN [jp ] we therefore check whether GN [ip ]  GN [jp ]
coincides with a particular (labeled) graphlet stitching of R and S . Doing so, in turn, requires
us to check for the presence or absence of only p (p - 1) - 2  q
                                                                 potential edges. The presence
or absence of the (p - q )2 possible edges from the vertices unique to R to those unique to
S is immaterial. Equation (86) gives neither an induced or partial subgraph frequency, but
what I will call a graphlet stitching frequency.


Calculating graphlet stitching frequencies

To understand how to calculate graphlet stitching frequencies in practice it is helpful to work
through a few examples. Figure 5 shows all the elements of W1, on vertex set {1, 2, 3, 4, 5},
with vertex 1 being the vertex in common. The top row shows all isomorphisms of               on
vertices {1, 4, 5}, while the left-most column shows all such isomorphisms on vertices {1, 2, 3}.
The nine figures in the corresponding grid show all the associated graphlet stitchings.
A more complicated example is provide by W2, , which is shown in Figure 6. The format
of the figure is the same as that of Figure 5. The two vertices in common are 1 and 2. An
interesting feature of this example is that not all graphlet stitchings are feasible.
In evaluating  (Wq,S,R ) it is helpful to observe that Wq,S,R                                may
include     multiple     isomorphisms       of      the     same     graph.            Since  the
probabilities              Pr (W = GN [{1, . . . , p}]  GN [{p - q, . . . , 2p - q }])       and
                                                                                         
Pr (W = GN [{1, . . . , p}]  GN [{p - q, . . . , 2p - q }]) coincide when W and W are iso-
morphic to one another, we can also "represent" Wq,S,R as a multi-set, with one (arbitrary)
labelling of each of the non-isomorphic graphlet stitchings retained as elements, but with
multiplicities equal to the number of isomorphic appearances. For example, the cardinality
of W1,      is |iso ( )| × |iso ( )| = 9, but with only three non-isomorphic elements.



                                                     74
Inspecting Figure 5 we define the multi-set:

                         W1
                          m
                           ,
                                   = ({    ,    ,     } , {(     , 1) , (     , 4) , (   , 4)}) .

Let q,R,S (W ) denote the multiplicity of W in Wq,R,S
                                                m
                                                      ; for example the multiplicity of                                  in
W1m
   ,
      is 1, ( ) = 4.

We then have that, using equation (87), the equality  W1
                                                       m
                                                        ,
                                                                                             =  W1,           . Similarly,
inspecting W2,      (see Figure 6) , we see that it also contains three non-isomorphic elements,
yielding
                         W2
                          m
                           ,
                                   = ({    ,    ,     } , {(     , 2) , (     , 2) , (   , 1)}) .

Finally, it is easy to see that W3
                                 m
                                   ,
                                               = ({    } , {(      , 3)}). The reader may verify that

     W1
      m
       ,
             = ({    } , {(    , 1)}) , W2
                                         m
                                          ,
                                                    = ({       } , {(   , 1)}) , W3
                                                                                  m
                                                                                   ,
                                                                                             = ({    } , {(    , 1)})

as well as that

  W1
   m
    ,    ,
             = ({    ,    } , {(    , 1) , (    , 2)}) , W2
                                                          m
                                                           ,        ,
                                                                            = ({    } , {(   , 2)}) , W3
                                                                                                       m
                                                                                                        ,      ,
                                                                                                                   = .

                                                                                                       
These multi-sets will be used to study the covariance of (PN (                            ) , PN (   )) as well as the
variance of the transitivity index.
At the risk of overkill, the following calculations illustrate how the two stitching probabil-
ity definitions, equations (86) and (87), coincide. For the two-star example, starting with




                                                           75
             Figure 5: Stitchings of two-star graphlets with one common node




Notes: Depiction of all possible ways to join (or "stitch") a pair of two-star ( ) subgraphs
together with one node in common. Each of the resulting subgraphs is a pentad wiring. The
dashed gray edges involve pairs of nodes that are not common across the pair of two-stars. Hence
the subgraph induced by the five nodes in the pentad may or may not include these edges. The set
W1,    has iso      × iso        = 9 elements.
Source: Author's calculations.




                                              76
equation (86), I get

                  Pr (          = GN [{1, 2, 3}] &   = GN [{1, 4, 5}])
   W1,        =                                    2
                                          |iso ( )|
                         1
              =                     2 E [{D12 D13        (1 - D23 ) + D12 (1 - D13 ) D23 + (1 - D12 ) D13 D23 }
                  |iso (        )|
                 × {D14 D15 (1 - D45 ) + D14 (1 - D15 ) D45 + (1 - D14 ) D15 D45 }]
                      1
              =          2 {E [D12 D13 (1 - D23 ) D14 D15 (1 - D45 )]|
                |iso ( )|
                  + 4E [D12 D13 (1 - D23 ) D14 (1 - D15 ) D45 ]
                 +4E [D12 (1 - D13 ) D23 D14 (1 - D15 ) D45 ]}
                      1
              =          2 1,   ( ) Pr ( = GN [{1, 2, 3}]  GN [{1, 4, 5}])
                |iso ( )|
                  + 1,           (        ) Pr (     = GN [{1, 2, 3}]  GN [{1, 4, 5}])

                  +1,           (     ) Pr (        = GN [{1, 2, 3}]  GN [{1, 4, 5}])

              =                      1,       (W ) Pr (W = GN [{1, 2, 3}]  GN [{1, 4, 5}])
                  W W m
                           1,



              = W1
                 m
                  ,
                                          .                                                                  (88)


The third equality follows from relationships like E [D12 D13 (1 - D23 ) D14 (1 - D15 ) D45 ] =
E [D12 D13 (1 - D23 ) (1 - D14 ) D15 D45 ], which allow for the grouping together of terms. The
balance of the equalities are consequences of the definitions given above.


Sampling variances

With the above notations in hand, I now calculate the sampling variances of P     ^ ( ) and
PN ( ) as well as their covariance. Holland & Leinhardt (1970, 1976) were the first to derive
variance expressions for subgraph counts. The specific development presented here follows
Bhattacharya & Bickel (2015). A Hoeffding (1948) variance-composition gives

                                               -2    3
           PN (    )                      N                N     3    N -3        q ( )   q ( , )
    V                           =
           PN (    )                      3         q =0
                                                           3     q    3-q         q ( , ) q ( )

with q ( ), q ( ) and q ( , ) as defined by (85) above (using the shorthand
q (S, S ) = q (S ) etc). Using the fact that each of these variances and covariances is


                                                                77
            Figure 6: Stitchings of two-star graphlets with two common nodes




Notes: Depiction of all possible ways to join (or "stitch") a pair of two-star ( ) subgraphs
together with two nodes in common. Each of the resulting subgraphs is a tetrad wiring. The
dashed gray edges involve the pair of nodes that is not common across the pair of two-stars. Hence
the subgraph induced by the four nodes in the tetrad may or may not include this edge.
Source: Author's calculations.




                                               78
zero when q = 0 and reorganizing terms gives
                                                                                                                   
              PN (       )        N
                                       -2       3
                                                    N       3        N -3           Wq,            Wq,
    V                        =
                                                                                                               ,
                                                                                                                   
              PN (       )        3          q =1
                                                    3       q        3-q    Wq,                        Wq,
                                                                                          ,
                                                                               2
                                              (N - 3)!2                 P( )         P ( )P ( )
                                 - 1-                                                                      .
                                             N ! (N - 6)!            P ( )P (      )    P( )
                                                                                             2



In what follows I assume that the network generating process is such that, for each N , q ( )
and q ( ) are not identically equal to zero for q  1. This prevents PN ( ) and PN ( )
from exhibiting degenerate U-Statistic-like attributes (c.f., Graham, 2017, Theorem 1). The
restriction is a real one, ruling out the Erdös-Renyi case. Separate results for this special
case are presented below.
As introduced earlier, in order to accommodate sequences of networks with varying degrees
of sparsity, we can index the underlying population graphon by N , setting hN (u, v ) =
N w (u, v ) with w (u, v ) = f Ui ,Uj |Dij ( u, v | Dij = 1) and allowing N  0 as N  . Under
such a sequence of GGPs P ( ) and P ( ) will tend to zero. In order to understand the
properties of PN ( ) vis-a-vis P ( ) we must normalize. It is natural to normalize according
to the number edges in the subgraph under consideration.
Let P~ ( ) = P ( ) /3 , P      ~ ( ) = P ( ) /2 , P           ~N ( ) = PN ( ) /3 and so on. So
                                  N                                  N                            N
normalizing I get
                                                                                                                          
            ~N (
            P        )           N
                                      -2    3
                                                    N   3       N -3            -
                                                                                N  Wq,
                                                                                  6
                                                                                                      -
                                                                                                      N  Wq,
                                                                                                       5

V                            =
                                                                                                                   ,
                                                                                                                          
            ~N (
            P        )           3         q =1
                                                    3   q       3-q   -
                                                                      N  Wq,
                                                                       5
                                                                                                      -
                                                                                                      N  Wq,
                                                                                                        4
                                                                                              ,

                                            (N - 3)!2              ~ ( )2
                                                                   P        ~ ( )P
                                                                            P      ~( )
                                 - 1-                                                                  .           (89)
                                           N ! (N - 6)!         ~ ( )P
                                                                P      ~( )    ~ ( )2
                                                                               P

Expression (89) agrees with the corresponding expression of Bhattacharya & Bickel (2015) for
injective homomorphism frequencies (Equation (3.8), p. 2395).31 The main difference is the
analog of  Wq,       in their expression is itself an injective homomorphism density, whereas
here  Wq,       is neither an injective homomorphism nor an induced subgraph density and
instead involves checking for particular patterns of both adjacency and non-adjacency as
described above.
    31
         See also Green & Shalizi (2017, Lemma 1).




                                                                79
Rates of convergence

To understand the rate of convergence in mean square of, for example, P  ~N ( ) toward
~ ( ), we need to determine the order of each of the terms in (89). Let e (R) def
P                                                                              |E (R)|
               def
and e (S )  |E (S )| denote the number of edges in graphlets R and S . Next observe that
 N -1 p N -p
 p     q   p-q
               = O (N -q ). We therefore have that the terms in the summation indexed by q
                          -e(R) -e(S )
in (89) are O N -q N N         O ( (Wq,R,S )) for q = 1, . . . , p. I divide these terms, closely
following Bhattacharya & Bickel (2015), into three cases:
Case 1 (q = 1): when q = 1 the number of edges in all elements of Wq,R,S equals e (R)+ e (S )
                                                         e(R) e(S )
for any subgraphs R and S . Hence O ( (W1,R,S )) = O N N , yielding

                                         -e(R) -e(S )
                           O N -1 N           N                 O ( (W1,R,S )) = O N -1 .

The q = 1 summand in (89) is of order N -1 . In general, from the theory of U-statistics, one
would expect this to be the leading variance term; however, the present situation is more
complicated.
Case 2 (q = 3 or q = p): In this case the order of  W3,                                   N ),  W3,
                                                                                    is O (3                 is O (2
                                                                                                                  N)

and W3, , is empty so that  W3,                         ,
                                                                 = 0. Therefore, recalling that N = (N - 1) N
equals average degree,

                                                 -2e(       )
                                O N -3 N                         O  W3,             = O -
                                                                                        N
                                                                                         3


                                                 -2e(       )
                                O N -3 N                         O  W3,             = O N -1 -
                                                                                             N
                                                                                               2


                                -e(      )   -e(    )
                     O N -3 N                N              O  W3,           ,
                                                                                    = o (1) .


Case       3     (q = 2    or    (2  q  p - 1)):                      Here   the   order     of    W2,         equals
     2e(       )-(q-1)                                                       2e(   )-(q-1)
O N                            N ),  W2,
                          = O (5                                equals O N                      = O ( 3
                                                                                                      N ) and that of




                                                                 80
                       e(     )+e(      )-(q-1)
 W2,     ,
              equals O N                           = O (4
                                                        N ) . Therefore



                                      -2e(   )
                         O N -2 N                 O  W2,             = O N -1 -
                                                                              N
                                                                                1


                                      -2e(   )
                         O N -2 N                 O  W2,             = O N -1 -
                                                                              N
                                                                                1


                        -e(   )   -e(    )
               O N -2 N           N          O  W2,         ,
                                                                     = O N -1 -
                                                                              N
                                                                                1
                                                                                  .

For the two variance terms we have

                                             1           1                 1
                    V P
                      ~N (    ) =O                +O                +O
                                             N          N N                3N
                                             1           1                  1
                    V P
                      ~N (    ) =O                +O                +O
                                             N          N N                N 2N

                                                ~N ( ) converges in mean square toward
indicating that the rate at which, for example, P
P~ ( ), depends on the behavior of average degree as the network grows large. This reflects
the fact that, depending on a combination of the nature of the graphlet of interest and the
rate at which N does, or does not, grows with N , several of the terms in (89) may be of
equal order.
For any increasing sequence of average degree we have

                                                                    1 1
                                  V P
                                    ~N (         ) =O max            ,
                                                                    N 3N
                                                        1
                                  V P
                                    ~N (         ) =O
                                                        N
                                                        1
                       C P
                         ~N (        ~N (
                                   ),P           ) =O           .
                                                        N
                                                 
If N  CN 1/3 , then the rate of convergence is N for both P     ~N ( ) and P ~N ( ). In the
sparse case, with N  , P     ~ ( ), due to the acyclic structure of the two-star graphlet,
                         
remains estimable at the N rate. However in this case all three of its variance terms are of
                         ~ ( ) is (evidently) not consistently estimable in the sparse case.
equal order. In contrast P


Asymptotic normality

When average degree is N > CN 1/3 , such that both P   ~N ( ) and P ~N ( ) converge at the

 N rate, an application of Theorem 1.c of Bickel et al. (2011) establishes that, under some


                                                  81
regularity conditions,

                ~N (
                P      )-P
                         ~(       )    D          0              ~1 ( )
                                                                         ~1 ( , )
                                                                         
           N                           N                   ,9                       ,     (90)
                ~N (
                P      )-P
                         ~(       )               0             ~1 ( , )
                                                                          ~1 ( )
                                                                          

where  ~ 1 ( ) = -6 1 ( ),    ~ 1 ( , ) = -5 1 ( , ) etc. Proving (90) is relatively
                   N                          N
straightforward. I do not sketch the argument here, but note that the main tools needed
were already introduced in the analysis of dyadic regression appearing in Section 4 above.
As noted previously, if N   as N   such that the network is sparse in the limit, then
                     
a general result on N P     ~N ( ) - P~ ( ) is unavailable. In contrast, part (b) of Theorem
                                                                   
                                                     ~N ( ) remain N consistent for P
1 in Bickel et al. (2011) implies that not only does P                                 ~( )
                               
in this case, but also that N P      ~N ( ) - P ~ ( ) remains asymptotically normal. The

limiting variance in this case differs from the one given in (90); all terms in V P
                                                                                  ~N (   ) are
of equal order (and hence should be retained).
More generally the sampling properties of induced subgraph frequencies under sparse graph
limits remains relatively unexplored. The sensitivity of rates of convergence and distribu-
tional properties to assumptions about N raises concerns about uniformity of inference
procedures. A similar concern is suggested by the properties of these statistics when the
graphon is constant. This last case is considered next.


Two-star and triangle counts in Erdös-Renyi networks

The      analysis      above     assumes      that the    graphon      is    such     that
                           
C (1 (R = GN [ip ]) , 1 (S = GN [jp ])) = 0 when ip and jp share exactly one index in
common (such that  (W1,S ) - P (S )2 > 0). This condition will generally hold for graphons
which vary in u and v (such that the events D12 = 1 and D13 = 1 are not independent),
but it does rule out the Erdös-Renyi case (where links form independently with constant
probability ).32 This graph generation process has been extensively studied by probabilists
for over sixty years (e.g., Janson et al., 2000).
In statistics, Janson & Nowicki (1991) and Nowicki (1991) studied the sampling properties
of induced and partial subgraph frequencies when the network is an Erdös-Renyi one. They
                                                                      N
demonstrated asymptotic normality of such frequencies with a          2
                                                                         rate of convergence.
These earlier results, at first glance, appear to be in tension with the more general results
                                                                     
of Bickel et al. (2011), who showed asymptotic normality with a N rate of convergence
under general graphons. It turns out, however, that the leading (i.e., q = 1) term in (89) is
 32
      See Menzel (2017) for more examples of degenerate graphons.


                                                      82
identically equal to zero under the Erdös-Renyi GPP. The Erdös-Renyi GPP is a "degenerate"
special case.
To see this, evaluate the stitching probabilities (87) under the Erdös-Renyi GPP to get

                                          4           1                               1
 W1,        = 4 (1 - )2 ,  W2,           = 3 (1 - )2 + 4 (1 - ) ,  W3,               = 2 (1 - )
                                          9           9                               3

and


                      W1,          = 6 ,  W2,       = 5 ,  W3,          = 3

and

                                                      2
         W1,     ,
                       = 5 (1 - ) ,  W2,        ,
                                                     = 4 (1 - ) ,  W3,         ,
                                                                                      = 0.
                                                      3

Under these graphlet stitching probabilities the q = 1 variance term, which is generally the
leading variance term in Bickel et al. (2011, Theorem 1), instead equals

                               1 ( )   1 ( , )
                                                            = 02 02 .
                               1 ( , ) 1 ( )

Hence, under the (dense) Erdös-Renyi GPP, the leading variance term is instead the q = 2
one, yielding for 0 <  < 1 but  = 2/3,

              PN (    )-P (    )     D          0        2 ( )   2 ( , )
        N
                                     N              ,9                                       (91)
        2
              PN (    )-P (    )                0        2 ( , ) 2 ( )

where

             2 ( )   2 ( , )                                  2         1
                                                                           (2 - 3)
                                          = 3 (1 - )                    3
                                                                                       .
             2 ( , ) 2 ( )                               1
                                                         3
                                                            (2 - 3)     1
                                                                        9
                                                                          (2 - 3)2

See Corollaries 2 and 4 of Nowicki (1991) for additional context and references to the primary
literature.


Uniform Inference

The analysis of the previous two subsections showed how the limiting distributions of two-
star and triangle frequencies are sensitive to the form of the graphon, hN (u, v ) = N w (u, v ).
If N approaches zero too quickly, or w (u, v ) is a constant, the rate of convergence of the

                                               83
                                Figure 7: Nyakatoke risk-sharing network




Sources: De Weerdt (2004) and authors' calculations. `TSh' is an abbreviation for Tanzanian
Shillings.

estimator changes. This raises concerns about how to conduct inference in settings where
the limiting graph is `close to sparse' and/or the graphon is `nearly' constant, or equivalently,
dependence across dyads sharing agents in common is weak. In such settings an approach
to inference based on (90), may have poor properties when N is finite. This is because the
q = 1, q = 2 and q = 3 terms in the variance expression (89) may all be of similar order. For
this reason, it seems advisable to keep all terms when calculating variances for test statistics.
Clearly, there are open questions on how best to undertake testing in this setting.


Application of results to inference on transitivity in Nyakatoke

De Weerdt (2004) collected information of risk-sharing relationships across 119 houses in
Nyakatoke, a small village in Tanzania (see Figure 8). The density of this network is 0.0698,
while its transitivity index is 0.1884, nearly three times a large. A natural question is whether
the high transitivity index simple reflects "chance" or is a real feature of Nyakatoke. To assess
this I construct a confidence interval for the transitivity index using the delta method and
the results outlined above. Other than the empirical illustration included in Bhattacharya
& Bickel (2015), I am aware of no other published examples of large network inference on
the transitivity index.
The natural analog estimates of  W1,                ,  W1,      , and  W1,     ,
                                                                                    involve summa-
                         N -3
tions over all   N
                 3
                     3
                     1   3-1
                                 = 30 ×   N
                                          5
                                              pairs of triads sharing exactly one common agent. This

                                                     84
requires evaluating the configuration of all N
                                             5
                                                pentads in the network; a computationally
non-trivial task even for medium-sized networks.33 It is for this reason that Bhattacharya &
Bickel (2015) suggest a subsampling approach to variance estimation.
For the Nyakatoke network we have a total of 119
                                               3
                                                   = 273, 819 triad configurations to count
               119
and a total of 5 = 182, 637, 273 pentads that need to be inspected in order to calculate
variances. These are large numbers, but nevertheless small enough enough for a desktop
computer to handle in a few minutes. Direct calculation gives

                                         0.00115                     0.00496
                          PN (    )=              , PN (       )=
                                        (0.00030)                   (0.00100)

These standard errors include estimates of both the first and last terms in (89) above,
although the second of these is asymptotically negligible as long as average degree grows fast
enough (which is assumed for the asymptotic normality result).
Applying the delta method I get an estimated standard error for the transitivity index of
0.011; this suggests that transitivity is significantly greater than what we would expect to
observe under the Erdös-Renyi random graph null.


7.2     Moments of the degree distribution
Networks are complex objects, making their analysis both conceptually and technically chal-
lenging. One approach to simplification involves looking only at the number of links each
agent has, that is their degree, Di+ = j =i Dij , ignoring all other architectural features of
the network. Indeed, a substantial empirical literature focuses on the degree sequence of a
network as its primary object of interest (Barabási & Albert, 1999; Barabási, 2016).
Most real world networks exhibit substantial degree heterogeneity, making the degree se-
quence an interesting statistic to study and model. A network's degree sequence is also
straightforward to measure. A researcher need only ask about the number of friends, sup-
pliers, or partners each agent has, not their identity. Many general purpose datasets collect
such information. For example General Social Survey (GSS) sometimes collects informa-
tion on the number of close confidants (cf., Marsden, 1987; McPherson et al., 2006), while
demographers routinely collect information on the number of lifetime and/or concurrent
sexual partners. Simplicity and data availability both drive the substantial focus on degree
distributions in empirical work.
  33
    For each pentad we look at the thirty pairs of triads that can be constructed from it, such that the two
triads share exactly one agent in common.



                                                    85
It is possible for two graphs with the same degree sequence to be topologically different; their
diameters and transitivity indices, for example, may differ substantially. At the same time a
network's degree sequence is an important summary statistic, constraining other features of
it, even local ones. This is shown by Theorem 3, which I believe is an original result (albeit
perhaps folk wisdom; cf., Snijders et al., 2006).

Theorem 3. (Degree Sequence Moments) Let G be an exchangeable random graph of
order N . The mth moment of Di+ = j =i Dij equals

                                              m
                           E    m
                               Di +     =           Ck,m × E [Dij1 × · · · × Dijk ]
                                             k=1


                                               N -1
for m = 1, 2, . . . , N - 1 and Ck,m =          k
                                                                           m!
                                                                pPk,m p1 !×···×pk !       with

                                                     k
                Pk,m =     ( p1 , . . . , p k ) :          pj = m, pj  N for j = 1, . . . , k
                                                    j =1


and N the set of positive integers.

Proof. See Appendix A.

Theorem 3 implies that the first four uncentered moments of Di+ equal

                     E [Di+ ] = (N - 1) P (                )                                              (92)
                    E Di
                       2
                         + = (N - 1) P (                   ) + (N - 1) (N - 2) Q (               )        (93)
                    E Di
                       3
                         + = (N - 1) P (                   ) + 3 (N - 1) (N - 2) Q (                 )    (94)
                                  + (N - 1) (N - 2) (N - 3) Q (                       )
                    E    4
                        Di +   = (N - 1) P (               ) + 7 (N - 1) (N - 2) Q (                 )    (95)
                                  + 6 (N - 1) (N - 2) (N - 3) Q (                         )
                                  + (N - 1) (N - 2) (N - 3) (N - 4) Q (                              ).

In dense networks it is natural to divide Di+ by N - 1. With degrees so normalized, all terms
in equations (92) to (95) are asymptotically dominated by the last one as N  . Hence, in
the limit, the k th moment of normalized degree equals the injective homomorphism density
of k -stars in the limiting graphon (cf., Diaconis et al., 2008, Lemma 4.1). In the dense case




                                                               86
we have, for example, that

                                      Di+
                         lim V               = Q(    )-P (       )P (   ).                           (96)
                        N            N -1

When the network is not dense, the natural normalization is instead by average degree,
N = (N - 1) N , which may no longer be proportional to N in the limit. In the sparse case,
N  , and all terms in equations (92) to (95) are of equal order. For example, the fourth
uncentered moment of Di+ /N equals, in a sparse limit,

                                 4        ~ ( ) 7Q
                                                 ~ ( ) 6Q
                                                        ~( )
                          Di+             P
                lim E                 =        +      +       ~(
                                                             +Q                   ),
               N          N                 3     2       

where a tilde above a subgraph/homomorphism density, as earlier, denotes the density di-
vided by N raised to the power of the number of edges in the subgraph under consideration
       ~ ( ) = Q ( ) /2 ).
(e.g., Q                N

From (92) and (93) have that, in the sparse case,

                             Di+                                        ~( )
                                                                        P
                    lim V               ~(
                                      = Q     )-P
                                                ~(          ~(
                                                           )P    ) +         .                       (97)
                   N         N                                            

There are several peculiarities in these expressions. Returning to the dense case, when the
graph is an Erdös-Renyi homogenous random graph, Q ( ) = P ( ) P ( ) , and (96)
indicates that the distribution of Di+ / (N - 1) is degenerate in the limit. In that case
                    
normalizing Di+ by N - 1 results in a random variable with a non-degenerate variance in
the limit since

    V (Di+ ) = (N - 1) (N - 2) [Q (       )-P (     )P (   )] + (N - 1) P (      ) (1 - P (   )) .

Observations such as these suggest that, as with subgraph frequencies, it may be desirable
to retain all terms ­ including nominally asymptotically dominated ones ­ when calculating
the variance and other moments of the degree distribution.
Atalay et al. (2011) construct a theoretical model of supply chain formation. They informally
assess the plausibility of a calibrated version of their model by comparing their model-
predicted degree sequence with the one observed in the US Buyer-Supplier network (see their
Figure 1). A formal minimum 2 type specification test of their model could be constructed
on the basis of Theorem 3.




                                               87
7.3    Further reading and open questions
Subgraph frequencies are, in many ways, analogous to moments of a distribution. Relatedly
methods of estimation and inference for subgraph frequencies have many applications, from
attaching a measure of uncertainty to statistics like the transitivity index, to facilitating
specification testing and model estimation. As the discussion here shows, the large network
properties of empirical subgraph frequencies depend on the nature and magnitude of depen-
dence across links induced by the graphon as well as properties like sparsity. Formulating
methods of inference for subgraph frequencies that are adaptive to these features of the GGP
would be useful. Menzel (2017) makes some progress in this direction, but substantial work
remains.
Volfosky & Airoldi (2016), extending results due to Diaconis & Freedman (1980), present
results relating finitely and infinitely exchangeable arrays. Results of this type could be
useful for understanding how best to proceed when the network in hand corresponds to the
equilibrium of an N -player game where the conditional independence structure associated
Aldous-Hoover type GGPs may not formally hold, but where ­ for N large enough ­ it
should hold approximately.
Bhattacharya & Bickel (2015), Green & Shalizi (2017) and Menzel (2017) discuss subsam-
pling and bootstrap methods for exchangeable random arrays. Adapting ideas introduced
by, for example, Menzel (2017) to accommodate sparse networks would be theoretically
interesting and practically useful.
I have emphasized more recent work on subgraph frequencies, but the earlier papers, begin-
ning with the seminal one by Holland & Leinhardt (1976) are rewarding to read (or re-read)
in the light of contemporary developments. The survey paper by Jackson et al. (2017)
presents many real work examples of degree distributions and other network statistics. This
paper also relates these measures to theoretical ideas in the economic literature on network
formation and network games.
A rather different approach to asymptotic analysis of network statistics builds off the prob-
ability literature on random geometric graphs (Penrose, 2003). These models posit a strong
form of homophily such that agents which are far apart from one another (in some, perhaps
latent, space) link infrequently (or not at all). The (latent) spatial structure renders agents
non-exchangeable. This mechanism generates sufficient independence among distant units
such that LLNs and CLTs can be proven. Leung (2019), Kuersteiner (2019), and Leung
& Moon (2019) develop these ideas to prove LLNs and CLTs for network statistics where
the observed network is assumed to be a strategic network equilibrium configuration. A
challenge of this approach is that valid inference appears to require information on agents'

                                              88
positions (so that HAC type variance estimators can be used). Unfortunately it is often
most natural to view such positions as latent (e.g., Hoff et al., 2002; Krivitsky et al., 2009).
Nevertheless, this approach, by building on insights from the literature of random geometric
graphs, as well as spatial statistics, seems well calibrated to some network applications. For
example, sparseness seems to be easier to handle in this framework (cf., Graham, 2016).
Understanding the connections between approaches to large network inference based upon
random geometric graphs versus exchangeable random graphs remains, to my knowledge,
largely unexplored.



8    Strategic models of network formation
The models of network formation introduced in Sections 4, 5 and 6 are externality free:
the utility two agents create by forming a link is invariant to the presence or absence of
links elsewhere in the network. In contrast, the theoretical literature on network formation,
beginning with the seminal paper by Jackson & Wolinsky (1996), is decidedly focused on
the study of models where agents' preferences are interdependent. That is, the utility dyad
{i, j } generates by forming an edge may vary with the presence or absence of additional
edges elsewhere in the network. For example, if i and j share many neighbors ("friends")
in common, they may reap utility gains from `triadic closure' when linking; incidentally also
forming many triangles (Simmel, 1908; Coleman, 1988; Jackson et al., 2012).
Models with interdependencies in preferences are typically called strategic models of net-
work formation. The use of the word strategic here stems from connections, both historical
and substantive, between recent theoretical research on networks and game theory. I will
comment on this nomenclature after first introducing the standard notion of equilibrium
used by theoretical network researchers in this area: pairwise stability. Pairwise stability
is the equilibrium concept introduced by Jackson & Wolinsky (1996). Here I introduce the
definition which excludes the possibility of transfers between agents; the transferable utility
case was introduced in Section 3.
Let i : DN  R be a utility function for agent i, which maps adjacency matrices into utils.
In order to define pairwise stability I need a definition of marginal utility. As earlier, the
marginal utility for agent i associated with (possible) edge (i, j ) is

                                       i (D) - i (D - ij ) if Dij = 1
                       M Uij (D) =                                                         (98)
                                       i (D + ij ) - i (D) if Dij = 0

recalling that D - ij is the adjacency matrix associated with the network obtained after

                                              89
deleting edge (i, j ) and D + ij the one obtained via link addition.

Definition 6. (Pairwise stability without Transfers) The network G is pairwise
stable if (i) no agent wishes to dissolve a link

                          (i, j )  E (G) , M Uij (D)  0 and M Uji (D)  0                              (99)

and (ii) no pair of agents wishes to form a link

                         (i, j ) / E (G) , M Uij (D) > 0  M Uji (D) < 0.                            (100)

Two features of Definition 6 merit emphasis. First, an implication of the definition is that
utility is nontransferable across agents. This differs from some of the models introduced ear-
lier. Second, the strategic moniker aside, pairwise stability is a really non-strategic/myopic
notion of equilibrium. This point is elegantly made by Ostrovsky (2008) in a related con-
text. Pairwise stability does not require agents to engage in any "what if" or forward-looking
introspection. Specifically it does not require agents to imagine what might happen to the
rest of the network were they to add or delete a link, rather it simply requires them to
behave optimally given the actions of all other agents in the network. The key feature of
so-called strategic models relative to those in Sections 4, 5 and 6 is not behavioral, but in
their different assumptions about the nature of preferences. Here utility is interdependent;
this is the interesting complication.34
For any profile of preferences {i }M
                                   i=1 there many be many network configurations satisfying
             35
Definition 6. The potentially high cardinality of the set of pairwise stable network config-
urations makes the direct application of econometric methods designed for the analysis of
games computationally prohibitive (c.f., Bajari et al., 2010b, 2013). Nevertheless insights
from research in this area is valuable for analyzing empirical models of network formation.


8.1     A fixed point approach with increasing preferences
One example of this claim is provided by an elegant and interesting paper by Miyauchi
(2016). This paper draws on insights from the theory of supermodular games (e.g., Topkis,
1998) and their empirical analysis (Jia, 2008; Uetake & Watanabe, 2013) to formulate a
tractable estimation strategy for a class of strategic network formation models. Following
  34
     It might also be interesting to consider estimation and inference under different refinements of the
pairwise stability concept; such refinements might posit more sophisticated play by agents.
  35
     For results on the existence and uniqueness of pairwise stable networks see Jackson & Watts (2001) and
Hellmann (2013).


                                                    90
Miyauchi (2016) consider the mapping  (D) : DN  I           N   :
                                                            2

                                                                             
                                  1 (M U12 (D)  0) 1 (M U21 (D)  0)
                                                                             
                                  1 (M U13 (D)  0) 1 (M U31 (D)  0)          
                   (D)                            .                          .
                                                                                            (101)
                                                  .
                                                  .                          
                              1 (M UN -1N (D)  0) 1 (M UN N -1 (D)  0)

Observe that 1 (M Uij (D)  0) 1 (M Uji (D)  0) equals 1 if condition (99) of pairwise sta-
bility holds (which implies edge (i, j ) is present) and zero otherwise (which implies condition
(100) and hence the absence of edge (i, j )). Under the maintained assumption that the
observed network is pairwise stable, its adjacency matrix is therefore the fixed point

                                      D = vech-1 [ (D)] .                                   (102)

Here vech(·) vectorizes the N  2
                                  elements in the lower triangle of an N × N matrix and I define
its inverse operator as creating a symmetric matrix with a zero diagonal. There may, of
course, be many d  DN such that d = vech-1 [ (d)]. Miyauchi (2016) notes, however, that
if the preference profile {i }Ni=1 satisfies what he calls a non-negative externality condition,
namely that the marginal utilities M Uij (d) are weakly increasing in d for all i and j , then one
can characterize the set of pairwise stable networks with Tarski's (1955) fixed point theorem
(Miyauchi, 2016, Proposition 1). The invocation of Tarski (1955) implies that the set of
pairwise stable networks corresponds to a complete lattice with a maximum and minimum
equilibrium. Furthermore any pairwise stable network is a partial subgraph, defined on nodes
{1, . . . , N } of the maximum equilibrium. And the minimum equilibrium is always a partial
subgraph, again defined on nodes {1, . . . , N } of any pairwise stable equilibrium. This has
many useful implications. Trivially, the set of equilibrium networks can be sorted according
to density; less trivially their degree sequences can also be ordered.
Of course, the non-negative externality requirement is restrictive; there are many settings
where diminishing marginal utility in links might be plausible (e.g., capacity constraints). At
the same time, many extant empirical models of network formation do satisfy the restriction,
so exploring estimation maintaining it is reasonable. Miyauchi (2016, Section 3.3) provides
additional discussion.
Again borrowing results from the theory of supermodular games, Miyauchi (2016) shows that
the minimum equilibrium, say d, can be computed by fixed point iteration of (101) starting
from the empty adjacency matrix, while the maximum equilibrium, say d, may be computed
by fixed point iteration starting from the adjacency matrix associated with the complete


                                               91
graph KN . A similar computational insight, albeit in non-network settings, features in Jia
(2008) and Uetake & Watanabe (2013).
At this stage, to show how the above insights can be used concretely, it is helpful to param-
eterize the utility function, introducing both explicit heterogeneity and a parameter vector.
Adopting the random utility approach pioneered by McFadden (1974), assume, for example,
that
                     i (d, U; 0 ) =        dij 0 + 0             dik djk - Uij ,             (103)
                                       j                    k

with U = [Uij ]i,j {1,...,N },i=j ,  = (,  ) and the change in notation for the utility function
emphasizing that the econometrician does not observe the matrix of random utility shifters
U. In practice the elements of U, as is common in discrete choice analysis, are assumed to
be i.i.d random draws from some known distribution (e.g, the standard Normal or Logistic
distribution).
Equation (103) implies that the marginal utility agent i gets from a link with j is


                         M Uij (d, U; 0 ) = 0 + 0               dik djk - Uij                (104)
                                                        k


This marginal utility is increasing in the number of links i and j have in common, embodying
a structural taste for transitive closure (here I assume that 0 > 0). Clearly (104) is weakly
increasing in d  DN and hence Tarski's (1955) theorem applies. For a given draw of U
and value of  we can compute minimum and maximum equilibria, respectively d (U; ) and
d (U; ), by fixed point iteration. Let GN (U; ) and GN (U; ) be the graphs corresponding
to these adjacency matrices. Using these graphs we can compute, for example, the injec-
tive homomorphism frequencies tinj (S, GN (U; )) and tinj S, GN (U; ) for S = ,           etc.
These homomorphism frequencies correspond to model predictions associated with specific
draws of U and values of . Using simulation to integrate out the former, yields the vectors
                                                                                             
                tinj S1 , GN U(b) ;                          tinj S1 , GN U(b) ; 
         1
            N
                                                         N
                                                                                             
    () =                    .
                            .                 ,  () = 1                  .
                                                                         .                   
         B b=1                                        B b=1                                  
                            .                                            .
                tinj SJ , GN U(b) ;                          tinj SJ , GN U(b) ; 

for U(1) , U(2) . . . , U(B ) a sequence of independent simulated random utility shifter profiles
and S1 , . . . , SJ a set of J identifying motifs of interest.
Miyauchi (2016) works under the assumption that the econometrician observes of c =
1, . . . , C independent networks, with, in a slight change relative to earlier notation, Gc denot-


                                                92
ing the cth network/graph. Let  (Gc ) be the vector of S1 , . . . , SJ injective homomorphism
frequencies as observed in the cth network and let  c () and  c () be the corresponding
expected frequencies at the minimum and maximum pairwise stable equilibria for that net-
work at parameter . These frequencies are computed using simulation as described above.
Under preferences (103) the only reason these frequencies might vary with c is if the networks
observed by the econometrician vary in the number of agents within them.36
Miyauchi (2016) focuses on assumptions which may only partially identify , but to begin
with consider adding to the set-up the assumption that agents select the maximum equilib-
rium (cf., Jia, 2008). In that case

                                     E [¯
                                        c (0 ) -  (Gc )] = 0,                                  (105)

is a valid moment condition. If the set of chosen motifs is sufficiently rich so as to point
identify , then consistent estimation of 0 by the method of simulated moments is straight-
forward (McFadden, 1989; Pakes & Pollard, 1989; Gourieroux et al., 1993).
Because the asymptotic approximation involves C  , this approach hinges upon the
availability of a large number of independent networks (each described by the same 0 ). If,
instead, only a single large network is observed, then econometrician might use the methods
outlined in Section 7 to form an estimate of the variance of  (GN ), say ^  . An estimate of
 could then be formed by minimizing the simulated minimum distance (SMD) criterion:

                                 () -  (GN )) 
                        ^SMD = (¯
                                              ^-1
                                                (¯ () -  (GN )) .

Note that  ^  is constructed under an Aldous-Hoover dependence/independence structure;
such a structure may not characterize the finite N structural model. An additional approx-
imation argument is involved; understanding and formalizing this argument is required to
(rigorously) derive the law of ^SMD (suitably scaled and centered).

When analyzing incomplete models, researchers are often reluctant to make assumptions
about equilibrium selection (which complete the model). Miyauchi (2016) shows that if the
chosen vector of moments satisfies a certain monotonicity property (see his Property 1), then
inference can be based upon the pair of moment inequalities

                                     E [¯
                                        c (0 ) -  (Gc )]  0                                    (106)
                                     E [ c (0 ) -  (Gc )]  0.
  36
     In more complicated models, with covariates, these minimums and maximums will vary with c due to
differences in the distribution of covariates across networks.



                                                 93
Confidence intervals which asymptotically cover 0 with probability at least 1 -  can be
constructed using the approach outlined by, for example, Andrews & Soares (2010). Injective
homomorphism frequencies appear to satisfy the needed property, although some induced
subgraph frequencies may not.


8.2    Directed links with private information
Leung (2015) studies a model of simultaneous directed network formation where agents have
private information. In a directed network agent i may send a link to agent j such that
Dij = 1; agent j may or may not decide to reciprocate and send a link back to i. The
adjacency matrix is no longer symmetric, although it retains a diagonal of structural zeros.
The ith row of the adjacency matrix records the set of links agent i chooses to send to other
agents, while the ith column records the set of links that other agents choose to send to i.
To describe Leung's (2015) approach let D[-i,·] be the sub-adjacency matrix constructed by
deleting the ith row from D. The marginal utility agent i receives when she directs a link to
agent j is
                                MUij D[-i,·] , X; 0 - Uij .                             (107)

An important implication of (107) is that while i's gain from sending a link to j may vary with
the presence or absence of links elsewhere in the network, it does not vary with the presence
or absence of other links which i herself may or may not direct. This restriction rules out
interesting preference structures (see below), but simplifies the analysis substantially. Ridder
& Sheng (2017) develop an approach to relaxing this feature of Leung's (2015) setup. To
describe the main ideas I work with a special case of (107) :

             MUij D[-i,·] , X; 0 = 0 + 0 Dji + 0               Dki Dkj + t (Xi , Xj ) 0 ,    (108)
                                                       k=i,j


                      
for 0 = (0 , 0 , 0 , 0 ) and t (Xi , Xj ) a vector of possibly non-symmetric functions of exoge-
nous agent attributes. The parameter 0 indexes the utility gain associated with reciprocity
in links, while 0 captures the utility gain arising when a link is supported. A directed edge
from i to j is supported by agent k , if k directs links to both i and j (this allows, for example,
k to "referee" transactions between i and j ).
Support, although related, differs from transitivity (cf., Jackson et al., 2012); replacing
   k Dki Dkj with      k Dik Djk in (108) means that 0 would instead index a structural taste
for transitivity (i.e., that a link to a "friend of one of my friends" generates more utility).
However a transitivity term of this type is ruled out by the restriction that the marginal


                                                94
utility of an i to j link does not vary with the presence or absence of other links which i may
or may not send (cf., Ridder & Sheng, 2017).
Leung (2015) assumes that Ui = (Ui1 , . . . , Uii-1 , Uii+1 , . . . , UiN ) , the idiosyncratic compo-
nents of link utilities, are private information to agent i, while all other features of the game
are common knowledge to all agents. Let Pij denote the common prior held by all play-
ers other than i regarding the probability that she directs a link to j . Let P denote the
N (N - 1) × 1 vector of such common priors. In a Bayes-Nash equilibrium agent i will best
respond to the common prior by choosing to direct an edge toward j according to


               Dij = 1 0 + 0 Pji + 0                Pki Pkj + t (Xi , Xj ) 0 - Uij  0 ;
                                            k=i,j

that is i forms the directed edge only if the expected marginal utility from doing so is positive.
Assuming, for example, that the {Uij }N   i,j =1 are i.i.d. standard normals. Let



               ij (P, X; 0 ) =  0 + 0 Pji + 0                     Pki Pkj + t (Xi , Xj ) 0
                                                          k=i,j


with  (·) the standard normal CDF. A Bayesian-Nash equilibrium requires self-consistency
of beliefs such that P corresponds to a fixed point of the mapping.

                                                                          
                                                      12 (P, X; 0 )
                                                           .              
                                                           .
                                                           .              
                                                                          
                                                                          
                                                      1N (P, X; )         
                                                           .              
                               (P, X; 0 ) = 
                                                           .
                                                           .              .
                                                                                                 (109)
                                                                          
                                                      N 1 (P, X; )        
                                                                          
                                                            .
                                                            .             
                                                            .             
                                                    N N -1 (P, X; 0 )
One approach would be to apply ideas analogous to those developed in Miyauchi (2016)
using (109). Leung (2015), instead creatively adapts the two-step approach familiar from
the wider econometrics literature on incomplete information games (Bajari et al., 2010a,
2013). Let P^ be a nonparametric estimate of the belief vector P. With this estimate in
hand, 0 , may be estimated by finding the maximum of the criterion

                       N
            1                               ^ , X;  + (1 - Dij ) ln 1 - ij P
                                                                           ^ , X; 
    max                           Dij ln ij P                                                ,   (110)
        N (N - 1)      i=1 j =i




                                                     95
using a standard Probit MLE program.
The challenge with this approach is that it is not obvious how one can consistently esti-
mate P. Unlike in, for example, the literature on entry games, where the same player is
observed playing independent replications of a game across different markets, in the present
set-up there is only a single game. Leung's (2015) key insight is to note that under an
exchangeability assumption and a focus on symmetric equilibria, estimation of P is possible
because it implies that (ordered dyads) with identical covariate configurations have identical
ex ante linking probabilities. For the case of discretely-valued Xi Leung (2015, Propo-
                                                                                              -1
sition 1) shows, under assumptions, that for P  ^ij =         1 (t (Xk , Xl ) = t (Xi , Xj ))
                                                                         k,l                     ×

   k,l   Dkl 1 (t (Xk , Xl ) = t (Xi , Xj ))

                                                                   p
                                               sup       ^ij - Pij 
                                                         P           0
                                           i,j V (GN )


at rate N 1/2 . Using these estimates in (110) results in a consistent and asymptotically
normal estimate of 0 under regularity conditions. The interesting features of these results
involve the need to account for first step estimation error as well as for dependencies across
dyads sharing one agent in common. Leung (2015) also presents a variance estimator and
an empirical illustration based on the network data collected by Banerjee et al. (2013).


8.3       Bounded degree and restricted heterogeneity
Like Miyauchi (2016), de Paula et al. (2018) study a simultaneous-move complete information
model of network formation. They place three key restrictions on the graph generating
process. First, they assume that agents only wish to maintain a small number of links.
Second, that utility only varies with the addition or deletion of links within a finite radius.
For example an agent may care about the friends of her friends, but not the friends of the
friends of her friends. Third, there are only a finite number of agent types and, crucially,
agents are indifferent among links of the same type. There is some nuance to the last
restriction since indirect connections may matter. Consider two Black individuals, each
with a Black and White friend, the restriction is that any third agent is indifferent between
forming a link with either of these two individuals. Similar restrictions feature prominently
in one-to-one transferable utility matching models (e.g., Choo & Siow, 2006; Graham, 2013;
Galichon & Salanie, 2017). The first and last of these assumptions are "non-standard", but
de Paula et al. (2018) show how they make identification analysis tractable.
They begin by noting that, under their assumptions, any rooted network ­ a configuration


                                                          96
of links within a fixed distance about a focal "root" node ­ will take one of a finite num-
ber of configurations. Identification of preference parameters comes from comparing model
predictions about the frequency of these configurations with their empirical counterparts.
The operationalization of this intuition into a workable method of inference is the main
contribution of their paper. To describe this contribution assume that the utility agent i
gets from network configuration D = d is, for example,

                              
     i (d, U; 0 ) =       dij 0 Rij + 0        dik djk + Ui (Xj ) -  · 1         dij > L .
                      j                    k                                 j


Here Rij = r (Xi , Xj ) is a vector of known symmetric functions of Xi and Xj , L is the
maximum number links an agent might desire (known by the econometrician), and Ui (x) is
an unobserved utility-shifter with known distribution. This utility shifter varies with i, but
only depends on j via the covariate Xj . The expression above suggests that associated with
each agent are just |X| shocks, one for each type of agent. de Paula et al. (2018) actually
attach L × |X| shocks to each agent, but their main ideas can be conveyed under the more
restrictive set-up.
                                 
Let Ui = Ui (x1 ) , . . . , Ui x|X| denote the vector of taste shocks associated with agent i.
Since agents maintain no more than L links, and preferences are only affected by network
structure within a certain radius, the number of logically observable rooted network configu-
rations is finite. For each of these configurations we can ask, for a given value of  and draw
of Ui , whether an agent will unilaterally reject it (e.g., given the configuration's structure
she may prefer to unilaterally dissolve some links). de Paula et al. (2018) call the set of
acceptable rooted networks a preference class. Since the distribution of Ui is known, the ex
ante probability that any individual falls into a particular preference class when  takes a
particular value can be computed (typically via simulation).
A network can be generated by choosing the frequency with which agents of (i) a particu-
lar type, and (ii) belonging to a particular preference class, are assigned to specific rooted
network configurations. Theorem 1 of de Paula et al. (2018) shows how to construct these
frequencies in a way which satisfies pairwise stability. A parameter value belongs to the
identified set, if there exists a feasible vector of allocation probabilities such that the pre-
dicted frequencies with which the various rooted network configurations occur match their
corresponding empirical frequencies. Theorem 2 of de Paula et al. (2018) shows how this
question may be answered by solving a particular quadratic program.
The identification analysis assumes there are continuum of agents. Since their graph is
sparse, the object they work with is not a graphon, but its sparse graph analog, called a

                                               97
graphing in the literature (Lovász, 2012). For inference they assume that the econometrician
observes a random sample of rooted networks, perhaps collected via snowball sampling.


8.4     Many agent approximations
Menzel (2016) studies a class of large network formation models with exchangeable agents.
He characterizes the limiting network as N   and investigates how to use this limit to
approximate the finite network in hand. One example of the family of preference structures
accommodated by his set-up is

                         
      M Uij (D, U; 0 ) = 0 Rij + 0 min             Dik Djk , 1   + Uij - (ln J + Ui0 ).     (111)
                                               k                           marginal cost
                                         marginal benefit


The scale and location parameters,  and J , vary with N in a particular way in order to
obtain useful limits.
Menzel (2016) observes that a network is pairwise stable if and only if Dij = 1 when M Uij  0
and Dij = 0 when M Uij < 0 for all j  Wi . The set Wi includes all agents j who are willing
to form a link with agent i or, equivalently, who would not veto such a link:

                            Wi = {j  V (GN )\ {i} : M Uji  0} .

When J grows with N at the appropriate rate, the number of links accepted by agent i,
among those available in Wi , is stochastically bounded (ensuring that the limiting network
is sparse). Furthermore, using extreme value theory, Menzel (2016) shows that the effect of
the endogenous choice set, Wi , on the probability of forming a particular link is completely
summarized by a conditional logit type inclusive value.
Let
                                       Zij = (Xi , Xj , Tij )

for Tij = min ( k Dik Djk , 1) . Further, for purposes of illustration, let Xi  {0, 1} be a binary
indicator for, say, gender. In this case Zij takes values within the finite set Z. For example
woman i may link with woman j , with whom she shares at least one friend in common,
such that Zij = (1, 1, 1) . Menzel (2016) demonstrates that the probability that agent i's
highest utility link is of type Zij = z , among all those available to her, takes a logit form.
Furthermore, when N is large, the inclusive value in this probability depends only on agent
i's exogenous attribute Xi (for preferences structure different than (111) the argument may
be a bit more complicated).

                                                   98
In setting up the sequence of network formation games appropriately, and also in character-
izing the resulting limit, Menzel (2016) demonstrates considerable ingenuity and technical
skill. Stepping back, the underlying intuition is quite simple. Under exchangeability of
agents, the link formation process for observationally identically agents should be similar
when N is large.
Next consider the link frequency "distribution"

                              N
                          1
                FN (z ) =                1 (Dij = 1, Xi  x1 , Xj  x2 , Tij  t12 )
                          N   i=1 j =i

for z = (x1 , x2 , t12 ) . This is not a proper measure, it integrates to average degree, not
one. Nevertheless these frequencies have well-defined limits which Menzel (2016) is able to
relate to the limiting choice probabilities associated with the infinite agent network forma-
tion game. Note that FN (z ) is closely related to a network moment, as introduced in (3.5)
earlier. As in the other papers surveyed in this section, the identification/estimation ap-
proach relates empirical frequencies with model-implied counterparts. Characterizing these
model-implied counterparts (in the limit) is non-trivial. Menzel (2016) shows that depending
on the preference structure considered, as well as researcher assumptions about equilibrium
selection, preference parameters may be point or set identified. For point identified models
Menzel (2016) suggests a constrained maximum likelihood estimator based on the form of
the limiting model.


8.5    Models with (unobserved) sequential meeting processes
Miyauchi (2016), Leung (2015), de Paula et al. (2018) and Menzel (2016) all model network
formation as a static game. Any underlying dynamics governing link formation are left un-
modeled. This is in keeping with the agnosticism regarding equilibrium selection maintained
by these researchers. Mele (2017) and Mele & Zhu (2017), in contrast, present models of
network formation which make explicit assumptions about how agents meet, form, dissolve
and maintain links.
In their model pairs of agents meet sequentially. Upon meeting a dyad decides to either form,
maintain, or dissolve a link. Although the utility attached to any given link may depend on
current network structure, agents are not forward looking. Rather agents myopically add,
maintain, or subtract links in order to raise current utility without anticipating the effects
of their actions on the future decisions of other agents in the network.
To discuss their results I work with the preference specification featured in Mele & Zhu


                                                 99
(2017). Let dt be a particular undirected network configuration in period t. The utility
agent i gets from such a configuration is given by

                                                             0
                  i (dt , X, Ut ; 0 ) =       dijt 0 Rij +               djkt - Uijt                (112)
                                          j
                                                             N       k


with  = ( ,  ) . Here Rij  
                             = r (Xi , Xj ) is a vector of known functions of Xi and Xj . This
term indexes, for example, the utility gains from homophilous sorting. The second term in
(112) captures the benefits associated with indirect connections; that is, the return agent i
receives from linking with j may, in part, depend on the number of links j already has. If
0 > 0 (0 < 0), then there exist utility gains from linking with more (less) popular agents.
It is also possible to incorporate a transitivity, or mutual friends, term into (112).
The preference shock Uijt is a Type I extreme value random variable; independently dis-
tributed across dyads and over time. I will return to the implications of these assumptions
for the interpretation and identification of the model shortly.
Under (112) the marginal utility agent i gets from a link with j is


                                                         0
                     M Uij (dt , X, Ut ; 0 ) = 0 Rij +               djkt - Uijt .                  (113)
                                                         N       k

Mele & Zhu (2017) assume utility is transferable. This implies that if i and j meet in period
t they will form (or maintain) a link if the net surplus from doing so is positive (cf., Bloch
& Jackson, 2007):

                                                                          0
   M Uij (dt , X, Ut ; 0 ) + M Uji (dt , X, Ut ; 0 )  0 Rij 0 +                    (dikt + djkt )   (114)
                                                                          N    k

                                                              Uijt + Ujit ,

                     
where Rij = Rij  + Rji . The Rij term is analogous to the vector of regressors appearing in
the dyadic regression model discussed in Section 4. Observe, in keeping with the undirected
nature of the network, that (114) is invariant to permutations of the agents' indices.
Dyads meet one at a time (i.e., sequentially). In each period the probability that a particular
ij dyad is chosen, say ij , is greater than zero. Let Zt = ij if dyad {i, j } is chosen to meet in
period t. This meeting variable equals one of the N   2
                                                         possible dyad index pairs each period.
Conditional on i and j meeting, as well as the beginning-of-period-t network structure, the




                                                 100
probability that they form (or maintain) a link is logistic:

                                                                    0
                                                      exp Rij 0 +       [           (Dikt + Djkt )]
     Pr ( Dt+1 = Dt + ij | Dt , X, Zt = ij ; 0 ) =            
                                                                    N
                                                                        0
                                                                                k
                                                                                                          .
                                                     1 + exp Rij 0 +    N
                                                                            [       k   (Dikt + Djkt )]

This link probability function augments the simple dyadic logistic regression model intro-
duced earlier with terms, in this case a popularity effect, which arise due to interdependencies
in preferences.
Under these assumptions the sequence of adjacency matrices D0 , D1 , . . . is a Markov chain
with transition probabilities depending on the exact specification of the meeting process and
the logistic probabilities specified above. This chain is irreducible and aperiodic. Therefore
the ergodic theorem implies that, in the limit, realized networks will correspond to draws
from a unique stationary distribution. Mele & Zhu (2017, Theorem 2.1) show that this
stationary distribution equals (cf., Blume, 1993)

                                               exp (QN (d; X, 0 ))
                          N (d; X, 0 ) =                                                                  (115)
                                              vDN exp (QN (v; X, 0 ))


for QN (d; X, ) = N    i=1 i (d, X, 0; 0 ). See also Mele (2017, Theorem 1). Equation (115)
corresponds to what network researchers call an exponential random graph model (ERGM).
Robins et al. (2007a) and Robins et al. (2007b) provide an overview of ERGMs for social
network analysis. de Paula (2017, Section 4.1) provides an interesting overview from the
vantage point of an econometrician. The results of Mele (2017) and Mele & Zhu (2017)
provide a microeconomic foundation for (certain forms of) ERGMs. This is interesting,
especially in light of peculiarities of the ERGM modeling framework emphasized by others
(e.g., Shalizi & Rinaldo, 2013).
It turns out that QN (d; X, ) is also the potential function, in the sense of Monderer &
Shapley (1996), associated with a particular network formation game. Consider preference
structure (112), but with all the pair-specific preference shocks set identically equal to zero.
The set of networks which (locally) maximize QN (d; X, ) correspond to the set of Nash
equilibrium networks associated with the simultaneous move network formation game under
these zero heterogeneity preferences. The stationary distribution (115) clearly has modes
at these equilibria. Mele & Zhu (2017) assume that the econometrician observes a single
draw from this stationary distribution. This draw, loosely, can be viewed as a random
perturbation of an equilibrium network in the associated "heterogeneity free" simultaneous
move static game.
Unfortunately computing the maximum likelihood estimate of 0 is not straightforward.


                                                101
This is because the denominator in (115) involves a summation over all undirected networks
of order N . It is impossible to evaluate this summation directly except for trivially small
networks. Furthermore approximate computation of the MLE via, for example, Markov
Chain Monte Carlo (MCMC) methods, is also difficult (e.g., Bhamidi et al., 2011).
Mele & Zhu (2017), building on ideas in Chatterjee & Diaconis (2013) and Chatterjee &
Dembo (2016), propose an approximate variational estimate of 0 (cf., Daudin et al., 2008;
Bickel et al., 2013). While their approximation does not generally coincide with the MLE,
they show that the difference between the two shrinks to zero as N grows large.
At a high level they proceed as follows. First, consider the conditional edge independence
model introduced in (3):

                                                      qijij (1 - qij )1-dij ,
                                                       d
                             Pr (D = d; q ) =                                               (116)
                                                i<j


with qij equaling the probability that i and j link. In this context the conditional edge
independence model is sometimes called the mean-field approximation. Exploiting ideas in
Wainwright & Jordan (2008) and He & Zheng (2013), they observe that the (log of the)
constant of integration in (115) is bounded below by

                  1                                                             1
                     ln         exp (QN (v; ))  Eq [QN (D; )] +                    S (q )
                  N2      vDN
                                                                                N2

with S (q ) denoting Shannon's Entropy and the expectation with respect to the approxi-
mating mean field model (116). Next choose the probabilities q = (q12 , q13 , . . . , qN -1N ) to
maximize the above lower bound. This is the variational problem. Clearly, the optimal ap-
proximation will vary with , the structural parameter of interest. The approximation will
also not be exact, since conditional edge independence models represent only a restricted set
of all the possible probability distributions on DN . The variational estimate of 0 , say    ^VE ,
is chosen to maximize (115) after replacing its denominator with the lower bound described
above.
Mele & Zhu (2017), using a result in Chatterjee & Dembo (2016), show that the lower bound
approximation becomes tight as N  . Furthermore the limit of the variational problem
corresponds to finding a graphon. More precisely, they find that as N  ,

   1. the stationary distribution associated with their strategic network formation model is
      arbitrarily well approximated by a conditional edge independence model with some
      graphon h (u, v ), or a mixture of such models;


                                                102
  2. these graphons correspond to local maximizers of a limiting version of the variational
     problem; and

  3. ^VE coincides with a local maximizer of (115).

The first finding is to be expected given the Aldous-Hoover Theorem and associated discus-
sion in Section 3. The second result is related to work by Chatterjee & Diaconis (2013).
It is of interest here since it provides a connection between a structural model of strategic
network formation and the exchangeable random graph theory reviewed earlier.
While Mele (2017) provides a nice microeconomic potential game interpretation of ERGMs,
and Mele & Zhu (2017) make important progress on methods of estimation, major challenges
in the areas of identification, estimation and inference in this class of models nevertheless
remain.
Christakis et al. (2010) also model link formation as a sequential process. Their approach
differs from that of Mele (2017). They assume the initial network is empty and that all N  2
dyads meet in a specific (unobserved) order. Upon meeting they myopically decide whether
to form a link or not. After all pairs of agents meet once, further link revisions do not
occur. In order to construct a likelihood Christakis et al. (2010) assigned a distribution
to the unobserved meeting sequence and integrate it out. For computation they develop a
Bayesian approach based on MCMC methods. One feature of their set-up is that the model
may place positive probability on network configurations that are not pairwise stable. In
contrast the ergodic distribution associated with Mele's (2017) model places most of its mass
in the neighborhood of equilibrium network configurations. While this may be viewed as
undesirable, from a computational standpoint the Christakis et al. (2010) method appears
attractive. In principal their model could be extended to allow each pair of agents to meet
multiple (but still a finite number of) times.


8.6    Further reading and open questions
With exception of the paper by Miyauchi (2016), all of the papers surveyed above base
estimation and inference on a single network. To get workable LLNs and CLTs each of
these authors deal with the dependence across links induced by strategic interaction in
interesting ways. Leung (2015) introduces private information; in a resulting Bayes-Nash
equilibrium links are conditionally independent given common information. The reduced
form probability of a directed link from i to j implied by his model is quite similar to the
representation result associated with X -exchangeability introduced in the context of dyadic
regression in Section 4. To a first approximation this probability depends only upon Xi and

                                            103
Xj (since the other sources of variation in k=i,j Pki Pkj should be rather modest when N is
large enough). Therefore, relative to a simple dyadic probit model, the Leung (2015) model
adds an equilibrium constraint.
In de Paula et al. (2018) the key assumption appears to be that preference heterogeneity is
over types of links alone, with no dyad-specific component. As mentioned earlier, similar as-
sumptions have proved to be very powerful in the literature on matching. Although Menzel
(2016) works with a model which generates a sparse graph in the limit (with dependence
across links vanishing), his use of exchangeability arguments does suggest connections to
the Aldous-Hoover type representation results introduced earlier. Mele (2017) and Chris-
takis et al. (2010) posit sequential meeting processes that effectively "complete" what would
otherwise be an incomplete simultaneous move N -player game. Each of these approaches
have pros and cons; a variety of computational and inference issues remain unsolved. At
the same time the creativity and diversity of them suggests that forward progress on these
types of models is possible. Better understanding the connections between different modeling
assumptions would be useful.
Another approach, not surveyed here, but nevertheless promising, involves working with
subnetworks. A focus on subnetworks sidesteps some of the computational challenges that
arise when trying to apply methods from the econometrics of games to network formation
problems (where there are typically many agents). Sheng (2014) pioneered this approach.
Gualdani (ming) develops additional (related) results.



9    The bright and happy future of network economet-
     rics
This chapter has surveyed a burgeoning literature on the econometrics of networks. This
literature ­ combining insights from econometric research on panel data and games, new
tools in applied probability and statistics, and original thinking ­ now provides a basic set
of tools for the analysis of networks. Nevertheless substantial work remains unfinished. As
noted at the start of this chapter, datasets with natural graph theoretic structure abound
in economics, and increasingly feature in published research. Each dataset exhibits its own
peculiarities: in some links are undirected, in others directed. The network may be bipartite
or even multi-partite(e.g., Min, 2019). The size and order of available network datasets vary
immensely. In some cases a network may be observed over multiple periods, in others just
once. For many of these settings there exist no extant econometric modeling strategies, in
all of them existing work could be improved in a number of ways.

                                            104
A defining feature of the econometric approach to modeling network formation is its random
utility foundation. When preferences are interdependent ­ where the utility two agents attach
to a candidate link may vary with the presence or absence of links elsewhere in the network ­
multiple equilibrium network configurations are likely. The analysis of incomplete models is
an important recent accomplishment of econometrics. The combinatoric complexity of large
networks will require new developments in this area. The set of papers surveyed in Section
8 gives some flavor of the key issues and possible solutions.
Another defining feature of modern microeconometric research is the incorporation of un-
observed heterogeneity; heterogeneity that agents observe and act upon, but which is unob-
served by the researcher. In the single agent setting panel data facilitates the identification
and estimation of models with rich heterogeneity structures. Networks have natural panel-
like aspects. In a dense network each agent decides whether to (attempt to) form a link
with all other agents. Multiple decisions per agent are observed. Leveraging this panel-like
structure has been a key feature of some of the contributions surveyed in Sections 4, 5 and
6 above.
Understanding the properties of the different methods surveyed above under sequences of
networks which are dense, sparse or somewhere in between, remains incomplete. Uniformity
of testing procedures across these various cases would be desirable. Some preliminary work
on bootstrapping methods in the networks setting now exists (e.g., Green & Shalizi, 2017;
Menzel, 2017; Davezies et al., 2019), but this remains relatively unexplored. Semiparametric
efficiency bounds are yet to be characterized, let alone the development of estimators attain-
ing them. Computational advances will be important for spurring real world application.
This chapter has focused on network formation. While the question of how networks form
is scientifically interesting, so is that of what they do? This latter question was a key driver
of the peer effects literature which emerged after Manski (1993). Developing methods for
simultaneously modeling the formation and consequences of social and economic networks re-
mains an important open area (Auerbach, 2016; Johnsson & Moon, 2017). Finally, although
more and more empirical work with a network dimensions appears each year, application
of the methods outlined above in substantive empirical work is a high priority. In addition
to whatever subject area insights such applications may produce, they will no doubt spur
further methodological innovations.




                                              105
A       Appendix
Lemma 2. (U-Statistic with Estimated Parameter) Let {Zi }N             i=1 be a simple random
sample drawn from some population FZ and  (Zi , Zj ; ,  ) be a function from Z × Z to
RJ indexed by   B and   C (with B and C compact subsets of Rdim( ) and Rdim( )
respectively). Suppose that  (z1 , z2 ; ,  ) is twice continuously differentiable in  for all
z1 , z2  Z × Z with

                                   E [  (Z1 , Z2 ; ,  ) 2 ] <                                                        (117)
                                    (Z1 , Z2 ; ,  )
                               E                                     <                                               (118)
                                                             F
                                    (Z1 , Z2 ; ,  )
                   E                                                 < , p = 1, . . . , dim ( ) .                    (119)
                                       p                     F

                                                                                                                       def
Then,    for   ^
                       a     N -consistent        estimate             of   0 ,       and      defining   ¯N (,  )     
 N -1          N -1                                              def
 2
         N
         i=1   j =i+1       (Zi , Zj ; ,  ) and  (,  )  E [ (Z1 , Z2 ; ,  )], we have

                             2
                                             N
                                                                                            
     N ¯N (, ^ ) -  (, 0 ) =                      0 (Z1 ; , 0 ) + 0, ( )                           - 0 ) + op (1) (120)
                                                                                               N (^
                             N              i=1


where 1 (z ; ,  ) = E [ (z, Z1 ; ,  )] and

                                   0 (Z1 ; ,  ) =1 (Z1 ; ,  ) -  (,  )
                                                              (Z1 , Z2 ; , 0 )
                                      0, ( ) =E                                .
                                                                   

Proof of Lemma 2

A Taylor expansion of ¯N (, ^ ) in ^ about 0 yields, after some re-arrangement and center-
ing,
                                                         
 N ¯N (, ^ ) -  (, 0 ) = N ¯N (, 0 ) -  (, 0 ) +N, (,         - 0 ) , (121)
                                                      ¯ ) N (^

with ¯ a mean value between     ^ and 0 which may vary across the rows of the Hessian
          def  ¯N (, )
N, (,  )         
                       . Next recall the definition of the L2,1 norm:

                                                       n         m              1/2

                                        A   2,1   =                    |aij |
                                                                            2
                                                                                      .                              (122)
                                                      j =1       i=1



                                                           106
The mean value theorem, as well as compatibility of the Frobenius matrix norm with the
Euclidean vector norm, gives for any  and   both in C,

                                             dim( )
         ¯N (,  )  
                   ¯N (,   )                                    ¯N (,  )
                                                                
                 -                                                                    -          .   (123)
                                   2,1        p=1
                                                                  p              F
                                                                                             2



                    ¯
                     N (, )
Observe that          p
                             is a matrix of U-statistics with kernels whose first moments are
finite (by condition 106 above). By Serfling (1980, Theorem 5.4A) these U-statistics converge
in probability and hence, from (123)

                        ¯N (,  )  
                                  ¯N (,   )
                                -                               Op (1) ·  -              .
                                                         2,1
                                                                                     2


                                                                             ¯
This condition, as well compactness of C, continuity of  N  
                                                             (, )
                                                                   in  , and condition
(118), allow for an application of Lemma 2.9 in Newey & McFadden (1994) such that
       ¯ (, )               p
sup  N   
              -  (,  )       0 with  (,  ) = E (Z1     ,Z2 ;, )
                                                                . This, along with con-
 C                         F
                                                           ¯          p
sistency of ^ for 0 , is enough to ensure that  N  
                                                   (,¯)
                                                         0, ( ). Equation (120) then
                            ¯
follows by observing that N (, 0 ) -  (, 0 ) is a vector of mean zero U-Statistics with
Hájek projections equal to the corresponding components of the first term to the right of the
equality in (120) (see, for example, Theorem 5.3.3. of Serfling (1980) and invoke condition
(117) above). See Mao (2018, Lemma S1) for a related Lemma.


Order of variances and covariances for pth order induced subgraph frequencies

Here I present the order of the covariance between empirical subgraph frequencies, where
the subgraph is of arbitrary order. For general pth -order graphlets R and S we have that

                                             -2     p
                                     N                     N      p       N -p
              C (PN (R) , PN (S )) =                                           q (R, S )
                                     p            q =1
                                                           p      q       p-q
                                             -2     p
                                         N                 N      p       N -p
                                  =                                             (Wq,R,S )
                                         p        q =1
                                                           p      q       p-q
                                                   (N - p)!2
                                      - 1-                      P (R ) P (S ) .                      (124)
                                                  N ! (N - 2p)!




                                                  107
                                                                                              e(R)             e(S )
Normalizing by N raised to the number of edges in R and S , respectively N                            and N ,
yields
                                        
                                         N
                                               -2 p-1
                                                        N     p      N -p         (Wq,R,S )
          C P
            ~N (R) , P
                     ~N (S ) =
                                         p              p     q      p-q          e(R) e(S )
                                                                                  N N
                                                 q =1
                                                   (
                                                         -e(R) -e(S )
                                                  O N -q N    N
                                                                      )
                                                                       O((Wq,R,S ))

                                                (N - p)!2
                                        - 1-                 ~ (R) P
                                                             P     ~ (S ) .                                   (125)
                                               N ! (N - 2p)!

There are 2p - q vertices in each element of Wq,R,S .


Case 1 (q = 1):

If q = 1, then e (W ) = e (R) + e (S ) for all W  Wq,R,S . This gives

                      -e(R) -e(S )                                -e(R) -e(S )
         O N -q N                    O ( (W1,R,S )) = O N -1 N
                                                                                         e(R) e(S )
                           N                                           N         O N N

                                                   = O N -1 .


Case (q = p):

If q = p, then  (Wq,R,S ) = 0 unless R = S . In that case, the "variance case", we have that
e (W ) = p since W = R = S. This gives

                               -2e(R)                              -2e(R)
                  O N -q N              O ( (Wp,R )) = O N -p N
                                                                                  e(R)
                                                                                O N
                                                                   -e(R)
                                                    = O N -p N              .

                                                                                 -e(R)
If R is a p-cycle, then p = e (R), yielding the simplification O N -p N                    = O -p
                                                                                               N .

                                                                                                      -e(R)
If R is a tree, then e (R) = p - 1, yielding the simplification O N -p N                                          =
         -(p-1)
O N - 1 N         .




                                                  108
Case (1 < q < p):

For q = 2, . . . , p - 1 we have that e (W ) = e (R) + e (S ) - (q - 1) if R and S are both p-cycles
so that

                  -e(R) -e(S )                                                   -e(R) -e(S )                  e(R)+e(S )-(q -1)
       O N -q N        N          O (Q (Wq,R,S )) = O N -q N                          N                 O N
                                                                                 -(q -1)
                                                            = O N -q N
                                                                                 -(q -1)
                                                            = O N -1 N                         .

Whereas we have that e (W )  e (R) + e (S ) - (q - 1) if R and S are both trees, or one is a
tree and the other a p-cycle, so that

                  -e(R) -e(S )                                                   -e(R) -e(S )                  e(R)+e(S )-(q -1)
       O N -q N        N          O ( (Wq,R,S ))  O N -q N                            N                 O N
                                                                                 -(q -1)
                                                           = O N -1 N                          .


Proof of Theorem 3

Without loss of generality set i = 1. By the definition of degree we have that

                                                                    N                 m

                                         E D1+
                                            m
                                               =E                          D1j             ,
                                                                    j =2


the multinomial theorem allows us to write the term inside the expectation above as

                                 N               m                                                       N
                     m                                                                   m                       q
                    D1+   =             D1j          =                                                         D1j                 (126)
                                 j =2                    q2 +···+qN =m
                                                                               q2 , q 3 , · · · , q N   j =2
                                                                                                                 j



                                                                           q
where q2 ,q3m   ,··· ,qN
                         = q2 !q3m !
                                 !···qN !
                                          . Since D1j is binary D1j
                                                                  j = D1j for all qj = 1, 2, . . . , m and zero
                                                     qj
when qj = 0. This implies that j =2 D1j = D1j1 × · · · × D1jk for D1j1 , D1j2 , . . . , D1jk the set
                                                N

of 1  k  m link indicators with qj  1. Consider agents j1 , j2 , . . . , jk , with, say, qj1 = p1 ,
qj2 = p2 , . . . , qjk = pk such that p  Pk,m , it follows that

                                          N
                                                     q
                                                   j = D1j1 × · · · × D1jk .
                                                        p1             pk
                                                 D1j                                                                               (127)
                                          j =2




                                                              109
                                                                                  m!
By the multinomial theorem the coefficient on (127) equals                   p1 !×···×pk !
                                                                                           ,   but since

                                             p                   p
                   j1 × · · · × D1jk = D1j1 × · · · × D1jk = D1j1 × · · · × D1jk
                  p1             pk
                 D1                      1              k




for any p, p  Pk,m , the coefficient on D1j1 × · · · × D1jk after combining identical terms in
                        m!
(126) equals pPk,m p1 !×···× pk !
                                  . Putting these pieces together yields
                                                              
                       m
                                                m!           E
           E Di
              m
                + =                                                               Dij1 × · · · × Dijk
                       k=1      pPk,m
                                        p 1 ! × · · · × pk !         j1 <···<jk


The expectations of the summands in              j1 <···<jk   Dij1 × · · · × Dijk are all identical with car-
          -1
dinality Nk  . The assertion follows.



References
Acemoglu, D., Akcigit, U., & Kerr, W. (2016a). Networks and the macroeconomy: an
  empirical exploration. NBER Macroeconomics Annual, 31(1), 273 ­ 335.

Acemoglu, D., Akcigit, U., & Kerr, W. R. (2016b). Innovation network. Proceedings of the
  National Academy of Sciences, 113(41), 11482 ­ 11488.

Acemoglu, D., Carvalho, V., Ozdaglar, A., & Tahbaz-Salehi, A. (2012). The network origins
  of aggregate fluctuations. Econometrica, 80(5), 1977 ­ 2016.

Ahern, K. R. & Harford, J. (2014). The importance of industry links in merger waves.
 Journal of Finance, 69(2), 527 ­ 576.

Airoldi, E. M., Blei, D. M., Fienberg, S. E., & Xing, E. P. (2008). Mixed membership
  stochastic blockmodels. Journal of Machine Learning Research, 9, 1981 ­ 2014.

Alatas, V., Banerjee, A., Chandrasekhar, A. G., Hanna, R., & Olken, B. A. (2016). Net-
  work structure and the aggregation of information: theory and evidence from indonesia.
  American Economic Review, 106(7), 1663 ­ 1704.

Aldous, D. J. (1981). Representations for partially exchangeable arrays of random variables.
  Journal of Multivariate Analysis, 11(4), 581 ­ 598.

Ambrus, A., Mobius, M., & Szeidl, A. (2014). Consumption risk-sharing in social networks.
 American Economic Review, 104(1), 149 ­ 182.


                                                     110
An, C., O'Malley, A. J., Rockmore, D. N., & Stock, C. D. (2018). Analysis of the u.s. patient
 referral network. Statistics in Medicine, 37(5), 847 ­ 866.

Anderson, J. E. (2011). The gravity model. Annual Review in Economics, 3(1), 133 ­ 160.

Andrews, D. W. & Soares, G. (2010). Inference for parameters defined by moment inequalities
 using generalized moment selection. Econometrica, 78(1), 119 ­ 157.

Angrist, J. (2014). The perils of peer effects. Labour Economics, 30, 98­108.

Apicella, C. L., Marlowe, F. W., Fowler, J. H., & Christakis, N. A. (2012). Social networks
 and cooperation in hunter-gatherers. Nature, 481(7382), 497 ­ 501.

Arellano, M. & Bover, O. (1995). Another look at the instrumental variables estimation of
  error-component models. Journal of Econometrics, 68(1), 29 ­ 51.

Arellano, M. & Hahn, J. (2007). Advances in Economics and Econometrics: Theory and
  Applications, volume 3, chapter Understanding bias in nonlinear panel models: some recent
  developments, (pp. 381 ­ 309). Cambridge University Press.: Cambridge.

Arellano, M. & Honoré, B. (2001). Handbook of Econometrics, volume 5, chapter Panel data
  models: some recent developments, (pp. 3229 ­ 3296). North-Holland: Amsterdam.

Aronow, P. M., Samii, C., & Assenova, V. A. (2017). Cluster-robust variance estimation for
  dyadic data. Political Analysis, 23(4), 564 ­ 577.

Atalay, E., Hortaçsu, A., Roberts, J., & Syverson, C. (2011). Network structure of produc-
  tion. Proceedings of the National Academy of Sciences, 108(13), 5199 ­ 5202.

Atalay, E., Hortaçsu, A., & Syverson, C. (2014). Vertical integration and input flows. Amer-
  ican Economic Review, 104(4), 1120 ­ 1148.

Athey, S., Eckles, D., & Imbens, G. W. (2018). Exact p-values for network interference.
  Journal of American Statistical Association, forthcoming.

Attanasio, O., Barr, A., Cardenas, J. C., Genicot, G., & Meghir, C. (2012). Risk pooling,
  risk preferences, and social networks. American Economic Journal: Applied Economics,
  4(2), 134 ­ 167.

Auerbach, E. (2016). A matching estimator for models with endogenous network formation.
  Technical report, University of California - Berkeley.



                                            111
Badev, A. (2017). Discrete games in endogenous networks: equilibria and policy. Technical
  Report 1705.03137, arXiv.

Bajari, P., Hong, H., Krainer, J., & Nekipelov, D. (2010a). Estimating static models of
  strategic interactions. Journal of Business and Economic Statistics, 28(4), 469 ­ 482.

Bajari, P., Hong, H., & Nekipelov, D. (2013). Advances in Economics and Econometrics,
  Tenth World Congress, volume 3, chapter Game theory and econometrics: a survey of
  some recent research, (pp. 3 ­ 52). Cambridge University Press: Cambridge.

Bajari, P., Hong, H., & Ryan, S. P. (2010b). Identification and estimation of a discrete game
  of complete information. Econometrica, 78(5), 1529 ­ 1568.

Baldwin, R. & Taglioni, D. (2007). Trade effects of the euro: a comparison of estimators.
  Journal of Economic Integration, 22(4), 780 ­ 818.

Banerjee, A., Chandrasekhar, A. G., Dulfo, E., & Jackson, M. O. (2013). The diffusion of
  microfinance. Science, 341(6144), 363 ­ 370.

Barabási, A.-L. (2016). Network Science. Cambridge: Cambridge University Press.

Barabási, A.-L. & Albert, R. (1999). Emergence of scaling in random networks. Science,
  286(5439), 509 ­ 512.

Barabási, A.-L. & Bonabau, E. (2003). Scale-free networks. Scientific American, (pp. 50 ­
  59).

Barnett, M., Landon, B., O'Malley, A., Keating, N., & Christakis, N. (2011). Mapping
  physician networks with self-reported and administrative data. Health Services Research,
  46(5), 1592 ­ 1609.

Barrot, J.-N. & Sauvagnat, J. (2016). Input specificity and the propagation of idiosyncratic
  shocks in production networks. Quarterly Journal of Economics, 131(3), 1543 ­ 1592.

Beaman, L. A. (2011). Social networks and the dynamics of labour market outcomes: Evi-
  dence from refugees resettled in the us. Review of Economic Studies, 79(1), 128 ­ 161.

Bearman, P. S., Moody, J., & Stovel, K. (2004). Chains of affection: the structure of
  adolescent romantic and sexual networks. American Journal of Sociology, 110(1), 44 ­ 91.

Bech, M. L. & Atalay, E. (2010). The topology of the federal funds market. Physica A:
  Statistical Mechanics and its Applications, 389(22), 5223 ­ 5246.

                                            112
Bellio, R. & Varin, C. (2005). A pairwise likelihood approach to generalized linear models
  with crossed random effects. Statistical Modelling, 5(3), 217 ­ 227.

Bernard, A. B., Moxnes, A., & Saito, Y. (2018). Geography and firm performance in the
  japanese production network. Journal of Political Economy. RIETI Discussion Paper
  14-E-034.

Bhamidi, S., Bresler, G., & Sly, A. (2011). Mixing time of exponential random graphs. The
  Annals of Applied Probability, 21(6), 2146 ­ 2170.

Bhattacharya, S. & Bickel, P. J. (2015). Subsampling bootstrap of count features of networks.
  Annals of Statistics, 43(6), 2384 ­ 2411.

Bhattacharya, S. & Nain, A. (2011). Horizontal acquisitions and buying power: A product
  market analysis. Journal of Financial Economics, 99(1), 97 ­ 115.

Bickel, P., Choi, D., Chang, X., & Zhang, H. (2013). Asymptotic normality of maximum like-
  lihood and its variational approximation for stochastic blockmodels. Annals of Statistics,
  41(4), 1922 ­ 1943.

Bickel, P. J. & Chen, A. (2009). A nonparametric view of network models and newman-
  girvan and other modularities. Proceedings of the National Academy of Sciences, 106(50),
  21068 ­ 21073.

Bickel, P. J., Chen, A., & Levina, E. (2011). The method of moments and degree distributions
  for network models. Annals of Statistics, 39(5), 2280 ­ 2301.

Blitzstein, J. & Diaconis, P. (2011). A sequential importance sampling algorithm for gener-
  ating random graphs with prescribed degrees. Internet Mathematics, 6(4), 489 ­ 522.

Bloch, F. & Jackson, M. O. (2006). Definitions of equilibrium in network formation games.
  International Journal of Game Theory, 34(3), 305 ­ 318.

Bloch, F. & Jackson, M. O. (2007). The formation of networks with transfers among players.
  Journal of Economic Theory, 113(1), 83 ­ 110.

Bloom, N., Schankerman, M., & van Reenen, J. (2013). Identifying technology spillovers
  and product market rivalry. Econometrica, 81(4), 1347 ­ 1393.

Blume, L. (1993). The statistical mechanics of strategic interaction. Games and Economic
  Behavior, 5, 387­424.


                                            113
Blume, L. E., Brock, W. A., Durlauf, S. N., & Ioannides, Y. M. (2011). Identification of
  social interactions. In J. Benhabib, A. Bisin, & M. O. Jackson (Eds.), Handbook of Social
  Economics, volume 1B (pp. 853 ­ 964). Amsterdam: North-Holland.

Blume, L. E., Brock, W. A., Durlauf, S. N., & Jayaraman, R. (2015). Linear social interaction
  models. Journal of Political Economy, 123(2), 444 ­ 496.

Blundell, R. & Powell, J. L. (2003). Advances in Economics and Econometrics: Theory and
  Applications, Eighth World Congress, volume 2, chapter Endogeneity in nonparametric
  and semiparametric regression models, (pp. 312 ­ 357). Cambridge University Press.

Bobollas, B., Janson, S., & Riordan, O. (2007). The phase transition in inhomogenous
  random graphs. Random Structures and Algorithms, 31(1), 3 ­ 122.

Bonhomme, S. & Manresa, E. (2015). Grouped patterns of heterogeneity in panel data.
  Econometrica, 83(3), 1147 ­ 1184.

Bramoullé, Y., Djebbari, H., & Fortin, B. (2009). Identification of peer effects through social
  networks. Journal of Econometrics, 150(1), 41 ­ 55.

Brock, W. & Durlauf, S. (2001). Discrete choice with social interactions. Review of Economic
  Studies, 68, 235­261.

Brown, B. W. & Newey, W. K. (1998). Efficient semiparametric estimation of expectations.
  Econometrica, 66(2), 453 ­ 464.

Callaert, H. & Veraverbeke, N. (1981). The order of the normal approximation for a studen-
  tized u-statistic. Annals of Statistics, 9(1), 194 ­ 200.

Cameron, A. C. & Golotvina, N. (2005). Estimation of country-pair data models control-
  ling for clustered errors: with international trade applications. Technical Report 06-13,
  University of California - Davis.

Cameron, A. C. & Miller, D. L. (2014). Robust inference for dyadic data. Technical report,
  University of California - Davis.

Cattaneo, M., Crump, R., & Jansson, M. (2014). Small bandwidth asymptotics for density-
  weighted average derivatives. Econometric Theory, 30(1), 176 ­ 200.

Cattelan, M. & Varin, C. (2013). Advances in Theoretical and Applied Statistics, chapter A
  model for correlated paired comparison data, (pp. 167 ­ 176). Springer-Verlag: Heidelberg.


                                             114
Chamberlain, G. (1980). Analysis of covariance with qualitative data. Review of Economic
 Studies, 47(1), 225 ­ 238.

Chamberlain, G. (1984). Handbook of Econometrics, volume 2, chapter Panel Data, (pp.
 1247 ­ 1318). North-Holland: Amsterdam.

Chamberlain, G. (1985). Longitudinal Analysis of Labor Market Data, chapter Heterogeneity,
 omitted variable bias, and duration dependence, (pp. 3 ­ 38). Cambridge University Press:
 Cambridge.

Chamberlain, G. (1992). Efficiency bounds for semiparametric regression. Econometrica,
 60(3), 567 ­ 596.

Chandrasekhar, A. (2015). Econometrics of network formation. In Y. Bramoullé, A. Galeotti,
 & B. Rogers (Eds.), Oxford Handbook on the Economics of Networks. Oxford University
 Press.

Chatterjee, S. (2017). Large Deviations for Random Graphs. Cham, Switzerland: Springer.

Chatterjee, S. & Dembo, A. (2016). Nonlinear large deviations. Advances in Mathematics,
 299(20), 396 ­ 450.

Chatterjee, S. & Diaconis, P. (2013). Estimating and understanding exponential random
 graph models. Annals of Statistics, 41(5), 2428 ­ 2461.

Chatterjee, S., Diaconis, P., & Sly, A. (2011). Random graphs with a given degree sequence.
 Annals of Applied Probability, 21(4), 1400 ­ 1435.

Chib, S. & Greenberg, E. (1998). Analysis of multivariate probit models. Biometrika, 82(2),
 347 ­ 361.

Choi, T. Y. & Wu, Z. (2009). Triads in supply networks: theorizing buyer-supplier-supplier
 relationships. Journal of Supply Chain Management, 45(1), 8 ­ 25.

Choo, E. & Siow, A. (2006). Who marries whom and why? Journal of Political Economy,
 114(1), 175 ­ 201.

Christakis, N. A., Fowler, J. H., Imbens, G. W., & Kalyanaraman, K. (2010). An empirical
 model for strategic network formation. NBER Working Paper 16039, National Bureau of
 Economic Research.

Chu, J. S. G. & Davis, G. F. (2016). Who killed the inner circle? the decline of the american
  corporate interlock network. American Journal of Sociology, 122(3), 714 ­ 754.

                                            115
Coleman, J. S. (1988). Social capital in the creation of human capital. American Journal of
  Sociology, 94(S), S95 ­ S120.

Conley, T. G. & Udry, C. R. (2010). Learning about a new technology: pineapple in ghana.
  American Economic Review, 100(1), 35 ­ 69.

Cox, D. R. & Reid, N. (2004). A note on pseudolikelihood constructed from marginal
  densities. Biometrika, 91(3), 729 ­ 737.

Crane, H. (2018). Probabilistic Foundations of Statistical Network Analysis. Boca Raton:
  CRC Press.

Crane, H. & Towsner, H. (2018). Relatively exchangeable structures. Journal of Symbolic
  Logic, 83(2), 416 ­ 442.

Currarini, S., Jackson, M., & Pin, P. (2009). An economic model of friendship: homophily,
 minorities and segregation. Econometrica, 77(4), 1003 ­ 1045.

Daudin, J.-J., Picard, F., & Robin, S. (2008). A mixture model for random graphs. Statistics
 and Computing, 18(2), 173 ­ 183.

Davezies, L., d'Haultfoeuille, X., & Guyonvarch, Y. (2019). Empirical process results for
  exchangeable arrayes. Technical report, CREST-ENSAE.

Davis, G. F. (1991). Agents without principles? the spread of the poison pill through the
  intercorporate network. Administrative Sciences Quarterly, 36(4), 583 ­ 613.

Davis, G. F. (1996). The significance of board interlocks for corporate governance. Corporate
  Governance: An International Review, 4(3), 154 ­ 159.

De Benedictis, L., Nenci, S., Santoni, G., Tajoli, L., & Vicarelli, C. (2014). Network analysis
  of world trade using the baci-cepii dataset. Global Economy Journal, 14(3-4), 287­343.

de Finetti, B. (1931). Funzione caratteristica di un fenomeno aleatorio. Atti della R.
  Academia Nazionale dei Lincei, Serie 6. Memorie, Classe di Scienze Fisiche, Mathematice
  e Naturale, 4, 251 ­ 299.

de Paula, A. (2013). Econometric analysis of games with multiple equilibria. Annual Review
  of Economics, 5, 107­131.

de Paula, Á. (2017). Advances in Economics and Econometrics, Eleventh World Congress,
  volume 1, chapter Econometrics of network models, (pp. 268 ­ 323). Cambridge University
  Press: Cambridge.

                                             116
de Paula, Á., Richards-Shubik, S., & Tamer, E. (2018). Identifying preferences in networks
  with bounded degree. Econometrica, 86(1), 263 ­ 288.

De Weerdt, J. (2004). Insurance Against Poverty, chapter Risk-sharing and endogenous
  network formation, (pp. 197 ­ 216). Oxford University Press: Oxford.

Dhyne, E., Magerman, G., & Rubínova, S. (2015). The Belgian production network 2002-
 2012. Working Paper 288, National Bank of Belgium.

Diaconis, P. (1977). Finite forms of de finetti's theorem on exchangeability. Synthese, 36(2),
  271 ­ 281.

Diaconis, P. & Freedman, D. (1980). Finite exchangeable sequences. Annals of Probability,
  8(4), 745 ­ 764.

Diaconis, P., Holmes, S., & Janson, S. (2008). Threshold graph limits and random threshold
  graphs. Internet Mathematics, 5(3), 267 ­ 320.

Diaconis, P. & Janson, S. (2008). Graph limits and exchangeable random graphs. Rendiconti
  di Matematica, 28(1), 33 ­ 61.

Dooley, P. C. (1969). The interlocking directorate. American Economic Review, 59(3), 314
 ­ 323.

Ductor, L., Fafchamps, M., & Goyal, S. (2014). Social networks and research output. Review
 of Economics and Statistics, 96(5), 936 ­ 948.

Dzemski, A. (2018). An empirical model of dyadic link formation in a network with unob-
  served heterogeneity. Review of Economics and Statistics. University of Mannheim.

Efron, B. & Stein, C. (1981). The jackknife estimate of variance. Annals of Statistics, 9(3),
  586 ­ 596.

Erikson, R. S., Pinto, P. M., & Rader, K. T. (2014). Dyadic analysis in international relations:
  a cautionary tale. Political Analysis, 22(4), 457 ­ 463.

Fafchamps, M. & Gubert, F. (2007). The formation of risk sharing networks. Journal of
  Development Economics, 83(2), 326 ­ 350.

Fafchamps, M. & Lund, S. (2003). Risk sharing networks in rural philippines. Journal of
  Development Economics, 71(2), 261 ­ 287.



                                              117
Fafchamps, M. & Minten, B. (2002). Returns to social network capital among traders. Oxford
  Economic Papers, 54(2), 173 ­ 206.

Fee, C. E. & Thomas, S. (2004). Sources of gains in horizontal mergers: evidence from
  customer, supplier, and rival firms. Journal of Financial Economics, 74(3), 423 ­ 460.

Fernández-Val, I. & Weidner, M. (2016). Individual and time effects in nonlinear panel data
  models with large n, t. Journal of Econometrics, 192(1), 291 ­ 312.

Frank, O. (1979). Moment properties of subgraph counts in stochastic graphs. Annals of the
  New York Academy of Sciences, 319(1), 207 ­ 218.

Frank, O. (1980). Transitivity in stochastic graphs and digraphs. Journal of Mathematical
  Sociology, 7(2), 199 ­ 213.

Frank, O. (1988). Triad count statistics. Discrete Mathematics, 72(1-3), 141 ­ 149.

Frank, O. (1997). Composition and structure of social networks. Mathematiques, Informa-
  tique, et Sciences Humaines, 137(1), 11 ­ 24.

Frank, O. & Snijders, T. A. B. (1994). Estimating the size of hidden populations using
  snowball sampling. Journal of Official Statistics, 10(1), 53 ­ 67.

Galichon, A. & Salanie, B. (2017). The econometrics and some properties of separable
 matching models. American Economic Review, 107(5), 251 ­ 55.

Gao, C. & Lafferty, J. (2017). Testing network structuring using relations between small
 subgraph probabilities. arxiv 1704.06742, arXiv.

Gao, C., Lu, Y., & Zhou, H. H. (2015). Rate-optimal graphon estimation. Annals of
 Statistics, 43(6), 2624 ­ 2652.

Gaulier, G. & Zignago, S. (2010). BACI: International trade database at the product-level.
 Working Paper 2010-23, CEPII.

Gofman, M. (2017).       Efficiency and stability of a financial architecture with too-
 interconnected-to-fail institutions. Journal of Financial Economics, 124(1), 113 ­ 146.

Goldenberg, A., Zheng, A., Fienberg, S. E., & Airoldi, E. M. (2009). A survey of statistical
 network models. Foundations and Trends in Machine Learning, 2(2), 129­333.

Goldsmith-Pinkham, P. & Imbens, G. W. (2013). Social networks and the identification of
 peer effects. Journal of Business and Economic Statistics, 31(3), 253 ­ 264.

                                            118
Goodman, L. (2017). The effect of the affordable care act medicaid expansion on migration.
 Journal of Policy Analysis and Management, 36(1), 211 ­ 238.

Gould, R. V. & Fernandez, R. M. (1989). Structures of mediation: a formal approach to
 brokerage in transaction networks. Sociological Methodology, 19, 89 ­ 126.

Gourieroux, C., Monfort, A., & Renault, E. (1993). Indirect inference. Journal of Applied
 Econometrics, 8(S), S85 ­ S118.

Graham, B. (2008). Identifying social interactions through conditional variance restrictions.
  Econometrica, 76(3), 643­660.

Graham, B. S. (2011). Efficiency bounds for missing data models with semiparametric
  restrictions. Econometrica, 79(2), 437 ­ 452.

Graham, B. S. (2013). Comparative static and computational methods for an empirical
  one-to-one transferable utility matching model. Advances in Econometrics, 31, 153 ­ 181.

Graham, B. S. (2015). Methods of identification in social networks. Annual Review of
  Economics, 7(1), 465­485.

Graham, B. S. (2016). Homophily and transitivity in dynamic network formation. NBER
  Working Paper 22186, National Bureau of Economic Research.

Graham, B. S. (2017). An econometric model of network formation with degree heterogeneity.
  Econometrica, 85(4), 1033 ­ 1063.

Graham, B. S. (2018a). Dyadic regression. Lecture Notes.

Graham, B. S. (2018b). Identifying and estimating neighborhood effects. Journal of Eco-
  nomic Literature, 56(2), 450 ­ 500.

Graham, B. S. & de Paula, A., Eds. (2020). The Econometric Analysis of Network Data.
  Academic Press.

Graham, B. S., Imbens, G. W., & Ridder, G. (2010). Measuring the effects of segregation in
  the presence of social spillovers: a nonparametric approach. Working Paper 16499, NBER.

Graham, B. S., Imbens, G. W., & Ridder, G. (2014). Complementarity and aggregate
  implications of assortative matching: a nonparametric analysis. Quantitative Economics,
  5(1), 29 ­ 66.



                                            119
Graham, B. S., Imbens, G. W., & Ridder, G. (2018). Identification and efficiency bounds for
  the average match function under conditionally exogenous matching. Journal of Business
  and Economic Statistics.

Graham, B. S., Niu, F., & Powell, J. L. (2019). Kernel density estimation for undirected
  dyadic data. Technical report, University of California - Berkeley.

Graham, B. S. & Pelican, A. (2020). The Econometrics of Social and Economic Networks,
  chapter Testing for externalities in network formation using simulation",. Elsevier: Ams-
  terdam.

Granovetter, M. S. (1973). The strength of weak ties. American Journal of Sociology, 78(6),
  1360 ­ 1380.

Granovetter, M. S. (1985). Economic action and social structure: the problem of embedded-
  ness. American Journal of Sociology, 91(3), 481 ­ 510.

Green, A. & Shalizi, C. R. (2017). Bootstrapping exchangeable random graphs. Technical
  Report 1711.00813v1, arXiv.

Gualdani, C. (forthcoming). An econometric model of network formation with an application
 to board interlocks between firms. Journal of Econometrics.

Hagedoorn, J. (2002). Inter-firm r & d partnerships: an overview of major trends and
  patterns since 1960. Research Policy, 31(4), 477 ­ 492.

Hahn, J. & Newey, W. K. (2004). Jackknife and analytical bias reduction for nonlinear panel
  data models. Econometrica, 72(4), 1295 ­ 1319.

Hausman, J. & Taylor, W. (1981). Panel data and unobservable individual effects. Journal
  of Econometrics, 49(6), 1377 ­ 1398.

He, R. & Zheng, T. (2013). Estimation of exponential random graph models for large
  social networks via graph limits. In Advances in Social Networks Analysis and Mining
  (ASONAM).

Heckman, J. J., Smith, J., & Clements, N. (1997). Making the most out of programme
  evaluations and social experiments: accounting for heterogeneity in programme impacts.
  Review of Economic Studies, 64(4), 487 ­ 535.




                                           120
Heckman, J. J. & Vytlacil, E. J. (2007). Handbook of Econometrics, volume 6B, chapter
  Econometric evaluation of social programs, part I: causal models, structural models and
  econometric policy evaluation, (pp. 4779 ­ 4874). North-Holland: Amsterdam.

Hellmann, T. (2013). On the existence and uniqueness of pairwise stable networks. Interna-
  tional Journal of Game Theory, 42(1), 211 ­ 237.

Helpman, E., Melitz, M., & Rubinstein, Y. (2008). Estimating trade flows: trading partners
  and trading volumes. Quarterly Journal of Economics, 123(2), 441 ­ 487.

Hensvik, L. & Skans, O. N. (2016). Social networks, employee selection, and labor market
  outcomes. Journal of Labor Economics, 34(4), 825 ­ 867.

Hilgerdt, F. (1943). The case for multilateral trade. American Economic Review, 33(1 (Part
  2)), 393 ­ 407.

Ho, K. (2009). Insurer-provider networks in the medical care market. American Economic
  Review, 99(1), 393 ­ 430.

Hoeffding, W. (1948). A class of statistics with asymptotically normal distribution. Annals
 of Mathematical Statistics, 19(3), 293 ­ 325.

Hoff, P., Raftery, A., & Handcock, M. (2002). Latent space approaches to social network
  analysis. Journal of the American Statistical Association, 97, 1090­1098.

Holland, P. W. & Leinhardt, S. (1970). A method for detecting structure in sociometric
  data. American Journal of Sociology, 76(3), 492 ­ 513.

Holland, P. W. & Leinhardt, S. (1976). Local structure in social networks. Sociological
  Methodology, 7, 1 ­ 45.

Holland, P. W. & Leinhardt, S. (1981). An exponential family of probability distributions
  for directed graphs. Journal of the American Statistical Association, 76(373), 33 ­ 50.

Honoré, B. E. & Powell, J. L. (1994). Pairwise difference estimators of censored and truncated
  regression models. Journal of Econometrics, 64(1-2), 241 ­ 278.

Hoover, D. N. (1979). Relations on probability spaces and arrays of random variables. Tech-
 nical report, Institute for Advanced Study, Princeton, NJ.

Imbens, G. W. & Rubin, D. B. (2015). Causal Inference for Statistics, Social, and Biomedical
  Sciences: An Introduction. Cambridge: Cambridge University Press.

                                             121
Imbens, G. W. & Wooldridge, J. M. (2009). Recent developments in the econometrics of
  program evaluation. Journal of Economic Literature, 47(1), 5 ­ 86.

Ioannides, Yannis, M. & Loury, L. D. (2004). Job information networks, neighborhood
  effects, and inequality. Journal of Economic Literature, 42(4), 1056 ­ 1093.

Isakov, A., Fowler, J. H., Airoldi, E. M., & Christakis, N. A. (2019). The structure of
  negative social ties in rural village networks. Sociological Science, 6(8), 197 ­ 217.

Jackson, M. & Watts, A. (2001). The existence of pairwise stable networks. Seoul Journal
  of Economics, 14(3), 299 ­ 321.

Jackson, M. O. (2008). Social and Economic Networks. Princeton: Princeton University
  Press.

Jackson, M. O., Rodriguez-Barraquer, T., & Tan, X. (2012). Social capital and social quilts:
  network patterns of favor exchange. American Economic Review, 102(5), 1857­1897.

Jackson, M. O. & Rogers, B. W. (2007). Relating network structure to diffusion properties
  through stochastic dominance. B.E. Journal of Theoretical Economics, 7(1), (Advances)
  Article 6.

Jackson, M. O., Rogers, B. W., & Zenou, Y. (2017). The economic consequences of social-
  network structure. Journal of Economic Literature, 55(1), 49 ­ 95.

Jackson, M. O. & Wolinsky, A. (1996). A strategic model of social and economic networks.
  Journal of Economic Theory, 71(1), 44 ­ 74.

Jackson, M. O. & Yariv, L. (2011). Handbook of Social Economics, volume 1A, chapter
  Diffusion, strategic interaction, and social structure, (pp. 645 ­ 678). North-Holland:
  Amsterdam.

Jackson, M. O. & Zenou, Y. (2015). Handbook of Game Theory, volume 4, chapter Games
  on networks, (pp. 95 ­ 163). North-Holland: Amsterdam.

Jaffe, A. (1986). Technological opportunity and spillovers of r&d: evidence from firms'
  patents, profits, and market value. American Economic Review, 76(5), 984 ­ 1001.

Janson, S., Luczak, T., & Rucinski, A. (2000). Random Graphs. New York: John Wiley &
  Sons, Inc.




                                            122
Janson, S. & Nowicki, K. (1991). The asymptotic distributions of generalized u-statistics
  with applications to random graphs. Probability Theory and Related Fields, 90(3), 341 ­
  375.

Janssen, P. (1994). Weighted bootstrapping of u-statistics. Journal of Statistical Planning
  and Inference, 38(1), 31­41.

Jia, P. (2008). What happens when wal-mart comes to town: an empirical analysis of the
  discount retailing industry. Econometrica, 76(6), 1263 ­ 1316.

Jochmans, K. (2018). Semiparametric analysis of network formation. Journal of Business
  and Economic Statistics, 36(4), 705 ­ 713.

Johnsson, I. & Moon, H. R. (2017). Estimation of peer effects in endogenous social networks:
  control function approach. USC-INET Research Paper No. 17-25, University of Souther
  California.

Kallenberg, O. (2005). Probabilistic Symmetries and Invariance Principles. New York:
 Springer-Verlag.

Keane, M. P. (1994). A computationally practical simulation estimator for panel data.
  Econometrica, 62(1), 95 ­ 116.

Kim, D. A., Hwong, A. R., Stafford, D., Hughes, D. A., O'Malley, A. J., Fowler, J. H.,
  & Christakis, N. A. (2015). Social network targeting to maximise population behaviour
  change: a cluster randomised controlled trial. Lancet, 386(9989), 145 ­ 153.

Kolaczyk, E. D. (2009). Statistical Analysis of Network Data. New York: Springer.

König, M. D., Liu, X., & Zenou, Y. (2019). R&d networks: theory, empirics and policy
 implications. Review of Economics and Statistics, 101(3), 476 ­ 491.

Kranton, R. & Minehart, D. (2001). A theory of buyer-seller networks. American Economic
  Review, 91(3), 485­508.

Krivitsky, P. N., Handcock, M. S., Raftery, A. E., & Hoff, P. D. (2009). Representing degree
  distributions, clustering, and homophily in social networks with latent cluster random
  effects models. Social Networks, 31(2), 204 ­ 213.

Kuersteiner, G. M. (2019). Limit theorems for data with network structure.            arXiv
 arXiv:1908.02375, University of Maryland.


                                            123
Lehmann, E. L. (1999). Elements of Large-Sample Theory. New York: Springer.

Leung, M. (2015). Two-step estimation of network-formation models with incomplete infor-
  mation. Journal of Econometrics, 188(1), 182 ­ 195.

Leung, M. (2019). A weak law for moments of pairwise stable networks. Journal of Econo-
  metrics, 210(2), 310 ­ 326.

Leung, M. & Moon, H. R. (2019). Normal approximation in large network models. arXiv
  arXiv:1904.11060, University of Southern California.

Lindsey, B. G. (1988). Composite likelihood. Contemporary Mathematics, 80, 221 ­ 239.

Loury, G. C. (2002). The Anatomy of Racial Inequality. Cambridge, MA: Harvard University
  Press.

Lovász, L. (2012). Large Networks and Graph Limits, volume 60 of American Mathematical
  Society Colloquium Publications. American Mathematical Society.

Lovász, L. & Szegedy, B. (2006). Limits of dense graph sequences. Journal of Combinatorial
  Theory, Series B, 96, 933­957.

Manski, C. F. (1993). Identification of endogenous social effects: the reflection problem,.
 Review of Economic Studies, 60(3), 531 ­ 542.

Mao, L. (2018). On causal estimation using u-statistics. Biometrika, 105(1), 215 ­ 220.

Marsden, P. V. (1987). Core discussion networks of americans. American Sociological Review,
 52(1), 122 ­ 131.

Mayda, A. M. (2010). International migration: a panel data analysis of the determinants of
 bilateral flows. Journal of Population Economics, 23(4), 1249 ­ 1274.

McFadden, D. (1974). Frontiers in Econometrics, chapter Conditional logit analysis of qual-
 itative choice behavior, (pp. 105 ­ 142). Academic Press: New York.

McFadden, D. (1989). A method of simulated moments for estimation of discrete response
 models without numerical integration. Econometrica, 67(5), 995 ­ 1026.

McPherson, M., Smith-Lovin, L., & Brashears, M. E. (2006). Social isolation in america:
 changes in core discussion networks over two decades. American Sociological Review, 71(3),
 353 ­ 375.


                                           124
Mele, A. (2017). A structural model of dense network formation. Econometrica, 85(3), 825
 ­ 850. John Hopkins University.

Mele, A. & Zhu, L. (2017). Approximate variational estimation for a model of network
 formation. Technical report, John Hopkins University.

Menzel, K. (2016). Strategic network formation with many agents. New York University.

Menzel, K. (2017). Bootstrap with clustering in two or more dimensions. Technical Report
 1703.03043v2, arXiv.

Milo, R., Shen-Orr, S., Itzkovitz, S., Kashtan, N., Chklovskii, D., & Alon, U. (2002). Network
 motifs: simple building blocks of complex networks. Science, 298(5594), 824 ­ 827.

Min, S. (2019). Network of loyalty programs: a sequential formation. Technical report,
 University of California - Berkeley.

Miyauchi, Y. (2016). Structural estimation of a pairwise stable network with nonnegative
 externality. Journal of Econometrics, 195(2), 224 ­ 235.

Monderer, D. & Shapley, L. S. (1996). Potential games. Games and Economic Behavior,
 14(1), 124 ­ 143.

Moreno, J. L. (1934). Who Shall Survive? New York: Beacon House.

Munski, K. (2003). Networks in the modern economy: Mexican migrants in the us labor
 market. Quarterly Journal of Economics, 118(2), 549 ­ 599.

Nadler, C. (2015). Networked inequality: evidence from freelancers. University of California
  - Berkeley.

Newey, W. K. & McFadden, D. (1994). Handbook of Econometrics, volume 4, chapter Large
  sample estimation and hypothesis testing, (pp. 2111 ­ 2245). North-Holland: Amsterdam.

Newman, M. E. J. (2001). The structure of scientific collaboration networks. Proceedings of
  the National Academy of Sciences, 98(2), 404 ­ 409.

Newman, M. E. J. (2010). Networks: An Introduction. Oxford: Oxford University Press.

Nowicki, K. (1991). Asymptotic distributions in random graphs with applications to social
  networks. Statistica Neerlandica, 45(3), 295 ­ 325.




                                             125
Nowicki, K. & Wierman, J. C. (1988). Subgraph counts in random graphs using incomplete
  u-statistics methods. Discrete Mathematics, 72(1-3), 299 ­ 310.

Olhede, S. C. & Wolfe, P. J. (2014). Network histograms and universality of blockmodel
  approximation. Proceedings of the National Academy of Sciences, 11(41), 14722 ­ 14727.

Orbanz, P. & Roy, D. M. (2015). Bayesian models of graphs, arrays and other exchangeable
  randoms structures. IEEE Transactions on Pattern Analysis and Machine Intelligence,
  37(2), 437 ­ 461.

Ortega, F. & Peri, G. (2013). The effect of income and immigration policies on international
  migration. Migration Studies, 1(1), 47 ­ 74.

Ostrovsky, M. (2008). Stability in supply chain networks. American Economic Review, 98(3),
  897 ­ 923.

Owen, A. B. (2007). The pigeonhole bootstrap. Annals of Applied Statistics, 1(2), 386 ­ 411.

Pakes, A. & Pollard, D. (1989). Simulation and the asymptotics of optimization estimators.
  Econometrica, 57(5), 1027 ­ 1057.

Pelican, A. & Graham, B. S. (2019). Testing for strategic interaction in social and economic
  network formation. Technical report, University of California - Berkeley.

Penrose, M. (2003). Random Geometric Graphs. Oxford: Oxford University Press.

Picard, F., Daudin, J. J., Koskas, M., Schbath, S., & Robin, S. (2008). Assessing the
  exceptionality of network motifs. Journal of Computational Biology, 15(1), 1 ­ 20.

Przulj, N., Corneil, D. G., & Jurisica, I. (2004). Modeling interactome: scale-free or geomet-
  ric? Bioinformatics, 20(18), 3508­3515.

Qu, X. & Lee, L.-F. (2015). Estimating a spatial autoregressive model with an endogenous
 spatial weight matrix. Journal of Econometrics, 184(2), 209 ­ 232.

Ridder, G. & Sheng, S. (2017). Estimation of large network formation games. Technical
  report, University of California - Los Angeles.

Robins, G., Pattison, P., Kalish, Y., & Lusher, D. (2007a). An introduction to exponential
  random graph (p ) models for social networks. Social Networks, 29(2), 173 ­ 191.




                                             126
Robins, G., Snijders, T., Wang, P., Handcock, M., & Pattison, P. (2007b). Recent devel-
  opments in exponential random graph (p ) models for social networks. Social Networks,
  29(2), 192 ­ 215.

Rose, A. (2005). Which international institutions promote international trade? Review of
  International Economics, 13(4), 682 ­ 698.

Rose, A. K. (2004). Do we really know that the wto increases trade? American Economic
  Review, 94(1), 98 ­ 114.

Rosenbaum, P. R. (2007). Interference between units in randomized experiments. Journal
  of American Statistical Association, 102(477), 191 ­ 200.

Rubin, D. B. (1981). Estimation in parallel randomized experiments. Journal of Educational
  Statistics, 6(4), 377 ­ 400.

Russett, B. M. & Oneal, J. R. (2001). Triangulating Peace: Democracy, Interdependence
  and International Organizations. New York: Norton.

Santos Silva, J. & Tenreyro, S. (2006). The log of gravity. Review of Economics and Statistics,
  88(4), 641 ­ 658.

Santos Silva, J. & Tenreyro, S. (2010). Currency unions in prospect and retrospect. Annual
  Review of Economics, 2, 51 ­ 74.

Saygin, P. O., Weber, A., & Weynandt, M. A. (2014). Coworkers, networks and job search
  outcomes. Iza dp no. 8174, IZA Institute of Labor Economics.

Schwartz, A. L. & Sommers, B. D. (2014). Moving for medicaid? recent eligibility expansions
  did not induce migration from other states. Health Affairs, 33(1), 88 ­ 94.

Serfling, R. J. (1980). Approximation Theorems of Mathematical Statistics. Wiley Series in
  Probability and Statistics. New York: John Wiley & Sons, Inc.

Serpa, J. C. & Krishnan, H. (2017). The impact of supply chains on firm-level productivity.
  Management Science.

Shalizi, C. R. (2016). Lecture 1: Conditionally-independent dyad models. Lecture note,
  Carnegie Mellon University.

Shalizi, C. R. & Rinaldo, A. (2013). Consistency under sampling of exponential random
  graph models. Annals of Statistics, 41(2), 508 ­ 535.

                                             127
Sheng, S. (2014). A structural econometric analysis of network formation games. Mimeo,
  University of California - Los Angeles.

Simmel, G. (1908). Soziologie. Untersuchungen über die formen der vergesellschaftung.
  Leipzig: Duncker & Humblot.

Snijders, T. (2002). Markov chain monte carlo estimation of exponential random graph
  models. Journal of Social Structure, 3(2), 1­40.

Snijders, T. A. B. & Borgatti, S. P. (1999). Non-parametric standard errors and tests for
  network statistics. Connections, 22(2), 61 ­ 70.

Snijders, T. A. B., Pattison, P. E., Robins, G. L., & Handcock, M. S. (2006). New spec-
  ifications for exponential random graph models. Sociological Methodology, 36(1), 99 ­
  153.

Tabord-Meehan, M. (2018). Inference with dyadic data: Asymptotic behavior of the dyadic-
  robust t-statistic. Journal of Business and Economic Statistics.

Tamer, E. (2003). Incomplete simultaneous discrete response model with multiple equilibria.
  Review of Economic Studies, 70(1), 147 ­ 165.

Tarski, A. (1955). A lattice-theoretical fixpoint theorem and its applications. Pacific Journal
  of Mathematics, 5(2), 285 ­ 309.

Tinbergen, J. (1962). Shaping the World Economy: Suggestions for an International Eco-
  nomic Policy. New York: Twentieth Century Fund.

Tomasello, M. V., Napoletano, M., Garas, A., & Schweitzer, F. (2017). The rise and fall of
  r&d networks. Industrial and Corporate Change, 26(4), 617 ­ 646.

Topkis, D. M. (1998). Supermodularity and Complementarity. Princeton, NJ: Princeton
  University Press.

Townsend, R. M. (1994). Risk and insurance in village india. Econometrica, 62(3), 539 ­
  591.

Udry, C. R. (1994). Risk and insurance in a rural credit market: an empirical investigation
 in northern nigeria. Review of Economic Studies, 61(3), 495 ­ 526.

Uetake, K. & Watanabe, Y. (2013). Estimating supermodular games using rationalizable
  strategies. Advances in Econometrics, 31(1), 233 ­ 247.

                                             128
van der Vaart, A. W. (2000). Asymptotic Statistics. Cambridge: Cambridge University
  Press.

van Duijn, M. A. J., Snijders, T. A. B., & Zijlstra, B. J. H. (2004). p2: a random effects
  model with covariates for directed graphs. Statistica Neerlandica, 58(2), 234 ­ 254.

VanderWeele, T. J. & An, W. (2013). Handbook of Causal Analysis for Social Research,
  chapter Social networks and causal inference, (pp. 353 ­ 374). Springer: Dordrecht.

Varin, C., Reid, N., & Firth, D. (2011). An overview of composite likelihood methods.
  Statistica Sinica, 21(1), 5 ­ 42.

Volfosky, A. & Airoldi, E. M. (2016). Sharp total variational bounds for finitely exchangeable
  arrays. Statistics and Probability Letters, 114, 54 ­ 59.

Wainwright, M. J. & Jordan, M. I. (2008). Graphical models, exponential families, and
 variational inference. Foundations and Trends in Machine Learning, 1(1-2), 1 ­ 305.

Wasserman, S. & Faust, K. (1994). Social Network Analysis: Methods and Applications.
 Cambridge: Cambridge University Press.

Wasserman, S. S. (1977). Random directed graph distributions and the triad census in social
 networks. Journal of Mathematical Sociology, 5(1), 61 ­ 86.

Wooldridge, J. M. (2005). Identification and inference for econometric models, chapter Unob-
 served heterogeneity and the estimation of average partial effects, (pp. 27 ­ 55). Number 3.
 Cambridge University Press: Cambridge.

Yan, T., Jiang, B., Fienberg, S. E., & Leng, C. (2018). Statistical inference in a directed
  network model with covariates. Journal of the American Statistical Association.

Zijlstra, B. J. H., van Duijn, M. A. J., & Snijders, T. A. B. (2009). Mcmc estimation for the
  p2 network regression model with crossed random effects. British Journal of Mathematical
  and Statistical Psychology, 62(1), 143 ­ 166.




                                             129
