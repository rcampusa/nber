                                 NBER WORKING PAPER SERIES




   LAND OF ADDICTS? AN EMPIRICAL INVESTIGATION OF HABIT-BASED ASSET
                          PRICING BEHAVIOR

                                           Xiaohong Chen
                                         Sydney C. Ludvigson

                                         Working Paper 10503
                                 http://www.nber.org/papers/w10503


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       May 2004




We acknowledge financial support from the National Science Foundation (Chen), the Alfred P. Sloan
Foundation (Ludvigson), and the C.V. Starr Center at NYU. We thank Kenneth French for providing
the portfolio return data, and are grateful to John Campbell, David Chapman, John Cochrane, Yuichi
Kitamura, Per Krusell, Lars Hansen, Oliver Linton, Anthony Lynch, Monika Piazzesi, Masao Ogaki,
B. Ravikumar, Martin Schneider, Jim Stock, George Tauchen, Zhenyu Wang and seminar participants
at Carnegie Mellon GSIA, Columbia University, Norwegian School of Economics and Business Administration,
Norwegian School of Management, Notre Dame, NYU, University of Chicago, University of Maryland,
University of Pennsylvania, 2004 CIREQ-CIRANO Financial Econometrics Conference at Montreal,
2004 NBER Spring Asset Pricing meeting, 2003 NBER Summer Institute, 2004 American Finance
Association Meetings, and 2004 Econometric Society winter meetings for useful comments. Jinyong
Kim and Artem Voronov provided excellent research assistance. Any errors or omissions are the responsibility
of the authors. The views expressed herein are those of the author(s) and not necessarily those of the
National Bureau of Economic Research.

© 2004 by Xiaohong Chen and Sydney C. Ludvigson. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Land of Addicts? An Empirical Investigation of Habit-Based Asset Pricing Behavior
Xiaohong Chen and Sydney C. Ludvigson
NBER Working Paper No. 10503
May 2004
JEL No. G1

                                               ABSTRACT

This paper studies the ability of a general class of habit-based asset pricing models to match the conditional
moment restrictions implied by asset pricing theory. We treat the functional form of the habit as unknown,
and to estimate it along with the rest of the model's finite dimensional parameters. Using quarterly
data on consumption growth, assets returns and instruments, our empirical results indicate that the
estimated habit function is nonlinear, the habit formation is better described as internal rather than
external, and the estimated time-preference parameter and the power utility parameter are sensible.
In addition, the estimated habit function generates a positive stochastic discount factor (SDF) proxy
and performs well in explaining cross-sectional stock return data . We find that an internal habit SDF
proxy can explain a cross-section of size and book-market sorted portfolio equity returns better than
(i) the Fama and French (1993) three-factor model, (ii) Lettau and Ludvigson (2001) scaled consumption
CAPM model, (iii) an external habit SDF proxy, (iv) the classic CAPM, and (v) the classic consumption
CAPM.

Xiaohong Chen
Department of Economics
New York University
269 Mercer Street
7th Floor
New York, NY 10003
xiaohong.chen@nyu.edu

Sydney C. Ludvigson
Department of Economics
New York University
269 Mercer Street
7th Floor
New York, NY 10003
and NBER
sydney.ludvigson@nyu.edu
1        Introduction
A prominent explanation of aggregate stock market behavior says that assets are priced as if there
were a representative investor whose utility is a power function of the di¤erence between aggregate
consumption and a habit level.1 In these theories, the habit function is the central part of the
asset pricing model. With few exceptions (discussed below), these models have been empirically
evaluated by engaging in calibration and simulation exercises, in which a chosen set of moments
computed from model-simulated data are informally compared to those computed from historical
data. Although such calibration exercises are undoubtedly important as an initial step, a complete
assessment of the habit-based paradigm requires moving beyond calibration, to formal estimation,
hypothesis testing, and model comparison.
        Formal estimation, testing, and model comparison present some signi…cant challenges. Among
the most important is that theory does not provide precise guidelines about the functional form of
the habit. Consider the range of habit-based asset pricing models cited in footnote 1. All models
assume that the habit stock is a function of past and (possibly) contemporaneous consumption.
But there is substantial divergence across models in how the habit stock is speci…ed to vary with
aggregate consumption. Some work speci…es the habit stock as a linear function of past consump-
tion (e.g., Sundaresan (1989); Constantinides (1990); Heaton (1995); Jermann (1998); Boldrin,
Christiano, and Fisher (2001)). More recent theoretical work often takes as a starting point the
particular nonlinear habit speci…cation that includes current consumption developed in Campbell
and Cochrane (1999) (e.g., Campbell and Cochrane (2000); Li (2001); Wachter (2006); and Menzly,
Santos, and Veronesi (2004)). Moreover, there is no theoretical reason why other forms of nonlin-
earities could not be entertained. These considerations imply that the functional form of the habit
should be treated, not as a given, but as part and parcel of any empirical investigation.
        This study econometrically evaluates a general class of habit-based asset pricing models, placing
as few restrictions as possible on the speci…cation of the habit and no parametric restrictions on
the law of motion for consumption. The empirical model we explore follows the existing theoretical
literature and presumes that investor utility is a power function of the di¤erence between aggregate
consumption and a habit level, but we allow the habit to be an unknown function of lagged and
contemporaneous consumption. The resulting speci…cation for investor utility is semiparametric in
the sense that it contains both the …nite dimensional set of unknown parameters that are part of
the power function and time-preference, as well as the in…nite dimensional unknown habit function
that must be estimated nonparametrically.
    1
        See Sundaresan (1989), Constantinides (1990), Ferson and Harvey (1992), Heaton (1995), Jermann (1998), Camp-
bell and Cochrane (1999), Campbell and Cochrane (2000); Boldrin, Christiano, and Fisher (2001), Li (2001), Shore
and White (2002); Dai (2003); Menzly, Santos, and Veronesi (2004); Wachter (2006). We discuss these papers further
below.



                                                           1
   We estimate all the unknown parameters of this semiparametric asset pricing model, and con-
duct statistical tests of hypotheses regarding the functional form of the unknown habit as well as
statistical tests for whether an internal habit vs external habit speci…cation better describes the
data. We then compare the estimated habit model’s ability to …t a cross-section of equity returns
with that of other asset pricing models, both quantitatively and in formal statistical terms.
   Estimation and testing are conducted by applying a Sieve Minimum Distance (SMD) procedure
to a set of Euler equations corresponding to the habit-based framework we study. The SMD method
is a distribution-free minimum distance method, where the conditional moments associated with
the Euler equations are directly estimated nonparametrically as functions of conditioning variables.
The “sieve” part of the SMD procedure requires that the unknown function embedded in the
Euler equations (here the habit function) be approximated by a sequence of ‡exible parametric
functions, with the number of parameters expanding as the sample size grows (Grenander (1981)).
The unknown parameters of the stochastic discount factor, including the sieve parameters of the
habit function and the …nite-dimensional parameters that are part of the power function and time-
preference, may then be estimated by minimizing a weighted quadratic distance from zero of the
nonparametrically estimated conditional moments.
   Using stationary quarterly data on consumption growth, assets returns and instruments, we
apply the SMD procedure to directly estimate all the unknown parameters of interest in the Euler
equations underlying the optimal consumption choice of an investor with access to N asset payo¤s.
The SMD procedure is especially appealing for this application because it can be implemented
as an instance of Generalized Method of Moments (GMM, Hansen (1982)), an approach that is
familiar from prior work in estimating fully parametric, consumption-based asset pricing models
(e.g., Hansen and Singleton (1982)). In addition to being robust to misspeci…cation of the functional
form of the habit and the law of motion for the underlying fundamentals, the SMD procedure
estimates the unknown habit function consistently at some nonparametric rate. The procedure
also provides estimates of the …nite dimensional parameters, such as the curvature of the power
                                                                                          p
utility function and the subjective time-discount factor; these estimates converge at rate T (where
T is the sample size) and are asymptotically normally distributed. See the Appendix for details.
   Using this methodology, we empirically investigate a number of hypotheses about the speci…ca-
tion of habit-based asset pricing models that have not been previously investigated. One hypothesis
concerns whether the habit is better described as a linear or nonlinear function. We develop a sta-
tistical test of the hypothesis of linearity and …nd that the functional form of the habit is better
described as nonlinear rather than linear.
   A second hypothesis concerns the distinction between “internal” and “external” habit forma-
tion. About half of the theoretical papers cited in footnote 1 investigate models of internal habit
formation, in which the habit is a function of the agent’s own past consumption. The rest investi-


                                                 2
gate models of external habit formation, in which the habit depends on the consumption of some
exterior reference group, typically per capita aggregate consumption. Abel (1990) calls external
habit formation “catching up with the Joneses.” Determining which form of habit formation is
more empirically plausible is important because the two speci…cations can have dramatically dif-
ferent implications for optimal tax policy and welfare analysis (Ljungqvist and Uhlig (2000)), and
for whether habit models can explain long-standing asset-allocation puzzles in the international
…nance literature (Shore and White (2002)). To address this issue, we derive a conditional moment
restriction that nests the internal and external nonlinear habit function, under the assumption that
both functions are speci…ed over current and lagged consumption with the same …nite lag length.
Our empirical results indicate that the data are better described by internal habit formation than
external habit formation.
   The SMD approach also allows us to assess the quantitative importance of the habit in the power
utility speci…cation. Our empirical results suggest that the habit is a substantial fraction of current
consumption–about 97 percent on average–echoing the speci…cation of Campbell and Cochrane
(1999) in which the steady-state habit-consumption ratio exceeds 94 percent. The SMD estimated
habit function is concave and generates positive intertemporal marginal rate of substitution in
consumption. The SMD estimated subjective time-discount factor is around 0.99 and the estimated
power utility curvature parameter is about 0.80 for three di¤erent combinations of instruments and
asset returns.
   Finally, we undertake a statistical model comparison analysis. Because our habit-based asset
pricing model makes some parametric assumptions that may not be fully accurate (e.g., it maintains
the power utility speci…cation), and because the SMD-estimated nonparametric habit function con-
tains lagged consumption of only …nite lag length, the implied Stochastic Discount Factor (SDF)
should be best viewed as a proxy to the true unknown SDF. Thus, we evaluate the SMD-estimated
habit model and several competing asset pricing models by employing the model comparison dis-
tance metrics recommended in Hansen and Jagannathan (1997) (the so-called HJ distance and the
HJ+ distance), where all the models are treated as SDF proxies to the unknown truth. In particu-
lar, the SMD-estimated internal habit model is compared to (i) the SMD-estimated external habit
model, (ii) the three-factor asset pricing model of Fama and French (1993), (iii) the “scaled” con-
sumption Capital Asset Pricing Model (CAPM) of Lettau and Ludvigson (2001b), (iv) the classic
CAPM of Sharpe (1964) and Lintner (1965), and (v) the classic consumption CAPM of Breeden
(1979) and Breeden and Litzenberger (1978). Doing so, we …nd that a SMD-estimated internal
habit model can better explain a cross-section of size and book-market sorted equity returns, both
economically and in a statistically signi…cant way, than the other …ve competing models. These
results are particularly encouraging for the internal habit speci…cation, since the Fama and French
(1993) three-factor model and the Lettau and Ludvigson (2001b) scaled consumption CAPM have


                                                  3
previously displayed relative success in explaining the cross-section of stock market portfolio re-
turns.
    The rest of this paper is organized as follows. In the next section we discuss related literature
not discussed above. Section 3 presents the habit-based asset pricing framework to be estimated
and tested. In Section 4 we explain the estimation technique and its implementation. Section
5 describes the data. Section 6 presents the results of estimation and hypothesis testing about
linearity of the habit function. Section 7 presents the results of speci…cation tests for internal
versus external habit formation, and conducts statistical model comparison when all the competing
models are treated as potentially misspeci…ed. Section 8 concludes. In the Appendix we discuss
the identi…cation of model parameters, and the large sample properties of the SMD estimators, and
the related test statistics.


2    Related Literature
Our work builds o¤ and extends a preexisting empirical literature investigating the possible role of
non-separabilities in preferences. Habit- and durability-based asset pricing models, where the habit
is restricted to have a linear functional form, have been empirically investigated by Ferson and
Constantinides (1991) and Heaton (1995). We discuss these papers further below. Dynan (2000)
estimates a linear model of habit formation using household level data on food consumption. We
add to this literature by relaxing the functional form of the habit and by testing internal vs external
habit formation.
    Our work also relates to a previous asset pricing literature that approximates the entire SDF
nonparametrically. Gallant and Tauchen (1989) were among the …rst to nonparametrically estimate
a consumption-based asset pricing model using the so-called SNP (semi-nonparametric) method.
Their SNP procedure is a constrained sieve maximum likelihood method, where the conditional
density function is approximated by a truncated Hermite polynomial sieve, and where all the
unknown parameters, including the Hermite polynomial sieve coe¢ cients and the parameters of
the stochastic discount factor, are estimated by maximizing the approximate likelihood subject to
the conditional moment restriction constraints implied by an asset pricing theory. Gallant, Hansen,
and Tauchen (1990) employ the same SNP method to estimate the conditional density of a vector
of monthly asset payo¤s. Subsequently, Bansal and Viswanathan (1993) and Bansal, Hsieh, and
Viswanathan (1993) apply semi-nonparametric techniques to estimate nonlinear arbitrage-pricing
models, while Chapman (1997) approximates an asset pricing kernel using orthonormal polynomials
in state variables implied by a real business cycle model.
    Our asset pricing model is closest to that of Gallant and Tauchen (1989), but our work still
di¤ers from theirs and previous work in several respects. First, we introduce the SMD procedure as



                                                  4
a particularly useful approach in asset pricing studies of larger cross-sections of returns. The SNP
procedure of Gallant and Tauchen (1989) requires nonparametric estimation by constrained sieve
maximum likelihood of the entire joint conditional density of the consumption and return series,
which involves nonlinear numerical optimization of a likelihood function whose dimensionality grows
with the number of return series. For the application studied here, the SMD procedure is much
easier to implement, for two reasons: (i) it does not require nonparametric estimation of the
entire likelihood function; this is important because when the number of return series is large, the
dimensionality of the joint density to be estimated becomes prohibitive. (ii) the SMD procedure
works directly on the Euler equations implied by asset pricing theory and delivers closed-form
expressions for the estimated conditional moments (see Section 4).
   Second, while both the SMD and the SNP procedures have the advantage of avoiding any
parametric speci…cation of the law of motion of consumption growth, there is currently no large
sample theory on asymptotic properties such as convergence rates and limiting distributions of the
SNP estimator that could be applied to undertake statistical inference. Here we extend existing
large sample theories on the SMD estimator for I.I.D. data (see e.g., Newey and Powell (2003),
Ai and Chen (2003), Ai and Chen (2005)), to our asset pricing setting with stationary but not
necessarily serially uncorrelated data.
   Third, we investigate a number of interesting hypotheses speci…c to the habit-based theoretical
framework (such as internal vs external habit formation) that have not been investigated elsewhere.
To do so, we place more structure on the empirical asset pricing model than in previous work by
embedding the unknown habit function in the familiar power-utility framework. By contrast,
Gallant and Tauchen (1989) treat the entire period-by-period utility function as unknown and
approximate it using a polynomial sieve.
   Finally, we study the cross-sectional asset pricing properties of our estimated habit models using
a large number (e.g., N = 7; 17 or 26) of return series (including the especially challenging book-
market sorted portfolios of Fama and French 1992, 1993), and undertake an extensive statistical
model comparison analysis. Gallant and Tauchen (1989) instead focus on the time series asset
pricing properties of their SNP estimated model using a small number (N = 2) of asset return
series, and do not undertake any model comparison.
   The results in this paper may also be related to recent evidence on long-run consumption
correlations with asset returns. For example, Parker and Julliard (2004) …nd that the covariance
between stock returns and consumption growth over a horizon of three years explains a much larger
fraction of the cross-sectional variation in size and book-market portfolio returns than does the
covariance between stock returns and contemporaneous, one-period, consumption growth. Internal
habit formation provides one possible explanation for these …ndings, since in this case agents take
into account the a¤ect of today’s consumption on all future habit levels. This interpretation of


                                                 5
the data is supported by our empirical results. We …nd that the internal habit SDF performs as
well or better than other popular models in the literature and better than a purely external habit
SDF that omits forward-looking terms governing the a¤ect of today’s consumption on future habit
levels. The …ndings in this paper may therefore provide a structural interpretation of the results
in Parker and Julliard (2004).2 We discuss this further below.


3        The Model
In this section we present a model of investor behavior in which utility is a power function of the
di¤erence between aggregate consumption and the habit. We do not consider models in which
utility is a power function of the ratio of consumption to the habit stock, as in Abel (1990) and
Abel (1999). Ratio models of external habit formation imply that relative risk-aversion is constant,
hence they have di¢ culty accounting for the predictability of excess stock returns documented in the
empirical asset pricing literature.3 By contrast, di¤erence models can generate time-variation in the
equilibrium risk-premium because relative risk aversion varies countercyclically. Di¤erence models
are also far more common in the asset pricing literature; for example, the di¤erence speci…cation
is used in all the habit-based asset pricing models referenced in footnote 1 above.
        Throughout this paper we assume that identical agents maximize the utility function
                                                        1
                                                        X
                                                              t (Ct     Xt )1         1
                                           U =E                                           :                        (1)
                                                                        1
                                                        t=0

Here Xt is the level of the habit, and             is the subjective time discount factor. Xt is assumed to be a
function (known to the agent but unknown to the econometrician) of current and past consumption

                                              Xt = f (Ct ; Ct         1 ; :::; Ct L ) ;


such that Xt < Ct ; Xt          0: Note that we allow the habit to potentially depend on contemporaneous
as well as past consumption, a modeling choice that is a feature of several habit models in the recent
theoretical literature (e.g., Campbell and Cochrane (1999)).4
        When the habit is internal, the agent takes into account the impact of today’s consumption
decisions on future habit levels. In this case the intertemporal marginal rate of substitution in
    2
        Hansen, Heaton, and Li (2005) provide an alternative interpretation based on recursive preferences and long-run
consumption risk.
   3
     A large literature …nds that excess stock returns are forecastable; see Shiller (1981), Fama and French (1988),
Campbell and Shiller (1989), Campbell (1991), Harvey (1991) Hodrick (1992), Lamont (1998) Lettau and Ludvigson
(2001a).
   4
     In the conclusion we discuss a possible alternative speci…cation (a signi…cant extension of the empirical approach
developed here), in which the habit is a function of an in…nite number of lags and speci…ed as a recursive functional
of unknown form e.g., Xt = r (Ct ; Ct    1 ; Xt 1 ) :




                                                                 6
consumption is given by
                                                         M Ut+1
                                            Mt+1 =              ;                                                 (2)
                                                          M Ut
where                                              2                                       3
                                                    XL
                         @U                        4           j                     @Xt+j 5
                M Ut =       = (Ct       Xt )   Et                 (Ct+j    Xt+j )           ;                    (3)
                         @Ct                                                          @Ct
                                                         j=0

and where Et is the expectation operator conditional on information available at time t. When the
habit is external, agents maximize (1) but ignore the impact of today’s consumption on tomorrow’s
habits, since the habit in this speci…cation merely plays the role of an externality. In this case,
only the …rst term on the right-hand-side of (3), (Ct                Xt )   , is part of marginal utility. In
equilibrium, identical individuals choose the same consumption, so that regardless of whether the
habit is external or internal, individual consumption, Ct , is equal to aggregate consumption, Cta ,
which we denote Ct from now on.
   Although we have motivated the time-nonseparable model above with the notion of habit-
formation, the framework itself is suitable for studying more general forms of nonseparabilities.
For example, if an increase in past consumption raises Xt , then Xt is interpreted as a habit because
current consumption must now be higher to deliver the same utility. By contrast, if an increase in
past consumption decreases Xt , then Xt is consistent with durability, since increases in the stock
of durable goods add to current utility. In our empirical estimation we do not restrict the unknown
Xt to impose either speci…cation. Instead, we follow Gallant and Tauchen (1989), Ferson and
Constantinides (1991) and Heaton (1995) and freely estimate the function, letting the data dictate
the appropriate framework as pertains to habit-formation or durability. The results (discussed
below) are that Xt increases with past consumption (at all lags), favoring the habit interpretation
over the durability interpretation.
   The asset pricing model comes from the …rst-order conditions for optimal consumption choice
for an investor with access to N asset returns. The …rst-order conditions place restrictions on
the joint distribution of the intertemporal marginal rate of substitution in consumption and asset
returns and imply that, for any traded asset indexed by i, with a gross return at time t + 1 of
Ri;t+1 ; the following equation holds:

                              Et [Mt+1 Ri;t+1 ] = 1;               i = 1; :::; N:                                 (4)

Equation (4) shows that the intertemporal marginal rate of substitution in consumption, Mt , is
the stochastic discount factor (SDF), which in this setting depends on the unknown habit function.
The resulting N equations yield a set of conditional moment restrictions containing a vector of
unknown parameters, ( ; )0 , and a single unknown habit function Xt = f (Ct ; Ct               1 ; :::; Ct L ).




                                                     7
4     Empirical Implementation
This section presents the details of our estimation procedure. The model to be estimated in (4)
is semiparametric in the sense that it contains both …nite dimensional and in…nite dimensional
unknown parameters. Estimation in this setting may be undertaken using the SMD procedure …rst
developed in Newey and Powell (2003) and Ai and Chen (2003) for independent and identically
distributed (I.I.D.) data. In the Appendix we show that the SMD procedure and its large sample
properties can be extended to stationary ergodic time series data.

4.1   Transformation of the model

Since consumption is trending over time, it is necessary to transform the model to use stationary
observations on consumption growth. We address this problem by assuming that the unknown
habit function Xt = f (Ct ; Ct   1 ; :::; Ct L )   can be written as
                                                       Ct 1        Ct L
                                        Xt = Ct g           ; :::;                ;                               (5)
                                                        Ct          Ct
where g : RL ! R is an unknown function of the gross growth rates of consumption, with domain
space reduced by one dimension relative to f . Note that g now replaces f as the unknown function
to be estimated along with ( ; ) using the Euler equations (4) and the SMD procedure. As shown
below, this assumption allows us to express the stochastic discount factor, Mt+1 , as a function of
gross growth rates in consumption, which are plausibly stationary. One way to motivate (5) is to
presume that the original function Xt = f (Ct ; Ct              1 ; :::; Ct L )   is homogeneous of degree one, which
allows the function to be re-written as
                                                           Ct 1        Ct L
                                       Xt = Ct f      1;        ; :::;                ;                           (6)
                                                            Ct          Ct
and rede…ned as in (5). The homogeneous of degree one assumption is consistent with the habit
models studied in the asset pricing literature cited above, including the nonlinear habit speci…cation
investigated in Campbell and Cochrane (1999).
    When the habit stock is a homogeneous of degree one function of current and past consumption,
marginal utility, M Ut , takes the form
                                  Ct 1        Ct L
         M Ut = Ct        1   g        ; :::;                                                                     (7)
                                   Ct          Ct
                             2                                                                              3
                              X L
                                       Ct+j                             Ct+j 1        Ct+j L        @Xt+j 5
                     Ct   Et 4     j
                                                   1              g            ; :::;                       ;
                                         Ct                              Ct+j          Ct+j          @Ct
                                 j=0

where,               8        Ct+j 1      Ct+j L
                     >
                     > g       Ct+j ; :::; Ct+j                                                   8j 6= 0
           @Xt+j     < j
                 =                                                                                                (8)
            @Ct    >
                   >                                 PL
                   : g        Ct 1      Ct L                          Ct 1      Ct L      Ct i
                               Ct ; :::; Ct            i=1 gi          Ct ; :::; Ct        Ct      j=0

                                                            8
In the expression directly above, gi denotes the derivative of g with respect to its i th argument.
   To obtain an estimable expression for the unknown parameters of interest                                                                           = ( ; ; g)0 , the
Euler equations (4) must be rearranged so that the conditional expectation Et ( ) appears only
on the outside of the conditional moment restrictions. The Appendix presents several equivalent
expressions of this form; here we present one. Denote the true values of the parameters with an
“o” subscript:                 = ( o;                 0
                           o                  o ; go ) .   Combining (2), (7) and (4), and rearranging terms, we …nd a set
of N conditional moment conditions:
                    (                                                                                !              )
                          Ct+1      o
                 Et    o              zt+1 Ri;t+1                                                1            t+1       = 0;   i = 1; :::; N;                              (9)
                           Ct

where
               0                                                                                                                                            1
                                       Ct        Ct+1 L                        o
                       1       go     Ct+1 ; :::; Ct+1
               B                                                                                                                                            C
  zt+1         @                     PL     j           Ct+1+j             o                      Ct+j        Ct+j+1 L                    o    @Xt+1+j      A=         t+1 ;
                                        j=0 o            Ct+1                      1       go    Ct+1+j ; :::; Ct+1+j                           @Ct+1

                           0                                                                                                                                1
                                                     Ct 1      Ct L                    o
                                 1      go            Ct ; :::; Ct
                           B                                                                                                                                C
               t+1         @                    PL        j         Ct+j           o                         Ct+j 1      Ct+j L                o   @Xt+j    A:
                                                      j=0 o          Ct                    1     go           Ct+j ; :::; Ct+j                      @Ct

We may write (9) more compactly as

                                       E f i (zt+1 ;           o;    o ; go )jwt g             = 0;                     i = 1; :::; N;                                   (10)

where zt+1 is a vector containing all observations used to estimate the conditional moment (9) at
time t,    i   is de…ned as
                                                                                                                                    !
                                                                                       Ct+1              o

                                    i (zt+1 ; o ;        o ; go )              o                             zt+1 Ri;t+1        1        t+1 ;
                                                                                        Ct

and the conditional expectation in (10) is taken with respect to agents’information set at time t,
denoted wt .
   Let wt be a dw                    1 observable subset of wt that does not contain a constant. Equation (10)
implies
                                       E f i (zt+1 ;           o;     o ; go )jwt g            = 0;                     i = 1; :::; N:                                   (11)

We assume that the econometricians’ information set wt is informative enough, such that if
E f i (zt+1 ; ; ; g)jwt g = 0, i = 1; :::; N for any                                       > 0;          > 0; 0          g < 1; g(0; :::; 0) = 0, g 6=constant,
then ( ;       ; g)0   = ( o;        o ; go   )0 .    In the Appendix we discuss identi…cation of                                          o   = ( o;      o ; go )
                                                                                                                                                                   0   based
on the set of conditional moment restrictions (11) for the external habit model.
   Given the theoretical restrictions implied by (11), the true parameter values must satisfy the
minimum distance relation
                                                                    0
                                         o     = ( o;       o ; go )    = arg min E m(wt ; )0 m(wt ; ) ;                                                                 (12)

                                                                                           9
where m(wt ; ) = Ef (zt+1 ; )jwt g, (zt+1 ; ) = ( 1 (zt+1 ; ); :::;                            N (zt+1 ;         ))0 for any candidate
value       = ( ; ; g)0 .


4.2       SMD estimation

We are now in a position to describe the SMD estimation of                               = ( o;              0
                                                                                     o               o ; go )    using the conditional
moment restrictions model (11). The idea behind the SMD procedure has three essential parts.
First, although the functional form of the conditional mean m(wt ; ) = Ef (zt+1 ; )jwt g is un-
                                                                   b
known, we may replace it with a consistent nonparametric estimator m(w; ) for any candidate
parameter value             = ( ; ; g)0 . Second, although the habit function g is an in…nite-dimensional
unknown parameter, we can approximate it by a sequence of …nite-dimensional unknown parame-
ters (sieves) denoted gKT , where the approximation error decreases as the dimension KT increases
with the sample size T . Third, the function gKT is estimated jointly with the …nite-dimensional
parameters ( ; )0 by minimizing a (weighted) quadratic norm of estimated conditional expectation
functions:
                                                           T
                                                         1X
                                 b = arg min                 b t ; ; ; gKT )0 m(w
                                                             m(w              b t ; ; ; gKT ):                                   (13)
                                               ; ;gKT    T
                                                              t=1

       Implementation of the SMD estimator requires a consistent estimate of the conditional mean
m(wt ; ): Let fp0j (wt ); j = 1; 2; :::; JT g be a sequence of known basis functions (including a con-
stant function) that map from Rdw into R. Denote pJT ( )                             (p01 ( ) ; :::; p0JT ( ))0 and the T          JT
                                                    0
matrix P          pJ T   (w1   ) ; :::; pJT   (wT ) . Then

                                                    T
                                                                                               !
                                                    X
                                 b
                                 m(w; )=                      (zt+1 ; )pJT (wt )0 (P0 P)   1
                                                                                                   pJT (w)                       (14)
                                                        t=1

is a sieve Least Squares estimator of the conditional mean vector m(w; ) = Ef (zt+1 ; )jwt = wg:
(Note that JT must grow with the sample size to ensure that m(wt ; ) is estimated consistently).
       We show in the Appendix that, under the assumption of stationary ergodic observations and
some additional regularity conditions, the SMD estimate of g is consistent and converges at a rate
                                                                                      p
faster than T 1=4 , while the estimates of the …nite-dimensional parameters ( ; )0 are T consistent
and asymptotically normally distributed; hence the standard errors for b; b can be computed.
Unfortunately, a general asymptotic distribution theory for SMD estimators of unknown functions,
such as the habit function g, has not been developed;5 hence it is not possible to compute con…dence
intervals for habit function itself. Nevertheless, it is possible to conduct hypothesis tests about some
aspects of the functional form of the habit, as discussed below.
   5
       Some authors treat the sieve estimators of unknown functions as parametric ones and compute their standard
errors by applying standard root-T asymptotic normality theory. Such practices ignore the uncertainty of the unknown
functions and may in general lead to erroneous inference decisions.




                                                                      10
   We emphasize that the SMD method is likely to be particularly useful in asset pricing studies
                                                                                b i (w; ) of the
of larger cross-sections of returns. This is because the nonparametric estimate m
conditional mean mi (w; ); i = 1; :::; N; has a closed-form expression (14). An attractive feature
of this SMD estimator is that it is easy to implement as an instance of GMM with a particular
                                                                      b
weighting matrix. To see this, plug the sieve least squares estimator m(w; ) into (13) to obtain:
                                      h         i0                                        h         i
                                                                                     1
                           b = arg min g( ; yT ) fIN                          P0 P       g g( ; yT ) ;                        (15)

                                                0
where yT     z0T +1 ; :::z02 ; wT0 ; :::w10         denotes the vector containing all observations in the sample of
size T and
                                                                 T
                                                      T        1X
                                          gT ( ; y )               (zt+1 ; )pJT (wt )                                         (16)
                                                               T
                                                                  t=1

are the sample moment conditions associated with the N JT                            1 -vector of population unconditional
moment conditions:

              E f i (zt+1 ;          o;   o ; go )p0j (wt )g   = 0;              i = 1; :::; N;    j = 1; :::; JT :           (17)

Thus the GMM criterion is
                                                  h           i0 h          i
                                          QT ( ) = gT ( ; yT ) W gT ( ; yT ) ;                                                (18)

                             1
where W = IN      (P0 P)         .
   It is important to note that the SMD estimation (13) collapses to a case of GMM only when
                                                                       1
the speci…c weighting matrix W = IN                       (P0 P)           is employed. This procedure is equivalent to
regressing each   i   on the set of instruments                pJ T   ( ) and taking the …tted values from this regression
as an estimate of the conditional mean, where the weighting matrix in (18) gives greater weight
to moments that are more highly correlated with the instruments pJT ( ). In this speci…c case,
the GMM implementation preserves the desirable properties of the SMD estimator, which include
parameter consistency, reasonable rates of convergence, and asymptotic normality of the …nite
dimensional parameters. We cannot, however, presume that these properties would be preserved in
GMM estimation using an arbitrary weighting matrix W. The weighting scheme can be understood
intuitively by noting that variation in the conditional mean is what identi…es the unknown function.


4.3   Implementation

Before we can estimate the model, several implementation issues must be addressed. First, it is clear
that identi…cation of the unknown habit function using (4) requires ruling out the case Xt = KCt ,
where K 2 [0; 1) is a constant. This is not a problem since any model of habit formation naturally
depends on past consumption. Second, estimation of Xt = f (Ct ; Ct                             1 ; :::; Ct L )   nonparametrically



                                                                      11
is not practical if L is too large, generating a “curse of dimensionality.”6 Thus, we have to assume
L is a reasonable …nite number relative to the sample size. Such lag limitations are less restrictive
than they might at …rst appear, since standard theoretical treatments of habit formation imply
that more recent values of consumption have the greatest in‡uence on the habit stock. Thus, the
estimation procedure we propose may still do a good job of characterizing how the habit changes
with consumption, by estimating the habit stock as a function the current and most recent lags of
consumption.
                                                                                                        Ct 1      Ct L
       Third, we need a sequence of sieves gKT to approximate the unknown function g                     Ct ; :::; Ct    :
We do so using an arti…cial neural network (ANN) sieve approximation, de…ned as
                                                         KT
                                                         X
                        Ct 1        Ct L                                  Ct 1               Ct L
                 gKT         ; :::;         =    0   +         j    j;1        +   +   j;L        +    j   ;        (19)
                         Ct          Ct                                    Ct                 Ct
                                                         j=1

where        ( ) an activation function, which can be any known function except a polynomial function
of …xed …nite degree (see Hornik, Stinchcombe, and White (1989)). A common choice for                             is the
logistic function,        (x) = (1 + e     x) 1,     a speci…cation we use here. To provide a nonparametric
estimate of the true unknown function, go ( ), where “( )” denotes its generic argument, it is nec-
essary to require KT to grow with the sample size to ensure consistency of the method.7 We use
the ANN sieve for several reasons: (i) it allows the use of more lags in the unknown function g
by delivering a relatively fast convergence rate when compared to other sieves (e.g., linear tensor
product Fourier sieves or spline sieves) (Chen and White (1999)); (ii) the use of a nonlinear sieve
such as (19) is often in practice better able than alternatives to allow for nonlinearities in the un-
known function and nonseparabilities between elements of g; (iii) as long as consumption is strictly
positive, the ANN sieve makes it possible to restrict coe¢ cients in (19) so that the habit Xt <
Ct , for all possible shocks to consumption, not just those observed in our sample. Imposing this
restriction is straightforward because the logistic function                  (x) = (1 + e    x) 1    lies between zero
and one, regardless of the values taken by its arguments. This insures that utility is always well de-
…ned, and avoids the danger that the model will break down out-of-sample. In previously speci…ed
habit-based asset pricing models, imposing this restriction is more di¢ cult even when the habit is
speci…ed parametrically (for example, as a linear or polynomial function of past consumption.)
       Forth, as with any nonlinear estimation procedure, it is necessary to require the parameter space
   6
       A curse of dimensionality in this context refers to the situation in which, …xing the smoothness of the function f
to be estimated, the rate of convergence of a nonparametric estimate approaches zero as the dimension of the domain
of the function f approaches in…nity.
    7
      Hornik, Stinchcombe, and White (1989) show that any continuous function can be arbitrarily well approximated
asymptotically using a neural network sieve. Chen and White (1999) provide convergence rates for a large class of
single hidden layer feedforward arti…cial neural networks. Bansal and Viswanathan (1993) use a neural network to
approximate the SDF of an nonlinear arbitrage pricing model. See Campbell, Lo, and MacKinlay (1997) for additional
neural network sieve applications in …nance.


                                                               12
to lie in a compact set. In practice, researchers use prior information to restrict the parameter
space. Restriction of the parameter space is particularly important for our application, since sieve
parameters which generate values for the ANN sieve logistic activation function              (x) = (1 + e   x) 1

that lie in the tails of the function imply that the habit g is constant. Thus, we restrict the sieve
parameters to a range that does not generate tail observations on                 ( ). We also restrict the rate
of time-preference,              2 (0; 1:2], and the curvature parameter   2 [:1; 100].
     A …nal implementation issue concerns the sampling interval of our data relative to the decision
interval of households. If consumption decisions occur more frequently than the data sampling
interval, aggregate consumption data are time-aggregated. Heaton (1993) studies the interaction
of time-aggregation and time-nonseparable preferences and concludes that it can in‡uence the
evidence in favor of habit formation, at least when habits are of the linear variety. Unfortunately,
as Ferson and Constantinides (1991) and Heaton (1995) point out, it is not possible to model time-
aggregation in a fully nonlinear framework using minimum distance estimation, which our procedure
requires. To the extent that time-aggregation is a concern, this must be considered a limitation
of our approach. Nevertheless, there are at least two reasons to think that time-aggregation may
not unduly a¤ect inference. First, Ferson and Constantinides (1991) note that estimates of the
nonseparability parameter in Heaton (1993)— which uses a …rst-order linear approximation of the
Euler equation but allows for time-aggregation— are similar to their own estimates generated from
nonlinear GMM in which no time-aggregation is modeled. Second, Ferson and Constantinides also
note that the e¤ect of time-aggregation is to increase the order of the moving average process
followed by the GMM error, which is straightforward to address using a nonparametric correction
to the standard errors for serial correlation. Of course, the in‡uence of time-aggregation may be
more complex for nonlinear speci…cations and moreover with nonlinearities it is not clear in which
direction time aggregation would in‡uence the evidence on habit formation. We follow Ferson and
Constantinides (1991) and at least partly account for these e¤ects when computing the asymptotic
standard errors for              and , by using a higher order nonparametric correction for serial correlation
in   i (zt+1 ; o ;   o ; go ).



5     The Data
A detailed description of the data and our sources is provided in the Appendix. Our data are
quarterly, and span the period from the fourth quarter of 1952 to the fourth quarter of 2001.
     The focus of this paper is on testing and modeling cross-sections of asset returns, rather than
one or two aggregate asset returns. As explained in the Appendix, exploiting the cross-section
aids the empirical identi…cation of the unknown habit function. We study three cross-sections of
asset returns. All stock return data are taken from Kenneth French’s Dartmouth web page (URL



                                                           13
provided in the appendix), created from stocks traded on the NYSE, AMEX and NASDAQ. The
…rst group (Group 1) contains the three-month Treasury bill rate, 10 industry portfolios of common
stocks based on 4-digit SIC codes, and six value-weighted portfolios of common stock sorted into two
size (market equity) quantiles and three book value-market value quantiles. Thus Group 1 consists
of 17 asset returns in total. The portfolios are created from all stocks traded on the NYSE, AMEX,
and NASDAQ, as detailed on Kenneth French’s web page. The second group of asset returns
(Group 2), is comprised of the three-month Treasury bill rate and the six value-weighted portfolios
of common stock sorted into two size quantiles and three book value-market value quantiles, for a
total of 7 asset returns. The third group (Group 3) is comprised of the three-month Treasury bill
rate plus 25 value-weighted returns for the intersections of 5 market equity quantiles and 5 book
equity-market equity quantiles, or 26 asset returns in total (Group 3).
       Our measure of consumption is real, per-capita expenditures on nondurables and services. Since
consumption is real, our estimation uses real asset returns, which are the nominal returns described
above de‡ated by the implicit chain-type price de‡ator (1996=100) for our measure of consumption.
We use quarterly consumption data because it is known to contain less measurement error than
monthly consumption data.
       The procedure requires computation of instruments, pJT (wt ), which are known basis func-
tions (including a constant function) of conditioning variables, wt . We include lagged consumption
growth in wt , as well as three variables that have been shown elsewhere to have signi…cant forecast-
ing power for excess stock returns and consumption growth in quarterly data.8 Two variables that
have been found to display forecasting power for excess stock returns at a quarterly frequency are the
“relative T-bill rate” (which we measure as the three month Treasury-bill rate minus its 4-quarter
moving average), and the lagged value of the excess return on the Standard & Poor 500 stock mar-
ket index (S&P 500) over the three-month Treasury bill rate (see Campbell (1991), Hodrick (1992),
Lettau and Ludvigson (2001a)). We denote the relative bill rate RREL and the excess return on
the S&P 500 index, SP EX.9 We also use the proxy for the log consumption-wealth ratio studied in
(Lettau and Ludvigson (2001a)) to forecast returns.10 This proxy is measured as the cointegrating
   8
       The importance of instrument relevance in a GMM setting (i.e., using instruments that are su¢ ciently correlated
with the included endogenous variables) is now well understood. See Stock, Wright, and Yogo (2002) for a survey of
this issue. No formal test of instrument relevance has been developed for estimation involving an unknown function.
Thus we we choose variables for wt that are known to be strong predictors of asset returns and consumption growth
in quarterly data.
   9
     We focus on these variables rather than some others because, in samples that include recent data, they drive
out many of the other popular forecasting variables for stock returns, such as an aggregate dividend-price ratio,
earnings-price ratio, term spreads and default spreads (Lettau and Ludvigson (2001a)).
  10
     This variable has strong forecasting power for stock returns over horizons ranging from one quarter to several
years. Lettau and Ludvigson (2001b) report that this variable also forecasts returns on portfolios sorted by size and
book-market ratios.



                                                           14
                                                                                         ay t .11
residual between log consumption, log asset wealth, and log labor income and is denoted cd
Lettau and Ludvigson (2004) …nd that quarterly consumption growth is predictable by one lag of
wealth growth, a variable that is highly correlated with SP EX, and results (not reported) con…rm
                                                                   h                                i0
that it is also predictable by one lag of SP EX. Thus, we use wt = cday t ; RRELt ; SP EXt ; CCt t 1 :
We note that consumption growth–often thought to be nearly unforecastable–displays a fair amount
of short-horizon predictability in the sample used here: a linear regression of consumption growth
on the one-period lagged value wt and a constant produces an F statistic for the regression in
excess of 12.12
         Since the error term      i (zt+1 ; o ; o ; go ) is orthogonal to the information set wt , any measurable
transformation of                J
                           wt , p T (wt ), can be used as valid instruments. We use power series as instru-
ments, investigating three di¤erent speci…cations. Each speci…cation includes a constant (vector of
ones). The …rst speci…cation includes a constant, the linear terms plus the squared terms of each
variable in wt , creating nine instruments; we use these basis functions when studying the asset
returns in Group 1. The second set of instruments includes a constant, the linear terms, squared
terms and pair-wise cross products of each variable in wt , or 15 instruments in total; we use these
when studying the asset returns in Group 2. The third set of instruments utilizes just a constant
and the linear terms of each variable, or …ve instruments in total; we use these when studying the
asset returns in Group 3. This insures that the total number of moment conditions is about the
same across estimations.13


6         Empirical Estimates
All the tables and …gures are reported at the end of the Appendix. Table 1 and Figures 1-8 present
the estimation results of the semiparametric habit model presented above, using the instruments
and the three groups of assets described in the previous section.14 The results reported below were
very similar with L = 4 and L = 3: Thus, we opt for the more parsimonious speci…cation, and in
    11
         See Lettau and Ludvigson (2001a) and Lettau and Ludvigson (2004) for further discussion of this variable and its
relation to the log consumption-wealth ratio. Note that standard errors do not need to be corrected for pre-estimation
of the cointegrating parameters in cd
                                    ay t , since cointegrating coe¢ cients are “superconsistent,” converging at a rate
faster than the square root of the sample size.
  12
     As recommended by Cochrane (2001), the conditioning variables in wt are normalized by standardizing and
adding one to each variable, so that they have roughly the same units as unscaled returns.
  13
     The number of total moment conditions is not uniquely determined by the estimation theory. The theory merely
requires that there be more moment conditions than parameters to be estimated, N JT                         dim ( ), and that the
number of moments, N JT , increase with the sample size T , but at a slower rate than the sample size, so that
N JT =T ! 0 and N JT ! 1 as T ! 1.
                                                     h                                  i
    14
         The results reported here are based on wt0 = cd
                                                       ay t ; RRELt ; SP EXt ;    Ct
                                                                                 Ct 1
                                                                                            . Nevertheless, all the empirical results
remain virtually unchanged when we use [d
                                        cay t ; RRELt ; SP EXt ] as wt . We have also tried wt , lagged wt and lagged
returns as instruments, again the empirical results change little with the additional lagged wt and lagged returns.


                                                              15
all cases reported below set L = 3.15 We emphasize that our use of three lags is a generalization of
what has been done previously in the estimation of time-nonseparable asset pricing models, most of
which have focused on speci…cations with L = 1 (e.g., Ferson and Constantinides (1991), Chapman
(1997)) and/or L = 2 (e.g., Gallant and Tauchen (1989)).16
                                                                                                    PKT            L
       For the dimensionality of the ANN sieve, g(x1 ; :::; xL )                            0   +    j=1   j   (   l=1 j;l xl   +    j ),   we
set KT = 3. Because asymptotic theory only provides guidance about the rate at which (L + 2)KT
must increase with the sample size T , other considerations must be used to judge how best to set
this dimensionality. The bigger is (L + 2)KT , the greater is the number of parameters that must
be estimated, therefore the dimensionality of the sieve is naturally limited by the size of our data
set. With KT = 3, the dimension of the parameter vector,                                     = ( ; ; g)0 , is 18, estimated using
a sample of size T = 200. In practice, we obtained very similar results setting KT = 4; thus we
present the results for the more parsimonious speci…cation using KT = 3 below.
       Table 1 displays estimates of the …nite dimensional parameters, for three estimations. The the
estimates of and          are very similar across these three estimations. In each case, the subjective rate
of time-preference is about 0:99, and the curvature parameter is between                                       = 0:76 and           = 0:81:
The standard errors indicate that these variables are estimated precisely, but the estimates for
are e¤ectively estimates of unity, since the minimized value of the SMD criterion is very similar
when        is restricted to one. Boldrin, Christiano, and Fisher (2001) …nd that a business cycle model
with linear habit formation and                      = 1 performs well in matching the mean equity premium and
Sharpe ratio.
       To get a sense of how important the habit is in the power utility speci…cation, the top and bottom
panels of Figure 1 plot the habit-consumption ratio and an estimate of the stochastic discount factor,
respectively, over time, for the estimation on Group 1 assets, where the instruments are a constant,
the linear and squared values of the elements of wt . The corresponding …gures for the estimations
on Group 2 and Group 3 assets are very similar and are therefore omitted to conserve space.
The …gure demonstrates signi…cant evidence in favor of habit formation, conditional on the power
utility framework. The habit is about 97 percent of current consumption on average, reminiscent
  15
       Notice that, because of the forward-looking terms in (11),           i (zt ;   o)   is not in the information set at time t. In
particular, E [ i (zt+s+1 ;   o )j i (zt ;   o )]   6= 0 for s   L: Taken literally, therefore, the choice of L = 3 implies that
the error term, f i (zt+1 ;    o )g ;   is correlated with its three-period lagged value. If this were known to be the true
lag structure of the error term, e¢ ciency gains could be made by imposing this structure in estimation. The choice
of lag length here, however, is largely dictated by our sample size. With no clear theoretical guidance on the value
for L, possible e¢ ciency gains are likely to be outweighed by the greater robustness a¤orded by foregoing e¢ cient
estimation in favor of consistent estimation. For this reason, we do not impose a third-order moving average (or
other) structure on the error term, and instead simply apply a nonparameteric adjustment for higher-order serial
correlation to the asymptotic standard errors of the …nite dimensional parameters.
  16
     Using stationary monthly data on consumption growth and two return series, Gallant and Tauchen (1989) ex-
perimented with 1 and 2 lags and found the appropriate lag length is 1 for their subutility approximation.



                                                                    16
of the Campbell and Cochrane (1999) model, in which the steady state habit-consumption ratio
is in excess of 94%. Since the procedure is free to estimate a zero habit, this evidence implies
that habit formation signi…cantly improves the model’s ability to …t the data, and rejects the
notion that preferences are well described as time-separable in the power utility framework. The
habit-consumption ratio is stable, ranging only from 0.97 to 0.974.
       The estimate of Mt is always positive, thus it is an arbitrage-free stochastic discount factor
suitable for pricing derivative claims, as discussed in Hansen and Jagannathan (1997) and Wang
and Zhang (2003).17 The relative stability of the habit-consumption ratio translates into a relatively
stable stochastic discount factor: the mean is slightly less than one (0.98), while the standard
deviation is about 0.02. Although the standard deviation is not large, it is nonetheless signi…cantly
larger than the standard deviation of quarterly consumption growth, equal to 0.0045 in this sample.
Still, it is evident that these speci…cations do not …t the unconditional volatility bounds for the
stochastic discount factor implied by the work of Hansen and Jagannathan (1991) when matched to
post-war data on aggregate stock returns. These bounds determine whether the model can match
the mean equity premium and Sharpe ratio. This …nding is not surprising, since the methodology
used here must place very high weight on conditional moments (and therefore relatively little weight
on unconditional moments) in order to nonparametrically estimate the unknown habit function with
accuracy.18
                                                                                                                  @Xt+i
       We can check whether our estimates of the habit imply that the partial …rst derivatives,                    @Ct ;
i = 1; 2; 3 are greater than zero, and decreasing in i. Such a structure is typical of linear habit models
speci…ed as a declining polynomial lag of past consumption. Of course, with a nonlinear habit, these
partial derivatives are not constant, but vary over time given our estimated X function. Figure 2
plots the derivatives over time as a function of lagged consumption growth, again for the model
estimated on Group 1 assets with a constant, the linear and squared terms of wt as instruments.
In each case, the partial derivative is positive everywhere; moreover, the partial derivative of the
habit one-step ahead is everywhere greater than that two-steps, which in turn is everywhere greater
than that three steps ahead. The estimated habit depends positively on lagged consumption, but
this positive dependence decreases as the consumption becomes more distant.
       The shape of our estimated habit function can be illustrated by plotting Xt as a function of
lagged consumption, Ct             1;   holding …xed current consumption, Ct , and the other lags of consump-
tion, Ct     2 ; :::; Ct L .   Figures 3 through 5 plot this relation for each estimation described above. For
these plots, one-period lagged consumption is allowed to vary, but Ct ; Ct                2 ; :::; Ct L   are alternately
  17
       A related point is made by Chapman (1998) who notes that requiring M Ut itself to be positive places restrictions
on habit models. The …tted marginal utility values are never negative in the sample of data used here.
  18
     The …nding is also similar to those in Ferson and Constantinides (1991), who concluded that habit persistence
improves the …t of the standard consumption-based model largely through its in‡uence on moments other than the
mean equity premium and Sharpe ratio.



                                                            17
held …xed at their median, 25th, and 75th percentile values in our sample.
   We can draw several conclusions from Figures 3-5. First, the estimated habit looks nonlinear;
this is evident from the curved shape of the functions and from the …nding that the shape depends
on where in the domain space the function is evaluated. Second, the estimated habit is always
increasing in past consumption. This suggests that the time-nonseparability in utility that we
estimate is better interpreted as habit formation than durability in consumption, consistent with
previous studies that use consumption growth measured over longer horizons (Gallant and Tauchen
(1989), Ferson and Constantinides (1991), Heaton (1995)). Third, the estimated habit is increasing
at a decreasing rate in past consumption. The next section presents a formal test of the linearity
of the habit.


6.1   Is Habit Function Linear?

Figures 3 to 5 indicate that the estimated habit function looks nonlinear. In this section, we test for
nonlinearity more formally. Whether habits are linear is an interesting empirical question because
the functional form of the habit is often crucial in determining the asset pricing implications of
the model. To address this question, we make use of the partial derivatives of our estimated habit
                                           @Xt+i
function. Notice that linearity implies     @Ct    is constant for all i       0, and in particular

                     @ 2 Xt+i         @2       Ct+i 1        Ct+i L
                              = Ct+i      g           ; :::;               0       8i   1:                 (20)
                       @Ct2          @Ct2       Ct+i          Ct+i

Figures 7-9 plot the values of (20) based on our estimates for the cases above for i = 1. Notice
                                                                  Ct+i 1      Ct+i L
from (8) that @ 2 Xt+i =@Ct2 will take the form (1=Ct+i ) gii      Ct+i ; :::; Ct+i     , where gii denotes the
second partial derivative of g with respect to its i th argument. Obviously (1=Ct+i ) gii cannot be
                              Ct+i 1      Ct+i L
identically zero unless gii    Ct+i ; :::; Ct+i     is a zero function, since consumption is everywhere
positive and …nite. Therefore, in order to rid (1=Ct+i ) gii of its dependence on the arbitrary units
of Ct , we plot the “normalized” second derivative of Xt+i , which consists only of the term gii . To
                                                    Ct        Ct+1 L
conserve space, we plot only the values g11        Ct+1 ; :::; Ct+1    corresponding to @ 2 Xt+1 =@Ct2 .
   Figure 6 plots the time series of g11 for the model estimated on Group 1 assets with a constant,
the linear and squared terms of wt as instruments; Figure 7 plots the same for the model estimated
on Group 2 assets and a constant, the linear, squared and cross terms of wt as instruments; Figure
8 plots the same for the model estimated on Group 3 assets with a constant, the linear terms of
wt as instruments. In each …gure, the second partial derivatives are everywhere negative; taken
together with the estimates of the …rst partial derivatives (e.g., Figure 2), this implies that the
habit is increasing in lagged consumption, but at a decreasing rate. Moreover, all three …gures
indicate that the second derivative of Xt is nonzero.
   We could construct a consistent test of whether the second derivatives of the habit are identically
zero functions. However, for simplicity, we provide a test based on smooth functionals of unknown

                                                      18
functions, as discussed in Chen and Shen (1998). Such smooth functionals converge at the standard
                  p
parametric rate, T , and have standard asymptotic distributions.
       One such smooth functional is the unconditional mean of the second derivative
                                                                   @ 2 Xt+i
                                                               E            :                                         (21)
                                                                     @Ct2
Clearly if (20) is everywhere identically equal to zero, its mean (21) must be zero, although the
converse need not hold. Nevertheless, if we …nd that the mean (21) is statistically di¤erent from
zero, we may conclude that (20) is not true, and the habit function is nonlinear. We present
the results of such a test now, focusing, as discussed above, on the normalized second derivative
                                                                Ct        Ct+1 L
corresponding to @ 2 Xt+1 =@Ct2 , which is g11                 Ct+1 ; :::; Ct+1    .
       Let
                                                                Ct         Ct+1 L
                                                 g   E g11          ; :::;              ;
                                                               Ct+1         Ct+1
and let gb() denote the SMD estimate of g() and gb11 () be the second partial derivative of gb() with
respect to its …rst argument. Then                   g   can be estimated by
                                                   T
                                                 1X                 Ct         Ct+1 L
                                            bg =     gb11               ; :::;              :
                                                 T                 Ct+1         Ct+1
                                                         t=L

By extending the theoretical result of Ai and Chen (2005) for I.I.D. data to stationary beta-mixing
                                                         p
data, under some regularity conditions, we obtain that T (bg          g ) is asymptotically normally
distributed with mean zero and variance 211 > 0. Let b211 be some consistent estimator of 211 . We
         p
may use T bg =b11 as a test statistic, which has a standard normal limiting distribution under the
null hypothesis         g   = 0.19
       The mean of the second derivative is estimated very precisely with tight con…dence intervals,
indicating strong rejections of              g   = 0. For the estimation on Group 1 assets with a constant, and
the linear and squared terms of wt as instruments, the estimated 95 percent con…dence region for
 g    is [ 0:052151; 0:051435]. Since the estimated habit function is very similar across estimations,
the con…dence intervals for estimation on Group 2 assets using a constant, the linear, squared and
cross-term of wt as instruments, and on Group 3 assets with a constant and the linear terms of wt
as instruments, are almost identical to that reported above. In every case, zero is well outside the
95% con…dence region. Thus, we reject the hypothesis that                          g    E[g11 ] is zero, implying that (20)
is not true and the habit function estimated is nonlinear.
  19
       The asymptotic variance       2
                                     11   takes a complicated form and the calculation of any consistent estimator b211 is
complicated. For this reason, we use a bootstrap procedure to directly compute an empirical, 95% con…dence region
for    g.   The bootstrap sample is obtained by sampling blocks of the raw data randomly with replacement and laying
them end-to-end in the order sampled. To choose the block length, we follow the recommendation of Hall, Horowitz,
and Jing (1995) who show that the asymptotically optimal block length for estimating a symmetrical distribution
function is l _ T 1=5 ; also see Horowitz (2003).We then conduct SM D estimation on 500 bootstrap samples so formed,
which delivers 500 estimates of       g.



                                                                   19
7     Speci…cation and Model Comparison

7.1     Is Habit Formation Internal or External?

An interesting hypothesis concerns the distinction between “internal” and “external” habit for-
mation. Much of our intuition about this distinction is based on simple linear models of habit
formation. For example, Cochrane (2001) (Chapter 21, page 484) considers an example in which
the habit is a distributed lag of past consumption. Under the additional assumptions of an I.I.D.
endowment sequence and a constant risk-free rate Rf equal the inverse of the subjective rate of
time preference, Cochrane (2001) shows that the asset pricing implications of internal and external
habits are equivalent.
    This equivalency breaks down if habits are nonlinear in past consumption or if the risk-free
                                                                                       @Xt+j
rate is not constant. With nonlinear habits, the partial derivatives                    @Ct    in (3) vary with lagged
consumption, implying that marginal utility under internal habit formation will not be proportional
to that under external habit formation. The asset pricing implications of internal and external habit
speci…cations will in general di¤er.
    One way to assess which speci…cation better describes the data is simply to compare the value
of the minimized SMD criterion function when habit formation is restricted to be external (i.e.,
imposing the restriction that M Ut = (Ct            Xt )     ) with that of the internal habit cases estimated
above. Doing so for each estimation described above, we …nd that the minimized SMD criterion is
several orders of magnitude larger under external habit formation. For example, for estimation on
Group 3 asset returns (using a constant and the linear terms of wt as instruments), we …nd that the
external habit model produces a minimized criterion equal to 1.2177e-04, compared to 1.3424e-07
for the internal habit case, or about 1000 times larger. The estimations using Group 1 and Group
2 assets produced similar results.
    Such …ndings do not provide a statistical comparison of external and internal habit. Thus, we
pursue an alternative way to address the issue by directly testing the Euler equation restrictions
corresponding to the external habit formation:
                                                                      !
                                    ex
                             Ct+1 Xt+1
                   E               ex             Ri;t+1     1 j wt       = 0;          i = 1; :::; N:             (22)
                              Ct Xt
In the appendix we show that the conditional moment restrictions for the internal habit asset
pricing model can be written as:
                                                                          !
                           Ct+1      in
                                  Xt+1
               E                            Ri;t+1 Fei;t+1      1 j wt        = 0;          i = 1; :::; N;         (23)
                            Ct    Xtin
where
               L
                                              !                L
                                                                                                   !
               X           Ct+1+j     in
                                     Xt+1+j             in
                                                     @Xt+1+j   X                     Ct+j    in
                                                                                            Xt+j            in
                                                                                                         @Xt+j  1
 Fei;t+1   1           j
                                      in
                                                             +                j 1
                                                                                             in
                                                                                                                     :
                             Ct+1    Xt+1             @Ct+1                          Ct+1   Xt+1          @Ct Ri;t+1
               j=0                                                    j=0


                                                           20
         We assume that the internal and external habit functions are both homogeneous of degree
one functions of current and lagged consumptions with the same …nite lag length L. Under this
assumption, the two habit functions may be distinguished. To see this, write the habit function
                                         Ct 1      Ct L
generically as Xt = Ct g                  Ct ; :::; Ct    : The external and the internal habit conditional moment
restrictions are then nested into
                                                                                               !
                              Ct+1     Xt+1
                   E                              Ri;t+1 Fei;t+1 ( ; ; ; g)        1 j wt          = 0;       i = 1; :::; N;       (24)
                                Ct     Xt

with

               Fei;t+1 ( ; ; ; g)                                                                                                  (25)
                        L
                        X                                                        L
                                                                                 X
                               j     Ct+1+j   Xt+1+j         @Xt+1+j                     j 1       Ct+j   Xt+j      @Xt+j 1
               1                                                     +                                                          .
                                       Ct+1   Xt+1            @Ct+1                                Ct+1   Xt+1       @Ct Ri;t+1
                        j=0                                                      j=0

The external habit corresponds to (24) with                         = 0; the internal habit corresponds to (24) with
     = 1.
         We estimate all the unknown parameters ( ; ; ; g( )) corresponding to the generalized condi-
tional moment restrictions (24) by the SMD method employed before, using the same ANN sieve
(19) to approximate the unknown g( ), the same three asset groups with the associated sets of
instruments. The estimation procedure is therefore free to choose one set of parameter values
    ex        ex ; g ex (
(        ;                  )) satisfying the external habit conditional moment restrictions (22) with                         = 0, just
                                                                        in       in ; g in (
as it is to choose another set of parameter values (                         ;                 )) satisfying the internal habit con-
ditional moment restrictions (23) with                      = 1. It follows that a test of the hypothesis that                      =0
or           = 1 provides a test of the hypothesis of external versus internal habit. As before, the SMD
estimates of ( ; ; ; g( )) converge in probability to their true values and the SMD estimates of
…nite-dimensional parameters ; ;                     are root-T consistent and asymptotically normally distributed.
Let b2 be a consistent estimator of the asymptotic variance of the SMD estimate of . Using the
           p
result that T ( b    )=b is asymptotically standard normal, we can then apply a sequential Wald
test of the null hypothesis of                 = 0 for external habit; and the null hypothesis of                  = 1 for internal
habit.
         For all the three asset groups and the corresponding instruments, the SMD estimates of ,
and their standard errors are quite similar to those in Table 1;20 the estimates of                                 are found to be
extremely close to unity, ranging between 1.0272 (for Group 1), 1.0876 (for Group 2) and 1.0275
(for Group 3), with small standard errors. In all cases, the hypothesis of                                     = 0 (external habit
formation) is strongly rejected. For example, using the estimation result for Group 2 assets with
the constant, the linear, squared and cross terms of wt as instruments, b = 1:0876 and b = 0:057,
    20
         For example, for Group 2 assets with the constant, the linear, squared and cross terms of wt as instruments, the
estimates of ;              are 0.9805 and 0.7991 with standard errors 0.018 and 0.014 respectively.


                                                                   21
we can easily reject the null hypothesis of     = 0 but fail to reject the null hypothesis of           = 1.
Thus we …nd that the stochastic discount factor is much better approximated by internal habit
formation than external habit formation.


7.2   Model Comparison

How well habit-based models explain asset pricing data relative to other models that have been
explored in the literature? We use the methodology provided by Hansen and Jagannathan (1997),
who develop a way to compare asset pricing models when all Stochastic Discount Factor (SDF)
models are treated as misspeci…ed proxies for the true unknown SDF, and the relevant question is
which model contains the least speci…cation error.
   Hansen and Jagannathan suggest that we compare the pricing errors of various candidate
SDF models by choosing each model’s parameters, , to minimize the quadratic form gTHJ ( )
wT0 ( ) GT 1 wT ( ), where wT ( ) = (w1T ( ); :::; wN T ( ))0 is the vector of the sample average of
                                  P
pricing errors (i.e., wiT ( ) = T1 Tt=1 Mt ( )Ri;t 1 for i = 1; :::; N ), and GT is the sample second
moment matrix of the N asset returns upon which the models are evaluated (i.e., the (i; j)-the
                    P
element of GT is T1 Tt=1 Ri;t Rj;t for i; j = 1; :::; N ). The measure of model misspeci…cation is then
                                                              q
the square root of this minimized quadratic form, dT            gTHJ (b), which gives the maximum pric-
ing error per unit norm on any portfolio of the N assets studied, and delivers a metric suitable
                                                                                         q       for
model comparison. We refer to the square root of this minimized quadratic form, dT          gT (b),
                                                                                             HJ

as the Hansen-Jagannathan distance, or HJ distance for short.
   An important advantage of this procedure is that the second moment matrix of returns delivers
an objective function that is invariant to the initial choice of asset returns. The identity and other
…xed weighting matrices do not share this property. Kandel and Stambaugh (1995) have suggested
that asset pricing tests using these other …xed weighting matrices can be highly sensitive to the
choice of test assets. Using the second moment matrix helps to avert this problem.
   We compare the speci…cation errors of the habit-based model to several alternative asset pricing
models that have been studied in the literature. First, we compare the SMD-estimated habit model
to two empirical asset pricing models that have displayed relative success in explaining the cross-
section of stock market portfolio returns: the three-factor, portfolio-based asset pricing model of
Fama and French (1993), and the approximately linear, conditional, or “scaled”consumption-based
capital asset pricing model explored in Lettau and Ludvigson (2001b). These models are both linear
stochastic discount factor models taking the form
                                                     k
                                                     X
                                      Mt+1 =    0+         i Fi;t+1 ;                                   (26)
                                                     i=1

where Fi;t+1 are variable factors, and the coe¢ cients     0   and   i   are treated as free parameters to be
estimated. Fama and French develop an empirical three-factor model (k = 3), with variable factors

                                                  22
related to …rm size (market capitalization), book equity-to-market equity, and the aggregate stock
market. These factors are the “small-minus-big”(SM Bt+1 ) portfolio return, the “high-minus-low”
(HM Lt+1 ) portfolio return, and the market return, Rm;t+1 , respectively.21 The Fama-French model
has displayed unusual success in explaining the cross section of mean equity returns (Fama and
French (1993), Fama and French (1996)). The model explored by Lettau and Ludvigson (2001b)
can be interpreted as a “scaled” or conditional consumption CAPM (“scaled CCAPM” hereafter)
and also has three variable factors (k = 3), cd
                                              ay t ; cd
                                                      ay t               log Ct+1 , and     log Ct+1 : Lettau and
Ludvigson (2001b) show that such a model can be thought of as a linear approximation to any
consumption-based CAPM (CCAPM) in which risk-premia vary over time.
       We also compare speci…cation errors of these models to those of a linearized version of the
standard CCAPM (with consumption growth the single variable factor in (26), k = 1) (Breeden
(1979); Breeden and Litzenberger (1978)), and to those of the classic CAPM, where the market
return Rm is the single variable factor in (26), k = 1.
       For all the non-habit asset pricing models, all the unknown parameters                    = ( 0;                0
                                                                                                           1 ; :::; k )

are chosen to minimize the squared HJ distance, gTHJ ( ), for that model. Because the fully
parametric non-habit asset pricing models have fewer parameters than the nonparametric habit
models, when computing the HJ distance for the habit models we deliberately restrict the num-
ber of parameters that are chosen to minimize the HJ distance. In particular, we choose only
the …nite-dimensional parameters               = ( ; )0 of our habit-based models to minimize the HJ
distance–the parameters of the nonparametric habit function are restricted to be those that min-
imize the SMD criterion. The procedure is as follows. For any candidate                         = ( ; )0 value in
the habit-based asset pricing models, we …rst estimate the habit function by the SMD estima-
                             P
tor gb( ; ; ) = arg mingKT T1 Tt=1 m(w
                                   b t ; ; ; gKT )0 m(w
                                                    b t ; ; ; gKT ), where m(w
                                                                           b t ; ; ; gKT ) is given
in (14), using, say, Group 2 assets (six size and book-market returns plus the T-bill rate). We
then construct the SMD-estimated internal habit and external habit SDF proxies by replacing the
unknown habit function go ( ; ; ) with the SMD-estimated gb( ; ; ). Finally, given gb( ; ; ); we
choose the parameters           = ( ; )0 of the habit asset pricing models to minimize the corresponding
HJ distances. Note that this places the habit models at a disadvantage because the habit para-
meters are not chosen to minimize the HJ criterion, the measure of model misspeci…cation. By
contrast all of the comparison models’parameters are chosen to minimize the HJ criterion.22
  21
       SM B is the di¤erence between the returns on small and big stock portfolios with the same weight-average book-
to-market equity. HM L is the di¤erence between returns on high and low book-to-market equity portfolios with the
same weighted-average size. Further details on these variables can be found in Fama and French (1993). We follow
Fama and French and use the CRSP value-weighted return as a proxy for the market portfolio, Rm . The data are
taken from Kenneth French’s Dartmouth web page (see the Appendix).
  22
     Recall that the SMD minimization gives greater weight to moments that are more highly correlated with the
instruments pJT (wt ), while the HJ minimization matches unconditional moments.




                                                          23
   We evaluate the speci…cation errors of the competing asset pricing models using a time-series
on two alternative sets of quarterly asset returns: (i) the six equity returns on portfolios double-
sorted on size and book-to-market characteristics provided by Fama and French, (N = 6), and
(ii) these six equity portfolio returns plus the three-month Treasury bill rate, (N = 7). We use
equity returns on size and book-to-market sorted portfolios because Fama and French (1992) show
that these two characteristics provide a “simple and powerful characterization”of the cross-section
of average stock returns, and absorb the roles of leverage, earnings-to-price ratio and many other
factors governing average stock return di¤erentials.
   Before discussing how each model fares according to speci…cation error, we note that the esti-
mates of   generated from minimizing gTHJ ( ) for the general internal habit model are similar to
those estimated using the SMD procedure but generally smaller, equal to 0.70 when the model is
evaluated on the equity portfolios alone, and 0.73 when the Treasury bill is included. Estimates of
 in the external habit case are similar to the internal habit case, equal to 0:9 when the Treasury
bill is included and 0:6 when it is omitted. The estimates of the curvature parameter        , when
freely estimated to minimize the HJ distance, are substantially larger than those estimated using
the SMD procedure. For the internal habit case, they equal to 26 when the model is evaluated
on the equity portfolios alone, and 25 when the Treasury bill is included. For the external habit
model, the resulting estimates of the curvature parameter    are equal to 37 when the Treasury bill
is included, and 62 when it is excluded. The larger values for    are not surprising because the HJ
procedure places emphasis on unconditional mean returns whereas the SMD procedure emphasizes
conditional moments. Fitting unconditional moments requires a more volatile SDF (Hansen and
Jagannathan (1991)), which can be generated by a higher value for .
q Table 2 reports the measure of speci…cation error given by the HJ distance (“HJ Dist”), dT
 gTHJ (b), for all the models discussed above. Regardless of whether the Treasury bill rate is
included in the set of test assets, the smallest speci…cation error is generated by the SMD-estimated
internal habit model. The HJ distance for this model is equal to 0.18 on the set of stock returns
and Treasury bill, and 0.17 on the set of size and book-market sorted equity returns alone. These
numbers are substantially lower than those for all the other models; for example, when the T-
bill is included, the next lowest pricing error is given by the Fama-French model, equal to 0.28.
When the T-bill is excluded, the scaled CCAPM delivers the second lowest speci…cation error,
equal to 0.21, while the third lowest speci…cation error is generated by the Fama-French model and
the external habit model, which have almost identical values of the HJ distance, equal to 0.262
and 0.261, respectively. The scaled CCAPM performs much worse once the T-bill is included.
Finally, the classic CCAPM and CAPM have errors substantially larger than those of most other
models, regardless of the set of test assets upon which they are evaluated. The one exception is the
external habit model which performs worst of all models when the T-bill is included, generating


                                                 24
a speci…cation error of 0.43. These results are particularly encouraging for the internal habit
framework.
       Table 3 also reports an alternate distance metric, denoted “HJ+ Dist,” for all the models
discussed above. This metric restricts the set of admissible stochastic discount factors to be positive.
The SMD-estimated internal habit model continues to beat all the other models by a wide margin,
according to this metric. The only models for which HJ+ is substantially di¤erent from HJ, are
the scaled CCAPM and the classic CCAPM. The distance metric for the scaled CCAPM increases
by a factor of four in pricing the equity returns when the set of admissible stochastic discount
factors is restricted to be positive. Although this model does a relatively good job of assigning the
right prices to size and book-market sorted equity returns, its linearity implies that it can assign
negative prices to some positive derivative payo¤s on those assets. This is not altogether surprising,
since linear models–typically implemented as approximations of nonlinear models for use in speci…c
applications–are not designed to price derivative claims.


7.2.1       Statistical Comparison of Competing Models

Table 2 reports the point estimates of the HJ distances for the six competing asset pricing models
without taking into account the statistical uncertainty associated with those estimates. To our
knowledge, no broadly applicable procedure has been developed for comparing HJ distances sta-
tistically.23 Here we provide a new methodology for statistical model comparison of HJ distances
based on the “reality check” method of White (2000). Given that the HJ distance is found to be
smallest for the internal habit model, we make this our null hypothesis for model comparison.
       Let j = 1; 2; :::; 6 index the six asset pricing models reported in Table 2, with j = 1 being
the internal habit model. Let E[wTj ( j )] denote the vector of population average of pricing errors
associated with model j and the candidate parameter value                     j.   Let

                                gjHJ ( j )     E[wTj ( j )]0 fE[GT ]g    1
                                                                             E[wTj ( j )]

and      j     arg min gjHJ ( j ). Denote the population squared HJ distance associated with model j
d2j     gjHJ    j   . The null hypothesis is:

                                             H0 :    max fd21    d2j g       0;
                                                    j=2;:::;6

meaning that, among the six competing models, model 1 (the internal habit model) has the smallest
  23
       Wang and Zhang (2003) provide a way to compare HJ distance measures across models using Bayesian methods,
under the assumption that the data follow linear, Gaussian processes. Their procedure is not directly applicable here,
since our methodology requires no speci…cation of the law of motion and permits the data to be stationary ergodic,
allowing a wide variety of nonlinear time-series processes such as di¤usion models, stochastic volatility, nonlinear
ARCH, GARCH, Markov switching, and many more.



                                                           25
pricing error according to the squared HJ distance. The alternative hypothesis is:

                                                   H1 :         max fd21               d2j g > 0;
                                                              j=2;:::;6

meaning that there is at least one competing model has smaller pricing error in the squared HJ
distance than model 1 (the internal habit model).
    Let d2T;j   HJ (b ) denote the sample estimate of the squared HJ distance for model j. To
               gT;j  j

apply White’s reality check test, we employ the following test statistics, T W , based on (White
(2000)) and Hansen’s modi…ed reality check test statistic, T H , based on (Hansen (2003)):24
                                 p                                                                          p
            TW        max            T fd2T;1    d2T;j g and           TH              max      max             T fd2T;1   d2T;j g ; 0 :
                     j=2;:::;6                                                                 j=2;:::;6

Both tests have complicated null limiting distributions. Therefore, to implement the reality check
test, we follow the suggestion of White (2000), Hansen (2003) and Corradi and Swanson (2003)
and compute block bootstrap estimates of their …nite sample distributions. Let White’s original
bootstrap test statistic and Hansen’s modi…ed bootstrap test statistic be denoted T W;b and T H;b ,
respectively. By repeated sampling, we compute bootstrap estimates of the p                                                      values
                                         B                                                 B
                                       1 X                                               1 X
                          pbW              1fT W;b > T W g;                      pbH         1fT H;b > T H g;
                                       B                                                 B
                                          b=1                                                  b=1

where B is the number of bootstrap samples. To account for the …rst-stage estimation of the un-
known habit function, in each bootstrap sample the parameters of the habit function are reestimated
using the SMD procedure.
       Since this is a one-sided test, at a 5% level of signi…cance, the critical value is the value at the
95th percentile of the bootstrap test statistics. We do not reject the null if the historical value of
the tests statistic (T W or T H ) is not unusually high, i.e., is not greater than the value at the 95th
percentile. Therefore, the tests T W and T H reject the null hypothesis if pbW or pbH are close to zero,
and do not reject the null if pbW or pbH are close to one. At a 5% level of signi…cance, we reject the
null if pbW or pbH are less than 0:05, but do not reject otherwise. The results of these tests in our
data are as follows. For the six return case pbW = 0:9731 and pbH = 0:9275, while for the six return
plus T-bill case pbW = 0:9838 and pbH = 0:9358. Thus, both tests imply that model 1 (the internal
habit model) is the best according to the squared HJ distance measure.
  24
       Using results in Hansen, Heaton, and Luttmer (1995) and Ai and Chen (2005), it can be shown, under mild
regularity conditions,
                         p                                                                              0   D
                          T d2T;1        d2T;2   [d21   d22 ]; :::; d2T;1    d2T;6      [d21    d26 ]       ! (Z2 ; :::; Z6 )0

                                                        (Z2 ; :::; Z6 )0         N (0; ) ;

where      is a positive semi-de…nite matrix. This justi…es our applications of White’s reality check test (White (2000)),
T W , and Hansen’s modi…ed reality check test (Hansen (2003)), T H .


                                                                            26
7.2.2       Comparing Internal and External Habit Speci…cations

What explains the superior econometric performance of the internal habit model compared to the
external habit speci…cation? Certainly the SDFs of the two models behave di¤erently over time: the
internal habit model is more volatile and more autocorrelated (quarterly standard deviation equals
to 2.8% and …rst-order autocorrelation equals to 0.21), than the external habit model (quarterly
standard deviation equals to 1.05% and …rst-order autocorrelation equals to 0.04).25 But such
time-series properties are likely to be more important determinants of how well each speci…cation
rationalizes variation over time in returns rather than across assets.
       Here, models are evaluated on their ability to explain cross-sectional moment restrictions. These
moment restrictions imply that the unconditional mean excess return of any asset must be propor-
tional to the covariance of the SDF with that asset’s return.26 Thus the relative performance of the
two models can be intuitively understood by examining how the SDFs of each model covaries with
the set of test asset returns. Table 4 shows sample estimates of these covariances, for the SDFs
of the internal habit model and external habit model, with each of the six size and book-market
sorted portfolio returns we use as test assets. For reference, the top panel of Table 4 shows the
unconditional mean quarterly excess return on each portfolio over the three-month Treasury bill
rate.
       Notice that the average excess returns on these portfolios are large, ranging from 1.8 percent to
3.2 percent per quarter (top panel, Table 4). Explaining such a large mean excess returns requires
the covariance of the SDF with the asset’s return to be high. The bottom panel of Table 4 shows
that an important reason for the superior performance of the internal habit model is that the
absolute value of its covariance with each return is considerably larger (in many cases by an order
of magnitude) than that of the external model.27 The internal habit model also gets the cross-
sectional patterns right. For example, the largest cross-sectional spread in returns occurs between
the return on S1B3, the “value”portfolio in the smallest size category, and the return on S1B1, the
“growth”portfolio in the same size category. The former has an average excess return of 3.2%, the
latter just 1.8%. This di¤erence captures the well-known value-premium in these data, which is
especially pronounced for small capitalization …rms. The internal habit model covaries more with
S1B3 than it does with S1B1, thereby explaining the higher excess return on the former relative to
  25
       These numbers are for the SDFs estimated when computing the HJ distances with        and   are reestimated to
minimize gTHJ ( ).
 26
    Start with 1 = E [Mt Rj;t ] and rearrange to …nd

                                                                  Cov (Mt ; Rj;t )
                                        E (Rj;t )   1=E (Mt ) =                    :
                                                                    E (Mt )

  27
       We expect this covariance to be negative. Positive excess returns are associated with positive covariance with
consumption growth, and therefore a negative covariance with marginal utility growth.



                                                           27
the latter. This is not the case for the external habit model, where these two covariances are about
the same.
    From (23) and (22), it is clear that the key di¤erence between external and internal habit
formation is that the internal habit speci…cation contains forward looking terms in marginal utility
not present in the external habit speci…cation. Empirically, these forward-looking terms are modeled
as projections onto instruments that have predictive power for the endogenous variables in the
model. To evaluate the quantitative importance of these forward looking terms, we re-computed the
HJ distance for the internal model using instead the ex-post values of the future terms in (3), rather
than their ex-ante predicted values, as dictated by theory. In this case we …nd that the performance
of the internal habit model is much closer to that of the external habit model. Thus, a key feature
of the empirical success of the internal habit model compared to the external habit speci…cation
lies with the forward-looking nature of marginal utility. These …ndings may be related to recent
work by Parker and Julliard (2004), who …nd that the covariance of size and book-market sorted
asset returns with long-horizon consumption growth explains a large fraction of the cross-sectional
variation in average returns on these portfolios. They refer to this as “ultimate consumption risk.”
To the extent that such long-horizon measures of consumption growth are correlated with the
forward-looking terms in marginal utility arising from internal habit formation, the …ndings here
provide a structural interpretation of why ultimate consumption risk better explains the cross-
section of average returns than one-period consumption risk.


8    Conclusion
A large and growing body of theoretical work in …nancial economics derives its most salient asset
pricing implications from the presence of habit formation in investor preferences. The importance
of this work in recent literature calls out for formal empirical evaluation, but such an evaluation is
complicated by the lack of theoretical agreement over the functional form of the habit. In this article,
we empirically evaluate a general class of representative-agent habit-based asset pricing models.
Rather than restricting the functional form of the habit, we pursue a semiparametric approach,
treating the habit speci…cation as unknown and estimating it along with the …nite dimensional
parameters of the power utility function.
    This semiparametric approach allows us to empirically evaluate a number of hypotheses about
habit-based asset pricing models that have not been previously evaluated. First, our results suggest
that, conditional on the power utility framework, preferences are far from time separable: the
estimated habit is found to be a quantitatively important part of the power utility speci…cation
and is a large fraction of current consumption. Second, we …nd that the habit speci…cation is better
described as a nonlinear function of current and past consumption, rather than as a linear function.



                                                  28
Several authors have argued that nonlinearities in the habit function are crucial for allowing the
model to account for the joint behavior of aggregate consumption and asset returns (e.g., Campbell
and Cochrane (1999)). Third, when the habits are estimated as nonlinear functions of current and
lagged consumption with the same …nite lag length, we strongly reject the hypothesis that habits
are a pure externality governed by the consumption of everyone else in the economy; internal habit
models based on own-consumption better describe the asset pricing data studied here.
   Finally, we assess how well the habit-based paradigm explains asset pricing data compared to
other asset pricing models. We …nd that an estimated internal habit model explains a cross-section
of size and book-market sorted equity returns better than (i) the Fama and French (1993) three-
factor model, (ii) the scaled consumption CAPM explored by Lettau and Ludvigson (2001b), (iii)
a SMD-estimated external habit model, (iv) the classic CAPM, and (v) the classic consumption
CAPM. The internal habit model performs better on statistical grounds as well as economic grounds.
   In this paper we have restricted our analysis to habit speci…cations that depend on a …nite num-
ber of consumption lags. Ideally, one would like to allow for an in…nite number of lags by modeling
the habit as a recursive function of past habits, e.g., Xt = r (Ct ; Ct   1 ; Xt 1 ).   The econometric
di¢ culty with this type of model is that it involves an unknown recursive functional that has as
one of its arguments an unknown function, both of which must be estimated nonparametrically.
Any procedure that succeeds in identifying r separately from X is likely to be slow to converge. As
such, the econometric results required to execute such an estimation have yet to be developed. We
argue that the empirical work in this paper is a natural starting place for such an investigation,
since the estimation of Xt nonparametrically is likely to comprise one step in the larger recursive
procedure.




                                                29
9    Appendix
This appendices consist of several parts: Appendix 1 describes the data. Appendix 2 presents
alternative expressions of the conditional moment models, and also provides su¢ cient conditions
for identi…cation in the external habit case. Appendix 3 describes the general SMD procedure.
Appendix 4 presents large sample properties of the SMD estimator. Appendix 5 provide limiting
distributions of the test statistics for testing linear habit and testing internal vs external habit.


                                       1. Data Description

    The sources and description of each data series we use are listed below.

CONSUMPTION
Consumption is measured as expenditures on nondurables and services, excluding shoes and cloth-
ing. The quarterly data are seasonally adjusted at annual rates, in billions of chain- weighted 1996
dollars. The components are chain-weighted together, and this series is scaled up so that the sample
mean matches the sample mean of total personal consumption expenditures. Our source is the U.S.
Department of Commerce, Bureau of Economic Analysis.

POPULATION
A measure of population is created by dividing real total disposable income by real per capita
disposable income. Consumption, wealth, labor income, and dividends are in per capita terms.
Our source is the Bureau of Economic Analysis.

PRICE DEFLATOR
Real asset returns are de‡ated by the implicit chain-type price de‡ator (1996=100) given for the
consumption measure described above. Our source is the U.S. Department of Commerce, Bureau
of Economic Analysis.

ASSET RETURNS

      3-Month Treasury Bill Rate: secondary market, averages of business days, discount basis
      percent; Source: H.15 Release –Federal Reserve Board of Governors.

      25 size/book-market value weighted returns for NYSE, AMEX, NASDAQ; Returns were cre-
      ated using 200112 CRSP database. It contains value-weighted returns for the intersections
      of 5 market equity categories and 5 book equity-market equity categories. The portfolios are
      constructed at the end of June. Source: Kenneth French’s homepage,
      http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html.




                                                  30
     6 size/book-market returns: Six portfolios, monthly returns from July 1926-December 2001.
     The portfolios, which are constructed at the end of each June, are the intersections of 2 portfo-
     lios formed on size (market equity, ME) and 3 portfolios formed on the ratio of book equity to
     market equity (BE/ME). The size breakpoint for year t is the median NYSE market equity at
     the end of June of year t. BE/ME for June of year t is the book equity for the last …scal year
     end in t-1 divided by ME for December of t-1. The BE/ME breakpoints are the 30th and 70th
     NYSE percentiles. Source: Kenneth French’s homepage, http://mba.tuck.dartmouth.edu/
     pages/faculty/ken.french/data_library.html.

     10 Industry Portfolios: The process assigns each NYSE, AMEX, and NASDAQ stock to an
     industry portfolio at the end of June of year t based on its four-digit SIC code at that time.
     Return data was created by CMPT_IND_RETS using the 200112 CRSP database. Returns
     are computed from July of t to June of t+1. Source: Kenneth French’s homepage,
     http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html.


PROXY FOR LOG CONSUMPTION-WEALTH RATIO, cd
                                         ay
The proxy for the log consumption-wealth ratio is computed as described in Lettau and Ludvigson
(2001a) using data from 1952:4-2001:4.

RELATIVE BILL RATE, RREL
The relative bill rate is the 3-month treasury bill yield less its four-quarter moving average. Our
source is the Board of Governors of the Federal Reserve System.

LOG EXCESS RETURNS ON S&P 500 INDEX: SP EX
SPEX is the log di¤erence in the Standard and Poor 500 stock market index, less the log 3-month
treasury bill yield. Our source is the Board of Governors of the Federal Reserve System.

Rm , SM B, HM L
The Fama/French benchmark factors, Rm, SMB, and HML, are constructed from six size/book-to-
market benchmark portfolios that do not include hold ranges and do not incur transaction costs.
Rm, the return on the market, is the value-weighted return on all NYSE, AMEX, and NASDAQ
stocks. Source: Kenneth French’s homepage,
http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html.


                 2. Conditional Moment Restrictions and Identi…cation


Alternative expressions of the conditional moment restrictions:

                           Et (Mt+1 Ri;t+1    1) = 0        i = 1; :::; N;

                                                 31
where
                                                                                 M Ut+1
                                                         Mt+1 =              o          ;
                                                                                  M Ut
where
                                                                              2                                                   3
                                                                               XL
                                   @U                                         4         j                              @Xt+j 5
                M Ut =                 = (Ct           Xt )    o           Et           o (Ct+j           Xt+j )      o
                                   @Ct                                                                                  @Ct
                                                                                  j=0
                                                            8                                                              9
                                                            <              L
                                                                           X           Ct+j       Xt+j           o
                                                                                                                     @Xt+j =
                                                                                  j
                             = (Ct        Xt )        o E
                                                          t  1                    o                                          ;
                                                            :                            Ct       Xt                  @Ct ;
                                                                           j=0

where
                                                       Ct 1          Ct L                             Ct 1        Ct L
                             Xt = Ct fo 1;                   ; :::;            = Ct go                     ; :::;             ;
                                                         Ct            Ct                              Ct          Ct
                                                            Ct 1           Ct L
                    Ct       Xt = Ct 1                 go           ; :::;
                                                             Ct             Ct

hence
                                                                                         PL       j        Ct+1+j Xt+1+j              o   @Xt+1+j
                                                                       Et+1 1                 j=0 o          Ct+1 Xt+1                     @Ct+1
                M Ut+1                  Ct+1       Xt+1            o
  Mt+1      = o        =           o
                 M Ut                     Ct       Xt                                        PL       j     Ct+j Xt+j             o   @Xt+j
                                                                                 Et 1             j=0 o       Ct Xt                    @Ct


and
        0                                                                                                                                     1
                         Ct+1 Xt+1            o         PL       j           Ct+1+j Xt+1+j             o   @Xt+1+j
     B Et+1         o      Ct Xt                  1          j=0 o             Ct+1 Xt+1                    @Ct+1         Ri;t+1            C
  Et B
     @                                                                                                                                     1C
                                                                                                                                            A = 0:
                                                  PL      j      Ct+j Xt+j               o    @Xt+j
                                       Et 1           j=0 o        Ct Xt                       @Ct


This can be expressed three di¤erent ways:
          0                                                                                                                           1
                 Ct+1 Xt+1     o      PL                               j    Ct+1+j Xt+1+j              o   @Xt+1+j
          B o      Ct Xt          1     j=0                            o      Ct+1 Xt+1                     @Ct+1         Ri;t+1      C
       Et B
          @                         PL
                                                                                                                                      C=0
                                                                                                                                      A
                                           j                           Ct+j Xt+j              o   @Xt+j
                                1     j=0 o                              Ct Xt                     @Ct

            0                            o               PL                                                  o
                                                                                                                                          1
                        Ct+1 Xt+1                                 j+1             Ct+1+j Xt+1+j                  @Xt+1+j
                o         Ct Xt            Ri;t+1             j=0 o                   Ct Xt                       @Ct+1 Ri;t+1
        Et @                                P                                        o @Xt+j
                                                                                                                                          A=0
                                                              Ct+j Xt+j
                                          + L  j=0
                                                         j
                                                         o      Ct Xt                   @Ct     1
                         0                                                                                                1
                                                    o

                       B
                             @Xt
                             @Ct   + o Ct+1 Xt+1
                                         Ct Xt        [Ri;t+1 + @X t+1
                                                                  @Ct
                                                                         @Xt+1
                                                                          @Ct+1 Ri;t+1 ]                                  C
                       B            PL                                                                                    C
                    Et B                                                                                                  C=0
                                            C    Xt+j     o @Xt+j     @Xt+j
                       B           + j=2 jo t+j
                                              Ct Xt         [ @Ct     @Ct+1 Ri;t+1 ]                                      C
                       @                                                          o
                                                                                                                          A
                                        L+1       Ct+L+1 Xt+L+1                       @Xt+L+1
                                        o             Ct Xt                            @Ct+1 Ri;t+1          1




                                                                            32
    Now if we specialize to the speci…cation Xt = ao Ct                                             1    with a unknown constant ao , as in Ferson
                                                                                                                       @Xt                  @Xt+1                @Xt+j
and Constantinides (1991) with no durable consumption, we have                                                         @Ct          = 0,     @Ct        = ao ,    @Ct    =0
for all j        2 and
                                                                                                                                                            !
                         Ct+1        Xt+1           o
                                                                                            2       Ct+2        Xt+2                o
            Et     o                                    [Ri;t+1 + ao ]                      o                                           ao Ri;t+1       1       =0
                           Ct        Xt                                                               Ct        Xt

which coincides with their expression.
    Alternatively we can write the conditional moment restrictions as:
                                                             !
                          Ct+1 Xt+1        o
                  Et o                       Ri;t+1 Fei;t+1 1 = 0; i = 1; :::; N;                                                                                        (27)
                             Ct Xt

with
                   L
                   X                                                                                    L
                                   Ct+1+j      Xt+1+j                 o
                                                                           @Xt+1+j X                                 Ct+j                Xt+j           o
                                                                                                                                                            @Xt+j 1
Fei;t+1      1             j
                           o                                                      +                            j 1
                                                                                                               o                                                        :
                                     Ct+1      Xt+1                         @Ct+1                                    Ct+1                Xt+1                @Ct Ri;t+1
                   j=0                                                                                  j=0


We note that Fei;t+1 = 1 for external habit.
    Alternatively
                                                                                                    !
                                           Ct+1           o
                           Et        o                        Ri;t+1 Fi;t+1                     1       = 0;            i = 1; :::; N;                                   (28)
                                            Ct

with
                                                                                         Ct        Ct+1 L                       o
                                                                      1     go          Ct+1 ; :::; Ct+1
                                          Fi;t+1        Fei;t+1                                                                     ;
                                                                                            Ct 1      Ct L                  o
                                                                       1        go           Ct ; :::; Ct

                       0                                                                                                                                             1
                                            Ct        Ct+1 L                        o
                               1     go    Ct+1 ; :::; Ct+1
                       B                                                                                                                                             C
                       @                  PL     j        Ct+1+j                o                         Ct+j        Ct+j+1 L                      o   @Xt+1+j      A
                                             j=0 o         Ct+1                         1        go      Ct+1+j ; :::; Ct+1+j                            @Ct+1
    Fi;t+1
                                                                                        Ct 1      Ct L                  o
                                                                      1     go           Ct ; :::; Ct
                           PL        j 1     Ct+j             o                     Ct+j 1      Ct+j L                          o   @Xt+j  1
                               j=0           Ct+1                 1        go        Ct+j ; :::; Ct+j                                @Ct Ri;t+1
                       +                                                                                                                                :
                                                                           Ct 1      Ct L                        o
                                                          1       go        Ct ; :::; Ct


Identi…cation:
    In this section, we provide su¢ cient conditions so that the conditional moment restrictions
(11) identi…es the parameters of interest                                  = ( o;                       0
                                                                       o                        o ; go )    in the external habit case, when L = 1.
While we do not provide a formal proof of identi…cation for the more complex internal habit case,
the results for external habit are strongly suggestive for that case, since the presence of a time-
varying component Fei;t+1 under internal habit formation (a nonlinear function of ( o ; o ; go )) should

                                                                                    33
make identi…cation easier than under external habit formation where Fei;t+1 = 1. Thus we study
identi…cation of the unknown true parameters ( o ;                    o ; go )   satisfying the conditional moment (28)
under the special case of external habit with L = 1. We note that, in practice, all of the parameters
of our model seem to be well identi…ed, since (as shown above) the estimation results are remarkably
similar across a variety speci…cations with di¤erent instruments and di¤erent asset returns.
    The conditional moment restrictions for this case are:
                                        Ct Ct 1
                              E ho         ;           Ri;t+1       1 j wt       = 0;          i = 1; :::; N;               (29)
                                       Ct+1 Ct
                                                     h                      i0
                                                                     Ct 1
with w      c;t      cay t ; RRELt ; SP EXt ]0 , wt = w0
                    [d                                          c;t ; Ct         and

                                                                                                 Ct          o
                                  Ct Ct 1                      Ct+1         o    1     go       Ct+1
                            ho       ;             =       o                                                                (30)
                                 Ct+1 Ct                        Ct                              Ct 1         o
                                                                                 1     go        Ct
                                       with 0           go < 1; go 6= const:,              o   > 0;    o   > 0:

    We note that the conditional moment restriction (29) is treating the stochastic discount factor
              M Ut+1                                                               Ct   Ct 1
Mt+1           M Ut      as a totally unknown function Mt+1 = ho                  Ct+1 ; Ct           . We …rst provide su¢ cient
conditions to identify the totally unknown ho () using the conditional moment restriction (29),
and we then use the semiparametric speci…cation (30) and the identi…ed ho () function to identify
( o;   o ; go ).
    The conditional moment restriction (29) is very similar to the equation (2.3) in Newey and Powell
(1988). In the following, we denote fi ( CCt+1       t
                                                       ; Ri;t+1 jwt ), i = 1; :::; N , as the conditional density of
                                                                                                      h              i0
( CCt+1
     t
        ; Ri;t+1 ) given wt , and f ( CCt+1
                                         t
                                            jwt ) as the conditional density of CCt+1  t
                                                                                          given wt = w0 c;t ; CCt t 1 ,
where w       c;t        cay t ; RRELt ; SP EXt ]0 . Following the result in Newey and Powell (1988), we have
                        [d
                                                   Ct   Ct 1
that the identi…cation of Mt+1 = ho               Ct+1 ; Ct      using the restriction (29) is equivalent to:
                        Z Z
            0 =                (yt+1 ; yt )Ri;t+1 fi (yt+1 ; Ri;t+1 jwt )dyt+1 dRi;t+1                                      (31)
                        Z                 Z
                                                      Ri;t+1
                    =       (yt+1 ; yt )                             fi (yt+1 ; Ri;t+1 jw c;t ; yt )dRi;t+1 dyt+1
                                             E[Ri;t+1 jw c;t ; yt ]
                        Z
                                           E[Ri;t+1 jyt+1 ; w c;t ; yt ]
                    =       (yt+1 ; yt )                                 f (yt+1 jw c;t ; yt ) dyt+1
                                             E[Ri;t+1 jw c;t ; yt ]

    for all i = 1; :::; N , implies (yt+1 ; yt ) = 0 almost surely.
                                                                        Ct   Ct 1
    Thus, the identi…cation condition for Mt+1 = ho                    Ct+1 ; Ct            becomes:
                              Ct 1
    (*) for each yt            Ct ;   and for all i = 1; :::; N , the “ i-th return adjusted” conditional density,
E[Ri;t+1 jyt+1 ;w c;t ;yt ]                                     Ct
  E[Ri;t+1 jw c;t ;yt ] f (yt+1 jw c;t ; yt ),   of yt+1       Ct+1   given w        c;t   is complete.
    See Newey and Powell (1988) for additional su¢ cient condition for the “completeness”in terms
of exponential families.

                                                               34
   Next we show that ( o ;             o ; go ) is identi…ed given the                 identi…ed ho () function and the speci…cation
(30). In the following we           let g 0 () denote the derivative                   of g, h0k ( ; ) denote the partial derivative of
h with respect to its k th element for k = 1; 2. Then the semiparametric speci…cation (30) implies
                                              Ct   Ct 1                        Ct 1
                                   h02       Ct+1 ; Ct                g0        Ct
                                                             =                                      almost surely;                           (32)
                                               Ct   Ct 1                          Ct 1
                                         h    Ct+1 ; Ct           1       g        Ct

                                  Ct   Ct 1                                                     Ct
                       h01       Ct+1 ; Ct                  Ct        1               g0       Ct+1
                                                    =                      +                                almost surely:                   (33)
                             h     Ct   Ct 1               Ct+1                                  Ct
                                  Ct+1 ; Ct                                       1        g    Ct+1
        Ct 1          Ct
Since    Ct    and   Ct+1    have the same distribution, we have
                                      8              9      8            9
                                      < g 0 CCt 1    =      < g 0 CCt    =
                                               t                   t+1
                                    E                  =E                  :
                                      : 1 g Ct 1 ;          : 1 g Ct ;
                                                Ct                  Ct+1

After taking expectations on both                  sides of equations (32) and                        (33), we obtain:
              8                                    9       8                                           9      (                      )
              < h02 CCt ; CCt 1                    =       < h01 CCt ; CCt 1                           =           Ct            1
                       t+1    t                                     t+1     t
            E                                         +E                                                 =E                              ;
              :          Ct  Ct 1
                    h Ct+1 ; Ct                    ;       :     h    Ct
                                                                         ; Ct 1                        ;          Ct+1
                                                                                  Ct+1         Ct

hence     is identi…ed. We now take log on both sides of the equation (30):
                                                                                                                       Ct
                                   Ct Ct 1                                            Ct+1                    1   g   Ct+1
                      log h           ;              = log            log                               log                  ;
                                  Ct+1 Ct                                              Ct                     1   g   Ct 1
                                                                                                                       Ct

then take E() on both sides, again since CCt t 1 and CCt+1t
                                                                                           have the same distribution, we have
                                     8                                                     9
                                     <      1 g CCt+1   t                                  =
                                   E log                                                      = 0;
                                     :      1 g CCt t 1                                    ;

                                                   Ct Ct 1                                      Ct+1
                                   E log h            ;               + E log                              = log ;
                                                  Ct+1 Ct                                        Ct
hence     is identi…ed.
   Denote       (x)      1        g(x), which should only take values in (0; 1). Then equation (32) becomes:
                                                                                        Ct
                                                                           h02         Ct+1 ; x
                                                    (log (x))0 =
                                                                                        Ct
                                                                              h        Ct+1 ; x

which can be solved for log (x) up to a scaling constant log (x) for a …xed x in the support of
                        Ct 1
the distribution of      Ct :

                                                                              Z        h02       Ct
                                                                                                Ct+1 ; y
                                                                                   x
                                         log (x)          log (x) =                                         dy
                                                                                                 Ct
                                                                               x           h    Ct+1 ; y


                                                                      35
hence 1            g(x) is identi…ed up to a scaling constant [1 g(x)]:
                                                           8                  9
                                                           <Z x h02 CCt ; y   =
                                                                     t+1
                                  1 g(x) = [1 g(x)] exp                     dy :
                                                           : x h Ct ; y       ;
                                                                    Ct+1

We maintain the assumptions (i) Xt                      0; and (ii) Xt < Ct for Ct positive. It follows that if Ct = 0,
Xt = 0. Hence, we have g(0) = 0 and
                                                                8                                 9
                                                                <Z      x   h02    Ct
                                                                                  Ct+1 ; y
                                                                                                  =
                                            1     g(x) = exp                                 dy       :
                                                                :            h     Ct             ;
                                                                                  Ct+1 ; y
                                                                    0




                                3. Sieve Minimum Distance (SMD) Procedure

     The sieve minimum distance (SMD) procedure has been proposed respectively in Newey and
Powell (2003) for nonparametric IV regression, and in Ai and Chen (2003) for semiparametric
conditional moment restrictions. Here we describe the SMD procedure in the estimation of                                         o   =
( o;    o ; go )   for the habit formation consumption-based asset pricing model (11). We assume that
 o     2 [ ; ]        [ ; ]    G, where [ ; ]           [ ; ] denotes the compact parameter space for the …nite
dimensional parameters ( ; ), and G denotes the parameter space for the in…nite dimensional
unknown function g. In the application we assume [ ; ]                              [ ; ]     (0; 1:2]    [0:1; 100] for simplicity),
and go 2 G where                                         Z
                                G       g 2 L2 (X ) :           jwjje
                                                                    g (w)jdw < 1; 0                   g<1 ;
                                                          RL
here X is a convex open bounded set in                   RL .
                                              This means g 2 G if and only if it is square integrable
                                                                 R
and its Fourier transform ge has …nite …rst moment, where ge(w)    exp( iw0 x)g(x)dx is the Fourier
transform of g.
     First we approximate a function g 2 G by gT 2 GT , where GT is the ANN sieve:
                     8                                                         9
                     <                         KT
                                               X                               =
                                                      L
                GT     g (x1 ; :::; xL ) = 0 +    j   l=1 j;l xl + j ; 0  g<1 ;                                                 (34)
                     :                                                         ;
                                                             j=1

which becomes dense in G as sample size T ! 1. Then for arbitrarily …xed candidate value
  = ( ; ; gT ) 2 [ ; ]              [ ; ]       GT , we estimate the population conditional moment function:

                              mi (wt ; )         E f i (zt+1 ; ; ; gT )jwt g ;                    i = 1; :::; N

nonparametrically by m                      b t ; )0 = (m
                     b i (wt ; ) and denote m(w         b 1 (wt ; ); :::; m
                                                                          b N (wt ; )). Finally we
estimate the ; and the unknown ANN sieve coe¢ cients jointly by a generalized version of minimal
distance estimation procedure:
                                                            T
                                                          1X
                                                min           b t ; )0 b (wt )m(w
                                                              m(w             b t ; );                                          (35)
                                       2[ ; ] [ ; ] GT    T
                                                             t=1


                                                                     36
where b (wt ) is a positive de…nite weighting matrix that is used to take care of heteroskedasticity and
serial dependence. We denote the resulting SMD estimator as b T = (bT ; b ; gbT ) 2 [ ; ] [ ; ] GT .   T
     There are many nonparametric procedures such as kernel, local linear regression, nearest neigh-
bor and various sieve methods that can be used to estimate mi (wt ; ); i = 1; :::; N . In our appli-
cation we again consider the sieve estimator. For each …xed (wt ; ), we approximate mi (wt ; )
by
                                                        JT
                                                        X
                                mi (wt ; )                    aj ( )p0j (wt );      i = 1; :::; N;
                                                        j=1

where p0j some known …xed basis functions, and JT ! 1 slowly as T ! 1: We then estimate the
sieve coe¢ cients faj g simply by OLS regression:
                      T                           JT                                             JT
                    1X                            X
                                                                            0
                                                                                                 X
              min       [ i (zt+1 ; )                     aj ( )p0j (wt )] [ i (zt+1 ; )               aj ( )p0j (wt )]
              faj g T
                       t=1                        j=1                                            j=1
                                                                                 PJT
                                           b i (w; ) =
and the resulting estimator is denoted as: m                                     j=1 abj ( )p0j (wt ). In         the following we
denote:   pJT (w)   = (p01 (w); :::; p0JT      (w))0      and P =    (p T (w1 ); :::; pJT (wT ))0 , then:
                                                                       J

                                    T
                                    X
                    b i (w; ) =
                    m                         i (zt+1 ;     )pJT (wt )0 (P0 P)     1 JT
                                                                                    p     (w);    i = 1; :::; N:              (36)
                                    t=1

     Again many known sieve bases could be used as fp0j g. In our application we take the power
series and Fourier series as the pJT (w). The empirical …ndings are not sensitive to the di¤erent
choice of sieve bases, and we only report the results based on power series due to the length of the
paper.
   In general, the SMD criterion (35) can not be expressed as a GMM criterion. However, when
the weighting matrix is the identity matrix b (wt ) = IN and when the nonparametric estimator
b i (w; ) is the linear sieve estimator (36), the SMD criterion (35) becomes the GMM criterion
m
(15).


              4. Asymptotic Properties of the SMD Estimator b T = (bT ; bT ; gbT )

Beta-mixing:
     We …rst introduce the concept of beta-mixing as a measure of temporal dependence for a time
series. Let fyt = (z0t ; cd
                          ay t ; RRELt ; SP EXt )0 g1
                                                    t=                  1   denote the vector time series. Let I t 1 and
 1 be sigma-…elds generated respectively by (y
It+j                                                                 1;         ; yt ) and (yt+j ;         ; y1 ). De…ne

                              (j)     sup E supfjP (BjI t 1 )                                 1
                                                                                P (B)j : B 2 It+j g:
                                          t

fyt g1
     t=   is called beta-mixing if (j) ! 0 as j ! 1. For a stationary Markov process fYt g with in-
          1
                                                                        R
variant measure F , the beta-mixing coe¢ cients are also given by: (j) = sup0     1 jE[ (Yj )jY0 =


                                                                   37
y]    E[ (Yj )]jdF (y). Beta-mixing is one popular measure of temporal dependence for nonlinear
time series–see the Appendix for the formal de…nition. It is satis…ed by many widely used …nancial
time series models including nonlinear ARX(p,q), ARCH, GARCH, stochastic volatility and di¤u-
sion models; see e.g., Doukhan (1994), Chen, Hansen, and Carrasco (2001) and Carrasco and Chen
(2002). Thus, our SMD procedure requires stationary ergodic observations but does not restrict to
linear time series speci…cations or speci…c parametric laws of motions of the data.

Consistency:
   The consistency of the SMD estimator b T = (bT ; bT ; gbT ) can be easily obtained by applying
                                                                   b ) = 1 PT m(w            0b
Lemma A1 of Newey and Powell (2003), with their criterion function Q(       T   t=1 b   t ; ) m(wt ; ),

their Q( ) = Efm(wt ; )0 m(wt ; )g, their parameter space     is our [ ; ] [ ; ] G, and their
           b
sieve space is our [ ; ] [ ; ] GT . Their assumption i) is satis…ed with our identi…cation result
                             b ) and Q( ) are continuous in all the unknown parameters. To
in Appendix 2. Note that our Q(
satisfy their assumption of compact parameter spaces                                 and b , we can take the following function
space G and the ANN sieve space GT :
                                   Z
                G    g 2 L2 (X ) :                        jwjje
                                                              g (w)jdw          K < 1; 0           g       0:999 ;
                                                     RL

for some known big constant K > 0, and
                   8                                                                                                 9
                   <                                                     KT
                                                                         X            exp     L                      =
                                                                                              l=1 j;l xl     +   j
             GT      g 2 G : g(x1 ; :::; xL ) =                  0   +          j                                        :
                   :                                                                exp     L
                                                                                            l=1 j;l xl   +   j   + 1;
                                                                         j=1


Then by applying the ANN denseness result of Hornik, Stinchcombe, and White (1989), the as-
sumption iii) of Lemma A1 in Newey and Powell (2003) is satis…ed with the sup-norm:

                           k           o ks   =j           oj   +j         oj   + sup jg(x)        go (x)j.
                                                                                     x2X

It remains to verify their uniform convergence assumption ii), which is
                                 T
                               1X
                 sup               b t ; )0 m(w
                                   m(w      b t; )                         Efm(wt ; )0 m(wt ; )g = op (1):                   (37)
             [ ; ] [ ; ] G     T
                                 t=1

This uniform convergence can be established either by applying Lemma A2 in Newey and Powell,
or by showing the following two results hold:

                                  (1)              b t; )
                                              sup jm(w                    m(wt ; )j = op (1);
                                              wt ;

and
                                   T
                                 1X
           (2)       sup             m(wt ; )0 m(wt ; )                             Efm(wt ; )0 m(wt ; )g = op (1):
                 [ ; ] [ ; ] G   T
                                   t=1



                                                                     38
Result (1) can be established by modifying Lemma A.1 in Ai and Chen (2003) to allow for stationary
beta-mixing data. In particular, we replace the Bernstein inequality for I.I.D. data in their proof
by Lemma 1 in Chen and Shen (1998) for stationary beta-mixing data. Result (2) can be obtained
by applying Lemma 1 in Chen and Shen (1998) (or any other uniform laws of large numbers) for
stationary beta-mixing data.
      Now by Lemma A1 in Newey and Powell (2003), we obtain: k b T                                                              o ks   = op (1).

Convergence rate:
      For any         2[ ; ]           [ ; ]      G, let f ( ) :                    2 [0; 1]g be a continuous path in [ ; ]                                [ ; ]   G
such that          (0) =     o    and        (1) =      . Suppose that for almost all zt+1 , (zt+1 ; ( )) is continuously
di¤erentiable at             = 0. Denote the …rst pathwise derivative at the direction [                                                           o]   evaluated at
  o   by:
                                      d (zt+1 ;      o)                             d(zt+1 ; ( ))
                                                            [             o]                      j          =0      a:s: zt+1
                                          d                                              d
                   dm(wt ;   o)
and denote            d           [          o]   Ef d          (zt+1 ;
                                                                  d
                                                                          o)
                                                                               [             o]   j wt g: For any           2[ ; ]       [ ; ]           G we de…ne
the following pseudo metric:
                                              s
                                                            dm(wt ;            o)                     0
                                                                                                           dm(wt ;     o)
                       jj             o jj        E f                               [             o ]g f                    [          o ]g    :
                                                               d                                              d

      Then under assumptions similar to those for Theorem 3.1 in Ai and Chen (2003), we have:
jj b T                        1=4 ).
            o jj   = op (T
      This rate result can be proved by slightly modifying the proof of Theorem 3.1 in Ai and Chen
(2003), that is, we simply replace several parts in their proof that rely on I.I.D. data by the
corresponding ones for stationary beta-mixing data. In particular, their key Lemma A.1 can be
established for stationary beta-mixing data by using Lemma 1 in Chen and Shen (1998).

Root-T asymptotic normality of b, b:
      De…ne ! = (! ; ! ) with


                                                                                                    0
                                        dm(wt ;      o)            dm(wt ;              o)                 dm(wt ;     o)       dm(wt ;            o)
         ! = arg min E                                                                       [! ]                                                       [! ]   ;
                     ! 2G                  d                          dg                                      d                    dg


                                                                                                    0
                                        dm(wt ;      o)            dm(wt ;              o)                 dm(wt ;     o)       dm(wt ;            o)
         ! = arg min E                                                                       [! ]                                                       [! ]   :
                     ! 2G                  d                          dg                                      d                    dg

Denote

                                      dm(wt ;      o)       dm(wt ;            o)                 dm(wt ;      o)           dm(wt ;       o)
             D! (wt ) =                                 ;                                                           [! ];                      [! ] :
                                         d                     d                                     dg                        dg


                                                                                    39
Assumption N. (i) E[D! (wt )0 D! (wt )] is positive-de…nite; (ii)                            o   2 ( ; ) and      o   2 ( ; ); (iii)
 o (w)       V ar[ (zt+1 ;    o )jwt   = w] is positive de…nite for all w in the support of wt ; (iv) jj b T
                  1=4 ):
 o jj   = op (T
   Under Assumption N and other regularity conditions similar to those for Theorem 4.1 in Ai
                          p                 0
and Chen (2003), we obtain T b    o; b    o   !D N (0; V 1 ) with

            V = E[D! (wt )0 D! (wt )]fE[D! (wt )0                o (wt )D!      (wt )]g     1
                                                                                                EfD! (wt )0 D! (wt )g:

    This result can be proved by slightly modifying the proof of Theorem 4.1 in Ai and Chen (2003),
that is, we simply replace several parts in their proof that rely on I.I.D. data by the corresponding
ones for stationary beta-mixing data.


                             5. Limiting Distributions of the Test Statistics


Root-T asymptotic normality of b for testing internal vs. external habit
    Recall that the pseudo-true value                   =( ;         ;   ; g ( ))0 solves the following conditional mo-
ment restrictions:
 0 0                                               1                                                         1
                              Ct        Ct+1 L
 B      Ct+1 1 g             Ct+1 ; :::; Ct+1                                                                 C
E@ @                                               A       Ri;t+1 Fei;t+1 (         ;   ;   ;g )       1 j wt A = 0;          i = 1; :::; N;
          Ct 1 g              Ct 1      Ct L
                               Ct ; :::; Ct


with Fei;t+1 ( ; ; ; g) de…ned in (25).
    These unknown pseudo-true values ( ;                   ;    ; g ( )) can again be estimated by the SMD method
using the same ANN sieve (19) to approximate the unknown g ( ), the same three asset groups
with the associated sets of instruments. All we need to do is to rede…ne                                    = ( ; ; ; g( ))0 and
 (zt+1 ; ) = ( 1 (zt+1 ; ); :::;       N (zt+1 ;   ))0 with
                                 0                                Ct+1 L
                                                                                1
                                                        Ct
                                   Ct+1 1 g            Ct+1 ; :::; Ct+1
                  i (z t+1 ; ) = @                                              A       Ri;t+1 Fei;t+1 ( ; ; ; g)         1
                                    Ct 1 g              Ct 1      Ct L
                                                         Ct ; :::; Ct

in the sieve LS estimation (14) of mi (wt ; ) and m(wt ; ) = (m1 (wt ; ); :::; mN (wt ; ))0 .
    Denote     = ( ; ; ; g ( ))0 and let b T = (bT ; bT ; b T ; gbT ) be the solution to
                                                                 T
                                                               1X
                                            min                    b t ; )0 m(w
                                                                   m(w      b t ; ):
                                   2[ ; ] [ ; ] [ ; ] GT       T
                                                                 t=1

    Let ! = (! ; ! ; ! ) with
                                                                            0
                               dm(wt ;       )     dm(wt ;       )                  dm(wt ;        )    dm(wt ;       )
        ! = arg min E                                                [! ]                                                 [! ]      ;
                   ! 2G           d                   dg                               d                   dg

                                                                40
and ! , ! de…ned similarly as those in Appendix 4 (above) except replacing                                                          o   by       . Denote
dm(wt ;    )
   dg          [! ] =   ( dm(wt;
                             dg
                                      )
                                          [! ];   dm(wt ;
                                                     dg
                                                              )
                                                                  [! ];    dm(wt ;
                                                                              dg
                                                                                       )
                                                                                           [! ]),

                                          dm(wt ;           ) dm(wt ;           ) dm(wt ;           )          dm(wt ;          )
                    D! (wt ) =                               ;                   ;                                                  [! ];
                                             d                   d                   d                            dg
and       (wt ) = V ar[ (zt+1 ;               )jwt ]. Finally let

              V = E[D! (wt )0 D! (wt )]fE[D! (wt )0                             (wt )D! (wt )]g           1
                                                                                                              EfD! (wt )0 D! (wt )g:

Then under assumptions similar to those suggested in Appendix 4, we obtain:
                                          p                                            0
                                              T b           ;b            ;b                 !D N (0; V         1
                                                                                                                    ):


Root-T asymptotic normality of bg for testing linear habit
   Recall that
                                                              T
                                                            1X          Ct         Ct+1 L
                                                  bg =          gb11 (      ; :::;        ),
                                                            T          Ct+1         Ct+1
                                                                 t=L

where gb11 () is the second partial derivative of the SMD estimator gb() with respect to its …rst
                                                                                                                      Ct        Ct+1 L               o ()
argument. Let f () denote the true unknown probability density of                                                    Ct+1 ; :::; Ct+1           and g11
denote the second partial derivative of the true go () with respect to its …rst argument. Then
                                  Z
                                      o
                             g =     g11 (z1 ; z2 ; :::; zL )f (z1 ; z2 ; :::; zL )dz:

   Suppose that f () is at least twice continuously di¤erentiable with respect to its …rst argument,
where f1 () and f11 () denote the …rst and second partial derivatives of f () with respect to its …rst
argument. Also assume that f () and f1 () go to zero smoothly as their …rst argument goes to the
boundaries. Under some mild additional conditions and using a slight modi…cation of Example 2.2
in Ai and Chen (2005), we obtain:
                p
                    T bg        g
                      T
                      X
                 1             o       Ct         Ct+1 L                     o        Ct         Ct+1 L
          =     p             g11 (        ; :::;        )                Efg11 (         ; :::;        )g
                  T                   Ct+1         Ct+1                              Ct+1         Ct+1
                      t=L
                      2                                                                                                                 3
                                                                                                                            Ct+1 L
                               Ct         Ct+1 L                          Ct         Ct+1 L         f11 ( CCt+1
                                                                                                             t
                                                                                                                ; :::;       Ct+1 ) 5
                +E 4 gb(           ; :::;        )                go (        ; :::;        )                              Ct+1 L
                                                                                                                                             + op (1);
                              Ct+1         Ct+1                          Ct+1         Ct+1              f ( CCt+1 ; :::;    Ct+1 )
                                                                                                               t


      p
and       T bg            g   !D N (0;            2 ).
                                                  11     Unfortunately, the limiting variance
                                                                               is of a complicated                         2
                                                                                                                           11
                                                                                          p
form, which motivates our use of bootstrap approximation of the asymptotic distribution of T bg                                                             g   .




                                                                               41
References
Abel, A. B. (1990): “Asset Prices Under Habit Formation and Catching Up With the Jones,” American
  Economic Review, 80, 38–42.

        (1999): “Risk Premia and Term Premia in General Equilibrium,”Journal of Monetary Economics,
  43, 3–33.

Ai, C., and X. Chen (2003): “E¢ cient Estimation of Models with Conditional Moment Restrictions
  Containing Unknown Functions,” Econometrica, 71, 1795–1843.

         (2005): “Estimation of Possibly Misspeci…ed Semiparametric Conditional Moment Restriction
  Models with Di¤erent Conditioning Variables,” forthcoming in Journal of Econometrics.

Bansal, R., D. A. Hsieh, and S. Viswanathan (1993): “A New Approach to International Arbitrage
  Pricing,” The Journal of Finance, 48, 1719–1747.

Bansal, R., and S. Viswanathan (1993): “No Arbitrage and Arbitrage Pricing: A New Approach,”The
  Journal of Finance, 48(4), 1231–1262.

Boldrin, M., L. J. Christiano, and J. D. M. Fisher (2001): “Habit Persistence, Asset Returns and
  the Business Cycle,” American Economic Review, 91(1), 149–166.

Breeden, D. (1979): “An Intertemporal Asset Pricing Model with Stochastic Consumption and Investment
  Opportunities,” Journal of Financial Economics, 7, 265–296.

Breeden, D., and R. Litzenberger (1978): “Prices of State-Contingent Claims Implicit in Option
  Prices,” Journal of Business, 51, 621–651.

Campbell, J. Y. (1991): “A Variance Decomposition for Stock Returns,”Economic Journal, 101, 157–179.

Campbell, J. Y., and J. H. Cochrane (1999): “By Force of Habit: A Consumption-Based Explanation
  of Aggregate Stock Market Behavior,” Journal of Political Economy, 107, 205–251.

        (2000): “Explaining the Poor Performance of Consumption-Based Asset Pricing Models,” Journal
  of Finance, 55(6), 2863–2878.

Campbell, J. Y., A. W. Lo, and C. MacKinlay (1997): The Econometrics of Financial Markets.
  Princeton University Press, Princeton, NJ.

Campbell, J. Y., and R. J. Shiller (1989): “The Dividend-Price Ratio and Expectations of Future
  Dividends and Discount Factors,” Review of Financial Studies, 1(3), 195–228.

Carrasco, M., and X. Chen (2002): “Mixing and Moment Properties of Various GARCH and Stochastic
  Volatility Models,” Economic Theory, 18, 17–39.

Chapman, D. A. (1997): “Approximating the Asset Pricing Kernel,”Journal of Finance, 52(4), 1383–1410.

        (1998): “Habit Formation and Aggregate Consumption,” Econometrica, 66(5), 1223–1230.

Chen, X., L. P. Hansen, and M. Carrasco (2001): “Nonlinearity and Temporal Dependence,”Unpub-
  lished paper, New York University.


                                                     42
Chen, X., and X. Shen (1998): “Sieve Extremum Estimates For Weakly Dependent Data,”Econometrica,
  66(2), 289–314.

Chen, X., and H. White (1999): “Improved Rates of Asymptotic Normality for Nonparametric Neural
  Network Estimators,” IEEE Information Theory, 45, 682–691.

Cochrane, J. H. (2001): Asset Pricing. Princeton University Press, Princeton, NJ.

Constantinides, G. M. (1990): “Habit-formation: A Resolution of the Equity Premium Puzzle,”Journal
  of Political Economy, 98, 519–543.

Corradi, V., and N. Swanson (2003): “A Test for Comparing Multiple Misspeci…ed Conditional Distri-
  butions,” Unpublished paper, Rutgers University.

Dai, Q. (2003): “Term Structure Dynamics in a Model with Stochastic Internal Habit,”Unpublished paper,
  Stern School of Business, New York University.

Doukhan, P. (1994): Mixing: Properites and Examples. Springer-Verlag, New York.

Dynan, K. E. (2000): “Habit Formation in Consumer Preferences: Evidence from Panel Data,” American
  Economic Review, 90, 391–406.

Fama, E. F., and K. R. French (1988): “Dividend Yields and Expected Stock Returns,” Journal of
  Financial Economics, 22, 3–27.

        (1992): “The Cross-Section of Expected Returns,” Journal of Finance, 47, 427–465.

        (1993): “Common Risk Factors in the Returns on Stocks and Bonds,” Journal of Financial Eco-
  nomics, 33, 3–56.

        (1996): “Multifactor Explanations of Asset Pricing Anomalies,” Journal of Finance, 51, 55–84.

Ferson, W. E., and G. M. Constantinides (1991): “Habit Persistence and Durability in Aggregate
  Consumption,” Journal of Financial Economics, 29, 199–240.

Ferson, W. E., and C. R. Harvey (1992): “Seasonality and Consumption-Based Asset Pricing,”Journal
  of Finance, 47, 511–552.

Gallant, A. R., L. P. Hansen, and G. Tauchen (1990): “Using Conditional Moments of Asset Payo¤s
  to infer the Volatility of Intertemporal Marginal Rates of Subsitution,” Journal of Econometrics, 45(2),
  141–179.

Gallant, A. R., and G. Tauchen (1989): “Seminonparametric Estimation of Conditionally Constrained
  Heterogeneous Processes: Asset Pricing Applications,” Econometrica, 57(5), 1091–1120.

Grenander, U. (1981): Abstract Inference. Wiley Series, New York, NY.

Hall, P., J. L. Horowitz, and B. Y. Jing (1995): “On Blocking Rules for the Bootstrap with Dependent
  Data,” Biometrika, 82, 561–574.

Hansen, L. P. (1982): “Large Sample Properties of Generalized Methods of Moments Estimators,”Econo-
  metrica, 50, 1029–54.


                                                     43
Hansen, L. P., J. Heaton, and N. Li (2005): “Consumption Strikes Back?: Measuring Long-run Risk,”
  Unpublished Paper, University of Chicago.

Hansen, L. P., J. Heaton, and E. G. Luttmer (1995): “Econometric Evaluation of Asset Pricing
  Models,” The Review of Financial Studies, 8(2), 238–274.

Hansen, L. P., and R. Jagannathan (1991): “Restrictions on Intertemporal Marginal Rates of Substi-
  tution Implied by Asset Returns,” Journal of Political Economy, 99, 225–262.

        (1997): “Assessing Speci…c Errors in Stochastic Discount Factor Models,” Journal of Finance, 52,
  557–590.

Hansen, L. P., and K. Singleton (1982): “Generalized Instrumental Variables Estimation of Nonlinear
  Rational Expectations Models,” Econometrica, 50(5), 1269–86.

Hansen, P. R. (2003): “A Test for Superior Predictive Ability,” Unpublished paper, Brown University.

Harvey, C. R. (1991): “The World Price of Covariance Risk,” Journal of Finance, 46, 111–117.

Heaton, J. (1993): “The Interaction Between Time-Nonseparable Preferences and Time Aggregation,”
  Econometrica, 61(2), 353–85.

        (1995): “An Empirical Investigation of Asset Pricing with Temporally Dependent Preference Spec-
  i…cations,” Econometrica, 63, 681–717.

Hodrick, R. (1992): “Dividend Yields and Expected Stock Returns: Alternative Procedures for Inference
  and Measurement,” Review of Financial Studies, 5, 357–386.

Hornik, K., M. Stinchcombe, and H. White (1989): “Multi-layer Feedforward Networks are Universal
  Approximators,” Neural Networks, 2, 359–366.

Horowitz, J. L. (2003): “The Bootstrap,” in Handbook of Econometrics, ed. by J. J. Heckman, and
  E. Leamer, vol. 5. Elsevier Science B.V., North Holland.

Jermann, U. (1998): “Asset Pricing in Production Economies,” Journal of Monetary Economics, 41(2),
  257–275.

Kandel, S., and R. F. Stambaugh (1995): “Portfolio Ine¢ ciency and the Cross-Section of Expected
  Returns,” Journal of Finance, 50, 157–184.

Lamont, O. (1998): “Earnings and Expected Returns,” Journal of Finance, 53, 1563–87.

Lettau, M., and S. C. Ludvigson (2001a): “Consumption, Aggregate Wealth and Expected Stock
  Returns,” Journal of Finance, 56(3), 815–849.

         (2001b): “Resurrecting the (C)CAPM: A Cross-Sectional Test When Risk Premia are Time-
  Varying,” Journal of Political Economy, 109(6), 1238–1287.

         (2004): “Understanding Trend and Cycle in Asset Values: Reevaluating the Wealth E¤ect on
  Consumption,” American Economic Review, 94(1), 276–299.

Li, Y. (2001): “Expected Returns and Habit Persistence,” Review of Financial Studies, 14(3), 861–899.


                                                   44
Lintner, J. (1965): “Security Prices, Risk and Maximal Gains from Diversi…cation,” Journal of Finance,
  20, 587–615.

Ljungqvist, L., and H. Uhlig (2000): “Tax Policy and Aggregate Demand Management Under Catching
  Up With the Jonses,” American Economic Review, 90(3), 356–366.

Menzly, L., T. Santos, and P. Veronesi (2004): “Understanding Predictability,” Journal of Political
  Economy, 112(1), 1–47.

Newey, W. K., and J. Powell (1988): “Instrumental Variable Estimation of Nonparametric Models,”
  Working Paper Version of Published Paper, MIT.

          (2003): “Instrumental Variable Estimation of Nonparametric Models,” Econometrica, 71, 1557–
  1569.

Parker, J., and C. Julliard (2004): “Consumption Risk and the Cross-Section of Expected Returns,”
  Journal of Political Economy, 113(1), 185–222.

Sharpe, W. (1964): “Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk,”
  Journal of Finance, 19, 425–444.

Shiller, R. J. (1981): “Do Stock Prices Move Too Much to be Justi…ed by Subsequent Changes in Divi-
  dends?,” American Economic Review, 71, 421–436.

Shore, S. H., and J. S. White (2002): “External Habit Formation and the Home Bias Puzzle,” Unpub-
  lished paper, Harvard University.

Stock, J. H., J. H. Wright, and M. Yogo (2002): “A Survey of Weak Instruments and Weak Identi…-
  cation in Generalized Method of Moments,”Journal of Business and Economic Statistics, 20(4), 518–528.

Sundaresan, S. (1989): “Intertemporally Dependent Preferences and the Volatility of Consumption and
  Wealth,” The Review of Financial Studies, 2, 73–89.

Wachter, J. (2006): “A Consumption Based Model of the Term Structure of Interest Rates,” Journal of
  Financial Economics, 79, 365–399.

Wang, Z., and X. Zhang (2003): “The Role of Artibtrage in the Empirical Evaluation of Asset Pricing
  Models,” Unpublished paper, Cornell University.

White, H. (2000): “A Reality Check for Data Snooping,” Econometrica, 68(5), 1097–1126.




                                                    45
10   Tables
                                           Table 1
                                  SMD Estimates of      and
       Assets            Instruments
       Group 1           1, wt , squared terms                0.9850      0.757
                                                              (0.005)    (0.107)
       Group 2           1, wt , squared, cross terms         0.9875      0.789
                                                              (0.005)    (0.077)
       Group 3           1, wt                                0.9847      0.811
                                                              (0.006)    (0.149)
       Notes: The table reports SMD parameter estimates and asymptotic standard errors
       in parentheses.




                                                 46
                                          Table 2
                   Speci…cation Errors for Alternative Models: HJ
                                     6 size/BM                      6 + T-bill
       Model                          HJ Dist                         HJ Dist
        (1)                               (2)                           (3)
 Internal Habit                         0.172                          0.179
 External Habit                         0.261                          0.425
 Fama-French                            0.262                          0.282
 Scaled CCAPM                           0.208                          0.352
 CCAPM                                  0.307                          0.403
 CAPM                                   0.339                          0.416
 Notes: For each model labeled in column 1, the table reports the Hansen-Jagannathan
  distance (“HJ Dist”) evaluated on equity returns alone (column 2) or equity returns
  plus Treasury bill rate (column 3).

                                          Table 3
                  Speci…cation Errors for Alternative Models: HJ+
                                    6 size/BM                       6 + T-bill
     Model                          HJ+   Dist                       HJ+ Dist
       (1)                              (2)                             (3)
Internal Habit                         0.177                           0.180
External Habit                         0.289                           0.455
Fama-French                            0.262                           0.287
Scaled CCAPM                           0.810                           0.601
CCAPM                                  0.372                           0.618
CAPM                                   0.340                           0.418
Notes: For each model in column 1,    "HJ+      Dist" is the distance between the model proxy
and the family of admissible nonnegative stochastic discount factors. In column
2, test assets are equity returns; in 3, test assets are equity returns plus T-bill rate.




                                                47
                           Table 4
             Covariances of SDFs with Returns
        Average Excess Return           Average Return
Tbill                                        1.0035
S1B1            0.0177                       1.0213
S1B2            0.0274                       1.0309
S1B3            0.0322                       1.0357
S2B1            0.0185                       1.0221
S2B2            0.0195                       1.0230
S2B3            0.0260                       1.0295
          SDF internal habit           SDF external habit
                          Covariance
S1B1            -0.0189                     -0.0103
S1B2            -0.0248                     -0.0096
S1B3            -0.0292                     -0.0100
S2B1            -0.0200                     -0.0074
S2B2            -0.0182                     -0.0039
S2B3            -0.0272                     -0.0083
Notes : This table reports average returns for the portfolios
in the left column, and covariance of the stochastic discount
factors of internal and external habit models with each excess
return. The sample spans the period 1952:Q4 -2001:Q2.




                               48
                                      Table 5
                        Pricing Errors for 6 Size/BM Returns
     Return                          Fama-French                      Internal Habit
                                    HJ Dist = 0.26                   HJ Dist = 0.172
      S1B1                               -0.0031                          -0.0052
      S1B2                               0.0005                           -0.0001
      S1B3                               0.0009                           -0.0005
      S2B1                               0.0026                           -0.0041
      S2B2                               -0.0029                          -0.0008
      S2B3                               -0.0015                          -0.0027
Notes: This Table reports pricing errors from the Hansen-Jagannathan minimization
using six size/book-market portfolio equity returns. Errors for the Fama-French
model and internal habit model are reported. The internal habit model uses
SMD estimates on Group 2 assets for g.




                                         49
                                           Figure 1


                                       Habit−to−Consumption Ratio
        0.975


        0.974


        0.973


        0.972


        0.971


         0.97
                0   20   40    60     80          100          120   140   160   180   200



                                       Stochastic Discount Factor
         1.04


         1.02


           1


         0.98


         0.96


         0.94
                0   20   40    60     80          100          120   140   160   180   200




Notes: This figure plots the estimated habit-consumption ratio (top panel) and estimated
stochastic discount factor (bottom panel) using Group 1 assets, linear and squared
instruments.
                                                         Figure 2


                               First Derivative Of Habit One Period Ahead With Respect to Consumption
        0.042

         0.04

        0.038

        0.036

        0.034
                0   20   40            60           80          100          120          140             160   180   200

                              First Derivative Of Habit Two Periods Ahead With Respect to Consumption
         0.03


        0.028


        0.026


        0.024
                0   20   40            60           80          100          120          140             160   180   200

                              First Derivative Of Habit Three Periods Ahead With Respect to Consumption
        0.019


        0.018


        0.017


        0.016
                0   20   40            60           80          100          120          140             160   180   200




Notes: Estimates use Group 1 assets, linear and squared instruments.
                                                 Figure 3


                   4
                x 10              X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at median
         1.18


         1.16


         1.14


         1.12
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10
                                   X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at 25%
         8600

         8500

         8400

         8300

         8200
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10
                   4
                x 10               X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at 75%
         1.46


         1.44


         1.42


          1.4
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10



Notes: X (t ) is the estimated habit, C (t ) is consumption. Estimates use Group 1 assets,
linear and squared instruments.
                                                 Figure 4


                   4
                x 10              X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at median
         1.18


         1.16


         1.14


         1.12
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10
                                   X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at 25%
         8600

         8500

         8400

         8300

         8200
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10
                   4
                x 10               X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at 75%
         1.46


         1.44


         1.42


          1.4
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10



Notes: X (t ) is the estimated habit, C (t ) is consumption. Estimates use Group 2 assets,
linear, squared and cross term instruments.
                                                 Figure 5

                                                NoteNoat

                   4
                x 10              X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at median
         1.18


         1.16


         1.14


         1.12
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10
                                   X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at 25%
         8600

         8500

         8400

         8300

         8200
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10
                   4
                x 10               X(t) Against C(t−1) with C(t), C(t−2), C(t−3) at 75%
         1.46


         1.44


         1.42


          1.4
            0.6        0.8           1                     1.2                    1.4       1.6      1.8
                                                                                                     4
                                                                                                  x 10


Notes: X (t ) is the estimated habit, C (t ) is consumption. Estimates use Group 3 assets,
linear instruments.
                                                        Figure 6


                              Second Derivative Of Habit One Period Ahead With Respect To Consumption
       −0.048




       −0.049




        −0.05




       −0.051




       −0.052




       −0.053




       −0.054




       −0.055
                0   20   40            60          80          100         120          140         160   180   200




Notes: Estimates using Group 1 assets, linear and squared instruments.
                                                        Figure 7


                              Second Derivative Of Habit One Period Ahead With Respect To Consumption
       −0.048




       −0.049




        −0.05




       −0.051




       −0.052




       −0.053




       −0.054




       −0.055
                0   20   40            60          80          100         120          140         160   180   200




Notes: Estimates using Group 2 assets, linear, squared and cross term instruments.
                                                        Figure 8


                              Second Derivative Of Habit One Period Ahead With Respect To Consumption
       −0.048




       −0.049




        −0.05




       −0.051




       −0.052




       −0.053




       −0.054




       −0.055
                0   20   40            60          80          100         120          140         160   180   200




Notes: Estimates using Group 3 assets, linear instruments.
