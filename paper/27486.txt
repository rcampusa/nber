                             NBER WORKING PAPER SERIES




                           MPCS, MPES AND MULTIPLIERS:
                     A TRILEMMA FOR NEW KEYNESIAN MODELS

                                        Adrien Auclert
                                       Bence Bardóczy
                                       Matthew Rognlie

                                     Working Paper 27486
                             http://www.nber.org/papers/w27486


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    July 2020




An earlier version of this paper circulated under the title "A Note on Multipliers in NK Models
with GHH Preferences". We thank the editor Yuriy Gorodnichenko, two anonymous referees, as
well as Florin Bilbiie, Gabriel Chodorow-Reich, Alisdair McKay, Ben Moll, and Valerie Ramey
for useful comments and suggestions. The views expressed herein are those of the authors and do
not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Adrien Auclert, Bence Bardóczy, and Matthew Rognlie. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
MPCs, MPEs and Multipliers: A Trilemma for New Keynesian Models
Adrien Auclert, Bence Bardóczy, and Matthew Rognlie
NBER Working Paper No. 27486
July 2020
JEL No. D52,E52,E62,H31

                                        ABSTRACT

We establish an impossibility result for New Keynesian models with a frictionless labor market:
these models cannot simultaneously match plausible estimates of marginal propensities to
consume (MPCs), marginal propensities to earn (MPEs), and fiscal multipliers. A HANK model
with sticky wages provides a solution to this trilemma.


Adrien Auclert                                 Matthew Rognlie
Department of Economics                        Department of Economics
Stanford University                            Northwestern University
579 Serra Mall                                 2211 Campus Drive
Stanford, CA 94305-6072                        Evanston, IL 60208
and NBER                                       and NBER
aauclert@stanford.edu                          matthew.rognlie@northwestern.edu

Bence Bardóczy
Northwestern University
Department of Economics
2211 Campus Drive
Evanston, IL 60208
bardoczy@u.northwestern.edu
                              MPCs, MPEs and Multipliers:
                    A Trilemma for New Keynesian Models

            Adrien Auclert*                 Bence Bardóczy                   Matthew Rognlie


                                                  June 2020


                                                      Abstract

          We establish an impossibility result for New Keynesian models with a frictionless labor
      market: these models cannot simultaneously match plausible estimates of marginal propensi-
      ties to consume (MPCs), marginal propensities to earn (MPEs), and fiscal multipliers. A HANK
      model with sticky wages provides a solution to this trilemma.




Introduction
In recent decades, macroeconomics has experienced a micro-moment revolution. As the field has
recognized the importance of heterogeneity for macroeconomic outcomes, it has increasingly used
estimates from disaggregated data to discipline its models.
    One moment that epitomizes this revolution is the marginal propensity to consume (MPC): the
amount by which consumption increases in response to a one-time transitory increase in income.
Recent research has established that MPCs are extremely important for the macroeconomic effects
of shocks and policy, both in partial equilibrium (e.g. Kaplan and Violante 2014, Auclert 2019,
Berger, Guerrieri, Lorenzoni and Vavra 2018) and in general equilibrium (e.g. Kaplan, Moll and
Violante 2018, Auclert, Rognlie and Straub 2018). Moreover, there exists a widespread consensus
on the average level of MPCs in the data. We summarize this consensus as:

Fact 1. Average MPCs are high in the data, around 0.25 quarterly and 0.5 annually.
   * Stanford University, CEPR and NBER. Email: aauclert@stanford.edu.
    Northwestern University. Email: bardoczy@u.northwestern.edu.
    Northwestern University and NBER. Email: matthew.rognlie@northwestern.edu.

An earlier version of this paper circulated under the title "A Note on Multipliers in NK Models with GHH Preferences".
We thank the editor Yuriy Gorodnichenko, two anonymous referees, as well as Florin Bilbiie, Gabriel Chodorow-Reich,
Alisdair McKay, Ben Moll, and Valerie Ramey for useful comments and suggestions.




                                                          1
    As is widely recognized in the literature, Fact 1 is important because it disqualifies almost all
standard representative-agent models, which are based on the permanent-income hypothesis and
therefore generate low average MPCs. Instead, Fact 1 favors models with heterogeneous agents
and incomplete markets.
    In standard macroeconomic models, agents have two immediate margins of adjustment when
they receive a one-time income shock: they can consume more or work less (the rest is saved).
The MPC measures how much they increase their consumption. The marginal propensity to earn,
or MPE, measures how much they reduce their earned income. While the MPE has received
somewhat less attention in the macroeconomic literature,1 it is the labor market equivalent of the
MPC. As such, it is in principle equally important for macroeconomic adjustment, and constitutes
an equally natural target for calibrating models with heterogeneous agents. Moreover, there also
exists a literature estimating MPEs in micro data. We summarize the evidence on the average level
of MPEs in that literature as:

Fact 2. Average MPEs are small in the data, around 0 to 0.04 annually.

    The combination of Facts 1 and 2 poses a challenge for heterogeneous agent models with a
flexible labor supply choice. Under separable preferences, unless utility has very different curva-
tures in consumption and labor, agents that are free to adjust their labor supply should adjust to
income transfers on the consumption and the labor supply margins by comparable amounts. If
average MPCs are high, then average MPEs should be high as well.
    The standard solution to this challenge is to consider alternative preference specifications that
dampen wealth effects on labor supply, such as GHH preferences (Greenwood, Hercowitz and
Huffman 1988). As we prove formally in this paper, any preference specification that lowers
wealth effects must also increase the degree of complementarity between consumption and labor
in preferences. While there is empirical support for some complementarity between consumption
and labor (e.g. Aguiar and Hurst 2013), in this paper we show that too much complementarity
poses a critical third challenge for business cycle models.
    To understand this challenge, keep in mind that the micro-moment revolution should not
eclipse the long tradition of disciplining macro models with macro moments. In this paper, we
will focus on one particular conditional macro moment: the fiscal multiplier, i.e. the effect of gov-
ernment spending on aggregate output. There is a long empirical tradition of estimating the fiscal
multiplier in aggregate time-series data, and of using it to gauge the plausibility of business cycle
models.2 We summarize the consensus evidence in that literature as:

Fact 3. Fiscal multipliers lie in a moderate range in the data. Under accommodative monetary policy, both
impact and cumulative multipliers are between 0.6 and 2.
   1A large literature in labor focuses on the static MPE, which is different from the dynamic MPE that is of interest for
macro models. See our discussion in section 1.
  2 For example, following Galí, López-Salido and Vallés (2007), the positive response of consumption to government

purchases in structural VARs has motivated a very large literature searching for models that can deliver this feature.
Monetary policy shocks provide alternative conditional moments to discipline business cycle models.


                                                            2
                                                    Fact 1:
                                                    MPCs




                                                              Se
                                                               pa
                                               K




                                                                  ra
                                            AN




                                                                     bl
                                            H




                                                                        e-
                                         H-




                                                                       HA
                                       GH




                                                                         NK
                                  Fact 2:                                     Fact 3:
                                   MPEs                                      Multipliers
                                                Separable-RANK




                                            Figure 1: The trilemma


    The most common framework for studying these multipliers is the New Keynesian model with
a frictionless labor market, featuring sticky prices and flexible wages. As Monacelli and Perotti
(2008) and Bilbiie (2011) have pointed out, introducing consumption-labor complementarity into
this model leads to higher multipliers under accommodative policy. Building on their findings,
we argue that when there is enough complementarity in the model to reconcile Facts 1 and 2, the
resulting multiplier is high enough to violate Fact 3. This creates a trilemma for New Keynesian
models: it is impossible to simultaneously match Facts 1, 2, and 3.
    Figure 1 provides a graphical summary of this trilemma: it is possible to match any two of the
three facts, but only at the cost of missing the third. First, with standard separable preferences, a
heterogeneous-agent New Keynesian ("HANK") model with sticky prices and flexible wages can
match MPCs and multipliers.3 But this generates average MPEs that are much higher than in the
data. For example, when we calibrate such a heterogeneous-agent model to feature a quarterly
MPC of 0.25, the annual MPE is over 0.2--at least five times as large as the data. Alternatively,
GHH preferences shut off wealth effects on labor supply, so that all agents have an MPE of 0. This
allows a HANK model to match MPCs and MPEs simultaneously,4 but at the cost of generating
very high fiscal multipliers: our calibration implies an impact multiplier around 4.5, and a cumu-
lative multiplier above 9. Finally, a representative-agent New Keynesian ("RANK") model with
separable preferences can match fiscal multipliers and MPEs, but misses MPCs.
    Our paper demonstrates that this trilemma is complete: even generalizing beyond the three
models discussed above, there is no way to match all three facts at once in a New Keynesian model
with a frictionless labor market. We conclude that solving the trilemma requires stepping outside
of this class of models--in particular, adding frictions to the labor market. We provide our own
  3 See  McKay, Nakamura and Steinsson (2016) and Kaplan, Moll and Violante (2018) for prominent versions of such
a model.
   4 This route is taken, for instance, by Bayer, Luetticke, Pham-Dao and Tjaden (2019), and was also taken by the

original versions of Kaplan, Moll and Violante (2018) and Auclert (2019).


                                                        3
solution, based on sticky wages.
    We establish the trilemma in two steps. First, we use consumer theory to show that, at the
microeconomic level, MPCs and MPEs are related by a "complementarity index" (CI  [0, 1]) that
measures the strength of the complementarity between consumption and labor supply. Taking the
elasticity of intertemporal substitution and the Frisch elasticity as given, lowering MPEs relative
to MPCs requires raising CI: it is not possible to limit the wealth effect on labor supply without
simultaneously raising the degree of complementarity between consumption and labor.
    Second, using a combination of analytical results and numerical simulations, we show that it
is the same complementarity index that, in New Keynesian models, regulates the size of the fiscal
multiplier. The intuition is as follows. As a fiscal shock increases demand for output, wages must
rise until enough labor is supplied in equilibrium to produce that output. When CI is positive,
as households work more, they also want to consume more, and this additional consumption
increases demand for output even further--prompting another increase in labor effort, and so on.
The larger CI, the stronger this effect, and therefore the larger the multiplier. This explains the
trilemma: the same force that reconciles Facts 1 and 2 makes it difficult to match Fact 3.
    To cleanly isolate the importance of CI for the fiscal multiplier, we start by considering the
representative-agent case. There, we show that the multiplier, if monetary policy maintains a
constant real interest rate, is given by

                                            dYt          1
                                                =                · 1s=t                                               (1)
                                            dGs   1 - (1 -  ) CI

where  < 1 is the labor wedge. When preferences are separable, CI is 0, and one dollar of
government spending increases output in the same period by one dollar: the constant-r fiscal
multiplier is 1. This is the celebrated result from Woodford (2011). Under GHH preferences, CI is
                                           1
1, and the constant-r fiscal multiplier is   . In standard parameterizations of the New Keynesian
          1
model,        equals the elasticity of substitution between varieties            p,   which is usually calibrated to
be at least 5. This implies an equally high multiplier, far outside the range of Fact 3.
    A sharp analytical result such as equation (1) cannot be obtained for general HANK models,
which must be solved numerically. We therefore set up a quantitative HANK model with prefer-
ences that can generate an arbitrary complementarity index, and demonstrate that there does not
exist any level of CI that can quantitatively reconcile Facts 1, 2 and 3. Specifically, we introduce
preferences that we call "GHH-plus". These preferences span separable, GHH, and a continuum
of cases in between, controlled by a single additional parameter   [0, 1].5 For each , we cal-
ibrate the model to hit an quarterly average MPC of 0.25, so that our model matches Fact 1 by
construction. We then calculate the average MPEs and the fiscal multipliers that result from this
parameterization. We show that there is no value of  that can also simultaneously hit Facts 2 and
3. This completes our formulation of the trilemma.
   5 Aswe discuss in section 4.1, our preference specification is related to, but different from, Bilbiie (2020), who also
introduces a specification that embeds separable and GHH as one parameter is varied.



                                                            4
      The trilemma can be solved by introducing labor market frictions into a HANK model with
separable preferences. In this paper, we do so via sticky wages, as in Auclert, Rognlie and Straub
(2018). An alternative approach might be to introduce search frictions in the labor market, as
in Gornemann, Kuester and Nakajima (2016) or Ravn and Sterk (2017).6 In all of these models,
workers are off their labor supply curves in the short run, so their effective MPEs are near 0,
consistent with Fact 2. It is then possible to simultaneously hit MPCs (Fact 1) and multipliers (Fact
3).
      A few other papers have argued that HANK models with flexible wages are difficult to rec-
oncile with the data. Broer, Hansen, Krusell and Öberg (2020) focus on the implied countercycli-
cality of profits. Nekarda and Ramey (2020) argue that the implied cyclicality of marginal costs is
rejected by the data. We add the trilemma to these voices against the flexible-wage model.7
      The organization of the paper is as follows. In section 1 we provide a review of the literature
supporting Facts 1­3. In section 2, we establish the relationship between MPCs, MPEs and the
complementarity index in a standard consumer theory model. In section 3 we establish the rela-
tionship between the complementarity index and fiscal multipliers in RANK models. Finally, in
section 4 we set up a HANK model with general preferences and show that there is no parame-
terization that can simultaneously match Facts 1­3. We provide our sticky-wage solution to the
trilemma in section 5. The appendix collects proofs, additional model details and results, and
explains our computational approach.


1     Evidence on MPCs, MPEs and multipliers
We begin by reviewing the empirical evidence that underlies Facts 1­3.


MPCs.      We define the MPC as the level of the response of spending to a one-time, unexpected
unit payment, in the period of the payment, and averaged across individuals. For example, the
unweighted quarterly MPC is the spending response in the quarter of the payment, uniformly
weighted across individuals. The literature has argued that this is a critical moment for discrim-
inating across models, and that, as such, it should be used to calibrate macroeconomic models of
consumption behavior.
      The empirical literature on MPCs is vast. Kaplan and Violante (2014) summarize this literature
and perform some of their own analysis on the 2001 US tax rebates. They find that the "collective
evidence convincingly concludes that households spend approximately 25 percent of rebates on
nondurables in the quarter that they are received." Alternative studies support similar magni-
tudes with alternative methods, and for alternative sources of income. This leads us to Fact 1:
   6 This does not work for every model with search frictions, however. If there is an elastic search effort margin or an

elastic intensive margin, MPEs can be too high to match Fact 2.
   7 Accordingly, we welcome the recent trend in the HANK literature of assuming sticky wages in addition to, or as a

substitute for, sticky prices (e.g. Hagedorn, Manovskii and Mitman 2019, Alves, Kaplan, Moll and Violante 2019).




                                                           5
the unweighted quarterly MPC is about 0.25. We will calibrate our model, which has a quarterly
frequency, to this target.
    Some of the evidence on the MPC is at an annual frequency instead. The unweighted annual
MPC in the literature is around 0.5. For example, the headline point estimate for the unweighted
annual MPC in Fagereng, Holm and Natvik (2020) is 0.52, and the unweighted annual MPC from
Jappelli and Pistaferri (2014) is 0.48.8
    There also is some evidence on heterogeneity in MPCs, consistent with the predictions of stan-
dard heterogeneous-agent models. For example, in the papers discussed above, agents that have
lower levels of liquid wealth or appear subject to financial constraints tend to have higher MPCs.


MPEs.        We define the MPE as the negative of the level of the response of earned income to a one-
time, unexpected unit payment, in the period of the payment, and averaged across individuals.
Since the best estimates of MPEs require administrative earnings data that is only available an-
nually, the MPE is often reported on an annual basis. While our definition makes the MPE the
labor-market equivalent of the MPC, we note that this is a different concept from those tradition-
ally used in the labor literature. This creates some difficulty in interpreting empirical estimates, as
we now discuss.
    One tradition in the labor literature is to define the MPE as a static object measuring how a one-
time unexpected unit payment is split between consumption and earned income. These estimates
correspond to, in our definition, MPE/(MPC + MPE)--a substantially larger number than the
MPE we have defined.9
    Another tradition is to measure the MPE out of permanent earnings changes, such as those
caused by winning an annuity when playing the lottery. Classic papers in this literature, such as
Imbens, Rubin and Sacerdote (2001), calculate the MPE as the change in earned income divided
by the flow annuity payment. Because this object ignores intertemporal considerations--in par-
ticular, the fact that transfers in other periods can cause labor supply to fall this period--it again
substantially overestimates the MPE as we define it.
    There exist few credible, direct estimates of the MPE that we are interested in. The best avail-
able evidence comes from Cesarini, Lindqvist, Notowidigdo and Östling (2017), who measure
the MPE out of small one-time lottery earnings in Sweden. Unlike most prior studies, they work
with administrative earnings data, which mitigates measurement error and concerns about small
samples and differential nonresponse. Moreover, they are able to control for the number of tickets
bought, which makes the conditional random assignment assumption much more plausible. They
report a precisely estimated MPE of 0.01, with a 95% confidence interval from 0.005 to 0.015.10
   8 While  the former use evidence from actual spending responses (to lottery earnings), the latter use answers to
hypothetical survey questions. Parker and Souleles (2019) have found that these two methods of eliciting the MPC
tend to yield similar answers.
   9 For example, Pencavel (1986) presents thirty estimates of the static MPE, which measure "the within-period division

of an additional dollar of nonlabor income between the consumption of commodities and of leisure, [taking] savings
decisions as being determined at a prior stage of the individual's allocation problem".
  10 The effect is persistent, so that the cumulative MPE is somewhat higher, at about 0.10. That cumulative number is




                                                           6
    The other widely cited paper on MPEs, which uses lottery data from Massachusetts, is Imbens
et al. (2001). As discussed above, their headline estimates, which range from 0.048 to 0.122, need to
be adjusted downwards to match our definition: they report the average "MPE" out of the yearly
payment from a 20-year annuity, while we are interested in the MPE from a one-time payment.
The ratio between these two notions of MPE is model-dependent. In a permanent income model
with no discounting and a unit interest rate, the Imbens et al. (2001) MPE would be 20 times
higher than our MPE. As a lower bound on our MPE, therefore, we divide their lowest estimate
by 20, which gives us 0.0024, or essentially zero. In a model with credit-constrained households,
however, the two definitions are closer. For this case, we use our calibrated heterogeneous-agent
model section 4, in which we calculate that the Imbens et al. (2001) MPE is 3.6 times higher than
our MPE.11 To obtain an upper bound on our MPE, we then take their highest estimate and divide
by 3.6, delivering 0.034.
    Combining this calculation with the Cesarini et al. (2017) results, and rounding up the upper
bound, we formulate Fact 2 as: the annual MPE lies between 0 and 0.04.


Fiscal multipliers. Fiscal multipliers summarize the macroeconomic impact of government spend-
ing on output. The impact fiscal multiplier is the response of GDP to a unit change in aggregate
government spending. The cumulative fiscal multiplier is the present discounted value of the re-
sponse of GDP to a unit change in the present discounted value of government spending. It is
well known in the literature that fiscal multipliers depend on the response of monetary policy.
The headline numbers we focus on to compare model and data are for a certain type of accom-
modative monetary policy that maintains constant real interest rates. As we show explicitly in
section 4.4, this type of monetary policy is less accommodative than the zero lower bound, but
more accommodative than typical Taylor rules.
    The empirical literature on fiscal multipliers is also vast. Ramey (2019) provides the most
recent comprehensive review. She concludes that "the bulk of the estimates across the leading
methods of estimation and samples lie in a surprisingly narrow range of 0.6 to 1", but that "The
evidence for higher government spending multipliers during periods in which monetary policy is
very accommodative, such as zero lower bound periods, is somewhat stronger. Recent time series
estimates for the United States and Japan suggest that multipliers could be 1.5 or higher during
those times." Ramey (2019) also makes a forceful argument that cumulative multipliers provide a
more robust description of the data than impact multipliers (see also Mountford and Uhlig 2009).
At times when policy is highly accommodative, Ramey (2011) suggests that "reasonable people"
could defend an upper bound as high as 2.0. Overall, we take this summary of the evidence to
support a range of fiscal multipliers between 0.6 to 2.0 when monetary policy is accommodative,
for both impact and cumulative multipliers. This is our Fact 3.
the counterpart of the cumulative MPC, which has been estimated to be near 1, e.g. in Fagereng et al. (2020).
  11 Specifically, we give agents in the separable heterogeneous-agent model of section 4 a 20-year annuity, and calculate

the ratio of their earnings response in the first year to the MPE out of a one-time payment, which we find to be 3.6.




                                                            7
2      The MPC-MPE relationship
We consider a heterogeneous-agent model with frictionless labor supply, as in e.g. Aiyagari and
McGrattan (1998). Households face idiosyncratic risk to their productivity e, which follows an
exogenous Markov chain. A household with current idiosyncratic productivity e and assets a at
time t, when the ex-post real interest rate is rt , the effective wage is wt (e) and transfers are Tt ,
solves

                                Vt ( a, e)   =      max U (c, n) + E[Vt+1 ( a , e )|e]
                                                    c,n, a
                                             s.t. c + a = wt (e)n + Tt + (1 + rt ) a                                (2)
                                                    a a

This model is the backbone of a recent literature that incorporates heterogeneity into the equilib-
rium analysis of monetary and fiscal policy. It nests the representative-agent case, in which e is a
constant over time and a = -.
      We allow for general U (c, n) that satisfy standard conditions: continuous second derivatives,
strict concavity, and Inada conditions that ensure an interior optimum. We will often refer to two
particular cases. First, separable preferences take the form

                                                 U ( c, n ) = u ( c ) - v ( n ).

Second, following Greenwood et al. (1988), GHH preferences take the form

                                                 U (c, n) = u(c - v(n)).

      In the solution to the dynamic programming problem (2), agents are on a first-order condition
for consumption vs. labor at all times, irrespective of whether they are currently at the borrowing
                                                                         ~  wt (e) and a multiplier
constraint. Consider an agent in state ( a, e) facing the effective wage w
of  = t ( a, e) on his budget constraint (2), and choosing the bundle (c, n) of consumption and
labor. This bundle must obey the first order conditions

                                                   Uc (c, n) =                                                      (3)
                                                               ~
                                                  Un (c, n) = -w                                                    (4)

Let c(, w           ~ ) denote the solution to the system of equation (3) and (4).12 We define three
         ~ ), n ( , w
preference parameters locally given (, w    ~ ). The elasticity of intertemporal substitution is defined
    12 Given  a solution for the multiplier t ( a, e), the agent's policy functions for consumption and savings are then
ct ( a, e) = c(t ( a, e), wt (e)) and nt ( a, e) = n(t ( a, e), wt (e))




                                                               8
in a standard way, as minus the elasticity of consumption to  at fixed wage,

                                                             ~)
                                                    log c (, w
                                          EIS  -
                                                      log 

and the Frisch elasticity of labor supply is similarly defined as the elasticity of labor to the wage
at fixed ,
                                                             ~)
                                                    log n (, w
                                         Frisch                 .
                                                      log w~
We also introduce the complementarity index, or CI for short:

                                                   ~)
                                             c ( , w                  ~)
                                                                n ( , w
                                     CI                    ~
                                                           w             .                                (5)
                                               w ~                w ~

                                                                                           ~,
This is the marginal propensity to consume out of a change in earned income in response to w
holding  fixed. The following lemma establishes some facts about CI.
                                                                                              Unc /Un
Lemma 1. For separable preferences, CI = 0. For GHH preferences, CI = 1. In general, CI =     Ucc /Uc .

   For separable preferences, CI = 0 because then  uniquely determines c in (3). But when
there is consumption-labor complementarity Unc > 0, then CI > 0: higher labor effort n, holding
Uc =  fixed, implies higher consumption c. The larger the response of c to n, the higher the
complementarity index.
   For GHH preferences, it is not an accident that CI = 1. Lemma 1 shows that in general, CI is
the ratio of the semielasticity of Un to c and the semielasticity of Uc to c. Since GHH preferences
eliminate wealth effects on labor supply, a change in c must increase Un and Uc proportionally, so
                                      ~ c is undisturbed. In other words, the two semielasticities
that the first-order condition Un = -wU
must be equal, so that their ratio CI is 1.
   Now let us return to the more standard policy functions ct ( a, e; Tt ) and nt ( a, e; Tt ), making the
dependence on the transfer Tt explicit. The marginal propensity to consume out of a transfer is

                                                     ct ( a, e; Tt )
                                           MPC 
                                                          Tt

and the marginal propensity to earn is

                                                         nt ( a, e; Tt )
                                               ~
                                         MPE  -w
                                                              Tt

With these definitions in hand, we prove the following relationship.

Proposition 1. For any individual in state ( a, e) at time t, we have

                                     MPE   ~
                                           wn   Frisch
                                         =    ·        · (1 - CI)                                         (6)
                                     MPC    c    EIS


                                                     9
      Equation (6) relates, at the individual level, the ratio of MPC and MPE to the earned-income-to-
consumption ratio and the three preference parameters EIS, Frisch and CI. Note that both MPC
and MPE are complicated objects that depend on both the idiosyncratic state ( a, e) and aggregate
state t. But equation (6) shows that MPC is a sufficient statistic for MPE, and vice versa. The
derivation of equation (6) requires only that conditions (3) and (4) be satisfied, so it characterizes
behavior in a very broad class of models with flexible labor supply.
   To understand the quantitative implications of (6), consider that in typical calibrations, Frisch
EIS, and asset and transfer income are small, so that c wn~ for most agents. This implies that for
these agents,
                                                  MPE       (1 - CI) · MPC                                         (7)

      Suppose first that preferences are separable, so that CI is 0. Equation (7) then implies that for
most agents, MPC and MPE are approximately the same. For example, constrained agents that
do not save should have an MPC of 0.5 and an MPE of 0.5. As discussed in section 1, while there
is some evidence that constrained agents have a high MPC, there is no good evidence supporting
this kind of large MPE. More generally, equation (7) shows that the average MPE and the average
MPC should be about the same. Hence, if preferences are separable, Facts 1 and 2 cannot hold
simultaneously.
      Indeed, equation (7) suggests that matching both facts requires raising the complementarity
index towards 1. For instance, taking an annual MPE of 0.04 from the upper bound of Fact 2
and an annual MPC of 0.50 from Fact 1 requires CI to be at least 1 - 0.04/0.50 = 0.92. GHH
preferences, with their CI of 1, may therefore seem like a natural solution. Next we show that
such high levels of CI create a challenge for Fact 3.


3       Consumption-labor complementarity and fiscal multipliers
In this section, we study a representative-agent model to gain insights into the relationship be-
tween CI and fiscal multipliers. While it is well known that the representative-agent model can-
not match Fact 1, and is therefore not a candidate to solve the trilemma, the analytical formula we
obtain from considering this case uncovers a force that is central in HANK models as well. Our
result from this section complements existing results by Bilbiie (2011) and Monacelli and Perotti
(2008) showing that consumption-labor complementarity can increase the fiscal multiplier in New
Keynesian models.13,14
      To specify our RANK model, we embed the model of household behavior (2) in general equi-
librium, under the assumptions of constant e = 1 and a = -. We further assume that the
representative agent faces a constant marginal tax rate on labor earnings of  w , so that its post-
tax-and-transfer labor earnings are (1 -  w )wt nt + Tt . For simplicity, we write the model under
    13 In   contrast, complementarity generally decreases the multiplier in flexible-price models.
    14 Bilbiie (2009) and Eusepi and Preston (2015) also stress the importance of complementarities between consumption

and labor for the aggregate effects of government spending.



                                                               10
perfect foresight, except for an unexpected shock at t = 0, and we drop expectations whenever
there is no ambiguity.
      The behavior of the representative household can be summarized by the Euler equation

                                                            e
                                      Uc (ct , nt ) = (1 + rt )Uc (ct+1 , nt+1 ),                                     (8)

       e denotes the ex ante real interest rate that agents expect to hold between periods t and t +
where rt
1, and the labor supply equation, obtained by combining the intratemporal optimality conditions
                                 ~ = (1 -  w ) w:
(3) and (4) and recognizing that w

                                                                   Un (ct , nt )
                                            (1 -  w ) w t = -                    .                                    (9)
                                                                   Uc (ct , nt )

Aggregate consumption and labor are simply Ct = ct and Nt = nt .
      On the supply side, the model has a textbook New Keynesian structure. The final good is
produced competitively as a CES aggregate of a continuum of intermediate goods with elasticity
 p.   Each intermediate good is produced by a monopolist using labor, according to a production
function f ( Nt ). These monopolists set their prices subject to isoelastic demand from the final good
producer and quadratic (Rotemberg 1982) price adjustment costs. Their objective is to maximize
                                                                            e . Since all monopolists
the present value of profits, discounted at the ex-ante real interest rate rt
face the same profit maximization problem, there exists an equilibrium in which they choose the
same price and produce the same quantity. This symmetric equilibrium is characterized by an
aggregate production function
                                                      Yt = f ( Nt )                                                  (10)

and a New Keynesian Phillips curve15

                                              wt          p   -1            1 Yt+1
                    log(1 + t ) =  p                 -                +        e Y log(1 + t+1 ).                    (11)
                                            f ( Nt )          p           1 + rt  t

      The combination of a labor tax and the monopoly power of intermediate goods producers
leads, in general, to a non-zero labor wedge, which we define as16

                                                       Un (Ct , Nt ) 1
                                            t  1 +                            .                                      (12)
                                                       Uc (Ct , Nt ) f ( Nt )
and which is strictly less than 1 under standard assumptions Un < 0, Uc > 0, and f > 0.
      The fiscal authority purchases an exogenous amount Gt of the final good in every period,
financed by lump-sum taxes at the margin. Since the model is Ricardian, the timing of these
lump-sum taxes is irrelevant. We assume that the monetary authority sets the real rate directly,
  15 As is well known, to first order, this Phillips curve is equivalent to the more common specification with Calvo
pricing and discounting with the household's stochastic discount factor Uc,t+1 /Uc,t .
  16 A welfare-maximizing planner choosing allocations would set -U /U
                                                                         n,t   n,c = f ( Nt )--that is, a zero labor wedge
(Chari, Kehoe and McGrattan 2007).



                                                              11
as in Woodford (2011), and that the economy reverts to steady state once all shocks are past.17
Market clearing requires that

                                                            p
                                       Yt = Ct + Gt +           log(1 + t )2 Yt .                    (13)
                                                          2 p

   Given perfect foresight after date 0, the model delivers a mapping between a sequence of
government spending { Gt }t0 and a path of output {Yt }t0 . The next proposition characterizes
the derivatives of this mapping--in other words, the model's fiscal multipliers.
Proposition 2. Assume that monetary policy sets a constant real rate r. The marginal effect of a time-s
government spending shock on time-t output is given by

                                            dYt         1
                                                =               · 1s=t .                             (14)
                                            dGs   1 - (1 -  )CI

   Proposition 2 shows that fiscal multipliers in this case are static (output only responds in the
period in which the government spends) and depend only on the steady-state labor wedge  and
complementarity index CI. In the special case of separable preferences (CI = 0), the multiplier is 1,
as in Woodford (2011). By contrast, in the special case of GHH preferences (CI = 1), the multiplier
is 1/ . More generally, since  < 1, the multiplier is increasing in CI whenever it is positive.
   Bilbiie (2011) previously derived an equivalent expression for the multiplier (14) under con-
stant r and general preferences, which he stated using a certain set of elasticities of marginal utility
and production (see his proposition 3). Our contribution is to instead write the fiscal multiplier in
terms of  and CI, clarifying that it is governed by the interaction between these two steady-state
parameters.
   Intuitively, (14) can be understood as follows. Increasing output by dY = dG on the margin
requires adding dN = (1/ f ( N ))dY labor. By definition of CI, this increase in labor, when real
interest rates and therefore marginal utility  are held constant, increases consumption demand
by dC = CI wdN~                              ~ equals -Un /Uc by (9), this increase in consumption
                  . Since the after-tax wage w
demand is also equal to
                                                  Un 1
                                    dC = - CI                dY = CI(1 -  )dY ,
                                                  Uc f ( N )
applying the definition of  . That is, satisfying demand dG from the government increases de-
mand from households by CI(1 -  )dG in general equilibrium. This additional demand leads
to a "second-round effect" of CI2 (1 -  )2 dG, and so on. The process converges to the multiplier
1 + CI(1 -  ) + CI2 (1 -  )2 + · · · = (1 - (1 -  ) CI)-1 .
   This argument is general, and only requires the definitions of CI and  in terms of preferences
and technology. In the model we have specified, however, the steady-state labor wedge  takes
the more specific form
                                                                    p   -1
                                              = 1 - (1 -  w )                .                       (15)
                                                                        p
 17 This   delivers determinacy in the representative-agent model with constant-r monetary policy.


                                                          12
Equation (15) shows the forces that shape the magnitude of the steady-state labor wedge in most
                                                                p -1
New Keynesian models: the monopolistic distortion                p
                                                                       , and distortive taxation  w --which
could be on either the employee side (as in this model), or on the firm side.
      Recall that, in the case of GHH preferences, the fiscal multiplier is 1/ . In typical calibrations,
this will be a large number, because      p   is calibrated to be high and  w is calibrated to be low. For
instance, Nakamura and Steinsson (2014) report a constant-r multiplier of 7.00 under GHH pref-
erences, reflecting their calibration choice of   = 7 and  w = 0. Another typical calibration choice
                                                    p
is to obtain an efficient steady state by offsetting monopolistic distortions with an employment
subsidy of  w = -1/( p - 1). This yields  = 0 and a locally infinite multiplier. Clearly, none of
these calibration choices can be reconciled with Fact 3.
     More generally, equations (14) and (15) show why there is a tension in matching Facts 1, 2 and 3
jointly. The back-of-the-envelope calculation from section 2 suggested that CI  0.92 is necessary
to match Facts 1 and 2. Meanwhile, equation (14) shows that to match Fact 3 with a multiplier
below 2 in a RANK model, we need CI to be lower than 1-      1/2    0.5
                                                            1-  = 1-  .
     Even with conservative choices for a labor income tax of  w = 0.33 (as in our model below) and
  = 7, equation (15) then requires CI  0.88. And this bound is only likely to tighten as we move
to flexible-labor HANK models--whose high MPCs tend to create higher multipliers--suggesting
that these models will be unable to solve the trilemma. The next section verifies quantitatively
that, indeed, no such solution exists.


4      The trilemma for HANK models
HANK models are famed for delivering Fact 1. One might hope that it is possible to parameterize
these models to match Facts 2 and 3 as well. In this section, we demonstrate that this is not the
case. In other words, we show that the trilemma has no solution in the space of New Keynesian
models with a frictionless labor market.
      To do this, we proceed as follows: we set up and calibrate a model that always features an
average quarterly MPC of 0.25, thereby matching Fact 1 by construction. By varying the degree of
complementarity in preferences, we then assess the quantitative tradeoff between matching Fact
2 and Fact 3. We show that it is impossible to match both.


4.1     HANK with GHH-plus preferences

Here we set up and parameterize our HANK model with flexible labor supply and an arbitrary
degree of consumption-labor complementarity in preferences.


Households.       Households solve the dynamic problem introduced in equation (2). Since we are
solving the model numerically, we must now specify a functional form. We consider a flexible




                                                        13
felicity function with the following form:

                                                                     1- 
                                           1             n 1+                           n 1+ 
                             U ( c, n ) =           c -                    -  (1 -  )                                (16)
                                          1-             1+                             1+

We call these "GHH-plus preferences", since they nest isoelastic separable preferences (when  =
0) and GHH preferences (when  = 1). This choice is certainly not the only possible functional
form for U (c, n) with this property (see, for instance, Bilbiie 2020). But it has two additional
properties that make it ideal for our purposes. First, it is convenient for computation: as we show
in appendix D, Uc can be inverted to provide analytical expressions for c and n, which means
that Carroll (2006)'s method of endogenous gridpoints can be applied. Second, as we show in
appendix A.4, it delivers a simple expression for CI:

                                                        Uc (e, a)
                                        CI(e, a) =                     [0, 1].                                       (17)
                                                     Uc (e, a) + 1 - 

Equation (17) shows that CI is effectively parameterized by , with CI = 0 for separable prefer-
ences and CI = 1 for GHH, as expected. In intermediate cases, CI is increasing in  but varies
across households according to their marginal utilities of consumption.
    Next, we follow the specification of the tax system in Auclert and Rognlie (2020) and let the
effective wage and transfers be given by

                                                                 g
                                           wt (e) = (1 - t )(1 - )wt e,                                              (18)
                                                               g
                                               Tt =      (1 - t )wt Nt .                                             (19)

                                                                                                        g
    Here,   [0, 1] governs the progressivity of the tax-and-transfer system, and t is the overall
tax rate on income. We calibrate both  and  g to the data. This is important for two purposes.
First, the literature has shown that the marginal incidence of taxes that the government levies to
pay for its spending has a significant effect on fiscal multipliers in HANK models (e.g. Auclert et
al. 2018, Hagedorn et al. 2019). For this marginal incidence to be realistic, we need an empirically
plausible degree of tax progressivity. Second, as we showed in section 3, a positive marginal tax
rate on labor increases the labor wedge, which in turn (at least in a representative agent model)
is an important determinant of the fiscal multiplier whenever CI > 0. We therefore want to make
sure that our results involve a plausible labor wedge.18


Asset markets.          This economy has two assets in positive net supply: public debt in the form
of one-period real bonds, and equity in intermediate goods firms. Since we assume certainty
equivalence at the aggregate level, financial market equilibrium requires that these two assets
offer the same return ex ante. Let pt be the ex-dividend price of equity, and dt be dividends. Then
  18 With   our tax system, the marginal tax rate on overall labor income in the steady state is  w = 1 - (1 -  g )(1 - ),
                                                                        p -1
and the labor wedge for every individual is  = 1 - (1 -  g )(1 - )         p
                                                                               .


                                                            14
we have
                                            e            d t +1 + p t +1
                                       1 + rt = Et                                                          (20)
                                                                pt
                         e denotes the real interest rate that agents expect to prevail between time
where, as in section 3, rt
t and time t + 1. Along perfect-foresight paths, the ex-post real interest rate rt that enters agents'
                                              e . However, an unexpected aggregate shock at
budget constraints in (2) is always equal to rt -1
                                                  e . Assuming that all households hold the same
t = 0 may result in capital gains and imply r0 = r- 1
portfolio of bonds and equity, each of them experiences the same ex-post interest rate, equal to a
weighted average of the realized return on equity and bonds:

                                      p t -1 dt + pt      Bt-1            e
                       1 + rt =                      +             (1 + r t -1 )                            (21)
                                  pt-1 + Bt-1 pt-1     pt-1 + Bt-1
                                   equity share                     bond share


where the last term in equation (21) reflects the fact that the return on government bonds at time
                      e , since these are one-period real bonds.
t is always equal to rt -1


Supply side. The supply side is the same as in section 3: the final good is produced competitively
as a CES aggregate of intermediate goods with elasticity                   p,   and intermediate goods firms are
monopolistically competitive with Rotemberg pricing.
   We parameterize the production function for intermediate goods as:

                                             f ( Nt ) = ZNt - F.                                            (22)

The fixed cost F allows us to target firms' steady-state net profits, and therefore the value of their
equity, independently of the elasticity      p.   This is useful because the two play different roles in the
model. The elasticity affects the value of the labor wedge and therefore the fiscal multiplier. Firm
equity is important because it is an asset held by households and therefore determines the overall
degree of liquidity in the economy, which in turn is a key determinant of MPCs.
   Aggregate firm dividends are then

                                                             p
                                  dt = Yt - wt Nt -              log(1 + t )2 Yt                            (23)
                                                         2

where the last term is the price adjustment cost. By equation (20), the value of firms pt is the
present discounted value of their future dividends.


Government policy.     The government purchases an exogenous amount of final goods Gt , runs
the tax-and-transfer system, and issues one-period real debt Bt . Its overall budget constraint in
period t is given by
                                         g             e
                                  Bt + t wt Nt = (1 + rt -1 ) Bt-1 + Gt .                                   (24)



                                                        15
      Following Auclert et al. (2018), we assume that the government follows a fiscal rule such that
increases in spending relative to steady state are initially financed using increases in debt, which
are then paid back at a rate of 1 -  B each period,

                                    Bt - Bss =  B ( Bt-1 - Bss + Gt - Gss )                        (25)

where we call  B  [0, 1) the "persistence" of debt, and a balanced-budget rule corresponds to
                                                                                  g
 B = 0. Given (25), the government adjusts the labor income tax rate t so that (24) is satisfied at
all times.
                                                                       e  r . We show explicitly in
      Just as in section 3, we specify the monetary policy rule to be rt   ss
section 4.4 that this represents a moderate degree of accommodation, in between the zero lower
bound and an active Taylor rule.
      Finally, goods market clearing requires that

                                                          p
                                     Yt = Ct + Gt +           log(1 + t )2 Yt .                    (26)
                                                       2 p

By Walras's law, this is equivalent to asset market clearing Bt + pt = At .


4.2     Calibration

As discussed at the top of this section, our goal is to assess the tradeoff between matching Fact
2 and Fact 3, conditional on matching Fact 1. Our calibration therefore varies  holding other
key moments constant, including a quarterly average MPC of 0.25. It is well known that HANK
models with a plausible supply of total assets cannot generate such large MPCs without additional
features, such as illiquid assets or discount factor heterogeneity. We follow the latter route and
use a simple form of permanent discount factor heterogeneity: we assume that one half of the
population has discount factor  1 and one half of the population has discount factor  2 <  1 , and
use (  1 ,  2 ) to jointly achieve our targets for the average MPC and the real interest rate r.
      The model period is one quarter. For the most part, our calibration follows McKay et al. (2016),
a prominent example of a HANK model with a canonical supply side, sticky prices, and flexible
wages. We set the real interest rate r to an annualized value of 2% and the Frisch elasticity 1/ to
0.5. The elasticity of intertemporal substitution (EIS) varies across individuals, and we calibrate
 to target an average EIS of 0.5.19 We choose the disutility of labor  to normalize effective
aggregate labor to 1, and aggregate labor productivity Z to normalize aggregate output to 1.
      We assume that idiosyncratic labor productivity e follows an AR(1) process with a persistence
of 0.966 as in McKay et al. (2016) and calibrate the variance of innovations to match the standard
deviation of log gross earnings of 0.92 documented by Song, Price, Guvenen, Bloom and von
Wachter (2019). We discretize the labor productivity process as a 25-point Markov chain. As in
Auclert and Rognlie (2020), we set the ratio of bonds to annual GDP to 0.55, the steady-state labor
 19 Appendix   A.4 shows how to calculate the EIS for GHH-plus preferences.



                                                        16
                                 Table 1: Fixed and calibrated parameters

               parameter       name                                           value/target
               1/              Frisch elasticity                                    0.5
               e               persistence of income process                       0.966
               g               income tax level                                    0.191
                               income tax progressivity                            0.177
                 p             elasticity of substitution                            7
               p               NKPC slope                                          0.002
               B               government bonds                                  0.55 · 4Y
               B               persistence of public debt                           0.9
               a               borrowing constraint                                  0
               1               upper discount factor                         r = 0.02/4
               2               lower discount factor                        MPC = 0.25
               1/              Uc curvature                               average EIS = 0.5
                               disutility of labor                             N=1
               Z               aggregate labor productivity                    Y=1
               e               std of income shocks                     Var log(ni ei ) = 0.922
               F               fixed cost                                   p = 0.85 · 4Y
               The upper panel lists directly calibrated parameters. The lower panel lists parameters
               calibrated to match some target, whose values will depend on the choice of .
               Separable preferences: (  1 ,  2 ) = (0.978, 0.923). GHH: (  1 ,  2 ) = (0.987, 0.970).


tax to  g = 0.191, and the progressivity parameter to  = 0.177. This provides a fit comparable
to the loglinear retention function of Heathcote, Storesletten and Violante (2017), but is slightly
more convenient for our purposes because the marginal tax rate of agents is constant and equal
to (1 -  g )(1 - ). Together with a standard value for the elasticity of substitution,       = 7, these  p
choices imply a steady-state labor wedge of  = 0.43, as in our back-of-the-envelope calculations
from section 3.
    Following McKay et al. (2016), we set the ratio of liquid assets to annual GDP to 1.4. In our
model, this includes the value of firm equity as well as government bonds, and we calibrate the
fixed cost F so that firm equity equals assets minus bonds, which is 0.85 times annual GDP. To-
gether with the fiscal rule, these assumptions imply G = 0.177. We assume that households cannot
borrow, a = 0. Finally, we set the slope of the Phillips curve to  p = 0.002. This low value is irrele-
vant for our fiscal multiplier results under constant r, since it only affects the dynamics of inflation.
We set it to avoid the explosively large multipliers with more flexible prices when nominal rates
are constant (the so-called "paradox of flexibility"), which would only exacerbate the trilemma.
    Table 1 summarizes our calibration. The upper panel contains the parameters we hold fixed,
and the lower panel shows the parameters that we calibrate internally. Appendix D discusses our
solution procedure.




                                                         17
                                   Impact Multiplier                                                       Cumulative Multiplier
                      5                           sticky price, all                            10                        sticky price, all
                                                                                                       GHH
                             GHH                  sticky wage, sep                                                       sticky wage, sep
                      4                                                                         8
  fiscal multiplier




                                                                           fiscal multiplier
                      3                                                                         6

                      2                                                                         4

                      1                                                                         2
                                                         separable
                                                                                                                                  separable
                      0                                                                         0
                          0.00   0.05      0.10   0.15       0.20                                   0.00   0.05     0.10   0.15      0.20
                                         Annual MPE                                                               Annual MPE


                                        Figure 2: The tradeoff between fiscal multipliers and MPEs


4.3                   The MPE-multiplier dilemma

Figure 2 presents our main quantitative result. The figure summarizes the model's performance
in matching average annual MPEs (Fact 2) and fiscal multipliers (Fact 3) for the full range of
possible values of the complementarity index. Each blue circle corresponds to the outcomes of
a model with a different value of   [0, 1]. Recall that each of these models is calibrated to a
quarterly MPC of 0.25, so by construction each of these circles matches Fact 1. The x axis plots the
annual MPE, evaluating the quantitative ability of the model to match Fact 2. The y axis plots two
measures of the fiscal multiplier, evaluating the quantitative ability of the model to match Fact 3.
The green rectangle shows the range of values that are acceptable according to our facts. Clearly,
none of the models gets close quantitatively, at least if we judge using cumulative multipliers on
the right panel: models that have plausible values for the MPE have far too large fiscal multipliers,
and vice versa. It takes high complementarity to match Fact 2, but low complementarity to match
Fact 3. This is the trilemma for New Keynesian models. We now provide more detailed context
for this conclusion, and discuss how it relates to proposition 1 and proposition 2.
              The x-axis in both panels of figure 2 shows the average annual MPE generated by the model.20
The leftmost point corresponds to  = CI = 1 (GHH preferences), and  then declines as we move
to the right, with the rightmost point corresponding to separable preferences ( = CI = 0). The
magnitudes on this axis reflect the aggregate implications of proposition 1. Recall that the Frisch
elasticity and the average EIS are calibrated to be the same number. While agents have different
ratios of earned income to consumption, the average ratio is (1 -  g )(1 - )W N /C = 0.66/0.82 =
0.80. We therefore expect the quarterly MPE to be roughly 0.80 × (1 - CI) × 0.25 = (1 - CI) × 0.20.
Indeed, the quarterly MPE for the separable model is close to this value, though slightly lower at
  20 Thisis computed as the (negative of) the sum of the responses of earned income in the first four quarters to a
one-time unit lump-sum transfer to all agents in quarter 0.


                                                                      18
0.16, and the annual MPE is 0.23, far outside the acceptable range from Fact 2.21 Only high values
of , near GHH, fall inside the acceptable range: it takes high complementarity to match Fact 2.
      The y-axis shows the fiscal multiplier in response to an AR(1) shock to government spend-
ing with a persistence of 0.7, as in Auclert et al. (2018). On the left panel, we plot the impact
                                                                                                       t (1+r )-t dYt
multiplier dY0 /dG0 . On the right panel, we plot cumulative multipliers, defined as                   t (1+r )-t dGt
                                                                                                                      .
Figure 3 shows the impulse responses of consumption corresponding to each of these points. As
in the representative-agent case of proposition 2, the multiplier is rising in CI, but now high MPCs
provide further amplification, especially when measured cumulatively (Auclert et al. 2018). For
instance, under GHH preferences, proposition 2 implies a constant-r multiplier of 1/ = 2.32,
both on impact and cumulatively, but here the cumulative multiplier is almost 10. Only low val-
ues of , near separable, fall inside the acceptable range: it takes low complementarity to match
Fact 3.22
      The calibration with  = 0.6 features an annual MPE of 0.04 and an impact fiscal multiplier of
2.03. This is just at the boundary of the acceptable range. However, it also features a cumulative
fiscal multiplier of 3.57, far outside the acceptable range. In brief, there is no sticky-price, flexible-
wage model that can solve the trilemma.


4.4     Alternative monetary and fiscal policies

In this section, we consider alternative monetary and fiscal policies. Since none of these policies
will change the calibrated steady state, MPCs and MPEs are unaffected, and we focus on fiscal
multipliers.
      The left panel of table 2 displays cumulative fiscal multipliers for different levels of comple-
mentarity   {0, 1/2, 1} under three monetary policy rules: an active Taylor rule it = r + t
with a coefficient on inflation of  = 1.25, our benchmark with constant r, and a simulation with
constant nominal interest rates for 3 years, followed by reversion to an active Taylor rule. Relative
to constant r, an active Taylor rule pushes down the multiplier, bringing it closer to its flexible-
price level, which is 0 for GHH and less than 1 for separable preferences. With constant nominal
interest rates, on the other hand, the multiplier increases even further, consistent with Christiano,
Eichenbaum and Rebelo (2011). This form of accommodative policy therefore makes the trilemma
even worse. Constant r, meanwhile, is the intermediate case--neither active nor highly accom-
modative.
      The right panel of table 2 displays cumulative fiscal multipliers under three fiscal policy rules:
balanced budget with  B = 0, our baseline with  B = 0.9, and very persistent debt  B = 0.95. The
table shows an intriguing property of the sticky price model: in contrast to typical HANK models
  21 The  representative-agent calculation 0.20 overstates the quarterly MPE when CI = 0 because of the negative co-
variance between MPCs and earned income that the model generates. The annual MPE is only around 50% higher than
the quarterly MPE because there is a large share of impatient agents at or very close to their borrowing constraint.
  22 For the separable sticky-price case, the impact (though not the cumulative) multiplier is slightly lower in HANK

than RANK, due to peculiar distributional forces discussed in appendix E. In general, we have found that these forces
make the separable calibration somewhat fragile.



                                                         19
         Table 2: Cumulative Fiscal Multipliers with Alternative Monetary and Fiscal Policies

                                       Monetary                                         Fiscal
                        Taylor rule    constant-r     3-year peg      B = 0           B = 0.9          B = 0.95
         Separable         1.09           1.26            3.19        1.26             1.26              1.26
          = 0.5            2.44           3.15            4.27        3.15             3.15              3.15
         GHH               6.76           9.60           13.25        9.60             9.60              9.60
         Sticky Wage        1.11           1.15           1.24          0.92            1.15             1.57


(Auclert et al. 2018), the timing of fiscal deficits is irrelevant for the multiplier. As we establish
formally in appendix B.1, this reflects an unusual form of "Ricardian equivalence", which is due
to the interaction of our tax system with tradable firm equity: both the path of after-tax wages
         g                                                                                                        g
(1 - t )(1 - )wt and the total value of assets are unaffected to first order by the path of t that
the government uses to finance its spending. Given that there is some empirical evidence that
deficit financing tends to raise the fiscal multiplier, this provides another argument against the
sticky-price, flexible-wage model. It also implies that conditional on spending, no path for bond
financing can ever lower the multiplier and solve the trilemma.


5      A solution to the trilemma
To solve the trilemma, we propose to push workers off their labor supply curves in the short
run, imposing nominal wage stickiness and demand-determined labor in the spirit of Erceg, Hen-
derson and Levin (2000). This does not avoid the problem of high multipliers when CI is high:
indeed, as appendix A.3 makes clear, the multiplier result in proposition 2 is identical under sticky
wages.23 It does, however, imply that MPE = 0, which allows us to choose low CI and obtain mul-
tipliers consistent with Fact 3 without contradicting Fact 2. For simplicity, in our calibration we
will choose separable preferences, CI = 0.


5.1     Model setup

We introduce sticky wages by borrowing the microfoundation of the wage Phillips curve from
Auclert et al. (2018), and adapting it to the tax system in (18)­(19).24 Households solve a version
of the problem in (2), but they now take their hours n as given. This makes their MPE equal to 0
by construction, and the model is therefore immediately consistent with Fact 2.
      Aggregate hours are determined by a labor union, who sets wages on behalf of households
subject to satisfying the aggregate demand for labor from final goods firms. In appendix B.2, we
                                                     nc /Un
         only difference is that we must use CI = U
    23 The
                                                    Ucc /Uc from lemma 1 to define CI directly in terms of utility, since
definition (5) no longer makes sense when workers are not on their labor supply curves. This CI can be interpreted as
the MPC out of earnings from demand-determined labor, divided by the wage markdown.
  24 The tax code affects marginal incentives to work, and therefore the wage-setting problem of labor unions.




                                                           20
show that the maximization problem of these unions yields a wage Phillips curve of

                    w                                                            w   -1
            log(1 + t ) = w Nt UN (Ct , Nt ) - wt Nt (1 - t )(1 - )                            
                                                                                          UC (Ct , Nt )
                                                                                     w                          (27)
                                               w
                                  +    log(1 + t +1 ),

      w denotes nominal wage inflation, U (C  , N  ) is the average marginal disutility of la-
where t                                  N  t    t
              , N  ) is the productivity-weighted average marginal utility of consumption. In the
bor and UC (Ct   t
representative-agent counterpart of the model, these are simply the UN and UC of the representa-
tive agent, and therefore (27) coincides with the formulation in Erceg et al. (2000).
      We assume that prices are flexible ( p = ), so that intermediate goods producers always
                                                                                            p -1
charge their desired markup. Hence, the real wage is constant at wt = Z                       p
                                                                                                   , and price and
                         w =  . Finally, since wage adjustment incurs a cost in terms of utils and
wage inflation coincide, t   t
not goods, goods market clearing becomes simply Yt = Ct + Gt . This completes the formulation
of the sticky-wage model.


5.2     Results

We calibrate the model as in section 4.2. We assume separable preferences ( = 0), and calibrate
the model to deliver Fact 1. Figure 2 shows that the model can then deliver Facts 2 and 3 simul-
taneously. The MPE is 0 by construction. The impact fiscal multiplier is 1.24 and the cumulative
fiscal multiplier is 1.15, well within the range of Fact 3. The red line of figure 3 shows that the
impulse responses of private consumption feature a moderate degree of crowding in for about 20
quarters.
      Table 2 shows that the sticky wage model is also well-behaved with respect to alternative
assumptions about monetary and fiscal policy. Alternative monetary rules affect the multiplier
moderately. Alternative fiscal policy rules affect the multiplier to a greater extent, with more back-
loaded fiscal policy generating larger fiscal multipliers. Under all of these assumptions, however,
multipliers remain within the range allowed by Fact 3. Hence, the sticky wage model provides a
solution to the trilemma.
      There are other reasons to prefer the sticky-wage, flexible-price model to its sticky-price, flexible-
wage counterpart. First, as appendix figure 4 shows, the equity price is mildly procyclical instead
of strongly countercyclical.25 This gives the model a chance of fitting both the cyclicality of the
price-cost margin (e.g. Nekarda and Ramey 2020) and the response of equity prices to govern-
ment spending shocks. It also avoids the large redistribution effects associated with firm owner-
ship, which Broer et al. (2020) show to be problematic, and which drive peculiar heterogeneity in
impulse responses in our own flexible-wage model, as appendix E discusses in detail.
  25 To obtain a simple benchmark HANK model, one can dispense with intermediate goods-producing sector and thus

economy-wide profits altogether. This simplifies the asset structure of the economy without affecting the dynamics of
the model much.




                                                         21
                                            Government Spending                                          Consumption
                          1.0
                                                                                                                        sticky price, sep
                                                                                     3
                                                                                                                        sticky price, GHH
                          0.8
    % of steady state Y




                                                                                                                        sticky wage, sep
                          0.6                                                        2

                          0.4
                                                                                     1
                          0.2

                          0.0                                                        0
                                0      10      20     30       40     50      60         0      10      20     30        40     50         60
                                                    quarters                                                 quarters


                                    Figure 3: Government Spending and the Response of Private Consumption
                          Each blue line corresponds to a different value of CI, going from  = 0 (light) to  = 1 (dark) in steps of 0.1.


6                         Conclusion
New Keynesian models with flexible wages and sticky prices face a trilemma: they cannot simul-
taneously match high MPCs, low MPEs, and fiscal multipliers that are moderate under accom-
modative monetary policy. Our proposed solution is to take workers off their short-run labor
supply curves. This directly implies low MPEs, allowing us to use separable preferences, which
can then match high MPCs and moderate fiscal multipliers. We achieve this with sticky wages
in a HANK model. Although we keep this model intentionally simple, it could be extended with
common quantitative features like sticky prices and investment and still solve the trilemma. An
alternative route might be to add search frictions, as in Gornemann et al. (2016) and Ravn and
Sterk (2017).
                    While there is no good way to solve the trilemma without adding labor market frictions,
some calibrations come closer than others. Preferences with an intermediate degree of labor-
consumption complementarity, between separable and GHH, achieve the best tradeoff of MPEs
and multipliers. For preferences with complementarity, a high labor wedge can also bring the
multiplier down to a more reasonable level, and in these cases we suggest that researchers report
the labor wedge. Finally, if monetary policy is active (with a high Taylor rule coefficient), rather
than accommodative as in fact 3, the model's predictions are closer to neoclassical. This sidesteps
the trilemma, but only as long as active policy is in force.




                                                                               22
References
Aguiar, Mark and Erik Hurst, "Deconstructing Life Cycle Expenditure," Journal of Political Econ-
  omy, June 2013, 121 (3), 437­492.

Aiyagari, S. Rao and Ellen R. McGrattan, "The Optimum Quantity of Debt," Journal of Monetary
  Economics, October 1998, 42 (3), 447­469.

Alves, Felipe, Greg Kaplan, Benjamin Moll, and Gianluca Violante, "A Further Look at the
  Propagation of Monetary Policy Shocks in HANK," Manuscript, 2019.

Auclert, Adrien, "Monetary Policy and the Redistribution Channel," American Economic Review,
  June 2019, 109 (6), 2333­2367.

  and Matthew Rognlie, "Inequality and Aggregate Demand," Working Paper, January 2020.

  , Bence Bardóczy, Matthew Rognlie, and Ludwig Straub, "Using the Sequence-Space Jacobian
  to Solve and Estimate Heterogeneous-Agent Models," Working Paper 26123, National Bureau
  of Economic Research, July 2019.

  , Matthew Rognlie, and Ludwig Straub, "The Intertemporal Keynesian Cross," Working Paper
  25020, National Bureau of Economic Research, September 2018.

Bayer, Christian, Ralph Luetticke, Lien Pham-Dao, and Volker Tjaden, "Precautionary Savings,
  Illiquid Assets, and the Aggregate Consequences of Shocks to Household Income Risk," Econo-
  metrica, 2019, 87 (1), 255­290.

Berger, David, Veronica Guerrieri, Guido Lorenzoni, and Joseph Vavra, "House Prices and Con-
  sumer Spending," Review of Economic Studies, July 2018, 85 (3), 1502­1542.

Bilbiie, Florin O., "Nonseparable Preferences, Fiscal Policy Puzzles, and Inferior Goods," Journal
  of Money, Credit and Banking, 2009, 41 (2-3), 443­450.

  , "Nonseparable Preferences, Frisch Labor Supply, and the Consumption Multiplier of Govern-
  ment Spending: One Solution to a Fiscal Policy Puzzle," Journal of Money, Credit and Banking,
  February 2011, 43 (1), 221­251.

  , "A GHH-CRRA Utility for Macro: Complementarity, Income, and Substitution," Manuscript,
  April 2020.

Broer, Tobias, Niels-Jakob Harbo Hansen, Per Krusell, and Erik Öberg, "The New Keynesian
  Transmission Mechanism: A Heterogeneous-Agent Perspective," Review of Economic Studies,
  January 2020, 87 (1), 77­101.

Carroll, Christopher D., "The Method of Endogenous Gridpoints for Solving Dynamic Stochastic
  Optimization Problems," Economics Letters, 2006, 91 (3), 312­320.

                                                 23
Cesarini, David, Erik Lindqvist, Matthew J. Notowidigdo, and Robert Östling, "The Effect of
  Wealth on Individual and Household Labor Supply: Evidence from Swedish Lotteries," Ameri-
  can Economic Review, December 2017, 107 (12), 3917­3946.

Chari, V. V., Patrick J. Kehoe, and Ellen R. McGrattan, "Business Cycle Accounting," Economet-
  rica, May 2007, 75 (3), 781­836.

Christiano, Lawrence, Martin Eichenbaum, and Sergio Rebelo, "When Is the Government
  Spending Multiplier Large?," Journal of Political Economy, February 2011, 119 (1), 78­121.

Erceg, Christopher J., Dale W. Henderson, and Andrew T. Levin, "Optimal Monetary Policy
  with Staggered Wage and Price Contracts," Journal of Monetary Economics, October 2000, 46 (2),
  281­313.

Eusepi, Stefano and Bruce Preston, "Consumption Heterogeneity, Employment Dynamics and
  Macroeconomic Co-Movement," Journal of Monetary Economics, April 2015, 71, 13­32.

Fagereng, Andreas, Martin B. Holm, and Gisle J. Natvik, "MPC Heterogeneity and Household
  Balance Sheets," Manuscript, March 2020.

Galí, Jordi, J. David López-Salido, and Javier Vallés, "Understanding the Effects of Government
  Spending on Consumption," Journal of the European Economic Association, 2007, 5 (1), 227­270.

Gornemann, Nils, Keith Kuester, and Makoto Nakajima, "Doves for the Rich, Hawks for the
  Poor? Distributional Consequences of Monetary Policy," Manuscript, April 2016.

Greenwood, Jeremy, Zvi Hercowitz, and Gregory W. Huffman, "Investment, Capacity Utiliza-
  tion, and the Real Business Cycle," American Economic Review, June 1988, 78 (3), 402­417.

Hagedorn, Marcus, Iourii Manovskii, and Kurt Mitman, "The Fiscal Multiplier," Working Paper
  25571, National Bureau of Economic Research, February 2019.

Heathcote, Jonathan, Kjetil Storesletten, and Giovanni L. Violante, "Optimal Tax Progressivity:
  An Analytical Framework," Quarterly Journal of Economics, 2017, 132 (4), 1693­1754.

Imbens, Guido W., Donald B. Rubin, and Bruce I. Sacerdote, "Estimating the Effect of Unearned
  Income on Labor Earnings, Savings, and Consumption: Evidence from a Survey of Lottery
  Players," American Economic Review, September 2001, 91 (4), 778­794.

Jappelli, Tullio and Luigi Pistaferri, "Fiscal Policy and MPC Heterogeneity," American Economic
  Journal: Macroeconomics, October 2014, 6 (4), 107­136.

Kaplan, Greg and Giovanni L. Violante, "A Model of the Consumption Response to Fiscal Stim-
  ulus Payments," Econometrica, July 2014, 82 (4), 1199­1239.

  , Benjamin Moll, and Giovanni L. Violante, "Monetary Policy According to HANK," American
  Economic Review, March 2018, 108 (3), 697­743.

                                                24
McKay, Alisdair, Emi Nakamura, and Jón Steinsson, "The Power of Forward Guidance Revis-
  ited," American Economic Review, October 2016, 106 (10), 3133­3158.

Monacelli, Tommaso and Roberto Perotti, "Fiscal Policy, Wealth Effects, and Markups," Working
  Paper 14584, National Bureau of Economic Research, December 2008.

Mountford, Andrew and Harald Uhlig, "What Are the Effects of Fiscal Policy Shocks?," Journal
  of Applied Econometrics, 2009, 24 (6), 960­992.

Nakamura, Emi and Jón Steinsson, "Fiscal Stimulus in a Monetary Union: Evidence from US
  Regions," American Economic Review, March 2014, 104 (3), 753­792.

Nekarda, Christopher J. and Valerie A. Ramey, "The Cyclical Behavior of the Price-Cost
  Markup," Manuscript, March 2020.

Parker, Jonathan A. and Nicholas S. Souleles, "Reported Effects versus Revealed-Preference Esti-
  mates: Evidence from the Propensity to Spend Tax Rebates," American Economic Review: Insights,
  December 2019, 1 (3), 273­290.

Pencavel, John, "Chapter 1 - Labor Supply of Men: A Survey," in "Handbook of Labor Eco-
  nomics," Vol. 1, Elsevier, January 1986, pp. 3­102.

Ramey, Valerie A., "Can Government Purchases Stimulate the Economy?," Journal of Economic
  Literature, 2011, 49 (3), 673­685.

  , "Ten Years after the Financial Crisis: What Have We Learned from the Renaissance in Fiscal
  Research?," Journal of Economic Perspectives, May 2019, 33 (2), 89­114.

Ravn, Morten O. and Vincent Sterk, "Job Uncertainty and Deep Recessions," Journal of Monetary
  Economics, October 2017, 90 (Supplement C), 125­141.

Rotemberg, Julio J., "Sticky Prices in the United States," Journal of Political Economy, December
  1982, 90 (6), 1187­1211.

Song, Jae, David J. Price, Fatih Guvenen, Nicholas Bloom, and Till von Wachter, "Firming Up
  Inequality," Quarterly Journal of Economics, February 2019, 134 (1), 1­50.

Woodford, Michael, "Simple Analytics of the Government Expenditure Multiplier," American Eco-
  nomic Journal: Macroeconomics, 2011, 3 (1), 1­35.




                                                    25
A     Proofs
A.1   Proof of Lemma 1

Proof. Applying the implicit function theorem to (3) yields

                                              ~)
                                        c ( , w               ~)
                                                        n ( , w
                                 Ucc             + Ucn           = 0.
                                          w ~             w ~

Rearrange to get
                                           ~)
                                     c ( , w                    ~)
                                                          n ( , w     Ucn
                                                                   =-
                                       w ~                  w ~       Ucc

                                             ~ = -Un /Uc , to obtain the desired result
and then divide by the ratio of (4) and (3), w

                                             ~)
                                       c ( , w                        ~)
                                                                n ( , w    Unc /Un
                             CI =                         ~
                                                          w              =         .            (28)
                                         w ~                      w ~      Ucc /Uc

    For separable preferences, Unc = 0, and it is clear that CI = 0. For GHH preferences, U (c, n) =
u(c - v(n)), and so Un = u (c - v(n))v (n) and Uc = u (c - v(n)) and Unc = u (c - v(n))v (n)
and Ucc = u (c - v(n)). Hence

                                       Unc   Ucc   u (c - v(n))
                                           =     =
                                       Un    Uc    u (c - v(n))

which shows that CI = 1.


A.2   Proof of Proposition 1

Proof. Log-linearizing (3)-(4) yields a linear system

                                       cUcc      nUcn        ^
                                                                 
                                        Uc        Uc  ^
                                                      c      
                                                        =        
                                       cUnc      nUnn
                                                      ^
                                                      n    ^
                                                           +w  ^
                                        Un        Un

The 2 × 2 matrix inverse formula implies that the solution is

                                             nUnn
                                                                         - UU
                                                                            cn n       ^
                                                                                             
                      ^
                      c             1
                        = Uc Un
                                                                                       
                                             Un                              c
                                         2
                           cn Ucc Unn - Ucn
                                                                                             
                      ^
                      n                      -cUnc                        cUcc        ^ +w
                                                                                         ^
                                              Un                           Uc

It follows that
                          log n(,w)       cUcc          cUnc
                            log            Uc    -       Un           Unc /Un
                                      =          cUcc
                                                               = 1-           = 1 - CI
                          log n(,w)
                                                  Uc
                                                                      Ucc /Uc
                           log w




                                                           26
and hence, using the definitions of EIS and Frisch in the main text,

                          log n(,w)         log n(,w)  log n(,w)
                            log               log       log w                     Frisch
                                       =                                  =-             (1 - CI).
                          log c(,w)         log n(,w)  log c(,w)                   EIS
                            log              log w       log 


The effect of a one-time transfer is therefore
                                                       log n(,w) d log 
                   MPE  -w dn   -wn log                 dT                        wn Frisch
                       = dcdT =                                              =              (1 - CI).
                   MPC   dT
                                   log
                                 c log 
                                       c (  , w ) d log                            c EIS
                                                     dT




A.3   Proof of Proposition 2

Proof. Totally differentiating (3) and substituting the linearized market clearing condition dCt =
dYt - dGt (from which the second-order price adjustment cost drops out) gives

                                       Ucc (dYt - dGt ) + Ucn dNt = dt .

Now differentiate the production function (10) and use the definition of the labor wedge to get

                                                    1               Uc
                                       dNt =          dYt = -(1 -  ) dYt
                                                    f               Un

Combine these two equations to get

                                                      1                            1
                              dYt =                                     dGt +         dt .               (29)
                                                     cn /Un
                                        1 - (1 -  ) U
                                                    Ucc /Uc
                                                                                  Ucc

                             Ucn /Un
where we recognize CI =      Ucc /Uc   in the denominator.
   All that is left is to express t as a function of the exogenous interest rates. Iterating the Euler
equation (8) forward until some T beyond which there are no more shocks, and we have returned
to steady state, gives
                                                                         
                                                   T - t -1
                              t =  T -t                              e
                                                              (1 + r t + j ) Uc
                                                                            
                                                     j =0
                                                                            T - t -1
                          log t = ( T - t) log  + log Uc +                                      e
                                                                                       log(1 + rt +j )
                                                                             j =0
                                       T - t -1
                         d log t =                           e
                                                  d log(1 + rt +j )
                                        j =0




                                                                27
and so we have solved for output:
                                                                                           
                                                           T - t -1
                                   1       dGt + Uc
                      dYt =
                            1 - (1 -  ) CI       Ucc                             e
                                                                      d log(1 + rt +j ) .
                                                                                                  (30)
                                                              j =0




   Note that this argument only requires constant real interest rates and the linearized market
clearing condition, not our specific sticky-price, flexible-wage general equilibrium. In particular,
it works equally well if there are sticky wages instead of, or in addition to, sticky prices, assuming
                                Ucn /Un
that we directly define CI as   Ucc /Uc   (since (5) no longer makes sense when households are not on
their labor supply curves).


A.4   Properties of GHH-plus preferences

Recall that GHH-plus preferences are of the form

                                                           1- 
                                     1             n 1+                               n 1+ 
                       U ( c, n ) =           c -                -  (1 -  )                 .
                                    1-             1+                                 1+

The partials of this function are

                                                                 -
                                                      n 1+ 
                                 Uc (c, n) =     c -                  ,
                                                      1+
                                 Un (c, n) = - n Uc (c, n) + 1 -  ,
                                                                          -  -1
                                                         n 1+ 
                                 Ucc (c, n) = -     c -                           ,
                                                         1+
                                Ucn (c, n) = - n Ucc (c, n).

The complementarity index thus equals

                           Uc Unc       Uc       n Ucc      Uc
                    CI =          =                    =           .                              (31)
                           Un Ucc   n [Uc + 1 - ] Ucc
                                                         Uc + 1 - 

That is, CI can take any value in [0, 1] depending on the choice of   [0, 1]. We recognize the
special cases from lemma 1: for separable preferences,  = 0 = CI, and for GHH preferences,
 = 1 = CI .




                                                     28
    Next we derive Frisch and EIS. Starting from the labor supply equation (3)(4) we get

                             w = n ( + 1 - ) ,
                                                              1
                                        w
                                                              
                                           
                         n ( , w ) =                              ,
                                          + 1 - 
                                       1
                     log n(, w) =        log w - log  + log  - log( + 1 - ) ,
                                       

which shows that Frisch is still parameterized directly by  :

                                                     log n(, w)  1
                                        Frisch =                = .                                (32)
                                                        log w    

EIS does not have such a simple form, but we can compute it recursively as follows:

                           n ( , w )   n ( , w )        1-
                                     =                                     ,
                           log                           + 1 - 
                            c ( , w )                         n ( , w )         1  1
                                      = n(, w)                                 - -  ,
                            log                               log               
                                             log c(, w)      1    c ( , w )
                                 EIS = -                =-                  .                      (33)
                                               log         c(, w)  log 

B     Additional results
B.1   Proof of "Ricardian equivalence" in the sticky-price model

We will prove a special case of Ricardian equivalence that applies to first order in the model. The
key idea is that in equilibrium, in whatever period the government raises taxes to pay for spend-
ing, firms will raise pretax wages by the same amount, so that the after-tax wage is unchanged,
and indeed consumption, labor, and assets are unchanged for every household in every period.
    For this to happen, it is essential that the firm equity is discounted using the same interest rate
paid on government debt. This way, when the government decreases the debt from t + 1 onward
by raising taxes at time t, there is an exactly offsetting increase in the valuation of firms, because
the loss from raising wages at time t is no longer included in the time t + 1 equity price.

Proof. First, note that ex-post return rt is fixed in all periods except 0:
                                    
                                          pss d0 + p0          Bss
                                                        +   pss + Bss (1 + rss )   for t = 0
                                    
                                       pss + Bss pss
                         1 + rt =                                                                  (34)
                                    1 + rss
                                                                                   for t  1

Therefore, the only endogenous inputs to the households' problem are the paths of after-tax wages
and transfers, and the cum dividend price of equity in period 0. In particular, the aggregate labor


                                                        29
supply function can be written as

                                                              g
                                Nt = Nt {(1 - s )ws , Ts }s0 , d0 + p0 .

Second, iterating the pricing equation (52) forward and using the definition of dividends (51)
(ignoring second-order adjustment costs) and the production function (49) yields

                                                    
                               d0 + p0 =            (1 + rss )-t dt
                                                   t =0
                                                     
                                             =      (1 + rss )-t (Yt - wt Nt )
                                                   t =0
                                                     
                                             =      (1 + rss )-t          ( Z - wt ) Nt - F ,                (35)
                                                   t =0


which shows that ex-post return depends only on the present values of { Nt }t0 and {wt Nt }t0 .
Third, iterating the government budget constraint (55) forward yields

                                                                              
                                                                                             g
                         (1 + rss ) B-1 +  (1 + rss )-t Gt =                   (1 + rss )-t t wt Nt .        (36)
                                                 t =0                         t =0

                         g,
Let the sequences {t , Nt , wt
                             , T }
                                t t0 be part of an equilibrium. Now consider an alternative
                                                          g
path of taxes that is part of an equilibrium {t , Nt , wt , Tt }t0 . We're going to guess and verify that
                     g                      g,
                                   for all t  0. That is, the pre-tax wage offsets any change
Nt = Nt and (1 - t )wt = (1 - t )wt
in taxes and the real outcomes are the same.
   The conjecture immediately implies that

                                         g                         g,
                              (1 - t )wt Nt = (1 - t )wt Nt ,                          t  0

and hence
                                        g                              g,
                     Tt = (1 - t )wt Nt = (1 - t )wt Nt = Tt ,                                   t  0.       (37)

Now take present discounted values and use the fact that both allocations satisfy (36) to see that
the present value of wage costs is the same:

                                                                   
                                                    g                                       g,
                      (1 + rss )-t (1 - t )wt Nt =                  (1 + rss )-t (1 - t              
                                                                                                 ) wt Nt ,
                     t =0                                          t =0
                                                                     
                                (1 + rss )-t wt Nt =  (1 + rss )-t wt Nt .
                               t =0                                t =0

It follows, by the conjecture Nt = Nt , that the present value of pre-tax wages is also the same:

                                                                       
                                       (1 + rss )-t wt =  (1 + rss )-t wt .
                                      t =0                             t =0



                                                                  30
It follows from (35) that
                                                                 
                                                 p0 + d0 = p0 + d0 .                                        (38)

We have shown that all inputs of the aggregate labor supply function are the same in both al-
locations, hence verified Nt = Nt . It follows that Yt = Yt and Ct = Ct
                                                                       and A = A . This
                                                                            t   t
means that goods market clearing holds period by period, up to the price-adjustment cost which
is a second order term. Asset market clearing then follows from Walras's law. This means that
            + p for all t even though B = B and p = p in general.
Bt + pt = Bt   t                       t   t     t   t


B.2   Derivation of the wage Phillips curve

Here, we adapt the derivation of the wage Phillips curve from Auclert et al. (2018) to take into
account the specification of the tax system in (18)­(19). Although our calibration features separable
preferences, here we allow for general nonseparable preferences.
   Let household i supply a continuum of labor services nikt which are imperfect substitutes. We
assume that there is a union for each type of labor k. These unions set a common wage per effi-
ciency unit wkt , and their members have to supply labor demanded at that wage. Labor demand
has the usual isoelastic form with elasticity            w.   The unions' objective is to maximize the average
welfare of their members, taking their consumption choice as given.
   At any time t, union k sets its real wage wkt to maximize

                                                                                                        2
                                                                   w                 wkt+
                          t+           U (cit+ , nit+ )di -
                                                               2 w
                                                                       log
                                                                                    wkt+ -1
                                                                                            (1 +  t )
                      0


subject to the demand curve
                                                                   -
                                                          wkt           w
                                                Nkt =                        Nt .
                                                          wt
Using symmetry as appropriate, the FOC may be written as

                                                                          w                 w )
                                  cit                  n        w log(1 + t )    w log(1 + t
        0=      Uc (cit , nit )       + Un (cit , nit ) it di -               +              +1
                                                                                                .           (39)
                                  wkt                  wkt      w      wt       w        wt

Next, we express the partial derivatives of consumption and labor. Household i's total hours are

                                                                               -
                                                                       wkt          w
                                        nit =    Nkt dk =                                Nt dk
                                                                       wt

and therefore
                                          nit                 Nkt                        Nt
                                              =-     w            dk = -             w                      (40)
                                          wkt                 wkt                        wt
   By the envelope theorem, the marginal effect on consumption is equal to the marginal effect




                                                              31
on income. Household income is

                         zit = (1 - t )(1 - )wt eit nit + Tt

                            = (1 - t )(1 - )eit         wkt nikt dk + Tt
                                                                               -
                                                                      wkt           w
                            = (1 - t )(1 - )eit Nt             wkt                      dk + Tt
                                                                      wt

and thus
                                  zit
                                      = Nt (1 -       w )(1 - t )(1 -  ) eit                                        (41)
                                  wkt
Substituting (40) and (41) into the FOC gives

                       w
               log(1 + t ) = w Nt         -Un (cit , nit )di

                                                                       w   -1                                       (42)
                                    - wt Nt (1 - t )(1 - )                                eit Uc (cit , nit )di
                                                                           w
                                                 w
                                    +    log(1 + t +1 )

This means that household heterogeneity affects wage setting via two cross-sectional moments:
the average marginal disutility of labor and the productivity-weighted average marginal utility
of consumption. To get a more compact expression, let virtual aggregate consumption and labor
(Ct , Nt ) be defined implicitly by

                                        
                                   UN (Ct , Nt ) =         -Un (cit , nit )di,                                      (43)
                                         
                                    UC (Ct , Nt ) =        eit Uc (cit , nit )di.                                   (44)

We can then write the wage Phillips curve as

                   w                                                                     w   -1
           log(1 + t ) = w Nt UN (Ct , Nt ) - wt Nt (1 - t )(1 - )                                       
                                                                                                    UC (Ct , Nt )
                                                                                             w                      (45)
                                           w
                              +    log(1 + t +1 ).

which is equation (27) in the main text.


C     Summary of model equations
C.1   Sticky-price HANK

This is the benchmark model we use to generate the blue circles in figure 2.

    · Households:



                                                      32
  The Bellman equation

                                                                         1- 
                                           1          n 1+                                     n1 +
  Vt (eit , ait-1 )   =     max                 cit -  it                      -  (1 -  )       it
                                                                                                    + Et Vt+1 (eit+1 , ait )
                           cit ,nit ,ait 1 -          1+                                       1+
                                                                                    g
                      s.t. cit + ait = (1 + rt ) ait-1 + (1 - )(1 - t )wt eit nit + Tt
                           ait  a

  gives aggregate consumption, asset demand, and labor supply:

                                                      e
                                      Ct = Ct ({rs , rs , s , ws , Ts }) =          cit di,                              (46)
                                                           e
                                      A t = A t ( {r s , r s , s , ws , Ts }) =         ait di,                          (47)
                                                      e
                                      Nt = Nt ({rs , rs , s , ws , Ts }) =              eit nit di.                      (48)


· Production:


                                                        Yt = ZNt - F                                                     (49)

· Phillips curve:

                                                 wt        p   -1                1 Yt+1
                       log(1 + t ) =  p             -                    +          e Y log(1 + t+1 ).                   (50)
                                                 Z             p               1 + rt  t


· Dividends:

                                                                     p
                                        dt = Yt - wt Nt -                 log(1 + t )2 Yt                                (51)
                                                                   2 p

· Equity price:
                                                               d t +1 + p t +1
                                                      pt =               e                                               (52)
                                                                    1 + rt

· Realized return on portfolio:

                                              p t -1 dt + pt      Bt-1            e
                            1 + rt =                         +             (1 + r t -1 )                                 (53)
                                          pt-1 + Bt-1 pt-1     pt-1 + Bt-1

· Monetary policy:
                                                              e
                                                             rt  rss                                                     (54)

· Government budget:
                                                               e
                                          Bt + t wt Nt = (1 + rt -1 ) Bt-1 + Gt .                                        (55)


                                                            33
   · Public debt policy:
                                         Bt - Bss =  B ( Bt-1 - Bss + Gt - Gss )                                     (56)

   · Lump-sum transfer:

                                                     Tt = (1 - t )wt Nt                                              (57)


   · Market clearing:

                                                                   p
                                           Yt = Ct + Gt +               log(1 + t )2 Yt                              (58)
                                                                  2 p
                                          At = Bt + pt                                                               (59)


C.2   Sticky-wage HANK

This is the benchmark model we use to generate the dark red diamond on figure 2. Here we list
only the equations that differ from the sticky-price model in appendix C.1.

   · Households:
      The Bellman equation

                                                  c1it
                                                      -
                Vt (eit , ait-1 )    =     max          + Et Vt+1 (eit+1 , ait )
                                         cit ,ait 1 - 
                                    s.t. cit + ait = (1 + rt ) ait-1 + (1 - )(1 - t )wt Nt eit + Tt
                                           ait  a

      gives aggregate consumption, asset demand, and marginal utility of consumption:

                                                    e
                                    Ct = Ct ({rs , rs , s , ws , Ns , Ts }) =            cit di,                     (60)
                                                         e
                                    A t = A t ( {r s , r s , s , ws , Ns , Ts }) =        ait di,                    (61)

                                    Utc = Nt ({rs , rs
                                                     e
                                                       , s , ws , Ns , Ts }) =                 -
                                                                                          eit cit di.                (62)


   · Phillips curve: replace (50) with

                                                                               w     -1
         log(1 + t ) = w  Nt1+ - (1 - )(1 - t )wt Nt                                          Utc +  log(1 + t+1 )   (63)
                                                                                     w


   · Price setting:
                                                          wt        p   -1
                                                             =                                                       (64)
                                                          Z             p




                                                             34
      · Dividends: replace (51) with
                                                       dt = Yt - wt Nt                           (65)

      · Market clearing: replace (58) with
                                                        Yt = Ct + Gt                             (66)


C.3      Extensions

Here we briefly describe the models used to construct table 2.

      · Taylor rule: replace (54) with

                                                         it = rss + t                            (67)
                                                        e        1 + it
                                                   1 + rt =                                      (68)
                                                               1 +  t +1

      · Nominal peg: replace (67) with
                                              
                                              r                for t = 0, 1, . . . 11
                                              
                                                  ss
                                       it =                                                      (69)
                                              rss + t
                                                               for t  12


D       Computational appendix
Endogenous gridpoints method for GHH-plus preferences. Recall that GHH-plus preferences
are
                                                                   1- 
                                       1             n 1+                               n 1+ 
                         U ( c, n ) =           c -                       -  (1 -  )
                                      1-             1+                                 1+

and the first order conditions are

                                                           e
                              Uc (cit , nit ) = it + (1 + rt )Et Uc (cit+1 , nit+1 )             (70)
                            -Un (cit , nit ) = wt (eit )Uc (cit , nit )                          (71)
                              it ( ait - a) = 0                                                  (72)
                                  cit + ait = (1 + rt ) ait-1 + wt (eit )nit + Tt                (73)

The core of the algorithm is a backward iteration of Uc on a discrete grid G = (e, a). Let  denote
the Markov transition matrix of the income state e. In this section only, we're going to use primes
to refer to the next period. Thus, Uc denotes marginal utility next period and (e , a ) refers to the
grid next period.

    1. Initial guess Uc (e , a ), marginal utility tomorrow on tomorrow's grid.



                                                          35
   2. e  e For unconstrained agents (70) implies that

                                            Uc (e, a ) = (1 + r e )Uc (e , a ).

      Then use the labor supply equation (71) to obtain
                                                                                          1
                                                       w(e)  Uc (e, a )
                                                                                          

                                       n ( e, a ) =                                           ,
                                                         Uc (e, a ) + 1 - 
                                                                           n ( e , a )1+ 
                                       c(e, a ) = Uc (e, a )- +                           .
                                                                               1+

   3. a  a the budget constraint (73) defines a mapping a(e, a ):

                                     c(e, a ) + a - w(e)n(e, a ) = (1 + r ) a + Tt

      which we can use to obtain c(e, a) and n(e, a) by linear interpolation. Then

                                   a ( e, a ) = (1 + r ) a + T + w ( e ) n ( e, a ) - c ( e, a ).


   4. Borrowing constraint Let B  G be the set of gridpoints where a (e, a) < a. At these points
      only, c(e, a) and n(e, a) obtained in step 3 are invalid. The right values solve

                        c(e, a), n(e, a) = arg max U (c, n)          s.t. c = (1 + r ) a + w(e)n + T
                                                 c,n


      a static optimization problem that's independent of the current guess of Uc and thus can be
      precomputed when solving for the steady state.

   5. Update guess
                                                                                        -
                                                                   n ( e , a )1+ 
                                      Uc (e, a) =       c(e, a) -                             .
                                                                      1+

General equilibrium.         We solve for impulse responses directly in sequence space as explained
in Auclert, Bardóczy, Rognlie and Straub (2019) using the toolkit published alongside that paper,
available at https://github.com/shade-econ/sequence-jacobian. Here we sketch the method
for the benchmark sticky-price model.
    There are 14 numbered equilibrium conditions in appendix C.1. Either goods market clearing
or asset market clearing is redundant by Walras's law. That is, the we have a system of 13 × T
nonlinear equations that characterize the time paths--truncated at some large T 26 --of endogenous
                                    e ,  , w , T , Y ,  , d , p , B } T -1 conditional on a path of the exogenous
variables U = {Ct , At , Nt , rt , rt   t   t t t      t t t       t t =0

  26 The choice of the truncation horizon is dictated by how long it takes for the economy to approximately return to
the steady state. We found that T = 200 is sufficient in all cases we consider in the paper.



                                                            36
                   T -1
variable G = { Gt }t =0 . We solve the system H(U, G) = 0 in two steps. First, we reduce the
                                 T -1
set of unknowns to {t , wt , Nt }t =0 by taking advantage of the limited dependency among the
equilibrium conditions. Second, we compute the Jacobians of H around the steady state. The
Jacobians are sufficient to compute aggregate impulse responses.


E    Additional impulse responses under separable preferences
Figure 4 contrasts the set of impulse responses for our sticky-price and sticky-wage models with
separable preferences. Interestingly, although the cumulative multipliers are similar in the two
cases, the dynamics are quite different: the consumption response in the sticky-price case starts
negative and then becomes persistently positive, while the consumption response in the sticky-
wage case more closely mirrors the trajectory of government spending.
    The non-monotonic aggregate consumption response reflects some of the peculiar properties
of the sticky-price model. As the middle two rows of figure 4 show, this model features both a very
large decline in equity prices and a large increase in wages (which, given our fiscal rule, funds an
increase in transfers). Since patient households own most of the equity, they suffer a negative
wealth effect, and as figure 5 shows, cut their consumption while increasing hours. Impatient
households, on the other hand, experience a large positive wealth effect from wages and transfers,
and increase their consumption while cutting hours. These two very large and opposite-signed
effects on both consumption and hours--which seem empirically implausible--net out to a much
smaller cumulative increase in consumption. (Note that although these extremely heterogeneous
responses show up in our model in patient vs. impatient agents, all that is really needed is wealth
heterogeneity.) The consumption impulse response starts negative because the MPC out of the
large date-0 decline in equity wealth initially dominates.
    In contrast, the sticky-price impulse responses in figure 6 display a much more plausible de-
gree of heterogeneity.




                                                37
                                                  Output                                          Consumption
                        1.25
                                                                  sticky price                                          sticky price
                                                                                      0.2
 % of steady state Y
                        1.00                                      sticky wage                                           sticky wage

                        0.75
                                                                                      0.1
                        0.50

                        0.25                                                          0.0

                        0.00
                                    0        20              40              60             0     20               40              60

                                                  Assets                                          Equity Price
                                                                                        0
                               0
% of steady state Y




                       -10                                                            -10

                       -20                                                            -20

                       -30                                                            -30
                                                                  sticky price                                          sticky price
                       -40                                                            -40
                                                                  sticky wage                                           sticky wage

                                    0        20              40              60             0     20               40              60

                                            After-Tax Wage                                             Transfers
                                                                                      0.4
                                                                  sticky price                                          sticky price
                              1.0
        % of steady state Y




                                                                  sticky wage         0.3                               sticky wage


                              0.5                                                     0.2

                                                                                      0.1
                              0.0
                                                                                      0.0

                                    0        20              40              60             0     20               40              60

                                         Government Spending                                    Government Bonds
                              1.0
                                                                                        3
        % of steady state Y




                              0.8

                              0.6                                                       2
                              0.4
                                                                                        1
                              0.2

                              0.0                                                       0
                                    0        20              40              60             0     20               40              60
                                                  quarters                                              quarters


                                        Figure 4: Impulse Responses with Separable Preferences




                                                                                 38
                                                  Consumption                                                      Hours
                                                                                         1.0                                      all
                                  0.5                                                                                             impatient
% of steady state Y




                                                                                                                                  patient
                                                                                         0.5
                                  0.0

                                                                                         0.0
                                                                       all
                       -0.5
                                                                       impatient
                                                                       patient
                                                                                        -0.5
                                        0   10   20      30       40    50     60                  0    10   20     30       40    50     60
                                                       quarters                                                   quarters


                                  Figure 5: Disaggregated Responses in Sticky-Price Model with Separable Preferences




                                                  Consumption                                                     Hours
                                  0.3                                   all                                                             all
                                                                                        1.0
                                                                        impatient
            % of steady state Y




                                                                        patient         0.8
                                  0.2
                                                                                        0.6

                                  0.1                                                   0.4

                                                                                        0.2
                                  0.0
                                                                                        0.0
                                        0   10    20     30       40     50        60          0       10    20     30       40    50     60
                                                       quarters                                                   quarters


                             Figure 6: Disaggregated Responses in Sticky-Wage Model with Separable Preferences




                                                                                   39
