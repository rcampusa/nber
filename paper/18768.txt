                               NBER WORKING PAPER SERIES




  A MEAN-VARIANCE BENCHMARK FOR INTERTEMPORAL PORTFOLIO THEORY

                                         John H. Cochrane

                                       Working Paper 18768
                               http://www.nber.org/papers/w18768


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     February 2013




I thank the CRSP for research support. The views expressed herein are those of the author and do not
necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by John H. Cochrane. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
A Mean-Variance Benchmark for Intertemporal Portfolio Theory
John H. Cochrane
NBER Working Paper No. 18768
February 2013
JEL No. G11,G12

                                            ABSTRACT

Mean-variance portfolio theory can apply to the streams of payoffs such as dividends following an
initial investment, in place of one-period returns. This description is especially useful when returns
are not independent over time and investors have non-marketed income. Investors hedge their outside
income streams, and then their optimal payoff is split between an indexed perpetuity – the risk-free
payoff – and a long-run mean-variance efficient payoff. "Long-run" moments sum over time as well as
states of nature. In equilibrium, long-run expected returns vary with long-run market betas and outside-
income betas. State-variable hedges do not appear in optimal payoffs or this equilibrium.


John H. Cochrane
Booth School of Business
University of Chicago
5807 S. Woodlawn
Chicago, IL 60637
and Hoover Institution and Cato Institute
and also NBER
john.cochrane@chicagobooth.edu
1    Introduction and central results
This paper examines long-horizon portfolio problems and corresponding equilibria. I allow
asset-return dynamics, dynamic trading, non-market wealth such as wages, businesses, or
real estate, and I allow preference shocks. Markets are incomplete, so investors may not
be able completely to hedge outside-income or state-variable shocks.
   I focus on the optimal stream of final payoﬀs, rather than focus on the composition
and dynamics of portfolio returns. I find that the stream of final payoﬀs obeys a classic
mean-variance characterization and CAPM equilibrium pricing.
   Let  = { } denote a stream of payoﬀs, costing () at time 0. (The Appendix
summarizes all notation.) These payoﬀs can be coupons, dividends, or the payouts from
dynamic trading strategies. I define a “long-run expectation” ̃ that sums over time,
weighted by a number   1, as well as summing over states of nature, weighted by
probabilities,
                                                ∞
                                       1− X
                               ̃() ≡                                       (1)
                                              =1

Thus, I write the price of a payoﬀ stream { }, given a scaled discount factor  = { },
as                               ∞
                                X                               
                       () =          = ̃();  ≡        
                                =1                           1−

    With this notation, we can transparently see how the simple ideas that flow from
 = () in one-period models apply to the payoﬀ streams of a multi-period, dynamic
environment. We replace  with ̃, and reinterpret the results. For example, 1 is the
risk-free payoﬀ. Interpretation: the risk-free payoﬀ to a long-run investor is an indexed
perpetuity, which pays a constant real coupon in every date and state of nature. Of
course, one can solve the same problems without the ̃ notation. The notation just
clarifies intuition by showing how the intertemporal results all map to familiar one-period
results.
   I apply this notation to portfolio theory. We can write the long-horizon investor’s
objective ̃ [()] and constraint  = () = ̃(). This investor chooses an optimal
payoﬀ ̂ by 0 (̂) = , where  is the Lagrange multiplier on initial wealth and  is a
stochastic discount factor or set of contingent claim prices.
    I specify quadratic utility and hence linear marginal utility 0 (̂) =  − ̂. As in
discrete-time one-period analysis, quadratic utility is necessary for mean-variance results,
given that we want to allow dynamic trading and thus non-normal payoﬀs. Thus, the
optimal payoﬀ is ̂ =  1− where 1 denotes the riskless payoﬀ. There is a unique traded
discount factor ∗ = , and linear combinations of traded payoﬀs are traded. Thus, the
optimal (traded) payoﬀ is ̂ =  1 − ∗ where 1 denotes the riskless payoﬀ. Proposition 1
derives this statement more carefully, allows non-market income, a stochastic bliss point,
and the absence of a riskfree payoﬀ.


                                             2
    Then, I rearrange the terms of this general characterization to express long-run coun-
terparts to traditional results. These more intuitive characterizations are the paper’s
central point.
    An investor who does not have outside income buys a payoﬀ that is split between
an indexed perpetuity and a payoﬀ on the long-run mean-variance frontier (Proposition
2). This “long-run” frontier is defined using ̃(), ̃(2 ) and the stream of payoﬀs to a
one-dollar investment (which I call “yields”) in the place of (), (2 ) and one-period
returns. Long-run variance measures variation over time as well as variation across states
of nature.
    If all investors are of this type, then the equilibrium market payoﬀ, which is a claim to
the aggregate consumption stream, is also on the long-run mean-variance frontier. In this
case, each investor’s optimal payoﬀ is a linear combination of an indexed perpetuity and
the market payoﬀ. The investor’s optimal payoﬀ is weighted more towards the perpetuity
if his risk aversion is large relative to average risk aversion and vice-versa (Proposition 4).
   That a risk-averse long-run investor should hold the indexed perpetuity, that the
average investor holds the market payoﬀ, and that others lie somewhere in between (or
beyond) are all results that hold for general utility functions. Quadratic utility delivers
the idea that optimal payoﬀs are a linear time-invariant combination of these two payoﬀs,
and the link to long-run mean-variance eﬃciency.
   In this equilibrium, a long-run CAPM holds: each asset’s long-run expected yield
(payoﬀ divided by initial price) is proportional to its long-run market beta (Proposition 5).
Long-run beta measures the long-run covariance of each asset’s payoﬀ with the market’s
payoﬀ (dividend) stream, also summing over dates and states. It is thus a pure “cashflow
beta,” not a “discount-rate beta.”
    When investors have outside income, we can define an outside-income hedge payoﬀ by
a long-run regression. This hedge payoﬀ is the traded payoﬀ stream which is closest, in
the ̃(2 ) sense, to the investor’s outside income stream.
    I characterize the resulting optimal risky payoﬀ in several equivalent ways: First, we
can say that the investor’s total payoﬀ should be long-run mean-variance eﬃcient, where
his “total payoﬀ” consists of his asset market payoﬀ plus the hedge payoﬀ he holds im-
plicitly by his ownership of the outside income stream (Proposition 6). Second, we can
say that the investor first shorts the outside-income hedge payoﬀ, and then buys a long-
run mean-variance eﬃcient asset payoﬀ (equations (39) and (42)). Third, and perhaps
most insightfully, the investor modifies his holding of the long-run mean-variance eﬃcient
payoﬀ to account for changes in eﬀective risk aversion due to the market and perpetuity
exposure of his outside-income stream, and then shorts a zero-cost zero-expected-yield
payoﬀ that hedges the idiosyncratic component of his outside income (Proposition 7).
    There are similarly several equivalent ways to characterize optimal payoﬀs in a market
of such investors (quadratic utility, outside income). First, each investor’s total payoﬀ
combines the riskfree payoﬀ and the market total payoﬀ (Proposition 8). Second, each
investor’s optimal asset payoﬀ combines the market asset payoﬀ, the average outside-

                                              3
income hedge payoﬀ, and an idiosyncratic outside-income hedge payoﬀ (Proposition 9,
and orthogonalized as Proposition 10). The weights in each case contrast the individual
with average values. Investors with average outside income and average risk aversion just
hold the market asset payoﬀ, despite dynamics in returns and the presence of outside
income. Investors with no outside income buy the average outside-income hedge payoﬀ,
earning a premium for taking on others’ risks.
    In equilibrium, long-run expected yields obey a one-factor CAPM using the aggregate
total payoﬀ as reference (Proposition 11). We can also break the total market payoﬀ into
its asset market component and the hedge payoﬀ for outside income, to obtain a long-run
two-factor equilibrium pricing model: long-run expected yields are proportional to long-
run asset-market betas and long-run betas with respect to the average outside-income
hedge payoﬀ (Proposition 12).
   These results sound familiar from one-period mean-variance analysis with the words
“yield” and “payoﬀ” in place of “return” and “portfolio.” The novelty is that the same
results hold as a characterization of the payoﬀ streams in a dynamic world.
    The other novelty is what’s missing. The standard Merton (1969, 1971a) characteri-
zation describes investments in portfolios whose returns hedge shocks to asset-return or
outside-income state variables, as well as a conditionally mean-variance eﬃcient portfolio.
The composition of and allocations to these portfolios change constantly and must be
rebalanced. In equilibrium, since the average investor must hold the market, the state-
variable hedging portfolios become a Merton (1971b) conditional multifactor asset pricing
model that describes conditional expected returns.
    By contrast, the payoﬀ characterization retains all the simple features of classical
one-period mean-variance analysis. The optimal payoﬀ does not include Mertonian state-
variable hedging demands, pricing does not depend on state-variable pricing factors, and
the payoﬀ description is static, not even requiring rebalancing.


2    Why is this interesting?
Dynamic incomplete-market portfolio theory is important. The fact that returns are
not i.i.d. means that investors can potentially exploit time-variation and cross-sectional
variation in asset return moments, and should hedge state variables. By doing so, they
provide socially useful risk transfer to the agents whose demands create return dynamics
in the first place. In typical calibrations, these eﬀects are large.
    Dynamic incomplete-market portfolio theory is hard. Consider the simple question
of how one should optimally invest in a stock index vs. a riskfree rate, given that in-
dex returns are predictable from variables such as the dividend-price ratio. This clas-
sic simple Merton (1969, 1971a) dynamic programming problem has been attacked by
Kim and Omberg (1996), Brennan, Schwartz and Lagnado (1997), Campbell and Viceira
(1999), Barberis (2000), Brennan and Xia (2000, 2002), Wachter (2003), Sangvinatsos and


                                            4
Wachter (2005), Liu (2007), Jurek and Viceira (2010) and many others. These papers are
technically complex. There is no closed-form solution, even for the simplest case: power
utility over consumption, an AR(1) forecasting variable whose shocks are not perfectly
correlated with return shocks. An easily-summarized practical consensus on the size and
nature of market-timing and hedging demands remains more elusive. The literature has
not even tried to characterize the final payoﬀs.
    Dynamic incomplete-market portfolio theory is widely ignored in practice, though
it has been around half a century. Even highly sophisticated hedge funds typically form
portfolios with one-period mean-variance optimizers — despite the fact that mean-variance
optimization for a long-run investor assumes i.i.d. returns, while the funds’ strategies are
based on complex models of time-varying expected returns, variances, and correlations.
Beyond formal portfolio construction, their informal thinking and marketing is almost
universally based on one-period mean-variance analysis, ignoring Mertonian state vari-
ables. Institutions, endowments, wealthy individuals, and regulators struggle to use even
the discipline of mean-variance analysis in place of name-based buckets, let alone to im-
plement Mertonian state-variable hedging.
   Well, calculating partial derivatives of unknown value functions is hard, and more
importantly nebulous. People sensibly distrust model-dependent black boxes.


2.1    Separating payoﬀs from portfolio strategy

In this context, this paper’s contribution is to provide a simple and intuitive benchmark
characterization of optimal payoﬀs, the final dividend stream the consumer/investor re-
ceives from asset markets, without deriving and characterizing the dynamic portfolio strat-
egy that supports those payoﬀs in a given market structure.
    The payoﬀ characterization is “simple,” because market-timing and state-variable
hedging demands do not appear. The results look just like familiar one-period mean-
variance analysis. It is a “benchmark,” because quadratic utility is undoubtedly unreal-
istic for many investors, and the results, although qualitatively sensible, can be a poor
quantitative approximation to the results that obtain from other utility functions. It
is a “characterization” because it describes what the optimal payoﬀs look like, without
describing in detail how to support them by dynamic trading in a particular incomplete-
market structure.
   Focusing on payoﬀs helps us to separate the investor’s risk and return decisions from
the financial engineering of how to achieve optimal payoﬀs in a given market structure.
That separation may be a useful step in getting investors and their advisers to understand
and use dynamic portfolio theory. The portfolio approach has to be re-solved for every
change in asset market structure, even if the final payoﬀs are no diﬀerent. And the hedging
demands emphasized by the portfolio approach are really means to an end — an optimal
consumption stream — rather than the end itself. But this payoﬀ characterization does
not advance the art of solving dynamic portfolio problems. That’s a feature, not a bug.


                                             5
It’s the whole point.
   Two examples should clarify these points. First, consider an investor with a 10-year
horizon. Examining payoﬀs, it is immediately obvious that a 10-year zero-coupon indexed
bond is the riskless asset for this investor. Likewise, it is immediately obvious that an
indexed perpetuity is the riskless asset for the standard infinitely-lived consumer-investor.
    By contrast, in the standard dynamic-programming approach, long-term bonds are
assets that happen to hedge changes in investment opportunity sets: long bond prices go
up when interest rates go down, so they hedge reinvestment risk. We have to evaluate
value-function derivatives and bond-return correlation models to decide how much and
which bonds to buy in order to hedge optimally. It takes hard work for Campbell and
Viceira (2001) and Wachter (2003) to prove that the resulting optimal portfolio converges
to long-term bonds as risk aversion rises to infinity.
    Furthermore, for less risk-averse investors, the optimal Mertonian portfolio mixes
market-timing, alpha-chasing, dynamic hedging, and risk-taking motives. Nowhere does
the portfolio approach state the obvious: “Long term bonds, not the short rate, are your
riskless asset. Split your investment between them and risky securities.”
   Think about explaining to a 10-year investor whose 10-year bonds have just nosedived,
that he didn’t really “lose” anything, that this was part of a state-variable hedging pro-
gram. If you focus instead on payoﬀs, it’s a much easier conversation. This fact seems
obvious, yet reflect how many long-run investors and their investment advisers regard
money-market investments, not indexed perpetuities, as their core “riskless” asset, eval-
uate bond managers by one-year returns relative to simple benchmarks or peers, and
rebalance their bond investments frequently.
   As a second example, consider an investor who says, “I want to invest in bonds and
stocks. I have a one-year horizon, and I can not lose more than 20%.” If you look at payoﬀs,
the answer is obvious: buy one-year, 20% out-of-the-money protective put options. If you
ask the Mertonian stock vs. bond portfolio allocation question, you will rediscover the
dynamic trading strategy that replicates put options. To the investor, that synthesis is a
complex dynamic strategy, buying and selling as the market goes up and down. It looks
suspiciously like technical-analysis alpha-chasing, and is in fact inexorably mixed with the
dynamic alpha-exploitation that dynamic portfolio theory recommends on top of the put
option.
    Furthermore, the portfolio strategy will change depending on whether the investor
can trade options, where bid/ask spreads and other transactions costs are larger, what
strikes and expiries are available, which index he wants to follow and what options on
it are available (not all indices and semi-passive strategies have the rich set of options
available for the S&P500), and so forth. The financial engineering of the cheapest way
to synthesize a given payoﬀ gets mixed up with the economic question of which payoﬀs
to deliver in the first place. In an incomplete market, much of what may seem like in-
teresting dynamic portfolio theory is merely economically uninteresting (but technically
challenging) synthesis of the same payoﬀ (say, a put option) by other means (dynamic


                                             6
trading) when the desired payoﬀ is not directly traded.
    Similarly, coupon-only after-tax inflation-protected bonds don’t exist. In current mar-
kets, they have to be synthesized. A cost-eﬀective synthesis might involve a fairly compli-
cated combination of Treasuries, TIPS, their strips, municipal bonds and inflation swaps.
It would depend on the nature of the risky portfolio as well, whether it already includes
long-run corporate or municipal bonds. It’s easy for an investor and his adviser to agree
that indexed coupon-only bonds are conceptually the right “riskfree asset” on which to
found the investment program. The investor really doesn’t have to know much about
the synthesis of this payoﬀ in order to make the important policy decision. Likewise,
“synthesize a coupon-only indexed strip” is a clearer direction for the adviser to give to
the financial engineering department than is “implement Merton portfolio theory for this
investor.”
    This separation of payoﬀs from the market-dependent dynamic portfolio and payout
strategies that generate payoﬀs corresponds to a sensible separation of functions in asset
management. The investor needs to think about risk and return, and find (with help)
the optimal payoﬀ. The manager then worries about the financial engineering of how
to construct that payoﬀ by dynamic trading and state-variable hedging in the currently-
available set of liquid assets. That financial engineering is undoubtedly hard, and worth
its fee.
    Markowitz (1952) mean-variance theory and Merton’s (1969, 1971a) dynamic exten-
sion really function as “benchmark characterizations” as well. Though Markowitz derived
the mean-variance frontier more than 60 years ago, we still have no settled way to com-
pute that frontier in real-world situations. Yes, we have a simple formula  = Σ−1 
( = weights, Σ = excess return covariance matrix,  = mean excess returns,  = risk
aversion), but this formula is essentially useless in practice.
                                                         √      The hurdles of estimating
large covariance matrices, overcoming the curse of   in estimating mean returns,
and dealing with parameter uncertainty and drift, are not minor matters. Computation
is approached diﬀerently for diﬀerent asset classes, trading restrictions, data sets, time
horizons, conditioning information sets, parameter priors, and all the other peculiarities
of a given application. The results of Σ−1  are so sensitive to input assumptions that
commercial optimizers and both regulatory and commercial risk management calculations
add layers of ad-hoc constraints, so many layers that the answers barely merit being called
implementations of Σ−1 . Much of the money management industry amounts to selling
one or another attempted solution to estimating and computing Σ−1 , at fees commensu-
rate with the challenge of the problem. The weights Σ−1  can change dramatically when
you include or exclude assets, though the characterization does not.
    Why then is mean-variance theory then so famous? Classical one-period mean-variance
analysis is really a brilliantly useful characterization of an optimal portfolio, useful for
final investors to understand and think hard about risk allocations, and especially to avoid
mistakes like bucket investing, closet indexing, and underdiversification, even though it
is not a particularly useful guide to computation. Classical mean-variance analysis con-
tinues to dominate portfolio applications, even when investors are contemplating highly


                                             7
non-normal payoﬀs, such as with options, credit risk, or dynamic trading, and even when
investors have nonlinear marginal utility, especially including leverage, drawdown or other
constraints limiting their acceptable losses. Why? Well, it is a simple conceptual bench-
mark, and benchmarks are useful. It’s a good robust first step, even when the second step
is fairly large as well.
    Merton-style dynamic portfolio theory is an especially clear case of a benchmark char-
acterization. The actual portfolio weights depend on value function derivatives, which
are not known in most environments. Textbooks repeated the optimal portfolio in terms
of unknown value-function derivatives for 30 years before the first attempts, cited above,
to actually compute those derivatives for simple environments. Evidently, the Merton
characterization of portfolios was and remains a conceptually valuable benchmark even
without full solutions or realistic computations.


2.2    Dynamics and traded assets

On the other hand, the dynamic portfolio strategies that investors use to implement
optimal payoﬀs can be trivial. If indexed perpetuities and a long-run mean-variance
eﬃcient payoﬀ were traded — or if financial firms created them, as they created index funds
— then investors would simply buy those payoﬀs. Investors would not even rebalance over
time. Dynamic portfolio theory is only hard when, for some reason, the supply side of
the market does not directly provide the payoﬀs of interest to investors.
    This observation gives an extreme example of how sensitive portfolio strategies are to
changes in the market structure, and suggests again why calculating dynamic strategies is
an (important) financial engineering question rather than the way to generate economic
intuition.
    This observation also suggests that thinking about optimal payoﬀs will be useful for
creating securities, or for explaining existing market structures. If more investors were
asking for coupon-only real bonds, more securities firms would sell them, and the investor’s
“dynamic portfolio theory” would become the firm’s risk management problem. More
basically, why do stocks pay dividends and bonds pay coupons? Consumers could in
principle synthesize such securities from dynamic trading of stocks that repurchase shares
instead of paying dividends and zero-coupon bonds. But if dividends and coupons reflect
the optimal final payouts many consumers desire, it may be less surprising that these are
the basic marketed securities.


2.3    The market portfolio

Expressing portfolio theory relative to the market is an especially useful discipline. Port-
folio theory seems to apply to everyone. But the average investor must hold the market
portfolio, and consume from the market payoﬀ, ignoring all tempting dynamics or addi-
tional factors. All deviations from market weights are a zero-sum game. For every investor

                                             8
who earns positive market alpha, another one must earn negative alpha. We can’t collec-
tively market-time. We can’t even collectively rebalance. Therefore, any deviation from
market weights that we recommend to A must be mirrored in opposite advice given to
B. If the advice applies to everyone, the equilibrium expected returns and covariances
underlying the advice must change as soon as any measure of investors take the advice,
and the advice will evaporate. If the advice seems to apply to everyone, maybe it’s wrong.
    Phrasing portfolio advice in terms of deviations from the market portfolio, driven by
deviations of the investor from average, along described dimensions of heterogeneity such
as risk aversion or exposure to outside risks, helps to preserve portfolio advice from this
average-investor conundrum. By phrasing portfolio advice based on diﬀerences between
individual and average preferences, outside risk exposures, and other characteristics, we
implicitly trace back seemingly attractive prices to economic fundamentals of why the
rest of the market seems to oﬀer our investor a good deal.
   Such a description may also be of practical use. Investors may not be able to answer
well “what’s your risk aversion?” but they may be able to answer “are you more or less risk
averse than the average investor?” (Of course, they must answer that question with a bit
more consistency than “are you smarter or better informed than the average investor?”)
Even in standard one-period mean-variance problems, phrasing portfolio maximization in
terms of deviations from the market portfolio is a standard way to get vaguely sensible
answers, i.e. answers that don’t deviate enormously from market weights.


2.4    Outside income

Incorporating outside income or assets into portfolio theory is important. Real investors
have houses, jobs, businesses, illiquid assets, assets that cannot be sold for tax, regulatory,
or other reasons, or similar non-marketed liabilities (pension funds, endowments). These
investors should start by hedging non-marketed risks. The zero-price, zero-premium hedge
payoﬀ most correlated with their outside income represents free insurance, risk reduction
without any reduction in expected return.
   Outside-income hedging by the average investor leads to changes in the market pre-
mium and the emergence of additional priced factors. Non-exposed investors can profit
by adapting their portfolios and payoﬀs, eﬀectively selling insurance.
   In this way, incorporating outside income leads to an interesting and fruitful portfolio
theory, one that predicts substantial heterogeneity in portfolios without violating the
average-investor conundrum or attempting to chase zero-sum “ineﬃciencies.” And, since
hedging outside income, and understanding the priced risks that emerge from other’s
hedging, is not easy, incorporating outside income represents a privately and socially
beneficial activity for the financial advice industry.
   These ideas have been present since the early days of modern portfolio theory and
asset pricing Mayers (1972), (1973) for example. On the idea that labor income looks like
a bond, investors are often advised to move away from stocks as they approach retirement.

                                              9
Roll and Ross (1984) advocated that individuals and institutions calibrate APT exposures
to their specific risks or liability streams, and that professional advice might be helpful in
doing so. Fama and French (1996) attribute the value premium to investors whose human
capital is correlated with value returns. Those investors shun value stocks, generating the
premium for the lucky investors whose outside income is not so exposed, and who then
buy value stocks.
    Incorporating outside income is hard. Most fundamentally, we can observe the stream
of outside income, but we cannot easily observe its value. To apply standard return-
based portfolio theory, one has to turn the income stream into a price. For example,
Jagannathan and Wang (1996) assume an AR(1) labor income process and a constant
discount rate, so that labor income growth measures human capital returns. However,
price changes unrelated to current cash flows dominate high-frequency asset returns for
assets whose prices we do observe, so they are likely to do so for non-traded assets as well.
The AR(1), constant discount rate procedure would do a poor job of replicating observed
stock returns from the stock dividend stream.
    In addition, outside-income growth is not likely to be i.i.d., so outside-income state
variables need to defined, modeled, and hedged as well as the income stream itself in order
to find the optimal dynamic portfolio. Assets are valuable if their returns are negatively
correlated with shocks to forecasts of future outside income or outside-income discount
rates, both tricky concepts to measure.
    These diﬃculties notwithstanding, a large literature incorporates outside income or
assets into intertemporal portfolio theory, typically further generalizing the Mertonian
dynamic-programming instantaneous-portfolio approach. Here too, we do not have an
analytic solution to the most basic problem: power utility, lognormal i.i.d. returns, and
a lognormal diﬀusion for outside income. (Duﬃe, Fleming, Soner, and Zariphopoulou
(1997) and Koo (1998) characterize this problem.) A bit more progress has been made
with CARA utility (Svensson and Werner (1993), Teplá (2000), Henderson (2002, 2005)),
which alas is not much more realistic than quadratic. Most of the applied literature
studies numerical or approximate solutions to particular calibrations. Highlights include
Campbell (1996), Heaton and Lucas (2000a), (2000b), Davis and Willen (2000, 2001),
Munk (2000), Viceira (2001), Lynch (2001), Flavin and Yamashita (2002), Gomes and
Michaelides (2005), Yao and Zhang (2005), Davis, Kubler and Willen (2006), Benzoni,
Collin-Dufresne, and Goldstein (2007) and Lynch and Tan (2011). A robust consensus is
even more remote than it is for intertemporal portfolio theory.
    Even in this extensive literature, most attention is still devoted to the simple stock/bond
and long bond/short bond split. The important question, characterizing which risky port-
folios hedge the risky components of outside income, remains essentially untouched. In
part, that question is hard because it must recognize the heterogeneity of outside income
across investors: If we all have the same outside income, the average-investor theorem
says that we just hold the market portfolio.
    Outside-income hedging is almost as widely ignored in practice as is Mertonian state-
variable hedging. Steel workers, and their pension funds, do not short the steel industry

                                             10
portfolio, or even the auto industry. Asset managers are only beginning emerge with
expertise in this hedging, selling individual-specific hedging portfolio services. Acad-
emic research has focused almost entirely on finding “priced” factors, alphas for the one
lonely (and typically myopic) mean-variance investor who has no outside income. It has
ignored finding non-priced factors well-correlated with typical outside income streams,
that, by providing free insurance, are potentially the most important deviations from
market weights for typical investors.
   In this context, it is attractive that the payoﬀ characterization with outside income is
quite simple. We just add the hedge payoﬀ for outside income, constructed by long-run
regression. The long-run regression is a regression of outside income streams or payoﬀs on
asset payoﬀs — pure “cashflow beta.” Intermediate prices — which we do not observe for
the outside income stream — do not appear. State variables for outside income dynamics
do not appear in optimal payoﬀs or in equilibrium pricing.
    Background risk eﬀects are also absent here. Breaking outside income to a tradeable
(hedge payoﬀ) and nontradeable (idiosyncratic) component, the latter does not appear.
In general, agents who have to hold an unspanned component of outside income risk may
act in a more risk-averse manner. By the assumption of quadratic utility, this eﬀect is
absent in mean-variance settings. Again, the point of a simple benchmark is to start with
the most basic eﬀects, and to avoid complex, though potentially important, refinements.


3    Literature: Complete markets and quadratic utility
This long-run mean-variance and equilibrium analysis builds on three other strands of
literature.
    First, the final-payoﬀ view of dynamic intertemporal portfolio theory, the equivalence
of static and dynamic optimization emphasized by my notation ̃() in (1), and the
potential to characterize final payoﬀs quickly without solving for the dynamic strategy
that supports them, are of course well known in the complete-markets tradition.
    In a complete market, there is a unique discount factor { } which summarizes the
available asset-payoﬀ space, and optimal payoﬀs consist simply of inverting 0 ( ) =  ,
where  is the Lagrange multiplier on the wealth constraint. Cox and Huang (1989), He
and Pearson (1991), He and Pagès (1993), Schroder and Skiadas (1999), Wachter (2003),
Sangvinatsos and Wachter (2005) and many others follow this approach, which really
traces back to Arrow and Debreu (1954).
    This approach has not as yet been of widespread use in incomplete-market setups,
however. In incomplete markets, there are an infinite number of potential discount factors
 that are consistent with the available prices and payoﬀs. To complete the solution
for optimal payoﬀs, one must search for which choice of  produces a tradeable payoﬀ
 from 0 ( ) =  . This search can be as hard as solving the dynamic program that
constructs  as the payoﬀ of a dynamic portfolio strategy.


                                            11
     The restriction to linear marginal utility underlying mean-variance analysis avoids this
central problem. The discount factor ∗ that is also a traded payoﬀ is unique. If 0 ( )
is linear, then inverting 0 ( ) = ∗ expresses  as a linear function of a traded payoﬀ,
so  is also a traded payoﬀ. Classical mean-variance analysis has always handled market
incompleteness transparently, and by mapping classical mean-variance analysis to payoﬀ
streams, this extension handles market incompleteness transparently in the same way.
    Most modern finance theory is recast in contingent-claim language, in which state-
and time-contingent payoﬀs replace moments such as mean, variance, and betas as the
basic commodities over which preferences and budget constraints are defined. Hansen and
Richard (1987) made the key connection between contingent claims and the mean-variance
frontier, and valid in infinite-dimensional payoﬀ space such as results from dynamic trad-
ing. As a minor pedagogical contribution, one can replace all the ̃ back to , and this
paper derives the propositions of classical mean-variance theory in one place, including
outside income and preference shocks, and from this contingent-claims perspective.
    Second, the basic idea of treating a discounted sum as a generalized “expectation” in
(1) comes from Hansen (1987), who includes an extensive analysis of asset pricing with
quadratic utility. In particular his Equation (1.8), p. 212 introduces the conditional inner
product
                                                ∞
                                                X
                                    h|i ≡                                        (2)
                                                =1

which is proportional to the long-run second moment ̃() as I have defined it in (1).
Hansen introduces the Hilbert space of payoﬀs with h|i  ∞. He posits complete
markets, solves the quantity dynamics, and studies allocations in equilibrium. My Propo-
sition 1 is a generalization of his Equation (2.13), p. 218. Hansen shows that individual
consumption is proportional to aggregate consumption in equilibrium (Equation (2.33) p.
222). Hansen and Sargent (2004) extends this asset pricing framework (see p. 55. and p.
108).
     Magill and Quinzii (2000) is the precursor most directly related to this paper. Magill
and Quinzii also specify a quadratic utility investor. Like Hansen (1987), they define the
inner product (2) and consequent Hilbert space of payoﬀs. With complete markets, they
also show (their Proposition 1) that in equilibrium each investor’s payoﬀ (consumption) is
a combination of the risk free rate and the aggregate endowment stream. They generalize
this statement (their Proposition 2) to a market that is missing a risk-free payoﬀ, though
it is still complete enough that investors can perfectly hedge idiosyncratic income shocks.
They show that a “least-variable” payoﬀ, the projection of the unit payoﬀ on the set of
traded payoﬀs, takes the place of the riskfree payoﬀ in this equilibrium representation.
    At one level, one can regard this paper as a substantial extension of Hansen (1987)
and Magill and Quinzii’s (2000) results. I characterize portfolios out of equilibrium, e.g.
when other agents do not have quadratic utility. I allow arbitrary market completeness
including unhedged idiosyncratic income. I allow preference shocks. I define the long-
run mean-variance frontier, and I show that optimal payoﬀs lie on it. I express long-run
pricing as well as optimal payoﬀs, showing how the long-run CAPM and long-run two-

                                             12
factor model emerge, with average outside income becomes the second factor.
   Most of all, I express the portfolio results in terms of risk aversion, and relative to mar-
ket averages, connecting the quadratic utility representation to standard mean-variance
portfolio theory.
    On the other hand, the major point of this paper is that none of these results are, in
retrospect, big theoretical contributions. Once you write down the definition of long-run
mean (1), all of standard one-period mean-variance theory applies directly and essentially
trivially to payoﬀ streams. That notation makes the theory come alive, and it paints
a novel picture of long-run portfolios and equilibrium. But it reveals that this whole
endeavor is a relabeling of classic mean-variance analysis rather than a basic theoretical
advance.
    Third, this eﬀort is part of a larger new interest in payoﬀ streams and long-run analysis
in asset pricing, for example Menzly, Santos and Veronesi (2004), Bansal and Yaron (2004),
Bansal, Dittmar and Lundblad (2005), Lettau and Wachter (2007), Gabaix (2007), Hansen
Heaton and Li (2008), and many others. These authors try to account for prices rather
than expected returns, based on the long-run correlations of cash flow streams, rather
than one-period return betas. This paper’s characterization of long-run expected yields
by a long-run (cashflow) beta is a simple expression of these ideas.


4     Asset pricing environment
This section sets up the framework to think about dynamic intertemporal portfolio prob-
lems in analogy to one-period problems, by treating date and state symmetrically.
    To describe the asset pricing environment, the mean-variance frontier, and its connec-
tion to beta representations, I follow the Hansen-Richard (1987) approach as expanded
in Cochrane (2005) Ch. 5 and 6. This approach makes clear the intimate link between
marginal utility, mean-variance frontiers, and discount factors, and applies to infinite-
dimensional payoﬀ spaces generated by dynamic trading.
   For readers anxious to get to optimal payoﬀs, the key results that I use later are
the existence of a traded discount factor ∗ (9) and its corresponding yield  ∗ (12), the
characterization of the mean-variance frontier in (18) and (20), and the long-run Roll
theorem connecting mean-variance frontiers and beta representations (21).


4.1    Payoﬀs and prices

I develop a notation that uses the same symbols to describe familiar one-period returns
and to describe streams of payoﬀs in an intertemporal context. The Appendix summarizes
all notation.
    The symbol  denotes a payoﬀ. In a one-period setting, the payoﬀ is the amount 1

                                              13
that an investor receives at date 1, in each state of nature, for a time-zero price 0 . In an
intertemporal setting, payoﬀs are the streams of dividends { } = {1  2  }, or { }
in continuous time, resulting from an initial purchase at price ({ }), and indexed by
state and date.
    Returns are price-one payoﬀs. We form returns by dividing payoﬀs by their initial
price,
                                   =  ({ })
In the intertemporal setting, the “return” to a particular date — the dividends or coupons
accruing to a one-dollar purchase — has the units of a yield, or coupon rate; it is a number
like 0.04, not 1.04. In an intertemporal context, I use the notation  and the word “yield”
rather than the letter  or word “return,” to help keep the typical units in mind.
   In a one-period model, the risk-free asset pays one unit in each state. The risk-free
payoﬀ in an intertemporal setting is one in all states and dates, a perpetuity,

                                              = 1

The risk free yield is then naturally,

                                          = 1({1})

 The riskfree yield is also a number like 0.01, not a number like the 1.01. (The presence of
such a long-run risk free payoﬀ does not imply that one-period riskless bonds are traded,
or that a one-period riskless rate is constant.)
    Excess yields are zero-price payoﬀs, which we can construct by diﬀerencing any two
yields,
                                 = 1 − 2 ;  ({ }) = 0
When not required for clarity, I drop the time subscripts and sequence notation, e.g.
 ≡ { } and  ({ }) = ().
    I use the notation ̃() to denote a sum over time as well as expectation over states
of nature. The meaning depends on context:
                                                             1
                                One period:          ̃() ≡   (1 )
                                                             
                                                                       ∞
                                                              1− X
                    Intertemporal, discrete:         ̃() ≡                
                                                                     =1
                                                                   Z ∞
                 Intertemporal, continuous:          ̃() ≡            −  
                                                                    =0

One can similarly define ̃ in environments with a terminal date, e.g.
                                                    Z 
                                            
                             ̃() ≡                    −  
                                         1 − −    =0

or with a separate lump-sum terminal payment.

                                                14
    The ̃ operator takes a sum over time, weighted by   or − , as well as a sum over
states, weighted by probabilities. Weighting allows us to produce finite values for a larger
set of payoﬀ processes in an infinite-period environment. It will be useful to pick  or
 as the agent’s subjective discount factor, as it is useful to use the agent’s subjective
probabilities to take expectations. One can weight over time by diﬀerent functions, as
one can weight over states of nature by alternative probability measures.
   I call ̃() the “long run mean” and I call
                                         h      i2          ½h       i2 ¾
                        2           2
                       ̃ () ≡ ̃( ) − ̃()       = ̃     − ̃()

the “long run variance” of the payoﬀ stream  . This “variance” concept measures stability
over time as well as stability across states of nature.
   With this notation, I write the fundamental pricing equation as

                                         = ̃()

where  is a stochastic discount factor. Relative to standard notation,  is the discount
factor scaled by the weighting function;  is 0 ( ) not   0 ( ). In each context, this
expression has a slightly diﬀerent meaning and value of the constant :

                         One period:   0 = (1 1 ) =  ̃(1 1 );
                                             X∞
                                                              
             Intertemporal, discrete:  =           =      ̃();
                                             =1             1−
                                             Z ∞
                                                                     1
           Intertemporal, continuous :  =       − ()() = ̃()
                                              0                      
The appearance of a constant  in the fundamental pricing equation is inelegant. However,
we gain more in convenience by defining “long run mean” with weights that sum to one
than we lose by introducing this constant in the pricing equation.
    Next, I describe payoﬀs and prices. Let  denote the payoﬀ space, the set of all payoﬀ
streams that investors can buy. Let  denote the set of price-one yields, and let  denote
the set of price-zero excess yields,

                                   ≡ { ∈  : () = 1} 

                                   ≡ { ∈  : () = 0} 

   I limit the payoﬀ space  to include only square—summable or square-integrable payoﬀs

                                         ̃(2 )  ∞.                                      (3)

In an infinite-period model, this requirement limits us to payoﬀs that do not grow too
fast, i.e. that do not vary too much over time, as well as limiting variance in the usual
sense. With this assumption ̃() is an inner product defining a Hilbert space as in
Hansen (1987), Hansen and Richard (1987), Hansen and Sargent (2004) and Magill and

                                              15
Quinzii (2000). Then, we can think of dividend streams  as vectors, ̃() as an inner
product, ̃(2 ) as the “size” of  and ̃ [( − )2 ] as the “distance” between  and .
   I let investors buy any portfolio of payoﬀs, which means that  and  are closed
under linear combinations,
                                ∈  →  +  ∈                            (4)
and I assume that prices and payoﬀs follow the law of one price, or that the pricing
function is linear,
                            ( + ) = () + ()                          (5)

    In an intertemporal context, we also want to allow dynamic trading, or equivalently we
want to allow investors to form and entrepreneurs to sell the payoﬀs of managed portfolios.
We can capture this expansion of the payoﬀ set by allowing state-contingent buying and
selling. If { } ∈ , we also allow any payoﬀ stream created by selling an existing payoﬀ,

                               {0   −1   +  ()} ∈                        (6)

or any stream created by buying a payoﬀ in mid-stream,

                             {0  −  () +1  +2 } ∈                    (7)

   In the standard continuous-time context, given a set of assets with excess return
process  and riskfree rate   we can include dynamic trading by allowing payoﬀs 
generated by a cumulative value process  and a payout policy  ,
                                      ³             ´
                                =   −   + 0                          (8)

As usual, we must limit dynamic trading so that the investor cannot generate arbitrage
opportunities by trading too frequently, by rolling over debt forever or following doubling
strategies. See, for example, Duﬃe (2001). (Section 8 gives an example.)
    I do not assume that the payoﬀ space  is complete, meaning that every stream of
random variables can be traded. I explicitly allow for two sources of incompleteness: the
investor may have a labor or business income stream that cannot be completely hedged
with traded assets, and there may be state variables for investment opportunities whose
shocks cannot be spanned by those of traded assets. I also consider the case that the
riskless payoﬀ is not traded.


4.2    Discount factor

The standard suﬃcient conditions (Ross (1978), Hansen (1987), Hansen and Richard
(1987)) on the payoﬀ space  guarantee the existence and uniqueness of a discount factor
that is also a traded payoﬀ. Given (3) and (4), linearity of the pricing function (5) holds
if and only if there is a unique discount factor ∗ that is also a traded payoﬀ stream, i.e.

                             ∃∗ ∈  :  = ̃ (∗ ) ∀ ∈ .                           (9)

                                               16
    When there is a finite vector of basis payoﬀs x with prices p, and ignoring dynamic
trading beyond what is included in the basis assets (the basis payoﬀs may themselves be
payoﬀs from dynamically-managed portfolios), so the payoﬀ space is  = {c0 x}, the usual
discount factor construction applies. The payoﬀ
                                               1 0
                                      ∗ =       x ̃(xx0 )−1 p                       (10)
                                               
is a discount factor, i.e. it satisfies  = ̃(∗ ).


4.3     Mean-variance frontier

The long-run mean-variance frontier consists of payoﬀs that solve

                                  min ̃( 2 ) s.t. ̃() = 
                                  {∈ }

The mean-variance frontier has a two-fund representation,

                                             =  ∗ +  ∗                         (11)

Here,  ∗ is defined by
                                              ∗          ∗
                                    ∗ =            =                                (12)
                                             (∗ )    ̃(∗2 )
and  ∗ is defined by
                                            ∗ = (1|)                           (13)
as the excess yield “closest” to the perpetuity payoﬀ.  is a number; as you vary  you
sweep out the frontier.
    The payoﬀs  ∗ and  ∗ have the usual properties from the one period case, suitably
reinterpreted. (Cochrane (2005) Ch. 6 gives a list of properties;  ∗ and  ∗ correspond to
∗ and ∗ there.) The yield  ∗ is the discount-factor mimicking yield: For any discount
factor , we have ∗ = (|) and then (12). The yield  ∗ is the minimum long-run
second moment yield,
                                   ∗ = arg min ̃( 2 )
                                                  {∈ }

It lies on the lower half of the mean-variance frontier. Since ∗ is proportional to ∗ it
can be used to price other payoﬀs:

                                  ̃( ∗ ) = ̃( ∗2 ) ∀ ∈  

More generally, any mean-variance eﬃcient yield carries pricing information.
   An explicit formula for  ∗ for the finite-basis case follows from (10) and mimics the
standard formulas for one-period mean-variance frontier returns:

                                               10 ̃(yy0 )−1 y
                                       ∗ =                                          (14)
                                               10 ̃(yy0 )−1 1

                                                   17
   The excess yield  ∗ generates long-run means in the same way that ∗ generates prices,

                                    ̃() = ̃( ∗ )∀  ∈                                  (15)

Since  ∗ is a price-zero excess yield,  ∗ and  ∗ are orthogonal, ̃( ∗  ∗ ) = 0 If a riskfree
yield is traded (1 ∈ ) then  ∗ is simply

                                                  − ∗
                                          ∗ =                                               (16)
                                                    
With a finite set of basis assets, we can also calculate  ∗ analogously to the calculation
(10) of  ∗ :
                                    ∗ = ̃(z)0 ̃ (zz)−1 z                            (17)
where z is a vector of excess yields.
    We can span the mean-variance frontier with any two eﬃcient payoﬀs in place of  ∗
and  ∗ given by (11). When a risk-free payoﬀ is traded, we can span the mean-variance
frontier by  ∗ and   , rather than  ∗ and  ∗ as in (11). Substituting (16) in (11) and
defining a new , we obtain
                                                      ³      ´
                                      =   +   ∗ −                                   (18)


    When a riskfree payoﬀ is not traded, one can use in place of  the minimum long-run
variance yield, the yield   =  ( ) of the constant-mimicking payoﬀ  ≡ (1|)
or the zero-beta yield corresponding to  ∗ . See Cochrane (2005) Ch. 6.
   The long-run mean-variance frontier of excess yields is defined by

                                   min ̃( 2 ) s.t. ̃() =                                (19)
                                  {∈}


This frontier is generated simply by

                                             =  ∗                                       (20)

Equation (17) transparently solves (19) for a finite set of basis assets z.
    As in standard mean-variance analysis, the mean-variance frontier of excess (zero
price) returns or yields is convenient, because it is always a V, not a hyperbola. Even if a
riskfree payoﬀ is not traded, the zero payoﬀ is always traded — invest nothing, get nothing
— so one does not need to keep track of riskfree asset special cases. The mean excess
yield or return is also a real quantity, where asset yields and returns include inflation.
Finally, excess returns and yields are full spaces so one does not need to keep track of the
constraint that portfolio weights must sum to one (compare (17) to (14)) and (|)
is meaningful, where projecting on yields or returns is not.
   All of these results can be derived by following exactly the Hansen-Richard (1987)
approach in one-period models, but using ̃ in the place of . We show that any yield

                                                 18
  can be written as   =  ∗ +   ∗ +   , with ̃( ) = 0, ̃(   ∗ ) = 0 ̃(   ∗ ) = 0. The
mean-variance frontier is then the set of yields with   = 0
    Traditional mean-variance formulas in terms of covariances also have straightforward
translations. For example, in the case of a finite basis, we can write the mean-variance
frontier of excess yields in the obvious analogue to the traditional formula   = 0 Σ−1 
                  g (z z)−1 z, rather than in second-moment form (17).
as   = ̃(z)0 


4.4     Expected yields and betas

As in one-period asset pricing, we can connect discount factors, pricing, mean-variance
frontiers, and expected yield-beta models. As usual, the formulas look familiar, but the
novelty is that standard analysis applies to long-run moments and streams of payoﬀs.
    The main proposition I will use below is a simple case of Hansen and Richard’s (1987)
statement of Roll’s (1977) theorem for infinite-dimensional payoﬀ spaces: If a riskfree rate
is traded, then a single-beta representation holds for each asset ’s long-run expected yield
with respect to yield   ,
                                                         h              i
                                ̃(  ) −   = ̃ ̃(  ) −                               (21)
if and only if   is on the long-run mean-variance frontier and   is not the riskfree
yield, i.e. if                                   ³          ´
                                   =   +   ∗ −  
and  6= 0.


      Derivation. We can decompose any excess yield as
                                              =   ∗ +  
      where we choose  so that ̃(  ∗ ) = 0. By (15), we then also have ̃(  ) = 0,
      so  = ̃ ∗ is the long-run regression coeﬃcient of   on  ∗ with a constant.
      Equation (20) characterizes the mean-variance frontier of excess yields,   =
        ∗ . So long as  6= 0 we can then write
                                                   
                                           =        + 
                                                 
      and ̃  =   is the long-run regression coeﬃcient of   on   with a
      constant. Taking long-run means, we have a single-beta representation with
      any long-run mean-variance eﬃcient excess yield as reference,
                                         ³ ´
                                      ̃   = ̃  ̃ (  ) .
      With a riskfree payoﬀ we can take   =   −   ;   =   −   by (16) and
      (18), and ̃  = ̃  .
         Long-run regression coeﬃcients and long-run covariance sum over time as
                        g
      well as states, (                                    g
                               ) = ̃()− ̃()̃(); ̃ = ( )̃ 2 ().

                                                    19
    The case with no riskfree payoﬀ works just as in the one-period setup, with a zero-beta
rate taking the place of   and the exception that the mean-variance eﬃcient reference
yield cannot be the minimum long-run variance yield. Hansen and Richard’s (1987), p.
600-611 proof works, translating the notation. The larger set of beta representations in
Cochrane (2005) Ch. 5 and Ch 6 translate as well.


5      The general portfolio problem
An investor has initial wealth  , a stream of human or other non-marketable income
 = { }, and he can buy payoﬀs  = { } ∈  at prices . I assume the law of
one price (5) in the available prices and payoﬀs, so there is a discount factor  that
satisfies  = ̃(). I specify time-separable expected-utility preferences. The investor’s
problem is then
                       max ̃ [()] s.t.  = ̃()  =  +                       (22)
                            {∈}


   As a reminder, though the symbols look like a one-period problem, they stand for
long-run portfolio problems, for example
                        ∞
                        X                                        ∞
                                                                 X
              max              ( ) s.t.  = ({ }) =              ;  =  +  
             { ∈}
                        =1                                      =1

or
                  Z ∞                                            Z ∞
                        −
        max                 ( ) s.t.  = ({ }) =             −   ;  =  +  
        { ∈}   =0                                             =0


     The first-order conditions state that at an optimum ̂,

                                            0 (̂ + ) =                                            (23)

where  represents a Lagrange multiplier on the wealth constraint. Marginal utility is
proportional to a discount factor.
     Inverting (23), the solution to the portfolio problem is characterized by

                                           ̂ = 0−1 () −                                           (24)

I use a hat ̂ to denote optimal values.
   The payoﬀ (24) has a simple intuition: The investor consumes more  = ̂ +  in
“cheap” (low ) states and dates, and less in “expensive” (high ) states and dates,
with 0−1 dictating how much or little to respond to this relative date- and state-price.
The traded payoﬀ ̂ then oﬀsets the eﬀects of outside income . The Lagrange multiplier
 scales the optimal payoﬀ up and down to match initial asset-market wealth  .
   If markets are complete, the discount factor  = ∗ ∈  is unique, and traded. Also,
the nonlinear transformation and addition described by (24) lead to traded payoﬀs, so

                                                   20
the constraint ̂ ∈  is satisfied. All we have to do is find the Lagrange multiplier  to
satisfy the initial wealth constraint.
    I focus on the case that markets are not complete. Now, condition (24) is necessary,
but not suﬃcient. There are many discount factors  that price assets, and for only one
of them does the construction (24) produce a traded payoﬀ ̂ ∈ . We still have to find
that .
    To solve this problem, I specialize to quadratic utility, so that marginal utility is linear.
The payoﬀ space  is closed under linear transformations (portfolio formation, equation
(4)), so once we construct the traded discount factor ∗ , we know that 0−1 (∗ ) is also
in the space of payoﬀs , and this is the optimal payoﬀ.
   Analytically, I specialize to
                                               1
                                     ( ) = − ( −  )2                            (25)
                                               2
 is a potentially time-varying stochastic bliss point. A time-varying or stochastic prefer-
ence shift can help to accommodate growth, life-cycle and household-composition eﬀects,
or to give a better approximation to nonlinear utility functions. (Hansen and Sargent
(2004), Heaton (1993), Cochrane (2012b).) I do not allow free disposal.
   The optimal payoﬀ is then characterized by

Proposition 1. The optimal payoﬀ for the investor (25) is given by
                                   ³        ´   h              i
                             ̂ =  −  − ( − ) −   ∗                                (26)
where the hedge payoﬀs  ,  are the projections of the preference shock and outside income
on the set of traded payoﬀs, e.g.
                                        ³       ´
                              ≡   |   ≡  (|)                               (27)
 is initial financial wealth, and  ∗ is the discount-factor mimicking and minimum
second-moment yield (12).


      Derivation. With the quadratic utility function (25), the first order condition
      (23) reads
                                   − ̂ −  = 
      Solving for ̂ and projecting both sides on the set of traded assets  yields
                                       ̂ = −∗ +  −                             (28)
       The wealth constraint states
                               = (̂) = −(∗ ) + ( − )
      Solving for , substituting  in (28), and using the definition  ∗ = ∗ (∗ )
      we obtain the optimal payoﬀ (26).


                                                21
    The expression (26) oﬀers a simple interpretation in the quadratic utility context: The
investor starts by buying a payoﬀ  −  that gets consumption as close to the bliss point
as traded assets allow. We can also think of the payoﬀ  −  as the optimal hedge for
preference shocks and labor income risk. It is formed by a long-run regression of the
streams  and  on the yields or dividend streams of the traded assets.
   Typically, initial wealth  is lower than the cost ( − ) of this ideal hedge payoﬀ.
Then, the investor shorts an optimal risky payoﬀ  ∗ in order to buy the individual hedge
payoﬀ. The yield  ∗ is proportional to contingent claims prices, so by shorting  ∗ the
investor is shorting the “most expensive” payoﬀ, in order to generate the largest funds
possible at minimum risk. The yield  ∗ is also on the mean-variance frontier.
   In sum, each investor’s optimal payoﬀ is a combination of a labor-income and preference-
shock hedge payoﬀ, plus an investment in a long-run mean-variance eﬃcient yield.
   This statement makes no restriction on the set of traded assets. In particular, the
proposition holds whether or not a riskfree payoﬀ is traded.


6     The classic case with no outside income
Equation (26) is the most general statement of the formal portfolio results in this paper.
However, equation (26) is a long way from traditional statements of mean-variance analy-
sis, and the intuition that it expresses is closely tied to quadratic utility. Since intuition is
most of the point of the paper, I rewrite (26) as a long-run version of standard statements
of mean-variance analysis: I write the result in terms of the yield (“return”) of the optimal
payoﬀ; I characterize preferences by risk aversion rather than by a bliss point; I express
the optimal payoﬀ in reference to a mean-variance eﬃcient payoﬀ on the upper part of
the frontier, rather than the minimum second moment yield  ∗ which is on the lower
part of the frontier; I express the optimal payoﬀ as a set of distortions to mean-variance
eﬃciency induced by nontraded income and preference shocks; and I express the optimal
payoﬀ relative to the market yield. I also describe the equilibrium pricing that results as
CAPM or two-factor model.


6.1    Mean-variance frontier

I start with the special case that the investor has no hedgeable outside income or preference
shocks. This classic special case simplifies the formulas a great deal, and shows the
structure of the main ideas. The case with outside income and preference shocks then
follows as a natural generalization.
    Proposition 2 oﬀers a more familiar expression of mean-variance portfolio ideas for
this case:




                                               22
Proposition 2. If the bliss point hedge payoﬀ  is constant,  = ̄ , the outside-income
hedge payoﬀ  = 0 and the riskfree yield   is traded, then the yield ̂ of the investor’s
optimal payoﬀ is on the long-run mean-variance frontier,
                                                1³     ´
                                   ̂ =   +      − ∗                                    (29)
                                                
where  is the investor’s coeﬃcient of risk aversion,

                                       1   ̄ −   
                                         ≡                                                  (30)
                                               



     Derivation. Since ̄ is constant and a riskfree rate is traded, (̄ ) = ̄   .
     Then, from (26),
                                       "             #
                                       ̄
                                   
                          ̂ = ̄ −  −   ∗
                                      
                                                 "        #
                                 ̂       ̄      ̄
                          ̂ =      =   −  − 1 ∗
                                                 
                                     "          #
                                          ̄     ³     ´
                          ̂ =   +  − 1   −  ∗ 
                                        

     and (29) follows. From the characterization of the long-run mean-variance
     frontier given in Equation (18), equation (29) describes a long-run mean-
     variance eﬃcient payoﬀ.


   For quadratic utility, the relative risk aversion coeﬃcient at consumption  is

                                  1       0 ()    − 
                                      ≡ − 00     =        
                                 ()     ()       

Thus, we interpret  as defined by (30) as the local risk aversion coeﬃcient, evaluated
at a value of consumption which can be obtained by investing all wealth in the riskfree
payoﬀ.
    Since  ∗ as minimum long-run second-moment yield is on the lower portion of the
mean-variance frontier, expression (29) places the reference mean-variance eﬃcient payoﬀ
on the more familiar, upper, portion of the frontier. We see a greater investment in this
risky payoﬀ for investors with lower risk aversion. The yield  ∗ is a particularly nice
reference point for the mean-variance frontier, because the risky payoﬀ weight is then
the inverse of the relative risk aversion coeﬃcient. The yield − ∗ is not the yield on the
market payoﬀ, however, unless average risk aversion happens to be one.


                                                23
   With a finite set of basis assets, (17) gives us an explicit expression of the optimal
payoﬀ,
                                                          −1
                       ̂ =   +  ∗ =   + ̃(z)0 ̃ (zz0 ) z
                                              

    Proposition 2 is a result about long-horizon portfolio theory, in an environment with
time-varying investment opportunities and incomplete markets. Yet the dynamic trading,
rules for re-allocating wealth to securities based on state variables, and hedging demands
for shocks to those state variables are absent from this representation. These demands
can appear, in the synthesis of the mean-variance eﬃcient payoﬀ, if the market does not
already oﬀer the optimal payoﬀs, just as dynamic trading may be used to synthesize
options that are not directly traded. But those demands do not appear in the description
of the payoﬀ itself. Similarly, the “risk aversion” governing payoﬀ allocation in (29) is
constant through time, though actual consumption and local risk aversion vary through
time. The investor does not rebalance in response to such changes.
   If a riskfree payoﬀ is not traded, we can span the mean-variance frontier with the
constant-mimicking payoﬀ in its place:

Proposition 3. If the bliss point  is constant  = ̄ and the outside-income hedge
payoﬀ  = 0, then the yield of the optimal payoﬀ is on the long-run mean-variance frontier
                                                1 
                                   ̂ =   +     ( −  ∗ ) 
                                                
where  is the investor’s coeﬃcient of risk aversion,

                                     1   ̄ − ( )
                                       ≡                
                                            ( )

 ≡ (1|) is the constant-mimicking payoﬀ, and   ≡  ( ) is its yield

     Derivation. Since  is constant, but a riskfree payoﬀ is not traded, the pro-
     jection  is proportional to the constant-mimicking payoﬀ,  =   . Then,
     from (26),
                                          h                i
                          ̂ = ̄  − ̄ ( ) −   ∗
                                                  "              #
                               ̄ ( )      ̄ ( )
                          ̂ =             −              − 1 ∗
                                                   
                                      "                  #
                                       ̄ − ( )
                          ̂ =  +                 
                                                           (  −  ∗ )
                                            ( )




                                                24
6.2    Payoﬀs relative to the market

As in one-period setups, the average investor must hold the market payoﬀ. Therefore, it
is useful to express the optimal payoﬀ relative to the market payoﬀ, in an equilibrium in
which investors have limited and described forms of heterogeneity. This expression is also
useful because it’s easy to name and construct the market payoﬀ.

Proposition 4. If all investors are of this type, (quadratic utility, constant bliss point,
no outside income) the yield of each investor’s optimal payoﬀ is split between the riskfree
yield and the yield of the market payoﬀ,
                                                    ³         ´
                                   ̂ =   +         ̂ −                         (31)
                                                   
The yield on the market payoﬀ is defined by a wealth-weighted average
                                        P                   P
                                         ̂
                                                   ̂   ̂
                                ̂ ≡ P        = P     =     
                                                    
and it is a claim to the aggregate consumption stream. Aggregate risk aversion is defined
as a wealth-weighted average of individual risk aversions,
                                                   P   1
                                            1      
                                               ≡ P       
                                                  


      Derivation. Start with (29),
                                                   1 ³     ´
                                   ̂ =   +         − ∗ 
                                                   
      Sum over investors, and divide by wealth,
                          P                             P
                             ̂            
                                                   1 ³     ´
                           P            =  + P            − ∗
                                                
                                               1 ³        ´
                                  ̂   =  +      − ∗                        (32)
                                               
                                                   ³            ´
                             −  ∗ =  ̂ −   

      Substitute this result in the right hand side of (29).

   I use subscripts such as  and  to distinguish who holds a payoﬀ, and superscripts
such as     ∗    to diﬀerentiate assets.
   The infinitely risk-averse investor holds the perpetuity   , as pointed out by Campbell
and Viceira (2001) and Wachter (2003). An investor whose risk aversion is the same as
that of the average investor just holds the market payoﬀ, as he must, and that market
payoﬀ pays aggregate consumption as its dividend.

                                                       25
   The infinite risk aversion and average-investor theorems hold in more general models.
The novelty here is a way of drawing the line between these two extremes: investors
with risk aversion greater than average, but still finite, purchase a payoﬀ that is a linear
combination of the market payoﬀ and the real perpetuity. This linear interpolation is
what requires quadratic utility.
    If a riskfree payoﬀ is not traded, Proposition 3 leads to the same representation as
Proposition 4 (31), with the constant-mimicking portfolio yield   in place of the riskfree
rate   . This result is a central point of Magill and Quinzii (2000), who call   the “least
variable” stream. I use a diﬀerent language because constant-mimicking payoﬀ yield  
is not the minimum long-run variance yield. We can also describe the frontier with any
other frontier security, such as the minimum long-run variance yield, or the zero-beta
yield for   . The remaining propositions generalize to the case that a riskfree yield is not
traded in the same way.
   The market payoﬀ is always traded. By definition, the market payoﬀ is the average
payoﬀ that each investor chooses among the traded payoﬀs. Thus, these statements
otherwise encompass general market incompleteness.


6.3    A long-run CAPM

In an equilibrium of investors who are all of the same type, but vary by risk aversion,
equilibrium prices follow a long-run version of the CAPM.

Proposition 5. For each asset , the long-run expected yield follows a long-run CAPM,
                                                      h                 i
                               ̃(  ) −   = ̃ ̃(̂  ) −                       (33)

where ̃ is a long-run regression coeﬃcient of yield  on the market yield.

   This proposition follows simply from the long-run Roll theorem (21) and the fact (32)
that the market payoﬀ is long-run mean-variance eﬃcient.
   Mertonian state variables for time-varying investment opportunities disappear from
long-run expected yields, as they disappear from the optimal payoﬀ, even though there
can be a complex ICAPM representation of one-period returns.
    Long-run betas are all “cashflow betas,” not “valuation betas,” or “discount-rate”
betas which dominate short-run return correlations. Long-run betas are thus a bit more
plausibly “exogenous” than one-period betas. If we regard cashflows as “exogenous,”
then the initial price is really the “endogenous” variable:  =  ({ }), and (33)
describes how ({ }) is formed. I use quotes because everything is endogenous in general
equilibrium production (not Lucas-tree or endowment) economies, but the informal habit
of reading causality from betas to expected returns does have a quite diﬀerent flavor in
the long-run context, since the betas are pure cashflow betas.

                                                 26
7     Outside income and preference shocks
Next, I allow outside income and preference shocks, potentially correlated with traded
asset payoﬀs. I separate the preference-shock hedge payoﬀ into a constant and a variable
component,                                           ³ ´
                               = ̄ × 1 + ̃ ; ̃ ̃ = 0
Proposition 1, (26), now reads
                           ³              ´   h                  i
                       ̂ = ̄ + ̃ −  − (̄ + ̃ − ) −   ∗                  (34)

The variable part ̃ of the bliss point hedge payoﬀ  and the outside income hedge payoﬀ
 enter together in everything that follows from this equation, so to save some space I
combine them in what follows; I use the symbol  to denote the quantity  − ̃ , I write
only “outside income hedge payoﬀ” to refer to both components, and I start with (34)
written as                         ³      ´ h                i
                             ̂ = ̄ −  − (̄ − ) −   ∗                        (35)


    Now, the investor sells the hedge payoﬀ for outside income (−) and then invests the
proceeds (), along with any wealth  , in the long-run mean-variance eﬃcient payoﬀ
∗.
   There are several diﬀerent, equivalent representations of the optimal payoﬀ and pricing
with outside income, each of which oﬀers a diﬀerent intuition.


7.1    Mean-variance frontier and risk aversion

With outside income, we can say that the mean-variance characterization now applies to
the yield of the “total payoﬀ” ̂  , which consists of the payoﬀ ̂ that the investor holds
directly in asset markets, plus the outside-income hedge payoﬀ  that the investor holds
implicitly:

Proposition 6. The total yield is on the long-run mean-variance frontier,
                                                  1³     ´
                                  ̂  =   +       − ∗                            (36)
                                                  
The total yield and risk aversion are defined here as
                                         ̂ + 
                                 ̂  ≡                                                (37)
                                      + ()
                                 1   ̄ −   [ + ()]
                                   ≡                                                  (38)
                                          [ + ()]


                                                 27
      Derivation. Since ̄ is constant and a riskfree rate is traded, (̄ ) = ̄   .
      Then, from (34),
                                  ³       ´   h                i
                           ̂ =    ̄ −  − (̄ − ) −   ∗
                                                           "                #
                  ̂ +            ̄                 ̄
                            =              −              − 1 ∗
                  + ()      [ + ()]        [ + ()]
                                  "                 #
                                        ̄           ³       ´
                              
                        ̂ =  +                − 1  − ∗ 
                                     [ + ()]
      and (36) follows.

    For this representation, we interpret  as defined by (38) as the local risk aversion
coeﬃcient, evaluated at a bliss point ̄ and a value of consumption in which the investor
invests all wealth, including the proceeds from shorting the outside-income hedge payoﬀ,
in the riskfree asset.
    Time-varying investments and hedging demands for state-variable shocks are still ab-
sent in this representation, now including state variables for outside income, though such
hedging demands may well appear in the dynamic strategies required to synthesize opti-
mal payoﬀs. The outside income stream, represented in its hedge payoﬀ  does appear
in the optimal payoﬀ, as it appears in familiar one-period mean-variance problems.


7.2    Portfolio distortions

Saying the total payoﬀ is long-run mean-variance eﬃcient is helpful, but in order to
figure out what assets to buy ̂ the investor needs to subtract the outside-income hedge
payoﬀ from the long-run mean-variance eﬃcient total payoﬀ. Buying the frontier and
then shorting a hedge payoﬀ will mean buying and selling the same assets, which may be
costly. (On the other hand, it may not: One could imagine an asset market with a common
“frontier” portfolio sold to everybody, and specialized “hedging” portfolios separately
tailored to people with diﬀerent outside-income risk characteristics.) For these reasons, it
is useful to characterize the asset payoﬀ directly. Finally, it’s useful to characterize the
optimal asset payoﬀ as a set of distortions relative to the mean-variance frontier and then
relative to the market payoﬀ.
   To characterize the asset payoﬀ, we can start by explicitly subtracting the outside-
income hedge payoﬀ from the mean-variance eﬃcient total payoﬀ. In equations, we can
write that the yield ̂ = ̂ of the optimal asset payoﬀ is
                             ³        ´   1³      ´    ³         ´
                           ̂ −   =      −  ∗ −    −                             (39)
                                          
where   denotes the yield of the outside-income hedge payoﬀ

                                                   
                                            ≡        
                                                  ()

                                               28
and the wealth shares  ,  are defined as
                                                       ()
                                ≡            ;  ≡          
                                       + ()         + ()

   We do not have () = (); we do not know how to assign prices for nontraded
payoﬀs. Hence, though I call  + () “total wealth,” it really is only “asset wealth plus
the value of the outside-income hedge payoﬀ.” Equation (39) follows quickly from (36) by
recognizing that ̂  =  ̂ +    
   Equation (39) nicely generalizes mean-variance advice: just subtract the outside-income
hedge payoﬀ from the mean-variance payoﬀ. I found it prettiest to express this result in
zero-cost form, but corresponding expressions for ̂ itself are straightforward.
                                                                                             
   Next, the outside-income hedge payoﬀ   ³    will
                                                   ´ usually contain some riskfree yield 
                                                ∗
and some of the mean-variance yield  −  . Expression (39) still contains a lot of
buying something and simultaneously selling it, a potentially ineﬃcient way to describe
a portfolio. It is therefore interesting to describe the investor’s asset yield ̂ or payoﬀ ̂,
more directly, as follows:

Proposition 7: Break the outside-income hedge yield into three components, defined by
the long-run regression                   ³         ´
                             =   + ̃   −  ∗ +                        (40)
Then the yield of the optimal payoﬀ in the presence of outside income can be expressed as
                                        Ã             !
                           ³       ´        1           ³       ´
                        ̂ −   =          −  ̃   −  ∗ −                    (41)
                                            

      Derivation: Substitute (40) into (39).


   Proposition 7 naturally directs the investor to lower his exposure to the mean-variance
eﬃcient payoﬀ, as if he were more risk averse, if his outside-income hedge payoﬀ is highly
long-run correlated ̃ with the mean-variance eﬃcient payoﬀ.
    The payoﬀ   is the orthogonalized and idiosyncratic ̃( ∗  ) = 0, zero-cost (  ) = 0
and zero-mean ̃( ) = 0 component of the outside-income hedge payoﬀ. It constitutes
free insurance against outside income risks. Selling (or buying) this payoﬀ ought to be
the first thing every investor does. Characterizing such payoﬀs is an important task for
academic portfolio advice.
    The idiosyncratic component   varies over time as well as across states of nature.
For example, if the investor has a certain wage stream and retires at a given date with
certainty, then   goes from a positive to a negative loading on the indexed perpetuity
on the retirement date, and “short   ” generates the usual shift from stocks to bonds at
that date.

                                                29
7.3    Shares and the low-wealth limit

In (39) and (41), as wealth  and hence the share of asset wealth  declines, the investor
becomes less risk averse, allocating larger shares to the risky assets. Similarly, when the
investor has no outside wealth () = 0, risk aversion itself in (30) or (38) declines as
wealth declines, and the risky payoﬀ share explodes.
    This behavior is really an eﬀect of units. From (39), the asset payoﬀ ̂ consists of the
sale of the outside-income hedge payoﬀ , and then investment of the proceeds () along
with asset wealth  in the long-run mean-variance eﬃcient payoﬀ,
                                          "                  #
                                              1³ 
                                              
                                                      ´
                          ̂ = [ + ()]  +    − ∗ −                                (42)
                                              

As  → 0, the asset payoﬀ ̂ becomes a pure zero-cost payoﬀ. The investor just shorts
the outside income hedge payoﬀ and invests the proceeds in a mean-variance payoﬀ, with
the risk aversion that an investor with wealth () would display. But the value of the
asset payoﬀ remains (̂) =  . By dividing the asset payoﬀ by its value, asset wealth
 , the yield on this payoﬀ appears enormously risky.
    One might reexpress the results just in terms of payoﬀs ̂ rather than yields as in
(42), or scale the asset payoﬀ ̂ by total wealth  + (). But I think that expression
would be just as misleading, and the tradition of expressing portfolio results in terms of
returns (yields) is a good one. In the real world we — investors, financial institutions,
and regulators — often do look at the value and riskiness of asset portfolios in isolation,
without trying to assess the value () or the risk characteristics  of outside income.
Investors with substantial outside income and little asset wealth should hold nearly zero-
cost hedging payoﬀs that, taken on their own, look very risky. Taking out a mortgage
and investing in the stock market is a classic example.
   The  = 0 and hence  = 0 limit without outside income is less interesting. Looking
back at Propositions 1 and 2, a quadratic-utility investor with no financial wealth  = 0
and no human wealth () = 0 invests anyway, in a zero-cost payoﬀ

                                          ̄ ³   ´
                                     ̂ =   −  ∗ 
                                         

The price (̂) = 0 , so the yield ̂ = ̂(̂) of this zero-price payoﬀ is not defined. This
payoﬀ is on the mean-variance frontier of zero-cost payoﬀs (20). To incorporate this case,
we could write the optimal payoﬀ in zero-cost form as
                                          "  #
                                        ̄    ³        ´
                             ̂ =   +  −    −  ∗
                                      
                                                                                         (43)
                                        

However, realistic utility functions, which do not extend to negative consumption, pre-
scribe zero investment ̂ = 0 for  = 0 and () = 0, and not zero risk aversion.



                                              30
7.4    Payoﬀs relative to the market

Again, we want to express the optimal payoﬀ relative to the well-defined market payoﬀ.
That translation is especially useful in this case, as the market payoﬀ is likely not to be
long-run mean-variance eﬃcient.
   Consider a market of investors who are all of the same type (quadratic utility), but with
heterogeneous risk aversion (bliss point, initial wealth) and also heterogeneous outside
income streams. Now investors think about how their outside income stream diﬀers from
the market average outside income stream, as well as how their risk aversion diﬀers from
the market average risk aversion. Again, several equivalent representations give diﬀerent
kinds of intuition.
   First, the two-fund theorem still applies. The investor’s total payoﬀ, including the
outside-income hedge payoﬀ he holds implicitly, is split between the index perpetuity
and the market’s total payoﬀ ̂ , which adds outside-income hedge payoﬀ of the average
investor to the actual market payoﬀ ̂ . Total payoﬀs are mean-variance eﬃcient. Actual
asset payoﬀs are not.

Proposition 8. When all investors are of this type (quadratic utility, outside income),
each investor’s total payoﬀ is proportional to the aggregate total payoﬀ, which is a claim
to the traded component of aggregate consumption:
                                               ³        ´
                                 ̂ =   +     ̂ −                            (44)
                                              
where the yield on the total aggregate payoﬀ is
                              P h                    i
                                                                    P
                                    + ( ) ̂
                                              ̂ +       ̂ + 
              ̂   ≡ P h           i = P h          i =             
                          + ( )       + ( )
                                                            + ( )
and aggregate risk aversion is defined as a wealth-weighted average of individual risk aver-
sion,
                                       P h             i
                                                          1
                                 1         + ( ) 
                                    ≡ P h                i 
                                            + ( )

      Derivation. Start with (36)
                                          1 ³     ´
                                                  ̂ =   +
                                              − ∗                                                               (45)
                                          
      Sum over people and divide by total wealth,
               P h                        i                         P h                 i
                                                                                             1
                             + ( ) ̂                                + ( )    
                                                                                                 ³             ´
                 P h                          i       =  +           P h                   i        − ∗
                              + ( )                                      + ( )
                                                                    1 ³      ´
                                              ̂ =   +              − ∗
                                                                    
                                                                ³              ´
                                        −  ∗ =  ̂ −   

                                                                 31
      Substitute this result in the right hand side of (45).
          The interpretation of the aggregate total payoﬀ as a claim to the traded
      component of aggregate consumption follows from the aggregated budget con-
      straint  =  +  , and the definition  = ( |), so

                                  ̂ = (̂ +  )  [ + ( )]
                                       = ( |) [( |)] 


    Equation (44) is an optimal partial risk-sharing result: the payoﬀ ̂  is split according
to risk aversion, with less risk-averse people getting a more variable stream. Asset payoﬀs
are reduced when individuals get a large outside-income hedge payoﬀ. It’s only a partial
risk sharing result: Investors also bear the risks of the non-hedgeable components of
outside income. Optimal payoﬀs engineer as much risk sharing as is possible in the
traded asset markets.
     To understand the optimal asset payoﬀs — what the investor should buy, in the end —
it is again useful to break the optimal payoﬀ up into components with diﬀerent economic
functions.

Proposition 9. The yield of the investor’s optimal asset payoﬀ can be written in terms of
the market asset yield, the market average outside-income hedge yield, and the individual
outside-income hedge yield as
               ³         ´              ³         ´   ³         ´     ³          ´
             ̂ −   =             ̂ −   +   −   −   −                     (46)
                                                    
where
                                                         
                                  ≡          ;  ≡
                                         ( )          ( )
                                                                   
                                    ≡                ;   ≡
                                          + ( )              + ( )
                                            ( )                 ( )
                                    ≡                ;  ≡              
                                          + ( )              + ( )

      Derivation. From (44),
                                           ³        ´            ³       ´
                                        ̂ −   =  ̂ −  
                         "Ã                    !        #        Ã               !
                               ̂ +                ̂ + 
                                        −   =              − 
                               + ( )             + ( )
                         h                          i        h                    i
                        ̂ +   −   =    ̂ +   −  
           h    ³            ´         ³           ´i        h       ³       ´    ³           ´i
            ̂ −   +   −                =    ̂ −   +   −          
      Equation (46) follows.

                                                        32
    The first term in (46) describes how the investor takes on market risk. As before,
investors who are temperamentally more risk averse than average    take on less
market risk. The units eﬀect of wealth shares  again aﬀects market risk. The yield of
the investor’s market portfolio will appear very risky, and his eﬀective risk aversion very
low, if he is predominantly financing investment from the sale of an outside-income hedge
payoﬀ. But now, we relate individual to average: if the average investor is also financing
most of his asset payoﬀ by selling an outside-income hedge payoﬀ, then the individual
investor will again just buy the market payoﬀ. The market payoﬀ itself will have a very
risky yield in this circumstance, an intriguing observation given the puzzlingly large risk
of stock market investment.
    Next, the investor moves away from the market payoﬀ towards the average outside-
income hedge payoﬀ. Here, the investor provides insurance to the average investor, and
typically earns a premium for doing so. An individual who is very risk averse, either
intrinsically or because he has a very large share of asset wealth in his portfolio, will
display a yield that reflects less outside-income insurance to the market.
    Finally, the investor shorts his own outside-income hedge payoﬀ. Here risk aversion is
irrelevant; the investor shorts the whole thing.
   The latter two eﬀects can oﬀset, if the investor’s hedge payoﬀ is similar to the average
payoﬀ. For example, if the investor has average adjusted risk aversion,    =    ,
and an average split between the value of outside and asset wealth  =  , then (46)
reduces to                                        ³         ´
                               (̂ − ̂ ) =   −  
The yield on this investor’s optimal payoﬀ starts with the market yield, then holds only
the diﬀerence between aggregate and individual outside income hedge payoﬀ. He buys
from the average investor the payoﬀ that the average investor would like to short, and
shorts the payoﬀ that best hedges his own outside income.
    As in Proposition 7, it is interesting to orthogonalize the payoﬀs, in part to avoid the
latter simultaneous buying and selling of hedge payoﬀs. Define components by successive
long-run regressions to define orthogonalized yields  , the component of the aggregate
outside-income hedge payoﬀ orthogonal to the market, and  , the component of the
individual outside-income hedge payoﬀ orthogonal to both market and aggregate outside-
income hedge payoﬀ, by                           ³         ´
                                −   = ̃ ̂ −   +  

                                         ³        ´
                    −   = ̃ ̂ −   + ̃  +  
                                         ³        ´          ³         ´
                                = ̃ ̂ −   + ̃  −   +  
                   ³        ´
The three payoﬀs ̂ −     , and  are all zero cost. In addition, ̃( ) = 0. The
payoﬀ  is again a zero-price, zero-mean, “idiosyncratic” component of the outside income
hedge payoﬀ — the part of the individual outside-income hedge payoﬀ not spanned by a
constant, the market payoﬀ or the average outside-income hedge payoﬀ. The last two

                                                33
lines deliver the same ̃ and definition of  , and oﬀer diﬀerent ways to think about the
orthogonalization.
   Substituting these definitions in (46), we obtain

Proposition 10. The investor’s asset portfolio can be written in terms of the market asset
yield, the orthogonalized market average outside-income hedge yield, and the idiosyncratic
individual outside-income hedge yield as
                                        "                                #
                  ³              ´                                         ³    ´
                             
                ̂ −            =       +  ̃ −  ̃ ̂ −        (47)
                                                 
                                         "                     #
                                           
                                       +       −  ̃  −   
                                           

    The first term in brackets now adjusts the yield of the investor’s optimal payoﬀ for dif-
ferent market exposures of the individual vs. the average outside income hedge payoﬀ, in
addition to already-explored dimensions of heterogeneity. For example, if the individual’s
outside income hedge payoﬀ is highly long-run correlated with the market payoﬀ, ̃
is large, we might think that the individual should scale back his market exposure. But
if everyone else’s outside-income hedge payoﬀ is also highly correlated with the market
payoﬀ, ̃ is also large, and the individual is otherwise average ( =     −   ),
then the individual just holds the market payoﬀ.
    The second term in brackets adjusts the individual’s exposure to the orthogonalized
average outside income hedge payoﬀ,  . The investor with no or uncorrelated outside-
income, ̃ = 0, buys the market average outside income hedge payoﬀ, deviating from
market weights to do so, and earning a premium for taking this risk. But now we recognize
that by selling his own outside-income hedge payoﬀ, the investor may end up undoing this
investment. An investor whose outside-income hedge payoﬀ is highly correlated with the
average, ̃ is large, will have to avoid this opportunity. This is a cleaner statement
than Proposition 9, which would have this investor simultaneously buy and sell the same
thing.
   Finally, the investor sells the completely idiosyncratic, zero-price, zero-mean compo-
nent of his outside-income hedge payoﬀ  .


7.5     Equilibrium with outside income

Next, I characterize the equilibrium of investors with heterogenous outside income streams
as well as heterogenous risk aversion. Since the average total payoﬀ ̂ is long-run mean-
variance eﬃcient in Proposition 8, and using the long-run Roll theorem (21), we have a
long-run version of the total-wealth CAPM,




                                                   34
Proposition 11. The expected long-run yield of each asset  follows a CAPM using the
aggregate total yield as reference payoﬀ:
                                                        h               i
                               ̃(  ) −   = ̃ ̃(̂ ) −                    (48)


   Again, ̂  defined in (37) is the yield on the asset payoﬀ plus the hedge payoﬀ for
outside income. Thus, it’s not quite correct to say that “total wealth” or the “total
income stream” must appear in the CAPM reference portfolio. What appears is the
hedge payoﬀ for total income.
   The total yield is not the traded asset-market yield. Therefore, it’s interesting to
separate out the asset market yield as a first factor, and therefore to express pricing in a
two-factor model in place of the total-income CAPM (48):

Proposition 12. The expected long-run yield of each asset  follows a multifactor model,
with the market payoﬀ and average outside-income hedge payoﬀ as factors,
                                         h                  i       h            i
                    ̃(  ) −   = ̃ ̃(̂ ) −   + ̃ ̃( ) −         (49)

where ̃ and ̃ are long-run multiple regression coeﬃcients.

    Proposition 12 follows directly from Proposition 11, and the fact that the total yield
is a linear combination of the asset yield and average outside income hedge yield, ̂ =
  ̂ +   
    In pricing as in portfolios, Mertonian state variables for outside income and investment
opportunities disappear. When the tradeable component of outside income does not
average to zero  6= 0, a second pricing factor emerges in addition to the market payoﬀ.
Assets have higher long-run expected yields if their cashflows have a higher long-run
covariance with aggregate outside income. For example, if as Fama and French (1996)
speculate, the average investor’s outside income is correlated with the payouts of a class of
“distressed” securities, then those securities will require higher long-run expected yields,
and they will receive lower prices. We see a “value” eﬀect in prices and a “value factor”
in long-run expected yields.
    We also can represent pricing with orthogonalized factors, which are possibly more
interesting. Define again  by a long-run regression.
                                                    ³           ´
                                 −   = ̃ ̂ −   + 

Then, our multifactor model can use  in place of  and become:
                                               h                i
                         ̃(  ) −   = ̃ ̃(̂ ) −   + ̃ ̃( )          (50)

   Comparing the pricing results (49) and (50) to the optimal payoﬀ expressions (46)
and (47), we see the same right hand variables. The payoﬀ expressions (46) and (47) tell

                                                   35
the investor how much to put in to the “priced assets” corresponding to the aggregate
market portfolio and aggregate outside-income-hedge payoﬀ, and then to perfectly hedge
residual, zero-price, mean-zero, risk. The payoﬀ shares advocated by (46) and (47) are
given by “risk aversions” which combine true risk aversion, and aversions induced by the
character of outside income.
    The resulting picture is similar to that painted by Fama (1996), (illustrated in three
dimensions in Cochrane (2011)) who describes portfolio choice between “multifactor eﬃ-
cient” portfolios which are also the pricing factors.


8     Towards calculations
In this section, I use two simple environments — the standard permanent income model,
and the lognormal i.i.d. environment — to investigate the connections between portfolios
and payoﬀs.
   These are completely standard and well-understood environments. The point is to
view these environments through the concepts in this paper: I characterize the payoﬀ
spaces (dividend streams) created by dynamic trading, I find discount factors in the
payoﬀ spaces, I characterize the hedge payoﬀ for outside income, and I find the optimal
payoﬀ. Connecting views, I characterize the dynamic trading strategies that synthesize
optimal payoﬀs when those payoﬀs are not directly marketed.
    This investigation admittedly runs a bit counter to the philosophy articulated in the
introduction, that one should not focus much attention on payoﬀ engineering. However,
building up payoﬀ streams from underlying investment opportunities is not as simple as
it seems, and giving a clear example of the connection between payoﬀs and portfolios in
well known environments is a natural step.


8.1    Permanent income model and standard results

Consider the standard quadratic utility permanent-income equilibrium model, with an
AR(1) income stream and interest rate equal to discount rate  =  :
                                   Z ∞           µ      ¶
                                             1
                                         − 
                           max           − ( −  )2  s.t.                     (51)
                           ³     =0
                                         ´
                                             2     ³        ´
                                                        
                      =   +  −  ; lim  −   = 0
                             
                                                                                     (52)
                                                        →∞
                    = −  +  

A quick recap of the standard results: The equilibrium consumption process follows the
familiar permanent-income rule,

                                                       
                                   =   +                                     (53)
                                                      + 

                                            36
and hence a random walk, whose innovations are the innovations to that present value,

                                                   
                                       =                                        (54)
                                                  + 
More explicit solutions for income and consumption are
                                                  Z 
                              = 0 − +              −(−)                  (55)
                                                   =0


                                              Z 
                          =  0 +     0 +                                     (56)
                                     +       +  =0

    As a general-equilibrium model, we think of  as the capital stock, and the interest
rate and budget constraint (52) represent a linear production technology with constant
marginal product of capital. Alternatively, they can represent international borrowing
and lending at a constant real rate with costless transport.


8.1.1   Payoﬀ space, discount factor, and frontier

So far, this is a representative-agent general equilibrium model. We can introduce a
variety of more or less complete asset markets. For example, in the textbook use of this
model, we specify complete markets, and we find from marginal utility the equilibrium
prices of consumption and the outside income stream  , just suﬃcient that the investor
chooses to consume  and not to market  . These prices reflect interesting time-varying
risk premia.
    Here, it is more interesting to specify that there is a single traded asset, the constant
riskfree rate, and that  is a non-marketed income stream. Doing so lets me characterize
a hedge payoﬀ for the nontraded income stream.
   Though the interest rate is the only available asset return, the investor can create
payoﬀs by dynamic saving and dissaving. The payoﬀ space  generated in this way is
any payout stream { } consistent with
                                              ³               ´
                                       =   −                                 (57)

and                                                 ³             ´
                                                          
                                     ∞; lim −   = 0                             (58)
                                             →∞

or equivalently                            Z ∞
                                                    
                                    0 =         −     ∞                       (59)
                                           =0
The latter conditions do not have expectations: In a  period model, we have  = 0 in
each state. The corresponding limit must hold for each path.
   Equation (57) represents a payout policy. The payoﬀ  is the amount saved or removed
from wealth built up in the riskfree investment. With a single asset this example does

                                                  37
not have an interesting portfolio policy, state-contingent allocation of wealth to diﬀerent
investment opportunities.
    We are used to thinking that riskfree investment means nonstochastic payoﬀs. But
by changing the payout  in response to events — for example income shocks  — the
investor can create state- and time-dependence in the payoﬀ stream  that is not present
in the asset market. But the investor cannot create arbitrary contingent claims. A
strategy that withdraws  today must pay it back in present value sense, or the trading
conditions (58)-(59) are violated. Similarly, since  =  0 , (59) implies that traded
yields must obey                    Z ∞
                                           
                                        −    = 1                               (60)
                                      =0
ex-post as well as ex-ante. The “riskfree” nature of the asset, and the incompleteness of
the market, implies that the ex-post integrals (59)-(60) must be nonstochastic, not that
each  or  cannot vary.
    The integrals in (59)-(60) are the “long run” payoﬀs inside the long-run mean operator
̃. Thus, the constant interest rate requires that long-run payoﬀs do not vary across
states of nature, much as a constant interest rate induces one-period returns which do
not vary across states of nature. This fact does not imply that long-run variance is zero,
however. The variance of long-run returns is a diﬀerent object from the long-run variance
of returns. A path that borrows     and then repays has a larger long-run variance than a
                                 R ∞ −  2
constant
R ∞ − 
          payoﬀ.   The  quantity  =0      may vary across states of nature even though
 =0       does not.
    The traded discount factor payoﬀ is simply ∗ = exp[( −  )] = 1. This ∗ is
the dividend process of a trading strategy of the form (57):  = (  − 1) implies
 = 1 . Be careful: You can only price traded payoﬀs with this discount factor. In
                                                ∗
                   ³ price { } or´{ } with  = 1, because those payoﬀs are not traded.
particular you cannot
(Although  =   +  −   leads to a convergent  path,  = (  −  )
or  = (  −  ) separately do not.) The familiar equations for the price of the
consumption or endowment stream in this model use marginal utility (non traded, here)
as a discount factor, and generate risk premiums that ∗ = 1 does not generate.
    Next, with ∗ = 1, (∗ ) = 1 so  ∗ =  =   and the long-run mean-variance
eﬃcient payoﬀ space collapses to the point   . Traded payoﬀs generated by dynamic
trading of the risk-free rate must obey risk-neutral pricing, which means a degenerate
frontier. Directly, (60) implies that for any traded { }, ̃() =  . A spectrum of assets
then lies on a flat line in long-run mean-variance space to the right of the riskfree payoﬀ.


8.1.2   Optimal payoﬀ and outside-income hedge payoﬀ

In this simple model, we can find the optimal asset payoﬀ — which consists of withdrawals
or additions to wealth or capital stock — as a consequence of the familiar solutions,

                                        ̂ =  −  

                                              38
with  and  solutions as given above. The investor saves ̂  0 when income  is
greater than consumption  and vice versa.
   The point is to understand this result in the long-run portfolio theory framework.
Proposition 1 characterized the optimal payoﬀ as
                                              ³        ´   h                 i
                                         ̂ =  −  − ( − ) − 0  ∗                                      (61)

Here,  is a constant, so tradeable and  = ̄ with ( ) = ̄  . We also have
 ∗ =   =  . The interesting component of (61) is the hedge payoﬀ for outside income
. It is given by
                                              Z 
                                 =  −                                      (62)
                                            +  =0
or, directly,
                                      Z  Ã                
                                                             !
                                                         
                        = 0 − +       −(−) −                         (63)
                                       =0             +
We can also write the hedge payoﬀ  in state-variable form,
                                               "                                      #
                                                            
                                   =  −  ( − 0 ) +     ( − 0 )                                     (64)
                                                           +

      To see the intuition of these results, it helps to write the diﬀerential,
                                                                    ½   Z ∞                  ¾
                                                                
                          =  −                =  −           − +  
                                             +                        =0

Thus, from any change in actual income  , we form the change in the tradeable compo-
nent by subtracting the change in the permanent component of income, the part which
cannot be self-insured by saving/borrowing and then repaying. This subtraction pro-
duces a transitory component of income, which can be completely self-insured, and which
is tradeable. Likewise, expression (62) shows that the tradeable component of income
subtracts oﬀ the amount by which permanent income has changed since time zero.
                                                                             ∞ −               R       
    To verify that the hedge payoﬀ  is tradeable, you can evaluate1 =0             =
0 ( + ) for any { }, thus satisfying condition (59) and giving us () = 0 ( + )
      

  1
      From (63),
         Z ∞               Z            ∞                   Z ∞            ∙Z  µ                    ¶     ¸
                                                                                               
             −    =              −  0 −  +        −             −(−) −        
            =0                     =0                      =0             =0                +
        Z    ∞                               Z ∞ ∙Z ∞ µ                             
                                                                                             ¶ ¸
                                    0                                                  
                  −    =           +                   −( +) −           −   
            =0                     +       =0    =                         +  
        Z    ∞                               Z ∞"          −( +)         
                                                                                 #
                                    0                                − 
                  −    =           +                         −            
            =0                     +       =0          +          +
        Z    ∞
                                       0
                  −    =             + 0
            =0                        +




                                                               39
as well. The    same evaluation shows that the actual outside income payoﬀ  is not
             R ∞ − 
tradeable: =0          includes terms in  that can reach arbitrarily large values.
Thus,  is an interesting
                  R ∞ − 
                             example of a payoﬀ that varies across time and states of nature,
yet its integrals =0       +  are nonstochastic, because withdrawals are always paid
back in ex-post present value terms.
    Thus, we have broken up nontradeable outside income  into a tradeable component 
and a non-traded residual,   ≡  − (the notation   corresponds to the decomposition
of Proposition 7.) The components are long-run orthogonal, ̃( ) = 0, and the residual
is orthogonal to any traded payoﬀ including ∗ = 1 ̃(  1) = 0.
   Having found  ∗ =   , ( ) =    we can can write the optimal payoﬀ from (61) as
                                          "               #
                                            0
                              ̂ = − +     + 0   .                               (65)
                                           +
In sum, then, Proposition 1 interprets this standard permanent income situation as fol-
lows: The investor sells an asset equal to the tradeable component  of his income stream,
given by ( 62), (63) or (64). If the payoﬀ  is directly marketed, he simply sells it as a
contingent claim. If  must be synthesized by him or his adviser, he starts by borrowing
( ) = 0 = 0 ( + ), and repaying this³debt stochastically
                                                          ´        in the amount  at each
                                                  
date, so the account balance follows  =   −  . Then, he invests the proceeds
of the sale, 0 , plus his initial wealth 0 , in the long-run mean-variance eﬃcient payoﬀ,
which is here the riskfree rate.
   At this point, we can verify that ̂ given by (65) satisfies ̂ =  −  . Substitute (
62) into (65) to obtain
                                                      "            #
                                   Z          0
                     ̂ = − +          +     + 0   
                                 +  =0        +
and using (56) we recognize  in the second two terms. I worked backwards to derive (
62) in this way, which takes more algebra.


8.2    Lognormal i.i.d.

The lognormal i.i.d. case is a standard environment for power-utility portfolio theory.
There is a constant riskfree rate  , risky assets have excess returns
                               =  −   =  +                            (66)
with covariance matrix
                                         Σ =  0 
there are no preference shocks ( is a constant) or outside income ( = 0). In general
equilibrium, we think of the assets as as linear production technologies with stochastic
marginal products of capital. I find optimal payoﬀs in this environment, both by tradi-
tional methods and by applying the concepts of this paper. I study how optimal payoﬀs,

                                              40
if not directly traded as contingent claims, are synthesized from dynamic trading in the
underlying assets (technologies) of (66). Cochrane (2012b) presents a more detailed
investigation of long-run mean-variance analysis in this environment.
   The investor’s wealth (capital)  follows

                             = (  −  ) +  0                           (67)

Any tradeable stream of payoﬀs and  =  in particular is synthesized by a portfolio
strategy  and a payout rule  .
   The power utility investor can synthesize his optimal payoﬀ and consumption stream
with an instantaneously mean-variance eﬃcient portfolio
                                                    1 −1
                                              =     Σ                                 (68)
                                                    
and following a payout rule proportional to wealth,
                                "                       Ã                     !#
                               1                  1 1 0 −1
                     = ̂ =    + ( − 1)  +    Σ                            
                                                 2

   The quadratic utility investor can similarly synthesize his optimal payoﬀ and con-
sumption stream by holding a mean-variance eﬃcient portfolio
                                    ³               ´
                                     −                      1 −1
                            =                         Σ−1  =      Σ                   (69)
                                                              
and following a payout rule in which consumption rises with wealth,
                                                                      Ã            !
                                        h                         i       
                                                  0    −1
                      = ̂ =  − 2 −  Σ  −                            −         (70)
                                                                          

However, the quadratic utility investor’s eﬀective risk aversion and allocation to risky
assets varies over time, becoming more risk averse as wealth rises (69), and his payout
rule includes an intercept, which can send wealth and consumption to negative values.
   Following the representation of this paper, however, the same optimal payoﬀ can be
equivalently represented by a static sum of two investments, the riskfree asset (indexed
perpetuity) and the long-run mean-variance eﬃcient payoﬀ, rather than dynamically syn-
thesizing a single investor-specific portfolio. To find this representation, I follow the
standard steps.
   First, we find the traded discount factor. I start with the conventional diﬀusion
representation for a discount factor ∗ which prices the returns   and  ,

                            ∗   ³        ´
                                          
                              ∗
                                 =   −       − 0 Σ−1  
                            


                                                    41
                                                                                      ³     ´
You can check that this construction satisfies the defining properties (∗ ∗ ) =  −  
and ( ) = −( ∗ ∗ ). Next, a bit of algebra2 reexpresses the discount factor as
                                              ³            ´
                                       ∗ =  ∗ − ∗  − ∗ 0 Σ−1           (73)

This equation says many things: ∗ is a discount factor, it is a traded payoﬀ (since ∗
is proportional to ∗ ), and it is a value process that generates the yield  ∗ = ∗ (∗ )
as a traded payoﬀ. The dynamic strategy that generates the payoﬀ  ∗ is a constantly-
rebalanced constant-weight short position in a mean-variance eﬃcient investment,  =
−0 Σ−1  , that pays out a constant fraction 1(∗ ) of its value.
    By Proposition 1, the quadratic utility investor consumes a constant linear function
of  ∗ , with an intercept that represents investment in the riskfree payoﬀ:
                                                           "             #
                                                         
                                                       
                                            = ̂ =  −  − 0 ∗ 
                                                         

Proposition 2 rewrites this result as

                                               1³      ´ 1     −   0
                               ̂ =      =  +    − ∗ ;   ≡                          (74)
                                       0                           0

   These are the same optimal payoﬀs and consumption streams as described by (69)-
(70). In place of the time-varying portfolio and payout weights in (69), we express the
optimal payoﬀ as a static sum of two payoﬀs. One is the riskfree payoﬀ. The other—
the long-run mean-variance eﬃcient payoﬀ—if not directly traded can be synthesized by
shorting a payoﬀ  ∗ that is short a constant fraction of its value in a mean-variance
eﬃcient portfolio, as described by (73).
    The yield that is halfway between  ∗ (or the market payoﬀ) and the riskfree payoﬀ
is not generated by a portfolio that constantly rebalances to 50/50 weights. Constant
rebalancing gives rise to payoﬀs that are nonlinear functions of underlying payoﬀs.
   For investors who diﬀer by wealth 0 and hence risk aversion , expressions (69)-(70)
require each investor to undertake an investor-specific dynamic allocation. By contrast
   2
       The price of ∗ is
                                                                       1
                                        (∗ ) = ̃(∗2 ) =                              (71)
                                                               2 −  − 0 Σ−1 
Then we can rewrite ∗ as a value process in the form (67),

                        ∗       £  ¡                      ¢¤
                                 =   − 2 −  − 0 Σ−1   − 0 Σ−1 ( +  )
                        ∗
                                   ∙             ¸
                        ∗                1
                                 =    −           − 0 Σ−1 
                        ∗               (∗ )
                                   ¡           ¢
                        ∗     =  ∗ − ∗  − ∗ 0 Σ−1                      (72)




                                                           42
the two funds in (74) are the same for all investors. Investors only diﬀer in the initial
allocation of wealth across the two funds.
   This observation opens the way to a diﬀerent, but equivalent, market structure. Rather
than market the two funds,  and 0 Σ−1  — the riskfree and tangency portfolios —
but then require each investor to dynamically adjust between these securities, in diﬀerent
amounts depending on initial risk aversion (wealth and
                                                     ³ bliss point),
                                                               ´     the indexed perpetuity
                                                           ∗
 and the long-run mean-variance eﬃcient payoﬀ  −  could be marketed. Then
investors would achieve the same end result by simply buying diﬀerent amounts of these
two funds, statically eating the dividends, and never rebalancing. If  and  represent
the economy’s technological opportunities, then intermediaries do the dynamic investing
and disinvesting.


8.2.1   Quadratic utility, the CAPM, and approximations

When the quadratic-utility investor implements optimal payoﬀs by the dynamic strategy
described by (67), (69) and (70), wealth follows
                Ã         !     Ã             !                                R
                                         −[( −)+ 12 0 Σ−1 ]−0 Σ−1     
                       −  =          − 0                                    0     
                                  

Wealth at time  is a negative lognormal, capped above at   and extending downward.
This is a natural result of the portfolio rule (69): As wealth rises, the investor pulls out
of risky assets and increasingly seeks to fund bliss point consumption  forever. The
consumption process  is also lognormal capped above at  .
    This result has important implications for the nature of the market portfolio. Since
the average investor pulls investment out of the risky technologies as wealth rises, the
distribution of the market return can be completely diﬀerent from that of the underlying
technologies — in this case, even reversing the direction of the lognormal tail from right to
left. Thus, it would be a mistake to apply long-run mean-variance analysis by specifying
an investor who splits between riskfree and “market” opportunities, and model the latter
as a lognormal diﬀusion.
    This example also addresses the Dybvig and Ingersoll (1982) paradox. Dybvig and
Ingersoll criticized CAPM / quadratic utility models, pointing out that if the market
return can attain suﬃciently high values, then the discount factor, as a linear function
of the market return, must take on a negative value, implying arbitrage opportunities
in complete markets. But the distribution of the market return is endogenous. In the
permanent income model without disposal above, market returns do attain suﬃciently
high values, and consumption exceeds the bliss point leading to negative marginal utility.
In this environment, however, the quadratic utility investor rebalances away from risky
assets, so the market wealth never attains the high enough values, and marginal utility and
discount factor are positive in every state of nature. The quadratic utility CAPM can exist
with dynamic trading and non-normal returns, without oﬀering arbitrage opportunities.


                                                  43
   A wealth process and consumption process that are capped above are unrealistic.
This aspect is relatively easy to handle by adding growing bliss points, or habits or other
temporal nonseparabilities. Cochrane (2012b) discusses this possibility at more length.
Hansen and Sargent (2004), Heaton (1993), and Cochrane (2012a) also show how to
extend quadratic quantity dynamics and asset pricing to include habits, durability, and
recursive utility.
    Equation (70) reveals problems when 2 −  − 0 Σ−1  ≤ 0. With lognormal i.i.d.
investment opportunities and quadratic utility, and for parameters 2 −  − 0 Σ−1  ≤ 0,
investors finance early consumption by huge falls in consumption late in life or in states
of nature when markets fall. As the lifetime increases, this repayment is indefinitely ex-
tended, so consumption becomes arbitrarily close√ to the bliss point. (Cochrane (2012b)
provides details.) With a market Sharpe ratio 0 Σ−1  of about 1/3, these are not unrea-
sonable parameters. Stochastic bliss points or temporal nonseparabilities do not resolve
the central issue. The lesson is simply that combination of quadratic utility (even with
generalized bliss points), lognormal i.i.d. investment opportunities, and a large risk pre-
mium doesn’t give interesting results.
   This observation is not a “fatal flaw” for quantitative application (as opposed to merely
useful conceptual benchmark) of these ideas. Actual index returns are far from lognormal.
But it does mean that a quantitatively realistic calculation must incorporate ingredients
such as stochastic volatility, mean-reversion, or additional state variables to generate such
departures from lognormality, exceeding by far the back of any envelope.
    Quadratic utility approximations to more realistic utility functions and standard dis-
tributional assumptions do not work well for large (realistic) risk premia. The answer
may be to look directly for similar representations based directly from other utility func-
tions. What do the payoﬀs look like, and what is the nonlinear line between the indexed
perpetuity and the market payoﬀ?
  Alternatively, log approximations may work better in practice. For example, the
Campbell-Shiller identity can be written
                            ∞
                            X                 ∞
                                              X
                                  −1  =         −1 ∆ − (0 − 0 )
                            =1               =1

where  = log return, ∆ = log dividend growth,  = log price, and  ≈ 096 is a constant
of approximation. Simply applying mean-variance and beta pricing ideas to long-run
returns so defined — which all come from long-run dividend growth — may be more fruitful
than literal use of the long-run expectation of the level of payoﬀs investigated here.


8.3    Finite basis

In conventional mean-variance analysis, we typically do not try directly to compute mean-
variance frontiers of thousands of U.S. stocks, let alone the plethora of other available
assets. Instead, we typically form a much smaller number of portfolios first. Implicitly,

                                                    44
we assume that the interesting opportunities in the larger set of securities is spanned by
the much smaller number of portfolios.
    The same approach is attractive in addressing intertemporal issues. Rather than try
to find the exact optimum in an infinite-dimensional space of portfolio weights and payout
rules, we can simply include a finite number of well-chosen dynamic trading strategies—
rules for portfolio weights  and payout rules  as a function of state variables. Brandt
and Santa-Clara (2006) advocate and implement this strategy for conventional dynamic
portfolio return optimization. Their approach adapts transparently here.
    If we make this simplification, most of the technical diﬃculties vanish. With a finite
vector of basis payoﬀs x, we can easily find a traded discount factor ∗ = 1 p0 ̃(xx0 )−1 x
We can then find the optimal payoﬀs, which will be of the form c0 x. The basis payoﬀs can
                                                                         
include dynamic trading rules. For example, if returns are predictable, +1 = + ++1 ,
                                                
we can include the managed-portfolio return  +1 and payout rules that depend on wealth
and  .


9     Concluding remarks
This article has shown that the familiar mean-variance characterization for one-period
returns applies straightforwardly to the stream of payoﬀs following an initial investment
in a dynamic, intertemporal environment with incomplete markets and outside income.
    Dynamic trading based on state variables that change over time is really just a dif-
ferent way of constructing a more interesting cross-section of long-run payoﬀ or return
opportunities. Conventional one-period asset pricing then applies to the stream of payoﬀs
following an initial investment. Thinking about streams of payoﬀs rather than dynamic
trading strategies may help us to apply intertemporal portfolio theory in practice.
    The best 5 word summary may be Robert Shiller’s often-oﬀered insight, “Buy stocks
for the dividends,” i.e. rather than for short-run price gain. However, recognize that
payouts from dynamic strategies are “dividends,” and that measures of a given dividend
stream’s covariance with market dividend streams matters for putting together a good
portfolio of dividends.




                                             45
10      Appendix: Notation
 : A payoﬀ. Its stream { } or .

() ({ }): Price of the payoﬀ stream { } 

  : Yield, payoﬀ to a one dollar investment,  =  ()

    : Riskfree payoﬀ and yield,  = 1,   = 1( )

: Excess yield, payoﬀ to costless investment, e.g.  =  −   

 : Discount factor and rate.
                                             P∞
 : Scaled discount factor, e.g. () =        =1      
                                          R∞
̃(): Long-run mean, e.g. ̃() =       =0   −  
                      h      i2
̃ 2 () ≡ ̃(2 )− ̃() : Long-run variance.

    g Long-run regression coeﬃcient and covariance, (
̃ :                                            g      ) = ̃()− ̃()̃();
              g           2
      ̃ = ( )̃ ().

   : Sets of available payoﬀs, yields, excess yields.

x y z: Vectors of  basis payoﬀs, yields, or excess yields.

∗ : Discount-factor mimicking payoﬀ, i.e. ∗ ∈ , () = ̃(∗ ).

 ∗ = ∗ (∗ ): Minimum long-run second moment yield.
                                                                         ³        ´
 ∗ = (1|): Mean-generating excess yield. When   is traded  ∗ =   −  ∗   .

     : Mean-variance eﬃcient yield, excess yield.

: Idiosyncratic component of a yield,  =  ∗ +  ∗ + , and () = 0 ̃() = 0

 ≡ (1|);   ≡  ( ). Constant-mimicking payoﬀ and its yield.

       : Generic ith asset.

̂ ̂: Optimal payoﬀ, yield of optimal payoﬀ.

̂  ̂ : Yield on investor ’s optimal payoﬀ, and market average.

  : Initial wealth and wealth at time .
                                                        ³          ´2
 : Bliss point of quadratic utility, () = −12  −  .

 : Hedge payoﬀ for the bliss point,  = ( |)


                                             46
̄  ̃ : Constant                                                            
               ³ ´ and variable components of the bliss point hedge payoﬀ,  = ̄ × 1 +
                 
        ̃ ; ̃ ̃ = 0

    : Relative risk aversion coeﬃcient, defined locally at , 1 = ( − ).  =
       Investor i’s risk aversion,  = wealth-weighted market average risk aversion.

  : Stream of outside labor or business income.

: Hedge payoﬀ for outside income ,  = (|).

     : Yield on outside income hedge payoﬀ,   = (), individual  value, and
       market  average.

̂   ̂  ̂ : Optimal total payoﬀ, ̂  ≡ (̂ + ) [ + ()], ̂ = individual value, and
         ̂ = market average.

̃    : Regression³coeﬃcient
                               ´ and idiosyncratic component of outside-income hedge yield.
        =  + ̃  −  +  
                          ∗



̃   : Regression coeﬃcient, and orthogonalized
                                                ³        outside-income
                                                          ´             hedge factor payoﬀ
                                                      
       for the average investor,  −  = ̃ ̂ −  +  

̃  ̃   Regression coeﬃcients, and idiosyncratic component of outside-income³         ´
        hedge yield, relative to market and average outside-income hedge,  −  = ̃ ̂ −   +
           ³         ´
     ̃  −   +  

   : Share of asset and outside wealth,  =  [ + ()]   = () [ + ()] 

         : Market average and individual shares.




                                               47
11    References
Arrow, Kenneth J., and Gerard Debreu, 1954, Existence of an equilibrium for a compet-
    itive economy, Econometrica 22, 265-290.

Bansal, Ravi, Robert F. Dittmar, Christian Lundblad, 2005, Consumption, dividends,
    and the cross-section of equity returns, Journal of Finance 60, 1639—1672.

Bansal, Ravi, and Amir Yaron, 2004, Risks for the long run: A potential resolution of
    asset pricing puzzles, Journal of Finance 59, 1481-1509.

Barberis, Nicholas, 2000, Investing for the long run when returns are predictable, Journal
    of Finance 55, 225-264.

Benzoni, Luca, Pierre Collin-Dufresne, and Robert S. Goldstein, 2007, Portfolio choice
    over the life cycle when the stock and labor markets are cointegrated, Journal of
    Finance 62, 2123-2167.

Brandt, Michael W., and Pedro Santa-Clara, 2006, Dynamic portfolio selection by aug-
    menting the asset space, Journal of Finance 61, 2187-2217.

Brennan, Michael J., Eduardo S. Schwartz and Roland Lagnado, 1997, Strategic asset
    allocation, Journal of Economic Dynamics and Control 21, 1377-1403.

Brennan, Michael J. and Yihong Xia, 2000, Stochastic interest rates and bond-stock mix,
    European Finance Review 4, 197-210.

Brennan, Michael J. and Yihong Xia, 2002, Dynamic asset allocation under inflation,
    Journal of Finance 57, 1201-1238.

Campbell, John Y., 1996, Understanding risk and return, Journal of Political Economy
   104, 298—345.

Campbell, John Y. and Luis M. Viceira, 1999, Consumption and portfolio decisions when
   expected returns are time varying, Quarterly Journal of Economics 114, 433-95.

Campbell, John Y. and Luis M. Viceira, 2001, Who should buy long-term bonds?”
   American Economic Review 91, 99-127.

Cochrane, John H., 2005, Asset Pricing, Revised Edition, Princeton: Princeton Univer-
    sity Press.

Cochrane, John H., 2011, Discount rates, Journal of Finance 66, 1047-1108.

Cochrane, John H., 2012a, A continuous-time asset pricing model with habits and dura-
    bility, Manuscript, University of Chicago.

Cochrane, John H., 2012b, Long-run mean-variance analysis in a diﬀusion environment
    Manuscript, University of Chicago.


                                           48
Cox, John C. and Chi-fu Huang, 1989, Optimal consumption and portfolio policies when
    asset prices follow a diﬀusion process, Journal of Economic Theory 49, 33-83.

Davis, Steven, Felix Kubler, and Paul Willen, 2006, Borrowing costs and the demand
    for equity over the life cycle, Review of Economics and Statistics 88, 348-362.

Davis, Steven, and Paul Willen, 2000, Occupation-level income shocks and asset returns:
    their covariance and implications for portfolio choice, NBER Working Paper 7905.

Davis, Steven J. and Paul Willen, 2001, Income shocks, asset returns, and portfolio
    choice, in Zvi Bodie, Brett Hammond and Olivia Mitchell, eds., Innovations in
    Retirement Financing (University of Pennsylvania Press).

Duﬃe, Darrell, 2001 Dynamic Asset Pricing Theory, 3d Edition (Princeton University
   Press).

Duﬃe, Darrell, Wendell Fleming, Mete Soner, and Thaleia Zariphopoulou, 1997, Hedg-
   ing in incomplete markets with HARA utility, Journal of Economic Dynamics and
   Control 21, 753—782.

Dybvig, Philip H. and Jonathan E. Ingersoll Jr., 1982, Mean-Variance Theory in Com-
   plete Markets, Journal of Business 55, 233-51.

Fama, Eugene F. 1996, Multifactor Portfolio Eﬃciency and Multifactor Asset Pricing,
   Journal of Financial and Quantitative Analysis, 31, 441-465.

Fama, Eugene F. and Kenneth R. French, 1996, Multifactor explanations of asset pricing
   anomalies, Journal of Finance 51, 55-84.

Flavin, Marjorie, and Takashi Yamashita, 2002, Owner-occupied housing and the com-
    position of the household portfolio, American Economic Review 92, 345—362.

Gabaix, Xavier, 2007, Linearity-generating processes: A modelling tool yielding closed
   forms for asset prices, Manuscript, New York University.

Gomes, Francisco, and Alexander Michaelides, 2005, Optimal life-cycle asset allocation:
   Understanding the empirical evidence, Journal of Finance 60, 869—904.

Hansen, Lars Peter, 1987, Calculating asset prices in three example economies, in Tru-
   man F. Bewley, ed.: Advances in Econometrics, Fifth World Congress (Cambridge
   University Press).

Hansen, Lars Peter, John C. Heaton and Nan Li, 2008, Consumption strikes back?
   Measuring long-run risk, Journal of Political Economy 116, 260-302.

Hansen, Lars Peter, and Scott F. Richard, 1987, The role of conditioning information in
   deducing testable restrictions implied by dynamic asset pricing models, Economet-
   rica 55, 587-613.



                                         49
Hansen, Lars Peter and Thomas J. Sargent, 2004, Recursive Models of Dynamic Linear
   Economies, Manuscript, University of Chicago and New York University.

He, Hua, and Neil D. Pearson, 1991, Consumption and portfolio policies with incom-
    plete markets and short-sale constraints: the infinite-dimensional case, Journal of
    Economic Theory, 54, 259-304.
He, Hua and Henri F. Pagès, 1993, Labor income, borrowing constraints, and equilibrium
    asset prices, Economic Theory 3, 663-696.

Heaton, John, 1993, “The Interaction Between Time-Nonseparable Preferences and Time
    Aggregation,” Econometrica 61 353-385.
Heaton, John, and Deborah J. Lucas, 2000a, Portfolio choice in the presence of back-
    ground risk, Economic Journal, 110, 1-26.
Heaton, John, and Deborah J. Lucas, 2000b, Portfolio choice and asset prices: The
    importance of entrepreneurial risk, Journal of Finance 55, 1163—1198.
Henderson Vicky, 2002, Valuation of claims on nontraded assets using utility maximiza-
   tion, Mathematical Finance, 12, 351-373.

Henderson, Vicky, 2005, Explicit solutions to an optimal portfolio choice problem with
   stochastic income Journal of Economic Dynamics and Control, 29, 1237-1266.
Jagannathan, Ravi, and Zhenyu Wang, 1996, The conditional CAPM and the cross-
    section of expected returns, Journal of Finance 51, 3-53.

Jurek, Jakub, and Luis Viceira, 2010, Optimal value and growth tilts in long-horizon
    portfolios, Review of Finance 15, 29-74.

Kim, Tong Suk and Edward Omberg, 1996, Dynamic nonmyopic portfolio behavior,
   Review of Financial Studies 9, 141-61.
Koo, Hyeng Keun, 1998, Consumption and portfolio selection with labor income: A
    continuous-time approach, Mathematical Finance 8, 49-65.

Lettau, Martin and Jessica Wachter, 2007, Why is long-horizon equity less risky? A
    duration-based explanation of the value premium, Journal of Finance 62, 55-92.

Liu, Jun, 2007, Portfolio selection in stochastic environments, Review of Financial Stud-
     ies 20, 1—39.

Lynch, Anthony, 2001, Portfolio choice and equity characteristics: Characterizing the
    hedging demands induced by return predictability, Journal of Financial Economics
    62, 67-130.

Lynch, Anthony, and Sinan Tan, 2011, Labor income dynamics at business-cycle fre-
    quencies: Implications for portfolio choice, Journal of Financial Economics 101,
    333-359.

                                          50
Markowitz, Harry, 1952, Portfolio selection, Journal of Finance, 7, 77-99.

Magill, Michael and Martine Quinzii, 2000, Infinite-horizon CAPM equilibrium, Eco-
   nomic Theory 15, 103-138.

Mayers, David, 1972, Nonmarketable assets and capital market equilibrium under un-
   certainty, in: M.C. Jensen, ed., Studies in the theory of capital markets, New York:
   Preager Publishers.

Mayers, David, 1973, Nonmarketable assets and the determination of capital asset prices
   in the absence of a riskless asset, Journal of Business 46, 258-276.

Menzly, Lior, Tano Santos and Pietro Veronesi, 2004, Understanding predictability, Jour-
   nal of Political Economy 112, 1-47.

Merton, Robert C., 1969, Lifetime portfolio selection under uncertainty: The continuous
    time case,” Review of Economics and Statistics 51, 247-257.

Merton, Robert C., 1971a, Optimum consumption and portfolio rules in a continuous
    time model, Journal of Economic Theory 3, 373-413.

Merton, Robert C., 1971b, An intertemporal capital asset pricing model, Econometrica
    41, 867-87.

Munk, Claus, 2000, Optimal consumption/investment policies with undiversifiable in-
   come risk and liquidity constraints, Journal of Economic Dynamics and Control 24,
   1315-1343.

Roll, Richard, 1977, A critique of asset pricing theory’s tests: Part I, Journal of Financial
     Economics 4, 129-176.

Roll, Richard and Stephen A. Ross, 1984, The Arbitrage Pricing Theory Approach to
     Strategic Portfolio Planning, Financial Analysts Journal 40, 14-26.

Ross, Stephen A., 1978, A simple approach to the valuation of risky streams, Journal of
    Business 51, 453-475.

Sangvinatsos, Antonios and Jessica Wachter, 2005, Does the failure of the expectations
    hypothesis matter for long-term investors?, Journal of Finance 60, 179—230.

Schroder, Mark and Costis Skiadas, 1999, Optimal consumption and portfolio selection
    with stochastic diﬀerential utility, Journal of Economic Theory, 89, 68-126.

Svensson Lars E. O. and Ingrid M. Werner, 1993, Non traded assets in incomplete
    markets, European Economic Review 37, 1149-1168.

Teplá Lucie, 2000, Optimal hedging and valuation of nontraded assets, European Finance
    Review 4, 231-251.



                                            51
Viceira, Luis, 2001, Optimal portfolio choice for long horizon investors with nontradeable
    labor income, Journal of Finance 56, 433-470.

Wachter, Jessica, 2002, Portfolio and consumption decisions under mean-reverting re-
   turns: An exact solution for complete markets, Journal of Financial and Quantita-
   tive Analysis 37, 63—91.

Wachter, Jessica, 2003, Risk aversion and allocation to long-term bonds, Journal of
   Economic Theory 112, 325—333.

Yao, Rui, and Harold H. Zhang, 2005, Optimal consumption and portfolio choices with
    risky housing and borrowing constraints, Review of Financial Studies 18, 197—239.




                                           52
