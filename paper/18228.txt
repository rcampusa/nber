                                NBER WORKING PAPER SERIES




                     REDISTRIBUTIVE TAXATION IN THE ROY MODEL

                                          Casey Rothschild
                                           Florian Scheuer

                                        Working Paper 18228
                                http://www.nber.org/papers/w18228


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      July 2012




We are grateful to the editor, Robert Barro, three anonymous referees, as well as Craig Brett, Philippe
Choné, Emmanuel Farhi, Mikhail Golosov, Sally Hudson, Matthew Weinzierl, John Weymark, and
seminar participants at the 2012 Taxation Theory Conference (Vanderbilt), SED Annual Meeting (Limassol),
NTA Annual Meeting (Providence), 2013 ASSA Meeting (San Diego), NBER Public Economics Program
Meeting (Cambridge), UC Berkeley, University of Georgia, University of Michigan and LMU Munich
for helpful comments. All remaining errors are our own. This paper is a significantly revised version
of the earlier working paper that circulated under the title “Entrepreneurial Taxation and Occupational
Choice.” The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2012 by Casey Rothschild and Florian Scheuer. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Redistributive Taxation in the Roy Model
Casey Rothschild and Florian Scheuer
NBER Working Paper No. 18228
July 2012, Revised June 2013
JEL No. D5,D80,E2,E6,H2,J3,J6

                                                ABSTRACT

We consider optimal redistribution in a model where individuals can self-select into one of several
possible sectors based on heterogeneity in a multidimensional skill vector. We first show that when
the government does not observe the sectoral choice or underlying skills of its citizens, the constrained
Pareto frontier can be implemented with a single non-linear income tax. We then characterize this
optimal tax schedule. If sectoral inputs are complements, a many-sector model with self-selection
leads to optimal income taxes that are less progressive than the corresponding taxes in a standard single-sector
model under natural conditions. However, they are more progressive than in canonical multi-sector
economies with discrete types and without occupational choice or overlapping sectoral wage distributions.


Casey Rothschild
Wellesley College
106 Central Street
Wellesley, MA 02481
crothsch@wellesley.edu

Florian Scheuer
Department of Economics
Stanford University
579 Serra Mall
Stanford, CA 94305
and NBER
scheuer@stanford.edu
1    Introduction
The Roy (1951) model of self-selection is one of the workhorse models in labor economics.
It has been used to study immigration and locational choice (Borjas, 1987, Dahl, 2002),
schooling (Willis and Rosen, 1979), choice of occupation or industry (Heckman and Sed-
lacek, 1985, 1990), employment in union versus non-union (Lee, 1978) and private versus
public sectors (Borjas, 2002), female labor force participation (Heckman, 1974), training
program participation (Ham and LaLonde, 1996), and the growth-retarding impact of
racial and gender discrimination in labor markets (Hsieh et al., 2011), for example. Its es-
sential feature is that individuals optimally self-select into one of several sectors based on
which one affords them the highest returns. One would expect this sort of self-selection to
have important implications for the design of redistributive income taxes. It is surprising,
then, that these implications have not been studied formally heretofore. This paper takes
a step towards understanding them by analyzing optimal Mirrleesian income taxation in
a two-sector Roy model.
    Incorporating self-selection à la Roy in an optimal taxation framework à la Mirrlees
raises some challenges. In the Mirrleesian approach, the government effectively uses
income taxes to screen individuals based on their unobserved skill (or wage). When
individuals can choose among multiple sectors, the underlying skill is naturally multi-
dimensional: each individual has a skill in each possible sector. It is well-known that
multi-dimensional screening problems are typically challenging (Rochet and Choné, 1998).
We show that the particular screening problem that arises in a many-sector model of opti-
mal income taxation is tractable despite the underlying multi-dimensional heterogeneity.
    We do this by demonstrating that a single non-linear income tax schedule is sufficient
for implementing any incentive compatible allocation if the government cannot or does
not want to condition taxes on sectoral choice. With a single tax schedule, allocations
only depend on the realized wage, not on sectoral choice per se, and hence the multi-
dimensional screening problem “collapses” into an almost standard single-dimensional
“screening on wages” problem. The tools developed by Mirrlees (1971) and others there-
fore apply, with one important difference: the wage distribution will typically be endoge-
nous when there are many sectors to choose from. This is because the productivity of
effort in any given sector will, in general, depend on the aggregate effort expended in this
and in other sectors. We characterize optimal taxes accounting for this endogeneity and
show that, under natural and general assumptions, it implies a force for less progressive
taxation relative to a world with a single sector and an exogenous wage distribution.
    The basic intuition for this result can be understood as follows. Suppose that there are


                                              1
two sectors, a “blue collar” and a “white collar” sector, and individuals are free to choose
to work in either. The government aims at redistributing from high- to low-income in-
dividuals and designs an income tax system accordingly. For administrative, informa-
tional, or political reasons, it may not distinguish between the two sectors: a white collar
and blue collar worker earning the same income y pay the same tax T (y). Even if sec-
toral choice is observable, such a restriction could result from the fact that individuals
can rather easily relabel their type of occupation and would have strong incentives to do
so in the presence of differential taxation, leading to distortions. Unless the government
collects detailed information about the kind of tasks that individuals do, such a reclassi-
fication may be hard or costly to prevent, which motivates our focus on uniform income
taxation. It also corresponds to the actual tax systems in many countries, where the in-
come tax is typically not sector- or occupation-specific.1
    With a linear production technology (i.e., when equivalent units of white and blue
collar efforts are perfect substitutes), the fact that there are two sectors would be irrelevant
(unless the government has an intrinsic sectoral preference). Individuals would choose
to work in the sector in which they are more productive, as reflected in their wage, and
this choice and the resulting wage distribution would be independent of tax policy. The
optimal tax would therefore be exactly the same as it would be in a single-sector Mirrlees
model with the same wage distribution.
    Contrast this with the case in which the two sectors are gross complements. In this
case, sectoral choices and wages will be endogenous to tax policy. Lowering taxes at in-
come levels that are dominated by white collar workers, for example, will differentially
encourage white collar effort. This will reduce the marginal productivity of white col-
lar effort (assuming diminishing marginal products within a given sector) and raise the
marginal productivity of blue collar effort (by complementarity across sectors). It there-
fore indirectly redistributes from white to blue collar workers.
    Suppose now that the blue collar sector is the low-income sector, i.e., that there are
disproportionately more white collar workers at higher incomes. Then this indirect redis-
tribution channel will lead the government to choose a tax system which is less progres-
sive than in a Mirrleesian world with exogenous wages: Lowering taxes on high earners
will disproportionately spur effort in the white collar sector, which will indirectly redis-
tribute from the relatively high-income white collar workers to the lower-income blue
collar workers by raising blue collar wages and lowering white collar wages. Similarly,
   1 There
         are exceptions to this pattern, e.g. the tax treatment of the self-employed versus employed in
some countries. See Scheuer (2012, 2013) for an analysis of differential taxation of entrepreneurs versus
workers.



                                                   2
raising taxes on lower earners will differentially discourage effort in the blue collar sector,
again increasing their wage. This indirect redistribution channel (sometimes referred to
as “trickle down” effects, since lower earners can benefit from tax cuts on higher earners)
therefore leads to less progressive taxes. For example, it implies an optimal top income tax
rate that will generally be negative when the skill distribution is bounded—i.e., strictly
below the well-known zero top rate result.
    This result does not say taxes should be regressive per se. Rather, it says that opti-
mal taxes will be less progressive than they would be in the alternative allocation that
would obtain if the endogeneity of wages implied by a multi-sector Roy model were ne-
glected. Making such a comparison requires formalizing this alternative allocation. We
use the notion of a self-confirming policy equilibrium (SCPE), developed for a different
context by Rothschild and Scheuer (2011), for this. An SCPE describes the tax system that
would emerge in the same economy if the government assumed that it was operating in
a standard exogenous-wage world. In such a world, a government would, following the
standard approach in public finance pioneered by Saez (2001), infer an underlying skill
distribution from the income distribution that it observes given an existing tax system.
Taking this skill distribution as given, it would then design the optimal income tax sys-
tem. In an SCPE, this newly computed optimal income tax system would coincide with
the existing tax system, thus “confirming” its optimality. Our results show that taxes in
such an SCPE are not, in fact, optimal in a multi-sector economy, since the wage-cum-
skill distribution is not, in fact, exogenous. In particular, the optimal taxes would be less
progressive.
    Related Literature. Most closely related to our analysis is Stiglitz (1982), who consid-
ers optimal nonlinear taxation in a two-type model with endogenous wages but without
occupational choice. He also shows that progressive redistributional motives will lead
the optimal top marginal tax rate to be negative when the two types’ efforts are comple-
ments. The indirect redistribution channel driving his results are similar to those driving
ours. Our model differs in two significant ways, however. First, our continuous type
model allows us to study the progressivity of the entire tax schedule, rather than just
the top marginal tax rate. Second, we identify several extra effects that arise in a gen-
eral Roy model, effects which result from (i) endogenous occupational choice and (ii)
the fact that the sectoral wage distributions will typically overlap in a general model
with continuous types, whereas Stiglitz’s discrete type model generically—and some-
what unrealistically—rules out workers in different sectors earning the same wage.
    We show that these extra effects mitigate the general equilibrium effects of taxation
found in Stiglitz (1982) and therefore make optimal taxes more progressive than in a dis-


                                              3
crete type model without occupational choice. To understand why, suppose we reduce
taxes at the top to increase the effort of the top earners. This is desirable insofar as it
indirectly redistributes from high to low incomes by raising the wages of workers in the
low wage sector and lowering the wages of workers in the high wage sector. When there
is endogenous occupational choice, however, there is an additional effect: the change in
wages leads some individuals to shift out of the high wage into the low wage sector. This
undoes some of the original increase in aggregate effort in the high wage sector and blunts
the desirable effects of the original reduction in taxes. As a result, the optimal progressiv-
ity of the tax schedule in our general Roy model is bounded between a standard Mirrlees
model at the progressive end and Stiglitz’s (1982) model at the regressive end.
    Naito (1999) has studied the role of sector-specific income taxes in Stiglitz’s (1982)
two-type model and observed that introducing additional commodity taxes or produc-
tion inefficiencies can be desirable when it relaxes incentive constraints by manipulating
relative wages, thus contradicting the results by Atkinson and Stiglitz (1976) and Dia-
mond and Mirrlees (1971). We do not consider sector-specific or commodity taxation in
this paper. Saez (2004) has contrasted Stiglitz’s model (with fixed occupations but flexible
hours) to a model with fixed hours but flexible occupational choice and shown that the
standard Diamond and Mirrlees (1971) optimal tax formulas apply and that Naito’s re-
sults cease to hold in the latter setting. Saez’s results depend on the assumption that each
wage corresponds to a unique occupation and there is no intensive margin. In contrast,
we allow the wage distributions of different occupations to overlap and consider both
endogenous occupational choice and labor supply.
    Our paper also relates to earlier research on optimal income taxation in models with
endogenous wages and occupational choice, such as Feldstein (1973), Zeckhauser (1977),
Allen (1982), Boadway et al. (1991), and Parker (1999). This literature has largely restricted
attention to linear taxation. An exception is the work by Moresi (1997), who considers
non-linear taxation of profits in a model of occupational choice between workers and
entrepreneurs. The occupational choice margin in his model is considerably simplified,
however, and heterogeneity is confined to affect one occupation only, not the other.
    Restricting heterogeneity to affect one occupation only, or tax schedules to be linear,
sidesteps the complexities of multidimensional screening, which emerge naturally in the
present model. Few studies in the optimal taxation literature have attempted to deal with
multidimensional screening problems until recently. Kleven, Kreiner, and Saez (2009)
have made progress along these lines in a study of the optimal income taxation of cou-
ples and Scheuer (2012) has considered the taxation of entrepreneurs and workers with
occupational choice, but the second dimension of heterogeneity in their models takes a


                                              4
specialized additive form.2 Choné and Laroque (2010) and Brett and Weymark (2003)
use an exogenous “type aggregator” akin to our technique, which can be interpreted as
an endogenous type aggregator. Moreover, the types of heterogeneity they study (tastes
for labor and education, respectively) are again quite distinct from the multi-dimensional
skill types that arise naturally in our Roy model.
    The methodological approach that we pursue here to characterize redistributive tax-
ation in the Roy model builds on Rothschild and Scheuer (2011), who consider optimal
income taxation in an economy with a productive and a rent-seeking sector. While that
paper shares the overall structure of two-dimensional skill heterogeneity and occupa-
tional choice between two sectors, the emphasis is on the corrective role of income taxa-
tion in a setting where wages deviate from the social marginal product of effort due to
rent-seeking externalities, issues that are absent from the present framework.
    More generally, this paper follows the large optimal income taxation literature build-
ing on the seminal contributions of Mirrlees (1971) and Diamond (1998). Until recently,
the theoretical literature focused on deriving results for a given skill distribution and
social welfare function. Saez (2001) instead inferred skills and optimal taxes from the ob-
served income distribution, and Laroque (2005), Werning (2007), and Choné and Laroque
(2010) explored the conditions under which an existing set of taxes is potentially Pareto ef-
ficient. In the same spirit, we characterize Pareto efficient tax policies rather than focusing
on a particular social welfare function. With multiple complementary sectors, however,
the wage distribution is endogenous to the tax code, so existing tests for optimality—e.g.,
Werning (2007), who infers wage-cum-skill distributions from income distributions as a
test of optimality—are potentially misleading. One might conclude that the tax code is in-
deed Pareto efficient given the inferred skill distribution under the (implicit and incorrect)
assumption that the skill distribution is independent of taxes. Our concept of an SCPE,
described above, captures this situation. It is related to the literature on self-confirming
equilibria in learning models (e.g. Sargent, 2009, and Fudenberg and Levine, 2009).
    The paper proceeds as follows. Section 2 describes the basic model and shows that a
single non-linear income tax is a fully general policy tool for a government who observes
income but not effort, wage, or sectoral choice. Section 3 characterizes and compares
optimal and SCPE non-linear taxes. Section 4 compares our results to Stiglitz (1982) and
points out the novel role of occupational choice and overlapping wage distributions in
our model. Section 5 illustrates our theoretical results with a simple empirical calibration.
Section 6 extends our results to allow for unbounded skill distributions and additional
across-occupation cost heterogeneity. Section 7 concludes. All proofs are in the Appendix.
  2 See   also Brett (2007) for a four type model of family taxation with two-dimensional heterogeneity.


                                                      5
2     The Model

2.1   Setup
We consider an economy where a unit mass of individuals can choose between work-
ing in either of two sectors. Accordingly, individuals have a two-dimensional skill type
(θ, ϕ) ∈ Θ × Φ with Θ = [θ, θ ] and Φ = [ ϕ, ϕ]. θ captures an individual’s productivity
when working in the Θ-sector and ϕ captures her Φ-sector skill. These skills are dis-
tributed in the population according to a continuous two-dimensional cdf F (θ, ϕ) with
density f (θ, ϕ). In section 6, we will demonstrate how our results extend to the case
where individuals also differ in their cost of working in one of the sectors, capturing, e.g.,
differential education requirements or tastes for different occupations.
    Individuals have preferences over consumption c and effort e captured by the strictly
concave utility function U (c, e) with Uc > 0, Ue < 0. We denote the consumption, effort,
utility, and sector assigned to an individual of type (θ, ϕ) by c(θ, ϕ), e(θ, ϕ), V (θ, ϕ) ≡
U (c(θ, ϕ), e(θ, ϕ)), and S(θ, ϕ) ∈ {Θ, Φ}, respectively.
    The technology in the economy is described by a constant returns to scale aggregate
production function Y ( Eθ , E ϕ ) that combines the skill-weighted aggregate effort in the
two sectors to produce the consumption good. Formally, aggregate efforts are given by
                  Z                                            Z
           Eθ ≡               θe(θ, ϕ)dF (θ, ϕ)   and   Eϕ ≡                ϕe(θ, ϕ)dF (θ, ϕ)
                      P⊂Θ×Φ                                        Θ×Φ\ P


with P ≡ {(θ, ϕ)|S(θ, ϕ) = Θ} . Since the technology is linear homogeneous, the marginal
products only depend on the ratio of aggregate effort in the two sectors x ≡ Eθ /E ϕ and are
therefore denoted by Yθ ( x ) and Yϕ ( x ). We define an individual’s wage w as the marginal
return to effort, so that
                                      (
                                            Yθ ( x )θ if S(θ, ϕ) = Θ,
                          w(θ, ϕ) =                                                      (1)
                                           Yϕ ( x ) ϕ if S(θ, ϕ) = Φ.

An individual’s income is then given by y(θ, ϕ) ≡ w(θ, ϕ)e(θ, ϕ). As is standard, we
assume U (c, e) to satisfy the single-crossing property, i.e. the marginal rate of substitution
between income and consumption, −Ue (c, y/w)/(wUc (c, y/w)), is decreasing in w.


2.2   Implementation
We start by characterizing a general, direct implementation, where individuals announce
their privately known type (θ, ϕ) and then get assigned consumption c(θ, ϕ), income


                                                   6
y(θ, ϕ) and a sector to work in S(θ, ϕ). Assuming that income and consumption are ob-
servable but not sectoral choice, wage, or effort, the resulting incentive constraints that
guarantee truth-telling of the agents are as follows. First, suppose S(θ, ϕ) = Θ, i.e. type
(θ, ϕ) is assigned to the Θ-sector. Then incentive compatibility requires that

                                                y(θ 0 , ϕ0 )                              y(θ 0 , ϕ0 )
                                                                                                   
            y(θ, ϕ)                              0   0                             0    0
 U c(θ, ϕ),                  ≥ max U c(θ , ϕ ),                          , U c ( θ , ϕ ),                     ∀θ 0 , ϕ0
            Yθ ( x )θ                            Yθ ( x )θ                                Yϕ ( x ) ϕ

since there are two ways for type (θ, ϕ) to imitate another type (θ 0 , ϕ0 ), namely by earning
(θ 0 , ϕ0 )’s income either in the Θ- or the Φ-sector. Analogously, if S(θ, ϕ) = Φ, we need

                                                y(θ 0 , ϕ0 )                              y(θ 0 , ϕ0 )
                                                                                                   
           y(θ, ϕ)                               0   0                             0    0
U c(θ, ϕ),                   ≥ max U c(θ , ϕ ),                          , U c ( θ , ϕ ),                     ∀θ 0 , ϕ0 .
           Yϕ ( x ) ϕ                            Yθ ( x )θ                                Yϕ ( x ) ϕ

    The assumption that only income, but not the wage or effort is observable is standard
to optimal income tax models since Mirrlees (1971). Even though sectoral choice may be
observable in some applications, it is worth emphasizing again that conditioning alloca-
tions on occupations may be hard to enforce in practice. This motivates our approach of
treating occupational choice as de facto non-contractible for the government. The follow-
ing lemma shows that, under these assumptions, any incentive compatible allocation can
be decentralized by offering a single non-linear income tax T (y).

Lemma 1. Suppose that only income y and consumption c are observable, whereas an individual’s
skill type (θ, ϕ), effort e and sectoral choice S are private information. Then for any incentive
compatible allocation {c(θ, ϕ), y(θ, ϕ), S(θ, ϕ), x }, the following properties hold:
(i) w(θ, ϕ) = max{Yθ ( x )θ, Yϕ ( x ) ϕ} and
                                             (
                                                 Θ if Yθ ( x )θ > Yϕ ( x ) ϕ,
                                S(θ, ϕ) =                                                                            (2)
                                                 Φ if Yϕ ( x ) ϕ > Yθ ( x )θ;

(ii) U (c(θ, ϕ), y(θ, ϕ)/w) = U (c(θ 0 , ϕ0 ), y(θ 0 , ϕ0 )/w) for all (θ, ϕ), (θ 0 , ϕ0 ) such that w(θ, ϕ) =
w(θ 0 , ϕ0 ) = w;
(iii) {c(θ, ϕ), y(θ, ϕ), S(θ, ϕ), x } can be implemented by offering the single non-linear income tax
schedule T ∗ (y) corresponding to the retention function R∗ (y) = y − T ∗ (y) defined by
                                                                                                         
          ∗                      y(θ, ϕ)                              y
        R (y) ≡ max c U c(θ, ϕ),                             ≥ U c,                    ∀(θ, ϕ) ∈ Θ × Φ               (3)
                 c               w(θ, ϕ)                            w(θ, ϕ)

and letting all agents choose one of their most preferred (c, y)-bundles from the resulting budget
set B∗ = {(c, y)|c ≤ y − T ∗ (y)}.

                                                         7
Proof. In Appendix A.

    In other words, individuals work in the sector in which they earn a higher wage, any
two individuals with the same wage achieve the same utility, and the so-called principle
of taxation extends to our setting. The first two properties follow directly from incentive
compatibility. For part (iii), the retention function R∗ (y) constructed in (3) to implement
a given incentive compatible allocation is the lower envelope of the indifference curves of
all individuals through the consumption-income bundle assigned to them. Given these
properties, the direct mechanism boils down to allocating (c, y)-pairs to a set of individu-
als with different wages, as in a standard optimal taxation problem.
    Lemma 1 does not rule out the possibility that two individuals with the same wage
(e.g. in different sectors) choose different consumption-income bundles, even though,
by property (ii), these bundles must be located on the same indifference curve in the
(c, y)-space. Since the type distribution F (θ, ϕ) is continuous, we can nevertheless re-
strict attention to allocations that pool all same-wage individuals at the same allocation.
To see why, observe that for any ŵ such that two types who both earn wage ŵ receive
distinct allocations (c1 , y1 ) and (c2 , y2 ), the retention function R∗ (y) described in (3) and
the wage-ŵ indifference curve must coincide between y1 and y2 . The number of such
wages ŵ must therefore be countable and the measure of types at such wages must be
zero. Pooling all individuals at each such ŵ at a bundle ( R∗ (y), y) with y between y1
and y2 is therefore incentive compatible and resource feasible, and, moreover, affects nei-
ther the aggregate effort in either sector nor, a fortiori, x. Since pooling in this manner
does not alter any type’s utility, the Pareto frontier can be traced out by using only alloca-
tions {c(w), y(w), x } that pool all same-wage individuals and where wages w and sectoral
choice S(θ, ϕ) are as described in Lemma 1. We focus on such allocations henceforth.


3     Characterizing Optimal Income Taxes

3.1   Pareto Optima and Self-Confirming Equilibria
For any given x, the marginal productivities in the two sectors, Yθ ( x ) and Yϕ ( x ), the
two-dimensional skill distribution, F (θ, ϕ), and the implied sectoral choice described in
(2) together induce a one-dimensional wage distribution characterized by the cdf and
sectoral densities                                         
                                            w        w
                           Fx (w) ≡ F             ,           and
                                          Yθ ( x ) Yϕ ( x )



                                                8
                          Z w/Yϕ ( x)                                              Z w/Yθ ( x)             
                 1                                  w                ϕ         1                       w
  f xθ (w)   =                            f                , ϕ dϕ, f x (w) =                    f θ,            dθ,
               Yθ ( x )     ϕ                     Yθ ( x )                   Yϕ ( x ) θ              Yϕ ( x )
                                                     ϕ                                             ϕ
with associated cdfs Fxθ (w) and Fx (w) and with f x (w) = f xθ (w) + f x (w). We also define
the bottom and top wages given x as
                             n                     o           
                    w x = max Yθ ( x )θ, Yϕ ( x ) ϕ , w x = max Yθ ( x )θ, Yϕ ( x ) ϕ .

To trace out the Pareto frontier, we assign Pareto weights G (θ, ϕ) in the two-dimensional
skill space. As with the type distribution F (θ, ϕ), we can integrate the Pareto weights
G (θ, ϕ) to obtain a distribution of Pareto weights over wages given x, denoted by Gx (w),
                                                       ϕ                          ϕ
with the corresponding densities gx (w) = gθx (w) + gx (w) (and cdfs Gxθ (w) and Gx (w)).
    Fixing x, the optimal income tax problem in a Roy model thus collapses to a one-
dimensional screening problem despite the underlying two-dimensional heterogeneity
in the economy. In particular, the Pareto problem is an almost standard Mirrlees problem
with the additional constraint that the individuals’ efforts and sectoral choices must be
consistent with x. Formally, we must require that
                                    Z wx
                                                 w
                                                        e(w) f xθ (w)dw
                                         wx    Yθ ( x )
                          x̃ ( x ) ≡ Z   wx
                                                                        = x,          or equivalently             (4)
                                                 w              ϕ
                                                        e(w) f x (w)dw
                                         wx    Yϕ ( x )
                                   Z wx                                       Z wx
                                                                                               ϕ
                  (1 − α( x ))                we(w) f xθ (w)dw − α( x )              we(w) f x (w)dw = 0,         (5)
                                    wx                                         wx

where α( x ) denotes the aggregate income share of the Θ-sector:

                                                           xYθ ( x )         Y ( x ) Eθ
                                         α( x ) ≡                          = θ             .
                                                      xYθ ( x ) + Yϕ ( x )  Y ( Eθ , E ϕ )

We employ the standard approach of optimizing directly over c(w), y(w)-allocations. In
fact, it is equivalent but formally more useful to optimize over e(w), V (w)-bundles, where
V (w) = U (c(w), e(w)) and e(w) = y(w)/w. With this, we can write the Pareto problem
for income taxation in the Roy model as
                                                                       Z wx
                                     max W ( x ) ≡            max             V (w)dGx (w)                        (6)
                                          x                e(w),V (w) w x




                                                                   9
subject to (5),

                                                          e(w)
                  V 0 (w) + Ue (c(V (w), e(w)), e(w))          = 0 ∀ w ∈ [ w x , w x ],              (7)
                                                            w

and                        Z wx
                                  (we(w) − c(V (w), e(w))) f x (w)dw ≥ 0,                            (8)
                            wx

where c(V, e) denotes the inverse of U (.) w.r.t. its first argument. We refer to the three
constraints (5), (7) and (8) as the consistency condition, the incentive constraints and the
resource constraint, respectively.3
     As suggested by the notation in (6), it is useful to decompose the Pareto problem (5) to
(8) into an “inner” problem, given x, and an “outer” problem, which maximizes over x.
Formally, fix some x and let W ( x ) denote the value of the objective (6) when maximizing
over V (w), e(w) subject to (5), (7) and (8) (the inner problem). Then the outer problem is
simply maxx W ( x ).
     For some of the subsequent analysis, it will be useful to restrict attention to solutions of
the Pareto problem when the Pareto weights have the special form G (θ, ϕ) = Ψ( F (θ, ϕ)).
It is straightforward to show that gθx (w)/ f xθ (w) = gx (w)/ f x (w) and Gx (w) = Ψ( Fx (w))
                                                          ϕ      ϕ

for such weights and any given x. The same welfare weight is thus assigned to any two
individuals with the same (endogenously determined) wage and we can think of Ψ as
a measure of how much social welfare weight is attached to different quantiles of the
(endogenous) wage distribution. We refer to such weights as relative welfare weights and
use Ψ instead of G to distinguish this special case from the general one.
     In order to compare the Pareto optimal tax schedules described so far with the cor-
responding optimal tax schedule in a standard Mirrlees model, we solve the following
benchmark inner-outer problem decomposition using relative welfare weights Ψ. For a
given x, we consider the relaxed inner problem:
                                              Z wx
                                      max            V (w)dΨ( Fx (w))                                (9)
                                    e(w),V (w) w x


subject to (7) and (8)—i.e., we drop the consistency constraint (5) and solve a standard
Mirrleesian problem taking the wage distribution Fx (w) as given. To ensure that the re-
   3 Note that we have made use of the local version of the incentive constraints in (7). It is a stan-
dard result (see e.g. Fudenberg and Tirole (1991), Theorems 7.2 and 7.3) that, under the single-crossing
condition, the local incentive constraints (7) together with the monotonicity constraint that income y(w)
must be non-decreasing in w are equivalent to the global incentive constraints V (w) = U (c(w), e(w)) =
maxw0 U (c(w0 ), (e(w0 )w0 )/w) for all w, w0 . We follow the usual approach of dropping the monotonicity
constraint and verifying ex post that the solution satisfies it, abstracting from issues of bunching.


                                                     10
sulting allocation is consistent with the original economy, however, we need to require
that the x̃ induced by the solution to the inner problem is equal to the original x that was
taken as given to solve the standard Mirrlees problem. The “outer” problem thus requires
that x be a fixed point of the mapping x → x̃ ∗ ( x ), where x̃ ∗ ( x ) is defined by (4), evaluated
at the effort allocation e(w) that solves the relaxed inner problem (7) to (9).
    The solution ( T̂ (y), x ∗ ) to this benchmark problem is interpretable as a self-confirming
policy equilibrium (SCPE) as developed in a different context in Rothschild and Scheuer
(2011). Suppose that taxes happen to be set at T̂ (y) (thereby inducing x = x ∗ ) and con-
sider a social planner with Pareto weights Ψ( Fx∗ (w)) who takes the wage distribution to
be exogenous to the tax code, as in a standard Mirrlees model. This social planner would,
following Saez (2001), observe the income distribution induced by T̂ (y) and infer the un-
derlying wage distribution Fx∗ (w) from it. It would then compute the optimal Mirrleesian
taxes given Ψ and Fx∗ (w) and “confirm” the optimality of the existing tax code T̂ (y). T̂ (y)
would not, in fact, be optimal in light of the endogeneity of wages to the tax code, but a
social planner who takes wages to be exogenous would have no reason to explore other
regions of the tax-policy space, given the “confirmed” optimality of the status quo.4

Definition 1. An SCPE is a value of x and an allocation V (w), e(w) such that (i) x is a fixed
point of x̃ ∗ ( x ) and (ii) V (w) and e(w) solve the inner SCPE problem given x.

   Hence, our definition of an SCPE is the most straightforward way of capturing stan-
dard Mirrleesian taxation in our framework in a consistent way. We will compare SCPE
and Pareto optima for given weights Ψ in our numerical explorations in section 5.


3.2    Example: Entrepreneurs and Workers
Before characterizing optimal income tax schedules in Pareto optima and SCPE, we briefly
demonstrate that our model can readily capture the situation where agents in one sector
are hired by agents in the other sector, as in Scheuer’s (2012) model of entrepreneurship
and endogenous firm formation. In particular, suppose Θ is the entrepreneurial sector
and Φ the workers’ sector, and individuals have skills θ and ϕ in the respective activities.
Let workers supply effective labor l ≡ ϕe at (endogenous) wage ω. Entrepreneurs hire ef-
fective labor in a competitive labor market taking the wage ω as given, and combine this
labor L with their own effective entrepreneurial effort E ≡ θe using a constant returns to
   4 Note the importance of using relative welfare weights here: the SCPE social planner is unaware of the
multi-sector character of the economy, so using general Pareto weights G (θ, ϕ) would be inconsistent with
the planner’s incorrect model of the economy.



                                                   11
scale technology Y ( E, L) (with diminishing marginal products of E and L) to produce a
consumption good.
   Entrepreneurs will choose E and L to maximize utility

                     max U (Y ( E, L) − ωL − T (Y ( E, L) − ωL), E/θ ) ,
                      E,L


where T (π ) (with T 0 ≤ 1) is the nonlinear income (profit) tax. This immediately implies
that, for any given effective effort E and wage ω, entrepreneurs set their labor demand by
solving the subproblem max L Y ( E, L) − ωL with the necessary condition YL ( E, L) = ω.
By constant returns to scale, YL depends only (and monotonically) on the ratio E/L. This
necessary condition therefore implicitly defines the input mix of all firms via E/L ≡ χ(ω ),
where χ(·) is the inverse of YL .
    Moreover, by constant returns to scale, profits are π = Y − ωL = YE E + YL L − ωL =
YE E. We can therefore view entrepreneurs as facing a wage ω̃ ≡ YE on their effective
entrepreneurial effort, which, by ω̃ = YE (χ(ω )), is a decreasing function of ω. Conse-
quently, ω fully determines the occupational choice and wage for each individual: Just
like in the Roy model, individuals will select the sector which affords them a higher return
on their effort, so that w ≡ max {ω̃ (ω )θ, ωϕ}. We can therefore again write allocations
c(w), e(w) as a function of the wage w and obtain a wage distribution Fω (w) and sectoral
            ϕ
densities f ω (w), f ωθ (w), and so forth, conditional on ω.
    In equilibrium, ω has to be such that the labor market clears, i.e. such that total effec-
tive labor hired by all individuals who decide to enter entrepreneurship is equal to total
effective labor supplied by all workers. Effective labor demand per firm is L = E/χ(w)
and effective entrepreneurial effort is E = eθ = ew/ω̃. Analogously, effective labor sup-
ply per worker can be written as l = eϕ = ew/ω. Hence, labor market clearing requires
                    Z wω                                Z wω
                                    w                                 w ϕ
                            e(w)         f ωθ (w)dw =          e(w)     f ω (w)dw.        (10)
                     wω          ω̃χ(ω )                 wω           ω

This shows that, in this model, the consistency condition (4) can be interpreted as a labor
market clearing condition: Equation (10) is completely equivalent to (4) since there is a
one-to-one relationship between ω and χ, ω = YL (χ), ω̃ = YE (χ), and χ = x.
   Finally, note that using a firm-level production function is equivalent to the aggregate
production function Y ( Eθ , E ϕ ) that we consider for the Roy model, since total output




                                                12
produced by all entrepreneurs is
         Z wω                                                     Z w
                     w           w        θ                1    1         ω
            Y e(w) , e(w)               f ω (w)dw = Y        ,              e(w)w f ωθ (w)dw
         wω          ω̃       ω̃χ(ω )                     ω̃ ω̃χ(ω )   wω
          Z w                    Z wω                         
               ω     w                           w
      = Y        e(w) f ωθ (w)dw,       e(w)         f θ (w)dw
            wω       ω̃            wω         ω̃χ(ω ) ω
          Z w                    Z wω                    
               ω     w θ                      w ϕ
      = Y        e(w) f ω (w)dw,        e(w) f ω (w)dw ,
            wω       ω̃            wω         ω

where we repeatedly used the fact that Y has constant returns to scale and the last step
used condition (10).


3.3     Inner Problem
We start by using the inner problem, taking x as given, to derive formulas for marginal
tax rates that have to be satisfied in any Pareto optimum.

Proposition 1. Let µ denote the multiplier on the resource constraint (8), let µξ denote the mul-
tiplier on the consistency condition (5), and use εu (w) and εc (w) to denote the uncompensated
and compensated labor supply elasticities, respectively. For any given Pareto weights G, optimal
marginal tax rates satisfy
                                                                                                     −1
                                                                            η (w) 1 + εu (w)
                                                                
                 0                           f xθ (w)
           1 − T (y(w)) =          1+ξ                − α( x )          1+                                   (11)
                                             f x (w)                       w f x (w) εc (w)

where

                                                                       εu (s)
                     Z wx                                 Z z                          
                                 gx (z) Uc (z)                                      dy(s)
           η (w) =            1−                      exp            1− c                       f x (z)dz.   (12)
                      w          f x (z) µ                       w     ε (s)        y(s)

Proof. See Appendix B.

   Since the inner SCPE problem differs from the inner Pareto problem only by the ab-
sence of the consistency condition (5), the marginal tax rates for an SCPE can be found
by using relative Pareto weights Ψ and setting ξ = 0 in Proposition 1, as in the following
Corollary.

Corollary 1. For any given relative Pareto weights Ψ, marginal tax rates in the resulting SCPE
satisfy
                                               η ( w ) 1 + ε u ( w ) −1
                                                                   
                            0
                      1 − T (y(w)) = 1 +                                ,                  (13)
                                              w f x (w) εc (w)


                                                       13
where

                                                                             εu (s)
                  Z wx                                          Z z                          
                                 0         Uc (z)                                         dy(s)
        η (w) =            1 − Ψ ( Fx (z))                exp              1− c                       f x (z)dz.         (14)
                   w                         µ                      w        ε (s)        y(s)

    The formulas for an SCPE are the same as for a standard Mirrlees model (see e.g. Saez,
2001). In contrast, in any Pareto optimum, the formula for marginal keep shares 1 − T 0 is
adjusted compared to the SCPE by a correction factor that depends on ξ and a comparison
between the aggregate income share of the Θ-sector, given by α( x ), with its local income
share y(w) f xθ (w)/(y(w) f x (w)) = f xθ (w)/ f x (w).5
    This is intuitive. For instance, suppose ξ > 0—which we will show in section 3.5
corresponds to the case where Θ is the high-income sector. Then the marginal keep share
is scaled up in the Pareto problem relative to the SCPE whenever, at the given wage (or
equivalently income) level, the local income share of the Θ-sector exceeds its aggregate
income share. This disproportionately encourages Θ-sector effort and therefore raises
wages in the Φ-sector relative to the Θ-sector. Hence, the solution to the Pareto problem
uses this “trickle down” channel through wages in order to redistribute to the low-income
sector, which is desirable for relative Pareto weights with Ψ( F ) ≥ F for all F ∈ [0, 1]. Note
that this implies a force towards less progressivity in the Pareto optimum relative to the
SCPE: If Θ is the high-income sector, marginal tax rates will be scaled up (down) in the
Pareto problem compared to the SCPE for low (high) income levels.6
    As usual, η (w) captures the redistributive motives of the social planner as well as
income effects. The optimal tax formula therefore simplifies considerably if income effects
disappear and preferences are of the quasilinear form U (c, e) = c − h(e). Then Uc (w) =
µ = 1 and εc (w) = εu (w) ≡ ε(w), which leads to the following corollary:

Corollary 2. With quasilinear preferences, the marginal tax rate in any Pareto optimum satisfies
                                                                                                              −1
                                                                       Gx (w) − Fx (w)
                                                                                        
           0                             f xθ (w)                                                      1
    1 − T (y(w)) =          1+ξ                   − α( x )          1+                            1+                 .
                                         f x (w)                           w f x (w)                 ε(w)

    Without income effects, the redistributive effect of taxation is simply given by η (w) =
Gx (w) − Fx (w), which is increasing in the degree to which Gx (w) puts weight on low-
   5 The formulas in Proposition 1 and Corollary 1 will eventually be evaluated at the optimal x-values from

solving the respective outer problems. Since, in general, the level of x in the SCPE and the Pareto optimum
will differ for a given economy, even when based on the same Pareto weights Ψ, the formulas do not permit
a direct comparison of tax rates at the two solutions. One interpretation, however, is as a comparison of the
tax rates in two different economies with the same endogenous wage distributions.
   6 The same would be true if Φ were the high-income sector. We will show below that, in this case, ξ is

negative and hence, per (11), marginal tax rates will again be higher (lower) in the Pareto optimum for low
(high) income levels.

                                                             14
wage earners over and above their population share Fx (w). The marginal tax rate is also
decreasing in the elasticity ε(w), which captures the distortionary effects of taxation as in
Diamond (1998). Again, the correction factor ξ ( f xθ (w)/ f x (w) − α( x )) comparing aggre-
gate and local income shares of the Θ-sector is applied to marginal keep shares.
    Independent of whether preferences exhibit income effects or not, the top marginal
tax rate is generally not zero in a Pareto optimum, as the following result demonstrates.

Corollary 3. The top marginal tax rate is zero in any SCPE and given by
                                                                                    
                                    0                                   f θ (w x )
                                  T (y(w x )) = ξ              α( x ) − x
                                                                        f x (w x )

in any Pareto optimum. In particular, if f xθ (w x )/ f x (w x ) = 0 respectively f xθ (w x )/ f x (w x )
= 1), then T 0 (y(w x )) = ξα( x ) (respectively T 0 (y(w x )) = −ξ (1 − α( x ))).

  In the next subsections, we will use the outer problem to determine the sign of ξ,
which will generally be such that this top marginal tax rate is negative.


3.4     Outer Problem
Denoting the substitution elasticity of the production function Y ( Eθ , E ϕ ) by σ( x ), we can
derive the following decomposition of the welfare effect of a marginal change in x.

Lemma 2. For any Pareto weights G, the welfare effect of a marginal change in x can be decom-
posed as follows:
                                                                             
                   0       1                        1
                W ( x ) = − ξµα( x )Yϕ ( x ) E ϕ +       ( I + R + ξµ(S + C )) ,                    (15)
                           x                       σ( x)

where                                        Z wx                          
                                  1                  2       w         w
                       S≡                    w e(w) f               ,          dw > 0,              (16)
                          Yθ ( x )Yϕ ( x )
                                       wx                 Yθ ( x ) Yϕ ( x )
                                                                         !
                                Z wx                0
                                                  V (w) d
                                                                   ϕ
                                                                 f x (w)
                           I≡µ        η (w)w                                dw,                     (17)
                                  wx              Uc (w) dw f x (w)
                                                                                  !
                          Z wx
                                        f θ (w) f ϕ (w)    g  θ (w)     g
                                                                          ϕ
                                                                            ( w )
                                                   x                      x
                       R≡      wV 0 (w) x                     x
                                                                      − ϕ           dw,             (18)
                           wx                f x (w)       f xθ (w)     f x (w)
and                                      Z wx                   ϕ
                                                         f (w) f xθ (w)
                                   C≡             w e (w) x
                                                    2 0
                                                                        dw.                         (19)
                                             wx             f x (w)


                                                          15
Proof. In Appendix B.2.

    We provide a heuristic derivation to illustrate the intuition behind this lemma and
the terms in (16) to (19). Notice first that if technology is linear, so that σ( x ) = ∞, then
setting W 0 ( x ) = 0 in (15) immediately implies ξ = 0. By Proposition 1, the marginal tax
formulas for the SCPE and Pareto problems coincide. This is intuitive: in this case, wages
are exogenous to the tax code, so the fact that there are two sectors is irrelevant. It is
only the additional effects driven by the endogeneity of wages in the finite σ( x ) case that
provide scope for using additional tools for accomplishing redistributive objectives.
    In particular, observe that when σ( x ) < ∞, a small increase in x has several effects.
First, it has a direct effect on the consistency condition (5), or equivalently,

                                               Eθ
                                                  − x = 0.                                          (20)
                                               Eϕ
                                                                          
Second, it has wage effects, since type (θ, ϕ)’s wage is given by w = max θYθ ( x ), ϕYϕ ( x )
and hence depends on x. Finally, it has a sectoral shift effect since it will induce some
individuals to migrate from the Θ- to the Φ-sector due to the decreased wages in the
Θ-sector and increased wages in the Φ-sector. The term S in equation (16) in Lemma 2
captures this sectoral shift effect, which we derive first. We then return to a discussion
of the other terms in equations (17) to (19), which are attributable to the direct and wage
effects.


3.4.1   The Sectoral Shift Effect

To derive the sectoral shift effect, it is useful to write the consistency condition as (1 −
                                                         Rw
α( x )) Zθ ( x ) − α( x ) Z ϕ ( x ) = 0, where Zθ ( x ) ≡ w we(w) f xθ (w)dw is the income earned in
the Θ-sector, and similarly for Z ϕ ( x ). Consider a small increase ∆x in x, holding efforts
and wages constant. This will lead some individuals to shift from the Θ- to the Φ-sector,
as illustrated in figure 1. Let ∆Zθ ( x ) denote the resulting change in Θ-sector income.
Since there is an equal and opposite change in Φ-sector income, the sectoral shift effect
can be written as S = ∆Zθ ( x ). Figure 1 illustrates the computation of ∆Zθ ( x ). It considers
the mass element of individuals with Θ-sector skills between θ and θ + dθ who are in the
Θ-sector at x but in the Φ-sector at x + ∆x. The height of this element is

                                                 Yθ0 ( x )Yϕ ( x ) − Yθ ( x )Yϕ0 ( x )
                                                                                        !
                 d Yθ ( x )/Yϕ ( x )
                                       θ∆x =                                                 θ∆x.
                         dx                                   Yϕ ( x )2



                                                   16
                                   Density:       ,


                              Income/worker:
                                        )                                                                Δ




                                                                           ̅



             Figure 1: Illustrating the computation of the sectoral shift effect



The income earned by each individual in that element is θYθ ( x )e (θYθ ( x )), and the den-
                                              
sity of individuals is f θ, θYθ ( x )/Yϕ ( x ) . Multiplying the width (dθ) by the height, the
density, and the per capita income, and then integrating over θ gives:

                           Yθ0 ( x )Yϕ ( x ) − Yθ ( x )Yϕ0 ( x )
                                                                   !                                               
                                                                                                         θY ( x )
                     Z θ
    ∆Zθ ( x ) = ∆x                                                             2
                                                                       Yθ ( x )θ e (θYθ ( x )) f       θ, θ             dθ
                      θ                 Yϕ ( x )2                                                        Yϕ ( x )
                                     Z w
                 −1/( xσ( x ))
                                                                                  
                                                               w        w
            = ∆x                              2
                                           w e (w) f                 ,                 dw,
                 Yθ ( x )Yϕ ( x )      w                     Yθ ( x ) Yϕ ( x )

where the second step involves changing variables to w = θYθ ( x ) and using xσ( x ) =
Yϕ0 ( x )/Yϕ ( x ) − Yθ0 ( x )/Yθ ( x ) (viz Lemma 3 in Appendix B.2.) The sectoral shift term S
defined in expression (16) follows directly.


3.4.2   The Direct and Wage Effects

Towards understanding the other terms in Lemma 2, first consider the thought experi-
ment of changing x—and hence the wage distribution—while holding effort and sector
constant for each individual. The first term in expression (15) is equal to the effect of this
change on the consistency condition (5), which can be seen by observing that the effect on
the reformulated constraint (20) is −1 and that the original and reformulated constraints
differ by a factor of α( x )Yϕ ( x ) E ϕ /x.

                                                         17
    This thought experiment is not actually feasible, however, since it requires assign-
ing two individuals with the same wage (but in different sectors) different (e(w), V (w))-
bundles after the change in x. The approach we take in the formal proof in Appendix B.2
is instead motivated by a related but feasible thought experiment: increase x by a small
amount while holding the e(w) and V (w) schedules fixed at each wage w rather than for
each type.7
    This thought experiment leads to changes in aggregate efforts and utilities, eagg (w) ≡
e(w) f x (w) and Vagg (w) ≡ V (w) f x (w), at any given w. The algebraic manipulations in our
proof are driven by thinking of the thought experiment in two steps: first, a change in the
schedules e(w) and V (w) at the original x and wage distribution that absorbs the aggre-
gate change in eagg (w) and Vagg (w) induced by the change in x at each wage; and second,
a change in x—and the wage distribution—coupled with a reversion to the original e(w)
and V (w) schedules. This second part, by construction, holds eagg (w) and Vagg (w) at
each w constant, but re-allocates that effort and utility across individuals who originally
earned the same wage but in different sectors. By an envelope argument, only the second,
re-allocating step has welfare effects. Since the resource constraint (8) depends only on
eagg (w) and Vagg (w) at each wage, it is unaffected in this second step. The terms C, I and
R arise from the effects on the other constraints (5) and (7) and the objective (6).
    The effect of the re-allocating change on the reformulated consistency constraint (20)
has two components: the −1 term from the (infeasible) thought experiment considered
above, and a second term—labeled C in expression (19)—which arises because the across-
sector re-allocation of effort at each wage affects Eθ /E ϕ . Intuitively, an increase in x raises
the wage of Φ-sector wage-w types and lowers the wage of Θ-sector wage-w types. If
e0 (w) > 0, this effectively re-allocates effort from the Θ- to the Φ-sector since Θ-workers
move down and Φ-workers move up along the e(w) schedule. It therefore reinforces the
re-allocation of effort across sectors from the sectoral shift effect S.
    The term R in (18) arises analogously: the re-allocation of V across sectors at each w
affects the objective insofar as the planner assigns different welfare weights to workers in
different sectors but at the same wage. It therefore disappears when there is no intrinsic
                                             ϕ                 ϕ
sectoral preference—i.e., when gθx (w)/gx (w) = f xθ (w)/ f x (w) for all w, as will be the case
with relative welfare weights G (θ, ϕ) = Ψ( F (θ, ϕ)). In contrast, when the social planner
has an intrinsic preference for the Θ-sector individuals at wage w, the re-allocation of
utility from the Θ- to the Φ-sector is welfare reducing.
    Finally, the term I in equation (17) arises from the incentive effect of the re-allocating
   7 An alternative approach, leading to the same results, is to break the incentive constraint into two sector-

specific constraints. See Rothschild and Scheuer (2011) for an example of this approach in a related problem.


                                                      18
step of the thought experiment. To understand it, suppose that the share of Θ-sector
workers is locally increasing at some w. Then an increase in x, which raises Φ-sector
wages and lowers Θ-sector wages, leads to a local compression of the wage distribu-
tion. Such a compression eases the local incentive compatibility constraints if they are
downward-binding, in which case η (w) > 0. The increase in x therefore leads to a wel-
                                        ϕ           
fare improvement insofar as η (w)d f x (w)/ f x (w) /dw < 0, and the magnitude of this
improvement will be related to how steeply increasing the utility distribution is. As we
will formalize in the subsequent section, I can be thought of as a (generalized) Stiglitz
(1982) effect: with endogenous wages, increasing (decreasing) effort at high (low) wages
will raise (lower) wages at low (high) wages. In contrast, the sectoral shift and other wage
effects, captured by S, C and R, are not present in Stiglitz’s (1982) framework.


3.5    Marginal Tax Rate Results
We can use the decomposition in Lemma 2 to sign the multiplier on the consistency con-
dition ξ at an optimal x by setting W 0 ( x ) = 0 in equation (15):
                                                                           
                               I+R                                   C+S
                           ξ=−                  α( x )Yϕ ( x ) E ϕ +             .                (21)
                               µσ ( x )                              σ( x)

We summarize the resulting conditions for the sign of ξ in the following corollary:

Corollary 4. With a linear technology (σ( x ) = ∞), ξ = 0.
For σ ( x ) ∈ (0, ∞), the following holds for any Pareto optimum with (i) increasing effort (e0 (w) ≥
0) and (ii) downwards-binding incentive constraints (η (w) ≥ 0 for all w):
                                                                                     ϕ   ϕ
   1. ξ ≥ 0 if f xθ (w)/ f x (w) is increasing in w and gθx (w)/ f xθ (w) ≤ gx (w)/ f x (w) ∀w,
                 ϕ                                                                   ϕ   ϕ
   2. ξ ≤ 0 if f x (w)/ f x (w) is increasing in w and gθx (w)/ f xθ (w) ≥ gx (w)/ f x (w) ∀w.

The inequalities in 1. and 2. are strict if η (w) is not identically zero.

    Conditions (i) and (ii) are sufficient, but not necessary. The former ensures that the
wage shift term C reinforces the sectoral shift effect. By equation (12), the latter holds
whenever the social marginal value of consumption, given by Uc (w) gx (w)/ f x (w), is
decreasing in w. This is guaranteed with quasilinear-in-consumption preferences and
weakly progressive welfare weights (i.e., decreasing gx (w)/ f x (w)), for example. It en-
sures that a compression of the wage distribution eases the incentive compatibility con-
straints. If f xθ (w)/ f x (w) is increasing in w, then Θ is the high-skill sector, and an increase
in x, by raising wages in the Φ-sector and lowering them in the Θ-sector, has desirable

                                                   19
wage compression effects, as in Stiglitz (1982). This desirable effect is reinforced by the re-
                                    ϕ        ϕ
distribution effect R whenever gx (w)/ f x (w) ≥ gθx (w)/ f xθ (w) ∀w. In this case, the social
planner puts higher social welfare weight on Φ-sector workers than on Θ-sector workers
at any given wage, and the wage changes induced by an increase in x also have direct
welfare benefits.
     Combining these results from the outer problem with the marginal tax rate results
from the inner problem has crisp implications for the comparison between Pareto op-
timal and SCPE tax schedules. For instance, suppose Θ is the high-skilled sector, i.e.
  ϕ
f x (w)/ f x (w) is decreasing so that ξ > 0 under conditions (i) and (ii) in Corollary 4 (and
assuming no intrinsic redistributive motives across sectors). Then by equation (11) in
Proposition 1, the marginal keep share in the Pareto optimum is scaled down relative
to the SCPE wherever the local income share in the Φ-sector is higher than in aggre-
gate. This disproportionately reduces Φ-sector effort and therefore indirectly increases
wages in the Φ-sector, achieving redistribution to the low-skilled sector. In particular,
        ϕ
since f x (w)/ f x (w) is decreasing, this means that marginal keep shares are scaled down
for low wages and scaled up for high wages, and the top marginal tax rate is negative.
                                     ϕ
     On the other hand, suppose f x (w)/ f x (w) is increasing, so that ξ < 0. Marginal keep
                                            ϕ
shares will be scaled down whenever f x (w)/ f x (w) is low, i.e., again for high wages. The
top marginal tax rate is also again negative. In both of the two cases the general equilib-
rium effects in the Roy model work in favor of less progressive taxation. We summarize
these insights in the following Proposition:

Proposition 2. If σ( x ) ∈ (0, ∞), then the top marginal tax rate is negative in any Pareto opti-
mum with
(i) a decreasing i-sector share of workers f xi (w)/ f x (w), i ∈ {θ, ϕ},
(ii) an increasing effort schedule e(w),
(iii) a decreasing social marginal utility of consumption schedule Uc (w) gx (w)/ f x (w) and
                                                                                    j        j
(iv) a weak intrinsic social preference for the i-sector, i.e. gix (w)/ f xi (w) ≥ gx (w)/ f x (w) for all
w, j 6= i ∈ {θ, ϕ}.

    Notably, consider the special case with relative welfare weights. Then Gx (w) = Ψ( Fx (w)),
gx (w) = Ψ0 ( Fx (w)) f x (w), and hence

                  gθx (w) = Ψ0 ( Fx (w)) f xθ (w) and gx (w) = Ψ0 ( Fx (w)) f x (w).
                                                         ϕ                       ϕ


                                                     ϕ        ϕ
This immediately implies gθx (w)/ f xθ (w) = gx (w)/ f x (w) ∀w and thus R = 0. With rela-
tive welfare weights, condition (iv) can therefore be dropped.


                                                   20
    Hence, these results reveal the following intuitive separation: Per Corollary 4, the sign
of the multiplier ξ on the consistency constraint accounts for the overall redistributive
motive across sectors, i.e., whether redistribution from Θ to Φ or vice versa is desirable.
Then, conditional on this direction, the nonlinear marginal tax rate correction in the Pareto
optimum relative to the SCPE is determined by comparing local and aggregate income
shares between sectors, per equation (11) in Proposition 1.


4    The Role of Occupational Choice and Continuous Types
In this section, we relate our results to those in Stiglitz (1982), who considers optimal non-
linear taxation in a two-type model with endogenous wages but without occupational
choice. We demonstrate that the general Roy model, with continuous types and occupa-
tional choice, features three extra effects, as captured by S, C and R in the previous section,
that do not appear in Stiglitz’s model. The disappearance of the sectoral shift effect S in
a model without occupational choice is obvious. In addition, the Roy model with contin-
uous types generates overlapping wage distributions in the two sectors, which gives rise
to the effects C and R. In contrast, in a discrete type model, generically—and somewhat
unrealistically—there are no workers in different sectors earning the same wage.
    The extra Roy effects that emerge in our model do not change the sign of the general
equilibrium effects found in Stiglitz (1982), but they mitigate them. In this sense, optimal
redistributive taxation in the Roy model involves a less progressive tax schedule than a
standard Mirrlees model (as captured by an SCPE) but a more progressive tax schedule
than a discrete type model without occupational choice.
    We start by reformulating Stiglitz’s (1982) model in terms of the decomposition into an
inner problem (for fixed x) and outer problem (optimizing over x) as above. Let there be
two types with skills θ and ϕ and with fractions f θ and f ϕ = 1 − f θ in the population. We
put (relative) Pareto weights ψθ and ψ ϕ on them such that f θ ψθ + f ϕ ψ ϕ = 1. Without loss
of generality, we will think of θ as the high wage sector and ϕ as the low wage sector, so
that regular welfare weights satisfy ψθ ≤ 1 and ψ ϕ ≥ 1. As in Stiglitz (1982), we therefore
focus on the case where only the θ-type’s incentive constraint binds.




                                              21
4.1    Inner Problem
Individuals are paid their marginal products, wθ = θYθ ( x ), and w ϕ = ϕYϕ ( x ). Hence, we
can write the inner problem for fixed x as

                                  W (x) =       max            f θ ψθ Vθ + f ϕ ψ ϕ Vϕ                     (22)
                                             eθ ,e ϕ ,Vθ ,Vϕ


                                                               wϕ
                                                                           
subject to
                                      Vθ ≥ U c(Vϕ , e ϕ ), e ϕ                  ,                         (23)
                                                               wθ
                                (1 − α( x )) f θ wθ eθ − α( x ) f ϕ w ϕ e ϕ = 0,                          (24)
                                                                                     
                           f θ wθ eθ + f ϕ w ϕ e ϕ ≥ f θ c(Vθ , eθ ) + f ϕ c Vϕ , e ϕ .                   (25)

As before, the outer problem is just maxx W ( x ).8
   We focus on the top marginal tax rate (i.e., the optimal allocation for type θ). Denoting
by µ and ξµ the multipliers on (25) and (24), the first order condition w.r.t. eθ is

                       − f θ µ (∂c(Vθ , eθ )/∂eθ − wθ ) + (1 − α( x )) f θ ξµwθ = 0.

Using ∂c/∂e = −Ue /Uc = MRS, this simplifies to MRSθ = wθ (1 + (1 − α( x ))ξ ). By
the first order condition for the worker’s utility maximization problem, i.e., MRS/w =
1 − T 0 (y), this implies that the marginal tax rate for the high-wage, Θ-sector individual,
is −(1 − α( x ))ξ as in Corollary 3.


4.2    Outer Problem
We next turn to the outer problem to determine ξ. By the envelope theorem, we can
compute the wage shift effect by holding Vi and ei constant for i ∈ {θ, ϕ}, which, in
contrast to section 3.4, is a feasible thought experiment here as each wage corresponds to
a single sector. Since sectors do not overlap at any wage, the re-allocation across sectors
that led to the terms R and C in the continuous model in section 3.4 is absent here. There
is also no sectoral shift effect S since occupational choice is fixed. As in section 3.4, the
effect of the wage shift induced by the change in x on the objective is identically zero, and
the effect on the resource constraint (25) is zero by constant returns to scale. Only the
   8 Observe  that we again pool all individuals of a given type at the same allocation (V, e). This is without
loss of generality, but the reasoning is somewhat different from the continuous type case in section 2.2. In
this discrete-type setting, as in Blackorby, Brett, and Cebreiro (2007), any allocation that treats individuals
who earn the same wage differently can be replaced by an alternative incentive compatible allocation that
keeps each individual’s utility unchanged and requires fewer resources. Importantly for our endogenous
wage setting, this alternative allocation also does not change aggregate effort in either sector or x.


                                                          22
direct effect −ξµα( x )Yϕ ( x ) E ϕ /x and the incentive effects remain.
   Specifically, putting a multiplier η̂µ on (23) (and using the same algebraic steps em-
ployed in the proof of Lemma 2) we find that the effect of the wage shift on the incentive
constraint is:
                                              0
                                           "                            #
                                wϕ        ϕ Yϕ ( x ) Yϕ ( x )Yθ0 ( x )
                                    
                                                                               1
              − µη̂Ue c ϕ , e ϕ        eϕ            −                    =−         Î,
                                wθ        θ Yθ ( x )   Yθ ( x )Yθ ( x )      xσ( x )
                            
                           w      w
where Î ≡ µη̂Ue c ϕ , e ϕ wϕ e ϕ wϕ is the discrete incentive constraint analog of I from the
                                θ        θ
general Roy model.9                           h                                                    i
                                 0          1
   Combining the effects yields W ( x ) = − x ξµα( x )Yϕ ( x ) E ϕ ( x ) +               1
                                                                                              Î       .
                                                                                        σ( x)


4.3       Marginal Tax Rates
At an optimum, W 0 ( x ) = 0, so
                                                     Î/(µσ ( x ))
                                             ξ=−                       ,                                      (26)
                                                    α( x )Yϕ ( x ) E ϕ

which coincides with the general formula (21) if S = C = R = 0 and when we replace
I with Î. Moreover, Î and η̂ have opposite signs. This means that ξ > 0 (and hence
top marginal taxes are negative) precisely when redistribution occurs from the θ- to the
ϕ-types, so that the downward incentive constraint binds.
    This is analogous to our results in the general Roy model, but comparing equations
(21) and (26) reveals that the addition of the effects S and C will make ξ, and hence top
marginal taxes, smaller in absolute value. To understand the intuition behind this, sup-
pose we lower taxes at the top to increase the effort of the top earners. This is welfare
enhancing because it raises the wages of the low wage sector workers and lowers the
wages of high wage sector workers and thus relaxes the downward incentive constraint.
However, when there is endogenous occupational choice, the sectoral shift effect works
against this, since this change in wages leads some individuals to shift out of the high
wage into the low wage sector, undoing some of the original increase in aggregate ef-
fort in the high wage sector. The indirect wage shift effect C reinforces the sectoral shift
effect (when effort is increasing in wage), since, at any given wage where the sectors over-
   9 To    see this, observe that in the limit where f xθ (w)/ f x (w) is 0 up until wθ , and 1 thereafter,
(d/dw)[ f xθ (w)/ f x (w)] is a Dirac δ-function and the integral in (17) evaluates to −V 0 (wθ )wθ η (wθ ) =
Ue (cθ , eθ )eθ η (wθ ) by the incentive constraint (7). The only difference from Î is that it has e ϕ w ϕ /wθ in-
stead of eθ and c ϕ rather than cθ (and η̂ = η/Uc is discrete rather than continuous). In the density limit, the
θ-type would be imitating an infinitesimally close individual. If we let w ϕ be arbitrarily close to wθ , then
we would get eθ and cθ , as in the limit case of I.


                                                        23
lap, it involves a re-allocation of effort (among individuals who do not shift sectors) from
workers in the high wage sector to workers in the low wage sector. Optimal taxes in the
general Roy model with continuous types will therefore be less progressive than in a Mir-
rlees model but more progressive than in a Stiglitz model with two types and exogenous
occupations.
    In fact, the result that the optimal progressivity of taxes in a Roy model is “sand-
wiched” between Mirrlees at the progressive end and Stiglitz at the regressive end is not
particular to our environment with continuous types. As we show in Rothschild and
Scheuer (2012), ξ is also bounded between Mirrlees (i.e. 0) and Stiglitz (i.e. formula (26))
in a general model with a discrete, two-dimensional type-distribution and with alloca-
tions that condition on wages only. This means that the Stiglitz formula (26) is a special
case even within the class of discrete-type models.


5       A Numerical Example
The purpose of this section is to illustrate the role of sectoral and wage shift effects for
the progressivity of optimal income taxes and verify the consistency of the conditions
in Corollary 4 and Proposition 2. We use data from the 2011 Current Population Survey
(CPS) rotating March sample to calibrate a simple 2-sector Roy model of the U.S. economy
and to compute optimal tax schedules. We assume quasilinear preferences U (c, e) =
c − h(e) with isoelastic disutility h(e) = e1+1/ε /(1 + 1/ε). We use a labor elasticity ε = 0.5
and Cobb-Douglas technology, Y = Eθα E1ϕ−α .10 We remain deliberately agnostic about
the nature of the two latent sectors. Instead, we build on Basu and Ghosh (1978) and
Heckman and Honoré (1990), who show that the parameters of an underlying bivariate
normal distribution over ( x1 , x2 ) can be identified by observing the single-dimensional
distribution of the maximum of x1 and x2 (up to a permutation of indices).
    Specifically, following Mankiw et al. (2009), we use the CPS data on weekly earnings
and hours to generate a sample of hourly wages wi for the U.S. population. We assume
that this wage distribution is generated from a two-sector Roy model with individuals
whose skills (θi , ϕi ) are drawn from a bivariate lognormal distribution so that, for a given
x = Eθ /E ϕ , the distribution across individuals of possible wages (θi Yθ ( x ), ϕi Yϕ ( x )) is also
bivariate lognormal. We estimate the means µθ , µ ϕ , variances σθ2 , σϕ2 , and covariance σθ ϕ of
this bivariate wage distribution by maximum likelihood. The likelihood of an observation
    10 This   implies a constant substitution elasticity σ = 1. We explore the effect of varying σ in section 6.




                                                          24
w̃i ≡ log(wi ) = max{log(θi Yθ ( x )), log( ϕi Yϕ ( x ))} is given by11

                      µθ − w̃i                  µ̃ ϕ − w̃i                  µ ϕ − w̃i                    µ̃θ − w̃i
                                                                                                           
        1                                                          1
    `i = φ                            1−Φ                         + φ                         1−Φ                         ,
        σθ               σθ                         σ̃ϕ            σϕ          σϕ                            σ̃θ

where φ(·) and Φ(·) denote the density and cumulative distribution of the standard nor-
mal distribution, respectively, and where
                                                                                     q
                                                                                         1 − σθ2ϕ /(σθ σϕ )2
                                        !
                             σθ ϕ                1                              σθ
                µ̃θ ≡    µθ − 2 µ ϕ                               and   σ̃θ ≡
                             σϕ             1 − σθ ϕ /σϕ2                                1 − σθ ϕ /σϕ2

                                                             q
ifσθ ϕ /σϕ26= 1 (and µ̃θ ≡ µθ − µ ϕ , σ̃θ ≡ σθ 1 − σθ2ϕ /(σθ σϕ )2 otherwise), with symmetric
expressions for µ̃ ϕ and σ̃ϕ .
    The income share of the Θ-sector, given by α, can be inferred from this estimated
bivariate wage distribution by using the estimated parameters µθ , µ ϕ , σθ2 , σϕ2 , and σθ ϕ to
draw a (large) sample of (wθ , w ϕ ). We can infer from this sample both sectoral choices and
wages w = max{wθ , w ϕ }. From these and the individual optimization condition e1/ε =
(1 − τ )w (where τ is the marginal tax rate, which we take to be 25% for our calibration),
we can compute the sectoral incomes Y θ and Y ϕ and hence α = Y θ /(Y θ + Y ϕ ).
    Finally, with Cobb-Douglas technology, we can, w.l.o.g., take the underlying skills
(θ, ϕ) to coincide with (wθ , w ϕ )—i.e., we can take Yθ ( x ) = Yϕ ( x ) = 1. To wit: note that
Yθ = αY/Eθ . Since scaling all θ-skills by k > 0 scales Eθ by k, this implies that Yθ scales
by k−1 . This re-scaling leaves wages w = θYθ , efforts, and incomes unchanged. In other
words, for a given economy, the underlying skills are only defined up to such a re-scaling.
    Our baseline estimates (standard errors) are µθ = 2.81 (.029), µ ϕ = 1.74 (.714), σθ =
0.647 (.015), σϕ = 0.637 (.369), and ρθ ϕ = −.030 (.630), where ρθ ϕ = σθ ϕ /σθ σϕ is the cor-
relation between the two dimensions. The corresponding mean wages are approximately
7 and 20 for the two sectors, and 12.3% of the workers are estimated to work in the Φ-
sector, which has an income share 1 − α of only 5.8%. The left panel of figure 2 compares
the estimated to the empirical wage distribution; it shows a reasonably good fit.
    The Φ-sector is the low-income sector here, and it is quite small in quantitative terms.
We therefore use a likelihood ratio test to see whether we can reject the two-sector model
in favor of a simpler one-sector model. This likelihood ratio test is complicated by the
fact that a single-sector model is a “singularity” in parameter space (ρθ ϕ ceases to be well-
defined under the restriction). We perform a two-step version of the test: first, we observe
  11 See   Basu and Ghosh (1978), expressions (2.5) and (6.2).



                                                             25
            Empirical and Fitted Wage Distribution                              Marginal Tax Rate
0.7                                                                0.6
         empirical                                                                                  Pareto Optimum
0.6      fitted                                                    0.5                              SCPE

0.5                                                                0.4

0.4                                                                0.3

0.3                                                                0.2

0.2                                                                0.1

0.1                                                                 0

 0                                                                −0.1
 −2             0              2             4          6             0   50   100    150      200       250     300
                           log(wage)                                                 wage


      Figure 2: Empirical/estimated wage distributions and optimal/SCPE tax schedules
                            Effort                                                   −Share
20                                                                  1
         Pareto Optimum
         SCPE                                                      0.9
15
                                                                   0.8

                                                                   0.7
10
                                                                   0.6

                                                                   0.5
 5
                                                                   0.4

 0
  0       50         100     150       200       250   300           0    50   100   150       200       250     300
                            wage                                                     wage


       Figure 3: Effort and share of workers in the Θ-sector for Pareto optimum/SCPE

that ρθ ϕ = 0 is not rejected. Re-estimating the model with ρθ ϕ ≡ 0 leads to imperceptible
changes in the remaining coefficients. A standard likelihood ratio test for the restriction
of this model to a single sector yields χ2 (2) = 244.2, easily rejecting the single-sector
restriction. We employ the ρθ ϕ = 0 estimates in the following tax computations.
    To compute the Pareto optimal and SCPE taxes for this economy, only the Pareto
weights remain to be specified. We use relative weights Ψ = 1 − (1 − F )r , where r char-
acterizes the magnitude of the government’s desire for redistribution from high to low
wages. With the quasilinear preferences that we use here, r = 1 implies no redistributive
motives, and r → ∞ for a Rawlsian social planner. We take r = 1.3, so that there is some
intermediate desire for redistribution from high- to low-wage earners.
    The right panel of figure 2 shows the marginal tax schedule T 0 (y(w)) as a function of



                                                             26
w both for the Pareto optimum and the SCPE resulting from our parametrization.12 The
two tax schedules are similar: Both display U-shaped marginal rates at modest wages,
and then falling rates in the upper tail of the distribution. The optimal tax schedule is
modestly less progressive than the SCPE, in accord with the theory above, and the top
marginal tax rate is negative, albeit small in magnitude at about −2% due to the small
size of the low-wage sector Φ (recall that, by Corollary 3, the top marginal tax rate is given
by −(1 − α)ξ). Finally, figure 3 demonstrates that the assumptions in Proposition 2 are
satisfied in our calibrated example: individual effort e(w) is increasing in the wage, and
the shares of Θ- and Φ-sector workers are monotone. A fortiori, income y(w) = we(w) is
increasing in w, so that bunching does not need to be considered.


6      Extensions

6.1         Unbounded Skill Distribution
We have focused attention on bounded skill distributions for simplicity and to facilitate a
comparison with Stiglitz (1982), but the preceding analysis does not rely on this assump-
tion. In particular, recent studies have emphasized that the top end of the empirical wage
distribution is better described by an unbounded Pareto distribution (Saez, 2001). The
analysis of the outer problem in section 3.4 can be extended in a straightforward way to
such unbounded distributions, and the methods developed in Diamond (1998) and Saez
(2001) can be used to compute asymptotic marginal tax rates T 0 (y(w)) for w → ∞. These
are particularly transparent in the following case:

Proposition 3. Consider any Pareto optimum (respectively, SCPE) such that
(i) preferences are quasilinear and isoelastic: U (c, e) = c − e1+1/ε /(1 + 1/ε)
(ii) the top earners are all in the Θ-sector: limw→∞ f xθ (w)/ f x (w) = 1
                                                                                    1 − Fx (w)
(iii) the Θ-sector skill distribution has a Pareto tail with parameter κ, so limw→∞            =κ
                                                                                     w f x (w)
(iv) Pareto weights are relative and progressive: Gx (w) = Ψ( Fx (w)) with Ψ00 ( x ) < 0 and
(v) zero welfare weight is put on the top earners: Ψ0 (1) = 0.
Then the asymptotic marginal tax rate is

                    κ (1 + 1/ε) − ξ (1 − α( x ))
                                                                                                
                                                                               κ (1 + 1/ε)
                                                            respectively,                            .
                          κ (1 + 1/ε) + 1                                    κ (1 + 1/ε) + 1

Moreover, ξ > 0 whenever e(w) and f xθ (w)/ f x (w) are increasing in w.
    12 We   truncate the distribution at the 99.99th percentile so that the top rate is well defined.


                                                            27
                   Marginal Tax Rate                                       Marginal Tax Rate
0.6                                                            0.4


0.5                                                           0.35


0.4                                                            0.3


0.3                                                           0.25


0.2                                                            0.2                                  =.5
                                   Pareto Optimum                                                   =0
                                   SCPE                                                             =−.5
0.1
   0          20         40            60           80           0   10   20      30      40   50          60
                        wage                                                     wage


       Figure 4: Pareto optimal/SCPE tax rates, and Pareto optimal tax rates for varying σ

Proof. In Appendix C.

    This implies that asymptotic marginal tax rates are scaled down in the Pareto opti-
mum relative to the SCPE, just like top marginal tax rates in the case of a bounded skill
distribution. To illustrate this downscaling numerically, we have to replace the thinner-
tailed lognormal distributions from the calibration in section 5 with Pareto tails. The
primary advantage of employing a bivariate lognormal distribution was that it could be
identified by observing only the empirical wage distribution. This allowed us to study
the role of Roy effects without taking a stand on the nature of the underlying sectors.
Unfortunately, a bivariate Pareto distribution is not identified without additional sectoral
information (Heckman and Honoré, 1990). We therefore use a simple numerical example
that is not explicitly calibrated to the U.S. economy to get a sense for the implications of
these thicker tails.
    In particular, we consider a skill distribution given by two independent Pareto distri-
butions with support [1, ∞) and parameters κθ = 2 and κ ϕ = 4, respectively. As a result,
there is more mass on lower skills in the ϕ-dimension compared to θ, and Φ is again the
                                  ϕ
low skill sector with limw→∞ f x (w)/ f x (w) = 0. We again start with the Cobb-Douglas
case and set the aggregate income share of the high skill sector Θ to α = .2. All other
parameters are as in section 5. The left panel in figure 4 shows the resulting marginal tax
schedules in the Pareto optimum and SCPE. It illustrates Proposition 3 and shows that, in
principle, the optimal asymptotic marginal tax rate can be considerably lower than in the
SCPE, indicating strong general equilibrium effects in the Roy model.
    In the right panel, we show how the importance of these effects varies with the elas-
ticity of substitution of the production function. We generalize the technology considered

                                                         28
                                                                ρ             ρ 1/ρ
so in section 5 to a CES production function Y ( Eθ , E ϕ ) = αEθ + (1 − α) E ϕ       , where
the elasticity of substitution is constant with σ = 1/(1 − ρ) (Cobb-Douglas obtains as a
special case for ρ = 0). The figure shows that the optimal asymptotic marginal tax rates
fall as we move to lower substitution elasticities. This is because the general equilibrium
effects from the endogeneity of wages become more pronounced as we move away from
linear technology, with σ = ∞ (ρ = 1) and fixed wages.


6.2    Differential Sectoral Costs
In the preceding analysis, individuals based their sectoral choice exclusively on whether
the Θ- or Φ-sector afforded them a higher wage. In many applications, however, it is
reasonable to assume that occupational choice is also affected by direct costs or tastes
for entering specific sectors. For instance, some occupations may require higher levels
of education, so that individuals who have a high cost of achieving such education may
not select into them even if they could earn a higher wage there. It is straightforward to
extend the model to allow for such differential costs of working in the two sectors.
     Let the types be described by a triple t = (θ, ϕ, β), where β parameterizes the cost of
Θ-sector effort relative to Φ-sector effort and, as above, θ and ϕ measure the Θ- and Φ-
sector skills. Let the general cdfs F̂ (θ, ϕ, β) and Ĝ (θ, ϕ, β), with supports [θ, θ ] × [ ϕ, ϕ] ×
[ β, β], denote the type distribution and cumulative welfare weights, respectively, and take
preferences to be separable, isoelastic in effort, and dependent on sector S as follows:
                                        (
                                            βu(c) − e1+/ε /(1 + 1/ε) if S = Θ
                     U (c, e; t, S) =
                                            u(c) − e1+/ε /(1 + 1/ε) if S = Φ.

In particular, with CARA utility of consumption u(c) = − exp(−rc), we can interpret
β̃ ≡ − log( β)/r as the consumption cost of working in the Θ-sector. (With CRRA, a
similarly transformed β is interpretable as a proportional consumption cost.)
    Within the Θ-sector, there will generally be two dimensions of heterogeneity—θ and
β. For any x, however,
                                               "                                         1+1/ε #
                 y                                          1                   y
          U c,           ; (θ, ϕ, β), Θ       = β u(c) −                                               ,
               θYθ ( x )                                 1 + 1/ε        θ̃ (θ, β)Yθ ( x )

where θ̃ (θ, β) ≡ θβε/(1+ε) . Conditional on S = Θ, θ̃ is thus a sufficient statistic for pref-
erences over (c, y)-bundles (as in Choné and Laroque, 2010). Moreover, any two types
(θ1 , ϕ1 , β 1 ) and (θ2 , ϕ2 , β 2 ) with θ̃1 (θ1 , β 1 ) = θ̃2 (θ2 , β 2 ) and ϕ1 = ϕ2 make the same sec-


                                                     29
toral choice. This means that we can “collapse” the policy relevant type distribution into
the two-dimensional distribution of (θ̃, ϕ)-types, with cdf

                                        Z θ Z ϕ Z (θ/θ̃ ) 1+ε ε
                          F (θ̃, ϕ) ≡                             d F̂ (θ 0 , ϕ0 , β0 ),
                                         θ    ϕ    β


and we can collapse the welfare weights to G (θ̃, ϕ) analogously.
    By interpreting w as an effective wage, given by max{θ̃Yθ ( x ), ϕYϕ ( x )}, the Pareto opti-
mal and SCPE tax rates are characterized exactly as in Section 3. In particular, marginal
taxes are given by Proposition 1, with ξ as in equation (21), and, as in Proposition 2, top
marginal tax rates will be negative whenever (i) the i-sector is the low w sector, (ii) effort
is increasing in w, (iii) marginal social utility of consumption is decreasing in w, and (iv)
there is a weak preference for i-sector workers at any given w.


7    Conclusion
We view this paper as making a two-fold contribution. The first is methodological: we
provide a technique for solving a multi-dimensional screening problem in an important
class of contexts. Specifically, we show that the multi-dimensional screening problem
that arises in designing optimal taxation in a multiple-sector economy can be reduced to
a single dimensional optimal income tax problem à la Mirrlees. This basic technique is
likely to be applicable more broadly.
    Our second contribution is to derive some of the implications that self-selection into
occupational sectors can have for optimal income taxation. In particular, we show that
the presence of several complementary sectors in an economy provides a force pushing
towards less progressive taxation. This force is a natural extension of Stiglitz’s (1982)
results to a more general framework with a continuous distribution of types and sectoral
mobility, and we show that the extra effects arising in this more general setting mitigate
the regressive forces in the basic Stiglitz model.
    We also demonstrated through a simple empirical calibration that computing the prac-
tical implications of occupational endogeneity for taxation is tractable. Through a theo-
retical simulation with unbounded skill distributions and fat tails, we also demonstrated
that, in principle, these implications could be quantitatively significant. More detailed
empirical calibrations are an important next step.




                                                    30
References
A LLEN , F. (1982): “Optimal Linear Income Taxation with General Equilibrium Effects on
   Wages,” Journal of Public Economics, 17, 135–143.

ATKINSON , A., AND J. S TIGLITZ (1976): “The Design of Tax Structure: Direct versus Indi-
  rect Taxation,” Journal of Public Economics, 6, 55–75.

B ASU , A., AND J. G HOSH (1978): “Identifiability of the Multinormal and other Distribu-
   tions under the Competing Risks Model,” Journal of Multivariate Analysis, 8, 413–429.

B LACKORBY, C., C. B RETT, AND A. C EBREIRO (2007): “Nonlinear Taxes for Spatially Mo-
   bile Workers,” International Journal of Economic Theory, 3, 57–74.

B OADWAY, R., N. M ARCEAU , AND P. P ESTIEAU (1991): “Optimal Linear Income Taxation
   in Models with Occupational Choice,” Journal of Public Economics, 46, 133–162.

B ORJAS , G. (1987): “Self-Selection and the Earnings of Immigrants,” American Economic
   Review, 77, 531–553.

      (2002): “The Wage Structure and the Sorting of Workers into the Public Sector,”
  NBER Working Paper 9313.

B RETT, C. (2007): “Optimal Nonlinear Taxes for Families,” International Tax and Public
   Finance, 14, 225–261.

B RETT, C., AND J. W EYMARK (2003): “Financing Education using Optimal Redistributive
   Taxation,” Journal of Public Economics, 87, 2549–2569.

C HONÉ , P., AND G. L AROQUE (2010): “Negative Marginal Tax Rates and Heterogeneity,”
   American Economic Review, 100, 2532–2547.

D AHL , G. B. (2002): “Mobility and the Return to Education: Testing a Roy Model with
  Multiple Markets,” Econometrica, 70, 2367–2420.

D IAMOND , P. (1998): “Optimal Income Taxation: An Example with a U-shaped Pattern
   of Optimal Tax Rates,” American Economic Review, 88, 83–95.

D IAMOND , P., AND J. M IRRLEES (1971): “Optimal Taxation in Public Production, I: Pro-
   duction Efficiency,” American Economic Review, 61, 8–27.

F ELDSTEIN , M. (1973): “On the Optimal Progressivity of the Income Tax,” Journal of Public
   Economics, 2, 356–376.

                                            31
F UDENBERG , D., AND D. L EVINE (2009): “Self-confirming equilibrium and the Lucas cri-
   tique,” Journal of Economic Theory, 144, 2354–2371.

F UDENBERG , D., AND J. T IROLE (1991): Game Theory. MIT Press, Cambridge.

H AM , J. C., AND R. J. L A L ONDE (1996): “The Effect of Sample Selection and Initial Condi-
  tions in Duration Models: Evidence and Experimental Data on Training,” Econometrica,
  64, 175–205.

H ECKMAN , J. (1974): “Shadow Prices, Market Wages, and Labor Supply,” Econometrica,
  42, 679–693.

H ECKMAN , J., AND B. H ONORE (1990): “The Empirical Content of the Roy Model,” Econo-
  metrica, 58, 1121–1149.

H ECKMAN , J., AND G. S EDLACEK (1985): “Heterogeneity, Aggregation and Market Wage
  Functions: An Empirical Model of Self-Selection in the Labor Market,” Journal of Politi-
  cal Economy, 93, 1077–1125.

       (1990): “Self-Selection and the Distribution of Hourly Wages,” Journal of Labor
  Economics, 8, S329–S363.

H SIEH , C., E. H URST, C. J ONES , AND P. K LENOW (2011): “The Allocation of Talent and
   U.S. Economic Growth,” Mimeo, Stanford University.

K LEVEN , H. J., C. T. K REINER , AND E. S AEZ (2009): “The Optimal Income Taxation of
   Couples,” Econometrica, 77, 537–560.

L AROQUE , G. (2005): “Income maintenance and labor force participation,” Econometrica,
   73, 341–376.

L EE , L. (1978): “Unionism and Wage Rates: A Simultaneous Equation Model with Quali-
   tative and Limited Dependent Variables,” International Economic Review, 19, 415–433.

M ANKIW, G., M. W EINZIERL , AND D. YAGAN (2009): “Optimal Taxes in Theory and
  Practice,” Journal of Economic Perspectives, 23, 147–174.

M IRRLEES , J. (1971): “An Exploration in the Theory of Optimum Income Taxation,” Re-
  view of Economic Studies, 38, 175–208.

M ORESI , S. (1997): “Optimal Taxation and Firm Formation: A Model of Asymmetric
  Information,” European Economic Review, 42, 1525–1551.

                                             32
N AITO , H. (1999): “Re-Examination of Uniform Commodity Taxes Under A Non-Linear
  Income Tax System And Its Implication for Production Efficiency,” Journal of Public
  Economics, 71, 165–188.

PARKER , S. C. (1999): “The Optimal Linear Taxation of Employment and Self-
  Employment Incomes,” Journal of Public Economics, 73, 107–123.

R OCHET, J.-C., AND P. C HONÉ (1998): “Ironing, Sweeping and Multidimensional Screen-
   ing,” Econometrica, 66, 783–826.

R OTHSCHILD , C., AND F. S CHEUER (2011): “Optimal Taxation with Rent-Seeking,” NBER
   Working Paper 17035.

        (2012): “Redistributive Taxation in the Roy Model,” NBER Working Paper 18228.

R OY, A. (1951): “Some Thoughts on the Distribution of Earnings,” Oxford Economic Papers,
   3, 135–146.

S AEZ , E. (2001): “Using Elasticities to Derive Optimal Tax Rates,” Review of Economic
   Studies, 68, 205–229.

       (2004): “Direct or Indirect Tax Instruments for Redistribution: Short-run versus
  Long-run,” Journal of Public Economics, 88, 503–518.

S ARGENT, T. (2008): “Evolution and Intelligent Design,” American Economic Review, 98,
   5–37.

S CHEUER , F. (2012): “Entrepreneurial Taxation with Endogenous Entry,” Mimeo, Stanford
   University.

         (2013): “Adverse Selection in Credit Markets and Regressive Profit Taxation,”
  forthcoming, Journal of Economic Theory.

S TIGLITZ , J. (1982): “Self-Selection and Pareto Efficient Taxation,” Journal of Public Eco-
   nomics, 17, 213–240.

W ERNING , I. (2007): “Pareto-Efficient Income Taxation,” Mimeo, MIT.

W ILLIS , R., AND S. R OSEN (1979): “Education and Self-Selection,” Journal of Political Econ-
  omy, 87, S7–S36.

Z ECKHAUSER , R. (1977): “Taxes in Fantasy, or Most Any Tax on Labor Can Turn Out to
   Help the Laborers,” Journal of Public Economics, 8, 133–150.

                                             33
A      Proof of Lemma 1
Part (i). Consider an incentive compatible allocation {c(θ, ϕ), y(θ, ϕ), S(θ, ϕ), x }. To obtain a contradiction,
suppose there exists a type (θ, ϕ) such that (e.g.) θYθ ( x ) < ϕYϕ ( x ), but S(θ, ϕ) = Θ and hence (by equation
(1)) w(θ, ϕ) = θYθ ( x ). Then type (θ, ϕ)’s incentive constraint must be violated, since he could do better by
earning the same income y(θ, ϕ) in the Φ- rather than the Θ-sector, which would result in utility
                                                                           
                                           y(θ, ϕ)                  y(θ, ϕ)
                                U c(θ, ϕ),             > U c(θ, ϕ),             .
                                           ϕYϕ ( x )                θYθ ( x )

    Part (ii). Consider two types (θ, ϕ) and (θ 0 , ϕ0 ) such that w(θ, ϕ) = w(θ 0 , ϕ0 ) = w. Again to obtain a
contradiction, assume w.l.o.g.

                                                                             y(θ 0 , ϕ0 )
                                                                                         
                                          y(θ, ϕ)                            0   0
                               U c(θ, ϕ),                   < U c ( θ , ϕ ),                    .
                                            w                                   w

Then type (θ, ϕ)’s incentive constraint must be violated: he could mimic type (θ 0 , ϕ0 ) by earning y(θ 0 , ϕ0 ),
staying in his original sector. His utility from this deviation would be given by the RHS of the above
inequality.
    Part (iii). We claim that, for each type (θ, ϕ), the consumption bundle (c(θ, ϕ), y(θ, ϕ)) is a solution
to max(c,y)∈ B∗ U (c, y/w(θ, ϕ)) . First, when faced with the budget set B∗ , each individual will, taking x as
given, choose his sector such that w(θ, ϕ) = max{θYθ ( x ), ϕYϕ ( x )} and S(θ, ϕ) as given by equation (2).
Second, each bundle (c(θ, ϕ), y(θ, ϕ)) from the original allocation is included in the budget set B∗ by the
construction in (3) and incentive compatibility. To see this, suppose there was some (c(θ, ϕ), y(θ, ϕ)) such
that c(θ, ϕ) > R∗ (y(θ, ϕ)). Then by (3) this would imply that there exists some (θ 0 , ϕ0 ) such that

                                             y(θ 0 , ϕ0 )
                                                                                         
                                           0    0                             y(θ, ϕ)
                              U c ( θ , ϕ ),                    < U c(θ, ϕ),                        ,
                                             w(θ 0 , ϕ0 )                    w(θ 0 , ϕ0 )

contradicting type (θ 0 , ϕ0 )’s incentive constraint and thus incentive compatibility of the original allocation.
Finally, each type (θ, ϕ) at least weakly prefers the bundle (c(θ, ϕ), y(θ, ϕ)) to any other bundle available in
B∗ by (3).



B     Proofs for Section 3
B.1     Proof of Proposition 1
Putting multipliers µ on (8), ξµ on (5) and η̂ (w)µ on (7), the Lagrangian corresponding to (6)-(8) is, after
integrating by parts (7),
             R wx                      R wx                 Rw                            e(w)
      L =      wx   V (w) gx (w)dw −    V (w)η̂ 0 (w)µdw + w x Ue (c(V (w), e(w)), e(w)) w η̂ (w)µdw
                                           wx                 x
                                        Rw                              Rw           ϕ
                         +ξµ(1 − α( x )) w x we(w) f xθ (w)dw − ξµα( x ) w x we(w) f x (w)dw
                                           x                              x
                                Rw                         Rw
                            +µ w x we(w) f x (w)dw − µ w x c(V (w), e(w)) f x (w)dw.                         (27)
                                       x                                 x




                                                                34
Using ∂c/∂V = 1/Uc and compressing notation, the first order condition for V (w) is

                                                                 1             Uec (w) e(w)
                             η̂ 0 (w)µ = gx (w) − µ f x (w)          + η̂ (w)µ              .               (28)
                                                              Uc (w)           Uc (w) w

Defining η (w) ≡ η̂ (w)Uc (w), this becomes

                               Uc (w)                   Ucc (w)c0 (w) + Uce (w)e0 (w) + Uce (w)e(w)/w
            η 0 (w) = gx (w)          − f x (w) + η (w)                                               .     (29)
                                 µ                                           Uc (w)

Using the first order condition corresponding to the optimization problem for an individual worker,

                                                                             e(w)
                                   Uc (w)c0 (w) + Ue (w)e0 (w) + Ue (w)           = 0,
                                                                               w

the fraction in (29) can be written as −(∂MRS(w)/∂c)y0 (w)/w where

                                                              Ue (c(w), e(w))
                                             MRS(w) ≡ −
                                                              Uc (c(w), e(w))

is the marginal rate of substitution between effort and consumption. Substituting in (29) and rearranging
yields
                          ∂MRS(w)         y0 (w)                          Uc (w)
                       −             e(w)        η (w) = f x (w) − gx (w)        + η 0 ( w ).         (30)
                              ∂c          y(w)                              µ
Integrating this ODE gives

                                                                                    y0 (s)
                               Z wx                            Z z                          
                                                    Uc (z)            ∂MRS(s)
                 η (w)   =              f x (w) − gx (z)     exp               e(s)         ds dz
                                w                      µ            w     ∂c        y(s)
                               Z wx 
                                         gx (z) Uc (z)
                                                            Z z      u    
                                                                       ε (s) dy(s)
                                                                                     
                         =            1−                 exp        1− c                 f x (z)dz,         (31)
                                w        f x (z) µ             w       ε (s)   y(s)

where the last step follows from e(w)∂MRS(w)/∂c = 1 − εu (w)/εc (w) after tedious algebra (e.g. using
equations (23) and (24) in Saez, 2001).
   Using ∂c/∂e = MRS, the first order condition for e(w) is
                                                 
                                         MRS(w)            
                                                                                           ϕ
                                                                                                 
                         µw f x (w) 1 −             + ξµw (1 − α( x )) f xθ (w) − α( x ) f x (w)
                                             w
                                                                                         
                                     (−Uec (w)Ue (w)/Uc (w) + Uee (w)) e(w) Ue (w)
                    =    −η̂ (w)µ                                             +              ,
                                                      w                            w

which after some algebra can be rewritten as
                                                                                                 
                MRS(w)            
                                                                 ϕ
                                                                                ∂MRS(w) e   MRS(w)
  w f x (w) 1 −            + ξw (1 − α( x )) f xθ (w) − α( x ) f x (w) = η (w)             +          .
                   w                                                               ∂e    w     w
                                                                                                     (32)
                                0
Noting that MRS(w)/w = 1 − T (y(w)) from the first order condition of the workers’ utility maximization
problem and using the definition of η (w), this becomes
                                          ϕ
         (1 − α( x )) f xθ (w) − α( x ) f x (w)
                                                                                                   
                                                                        η (w)         ∂MRS(w)   e
   1+ξ                                          = (1 − T 0 (y(w))) 1 +             1+                   .   (33)
                          f x (w)                                      w f x (w)        ∂e    MRS(w)



                                                              35
Simple algebra again shows that 1 + ∂ log MRS(w)/∂ log e = (1 + εu (w))/εc (w), and that
                                                            ϕ                                     ϕ
                        (1 − α( x )) f xθ (w) − α( x ) f x (w)                f (w)     f θ (w)
                                                               = 1 − α( x ) − x       = x       − α ( x ).
                                         f x (w)                              f x (w)   f x (w)

The Proposition follows from (31) and (33).


B.2      Proof of Lemma 2
We begin with the following two technical lemmas, which will be useful for the proof of Lemma 2.

                                                                                                                                      Yθ0 ( x )       Yϕ0 ( x )
Lemma 3. The substitution elasticity of Y ( Eθ , E ϕ ) is given by σ( x ) = − xλ1( x) with λ( x ) ≡                                   Yθ ( x )
                                                                                                                                                  −   Yϕ ( x )
                                                                                                                                                                .

                                                                                                                               d log(Yϕ ( x )/Yθ ( x )) −1
                                                                                                                                                      
                                                                                     dx Yϕ ( x )/Yθ ( x )              1
Proof. The substitution elasticity is defined as σ( x ) ≡                             x d(Yϕ ( x )/Yθ ( x ))   =       x                dx                 ,        from
which the Lemma follows directly.

Lemma 4.

                  dFxθ (w)   Y0 (x) θ                                                 ϕ
                                                                                    dFx (w)    Yϕ0 ( x ) ϕ
                           =− θ      w f (w) + Ω x (w)                and                   =−          w f x (w) − Ω x (w)
                    dx       Yθ ( x ) x                                               dx       Yϕ ( x )

with
                                                                                               w0       w0
                                                                          Z w                                    
                                                        1
                                   Ω x (w) ≡                     λ( x )            w0 f               ,               dw0 .
                                                Yθ ( x )Yϕ ( x )              wx              Yθ ( x ) Yϕ ( x )
                                                                          ϕ
Completely analogous expressions hold for Gxθ (w) and Gx (w).

   The proof of Lemma 4 involves nothing more than tedious algebra. We now turn to proving Lemma 2
and use (27) to compute
            Z wx                               Z wx
                           dgx (w)                               d f x (w)
W 0 (x) =          V (w)           dw − µ             c(V (w), e(w))       dw − ξµα0 ( x )Y ( Eθ , E ϕ )
             wx              dx           wx                         dx
                                Z wx                              Z wx             ϕ
                                                                                            !         Z wx
                                           d f xθ (w)                          d f x (w)                          d f x (w)
        + µξ       (1 − α( x ))      we(w)            dw − α( x )        we(w)           dw + µ             we(w)           dw + B1
                                 wx            dx                   wx             dx                    wx           dx

with

    dw x h                                                                       
                                                                                                                          ϕ
                                                                                                                                               i
B1 ≡       V (w x ) gx (w x ) − µc(V (w x ), e(w x )) f x (w x )+µ f x (w x ) + ξ (1 − α( x )) f xθ (e(w x )) − α( x ) f x (e(w x )) w x e(w x )
     dx
   dw x h                                                                       
                                                                                                                        ϕ
                                                                                                                                             i
 −        V (w x ) gx (w x ) − µc(V (w x ), e(w x )) f E (w x )+µ f x (w x ) + ξ (1 − α( x )) f xθ (e(w x )) − α( x ) f x (e(w x )) w x e(w x ) .
    dx

Integrating by parts the five integral terms yields
                           Z wx                                 Z wx  0       
                                            dGx (w)                   V (w)      dFx (w)
W 0 ( x ) = B1 + B2 −             V 0 (w)           dw + µ      + MRS(w)e0 (w)           dw − ξµα0 ( x )Y ( Eθ , E ϕ )
                       wx                     dx wx    Uc (w)                       dx
            Z wx                          ϕ
                                                                        ! !     Z wx
                    0                   dFx (w)                dFxθ (w)                                dFx (w)
   +µξ           (we (w) + e(w)) α( x )         − (1 − α( x ))           dw − µ      (we0 (w) + e(w))             dw
             wx                           dx                     dx              wx                       dx
                                                                                                                                                                    (34)


                                                                          36
with
          "                                                                                                    ϕ
                                                                                                                      !                      #wx
           dGx (w)                   dFx (w)                                             dF θ (w)         dF (w)                   dFx (w)
B2 ≡ V (w)         − µc(V (w), e(w))         + µξwe(w)                       (1 − α( x )) x       − α( x ) x              + µwe(w)                 .
             dx                        dx                                                  dx               dx                       dx
                                                                                                                                              wx


By the first order conditions (30) and (32) with respect to V (w) and e(w) from the inner problem, the terms
    Z wx 0                                                                                               
         e (w)                     MRS(w)     
                                                                          ϕ
                                                                                        ∂MRS(w) e(w) MRS(w)    dFx (w)
µ                     w f x (w) 1−         +ξw (1 − α( x )) f xθ−α( x ) f x (w) −η (w)               +                  dw
     wx       f x (w)                w                                                     ∂e      w    w         dx

and

                            V 0 (w)                                                            y0 (w) dFx (w)
                  Z wx                                                                              
                                                 Uc (w)              0            ∂MRS(w)
              µ                           gx (w)        − f x (w) − η (w) − η (w)         e(w)                dw
                   wx    Uc (w) f x (w)            µ                                ∂c         y(w)     dx

are both equal to zero. Adding them to (34), using (7), canceling and re-arranging yields
                                                  Z wx                                        
                                                                 gx (w) dFx (w) dGx (w)
W 0 ( x ) = B1 + B2 − ξµα0 ( x )Y ( Eθ , E ϕ ) +       V 0 (w)                     −             dw
                                                    wx           f x (w) dx               dx
                                                                                      V 0 (w)
           Z wx                       Z wx                                                   
                     dFx (w)                     η (w) d [ MRS(w)e(w)]                            1 dFx (w)
     −µ         e(w)         dw − µ                                         + η 0 (w)                          dw
            wx         dx                wx        w           dw                     Uc (w) f x (w) dx
         Z wx                                  ϕ
                                                                             !                                          ϕ
                                                                                                                              !       !
                           0               dFx (w)                  dFxθ (w)        0                f xθ (w)         f x (w) dFx (w)
 + ξµ           (e(w)+we (w)) α( x )                 −(1 − α( x ))            +we (w) (1 − α( x ))            −α( x )                   dw.
          wx                                   dx                      dx                            f x (w)          f x (w)   dx
                                                                                                                                 (35)

From Lemma 4,

                                                      Yθ0 ( x ) gx (w) θ                       Yϕ0 ( x ) gx (w) ϕ
                                                                                                                                
               gx (w) dFx (w) dGx (w)                                                                                        ϕ
                                  −            = −w                    f (w) − gx (w) + w
                                                                                 θ
                                                                                                                  f x (w) − gx (w)
               f x (w) dx              dx             Yθ ( x ) f x (w) x                       Yϕ ( x ) f x (w)
                  Yθ0 ( x ) Yϕ0 ( x )
                                      !                                         ϕ                              ϕ
                                                                                                                        !
                                          gx (w) ϕ               ϕ              f x (w) f xθ (w) gθx (w)       gx (w)
     =                     −           w          f x (w) − gx (w) = λ( x )w                                  − ϕ         .
                  Yθ ( x ) Yϕ ( x )       f x (w)                                    f x (w)         f xθ (w)  f x (w)

The first integral in (35) is therefore
                                      Z wx                                        
                                               0          gx (w) dFx (w) dGx (w)
                                              V (w)                     −              dw = λ( x ) R                             (36)
                                        wx                f x (w) dx       dx

Combining the terms with e(w) on the second and third line of (35) and using Lemma 4 and the identity
Yθ0 ( x ) Eθ + Yϕ0 ( x ) E ϕ ≡ 0 gives:

               Z wx                        Z wx                     ϕ
                                                                                                     !
                        dFx (w)                                  dFx (w)                    dFxθ (w)
          −µ    e(w)            dw + ξµ         e(w) α( x )                − (1 − α( x ))              dw
             wx            dx               wx                     dx                         dx
                                                          0 ( x) Z wx
                "                                                                          #
                  Yθ0 ( x ) wx                         Y
                           Z
                                                          ϕ                      ϕ
             =µ                 we(w) f xθ (w)dw +                    we(w) f x (w)dw
                  Yθ ( x ) wx                          Yϕ ( x ) wx
                                                                            Yϕ0 ( x ) ϕ
                                                                                            !
                                                 Yθ0 ( x ) θ
                   Z wx                                                                                 Z wx
              + ξµ         we(w) (1 − α( x ))              f x (w) − α( x )          f x (w) dw − ξµ         e(w)Ω x (w)dw
                      wx                         Yθ ( x )                   Yϕ ( x )                     wx
                                        Z wx
                  = 0 + ξµYθ0 Eθ − ξµ          e(w)Ω x (w)dw.                                                                    (37)
                                         wx



                                                                    37
The terms with we0 (w) in the last line (35) can be written, using Lemma 4 again, as

        Z wx                              ϕ                                                                            ϕ
                                                                                                                              !             !
                                       dF (w)               dF θ (w)                            f θ (w)          f (w)            dFx (w)
   ξµ          we (w)0
                                 α( x ) x     − (1 − α( x )) x       +              (1 − α( x )) x       − α( x ) x                             dw
         wx                              dx                   dx                                 f x (w)          f x (w)           dx



                                                 Yϕ0 ( x ) ϕ                                                             Yϕ0 ( x ) ϕ
                           "                                                                            !                                 !#
                           Yθ0 ( x ) θ                                                           f x (w) Yθ0 ( x ) θ
                                                                                                   ϕ
        Z wx
               2 0                                                              f xθ (w)
 =ξµ    w e (w) (1−α( x ))          f (w)−α( x )          f x ( x )− (1−α( x ))          −α( x )                  f (w)+          f x ( x ) dw
     wx                    Yθ ( x ) x            Yϕ ( x )                       f x (w)          f x (w) Yθ ( x ) x      Yϕ ( x )
                         Z wx
              − ξµ               we0 (w)Ω x (w)dw
                          wx
                                 Z wx
   = λ( x )ξµC − ξµ                     we0 (w)Ω x (w)dw,                                                                                        (38)
                                  wx


where the first term in the last step follows after some tedious algebra. Combining the terms with Ω x (w)
                              Rw
from (37) and (38) gives −ξµ w x (we(w))0 Ω x (w)dw, which can be integrated by parts to yield:
                                                x

                                                             Z wx                                      
                                               λ( x )                 2               w        w
                                − B3 + ξµ                           w e(w) f                ,               dw = ξµλ( x )S,                      (39)
                                          Yθ ( x )Yϕ ( x )    wx                    Yθ ( x ) Yϕ ( x )

with B3 = ξµw x e(w x )Ω x (w x ) since Ω x (w x ) = 0. Finally, use the incentive constraint (7), rewritten as
wV 0 (w)/Uc (w) = MRS(w)e(w), to write the second integral in the second line of (35) as

                                         d[V 0 (w)/Uc (w)]            V 0 (w)         V 0 (w)
                         Z wx                                                                                
                                                                                                                      1    dFx (w)
               −µ                 η (w)w                   + η 0 (w)w         + η (w)                                              dw
                          wx                     dw                   Uc (w)          Uc (w)                      w f x (w) dx

or, recognizing the sum of the bracketed terms as d[η (w)wV 0 (w)/Uc (w)]/dw, integrating by parts, and
using the transversality condition η (w x ) = η (w x ) = 0 and Lemma 4,

                                                                    Yθ0 ( x ) f xθ (w) Yϕ0 ( x ) f xϕ (w)
                                                                                                             !!
                                             V 0 (w) d
                               Z wx
                           µ          η (w)w                 −                        −                           dw = λ( x ) I                  (40)
                                wx           Uc (w) dw              Yθ ( x ) f x (w)    Yϕ ( x ) f x (w)

Define F̃ (w, x ) ≡ Fx (w). Since F̃ (w x , x ) ≡ 1 for all x,

                               d F̃ (w x , x )   ∂ F̃ (w x , x ) ∂ F̃ (w x , x ) dw x   dFx (w x )              dw x
                                               =                +                     =            + f x (w x )      = 0.                        (41)
                                     dx                ∂x              ∂w         dx       dx                    dx

Together with an analogous expression at w x , the fact that Ω x (w x ) = 0, and Lemma 4, this yields

                                                    B1 + B2 = −ξµw x e(w x )Ω x (w x ) = B3 .

Using (36), (37), (38), (39) and (40) in (35) yields

                                        W 0 ( x ) = λ( x ) I + R + ξµ α( x )Yϕ ( x ) E ϕ σ( x ) + S + C ,
                                                                                                      
                                                                                                                                                 (42)

where we have used −α0 ( x )Y ( Eθ , E ϕ ) + Yθ0 ( x ) Eθ = −α( x )Yϕ ( x ) E ϕ /x.




                                                                           38
C     Proof of Proposition 3
                                                         ϕ
                                                                  !
                                                    f (w)
                                 1+ξ   1 − α( x ) − x
                                                    f x (w)
               0
     lim 1 − T (y(w)) = lim
     w→∞                   w→∞          η (w) 1 + εu (w)
                                  1+
                                       w f x (w) εc (w)
                                                                         ϕ
                                                                                 !!
                                                                       f x (w)
                                    1+ξ      1 − α( x ) − lim
                                                             w→∞       f x (w)                     1 + ξ (1 − α( x ))
                       =                                                                      =                 .
                                                                       Ψ( Fx (w)) − Fx (w)
                                                                                                        
                                                     1 − Fx (w)
                                                               
                                 1                                                                            1
                           1+ 1+           lim                                                      1+ 1+          κ
                                 ε         w→∞        w f x (w)            1 − Fx (w)                         ε

The first equality is from (11). The second uses (iv) and (i), which implies η (w) = Ψ( Fx (w)) − Fx (w).
The third uses (ii) to simplify the numerator, and (iii) and (v) to take the limits of the two terms in the
denominator. The top tax rate result for the Pareto optimum follows with a little re-arranging. Setting
ξ = 0 yields the result for the SCPE. Corollary 4 and (iv) imply ξ > 0, since Ψ00 ( x ) < 0 implies that
gx (w)/ f x (w) = Ψ0 ( Fx (w)) is decreasing in w.




                                                          39
