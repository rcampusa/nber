                               NBER WORKING PAPER SERIES




         ON THE CORRELATION STRUCTURE OF MICROSTRUCTURE NOISE:
                     A FINANCIAL ECONOMIC APPROACH

                                        Francis X. Diebold
                                          Georg Strasser

                                       Working Paper 16469
                               http://www.nber.org/papers/w16469


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    October 2010




For comments and suggestions we thank Rob Engle, Peter Hansen, Charles Jones, Eugene Kandel,
Gideon Saar, Frank Schorfheide, Enrique Sentana, and three anonymous referees. We are also grateful
to participants at the NBER Conference on Market Microstructure, the Oxford-Man Institute Conference
on the Financial Econometrics of Vast Data, and the Christmas Meeting of German Economists Abroad.
We thank Ole E. Barndor-Nielsen, Peter R. Hansen, Asger Lunde and Neil Shephard for sharing their
data with us. The views expressed herein are those of the authors and do not necessarily reflect the
views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2010 by Francis X. Diebold and Georg Strasser. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
On the Correlation Structure of Microstructure Noise: A Financial Economic Approach
Francis X. Diebold and Georg Strasser
NBER Working Paper No. 16469
October 2010
JEL No. C51,D82,D83,G14,G20

                                              ABSTRACT

We introduce the financial economics of market microstructure into the financial econometrics of
asset return volatility estimation. In particular, we use market microstructure theory to derive the cross-
correlation function between latent returns and market microstructure noise, which feature prominently
in the recent volatility literature. The cross-correlation at zero displacement is typically negative, and
cross-correlations at nonzero displacements are positive and decay geometrically. If market makers
are sufficiently risk averse, however, the cross-correlation pattern is inverted. Our results are useful
for assessing the validity of the frequently-assumed independence of latent price and microstructure
noise, for explaining observed cross-correlation patterns, for predicting as-yet undiscovered patterns,
and for making informed conjectures regarding improved volatility estimation methods.


Francis X. Diebold
Department of Economics
University of Pennsylvania
3718 Locust Walk
Philadelphia, PA 19104-6297
and NBER
fdiebold@sas.upenn.edu

Georg Strasser
Department of Economics
Boston College
140 Commonwealth Avenue
Chestnut Hill, MA 02467-3806
Georg.Strasser@bc.edu
1       Introduction
Recent years have seen substantial progress in asset return volatility measurement, with im-
portant applications to asset pricing, portfolio allocation and risk management. In particular,
so-called realized variances and covariances (“realized volatilities”), based on increasingly-
available high-frequency data, have emerged as central for several reasons.1 They are, for ex-
ample, largely model-free (in contrast to traditional model-based approaches such as GARCH
or stochastic volatility), they are computationally trivial, and they are in principle highly
accurate.
    A tension arises, however, linked to the last of the above desiderata. Econometric theory
suggests the desirability of sampling as often as possible to obtain highly accurate volatility
estimates, but financial market reality suggests otherwise. In particular, microstructure
noise (MSN), such as bid-ask bounce associated with ultra-high-frequency sampling, may
contaminate the observed price, potentially rendering naively-calculated realized volatilities
unreliable.
    Early work (e.g., Andersen et al., 2001a,b, 2003, Barndorff-Nielsen and Shephard, 2002a,b)
addressed the sampling issue by attempting to sample often, but not “too often,” implicitly
or explicitly using the volatility signature plot of Andersen et al. (2000) to guide sampling
frequency, typically resulting in use of five- to thirty-minute returns.2
    Much higher-frequency data are usually available, however, so reducing the sampling
frequency to insure against MSN discards potentially valuable information. To use all infor-
mation, more recent work has emphasized MSN-robust realized volatilities that use returns
sampled at very high frequencies. Examples include Zhang et al. (2005), Bandi and Russell
(2008), Aı̈t-Sahalia et al. (2010), Hansen and Lunde (2006), and Barndorff-Nielsen et al.
(2008a, 2010). That literature is almost entirely statistical, however, which is unfortunate
because it makes important assumptions regarding the nature of the latent price, the MSN,
and their interaction, and purely statistical thinking offers little guidance. A central example
concerns the interaction (if any) between latent price and MSN. Some authors such as Bandi
and Russell assume no correlation (perhaps erroneously), whereas in contrast Barndorff-
Nielsen et al. (2008a,b) allow for correlation (perhaps unnecessarily).
    To improve this situation, we explicitly recognize that MSN results from the strategic
behavior of economic agents, and we push toward integration of the financial economics of
market microstructure with the financial econometrics of volatility estimation. In particular,
    1
     Several surveys are now available, ranging from the comparatively theoretical treatments of Barndorff-
Nielsen and Shephard (2007) and Andersen et al. (2010) to the applied perspective of Andersen et al. (2006).
   2
     The volatility signature plot shows average daily realized volatility as a function of underlying sampling
frequency.



                                                      1
we explore the implications of microstructure theory for the relationship between latent
price and MSN, characterizing the cross-correlation structure between latent price and MSN,
contemporaneously and dynamically, in a variety of leading environments, including those
of Roll (1984), Glosten and Milgrom (1985), Kyle (1985), Easley and O’Hara (1992), and
Hasbrouck (2002).3
    We proceed as follows. In section 2 we introduce our general framework, which nests a
variety of microstructure models. In sections 3 and 4 we provide detailed analyses of models
of private information, distinguishing two types of latent prices based on the implied level of
market efficiency. In particular, we treat strong form efficiency in section 3 and semi-strong
form efficiency in section 4. We sketch additional econometric implications of our findings
in section 5, and we conclude in section 6.


2       The Framework
We begin in section 2.1 by introducing our general framework relating latent prices, observed
prices, and MSN in a wide range of market-making environments. We then provide, in section
2.2, a generic (model-free) statistical result on the nature of correlation between latent price
and MSN. Finally, in section 2.3 we introduce several workhorse microstructural economic
models of market making, which we use heavily in subsequent analyses.


2.1     Latent Prices, Observed Prices and Microstructure Noise
Let p∗t denote the (logarithm of the) strong form efficient price of some asset in the calendar
time period t.4 This price, strictly exogenously changing every T th -period and at time t
known only to the informed traders, follows the process5
                                          
                                          p ∗     + σεt , ∀t = κT, κ ∈ Z
                                             t−1
                                  p∗t =                                                                    (1)
                                          p ∗ ,            otherwise
                                             t−1



                                                   εt iid
                                                      ∼ (0, 1).                                            (2)
    3
     For insightful surveys of the key models, see O’Hara (1995) and Hasbrouck (2007).
    4
     We focus on the information conveyed by the trade direction only. Today’s markets are dominated by
orders split into many small trades, so that the size of individual orders is only minimally informative. Hence
we focus on the trade direction as primary source of trade-related information.
   5
     The setup we present here is a slight generalization of the “generalized Roll model” of Hasbrouck (2007).
As common in the high-frequency literature, we drop the deterministic drift term, but our results hold for
any nonzero deterministic drift, if price changes are defined net of drift.



                                                        2
    Order-splitting into many small trades has become dominant in recent years. In line with
recent developments we consider in this paper the limiting case of all trades being of unit
size. Under a suitable choice of calendar frequency, as illustrated by Figure 1, this allows us
to map any trading pattern into calendar time with unit trades.

                             Figure 1: Mapping Tick-Time into Calendar Time

           quantity 63r                                          r
                                                                 3




                   2
                    r                            2
                                                  r 2r 2r
       Tick-

                                          r                                       r                          r
         time
       Sampling                          1                                       1                           1




                                                                                                                         - time
                                              frequency τT T =
                                              least common multiple of all non-zero
                                              time intervals between ticks

           quantity 6

                    11    111             1      11   11   11    111              1                          1
       Calendar-
         time
       Sampling

                        0000 0000000000000 0000000 000 000 0000000   000000000000000 0000000000000000000000000 0000000
                                                                                                                         - time
                    123456

                    6
                   1/6
                                              frequency τCT = τT T ×
                                              least common multiple of quantities
                                              traded at any tick




    Let qt denote the direction of the trade in period t, where qt = +1 denotes a buy, qt = −1
a sell, and qt = 0 that no trade occurs in the period. Define pet as the expected efficient price
directly before the trade occurs. The semi-strong form efficient price, which summarizes the
knowledge of the market maker after the trade,6 is

                                                            p̃et = pet + λt qt ,                                                  (3)

where λt ≥ 0 captures the response to asymmetric information revealed by the trade direction
qt . At the beginning of each trading round, additional information about p∗t and εt might be
revealed by information diffusion from other markets. This information, summarized by ωt ,
   6
    This terminology is borrowed from the asset pricing literature. In contrast to the strong form effi-
cient price, which incorporates all public and private information, the semi-strong form efficient price only
incorporates all publicly available information (Fama, 1970).


                                                                       3
makes the market maker revise his price expectation for the next period according to7

                                                              pet = p̃et−1 + ωt .                                                           (4)

    Assuming that the (logarithm of) price quotes are symmetric around the expected efficient
price before the trade,8 the (logarithm of the) observed transaction price can be written as

                                                              pt = pet + st qt ,                                                            (5)

where st is one-half of the spread. In particular, the bid price is pbid  e
                                                                     t = pt − st , the ask price
is pask
    t   = pet + st , and the mid price is pmid
                                           t   = pet . These prices and their relationships are
illustrated by Figure 2.

                                  Figure 2: Timing of Information and Prices

        Strong Form
                           p∗t                                  p∗t+1                               p∗t+2
        Eﬃcient Price
                                                                                                                                        
        Information Flow         ωt               qt                ωt+1               qt+1             ωt+2               qt+2          time
                                                                                                                     
        Semi-strong Form              pet              p̃et             pet+1             p̃et+1            pet+2             p̃et+2
        Eﬃcient Price

                                                                                                                        
        Market Price                        pet + st qt                         pet+1 + st+1 qt+1                   pet+2 + st+2 qt+2




      Strong form efficient returns in periods t = κT are therefore

                                                       ∆p∗t ≡ p∗t − p∗t−1 = σεt ,                                                           (6)

and zero in all other periods. Semi-strong form efficient returns are

                                                ∆p̃et ≡ p̃et − p̃et−1 = λt qt + ωt ,                                                        (7)

and market returns are

                       ∆pt ≡ pt − pt−1 = ∆pet + st qt − st−1 qt−1
                                                       = ∆p̃et + (st − λt )qt − (st−1 − λt−1 )qt−1 .
  7
    In periods in which p∗t−1 becomes public information,this becomes pet = p∗t−1 + ωt .
  8
    We use the approximation ln(P + S) = ln P 1 + PS = p + ln 1 + PS ≈ p + PS ≡ p + s, where P and
S denote price and spread before taking the natural logarithm, respectively.



                                                                        4
       We use the term “latent price” as a general term comprising both types of efficient
prices. The two latent prices defined here are conceptually very distinct and appeal to
distinct audiences. For example, on the one hand, a pure theorist may want to understand
the properties of the full-information price, and is thus interested in an estimate of the
volatility of the strong form efficient return (6). One the other hand, a market maker may
need a volatility measure to calculate risk exposure, thus his relevant price for the asset is
p̃et , the price at which he keeps the asset on his accounts. It is the volatility of (7), and not
of (6), that affects his balance sheet.
       Microstructure noise (MSN) is the difference between the observed market return and
the latent return. Depending on whether one considers the strong form efficient return or
the semi-strong form efficient return, the noise is defined either as strong form noise

                                          ∆ut ≡ ∆pt − ∆p∗t ,

or as semi-strong form noise 9
                                          ∆ut ≡ ∆pt − ∆p̃et .                                        (8)

    As we show in this paper, these two types of noise differ fundamentally in their cross-
correlation properties. It is therefore essential for a researcher to be clear in advance what
type of latent price the object of interest is, because each type of efficiency requires different
procedures to remove MSN appropriately.
    A convenient estimator of the variance of the strong form efficient return, σ 2 , is the
realized variance Andersen et al. (2001b). Realized variance during the time interval [0, T ]
is defined as the sum of squared market returns over the interval, i.e. as

                                                       T
                                                       X
                                        V ar(∆pt ) =         ∆p2t .
                                                       t=1


In the presence of MSN, the realized variance is generally a biased estimate of the variance
of the efficient return, σ 2 . To see this, decompose the noise into two components, i.e. ∆ut =
            asy
∆uba                                        ba
    t +∆ut . The first component, ∆ut , is assumed to be uncorrelated with the latent price
of interest, reflecting for example the bid-ask bounce in a market populated with uninformed
traders only. The second component, ∆uasy      t , is correlated with the efficient price, and reflects
for example the effect of asymmetric information. Realized variance can now be decomposed
   9
     We assume throughout that market conditions are stable and that market prices pt adjust sufficiently
fast so that the noise process ∆ut is covariance stationary.




                                                   5
– here shown for the strong form efficient price – as

                                               asy
              V ar(∆pt ) = V ar(∆p∗t + ∆uba
                                         t + ∆ut )
                                                        asy          ∗     asy
                            = σ 2 + V ar(∆uba
                                           t ) + V ar(∆ut ) + 2Cov(∆pt , ∆ut ).


The bias of the realized variance can stem from any of the last three terms, which are all
nonzero in general. Realized variance estimation under the independent noise assumption
accounts for the second and third positive terms, but ignores the last term, which is typically
negative (Hansen and Lunde, 2006). Correcting the estimates for independent noise only,
always reduces the volatility estimate. But because such a correction ignores the last term,
which is the second channel through which asymmetric information affects the realized vari-
ance estimate, the overall reduction might be too much. Further, serial correlation of noise,
or equivalently a cross-correlation between noise and latent returns at nonzero displacement,
requires the use of robust estimators for both the variance and the covariance terms. In
this paper we determine what correlation and serial correlation market microstructure the-
ory predicts, and how market microstructure theory can be useful for obtaining improved
estimates of integrated variance.


2.2     Statistical Characterization of Return/Noise Correlations
We focus in this paper on the cross-correlation between latent returns and noise contem-
poraneously and at all displacements. Throughout, we refer to this quantity simply as the
“cross-correlation”.
   Here we present a simple but important insight about the cross-correlation, true under
very general conditions because it follows directly from the definition of covariance. In
particular, for the price processes given by (1)–(5) the contemporaneous cross-correlation
Corr(∆p∗t , ∆ut ) is positive only if the market return, ∆pt , is more volatile than the latent
return. More precisely, for strong form efficient returns10
                                                                                         s
                                                                                              V ar(∆p∗t )
  Corr(∆p∗t , ∆ut ) > 0 ⇔ E(∆pt ∆p∗t ) > V ar(∆p∗t ) ⇔ Corr(∆pt , ∆p∗t ) >                                ,   (9)
                                                                                              V ar(∆pt )
  10
    To see this for strong form efficient returns, simply note that the unconditional expectation of both
microstructure noise and the latent price change is zero (E(∆ut ) = 0, E(∆p∗t ) = T1 σE(εt ) = 0), so that the
contemporaneous cross-covariance between strong form efficient returns and noise is

                     Cov(∆p∗t , ∆ut ) = E(∆p∗t (∆pt − ∆p∗t )) = E(∆p∗t ∆pt ) − V ar(∆p∗t ).

The logic for semi-strong form efficient returns is analogous, because E(∆p̃et ) = 0.



                                                       6
and for semi-strong form efficient returns
                                                                                          s
                                                                                              V ar(∆p̃et )
       Corr(∆p̃et , ∆ut ) > 0 ⇔ E(∆pt ∆p̃et ) > V ar(∆p̃et ) ⇔ Corr(∆pt , ∆p̃et ) >                        .
                                                                                              V ar(∆pt )

    Cross-correlations at displacements τ ≥ 1 are positive if and only if the current market
price responds stronger in the direction of a previous latent price change than the current
latent price itself. More precisely, for strong form efficient returns11

                             Corr(∆p∗t−τ , ∆ut ) > 0 ⇔ E(∆pt ∆p∗t−τ ) > 0,                                     (10)

and for semi-strong form efficient returns

                     Corr(∆p̃et−τ , ∆ut ) > 0 ⇔ E(∆pt ∆p̃et−τ ) > E(∆p̃et ∆p̃et−τ ).

    The statistical insight offered here is helpful at a broad conceptual level – without re-
ferring to any specific model of market participants’ behavior, we can nevertheless isolate
the properties of ∆pt that determine the cross-correlation pattern – but it offers no insight
into the nature of cross-correlation patterns induced by strategic economic behavior. In
the financial economic environments that will concern us, the properties of ∆pt , and hence
the cross-correlation patterns, are determined by (1) the market microstructure, and (2) the
market maker’s loss function. Hence we introduce them now in some detail.


2.3       Introducing Markets and Market Makers
Whereas the strong form efficient price (1) is an exogenous stochastic process, the semi-strong
form efficient price (3) and the market price (5) are an outcome of the market participants’
optimizing behavior. As such the latter are not time series of unknown properties generated
by a black box. Instead, key properties of the data generator – the financial market – are
often observable and allow inferring properties of these price series. This is what we do in
this paper.
    Generally speaking, the market price depends on the information available about the
  11
    These results follow again from the definition of covariance; the cross-covariance at nonzero displacements
between latent returns τ ≥ 1 periods ago and noise is

                Cov(∆p∗t−τ , ∆ut ) = E(∆p∗t−τ (∆pt − ∆p∗t )) = E(∆p∗t−τ ∆pt ) − E(∆p∗t−τ ∆p∗t ).

Independence of strong form efficient price changes and non-forgetting immediately implies (10). The logic
for semi-strong form efficient returns is again analogous, except that serial correlation of semi-strong form
efficient returns, ∆pet , must be taken into account.


                                                       7
strong form efficient price and the market participants’ response to this information. The
information process matters in two ways: First, via its information content, and second,
via the time span T in which it is not publicly known but valid. The price updating rule
determines how, and how quickly, market prices respond to new information. Of particular
importance is whether the market maker can quote prices dependent on the direction of
trade, i.e. whether he is free to charge any spread, because direction-dependent quotes allow
prices to react instantaneously.
    We consider limit-order markets, populated by informed and uninformed traders. Market
makers are the counterparty of all trades. Each trading round they quote price pmid         t   and
spread st for one unit of the asset. Thereafter, as shown in figure 3, informed traders
screen the market with probability α for profitable trading opportunities. They buy if
p∗t > pask
       t   ≡ pmid
              t   + st , sell if p∗t < pbid  mid
                                        t ≡ pt   − st , and refuse to trade otherwise. In periods of
no informed trade, uninformed traders trade instead with probability β, buying and selling
with equal probability.12

               Figure 3: Sequence of Informed and Uninformed Trading Decisions


                                                          Informed
                                                      5      Buy                              q = +1
                                        ∗     ask
                                       p >p

                             Informed       p∗ < pbid / Informed
                              Traders                                                         q = −1
                                                           Sell
                            ? Active
                   α                        pask ≥ p∗ ≥ pbid
                                                                                     No
                                                                                 Uninformed   q=0
                                                                                6 Trading
                                                                     1−β
                  1−α
                                                         
                                Informed                   No         β/2
                                 Traders              / Informed            / Uninformed      q = +1
                                                                                 Buy
                                 Inactive                Trading

                                                                     β/2    )
                                                                                Uninformed
                                                                                   Sell       q = −1




       When trading with an informed trader the market maker always loses. His expected loss
  12
    Easley et al. (2008) estimate time-varying arrival rates of informed and uninformed traders, which they
find mutually dependent.




                                                              8
is
                                            Z    p
                                                     |(pt − p∗t )E(qt |p∗t , pt , st )|n f (p∗t ) dp∗t ,
                                     
                Ln   pt , F (·; p, p) = −                                                                  (11)
                                             p


where E(qt |pt + st < p∗t ) = α, E(qt |pt − st > p∗t ) = α, E(qt |pt − st ≤ p∗t ≤ pt + st ) = 0, and
n reflects the risk aversion of the market maker. F (·) and f (·) denote the cdf and pdf with
          
support p, p of the market maker’s belief about the latent price. The market maker faces
a tradeoff between avoiding losses today and learning quickly.13
    We add the following assumption, which helps us in greatly simplifying the model without
affecting its basic behavior.

Assumption 1 Ex ante (t = 0) buys (qt = +1) and sells (qt = −1) are equally likely,
so that E(qt ) = 0. There is no “momentum” in uninformed trading, and thus trades are
not serially correlated beyond the time of a strong form efficient price change, that is,
E(qκT +τ1 |qκT −τ2 ) = 0 ∀κ, τ1 ∈ N0 , ∀τ2 ∈ N.

    In the following sections 3 and 4 we look at specializations of this general market maker
problem and examine the effect of various model setups on the cross-correlation function.
For both strong form and semi-strong form efficient returns we first examine the multiperiod
case, where private information is not revealed until after many periods. We then specialize
to the one-period case, a case where private information becomes public, and worthless,
after only one period, where we specifically address the effect of a risk-averse market maker
(n > 1).


3         Return/Noise Cross-Correlations in Economic Envi-
          ronments I: Strong Form Efficient Prices
Here we characterize cross-correlations in an environment of strong form efficient prices.
Accordingly, in this section “efficient price” means “strong form efficient price”.
   Suppose there is a single change in the strong form efficient price at a known time at
which the previous change becomes public knowledge. To fix ideas, let this change occur
every T periods.14 This allows studying the effect of one efficient price change in isolation.
     13
    We describe this market maker problem in more detail in Appendix A.
     14
    The average time T between two changes in the strong form efficient price could be several days, or,
more likely, just a few hours. Engle and Patton (2004) and Owens and Steigerwald (2005), for example, find
evidence of multiple information arrivals during a calendar day.




                                                         9
      We first calculate the correlations between strong form efficient returns
                                                  (
                                                       σεκT ∀κ ∈ Z
                               ∆p∗t = ∆p∗κT =                                                       (12)
                                                        0   ∀κ ∈
                                                               /Z

and the corresponding noise,

                          ∆ut = ∆pt − ∆p∗t = ∆pet + st qt − st−1 qt−1 − ∆p∗t .                      (13)


3.1       The General Multi-Period Case
In the period of a change in the strong form efficient price, the expectation about this price
changes by15

                          ∆pe0 = pe0 − pe−1
                                              T
                                              X
                                 = σε−T −             (λ−t q−t + ω−t ) − ω−1 + ω0 ,
                                                t=2


and in all other periods by
                                          ∆pet = λt−1 qt−1 + ωt .

      From (13) we get for t = κT

                                                             T
                                                             X
               ∆u0 = σ(ε−T − ε0 ) + s0 q0 − s−1 q−1 −               (λ−t q−t + ω−t ) − ω−1 + ω0     (14)
                                                              t=2


and ∀t 6= κT
                                ∆ut = λt−1 qt−1 + st qt − st−1 qt−1 + ωt ,                          (15)

where the first term reflects information-revealing trades, the second and third term reflect
the bid-ask bounce, and the last term new non-trade information.
   This immediately leads to the contemporaneous cross-covariance

                                                σ
                           Cov(∆p∗t , ∆ut ) =     [s0 E(q0 ε0 ) − σ + E(ω0 ε0 )] .                  (16)
                                                T

For cross-covariance at higher displacements τ ∈ [1; T − 1] we get

                                    σ
             Cov(∆p∗t−τ , ∆ut ) =     [(λτ −1 − sτ −1 )E(qτ −1 ε0 ) + sτ E(qτ ε0 ) + E(ωτ ε0 )] ,   (17)
                                    T
 15
      As a shorthand notation we use px ≡ pκT +x ∀κ, x ∈ Z.



                                                       10
for cross-covariance at displacement T

                                                          T −2                T −1
                               "                                                            #
                             σ                            X                   X
        Cov(∆p∗t−T , ∆ut ) =     σ − sT −1 E(qT −1 ε0 ) −      λi E(qi ε0 ) −      E(ωi ε0 ) ,                        (18)
                             T                            i=0                 i=0


and for all higher order displacements τ > T

                                                 Cov(∆p∗t−τ , ∆ut ) = 0.                                              (19)


   Now consider V ar(∆p∗t ) and V ar(∆ut ). The strong form efficient price has unconditional
variance
                                      ∗     1             σ2
                              V ar(∆pt ) = V ar(σε0 ) = ,                                (20)
                                            T             T
and the corresponding noise has unconditional variance

                 T −1
               1X
  V ar(∆ut ) =        V ar(∆ui )
               T i=0
                           T −1                                                   T −2
                 (
               1      2
                          X
                                     2          2
                                                                                 X
             =      2σ +         φi si + φi−1 si−1 − 2σsT −1 E(qT −1 ε0 ) − 2σ         λi E(qi ε0 )
               T           i=0                                                    i=0
                                                                            !2 
                                       XT −2                       T
                                                                   X −2
             − 2σs0 E(q0 ε0 ) + 2sT −1       λi E(qi qT −1 ) + E       λi qi  + E(ω02 )
                                                        i=0                            i=0
                        "T −1           #                            T                          T −1
                         X                                           X                          X
                 + E              ωi2       + 2s0 E(q0 ω0 ) − 2σ           E(εi ωi ) + 2sT −1          E(qT −1 ωi )
                            i=0                                      i=0                        i=0
                     T −1
                     X
                 +          (φi−1 λi−1 (λi−1 − 2si−1 ) + 2(λi−1 − si−1 )(si E(qi−1 qi ) + E(qi−1 ωi ))
                      i=1
                      E(ωi2 ) + 2si E(qi ωi )
                                                    
                 +                                       ,                                                            (21)

where

  φt = E(q 2 ) = E [P rob(q = +1 ∨ q = −1)] = β + (1 − β)α [1 − F (pet + st ) + F (pet − st )] .

   Using (16) the contemporaneous cross-correlation is

                                                              s0 E(q0 ε0 ) − σ + E(ω0 ε0 )
                             Corr(∆p∗t , ∆ut ) =                   p                       .                          (22)
                                                                       T V ar(∆ut )

All other cross-correlations can be obtained analogously using (17) to (19).


                                                                11
    The term E(qτ ε0 ) enters the expressions for the cross-covariance (16)–(18) linearly and
enters the denominator of the cross-correlation under a square root. Because this term de-
creases the share of uninformed trades, the contemporaneous cross-correlation is the smaller,
the less informed traders are active. Only in absence of any informed traders we have
E(qτ ε0 ) = 0, and the market microstructure reduces to a bid-ask bounce, as in Roll (1984).
Even in this case, shown in the first row of Table 1, the latent price and noise are not inde-
pendent. The contemporaneous cross-correlation (16) is negative, the cross-correlations at
displacement T is positive and all other cross-correlations are zero.
    Because of order splitting, effective spreads have become very small for liquid assets. If
the spread sufficiently small,16 the contemporaneous cross-correlation is negative, because in
this case pt shows barely any instantaneous reaction to ∆p∗t .17 Likewise, if the spread roughly
matches the adverse selection coefficient, by (17) the cross-correlations at displacements one
up to T − 1 are positive, which reflects that the more the market maker learns, the closer pt
gets to p∗t , and the more noise shrinks to zero. If, additionally, the adverse selection coefficient
λ and extra information ω in all periods are sufficiently small, by (18) the cross-correlation
at displacement T is positive.
    In general, however, the sign of the cross-correlations depends on the behavior of the
market maker and traders. We now turn to models that allow us to introduce these explicitly.


3.2     Special Multi-Period Cases
Because the market maker loses in every trade with an informed trader, he has an incentive
to find out the strong form efficient price. He learns about the informed traders’ private
information by setting prices and observing the resulting trades. As he learns over time “by
experimentation”,18 the value of private information of the informed trader slowly vanishes.
Although there are many possible interactions of strategic actions by market participants,
we will see that rational behavior ensures that they all share the same cross-correlation sign
pattern and differ only in the absolute value of the cross-correlation.
    The market maker does not observe p∗t directly, but only signals which allow him to
narrow down the range of the current p∗t level. He observes in particular the response of
traders to his previous price quote and uses this signal to revise his quote. Because the
strong form efficient price, p∗t , by assumption (12) does not change after the initial jump for
T periods, the market maker can use the entire sequence of signals to learn p∗t over time. His
  16
     A sequence of only bid prices (or only ask prices) is equivalent to st = 0 ∀t.
  17
     ρ0 is negative, but strictly larger than negative one. This obtains, because pt responds every period to
noisy signals about p∗0 , which increases the noise variance.
  18
     Aghion et al. (1991), Aghion et al. (1993)



                                                     12
optimization task is to quote prices that minimize his losses by learning about p∗t as quickly
as possible.
     The recursive problem of the market maker is hard to solve, and in particular there are
in general no closed form policy functions pbid
                                              t   and pask
                                                       t . Therefore we follow the market
microstructure literature by discussing interesting polar cases, which can be solved because
f (p∗t ) is degenerate.19

3.2.1    No Strategic Traders

Consider a market in which the market maker observes only a noisy signal of whether p∗t
has changed, but in which traders do not behave strategically yet. The market maker has to
learn both about the quality of the signal and about the latent price. Glosten and Milgrom
(1985) describe a market maker who – as in our general setup – does not know whether he is
trading with an informed or an uninformed trader and thus cannot tell whether the direction
of trade, qt , contains information. For example, the market maker cannot tell whether a
“buy” originates from an informed trader, in which case it would indicate an increase in the
strong form efficient price, or whether it is just a random trade of an uninformed trader.
Thus, a noisy “buy” increases the likelihood of an increase in the strong form efficient price
less than a “buy” in a“perfect signal” environment.
    As useful illustration is the stylized model of Easley and O’Hara (1992), which allows
us to derive the cross-correlation pattern explicitly. As in our general setup in section 2.3
informed traders are active with probability α. The two possible latent price levels, p∗ and
p∗ > p∗ ,20 and the probability γ of a low latent price are publicly known, but the actual
realization of p∗t is not.
    The direction-of-trade signal, qt , is thereby uncertain in two ways.21 Not only does the
market maker not know if a specific trade originates from informed traders, thereby being
informative; the market maker does not even know if there are any informed traders. He
learns by updating in a Bayesian manner his belief about the probabilities that nobody
observed a signal, that informed traders observed a high p∗t , or that they observed a low p∗t ,
using his information set of all previous quotes and trades, Ωt . Even non-trading intervals
contain information about p∗t , because they lower the probability that informed traders are
  19
      See Appendix A.2. We assume in the following section 3.2.1 that market makers are risk neutral (n = 1)
and limit our discussion to the mid price under a constant spread in order to study the learning effect in
isolation.
   20
      The strong form efficient price is not a martingale here.
   21
      The case of signal certainty, which implies the absence of any uninformed traders, is trivial here: Because
p∗t can assume only one of two price levels, the first trade reveals the true strong form efficient price. Until
the first trade occurs, the expected efficient price is γp∗ + (1 − γ)p∗ .



                                                       13
active.22
    Denote βτ,{p∗ } the belief at time t+τ that a high latent price has been observed, βτ,{p∗ } the
belief that a low latent price has been observed and βτ,{} the belief that nobody has observed
any signal, all conditional on Ωt ∪ {qt }. The market maker sets under perfect competition

                 ∗
                                                                                   p ∗ + p∗
           pbid
            τ −p   = βτ,{p∗ } (1 − βτ,{} )p∗ + βτ,{p∗ } (1 − βτ,{} )p∗ + βτ,{}              − p∗
                                                                                     2
                                   βτ,{}
                                             p ∗ − p∗ .
                                                     
                   =   βτ,{p∗ } +
                                    2

A sufficiently large τ allows invoking a law of large numbers for the observations included in
the market maker believes. Easley and O’Hara (1992) show for the case that traders observe
a low latent price that βτ,{p∗ } = exp(−r1 τ ) and βτ,{} = exp(−r2 τ ) for some r1 , r2 > 0. Hence
for large τ the bid price pbid
                             t   converges to p∗ almost surely at the exponential learning rate
r = min(r1 , r2 ) in clock time.
                                                  a.s. ∗
                                             pbid
                                              t   →p

An analogous result applies to the convergence of the ask price to p∗ . Thus transaction prices
converge to the strong form efficient price in clock time at exponential rates for large τ .23
   The following proposition summarizes the cross-correlations in Easley and O’Hara (1992)-
type models. It considers only the dominant exponential learning pattern, and ignores all
terms which disappear at a faster rate as τ gets large.

Proposition 1 (Cross-correlations in the Easley-O’Hara model)
  The contemporaneous cross-correlation in the Easley and O’Hara (1992) model is

                                                       1 + e−r(T −1)
                               Corr (∆p∗t , ∆ut )   =−     √         < 0,
                                                          2 K

and the cross-correlations at sufficiently large nonzero displacements follow

                                         er − 1
                       Corr ∆p∗t−τ , ∆ut = √ e−rτ > 0, ∀τ ∈ [1, T − 1]
                                           2 K

                                                   e−r(T −1)
                                 Corr ∆p∗t−T , ∆ut = √        > 0,
                                                     2 K
  22
     A variation of this setup is the model of Diamond and Verrecchia (1987), where short selling constraints
cause periods of no trading to be a noisy signal of a low latent price.
  23
     This corresponds to proposition 6 in Easley and O’Hara (1992). The result has been derived for calendar
time sampling. Tick time sampling leads to lower convergence rates, because it misses the no-trade periods,
which reveal information as well: During trading days in which no trader has observed the latent price there
are more no-trade periods than during trading days in which some have.


                                                     14
where K = K(r, T ).

   Proof: See Appendix B.1.
   As before, the contemporaneous correlation is negative, and approaches its minimum for
small r and small T . Furthermore, for τ ∈ [1, T − 1],
                                                                             τ −1
                                                                         1
                                         ∆p∗t−τ , ∆ut                                  Corr ∆p∗t−1 , ∆ut .
                                                                                                       
                              Corr                               =
                                                                         er

That is, the cross-correlation of the strong form efficient price decays geometrically to zero
until τ = T .
            Figure 4: Cross-Correlation Functions ρτ of the Strong Form Efficient Price
              Cross-Correlations of Strong Form Efficient Prices                         Cross-Correlations of Strong Form Efficient Prices
              in(a) Noisy Signal
                 Easley-O'Hara         (r=0.5,
                               Model (K=1,  r=0.5,TT=5)
                                                    =5)                                  in (b)  Noisy Signal
                                                                                            Easley-O'Hara           (r=2,
                                                                                                          Model (K=1,  r=2, T =5)
                                                                                                                            T=5)
      1.0                                                                        1.0
      0.8                                                                        0.8
      0.6                                                                        0.6
      0.4                                                                        0.4
      0.2                                                                        0.2
      0.0                                                                        0.0
     -0.2                                                                       -0.2
     -0.4                                                                       -0.4
     -0.6                                                                       -0.6
     -0.8                                                                       -0.8
     -1.0                                                                       -1.0
               0        1        2         3        4        5                            0        1        2         3        4        5

              Cross-Correlations of Strong Form Efficient Prices                         Cross-Correlations of Strong Form Efficient Prices
                 (c) Model
              in Kyle Strategic
                             (T=5) Traders (T =5)                                           (d) Model
                                                                                         in Kyle Strategic
                                                                                                        (T=2) Traders (T =2)
      1.0                                                                        1.0
      0.8                                                                        0.8
      0.6                                                                        0.6
      0.4                                                                        0.4
      0.2                                                                        0.2
      0.0                                                                        0.0
     -0.2                                                                       -0.2
     -0.4                                                                       -0.4
     -0.6                                                                       -0.6
     -0.8                                                                       -0.8
     -1.0                                                                       -1.0
               0        1        2         3        4        5                            0        1        2         3        4        5

              Cross-Correlations of Strong Form Efficient Prices                         Cross-Correlations of Strong Form Efficient Prices
               (e)Low
              with  LowRiskRisk    Aversion
                             Aversion  (T=1)    (T =1)                                    (f)High
                                                                                         with  HighRiskRisk    Aversion
                                                                                                        Aversion  (T=1)    (T =1)
      1.0                                                                        1.0
      0.8                                                                        0.8
      0.6                                                                        0.6
      0.4                                                                        0.4
      0.2                                                                        0.2
      0.0                                                                        0.0
     -0.2                                                                       -0.2
     -0.4                                                                       -0.4
     -0.6                                                                       -0.6
     -0.8                                                                       -0.8
     -1.0                                                                       -1.0
               0        1        2         3        4        5                            0        1        2         3        4        5




   In the first row of Figure 4 we graph this cross-correlation function. We show the cross-

                                                                         15
correlation pattern for an Easley-O’Hara (1992)-type model for a learning rate of r = 0.5 in
the upper left panel, and for a faster learning rate of r = 2 in the upper right panel.
    We summarize the results for the Easley-O’Hara (1992) model in the third row of Table
1. This decay pattern is not unique to the Easley-O’Hara (1992) model. In Appendix C we
show that this cross-correlation pattern holds under signal certainty as well. In this case it is
optimal for market markers to learn the latent price by repeated bisections. Often, optimal
learning stops before p∗ is reached (Aghion et al., 1991), e.g. if the spread is large or if risk
aversion is small. In that case the cross-correlations cut off at some τ < T .
    More generally, Glosten and Milgrom (1985) show that if learning is costless, the expec-
tations of market makers and traders necessarily converge as the number of trades increases.
We summarize these qualitative results in the second row of Table 1. Because of the uncer-
tainty of whether a trade reflects information or just noise, the market maker faced with a
noisy signal adjusts only partially. Therefore, whereas the cross-correlations under a noisy
signal have the same signs as under signal certainty, their absolute values are all dampened
toward zero.

          Table 1: Strong Form Efficient Cross-Correlations in Multi-period Models

     p∗t mar-     signal       traders             ρ0               ρτ                ρT            ρτ
     tingale                  strategic                       τ ∈ [1, T − 1]                      τ >T
        yes        none          n.a.           ρ0 < 0                0              −ρ0           0
                 certain/
        yes                       no            ρ0 < 0        ρτ −1 > ρτ > 0     ρT > 0            0
                  noisy
                                                   −r(T −1)   −e−rτ −r(τ −1)       −r(T −1)
        no        noisy           no         − 1+e
                                                 √               √+e              e√
                                                                                                   0
                                                2 K(r,T )       2 K(r,T )        2 K(r,T )
                                                 q              q                q
        yes        noisy         yes          − T 2T+1                  1
                                                                    T (T 2 +1)
                                                                                         1
                                                                                     T (T 2 +1)
                                                                                                   0

Notes: We show ρτ = Corr(∆p∗t−τ , ∆ut ) in multiperiod models (T > 1) under risk neutrality (n = 1).




3.2.2    Strategic Traders

Because the market maker cannot distinguish informed trades from uninformed ones, in-
formed traders can act strategically. The aim of strategic behavior of informed traders is to
make the signals about p∗t conveyed by their orders as noisy as possible, while still executing
the desired trades. By mimicing uninformed traders they keep the market maker unaware
about the change in p∗t . Because the market maker observes the order flow and uses it to
detect informed trading, the informed traders stretch their orders over a long time period
such that detecting an abnormal trading pattern becomes difficult. The market maker will,

                                                   16
of course, notice the imbalance in trades over time. By sequentially updating his belief
about p∗t based on the history of trades he still learns about p∗t , but, because of the strategic
behavior of traders, at the slowest possible rate.
    Markets of this type have been described in Kyle (1985) and Easley and O’Hara (1987). In
the following we discuss the cross-correlation function implied by the Kyle (1985) model. The
strategic behavior described by Kyle (1985) requires that exactly one trader is informed, or
that all informed traders build a monopoly and coordinate trading. Here, the market maker
does not maximize a particular objective function, he merely ensures market efficiency, i.e.
sets the market price such that it equals the expected strong form efficient price, pet , given
the observed aggregate trading volume from informed and uninformed traders. The only
optimizer in this model is the (risk neutral) informed trader who optimally spreads his orders
over the day to minimize the (unfavorable) price reaction of the market maker. Thereby he
maximizes his expected total daily profit using his private information and taking the price
setting rule ∆pt (Ωt ) of the market makers as given. Effectively, the informed trader trades
most when the sensitivity of prices to trading quantity is small.
    Kyle (1985) assumes a linear reaction function of the market maker, which implies λt = λ
∀t ∈ [1, T ], and a linear reaction function for the informed trader, which implies qt = q
∀t ∈ [0, T − 1]. Under these assumptions he shows that in expectation the market price
approaches the latent price linearly, not exponentially. The reason for this difference is that
the market maker in Easley and O’Hara (1992) updates his beliefs in a Bayesian manner,
whereas in Kyle (1985) the market maker’s actions are constrained to market clearing. The
other key feature of this model is that by the end of the trading day – just before p∗t would
be revealed – the market price reflects all information.
    From the continuous auction equilibrium in Kyle (1985) the price change at time t is

                                 e     p∗ − pe (t)
                              dp (t) =             dt + σdz, t ∈ [0, T ].
                                         T −t

The innovation term dz is white noise with dz ∼ N (0, 1) and reflects the price impact of
uninformed traders. This stochastic differential equation has the solution
                                                                       t
                                     T −t e
                                                                 Z
                               t                                             σ
                        p (t) = p∗ +
                         e
                                         p (0) + (T − t)                        dBs ,
                               T       T                           0       T −s

where dBs ≡ dz.24 The increments of the expected price over a discrete interval of time
  24
     The third term reflects uninformed trading. It has an expected value of zero, and the impact of this
random component increases during the early trading day and decreases lateron – its contribution to pe (t)
is therefore hump-shaped over time.



                                                   17
follow therefore
                                                  τ                           τ −1
                            ∆p∗0
                                              Z                          Z
                                                        σ                              σ
                   ∆peτ   =      + (T − τ )                dBs −                          dBs .   (23)
                             T                τ −1    T −s                0          T −s

   The following proposition presents the cross-correlations for the Kyle (1985) model.

Proposition 2 (Cross-correlations in the Kyle model)
  The contemporaneous cross-correlation in Kyle (1985) is
                                                            r
                                                                    T
                                 Corr (∆p∗t , ∆ut )        =−          ,
                                                                 T2 +1

the cross-correlations at displacements τ ∈ [1; T ] are
                                                            s
                                                                      1
                               Corr ∆p∗t−τ , ∆ut =
                                                      
                                                                                 ,
                                                                T (T 2    + 1)

and all higher order cross-correlations are zero.

    Proof: See Appendix B.2.
    The cross-covariance at nonzero displacements is positive because of market maker learn-
ing. It is constant because of the strategic behavior of traders, which spread new information
equally over time. This maximizes the time it takes the market maker to include the entire
strong form efficient price change in his quotes. The more periods, the more pronounced is
the negative contemporaneous cross-correlation, and the smaller are the cross-correlations
at nonzero displacements.
    We plot the cross-correlation function given by Proposition 2 in the second row of Figure
4. We show the cross-correlation function a Kyle (1985)-type model under modestly frequent
changes in the latent price (T = 5) in the left panel, and for more frequent changes (T = 2)
in the right panel. Table 1 compares standard multiperiod market microstructure mod-
els. In contrast to markets with nonstrategic traders, which display decaying lagged cross-
correlations (row 3), markets with strategic traders display constant lagged cross-correlations
(row 4).


3.3    One-Period Case
In this section we consider the extreme case of markets in which p∗t automatically becomes
public information at the end of each period, i.e. ωt = p∗t−1 − p̃et−1 and T = 1. This
allows us to investigate the impact of risk aversion for the cross-correlation pattern. p∗t−1

                                                      18
is thus known when the market maker decides on pt , and by (1) and (4) pet = p∗t − σεt .
The free distribution of information removes any incentive for informed traders to behave
strategically. They therefore react immediately, which implies E(qt−τ εt ) = 0 ∀τ 6= 0 and
trades are serially uncorrelated, i.e. E(qt |qt−1 ) = 0. For the market maker all periods are
identical, and therefore the spread and reaction parameters are both constant over time, i.e.
st = s and λt = λ ∀t.
    Because T = 1 the market maker’s recursive problem25 collapses to a sequence of single
period problems. This by itself pins down the shape of the cross-correlation function. By
(16) and (18) the cross-correlation at displacement one has the opposite sign and same
absolute value as the contemporaneous cross-correlation, and by (19) all cross-correlations
at displacements larger than one are zero.
    In order to pin down the contemporaneous cross-correlation, we now turn to specific
models.

3.3.1     No Market Maker Information

We start with our baseline assumption that the market maker at time t has no information
whatsoever about ∆p∗t . Plugging T = 1, st = s, and λt = λ, and thus φt = φ, into the
general multiperiod results derived in section 3.1 gives

Proposition 3 (Strong form cross-correlation, one period model)

                                              1     sE (qt εt ) − σ
                          Corr(∆p∗t , ∆ut ) = √ p                         ,             (24)
                                               2 φs2 + σ 2 − 2sσE(qt εt )

                              Corr(∆p∗t−1 , ∆ut ) = −Corr(∆p∗t , ∆ut ).


      Proof : See Appendix B.3.

   As the following Proposition 4 shows, if there is trading in every period (β = 1), and
thus φ = 1), then the cross-correlation (24) can be bounded from above and below.

Proposition 4 (Bounds of contemporaneous cross-correlation)

                                      1
                                   − √ ≤ Corr(∆p∗t , ∆ut ) ≤ 0
                                       2
 25
      See Appendix A.2.




                                                 19
Proof: See Appendix B.4.

    Note that the cross-correlation reaches the lower bound for zero spread. Thus for mid
prices, or extremely small spreads due to order splitting, the cross-correlation is highest. For
transaction prices the contemporaneous cross-correlation is less pronounced. The contempo-
raneous cross-correlation for mid prices is negative, because pmid
                                                                t   does not react at all to the
change in the strong form efficient price in the same period.26 It differs from negative unity
because market prices move in adjustment to the strong form efficient return one period
earlier.
    We summarize these results in the upper two rows of Table 2. Compared to the multi-
period case (T > 1) the absolute value of the cross-correlation at lag one is large, because
all information is revealed. Cross-correlations at any displacement beyond one, in contrast,
are all zero.

                          Table 2: Cross-Correlations in One-period Models

              efficient      spread        loss                   ρ0              ρ1        ρτ
                price                    function                                         τ >1
               strong          0           any                   − √12            √1
                                                                                    2
                                                                                            0
               strong         ≥0           any             − √12 ≤ ρ0 < 0        −ρ0        0
                                        high n +
               strong         ≥0                                ρ0 > 0           −ρ0        0
                                        extra info
            semi-strong  ≥0             quadratic         − √12 ≤ ρ0 ≤ √12       −ρ0        0
            semi-strong ∈ [0, λ[          any                ambiguous          ρ1 > 0      0
            semi-strong    λ              any                    0                 0        0
            semi-strong  ≥λ               any                ambiguous          ρ1 < 0      0

Notes: The upper half of the table reports ρτ = Corr(∆p∗t−τ , ∆ut ) under no extra market maker information
in rows 1 and 2, and under extra market maker information {sgn(εt )} in row 3. The lower half reports
ρτ = Corr(∆p̃t−τ , ∆ut ).




3.3.2    Incomplete Market Maker Information and Risk Aversion

Previously our market maker set prices knowing p∗t−1 but without information about the
strong form efficient return in period t. Now we show that under risk aversion the existence
of extra information about the direction of the change in the latent price, i.e. {sgn(εt )},
  26
    This is an instance of the price stickiness that Bandi and Russell (2006) show to generate “mechanically”
a negative contemporaneous cross-correlation.



                                                     20
can invert the cross-correlation pattern. Observing {sgn(εt )} before setting his price pmid t  ≡
pet allows the market maker to adjust the mid price before any informed trader can take
advantage of the latent price change. The market maker updates his prior belief about p∗t ,
summarized by the distribution p∗t ∼ f (p∗t−1 , σ 2 ), with the signal {sgn(εt )}. For convenience
of exposition we use

Assumption 2 The probability density function of εt is symmetric around its zero mean,
monotonically increasing on ] − ∞; 0] and monotonically decreasing on [0; ∞[.

    The updated distribution f˜(·) differs from f (·) in that it is truncated from below or
above at p∗t = p∗t−1 when sgn(εt ) > 0 or sgn(εt ) < 0, respectively. The left panels of Figure 5
illustrate the posterior distribution after observing the signal {sgn(εt ) = +1} and {p∗t−1 = 0}:
If the prior is a normal distribution, the posterior is given by the half normal in the upper left
panel. If the prior is a tent distribution, the posterior is given by the triangular distribution
in the lower left panel.

     Figure 5: Optimal Predictor p(n) under Half-Normal and Triangular Distributions
                                                                             Optimal Predictor p(n) at Risk Aversion n
                  (a) Half-Normal
                       Half−NormalDistribution
                                   Distribution                        (b) Optimal Predictor  for Half-Normal
                                                                                       su=0, so=80
            0.8                                                      2.5

            0.6                                                       2
    f(p*)




                                                              p(n)




            0.4                                                      1.5

            0.2                                                       1

             0                                                       0.5
              0      1        2         3        4   5                          5      10      15      20      25        30
                                   p*                                                           n

                                                                             Optimal Predictor p(n) at Risk Aversion n
                   (c) Triangular
                        TriangularDistribution
                                  Distribution                             (d) Optimal Predictor for Triangular
                                                                                          su=0, so=1
             2                                                       1.5

            1.5
                                                                      1
    f(p*)




                                                              p(n)




             1
                                                                     0.5
            0.5

             0                                                        0
              0      0.2     0.4        0.6   0.8    1                          5      10      15      20      25        30
                                   p*                                                           n


Notes: The left panels are two examples of market maker believes about the strong form efficient price
after observing {sgn(εt ) = +1}. The right panels show the corresponding optimal predictors, pmid√
                                                                                                 (n), as a
                                                                                                          σ             E(ε2 )
function of risk aversion n. The dotted line marks E(∆p∗t ), and the dashed line marks                 E(|∆p∗      =   E(|ε|) .
                                                                                                            t |)




                                                         21
   After observing this signal and p∗t−1 , the market maker quotes a bid and an ask price for
the following period, taking the spread s as given:

                                                 pt = p∗t−1 + sqt + R({sgn(εt )}).                                               (25)

This equation resembles (5), augmented by the market maker response function R(·) to the
extra information.27 The function R(·) depends in particular on the market maker’s risk
aversion, n.
   An approximation28 to the problem of choosing pmid
                                                  t   (n) based on loss function (11) is
                                                      Z   x                                  Z     p∗
                                                                       ∗ n
                 p   mid
                           (n) = argmax
                                    ∗ ∗
                                        −                     (x − p ) f (p )dp −∗      ∗
                                                                                                        (p∗ − x)n f (p∗ )dp∗ .   (26)
                                  x∈[p ,p ]            p∗                                      x


   For some values of n, explicit solutions to (26) are available, which we list in the following
proposition.

Proposition 5 (Optimal mid price)

                                                      pmid (1) = Median(p∗t )
                                                      pmid (2) = E(p∗t )
                                                  pmid (∞) = Midsupport(p∗t ).


    Proof: See Appendix B.5.
    The higher the risk aversion n, the more sensitive is the expected loss, Ln pt , F (·, p∗ , p∗ ) ,
                                                                                                    

to the support of p∗t , that is, to p∗ and p∗ . A well-known result is that the optimal choice
for a risk neutral market maker (n = 1) is to set pmid
                                                     t    equal to the median of f (·), and for a
modestly risk averse market maker (n = 2) to the mean. An extremely risk averse (n → ∞)
market maker follows the most robust pricing role possible: He minimizes his expected loss
                                                              p∗ +p∗
at the price in the middle of the support of f (·), i.e. pt = 2 .
    The right panels of Figure 5 illustrate this. They plot the market price as a function of
risk aversion n and show that as risk aversion n grows, pmid (n) moves monotonically from the
median of f (·) to the midpoint of the support of f (·).29 The upper right panel shows this for
  27
       The release of p∗t−1 is captured by ωt = p∗t−1 − pt−1 + (st−1 − λt−1 )qt−1 .
  28
       This approximation is exact for s = 0 or, more generally, for
                 Z    pmid (n)                                           Z    pmid (n)+s
                                                  ∗ n          ∗   ∗
                                                                                                         n
                                      mid
                                                                                            p∗ − pmid (n) f (p∗ )dp∗ = 0.
                                                   
                                  p         (n) − p       f (p )dp +
                     pmid (n)−s                                              pmid (n)


  29
       See Appendix D for details.


                                                                         22
a right-skewed distribution f (·) with infinite support, namely the halfnormal distribution.
Indeed, pmid (n) increases in n, starting from the median for n = 1, monotonically without
bound. If, in contrast, f (·) has finite support, then pmid (n) increases from the median
monotonically toward a finite asymptote pmid (∞).30 This is shown in the lower right panel
of Figure 5 for the triangular distribution defined on [0, 1]. We use these observations in the
proof of the following proposition:

Proposition 6 (Cross-correlation under market maker information)
    If Ωt = {sgn(εt ), p∗t−1 } and Assumption 2 holds, then the optimal market maker response
R({sgn(εt )}) strictly increases in risk aversion, n ≥ 1, without bound. If, further, the
distribution of the expected latent price with support [p∗ , p∗ ] satisfies

                                   p∗t + p∗t
                                                          
                                                                                  σ
                                               −   p∗t−1       sgn(εt ) > s +            ,             (27)
                                      2                                         E(|εt |)

then ∃n0 > 1 such that ∀n > n0 it holds that Corr(∆p∗t , ∆ut ) > 0.

       Proof: See Appendix B.6.

    Condition (27) holds, for example, for normally distributed ∆p∗t , but not for tent dis-
tributed ∆p∗t .
    Comparing these results in the third row of Table 2 with the other model setups, it
appears that even though the contemporaneous cross-correlation can be positive for high
risk aversion levels, the usual case is that it is negative. For the halfnormal distribution in
the upper left panel of Figure 5, for example, we need a rather high risk aversion of n ≥ 8.
Nevertheless, changes in risk aversion of the market maker have a distinctive impact on the
cross-correlation. Hansen and Lunde (2006) note as their “Fact IV” that “the properties of
the noise have changed over time.” Because they base this observation on a comparison of
year 2000 with year 2004 it is possible that the underlying cause is a change in risk aversion.
    The link between properties of noise and risk aversion offers itself as a way to estimate
the time path of risk aversion from the cross-correlation pattern of market prices. In stable
periods with low risk aversion the contemporaneous cross-correlation is negative, but as
uncertainty shoots up, contemporaneous cross-correlation shoots up with it. In periods of
crisis this can lead to the extreme case of an inverted cross-correlation pattern that we have
described in this section. The lower row of Figure 4 illustrates this inversion: it shows the
typical cross-correlation pattern of strong form efficient prices in a one-period model with
modest risk aversion on the left, and under higher risk aversion on the right.
  30
   Analogously, for left-skewed distributions with infinite support, pmid (n) decreases in n from the median
monotonically without bound, and with finite support toward a finite asymptote pmid (∞).


                                                               23
   The negative contemporaneous cross-correlation in Hansen and Lunde (2006) indicates
that during their sample period the risk aversion of market makers was rather low.31


3.4     Frequent Price Changes
Until now we discussed models, where the old strong form efficient price becomes public
information before any new shift in the latent price. In general, however, the latent price
may change again before the old latent price becomes fully publicly known. In this case
the old p∗t−1 still contains unrevealed information about the new p∗t . As p∗t−1 is not precisely
known itself, potentially the entire history of market prices contains information about p∗t .
    More specifically, suppose that at any point in time the T most recent changes in the
strong form efficient price are private information. The signal {sgn(pt − p∗t )} is now different
from the signal {sgn(εt )}. Under the former signal and with Corr(p∗t , ∆p∗t−τ ) > 0 ∀τ > 0
the information set Ωt contains information about p∗t−τ not contained in Ωt−1 . By (10) the
signs of the cross-correlations at nonzero displacements remain unchanged even if p∗t changes
frequently. All that is needed is that in expectation market price changes in t are affected by
latent price changes in t − τ , τ > 0, by learning. The more often p∗t changes during [t, t − τ ],
the closer to zero is the cross-correlation Corr(p∗t , ∆p∗t−τ ), the less informative is the signal
in t about ∆p∗t−τ , and thus the closer to zero is the cross-correlation between latent returns
and noise. For both signals the contemporaneous cross-correlation is dampened toward zero,
because the signal {sgn(pt −p∗t )} mixes up information on ∆p∗t with information on ∆p∗t−τ , and
the signal {sgn(εt )} is related only to a small component of ∆ut . Overall, slowly decaying
private information keeps the cross-correlation sign pattern unchanged, but dampens its
absolute values toward zero.
    In summary we have shown in this section that many market properties leave their mark
on the cross-correlation pattern: The displacement beyond which correlation is zero gives an
indication of the frequency of information events. The larger the correlation is in absolute
value terms the fewer uninformed trades occur in the market. If contemporaneous strong
form cross-correlation is high and positive, then market makers are very risk averse and
have access to extra information. If the cross-correlations at nonzero displacements decay
  31
    Note that in this section from the point of view of the market maker all periods are ex ante identical.
Every period the market maker gets the same type of new information (p∗t−1 , and either sgn(εt ) = 1, or
sgn(εt ) = −1), thus st is the same in every period. Only a small change in the model allows for time
variation in spreads (Demsetz, 1968). If – contrary to the maintained assumptions – we assigned nonzero
probability mass to the information event {sgn(εt ) = 0} and kept V ar(εt ) = 1 by moving probability mass to
the tails of the distribution, then observing this signal would ensure the market maker of no informed trading
in this period. Therefore, the competitive spread in this period would be zero. A subsequent sgn(εt ) = ±1
then would not only trigger a shift in pmid
                                          t  , but also an increase in spread.



                                                     24
quickly, then market makers learn fast. If they do not decay at all, then informed traders
act strategically.


4       Return/Noise Cross-Correlations in Economic Envi-
        ronments II: Semi-Strong Efficient Prices
Now we base the cross-correlation calculation on another latent price, the semi-strong form
efficient price, p̃t . Equivalently we could interpret this setup as an endogenous latent price
process, determined by an exogenous trading process qt , because the strong-form efficient
price remains unobserved and enters the model only via the informed trades. This setup is
closely related to the generalized Roll (1984) bid-ask model in Hasbrouck (2007).


4.1       The General Multi-Period Case
In the period of a change in the strong form efficient price, in which also the previous strong
form efficient price becomes public information, the semi-strong form efficient return is32

                                                      T
                                                      X
                           ∆p̃e0   = λ0 q0 + σε−T −          (λ−i q−i + ω−i ) + ω0 ,
                                                       i=1


where the first term reflects the market maker’s guess about the new strong form efficient
return based on a trade, the second term internalizes the new information about the previous
return, and as a countermove the sum undoes the now obsolete guesses about the previous
return. In all other periods the semi-strong form efficient price changes by

                                              ∆p̃et = λt qt + ωt .

      From (8) we get for ∀t

                                   ∆ut = (st − λt )qt − (st−1 − λt−1 )qt−1 ,                      (28)

where the first two terms reflect information-revealing trades, and the second two terms
reflect the bid-ask bounce.
    Using Assumption 1 this immediately leads to an expression for the contemporaneous
covariance33
 32
      We use again the shorthand notation p0 ≡ pκT ∀κ ∈ Z, and likewise p−x ≡ pκT −x ∀κ, x ∈ Z.
 33
      To keep the terms manageable, we assume no extra information here, i.e. ωt = 0 ∀t.



                                                      25
                               1
           Cov(∆p̃et , ∆ut ) =   {−φ0 λ0 (λ0 − s0 ) + σ(λ−1 − s−1 )E(q−1 ε−T )
                               T
                               −T
                               X
                             −    (λ−1 − s−1 ) λi E(qi q−1 )
                                   i=−1
                                   T −1
                                                                                          )
                                   X
                             +            (−φi λi (λi − si ) + λi (λi−1 − si−1 )E(qi qi−1 )) ,   (29)
                                   i=1


for covariance at higher displacements τ ∈ [1, T − 1]

                                 1
           Cov(∆p̃et−τ , ∆ut ) =   {−λ0 (λτ − sτ )E(q0 qτ )
                                T
             + λ0 (λτ −1 − sτ −1 )E(q0 qτ −1 ) + λT −τ (λT −1 − sT −1 ) E(qT −τ qT −1 )
                T −1
                                                                                        )
                X
             +        [λi−τ (−λi + si )E(qi−τ qi ) + λi−τ (λi−1 − si−1 )E(qi−τ qi−1 )] ,         (30)
                 i=τ +1


for covariance at displacement T

                                                1
                      Cov(∆p̃et−T , ∆ut ) =       λ0 (λT −1 − sT −1 ) E(q0 qT −1 ),              (31)
                                                T

and for all higher order displacements τ > T

                                          Cov(∆p̃et−τ , ∆ut ) = 0.

    Under semi-strong market efficiency (st = λt ∀t) the cross-correlation function is zero
for all displacements. Hence all of the special cases that we now discuss assume lack of even
this weak form of market efficiency.


4.2    Special Multi-Period Cases
The cross-correlations for semi-strong form efficient prices stem from a gap between the
spread, st , and the adverse selection parameter, λt . Such a gap can result from processing
costs (st > λt ), from legal restrictions (st < λt ), or merely from suboptimal behavior of
the market maker. Noisy signals or strategic behavior do not affect the semi-strong cross-
correlations – all what matters is that the market maker’s knowledge passes into market
prices one-to-one.
    In Easley and O’Hara (1992), for example, prices are semi-strong form efficient by defi-
nition, and therefore the semi-strong form cross-correlation function is zero always.

                                                    26
       The Kyle (1985) model assumptions λt = λ and st = s ∀t give with (30)

                                                                 T −1
                                             (                                                     )
                                  λ(λ − s)                       X
          Cov(∆p̃et−τ , ∆ut ) =              E(qT −τ qT −1 ) +          [E(qi−τ qi−1 ) − E(qi−τ qi )] .
                                     T                           i=τ


If λ = 0, then this cross-correlation is flat at zero. Likewise, if additionally E(qi−τ qi ) is
a positive constant between the time of the latent price change and its announcement,
the cross-correlation is flat and proportional to λ(λ−s)T
                                                           . More generally, because typically
E(qi qj ) > E(qi−τ qj ) > 0 ∀i ≤ j, ∀τ > 0, the cross-correlation decreases in τ .


4.3       One-Period Case
The simpler case of markets in which all information is revealed after one period without
any extra information, i.e.
                               ∆p̃et = λ(qt − qt−1 ) + σεt−1                         (32)

offers itself again for illustration of these cross-correlation effects. In the one period case the
semi-strong form efficient prices follow a martingale, but unlike their strong form counterpart
the semi-strong form efficient returns do not follow a martingale difference sequence.34 We
see in the following proposition that in contrast to the strong form correlations, the absolute
value of semi-strong form cross-correlation at displacement zero and one usually differs.

Proposition 7 (Semi-strong form cross correlation, one-period model)
  The contemporaneous cross-correlation is

                                               2φλ − σE(qt εt )      sgn(s − λ)
                     Corr(∆p̃et , ∆ut ) = p                             √       .
                                           σ 2 − 2σλE(qt εt ) + 2φλ2      2φ

The cross-correlation at displacement one equals

                                                     −φλ              sgn(s − λ)
                    Corr(∆p̃et−1 , ∆ut ) = p                             √       .
                                            σ 2 − 2σλE(qt εt ) + 2φλ2      2φ

All cross-correlations at higher displacements are zero.

       Proof: See Appendix B.7.

  Bounds on the contemporaneous cross-correlation can be obtained by assuming a specific
market marker loss function and then solving for the market maker’s optimal λ. For example,
  34
    In multiperiod models strong form efficient prices follow a martingale, but semi-strong form efficient
prices do not.


                                                    27
suppose the market maker has a quadratic loss function, then

                                     λopt = argmin E (p̃et − p∗t )2 ,
                                                                  
                                               λ


which becomes
                                  λopt = argmin φλ2 − 2σλE (qt εt ) ,
                                           λ

and therefore λopt = σφ E (qt εt ) > 0. At λopt we have

                                                                sgn(s − λopt )
                               Corr(∆p̃et , ∆ut )   = E(qt εt )     √          ,
                                                                      2φ

                                                                 sgn(s − λopt )
                             Corr(∆p̃et−1 , ∆ut ) = −E(qt εt )       √          ,
                                                                       2φ
and because 0 ≤ E (qt εt−τ ) < 1, ∀t, ∀τ.35

                                                                         1
                          |Corr(∆p̃et , ∆ut )| = Corr(∆p̃et−1 , ∆ut ) ≤ √ .
                                                                         2φ

Under a quadratic market maker loss function and an uninterrupted flow of trades (φ = 1),
the absolute value of cross-correlations is bounded from above by √12 .
    Proposition 7 shows that the size of the spread matters only relative to the adverse
selection parameter. The cross-correlation at displacement one, for example, is negative if
and only if the spread exceeds the adverse selection cost. s > λ is reasonable, because the
spread must cover the order processing cost. It also entails, however, that the average trader
in expectation incurs a loss with every transaction. Hasbrouck (2007) justifies this with the
liquidity needs of traders.
    The sign of contemporaneous cross-correlation is ambiguous in general. As in Diebold
                                                                               σ
(2006), no matter what loss function applies, for s sufficiently large and λ > 2φ E(qt εt ) = λopt
                                                                                               2
the model predicts a cross-correlation pattern that is the opposite of the empirical pattern
in Hansen and Lunde (2006). We illustrate this again in the last row of Figure 4, which on
the left shows the cross-correlation function for a relatively small spread (0 ≤ s < λ), and
on the right for a typical, wider spread (s > λ > 0). If sufficiently many lags are included,
the Hansen and Lunde estimator is unbiased for the strong form efficient price defined as in
(1) and (2), but by construction not for its semi-strong form counterpart.
 35
      See equation (38) in Appendix A.2.




                                                      28
    All it takes to generate such a large spread without violating the market maker’s zero-
profit condition is high risk aversion. By the same reasoning as in section 3.3.2,36 there
exists a minimal risk aversion level n0 such that all n > n0 generate a spread s > λ.
                              σ
Thus if additionally λ > 2φ     E(qt εt ), then there exists n0 such that all n > n0 generate a
positive contemporaneous cross-correlation and a negative cross-correlation at displacement
one. Note that unlike for the strong-form efficient prices discussed in section 3.3.2 positive
contemporaneous cross-correlation for semi-strong form efficient prices obtains even though
the market maker does not observe a signal. We summarize the results in the lower four
rows of Table 2.
    Summing up, what sign of contemporaneous cross-correlation does market microstruc-
ture theory predict? Positive contemporaneous cross-correlations occur for (1) strong form
efficient prices under sufficiently high risk aversion if a signal is observed, and (2) semi-strong
form efficient prices for large spreads. Various market arrangements and sampling speeds
can dampen the contemporaneous cross-correlation to zero, but the negative sign main-
tains except in the two aforementioned cases. Bandi and Russell (2006) and Diebold (2006)
rightly wonder whether a negative cross-correlation is inevitable. In contrast to Hansen and
Lunde (2006), Bandi and Russell (2008) find no “obvious evidence of a significant, negative
correlation.” These seemingly contradictory results might stem from the inability of purely
statistical estimators to clearly distinguish strong form from semi-strong form efficient prices.
Without controlling for market features, which the realized volatility literature so far largely
ignores, the estimate may pick up any of the two prices. As we have seen, a positive cross-
correlation is possible, but a negative cross-correlation appears most realistic for strong form
efficient prices.


5      Additional Discussion
We have already drawn some econometric implications insofar as we have shown that market
microstructure models predict rich cross-correlation patterns between latent prices and mi-
crostructure noise, which have yet to be investigated empirically. Here we go farther, sketch-
ing some specific aspects of such empirics, including the relationship between theory-based
and data-based (sample) cross-correlation functions, strategies for using microstructural in-
formation to obtain improved “structural” volatility estimators, and comparative aspects of
structural and non-structural volatility estimators.
  36
    The spread affects the market maker price conditional on the trade direction, thus the market maker
belief conditional on the trade direction is truncated on one side at pet .




                                                  29
5.1    Effects of Sampling Frequency on Return/Noise Correlations
We have thus far focused on sampling at the rate corresponding exactly to the market maker’s
reaction time. Sampling at faster or slower rates will affect the shape of cross-correlation
functions. This has immediate implications for the shape of empirically estimated (sample)
cross-correlation functions, because the reaction speed of the market maker is generally
unknown, so that econometric sampling may proceed at faster or slower rates.
   Consider first the effects of sampling “too fast.” Suppose we sample m times during
an interval of no changes in both latent and market prices, and record each time the most
recently realized prices. Then all returns except for the first one are zero and thus the
cross-correlation function becomes a spread-out version of the cross-correlation functions
derived in the previous sections: after each non-zero cross-correlation follow m − 1 zero
cross-correlations, as in the second row of Table 3. Zeros in the middle of a cross-correlation
function thus indicate overly fast sampling.

            Table 3: Cross-Correlation Patterns at Various Sampling Frequencies

          sampling rate                        cross-correlation function                note
                                      τ =0        1      2      3     4       5
           optimal                      ρ0       ρ1     ρ2      ρ3    ρ4      ρ5
   > latent price frequency             ρ0       0      0       ρ1    0       0
 > market maker update freq.           ρM
                                        0
                                           M
                                                 0     ρM
                                                        1
                                                           M
                                                                0    ρM
                                                                      2
                                                                         M
                                                                              0     ρM
                                                                                     i
                                                                                        M
                                                                                          > ρi ∀i
   < latent price frequency             ρSL
                                         0      ρSL
                                                 1      ρSL
                                                         2     ρSL
                                                                3     ρSL
                                                                       4     ρSL
                                                                              5
                                                                                       SL
                                                                                     ρi < ρi ∀i



   A variant of sampling “too fast” is sampling exactly at trading frequency, but with a
market maker in the background who updates pet infrequently, for example only every second
period. After a latent price change at t = 0, he updates his quotes for the first time at
t = 2, and then, observing the trades in between, again at t = 4, t = 6, and so forth. The
expected noise pattern is therefore −∆p∗t , 0, ∆p2 , 0, ∆p4 , . . .. Trading activity in the interim
period provides information about ∆p∗t and thus ∆p2 is more correlated with ∆p∗t than under
period-by-period updating. But because the quote in the interim period is fixed, the two
periods together provide less additional information than under period-by-period updating.
Whereas the variance of ∆p∗t is unchanged, the (unconditional) variance of noise shrinks to
somewhat more than half the variance that obtains when the market maker updates pt every
period. The cross-correlation function therefore oscillates, as in the third row of Table 3.
   Now consider the effects of sampling “too slowly”. Suppose, for example, that in the
one-period model of section 4.3 we sample only every n-th tick, where t̂ indexes the n-tick

                                                  30
blocks. Then (32) becomes

                                    t̂n
                                    X                                                t̂n−1
                                                                                      X
                    ∆p̃et̂   =                 ∆p̃ei   = λ(qt̂n − q(t̂−1)n ) + σ               εi ,
                                 i=(t̂−1)n+1                                       i=(t̂−1)n


and the variance increases to V ar(∆pet̂ ) = 2φλ2 +nσ 2 −2λσE(qt εt ). Assuming that the statis-
tical properties of the interim periods are the same as the properties of the sampled periods,
the expressions for noise (28), its variance V ar(∆ut̂ ), and the covariance Cov(∆p̃et̂ , ∆ut̂ )
remain unchanged. Thus

                                     2φλ − σE(qt εt )
        |Corr(∆p̃t̂ , ∆ut̂ )| = √ p                            < |Corr(∆p̃t , ∆ut )| ,
                                 2φ nσ 2 − 2λσE(qt εt ) + 2φλ2

so that increasing the sampling interval averages the initial market price reaction with later
price changes, thereby dampening the entire cross-correlation pattern toward zero. The most
informative cross-correlations are therefore obtained by sampling sufficiently fast to capture
every tick separately. Hansen and Lunde (2006) find a negative contemporaneous cross-
correlation between returns and noise, which diminishes as more ticks are combined into
one market price sample. Our results show that this can stem from two different sources:
Either from the averaging effect across latent price changes just described, or from cross-
correlations at nonzero displacements offsetting the contemporaneous correlation for the
same latent price change. This ambiguity can be resolved by evaluating the entire cross-
correlation function, especially its cutoff, which shows the importance of not limiting noise
analysis to the contemporaneous cross-correlation.
    The upshot is that sampling frequency does not change the sign pattern of cross-correlati-
ons but can severely impact their absolute values, as summarized in Table 3. At low sampling
rates the cross-correlations become empirically indistinguishable from zero, whereas at higher
sampling frequencies the cross-correlation structure of the noise needs to be addressed. In
the next section we suggest strategies for doing so in parsimonious fashion by exploiting
market microstructure theory.


5.2    Structural Volatility Estimation via Microstructural Restric-
       tions
In the introduction we highlighted the key issue of estimation of integrated volatility (IV )
using high-frequency data, the potential problems of the first-generation estimator (simple
realized volatility – RV ) in the presence of MSN, and subsequent attempts to “correct” for


                                                           31
MSN.
    In an important development, Hansen and Lunde (2006) suggest making RV robust to
serial correlation via HAC estimation methods, which are asymptotically justified under
very general conditions. That asymptotic generality is, however, not necessarily helpful in
finite samples. Indeed the frequently unsatisfactory finite-sample performance of nonpara-
metric HAC estimators leads Bandi and Russell (2010) to suggest sophisticated alternative
statistical approaches.
    Here we explore aspects of a different approach that specializes the estimator in accor-
dance with the implications of market microstructure theory. As we have seen, dynamic
market microstructure models imply that noise decays geometrically over time after dis-
placement one, with two polar cases of immediate decay (as in section 3.3) and no decay (as
in section 3.2.2). That knowledge can be used to construct volatility estimators that exploit
the restrictions implied by market microstructure theory37
    Consider first a “bid-ask bounce estimator”, based on a one-period model without extra
information and constant spread. The only action in the market price is then the bid-ask
bounce. Suppose we are interested in the volatility of the strong form efficient price. From
(4) and (5) we obtain ∆pt = ∆p∗t + ∆ut with ∆ut = σ(εt−1 − εt ) + s(qt − qt−1 ). It follows
that
              E (∆p∗t )2 = E (∆pt − ∆ut )2 = E ∆p2t + 2s (σE(qt εt ) − φs) .
                                                    

Simple calculations reveal that the last term equals twice the first-order autocorrelation of
market returns, so that, even if E(qt εt ) 6= 0, a consistent estimator for IV of the strong form
efficient price is38

                                      IV
                                      c = RV + 2E(∆pt ∆pt−1 ).                                           (33)

It is interesting to note the resemblance to the Roll (1984) estimator.
    As another example, consider a “learning estimator”. Suppose ∆pt follows an MA(∞)
process in the innovations for the latent price,

                                                          ∞
                                                                            !
                                                          X
                                    ∆pt = σ α1 εt +              α2τ εt−τ       .                        (34)
                                                          τ =1
  37
     We do not claim optimality; instead we show the practical relevance of tailoring the estimator to the
market at hand. As emphasized before, optimality of a RV estimate must be defined relative to the user’s
objective.
  38
     Hasbrouck (1993) and recently Hansen et al. (2008) show how to embed (33) into general moving av-
erage (MA)-based estimators. Such general MA-estimators are warranted if the researcher has only limited
information about the microstructure of the market or has interest different from IV estimation, such as fore-
casting the latent price process. If, however, the microstructure is known and interest centers on estimating
IV, as we assume here, then our estimator may be more appealing.

                                                     32
This form of ∆pt accommodates very persistent cross-correlations, similar to the idea behind
the sequence of examples in Oomen (2006). If our knowledge of the market is this compre-
hensive, we can obtain a consistent estimate for IV = σ 2 from (34) in a GMM framework
using three moments.39 For example, a learning model with T = ∞ and frequent latent price
changes might predict
                                 ∞
                                 X                                                         ∞
                                                                                           X
                                             −rτ        −r(τ −1)                  r
                                                                                                  e−rτ εt−τ .
                                                                   
             ∆pt ≈ 0 · σεt +            −e         +e                  σεt−τ = σ (e − 1)
                                 τ =1                                                      τ =1


The IV (= σ 2 ) can then be consistently estimated directly by GMM. The resulting estimate
of IV is a scaled version of standard RV 40

                                                      1 − e−2r̂
                                        IV
                                        c =                          · RV,                                      (35)
                                                   1 − 2e−r̂ + e−2r̂

where the scaling factor requires a consistent estimator of only one parameter, the market
maker’s learning rate, r.
   The expression for IV c in (35) offers a structural interpretation to estimates of noise
and IV, such as those in Table 3 of Hansen and Lunde (2006). The model of Easley and
O’Hara (1992) predicts that the noise decreases with the learning rate. Slow learning implies
a very persistent cross-correlation between noise and latent returns, and hence persistent
autocorrelation of noise, so that fluctuations in noise tend to dominate the IV.41
   Figure 6 provides some perspective. It is based on the noise-to-IV ratios reported by
Hansen and Lunde (2006), which are (unfortunately) derived under the assumption of inde-
pendent noise. The ratio of noise to IV shrinks with the number of price-changing quotes
per day. If the number of times that the market maker changes his price quote during a
trading day is indicative of his speed of learning, then MSN indeed decreases as the learning
rate of the market maker increases. Thus, even though these ratios may not be directly
applicable, they seem to support the multiperiod learning model.
   Furthermore, the recent decline in noise-induced bias of RV (Hansen and Lunde’s fact III)
suggests that the learning rate r has increased. Meddahi’s (2002) finding that the standard
  39
     The proof, which we sketch here,
                                  √ is straightforward. Recast the price process (1) and (2) in continuous
time, so that ∆pt = ∆p∗t + ∆ut / m, with m denoting the number of subintervals, tm equal to one unit of
calendar time, and the scale of t suitably redefined. Then under standard assumptions r is invariant to m
and local infill asymptotic theory can be applied.
  40
     Hansen et al. (2008) present an estimator of IV which, like (35), is a scaled variant of RV. The key differ-
ence between the two estimators is that we exploit (that is, condition on) the relevant market microstructure,
whereas Hansen et al. (2008) attempt to achieve robustness to a wide range of possible microstructures.
  41
     Kelly and Steigerwald (2004) take this a step further by linking information persistence and frequency
with the difference between prices and trades in the decay rate of autocorrelations.



                                                           33
deviation of the bias is large relative to the IV suggests that the learning rate itself may
have fluctuated considerably around its increasing trend.

       Figure 6: Ratio of Noise to Integrated Variance, as a Function of Quotes per Day




Notes: The vertical axis measures the noise-to-signal ratio as 100 times noise divided by IV under the
assumption of independent noise. The horizontal axis gives the number of quotes per day with a price
change. Data are for 30 NYSE and NASDAQ equities in 2000, obtained from Hansen and Lunde (2006)
Tables 1 and 3. The solid line is a fitted trend.

    Table 4 reveals that both the learning and bid-ask estimators explain at least one third
of noise. Learning appears to be very fast for the Alcoa stock (high r), which implies quick
decay of the MA terms, such that essentially only the MA(1) term matters. As a result
the learning and bid-ask volatility estimates are very similar. Based on this evidence, the
MA(1) captures both the learning and bid-ask bounce effects.42 These are the two most
common microstructure effects, which we indeed want to remove. But what about the
other two thirds of the “noise”? It is not clear whether the difference between the bid-
ask and Hansen-Lunde estimates, say, is really “noise”, unless one has in mind a distorting
microstructure effect other than learning and bid-ask bounce. Hence our perspective warns
against removing “noise” from a volatility estimate when the noise does not have a plausible
noise interpretation.
  42
    All estimators in the table except the standard estimator allow for correlation between noise and latent
price. The bid-ask bounce we remove thus includes both uninformed and informed components. The
uninformed component alone can be calculated by taking s directly from the difference between bid and ask
in the data, and φ as the number of seconds with a trade or quote.




                                                    34
                      Table 4: Comparison of Realized Volatility Estimators

                           RV estimator            price     mid      bid       ask
                            RVStandard             2.487    1.601    2.726    2.679
                            RVLearning             2.373    1.544    2.525    2.477
                            RVBid−ask              2.370    1.543    2.517    2.468
                          RVHansen−Lunde           2.142    2.138    2.250    2.253
                           RVSemi−strong           2.258    1.517    2.352    2.297

Notes: The price data are second-by-second for Alcoa Inc. (AA) in 2004, from Barndorff-Nielsen et al.
(2009). RVStandard is simple realized volatility, ∆p2t . RVLearning is the strong form efficient price estimator
under asymmetric information, and RVBid−ask is the strong form efficient price estimator accounting for
a non-zero spread, as described in section 5.2. RVHansen−Lunde is the statistical estimator of Hansen and
Lunde (2006). RVSemi−strong is the semi-strong form efficient price estimator as defined in section 5.3.


5.3     On Structural vs. Non-Structural Volatility Estimators
Here we emphasize that the more the econometrician knows about the price process of
relevance, the more the noise correction can be tailored to it by exploiting microstructure
theory. This is important, because as discussed in section 2, the price process of interest may
differ across users of volatility estimates (e.g., many users are likely to be interested in price
processes different from (1), which has implications for appropriate volatility estimation.
The estimate of the volatility of strong form efficient return, (20), the theoretical price under
full information, differs both conceptually and numerically from the volatility of semi-strong
form efficient returns,

                                                      !2                       
                            T −1               −T                −T
                    1      X                  X                 X                
      E (∆p̃et )2 =    σ2 +      φi λ2i + E 
                
                                                   λi qi  − 2σ      λi E(qi ε−T ) ,                       (36)
                    T      i=0               i=−1              i=−1
                                                                                  

which is the volatility that affects the balance sheet of the market maker. Thus studies of
market maker behavior should be based on a RV estimate E [(∆p̃et )2 ], not E [(∆p∗t )2 ]. For
example, consider again T = 1, in which case strong form volatility (20) is σ 2 and semi-strong
volatility (36) simplifies to

                              E (∆p̃et )2 = σ 2 + 2φλ2 − 2σE(qt εt ) 6= σ 2 .
                                        


But the RV estimator promoted by Hansen and Lunde (2006) is

                                 1tick
                               RVAC 1
                                       = ∆p2t + ∆pt−1 ∆pt + ∆pt ∆pt+1 ,

                                                      35
which for T = 1 is

       1tick
               = E [(s(qt − qt−1 ) + σεt−1 ) × (σ(εt + εt−1 + εt−2 ) + s(qt+1 − qt−2 ))] = σ 2 .
             
   E RVAC 1



                       1tick
Hence although RVAC       1
                             is unbiased for σ 2 , it is in general biased with ambiguous direction
for V ar(∆p̃et ), because by construction a noise-robust estimator with lag window T correctly
removes any microstructure and other correlation effects. For this estimator to work, the
latent price process of interest must follow a martingale difference sequence (MDS). Even
though semi-strong form prices with T = 1 form a martingale, their returns are not an MDS.
                                                       1tick
They are serially correlated and inevitably RVAC          1
                                                             is biased relative to V ar(∆p̃et ).
    Consider, for example, a “semi-strong form efficient price estimator”. We work in a one-
period model without extra information and constant spread, but we are now interested in
the volatility of the semi-strong form efficient price. From (4) and (5), using (32), we obtain
∆pt = ∆p̃et + ∆ut with ∆ut = σ(εt−2 − εt−1 ) + s(qt − qt−1 ) + λ(−qt + 2qt−1 − qt−2 ). It follows
that
                                 E (∆p̃et )2 = E ∆p2t + 2sφ(λ − s).
                                                        

One can show that the last term equals twice the difference of the first- and second-order
autocorrelations of market returns; hence a consistent estimator for IV of the semi-strong
form efficient price is

                        c = RV + 2 [E(∆pt ∆pt−1 ) − E(∆pt ∆pt−2 )] .
                        IV                                                                     (37)

The obvious difference between (33) and (37) emphasizes the importance of carefully defining
the latent price series of interest. Note also that whereas sampling only every second price
would remove all microstructure noise from the RV estimate of the strong form efficient
price in (33) (and thus IV c bae = RV ), it would not remove all noise from the RV estimate
of the semi-strong form efficient price (37), because E(∆pt ∆pt−2 ) = s(σE(qt εt ) − φλ) 6= 0.
    We show estimates for the volatility of semi-strong form efficient prices in the bottom
row of Table 4. The strong form efficient price estimator (i.e., the bid-ask estimator) would
overstate the volatility of semi-strong form efficient prices by five percent or more. This
emphasizes quantitatively the potential importance of tailoring the noise correction to the
latent price of interest.
    In this paper we model the strong form efficient price as an MDS, and indeed this latent
price series is of interest on its own. We doubt, however, that this is the unique latent price
of interest in volatility estimation. Efficient prices from an informed trader’s perspective



                                                36
could themselves be seen as the result of a learning process about the state of the economy,43
which implies that the p∗t of interest is often not an MDS, but instead has the properties
that we have derived in this paper for the semi-strong form efficient price p̃t .
   Suppose, for example, that the strong form efficient prices violate (2) and are themselves
the result of learning by informed traders about fundamentals, ηt , which follow a random
walk,
                                    X T
                               ∗
                                          −e−r1 τ + e−r1 (τ −1) ηt−τ .
                                                               
                            ∆pt = σ
                                          τ =1

Suppose as well that market prices follow the usual process of market maker learning,

                                        T
                                        X
                                               −e−r2 τ + e−r2 (τ −1) ∆p∗t−τ .
                                                                    
                                ∆pt =
                                        τ =1

                                     1tick
Then mechanically calculating RVAC(T       ) gives the variance of the fundamental, not the vari-
ance of the strong form efficient price. Obviously, a purely statistical noise correction cannot
distinguish between cross-correlation caused by fundamentals and cross-correlation caused
by MSN.44 This is where market microstructure theory can contribute new insights to RV
estimation. By providing distinctive but flexible relationships between noise and latent re-
turns, we can decompose the agnostic statistical noise estimate into its various components,
such as MSN and fundamental correlation in the strong form efficient price (in our example
discussed previously). Our example uses a MA(2T ) process with only two free coefficients,
but the large sample sizes typical with high frequency data can accommodate much richer
specifications. Empirical work in market microstructure tends to favor extreme parametriza-
tions, ranging from the very parsimonious as in the regressions of Glosten and Harris (1988),
to the profligate as in the vector autoregressions of Hasbrouck (1996). For RV noise correc-
tion the most useful parametrizations may be intermediate, imposing a general correlation
pattern but avoiding highly situation-specific assumptions.
  43
     Also, they might be the result of learning about information of other market participants, as in Foster
and Viswanathan (1996).
  44
     Standard RV is unbiased if sampling frequency is sufficiently low so that microstructure effects are
averaged out. In a volatility signature plot for our dataset (see the upper panels for 2004 of Figure 1 in
Hansen and Lunde (2006), up to 30 minute sampling cycle duration) the standard RV seems to decline with
sampling frequency. RVACN W (30) deviates considerably from the low frequency level of standard RV, and
thus whereas it might remove high-frequency noise, it appears biased at small frequencies, at least in small
samples. Thus “noise-corrected” RV estimators should only be applied to data sampled at frequencies at
which microstructure effects can conceivably exist, e.g. above 0.01 per second. Applying them to data at
lower frequencies results in biased estimates, because at lower frequencies slow moving features of the price
process are removed, not microstructure noise.




                                                     37
6      Concluding Remarks
The recent realized volatility literature provides statistical insights into microstructure noise
(MSN) and its effects. In this paper we have provided complementary economic insights,
treating MSN not simply as a nuisance, but rather as the result of financial economic deci-
sions, which we seek to understand.45 In that regard, we derived the predictions of economic
theory regarding correlation between MSN and two types of latent price, characterizing and
contrasting the entire cross-correlation functions in a variety of market environments, with
a variety of results.
    Some results are generic. For example, cross-correlations between strong form efficient
price and MSN at displacements greater than zero have sign opposite to that of the contem-
poraneous correlation.
    Some results are not generic but nevertheless quite robust to model choice. For example,
all models predict negative contemporaneous correlation between latent price and MSN, so
long as the risk aversion of market makers is not too high.
    Finally, some results are highly model-specific. For example, the cross-correlation pat-
terns and absolute magnitudes depend critically on the frequency of latent price changes,
the presence of bid/ask bounce, the timing of information and actions, and the degree of
market maker risk aversion.
    We hope that the results of this paper will promote the use of theory in disciplining
data. We have shown, for example, that attention to market microstructure theory enables
us to assess the likely validity of the independence assumption, to offer explanations of em-
pirically observed cross-correlation patterns, to predict the existence of as-yet undiscovered
patterns, and to make informed suggestions for improving volatility estimation methods.
And conversely, of course, additional work along our lines may help promote the use of
data in disciplining theory, by helping to sift the comparative merits of various competing
theoretical microstructure models.
    Novel uses of our results may also be possible. For example, the rate of decay of cross-
correlations might be used to assess the extent to which strategic traders are active in the
market, and the sign and size of the contemporaneous correlation might be used to assess
the degree of market maker risk aversion. Indeed market maker risk aversion might be
time-varying, with associated time-varying cross-correlation structure between latent price
and MSN. During crises, for example, market makers may be more risk averse, as bor-
rowing and hedging possibilities are reduced. If so, the “normal pattern” of negative con-
  45
    For an interesting related perspective, see Engle and Sun (2007). Their approach and environment
(conditional duration modeling), however, are very different from ours.



                                                38
temporaneous cross-correlation and positive higher-order cross-correlations might switch to
a “crisis pattern” of positive contemporaneous cross-correlation and negative higher-order
cross-correlations. Such possibilities await future empirical exploration.




                                            39
References
Aghion, Philippe, Patrick Bolton, Christopher Harris, and Bruno Jullien (1991), “Optimal
  learning by experimentation,” Review of Economic Studies, 58, 621–654. 12, 16, 47, 57

Aghion, Philippe, Maria Paz Espinosa, and Bruno Jullien (1993), “Dynamic duopoly with
  learning through market experimentation,” Economic Theory, 3, 517–539. 12, 47

Aı̈t-Sahalia, Yacine, P.A. Mykland, and L. Zhang (2010), “Ultra high frequency volatility
   estimation with dependent microstructure noise,” Journal of Econometrics, forthcoming.
   1

Andersen, Torben G., Tim Bollerslev, Peter F. Christoffersen, and Francis X. Diebold (2006),
 “Volatility and correlation forecasting,” in “Handbook of Economic Forecasting,” (edited
 by Elliot, Graham, Clive W. J. Granger, and Allan Timmermann), 777–878, Amsterdam:
 North-Holland. 1

Andersen, Torben G., Tim Bollerslev, and Francis X. Diebold (2010), “Parametric and
 nonparametric volatility measurement,” in “Handbook of Financial Econometrics,” (edited
 by Hansen, Lars P. and Yacine Aı̈t-Sahalia), 67–137, Amsterdam: North-Holland. 1

Andersen, Torben G., Tim Bollerslev, Francis X. Diebold, and Heiko Ebens (2001a), “The
 distribution of realized stock return volatility,” Journal of Financial Economics, 61, 43–
 76. 1

Andersen, Torben G., Tim Bollerslev, Francis X. Diebold, and Paul Labys (2000), “Great
 realizations,” Risk , 13, 105–108. 1

Andersen, Torben G., Tim Bollerslev, Francis X. Diebold, and Paul Labys (2001b), “The
 distribution of realized exchange rate volatility,” Journal of the American Statistical As-
 sociation, 96, 42–55. 1, 5

Andersen, Torben G., Tim Bollerslev, Francis X. Diebold, and Paul Labys (2003), “Modeling
 and forecasting realized volatility,” Econometrica, 71, 579–625. 1

Bandi, Federico M. and Jeffrey R. Russell (2006), “Realized variance and market microstruc-
  ture noise: Comment,” Journal of Business and Economic Statistics, 24, 167–173. 20,
  29

Bandi, Federico M. and Jeffrey R. Russell (2008), “Microstructure noise, realized variance,
  and optimal sampling,” Review of Economic Studies, 75, 339–369. 1, 29

                                            40
Bandi, Federico M. and Jeffrey R. Russell (2010), “Market microstructure noise, integrated
  variance estimators, and the accuracy of asymptotic approximations,” Journal of Econo-
  metrics, forthcoming. 32

Barndorff-Nielsen, Ole E., Peter R. Hansen, Asger Lunde, and Neil Shephard (2008a), “De-
  signing realised kernels to measure the ex-post variation of equity prices in the presence
  of noise,” Econometrica, 76, 1481–1536. 1

Barndorff-Nielsen, Ole E., Peter R. Hansen, Asger Lunde, and Neil Shephard (2008b), “Mul-
  tivariate realised kernels: Consistent positive semi-definite estimators of the covariation of
  equity prices with noise and non-synchronous trading,” Manuscript, Oxford-Man Institute
  of Quantitative Finance, University of Oxford. 1

Barndorff-Nielsen, Ole E., Peter R. Hansen, Asger Lunde, and Neil Shephard (2009), “Re-
  alized kernels in practice: Trades and quotes,” Econometrics Journal , 12, C1–C32. 35

Barndorff-Nielsen, Ole E., Peter R. Hansen, Asger Lunde, and Neil Shephard (2010), “Sub-
  sampling realised kernels,” Journal of Econometrics, forthcoming. 1

Barndorff-Nielsen, Ole E. and Neil Shephard (2002a), “Econometric analysis of realized
  volatility and its use in estimating stochastic volatility models,” Journal of the Royal
  Statistical Society B , 64, 253–280. 1

Barndorff-Nielsen, Ole E. and Neil Shephard (2002b), “Estimating quadratic variation using
  realized variance,” Journal of Applied Econometrics, 17, 457–477. 1

Barndorff-Nielsen, Ole E. and Neil Shephard (2007), “Variation, jumps, market frictions and
  high frequency data in financial econometrics,” in “Advances in Economics and Economet-
  rics, Theory and Applications, Ninth World Congress of Econometric Society,” (edited by
  Blundell, Richard, Persson Torsten, and Whitney K. Newey), 328–372, Cambridge: Cam-
  bridge University Press. 1

Demsetz, Harold (1968), “The cost of transacting,” Quarterly Journal of Economics, 82,
  33–53. 24

Diamond, Douglas W. and Robert E. Verrecchia (1987), “Constraints on short-selling and
  asset price adjustment to private information,” Journal of Financial Economics, 18, 277–
  311. 14

Diebold, Francis X. (2006), “Realized variance and market microstructure noise: Comment,”
  Journal of Business and Economic Statistics, 24, 181–183. 28, 29

                                              41
Easley, D., R.F. Engle, M. O’Hara, and L. Wu (2008), “Time-Varying Arrival Rates of
  Informed and Uninformed Trades,” Journal of Financial Econometrics, 6, 171–207. 8

Easley, David and Maureen O’Hara (1987), “Price, trade size, and information in securities
  markets,” Journal of Financial Economics, 19, 69–90. 17

Easley, David and Maureen O’Hara (1992), “Time and the process of security price adjust-
  ment,” Journal of Finance, 47, 576–605. 2, 13, 14, 17, 26, 33, 44, 47, 48

Engle, Robert F. and Andrew J. Patton (2004), “Impacts of trades in an error-correction
  model of quote prices,” Journal of Financial Markets, 7, 1–25. 9

Engle, Robert F. and Zheng Sun (2007), “When Is Noise Not Noise – A Microstructure
  Estimate of Realized Volatility,” Manuscript, Stern School, New York University. 38

Fama, Eugene F. (1970), “Efficient Capital Markets: A review of theory and empirical work,”
  Journal of Finance, 25, 383–417. 3

Foster, F. Douglas and S. Viswanathan (1996), “Strategic trading when agents forecast the
  forecasts of others,” Journal of Finance, 51, 1437–1478. 37

Glosten, Lawrence R. and Lawrence E. Harris (1988), “Estimating the components of the
  bid/ask spread,” Journal of Financial Economics, 21, 123–142. 37

Glosten, Lawrence R. and Paul R. Milgrom (1985), “Bid, ask, and transaction prices in a spe-
  cialist market with heterogeneously informed traders,” Journal of Financial Economics,
  14, 71–100. 2, 13, 16

Hansen, Peter R., Jeremy Large, and Asger Lunde (2008), “Moving Average-Based Estima-
  tors of Integrated Variance,” Econometric Reviews, 27, 79–111. 32, 33

Hansen, Peter R. and Asger Lunde (2006), “Realized variance and market microstructure
  noise,” Journal of Business and Economic Statistics, 24, 127–161. 1, 6, 23, 24, 28, 29,
  31, 32, 33, 34, 35, 37

Hasbrouck, Joel (1993), “Assessing the quality of a security market: A new approach to
  transaction-cost measurement,” Review of Financial Studies, 6, 191–212. 32

Hasbrouck, Joel (1996), “Modeling market microstructure time series,” in “Statistical Meth-
  ods in Finance,” (edited by Maddala, Gangadharrao S. and Calyampudi R. Rao), 647–692,
  Amsterdam: North Holland. 37


                                            42
Hasbrouck, Joel (2002), “Stalking the efficient price in empirical microstructure specifica-
  tions,” Journal of Financial Markets, 5, 329–339. 2

Hasbrouck, Joel (2007), Empirical Market Microstructure, New York: Oxford University
  Press. 2, 25, 28

Kelly, David L. and Douglas G. Steigerwald (2004), “Private information and high-frequency
  stochastic volatility,” Studies in Nonlinear Dynamics and Econometrics, 8, 1–28. 33, 44

Kyle, Albert S. (1985), “Continuous auctions and insider trading,” Econometrica, 53, 1315–
 1336. 2, 17, 18, 27, 50, 51

Meddahi, Nour (2002), “A theoretical comparison between integrated and realized volatility,”
 Journal of Applied Econometrics, 17, 479–508. 33

O’Hara, Maureen (1995), Market Microstructure Theory, Cambridge: Cambridge University
  Press. 2

Oomen, Roel C. A. (2006), “Realized variance and market microstructure noise: Comment,”
 Journal of Business and Economic Statistics, 24, 195–202. 33

Owens, John and Douglas G. Steigerwald (2005), “Inferring information frequency and qual-
 ity,” Journal of Financial Econometrics, 3, 500–524. 9

Roll, Richard (1984), “A simple implicit measure of the effective bid-ask Spread in an efficient
  market,” Journal of Finance, 39, 1127–1139. 2, 12, 25, 32

Zhang, Lan, Per A. Mykland, and Yacine Aı̈t-Sahalia (2005), “A tale of two time scales:
  Determining integrated volatility with noisy high frequency data,” Journal of the American
  Statistical Association, 100, 1394–1411. 1




                                              43
       Appendices
A       Market Microstructure
A.1      Market Setup
Let Ωt denote all public information available at time t. The market maker in particular
has no information beyond Ωt .46 We analyze limit-order markets, populated by informed
and uninformed traders. There are many market makers engaged in perfect competition and
serving as counterparty to all trades.47 The timing of information and actions in any given
period, t, which is infinitely often repeated, is as follows:48

   1. p∗t−1 becomes public information, thus p∗t−1 ∈ Ωt .
                                            


   2. p∗t changes randomly.

   3. The market maker observes Ωt which contains at least all transaction prices and trades
      up to the previous period, i.e. {pi , qi } ∈ Ωt ∀i < t. Ωt may contain additional infor-
      mation ωt about the current strong form efficient price, p∗t , for example the direction
      of the price innovation, {sgn(εt )}. Conditional on this, the market maker forms his
      price expectations pet .

   4. The market maker quotes a pricing scheme for period t, i.e. a mid price pmid
                                                                                 t  and a
      spread 2st ≥ 0. The market maker is bound to transact one unit at this price.

 5a. Informed traders are “active” with probability α. An α < 1 can be interpreted as
     inattention of traders or as occasional absence of a signal about p∗t . If they are active,
     they observe p∗t and the market maker pricing scheme {pmid     t   , st }. If based on their
                           ∗    ask      mid
     private knowledge pt > pt ≡ pt + st , then they try to buy an infinite amount,
     whereas if p∗t < pbid
                       t ≡ pt
                             mid
                                 − st , they try to (short-) sell an infinite amount. However,
     the market maker fills the demand only up to his commitment limit, one unit. If a
     transaction takes place, the transaction price is pt = pask
                                                               t   or pt = pbidt , respectively. If
  46
     Variance σ 2 and the probability density function of εt are public knowledge. We assume perfect memory,
Ωi ⊂ Ωt ∀i ≤ t, and that given the information set Ωt the market participants’ optimizing behavior
determines a unique market price p(Ωt ), with corresponding market return ∆p(Ωt , Ωt−1 ).
  47
     At a minimum, we require one market maker and many potential competitors.
  48
     The setup is similar to Easley and O’Hara (1992), where steps 5a and 5b are sequential, i.e. uninformed
traders step in if the informed refuse to trade. A variant is the model of Kelly and Steigerwald (2004) with
a random draw between steps 5a and 5b. That is, if the informed trader (5a) is drawn, and he refuses to
trade, then the period ends without a trade.


                                                    44
        neither buy nor sell is profitable, or if informed traders are not active in this period,
        then no informed trade occurs.

 5b. If there is no informed trade, uninformed traders trade instead randomly for exogenous
     reasons with probability β. If they trade, buying at pask
                                                             t   and selling at pbid
                                                                                 t   has equal
     probability, which allows market makers to earn the spread without risk. The maker
     maker cannot distinguish informed from uninformed traders – the latter, however, are
     his only source of revenue.

  6. If private information is valid for only one period, then the market continues with step
     1. Otherwise, if information remains private for T > 1 periods, no further information
     is revealed at this moment and the market continues with step 3. Eventually after T
     loops p∗t becomes public information and the market continues with step 1.


A.2        Decision Problem of Market Maker
Having detailed the market microstructure, we now describe the behavior of the market
maker. The loss function of the market maker pins down the optimal spread size and the
response to a trade, and is thus a key determinant of the sign of the cross-correlations.
Before trading occurs, the market maker has a belief about p∗t , summarized by the prior
probability density function f (p∗t ). We require f (p∗t ) = f (p∗t−1 + εt ) to be consistent with
Assumption 2 and denote the corresponding cumulative distribution function with F (·). Let
p and p denote the lower and upper end of the support of f (p∗t ) that the market maker has
determined by previous experimentation.49 We define the loss function of a market maker
with risk aversion parameter n ≥ 1 as ln (x) = − |x|n .
    The market maker’s loss in periods of informed trading is a function of the gap between
the strong form efficient price and the transaction price. In periods without any informed
trading the market maker suffers no loss, because any potential loss to a noise trade on the
one side of the market is offset by an even larger (by 2s) gain from a noise trade on the other
side of the market. The expected loss in period t when the market price is set at pt is
                                                 Z    p
                                                          |(pt − p∗t )E(qt |p∗t , pt , st )|n f (p∗t ) dp∗t ,
                                          
                    Ln    pt , F (·; p, p) = −
                                                  p


where E(qt |pt + st < p∗t ) = α, E(qt |pt − st > p∗t ) = α, and E(qt |pt − st < p∗t < pt + st ) =
0.50 Throughout most of the paper, we consider the case of a risk-neutral market maker
 49
      In the first period, either p and p are known, or are set to p = −∞ and p = ∞.
 50
      Ln (pt , F (·; p, p))1/n is related to the `n metric. However, it differs in that it is reweighted, and sums over



                                                               45
(n = 1). This assumption reflects that the market maker has a transaction limit of one unit
per period. As long as one unit is small relative to market maker wealth, his risk aversion
is negligible. An important special case for cross-correlations appears, however, in markets
where one unit of q is large relative to market maker wealth and thus risk aversion does
matter. We will discuss the risk aversion case in section 3.3.2.
    This setup has an immediate implication. If no informed traders are present in the mar-
ket, then E (qt εt−τ ) = 0 ∀t, ∀τ , because uninformed trades are unrelated to p∗t . In contrast,
for informed trades and sufficiently small risk aversion of the market maker E(qt εt−τ ) ≥ 0
∀t, ∀τ ≥ 0, because informed traders buy only if the strong form price increased, and sell if
it fell. Taken together it holds that51

                                           0 ≤ E (qt εt−τ ) ≤ E (|εt |) < 1, ∀t, ∀τ.                        (38)

    The market maker wants to pick bid and ask prices that meet two competing objectives:
on the one hand, minimizing current period losses to informed traders and simultaneously
maximizing spread income from uninformed traders, and on the other hand, learning as much
as possible about the latent price in order to provide a more accurate quote and thus incur
smaller losses in future periods. Denoting the market maker’s value function at time t by
Vt (Ft (·, pt , pt )) and his discount factor by δ, the market maker solves the recursive problem
                                 X                         n
       Vt (Ft (·; pt , pt )) =          P (ωt+1 )bid
                                                  maxask
                                                            αLn (pbid , Ft (·; pt , pbid ))
                                                 p   ,p
                                 ωt+1

                                       (1 − α)β
                                                                                               
                                                        β       ask         β         bid
         +    δVt+1 (F̃t+1 |qt = −1)             +α       Ft (p ) + 1 −          Ft (p ) − Ft (pt )
                                           2            2                   2
              pask − pbid 
                             1 − α + α Ft (pask ) − Ft (pbid )
                                                              
         +
                   2
                                       (1 − α)β
                                                                                               
                                                                        β        ask      β    bid
         +    δVt+1 (F̃t+1 |qt = +1)             + α Ft (pt ) − 1 −         Ft (p ) − Ft (p )
                                           2                            2                 2
                      ask        ask
         +    α Ln (p , Ft (·; p , pt )) ,                                                            (39)

where F̃t+1 is the update of Ft using information {ωt+1 , qt }, with pt+1 and pt+1 being the

infinitely many elements. In particular under zero spread and always active informed traders (|E(qt |p∗t , pt )| =
1 ∀pt 6= p∗t ), we have for n → ∞

    Ln→∞ (pt , F (·; p, p))1/n = −sup |pt − p∗t | , p∗t ∈ p|p ≤ p ≤ p, f (p) > 0 = −sup |pt − p| , pt − p .
                                                                                     


                                       
  51                        2         2
       Note that [E (|εt |)] < E |εt | = E ε2t = 1, where the first inequality follows from Jensen’s inequality.
                                              

Taking the square root we therefore get E(|εt |) < 1.



                                                               46
updated upper and lower bound of this distribution, and P (ωt+1 ) is the probability that the
market maker observes the signal ωt+1 . The recursive problem (39) encompasses most cases
that we discuss in this paper.
    If ωt+1 contains only information about period t and earlier, but no signal about t + 1
values, and if the market maker takes the spread as given,52 then the market maker’s only
choice variable is the location of the spread interval, pmid . Assuming that informed traders
are active (α = 1), (39) simplifies to

                                           mid                mid
                                                                     
       V (F (; p, p)) = max         Ln   p     − s, F (·; p, p    − s
                         pmid
                                        β                    
                                                                        β
                                                                                            
                              mid                   mid                         mid
         + δV F̃ (·; p, p + s)                 F (p + s) + 1 −              F (p − s) − F (p)
                                             2                          2
         + sβ F (pmid + s) − F (pmid − s)
                                                 
                                                 
                                                             β
                                                               
                                                                                 β
                                                                                            
                           mid                                       mid            mid
         + δV F̃ (·; p − s, p               F (p) − 1 −          F (p + s) − F (p − s)
                                                             2                   2
                     mid             mid
                                                 
         + Ln p + s, F (·; p + s, p) .                                                               (40)

Unfortunately, (39) and even (40) are hard to solve – in general the policy functions pbid (·)
and pask (·) are not available in closed form.53
    In the paper we look at specializations of the general market maker problem (39) and
examine the effect of various model setups on the cross-correlation function. For both strong
form and semi-strong form efficient returns we first examine the multiperiod case (δ > 0),
where private information is not revealed until after many periods. In subsections 3.3 and
4.3 we specialize to the one-period case (δ = 0), a case where private information becomes
public, and worthless, after only one period.


B      Proofs of Propositions

B.1      Proof of Proposition 1
Proposition (Cross-correlations in the Easley-O’Hara model)
  The contemporaneous cross-correlation in the Easley and O’Hara (1992) model is

                                                        1 + e−r(T −1)
                              Corr (∆p∗t , ∆ut ) = −        √         < 0,
                                                           2 K
  52
    The spread might be pinned down by competition (see Appendix E) or given exogenously by regulation.
  53
    For characterizations of the general solution see Aghion et al. (1991) and Aghion et al. (1993). Their
solution shows that in general optimal learning requires λt in (3) to vary over time.


                                                   47
and the cross-correlations at sufficiently large nonzero displacements follow

                                        er − 1
                      Corr ∆p∗t−τ , ∆ut = √ e−rτ > 0, ∀τ ∈ [1, T − 1]
                                          2 K

                                                 e−r(T −1)
                               Corr ∆p∗t−T , ∆ut = √        > 0,
                                                   2 K
where K = K(r, T ).
    Proof:
    Following the setup in Easley and O’Hara (1992), suppose the strong form efficient price
process switches between a high state p, a neutral state, and a low state p, where χ is the
probability of a non-neutral state and γ the probability of a high state given that the state
is non-neutral.               
                              
                              
                               p              with probability χγ
                              
                         p∗t = γp + (1 − γ)p w.p. 1 − χ
                              
                              
                                               w.p. χ(1 − γ)
                              
                              p

   Therefore, for t = κT , κ ∈ Z
                            
                            
                            
                             p−p         w.p. χ2 γ(1 − γ)
                            
                            
                              γ(p − p)    w.p. 2χ(1 − χ)(1 − γ)
                            
                            
                            
                            
                            
                      ∆p∗t = 0            w.p. (1 − χ)2 + χ2 (γ 2 + (1 − γ)2 )
                            
                            
                              γ(p − p)    w.p. 2χ(1 − χ)γ
                            
                            
                            
                            
                            
                            
                            p − p        w.p. χ2 γ(1 − γ)
                            


and ∆p∗t = 0 otherwise. Prices have the properties

                  (p − p)2  2
 E[(∆p∗t )2 ]               2γ χ(1 − χ)(1 − γ) + χ2 γ(1 − γ) + 2γ 2 χ(1 − χ)γ + χ2 γ(1 − γ)
                                                                                           
                =
                     T
                  (p − p)2                     σ2
                =          2χγ(γ + χ − 2χγ) ≡ ,
                     T                         T


                                         E(∆p∗t ∆pt ) = 0,
                                     E(∆p∗t−τ ∆p∗t ) = 0.

   For ease of exposition let us focus on the case γ = 1/2 and χ = 1, i.e. latent prices are
high and low with equal probability. Using the result from Easley and O’Hara (1992) that


                                                48
transaction prices converge to the strong form efficient price at an exponential rate we get

                            p − p −r(T −1)               p+p
                                                            
                                                    ∗
                                              
                      ∆p0 =       e        − 1 sgn p−T −
                              2                           2

                           p − p −r(τ −1)                   p+p
                                                               
                                             −rτ
                                                 
                    ∆pτ =        e        −e       sgn p0 −
                             2                               2
                        p − p −r(T −1)                  p+p
                                                            
                                       − 1 sgn p∗−T −          − ∆p∗0
                                          
                  ∆u0 =        e
                          2                               2
                           p − p −r(τ −1)                   p+p
                                                               
                                             −rτ
                                                 
                    ∆uτ =        e        −e       sgn p0 −
                             2                               2
   The contemporaneous cross-covariance (τ = 0) is

                                               1
                         Cov (∆p∗t , ∆ut ) =     E (∆p∗0 ∆u0 )
                                               T
                                                 σ2 
                                                     1 + e−r(T −1) .
                                                                  
                                             = −
                                                 2T

The second term inside the brackets is an artifact of p∗t not following a martingale. In
the period of the efficient price change it is optimal for the market maker to set pt to the
unconditional mean of p∗t , thereby offsetting the effect of all previous learning, which the
efficient price change rendered obsolete.
    The cross-covariance for τ ∈ [1; T − 1] is

                                               1
                      Cov ∆p∗t−τ , ∆ut           E (∆p∗0 ∆uτ )
                                         
                                             =
                                               T
                                               σ2
                                                   −e−rτ + e−r(τ −1) ,
                                                                    
                                             =
                                               2T

and for τ = T we have

                                                   1
                          Cov ∆p∗t−T , ∆ut           E ∆p∗−T ∆u0
                                                                 
                                                 =
                                                   T
                                                   σ 2 −r(T −1)
                                                 =    e         .
                                                   2T




                                                 49
   The variance of the noise is

                       1 (p − p)2 −r(T −1)                      (p − p)2 −r(T −1)
                          
                                                2
                                            − 1 + σ2 + 2
                                                                                    
       V ar(∆ut ) =                  e                                   e        −1
                       T        T                                   4
                       T −1
                                                          #
                       X    (p − p)2                   2
                   +                 −e−rτ + e−r(τ −1)
                       τ =1
                                4
                                                               −2r T −1
                       σ 2 1 −2r(T −1) 1 1                              −1
                                                                          
                                                   r       2 (e    )
                   =          e        + + (−e + 1)                          .
                       T 2              2 2                     e−2r − 1

   Denoting the term in brackets by K = K(r, T ) we get for the contemporaneous cross-
correlation
                                                  1 + e−r(T −1)
                           Corr (∆p∗t , ∆ut ) = −     √         ,
                                                     2 K
for the cross-correlation at displacements τ ∈ [1; T − 1]

                                                       −e−rτ + e−r(τ −1)
                                  ∆p∗t−τ , ∆ut
                                                 
                           Corr                      =       √           ,
                                                            2 K

and for the cross-correlation at displacement T

                                                              e−r(T −1)
                                      ∆p∗t−T , ∆ut
                                                         
                               Corr                          = √        .
                                                               2 K

Q.E.D.


B.2      Proof of Proposition 2
Proposition (Cross-correlations in the Kyle model)
  The contemporaneous cross-correlation in Kyle (1985) is
                                                              r
                                                                    T
                               Corr (∆p∗t , ∆ut )        =−              ,
                                                                  T2 + 1

the cross-correlations at displacements τ ∈ [1; T ] are
                                                             s
                                                                      1
                             Corr ∆p∗t−τ , ∆ut =
                                                     
                                                                                 ,
                                                                 T (T 2   + 1)

and all higher order cross-correlations are zero.
   Proof:
   In order to present a closed-form solution we use continuous time, t ∈ [0, T ], but note


                                                 50
that Kyle (1985) discussed the discrete time case as well. The discussion is based on the
assumption of Kyle (1985) that the reaction functions for quantity demanded and prices are
linear, i.e. that λt = λ, and st = s. Nonlinear solutions might nevertheless exist as well.
    We assume semi-strong market efficiency, and so s = λ. We get from (16)

                                                         σ
                            Cov (∆p∗t , ∆ut ) = −          (λE(qε0 ) − σ) < 0.
                                                         T

From (17) the cross-covariance function at nonzero displacements
                                                σ
                               Cov ∆p∗t−τ , ∆ut = λE(qε0 ) > 0
                                                 T

is constant ∀t ∈ [1, T − 1], and zero ∀t ≥ T .
    More specifically, we derive based on (23) for the noise (assuming zero spread)

                                                         T −1
                                   ∆p∗−T
                                                 Z
                                                                  σ
                             ∆u0 =       −                           dBs − ∆p∗0
                                    T                0          T −s

and for τ ∈ [1, T − 1]

                                                 τ                           τ −1
                        ∆p∗0
                                            Z                           Z
                                                           σ                          σ
                  ∆uτ =      + (T − τ )                       dBs −                      dBs .
                         T                      τ −1     T −s            0          T −s

The variance of the noise is therefore
                                                        T −1
                                          "                          #
                                      1                 X
                         V ar(∆ut ) =       E(∆u20 ) +       E(∆u2t )
                                      T                 t=1
                                        2
                                      σ T + 1 T − 1 (T − 1)2
                                                                      
                                    =              +          +
                                      T        T         T           T
                                        2
                                      σ       2
                                                    
                                    =       T   + 1   .
                                      T2

The covariances are simply, at displacement zero

                                                1                      −σ 2
                          Cov(∆p∗t , ∆ut ) =      Cov(∆p∗0 , −∆p∗0 ) =      ,
                                                T                       T

and at higher order displacements
                                                              ∗
                                                 1      ∗ ∆p0      σ2
                           Cov(∆p∗t−τ , ∆ut )   = Cov(∆p0 ,     ) = 2,
                                                 T          T      T

which leads directly to the cross-correlations given by Proposition 2. Q.E.D.


                                                         51
B.3     Proof of Proposition 3

Proposition (Strong form cross-correlation, one period model)

                                          1      sE (qt εt ) − σ
                      Corr(∆p∗t , ∆ut ) = √ p
                                           2 φs + σ 2 − 2sσE(qt εt )
                                               2



                           Corr(∆p∗t−1 , ∆ut ) = −Corr(∆p∗t , ∆ut )

   Proof:
   With T = 1, no extra information, λt = λ, st = s, and thus φt = φ ∀t, the variance term
(21) simplifies to V ar(∆ut ) = 2(σ 2 + φs2 ) − 4sσE(qt εt ). Plugging this into (22) gives the
desired result. Q.E.D.


B.4     Proof of Proposition 4
Proposition (Bounds of contemporaneous cross-correlation)

                                     1
                                  − √ ≤ Corr(∆p∗t , ∆ut ) ≤ 0
                                      2

     Proof:
     Negativity can be seen as follows. Uninformed traders trade randomly (E(qt |εt ) = 0),
thus for them we have sE(qtu εt ) = 0. In contrast, informed traders buy (qt = +1) only when
σεt > s and sell (qt = −1) only when σεt < −s. Thus in a market of only informed traders
σqti εt > s ≥ 0 ∀t. Therefore we can write

                                                                              s2
                                                   s                            
                         1=   E(qti 2 ε2t )   >E        qti εt       >E                > 0,
                                                    σ                         σ2

so in particular σ > sE(qti εt ) > 0. Combining informed and uninformed trades we have

                                          σ ≥ sE(qt εt ) > 0,

which implies that the contemporaneous cross-correlation (24) is negative.
                                              √
   Further, (24) is bounded from below by −1/ 2, which we prove by contradiction. Sup-
pose this was not the case, then from (24)
                                            p
                         sE (qt εt ) − σ < − φs2 + σ 2 − 2sσE(qt εt ).




                                                    52
Squaring both sides and simplifying gives the condition

                                                             [E (qt εt )]2 > φ,                                    (41)

but by Jensen’s inequality and β = 1

                                              [E (qt εt )]2 ≤ E qt2 ε2t = 1,
                                                                       


which contradicts (41). Q.E.D.


B.5      Proof of Proposition 5
Proposition (Optimal Mid Price)

                                               p(1) = Median(p∗t )
                                               p(2) = E(p∗t )
                                             p(∞) = Midsupport(p∗t ).

    Proof:
    The first two equations in the proposition54 are the well-known result that the median
is the best predictor under linear (absolute) loss, whereas the mean is the best predictor
under squared loss. The third equation is obtained by first noting that for any density f (·),
which has all moments, we can apply Leibnitz’s rule. Thus we obtain for (26) the first order
condition
                Z     p(n)                                           Z    p
                                      ∗ n−1
                             (p(n) − p )                 ∗
                                                   f (p )dp −   ∗
                                                                               (p∗ − p(n))n−1 f (p∗ )dp∗ = 0.      (42)
                  p                                                    p(n)


Rewriting (42) as a metric
                                                                                           !1/(n−1)
                                     Z      p(n)
                                                                    ∗ n−1
                              lim                  (p(n) − p )                f (p∗ )dp∗
                             n→∞        p
                                             Z      p                                              1/(n−1)
                                                               ∗               n−1      ∗       ∗
                                = lim                        (p − p(n))              f (p )dp                  ,
                                    n→∞             p(n)

  54
    We assume n ≥ 1 throughout, because this implies realistic market maker preferences. However, (26)
can be solved for any n ≥ 0. In particular, pmid (0) is the mode of f (·) when s = 0, or the highest density
(connected) region when s > 0. For n ∈   / {1, 2, ∞} no explicit solution exists, and for n > 25 even obtaining
numerical solutions creates difficulty for non-trivial distribution functions f (·).



                                                                     53
which after taking the limit degenerates to the sup norm

                          sup
                           ∗
                              (p(∞) − p∗ ) = sup
                                              ∗
                                                                   (p∗ − p(∞)) ,
                          p ∈[p,p(∞)]                       p ∈[p(∞),p]


gives
                                              p+p
                                              p(∞) =
                                                  .                                     (43)
                                               2
Thus, by monotonicity (43) solves (42) for n → ∞. Q.E.D.


B.6     Proof of Proposition 6
Proposition (Cross-correlation under market maker information)
    If Ωt = {sgn(εt ), p∗t−1 } and Assumption 2 holds, then the optimal market maker response
R({sgn(εt )}) strictly increases in risk aversion, n ≥ 1, without bound. If, further, the
distribution of the expected latent price with support [p∗ , p∗ ] satisfies

                              p∗t + p∗t
                                                     
                                                                             σ
                                          −   p∗t−1       sgn(εt ) > s +            ,
                                 2                                         E(|εt |)

then ∃n0 > 1 such that ∀n > n0 it holds that Corr(∆p∗t , ∆ut ) > 0.
    Proof:
    The new information ωt is now replaced by two parts: The first part reflects as before
information about p∗t−1 , i.e. ωt = p∗t−1 − pt−1 + (st−1 − λt−1 )qt−1 . The second, and new,
part reflects the extra information about ∆p∗t , and the response of the market maker to it.
To be specific, we assume that this extra information is the direction of the latent price
change {sgn(εt )}. If the distribution of expected latent price changes at the beginning of
each period is the same, we can write the market maker response to this extra information
as R(sgn(εt )) = R sgn(εt ). From (25) ∆pt = −pt−1 + p∗t−1 + sqt + R(·), and

          E (∆pt εt ) = E −pt−1 + p∗t−1 + sqt + R(·) εt
                                                       

                        1                             1
                      =   E [(sqt + R(·))εt |εt > 0] + E [(sqt − R(·))εt |εt < 0]
                        2                             2
                      = RE (|εt |) + sE (qt εt ) .                                      (44)

Plugging (44) with E (∆pt ∆p∗t ) = σE (∆pt εt ) into (9) implies that the contemporaneous
cross-covariance is positive if and only if

                                                  σ − sE (qt εt )
                                          R>                      .                     (45)
                                                     E (|εt |)


                                                           54
   Because E(qt εt ) > −E(|εt |) we have as sufficient condition

                                                        σ
                                             R>s+              .                                (46)
                                                     E (|εt |)

To satisfy (46) we need for pet = p∗t−1 + R(·) = p∗t−1 + R sgn(εt ) that
                                     
                                     > p∗             σ
                                         t−1   +s+   E(|εt |)
                                                                  for ε > 0
                               pet
                                     < p∗             σ
                                         t−1   −s−   E(|εt |)
                                                                  for ε < 0.
                                             h                        i
                                                                p+p
    From Proposition 5 for any p(n) ∈ Median(p);               there is a risk aversion level n such
                                                                 2
that market makers will – after observing the signal {sgn(εt )} – quote this price as mid
price pet . Therefore, for all distributions f (p∗ ) which satisfy (27), a sufficiently large n leads
to a market maker response which satisfies (45) and thus to a positive contemporaneous
cross-covariance. Q.E.D.


B.7     Proof of Proposition 7
Proposition (Semi-strong form cross-correlation, one period model)
  The contemporaneous cross-correlation is

                                             2φλ − σE(qt εt )      sgn(s − λ)
                   Corr(∆p̃et , ∆ut ) = p                             √       .
                                         σ 2 − 2σλE(qt εt ) + 2φλ2      2φ

The cross-correlation at displacement one equals

                                                  −φλ              sgn(s − λ)
                  Corr(∆p̃et−1 , ∆ut ) = p                            √       .
                                          σ 2 − 2σλE(qt εt ) + 2λ2      2φ

All cross-correlations at higher displacements are zero.
    Proof:
    The expressions for the cross-correlations follow directly from their multiperiod counter-
parts. In the setup of section 4.1 the semi-strong form efficient price has the unconditional




                                                 55
variance (36) and the corresponding noise has an unconditional variance of

                                 T −1
                              1X
                 V ar(∆ut ) =         V ar(∆ut )
                              T t=0
                                 (T −1
                              1 X
                                         φi (λi − si )2 + φi−1 (λi−1 − si−1 )2
                                                                               
                            =
                              T i=0
                                T −1
                                                                        )
                                X
                            − 2      E(qt qt−1 )(λi − si )(λi−1 − si−1 ) .               (47)
                                    i=1


The contemporaneous cross-correlation is

                                                    Cov(∆p̃t , ∆ut )
                         Corr(∆p̃et , ∆ut ) = p                            .
                                                  V ar(∆p̃et )V ar(∆ut )

where Cov(∆p̃et , ∆ut ) is given by (29). All other cross-correlation can be obtained analo-
gously.
    For T = 1, spread and adverse selection parameter are constants, i.e. st = s and λt = λ
∀t, and the variance terms (36) and (47) simplify radically to

                            V ar(∆p̃et ) = σ 2 − 2σλE(qt εt ) + 2φλ2 ,

                                   V ar(∆ut ) = 2φ(s − λ)2 ,

where we have used that qt is serially uncorrelated. Finally, from (29) and (31), we get for
T = 1 the covariances

                         Cov(∆p̃et , ∆ut ) = (s − λ) [2φλ − σE(qt εt )]

and
                                Cov(∆p̃et−1 , ∆ut ) = φλ(λ − s).

Combining these with the variances immediately gives the cross-correlations stated in propo-
sition 7. Q.E.D.


C     Example of Optimal Learning
Here we show that under signal certainty, the cross-correlation at nonzero displacements falls
with τ . Consider a signal that is known to be free of noise and strategic manipulation by
market participants. To learn as much as possible the market maker minimizes the length of

                                               56
the interval in which p∗t may be located. Even with a uniform prior belief, F , the posterior
F̃ is not uniform (as in Aghion et al. (1991)), but step-uniform, because of the noise induced
by uninformed trading. For the upper and lower end of the distribution to be a sufficient
statistic for market maker believes, we have to additionally assume the absence of noise
traders (β = 0). With these assumptions (40) collapses to

                                    pmid −s
                             pmid − s − p∗ ∗
                                Z
                                          dp + δV p, pmid − s pmid − s − p
                                                                          
    V (p, p) = max          −  mid
               mid
               p       p      p −s−p
                                                   p∗ − pmid − s ∗
                                          Z p
                   mid          mid
                                      
             + δV p + s, p p − p − s −                   mid − s
                                                                   dp .
                                           pmid +s p − p


     A solution to this example is the market maker to do repeated bisections, setting pmid
                                                                                        t   =
pt +pt
   2
       in every period. To see this, let us assume risk neutrality (n = 1), always active
informed traders, and no uninformed trades (for which a zero spread is sufficient, but not
necessary) which simplifies this recursive problem to
                                    " Z
                                             p−s
        V (p, p) = max               −             (p − s − p∗ )f (p∗ )dp∗ + V (p, p − s)F (p − s)
                        p                p

                 + V (p − s, p + s) (F (p + s) − F (p − s)) + V (p + s, p) (1 − F (p))
                   Z p                         
                          ∗              ∗   ∗
                 −      (p − p − s)f (p )dp .                                                        (48)
                        p+s


    To simplify the problem further, we assume as in the example in Aghion et al. (1991)
that f (·) is uniform. Then, in fact, the location of the interval [p, p] does not matter for
describing information content. The length of it alone, m = p − p, summarizes the state of
learning. (48) becomes with p = αm + p

                         1
V (m) = max         −      (αm)2 + δV (αm)α
            α           2m
           1                                             2s
        −    ((1 − α)m)2 + δV ((1 − α)m)(1 − α) + V (2s)
          2m                                             m
                                                     1
                                                         (αm − s)2 + ((1 − α)m − s)2
                                                                                     
        = max δV (αm)α + δV ((1 − α)m)(1 − α) −
           α                                       2m
        = max δV (αm)α + δV ((1 − α)m)(1 − α)
           α
           1
              2α2 m2 + 2s2 + m2 − 2αm2 − 2ms .
                                              
        −
          2m

 From the first order condition for the maximum we get α = 1/2, thus optimal learning is
achieved by repeated bisections.
   This result is driven by uniformity and the zero spread, which ensures that Assumption

                                                          57
2 holds in every period, in particular that f (·) in (48) is always symmetric. Thereby, the
term in brackets in (48) is symmetric around the symmetry point of f (·) as well, and the
optimal pmid equals the median, and the midpoint of the support of f (·). For non-uniform
f (·) the solution path over time is specific to the shape of f (·) and has to be determined
numerically.
     Therefore, the market maker’s optimal pricing rule follows repeated bisections, i.e. he sets
         p +p
pt = t 2 t in every period. Therefore pmid
  mid
                                             t   converges, in smaller and smaller steps, towards
p∗ , and the probability of p∗ ∈ [pmid − s, pmid + s] converges to unity. The smaller the interval
[p, p] of possible p∗ becomes, the less likely will the choice of pmid allow profitable informed
trades. Therefore E(q0 ε0 ) decreases over time. Likewise, as more and more information
is already contained in [p, p], E(ωt ε0 ) decreases as well. Overall, the cross-correlation at
nonzero displacements falls with τ .


D        Effect of Risk Aversion on Optimal Price
Here we show that high risk aversion pushes the optimal price toward the midpoint of the
support. In other words, if f (·) is without loss of generality right-skewed, then p(n) is
increasing in n, ∀n ≥ 1. First, note that p(n), p(n) ∈ [p, p],55 is continuous. If p or p
are infinite, we replace these bounds with a function of n, thereby making the domain of p
compact. As f (·) and all components of the integral are continuous functions, the theorem
of the maximum gives continuity of p(n).
    Next, to evaluate how the optimal price p(n) responds to changes in risk aversion n, take
the total differential of (42) and rearrange to obtain
                                       
                                           p(n)
                                            Z
                dp(n)    1             
                      =    × −                  (p(n) − p∗ )n−1 ln (p(n) − p∗ ) f (p∗ )dp∗
                 dn     n−1 
                            
                                            p
                                                                         
                       Zp                                                
                                                                         
                                                                           ,
                  +           (p∗ − p(n))n−1 ln (p∗ − p(n)) f (p∗ )dp∗
                                                                         
                                                                         
                      p(n)
                                                                                 
                       p(n)                           Zp                         
                      Z                                                          
                                     ∗  n−2     ∗   ∗       ∗       n−2     ∗   ∗
                            (p(n) − p )     f (p )dp +    (p − p(n))    f (p )dp .                 (49)
                      
                                                                                 
                                                                                  
                          p                                 p(n)


      In the following argument we use that f (·) is monotone and assume without loss of
 55
      We suppress the asterisk from p∗ and p∗ and replace pmid
                                                           t   (n) by p(n) to simplify notation.



                                                       58
                                                                                          
generality that f (·) is monotonically decreasing. This means f (·) is right-skewed on p, p ,
which occurs if the market maker has some information that the strong form efficient price
has increased. Under this assumption (49) is positive. To see this, note first that both terms
in the denominator are positive. To economize notation we replace p ≡ p(n), d ≡ p(n) − p
and x ≡ p∗ . The numerator can be broken up into three parts:

               Zp                                         Zp
                             n−1
           −         (p − x)       ln (p − x) f (x)dx +           (x − p)n−1 ln (x − p) f (x)dx
                p                                         p

               Zp−1                                Zp+d
                          n−1
           = −     (p − x)    ln (p − x) f (x)dx +     (x − p)n−1 ln (x − p) f (x)dx
                    p−d                                           p+1

                Zp                                        Zp+1
           −          (p − x)n−1 ln (p − x) f (x)dx +              (x − p)n−1 ln (x − p) f (x)dx
               p−1                                            p

                Zp
           +          (x − p)n−1 ln (x − p) f (x)dx.                                               (50)
               p+d



   The first term, which exists only for d > 1, gives

               Zp−1                                 Zp+d
                           n−1
             −     (p − x)     ln (p − x) f (x)dx +     (x − p)n−1 ln (x − p) f (x)dx
                p−d                                           p+1

                 Zp+d
             = −     (x − p)n−1 ln (x − p) f (2p − x)dx
                     p+1

                      Zp+d
                    +     (x − p)n−1 ln (x − p) f (x)dx
                     p+1

               Zp+d
             =     (x − p)n−1 ln (x − p) [−f (2p − x) + f (x)] dx
                p+1

               Zp+d
             ≥     (x − p)n−1 ln (d) [−f (2p − x) + f (x)] dx
                p+1

                 Zp−1                            Zp+d
                            n−1
             = −     (p − x)    ln (d) f (x)dx +     (x − p)n−1 ln (d) f (x)dx.                    (51)
                     p−d                                p+1


                                                   59
The second term is for d ≥ 1

              Zp                                          Zp+1
                               n−1
         −           (p − x)         ln (p − x) f (x)dx +     (x − p)n−1 ln (x − p) f (x)dx
              p−1                                         p
                    Zp+1
         = −            (x − p)n−1 ln (x − p) f (2p − x)dx
                    p
                Zp+1
              +     (x − p)n−1 ln (x − p) f (x)dx
                    p
              Zp+1
         =           (x − p)n−1 ln (x − p) [f (x) − f (2p − x)] dx ≥ 0.                         (52)
               p


For d < 1 the last inequality of the calculations for the second term is instead

                               Zp+1
                                   (x − p)n−1 ln (x − p) [f (x) − f (2p − x)] dx
                               p

                          Zp+d
                        ≥     (x − p)n−1 [f (x) − f (2p − x)] dx ln (d) ≥ 0.                    (53)
                               p


And for the last term we can write

             Zp                                               Zp
                               n−1
         −         (x − p)           ln (x − p) f (x)dx > −        (x − p)n−1 ln (d) f (x)dx.   (54)
             p+d                                           p+d


Using (51), (52), and (54), (50) becomes

                       Zp−1                     Zp
                                                                    

             (50) > −     (p − x)n−1 f (x)dx +    (x − p)n−1 f (x)dx ln(d)
                               p−d                        p+1




                                                    60
                        Zp−1                     Zp
                     
                                   n−1
                >    −     (p − x)    f (x)dx −    (p − x)n−1 f (x)dx
                          p−d                               p−1

                      Zp+1                     Zp
                                                                    

                +         (x − p)n−1 f (x)dx +    (x − p)n−1 f (x)dx ln(d)
                      p                               p+1

                              Zp                            Zp
                                                                                    

                =    −            (p − x)n−1 f (x)dx +           (x − p)n−1 f (x)dx ln(d)
                          p−d                               p
                =    0,

 where the inequality follows from the monotonicity of f (·), and the last equality follows
from the first order condition (42).
   Likewise, for d < 1, using (53) we have

                                   Zp                            Zp
                                                                                        

              (50) > −                 (p − x)n−1 f (x)dx +          (x − p)n−1 f (x)dx ln(d)
                               p−d                                p
                    = 0.

    Therefore the numerator is positive and

                                                  dp(n)
                                                        >0
                                                   dn

for right-skewed distributions. Combining this with the fact that p(1) = Median(p∗ ) and
p(∞) = Midsupport(p∗ ) we conclude that p(n) monotonically increases from the median to
the midpoint of the support of the efficient price distribution f (·), if f (·) is right-skewed.
Analogously, for left-skewed f (·), p(n) monotonically decreases from the median to the mid-
point of the support.


E     Zero Profit Condition Under Perfect Competition
In the following example we show that s is uniquely determined as a competitive outcome.
Under perfect competition the zero profit condition requires the market maker’s losses in
trades with informed traders to exactly offset the spread earned from trades with uninformed
traders. An increase in the spread benefits the market maker in three ways: it increases his
spread income from uninformed traders, makes uninformed trades more likely, and reduces



                                                      61
his losses to informed traders. This can be written as
                     Z    pbid                                               Z   ∞
                                                 ∗ n        ∗        ∗
                                                                                                    n
                                     bid
                                                                                      p∗ − pask          f (p∗ )dp∗
                                                  
                 −               p         −p          f (p )dp −
                        −∞                                                   pask

                                                                         !
                                                 pask
                                                                             pask − pbid
                                             Z
                                     +                  f (p∗ )dp∗                       = 0.                                (55)
                                             pbid                                 2

Clearly, as in section 3.3.2 the bid and ask price grow in n, without bound as n → ∞ if f (·)
has unbounded support.
   For simplicity, we now assume risk neutrality (n = 1) in a one-period model (δ = 0),
where informed traders are always active. Using the symmetry of the expected density f (p∗ )
around pmid , (55) becomes a problem of setting pmid and s.
                                                                                                                    !
                    Z    pmid −s                                                       Z     pmid
                                      p∗ − pmid + s f (p∗ )dp∗ =                                    f (p∗ )dp∗
                                                             
                −                                                                                                       s.   (56)
                     −∞                                                                   pmid −s


    Then, with F (·) denoting the cumulative density function of f (·) (whose expected value
is assumed to exist)
                                                                                        
                                      pmid −s
                  − E(p∗ )            −∞          · F (pmid − s) − (pmid − s)F (pmid − s)

                                           = F (pmid ) − F (pmid − s) s,
                                                                     
                                                                                                                             (57)

where E(p∗ ) |p−∞ denotes the expectation of p∗ over the distribution f (p∗ ) restricted to the
interval [−∞, p]. pmid is given by the optimal learning rule. (57) is one equation in the one
unknown, s.
                                              mid     sF (pmid )
                              pmid − E(p∗ ) p−∞ −s =                                       (58)
                                                     F (pmid − s)
The left-hand side (LHS) is monotonically increasing in s from some positive number to
positive infinity. The right-hand side (RHS) is monotonically increasing in s, from 0 to
positive infinity. It can be shown that the RHS increases faster than the LHS and that
this difference in slope does not go to zero as s becomes larger. Differentiating (56) using
Leibnitz’s rule, we get

                                                                                                  pmid −s
                                                                                 −1
                                                                                            Z
                                                                                                            1
                    mid                mid                   mid
                                                                                                              f (p∗ )dp∗
                                                    
              − p         −s−p               + s f (p                − s)                 −
                                                                                 2             −∞           2
                                                                                                                !
                                                                                      pmid
                                                            −1
                                                                               Z
                                       mid                              1                           ∗       ∗
                          < −f (p            − s)                    s+                        f (p )dp
                                                            2           2            pmid −s


                                                                     62
and
                1              s               1
               − F (pmid − s) < f (pmid − s) +   F (pmid ) − F (pmid − s) .
                                                                         
                2              2               2
Therefore
                                 0 < sf (pmid − s) + F (pmid ),

which holds always by definition. This shows two things: Firstly, the RHS in (56) is increasing
faster than the LHS. And secondly, the difference in slope is always at least F (pmid ) > 0.
Hence we have proven that there is a single crossing and s is determined uniquely.
    If the LHS in (58) is very small because the support of the distribution became very
small by learning, then s must be small as well. Hence, as market makers learn, the spread
s in the market shrinks. If some market maker learned more slowly than his peers, he would
make losses at least until the next change in p∗ .




                                              63
