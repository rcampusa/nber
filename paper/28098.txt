                              NBER WORKING PAPER SERIES




               DESIGNING, NOT CHECKING, FOR POLICY ROBUSTNESS:
                     AN EXAMPLE WITH OPTIMAL TAXATION

                                      Benjamin Lockwood
                                          Afras Y. Sial
                                      Matthew C. Weinzierl

                                       Working Paper 28098
                               http://www.nber.org/papers/w28098


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                   November 2020




The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Benjamin Lockwood, Afras Y. Sial, and Matthew C. Weinzierl. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Designing, not Checking, for Policy Robustness: An Example with Optimal Taxation
Benjamin Lockwood, Afras Y. Sial, and Matthew C. Weinzierl
NBER Working Paper No. 28098
November 2020
JEL No. H21,H24

                                        ABSTRACT

Economists typically check the robustness of their results by comparing them across plausible
ranges of parameter values and model structures. A preferable approach to robustness--for the
purposes of policymaking and evaluation--is to design policy that takes these ranges into
account. We modify the standard optimal income tax model to include the policymaker's
subjective uncertainty over parameter values, and we characterize robust optimal policy as that
which maximizes expected social welfare. After calibrating uncertainty over the elasticity of
taxable income from past empirical work and novel survey data on economists' beliefs, we
compare the implied robust optimal marginal tax rates to the alternative benchmark policy based
on the best point estimates of relevant parameters. Our results suggest that robust optimal
marginal tax rates are typically more progressive than in benchmark analyses, raising top
marginal tax rates by between 5 and 7 percentage points, and generating modest expected welfare
gains.

Benjamin Lockwood                              Matthew C. Weinzierl
The Wharton School                             Harvard Business School
University of Pennsylvania                     277 Morgan
1400 Steinberg-Dietrich Hall                   Soldiers Field
3620 Locust Walk                               Boston, MA 02163
Philadelphia, PA 19104                         and NBER
and NBER                                       mweinzierl@hbs.edu
ben.lockwood@wharton.upenn.edu

Afras Y. Sial
The Wharton School
University of Pennsylvania
300 Vance Hall
3733 Spruce Street
Philadelphia, PA 19104-6372
sial@wharton.upenn.edu
                 Designing, not Checking, for Policy Robustness:

                           An Example with Optimal Taxation

                    Benjamin B. Lockwood, Afras Sial, and Matthew Weinzierl

                                              November 10, 2020



                                                     Abstract

          Economists typically check the robustness of their results by comparing them across plausible
      ranges of parameter values and model structures. A preferable approach to robustness--for
      the purposes of policymaking and evaluation--is to design policy that takes these ranges into
      account. We modify the standard optimal income tax model to include the policymaker's
      subjective uncertainty over parameter values, and we characterize robust optimal policy as
      that which maximizes expected social welfare. After calibrating uncertainty over the elasticity
      of taxable income from past empirical work and novel survey data on economists' beliefs, we
      compare the implied robust optimal marginal tax rates to the alternative benchmark policy
      based on the best point estimates of relevant parameters. Our results suggest that robust
      optimal marginal tax rates are typically more progressive than in benchmark analyses, raising
      top marginal tax rates by between 5 and 7 percentage points, and generating modest expected
      welfare gains.


Policymaking must proceed in the face of widespread uncertainty.1                     Despite our best efforts,

economists cannot provide policymakers with definitive estimates of most, if any, of the inputs
   
     University of Pennsylvania Wharton School and NBER; University of Pennsylvania Wharton School; Harvard
Business School and NBER. We thank the Editor and participants at the NBER Tax Policy and the Economy
2020 conference for valuable comments and suggestions. We thank the Wharton Dean's Research Fund for financial
support.
   1
     We will use the term uncertainty as a shorthand for risk, uncertainty, and ignorance, three classes of limits to
understanding (see Zeckhauser 2014). Our analysis has the policy designer face risk (known probabilities of known
states) and uncertainty (unknown probabilities of known states), and we use the latter term to encompass both. To
be specifc, we assume known probabilities of known states or have the policymaker attempt to resolve uncertainty
over the unknown probabilities of known states (i.e., via a survey of economists). We would be eager to incorporate
ignorance (unknown probabilities of unknown states), but doing so would take us too far from standard policy
evaluation methods. See Weinzierl (2017) for a possible approach to managing ignorance in policy design.


                                                         1
to optimal policy models (much less guarantee that we are using the right models). Therefore,

economists studying optimal policy design have a responsibility to ensure that their results are

robust to plausible uncertainty about the model inputs. In this paper, we argue that the cur-

rent approach to robustness used by most economists is flawed as a guide to policymaking and

evaluation, however natural it may be for academic research, and we propose an alternative.

       A typical robustness analysis is designed for the use of journal editors and referees, not pol-

icymakers. In particular, the results obtained in a baseline case are typically labeled "robust"

when they are close--in some unspecified but generally understood sense--to the results obtained

at several points within a plausible space of parameter values and range of model specifications.

This approach provides reassurance that the results are not special or fragile; that is, that they

do not rely on a particular calibration or modeling choice. But this approach is at odds with

how economists themselves advise policymakers to confront limits to their understanding, and it is

therefore a disservice to policymakers (and their economic advisors). Instead, most economists be-

lieve rational policymaking in the face of uncertainty is nothing other than expected social welfare

maximation, in which policymakers ought to take into consideration the probabilities and implica-

tions of the full range of plausible parameter values when choosing policy.2 In other words, policies

ought to be robust to parameter and model uncertainty by design.

       The expected social welfare maximization approach has at least two advantages as a guide to

robust policy. First, it makes it more difficult to ignore nonlinearities in "outlier" results from far-

off parts of the parameter space. Under the current approach, if some combination of parameter

values is unlikely but not impossible, and yet has substantial implications for the results, it may

easily escape the analyst's attention and encourage a false sense of security. This risk is especially

great in complex situations with a number of uncertain parameters, when relying on the researcher's

best judgment may be insufficient. Expected welfare maximization avoids this problem, as it is

designed to be sensitive to any extreme welfare implications. Second, expected welfare maximation

delivers a rigorously determined optimal policy compromise in the face of uncertainty, whereas the

current method provides no guidance on how the results under baseline and "outlier" cases are to

be combined. It is striking, upon reflection, how seldom the results of robustness checks under the
   2
    We address primarily economists working in the welfarist tradition widely assumed in modern economic analysis.
A concern for robustness may lie behind support for nonwelfarist principles of policy design, though we do not explore
that possibility here. See Weinzierl (2018; 2019) for an elaboration of the case for nonwelfarist principles.


                                                          2
current approach lead to recommendations for any adjustment to the baseline optimal policy.

       To demonstrate how using expected social welfare maximation modifies standard analytical and

quantitative optimal policy results, we focus on the much-studied optimal income tax problem.3

Working within the standard Mirrlees (1971) model, we assume that its key parameters may be

state-dependent and that the tax designer, who maximizes expected social welfare, is uncertain

over the true state of the world. The resulting necessary conditions for a robust optimal tax policy,

and the policy implied by them under a specific calibration, can be compared to two benchmarks:

an "average optimal policy" which equals the probability-weighted average of policies computed

for each possible value of these parameters, and the "best estimate optimal policy" based on the

expected values of these parameters.

       Our new analytical results clarify how the robust optimal tax policy more effectively responds

to relationships among uncertain parameters than do the two benchmark policies. For example, in

one scenario considered below, we find that the necessary conditions for robust optimal marginal

income taxes depend on the inverse of the expected value (across states) of the product of the

elasticity of taxable income and the density of the income distribution (using the notation below,
         1
Es [s (y )hs,T (y )]
                     ),    rather than the expected value of the inverse of the product of those parameters
               1
(Es      s (y )hs,T (y )   , upon which depends the average optimal policy) or the inverse of the product of
                                           1
their expected values ( E                     , upon which depends the best estimate optimal policy).
                                   [hs,T (y)]
                                  s [s (y )]Es

       Our quantitative results indicate that, for plausible levels of uncertainty, the robust optimal

tax policy remains broadly similar to the policy chosen under certainty, but instructive differences

exist. To calibrate the model, we must construct a subjective probability distribution over key

parameter values. For purposes of concreteness, we focus our analysis on a central parameter of

optimal income taxation models: the long-term elasticity of taxable income (ETI). To calibrate

the subjective distribution, we draw on two data sources: the vast existing empirical literature

estimating the ETI, and a novel survey of academic economists.4 Then, for each value of that
   3
     Although we have not seen our proposed approach to robustness applied in tax policy design, there is some
precedent for this approach in environmental policy, e.g., in Nordhaus (2007, p. 33):
         The present study takes the standard economic approach to uncertainty known as the expected utility
         model, which relies on an assessment with subjective or judgmental probabilities. This approach uses
         the best available estimates of the averages and uncertainties for the major variables to determine how
         the presence of uncertainty might change our policies relative to a best-guess policy.

   4
       In doing so, we aggregate many individuals' beliefs, and for simplicity we will apply equal weights to each. If some



                                                              3
elasticity, we infer an income-earning ability distribution from current data on income and the

tax system. We are thus able to construct state-dependent joint probability distributions for two

of the dimensions of uncertainty facing tax policy designers and use them to compare the robust

optimal policy to the two benchmark policies. We find that the robust optimal tax schedule retains

the now-standard U-shape discussed in Diamond (1998) and Saez (2001). At the same time, the

robust optimal tax system is generally more progressive and welfare-improving. In our baseline

case, we calibrate uncertainty using our pilot survey of public finance economists, in conjunction

with empirical estimates of the modern U.S. income distribution, and we allow the policymaker's

budget constraint to bind only in expectation. We find that robust optimal policy raises marginal

and average tax rates on incomes greater than $100,000 by approximately 7 percentage points and

4 percentage points respectively relative to the best estimate policy. Average tax rates are reduced

by between 2 and 7 percentage points at lower incomes, and the robust policy generates annual

welfare gains of 1.1% of consumption, or $190 billion. When we require the constraint to bind in

each state, the robust optimal policy raises marginal and average tax rates at higher incomes by

about 5 and 3 percentage points, respectively, and generates more modest annual welfare gains of

0.2% of consumption, or $54 billion.

    Finally, we note that our alternative approach in no way undermines, and may improve, the

most important benefit of conventional robustness checks. Both scholars and policymakers want

to know whether, in what ways, and by how much a policy based on the best of their knowledge

will be substantially in error if they turn out to have been wrong. This desire makes it natural

to compare (in a variety of ways) two policies: the optimal policy given baseline parameter values

(what we call the best estimate optimal policy), and the optimal policy given substantially different

values. Under our approach, the first of these two policies is replaced by the optimal robust policy,

which maximizes expected social welfare over the possible range of parameter values. Therefore,

the results of a traditional robustness analysis can still teach us how costly are deviations of the

actual parameter values from our beliefs, but we now measure these costs relative to a rationally

constructed robust policy.
sources of beliefs are more credible than others, their influence would be greater on the policy designer's probability
distribution over states.




                                                          4
1     Analytical results without and with uncertainty

To make our approach concrete and demonstrate its practicality, we work within the currently

dominant optimal tax framework based on Mirrlees (1971) and developed by Diamond (1998) and

Saez (2001), among many others. The Mirrleesian literature has expanded along a number of

dimensions, with each expansion introducing greater sophistication and complexity to the (already

demanding) model. But the basic model's core result on marginal tax rates (that is, distortions

to individuals' consumption-leisure tradeoffs) relies on a remarkably short list of parameters: the

long-term5 elasticity of taxable (labor) income, the shape of the income (or income-earning ability)

distribution, and marginal welfare weights along the income (or ability) distribution.6

    Uncertainty is pervasive, however, over the values of these parameters upon which Mirrleesian

optimal tax results depend. Taxable income elasticities have been exhaustively studied for decades,

but their long-term values in response to substantial tax changes remain elusive given the limits

of econometrics in a complex and dynamic world.7 The income distribution is relatively well

understood at a point in time, but its long-term evolution and (non-tax-policy) determinants remain

only vaguely understood.8 Even marginal social welfare weights, which for decades were viewed as

arising in a straightforward way from a utilitarian social welfare function, have recently come up

for debate, with some authors finding support for quite different values.9
    5
      As Saez, Slemrod, and Giertz (2012) write in their literature review on this elasticity, "The long-term response
is of most interest for policy making."
    6
      Note that we designate the elasticity of taxable income as containing within it all responses to tax policy that
affect income, including (for example) human capital accumulation decisions. Changes to the income distribution not
captured by this elasticity may be due to non-tax policy changes (such as education) and changes to the productive
environment (such as technology). As there is no other income in the model, and the model is static (it can be
thought of as a lifetime model), there is no income shifting in response to a tax change.
    7
      As Saez, Slemrod, and Giertz (2012) point out, "the long-term response is more difficult to identify empirically.
The empirical literature has primarily focused on short-term (one year) and medium-term (up to five year) responses,
and is not able to convincingly identify very long-term responses." In part, they argue, this difficulty is because the
elasticity of taxable income is not a "structural parameter" with a value independent of context. Instead, it depends
on the existing tax and broader economic system, such that "an elasticity estimated around the current tax system
may not apply to a hypothetical large tax change." Factors of potential importance on which empirical evidence is
quite limited, and which thereby complicate the econometrics, include the long-term responsiveness of investment in
human capital and interdependent social norms.
    8
      This uncertainty is closely related to the assumed unobservability of income-earning ability at the heart of the
Mirrlees model. Both the income and ability distributions will depend, in the long term, on the evolution of a range
of unforeseeable factors such as production technology, the educational system, fertility choices, and various non-tax
policies.
    9
      The inverse-optimum literature (see Bourguignon and Spadaro 2012, Bargain et al. 2014, and Lockwood and
Weinzierl 2016) seeks to infer welfare weights from existing policy choices. Its results are not easily summarized, but
some analyses have found implied welfare weights that do not decline monotonically or as quickly as the standard
utilitarian approach would imply. See also Weinzierl (2014), Saez and Stantcheva (2016), and references therein.



                                                          5
   Our model policymaker takes this uncertainty into account by imagining each possible collection

of parameter values as a state of the world, specifying a probability distribution over states of the

world, and choosing tax policy to maximize expected social welfare. This probability distribution

can be understood as a Bayesian policymaker's prior, which may be subject to change on the

basis of new information. In particular, we allow for a range of possible values of the taxable

income elasticity and assume functional forms for the income distribution and marginal social

welfare weights. Then, each possible elasticity implies--given observed pre-tax and post-tax income

distributions and a tax system--an underlying income-earning ability distribution and a set of

marginal social welfare weights, together generating a collection of state-specific parameter values

for the model policymaker to use.


1.1     Linear taxation

To build intuition, we begin with an optimal linear tax model of the kind considered in Sheshinski

(1972). The tax system is defined by a lump-sum grant b and constant marginal rate t.


1.1.1    Certainty benchmark

Individuals differ in their unobservable income-earning ability type, indexed by i = {1, 2, ..., I }, and

choose labor effort to maximize utility U ci , y i , where ci is individual i's after-tax income (i.e.,

consumption) and y i is pre-tax income (i.e., the product of ability and effort). We use  i to denote

the compensated elasticity of the individual's taxable income with respect to 1 - t. For the purposes

of this section, we assume utility is quasilinear in consumption so that there are no income effects of

taxation on an individual's optimization, and thus  i is also the uncompensated elasticity of taxable

income. An individual earning income y i pays tax T y i = -b + ty i , so the individual's budget

constraint is ci = (1 - t) y i + b, and individual i's indirect utility can be denoted V i (1 - t, b) . We

denote average income with y
                           ¯=              iyi,   where pi is the fixed population proportion of type i in
                                      ip

the economy.

   The tax authority's objective is to maximize a simple-sum utilitarian measure of social welfare:
     i i     - t, b). This form for the objective is standard--though not uncontroversial--in the
  i p V (1




                                                        6
literature. We define
                                                                         dV i
                                                        i                 db
                                                    g =                         ,                                  (1)
                                                                          

to denote the marginal social welfare of income for individual i, equal to their marginal utility of

consumption (the numerator) normalized by the marginal value of public funds .10

       The tax authority's budget constraint is


                                                t           pi y i = b + R,                                        (2)
                                                    i


where R is exogenous required public goods spending.

       We use the perturbation method made familiar (in the nonlinear tax context) by Saez (2001)

to derive the necessary conditions for optimal policy. The strategy is to note that at the optimum,

social welfare is maximized with respect to the tax rate t, and so a small change dt must have no

first-order impact on welfare when all its component parts are summed.11

       The effects of the perturbation dt can be collected into two classes: mechanical and behavioral.

The mechanical effect includes a revenue increase from higher taxes on each agent's income, equal

to a revenue change of y i dt from each individual i, and a consequent mechanical reduction in welfare

of g i y i dt for each individual i. The total mechanical effect, dM, is therefore


                                            dM =                    pi (1 - g i )y i dt.                           (3)
                                                            i


                                                                                     dy                 i
       The behavioral effect arises from each individual i adjusting earnings by - d(1-t) dt, which

thereby changes tax revenue. The total behavioral effect, dB, is

                                                                              dy i
                                           dB = -t                    pi             dt.                           (4)
                                                                           d (1 - t)
                                                                i


If the initial policy is optimal, then dM + dB = 0. With some simplification (and recalling that
  10
     At the optimum (and absent income effects), the policymaker must be indifferent between a marginal dollar of
                                                                                          j
public funds and a marginal increase in the lump-sum grant, implying that  = j dV       db
                                                                                            , and in turn implying that
marginal social welfare weights average to one.
  11
     In Appendix A, we also derive the optimal linear tax rates using direct constrained optimization, resulting in the
same solution.




                                                                     7
  dy i 1-t
d(1-t) y i   =  i ), the optimal linear tax rate t satisfies


                                     t    E yi - giyi     -Cov [g i , y i ]
                                        =               =                   .                                     (5)
                                    1-t     E [ i y i ]    E [ i y i ]

We additionally assume  i   is constant across individuals, and we retain this assumption

throughout the rest of this section. Then, equation (5) can be expressed more simply as:

                                                                          i
                                              t    -Cov g i , y
                                                              y¯
                                                 =               .                                                (6)
                                             1-t       

In words, expression (6) says that the optimal linear tax rate t is positive if the value society places
                                                                                                 i
on an additional unit of income is lower for higher-income individuals (Cov g i , y
                                                                                  y¯ < 0), and that

tax rate is larger the more that value declines with income. On the other hand, the optimal linear

tax rate is smaller the greater the elasticity (and thus efficiency costs) of taxation (i.e., the larger

is  ). Equations (5) and (6) closely resemble the many-person Ramsey tax rule for the optimal

redistributive linear commodity tax, as derived in Diamond (1975).

       This paper is motivated by the observation that result (6) is obtained under the assumption

that its terms are known with certainty by the tax authority. In reality, the parameters on the

right-hand side of this expression are estimable only with great uncertainty, if at all. We turn now

to understanding how robust optimal linear taxation manages that uncertainty.


1.1.2      Adding uncertainty: the fully pre-specified robust optimum

Now, we consider a setting in which multiple possible states of the world, indexed by s = {1, 2, ..., S },

arise with perceived probabilities s , where s s = 1.12 Each state corresponds to different realized

values of the components of expression (6) over which the tax authority is uncertain when designing

policy. Individuals' indirect utility from a given tax policy may now differ across states, denoted

Vsi (1 - t, b), and as a result, marginal welfare weights are also now state-specific:

                                                              dVs i

                                                    i          db
                                                   gs =               .
                                                               
  12
    Here we interpret s as the probilities of each state as perceived by the policymaker, whether arising from a known
probability distribution or (more likely) subjective uncertainty based on the policymaker's assessment of empirical
evidence or aggregation of divergent views from experts.


                                                          8
Note that at the optimum, the policy maker is indifferent between marginal spending on public funds
                                                                                                                 dVs i
and a marginal increase in the pre-specified lump-sum grant, implying  =                                    i
                                                                                              s s        i ps     db     .
                                                                                                 i,
Incomes, population shares, and elasticities of taxable income are also state-specific, denoted ys

pi       i                                                       i
 s , and s . We denote the within-state average of any variable xs as x
                                                                      ¯s =                            i i
                                                                                                  i p s xs ,   and the

across-state average as x
                        ¯=        s s x
                                      ¯s .

    The tax authority must specify one tax system {b , t } that will apply regardless of which state

obtains; asterisks are used to denote the robust optimal tax policy. Conceptually, we have in mind

choosing a tax policy that is expected to apply, unchanged, over a long time horizon, so we abstract

from concerns about transition dynamics. The tax authority's objective is to maximize expected

social welfare as before, but now this maximization involves an expectation over states:


                                                 s       pi   i
                                                          s Vs (1 - t, b)                                            (7)
                                             s       i


    In our baseline derivation, we constrain the tax authority to a fully pre-specified, state-invariant

policy; that is, to a fixed linear rate t and lump-sum grant b(t) = t                      i i    - R. Note that
                                                                                 s s    i ps ys

framing the problem in this way implies that the budget constraint need bind only in expectation;

it effectively allows for transfers of resources across states s.13 An alternative--very plausible--

assumption is to require that the budget constraint must not be violated within each state. This

case necessarily requires that some parameter of the tax--most naturally, the budget constraint

b--is state-contingent; we consider this possibility below in Section 1.1.3.

    Before characterizing robust optimal policy, we note how our approach differs from some related

lines of research.

    In a series of contributions dating back three decades, Charles Manski has studied the problem

of "microeconomic" policymaking in the presence of uncertainty. He mentions the potential ap-

plication to settings of optimal taxation explicitly in Manski (2009) with the following remarkable

paragraph, which we quote in full:

      Research on optimal income taxation illustrates the problem. Stimulated by Mirrlees

      [1971], many theoretical studies have derived optimal tax schedules under the assump-
  13
     Importantly, although this setup implies some transfer of resources across states, it does not allow the tax
authority to choose state-specific lump-sum grants optimally, for example by increasing the grant in states where
labor disutility is high on average.


                                                          9
      tion that the planner knows how the tax schedule affects labor supply. However, our

      knowledge of the actual responsiveness of labor supply to income taxes remains limited,

      despite the strenuous effort of empirical economists to shed light on the matter. For

      this reason, among others, research on optimal income taxation has not played much of

      a role in practical analysis of tax policy.

This motivation is tightly related to our own. Despite this similarity, however, Manski proposes a

rather different method for policy selection. He notes that although one might act as a "Bayesian

planner" and choose policies which maximize expected welfare with respect to a subjective proba-

bility distribution over policy states, in some settings, the formation of that subjective distribution

may not be straightforward. Instead, he proposes a "minimax regret" procedure in which the plan-

ner seeks to ensure that welfare losses relative to the (ex post) optimal policy are not too large.

We view our work as complementary, exploring the optimal policy as a function of the subjective

probability distribution across states, in the event that such a distribution can be credibly formed.

    Separately, Hansen and Sargent (2001) introduce to macroeconomic theory the techniques of

robust optimal control in which the primary concern is to avoid worst-case scenarios (see Williams

2008). Formally, Hansen and Sargent's policymakers proceed as if they are playing a game against

a malevolent Nature that selects the worst realization of parameter or model uncertainty given the

chosen policy. As a result, the robust policy literature within macroeconomics typically emphasizes

maximin policy objectives. For concreteness and simplicity, we assume all concavity arises through

the individual's utility functions, and the policymaker is risk neutral in aggregate welfare across

states. Our expected social welfare approach therefore reacts less strongly to worst-case scenarios;

although such scenarios are naturally weighted more heavily due to the fact that marginal utility

of consumption is higher in bad states, the policymaker does not place additional weight (let alone

infinite weight) on those outcomes.14
  14
     The contrast between our approach and that of Hansen and Sargent is analogous to the contrast, pointed out
by Arrow (1973), between economists' conventional utilitarianism and the influential Difference Principle of Rawls
(1971). Rawls reasoned that individuals designing society's institutions from behind a veil of ignorance, and thereby
ignorant of their own positions within that society, would maximize the well-being of the worst-off individual in that
society. Arrow argued against this inference as reflecting too extreme a level of risk aversion, in particular relative
to Harsanyi's (1953; 1955) inference (using a similar thought experiment designed to emphasize impartiality) that
social welfare ought to be the probability-weighted sum of individual utilities within society. Thus our model takes
Arrow's view with respect to uncertainty over policy parameters. In principle, our approach can be extended to
incorporate risk aversion across states on the part of the policymaker by replacing the objective in equation (7)
                     i i       
with s s          i ps Vs (a, b ) , where  is a concave transformation; then the Hansen and Sargent (2001) notion of




                                                          10
    More similar to our approach is Kasy (2018), which advocates using machine learning tech-

niques to maximize expected welfare when parameters are uncertain with a Gaussian process prior

distribution. That paper applies its model to a simulation with health insurance copays and, con-

sistent with our results, finds that accounting for uncertainty has a substantial impact on optimal

policy.

    Returning to our analysis, applying the same perturbation method as above, we obtain par-

allel expected mechanical and behavioral effects, which we denote dM e and dB e . The expected

mechanical effect, analogous to equation (3) above, is


                                          dM e =        s            pi       i i
                                                                      s (1 - gs )ys dt .                                         (8)
                                                   s            i


The expected behavioral effect, analogous to equation (4) above, is

                                                                                  i
                                                                                dys
                                         dB e = -t         s            pi
                                                                         s             dt .                                      (9)
                                                       s
                                                                             d (1 - t)
                                                                    i


In this scenario with uncertainty, a necessary condition for optimality is that the tax authority does

not view such a perturbation as yielding a net welfare gain in expectation. Setting dM e + dB e = 0,
                                  i is homogeneous within states (denoted  ), the optimal t
and employing the assumption that s                                       s

is characterized by the following proposition.

Proposition 1. The optimal fully pre-specified robust linear income tax rate satisfies

                                                                                i
                                                    -Cov gs i , ys
                                             t                  y¯
                                               
                                                =                                        .                                      (10)
                                            1-t   ¯ 1 + Cov ¯
                                                               s y
                                                                 ,¯s
                                                                y  ¯


Proof. Setting dM e + dB e = 0 from equations (8) and (9), and rearranging, yields

                                                                                       i i i
                                           t           s s y
                                                           ¯s   -       s s         i ps gs ys
                                               =                                                 .                              (11)
                                         1 - t                      s s [s y
                                                                           ¯s ]

We can manipulate the second summation in the numerator as                                                i i i              i yi ] =
                                                                                                 s s   i ps gs ys   = Ei,s [gs  s
       i ]E [y i ] + Cov [g i , y i ].
Ei,s [gs                                                                           i ] = 1, the numera-
                                         Then using the fact that we normalize E [gs
           i,s s           s s
                                       i , y i ]. Similarly, the denominator can be decomposed as
tor of equation (11) reduces to -Cov [gs    s

robustness corresponds to the limiting case of extreme concavity in .


                                                                11
                                                                               ¯ and dividing the numerator
  s s [s y
         ¯s ]   = Es [s y
                        ¯s ] = Es [s ] Es [¯
                                           ys ] + Cov [s , y
                                                           ¯s ]. Factoring out 

and denominator by y
                   ¯ results in expression (10).

   To understand the adjustments the tax authority makes to achieve robustness in the face of

uncertainty, it is useful to compare the result in Proposition 1 with the expression for the optimal

linear tax rate without uncertainty in equation (6). The expressions are similar, with the exception
                          s y¯s
of the term 1 + Cov       ¯, y
                              ¯   in the denominator of equation (10). This term points to a key force

that determines robustly optimal policies: if elasticities are low in states of the world with high
                                    s y¯s
incomes--meaning that Cov           ¯, y
                                        ¯    < 0--then taxes are generally less distortionary, implying that

the optimal tax rate is higher than in a setting with certainty.

   To formalize the effect of robust policy, we compare the result in Proposition 1 to two natural

alternatives. The first is the "best estimate optimal linear tax rate," that is, the optimal linear

tax computed as if the policymaker's best point estimates (across states) of each parameter value

were known with certainty. To express this, we write the across-state, within-person average of a

parameter xi    ¯i =
           s as x
                                   i
                             s  s xs .   Then this policy can be found by substituting the best estimates

for each parameter into the expression for the optimal linear tax rate with certainty:

                                                                     ysi

                                             t         ¯i , Es
                                                  -Cov g             y
                                                                     ¯s
                                                =        ¯                 .                           (12)
                                            1-t          

   Alternatively, the tax authority might solve for the optimal linear tax rate given each possible

state of the world (using a state-specific version of 6) and then take the expectation of those values

across states. We denote the resulting policy with ¯  ¯ and refer to it as the "average optimal
                                                   b, t

linear tax rate," which satisfies:

                                                                 i             
                                                            i ys E [¯
                                                      -Cov gs
                                          ¯
                                          t                   y
                                                              ¯s  s ys ]
                                              = Es                             .                       (13)
                                         1-t¯              s Es [¯
                                                                 ys ]


   Comparing results (10), (13), and (12) reveals the main difference between robust optimal linear

taxes and the two alternatives.

   Mathematically, understanding this difference starts with the observation that expressions (10),

(13), and (12) are of nearly the same structure. That is, all three rates (t , t
                                                                               ¯, and t) depend in the



                                                         12
same directions on the same multiplicative terms: the product of the covariance (between welfare

weights and relative income) and mean income in the numerator and the product of the elasticity

of taxable income and mean income in the denominator. How they differ is in the level at which the

expectation over states is taken: at the level of these multiplicative terms for the robust optimal

rate t , at the level of the ratio of these terms for the average optimal rate t
                                                                               ¯, and at the level of

each factor within these terms for the best estimate optimal rate t. As a result, neither the average

optimal linear tax rate in (13) nor the best estimate linear tax rate in (12) utilizes information

most effectively to maximize expected welfare.

       Economically, the intuition behind the difference is that the robust tax policy is sensitive--to

the optimal degree--to complementarities in the effects of uncertainty's resolution across states.

For example, suppose there are three states s = {1, 2, 3}, and their elasticities are symmetrically

distributed, such as 1 = 0.25, 2 = 0.50, and 3 = 0.75. Suppose further that the high-elasticity

state also has a substantially greater average income than in the other states, such that Es [s y
                                                                                                ¯s ] >

E [s ] E [¯
          ys ]. In that case, the robust optimal rate reflects that the distortionary costs of taxation

are greater in expectation than what the best estimate optimal rate would suggest, because the

state in which the elasticity of taxable income is high is also that in which incomes are greater.15

The conceptual contrast between the robust optimal rate and the average optimal rate is more

subtle: while the former takes these complementarities into account separately in the numerator

and denominator, the latter takes them into account through (i.e., by taking the expectation over

states of) their ratio. If the values of the multiplicative terms in the numerator and denominator

are correlated across states, either positively or negatively, the average optimal linear tax rate will

respond not to the ratio of their expected values but to the expected value of their ratio, missing

opportunities for more sophisticated robustness to uncertainty.

       More colloquially, the robust optimal tax policy tries to protect against worst-case scenarios,

take advantage of best-case scenarios, and manage the cases in between, rather than just do best

in the expected case or choose a simple average of its best state-specific values.
  15
    If uncertainty is asymmetric in other ways--for example, if the distribution of elasticities has a mean greater
than its median--this difference between the robust optimal policy and the best estimate policy is potentially even
greater. And a similar logic applies to the terms in the numerator: to the extent that variation across states in
parameters generates asymmetric uncertainty in the welfare effects of taxation, the robust optimal policy will differ
from the best estimate policy.




                                                         13
1.1.3      The optimum when budgets must balance within each state

The fully pre-specified tax policy above is perhaps extreme in that it implies that resources can be

transferred across states. In many settings, this may be unrealistic; real productive capacity might

vary across states, for example, with no counterparty available to provide across-state insurance.

Therefore, we also consider a natural alternative assumption: that the budget constraint binds

within each state. This assumption introduces a complication, however, for it implies that some

feature of the tax schedule must be state-contingent, and the nature of that state-contingency must

be pre-specified. On the other hand, it does not seem realistic that the entire tax system can be

made state-contingent. (If it could, then the problem of robustness dissolves, as the fully optimal

tax policy is to simply select the optimal tax policy as a function of the parameters which arise in

each state.)

       We choose a middle ground: we assume that the tax rate t must be pre-specified (or, in the

analysis of nonlinear tax schedules to follow, the full schedule of marginal tax rates), whereas the

lump-sum grant b is allowed to adjust in each state to achieve budget balance: bs (t) = t                  i i    -
                                                                                                        i ps ys

R.16 This setting constrains the tax authority more severely than our previous setting, as it

disallows transfers of resources across states. Which setting is preferable depends on, among other

factors, how completely this model captures the total fiscal policy problem of the tax authority. If it

is viewed as a narrow portion--e.g., the part of the policymaking problem devoted to redistribution,

but separate from issues of trade, regulation, etc.--then the tax authority may be described as

choosing a fully pre-specified tax policy that is self-funding in expectation, with imbalances absorbed

elsewhere. On the other hand, if this model is viewed as an abstraction for the macroeconomy as a

whole, then the second setting may be preferable because it more accurately reflects the necessary

adjustment to the lump-sum transfer that the tax authority will have to make once the true state

obtains.

       In this setting, the tax authority must take into account that the chosen tax rate will have

implications for the lump-sum grant that vary--perhaps dramatically--by state. An implication of

this modification is that the marginal value of public funds may differ across states, since resources
  16
    Since this model takes a broad perspective of the tax and spending system as an integrated whole, this can be
loosely interpreted as government spending on social support and public services adjusting to balance the budget,
rather than a literal cash grant paid out to households.




                                                       14
cannot be reallocated to equate them. Since budget constraints now apply within each state, it is

useful to define the marginal value of public funds within each state:


                                             s =           pi    i
                                                            s  (Us ).                            (14)
                                                      i


This modification alters the expected mechanical effect of a small tax change, since the marginal

funds generated in state s are worth s / in expected public funds. Therefore the expected me-

chanical effect is now
                                                                   s
                              dM e =          s           pi
                                                           s
                                                                        i
                                                                     - gs  i
                                                                          ys dt .                (15)
                                         s
                                                                   
                                                      i

Likewise, the behavioral effect is also modified:

                                                      s                      i
                                                                           dys
                              dB e = -t           s                pi
                                                                    s             dt .           (16)
                                              s
                                                                        d (1 - t)
                                                               i


   Employing the same perturbation method as above, the robust optimal policy under within-

state budget balance is given by the following proposition:

Proposition 2. The optimal robust linear income tax rate when the budget constraint binds in

each state satisfies
                                                               i                  i
                                                   i , ys + Cov
                                             -Cov gs                          s ys
                             t                         y¯                      , y
                                                                                 ¯
                                   =                                                             (17)
                           1 - t       ¯ 1 + Cov          ¯s y¯s              s    ¯s y
                                                                                      ¯s
                                                           ¯, y¯    + Cov       ,   ¯y¯

Proof. Setting dM e + dB e = 0 from equations (15) and (16), and rearranging, yields

                                                                                 i i i
                              t              s s s y
                                                   ¯s     -  s s              i ps gs ys
                                  =                                                        .     (18)
                            1 - t                          s s [s s y
                                                                    ¯s ]

We then decompose the expectations using the definition of covariance to yield the expression in

the proposition.

   Compared to equation (10) above, equation (17) incorporates the state-specific marginal values

of public funds in both the numerator and the denominator. These additions capture two forces:

on the one hand, if increasing the tax rate generates extra revenue in states where marginal utilities

are high on average (large s ) then the tax should be higher; on the other hand, if increasing the

tax rate depresses income in those states especially strongly, it should be lower. These forces are

                                                          15
absent in the setting where resources can be transferred across states.


1.2      Nonlinear optimal taxation

We now remove the linearity restriction on the tax system to characterize robust optimal nonlinear

income taxes, thus connecting more closely to the main Mirrleesian literature.


1.2.1      Certainty benchmark

Individuals are now assumed to belong to a continuum of (possibly multidimensional) types. To

reflect this difference from the preceding section, we denote the continuous index of types by   ,

which is distributed according to F () with associated density f (). Individuals choose, taking the

tax system as given, a level of labor effort to maximize individual utility. The product of labor

effort and type is income y , which is distributed (conditional on the tax function T ) according to

HT (y ) with associated density hT (y ). Let  (y ) denote the compensated labor supply elasticity, and

we now generalize the theoretical model to allow for income effects as well, denoted  (y ). The

nonlinear income tax T (y ) is chosen by the tax authority to maximize social welfare subject to the

feasibility constraint        T (y )hT (y )dy  R, where R is exogenous public goods expenditure.

       As with the linear tax case, we use the perturbation method to derive our results. Consider

a small increase in the marginal tax rate d in an interval of size  around some earnings level

y  . The mechanical effect of this increase has three components. First, it raises revenues equal
            
to d       y  hT (z )dz   from those earning y  and more. Second, it directly reduces after-tax income
                                                                                   
among these individuals, with an effect on social welfare of d                    y  (-g (z )) hT (z )dz ,   where g (y ) is

(as before) the marginal social welfare weight on y -earners in terms of public funds. Third, this after-

tax income reduction for individuals with earnings above y  may cause them to raise their earnings

through an income effect, generating an increase in revenue for the tax authority. Denote this fiscal
                            -T (z )                                                                             T (y )
externality as d          y  1-T (z )  (z )hT (z )dz .                                  ^(y ) = g (y ) -
                                                         For notational simplicity, let g                      1-T (y )  (y )

denote the combination of the latter two effects.17 We can write the overall mechanical effect, then,

as:
                                                           
                                         dM = d               (1 - g
                                                                   ^(z )) hT (z )dz.                                   (19)
                                                         y
  17
    In the case of quasilinear utility, which we assumed in the linear tax case above but relax here, income effects are
absent and g^(y ) reduces to g (y ).


                                                              16
This tax increase also generates a behavioral effect, as y  -earners reduce their effort and, thereby,

generate a negative fiscal externality equal to

                                                        -T
                                     dB = d                 (y  )y  hT (y  ).                              (20)
                                                       1-T

At the optimum, the tax system is optimal only if the sum of these effects is zero. That is, if T (y )

is optimal, then the following condition on the marginal tax rate T (y ) holds:

                                                                    
                              T (y )           1
                                       =                               (1 - g
                                                                            ^(z )) hT (z )dz.              (21)
                            1 - T (y )   y (y )hT (y )          y


1.2.2   Adding uncertainty: the optimal fully pre-specified robust nonlinear tax

As in the linear setting, we now allow for uncertainty over the parameters that matter for optimal

taxation. In particular, we imagine that there are multiple possible states of the world indexed

by s, each arising with probability s such that                        s s   = 1. We denote uncertainty through

state-dependence of the individual type distributions Fs () and densities fs (), endogenous income

distributions Hs,T (y ) and densities hs,T (y ), compensated elasticities of taxable income and income

effects s (y ) and s (y ), and marginal welfare weights gs (y ). We assume that the tax authority

must pre-specify the entire tax function--that is, both the nonlinear income tax schedule T (y ) and

the lump-sum grant -T (0)--to apply in all states so that the tax authority's budget constraint is

satisfied in expectation:    s s    y   T (z )hs,T (z )dz  R.

   The perturbation method proceeds as before. Consider a small increase in the marginal tax

rate d in an interval of size  around some earnings level y  . The expected mechanical effect is

expression (19) modified for multiple states:

                                                           
                            dM e = d               s          (1 - g
                                                                   ^s (z )) hs,T (z )dz .                  (22)
                                               s         y

The expected behavioral effect is a similar modification of expression (20):

                                                        -T (y  )
                            dB e = d               s               s (y  )y  hs,T (y  )                    (23)
                                           s
                                                       1 - T (y  )




                                                           17
The sum of these expected effects must be zero under the robust optimal tax, so:

                                                      
                                 T  (y )     Es      y (1    -g
                                                              ^s (z )) hs,T (z )dz
                                           =                                         .              (24)
                               1 - T  (y )            yEs [s (y )hs,T (y )]

Again, it is useful to compare this result to the best estimate optimal tax policy,

                                                
                               T (y )          y Es [(1   -g
                                                           ^s (z ))] Es [hs,T (z )] dz
                                        =                                                ,          (25)
                             1 - T (y )            yEs [s (y )] Es [hs,T (y )]

and the average optimal tax policy,

                                                     
                                ¯ (y )
                                T                   y (1    -g
                                                             ^s (z )) hs,T (z )dz
                               1-T¯ (y ) = Es              ys (y )hs,T (y )
                                                                                     .              (26)


   As with the results (10), (12), and (13) in the linear case, the most noticeable difference among

results (24), (25), and (26) is the level over which the expectation across states is taken. The

robust optimal policy at income y takes into account the multiplicative interactions within states

between the compensated elasticity of taxable income and the density of the income distribution

at y as well as those between the marginal welfare weight at y and that density. In contrast, the

best estimate nonlinear income tax takes expectations of the factors within those multiplicative

terms, while the average optimal nonlinear tax policy turns on the ratio of those multiplicative

interactions within states. In words, the robust optimal policy appropriately reacts to how inputs

to the optimal policy function may build upon or offset each other in the various states of the

world; that is, how uncertainty across inputs to the model may exacerbate or mitigate the optimal

policy design problem.


1.2.3   The optimal robust nonlinear tax when budgets must balance within each state

As before, we now also consider a scenario in which the tax authority must balance its budget

within each state. Specifically, we require the tax authority to pre-specify the nonlinear income

tax schedule T (y ) which will apply across states, but we adjust the state-specific lump-sum grant

to ensure state-by-state budget balance. Formally, the expression for the state-specific lump-sum

grant is bs =   y>0 T (z )hs,T (z )dz   - R. This setting constrains the tax authority more severely than



                                                       18
our previous setting, as it disallows transfers of resources across states.

    Using same perturbation approach, we obtain expressions for the mechanical effect:

                                                      
                                                          s
                         dM e = d            s              -g
                                                             ^s (z ) hs,T (z )dz ,              (27)
                                         s          y     

    and the behavioral effect

                                                 s -T (y  )
                         dB e = d            s                s (y  )y  hs,T (y  ) .            (28)
                                     s
                                                  1 - T (y  )

In both expressions, the term s denotes the state-specific marginal value of public funds, which

measures the welfare impact of a small increase in the state-specific lump-sum grant.

    At the optimum, the following condition must hold:

                                                      
                             T  (y )     Es          y (s     -g
                                                               ^s (z )) hs,T (z )dz
                                       =                                              .         (29)
                           1 - T  (y )                yEs [s s (y )hs,T (y )]

    Expression (29) captures factors quite similar to those in expression (17): tax rates should be

higher if they generate more revenue when the state-specific marginal value of public funds s is

high (explaining its presence in the numerator); but tax rates should be lower if that marginal value

of public funds is high precisely when the elasticity of taxable is high (explaining the presence of

s in the denominator). For our simulations in Section 3 we consider both the case in which the

tax policy is fully pre-specified, and this case in which the lump-sum grant (or, more generally, the

total level of government spending) adjusts in each state to achieve balance.



2    Evidence on the extent of parameter uncertainty

In this section, we attempt to quantify some of the uncertainty to which the robust optimal tax

conditions of the previous section respond. We restrict our attention to the dimensions of un-

certainty over which we have relatively good information: that is, over the parameters for which

uncertainty is not as great. In particular, we start by focusing on what economists know--and don't

know--about the policy-relevant value(s) of the elasticity of taxable income. Then, we use recent

data on the tax system and income distribution to infer, for each possible value of that elasticity,


                                                         19
an underlying income-earning ability distribution. These exercises produce a joint probability dis-

tribution for the elasticity of taxable income and the income distribution, allowing us to simulate

and compare robust and benchmark optimal policies in the next section.

       We note, however, that we are including only a small portion of the risk, uncertainty, and igno-

rance18 that faces a tax designer using the optimal policy model above. In particular, we abstract

from the many non-tax factors that will affect the evolution of the income distribution, and we

assume certainty in normative judgments of optimal policy (i.e., in the pattern of welfare weights).

In reality, these other dimensions of limits to our understanding--and how they interact with each

other and the dimensions we do include--are likely to have additional substantial quantitative

implications for robust policy.


2.1      The elasticity of taxable income

To characterize beliefs on the long-term elasticity of taxable income, we turn to two sources of

evidence: the existing empirical literature, and a new survey of academic economists.


2.1.1      Existing literature on the elasticity of taxable income

A leading survey of the literature on the elasticity of taxable income--Saez, Slemrod, and Giertz

(2012)--summarizes the state of knowledge about this parameter's value over the horizon of rele-

vance to optimal tax theory: "Estimates of the elasticity of taxable income in the long run (i.e.,

exceeding a few years) are plagued by extremely difficult issues of identification, so difficult that we

believe that there are no convincing estimates of the long-run elasticity of reported taxable income

to changes in the marginal tax rate."19 Giertz (2010) reaches a similarly discouraging conclusion:

"In most ETI studies, it is more accurate to refer to estimated elasticities as either `short term'

or `longer term' (as opposed to `long term'). Long-term responses may be the most important but

could take many years before responses are fully observed. These types of changes (which may

include some human capital and occupation decisions as well as more traditional investment) are

currently beyond the scope of the ETI literature. For that reason, this article eschews the label
  18
    See the first footnote for a discussion of these three terms.
  19
    As do we, these authors note that the uncertainty surrounding the parameters on which their work focuses
extends to many areas of economics, writing: "Many of these problems are not unique to identifying the long-run
ETI, but apply to the estimation of all behavioral responses."



                                                      20
`long term' in favor of `longer term' in order to distinguish these estimates from short-term elastic-

ities while also recognizing that they are not truly long term." A similar point has been forcefully

made in a review of the gap between micro and macro estimates of labor supply elasticities by

Keane and Rogerson (2012).

    Lacking definitive evidence, what do economists believe is a reasonable value for this elasticity?

Three examples will serve to illustrate the range of beliefs. Diamond and Saez (2011) are skeptical

of substantial real responses to marginal income tax rates,20 concluding that "the elasticity e =

0.57 is a conservative upper bound estimate" and that a value of 0.9 would be "extremely high."

Giertz (2010) estimates values "from 0.78 to 1.46 over the longer term" of three to six years,

and thus Giertz (2009) considers values ranging from 0.2 to 1.0 for his calculations of the efficiency

consequences of tax reforms. Jones (2019) incorporates idea generation into the model and--though

he acknowledges substantial uncertainty--prefers parameterizations that imply a responsiveness of

aggregate income corresponding to elasticities as high as 2.36.21 More generally, the difficulty--

even impossibility--of taking into account truly long-term factors, such as changes to social norms

around work in response to taxation, strongly suggests to us that economists have very limited

knowledge of the policy-relevant value for this key parameter.


2.1.2     Novel survey evidence on the elasticity of taxable income

We also take a direct route to gauging economists' beliefs about the value of the ETI: we ask

them. We design a novel survey to elicit beliefs about this parameter, in which we ask the following

question:

        We would like to understand your beliefs on the long-term (uncompensated) elas-

        ticity of taxable income with respect to substantial changes in the marginal

        personal income "keep share" (that is, one minus the marginal tax rate).

        We are interested in both your belief about the most likely value of this elasticity and

        your uncertainty about that value, so we will ask you to assign probabilities to ranges

        of values.
  20
     Real responses are those that change income earned, not reported, and are the relevant ones for optimal tax
policy (because enforcement is a concern outside the theory).
  21
     These values are imputed by this paper's authors, using Jones's optimal top marginal tax rates from his Table
1 and the standard (see Diamond and Saez 2011) formula for the top marginal tax rate with a Pareto parameter
 = 1.5.


                                                       21
        · By "long term" we mean a time horizon for adjustment of at least 30 years.

        · By "substantial changes" we mean changes to marginal income tax rates greater

           than 5 percentage points.

        · Please answer with respect to the overall economy of the United States today.

      To aid intuition, you can imagine a tax reform that raised the entire schedule of federal

      marginal personal income tax rates in the United States by 7 percentage points, with

      any change in revenue being allocated pro-rata to current government spending. Please

      use the sliders below to indicate the probability you assign to each possible range of

      values for this parameter (they must sum to 1.00).

We then provide six ranges into which the ETI might fall, and we ask respondents to assign a

probability to each range, with final probabilities required to sum to 1. The full survey instrument

is shown in Figure 1.

   We note two features of this question. First, we describe in some detail the parameter about

which we are asking. Though perhaps tedious to the respondent, this detail is essential for eliciting

the right beliefs for our purposes. In particular, we emphasize that we are interested in the long-run

elasticity so that respondents will take into account some of the factors--such as human capital

accumulation and social norms adjustment--that short-term elasticity estimates may safely neglect.

Second, we elicit a full (subjective) distribution over these value ranges, rather than a specific point

estimate. This is crucial for exploring the implications of uncertainty for optimal policy, as we will

then be able to explore both the optimal policy which is robust to uncertainty across economists,

and also the robust policy that an individual economist should favor in view of their own subjective

uncertainty.

   We consider the range 0.30 to 0.50 to be the "central" range in our simulations, as it contains

the preferred point estimate from a number of recent prominent surveys (including Diamond and

Saez 2011, Chetty et al. 2011, Chetty 2012, and others).

   This paper reports results based on a small pilot survey with responses from nine prominent

public finance economists. The results of this pilot survey are shown in Figure 2, where we plot

the mean answer for each point in the discretized distribution.



                                                  22
2.1.3      Combining evidence on the elasticity of taxable income

The evidence on  shows that robust optimal tax policy design confronts both risk and uncertainty.

In particular, a robust tax policy designer faces not only the risk posed by the distribution over the

possible values for  that any individual researcher will suggest, but also the uncertainty posed by

disagreement over that distribution across researchers. In principle, robust optimal policy might

respond differently to these two types of limits to understanding.

       We will simplify matters and treat risk and uncertainty in the same formal manner: that is,

both are managed through expected social welfare maximization. Different possible probability

distributions are simply weighted (perhaps uniformly, though differential credence could generate

a motive for variation) and summed, yielding a single probability distribution used as the basis for

robust policy.


2.2      The shape of the income distribution

A second source of uncertainty in the optimal tax model is the long-term shape of the income

distribution and how it varies with the elasticity of taxable income. Forecasting the evolution

of aggregate income, much less its distribution, is notoriously difficult, as it requires anticipating

major forces--such as technological and cultural changes--whose underlying drivers are poorly

understood.

       We will focus on a narrow slice of the broad uncertainty over the income distribution's shape:

the range of possible current underlying income-earning ability distributions that is implied by

different plausible values for the elasticity of taxable income. Given an observed income distribu-

tion, an existing tax system, and a model of the individual labor supply decision, we can infer a

current underlying distribution of income-earning abilities for each value of the elasticity of taxable

income.22

       These current underlying ability distributions are all consistent with one existing income dis-

tribution, given the existing tax system, but if the tax system is changed they will translate into

different income distributions. That is, when we reverse the inference process that yielded these

ability distributions, instead plugging them into the model of individual labor supply with a new
  22
    We are assuming that income is the product of these abilities and labor supply as determined by the individual's
optimization.



                                                        23
tax system, we will obtain a new income distribution for each value of the elasticity of taxable

income. We can then feed the joint probability distribution of these pairs of elasticities and income

distributions into the robust optimal tax model from the previous section.

       Formally, consider the individual utility maximization problem: maxyi U ci , y i , where ci =

y i - T y i , using the same notation as in the linear case above. To relate our results to the large

existing literature on optimal taxation without income effects, we assume that the individual utility

function takes the Type 1 form from Saez (2001):

                                                                             1+1/
                                                             1          yi
                                 U ci , y i = G ci -                                ,                             (30)
                                                          1 + 1/        wi

where G is a concave transformation and the parameter  controls the ETI and is equal to it

when the tax schedule is locally linear.23 This type of utility function is often used to represent a

"constant ETI" economy, and in practice the true ETI is very close to  even with curvature, so

to implement our numerical simulations, we set  equal to the ETI values reported in the survey.

The individual's first-order condition is therefore

                                                                          1
                                                                    -    1+
                                         wi = y i 1 - T        yi             .                                   (31)


To obtain T (y ), we calibrate the current U.S. tax system using the empirical mapping between

a broad measure of market income and consumption, as reported in Piketty, Saez, and Zucman

(2018). This measure thus incorporates broad features of the tax and transfer system including

not only income taxes at all levels, but also other tax credits and phaseouts, in-kind transfers and

other social support programs, and an accounting of distributed public goods.

       We again use the income distribution from Piketty, Saez, and Zucman (2018) to calibrate the

status quo income distribution. Using the calibrated status quo tax function TU S and the status

quo income distribution HTU S (y ), we can compute an underlying implied ability distribution using

the first-order condition in (31) for any assumed value of the parameter  . More generally, if the
  23
    When the tax function is locally curved (i.e., T = 0), the ETI that is relevant for tax policy differs from the
structural parameter. Intuitively, a change in the marginal tax rate induces an adjustment in y , which further changes
the marginal tax rate due to the curved tax function, inducing a further adjustment in y , and so on. The ETI 
is defined to include the full effect of this iteration. See equation (68) in Appendix C for the precise relationship
between  and .




                                                          24
policymaker faces an uncertain distribution of possible elasticity values, this procedure permits

us to compute a separate underlying ability distribution in each case, which can then be used to

compute an optimal expected tax function in the face of such uncertainty. We next compute the

results of such an exercise, for a range of assumptions about the elasticity of income with respect

to tax rates.

    We emphasize that this uncertainty represents a narrow slice of the broad uncertainty that exists

over the future shape of the income and income-earning ability distributions. The process by which

the mean level, much less the variance, of human capital changes over time is poorly understood.

And different historical periods have seen dramatically different trends in growth and inequality

for which differences in tax policy (which would be captured in our calibration) are unlikely to

be the primary, much less only, determining factor. An important task for further research is to

incorporate the scope of uncertainty in this dimension of the model, for example by allowing for a

range of paths for the underlying ability distribution as implied by past data.



3    Quantitative results

In this section, we use the optimality conditions and calibration procedures described above in

order to demonstrate the effect of parameter uncertainty on optimal tax results. In other words,

for a given assumption about the average value of a model parameter--in this case, the elasticity

of taxable income--what is the effect of uncertainty on the optimal tax schedule?

    Here we continue to employ the individual utility function in equation (30). To account for

the agent's diminishing marginal utility of consumption (or, equivalently in this model, the pol-

icymaker's degree of inequality aversion), an assumption must be made about the shape of the

concave transformation G. As Saez (2001) notes, this concavity can be described in a transparent
                                                                                         1+1/
                                                                               1    yi
way using "social marginal welfare weights" g i , proportional to G   ci -   1+1/   wi
                                                                                                at the

optimum. In our baseline simulations, we use a logarithmic functional form G(x) = ln(x).

    Note that we focus on uncertainty over the ETI in particular, but in principle one may wish

to consider uncertainty over the concave transformation G, or over the future income distribution,

as discussed above. Additionally, there may be uncertainty about whether individuals successfully

maximize their own utility, or whether they are subject to misperception or other behavioral fric-


                                                 25
tions.24 We restrict our focus to uncertainty about the ETI in order to provide a tractable and

concrete illustration with new data elicited from economists about the value of this well-known

parameter, but we view the extension of uncertainty to other aspects of the model, including its

normative features, as an important task for further research.

    We first consider a simple example of an economy with two types--a low income-earning ability

type and a high income-earning ability type, chosen to correspond to the 25th and 75th percentiles

of the U.S. income distribution--and a linear tax system. In this example, we consider an economy

in which the planner's subjective distribution of  is discrete, consisting of just two values:  = 0.1

with probability 0.7, and  = 1.1 with probability 0.3, for an overall expected value of  = 0.4.

In this setting, we compare the best estimate policy to the robust policy under the two different

assumptions about the budget constraint discussed in Section 1, where either the tax policy is fully

pre-specified (with the budget constraint binding in expectation), or else the budget must balance

in each state by adjusting the lump-sum grant. The optimal linear tax rates and lump-sum grants

for these specifications are reported in Table 1. From this simple example, we note three features of

the optimal tax regimes: (i) robustness generally increases tax rates and lump-sum grants, resulting

in a more progressive tax system; (ii) enforcing within-state budget constraints generally decreases

tax rates, reducing the progressive effect of robustness; and (iii) state-specific lump-sum grants are

decreasing in the elasticity, as income and consequently revenue decline more in those states.25

    We next perform simulations in a more complex setting, where we compute the optimal fully

nonlinear tax. Details of the implementation are discussed in Appendix C. In these simulations,

we calibrate the economy at the status quo with the modern U.S. income and consumption distri-

butions. We revisit the distribution of states considered above:  = 0.1 with probability 0.7, and

 = 1.1 with probability 0.3. Features of the optimal best estimate and robust tax policies are

plotted in Figure 3. Panel (a) displays the optimal schedule of marginal tax rates computed under

the best estimate specification, comparing it to the fully pre-specified robust tax schedule and the
   24
      Many papers have studied the implications of behavioral frictions for optimal income taxation. See Rees-Jones
and Taubinsky (2018) for a broad discussion. For examples of specific applications, see Allcott, Lockwood, and
Taubinsky (2018) for a model with less-than-fully salient income taxes, and Lockwood (2020) for a model with
present-biased workers.
   25
      We note that the key driver of these comparisons is that the optimal tax rate in every case is substantially higher
in the status quo, implying that a higher ETI results in lower total income. If instead the policy were considered
from the perspective of a status quo with higher-than-optimal tax rates, the high ETI states would instead generate
more income.



                                                           26
within-state budget-balancing robust tax schedule. Because marginal tax rates are pre-specified in

each setting, these schedules are not sensitive to the ETI which actually obtains. Panel (b) plots

the schedule of average tax rates in each setting. In the within-state budget balance setting, the

lump-sum grant depends on which ETI turns out to obtain, and so the schedule of average tax rates

in that setting is state-dependent. To retain legibility in the plot, we display only the expected

schedule of average tax rates, rather than the schedule in each state. Finally, Panel (c) plots the

difference in average tax rates under the robust policy relative to the best estimate policy, in both

the fully pre-specified setting and the within-state budget balance setting. (For the latter case, we

also plot the difference in average tax rates within each state.)

   To explore the impact of even greater skewness in the subjective distribution, Figure 4 plots

results for a subjective distribution in which  takes the values of 0.1, 0.2, and 2.6 with probabilities

0.4, 0.5, and 0.1, respectively, resulting in the same average value of  = 0.4.

   We note two patterns which are apparent from these simulations with a fully nonlinear tax.

   First, the shape of the optimal tax schedule remains broadly similar with and without robust-

ness, generally retaining the trademark U-shape discussed in Diamond (1998) and Saez (2001).

The shape changes more as the distribution of  becomes more skewed, as demonstrated in Figure

4, where the U-shape spans a narrower range of incomes under the robust optimal tax schedules.

Under both distributions of  , the tax schedules under within-state budget constraints depart less

strongly from the certainty benchmark. In some cases, the shape of the robust optimal tax sched-

ule appears somewhat smoother than the best estimate tax. For example, the "jaggedness" of the

best estimate tax schedule in Figure 3, panel (a), just below $50,000 and $100,000 appears less

pronounced in the robust schedules. This smoothness is directly tied to the policy's recognition of

uncertainty. If there is a concentration of the population density at a specific point in the income

distribution, and thus income-earning ability distribution, the optimal tax schedule under certainty

will feature a dip at the point of that higher density in order to reduce distortionary marginal

tax rates for that high density of workers. On the other hand, if the elasticity is uncertain, the

location of that point of population density under a reformed tax schedule is less predictable and

so the depressing effects on optimal tax rates are more diffuse. In Figure 3, this feature is visible

at incomes below $100,000, where a large majority of the population is concentrated in each state.

This result, however, does not always obtain: for instance, under the high degree of skewness in the

                                                  27
distribution of  in Figure 4, this smoothness is masked by a steep increase in rates across incomes

above $50,000 driven by the large probability placed on low values of  .

   The second key pattern from Figures 3 and 4 is that the robust tax schedule is more progressive.

This pattern is particularly apparent from panel (c) in each figure: when the lines slope upward,

that is an indication that average tax rates are higher for high earners relative to low earners

under robustness. This "progressivity effect" has a somewhat subtle source. Starting with a

given tax policy, states in which the elasticity  is higher will have income distributions that are

shifted downward relative to those with lower elasticities. High-elasticity states are also those in

which taxes are particularly distortionary, so optimal marginal tax rates in those states are low.

Thus, a policy designed to apply across all states will account for the covariance between these

parameters and optimally impose lower marginal tax rates at lower incomes and higher rates at

higher incomes, yielding an optimal tax rate schedule that is more progressive than under the best

estimate tax policy. An illuminating subtlety is that when the budget constraint binds in each

state--and thus resources cannot be moved across states--the realized robust optimal tax policy

is not always more progressive, as seen in Figure 3 when  = 1.1. Due to the lower levels of tax

revenue and consequently smaller lump-sum grants generated in higher elasticity states, the tax

policy optimized under uncertainty is less progressive when those states are realized. Nevertheless,

the tax schedule remains generally more progressive in expectation under uncertainty even when

the budget constraint must be satisfied in each state.

   While the examples in Figures 3 and 4 are illustrative, for our preferred estimates of the robust

tax policy, we rely on our survey data, discussed in Section 2.1.2, elicited from public finance

economists. Figure 2 plots the ETI distribution obtained by averaging those distributions, and

Figure 5 plots the optimal tax schedules generated using this distribution. Specifically, we assume

the parameter  may take each of six different values corresponding to intervals we specified in

the survey (0.10, 0.20, 0.40, 0.75, 1.50, and 2.50), with probabilities corresponding to the average

across respondents (normalized to ensure a sum of 100%). This procedure results in a less skewed

distribution of  than that which we assumed earlier. As a consequence, while the robust optimal

income tax policy remains more progressive and better for welfare than the best estimate optimal

policy, it is also more similar to the best estimate policy than in Figures 3 and 4.

   In each setting, we estimate the expected annual money-metric welfare gain from replacing

                                                 28
the best-guess optimum with the robust optimal income tax (under the same budget constraint

assumption). The welfare gain is higher when the budget constraint binds in expectation--allowing

for welfare-increasing transfers of resources across states--than it is when budget constraints bind

in each state. Under our preferred calibration using our survey of economists, the gains are the most

modest, at 1.1% and 0.2% of consumption, or $190 billion and $54 billion, under the constraints

that bind in expectation and each state, respectively.26

    Although using the robust optimal policy increases welfare in expectation both in the fully pre-

specified setting and when the budget constraint binds in each state, in the latter setting the gains

are unequal across states, and using the robust optimal policy may even decrease welfare when

the ETI turns out to be very high. Figure 6 plots the welfare gain (or loss) in each state under

our baseline calibration. When the budget constraint binds in expectation, the welfare effect of

adopting the robust policy is positive in every state, and increases monotonically in the elasticity.

This increase reflects the fact that the more progressive robust policy results in a higher lump-sum

grant, which generates particularly large gains in the high ETI states where the marginal value

of consumption is higher. Under within-state budget constraints, the lump-sum grant is larger

in low elasticity states and smaller in high elasticity states under the robust policy, causing the

welfare effect to generally decrease in the elasticity. However, due to the crossing of the best

estimate and robust marginal tax rate schedules around $50,000 in income, the lower marginal

tax rates under the robust policy below that threshold, and the downward-shifting of the income

distribution as the elasticity increases, the change in revenue from adopting the robust policy does

not necessarily monotonically decrease in the elasticity. As a result, the decrease in the lump-

sum grant from adopting the robust policy is greater when  = 1.5 than in the highest elasticity

state. Consequently, the welfare losses from robustness are estimated to be the largest in that state.

These potential welfare losses in higher elasticity states result in lower expected welfare gains under

within-state budget constraints than under the constraint that binds in expectation.
  26
     For comparison, we also compute these expected welfare gains under the illustrative distributions used for the
simulations in Figures 3 and 4. The welfare effect increases in the skewness of the distribution of  since the robust
policy is relatively more efficient at targeting tax rates across incomes when the discrepancy between the elasticities
in each state and the best estimate of the elasticity is greater. In the setting of Figure 4, the welfare gains are the
largest, estimated at 4.0% and 1.3% of consumption, or $724 billion and $288 billion, when the budget constraint
binds in expectation and in each state, respectively. Under less skewness in the distribution of  as in Figure 3, the
estimated welfare gains are 2.1% and 0.4% of consumption, or $380 billion and $127 billion, respectively.




                                                          29
4    Conclusion

In this paper, we propose a method by which to design economic policy analyses for robustness

to uncertainty over the models and parameters at their core. We apply this method to the topic

of optimal income taxation in the Mirrleesian tradition and use both existing and novel empirical

evidence on the range of professional economists' beliefs over the value of the elasticity of tax-

able income to introduce uncertainty into the analysis. We characterize--both analytically and

quantitatively--robust optimal income taxes and compare them to benchmark results, suggesting

that this method might be fruitfully applied to a wide range of economic policies.




                                                30
References

Allcott, Hunt, Benjamin Lockwood, and Dmitry Taubinsky. 2018. "Ramsey Strikes Back: Optimal

  Commodity Tax and Redistribution in the Presence of Salience Effects." AEA Papers and

  Proceedings 108:88­92.

Arrow, Kenneth J. 1973. "Rawls's Principle of Just Saving." The Swedish Journal of Economics

  75 (4):323­335.

Bargain, Olivier, Mathias Dolls, Dirk Neumann, Andreas Peichl, and Sebastian Siegloch. 2014.

  "Tax-Benefit Revealed Social Preferences in Europe and the US." Annals of Economics and

  Statistics (113/114):257­289.

Bourguignon, Fran¸
                 cois and Amedeo Spadaro. 2012. "Tax­Benefit Revealed Social Preferences."

  The Journal of Economic Inequality 10 (1):75­108.

Chetty, Raj. 2012. "Bounds on Elasticities with Optimization Frictions: A Synthesis of Micro and

  Macro Evidence on Labor Supply." Econometrica 80 (3):969­1018.

Chetty, Raj, Adam Guren, Day Manoli, and Andrea Weber. 2011. "Are Micro and Macro Labor

  Supply Elasticities Consistent? A Review of Evidence on the Intensive and Extensive Margins."

  American Economic Review 101 (3):471­75.

Diamond, Peter and Emmanuel Saez. 2011. "The Case for a Progressive Tax: From Basic Research

  to Policy Recommendations." Journal of Economic Perspectives 25 (4):165­90.

Diamond, Peter A. 1975. "A Many-Person Ramsey Tax Rule." Journal of Public Economics

  4 (4):335­342.

Diamond, Peter A. 1998. "Optimal Income Taxation: An Example with a U-Shaped Pattern of

  Optimal Marginal Tax Rates." American Economic Review 88 (1):83­95.

Giertz, Seth. 2009. "The Elasticity of Taxable Income: Influences on Economic Efficiency and Tax

  Revenues, and Implications for Tax Policy." In Tax Policy Lessons from the 2000s, edited by

  Alan Viard. Washington, D.C.: AEI Press, 101­136.



                                              31
------. 2010. "The Elasticity of Taxable Income during the 1990s: New Estimates and Sensitivity

  Analyses." Southern Economic Journal 77 (2):406­433.

Hansen, Lars Peter and Thomas J Sargent. 2001. "Acknowledging Misspecification in Macroeco-

  nomic Theory." Review of Economic Dynamics 4 (3):519­535.

Harsanyi, John C. 1953. "Cardinal Utility in Welfare Economics and in the Theory of Risk-Taking."

  Journal of Political Economy 61 (5):434­435.

------. 1955. "Cardinal Welfare, Individualistic Ethics, and Interpersonal Comparisons of Utility."

  Journal of Political Economy 63 (4):309­321.

Jones, Charles I. 2019. "Taxing Top Incomes in a World of Ideas." NBER Working Paper No.

  25725.

Kasy, Maximilian. 2018. "Optimal taxation and insurance using machine learning--Sufficient statis-

  tics and beyond." Journal of Public Economics 167:205­219.

Keane, Michael and Richard Rogerson. 2012. "Micro and Macro Labor Supply Elasticities: A

  Reassessment of Conventional Wisdom." Journal of Economic Literature 50 (2):464­76.

Lockwood, Benjamin B. 2020. "Optimal Income Taxation with Present Bias." American Economic

  Journal: Economic Policy 12 (4):298­327.

Lockwood, Benjamin B. and Matthew Weinzierl. 2016. "Positive and Normative Judgments Implicit

  in US Tax Policy, and the Costs of Unequal Growth and Recessions." Journal of Monetary

  Economics 77:30­47.

Manski, Charles F. 2009. "Social Planning with Partial Knowledge of Social Interactions." Journal

  of Institutional and Theoretical Economics (JITE)/Zeitschrift f¨
                                                                 ur die gesamte Staatswissenschaft

  :146­158.

Mirrlees, James A. 1971. "An Exploration in the Theory of Optimum Income Taxation." The

  Review of Economic Studies 38 (2):175­208.




                                                 32
Nordhaus, William. 2007. "The Challenge of Global Warming: Economic Models and Environmen-

  tal Policy." URL http://www.econ.yale.edu/~nordhaus/homepage/OldWebFiles/DICEGAMS/

  dice_mss_072407_all.pdf.

Piketty, Thomas, Emmanuel Saez, and Gabriel Zucman. 2018. "Distributional National Accounts:

  Methods and Estimates for the United States." Quarterly Journal of Economics 133 (2):553­609.

Rawls, John. 1971. A Theory of Justice. Cambridge, MA: Belknap Press of Harvard University

  Press.

Rees-Jones, Alex and Dmitry Taubinsky. 2018. "Taxing Humans: Pitfalls of the Mechanism Design

  Approach and Potential Resolutions." Tax Policy and the Economy 32 (1):107­133.

Saez, Emmanuel. 2001. "Using Elasticities to Derive Optimal Income Tax Rates." The Review of

  Economic Studies 68 (1):205­229.

Saez, Emmanuel, Joel Slemrod, and Seth H. Giertz. 2012. "The Elasticity of Taxable Income with

  Respect to Marginal Tax Rates: A Critical Review." Journal of Economic Literature 50 (1):3­50.

Saez, Emmanuel and Stefanie Stantcheva. 2016. "Generalized Social Marginal Welfare Weights for

  Optimal Tax Theory." American Economic Review 106 (1):24­45.

Seade, Jesus K. 1977. "On the Shape of Optimal Tax Schedules." Journal of Public Economics

  7 (2):203­235.

Sheshinski, Eytan. 1972. "The Optimal Linear Income-tax." The Review of Economic Studies

  39 (3):297­302.

Weinzierl, Matthew. 2014. "The Promise of Positive Optimal Taxation: Normative Diversity and

  a Role for Equal Sacrifice." Journal of Public Economics 118:128­142.

------. 2018. "Revisiting the Classical View of Benefit-based Taxation." The Economic Journal

  128 (612):F37­F64.

------. 2019. "A Welfarist Role for Nonwelfarist Rules [plus a preview of The Golden Rule of

  Taxation]." Working Paper.


                                              33
Williams, Noah. 2008. "Robust Control." New Palgrave Dictionary of Economics 2 (6).

Zeckhauser, Richard. 2014. "New Frontiers Beyond Risk and Uncertainty: Ignorance, Group De-

  cision, and Unanticipated Themes." In Handbook of the Economics of Risk and Uncertainty.

  Oxford, UK: Elsevier.




                                             34
                             Table 1: Linear tax illustration with two types

                                                       t                           b
      1   Status quo                                16.9%                  $12,848
      2   Best estimate, fully pre-specified        33.9%                  $13,982
      3   Robust, fully pre-specified               35.9%                  $14,741
      4   Best estimate, within-state balance       33.9%     $14,975 ( = 0.1) $11,914 ( = 1.1)
      5   Robust, within-state balance              34.9%     $15,426 ( = 0.1) $12,072 ( = 1.1)
Notes: This table reports the status quo and optimal linear tax rates under a given average value of the
structural elasticity parameter  , but for different assumptions about uncertainty, in a simple setting with
two income-earning ability types. In the status quo, the low-ability type earns the 25th percentile income
from the modern U.S. income distribution, while the high-ability type earns the 75th percentile income. Each
type's consumption is equal to the empirical consumption that corresponds to its income, adjusted by the
same lump-sum to ensure the budget is balanced in the status quo and the exogenous revenue requirement
is zero given a linear tax system. Each type constitutes 50% of the population. In row 1, the status quo
linear tax t and lump-sum grant b are reported. In row 2, the optimal linear tax under the policymaker's
best estimate of  = 0.4 and a budget constraint that binds in expectation is reported with a pre-specified
grant. In row 3, the robust optimal linear tax under the policymaker's belief that there is a 70% chance that
 = 0.1 and a 30% chance that  = 1.1 and a budget constraint that binds in expectation is reported with
a pre-specified grant. In row 4, the optimal linear tax under the policymaker's best estimate of  = 0.4 and
within-state budget constraints is reported with state-specific grants. In row 5, the robust optimal linear tax
under the same beliefs as in row 3 and within-state budget constraints is reported with state-specific grants.




                                                      35
Figure 1: Pilot Survey Question




              36
    Figure 2: Probability Distribution of the Elasticity of Taxable Income (Pilot Survey Data)


                                       0.4




                    Mean probability   0.3




                                       0.2




                                       0.1




                                        0
                                             < 0.1   0.1-0.3   0.3-0.5   0.5-1.0   1.0-2.0   > 2.0
                                                        Elasticity of taxable income

Notes: This figure plots the mean probability assigned to each range of values of the long-term uncompensated
elasticity of taxable income for which we elicited beliefs in our survey of academic economists. Data are
based on a pilot survey of nine public finance economists.




                                                                    37
                                       Figure 3: Optimal Tax Schedules Under Parameter Uncertainty
                                                                               (a) Optimal Tax Rate Schedules

                                                                    0.8

                                                                    0.7


                                                Marginal tax rate
                                                                    0.6

                                                                    0.5

                                                                    0.4

                                                                    0.3                                                           Best estimate
                                                                                                                                  Robust, fully pre-specified
                                                                                                                                  Robust, within-state balance
                                                                    0.2
                                                                          0    50     100       150                200                       250        300     350
                                                                                            Income ($1000s)

                               (b) Optimal Average Tax Rates                                                                                 (c) Change in Average Tax Rates

                    0.6                                                                                                          0.16

                                                                                                                                 0.12
                                                                                                       Average tax rate change




                    0.4
                                                                                                                                 0.08
 Average tax rate




                    0.2                                                                                                          0.04

                                                                                                                                     0
                      0                                                                                                          -0.04

                                        Best estimate, fully pre-specified                                                       -0.08                                 Fully pre-specified
                    -0.2                Best estimate, within-state balance, expectation                                                                               Within-state balance, = 0.1
                                        Robust, fully pre-specified                                                              -0.12                                 Within-state balance, = 1.1
                                        Robust, within-state balance, expectation                                                                                      Within-state balance, expectation
                    -0.4                                                                                                         -0.16
                           0     50   100     150                    200      250   300   350                                            0         50    100     150     200       250       300       350
                                            Income ($1000s)                                                                                                   Income ($1000s)


Notes: Panel (a) of this figure plots optimal marginal tax rates under a given average value of the structural
elasticity parameter  , but for different assumptions about uncertainty. The line labeled "Best estimate"
plots the tax schedule optimized under the certain value  = 0.4. In the "fully pre-specified" case, the lump-
sum grant is specified so that the budget constraint binds when  = 0.4 and is $27,201. In the "within-state
balance" case, a lump-sum grant is specified in each of two elasticity states,  = 0.1 and  = 1.1, ensuring
within-state budget constraints bind. The grant received is $31,426 if  = 0.1 and $19,650 if  = 1.1. The
lines labeled "Robust" plot the robust optimal tax schedule when the policymaker is uncertain about the
elasticity of taxable income and either fully pre-specifies the tax or ensures within-state balance by satisfying
within-state budget constraints. The policymaker believes there is a 70% chance that  = 0.1 and a 30%
chance that  = 1.1. The pre-specified lump-sum grant is $28,322. The state-specific grant is $31,929 if
 = 0.1 and $18,105 if  = 1.1. Panel (b) plots the optimal average fully pre-specified tax rates and the
expectation of the average tax rates with within state balance. Panel (c) plots the differences in optimal
average tax rates between the "Best estimate" and "Robust" specifications.




                                                                                                  38
                                 Figure 4: Optimal Tax Schedules Under Parameter Uncertainty (Skewed)
                                                                               (a) Optimal Tax Rate Schedules

                                                                    0.8

                                                                    0.7


                                                Marginal tax rate
                                                                    0.6

                                                                    0.5

                                                                    0.4

                                                                    0.3                                                           Best estimate
                                                                                                                                  Robust, fully pre-specified
                                                                                                                                  Robust, within-state balance
                                                                    0.2
                                                                          0    50     100       150                200                       250        300     350
                                                                                            Income ($1000s)

                               (b) Optimal Average Tax Rates                                                                                 (c) Change in Average Tax Rates

                    0.6                                                                                                          0.16

                                                                                                                                 0.12
                                                                                                       Average tax rate change




                    0.4
                                                                                                                                 0.08
 Average tax rate




                    0.2                                                                                                          0.04

                                                                                                                                     0
                      0                                                                                                          -0.04
                                                                                                                                                                       Fully pre-specified
                                        Best estimate, fully pre-specified                                                       -0.08                                 Within-state balance, = 0.1
                    -0.2                Best estimate, within-state balance, expectation                                                                               Within-state balance, = 0.2
                                        Robust, fully pre-specified                                                              -0.12                                 Within-state balance, = 2.6
                                        Robust, within-state balance, expectation                                                                                      Within-state balance, expectation
                    -0.4                                                                                                         -0.16
                           0     50   100     150                    200      250   300   350                                            0         50    100     150     200       250       300       350
                                            Income ($1000s)                                                                                                   Income ($1000s)


Notes: Panel (a) of this figure plots optimal marginal tax rates under a given average value of the structural
elasticity parameter  , but for different assumptions about uncertainty. The line labeled "Best estimate"
plots the tax schedule optimized under the certain value  = 0.4. In the "fully pre-specified" case, the
lump-sum grant is specified so that the budget constraint binds when  = 0.4 and is $27,201. In the "within-
state balance" case, a lump-sum grant is specified in each of three elasticity states,  = 0.1,  = 0.2, and
 = 2.6, ensuring within-state budget constraints bind. The grant received is $31,426 if  = 0.1, $29,933
if  = 0.2, and $9,978 if  = 2.6. The lines labeled "Robust" plot the robust optimal tax schedule when
the policymaker is uncertain about the elasticity of taxable income and either fully pre-specifies the tax or
ensures within-state balance by satisfying within-state budget constraints. The policymaker believes there
is a 40% chance that  = 0.1, a 50% chance that  = 0.2, and a 10% chance that  = 2.6. The pre-specified
lump-sum grant is $29,845. The state-specific grant is $32,381 if  = 0.1, $29,813 if  = 0.2, and $8,827 if
 = 2.6. Panel (b) plots the optimal average fully pre-specified tax rates and the expectation of the average
tax rates with within state balance. Panel (c) plots the differences in optimal average tax rates between the
"Best estimate" and "Robust" specifications.




                                                                                                  39
                           Figure 5: Optimal Tax Schedules Under Parameter Uncertainty (Pilot Survey Data)
                                                                               (a) Optimal Tax Rate Schedules

                                                                    0.8

                                                                    0.7


                                                Marginal tax rate
                                                                    0.6

                                                                    0.5

                                                                    0.4

                                                                    0.3                                                           Best estimate
                                                                                                                                  Robust, fully pre-specified
                                                                                                                                  Robust, within-state balance
                                                                    0.2
                                                                          0    50     100       150                200                       250        300     350
                                                                                            Income ($1000s)

                               (b) Optimal Average Tax Rates                                                                                 (c) Change in Average Tax Rates

                    0.6                                                                                                          0.08

                                                                                                                                 0.06
                                                                                                       Average tax rate change




                    0.4
                                                                                                                                 0.04
 Average tax rate




                    0.2                                                                                                          0.02

                                                                                                                                     0
                                                                                                                                                                       Fully pre-specified
                      0                                                                                                          -0.02                                 Within-state balance, = 0.1
                                                                                                                                                                       Within-state balance, = 0.2
                                                                                                                                                                       Within-state balance, = 0.4
                                        Best estimate, fully pre-specified                                                       -0.04                                 Within-state balance, = 0.75
                    -0.2                Best estimate, within-state balance, expectation                                                                               Within-state balance, = 1.5
                                        Robust, fully pre-specified                                                              -0.06                                 Within-state balance, = 2.5
                                        Robust, within-state balance, expectation                                                                                      Within-state balance, expectation
                    -0.4                                                                                                         -0.08
                           0     50   100     150                    200      250   300   350                                            0         50    100     150     200       250       300       350
                                            Income ($1000s)                                                                                                   Income ($1000s)


Notes: Panel (a) of this figure plots optimal marginal tax rates under a given average value of the structural
elasticity parameter  , but for different assumptions about uncertainty. The line labeled "Best estimate"
plots the tax schedule optimized under the certain value  = 0.57, the expected value of the elasticity of
taxable income from our survey of economists. In the "fully pre-specified" case, the lump-sum grant is
specified so that the budget constraint binds when  = 0.57 and is $23,817. In the "within-state balance"
case, a lump-sum grant is specified in each elasticity state for which we elicited beliefs in our survey, ensuring
within-state budget constraints bind. The grant received is $28,140 if  = 0.10, $27,144 if  = 0.20, $25,273
if  = 0.40, $22,342 if  = 0.75, $17,214 if  = 1.50, and $12,211 if  = 2.50. The lines labeled "Robust" plot
the robust optimal tax schedule when the policymaker is uncertain about the elasticity of taxable income and
either fully pre-specifies the tax or ensures within-state balance by satisfying within-state budget constraints.
The policymaker has the average belief of the economists from our survey, where there is a 11.7% chance
that  = 0.10, a 21.3% chance that  = 0.20, a 33.8% chance that  = 0.40, a 21.0% chance that  = 0.75, a
8.4% chance that  = 1.50, and a 3.8% chance that  = 2.50. The pre-specified lump-sum grant is $24,281.
The state-specific grant is $28,536 if  = 0.10, $27,311 if  = 0.20, $25,067 if  = 0.40, $21,697 if  = 0.75,
$16,266 if  = 1.50, and $11,478 if  = 2.50. Panel (b) plots the optimal average fully pre-specified tax rates
and the expectation of the average tax rates with within-state balance. Panel (c) plots the differences in
optimal average tax rates between the "Best estimate" and "Robust" specifications.

                                                                                                  40
                   Figure 6: Welfare Gains from Robustness (Pilot Survey Data)


                                                  300

                                                  250

                                                  200
                    Welfare effect ($ billions)
                                                  150

                                                  100

                                                   50

                                                    0

                                                   -50

                                                  -100

                                                  -150            Gains from robustness, fully pre-specified
                                                                  Gains from robustness, within-state balance
                                                  -200
                                                         Expectation   = 0.1       = 0.2       = 0.4        = 0.75   = 1.5    = 2.5
                                                                       = 0.12      = 0.21      = 0.34       = 0.21   = 0.08   = 0.04


Notes: This figure plots the estimated annual money-metric welfare effect of switching from the best estimate
income tax policy to the robust optimal income tax policy when each state of  --with associated probability
 --obtains and in expectation. The policymaker has the average belief about  of the academic economists
from our survey. The fully pre-specified best estimate policy, with a lump-sum grant specified so that the
budget constraint binds when  is equal to its best estimate, is compared to the fully pre-specified robust
optimal policy with a lump-sum grant specified so that the budget constraint binds in expectation. The
best estimate policy, with state-specific lump-sum grants specified so that budget constraints bind within
each state, is compared to the robust optimal policy with within-state budget balance. See Appendix C.2
for implementation details.




                                                                                              41
                                                                                Appendix



A          Derivations with Direct Maximization

In this appendix, we show how the results derived for the optimal linear tax through the perturba-

tion method can also be obtained through a direct maximization of the tax authority's objective.


A.1            Certainty benchmark

Individual utility is U i (c, y ) = c - v i (y/wi ), with v i increasing and convex. Types are indexed by

i with population fractions pi . The social welfare function is                                                          i
                                                                                                                       ip        U i (c, y ) , with  increasing

and concave. Tax policy is defined by a linear rate t, which determines a lump-sum grant b(t) =

t          iyi.    Individuals choose y i (t) = arg maxy y (1 - t) + b(t) - v i (y/wi ) , and we denote  i =
     ip
dy i (t)       1-t
d(1-t)     ·    yi
                   .

     The tax authority's policy problem is maxt                                                     i   y i (t)(1 - t) + b(t) - v i (y i (t)/wi )
                                                                                               ip                                                           . The

first-order condition for the optimum is:
                                                                                                                                      
                                                                                                                       dy j (t)
                                            pi  (U i ) -y i (t) +                     pj y j (t) - t              pj                   = 0,                  (32)
                                                                                                                       d(1 - t)
                                       i                                         j                        j


or, rearranging,

                          t
                                           pi  (U i ) ·               pj  j y j =          pi  (U i ) ·            pj y j -               pi  (U i )y i .    (33)
                         1-t
                                   i                             j                    i                       j                       i


     Now, we add notation for simplicity:  =                                                 i      (U i ) is the social value of marginally aug-
                                                                                           ip 

menting the lump-sum grant (also known as the MVPF); x
                                                     ¯=                                                                     i (xi )
                                                                                                                       ip             is the expected value of an
                                                                             (U i )
individual-specific variable xi ; and g i =                                           is the marginal social welfare weight on type i. Note
                              i
                         i  (U )                  pi    (U i )
that g
     ¯=                ip              =      i
                                                  pj  (U j )
                                                                     = 1. With these terms, we can rewrite the first-order condition
                                              j

as

                                                                       t    E yi - E giyi
                                                                          =                                                                                  (34)
                                                                      1-t       E [ i y i ]
                                                                            -Cov [g i , y i ]
                                                                          =                   .                                                              (35)
                                                                             E [ i y i ]


                                                                                          42
    If we additionally assume  i  ¯ is constant, then this FOC simplifies further to

                                                                                 i
                                                           t    -Cov g i , y
                                                                           y¯
                                                              =     ¯         .                                                          (36)
                                                          1-t       

A.2     Uncertainty, state-invariant lump-sum grant

In this scenario, states are indexed by s, with associated probabilities s . Individual utility is
 i (c, y ) = c-v i (y/w i ); population fractions are pi . The social welfare function is
Us                                                                                                                                  i     i (c, y ) ,
                s                                      s                                                                s s      i ps    Us

with  increasing and concave. Tax policy is made up of a state-invariant linear rate t, which de-

termines the state-invariant lump-sum grant: b(t) = t                                           i i
                                                                                 s s        i p s ys .   Note that while this setup

implies resources can be transferred across states, it is not the same as imposing the optimal state-

specific lump-sum grants, as that would generally entail making the grant higher in states where
                  i (y/w i ) is high on average. In other words, this is the optimal tax and transfer
labor disutility vs

when both must be pre-specified.
                                            i (t) = arg max                       i     i
    The individual optimization problem is ys               y y (1 - t) + b(t) - vs (y/ws ) , where
                      dysi (t)
          i =                        1-t
we denote s           d(1-t)     ·     i .
                                      ys
                                             The tax authority's policy problem is



                            max                  s       pi   i                      i i        i
                                                          s  ys (t)(1 - t) + b(t) - vs (ys (t)/ws )                 .                    (37)
                                 t
                                             s       i


The optimum is characterized by the following first order condition:
                                                                                                                        
                                                                                                                j
                                                                                                              dys (t)
                  s         pi    i     i
                             s  (Us ) -ys (t) +                   s        pj  j
                                                                            s ys - t        s            pj
                                                                                                          s
                                                                                                                        = 0.             (38)
              s
                                                                                                              d(1 - t)
                        i                                     s       j                 s          j


    Again, we introduce notation, now adapted for uncertainty:  =                                                          i      i ) is the
                                                                                                               s s      i ps    (Us

MVPF; x
      ¯ =                            i i
                   s s           i p s xs    denotes the expectation of a variable x over types and states; x
                                                                                                            ¯s =
                                                                                                            i)
                                                                                                          (Us
     i i                                                            i =
  i ps xs   denotes the average across types within a state s; and gs                                      ,        still implying g
                                                                                                                                   ¯ = 1.

With these in hand, we rewrite the optimality condition as:

                                                          t        i ] - E [g i y i ]
                                                               E [ys             s s
                                                             =            i yi ]
                                                                                                                                         (39)
                                                         1-t        E [s      s
                                                               -Cov [gs   i , yi ]
                                                                                s
                                                             =         i yi ]
                                                                                   .                                                     (40)
                                                                  E [s     s



                                                                      43
                                 i 
   And if we further assume that s ¯s , i.e., there is uncertainty about the (homogeneous) value

of  , then the FOC simplifies to:

                                                    t             i , yi ]
                                                           -Cov [gs    s
                                                       = ¯          ¯                                                                   (41)
                                                   1-t   y¯ + Cov [s , y¯s ]
                                                                                    i
                                                                           i , ys
                                                                     -Cov gs   y¯
                                                          =                       ¯s ysi
                                                                                               .                                        (42)
                                                              ¯ 1 + Cov           
                                                                                   ¯, y
                                                                                      ¯


A.3    Uncertainty, budget constraint binds in each state

Finally, we assume that the budget constraint binds within each state, i.e., bs (t) = t                                                  i i
                                                                                                                                     i p s ys .

The policy problem is max                                i       i (t)(1 - t) + b (t) - v i (y i (t)/w i )
                                              s s     i ps      ys               s       s s          s                  . Since the budget

constraint applies in each state, we define the marginal value of public funds within each state:

s =       i      i ).
       i ps    (Us

   The optimality condition is:
                                                                                                                  
                                                                                                    j
                                                                                                j dys (t)
                            s            pi    i     i
                                          s  (Us ) -ys (t) +                pj  j
                                                                             s ys - t          ps                  = 0.                 (43)
                        s
                                                                                                       d(1 - t)
                                    i                                   j                  j


   We can rewrite this result as

                    t
                                        s s         pi i i
                                                     s s ys =         s s         pi  i
                                                                                   s ys -              s          pi  i i
                                                                                                                   s gs ys ,            (44)
                   1-t          s                                s                                 s
                                               i                              i                              i


implying

                                               t          i ] - E [g i y i ]
                                                    E [s ys            s s
                                                  =             i yi ]
                                                                                                                                        (45)
                                              1-t       E [s s     s
                                                                 i , y i ] + Cov      s    i
                                                          -Cov [gs    s                , ys
                                                      =                            s
                                                                                                                                        (46)
                                                              i y i ] + Cov
                                                           E [s                       i i
                                                                 s                  , s ys

                                 i 
   And if we further assume that s ¯s , i.e., there is uncertainty about the (homogeneous) value




                                                                      44
of  , then the FOC simplifies to

                                  -Cov [gs i , y i ] + Cov s , y i
                             t                  s                s
                                =                                                                              (47)
                            1-t    E [¯s y
                                         ¯s ] + Cov      s ¯
                                                          ,   y
                                                              ¯
                                                             s s
                                                         
                                                           i                  i
                                                  i , ys + Cov
                                            -Cov gs                       s ys
                                                      y¯                   , y
                                                                             ¯
                                  =                                                                            (48)
                                         ¯ + Cov 
                                                 ¯s , y
                                                      ¯s                  s ¯ y¯s
                                                      y¯ + Cov             , s y¯
                                                               i                 i
                                                   i , ys + Cov
                                             -Cov gs                         s ys
                                                       y¯                     , y
                                                                                ¯
                                  =                       ¯s y                    ¯s y
                                                                                          .                    (49)
                                         ¯ 1 + Cov            ¯s             s       ¯s
                                                           ¯, y¯     + Cov     ,   ¯y¯


B      Derivations of Nonlinear Optimal Tax Formulas

In this appendix, we show how to obtain the results derived for the optimal nonlinear tax through

the perturbation method.


B.1     Certainty benchmark

Individual utility is U  (c, y ) = c - v  (y/w ), with v increasing and convex. Types are continuously

indexed by    with distribution F () and associated density f (). The social welfare function

is     U  (c, y ) dF (), with  increasing and concave. Tax policy consists of a nonlinear income

tax T (y ), which consists of marginal tax rates T (y ) and a lump-sum grant -T (0) equal to per-

capita tax revenues. Individuals choose y  (T ) = arg maxy y - T (y ) - v  (y/w ) , resulting in the

endogenous income distribution HT (y ) and associated density hT (y ). We denote the compensated
                                         y             1-T (y )
labor supply elasticity as  (y ) =    (1-T (y ))   ·     y         and have income effect  (y )  0.

     The tax authority's policy problem is maxT                  U  (y  - T (y  ) - v  (y  /w )) dF () subject

to the governmental budget constraint              T (y )hT (y )dy  R, where R is an exogenous revenue

requirement, and subject to each y  solving the individual's optimization problem. We add the
                                                (U  (c,y ))
following notation for simplicity: g (y ) =                     is the marginal social welfare weight on y -earners

of type --assuming a one-to-one mapping between  and y --and

                                                                                            
                                              T (y )                                   (U )dF ( )
       =          U  dF () -                            (y )dHT (y ) =                T (y )
                                                                                                               (50)
                                            1 - T (y )                 1+           0 1-T (y )  (y )dHT (y )
                                     0



is the MVPF, which reduces to  =               U  dF () in the case with no income effects. We can



                                                           45
                                   T (y )
               ^(y ) = g (y ) -
further define g                  1-T (y )  (y )   as the social marginal utility of consumption, accounting

for fiscal externalities from income effects, in which case we have g
                                                                    ^(y ) = g (y ) when income effects
                                                                              
are absent. Dividing equation (50) by  demonstrates that                     0 g
                                                                               ^(y )dHT (y )     = 1.

   We use the perturbation method to derive the first-order condition for optimality of the tax

policy, considering a small increase in the marginal tax rate d in an interval of size  around some

earnings level y  . The mechanical effect of this reform is to raise revenue from individuals with

y > y  and thereby reduce the after-tax income of those individuals, at a welfare cost of g
                                                                                          ^(y ):

                                                       
                                      dM = d              (1 - g
                                                               ^(z )) hT (z )dz.                                   (51)
                                                      y


The behavioral effect of the reform corresponds to the negative fiscal externality that results from

those individuals reducing their effort, with:

                                                      -T
                                          dB = d          (y  )y  hT (y  ).                                        (52)
                                                     1-T

At the optimum, dM + dB = 0, yielding the first-order condition:

                                                                   
                              T (y )           1
                                       =                              (1 - g
                                                                           ^(z )) hT (z )dz.                       (53)
                            1 - T (y )   y (y )hT (y )         y


B.2    Uncertainty: fully pre-specified robust optimum

                                                                                          (c, y ) =
Now we have states indexed by s with associated probabilities s . Individual utility is Us
      (y/w  ). The individual type distribution in each state is denoted F ( ), with associated density
c - vs                                                                    s

fs (). Tax policy consists of a state-invariant nonlinear income tax T (y ), defined by a schedule of

marginal tax rates T (y ) and a pre-specified lump-sum grant -T (0), equal to expected per-capita
                                                           (T ) = arg max                       
tax revenues. In each possible state, individuals choose ys               y y - T (y ) - vs (y/w ) ,

resulting in the endogenous income distribution HT,s (y ) and associated density hT,s (y ). We denote
                                                                                      ys             1-T (ys )
the state-specific compensated labor supply elasticity as s (y ) =                 (1-T (ys ))   ·     ys      .

   In this setting, the tax authority's policy problem is


                                                                   
                      max             s       Us (ys - T (ys ) - vs (ys /w )) dFs ()                               (54)
                        T                 
                                  s



                                                          46
subject to a government resource constraint                                                                        
                                                                        T (y )hs,T (y )dy  R, and subject to each ys
                                                              s s

solving the individual's optimization problem above. The resource constraint binds in expectation,

implying that resources can be transferred across states. Thus the marginal value of public funds

is given by

                                                                               
                                                                                    T (y )
                    =          s        (Us )dF () -                   s                      (y )dHT (y )                    (55)
                          s                                        s       0      1 - T (y )
                                               
                                     s s   (Us )dF ( )
                      =                  T (y )
                          1+       s s 0 1-T (y )  (y )dHT (y )


and we normalize the social marginal utility of consumption by  to obtain the marginal social
                                  (c,y ))
                               (Us                                                 T (y )
welfare weights gs (y ) =                          ^s (y ) = gs (y ) -
                                            . With g                              1-T (y ) s (y ),       dividing equation (55) by
                   
 yields       s s 0 g
                    ^s (y )dHT,s (y )    = 1. As in the linear case, this full pre-specified policy regime

implies that the tax authority can costlessly transfer resources across states, effectively using the

lump-sum grant to provide some insurance.

   Using the perturbation method to derive the first-order condition for optimality of the tax

policy, we again consider a small increase in the marginal tax rate d in an interval of size  around

y  . The expected mechanical effect of this reform is to raise revenue from individuals in each state

with y > y  and thereby reduce their consumption:

                                                              
                               dM e = d               s            (1 - g
                                                                        ^s (z )) hs,T (z )dz .                                (56)
                                                  s           y


The expected behavioral effect is the expected negative fiscal externality that results from those

individuals reducing their effort:

                                                           -T (y  )
                              dB e = d                s               s (y  )y  hs,T (y  ) .                                  (57)
                                              s
                                                          1 - T (y  )

We set dM e + dB e = 0, yielding the FOC at the optimum:

                                                               
                                 T (y )               s s     y (1     -g
                                                                        ^s (z )) hs,T (z )dz
                                          =                                                          .                        (58)
                               1 - T (y )                 y       s s [s (y )hs,T (y )]


This corresponds to the equation in the text.



                                                              47
B.3      Uncertainty, budget constraint binds in each state

Here we assume that the government budget constraint binds within each state, with the lump-

sum grant adjusting to balance the budget. Formally, the state-dependent tax policy is defined

as Ts (y ) = T (y ) - bs , where T (0) = 0 and bs is the state-dependent lump-sum grant, with bs =
  
 0 T (y )hs,T (y )dy   for each s; marginal tax rates T (y ) remain state-invariant. The policy problem

remains the same as in equation (54), except that the budget constraint now applies in each state

(i.e.,   Ts (y )hs,T (y )dy  R). In this setting, resources cannot be transferred across states and the

social value of raising bs differs across states. We define the state-specific MVPF as

                                                                   
                                                                        T (y )
                          s =        (Us )dF () - s                              s (y )dHs,T (y )   (59)
                                                               0      1 - T (y )
                                               
                                         (Us )dF ( )
                            =          T (y )
                                                                    .
                                1+   0 1-T (y ) s
                                                  ( y ) dHs,T ( y )

     Using the perturbation method and considering a small increase in the marginal tax rate d in

an interval of size  around y  , we note that the revenue generated in each state must be weighted
     s
by       , accounting for the fact that funds may be more or less valuable in state s than they are in

expectation overall. As a result, we have the modified expected mechanical effect:

                                                           
                                                               s
                            dM e = d              s              -g
                                                                  ^s (z ) hs,T (z )dz .             (60)
                                              s          y     

Similarly, we weight the behavioral effect in each state by the MVPF because the negative fiscal

externality is most costly in states where s is highest, resulting in the expected behavioral effect:

                                                      s -T (y  )
                            dB e = d              s                s (y  )y  hs,T (y  ) .           (61)
                                          s
                                                       1 - T (y  )

We again derive the FOC at the optimum by setting dM e + dB e = 0, yielding:

                                                          
                                  T (y )     Es          y (s      -g
                                                                    ^s (z )) hs,T (z )dz
                                           =                                               .        (62)
                                1 - T (y )                yEs [s s (y )hs,T (y )]




                                                              48
C      Documentation of Simulations

We simulate robust optimal nonlinear tax policies for the United States under various beliefs about

the long-term elasticity of taxable income using the fixed-point algorithm detailed in Section C.1.

We implement the algorithm and estimate the welfare effects of changing tax policies in MATLAB

using the files detailed in Section C.3.


C.1     Details of the Fixed-Point Algorithm

The algorithm is implemented in the following general steps, with further details provided below:

    1. Characterize beliefs about the long-term elasticity of taxable income as vectors of elasticity

      states and probabilities assigned to each state.

    2. Import income and consumption distribution data to infer an underlying income-earning

      ability distribution for each state, calibrate the status quo tax system, and determine the

      policymaker's revenue requirement. Initialize the income and consumption distributions in

      each state at the status quo and solve for state-specific labor disutility constants that ensure

      that the utility of each individual is equal across states in the status quo.

    3. Compute the marginal social welfare weight for each ability type in each state. Update the

      marginal tax rate schedule with an alternative tax schedule obtained from the policymaker's

      first-order condition, either in the case in which the budget constraint binds in expectation

      or the case in which it binds in each state.

    4. Update the income distribution in each state with the optimal labor supply choice under the

      updated marginal tax rate schedule using the first-order condition in the individual's utility

      maximization problem. Repeat this step until the change in labor supply choices becomes

      trivially small.

    5. Update the lump-sum grant, either within each state (for the specification in which the

      budget constraint binds in each state) or across all states (if the budget constraint binds in

      expectation). Update the consumption distribution in each state under the updated marginal

      tax rate schedule and state-specific income distribution.


                                                  49
   6. Repeat steps 3-5 until the updating of the marginal tax rate schedule and the difference

         between the proposed alternative tax schedule and the current tax schedule are trivially

         small.

   7. Check the second-order condition that income is non-decreasing in income-earning ability in

         each state at the fixed point.

The resulting fixed-point marginal tax rate schedule satisfies the necessary first-order condition

for robust optimality. This process does not guarantee convergence to a fixed-point tax schedule.

However, if it does converge, and the second-order condition is satisfied, this represents the optimal

tax schedule. This result depends on the fact that the individual utility functions satisfy the

single-crossing property.


C.1.1       Step 1: Characterize beliefs about the elasticity of taxable income in different

            states

We characterize beliefs about the long-term elasticity of taxable income as a discrete probability

distribution of states over the parameter  . We generate a vector of elasticity states and a cor-

responding vector of probabilities assigned to each state s.27 Within each state, we assume the

value of the parameter s is homogeneous across the population. In the specification based on

beliefs elicited in our survey of academic economists, we assign a probability to each elasticity state

equal to the unweighted average probability assigned to that state by the economists surveyed.28

In specifications in which we assume certainty, a probability of 1 is assigned to a single elasticity

state.


C.1.2       Step 2: Initialize each state at the status quo

We begin by importing the discrete status quo U.S. market income distribution HTU S (y ), consump-

tion distribution, and corresponding probability mass function f () for types    from Piketty,

Saez, and Zucman (2018). We adjust HTU S (y ) by imposing a Pareto tail above the 90th percentile
  27
    We define Es [xs ] := s s xs , where s is the probability assigned to state s.
  28
    We map from the intervals over which we elicited beliefs in the survey to specific values and assign the average
probabilities to those values.




                                                        50
income,29 use linear interpolation to adjust consumption accordingly for income-earners above that

threshold, and generate a cumulative distribution function of types F (). Next, we calibrate the

current U.S. tax system. We obtain the status quo marginal tax rate schedule TU S (y ) by setting the

lump-sum grant equal to the lowest income-earner's consumption level and mapping the empirical

income and consumption distributions to implied marginal tax rates. In the case in which the

budget constraint binds in expectation, we initialize a single lump-sum grant, while we initialize a

vector of state-specific lump-sum grants in the case in which the budget constraint binds in each

state. The methodology in Piketty, Saez, and Zucman (2018) ensures that pre-tax and post-tax

national income are equal, in order to reconcile with national accounts. As a result, under this

calibration we have an exogenous revenue requirement of R = 0.30

    For each elasticity state, we initialize an income and consumption distribution at the status quo.

In addition, we set a single fixed grid of income levels along which the robust optimal marginal

tax rate schedule T  (y ) will be defined. We initialize the robust marginal tax rate schedule via

linear interpolation of TU S (y ) to each income level in the fixed grid of incomes. We also initialize

state-specific marginal tax rate schedules at TU S (y ) to serve as dynamic mappings from the robust

tax schedule defined along the fixed grid of incomes to the state-specific income distributions.

    Finally, we use HTU S (y ) , TU S (y ), and the parameter s in each state to compute an underlying

state-specific implied income-earning ability distribution using the first-order condition from the

individual's utility maximization problem. We assume the individual utility function takes the

Type 1 form from Saez (2001) with the logarithmic transformation:

                                                                             1+1/s
                                                              1        ys
                               U   c     
                                    s , ys   = ln   cs   -                             .                          (63)
                                                           1 + 1/s     w
  29
     The Pareto parameter is chosen such that the local parameter just below the 90th percentile income is equal
to the constant parameter above the 90th percentile income. We also modify f () along the Pareto tail by defining
additional types at low and middle incomes and fewer types at high incomes to facilitate convergence to the fixed-point
tax schedule.
  30
     To enforce this equality in the presence of our numerical integration, which generates approximations, we rescale
status quo consumption by a constant factor (about 1.01) so national income and consumption are exactly equal in
the status quo. This does not preclude deficit spending; rather, it requires deficits to be accounted for in income.
Piketty, Saez, and Zucman (2018) include deficit-funded transfers in consumption and adjust incomes by "allocat[ing]
50% of the deficit proportionally to taxes paid, and 50% proportionally to government spending received."




                                                           51
                                              , the implied ability is
For type  in state s with status quo income yU S


                                                                                  1
                                                                           -s
                                         ws = yU S (1 - T      U S (yU S ))           .                                   (64)
                                                                                1+s




                                                   in each state that ensure that utility and conse-
We then solve for the labor disutility constants ks
                                             for each type is equal across all states in the status
quently the marginal social welfare weight gs

quo.31 Furthermore, we impose the normalization that ks
                                                       = 0 under the central parameter value


of base = 0.4 from our survey of academic economists, which implies:

                                                     1+1/s                                 1+1/base
                                1            yU S                   1            yU S
                      ks   =                   
                                                             -                    
                                                                                                      .                   (65)
                             1 + 1/s         ws                1 + 1/base        wbase

C.1.3     Step 3: Update the marginal social welfare weights and marginal tax rate

          schedule
                                                                                                                         )
                                                                                                                       (Us
                                                                                      =
First, we compute the marginal social welfare weight for each type in each state as gs                                     32
                                                                                                                         ,
                                                                               )dF ( )].33,34
where (x) = ln(x) and  is the marginal value of public funds, with  = Es [  (Us

When the budget constraint binds in each state and the social value of marginally increasing the

lump-sum grant is not equal across all states,  is the expected marginal value of public funds and

we further define the state-specific marginal value of public funds: s =                           )dF ( ).
                                                                                                (Us

    We now employ the result, from equation (24) in the text, that when the budget constraint

binds only in expectation, the robust optimal tax satisfies:

                                                            
                                  T  (y )     Es           y (1    -g
                                                                    ^s (z )) hs,T (z )dz
                                            =                                              ,                              (66)
                                1 - T  (y )                  yEs [s (y )hs,T (y )]

with state-specific endogenous income densities hs,T (y ), compensated elasticity of taxable income

s (y ), and marginal social welfare weights g
                                            ^s (y ). (Note that in the absence of income effects, g
                                                                                                  ^s (y ) =
                                                                                                           
gs (y ).) To implement this calculation in the simulations, we use the fact that Es                       0 (1   - gs (z )) hs,T (z )dz =
                         y               1-T (y )
0 and s (y ) = -      (1-T (y )) s   ·     y        to rewrite the condition above as
  31
     In the status quo, these state-specific constants are necessary to ensure that each individual's status quo labor
supply choice maximizes their utility, regardless of which elasticity state happens to obtain.
  32                       
     We verify that Es [ gs dF ()]  1.
  33
     Our assumption that there are no income effects simplifies the computation of the marginal value of public funds
and marginal social welfare weights.
  34
     All integrals are computed numerically by the trapezoidal method, using the trapz function in MATLAB.


                                                              52
                                                       y
                                              Es      0    (gs (z ) - 1) hs,T (z )dz
                                   T (y ) =                                               .                  (67)
                                                               y
                                               Es           (1-T  (y )) s hs,T (y )

The first-order condition from the individual of type 's utility maximization problem in state s is
                   
          )) - ( ys )1/s · 1 = 0. Implicitly differentiating with respect to the marginal "keep rate"
(1 - T (ys       w s       ws

1-T      ),
      (ys     we can solve for the local labor supply response:

                                           y                       1 - T (y )            s
                        s (y ) =                               ·              =         T (y )
                                                                                                     .       (68)
                                       (1 - T (y ))        s           y        1+               s y
                                                                                       1-T (y )


   In the case where the budget constraint binds in each state, the optimal tax condition satisfies

equation (29) from the text:

                                                          
                                  T  (y )     Es         y (s           -g
                                                                         ^s (z )) hs,T (z )dz
                                            =                                                                (69)
                                1 - T  (y )                yEs [s s (y )hs,T (y )]

                                               
   In this case, we use the fact that         0 (s         - gs (z )) hs,T (z )dz = 0 in each state to rewrite the

above condition as:

                                                     y
                                             Es     0    (gs (z ) - s ) hs,T (z )dz
                                  T (y ) =                                                    .              (70)
                                                                   y
                                              Es s              (1-T  (y )) s hs,T (y )

We compute the alternative tax schedule from the right-hand side of equation (67) or (70), depend-

ing on the specification, at each point in our fixed grid of income levels. We use the current tax

schedule in place of T  (y ) and employ linear interpolation to map from inputs computed under

state-specific income distributions to the fixed income grid. We update the marginal tax rate sched-

ule as the weighted average of the alternative tax schedule and the current tax schedule. We apply

a weight of .001 to the alternative tax schedule to aid in a gradual progression towards convergence

to the fixed-point tax schedule. We also impose an upper bound of 1.0 and a lower bound of -0.1

on the alternative tax schedule to facilitate convergence; these limits do not bind at the optimum

in any of our specifications.




                                                                   53
C.1.4     Step 4: Determine the optimal labor supply for each type in each state

We rearrange the first-order condition from the individual's utility maximization problem, yielding


                                                (1+s )             s
                                          ys = ws      · (1 - T (ys )) .                                           (71)


Due to the endogeneity of the marginal tax rate, we employ another fixed-point algorithm in order

to reoptimize the labor supply choices made by each type. It proceeds as follows:

   1. Use linear interpolation to map from the marginal tax rate schedule on our fixed grid of

       incomes to the current income distribution in each state.35

   2. Compute an alternative income distribution from the right-hand side of equation (71), using

       the marginal tax rate corresponding to the current income of each type in each state.

   3. Update the income distribution in each state as the weighted average of the alternative income

       distribution and the current income distribution. Apply a weight of .05 to the alternative

       income distribution to aid in a gradual progression towards convergence to the fixed-point

       income distribution.36

   4. Repeats steps 1-3 until the updating of the income distribution is trivially small.37

The resulting income distribution represents the optimal labor supply choices under the updated

marginal tax rate schedule.


C.1.5     Step 5: Update the lump-sum grant and consumption in each state

After updating the marginal tax rate schedule and arriving at the corresponding fixed-point income

distribution, we update the lump-sum grant(s) and the state-specific consumption distributions.
  35
     We limit the marginal tax rates to an upper bound of 0.99 to avoid nonreal values; this limit does not bind at
the optimum in any of our specifications. Furthermore, we enforce the "zero at the top" result that arises from using
a bounded ability distribution (see Seade 1977) when the marginal tax rate of the top ability type is extrapolated to
be negative.
  36
     To facilitate convergence, we impose a bounding procedure that ensures incomes do not become "too large"
during the iteration process, while still remaining monotonic. Specifically, we limit the values of the new income
                                                                                                  n-1
                                                                                    
distribution so that given proposed income ys  0
                                                 from step 2, we compute ys = min{ys0
                                                                                      , $109 · 10 N -1 }, where n is type
's rank (of N ) in the income distribution.
  37
     We define a trivially small update as occurring when the maximum of the absolute value of the pairwise differences
between the incomes under the current and updated income distributions is less than 0.0001.



                                                           54
First, we simply update the lump-sum grant to ensure that the budget constraint is either satisifed in

expectation (i.e., Es      T (z )hs,T (z )dz = R) or in each state (i.e.,     Ts (z )hs,T (z )dz = R), depending

on the specification. Second, we update consumption in each state as c             
                                                                      s = ys - T (ys ) using the

updated income distribution, lump-sum grant, and marginal tax rate schedule.


C.1.6     Step 6: Converge to the fixed-point tax schedule

We repeat steps 3-5 until (i) the updating of the marginal tax rate schedule is trivially small and

(ii) the difference between the proposed alternative tax schedule and the current tax schedule is

trivially small. For criterion (i), we define a trivially small update as occurring when the magnitude

of the vector of differences between the current and updated tax schedules is less than 10-5 . For

criterion (ii), we define a trivially small difference as present when the percent difference in marginal

tax rates at all income levels in our fixed grid is less than .01 percent.38 Once these criteria are

satisfied, the procedure is complete and the resulting tax schedule is the fixed-point tax schedule.39


C.1.7     Step 7: Check for optimality of the fixed-point tax schedule

Our final step is to confirm that the fixed-point tax schedule is the robust optimal nonlinear tax
                                                                             corresponding to
schedule. We check the second-order condition that the fixed-point incomes ys

the fixed-point tax schedule are non-decreasing in income-earning ability type in each state.


C.1.8     Impose an asymptotic marginal tax rate at high incomes

Since the income-earning ability distribution is bounded in each state, Seade's (1977) "zero at the

top" result arises and the marginal tax rate at top incomes declines towards zero. Realistically,

the policymaker may not know the top income-earning ability with certainty in each state, so we

impose the marginal tax rate that plateaus above $300,000 in income across all incomes above

that threshold. We then employ the labor supply fixed-point algorithm from step 4 to reoptimize

labor supply choices under the modified tax policy. Finally, we update the lump-sum grant(s) and

consumption distributions as in step 5.
  38
     We exclude the tax rate for the top income earners--which is expected to be zero--when checking this criterion
to avoid division by zero.
  39
     Due to the "zero at the bottom" result that arises from using a bounded ability distribution (see Seade 1977),
we do not plot the tax rate for the lowest income in our fixed grid of incomes since rates will approach zero at any
arbitrary first income cell.


                                                        55
C.1.9     Enforce within-state budget constraints

For comparison to the robust optimal tax policy under within-state budget constraints, we modify

the fully pre-specified best estimate tax policy--optimized under a certain, best estimate value of

 --to enforce within-state budget constraints. The modification proceeds as follows:

  1. Employ the labor supply fixed-point algorithm in step 4 to optimize the labor supply of each

      type in each elasticity state under the marginal tax rate schedule of the fully pre-specified

      best estimate tax policy and the underlying state-specific income-earning ability distributions

      implied by each value of  .

  2. Compute state-specific lump-sum grants, ensuring that the budget constraint is satisfied in

      each state under the best estimate policy's marginal tax rate schedule and the updated income

      distributions from the previous step. Compute the consumption of each type in each state

      as c             
          s = ys - T (ys ) using the best estimate policy's marginal tax rate schedule, the updated

      income distributions, and the state-specific lump-sum grants.


C.1.10     Modifications for a simple linear tax illustration

We modify steps 2 and 3 of the fixed-point algorithm detailed above as follows to implement a

simple linear tax illustration:

Step 2:     We define an economy with two income-earning ability types. Each type constitutes

            50% of the population. In the status quo, the low-ability type earns the 25th percentile

            income from the status quo U.S. income distribution, while the high-ability type earns

            the 75th percentile income. Each type's consumption is equal to the empirical consump-

            tion that corresponds to its income from the status quo U.S. consumption distribution,

            adjusted by the same lump-sum. The lump-sum adjustment is set to ensure the budget

            is balanced in the status quo and the exogenous revenue requirement R is zero given a

            linear tax system.

Step 3:     We instead employ the result from the proof of Proposition 1 in the text that when the




                                                 56
           budget constraint binds in expectation, the robust optimal tax satisifes:

                                       t              ¯s
                                                  s s y    -     s s            p    
                                                                                 s gs ys
                                           =                                               ,   (72)
                                     1 - t                     s s [s y
                                                                      ¯s ]

           where, in our simple economy, y
                                         ¯s is the average income in each state across the two

           types and ps = 0.5 for all  . To implement the computation of the alternative linear tax

           rate, we rearrange and define t0 as the current linear tax rate, which--in the notation

           of this section--yields

                                               ys ] - Es
                                           Es [¯                  
                                                              ps gs ys
                                     t =                               · (1 - t0 ).            (73)
                                                     Es [s y
                                                           ¯s ]

           We compute the alternative tax rate from the right-hand side. Similarly, when the

           budget constraint binds in each state, we employ the result from the proof of Proposition

           2 in the text that the robust optimal tax satisifes:

                                                                              
                                   t            s s s y
                                                      ¯s   -  s s          ps gs ys
                                       =                                            .          (74)
                                 1 - t                      s s [s s y
                                                                     ¯s ]

           Again, we rearrange and rewrite, yielding

                                             ¯s ] - Es
                                       Es [s y                    
                                                              p s gs ys
                                 t =                                    · (1 - t0 ),           (75)
                                                 Es [s s y
                                                         ¯s ]

           and we compute the alternative tax rate from the right-hand side. The rest of the

           procedure remains the same as in the nonlinear cases.


C.2    Details of the Welfare Computations

We estimate the welfare effects of switching from the best estimate tax policy to the robust optimal

tax policy under the same beliefs about the probability distribution of  in the following steps:

  1. Use the utility function in equation (63) and the income-earning ability, income, and con-

      sumption distributions in each elasticity state at the optimum to compute the utility of each

      type in each state under the robust optimal tax policy.

  2. (a) In the case of fully pre-specified policies: Employ the labor supply fixed-point algorithm

                                                   57
           in step 4 of Section C.1 to optimize the labor supply of each type in each elasticity

           state under the marginal tax rate schedule of the best estimate tax policy. Compute

           the consumption of each type in each state using the optimal labor supply in each state

           and the pre-specified grant and marginal tax rate schedule of the best estimate tax

           policy. Use the individual's utility function and the income-earning ability, income, and

           consumption distributions in each state to compute the utility of each type in each state.

      (b) In the case of within-state budget constraints: Repeat step 1 for the best estimate tax

           policy.

  3. Compute the change in utility for each type in each state from switching from the best

      estimate tax policy to the robust optimal tax policy.

  4. Compute the marginal value of public funds s under the best estimate tax policy in each

      state as s =       )dF ( ), where (x) = ln(x). Convert the change in utility in each state
                      (Us

      from utils to dollars by dividing by s .

  5. Aggregate the money-metric change in utility across the population using the probability

      mass function of types f () and an estimate of the U.S. population. Divide by aggregate

      consumption in each state under the best estimate tax policy to rescale the welfare effect as

      a percentage of consumption.


C.3    Implementation in MATLAB

We use the five MATLAB files detailed below to implement the fixed-point algorithm:

   · "run simulations.m" executes the simulations.

   · "economy.m" defines an economy-class object that implements the fixed-point algorithm for

      the case in which the budget constraint binds in expectation.

   · "economy budgetbind.m" defines a subclass that modifies the economy class to enforce within-

      state budget constraints.

   · "economy linear.m" defines a subclass that modifies the economy class to implement the fixed-

      point algorithm in a simple setting with two income-earning ability types, a linear tax system,

                                                 58
     and a budget constraint that binds in expectation.

   · "economy linear budgetbind.m" defines a subclass that modifies the economy_linear sub-

     class to enforce within-state budget constraints.

We also use the two MATLAB files below to modify economy-class objects generated under a

certain, best estimate value of  to enforce within-state budget constraints in each state of the

probability distribution of  .

   · "balance within state.m" modifies economy-class and economy_budgetbind-subclass objects.

   · "balance within state linear.m" modifies economy_linear-subclass and

     economy_linear_budgetbind-subclass objects.

We use one MATLAB file to impose an asymptotic marginal tax rate at high incomes:

   · "impose top rate.m" modifies economy-class and economy_budgetbind-subclass objects.

We use an additional MATLAB file to compute the welfare effects of changing tax policies:

   · "compute welfare effect.m" defines a function that computes the money-metric welfare effect

     of switching from the best estimate tax policy to the robust optimal tax policy optimized

     under the same beliefs about the probability distribution of  .

All of the files above can be found in the "code" directory of this paper's replication files. To

generate the results reported in this paper, run the script "run simulations.m" in MATLAB. It will

output "numbersfortext.tex" directly to the "output" folder. The file "numbersfortext.tex" contains

L
A TEX commands with the survey probabilities, lump-sum grants, and money-metric welfare effects

reported in this paper as well as the contents of Table 1. The script will also output all PDF figures

to the "Figures" subfolder of the "output" folder.




                                                 59
