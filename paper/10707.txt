                                 NBER WORKING PAPER SERIES




                                    OPTIMAL EXPECTATIONS

                                       Markus K. Brunnermeier
                                         Jonathan A. Parker

                                         Working Paper 10707
                                 http://www.nber.org/papers/w10707


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      August 2004




For helpful comments, we thank Andrew Abel, Roland Bénabou, Douglas Bernheim, Andrew Caplin, Larry
Epstein, Ana Fernandes, Christian Gollier, Lars Hansen, David Laibson, Augustin Landier, Erzo Luttmer,
Sendhil Mullainathan, Filippos Papakonstantinou, Wolfgang Pesendorfer, Larry Samuelson, Laura Veldkamp
and three anonymous referees, as well as seminar participants at University of Amsterdam, UC Berkeley,
Birkbeck, University of Bonn, Boston University, Carnegie-Mellon, University of Chicago, Columbia, the
Federal Reserve Board, Harvard, the Institute for Advanced Study, London Business School, London School
of Economics, MIT, University of Munich, New York University, University of Pennsylvania, Princeton,
Rochester, Stanford, Tilburg University, the University of Wisconsin, Yale, and conference participants at
the 2003 Summer Meetings of the Econometric Society, the NBER Behavioral Finance Conference April
2003, the 2003 Western Finance Association Annual Meetings, the NBER Economic Fluctuations and
Growth meeting July 2003, the Minnesota Workshop in Macroeconomic Theory 2003, Bank of Portugal
Conference on Monetary Economics 2004, CEPR Summer Symposium at Gerzensee 2004. Both authors
acknowledge financial support from the National Science Foundation (SES 021-4445 and SES 009-6076).
Parker also thanks the Sloan Foundation and an NBER Aging and Health Economics Fellowship through the
National Institute on Aging (T32 AG00186). The views expressed herein are those of the author(s) and not
necessarily those of the National Bureau of Economic Research.

©2004 by Markus K. Brunnermeier and Jonathan A. Parker. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Optimal Expectations
Markus K. Brunnermeier and Jonathan A. Parker
NBER Working Paper No. 10707
August 2004
JEL No. D1, D8, E21, G11, G12

                                              ABSTRACT


This paper introduces a tractable, structural model of subjective beliefs. Forward-looking agents care

about expected future utility flows, and hence have higher current felicity if they believe that better

outcomes are more likely. On the other hand, biased expectations lead to poorer decisions and worse

realized outcomes on average. Optimal expectations balance these forces by maximizing average

felicity. A small bias in beliefs typically leads to first-order gains due to increased anticipatory utility

and only to second-order costs due to distorted behavior. We show that in a portfolio choice

problem, agents overestimate the return on their investment and exhibit a preference for skewness.

In general equilibrium, agents' prior beliefs are endogenously heterogeneous. Finally, in a

consumption-saving problem with stochastic income, agents are both overconfident and

overoptimistic.

Markus K. Brunnermeier
Department of Economics
Bendheim Center for Finance
Princeton University
Princeton, NJ 08544
markus@princeton.edu

Jonathan A. Parker
Department of Economics
Bendheim Center for Finance
Princeton University
Princeton, NJ 08544
and NBER
jparker@princeton.edu
1     Introduction
Modern psychology views human behavior as a complex interaction of cognitive and emo-
tional responses to external stimuli that sometimes results in dysfunctional outcomes.
Modern economics takes a relatively simple view of human behavior as governed by un-
limited cognitive ability applied to a small number of concrete goals and unencumbered
by emotion. The central models of economics allow coherent analysis of behavior and
economic policy, but eliminate “dysfunctional” outcomes, and in particular the possibil-
ity that individuals might persistently err in attaining their goals. One area in which
there is substantial evidence that individuals do consistently err is in the assessment of
probabilities. In particular, agents often overestimate the probability of good outcomes,
such as their success (Alpert and Raiﬀa (1982), Weinstein (1980), and Buehler, Griﬃn,
and Ross (1994)).
    We provide a structural model of subjective beliefs in which agents hold incorrect but
optimal beliefs. These optimal beliefs diﬀer from objective beliefs in ways that match
many of the claims in the psychology literature about “irrational” behavior. Further, in
the canonical economic models that we study, these beliefs lead to economic behaviors that
match observed outcomes that have puzzled the economics literature based on rational
behavior and common priors. Our approach has three main elements.
    First, at any instant people care about current utility flow and expected future utility
flows. While it is standard that agents that care about expected future utility plan
for the future, forward-looking agents have higher current felicity if they are optimistic
about the future. Agents that care about expected future utility flows are happier if
they overestimate the probability that their investments pay oﬀ well or their future labor
income is high.
    The second crucial element of our model is that such optimism aﬀects decisions and
worsens outcomes. Distorted beliefs distort actions. For example, an agent cannot derive
utility from optimistically believing that she will be rich tomorrow, while basing her


                                             1
consumption-saving decision on rational beliefs about future income.
   How are these forces balanced? We assume that subjective beliefs maximize the agent’s
expected well-being, defined as the time-average of expected felicity over all periods. This
third key element leads to a balance between the first two — the benefits of optimism and
the costs of basing actions on distorted expectations.
   We illustrate our theory of optimal expectations using three examples. In general, a
small bias in beliefs typically leads to first-order gains due to increased anticipatory utility
and only to second-order costs due to distorted behavior. Thus, beliefs tend towards
optimism — states with greater utility flows are perceived as more likely. Further, optimal
expectations are less rational when biases have little cost in realized outcomes and when
biases have large benefits in terms of expected future happiness.
   More specifically, in a portfolio choice problem, agents overestimate the return of
their investment and prefer skewed returns. Second, in general equilibrium, agents’ prior
beliefs are endogenously heterogeneous and agents gamble against each other. We show
in an example that the expected return on the risky asset is higher than in an economy
populated by agents with rational beliefs if the return is negatively skewed. Third, in
a consumption-saving problem with quadratic utility and stochastic income, agents are
overconfident and overoptimistic; early in life they consume more than implied by rational
beliefs. In addition, Brunnermeier and Parker (2002) shows in a diﬀerent economic setting
that agents with optimal expectations can exhibit intertemporal preference reversal, a
greater readiness to accept commitment, regret, and a context eﬀect in which non-chosen
actions can aﬀect utility.
   Psychological theories provide many channels through which the human mind is able to
hold beliefs inconsistent with the rational processing of objective data. First, to the extent
that people are more likely to remember better outcomes, they will perceive them as more
likely in the future, leading to optimistic biases in beliefs as in our optimal expectations




                                               2
framework.1 Second, most human behavior is not based on conscious cognition but is
automatic, processed only in the limbic system and not the cortex (Bargh and Chartrand
(1999)). If automatic processing is optimistic, then the agent may naturally approach
problems with optimistic biases. However, the agent may also choose to apply cognition to
discipline belief biases when the stakes are large, as in our optimal expectations framework.
       Our model of beliefs diﬀers markedly from treatments of risk in economics. While
early models in macroeconomics specify beliefs exogenously as naive, myopic, or partially
updated (e.g. Nerlove (1958)), since Muth (1960, 1961) and Lucas (1976) nearly all
research has proceeded under the rational expectations assumption that subjective and
objective beliefs coincide. There are two main arguments for this. First, the alternatives to
rationality lack discipline. But our model provides precisely this discipline for subjective
beliefs by specifying an objective for beliefs, that they maximize well-being. The second
argument is that agents have the incentive to hold rational beliefs (or act as if they do)
because these expectations make agents as well oﬀ as they can be. However, this rationale
for rational expectations relies upon agents caring about the future but at the same time
having their expectations about the future not aﬀect their current felicity, which we see
as inconsistent. Our approach of optimal expectations takes into account the fact that
agents care in the present about utility flows that are expected in the future in defining
what beliefs are optimal.
       Most microeconomic models assume that agents share common prior beliefs. This
“Harsanyi doctrine” is weaker than the assumption of rational expectations that all agents’
prior beliefs are equal to the objective probabilities governing equilibrium dynamics. But
like rational expectations, the common priors assumption is quite restrictive and does not
allow agents to “agree to disagree” (Aumann (1976)). Savage (1954) provides axiomatic

   1
     In Mullainathan (2002) individuals have imperfect recall and form expectations as if they did not. In
Piccione and Rubinstein (1997) individuals understand that they have imperfect recall, and in Bernheim
and Thomadsen (2003) individuals additionally can influence the memory process to increase anticpatory
utility.



                                                    3
foundations for a more general theory in which agents hold arbitrary prior beliefs, so agents
can agree to disagree. But if beliefs can be arbitrary, theory provides little structure or
predictive power. Optimal expectations provides discipline to the study of subjective
beliefs and heterogeneous priors. Framed in this way, optimal expectations is a theory of
prior beliefs for Bayesian rational agents.
    The key assumption that agents derive current felicity from expectations of future
pleasures has its roots in the origins of utilitarianism. Detailed expositions on anticipatory
utility can be found in the work of Bentham, Hume, Böhm-Barwerk and other early
economists. More recently, the temporal elements of the utility concept have re-emerged
in research at the juncture of psychology and economics (Loewenstein (1987), Kahneman,
Wakker, and Sarin (1997), Kahneman (2000)), and have been incorporated formally into
economic models in the form of belief-dependent utility by Geanakoplos, Pearce, and
Stacchetti (1989), Caplin and Leahy (2001), and Yariv (2001).2 In particular, Caplin
and Leahy (2000) shows that competitive equilibria are generically intertemporally sub-
optimal and so opens the door for belief distortion to increase well-being.
    Several papers in economics study related models in which forward-looking agents
distort beliefs. In particular, Akerlof and Dickens (1982) models agents as choosing beliefs
to minimize their discomfort from fear of bad outcomes. In a two-period model, agents
with rational beliefs choose an industry to work in, understanding that in the second
period they will distort their beliefs about the hazards of their work and perhaps not invest
in safety technology. Second, Landier (2000) studies a two-period game in which agents
choose a prior before receiving a signal and subsequently taking an action based on their
updated beliefs. Unlike our approach, belief dynamics are not Bayesian; common to our
approach, agents tend to save less and be optimistic about portfolio returns.3 Third, time

   2
     Caplin and Leahy (2004) and Eliaz and Spiegler (2003) show that the forward-looking nature of utility
raises problems for the revealed preference approach to behavior and the expected utility framework in
the context of the acquisition of information.
   3
     Similarly, in Eyster (2002), Rabin and Schrag (1999), and Yariv (2002) agents distort beliefs to be
consistent with past choices or beliefs.


                                                    4
inconsistent preferences can make it optimal to strategically ignore information (Carrillo
and Mariotti (2000)) or distort beliefs (Bénabou and Tirole (2002, 2004)). In the latter,
unlike in our model, multiple selves play intra-personal games with imperfect recall, and
actions serve as signals to future selves. Similarly, concerns about self-reputations also
play a central role in Harbaugh (2002). Finally, there is a large literature on bounded
rationality and incomplete memory. Some of these models suggest mechanisms for how
individuals achieve optimal expectations in the face of possibly contradictory data.
    The structure of the paper is as follows. In Section 2 we introduce and discuss the
general optimal expectations framework. Subsequently, in Sections 3 through 5 we use the
optimal expectations framework to study behavior in three diﬀerent canonical economic
settings. Section 3 studies a two-period two-asset portfolio choice problem and shows that
agents hold beliefs that are biased towards the belief that their investments will pay oﬀ
well. Section 4 shows that in a two-agent economy of this type with no aggregate risk,
optimal expectations are heterogeneous and agents gamble against one another. Section
5 analyzes the consumption-saving problem of an agent with quadratic utility receiving
stochastic labor income over time, and shows that the agent is biased towards optimism
and is overconfident, and so saves less than a rational agent. Section 6 concludes. An
appendix contains proofs of all propositions.


2     The optimal expectations framework
We choose to maintain many of the assumptions of canonical economic theory: agents
optimize knowing the correct mapping from actions to payoﬀs in diﬀerent states of the
world. But we allow agents’ assessments of probabilities of diﬀerent states to depart from
the objective probabilities.
    This section defines our framework in two steps. First, we describe the problem of the
agent given an arbitrary set of beliefs. At any point in time agents maximize felicity, the
present discounted value of expected flow utilities. Second, we define optimal expectations


                                            5
as the set of beliefs that maximize well-being in the initial period. Well-being is the
expected time-average of the agent’s felicity, and so is a function of the agent’s beliefs and
the actions these beliefs induce.

2.1       Optimization given beliefs

Consider a canonical class of optimization problems. In each period from 1 to T , agents
take their beliefs as given and choose control variables, ct , and the implied evolution of
state variables, xt , to maximize their happiness. We consider a world where the uncer-
tainty can be described by a finite number of states, S.4 Let π (st |st−1 ) denote the true
                                                                       ¯
probability that state st ∈ S is realized after state history st−1 := (s1 , s2 , ..., st−1 ) ∈ St−1 .
                                                              ¯                                ¯
We depart from the canonical model in that agents are endowed with subjective proba-
bilities that may not coincide with objective probabilities. Conditional and unconditional
subjective probabilities are denoted by π̂ (st |st−1 ) and π̂ (st ) respectively, and satisfy the
                                                ¯              ¯
basic properties of probabilities (precisely specified subsequently).
      At time t, the agent chooses control variables, ct , to maximize his felicity, given by

                                        Ê [U (c1 , c2 , ..., cT ) |st ] ,                       (1)
                                                                    ¯

where U (·) is increasing and strictly quasi-concave and Êt is the subjective expectations
operator associated with {π̂} and given information available at t. The agent maximizes
subject to a resource constraint

                                       xt+1 = g (xt , ct , st+1 ) ,                              (2)

                                   h (xT +1 ) ≥ 0 and x0 is given,                               (3)

where g (·) gives the evolution of the state variable and is continuous and diﬀerentiable in
x and c, and h (·) gives the endpoint condition. Denote the optimal choice of the control
as c∗ (st , {π̂}) and induced state variables as x∗ (st , {π̂}).
       ¯                                             ¯
  4
      Appendix A defines optimal expectations for the situation with a continuous state space.


                                                        6
       While the agent’s problem is standard and general, we employ the specific interpreta-
tion that Ê [U (·) |st ] is the felicity of the agent at time t. The felicity of the agent depends
                     ¯
on expected future utility flows, or ‘anticipatory’ consumption, so that subjective condi-
tional beliefs directly impact felicity. To clarify this point, consider the canonical model
with time-separable utility flows and exponential discounting. In this case, felicity at time
t,
                                                  ³P                                     hP                        i´
                                                    t−1                                    T −t
     Ê [U (ct−1 , ct , ..., cT ) |st ] = β t−1     τ =1 β
                                                           −τ
                                                              u (ct−τ ) + u (ct ) + Ê            τ
                                                                                            τ =1 β u (ct+τ ) |st        ,
            ¯                      ¯                                                                          ¯
is the sum of memory utility from past consumption, flow utility from current consump-
tion, and anticipatory utility from future consumption.

2.2         Optimal beliefs

Subjective beliefs are a complete set of conditional probabilities after any history of the
event tree, {π̂ (st |st−1 )}. We require that subjective probabilities satisfy four properties.
                     ¯

Assumption 1 (Restrictions on probabilities)
        P
    (i) st ∈S π̂ (st |st−1 ) = 1
                        ¯
    (ii) π̂ (st |st−1 ) ≥ 0
                  ¯     ¡          ¢ ¡             ¢
    (iii) π̂ (s0t ) = π̂ s0t |s0t−1 π̂ s0t−1 |s0t−2 · · · π̂ (s01 )
              ¯               ¯               ¯
    (iv) π̂ (st |st−1 ) = 0 if π (st |st−1 ) = 0.
                   ¯                   ¯

       Assumption 1(i) is simply that probabilities sum to one. Assumptions 1(i) — (iii) imply
that the law of iterated expectations holds for subjective probabilities. Assumption 1(iv)
implies that in order to believe that something is possible, it must be possible. That
is, agents understand the underlying model and only misperceive the probabilities. For
example, consider an agent choosing to buy a lottery ticket. The states of the world are
the possible numbers of the winning ticket. An agent can believe that a given number
will win the lottery. But the agent cannot believe in the nonexistent state that she will
win the lottery if she does not hold a lottery ticket or even if there is no lottery. Note

                                                             7
that it is possible for the agent to believe that a possible event is impossible. But since
we specify subjective beliefs conditional on all objectively possible histories, as in the
axiomatic framework of Myerson (1986), the agent’s problem is always well-defined.
   We further consider the class of problems for which a solution exists and provides
finite felicity for all possible subjective beliefs.

Assumption 2 (Conditions on agent’s problem)
      Ê [U (c∗1 , c∗2 , ..., c∗T ) |st ] < ∞ for all st and for all {π̂} satisfying Assumption 1.
                                     ¯                ¯

   Optimal expectations are the subjective probabilities that maximize the agent’s life-
time happiness. Formally, optimal expectations maximize well-being, W, defined as the
expected time-average of the felicity of the agent.
                                                                             ©               ª
Definition 1 Optimal expectations (OE) are a set of subjective probabilities π̂OE (st |st−1 )
                                                                                      ¯
that maximize well-being
                                "                                          #
                                  1X
                                     T
                         W := E         Ê [U (c∗1 , c∗2 , ..., c∗T ) |st ]              (4)
                                  T t=1                               ¯

subject to the four restrictions on subjective probabilities (Assumption 1).

   In addition to being both simple and natural, this objective function is similar to what
Caplin and Leahy (2000) argue should be the welfare function. Further, this choice of
W has the feature that under rational expectations well-being coincides with the agent’s
felicity, so the agent’s actions maximize both well-being and felicity. We further discuss
these issues in Subsection 2.3.
     Optimal expectations exist if cOE (st ) and xOE (st ) are continuous in probabilities
                                             ¯                ¯                    ¡ ©        ª¢
π̂ (st |st−1 ) that satisfy Assumption 1 for all t and st−1 , where cOE (st ) := c∗ st , π̂ OE and
        ¯          ¡ © OE ª¢                           ¯                 ¯          ¯
  OE             ∗
x (st ) := x st , π̂           . This follows from the continuity of expected felicity in prob-
        ¯           ¯
abilities and controls, Assumption 2, and the compactness of probability spaces. For less
regular problems optimal expectations may or may not exist. As to uniqueness, optimal
beliefs need not be unique, as will be clear from the subsequent use of this concept.

                                                   8
    Beliefs impact well-being directly through anticipation of future flow utility and indi-
rectly through their eﬀects on agent behavior. Optimal beliefs trade-oﬀ the incentive to be
optimistic in order to increase expected future utility against the costs of poor outcomes
that result from decisions made based on optimistic beliefs.
    How does this trade-oﬀ occur in practice? Think of people as first approaching prob-
lems with optimism (“This paper will be easy to write”). But people sometimes choose
not to simply accept their initial beliefs, and instead allocate cognitive resources to the
problem — asking themselves whether the probabilities of a good outcome are really as
high as they would like to believe (“Am I sure writing this paper will not stretch over
years?”). As cognition is applied, probability assessments become more rational. We posit
that the amount of cognition is directly related to the true risks and rewards of biased
versus rational beliefs (“I am hesitant to commit to present the paper next week when I
may not have results — let me think about it”). This description is consistent with the
view that human behavior is mostly determined by the rapid and unconscious processing
of the limbic system, but that for important decisions people rely more on the slower,
conscious processing of the cortex. This description also matches many psychological
experiments that find that agents report optimistic probabilities particularly when these
probabilities or their reports do not aﬀect payoﬀs. Probabilities tend to be more accurate
and beliefs more rational when agents have more to lose from biased beliefs.5 Our optimal
expectations framework is a simple model that captures this (and other) complex (and
speculative) brain processes.
    We view these processes — the mapping from objective to subjective probabilities
— as hard-wired and subconscious, not conscious. Thus, while the interaction between
optimistic and rational forces can be viewed as a model of a divided self, agents are

   5
     Lichtenstein, Fischhoﬀ, and Phillips (1982) surveys evidence on people’s overconfidence. Professionals
such as weather forecasters or those who produce published gambling odds make very accurate predictions.
Note also that the predictions of professionals do not seem to be due to learning from repetition (Alpert
and Raiﬀa (1982)).



                                                    9
unaware of this division and of the fact that their beliefs may be biased. This lack of
self-awareness implies that agents are unable to figure out the true probabilities from the
model and their subjective beliefs.
   So far we have focused on the optimization problem of a single agent. In a competitive
economy each agent faces this maximization problem taking as given his beliefs and the
stochastic process of payoﬀ-relevant aggregate variables. In our notation, xit includes the
payoﬀ-relevant variables that agent i takes as given, and so reflects the actions of all other
agents in the economy. Each agent’s beliefs maximize equation (4), where the states and
controls are indexed by i, taking the actions of the other agents as given. In equilibrium,
markets clear.

Definition 2 A competitive optimal expectations equilibrium is a set of beliefs for each
agent and an allocation such that
(i) each agent has optimal expectations, taking as given the stochastic process for aggregate
variables;
(ii) each agent maximizes (1) subject to constraints taking as given his beliefs and the
stochastic process for aggregate variables;
(iii) markets clear.

   Intuitively, optimal beliefs of each agent take as given the aggregate dynamics, and
the optimal actions take as given the perceived aggregate dynamics.

2.3    Discussion

Before proceeding to the application of optimal expectations, it is worth emphasizing
several points.
   First, because probabilities, π̂ OE (st |st−1 ), are chosen once and forever, the law of iter-
                                            ¯
ated expectations holds with respect to the subjective probability measure and standard
dynamic programming can be used to solve the agent’s optimization problem. An al-
ternative interpretation of optimal conditional probabilities is instead that the agent is
endowed with optimal priors over the state space, π̂ OE (sT ), and learns and updates over
                                                         ¯


                                               10
time according to Bayes’ rule.6 Thus, agents are completely “Bayesian” rational given
what they know about the economic environment.
    Second, optimal expectations are those that maximize well-being. The argument that
is traditionally made for the assumption of rational beliefs — that such beliefs lead agents
to the best outcomes — is correct only if one assumes that expected future utility flows
do not aﬀect present felicity. This is a somewhat inconsistent view: one part of the agent
makes plans that trade oﬀ present and expected future utility flows, while another part of
the agent actually enjoys utils but only from present consumption.7 Under the Jevonian
view that an agent who cares about the future has felicity that depends on expectations
about the future, optimal expectations give agents the highest average lifetime utility
level.
    To recast this point, we can ask what objective function for beliefs would make rational
expectations optimal. In the general framework, this is the case if well-being counts only
the felicity of the agent in the last period, so that W = E [U (c∗1 , c∗2 , ..., c∗T )]. Alternatively,
in the canonical time-separable model, this is the case if the objective function for beliefs
                                                         h P                 i
omits anticipatory and memory utility, so that W = E T1 Tτ=1 β τ −1 u (c∗τ ) .
    Third, this discussion also makes clear why well-being, W, uses the objective expec-
tations operator. Optimal beliefs are not those that maximize the agent’s happiness only
in the states that the agent views as most likely. Instead, optimal beliefs maximize the
happiness of the agent on average, across repeated realizations of uncertainty. The objec-
tive expectation captures this since the actual unfolding of uncertainty over the agent’s
life is determined by objective probabilities.
    Fourth, the only reason for belief distortion is that current felicity depends on expected
future utility flows. This is because changes in actions caused by belief distortion reduce

    6
      The interpretation of the problem in terms of optimal priors requires that one specify agent beliefs
following zero subjective probability events, situations in which Bayes rule provides no restrictions.
    7
      See Loewenstein (1987) and the discussion of the Samuelsonian and Jevonian views of utility in Caplin
and Leahy (2000).



                                                    11
well-being. Under rational expectations, the objective function for beliefs, W, is identical
to the objective function of the agent, E [U ]. Thus, fixing beliefs to be rational, the
actions of the agent maximize well-being.
   To clarify this point, consider a generalized version of current felicity at time t with
time-separable utility and exponential discounting
                                                ³P                                  hP                        i´
                                                  t−1                                 T −t
  Ê [Ut (ct−1 , ct , ..., cT ) |st ] = β t−1           τ
                                                  τ =1 δ u (ct−τ ) + u (ct ) + Ê
                                                                                             τ
                                                                                       τ =1 β u (ct+τ ) |st        ,
          ¯                      ¯                                                                       ¯
                                                                                                                   (5)
where the agent discounts past utility flows at rate δ, 0 ≤ δ ≤ 1/β. If δ = 1/β, then this
example fits into the framework we have assumed so far; we refer to this case as preference
consistency. If δ < 1, the agent’s memory utility decays through time, which has more
intuitive appeal. However, in this case, an agent’s ranking of utility flows across periods
is not time-invariant under rational expectations (Caplin and Leahy (2000)). Thus, there
is an incentive to distort beliefs in order to distort actions so as to increase well-being.
In Section 5 we assume time-separable utility and exponential discounting. While the
behavior of agents depends on δ, the qualitative behavior characterized by our propositions
holds for any δ ≤ 1/β.
   Fifth, one might be concerned that agents with optimal expectations might be driven
to extinction by agents with rational beliefs. But evolutionary arguments need not favor
rational expectations. Since optimal expectations respond to the costs of mistakes, agents
with optimal expectations are harder to exploit than agents with fixed biases. Further,
many economic environments favor agents who take on more risk (DeLong, Shleifer, Sum-
mers, and Waldmann (1990)). Finally, from a longer-term perspective and consistent with
our choice of W, there is a biological link between happiness and better health (Kiecolt-
Glaser, McGuire, Robles, and Glaser (2002) and Cohen, Doyle, Turner, Alper, and Skoner
(2003)).
   Before turning to the applications, we discuss three generalizations of our approach.
First, optimal expectations could be derived from a more general objective function than


                                                         12
a simple time-average of felicities. In particular, an earlier version of this paper defined
well-being as a weighted average of the agent’s felicities.
    Second, optimal subjective probabilities are chosen without any direct relation to real-
ity. This frictionless world provides insight into the behaviors generated by the incentive
to look forward with optimism when belief distortion is limited by the costs of poor out-
comes. In fact, it may be that beliefs cannot be distorted far from reality for additional
reasons. At some cost in terms of tractability, the frictionless model can be extended to
include constraints that penalize larger distortions from reality. Beliefs would then bear
some relation to reality even in circumstances in which there are no costs associated with
behavior caused by distorted beliefs.
    What sort of restrictions might be reasonable to impose? One could require that belief
distortions be restricted to be “smooth” or lie on a coarser partition of the probability
space, so that belief distortion are similar for states with similar outcomes. Alternatively,
one could restrict the set of feasible beliefs to be consistent with a set of parsimonious
models. For example, the agent might only be able to bias beliefs through his belief about
his own ability level. Or we might require that the agent believes that his income process
is some first-order Markov process rather than allow belief distortions to be completely
history dependent.8
    Finally, returning to the first point of our discussion, we maintain the assumption that
conditional probabilities are fixed through time. As an alternative, one might consider
beliefs as being reset in each period to maximize well-being given the new information
that has arrived. We describe the relationship between these diﬀerent approaches at the
end of Section 5.2.

   8
     If the agent were aware that his prior/model is chosen from a set of parsimonious models, then he
might questions these beliefs. In this case, it would make sense to impose the additional restriction that
only priors for which the agent cannot detect the misspecification can be chosen, an approach being
pursued in the literature on robust control. By not restricting the choice set over priors we avoid these
complications.




                                                   13
3     Portfolio choice: optimism and a preference for
      skewness
In this section we consider a two-period investment problem in which an agent chooses
between assets in the first period and consumes the payoﬀ of the portfolio in the second
period. We show that the agent is optimistic about the payout of his own investment and
prefers positively skewed returns. The subsequent section places a continuum of these
agents into a general equilibrium model with no aggregate risk, and shows that agents
disagree about the returns of assets.

3.1    Portfolio choice given beliefs

There are two periods and two assets. In period one, the agent allocates his unit endow-
ment between a risk-free asset with gross return R and a risky asset with gross return
R + Z (Z is the excess return of the risky asset over the risk-free rate). In period two,
the agent consumes the payoﬀ from his first-period investment.
    In period one, the agent chooses his portfolio share, α, to invest in the risky asset in
order to maximize felicity in the first period, Ê [U (c)],

                                                X
                                                S
                                   max      β         π̂ s u (cs ) ,
                                     α
                                                s=1
                                    s.t.    cs = R + αZs ,

                                            cs ≥ 0,

where u (·) is the utility function over consumption, u0 > 0, u00 < 0, u0 (0) = ∞ and
u (0) := limc&0 u (c). The second constraint is set by the market. Since consumption
cannot be negative, the constraint follows from the market requiring the agent to be able
to meet his payment obligations in all future states.
    Uncertainty is characterized by S states with ex post excess return Zs and probabilities
π s > 0 for s = 1, . . . , S. Let the states be ordered so that the larger the state, the larger


                                                14
the payoﬀ, Zs+1 > Zs , Z1 < 0 < ZS , and Zs 6= Zs0 for s 6= s0 . Beliefs are given by {π̂ s }Ss=1
satisfying Assumption 1.
   Noting that the second constraint can only bind for the highest or lowest payoﬀ state,
the agent’s problem can be written as a Lagrangian with multipliers λ1 and λS ,

                        X
                        S
                max β         π̂ s u (R + αZs ) − λ1 (R + αZ1 ) − λS (R + αZS ) .
                  α
                        s=1

The necessary conditions for an optimal α are

                               PS
                      0 =         s=1   π̂ s u0 (R + α∗ Zs ) Zs − λ1 Z1 − λS ZS ,

                      0 = λ1 (R + α∗ Z1 ) ,

                      0 = λS (R + α∗ ZS ) .

   It turns out that optimal beliefs are never such that cs = 0 (or R + α∗ Zs = 0) for any
s. To see this, suppose that R + α∗ Zs = 0 for some s and consider an infinitesimal change
in probabilities that results in an increase of consumption in this state. Since u0 (0) = ∞,
this causes an infinite marginal increase in well-being. Thus, optimal expectations imply
R + α∗ Zs 6= 0 for all s. By complementary slackness, λs = 0 for all s, and the optimal
portfolio is uniquely determined by

                               PS
                         0=       s=1   π̂s u0 (R + α∗ Zs ) Zs ⇒ α∗ ({π̂}) .                 (6)

3.2    Optimal beliefs

Optimal beliefs are a set of probabilities that maximize well-being, the expected time-
average of felicities in the first and second period:
                                      h                             i
                              W = 12 E Ê1 [U (c∗ )] + Ê2 [U (c∗ )] .

In period one, the agent’s felicity is the subjectively expected (anticipated) utility flow
in the future period; in period two, the agent’s felicity is the utility flow from actual


                                                   15
consumption. Substituting for our utility function and consumption and writing out the
             ©     ª
expectations, π̂ OE solve

                          X
                          S                                          X
                                                                     S
               max 21 β          π̂ s u (R + α∗ ({π̂}) Zs ) + 12 β         π s u (R + α∗ ({π̂}) Zs ) ,
                π̂
                          s=1                                        s=1

subject to the restrictions on probabilities (Assumption 1) and where α∗ ({π̂}) is given
implicitly by equation (6).
   To characterize optimal beliefs, first note that π̂ OE
                                                       s  > 0 for at least one state s0 with
Zs0 < 0 and one state s00 with Zs00 > 0. If this were not the case, the agent would view the
risky asset as a money pump, and would invest or short as much of the asset as possible,
so that cs = 0 for s = 1 or for s = S, which contradicts our previous argument. Now
consider the first-order condition associated with moving dπ̂ from the low-payoﬀ state s0
to the high-payoﬀ state s00 , where both states have positive subjective probability. By
the envelope condition, small changes in portfolio choice from the optimum caused by
small changes in subjective probabilities lead to no change in expected utility, so that this
condition is
                          1
                                                         PS        0      ∗            dα∗
                          2
                            β   (us00 − us0 ) = − 12 β    s=1 π s u (R + α Zs ) Zs         ,             (7)
                                                                                       dπ̂
where us0 := u (R + α∗ Zs0 ). The left-hand side is the marginal gain in ‘anticipatory utility’
in the first period from increasing π̂ s00 at the expense of π̂s0 ; the right-hand side is the
marginal loss in expected utility in the second period from the resultant change in the
portfolio share of the risky asset. At the optimum, the gain in anticipatory utility balances
the costs of distorting actual behavior.
   Let αRE denote the optimal portfolio choice for rational beliefs. The following proposi-
tion, proved in the appendix, states that the agent with optimal expectations is optimistic
about the payout of his portfolio. Further, the agent with optimal expectations either
takes a position opposite that of the agent with rational beliefs or is more aggressive —
investing even more if the rational agent invests, or shorting more if the rational agent
shorts.

                                                          16
Proposition 1 (Excess risk taking due to optimism)
(i) Optimal belief on average are biased upwards (downwards) for states in which an
agent’s chosen Pportfolio payout is¡ positive (negative):
                                                ¢
   if α > 0, Ss=1 (π̂ s − π s ) u0 R + αOE Zs Zs > 0;
       OE
                P                   ¡           ¢
   if αOE < 0, Ss=1 (π̂ s − π s ) u0 R + αOE Zs Zs < 0.
(ii) An agent with optimal expectations invests more aggressively than an agent with ra-
tional expectations or in the opposite direction:
    if E [Z] > 0, then αRE > 0, and αOE > αRE or αOE < 0;
    if E [Z] < 0, then αRE < 0, and αOE < αRE or αOE > 0;
    if E [Z] = 0 and S > 2, then αRE = 0 and αOE 6= 0.

   To understand the first part of the proposition, note that u0s > 0 for all s, and Zs is
positive for large s and negative for small s. Thus, when the agent is investing in the
asset (αOE > 0), optimal expectations on average bias up the subjective probability for
positive excess return states at the expense of negative excess return states.
   The second part of the proposition characterizes behavior. When E [Z] > 0, the
rational agent chooses αRE > 0 since the expected excess return on the risky asset is
positive. Starting from rational beliefs, again consider a small increase in the probability
of state s00 at the expense of state s0 where s00 > s0 . The left-hand side of equation (7)
shows that this leads to a first-order gain in anticipatory utility. The marginal cost of this
distortion, shown on the right-hand side of equation (7), is zero because the cost of a small
change in portfolio allocation away from the rational optimum is only of second-order, as
                               ©    ª
shown in equation (6). Thus, π̂ OE 6= {π} and αOE 6= αRE .
   Further, the individual either invests more than the rational agent in the risky asset
or shorts the risky asset for E [Z] > 0, and vice versa for E [Z] < 0. Why would the agent
take a position in the opposite direction to the rational agent, when this implies that he
is taking a negative expected payoﬀ gamble? This occurs when anticipatory utility in the
contrarian position is suﬃciently large. For many utility functions, this is the case when
the asset has the properties similar to a lottery ticket, that is when the asset is skewed in
the opposite direction of the mean payoﬀ.
   To illustrate this point, consider a world with two states and an asset with negative

                                             17
expected excess payoﬀ, E [Z] =: µZ < 0. We specify the payoﬀs Z1 and Z2 , such that, as
we vary probabilities the mean and variance, σ 2Z , stay constant, but skewness decreases
in π 2 .

                             State Probability         Excess Payoﬀ
                                                                 q
                                                                    π2
                               1       1 − π2       Z1 = µZ − σ Z 1−π
                                                                 q 2
                               2          π2        Z2 = µZ + σ Z 1−π
                                                                    π2
                                                                       2




When π 2 is small, the asset is similar to a real-world lottery: the asset yields a small
negative return with high probability and a large positive return with low probability.

Proposition 2 (Preference for skewness)
For unbounded utility functions, there exists a π̄2 such that for all π̄ 2 > π 2 > 0
(i) the agent is optimistic about the asset, π̂ OE
                                                2  > π 2 , and (ii) invests in the asset, αOE > 0,
even though E [Z] < 0.



       If the agent were to short the asset when π 2 is close to zero, π̂ 2 < π 2 , and so π2 − π̂ 2
is near zero — subjective beliefs are necessarily near rational beliefs — and α∗ ({π̂}) is near
αRE . However, in this case, if the agent instead is optimistic about the payoﬀ of the risky
asset, π̂ 1 < π 1 , then he can invest in the asset and dream about the asset paying oﬀ well.
In fact, for π 1 near unity, π̂ OE
                                1  < π1 and αOE is positive. This type of behavior — buying
stochastic assets with negative expected return and positive skewness — is widely observed
in gambling and betting.
       When E [Z] = 0, the cost and benefit of a marginal change in beliefs from rational
beliefs are both of second order. However, the gains in anticipatory utility still domi-
                                           ©    ª
nate the costs, as long as S > 2. Hence, π̂ OE 6= {π} and the agent with optimal
beliefs holds or shorts an asset that a rational agent would not.9 An implication is
that, from the perspective of objective probabilities, the agent with optimal expectations

   9
     When there are only two states and E [Z] = 0, we know of one special case for which αOE = αRE ; in
this case, skewness is zero (both states are equally likely). We thank Erzo Luttmer and Christian Gollier
for this example.

                                                   18
holds an underdiversified portfolio. That is, there exists a portfolio with the same objec-
                                                      £            ¤      £           ¤
tive expected return and less objective risk since E R + αOE Zs = E R + αRE Zs but
     £           ¤       £            ¤
V ar R + αOE Zs > V ar R + αRE Zs .


4     General equilibrium: endogenous heterogenous be-
      liefs
In this section we place the portfolio choice problem into an exchange economy with iden-
tical agents and no aggregate risk. In an optimal expectations equilibrium, agents choose
to hold idiosyncratic risk and gamble against one another, even though perfect consump-
tion insurance is possible. These features match stylized facts about asset markets. In
addition, the price of the risky asset may diﬀer from that in an economy populated by
agents with rational beliefs.
    The economy consists of a continuum of agents of mass one with the same utility
function and facing the same investment problem as in the previous section. As before,
there are two periods, with S states in the second period. There is one technology, bonds,
that is risk free and gives normalized gross return 1 (R equals unity). There is also an
asset in zero net supply, equity, that gives random gross return 1+Z with realized returns
          1+εs
1+Zs =     P
                where P is the equilibrium price of equity and ε1 < ε2 < ... < εS . Each agent
                                                                                     R
i is initially endowed with e = 1 bonds. Since equity is in zero net supply, Cs = i cis di = e
in all states s.
                              © ª
    Agent i takes her beliefs, π̂is , and the price of equity, P , as given, and chooses her
portfolio to maximize expected utility,

                                                  X
                                                  S
                                                               ¡ ¢
                                     max
                                      i
                                         β              π̂ is u cis ,
                                      α
                                                  s=1
                                                     ¡         ¢
                                     s.t.   cis   = e 1 + αi Zs ,

                                     cis ≥ 0.



                                                   19
The first-order conditions for portfolio choice deliver a unique optimal portfolio share:
                                   PS                                             ¡© i ª¢
                            0=          s=1       π̂ is u0 (1 + α∗ Zs ) Zs ⇒ α∗     π̂    .   (8)

   Optimal beliefs maximize the well-being of each agent
                                  X
                                  S
                                                  ¡ ∗ ¡© i ª¢¢ 1 X S
                                                                          ¡ ¡© ª¢¢
                      max
                       i
                            1
                            2
                              β         π̂ is u    cs π̂      + 2β   π s u c∗s π̂ i ,
                       π̂
                                  s=1                                  s=1
                                                                       ¡© ª¢       ¡       ¡© ª¢ ¢
subject to the restrictions on probabilities (Assumption 1), where c∗s π̂i = e 1 + α∗ π̂i Zs
       ¡© ª¢
and α∗ π̂ i is given by equation (8). Note that, since Zs = 1+ε       P
                                                                        s
                                                                          − 1, optimal beliefs
and asset demand depend on P .
   An optimal expectations equilibrium is a set of beliefs and an allocation of assets char-
acterized by each agent holding beliefs that maximize her well-being subject to constraints,
and market clearing. Letting OE denote values in an optimal expectations equilibrium
               1+ε
(e.g. Z OE =   P OE
                      − 1) and RE denote values in a rational expectations equilibrium, we
have the following proposition.

Proposition 3 (Heterogeneous beliefs and gambling)
(i) an optimal expectations equilibrium exists;
(ii) for S > 2, agents have heterogenous priors such that some agents hold the risky asset
and some agents short the risky asset:
    • there
      © OE,iexists
             ª ©a OE,j
                     subset
                         ª of thei agents,
                                   £ OE ¤ I, suchOE,i
                                                  that for all i ∈ £I, j ∈
                                                                         /¤ I,
                                                                  j   OE
        π̂     6= π̂       and Ê Z        > 0, α     > 0, and Ê Z         < 0, αOE,j < 0,
                         ©     ª
    • αOE,i 6= αRE = 0, π̂OE,i 6= {π} for all i.

   Since there is no aggregate risk, in the rational expectations equilibrium, no agent
holds any of the risky asset and all agents have the same consumption in all states. In
contrast, in an optimal expectations equilibrium agents have heterogeneous beliefs and
some agents hold the asset and some short it. Consequently, agents gamble against each
other and bear consumption risk.
   To gain intuition for this result, consider the following example with only two states:
           1 1−γ
u (c) =   1−γ
              c    with γ = 3, π 1 = 0.25, π 2 = 0.75, ε1 = −0.6, ε2 = 0.2. We choose the
risky asset to have negative skewness, like returns on the US stock market. The rational

                                                              20
expectations equilibrium has P RE = 1 so that E [Z] = 0 and no agent holds the risky
asset. At this price, because the payoﬀ of the asset is negatively skewed, agents with
optimal expectations would be pessimistic about the payout of the asset and short the
asset. This can be seen in Figure 1; the dotted line plots well-being as a function of π̂ 2
for the rational expectations price, P = 1. At this price, the market for the risky asset
does not clear because demand is too low.
   At lower prices, E [Z] > 0, and Proposition 1 implies that agents with optimal expec-
tations either hold more of the asset than the agent with rational expectations or short
the asset. If the price were far below P RE , then the asset would have such a high expected
return that it would be optimal for all agents to be optimistic about the return on the
asset and to hold the asset (the dashed line in Figure 1), so again the market would not
clear. The unique optimal expectations equilibrium occurs at a price of 0.986. At this
equilibrium price, each agent holds one of two beliefs, each of which gives the same level
of well-being. These correspond to the two local maxima of the solid line in Figure 1.
One set of agents has optimistic beliefs about the return on the asset and holds the asset
(π̂OE,i
   2    = 0.82 and αOE,i = 0.19); the remaining agents have pessimistic beliefs and short
the asset (π̂ OE,j
              2    = 0.38 and αOE,j = −0.67). The market for the risky asset clears when
78 percent of the agents are optimistic and the remaining 22 percent are pessimistic. No
agents hold rational beliefs.
   From an economic perspective, the most interesting result in this example is that
the optimal expectations equilibrium has a 1.4 percent higher equity premium than the
rational expectations equilibrium. In the example, the equity premium decreases with the
skewness of the asset. For the case in which the asset is positively skewed, by symmetry
of the problem, P OE > P RE . For the knife-edge case in which the asset is not skewed
(π1 = 0.5 and ε1 = −ε2 ), agents hold rational expectations and the optimal expectations
price is equal to the rational expectations price. But this result is quite specific to this
example, since by Proposition 1, this is not the case if S > 2 or if there is aggregate risk.



                                             21
                  0.3      0.4      0.5      0.6      0.7      0.8      0.9




               Figure 1: Well-being W as a function of subjective beliefs

   This relationship between skewness and expected returns is also found in the payoﬀs
and probabilities in pari-mutuel betting at horse tracks. As in our example, in pari-mutuel
betting there is no aggregate risk and there are risky assets. The longer the odds on a
horse, the more positively skewed is the payoﬀ. Golec and Tamarkin (1998) documents
that the longer the odds the lower the expected return on the bet, or equivalently, the
higher the price of the asset. To summarize, when returns are positively skewed, as in
pari-mutuel betting, our model predicts lower expected returns than the rational model;
when returns are negatively skewed, as in the US stock market, our model predicts higher
expected returns than the rational model.
   It is also worth noting that in an optimal expectations equilibrium there is significant
trading volume, while there is no trade in the rational expectations equilibrium. Further,
there is more trading when the asset is more skewed. This is consistent with the em-
pirical findings in Chen, Hong, and Stein (2001). We note the caveat that the choice of
endowments drives this result. Finally, let us speculate about a setting with heteroge-
neous endowments. In such a setup, it is natural to pick an equilibrium in which agents


                                            22
are more optimistic about the payoﬀs of their initial endowments. This choice minimizes
trading. Interpreting endowment as labor income, the model suggests that most agents
are optimistic about the performance of the companies they work in or the countries they
live in. Hence, investors overinvest in the equity of their employer and of their country
relative to the predictions of standard rational models, consistent with the data (see for
example Poterba (2003) on pension underdiversification and Lewis (1999) on the home
bias puzzle).


5     Consumption and saving over time: undersaving
      and overconfidence
This section considers the behavior of an agent with optimal expectations in a multi-period
consumption-saving problem with stochastic income and time-separable, quadratic utility.
We show that the agent overestimates the mean of future income and underestimates the
uncertainty associated with future income. That is, the agent is both unrealistically
optimistic and overconfident. This is consistent with survey evidence that shows that
growth rate of expected consumption is greater than that of actual consumption.

5.1    Consumption given beliefs

In each period t = 1, . . . , T the agent chooses consumption to maximize the expected
discounted value of utility flows from consumption subject to a budget constraint.
                                       " T −t                  #
                                        X
                                max Ê        β τ u (ct+τ ) |yt ,
                                 ct                          ¯
                                         τ =0
                                        X
                                        T −t
                                 s.t.          R−τ (ct+τ − yt+τ ) = At ,
                                        τ =0


where u (ct+τ ) = act+τ − 2b c2t+τ , initial wealth A1 = 0, a, b > 0, βR = 1, and yt denotes the
                                                                                  ¯
history of income realizations up to t. The agent’s felicity at time t is given by equation
(5), so that the agent has time-separable utility and discounts the future and the past

                                                   23
exponentially. Equation (5) allows the rate at which past utility flows are discounted, δ,
to diﬀer from the inverse of the rate at which future flows are discounted, β. We note
again that the choice of δ does not aﬀect the agent’s actions given beliefs.
   The only uncertainty is over income, yt . Income has cumulative distribution function
  ³       ´                £ ¤
Π yt |yt−1 with support y, ȳ and dΠ (yt ) > 0 for all y ∈ Y where 0 < y < ȳ < bTa .
      ¯                                                               ³      ´
We assume income is independently distributed over time, and so Π yt |yt−1 = Π (yt ).
                                                                         ¯
Agents however can believe that income is serially dependent, so subjective distributions
                 ³        ´
are denoted by Π̂ yt |yt−1 .
                      ¯
   Assuming an interior solution, the necessary conditions for an optimum imply the Hall
random walk result for consumption, but for subjective beliefs
                                            h         i
                                    c∗t = Ê c∗t+1 |yt .                               (9)
                                                    ¯
Substituting back into the budget constraint gives the optimal consumption rule
                                      Ã                               !
                                −1
                                                 X
                                                 T −t       h        i
                    c∗t = 1−R
                            1−R
                              −(T −t)  At + yt +      R−τ Ê yt+τ |yt .               (10)
                                                 τ =1              ¯

Optimal consumption depends on subjective expectations of future income, and on the
history of income realizations through At . Because quadratic utility exhibits certainty
equivalence in the optimal choice of consumption, the subjective variance (and higher
moments) of the income process are irrelevant for the optimal consumption-saving choices
of the agent, given the subjective expectation of future income.

5.2    Optimal beliefs

Optimal expectations maximize well-being subject to the agent’s optimal behavior given
beliefs and the restrictions on expectations. Assumption 10 in Appendix A states the
restrictions on expectations for a continuous state space. We incorporate optimal behavior
                                                                           ©    ª
directly into the objective function and characterize consumption choices, cOEt   , implied
                                                   n     o
by optimal beliefs. Optimal beliefs, Ê OE and Π̂OE , implement these consumption


                                            24
choices given optimal behavior on the part of the agent.10
       Since the objective is a sum of utility functions, it is concave in future consumption.
And since the agent’s behavior depends only on the subjective certainty-equivalent of
future income, optimal beliefs minimize subjective uncertainty. Thus, future income is
optimally perceived as certain, which is an extreme form of overconfidence.
   Using the fact that optimal beliefs are certain and the consumption Euler equation,
  h ¡     ¢ i       ³ h       i´
Ê u ct+τ |yt = u Ê ct+τ |yt = u (c∗t ), so that the agent’s felicity at time t can be
       ∗                 ∗
           ¯                ¯
written as
               h                              i        ³P                                     ´
                                                         t−1 τ ¡ ∗ ¢             PT
             Ê Ut (c∗1 , c∗2 , ..., c∗T ) |yt = β t−1   τ =1 δ u ct−τ + u (c∗
                                                                             t )  τ =t β τ −t
                                                                                                .
                                            ¯
Subjective expectations are chosen to yield the path of {c∗t } that maximizes well-being
    ⎡                                                                                                               ⎤

1 ⎢⎢    ∗
            PT           τ −1
                                 ³
                                       ∗            ∗
                                                       PT   τ −2
                                                                 ´                ³
                                                                              T −1 PT −1 τ
                                                                                                ¡ ∗ ¢    ∗
                                                                                                            ´⎥
                                                                                                             ⎥
 E ⎢u (c1 ) τ =1 β            + β δu (c1 ) + u (c2 ) τ =2 β        + .... + β       τ =1 δ u cT −τ + u (cT ) ⎥ ,
T ⎣|          {z            } |                 {z               }          |                 {z            }⎦
          Ê [U1∗ |y 1 ]
                   ¯                        Ê [U2 |y ]
                                                 ∗                                       Ê [U |y ]
                                                                                               ∗
                                                                                                    T
                                                   ¯2                                                   ¯T

subject to the budget constraint. Collecting terms, the objective simplifies to
                                       " T              #
                                   1    X
                                     E       ψt u (c∗t ) ,                                                   (11)
                                  T      t=1
                ³   P −t τ             ´
where ψt = β t−1 1 + Tτ =1 (β + (βδ)τ ) . Notice that, regardless of δ, the average con-
sumption path of agents is not constant. Only if the objective for beliefs were to ignore
anticipatory utility and memory utility (δ = 0) so that ψt = β t−1 , would beliefs be rational
and the expected consumption path standard.

  10
    Inh takingi this approach, we are assuming that the optimal choice of consumption and thus
 OE
Ê     yt+τ |yt does not require violation of the assumptions on expectations, which can be checked.
             ¯
That is, if the support of yt is small, belief distortion may be constrained by the range ofhpossiblei in-
come realizations. To incorporate these constraints directly, one would solve for optimal Ê yt+τ |yt by
              ³ n      o´                                                                          ¯
replacing c∗ yt , Π̂OE     using equation (10) and impose Assumption 10 .
               ¯



                                                        25
   Under optimal expectations, the first-order condition implies that expected consump-
tion growth between t and t + τ is given by
                              ¡    ¢ ψt+τ τ h 0 ¡ OE ¢ i
                            u0 cOE
                                t   =    R E u ct+τ |yt ,
                                      ψt              ¯
which, substituting for the quadratic utility function, implies that
                          ³ ´ a ψ      ³     h    ³    ´ i´
                     OE           t+τ τ a      OE
                    c      yt = −    R     −E c    yt+τ |yt .                              (12)
                           ¯   b  ψt     b          ¯    ¯
Level consumption is recovered by substituting into the budget constraint and taking
objective conditional expectations.
   Given this characterization of optimal behavior, agents are optimistic at every time
and state. Define human wealth at t as the present value of current and future labor
            P −t −τ
income, Ht = Tτ =0 R yt+τ .

Proposition 4 (Overconsumption due to optimism)
For all t ∈ {1, . . . , T − 1}:
(i) on average,
           h      agents
                     i     revise
                             h    down
                                   h   their iexpectation
                                                  i       of human wealth over time:
        OE                      OE
     Ê     Ht+1 |yt > E Ê         Ht+1 |yt+1 |yt ;
                 ¯                       ¯     ¯            h       i
(ii) on average, consumption falls over time: cOE    t  > E  cOE
                                                              t+1 t ;
                                                                 |y
                                                                 ¯ h          i   h        i
                                                                  OE   OE           OE
(iii) agents are optimistic about their future consumption: Ê        ct+1 |yt > E ct+1 |yt .
                                                                           ¯            ¯

   The first point of the proposition states that agents overestimate their present dis-
counted value of labor income and on average revise their beliefs downward between t
and t + 1. The second point states that consumption on average falls between t and t + 1.
Because on average the agent revises down expected future income, on average consump-
tion falls over time. The proof follows directly from the expected change in consumption
                                                    ³ ´
                                                                  ψ
given by equation (12) and noting that ab − cOE t    yt > 0 and ψt+1 R < 1. Finally, the
                                                     ¯              t

optimal subjective expectation of future consumption exceeds the rational expectation
of future consumption. This is optimism. Part (iii) follows from part (ii) and equation
(9). In sum, households are unrealistically optimistic, and, in each period, are on average


                                              26
             c(t)


                    +                                                     expected future
                           +     +                                        consumption
                                        +
                                              +                           paths
                    ×      ×     ×     ×      ×     +
                                                    ×       ×   ×     ×
                                                            +
                                                                +
                        Rational expectations profile (×
                                                       ×)
                        Optimal expectations profile (++)             +



                                                                               t
                    1      2      3     4     5                 T-1   T



                    Figure 2: Average life-cycle consumption profiles

surprised that their incomes are lower than they expected, and so, on average, household
consumption declines over time.
   Figure 2 summarizes these results. The agent starts life optimistic about future in-
come. At each point in time the agent expects that on average consumption will remain
at the same level. Over time, the agent observes on average that income is less than he
expected, and consumption typically declines over his life. Note that the agent updates
                        n o                                    n o
his beliefs according to Π̂ , but does not learn over time that Π̂ is incorrect because
he does not know that his income is identically and independently distributed over time.
The agent merely observes one realization of income at each age and (on average) believes
that he was unlucky.
   While quadratic utility makes this example quite tractable, the agent’s overconfidence
is extreme. Before each period the agent is certain about what his future income will
be, and this belief is contradicted by the realization. But, as seen in equation (10),
less extreme overconfidence would not alter consumption choices, only reduce the agent’s


                                                  27
felicity early in life.
    This optimism matches survey evidence on desired and actual life-cycle consumption
profiles. Barsky, Juster, Kimball, and Shapiro (1997) finds that households would choose
upward sloping consumption profiles. But survey data on actual consumption reveal that
households have downward sloping or flat consumption profiles (Gourinchas and Parker
(2002), Attanasio (1999)). In our model, households expect and plan to have constant
marginal utility since βR − 1 = 0. However, on average marginal utility rises at the age-
                 ψt
specific rate   ψ t+1
                        − 1 > 0. Thus, in the model, the desired rate of increase of consumption
exceeds the average rate of increase, as in the real world. In addition, the model matches
observed household consumption behavior in that average life-cycle consumption profiles
are concave — consumption falls faster (or rises more slowly) later in life.
    In general, in consumption-saving problems, the relative curvatures of utility and
marginal utility determine what beliefs are optimal. Uncertainty about the future enters
the objective for beliefs both through the expected future level of utility and through the
agent’s behavior, which depends on expected future marginal utility. For utility functions
with decreasing absolute risk aversion, greater subjective uncertainty leads to greater
precautionary saving through the curvature in marginal utility. This has some benefit in
terms of less distortion of consumption. In such cases optimal beliefs may consist of a
large positive bias for both expected income and its variance.
    We conclude this section by using our consumption-saving problem to make four points
about the dynamic choices of agents with optimal expectations.
    First, given that in expectation the consumption of the agent is always declining, the
costs of optimism early in life could be extreme for long-lived agents. But, illustrating a
general point, optimal expectations depend on the horizon in a way that mitigates these
possible costs. The behavior of an agent with a long horizon is close to that of an agent
with rational expectations. For T large but finite, an agent with optimal expectations con-
sumes a small amount more for most his life, leading to a significant decline in consump-



                                                  28
tion at the end of life. As the horizon becomes infinite, at any fixed age, the consumption
choice of the agent with optimal beliefs converges to that of the agent with rational be-
liefs as the subjective expectation of human wealth converges to the rational expectation.
                                          ³ ´          ³ ´         h        i       h        i
Formally, for any t, as T → ∞, cOE         y    →  cRE
                                                        y  , Ê OE
                                                                     H   |y
                                                                      t+1 t   →   E  H t+1 t ,
                                                                                          |y
          ³ ´        h      ³     ´ it     ¯t
                                                    t
                                                        ¯t                ¯                ¯
and cOEt   y   →  E    cOE
                        t+1  y     |y .11
                                          Beliefs become more   rational as the stakes become
           ¯t                 ¯t+1 ¯t
larger.
       Second, an agent with optimal expectations may choose not to insure future income
when oﬀered an objectively fair insurance contract. Formally, let the agent face an addi-
tional binary decision in period one: whether or not to exchange all current and future
                   h      i
income for B = E H1 |y1 . A rational agent would always take this contract, while the
                        ¯
agent with optimal expectations may choose not to insure consumption. Interestingly,
since beliefs aﬀect whether the agent insures or not, the addition of the possibility of
insurance may change what beliefs are optimal.
       Optimal expectations are either the beliefs that maximize well-being conditional on
inducing the agent to reject the insurance, or the beliefs that maximize well-being con-
ditional on inducing the agent to accept the insurance. The former are the optimal
expectations from Proposition 4. These beliefs are optimal for the problem without the
constraint, and the agent rejects the insurance because both income streams are perceived
                  h     i      h       i
as certain and Ê H1 |y1 > E H1 |y1 = B. Well-being in this case is
                      ¯             ¯
                                    1X
                                       T      h             i
                                          ψt E u (c∗t ) |y1
                                   T t=1                 ¯
from equation (11). The latter, optimal beliefs conditional on accepting the insurance, are
                                                                   h      i
irrelevant for well-being, provided that the agent believes that Ê H1 |y1 is small enough
                                                                        ¯
  11
    It can be seen that cOE 1h    → ciRE
                                      1     by taking conditional expectations of the budget constraint and
repeatedly substituting E ct+τ |yt , for all τ , from the Euler equation (12) to solve for cOE
                               OE
                                                                                                   1 , and noting
      ψ t+τ τ
                                    ¯ ψ
                                              −τ
that ψ R → 1 as T → ∞ and ψ t R < ψ t for τ , T → ∞. This together with equation (10) imply
         t h       i    h         i     t+τ
                                                                  ψ
that Ê OE H2 |y1 → E H2 |y1 . Again using the fact that ψt+τ Rτ → 1 as T → ∞, equation (12) implies
                ¯ OE            ¯                                    t

that for finite t, ct → cRE
                          t    , so that  the first two results also  hold for any finite t (not just t = 1).

                                                       29
and/or the process for {y} uncertain enough that he accepts the insurance.12 Well-being
in this case is
                              1X
                                  T        ³  ³ ´´
                                     ψt u cF I y1 ,
                             T t=1             ¯
          ³ ´            hP                i
                 R−1       T
where cF I y1 = R−R1−T E   t=1 R
                                 1−t
                                     yt |y1 .
           ¯                             ¯
  Risk determines which expectations are optimal. Well-being decreases in objective
income risk when the agent rejects the insurance, while it is invariant to risk if he accepts
the insurance. If objective income risk is small, then the cost of distorted beliefs — variable
future consumption — is small, and optimal expectations are optimistic. If objective
income risk is large, optimal expectations are more rational and induce the agent to
insure his future income.
       Third, at the start of life the agent facing the problem with the option to insure income
may have a lower level of felicity than the agent facing the problem without this option.
Informally, we might think of an agent approaching their life blithely optimistic about
their future. Given no choice of insurance, this is indeed optimal. However, if placed
in an environment with large amounts of income risk, an agent given the opportunity to
insure considers his life more realistically, puts more weight on possible bad states of the
                                            ³ ´        ³ ´
world, and chooses insurance. Since cOE y1 > cF I y1 , the agent who has and accepts
                                              ¯         ¯
the option to insure is less happy initially.13
       Finally, what if beliefs were chosen in each period to maximize well-being? Sup-
pose that the agent in each period chooses his actions taking as given his own be-
liefs in the future, which are possibly diﬀerent. The agent’s felicity is the present dis-
counted value of utility flows evaluated using his own subjective beliefs. This can be
viewed as if the agent in each period is a diﬀerent self that knows the conditional be-

  12
     While nothing formally requires this, it seems natural to assume that expectations are rational in
this case.
  13
     On average, the agent who has and accepts the option to insure has greater levels of felicity later
in life. This is because lifetime well-being with the option to insure is greater than or equal to lifetime
well-being without the option.



                                                    30
liefs of his future selves. The well-being function for optimal beliefs at time t would
                     h P                                  i
                       1   T
then be W := E T τ =1 Ê [U (c1 , c2 , ..., cT ) |sτ ] |st where Ê τ [·|sτ ] denotes the beliefs
                t               τ      ∗ ∗      ∗
                                                   ¯ ¯                   ¯
of the agent at time τ under this alternative assumption. Ê t [·|sτ ] maximizes W t given
n             o                                                       ¯
  Ê τ [·|sτ ]    and the future decision rules that these beliefs induce.
          ¯ τ >t
     Because the objective function changes through time, typically it is not the case that
the agent updates probabilities according to Bayes’ law. That is, Ê t [·|sτ ] varies across an
                                                                          ¯
agent’s selves in diﬀerent periods t < τ . However, in the application of this section, an
agent’s selves agree.
Proposition 5 (Time consistency of beliefs)
In this consumption-saving problem, optimal expectations are time consistent: Ê OE,t [·|sτ ]
                                                                                        ¯
is independent of t for all possible histories and τ ≥ t.

    This result obtains here because of the extremity of overconfidence. Consider first the
choice of beliefs at time t following an event at t + s, viewed subjectively as having zero
probability. These beliefs do not influence either the actions or anticipatory utility of the
agent at time t; they only influence the actions and anticipatory utility of the agent at time
t + s. Thus, beliefs following realizations of income besides the expected one are chosen
simply to maximize the expected utility of that agent in that period. The perspective from
which one chooses these optimal beliefs is irrelevant. If the income realization matches
the expected level, then consumption remains constant, and the agent continues to hold
the certain beliefs that they held in the previous period (by Bayes’ law). Note that this
argument pins down the profile of optimal income expectations, Ê [yt ], which increases in
a pattern opposite the average consumption profile, E [ct ].


6     Conclusion
This paper introduces a model of utility-serving biases in beliefs. While our applications
highlight many of the implications of our theory, many remain to be explored.
    First, the specification of possible events seems to be more important in a model with
optimal expectations than it is in a model with rational expectations. For example, an

                                               31
optimal expectations equilibrium in a world with only certain outcomes is diﬀerent from
the equilibrium in the same world with an available sunspot or public randomization
device. With the randomization device agents can gamble against one another.
       Second, agents with optimal expectations can be optimistic about uncertain events,
and therefore can be better oﬀ with the later resolution of uncertainty. For instance,
you tell someone that they are going to receive gifts on their birthday but you do not
tell them what those gifts are until their birthday.14 More generally, because more in-
formation can change the ability to distort beliefs, agents can be better oﬀ not receiving
information despite the benefits of better decision making. However, without relaxing the
assumptions of expected utility theory and Bayesian updating, agents would not choose
that uncertainty be resolved later because agents take their beliefs as given.
       Third, we conjecture that the agent who faces the same problem again and again, and
so faces the possibility of large losses from an incorrect specification of probabilities, will,
in our framework, have a better assessment of probabilities. Thus, optimal expectations
agents are not easy to turn into “money pumps,” although they may exhibit behavior far
from that generated by rational expectations in one-shot games.
       Fourth, and closely related, to what extent do optimal beliefs give an evolutionary
advantage or disadvantage relative to rational beliefs? On the one hand, agents with
optimal expectations make poorer decisions. On the other hand, agents with optimal
expectations may take on more risk, which can lead to an evolutionary advantage.
       Finally, optimal expectations has promising applications in strategic environments. In
a strategic setting, each agent’s beliefs are set taking as given the reaction functions of
other agents.




  14
    A surprise party for an agent raises the possibility in the agent’s mind that he might get more surprise
parties in the future and he enjoys looking forward to this possibility.

                                                    32
                                      Appendixes
A      Optimal expectations when the state space is continuous


In the main text, we define optimal expectations when the state space is finite and discrete.
To consider random variables with continuous distributions, we extend our definitions. Let
{ST , F, Π} denote the state space, σ -algebra, and objective probability measure. Let F =
 ¯                                  n o
{F0 , ..., FT } be a filtration. Let Π̂ and Ê denote the subjective probability measure and
expectation respectively. First, agent optimization given continuously distributed random vari-
ables is standard. Second, it is mathematically simpler to state the restrictions on subjective
beliefs in terms of subjective conditional expectations. Thus, one solves for optimal expecta-
tions by choosing Ê [A|Ft ] for any Ft in the filtration F and any event A ⊆ST to maximize the
                                                                             ¯
functional objective and Assumption 1 is replaced by


Assumption 1´ (Restrictions on probabilities for a continuous state space) For every Ft ∈ F
      (i) Ê [ST |Ft ] = 1
             ¯
      (ii) Ê [f |Ft ] ≥ 0 for any nonnegative function f :ST 7→ R which is Ft -measurable
                             h            i              ¯
      (iii) Ê [A|Ft ] = Ê Ê [A|Ft+τ ] |Ft for any τ ≥ 0 and any event A
      (iv) Π is a dominating measure of Π̂.


B      Proofs of Propositions

B.1     Proof of Proposition 1

(i) We prove the case for αOE > 0; the case for αOE < 0 is analogous. For αOE > αRE , when
the asset pays oﬀ poorly, marginal utility is higher (lower) for the agent with the higher (lower)
share invested in the risky asset:

                   ¡          ¢    ¡          ¢
                 u0 R + αOE Zs ≥ u0 R + αRE Zs for s such that Zs ≤ 0                        (B.1)
                   ¡          ¢    ¡          ¢
                 u0 R + αOE Zs < u0 R + αRE Zs for s such that Zs > 0



                                               33
Combining this with the first-order condition of the agent with rational expectations,

                   X             ¡          ¢     X       ¡          ¢
                            πs u0 R + αRE Zs Zs +   π s u0 R + αRE Zs Zs = 0,
                sÄZs ≤0                                       sÄZs >0

yields
                   X             ¡          ¢     X       ¡          ¢
                           π s u0 R + αOE Zs Zs +   π s u0 R + αOE Zs Zs < 0.
                sÄZs ≤0                                       sÄZs >0

Subtracting this from the first-order condition of the agent with optimal expectations gives the
desired inequality
                                      X
                                      S
                                        ¡ OE       ¢ ¡           ¢
                                         π̂ s − π s u0 R + αOE Zs Zs > 0                                          (B.2)
                                      s=1

Thus, if we can show that αOE > 0 implies αOE > αRE the proof of (i) is complete. This
follows from the second point of the proposition, which we now prove.
    (ii) The proof of the sign of αRE in each case is standard and omitted. We first treat the
case of E [Z] > 0 and αRE > 0, the case of E [Z] < 0 and αRE < 0 is analogous, and we treat
E [Z] = 0 and αRE = 0 subsequently.
    We first show that an agent with arbitrary beliefs invests more in the risky asset (or shorts
it less) as the subjective probability of a state s00 with Zs00 > 0 is increased relative to a state s0
with Zs0 < 0. Examine the agent’s first-order condition for α∗ and consider moving dπ̂ from s0
to s00

                                                                                  X
                                                                                  S
                   0          ∗                       0       ∗
         0 = (u (R + α Z ) Z − u (R + α Z ) Z ) dπ̂ +
                                      s00     s00                     s0    s0          π̂ s u00 (R + α∗ Zs ) Zs2 dα∗
                                                                                  s=1
         ∗             0          ∗                       0       ∗
    dα             u (R + α Z ) Z − u (R + α Z ) Z
                                        s00     s00                    s0    s0
             = −         PS                          >0
    dπ̂                              00     ∗      2
                           s=1 π̂ s u (R + α Zs ) Zs

since the denominator is negative and Zs00 > 0 > Zs0 .
    Suppose for purposes of contradiction, that 0 < αOE ≤ αRE . As in the proof of part (i),
we have

                             ¡          ¢    ¡          ¢
                           u0 R + αOE Zs ≤ u0 R + αRE Zs for s Ä Zs ≤ 0
                             ¡          ¢    ¡          ¢
                           u0 R + αOE Zs > u0 R + αRE Zs for s Ä Zs > 0

                                                              34
which implies from the first order condition of the agent with rational expectations,

                                    X
                                    S
                                               ¡          ¢
                                          πs u0 R + αOE Zs Zs > 0.                             (B.3)
                                    s=1

Now to establish the contradiction, the first-order condition for beliefs, equation (7), implies
                                                  "                                        #
                                                      X
                                                      S
                                                             ¡          ¢ dα∗
                    sign [β (us00 − us0 )] = sign −     π s u R + αOE Zs Zs
                                                             0

                                                    s=1
                                                                            dπ̂

       dα∗
From    dπ̂
              > 0 and equation (B.3), the sign of the right hand side is strictly negative, while the
fact that we are assuming αOE > 0 implies that us00 > us0 and the left hand side is strictly
positive, a contradiction. Therefore either αOE > αRE or αOE ≤ 0. The final step is to rule
out αOE = 0. If αOE = 0 then β (us00 − us0 ) = 0, so that by the first-order condition for beliefs

                                          X
                                          S
                                                     ¡          ¢
                                    0=          πs u0 R + αOE Zs Zs .                          (B.4)
                                          s=1

But αOE = 0 cannot solve equation (B.4) because equation (B.4) is the same as the first-order
condition for the optimal portfolio choice of the rational agent, and the objective of the rational
agent is globally concave with a unique αRE satisfying equation (B.4).
   Finally, we prove that when E [Z] = 0 and αRE = 0, αOE 6= 0. Suppose that instead
© OE ª
 π̂    were such that αOE = 0, which occurs if and only if Ê OE [Z] = 0. These beliefs
actually satisfy the first-order condition for optimal expectations because 1) there is no gain
to the marginal belief distortion since us00 = us0 and 2) starting from αRE the first-order cost
of a small change in optimal portfolio choice is zero. We show however, that the second order
condition is violated for some beliefs such that Ê [Z] = 0, which means that there is a deviation
from this set of beliefs that increases well-being and therefore αOE 6= 0.
   The second order condition for the same dπ̂ that moves an infinitesimal probability from s0
to s00 , where Zs00 > 0, Zs0 < 0, and π̂ s0 > 0 is
                                                                 µ         ¶2
                    d2 W      ∂ 2 W dα∗   ∂2W       ∂2W              dα∗            ∂W d2 α∗
                           =2           +         +                             +
                    dπ̂dπ̂    ∂π̂∂α dπ̂   ∂π̂∂ π̂   ∂α2              dπ̂            ∂α dπ̂2


                                                      35
                                           d2 W
Since W is linear in probabilities,        dπ̂dπ̂
                                                    = 0. Now, omitting 12 β from all terms,
                                        ∂W    XS
                                            =            (πs + π̂ s ) u0s Zs
                                        ∂α          s=1
                                       ∂2W    XS
                                            =            (πs + π̂ s ) u00s Zs2
                                       ∂α2          s=1
                                      ∂2W
                                            = u0s00 Zs00 − u0s0 Zs0
                                      ∂π̂∂α
We evaluate this second order condition for {π̂} such that Ê [Z] = 0 so that α∗ = 0 and u0 and
u00 are independent of s, yielding
              (                              " S                      #                  )
d2 W                                            X                         0
                                                                                             dα∗       X  S
                                                                                                                               d2 α∗
                 0                        00                        2 u Zs0 − Zs00                   0
         =     2u [Zs00 − Zs0 ] + u                  (π s + π̂ s ) Zs       P                     + u        (π s +  π̂ s ) Zs
dπ̂dπ̂                                          s=1
                                                                        u00 Ss=1 π̂ s Zs2 dπ̂           s=1
                                                                                                                               dπ̂ 2
              (     PS                             )                              ( S                          )
                             (π  s +  π̂ s ) Z   2
                                                                       dα ∗         X             XS
                                                                                                                  d2 α∗
                                                 s
         =     2 − s=1   PS                          [Zs00 − Zs0 ] u0       + u0         π s Zs +      π̂ s Zs
                             s=1 π̂ s Zs
                                         2                              dπ̂         s=1           s=1
                                                                                                                  dπ̂ 2
              (     PS               )
                                   2                             ∗
                             π s Z s                        0 dα
         =     1 − Ps=1S
                                         [Z  s 00 − Zs0 ] u

                       s=1 π̂ s Zs
                                   2                          dπ̂
                                                   P                     P
where the third equality makes use of                 π s Zs = 0 and        π̂s Zs = 0. Thus, any {π̂} such that
PS          2
                PS            2                                d2 W
   s=1 π s Zs <    s=1 π̂ s Zs and Ê [Z] = 0 has dπ̂dπ̂ > 0, and so there exists a deviation that

increases well-being, completing the proof. This final step requires S > 2; for S = 2, the second
order condition is necessarily zero and there are cases where αOE = αRE . We conjecture that
αOE = αRE only occurs for S = 2, Z1 = −Z2 , and π1 = π2 = 1/2.

B.2       Proof of Proposition 2

To avoid arbitrage we consider only π1 large enough such that Z2 > 0. We show that as
π 1 → 1, well-being when investing in the asset is higher than when shorting the asset. We do
this by constructing a lower bound for well-being when investing in the asset (W + (π 1 )) and
                                                          −
an upper bound when shorting the asset (W (π 1 )) and showing that limπ1 →∞ W + (π 1 ) >
               −
limπ1 →∞ W (π 1 ). Define well-being as a function of subjective and objective beliefs, given
optimal agent behavior, as

           W (π̂ 1 ; π 1 ) := 12 β (π 1 + π̂ 1 ) u (R + α∗ Z1 ) + 12 β (2 − π 1 − π̂ 1 ) u (R + α∗ Z2 )

                                                          36
where Zs = Zs (π 1 ), and α∗ = α∗ (π̂ 1 ; Z1 (π 1 ) , Z2 (π 1 )).
    Step 1: limπ1 →1 W (·) = ∞ for α > 0.
    Consider an optimistic belief, π̂ 01 , 0 < π̂01 < π 1 , such that the agent invests in the asset,
α0 > 0. Since π̂ 0 may be suboptimal, well-being with this belief is a lower bound for the well-
                                                                                  ¡                   ¢
being of the agent conditional on α > 0. Define W + (π 1 ) := W (π̂ 01 ; π 1 ) ≤ W π̂ OE
                                                                                      1  (π 1 ) , π 1  .
Taking the limit as skewness goes to infinity


       lim W + (π 1 ) =          1
                                 2
                                   β   (1 + π̂ 01 ) lim u (R + α0 Z1 ) + 12 β (1 − π̂ 01 ) lim u (R + α0 Z2 )
       π1 →1                                      π1 →1                                      π 1 →1

                          =      1
                                 2
                                   β   (1 + π̂ 01 ) u (R + α0 µZ ) + 12 β (1 − π̂ 01 ) lim u (R + α0 Z2 )
                                                                                    π 1 →1

                          = ∞

since Z1 → µZ , Z2 → ∞ and limc→∞ u (c) = ∞.
    Step 2: limπ1 →1 W (·) < ∞ for α < 0.
    Define an upper bound for well-being by choosing the portfolio and subjective beliefs subject
only to the conditions that the agent shorts the asset, that the agent is pessimistic about the
payout, and that the portfolio is feasible:

               −
          W (π1 ) : = 12 β sup [(π 1 + π̂ 1 ) u (R + αZ1 ) + (2 − π1 − π̂ 1 ) u (R + αZ2 )]
                                    α,π̂ 1
                   s.t.       α<0

                              π̂ 1 > π1

                              R + αZ2 ≥ 0

   −
W (π 1 ) is an upper bound since we do not restrict α to be the optimal agent’s choice given
π̂ 1 . The optimal π̂ 1 = 1, and the first and third constraints become − ZR2 ≤ α ≤ 0 (which is
not the null set since Z2 > 0), so that this can be re-written as

               −                1
    lim W (π1 ) =                 β lim
                                2 π →1
                                               sup       [(1 + π 1 ) u (R + αZ1 ) + (1 − π 1 ) u (R + αZ2 )]
   π 1 →1                            1
                                             − ZR ≤α≤0
                                             h 2         ³   ³     ´ ´                   i
                                1
                          <       β lim
                                2 π →1
                                              (1 + π1 ) u R + − ZR2 Z1 + (1 − π 1 ) u (R) = βu (R)
                                     1




                                                              37
where the second line follows from substituting the best portfolio choice in each state separately
               Z1
and limπ1 →1   Z2
                    = 0.
                                                                         −
   The proof follows from limπ1 →1 W + (π 1 ) > limπ1 →1 W (π 1 ) and Proposition 1.


B.3     Proof of Proposition 3

(i) Write the well-being of an agent as a function of subjective beliefs and the price given {π}
and optimal agent behavior:
                                           X
                                           S                                 X
                                                                             S
                                                              ∗
                    W({π̂} , P ) =   1
                                     2
                                       β         π̂s u (1 + α Zs ) +   1
                                                                       2
                                                                         β         π s u (1 + α∗ Zs )
                                           s=1                               s=1

This function is well-defined for the set of prices and beliefs such that the agent chooses positive
consumption in every state. Denote this set M . In M the function W is continuous in prices
and subjective probabilities because α∗ is continuous in subjective probabilities and prices. M
                                                                  © OE ª
is not closed, but we now show that P OE and all                   π̂    do not lie outside M or in the set
{Closure (M) \M}. First, consider prices such that Z1 ≥ 0 or ZS ≤ 0. In this case, all agents
would have an identical arbitrage opportunity for any possible subjective beliefs, except possibly
for π̂1 = 1 or π̂ S = 1. Hence, this cannot constitute an equilibrium because agents would all
choose to buy or all choose to short the risky asset, and so the market for the risky asset would
not clear. Thus, the equilibrium price must lie on the interior of the set P ∈ (1 + ε1 , 1 + εS ) .
Second, consider beliefs such that an agent chooses cs = 0 for some s. Because u0 (0) = ∞ in
some state, a marginal increase in π̂ 1 or π̂ S leads to cs > 0 for all s, and results in an infinite
increase in well-being.
   We will argue that at a low enough price, W({π̂} , P ) is maximized by beliefs such that
Ê [Z] > 0 and α∗ > 0, and at a high enough price, W({π̂} , P ) is maximized by beliefs such
that Ê [Z] < 0 and α∗ < 0. Then, by continuity of W({π̂} , P ), either at some intermediate
price there are multiple global maxima, some with Ê [Z] > 0 and some with Ê [Z] < 0, or at
some intermediate price there is a unique global maximum with Ê [Z] = 0 and α∗ = 0. By
Proposition 1, this second alternative cannot occur for S > 2. Thus, for S > 2, the unique
equilibrium in which markets clear has a fraction of agents believing Ê [Z] < 0 and shorting

                                                         38
the asset and a fraction of agents believing Ê [Z] > 0 and buying the asset. The fractions are
such that the aggregate demand for the asset is zero.
    We now show that there exists a low enough price such that optimal beliefs always induce
the agent to buy the asset. We do this by showing that, for a low enough price, an upper bound
on the well-being of an agent that shorts the asset is lower than the well-being of an agent
with rational beliefs, who buys the asset. Consider an agent that shorts the asset and consider
lower and lower prices for the asset. Since the agent shorts, he must believe Ê [Z] ≤ 0. As
P & 1 + ε1 , Ê [Z] ≤ 0 implies π̂ 1 % 1 and Z1 % 0, so that
                                    n XS                                   XS                        o
                                     1                       ∗         1                       ∗
   lim W({π̂} , P ) =       lim        β       π̂ s u (1 + α   Z s ) +   β        π s u (1 + α   Zs )
 P &1+ε1                  P &1+ε1 2        s=1                         2      s=1
                                                   XS
                      = 12 βu (1) + 12 β lim               π s u (1 + α∗ Zs )
                                                 P &1+ε1         s=1
                             1                1
                         ≤   2
                               βu (1)    +    2
                                                βu (1)   = βu (1)

where the inequality follows from the fact that in the limit the risky asset becomes dominated
                                    PS
by the risk-free asset. For P <         s=1   π s (1 + εs ), we have E [Z] > 0, and so, for an agent with
rational beliefs, well-being is

                                                         X
                                                         S
                                  W ({π} , P ) = β             π s u (1 + α∗ Zs )
                                                         s=1

where α∗ > 0. Since the rational agent chooses α to maximize his objective, α∗ yields higher
utility than α = 0, so
                                        X
                                        S
                                    β         π s u (1 + α∗ Zs ) > βu (1)
                                        s=1
Thus, there is a low enough price such that the beliefs that maximize the well-being function
have Ê [Z] > 0 and α∗ > 0. The problem is symmetric, so that there is a completely analogous
argument that in the limit as P % 1 + εS , optimal expectations have Ê [Z] < 0 and α∗ < 0.
    (ii) The proof for the rational expectations equilibrium is standard and omitted.
           £     ¤
    For E Z OE = 0, Proposition 1 directly implies αOE,i 6= αRE = 0, because in this case
                         P
αRE = αRE (P OE ) = αRE ( Ss=1 πs (1 + εs )) = 0 where αRE (P OE ) denotes the portfolio
choice of an agent who has beliefs equal to the objective probabilities and faces the optimal

                                                         39
expectations equilibrium price of equity. By market clearing and since agents either short or
hold the asset, some agents must be shorting and some agents must be holding the asset,
                                                          £     ¤
which implies the result. Again by Proposition 1, for E Z OE > 0, each price-taking agent
has αOE,i > αRE (P OE ) > 0 or αOE,i < 0, so αOE,i 6= 0, and since αOE,i 6= αRE (P OE ),
© OE,i ª
 π̂      6= {π}. Again, by market clearing and since agents either short or hold the asset, some
agents must be shorting and some agents must be holding the asset, which implies the result.
              £     ¤
The case of E Z OE > 0 is analogous.


B.4     Proof of Proposition 4
                      h       i
                         OE
Part (ii): Subtract E ct+1 |yt from each side of equation (12) with τ = 1
                            ¯
                      h       i       a ψt+1 ³ a           h       i´       h       i
             cOE
              t  −  E  cOE
                           |y
                        t+1 t     =     −        R    −  E  cOE
                                                                |y
                                                             t+1 t      − E  cOE
                                                                                 |y
                                                                              t+1 t
                            ¯         b     ψt      b            ¯                ¯
                                      µ             ¶³        h         i´
                                            ψt+1       a
                                  =     1−        R      − E cOEt+1 |yt
                                              ψt       b             ¯
                                                                               h        i
                                                                                            a
Since the support of the income process does not admit a plan such that E cOE        |y
                                                                                  t+τ t > b for
                                                                                      ¯
any τ , the second term is positive. The following demonstrates that the first term is positive.
                                         P −t−1 τ
                ψt+1          β t 1 + Tτ =1       (β + (βδ)τ )
                     R =          R      P −t τ
                 ψt          β t−1 1 + Tτ =1     (β + (βδ)τ )
                                                 P −t−1 τ
                                            1 + Tτ =1    (β + (βδ)τ )
                         < βR        P −t−1 τ                 ³                  ´
                                 1 + Tτ =1    (β + (βδ)τ ) + β T −t + (βδ)T −t
                          < 1

therefore
                                             h       i
                                     cOE
                                      t  − E  cOE
                                                  |y
                                               t+1 t > 0
                                                   ¯
and we have the result.
   Part (iii): From the agent’s consumption Euler equation
                                  h       i           h       i
                                Ê cOE |y
                                    t+1 t   = cOE
                                               t  > E  cOE
                                                           |y
                                                        t+1 t
                                        ¯                   ¯
where the inequality follows from part (ii).

                                               40
     Part (i): the consumption rule at t + 1 is
                                                           ³         h           i´
                                                1−R−1
                                  cOE
                                   t+1   =    1−R−(T −t)
                                                            At+1 + Ê Ht+1 |yt+1
                                                                            ¯
                      PT −t−1
where Ht+1 =            τ =0    R−τ yt+τ +1 . From part (iii) we have
                                         h       i     h        i
                                       Ê cOE |y
                                           t+1 t   > E   cOE
                                                             |y
                                                          t+1 t
     h                ³         h          i´ ¯ i      h      ¯   ³     h          i´ i
           1−R−1                                           1−R−1
Ê       1−R−(T −t)
                       At+1 + Ê Ht+1 |yt+1 |yt > E 1−R−(T −t) At+1 + Ê Ht+1 |yt+1 |yt
                                       ¯       ¯                               ¯     ¯
and by the law of iterated expectations
                                      h        i   h h           i i
                                    Ê Ht+1 |yt > E Ê Ht+1 |yt+1 |yt .
                                             ¯               ¯     ¯

B.5          Proof of Proposition 5

                                      ψ t+1
This result obtains because            ψt
                                              depends only on the number of periods until T , T − t:
                                                 P −t−1 τ
                                     ψt+1    1 + Tτ =1  (β + (βδ)τ )
                                          =β     PT −t τ
                                      ψt      1 + τ =1 (β + (βδ)τ )
Thus, optimal beliefs from the perspective of any time period imply the same rationally
expected percent change in the profile of marginal utility between any two periods. Since
the budget constraint determines the level of the profile and all plans exhaust the re-
sources, the levels are necessarily the same. Since income is perceived as certain, if that
income actually occurs, beliefs are bound by Bayes’ rule. In this case, there is no change
in beliefs about future incomes, and the subjective expectation of consumption coincides
with actual consumption.




                                                             41
References
Akerlof, G., and W. T. Dickens (1982): “The Economic Consequences of Cognitive
 Dissonance,” American Economic Review, 72(3), 307—319.

Alpert, M., and H. Raiffa (1982): “A Progress Report on the Training of Probability
 Assessors,” in Judgement Under Uncertainty: Heuristics and Biases, ed. by D. Kahne-
 man, P. Slovic, and A. Tversky, pp. 294—305. Cambridge University Press, Cambridge.

Attanasio, O. (1999): “Consumption,” in Handbook of Macroeconomics, ed. by J. B.
  Taylor, and M. Woodford, vol. 1, chap. 11, pp. 741—812. Elsevier Press, Amsterdam.

Aumann, R. J. (1976): “Agreeing to Disagree,” Annals of Statistics, 4, 1236—1239.

Bargh, J. A., and T. L. Chartrand (1999): “The Unbearable Automaticity of Being,”
 American Psychologist, 54(7), 462—479.

Barsky, R., T. Juster, M. Kimball, and M. Shapiro (1997): “Preference Para-
 meters and Behavioral Heterogeneity: An Experimental Approach in the Health and
 Retirement Survey,” Quarterly Journal of Economics, 112(2), 537—580.

Bénabou, R., and J. Tirole (2002): “Self-confidence and Personal Motivation,” Quar-
  terly Journal of Economics, 117(3), 871—915.

        (2004): “Willpower and Personal Rules,” Journal of Political Economy, 112(4),
  848—86.

Bernheim, B. D., and R. Thomadsen (2003): “Memory and Anticipation,” Mimeo,
  Stanford University.

Brunnermeier, M. K., and J. A. Parker (2002): “Optimal Expectations,” Woodrow
 Wilson School Discussion Papers in Economics, 221.

Buehler, R., D. Griffin, and M. Ross (1994): “Exploring the “Planning Fallacy”:
 Why People Underestimate Their Task Completion Times,” Journal of Personality and
 Social Psychology, 67(3), 366—381.

Caplin, A. J., and J. Leahy (2000): “The Social Discount Rate,” NBER Working
 Paper, 7983.

        (2001): “Psychological Expected Utility Theory and Anticipatory Feelings,”
  Quarterly Journal of Economics, 106(1), 55—80.

        (2004): “The Supply of Information by a Concerned Expert,” Economic Journal,
  114(497), 487—505.


                                         42
Carrillo, J. D., and T. Mariotti (2000): “Strategic Ignorance as a Self-Disciplining
 Device,” Review of Economic Studies, 67, 529—544.

Chen, J., H. Hong, and J. C. Stein (2001): “Forecasting Crashes: Trading Vol-
 ume, Past Returns and Conditional Skewness in Stock Prices,” Journal of Financial
 Economics, 61, 345—381.

Cohen, S., W. J. Doyle, R. B. Turner, C. M. Alper, and D. P. Skoner (2003):
 “Emotional Style and Susceptibility to the Common Cold,” Psychosomatic Medicine,
 65, 652—657.

DeLong, J. B., A. Shleifer, L. H. Summers, and R. J. Waldmann (1990): “Noise
 Trader Risk in Financial Markets,” Journal of Political Economy, 98(4), 703—738.

Eliaz, K., and R. Spiegler (2003): “Anticipatory Feelings and Choices of Information
  Sources,” Mimeo, University of New York.

Eyster, E. (2002): “Rationalizing the Past: A Taste for Consistency,” Mimeo, Oxford
  University.

Geanakoplos, J., D. Pearce, and E. Stacchetti (1989): “Psychological Games
 and Sequential Rationality,” Games and Economic Behavior, 1, 60—79.

Golec, J., and M. Tamarkin (1998): “Gamblers Love Skewness, Not Risk, at the
 Horse Track,” Journal of Political Economy, 106, 205—255.

Gourinchas, P.-O., and J. A. Parker (2002): “Consumption Over the Lifecycle,”
 Econometrica, 70(1), 47—89.

Harbaugh, R. (2002): “Skill Reputation, Prospect Theory, and Regret Theory,” Mimeo,
 Claremont Colleges.

Kahneman, D. (2000): “Experienced Utility and Objective Happiness: A Moment-Based
 Approach,” in Choices, Values and Frames, ed. by D. Kahneman, and A. Tversky, pp.
 637—692. Cambridge University Press, New York.

Kahneman, D., P. P. Wakker, and R. Sarin (1997): “Back To Bentham? Explo-
 rations of Experienced Utility,” Quarterly Journal of Economics, 112(2), 375—405.

Kiecolt-Glaser, J. K., L. McGuire, T. F. Robles, and R. Glaser (2002): “Psy-
  choneuroimmunology and Psychosomatic Medicine: Back to the Future,” Psychoso-
  matic Medicine, 64, 15—28.

Landier, A. (2000): “Wishful Thinking: A Model of Optimal Reality Denial,” Mimeo,
  MIT.

                                        43
Lewis, K. K. (1999): “Trying to Explain Home Bias in Equity and Consumption,”
  Journal of Economic Literature, 37(2), 571—608.

Lichtenstein, S., B. Fischhoff, and L. D. Phillips (1982): “Calibration of Prob-
  abilities: The State of the Art to 1980,” in Judgement Under Uncertainty: Heuristics
  and Biases, ed. by D. Kahneman, P. Slovic, and A. Tversky, pp. 306—334. Cambridge
  University Press, Cambridge.

Loewenstein, G. (1987): “Anticipation and the Valuation of Delayed Consumption,”
  Economic Journal, 47(387), 666—684.

Lucas, Jr., R. E. (1976): “Econometric Policy Evaluation: A Critique,” in The Phillips
  Curve and Labor Markets, ed. by K. Brunner, and A. H. Meltzer, vol. 1 of Carnegie
  Rochester Conference Series on Public Policy, pp. 19—46. North-Holland, Amsterdam.

Mullainathan, S. (2002): “A Memory-Based Model of Bounded Rationality,” Quar-
 terly Journal of Economics, 117(3), 735—774.

Muth, J. F. (1960): “Optimal Properties of Exponentially Weighted Forecasts,” Journal
 of the American Statistical Association, 55, 229—305.
         (1961): “Rational Expectations and the Theory of Price Movements,” Econo-
  metrica, 29(3), 315—335.

Myerson, R. B. (1986): “Axiomatic Foundations of Bayesian Decision Theory,” North-
 western University, MEDS Discussion Paper, 671.

Nerlove, M. (1958): “Adaptive Expectations and Cobweb Phenomena,” Quarterly
 Journal of Economics, 72, 227—240.

Piccione, M., and A. Rubinstein (1997): “On the Interpretation of Decision Problems
  with Imperfect Recall,” Games and Economic Behavior, 20, 3—24.

Poterba, J. M. (2003): “Employer Stock and 401(k) Plans,” American Economic Re-
 view (Papers and Proceedings), 93(2), 398—404.
Rabin, M., and J. L. Schrag (1999): “First Impressions Matter: A Model of Confir-
 matory Bias,” Quarterly Journal of Economics, 114(1), 37—82.

Savage, L. J. (1954): The Foundation of Statistics. Wiley, New York.

Weinstein, N. D. (1980): “Unrealistic Optimism About Future Life Events,” Journal
 of Personality and Social Psychology, 39(5), 806—820.

Yariv, L. (2001): “Believe and Let Believe: Axiomatic Foundations for Belief Dependent
  Utility,” Yale University, Cowles Foundation Discussion Paper, 1344.

                                         44
     (2002): “I’ll See It When I Believe It — A Simple Model of Cognitive Consistency,”
Mimeo, UCLA.




                                         45
