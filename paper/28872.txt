                             NBER WORKING PAPER SERIES




  EXCHANGE RATES AND MONETARY POLICY WITH HETEROGENEOUS AGENTS:
                 SIZING UP THE REAL INCOME CHANNEL

                                        Adrien Auclert
                                       Matthew Rognlie
                                       Martin Souchier
                                        Ludwig Straub

                                     Working Paper 28872
                             http://www.nber.org/papers/w28872


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                            May 2021, Revised June 2021




We are grateful to George Alessandria, Manuel Amador, Luigi Bocola, Ariel Burstein, Julian di
Giovanni, Sebastian Fanelli, Mark Gertler, Pierre-Olivier Gourinchas, Guido Lorenzoni, Oleg
Itskhoki, Sebnem Kalemli-Özcan, Matteo Maggiori, Kurt Mitman, Tommaso Monacelli, Brent
Neiman, Pablo Ottonello, Diego Perez, Fabrizio Perri, Jesse Schreger, Vincent Sterk and Iván
Werning for helpful comments. Jan Ertl provided excellent research assistance. This research is
supported by the National Science Foundation grant awards SES-1851717 and SES-2042691 The
views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Adrien Auclert, Matthew Rognlie, Martin Souchier, and Ludwig Straub. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Exchange Rates and Monetary Policy with Heterogeneous Agents: Sizing up the Real Income
Channel
Adrien Auclert, Matthew Rognlie, Martin Souchier, and Ludwig Straub
NBER Working Paper No. 28872
May 2021, Revised June 2021
JEL No. E52,F32,F41

                                           ABSTRACT

Introducing heterogeneous households to a New Keynesian small open economy model amplifies
the real income channel of exchange rates: the rise in import prices from a depreciation lowers
households' real incomes, and leads them to cut back on spending. When the sum of import and
export elasticities is one, this channel is offset by a larger Keynesian multiplier, heterogeneity is
irrelevant, and expenditure switching drives the output response. With plausibly lower short-term
elasticities, however, the real income channel dominates, and depreciation can be contractionary
for output. This weakens monetary transmission and creates a dilemma for policymakers facing
capital outflows. Delayed import price pass-through weakens the real income channel, while
heterogeneous consumption baskets can strengthen it.


Adrien Auclert                                    Martin Souchier
Department of Economics                           Department of Economics
Stanford University                               Stanford University
579 Jane Stanford Way                             579 Jane Stanford Way
Stanford, CA 94305                                Stanford, CA 94305
and NBER                                          souchier@stanford.edu
aauclert@stanford.edu
                                                  Ludwig Straub
Matthew Rognlie                                   Department of Economics
Department of Economics                           Harvard University
Northwestern University                           Littauer 211
2211 Campus Drive                                 Cambridge, MA 02139
Evanston, IL 60208                                and NBER
and NBER                                          ludwigstraub@fas.harvard.edu
matthew.rognlie@northwestern.edu




A online appendix is available at http://www.nber.org/data-appendix/w28872
1      Introduction
How do open economies respond to exchange rate shocks, such as those caused by cap-
ital flows? What is the role of exchange rates in monetary transmission? The canonical
answers to these questions are derived from models with a representative agent.1 In
these models, marginal propensities to consume are small, muting the income effects of
exchange rates for shocks at business cycle frequencies.
    In this paper, we revisit these questions in a Heterogeneous Agent New Keynesian
model that features higher marginal propensities to consume, in line with empirical evi-
dence.2 We first provide novel neutrality results under which heterogeneity is irrelevant.
We then argue that, in the empirically relevant case, heterogeneity generates a powerful
real income channel that limits or even undoes the expansionary effects of depreciations
and weakens monetary transmission. This provides an explanation for the common pol-
icy view that depreciations can cause declines in output, even when foreign currency
borrowing is not an issue.3
    To isolate the forces that make heterogeneity relevant, we take as our benchmark
the canonical representative-agent (RA) model of Galí and Monacelli (2005). This is a
complete-market model of a small open economy, in which the law of one price holds for
individual goods. Instead of complete markets, we consider incomplete markets for both
aggregate and idiosyncratic risk. A large mass of domestic residents faces idiosyncratic
income uncertainty and borrowing constraints. We consider two main types of shocks:
exchange rate shocks (shocks to the foreign interest rate that do not affect foreign demand)
and domestic monetary policy shocks.
    For exchange rate shocks, we show, using a sequence-space representation of the
model (Auclert, Rognlie and Straub 2018, Auclert, Bardóczy, Rognlie and Straub 2021b)
that the output response combines three effects: an expenditure switching channel, a real
income channel, and a Keynesian multiplier channel. The RA model only has expendi-
ture switching, whose magnitude is governed by the composite parameter , equal to
    1 SeeObstfeld and Rogoff (1995), Corsetti and Pesenti (2001), Clarida, Galí and Gertler (2002) and Galí
and Monacelli (2005), as well as the textbook treatments in Galí (2008) and Uribe and Schmitt-Grohé (2017).
    2 High MPCs have been documented in advanced economies and emerging markets alike, see for in-

stance Johnson, Parker and Souleles (2006) for the United States, Jappelli and Pistaferri (2014) for Italy,
Fagereng, Holm and Natvik (2020) for Norway, and Hong (2020) for Peru.
    3 On contractionary devaluations, Frankel (2005) says: "Why are devaluations so costly? Many of the

currency crises of the last 10 years have been associated with output loss. Is this, as alleged, because of ex-
cessive reliance on raising the interest rate as a policy response? More likely, it is because of contractionary
effects of devaluation." Although widespread, this policy view is difficult to back up empirically because
it is very challenging to identify exogenous exchange rate shocks in the data. This makes it even more
important to study the conditions under which contractionary depreciations can emerge in microfounded
general equilibrium models.


                                                       2
the sum of the price elasticities of imports and exports (the trade elasticity).4 This chan-
nel is unchanged in the heterogeneous agent (HA) model. Instead, there are two new
forces, both of which work through households' real income: the "real income channel"
through which rising import prices reduce aggregate consumption, and the multiplier
on aggregate output. Since the multiplier depends on the overall output response, its
importance grows with . Our first neutrality result states that, when  = 1, the two
new forces exactly cancel, and the RA and HA models have identical responses to any ex-
change rate shock. In fact, the response is independent of the market structure both across
and within countries. Intuitively, when the trade elasticity is equal to 1, the rise in out-
put from expenditure switching is exactly enough to offset rising import prices, leaving
each household's real income and therefore its consumption unchanged. The trade bal-
ance also remains constant, as reallocation from foreign to domestic goods offsets higher
prices on the foreign goods.
    When the trade elasticity  is below 1 instead, the real income channel dominates.
This makes the output response in the HA model lower than in the RA model. For  suf-
ficiently below one, this response turns negative: a contractionary depreciation emerges.
Qualitatively, the same effect is also at play in a representative-agent model with incom-
plete markets for aggregate risk (RA-IM). But we show that it is quantitatively much
larger in an HA model calibrated to feature realistically high MPCs. In other words, het-
erogeneity "sizes up" the real income channel that Díaz Alejandro (1963) and Krugman
and Taylor (1978) had emphasized as a potential source of contractionary devaluations.5
By contrast, when  > 1, the multiplier effect dominates, and depreciations are even more
expansionary. Hence, our theoretical result is one of complementarity between heterogene-
ity and trade elasticities. Later, we argue that the relevant empirical counterpart of  is
the short-run trade elasticity, which tends to be less than 1.
    We next study the case where the country's export prices, just like its import prices,
are sticky in foreign currency--the so-called "dollar currency pricing" (DCP) paradigm,
which the literature has recently argued to be the relevant empirical benchmark for a
broad set of countries (Gopinath 2016, Boz et al. 2020). Working with representative-agent
models, this literature has emphasized the fact that there is less expenditure switching un-
der DCP than in the producer currency pricing (PCP) setting, so that the output response
   4 This is the elasticity that enters the well-known Marshall-Lerner condition, which states that, in par-
tial equilibrium, depreciations improve the trade balance when  > 1. We show that in our model, this
condition also applies in general equilibrium.
    5 We show that a two agent (TA) model calibrated to the same MPCs as our HA model also generates

quantitatively large contractionary devaluations at low . To our knowledge, this result is new to the
literature on two agent models. However, in the HA model, the contraction is larger and more persistent,
due to the larger "intertemporal marginal propensities to consume" (Auclert, Rognlie and Straub 2018).


                                                     3
to depreciations is lower under DCP than under PCP. In an HA model, however, we show
that there is another force, because the depreciation causes an increase in exporter profit
margins that can in turn spur increased spending at home. We find that, when  is suf-
ficiently small, this new force can dominate: then, our HA model with DCP has less of a
contraction in response to a depreciation than our HA model with PCP.
    Turning to monetary policy, we show that there also exists a threshold level of the
trade elasticity for which heterogeneity is irrelevant. This result requires an elasticity of
intertemporal substitution of 1, and a trade elasticity of  = 2 - , with   (0, 1) de-
noting the openness of the country. As in the exchange rate case, this involves a constant
trade balance; here we need a higher trade elasticity  to offset the increase in import de-
mand from rising consumption in a monetary expansion. The  = 2 -  level includes the
Cole-Obstfeld parametrization, in which both domestic and foreign agents have unitary
elasticities of substitution. In fact, our neutrality result is reminiscent of the original Cole
and Obstfeld (1991) result, which established that with Cobb-Douglas elasticities, market
structure was irrelevant for the effect of productivity shocks. Our result shows that the
same is true for monetary policy shocks, and also for a much broader set of market struc-
tures including within-country incomplete markets with respect to idiosyncratic shocks.
In that sense, our result also generalizes Werning (2015)'s seminal neutrality result for
closed economies to an open economy setting.6
    Away from this benchmark, when  < 2 - , the output response is lower in the
HA model than in the RA model--another manifestation of a dominant real income ef-
fect. One way to understand this result is that, with elasticities below Cobb-Douglas,
a temporary monetary expansion induces a current account deficit, as in Tille (2001).
The resulting negative net foreign asset position must be repaid later. However, absent
further monetary stimulus, repayment must occur without a depreciated exchange rate,
and hence without increased exports. Instead, the trade balance improves via depressed
imports--which can only be achieved through a domestic contraction. Thus, in an HA
model with  < 2 - , monetary easing raises current demand at the expense of a future
contraction: it "steals demand from the future". Since this mechanism operates through
the current account, it is different from the effect of durable goods or indebted demand in
closed economies (McKay and Wieland, 2019, Mian, Straub and Sufi, 2020).
    Our benchmark model allows for clean analytical results, but it says nothing of the em-
pirically relevant level of the trade elasticity . A simple quantification is difficult because
trade elasticities are well documented to be dynamic: smaller in the short run than in the
   6 Weshow that our neutrality result can be extended to productivity shocks, as in the original Cole and
Obstfeld (1991) paper.


                                                    4
medium to long run.7 We address this shortcoming of our baseline model by building a
quantitative extension. In it, we incorporate a tractable model of "delayed substitution",
in which consumers can only substitute between goods with a given Calvo probability.8
Calibrating to the evidence in Boehm, Levchenko and Pandalai-Nayar (2020), we find
that our model generates a "J curve", with a trade elasticity that is smaller than 1 in the
short-run, but larger than 1 in the long-run. As a consequence, our quantitative model
finds that transitory depreciation shocks are contractionary in the short run.
    Aside from accounting for dynamic trade elasticities, the quantitative model also al-
lows us to speak to several other issues: we show that when consumption baskets of the
poor are skewed towards imported goods (as in e.g. Cravino and Levchenko, 2017), the
real income channel is amplified and a depreciation is more likely to be contractionary;
we find that the real income channel is larger than a balance sheet channel calibrated to
the net currency exposure of a typical country (which has shrunk in recent decades, e.g.
Lane and Shambaugh 2010); and we find that the real income channel is stronger the
faster exchange rates pass through to retail prices of imported goods--and hence, likely
stronger in emerging markets.
    Our model can speak to the common perception of a dilemma for policymakers facing
capital outflows--captured in our model as exchange rate depreciation shocks. On the
one hand, outflows are contractionary, and fighting them with accommodative monetary
policy exacerbates the depreciation. On the other hand, stabilizing the exchange rate by
tightening monetary policy comes with the negative side effects of higher interest rates
domestically, as in Gertler, Gilchrist and Natalucci (2007) and Gourinchas (2018). We use
our model to derive the unique output-stabilizing monetary policy. For countries with
fast import price pass-through, such as many emerging markets, this policy involves hik-
ing interest rates to stabilize the exchange rate; for countries with slow import price pass-
through, such as many advanced economies, this policy involves easing interest rates to
stabilize output. This finding aligns well with the contrasting responses of developed and
emerging markets to U.S. monetary policy shocks documented in Kalemli-Özcan (2019).
    Our paper relates to a literature that stresses the importance of the real income chan-
nel, which was first studied by Díaz Alejandro (1963) and Krugman and Taylor (1978) in
the context of IS-LM models. Working with a first-generation new open economy model
   7 See, e.g., Hooper, Johnson and Marquez (2000), Fitzgerald and Haller (2018), Feenstra, Luck, Obstfeld
and Russ (2017), Auer, Burstein, Erhardt and Lein (2019), Amiti, Itskhoki and Konings (2020), Boehm,
Levchenko and Pandalai-Nayar (2020), and Auer, Burstein and Lein (2021).
    8 This approach complements a structural literature on models of delayed adjustment of firms export

and import decisions, as in e.g., Baldwin (1988), Baldwin and Krugman (1989), Ruhl (2008), Drozd and
Nosal (2012), Alessandria and Choi (2019). See Alessandria, Arkolakis and Ruhl (2020) for a review of this
literature.


                                                    5
with prices set one period in advance, Corsetti and Pesenti (2001) analytically showed
that monetary accommodations have a "beggar-thyself effect" through this channel. Their
model featured unitary elasticities, so while this effect reduced country welfare, it did not
lower aggregate consumption or output. Later, Tille (2001) extended this model to feature
a non-unitary elasticity substitution between goods and noted that, when this elasticity
was low enough, his model "allow[ed] for the possibility of a devaluation to reduce con-
sumption", though not output.9
    Our two neutrality results relate to a large international macro literature that, building
on the original Cole and Obstfeld (1991) result, studies how the structure of asset markets
matters for the aggregate effects of international shocks (Baxter and Crucini 1995, Heath-
cote and Perri 2002). In the context of a representative-agent model, Itskhoki (2020) gen-
eralizes the Cole-Obstfeld equivalence between complete markets and financial autarky
to a broader range of shocks, including monetary policy shocks. We provide similar neu-
trality results for monetary policy and exchange rate shocks, showing that this requires
different trade elasticities, and consider a much broader set of market structures.
    Finally, our paper relates to an emerging literature that analyzes the effects of inter-
national shocks in the context of heterogeneous-agent, New Keynesian open economy
models.10 This literature has mostly focused on heterogeneous effects of shocks. Gi-
agheddu (2020) studies the distributional effects of fiscal devaluations. de Ferra, Mitman
and Romei (2020) study the distributional effect of depreciations when agents hold differ-
ent amounts of foreign currency debt. Guo, Ottonello and Perez (2021) study the distribu-
tional effects of international shocks when agents differ by their sector of work and their
financial integration, finding that these sources of heterogeneity can play a major role,
and create trade-offs in the conduct of monetary policy. Other recent papers studying the
redistributive effects of external shocks include Zhou (2020), Oskolkov (2021) and Otten
(2021). Relative to these papers, ours focuses on aggregate rather than distributional ef-
fects, provides sharp benchmark results on when heterogeneity matters and when it does
not, and shows that heterogeneity can cause contractionary depreciations.


Layout. Section 2 sets up our baseline model. Section 3 considers the effect of exchange
rate shocks, while section 4 considers the transmission of monetary policy. Section 5 intro-
duces our quantitative model, which we use to study the role of delayed substitution, de-
layed import price pass-through, heterogeneous consumption baskets, and the response
   9 Inrelated work, Corsetti, Dedola and Leduc (2008) showed that the real income effect can explain the
Backus-Smith correlation in response to productivity shocks.
  10 See Farhi and Werning (2016), Farhi and Werning (2017), and Cugat (2019) for New Keynesian open

economy models with two agents.


                                                   6
of monetary policy to contractionary capital outflows. Appendix A contains details on
our benchmark model, appendix B collects all proofs, and appendix C contains details on
our quantitative model. Appendix D presents three alternative models, which we show
can reinterpreted as versions of ours: one with nontraded goods, one with imported in-
termediates, and one in which the country is a commodity exporter.


2    A baseline heterogeneous-agent open economy model
Our modeling approach merges two New Keynesian traditions: the heterogeneous-agent
("HANK") framework for closed economies and the New Open Economy macro frame-
work for open economies. Specifically, our model builds on the open-economy model
of Galí and Monacelli (2005). To this model we add incomplete markets, heterogeneous
households, and sticky wages as in Auclert, Rognlie and Straub (2018).


Model setup. Time is discrete and the horizon is infinite. We focus directly on the prob-
lem of a small open economy understood, as in Galí and Monacelli (2005), as part of a
world economy consisting of a continuum of countries. We denote variables with a star
superscript when they correspond to the world economy as a whole. We consider perfect-
foresight impulse responses to shocks starting from a steady state without aggregate un-
certainty ("MIT shocks"). We use the solution method from Auclert et al. (2021b), which
linearizes with respect to these shocks. By certainty equivalence, its impulse responses
are therefore the same as those of the model with aggregate risk.
    There are two goods in the economy: domestically produced "home" goods H , which
can be exported, and "foreign" goods F, which are produced abroad and imported.
    Domestic households. The economy is populated by a continuum of households. Each
household is subject to idiosyncratic income risk in the form of productivity shocks eit ,
which follow a first-order Markov chain with mean Eeit = 1. Households can only insure
this risk by investing their assets in a domestic mutual fund, whose returns cannot be
indexed to idiosyncratic productivity. A household with asset position a and productivity
level e at time t optimally chooses her consumption of the two goods, c H , c F , and saving
a , by solving the dynamic program

              Vt ( a, e)     =     max u (c F , c H ) - v ( Nt ) + Et Vt+1 a , e
                                  c F ,c H , a
                                  PFt      PHt                p      Wt
                           s.t.       cF +     c H + a = 1 + rt a + e Nt                 (1)
                                   Pt       Pt                       Pt
                                  a a

                                                 7
Here, PFt is the nominal price of foreign goods in domestic currency units, PHt is the price
                      p
of domestic goods, rt denotes the ex-post mutual fund return in units of the consumer
price index Pt , Wt is the nominal wage, Nt denotes labor supplied by households, de-
termined by union demand as specified below; and a  0 parametrizes the borrowing
constraint agents face. Households share the common per period utility function

                                              c 1-                               N 1+ 
                           u (c F , c H ) =         ,            v (N) = 
                                              1-                                 1+

where c is the consumption basket

                                    (  -1) /                           (  -1) /   / (  -1)
                       c = 1/ c F               + (1 - )1/ c H                                  (2)

The parameter  > 0 is the inverse elasticity of intertemporal substitution,  > 0 the
inverse Frisch elasticity of labor supply, and  > 0 is the elasticity of substitution between
home and foreign goods.  measures the openness of the economy (1 -  is the degree of
home bias in preferences).  > 0 is a normalization constant. The consumer price index
for these preferences is
                                          1-                      1- 1/(1- )
                              Pt   PFt          + (1 - ) PHt                                    (3)

Households differ in their level of spending but have the same consumption basket and
use the same price index.11 Standard results imply that a household in state ( a, e), with
consumption ct ( a, e), splits her purchases between foreign and home goods according to

                                                             -
                                                    PFt
                            c Ft ( a, e) =                        c t ( a, e )                  (4)
                                                    Pt
                                                                        -
                                                                 PHt
                           c Ht ( a, e) = (1 - )                            c t ( a, e )        (5)
                                                                  Pt

Monetary policy abroad keeps the price of foreign goods in foreign currency constant,
   = P = 1. For now, we assume that imports are denominated in foreign currency and
PFt     t
that there is perfect pass-through of exchange rates into domestic goods prices: the law
of one price holds at the good level, so that PFt = Et , where Et is the nominal exchange
rate.12 The real exchange rate is then given by
                                                            Et
                                                 Qt                                             (6)
                                                            Pt
  11 Section5 considers non-homothetic preferences, under which poor households can consume foreign
goods in different proportions than rich households.
  12 We relax this assumption in section 5.



                                                        8
With this convention, an increase in Et indicates a nominal depreciation, and an increase
in Qt a real depreciation.
    Foreign households. Foreign households face the same problem as domestic households.
We set up their problem in appendix A.1 along the lines of Galí and Monacelli (2005),
so that they consume an exogenous and constant quantity C  of worldwide goods, and
spread their own consumption of foreign goods across all foreign countries, with an elas-
                                                               the foreign-currency price
ticity of substitution across countries of  > 0. Denoting by PHt
of domestically produced goods, export demand for home goods is given by

                                                               -
                                                     PHt
                                           CHt =                   C                                    (7)
                                                     P
                                                                               is equal
We assume that the law of one price holds for foreign goods as well, so that PHt
to the cost PHt /Et of a domestic good in foreign currency units:

                                                         PHt
                                               PHt =                                                    (8)
                                                          Et

This formulation effectively assumes the producer currency pricing (PCP) paradigm from
the celebrated Mundell-Fleming model, adopted by Galí and Monacelli (2005) and many
others, in which exchange rates fully pass through to foreign-currency prices of exported
goods. Below, we also consider dollar currency pricing (DCP), where the foreign currency
price of home goods PHt    is sticky in foreign currency.

   Trade elasticities of imports and exports. Aggregating equation (4) across consumers, the
                                                           -
volume of aggregate imports is CFt =  P       Ft
                                             Pt     Ct . Holding aggregate consumption
Ct fixed, the elasticity of imports with respect to the relative price of imports PFt / PHt
is  (1 - ). The volume of exports is given by CHt     in equation (7). The elasticity of
                                                                   / P , holding foreign
exports with respect to the relative price that foreigners see, PHt    Ft
                                     13
consumption C fixed, is equal to . We denote by  the sum of these two elasticities,

                                               (1 -  ) +                                                (9)

which we henceforth refer to as the trade elasticity. It plays a key role in our analysis.
   Production of home goods. Home goods are produced from domestic labor with constant
returns,
                                        Yt = ZNt                                           (10)
  13 That      log C           log P / P  t                         log C       log P / P
         is,  log P /Ft              Ft
                          = -  log PFt                                  / P = -   log P / P = - . The latter
                                       / PHt = -  (1 -  ), while  log PHt
                                                                          Ht           Ht  t
                   Ft PHt                                                    Ft        Ht  Ft
does not depend on foreign home bias because the home country is too small to affect the foreign CPI.


                                                     9
where Nt is aggregate labor supplied and Z is the constant level of labor productivity.
There is a continuum of monopolistically competitive firms producing home goods with
technology (10). Let denote the elasticity of substitution between varieties produced
within a country. For now, we assume that prices are fully flexible, so that the price of
home goods is set at a constant markup µ over nominal marginal costs,

                                                         Wt
                                              PHt = µ                                                 (11)
                                                         Z

where µ = /( - 1). Real dividends by firms are equal to
                                                       -P
                                   PHt Yt - Wt Nt Et PHt  Ht 
                              Dt =               +          CHt                                       (12)
                                          Pt           Pt

The second term is zero under PCP, and captures profits from exporters' unhedged cur-
rency exposure under DCP. Firms have a unit mass of shares outstanding, with end-of-
period price pt . As is usual, their objective is to maximize firm value Dt + pt .
    Financial sector. We assume frictionless capital flows across countries. At home, an
unconstrained, risk-neutral mutual fund issues claims to households, with aggregate real
value At at the end of period t, and can invest in four types of assets: domestic nominal
bonds with an interest rate it , foreign nominal bonds with an interest rate it , domestic firm

shares with return ( pt+1 + Dt+1 ) / pt , and foreign firm shares. Its objective is to maximize
                                                         p
the (expected) real rate of return on its liabilities rt+1 . In equilibrium, this implies that
expected returns on all four assets are equal, and that the mutual fund's portfolio choice
is indeterminate.14 Appendix A.1 shows that equality of expected returns implies the
standard uncovered interest parity (UIP) condition,
                                                               E t +1
                                        1 + i t = (1 + i t )                                          (13)
                                                                Et

Moreover, defining the ex-ante real interest rate as
                                                                Pt
                                        1 + r t  (1 + i t )                                           (14)
                                                               Pt+1

gives the ex-post return at t + 1 on the mutual fund, as well as the ex-ante return on
domestic stocks:
                                            p     p     + Dt +1
                            1 + r t = 1 + r t +1 = t +1                            (15)
                                                        pt
  14 Note that our MIT shock assumption implies that markets are effectively incomplete with respect to

country risk. Solving for the complete market allocation while maintaining incomplete markets for id-
iosyncratic risk is technically challenging. We will show that our effects remain in a two-agent model with
complete markets across countries; see also Kekre and Lenel (2020) for a related setting.


                                                    10
                                        p
The ex-post mutual fund return r0 at date 0 depends on its portfolio, and our baseline is
to resolve portfolio indeterminacy by assuming that coming into date 0, the mutual fund
is invested entirely in domestic stocks. Given this assumption, which we relax in section
5.6, the second equality in (15) holds for t = -1 as well, with p-1 = pss .
    Combining (6), (13), and (14), we obtain a real version of the UIP condition

                                                               Q t +1
                                       1 + r t = (1 + i t )                                          (16)
                                                                Qt

which we appeal to extensively in our analysis. We define the net foreign asset position to
be the difference between the value of assets accumulated domestically, At , and the total
value of assets in net supply domestically, pt , i.e.

                                            nfat  At - pt                                            (17)

                                 in equation (16) are exogenous. Appendix A.1 micro-
    The foreign interest rates it
founds their variation at fixed aggregate foreign demand C  by assuming exogenous
variations in the time preference rate of foreign households. This assumption allows us
to derive a clear complete market benchmark.15
    Unions. We assume a standard formulation for sticky wages with heterogeneous house-
holds, similar to Auclert, Rognlie and Straub (2018). A union employs all households for
an equal number of hours Nt , and is in charge of setting nominal wages by maximizing
the welfare of the average household. We choose the union objective function so that this
problem leads to the wage Phillips curve

                                              v ( Nt )
                             wt = w          1 Wt
                                                              - 1 + wt+1                             (18)
                                            µw Pt u   (Ct )

where wt denotes nominal wage inflation,
                                                       Wt
                                            wt             -1
                                                      Wt-1

Wage inflation rises when marginal disutility of average work v ( Nt ) is higher than the
product of the marked-down real wage by the marginal utility of average consumption
  15 We show in appendix A.2 that we obtain an identical model if we instead microfound exogenous move-
           as exogenous "UIP shocks", such as risk premium or noise trader shocks, as in e.g. Farhi and
ments in it
Werning (2014), Gabaix and Maggiori (2015) and Itskhoki and Mukhin (2020). In section 5.7, we also con-
sider an extension of this model in which UIP deviations are endogenous to the country's net foreign asset
position.




                                                      11
 1 Wt
µw Pt u   (Ct ), now or in the future.16 If we derive this equation from a Calvo specification
                                                                         w     w  (1-  )(1- )
where the probability of keeping the wage fixed is w , then w =           w      .
    Fiscal policy and monetary policy. The government does not spend, tax or use transfers,
and domestic bonds are in zero net supply. The monetary authority sets the nominal
interest rate according to a monetary rule. It is standard in the open-economy literature
to consider a few of these rules. For the analytical results that we develop in the next two
sections, we consider a specification in which monetary policy holds the real interest rate
constant:
                                       it = rss + t+1 + t                                (19)

This is a CPI-based Taylor rule with a coefficient of 1 on expected inflation. This monetary
rule achieves a middle ground between standard CPI-based Taylor rules with responsive-
ness larger than 1, and zero-lower-bound specifications with a fixed nominal interest rate,
and is widely used in the literature as a device to partial out the effects of monetary policy
in the study of the effects of shocks to aggregate demand (e.g. Woodford 2011, McKay,
Nakamura and Steinsson 2016, Auclert, Rognlie and Straub 2018). In section 5 and in
appendix B.9, we consider, as an alternative, a standard Taylor rule based on producer
prices,
                                    it = rss +  Ht + t                                    (20)

with  Ht = PP Ht
             Ht-1
                  - 1 and  > 1, which, as we show below, yields similar results to (19).
   Equilibrium. We define an equilibrium as follows.

Definition. Given sequences of foreign interest rate shocks {it              } and monetary shocks

{ t }, an initial wealth distribution D0 ( a, e), and an initial portfolio allocation for the mu-
tual fund, a competitive equilibrium is a path of policies {c Ht ( a, e) , c Ft ( a, e) , ct ( a, e) , at+1 ( a, e)}
                                                                                                 p
for households, distributions Dt ( a, e), prices Et , Qt , Pt , PHt , PFt , Wt , pt , it , rt , rt , and ag-
gregate quantities {Ct , CHt , CFt , Yt , At , Dt , nfat }, such that all agents optimize, firms opti-
mize, and the domestic goods market clears:

                                                     
                                              CHt + CHt = Yt                                              (21)

where CHt  e e c Ht ( a, e) Dt ( a, e) denotes aggregate consumption of home goods,
and Ct , CFt , At are defined similarly. We focus on equilibria in which the long-run ex-
change rate returns to its steady state level, Q = Qss .
  16 InAuclert, Rognlie and Straub (2018)'s formulation of the union problem, the consumption level that
                                                                               -1
enters the Phillips curve in (18) is equal to a consumption aggregator Ct  (u ) (E [eit u (cit )]) that takes
into account inequality in labor earnings. Here we opt for the simpler formulation in (18), because it helps
streamline some of our analytical results.

                                                      12
    Appendix A.3 shows that, in equilibrium, the current account identity holds:

                                       PHt                          p
                   nfat - nfat-1 =         Yt - Ct + rt-1 nfat-1 + rt - rt-1 At-1                          (22)
                                        Pt

where P  Pt Yt - Ct  NXt is the value of net exports (or, equivalently, the trade balance) in
          Ht

                                                        p
units of the CPI, and the valuation effect term rt - rt-1 At-1 is zero for all t  1.
    We consider a steady state with no inflation and no initial gross positions across bor-
ders. That is, the domestic mutual fund owns all stocks issued by domestic firms and
the net foreign asset position is zero. Without loss of generality, we normalize prices to 1
                                                           , E , Q are all equal to 1. Moreover,
in this steady state, implying that PHss , PFss , Pss , PHss  ss  ss
we normalize domestic steady-state output Yss to 1. Hence, Css and C  also equal 1. Ap-
pendix A.4 shows that the unique Q = 1 steady state, to which the economy returns
after transitory shocks, also has no net foreign asset position and C = Y = 1. Hence,
our heterogeneous-agent model is stationary without the need for a debt-elastic interest
rate, as in Schmitt-Grohé and Uribe (2003) or the large literature that followed.17


Complete-market representative-agent model ("RA model"). Throughout the paper,
we compare the heterogeneous-agent model just described with the canonical representative-
agent model of Galí and Monacelli (2005), in which there are complete markets across
households and across countries. We spell out the details of this model in appendix A.5,
where we show that that the consumption behavior of the representative domestic house-
hold is described by the Backus-Smith condition

                                               Qt -   -
                                                 C = Css                                                   (23)
                                               Bt t
                              
                         1+ i s
where Bt  st             1+rss    is the exogenous preference shifter of foreign households, as-
sumed to satisfy B = 1.18 We further show that this complete-market model admits the
exact same log-linear equations as the original Galí and Monacelli (2005) model, extended
to allow for foreign discount factor shocks. In particular, since we are not considering pro-
ductivity shocks, our assumption that wages rather than prices are sticky is innocuous.19
  17 Ghironi  (2006) also observed that his non-Ricardian model, based on overlapping generations, auto-
matically achieved stationarity. Another way to achieve stationarity, at least in principle, is to solve for the
global, nonlinear solution amidst idiosyncratic shocks to each country, as in Clarida (1990).
  18 In this model, the primitive is the path of B . Foreign interest rates follow from 1 + i  = (1 + r ) Bt .
                                                  t                                           t        ss Bt+1
  19 As explained in Auclert, Bardóczy and Rognlie (2021a) and Broer, Hansen, Krusell and Öberg (2020),

the assumption of sticky wages and flexible prices is better suited to heterogenous-agent models than the
opposite assumption of sticky prices and flexible wages.



                                                      13
Incomplete-market representative-agent model ("RA-IM model"). We briefly touch
on two additional models in section 3 below. The incomplete-market representative-agent
model is identical to our baseline heterogeneous-agent model, except that there is no het-
erogeneity or idiosyncratic income risk in (1). Here, the Backus-Smith condition (23) does
not hold, and the representative agent's consumption behavior is characterized by its
budget constraint and the Euler equation

                                    -               -
                                   Ct =  (1 + rt ) Ct +1                                 (24)

This model is not stationary, and we describe its solution in appendix A.6.


Two-agent model ("TA model").        We also compare our model to a two-agent model
(as in the closed-economy work of Galí, López-Salido and Vallés 2007 and Bilbiie 2008,
and the open-economy work of Farhi and Werning 2017 and Cugat 2019). In this model,
we assume a fraction  of hand-to-mouth households, and a fraction 1 -  of households
with access to complete international markets, for whom an equation analogous to (23)
holds. We describe this model further in appendix A.7.


3    Exchange rate shocks
We start by considering shocks to foreign interest rates it in (16), caused by preference
                        
                   1+ i s
shocks Bt = st 1+rss      to foreign households. Combining the real UIP condition (16),
the fact that Q = 1, and the constant real rate (19), we find that the real exchange rate is
given by
                                                 
                                            1 + is
                                Qt =                  = Bt                             (25)
                                      st 1 + rss

Intuitively, when foreign households become more impatient (rising Bt ), they push up
                         , leading to capital outflows that depreciate the exchange rate (ris-
foreign interest rates it
ing Qt ). Given (25), the real exchange rate is effectively exogenous in this section.
   Our analysis is centered around the home goods market clearing condition (21). After
substituting in the demands (5)-(7) and the price-setting condition for PCP (8), we can
write this condition as
                                              -                  -
                                        PHt                PHt
                        Yt = (1 - )                Ct +              C                   (26)
                                         Pt                 Et

The relative prices in equation (26) are tied to the real exchange rate Qt . A depreciation


                                              14
                                                   Figure 1: The exchange rate shock

                                             Foreign interest rate                                              Real exchange rate
                              0.20                                                                1.2


                                                                                                  1.0
                              0.15
                                                                                                  0.8




                                                                               Percent of s.s.
                              0.10                                                                0.6
                    Percent




                                                                                                  0.4
                              0.05
                                                                                                  0.2


                              0.00                                                                0.0


                                                                                                 -0.2
                                     0   5    10     15       20     25   30                            0   5   10     15       20   25   30
                                                   Quarters                                                          Quarters


Note: AR(1) shock to it  with persistence 0.85, and corresponding impulse response of the real exchange rate Q . The shock is normal-
                                                                                                              t
ized so that the real exchange rate depreciates by 1% on impact.



lowers the price of home goods relative to the domestic CPI, PHt / Pt , and relative to the
foreign CPI, PHt /Et . This leads domestic and foreign consumers to substitute towards
home goods. In addition to these traditional expenditure switching effects, the volume of
domestic spending Ct may change. In this section, we characterize how this response is
affected by the market structure and heterogeneity among agents.
    Throughout this section and the next, we illustrate our results with a numerical cali-
bration, which we describe in detail in section 5. We intentionally leave the trade elasticity
 (and thus  , ) unspecified for now. We choose an openness of  = 0.40 as in Galí and
Monacelli (2005). We assume that it follows an AR(1) shock with quarterly persistence of

 = 0.85, and that it is normalized to have an impact effect of 1 on the real exchange rate
dQ0 (see figure 1).20


3.1      Complete-market benchmark
We start by considering the complete-market representative-agent model ("RA model").
Combining (25) with the Backus Smith condition (23), we immediately find that consump-
tion does not respond to the shock, Ct = Css = 1.21 Equation (26) then implies that
domestic production is only affected by expenditure switching.

Proposition 1. In the complete-market representative-agent model with real interest rate rule
(19), the linearized deviations from steady state consumption over output, dCt = (Ct - Css ) /Yss
   20 This quarterly persistence is typical for exchange rate shocks in estimated models (see e.g. Eichenbaum,

Johannsen and Rebelo 2021 for a recent example), as well as to standard estimates of the (HP-filtered)
unconditional persistence of the real exchange rate, such as those in Chari, Kehoe and McGrattan (2002).
   21 Consumption comoves negatively with real exchange rates in response to other shocks that keep B =
                                                                                                           t
                                                              -
1, since the Backus-Smith condition (23) dictates that Qt Ct     is constant in response to these shocks.

                                                                           15
                                             Figure 2: Effect of exchange rate shocks on output for various 's

                                   RA model - complete markets                          RA model - incomplete markets                                HA model
                                                              =1                                                   =1                                                 =1
                       0.6                                                   0.6                                                  0.6
                                                               = 0.5                                                = 0.5                                              = 0.5
                                                               = 0.1                                                = 0.1                                              = 0.1

                       0.4                                                   0.4                                                  0.4
 dY (percent of ss)




                       0.2                                                   0.2                                                  0.2



                       0.0                                                   0.0                                                  0.0



                      -0.2                                                  -0.2                                                 -0.2


                             0     5    10      15       20   25       30          0     5    10     15       20   25       30          0   5   10      15       20   25       30
                                              Quarters                                             Quarters                                           Quarters

                                                             displayed in Figure 1.  is the trade elasticity (the sum of the import and
Note: impulse response in all three models to the shock to it
export elasticity to the exchange rate). The HA model generates a contraction on impact for  <  = 0.37.



and output dYt = (Yt - Yss ) /Yss in response to shocks to the real exchange rate dQt = ( Qt - Qss ) / Qss
are given by

                                                                            dCt = 0         t                                                                              (27)
                                                                                           
                                                                             dYt        =     dQt                  t                                                       (28)
                                                                                          1-

    Proposition 1 captures a common view in the literature: depreciations are expansion-
ary due to expenditure switching, and a greater trade elasticity  leads to a greater expan-
sion dYt . The left panel of figure 2 shows the output response for various values of . A
                                                                       1
1% real depreciation lowers the relative price of home goods by 1-        %, with a combined
                                                                    
effect on imports and exports of 1- % of initial imports, so of 1- % of GDP.
    Going forward, it will be convenient to express impulse responses as vectors, e.g.
dY = (dY0 , dY1 , . . .). With this notation, (27)­(28) become dC = 0 and dY = 1-
                                                                                     d Q.



3.2                              Incomplete markets and the real income channel
We next examine the effects of exchange rate shocks in our heterogeneous-agent model.
In that model--as in any incomplete-market model--consumption is no longer insulated
from movements in real income. To see this, consider the two components of real income:
wages and dividends. First, the price-setting condition (11) combined with the produc-
tion function (10) implies that households' real wage income is given by

                                                                                       Wt      1 PHt
                                                                                          Nt =       Yt                                                                    (29)
                                                                                       Pt      µ Pt



                                                                                                16
Combining (29) with equation (12), we see that real dividends are equal to

                                                            1    PHt
                                         Dt =       1-               Yt                             (30)
                                                            µ     Pt

Both wage income and dividends matter for aggregate consumption. Wage income enters
households' budget constraints (1). Dividends affect the value of home firms, pinning
         p
down r0 via (15), given our assumption on the initial mutual fund portfolio.22 Hence,
real wage income and dividends are the only two aggregate variables needed to solve the
consumption-saving problem of domestic households, and therefore their consumption
policy functions at each date t. Aggregating up and using (29) and (30), we find that
that the path of aggregate consumption Ct is entirely a function of the path of aggregate
                                                                                      
real income P  Ht
               Pt Yt . We  denote  this "consumption   function" by Ct = C t
                                                                               PHs
                                                                                Ps Ys      .23
                                                                                      s =0
Around the steady state, we denote the derivative (Jacobian) of C by M, a matrix with
                   Ct
elements Mt,s        Ys that characterize the date-t consumption response to a date-s change
in real income. Following Auclert, Rognlie and Straub (2018), we refer to the elements of
M as "intertemporal MPCs".24
    Since Yt enters the consumption function, the equilibrium response dYt to an exchange
rate shock dQt is now the solution to the following fixed point problem.

Proposition 2. In response to a shock to the real exchange rate dQ, the impulse response of
consumption is given by
                                         
                            dC = -           MdQ + MdY                                 (31)
                                       1-
                                                                       Multiplier
                                             Real income channel

and the impulse response of output dY is determined by an "international Keynesian cross"

                                
                    dY =          dQ                -         MdQ             + (1 -  ) M d Y       (32)
                               1-
                                                        Real income channel         Multiplier
                           Exp. switching channel


   Proposition 2 shows that the impulse responses of consumption and output only de-
pend on the openness parameter , the trade elasticity , and the matrix of intertemporal
MPCs M. Equation (31) finds that there are two ways in which real income P     Pt Yt , and
                                                                               Ht


hence consumption dC, are affected by an exchange rate depreciation dQ. First, a depre-
  22 For       p
         t > 0, rt is equal to rt-1 , which is held constant by monetary policy in this experiment.
  23 A similar logic underlies the consumption functions used in Kaplan, Moll and Violante (2018), Farhi

and Werning (2019), and Auclert, Rognlie and Straub (2018).
  24 The MPC is most often defined as the immediate response of an individual to a transitory increase in

income. Our M0,0 corresponds to the average of this MPC, weighted by each individual's share of total
income.

                                                         17
ciation lowers P         
                Pt by 1- dQt , that is, it lowers the price of the goods that the country
                 Ht


produces relative to the price of those that it buys. This reduces real income, leading
agents to cut consumption by M × 1-     
                                          d Q. We refer to this as the real income channel.
Second, a depreciation affects the path of output dY, which also enters real income, and
changes consumption by M × dY. This is a standard (Keynesian) multiplier effect.
    Linearizing goods market clearing (26) and substituting in (31), we obtain equation
(32), whose form is like that of a standard Keynesian cross, where the relevant multiplier
is the product of MPCs M by the degree of home bias (1 - ). Including expenditure
switching, there are altogether three distinct channels that jointly determine the output
response to any given shock. The next proposition derives the general solution to (32).

Proposition 3. Assuming M  0, the equilibrium output response is unique and given by

                                                        
                       dY =      (1 -  ) k M k         1-
                                                          dQ - MdQ                                (33)
                                k 0

                                 =(I-(1-)M)-1

    Alternative models of consumption. One advantage of these results is that they apply
not only to any calibration of our heterogeneous-agent model, but also to any model that
                                                                    
                                                             PHs
admits a consumption function of the form Ct = Ct             Ps Ys      with derivative M.
                                                                    s =0
This includes the (complete-market) RA model above, for which M = 0, but also the TA
model and the RA-IM model, whose closed-form solutions we derive in appendices B.7
and B.8, respectively.25 In addition, appendices D.1 and D.2 show that our results also
apply in a model with nontradable goods or with imported intermediate goods. These
models are isomorphic to our baseline model, under a reinterpretation of parameters.
    We use the result in proposition 3 to solve for dY in both the RA and RA-IM models as
well as the HA model, and decompose dY following (32). Figure 3 presents the outcome
of this exercise for the case where  = 1. As we noted already, the output response
in the RA model (left panel) is entirely driven by expenditure switching. In the RA-IM
model (middle panel), there is a small negative real income channel, and a small positive
multiplier effect. Both are an order of magnitude larger in the HA model (right panel). In
other words, the HA model "sizes up" the real income channel.
    An intriguing property of figure 3 is that the multiplier effect exactly undoes the in-
creased real income channel, in both the RA-IM and the HA model. The aggregate output
  25 Bianchi
           and Coulibaly (2021) independently arrived at a decomposition for consumption in a tradable-
                                                                                         to enter the
nontradable RA-IM model. Their decomposition is distinct from ours, in that they allow it
consumption function directly.



                                                  18
                                  Figure 3: Exchange rate shock when  = 1 and its transmission channels

                              RA model - complete markets                                RA model - incomplete markets                            HA model
                                               Total
                    0.6                        Real income channel            0.6                                              0.6
                                               Exp. switching channel
                                               Multiplier
                    0.4                                                       0.4                                              0.4
 Percent of s.s.




                    0.2                                                       0.2                                              0.2



                    0.0                                                       0.0                                              0.0



                   -0.2                                                      -0.2                                             -0.2

                          0   5     10      15       20      25         30          0    5     10     15       20   25   30          0   5   10      15       20   25      30
                                          Quarters                                                  Quarters                                       Quarters

                                                             displayed in Figure 1, with decomposition from proposition 2.
Note: impulse response in all three models to the shock to it



responses dY are therefore identical across models in figure 3. Our next result proves that
this is no coincidence.

Proposition 4. Consider any model of consumption characterized by a matrix M, and an arbi-
trary exchange rate shock dQ. If  = 1, all aggregate quantities and prices are the same as in the
RA model, and in particular, dY = dY RA . Moreover, provided that M > 0, for a depreciation
shock dQ  0, we have

                                                          dY  dY RA                     and    dC  0                          1

    The first part of proposition 4 formally establishes a neutrality result for exchange
rate shocks: when  = 1, the details of household behavior and market structure are
irrelevant as long as there exists an aggregate consumption function of the form Ct =
             
      PHs
Ct     Ps Ys      . This result follows directly from substituting  = 1 into (33). To un-
                                   s =0
derstand why this works, note that when we substitute dY = dY RA = 1-       
                                                                              d Q into (31),
we get dC = 0: for  = 1, the rise in output from expenditure switching is just large
enough to offset the loss of real income from higher prices, leaving total real income and
therefore consumption unchanged in every period. Since consumption is unchanged, the
only effect on output is from expenditure switching, just as in the RA model.
   Our result in proposition 4 is closely related to the Marshall-Lerner condition, which
posits that the response of the trade balance after an exchange rate shock depends on the
position of , the sum of import and export elasticities, relative to 1. Indeed, appendix
B.3 shows that, in our model, the response of the trade balance is given by

                                                                                         
                                                                  dNXt =                   ( - 1) dQt - dCt                                                             (34)
                                                                                        1-

                                                                                                 19
      Figure 4: Complementarity between expenditure switching elasticity  and high MPCs

                                               Volume of output at date 0 dY0                         Consumption at date 0 dC0
                                     1.2       HA
                                               RA
                                     1.0                                                  0.2

                                     0.8
                                                                                          0.0
                                     0.6
                   Percent of ss.


                                     0.4
                                                                                         -0.2
                                     0.2

                                     0.0                                                 -0.4

                                    -0.2
                                                                                         -0.6
                                    -0.4
                                       0.00   0.25   0.50   0.75   1.00    1.25   1.50      0.00   0.25   0.50   0.75   1.00   1.25   1.50
                                                                                                                  


Note: changes on impact in output and consumption following the shock to it  displayed in Figure 1. The HA model generates a
contraction for output on impact for  <  = 0.37 and a contraction for consumption on impact for  < 1. The complete-market RA
model never generates a contraction.



Since the sign of dCt depends on  - 1, the Marshall-Lerner condition holds here in gen-
eral equilibrium.26 At the threshold  = 1, reduced imports and increased exports exactly
offset increased import prices, and the trade balance is unchanged.
    Going beyond the neutrality result, proposition 4 shows that when  lies below 1,
expenditure switching is weaker, reducing the output response Yt , and therefore reducing
the multiplier term. The real income channel is now no longer fully offset, pushing the
output response in the HA model below that in the RA model. The opposite happens
when  > 1.
    Proposition 4 therefore describes a complementarity between the trade elasticity  and
incomplete markets. Reducing  below 1 has a disproportionate effect on output in the
heterogeneous-agent model, as it reduces the multiplier channel while the real income
channel remains unchanged. We illustrate this point in figure 4, which shows the impact
responses of output dY0 and consumption dC0 for the shock considered in figure 1 at
various values of .
    As the right panel in figure 4 illustrates, an interesting implication of  < 1 is that
aggregate consumption falls in response to an exchange rate depreciation in our setting.
This finding is in line with the empirical Backus-Smith correlation, and complements the
recent results of Itskhoki and Mukhin (2020), who show that a similar correlation can be
obtained in a representative-agent model with an active Taylor rule.
  26 Observe that  = 1 does not correspond to the well-known Cole and Obstfeld (1991) parametrization,
which, using (9), is given by  = 2 - . The Cole and Obstfeld (1991) parametrization turns out to be the
relevant one for monetary policy (see section 4).




                                                                                   20
3.3   Contractionary depreciations
A novel feature of the model is that, with  sufficiently below 1, consumption falls by so
much after an exchange rate depreciation that it causes a contraction in output. In other
words, the economy displays contractionary depreciations.

Proposition 5. If  < 1 - , the output response to a depreciation shock dQt  0 has negative
net present value,               -t
                     t=0 (1 + r ) dYt < 0 in the heterogeneous-agent model. Moreover, given a
depreciation shock, there is a threshold  between (1 - ) M0,0 and 1 such that for any  <  ,
the output response is negative on impact, dY0 < 0.

    When  < 1 - , the present value of the real income channel overwhelms the ex-
penditure switching channel in (32), leading to an output response with negative present
value.27 For low enough , expenditure switching is overwhelmed by the real income
channel on impact as well. For instance, if there is a one-time shock to dQ0 , the real in-
come effect at t = 0 is - M0,0 dQ0 , compared to expenditure switching of 1-   
                                                                                  dQ0 . When
 < (1 - ) M0,0 , the former dominates. This dominant real income channel is only rein-
forced by the multiplier in (32), since the real income effect on consumption persists after
the shock has passed, and this persistence feeds back to date 0 via the multiplier. Overall,
for any depreciation, there is a threshold  at which it becomes contractionary:  is at
least (1 - ) M0,0 , and usually greater due to multiplier effects.
    Since this result is driven by the real income channel, it is different from, and comple-
mentary to, the commonly studied balance sheet channel with currency mismatch (e.g.
Aghion, Bacchetta and Banerjee 2004, Céspedes, Chang and Velasco 2004). It can poten-
tially explain the continued relevance of fear of floating (Ilzetzki, Reinhart and Rogoff
2019) and reserve hoarding (Bianchi and Lorenzoni 2021) among countries for which cur-
rency mismatch is no longer an issue (see appendix C.4).
    The right panel of figure 2 illustrates contractionary depreciations. Since  = 0.4, the
present value of the output response is negative whenever  < 0.6--for instance, the
 = 0.5 impulse response features this property. The threshold trade elasticity  for this
calibration is given by  = 0.37.


3.4   Dollar currency pricing
We have seen that the degree of expenditure switching crucially influences whether a
depreciation is expansionary in the HA model. One reason for a weaker expenditure
 27 Since   M conserves present value, taking the present value of both sides of (32) gives PV (dY) =
  
 1-   -      PV (dQ) + (1 - ) PV (dY), so for dQ  0, PV (dY) has the same sign as  - (1 - ).


                                                  21
switching channel is the prevalence of dollar (or dominant) currency pricing (DCP). With
DCP, exports are invoiced in dollars. This means that export prices do not immediately
adjust in response to exchange rate fluctuations (Gopinath, 2016), limiting the response
of export demand (Gopinath et al., 2020).
    To explore the effects of DCP for our model, we replace equation (8) with PHt       = P .
                                                                                               H
Hence, all exports are invoiced in dollars, and for simplicity these dollar prices are fixed.28
This influences our analysis in two ways. First, it lowers the trade elasticity  from
 (1 - ) +  to simply  (1 - ): the volume of export demand no longer responds to a
depreciation. We refer to this as the "standard effect" of DCP. Second, domestic firms'
markups on exports are now endogenous to the exchange rate: after a depreciation,
markups increase, raising profits via equation (12).29 These profits are earned by domes-
tic shareholders, generating a positive effect on spending. We refer to this as the "profit
effect" of DCP.
    To investigate the role of the two effects of DCP, figure 5 compares the output response
to a depreciation under PCP to the responses under DCP with (i) only the standard effect
and (ii) both effects.30 The left panel shows the case of larger elasticities  =  = 1/(2 -
), chosen to give  = 1. Here, the standard DCP effect causes a large reduction in the
output response, as it effectively sets  to zero. The profit effect is positive for output, as
asset owners spend some of the additional profit earned on exports, but here this is not
enough to overturn the lack of export demand, since these asset owners have low MPCs.
    The right panel shows the case of smaller elasticities. There, since  is already small,
the standard effect is much weaker, and it is now reversed by the profit effect: DCP in-
creases the output response, making the depreciation less contractionary.
    To shed further light on this effect, consider the effect of a one-time depreciation dQ0
on output. For any given agent i, the depreciation causes a reduction in real wage in-
          1
come of µ   ei0 , where ei0 is the idiosyncratic productivity of agent i at date 0, and it raises
                              1 ai0        ai0
real dividend income by µ       Ass where Ass is the wealth owned by agent i relative to mean
wealth. Let us define the net exchange rate exposure NXEi of agent i by

                                                  ai0              1
                                     NXEi             - ei0    ·                                    (35)
                                                  Ass              µ
  28 Insection 5 we relax this assumption by allowing for dynamic adjustment of the dollar price.
  29 Barbiero (2020) empirically documents these foreign-exchange-induced variations in the profits of
French firms that price in foreign currency.
  30 One can think of (i) as the case in which exporters are perfectly hedged against exchange rate move-

ments.




                                                   22
                                                                   Figure 5: Capital outflows under dollar currency pricing

                                                                            =  = 1/(2 - )                                             =  = 0.1/(2 - )
                                                             0.7
                                                                           PCP
                                                             0.6           DCP - standard effect                      0.00



                   Change in output dYt (percent of s.s.)
                                                                           DCP - standard effect and profit effect
                                                             0.5                                                     -0.05

                                                             0.4                                                     -0.10

                                                             0.3                                                     -0.15

                                                             0.2                                                     -0.20

                                                             0.1                                                     -0.25

                                                             0.0                                                     -0.30


                                                            -0.1                                                     -0.35
                                                                   0   5     10      15          20        25                0   5    10      15      20   25
                                                                                  Quarters                                                 Quarters


Note: impulse responses to the shock to it displayed in Figure 1. PCP corresponds to producer currency pricing, DCP to dollar
currency pricing. The standard (reduced expenditure switching) and the profit effect are discussed in the main text.



We show in appendix B.4 that the impact output response is then given by

                                                                    
               dY0 =                                                  dQ0 + Cov ( MPCi , NXEi ) dQ0 + (1 - )  M0,s dYs                                          (36)
                                                                   1-                                        s 0


Compared with (32), we see that the real income channel is now given by the cross-
sectional covariance of MPCs and net exchange rate exposures. In our model, this covari-
ance is endogenously negative, since firms' shareholders tend to be richer and have lower
MPCs than agents who predominantly rely on labor income. Our model thus provides
a micro-founded counterpart to Díaz Alejandro (1963) and Krugman and Taylor (1978),
who previously discussed this mechanism in the context of IS-LM models. We regard
measuring net exchange rate exposures such as (35) in the data, and analyzing their ag-
gregate implications using equation (36), as a very promising avenue for future research.
    In commodity exporting countries, exchange rate depreciations also create a profit
effect: they raise the domestic price at which commodity exporting firms sell, so that
depreciations redistribute from workers, whose real income falls, to the owners of these
firms. Appendix D.3 proves that there is, in fact, a formal analogy: by reinterpreting 
and , a model with produced nontradables and endowed tradables (e.g. commodities)
is exactly equivalent to the model with DCP and fixed dollar prices studied here.


4     Monetary policy
We next ask how monetary transmission is affected by heterogeneous agents and incom-
plete markets. Throughout this section we assume log preferences  = 1, which allow for


                                                                                                                 23
a clean analytical characterization. In the interest of space we focus on real interest rate
rules; appendix B.9 considers Taylor rules and shows that our equivalence result extends
to that case, including for the response to productivity shocks.


4.1   Transmission of real interest rates
Given our monetary policy rule (19), monetary policy affects aggregate activity in our
model by directly changing the path of domestic real interest rates {rt }. This has two
distinct effects on household behavior. First, it affects the path of the real exchange rate
{ Qt } through the real UIP condition (16). Given that Q = 1 and i = rss , we now have

                                                               1 + rss
                                                 Qt =          1 + rs
                                                                                                             (37)
                                                        st


These changes in the real exchange rate operate through the expenditure switching and
real income channels analyzed in section 3.
    Second, changes in domestic interest rates affect the economy directly as rt moves as-
set prices and therefore returns at all dates, including by revaluating wealth at date 0.
This induces income and substitution effects that are well-studied in the closed econ-
omy literature (e.g. Auclert 2019). We refer to these effects as the interest rate chan-
nel. Formally, aggregate consumption is now also directly affected by real interest rates,
Ct = Ct     rs , PPs Ys
                  Hs
                         . The interest rate response matrix Mr , which we define as Mt
                                                                                      r 
                                                                                        ,s
(1 + r ) · Ct /rs , captures these closed-economy effects.
    To characterize the effect of monetary policy on output, we again proceed by lin-
earizing the goods market clearing condition. Consider a change {drt } to real interest
                               dr0     dr1
rates, and let dr             1+rss , 1+rss , . . .   . Given (37), the real exchange rate responds by
                drs
dQt = - st 1+     rss , or in matrix notation, d Q = - U d r, where U is a matrix with 1's on
and above the diagonal. Linearizing (21) again, we obtain a generalized version of the
international Keynesian cross (32):
                                               
      d Y = (1 -  ) Mr d r +                     dQ              -        MdQ              + (1 -  ) M d Y   (38)
                                              1-
               Interest rate channel                                 Real income channel       Multiplier
                                        Exp. switching channel


The representative-agent model is still covered as a special case of equation (38), in which
M = 0 and Mr = -U.31 In that case, equation (38) delivers the simple expression dY RA =
- (1 -  ) + 1-
                 U d r.
 31 Recall                                                 1
             that  = 1 in this section. In general, Mr = -   U.


                                                          24
    In the HA model, it is well-understood from the closed-economy literature that the
interest rate channel is less powerful, since agents have less ability to substitute intertem-
porally. In a closed economy, this weaker interest rate channel can be offset by a stronger
multiplier (Werning 2015). In the open economy, however, the multiplier is weaker, since
only a share 1 -  of domestic demand is spent on home goods. Hence, with  = 1, the
HA model has a weaker output response to monetary policy. However, as we prove next,
equivalence is restored at a greater value for , namely  = 2 - .
Proposition 6. Assume  = 1, and consider an arbitrary first-order monetary policy shock dr. If
 = 2 - , all aggregate quantities and prices are identical in heterogeneous and representative-
agent models. Moreover, provided that M > 0, for an accommodative shock dr  0,

                                     dY  dY RA                  2-

    Proposition 6 is the analogue of Proposition 4 for monetary policy. The neutral case,
 = 2 - , applies in particular to the commonly-studied Cole and Obstfeld (1991) param-
eterization in which  =  =  = 1.32 This result generalizes the representative-agent
result in Itskhoki (2020) to heterogeneous-agent models, and the closed economy result
of Werning (2015) to the open economy.
    To understand this result, it is helpful to consider the effects of monetary policy on
the trade balance. Suppose that consumption changes as in the RA model: the Backus-
Smith condition then implies that dCt = dQt . Then, equation (34) implies that dNXt =
1- (  - (2 -  )) dQt . Hence, at  = 2 - , expenditure switching offsets both the increase
  

in import prices and the higher import demand, and the economy behaves as if it were a
closed economy. Given this, we can apply Werning (2015)'s result for closed economies
to validate our guess that consumption behaves as if there was a representative agent.
    The top panels of figure 6 illustrate this neutrality result. We consider an accommoda-
tive interest rate shock that generates the same path for the real exchange rate as that con-
sidered in section 3. In the right panel, we show the output response in the HA model,
as well as its decomposition using equation (38). Compared to the RA model (left panel),
it shows a clearly negative real income effect, and a weaker interest rate effect. Both are
exactly offset by a positive multiplier effect from the increased production (not shown), so
that the output response is identical. In the bottom panels of figure 6, we consider what
happens when  = 0.5 instead. The interest rate and real income channels are unchanged
relative to  = 2 - , but after a few quarters, the muted expenditure switching channel
  32 In fact, in this special case, it is even possible to prove that proposition 6 holds for unanticipated non-
linear shocks. We can generalize our results further when  = 2 - , e.g. by allowing for arbitrary monetary
policy rules. See appendix B.9.

                                                      25
                                                        Figure 6: The effects of monetary policy

                                                                     (a) Neutral case:  = 2 - 
                                                    Output, complete markets RA                            Output, HA
                                          2.0                                               2.0
                                                                                                                    Total
                                                                                                                    Real income channel
                                          1.5                                               1.5                     Exp. switching channel
                                                                                                                    Interest rate channel
                       Percent of s.s.


                                          1.0                                               1.0



                                          0.5                                               0.5



                                          0.0                                               0.0



                                         -0.5                                           -0.5
                                                0   5     10      15      20      25              0   5   10      15       20      25
                                                               Quarters                                        Quarters



                                                               (b) Lower trade elasticity:  = 0.5
                                                    Output, complete markets RA                            Output, HA
                                          1.0                                               1.0
                                                                                                                    Total
                                          0.8                                               0.8                     Real income channel
                                                                                                                    Exp. switching channel
                                                                                                                    Interest rate channel
                                          0.6                                               0.6
                       Percent of s.s.




                                          0.4                                               0.4


                                          0.2                                               0.2


                                          0.0                                               0.0


                                         -0.2                                           -0.2


                                         -0.4                                           -0.4
                                                0   5     10      15      20      25              0   5   10      15       20      25
                                                               Quarters                                        Quarters



Note: impulse response to a shock to rt that has the same shape and magnitude as the it    shock in figure 1, but with opposite sign.
This leads to the same real exchange rate path as in the right panel of that figure. The decomposition follows equation (38).



no longer undoes their negative influence on output. Overall, the response of output is
below that of the RA model everywhere, consistent with proposition 6.


4.2      Stealing demand from the future through current account deficits
An intriguing aspect of the bottom right panel of figure 6 is that the output response
in the HA model turns negative after 9 quarters. In other words, monetary stimulus
successfully raises aggregate demand for a few quarters, but at the cost of lowering it
afterward. It "steals" demand from the future.
    What explains this pattern? As discussed above, when  < 2 - , monetary stimulus
generates a current account deficit: agents borrow from abroad, both to finance higher
spending today, spurred by the low rates, and to smooth the real income losses from


                                                                                       26
higher import prices. These current account deficits accumulate into a negative net for-
eign asset position over time, which remains even after the interest rate and exchange rate
have converged most of the way back to steady state. To rebalance the current account,
agents cut back on spending, causing a downturn in aggregate demand.
   The following proposition derives a simple expression for the present value of the
consumption adjustment needed to close a given net foreign asset position dnfat .

Proposition 7. If the real exchange rate is at steady state from date t + 1 onward (dQt+s = 0 for
s  1), the date-t present value of consumption and output is given by

                                                             
                                            1                                            1-
                 (1 + rss )   -s
                                   dCt+s   = dnfat
                                                            (1 + rss )-s dYt+s =          
                                                                                            dnfat
               s =1                                        s =1

    Intuitively, in present value terms, any negative net foreign asset position will even-
tually be repaid. If there is no depreciation, this must involve a recession. Proposition
7 shows that the more closed the economy (the smaller ), the larger the reduction of
spending and output required for repayment, since most of the reduced spending falls on
home goods, which does not contribute to the international adjustment.33
    Our "stealing demand from the future" effect is a close cousin to the "limited ammu-
nition" effect in closed-economy models that has been recently described by McKay and
Wieland (2019), Caballero and Simsek (2020) and Mian, Straub and Sufi (2020). There is
one crucial difference, however. In our open economy setting, the effect of monetary pol-
icy can be so weak that the present value of the output response to monetary stimulus,
PV (dY), is negative. Appendix B.6 shows that this happens in our model when  < 1 - .


5      Quantitative model
We have shown that the extent to which heterogeneity matters for the effects of exchange
rates or monetary policy depends on the level of the trade elasticity . We derived these
results under the standard assumption of static CES demand, for which  is a constant
structural parameter. Yet a host of empirical evidence suggests that the response of the
trade balance to exchange rate shocks takes time to play out and depends on the nature
of the shock, notably on agents' expectations of its persistence (e.g. Ruhl 2008, Fitzgerald
and Haller 2018). For transitory shocks to exchange rates, the elasticity can be close to 0
in the short run (e.g. Hooper, Johnson and Marquez 2000); for more permanent shocks,
    33 See Krugman (1987) for an earlier articulation of this point.   Of course, a less open economy is less likely
to accumulate a large negative NFA in the first place.


                                                        27
such as tariff changes, it can be 4 or more in the long run (e.g. Caliendo and Parro 2015).
Any plausible quantification exercise needs to confront this evidence.
    In this section, we develop a quantitative version of the benchmark model studied so
far. To this benchmark, we add a stylized model of delayed substitution, which exhibits
shock-dependent and time-varying elasticities of imports and exports to movements in
relative prices (a " J curve"). The model's aggregate dynamics are similar to those of
the richer models in Ruhl (2008), Drozd and Nosal (2012) and Alessandria and Choi
(2019), but it abstracts away from the behavior of firms and focuses directly on that of
of households. In doing so, it captures the essence of these theories in reduced form, and
is straightforward to integrate into broader general equilibrium environments, such as
that of our heterogeneous-agent model.34
    In addition to delayed substitution, our quantitative model allows for price rigidities
on top of wage rigidity (and hence intermediate degrees of exchange rate pass-through),
non-homotheticities in consumption, currency mismatch in balance sheets, and a stan-
dard Taylor rule for monetary policy.


5.1    Additional model elements
We next introduce our new model elements.
    Non-homothetic preferences. Cravino and Levchenko (2017) document that, in Mexico,
households at the bottom of the income distribution consume a larger share of imported
goods than households at the top, implying that they experience larger declines in real
income during a depreciation.35 Since poor households typically have higher MPCs, ac-
counting for this fact could magnify the importance of the real income channel. To allow
for this possibility, we follow Carroll and Hur (2020) and Fanelli and Straub (2020) and
assume agents consume a Stone-Geary CES bundle, with a positive subsistence need c for
imported tradables,36

                                                                    (  -1) /   / (  -1)
                     c = 1/ (c F - c)( -1)/ + (1 - )1/ c H                                             (39)

    Monetary policy. Galí and Monacelli (2005) show that, in their framework, optimal
  34 See  Arkolakis, Eaton and Kortum (2012) and Drozd, Kolbin and Nosal (2021) for alternative reduced-
form models that share the same objective.
   35 The importance of this phenomenon in other countries is subject to an empirical debate. Borusyak and

Jaravel (2018) argue that the share of imports in consumption baskets is flat across the income distribution
in the United States. Bems and di Giovanni (2016) argue that the fall in aggregate income during the 2008
crisis in Latvia caused consumers to shift towards lower-quality, domestically produced goods.
   36 Appendix C.1 describes how to modify our solution method to incorporate this form of non-homothetic

demand.

                                                    28
policy targets producer-price-index (PPI) based inflation. We replace the constant­r mon-
etary rule in the previous sections by the PPI inflation based Taylor rule (20).
   Sticky prices and imperfect exchange rate pass-through. We allow for price stickiness in
domestic prices, modeled a la Calvo with a price stickiness coefficient of  H . This leads to
a Phillips curve for inflation in domestic prices PHt of

                                          Wt          1
                         Ht =  H     µ          -1 +     Et [  H ,t +1 ]                     (40)
                                         Zt PHt      1+r

                              1
with  H = (1 -  H ) 1 - 1+      r  H / H .
    We also allow for imperfect pass-through of the exchange rate into import and export
prices. To model imperfect pass-through to import prices, we assume that foreign ex-
porters produce differentiated goods a flat cost of Et per unit and sell them domestically
at a sticky price PFt . The elasticity of substitution between these varieties is µ F / (µ F - 1).
This formulation leads to a Phillips curve for imported goods PFt of

                                          Et        1
                           Ft =  F µ F        -1 +     Et [  F ,t +1 ]                       (41)
                                          PFt      1+r

                           1
with  F = (1 -  F ) 1 - 1+   r  F /  F . We make the same assumption for home exporters
                                                                                 of home
to model imperfect pass-through to export prices. Then, inflation in the price PH ,t
goods that foreigners see, expressed in their currency, is

                                           PHt         1
                      Ht =  H       µ H          -1 +     Et  H ,t +1                        (42)
                                          Et PHt      1+r

                             1
with  H  = (1 -  H  ) 1 - 1+   r H
                                    /  H  . Domestic equity earns the dividends of both

home producers and home exporters.
   Delayed substitution. We introduce delayed substitution by modifying the household
problem. Instead of being able to flexibly adjust their relative consumption of different
countries' goods in each period, we now assume that households can only do so with
a certain probability 1 -  . With probability  , they are forced to keep the ratio of each
country's good to total consumption constant, although they can still adjust overall ex-
penditure.
   We obtain general results for this delayed substitution model in appendix C.2. In our
problem, this model generates first-order dynamics for the target ratios x         ^
                                                                          ^ Ht and x Ht , for
households who can adjust, of domestic and foreign home good consumption to overall



                                                29
consumption:37

                                                  PHt
                            ^ Ht = -(1 -  ) d log
                      d log x                                  ^ Ht+1
                                                      +  d log x                                   (43)
                                                   Pt
                                                  P
                            ^
                      d log x Ht   = -(1 -  )d log Ht +  d log x
                                                               ^ Ht+1                              (44)
                                                   Et

This is similar to a Calvo model of pricesetting, but here, consumers reset their consump-
tion bundles based on their perceptions of current and future relative prices. The aggregate
ratios CHt /Ct and CHt /C  , in turn, evolve sluggishly as only a fraction 1 -  adjusts each

period, with dynamics described by

                              CHt                               C
                         d log                    ^ Ht +  d log Ht-1
                                   = (1 -  )d log x                                                (45)
                               Ct                                Ct-1
                                                                 
                                                  ^ Ht +  d log CHt
                         d log CHt = (1 -  )d log x                 -1                             (46)

This delivers a model in which the trade elasticity is both shock- and time-dependent.
For instance, for foreign consumption CHt   of the home good, the long-run elasticity to a

permanent shock is simply . By constrast, the short-run elasticity to the same permanent
shock is lower, at  (1 -  ), since it takes time for consumers to adjust. Finally, the short-
run elasticity to a one-time shock is even lower, at  (1 -  ) (1 -  ), since even those who
change their bundles choose to adjust little, as they anticipate wanting to adjust back in
the other direction after the shock has passed.


5.2    Calibration
Aggregate calibration. We calibrate the model at a quarterly frequency. Our aggregate
calibration is standard. Our goal is to capture the essential features of a typical Latin
American economy such as Mexico. Table 1 summarizes this calibration. We assume dis-
count factor heterogeneity, a standard feature in the literature to deliver a realistic level
of average MPCs with a non-trivial amount of aggregate wealth. We opt for permanent
heterogeneity, with a three point distribution at  -                
                                                           2 , ,  + 2   and a third of agents
in each. We set  to achieve an annualized real interest rate of r = 4% in steady state. We
set the initial steady state net foreign asset position to 0, with all mutual fund assets in-
vested in domestic stocks, to avoid interactions between exchange rates and pre-existing
trade deficits. We consider standard values of  = 1 for the elasticity of intertemporal
  37 For
       the heterogeneous domestic households, the simple form of (43) and (45) requires our assumption
that  = 1. Otherwise, as shown in appendix C.2, there is a more complex expression for the target ratio,
which can vary between heterogeneous households.


                                                  30
Parameter     Benchmark model           Quantitative model         Parameter       Benchmark model           Quantitative model

                         1                         1                     µ                  1.03                      1.028
                         2                         2                 s.s. nfa                 0                         0
                  {0.1,0.5,1,2-}
                        2-                         4                   e                     0.6                       0.6
                       =                          =                    e                    0.92                      0.92
                       n.a.                      0.987                 w                    0.95                      0.95
                      0.954                      0.947                 H                      0                       0.66
                      0.06                       0.067                  H                     0                       0.66
                       0.4                       0.323                 F                      0                         0
    c                   0                        0.114                                      n.a.                       1.5

                                             Moment                   Data         Benchmark model           Quantitative Model
                                     Average annual MPC               0.632             0.636                      0.637
                                        Std of annual MPC             0.152             0.151                      0.149
                                    Average tradable share            0.400             0.400                      0.400
                                      Std of tradable share           0.042              n.a.                      0.042

 Notes: all parameters are for the quarterly calibration, but MPCs are annual. Average and standard deviations are computed across
 deciles of income.  heterogeneity is discretized with 3 points, and  is the spread between the highest and the lowest . The income
 process is discretized with 7 points.

                                                    Table 1: Calibration


 substitution, and -1 = 0.5 for the Frisch elasticity of labor supply. For the elasticity of
 substitution across goods, we proceed as follows. Since there is limited evidence that this
 elasticity is different for imported vs domestic goods relative to between imported goods,
 we set  =  . This implies that  = (2 - ) . In our benchmark model, we considered a
 range of values for . By contrast, our quantitative model relies on delayed substitution,
 which we calibrate below.
     MPCs. To calibrate the aggregate consumption behavior of the model, and in the ab-
 sence of good disaggregated MPC evidence from Mexico, we target moments of the Peru-
 vian MPC data from Hong (2020). Hong (2020) reports an estimated MPC at each decile
 of the income distribution in Peru. Table 1 reports the average and the standard deviation
 of MPCs from his estimation exercise. We assume an AR(1) process for log income, with
 a persistence of e = 0.92 and a cross-sectional standard deviation of logs of e = 0.60,
 reflecting typical estimates.38 We set the borrowing constraint to a = 0. We adjust the
 markup µ, which mostly affects the level of steady-state liquidity in the model, so as to
 target the average (annual) MPC, and set the discount factor spread  to target the stan-
 dard deviation of MPCs across income deciles. This delivers µ = 1.03, so an average
   38 Sinceour quantitative model has subsistence needs, we make sure that our discretization procedure
 respects the constraint that the agent at the lowest level of income can always afford the subsistence level
 of consumption.


                                                                31
                                                                   Figure 7: Calibration targets and outcomes

                                                                            MPC                                                                  Import share
                                                    1.0                                                             0.55
                                                                                                                                                             Benchmark model
                                                    0.9                                                                                                      Quantitative model
                                                                                                                    0.50                                     Data
                                                    0.8

                                                    0.7
                                                                                                                    0.45




                                                                                                     Import share
                              MPC



                                                    0.6

                                                                                                                    0.40
                                                    0.5

                                                    0.4
                                                                                                                    0.35
                                                    0.3

                                                    0.2                                                             0.30
                                                          2          4           6       8     10                                 2          4           6         8           10
                                                                         Income decile                                                           Income decile

                                                              Share of aggregate consumption                                           Import share against MPC
                                                   0.35                                                             0.55
                                                                                                                                   Quantitative model
                                                   0.30                                                                            Data
                                                                                                                    0.50
                  Share of aggregate consumption




                                                   0.25

                                                                                                                    0.45
                                                                                                     Import share
                                                   0.20


                                                   0.15
                                                                                                                    0.40

                                                   0.10
                                                                                                                    0.35
                                                   0.05


                                                   0.00                                                             0.30
                                                          2          4           6       8     10                          0.2   0.3   0.4   0.5      0.6   0.7   0.8    0.9      1.0
                                                                         Income decile                                                               MPC


Note: calibration of the benchmark model from section 2 and of the quantitative model from section 5. The benchmark model tar-
gets the average and standard deviation of MPC across income deciles and the average consumption share of foreign goods. The
quantitative model also targets the standard deviation of consumption share of foreign good across income deciles.



wealth to GDP ratio of 73%.39
    Foreign good shares. To calibrate the spending behavior of households across goods,
we target moments of the Mexican spending survey reported in Cravino and Levchenko
(2017), and summarized in Figure 7. From their data, we obtain the average tradable
share at each income decile, as well as that decile's share of aggregate consumption. We
then assume that the share of imports within tradables is the same across the income
distribution, and compute income-specific import shares so that the economy-wide share
lines up with the Mexican import/GDP ratio of 40%, as reported in appendix table A.1.40
In the benchmark model, we set  = 0.4, while in the quantitative model we adjust , the
asymptotic import share, and c, the subsistence level on the imported good, to target an
  39 Thiscompares to a Mexican wealth-GDP ratio of 350% in 2018. Our estimate is smaller and best under-
stood as capturing liquid wealth. We decided not to target aggregate wealth to GDP in order to hit realistic
MPCs, whose importance is emphasized by our theoretical results.
  40 Appendix D.1 spells out a formal model with nontradables, domestically produced tradables and im-

ported tradables, and shows that it is equivalent to our model provided that  is calibrated to the im-
port/GDP ratio.


                                                                                                    32
average import share of 0.4 together with the standard deviation of import shares across
income groups from Figure 7.
    Figure 7 compares the calibration of our household model against the data by income
decile. Overall our model does a very good job at capturing both the MPC variation and
the import share variation across the income distribution. In particular, the spending
share on imported goods is strongly declining in income, as emphasized by Cravino and
Levchenko (2017).
    Phillips curve parameters. Appendix C.3 provides details on our calibration of Phillips
curve parameters. Among the price rigidity parameters, the Calvo coefficient for import
prices  F is the most important as it directly affects the magnitude of the real income
effect. We calibrate  F using evidence from the 1994 Mexican devaluation as reported
by Burstein and Gopinath (2015). For this particular devaluation, we find perfect pass-
through to import prices, so  F = 0.41 By contrast, given the widespread evidence in Boz
et al. (2020) for dollar pricing of exports in Latin American countries, we set  H  > 0. We
assume that the degree of price rigidity in dollar prices, like the price rigidity of domestic
goods prices, corresponds to an average price reset frequency of 9 months, as is standard
in the literature. This leads us to set  H =  H  = 0.66. We then find the wage stickiness
parameter that is able to simultaneously replicate the path of home good prices after the
Mexican devaluation and keep dividends reasonably acyclical in response to exchange
rate shocks (see figure A.2). We set the Taylor rule coefficient on PPI inflation to  = 1.5.
    Delayed substitution model. We assume that our delayed substitution model applies
equally to domestic and foreign households, with the same parameter  . We calibrate
the model to the evidence in Boehm, Levchenko and Pandalai-Nayar (2020) (henceforth,
BLP). BLP identify plausibly exogenous changes in tariffs and trace out the entire dynamic
response of trade flows. To be precise, BLP observe how a country A's exports within an
industry to a specific importing country B respond to a persistent increase in tariffs levied
by B on imports from A. This elasticity captures , the elasticity of export demand by the
rest of the world. Figure 8 plots the evidence from their estimates. The left panel shows
the changes in tariffs. The right panel shows the response of trade flows.
    We replicate this experiment in our model as follows. We begin by setting the long-run
 to 4, since this is a consensus estimate for the long-term trade elasticity (e.g. Caliendo
and Parro 2015). We then interpret the tariff change in the BLP data as a change in the
relative price d log PEt , which we assume follows an AR(1) with persistence . We choose
                       Ht


 to minimize the sum of squared distances to the tariff response in the left panel in
figure 8, finding  = 0.989 quarterly. We then feed this process into (44) and (46) and
 41 We   recalibrate to evidence from other countries in appendix C.3.


                                                     33
                    Figure 8: Calibrating delayed substitution in the quantitative model

                                                   Price of foreign goods                          Demand for foreign goods
                                         1.6
                                                                            Data                                        Data
                                                                                         0.5
                                         1.4                                AR(1)                                       Fitted model

                                         1.2
                                                                                         0.0
                                         1.0
                       Percent of s.s.

                                         0.8
                                                                                     -0.5
                                         0.6

                                         0.4                                         -1.0

                                         0.2

                                                                                     -1.5
                                         0.0

                                               0   10       20         30       40             0    10       20         30         40
                                                          Quarters                                         Quarters


Note: calibration of delayed substitution in the quantitative model. We fit an AR(1) to the change in tariffs from Boehm, Levchenko and
Pandalai-Nayar (2020) and estimate  to minimize the sum of squared residuals between the model response and the data response of
the demand for foreign goods.



calibrate  to minimize the sum of squared distances to the estimates displayed in the
right panel in figure 8. This delivers  = 0.987 quarterly. Finally, we also set  = .


5.3      Revisiting contractionary depreciations
We use our quantitative model to revisit the effect of exogenous depreciation shocks.
Proposition 5 showed that, in the benchmark model, these shocks generate output con-
tractions when the trade elasticity  is small enough. Figure 9 shows that in our quantita-
tive model (green line), depreciations are also contractionary, in spite of an active Taylor
rule and a high long-run trade elasticity. This is because, in the short run, the quantitative
model behaves similarly to a model with a real rate rule and a low static trade elasticity
(red line). As delayed substitution kicks in, however, the quantitative model delivers a
better recovery in the long term.42


5.4      Managing contractionary depreciations
Our analysis shows that depreciations can be contractionary because of a real income
channel. We now discuss how monetary policy should respond if its goal is to stabilize
output. The question is non-trivial, due to the following dilemma: should monetary
policy hike interest rates to fight the depreciation, which is the root cause of the recession?
Or should it stimulate by cutting interest rates, as is traditional to fight a recession? To
illustrate this tradeoff, we first consider two simple policies.
  42 See the gap between the blue line (with delayed substitution) and the red line (without delayed substi-
tution, but with a very low trade elasticity at all dates), which grows over time.


                                                                                    34
                                                                            Figure 9: Contractionary depreciations

                                    Output                                       Consumption                                              Net exports                                           NFA
                   0.3
                                    Taylor rule                       0.0
                                                                                                                             0.0                                              0.0
                   0.2              Real rate rule
                                                                    -0.1
                   0.1              Real rate rule +  = 0.1                                                                                                                  -0.2
                                                                                                                    -0.1
 Percent of Yss




                                                                    -0.2
                   0.0
                                                                                                                                                                             -0.4
                                                                                                                    -0.2
                  -0.1                                              -0.3
                                                                                                                                                                             -0.6
                  -0.2                                              -0.4                                            -0.3

                  -0.3                                                                                                                                                       -0.8
                                                                    -0.5
                                                                                                                    -0.4
                  -0.4
                         0     10              20             30            0    10              20   30                           0     10              20   30                    0     10              20   30

                             Real wage income                                     Dividends                                            Real exchange rate                               Real interest rate
                                                                    0.002
                                                                                                                             1.0                                             0.04
                   0.0
                                                                    0.000
                                                                                                                             0.8
                  -0.2                                                                                                                                                       0.03




                                                                                                           Percent of s.s.
 Percent of Yss




                                                                   -0.002
                                                                                                                             0.6




                                                                                                                                                                   Percent
                  -0.4                                             -0.004                                                                                                    0.02
                                                                                                                             0.4

                  -0.6                                             -0.006                                                                                                    0.01
                                                                                                                             0.2
                                                                   -0.008
                  -0.8                                                                                                       0.0                                             0.00
                         0     10              20             30            0    10              20   30                           0     10              20   30                    0     10              20   30
                                    Quarters                                          Quarters                                                Quarters                                         Quarters


Note: impulse response in the quantitative model to the shock to it  displayed in Figure 1. The model with Taylor rule is our quanti-
tative model; the one with real rate rule is our quantitative model without the Taylor rule; the model with real rate and  = 0.1 drops
delayed substitution and allows households to immediately adjust their consumption baskets across countries.



    Panel (a) of figure 10 shows what happens when the central bank stabilizes the ex-
change rate. This policy leads to an even worse recession in the short run, but it helps
improve output further out. The intuition for this finding is that hiking rates replaces one
evil (contractionary depreciation) with another (contractionary monetary policy), as high-
lighted by Gourinchas (2018) and Kalemli-Özcan (2019). For our baseline calibration, the
additional contraction is short lived. The contraction is greater for less open economies.
    Panel (b) of figure 10 illustrates what happens if monetary policy instead stabilizes
output for four quarters. As can be seen, this is achieved with aggressive monetary eas-
ing. However, lower interest rates depreciate the exchange rate by even more. This wors-
ens the real income channel, deteriorating the current account even further, and leading
to an even greater recession after the four quarters of output stabilization.
    These two scenarios suggest that the policy that fully stabilizes output in all periods
is complex. The dashed blue line of panel (c) displays it.43 Here, monetary policy does
not change interest rates much initially, and instead promises to hike them later on. By
relying on forward guidance in this way, monetary policy not only manages to fight the
depreciation: it even appreciates the exchange rate. Meanwhile, because interest rate
hikes come in the future, the appreciation does not come at the cost of an immediate
  43 This is the unique output-stabilizing policy, which is simple to obtain with our methods by setting the

path of the real interest rate as an additional unknown, and the stable output path as an additional target.
Optimal policy would be very interesting to study, but is still out of reach at present.



                                                                                                      35
                                               Figure 10: Policies to deal with contractionary depreciations

                                                                                                       (a) Fighting the depreciation
                           Real rate r and foreign interest rates i                                                      Real exchange rate Q                                               Output Y
                                                     Initial shock to i                            1.0                     Initial path of Q                    0.2                    Initial path of Y
            0.14                                     Monetary response r                                                   Path of Q with monetary response                            Path of Y with monetary response
                                                                                                                                                                0.1
            0.12                                                                                   0.8
                                                                                                                                                                0.0
            0.10
                                                                                                                                                               -0.1




                                                                                 Percent of Yss
                                                                                                   0.6
  Percent




            0.08                                                                                                                                               -0.2

            0.06                                                                                   0.4                                                         -0.3

            0.04                                                                                                                                               -0.4
                                                                                                   0.2
            0.02                                                                                                                                               -0.5

            0.00                                                                                   0.0                                                         -0.6

                   0           5       10       15        20       25                                    0       5         10       15      20       25                0       5       10      15        20        25
                                             Quarters                                                                            Quarters                                                   Quarters



                                                                                                             (b) Fighting the recession
                           Real rate r and foreign interest rates i                                                      Real exchange rate Q                                               Output Y
             1.0                                                                                       4.0
                                                     Initial shock to i                                                    Initial path of Q                     0.4                   Initial path of Y
                                                     Monetary response r                               3.5                 Path of Q with monetary response                            Path of Y with monetary response
             0.5
                                                                                                       3.0                                                       0.2
             0.0
                                                                                                       2.5                                                       0.0
                                                                              Percent of Yss




            -0.5                                                                                       2.0
  Percent




                                                                                                                                                                -0.2

            -1.0                                                                                       1.5
                                                                                                                                                                -0.4
                                                                                                       1.0
            -1.5                                                                                                                                                -0.6
                                                                                                       0.5
            -2.0                                                                                                                                                -0.8
                                                                                                       0.0

            -2.5                                                                                  -0.5                                                          -1.0
                   0           5       10       15        20       25                                        0    5        10       15      20       25                    0       5   10       15        20        25
                                             Quarters                                                                            Quarters                                                    Quarters



      (c) Fully stabilizing output: full import pass-through (baseline  F = 0) vs limited pass-through ( F = 0.7)
                            Real rate r and foreign interest rates i                                                     Real exchange rate Q                                               Output Y
                                                                                                                                                                 0.2
             0.15                            Initial shock to i                                                             Initial path of Q                                                  Initial path of Y
                                                                                                         3
                                             Monetary response r                                                            Path with MP response                                              Initial path of Y ( F = 0.7)
                                             Monetary response r ( F = 0.7)                                                 Path with MP response ( F = 0.7)     0.1
                                                                                                                                                                                               Path with MP response
             0.10
                                                                                                         2
                                                                                                                                                                 0.0
             0.05
                                                                                      Percent of Yss
  Percent




                                                                                                         1
                                                                                                                                                               -0.1
             0.00

                                                                                                         0                                                     -0.2
            -0.05

                                                                                                                                                               -0.3
            -0.10                                                                                      -1

                                                                                                                                                               -0.4
                       0           5    10       15        20       25                                       0       5      10      15       20      25                0       5       10       15        20        25
                                              Quarters                                                                           Quarters                                                    Quarters



Note: impulse responses to the shock to it  displayed in Figure 1 with and without monetary policy. In panel (a), the green line shows
the impulse without monetary policy response. The blue dotted lines show the impulse when monetary policy stabilizes the real
exchange rate. In panel (b), the blue dotted lines show the impulse when monetary policy stabilizes output for 4 quarters. In panel (c),
the blue dotted lines show the impulse when monetary policy stabilizes output permanently in our quantitative economy with full
import pass-through. The orange dotted lines show the impulse when monetary policy stabilizes output permanent for an economy
with limited import pass-through.



                                                                                                                           36
recession, and interest rates increase later on when the economy, having built a positive
net foreign asset position, is in a better situation to weather them.
    The dashed yellow line of panel (c) shows the output-stabilizing policy in an economy
with less import price pass-through. In this case, interest rates are cut for an extended pe-
riod of time. The reason here is that, with less import price pass-through, the economy is
more insulated from the real income channel--the recession at constant policy is smaller,
as the solid red line shows--so the cost in terms of a depreciation of the exchange rate is
smaller, and the benefits of monetary accommodation dominate. This starkly contrasting
behavior of monetary policy with high and low import price pass-through may rational-
ize why, in response to hikes in foreign interest rates, emerging markets tend to hike even
more, while advanced economies hike by less or even ease (e.g. Kalemli-Özcan 2019).


5.5   When does the real income channel matter?
Table 2 explores the role of economy-wide characteristics more systematically. For each
column, we vary a single parameter in the model, and we report both the on impact re-
sponse of output and its two-year cumulative response. The first column, labeled "Base-
line", corresponds to our quantitative model, as displayed in the green line of Figure 9.
    The second column shows that lower openness reduces the impact effect of an ex-
change rate shock on output. This is natural, as both the real income channel and the
expenditure switching channel of exchange rates scale with . Notably, however, the
two-year cumulative change is reduced by less: this is because the multiplier channel is
larger at lower , as any given change in aggregate consumption has a stronger effect on
domestic output in a more closed economy.
    Next, we vary the steady state level of markups µ to generate a higher MPC. This
amplifies the real income and multiplier channels, leading depreciations to be more con-
tractionary. DCP, as in section 3.4, slightly softens the contraction, as do homothetic pref-
erences and a higher short-term substitution elasticity. Less exchange rate pass-through
into import prices significantly reduces the strength of the real income channel. Since
it also dampens domestic expenditure switching, the output response is mostly scaled
down, rather than flipping sign.
    These patterns suggest that different countries are likely to respond differently to ex-
change rate depreciations. In appendix C.3, we calibrate the model to seven countries
that have experienced depreciation episodes. We find that the degree of inferred import
price pass-through is the most important cross-country determinant of the magnitude of
the contraction after a depreciation.


                                             37
               Baseline      Low         High MPC         Full DCP       Homothetic         High ST           F = 0.7      F = 0.9

    dY0          - 0.35       - 0.26        - 0.39           - 0.31           - 0.32           - 0.30         - 0.09        - 0.02

 7
 t=0 dYt         - 1.81       - 1.48        - 1.85           - 1.53           - 1.54           - 1.14         - 0.95        - 0.22
Note: change on impact and 2-year cumulated impulse response of output to the shock to it       displayed in Figure 1 for various para-
metric assumptions. The baseline corresponds to our quantitative model. For low alpha we target a share of tradable of 20% instead
of 40%; for high MPC we target an average annual MPC of 80% instead of 63%; for full DCP we assume no pass-through of exchange
rate into export prices ( H  = 0.99) instead of an intermediate pass-through ( H  = 0.66); for homothetic we target a constant tradable
share across the income distribution; for high short-term elasticity we target an elasticity of substitution between home and foreign
goods of 1 after 1 year, relative to 0.3 in our baseline.

                     Table 2: Effects of exchange rate shock under various assumptions


5.6       Comparison with balance sheet effects
A well-documented feature of international investment positions is that the net foreign
asset position consists of the difference between gross assets and gross liabilities that are
both very large, and often differ in terms of their risk profile and currency composition
(e.g. Gourinchas and Rey 2007, Lane and Shambaugh 2010). While we cannot easily
capture the risk dimension, we can accommodate currency mismatch in the net foreign
asset position.
    We relax the assumption that the domestic mutual fund holds 100% of its assets in
domestic stocks, and that the government has no gross assets or liabilities. Instead, we
assume that one of these has initially borrowed in foreign currency to invest in domestic
stocks, while keeping their net position unchanged. Throughout, we assume that gross
foreign currency liabilities are 50% of GDP and have an average duration of 18 quar-
ters. Appendix C.4 provides details and shows that this calibration provides an upper
bound on the magnitude of valuation effects: data from Bénétrix, Gautam, Juvenal and
Schmitz (2020) show that few countries have historically had such large gross currency
mismatches in their external balance sheets, and that most countries have dramatically
reduced these gross mismatches in the past two decades.
    In Table 3 we report how our results for the output effect of the devaluation (repeated
in the first column) are altered in this scenario. We consider four cases. In the first, called
"mutual fund", the gross foreign currency debt is held by the same mutual fund that
holds all other financial positions. This brings down the output response by a further
0.06% on impact, and by 0.38% over 2 years. In other words, foreign currency debt causes
some amplification of the contractionary effect of the depreciation, but even in this cali-
bration to a very large net currency mismatch, this effect is small in comparison to the real
income effect. This is because exposed households, who own wealth through the mutual
fund, have low MPCs.


                                                                 38
                  Baseline      Mutual fund         Gov, lump-sum          Gov, proportional tax          Gov, deficit-finance

       dY0          - 0.35           - 0.41               - 0.70                     - 0.63                       - 0.53

    7
    t=0 dYt         - 1.81           - 2.19               - 2.58                     - 2.53                       - 2.53
Note: change on impact and 2-year cumulated impulse response of output to the shock to it   displayed in Figure 1 for different balance
sheet specifications. The baseline corresponds to our quantitative model. In the second column we assume that the mutual fund holds
the equivalent of 50% of annual GDP in debt denominated in foreign currency; for government with lump-sum transfers we assume
that the government owes foreign currency debt and owns local currency assets, and adjusts following the depreciation using lump
sum taxes to balance budget period by period; for government with proportional taxes we assume that taxes are proportional to labor
income; for government deficit financed we assume that the government does not balance budget period by period but can run a
deficit. In all our specifications we assume that debt takes the form of long-term bonds with average duration of 18 quarters.

                   Table 3: Balance sheet effects under various distribution assumptions


    In the next three columns, we consider what happens if instead the foreign currency
exposure is held on the government balance sheet, and then rebated to households ac-
cording to various tax schemes. The first two columns report the effect of immediately
taxing households lump sum or proportionally, while the third reports the effect of deficit-
financing and taxing later with a proportional tax. The amplification is largest with an
immediate lump-sum tax, which is most regressive. This echoes the findings in de Ferra,
Mitman and Romei (2020) and Zhou (2020), who show that that valuation effects are espe-
cially powerful at reducing output when they are concentrated on high-MPC households.
Even in the most extreme case, however, the balance sheet effect is no greater than the real
income effect on impact, and cumulatively over 2 years it is much smaller: an additional
decline of 0.77%, compared with 1.81% in our main model.


5.7      Endogenous UIP deviations
We finally consider an extension with endogenous UIP deviations, as in Gabaix and Mag-
giori (2015) and Itskhoki and Mukhin (2020). In this extension, which we spell out in
appendix A.2, we assume that the mutual fund cannot directly access foreign asset mar-
kets. Instead, foreign financial intermediaries trade in both domestic and foreign bond
markets, with an imperfectly elastic demand for domestic bonds. This gives the standard
condition
                                        Et           
                            (1 + i t )        = 1 + it -  · nfat
                                       E t +1
which, compared to the UIP (13), includes a UIP deviation term  · nfat . The deviation
captures the idea that when the country borrows from the rest of the world, nfat < 0, it is
required to pay a greater interest rate it .
   Figure 11 simulates an it  shock in this extension. As before, the shock depreciates

the exchange rate and leads to increased domestic interest rates it . As the NFA declines

                                                                   39
                                             Figure 11: Depreciations with endogenous UIP deviations

                                   Real exchange rate                                          Output                                         NFA
                                                                                                                          0.1
                                          UIP
                                                                           0.0
                                          Endogenous UIP deviation
                   0.8                                                                                                    0.0

                                                                          -0.1                                           -0.1
                   0.6
 Percent of s.s.




                                                                          -0.2                                           -0.2
                   0.4
                                                                                                                         -0.3
                                                                          -0.3
                   0.2                                                                                                   -0.4

                                                                          -0.4
                                                                                                                         -0.5
                   0.0
                                                                          -0.5                                           -0.6
                         0     5   10     15       20     25         30          0   5   10      15       20   25   30          0   5   10     15       20   25   30
                                        Quarters                                               Quarters                                      Quarters

                                         displayed in Figure 1. The green line shows the impulse in the quantitative model (UIP)
Note: impulse response to the shock to it
while the blue dotted line shows the impulse in the model with endogenous UIP deviations.



due to greater import prices, however, foreign intermediaries require even higher domes-
tic interest rates it , captured by a more positive UIP deviation -nfat . This amplifies
the exchange rate depreciation and ultimately worsens the contractionary effects of the
depreciation. Thus, endogenous UIP deviations amplify contractionary depreciations,
especially in countries with high . This presents another reason why interest rates may
be procyclical in open economies, especially in emerging markets prone to having greater
UIP deviations (higher ).


6                            Conclusion
We introduce heterogeneous households in a New Keynesian model of a small open econ-
omy. Our model matches both the size and heterogeneity of MPCs observed in the data.
We show that this new feature is critical to understand the effects of capital flows and
monetary policy. When depreciations pass through quickly to consumer prices but it
takes time for consumers to substitute toward domestic varieties, depreciations become
contractionary. Monetary easing comes with the negative side effects of a depreciated
exchange rate; it leads to current account deficits, and depresses demand in the future.
Stabilization policy balances the costs of high interest rates against the costs of deprecia-
tion created by the real income channel.




                                                                                              40
References
Aghion, Philippe, Philippe Bacchetta, and Abhijit Banerjee, "A Corporate Balance-Sheet Ap-
  proach to Currency Crises," Journal of Economic Theory, November 2004, 119 (1), 6­30.

Alejandro, Carlos F. Díaz, "A Note on the Impact of Devaluation and the Redistributive Effect,"
  Journal of Political Economy, 1963, 71 (6), 577­580.

Alessandria, George A. and Horag Choi, "The Dynamics of the U.S. Trade Balance and Real
  Exchange Rate: The J Curve and Trade Costs?," Working Paper 25563, National Bureau of Eco-
  nomic Research, February 2019.

  , Costas Arkolakis, and Kim J. Ruhl, "Firm Dynamics and Trade," Working Paper 27934, Na-
  tional Bureau of Economic Research, October 2020.

Alvarez, Fernando, Andrew Atkeson, and Patrick J. Kehoe, "Time-Varying Risk, Interest Rates,
  and Exchange Rates in General Equilibrium," Review of Economic Studies, July 2009, 76 (3), 851­
  878.

Amiti, Mary, Oleg Itskhoki, and Jozef Konings, "Dominant Currencies: How Firms Choose
 Currency Invoicing and Why it Matters," Working Paper 27926, National Bureau of Economic
 Research, October 2020.

Arkolakis, Costas, Jonathan Eaton, and Samuel Kortum, "Staggered Adjustment and Trade Dy-
  namics," Manuscript, July 2012.

Auclert, Adrien, "Monetary Policy and the Redistribution Channel," American Economic Review,
 June 2019, 109 (6), 2333­2367.

  , Bence Bardóczy, and Matthew Rognlie, "MPCs, MPEs and Multipliers: A Trilemma for New
  Keynesian Models," Review of Economics and Statistics, 2021, Forthcoming.

  ,  ,   , and Ludwig Straub, "Using the Sequence-Space Jacobian to Solve and Estimate
  Heterogeneous-Agent Models," Econometrica, 2021, Forthcoming.

  , Matthew Rognlie, and Ludwig Straub, "The Intertemporal Keynesian Cross," Working Paper
  25020, National Bureau of Economic Research, September 2018.

  , , and , "Micro Jumps, Macro Humps: Monetary Policy and Business Cycles in an Esti-
  mated HANK Model," Working Paper 26647, National Bureau of Economic Research, January
  2020.

Auer, Raphael, Ariel Burstein, and Sarah M. Lein, "Exchange Rates and Prices: Evidence from
 the 2015 Swiss Franc Appreciation," American Economic Review, February 2021, 111 (2), 652­686.

  , , Katharina Erhardt, and Sarah M. Lein, "Exports and Invoicing: Evidence from the 2015
  Swiss Franc Appreciation," AEA Papers and Proceedings, May 2019, 109, 533­538.

Baldwin, Richard, "Hysteresis In Import Prices: The Beachhead Effect," American Economic Re-
  view, September 1988, 78 (4), 773­785.



                                               41
  and Paul Krugman, "Persistent Trade Effects of Large Exchange Rate Shocks," Quarterly Journal
  of Economics, November 1989, 104 (4), 635­654.

Barbiero, Omar, "The Valuation Effects of Trade," Manuscript, December 2020.

Baxter, Marianne and Mario J. Crucini, "Business Cycles and the Asset Structure of Foreign
  Trade," International Economic Review, 1995, 36 (4), 821­854.

Bems, Rudolfs and Julian di Giovanni, "Income-Induced Expenditure Switching," American Eco-
  nomic Review, December 2016, 106 (12), 3898­3931.

Bénétrix, Agustín S., Deepali Gautam, Luciana Juvenal, and Martin Schmitz, "Cross-Border
  Currency Exposures: New Evidence Based on an Enhanced and Updated Dataset," SSRN Schol-
  arly Paper No 3611655, Social Science Research Network, May 2020.

Bianchi, Javier and Guido Lorenzoni, "The Prudential Use of Capital Controls and Foreign Cur-
  rency Reserves," in "Handbook of International Economics," Vol. Forthcoming, 2021.

  and Louphou Coulibaly, "Liquidity Traps, Prudential Policies and International Spillovers,"
  Manuscipt, May 2021.

Bilbiie, Florin O., "Limited Asset Markets Participation, Monetary Policy and (inverted) Aggre-
  gate Demand Logic," Journal of Economic Theory, May 2008, 140 (1), 162­196.

  , "The New Keynesian Cross," Journal of Monetary Economics, October 2020, 114, 90­108.

Boehm, Christoph E., Andrei A. Levchenko, and Nitya Pandalai-Nayar, "The Long and Short
  (Run) of Trade Elasticities," Working Paper 27064, National Bureau of Economic Research, April
  2020.

Borusyak, Kirill and Xavier Jaravel, "The Distributional Effects of Trade: Theory and Evidence
  from the United States," SSRN Scholarly Paper No 3269579, Social Science Research Network
  October 2018.

Boz, Emine, Camila Casas, Georgios Georgiadis, Gita Gopinath, Helena Le Mezo, Arnaud
  Mehl, and Tra Nguyen, "Patterns in Invoicing Currency in Global Trade," Working Paper
  3670607, Social Science Research Network, July 2020.

Broer, Tobias, Niels-Jakob Harbo Hansen, Per Krusell, and Erik Öberg, "The New Keynesian
  Transmission Mechanism: A Heterogeneous-Agent Perspective," Review of Economic Studies,
  January 2020, 87 (1), 77­101.

Burstein, Ariel and Gita Gopinath, "Chapter 7 - International Prices and Exchange Rates," in El-
  hanan Helpman, Kenneth Rogoff, and Gita Gopinath, eds., Handbook of International Economics,
  Vol. 4, Elsevier, 2015, pp. 391­451.

  , Martin Eichenbaum, and Sergio Rebelo, "Large Devaluations and the Real Exchange Rate,"
  Journal of Political Economy, August 2005, 113 (4), 742­784.

Caballero, Ricardo J. and Alp Simsek, "A Model of Asset Price Spirals and Aggregate Demand
  Amplification of a 'COVID-19' shock," Working Paper 3576979, Social Science Research Net-
  work, 2020.

                                              42
Caliendo, Lorenzo and Fernando Parro, "Estimates of the Trade and Welfare Effects of NAFTA,"
  Review of Economic Studies, January 2015, 82 (1), 1­44.

Carroll, Daniel R. and Sewon Hur, "On the Heterogeneous Welfare Gains and Losses from
  Trade," Journal of Monetary Economics, January 2020, 109, 1­16.

Cavallo, Alberto, Gita Gopinath, Brent Neiman, and Jenny Tang, "Tariff Pass-Through at the
  Border and at the Store: Evidence from US Trade Policy," American Economic Review: Insights,
  March 2021, 3 (1), 19­34.

Céspedes, Luis Felipe, Roberto Chang, and Andrés Velasco, "Balance Sheets and Exchange Rate
  Policy," American Economic Review, 2004, 94 (4), 1183­1193.

Chari, V. V., Patrick J. Kehoe, and Ellen R. McGrattan, "Can Sticky Price Models Generate
  Volatile and Persistent Real Exchange Rates?," Review of Economic Studies, July 2002, 69 (3), 533­
  563.

Clarida, Richard H., "International Lending and Borrowing in a Stochastic, Stationary Equilib-
  rium," International Economic Review, August 1990, 31 (3), 543­558.

Clarida, Richard, Jordi Galí, and Mark Gertler, "A Simple Framework for International Mone-
  tary Policy Analysis," Journal of Monetary Economics, July 2002, 49 (5), 879­904.

Cole, Harold L. and Maurice Obstfeld, "Commodity Trade and International Risk Sharing: How
  Much Do Financial Markets Matter?," Journal of Monetary Economics, August 1991, 28 (1), 3­24.

Corsetti, Giancarlo and Paolo Pesenti, "Welfare and Macroeconomic Interdependence," Quarterly
  Journal of Economics, May 2001, 116 (2), 421­445.

  , Luca Dedola, and Sylvain Leduc, "International Risk Sharing and the Transmission of Pro-
  ductivity Shocks," Review of Economic Studies, April 2008, 75 (2), 443­473.

Cravino, Javier and Andrei A. Levchenko, "The Distributional Consequences of Large Devalua-
  tions," American Economic Review, November 2017, 107 (11), 3477­3509.

Cugat, Gabriela, "Emerging Markets, Household Heterogeneity, and Exchange Rate Policy,"
  Manuscript, October 2019.

de Ferra, Sergio, Kurt Mitman, and Federica Romei, "Household Heterogeneity and the Trans-
  mission of Foreign Shocks," Journal of International Economics, May 2020, 124, 1­18.

Doepke, Matthias and Martin Schneider, "Inflation and the Redistribution of Nominal Wealth,"
 Journal of Political Economy, December 2006, 114 (6), 1069­1097.

Drozd, Lukasz A and Jaromir B Nosal, "Understanding International Prices: Customers as Capi-
  tal," American Economic Review, February 2012, 102 (1), 364­395.

Drozd, Lukasz A., Sergey Kolbin, and Jaromir B. Nosal, "The Trade-Comovement Puzzle,"
  American Economic Journal: Macroeconomics, April 2021, 13 (2), 78­120.

Eichenbaum, Martin S., Benjamin K. Johannsen, and Sergio T. Rebelo, "Monetary Policy and
  the Predictability of Nominal Exchange Rates," Review of Economic Studies, January 2021, 88 (1),
  192­228.

                                                43
Fagereng, Andreas, Martin B. Holm, and Gisle J. Natvik, "MPC Heterogeneity and Household
  Balance Sheets," Manuscript, March 2020.

Fanelli, Sebastián and Ludwig Straub, "A Theory of Foreign Exchange Interventions," Working
  Paper 27872, National Bureau of Economic Research, September 2020.

Farhi, Emmanuel and Iván Werning, "Dilemma Not Trilemma? Capital Controls and Exchange
  Rates with Volatile Capital Flows," IMF Economic Review, November 2014, 62 (4), 569­605.

  and , "Chapter 31 - Fiscal Multipliers: Liquidity Traps and Currency Unions," in Harald
  Uhlig and John B. Taylor, eds., Handbook of Macroeconomics, Vol. 2, Elsevier, 2016, pp. 2417­2492.

   and    , "Fiscal Unions," American Economic Review, December 2017, 107 (12), 3788­3834.

  and , "Monetary Policy, Bounded Rationality, and Incomplete Markets," American Economic
  Review, November 2019, 109 (11), 3887­3928.

Feenstra, Robert C., Philip Luck, Maurice Obstfeld, and Katheryn N. Russ, "In Search of the
  Armington Elasticity," Review of Economics and Statistics, August 2017, 100 (1), 135­150.

Fitzgerald, Doireann and Stefanie Haller, "Exporters and Shocks," Journal of International Eco-
   nomics, July 2018, 113, 154­171.

Frankel, Jeffrey A., "Mundell-Fleming Lecture: Contractionary Currency Crashes in Developing
  Countries," IMF Staff Papers, April 2005, 52 (2), 149­192.

Gabaix, Xavier and Matteo Maggiori, "International Liquidity and Exchange Rate Dynamics,"
 Quarterly Journal of Economics, August 2015, 130 (3), 1369­1420.

Galí, Jordi, Monetary Policy, Inflation, and the Business Cycle: An Introduction to the New Keynesian
 Framework, Princeton University Press, February 2008.

   and Tommaso Monacelli, "Monetary Policy and Exchange Rate Volatility in a Small Open
  Economy," Review of Economic Studies, July 2005, 72 (3), 707­734.

  , J. David López-Salido, and Javier Vallés, "Understanding the Effects of Government Spend-
  ing on Consumption," Journal of the European Economic Association, 2007, 5 (1), 227­270.

Gertler, Mark, Simon Gilchrist, and Fabio M. Natalucci, "External Constraints on Monetary
 Policy and the Financial Accelerator," Journal of Money, Credit and Banking, 2007, 39 (2-3), 295­
 330.

Ghironi, Fabio, "Macroeconomic Interdependence Under Incomplete Markets," Journal of Inter-
 national Economics, December 2006, 70 (2), 428­450.

Giagheddu, Marta, "The Distributional Implications of Fiscal Devaluations," Working Paper
  3651258, Social Science Research Network, March 2020.

Gopinath, Gita, "The International Price System," Jackson Hole Symposium Proceedings, 2016.

  , Emine Boz, Camila Casas, Federico J. Díez, Pierre-Olivier Gourinchas, and Mikkel
  Plagborg-Møller, "Dominant Currency Paradigm," American Economic Review, March 2020, 110
  (3), 677­719.

                                                 44
Gourinchas, Pierre-Oliver, "Monetary Policy Transmission in Emerging Markets: An Application
 to Chile," Series on Central Banking Analysis and Economic Policies no. 25, 2018.

Gourinchas, Pierre-Olivier and Helene Rey, "From World Banker to World Venture Capitalist:
 U.S. External Adjustment and the Exorbitant Privilege," in "G7 Current Account Imbalances:
 Sustainability and Adjustment," University of Chicago Press, 2007, pp. 11­66.

Guo, Xing, Pablo Ottonello, and Diego Perez, "Monetary Policy and Redistribution in Open
 Economies," Working Paper 28213, National Bureau of Economic Research, March 2021.

Heathcote, Jonathan and Fabrizio Perri, "Financial Autarky and International Business Cycles,"
 Journal of Monetary Economics, 2002, 49 (3), 601­627.

Hong, Seungki, "MPCs and Liquidity Constraints in Emerging Economies," Manuscript, Septem-
 ber 2020.

Hooper, Peter, Karen H. Johnson, and Jaime R. Marquez, Trade elasticities for the G-7 countries
 number no. 87. In `Princeton Studies in International Economics.' 2000.

Ilzetzki, Ethan, Carmen M Reinhart, and Kenneth S Rogoff, "Exchange Arrangements Entering
   the Twenty-First Century: Which Anchor will Hold?," Quarterly Journal of Economics, May 2019,
   134 (2), 599­646.

Itskhoki, Oleg, "The Story of the Real Exchange Rate," Annual Review of Economics, December
   2020, forthcoming.

   and Dmitry Mukhin, "Exchange Rate Disconnect in General Equilibrium," Manuscript,
  November 2020.

Jappelli, Tullio and Luigi Pistaferri, "Fiscal Policy and MPC Heterogeneity," American Economic
  Journal: Macroeconomics, October 2014, 6 (4), 107­136.

Johnson, David S., Jonathan A. Parker, and Nicholas S. Souleles, "Household Expenditure and
  the Income Tax Rebates of 2001," American Economic Review, December 2006, 96 (5), 1589­1610.

               . ebnem, "U.S. Monetary Policy and International Risk Spillovers," Jackson Hole
Kalemli-Özcan, S
  Symposium Proceedings, September 2019.

Kaplan, Greg, Benjamin Moll, and Giovanni L. Violante, "Monetary Policy According to
  HANK," American Economic Review, March 2018, 108 (3), 697­743.

Kekre, Rohan and Moritz Lenel, "Dollar Demand and International Risk Sharing," Manuscript,
  October 2020.

Krugman, Paul, "Adjustment in the World Economy," Working Paper 2424, National Bureau of
  Economic Research, October 1987.

  and Lance Taylor, "Contractionary Effects of Devaluation," Journal of International Economics,
  August 1978, 8 (3), 445­456.

Lane, Philip R. and Jay C. Shambaugh, "Financial Exchange Rates and International Currency
  Exposures," American Economic Review, March 2010, 100 (1), 518­540.

                                              45
McKay, Alisdair and Johannes F Wieland, "Lumpy Durable Consumption Demand and the Lim-
 ited Ammunition of Monetary Policy," Working Paper 26175, National Bureau of Economic
 Research, August 2019.

  , Emi Nakamura, and Jón Steinsson, "The Power of Forward Guidance Revisited," American
  Economic Review, October 2016, 106 (10), 3133­3158.

Mian, Atif R., Ludwig Straub, and Amir Sufi, "Indebted Demand," Working Paper 26940, Na-
 tional Bureau of Economic Research, April 2020.

Obstfeld, Maurice and Kenneth Rogoff, "Exchange Rate Dynamics Redux," Journal of Political
 Economy, June 1995, 103 (3), 624­660.

Oskolkov, Aleksei, "Exchange Rate Policy and Heterogeneity in Small Open Economies,"
  Manuscript, March 2021.

Otten, Julia Isabelle, "Household Heterogeneity and the Adjustment to External Shocks," in
  "Three Essays on Household Heterogeneity and Macroeconomic Dynamics" March 2021.

Ruhl, Kim J., "The International Elasticity Puzzle," Manuscript, 2008.

Schmitt-Grohé, Stephanie and Martín Uribe, "Closing Small Open Economy Models," Journal of
  International Economics, October 2003, 61 (1), 163­185.

Tille, Cédric, "The Role of Consumption Substitutability in the International Transmission of
  Monetary Shocks," Journal of International Economics, April 2001, 53 (2), 421­444.

Uribe, Martín and Stephanie Schmitt-Grohé, Open Economy Macroeconomics, Princeton, NJ:
  Princeton University Press, April 2017.

Werning, Iván, "Incomplete Markets and Aggregate Demand," Working Paper 21448, National
 Bureau of Economic Research, August 2015.

Woodford, Michael, "Simple Analytics of the Government Expenditure Multiplier," American Eco-
 nomic Journal: Macroeconomics, 2011, 3 (1), 1­35.

Zhou, Haonan, "Open Economy, Redistribution, and the Aggregate Impact of External Shocks,"
  December 2020, Presentation slides.




                                                46
     Online Appendix for "Exchange Rates and
    Monetary Policy with Heterogeneous Agents:
       Sizing up the Real Income Channel"
A     Model details
A.1    Model setup
Here we provide additional details on the setup of the model in section 2.

Preferences across goods.     In our baseline model, consumption cit of any agent i living in any
country aggregates their home good H and a composite foreign good F with elasticity  ,
                                                                                                                        
                                                                    1                 -1          1          -1         -1
                                     cit = (1 - ) (ciHt )                                  +  (ciFt )
                                                                                                             




home consumption aggregates goods j produced at home, while foreign consumption aggregates
goods produced in a continuum of countries k:
                                                                                                                                       
                                            1                     -1              -1                        1           -1             -1
                            ciHt =              ciHt ( j)               dj                 ciFt =               cikt         dk
                                        0                                                               0

with > 1,  > 0 and  > 0. In turn, consumption from country k aggregates goods produced
there with the same elasticity as that used to aggregate goods produced at home,

                                                                             1               -1        -1
                                                        cikt =                   cikt ( j)        dj
                                                                         0

The agent's budget constraint is
               1                                    1        1                                                                              Wt
                                                                                                                                  p
                   PHt ( j) ciHt ( j) dj +                       Pkt ( j) cikt ( j) djdk + ait+1  1 + rt ait + eit                             Nt
           0                                    0        0                                                                                  Pt
hence, consumer i's demand for good j in country k is
                                                                                 -                -                -
                                                                 Pkt ( j)                  Pkt          PFt
                                   cikt ( j) =                                                                           cit
                                                                  Pkt                      PFt          Pt

while their demand for good j in the home country is
                                                                                                  -               -
                                                                                 PHt ( j)              PHt
                                     ciHt ( j) = (1 - )                                                                 cit
                                                                                  PHt                   Pt

Applying this demand system to the heterogeneous agents at home, indexed by their state ( a, e),
delivers equations (4) and (5). Applying this demand system to the representative foreign agents,
                                                                                         = P ,
noting that all foreign countries are symmetric and prices are flexible abroad so that PFt     t




                                                                                 A-1
delivers
                                                                  -
                                                        PHt            
                                          CHt =                       Ct
                                                        Pt
which is equation (7).

Financial sector.        Let At denote the nominal liabilities of the domestic mutual fund (the
                                                  p
amount of shares it sold to households), and it denote the nominal return on these assets. Let
 H (resp. s F ) denote the mutual fund's holdings of domestic (resp. foreign) shares, and B H (resp.
st           t                                                                              t
Bt F ) denote its holdings of domestic (resp. foreign) bonds. At the beginning of period t, the liq-

uidation value of the intermediary's liabilities is equal to the liquidation value of its assets, so
that
        p                        H                   H                        F                     F
   1 + it At-1 = ( Dt + pt ) Pt st -1 + (1 + it-1 ) Bt-1 + ( Dt + pt ) Pt Et st-1 + (1 + it-1 ) Et Bt-1 (A.1)

At the end of the period, the value of newly purchased assets must be
                                             H
                                 At = pt Pt st + BtH + p         F       F
                                                        t Pt Et st + Et Bt                             (A.2)

Define the ex-post real return to the mutual fund as

                                               p              p   Pt-1
                                          1 + rt = 1 + it                                              (A.3)
                                                                   Pt
                                                                                  p
The mutual fund maximizes the (expected) real return on its liabilities, rt+1 , for all t  0, which
                                                                p
here is equivalent to maximizing the (expected) nominal return it+1 . Optimality requires that the
nominal returns on all assets is equalized,
                                                 + p
                                               Dt           
                                                       t+1 Pt+1 Et+1
               ( Dt+1 + pt+1 ) Pt+1                                           ) E
                                                                       (1 + i t
                                                  +1                              t +1
                                    = 1 + it =                       =                                 (A.4)
                       pt Pt                         p  P E
                                                      t t t                 E   t

Combining (A.1) and (A.4), we find that, for all t  0,
                                                   p
                                             1 + i t +1 = 1 + i t                                      (A.5)

Further define the ex-ante real risk free rate as
                                                                   Pt
                                          1 + r t  (1 + i t )                                          (A.6)
                                                                  Pt+1

This is equation (14). Using the definition of the real exchange rate in (6), real exchange rate
depreciation between time t - 1 and t can be expressed as

                                             Qt       Et Pt-1
                                                   =                                                   (A.7)
                                            Q t -1   Et-1 Pt
Using (A.3), (A.4), (A.6) and (A.7), together with the fact that Pt = 1 always, it follows that, for all
t  0,
                                                          + p
                                                        Dt       t +1 Q t +1
                                     Dt + 1 + p t + 1                                 ) Q
                                                                               (1 + i t
                    p                                      +1                             t +1
              1 + r t +1 = 1 + r t =                  =                      =                    (A.8)
                                            pt                pt Q  t               Q   t

which delivers equations (15) and (16).


                                                       A-2
   Finally, let the real asset position of the mutual fund be defined as

                                                                 At
                                                       At                                                           (A.9)
                                                                 Pt
and define the net foreign asset position to be the difference between At and the total value of
assets in net supply domestically,
                                         nfat  At - pt
which is equation (17).
   Using (A.9), equation (A.1) rewrites

          p                          H                      Pt-1 BtH
                                                                   -1                     F
                                                                                                                    F
                                                                                                                   Bt -1
    1 + r t A t - 1 = ( Dt + p t ) s t -1 + (1 + i t -1 )             + ( Dt + p                        
                                                                                t ) Q t s t -1 + (1 + i t -1 ) Q t
                                                             Pt Pt-1                                                P
                                                                                                                    (A.10)
while (A.2) rewrites
                                                H       BtH          F     BtF
                                       At = pt st +         + pt Qt st + Qt                                        (A.11)
                                                        Pt                 P
                                                                                                            H
                                                                                                           B-            H
                                                                                                                        B-
                                            p                                 H , sF ,
From (A.10), we can calculate 1 + r0 given the initial mutual fund portfolio s- 1 -1                       P-1
                                                                                                              1
                                                                                                                  and   P ,
                                                                                                                           1


whose value in steady state, given (A.11), must add up to Ass ,
                                                       H
                                                      B-                       F
                                                                              B-
                                             H           1           F           1
                                  Ass = pss s- 1+          + p  Q  s
                                                              ss ss -1 + Q ss
                                                      P-1                     P

In our baseline calibration, we assume that the mutual fund holds all the domestic assets and no
                               H           F
                  H = 1 and B-1 = s F = B-1 = 0. This ensures that A = p , and therefore that
other assets, ie s- 1         P-1   -1    P                           ss    ss
nfa-1 = 0.

Foreign agents.           All foreign countries are symmetric. In each lives a representative foreign
agent with utility
                                           
                                            (  )t Bt {u (Ct ) - v ( Nt )}                                          (A.12)
                                          t =0

where  is the foreign discount factor, and Bt is a utility modifier capturing time-varying patience
for the foreign household. We assume that Bt has initial value B-1 = 1, is nonnegative and
bounded, Bt  0, B for B > 0, and reverts to 1 in the long run: limt Bt = 1.
    Foreign countries produce their own good under constant returns to scale with production
function
                                           Yt = Z  Nt
Prices and wages are flexible abroad, so that

                                                      Pt = µWt

The home country is infinitesimal, so that market clearing for the composite foreign good is
                                                         
                                                        Ct = Yt




                                                            A-3
The first order conditions for a representative foreign agent are

                                               v ( Nt )   Wt
                                                        =
                                               u (Ct)     Pt

and
                                Bt (Ct )- =  (1 + rt
                                                   
                                                     ) Bt+1 (Ct+1 )-                               (A.13)
where rt  denotes the foreign interest rate. It follows that the world equilibrium features a constant

level of consumption C  (and output Y  = C  ) given by

                                              v (C  / Z  )   1
                                                           =
                                                u (C  )      µ
                                  is given by (A.13) when C  = C 
and that the real interest rate rt                                           
                                                               t      t+1 = C . The central bank targets
                          
a constant price index P , which it achieves by setting the foreign interest rate according to price-
level targeting rule with the natural rate rt  as an intercept, i  = r  +  log ( P / P ). In equilibrium,
                                                                  t    t          t
the foreign nominal and real interest rates are equal, and relate to the discount factor shocks Bt
according to
                                                            1 Bt
                                       1 + it = 1 + rt  =                                           (A.14)
                                                            B t +1
The primitive shocks in our economy are the sequence of Bt 's. Alternatively, given (A.14), we can
construct this sequence for a given exogenous sequence of foreign interest rates it 's and the fact

that lim Bt = 1, from
                                                      
                                                 1 + is
                                       Bt = 
                                            st   1/ 
                                                                              relative to the steady
so that high Bt corresponds to high current or future foreign interest rate it
state foreign interest rate 1/  .


A.2     Version of the model with UIP deviations
We consider a version of our model in which we allow for deviations in the UIP condition. In
particular, we assume that mutual funds cannot directly hold positions in foreign bonds. Instead,
there exist foreign intermediaries that can trade in both foreign and domestic bond markets. De-
note the end-of-period positions of these intermediaries by btI . We assume that foreign intermedi-
aries have an imperfectly elastic demand for domestic bonds, that is,

                                         1                Et
                                 btI =     (1 + i t )                      
                                                                  - (1 + i t )
                                                         E t +1
Such imperfect elasticity can be microfounded by assuming that there is only a limited number
of foreign intermediaries (of similar measure as the small open economy itself) and that foreign
intermediaries face limited commitment (Gabaix and Maggiori 2015), risk (Itskhoki and Mukhin
2020) or adjustment costs (Alvarez, Atkeson and Kehoe 2009, Fanelli and Straub 2020). These
microfoundations are identical for our purposes.
    In addition to foreign intermediaries, we also allow for noise traders with exogenous demand
 t for domestic bonds as in Gabaix and Maggiori (2015) and Itskhoki and Mukhin (2020). To-
gether, foreign intermediaries and noise traders hold the inverse of the country's net foreign asset


                                                        A-4
position,
                                                  btI +  t = -nfat
Rearranging, this implies that the UIP condition (13) no longer holds whenever  > 0

                                                Et              
                                  (1 + i t )             = 1 + it -  ( t + nfat )                 (A.15)
                                               E t +1
The dependence on the NFA in (A.15) captures the idea that the country has to pay a premium
when it is a net borrower nfat < 0, in terms of a greater interest rate it . The dependence on  t
captures the idea that noise shocks can also move exchange rates.44
   In the limit where   0, we recover the UIP condition (13). On the other hand if, as in Itskhoki
and Mukhin (2020), we simultaneously assume   0 but  t  0, we obtain a version of (A.15)
with exogenous UIP shocks
                                              Et           
                                  (1 + i t )        = 1 + it -  t
                                             E t +1
Observe that those shocks enter in exactly the same way as the world interest rate shocks it  that
                                                              shocks carries over to exogenous UIP
we introduced in section 2. In that sense, our analysis for it
                                    
shocks, by simply redefining it  it -  t .
   We study the effects of endogenous UIP deviations (A.15) with  t = 0 in section 5.7.


A.3       Current account identity
Start by aggregating up household budgets in equation (1), using Eeit = 1,

                               PFt       PHt                 p
                                   CFt +     CHt + At = 1 + rt At-1 + wt Nt
                               Pt         Pt
Use the definition of the NFA (17), noting that we can always write the aggregate expost return as
                           p                                       p
                     1 + r t A t -1 = (1 + r t -1 ) A t -1 + r t - r t -1 A t -1
                                                                              p
                                     = (1 + rt-1 ) ( pt-1 + nfat-1 ) + rt - rt-1 At-1
                                                                                  p
                                     = Dt + pt + (1 + rt-1 ) nfat-1 + rt - rt-1 At-1              (A.16)

to obtain
          PFt       PHt                                                   p
              CFt +     CHt + pt + nfat = Dt + pt + (1 + rt-1 ) nfat-1 + rt - rt-1 At-1 + wt Nt
          Pt         Pt
Substitute in the value of dividends Dt in (12),
            PFt       PHt             PHt                                      p
                CFt +     CHt +nfat =     (CHt + CHt ) + (1 + rt-1 ) nfat-1 + rt - rt-1 At-1
            Pt         Pt              Pt
                                                        Yt
                   Ct

  44 An   alternative way to think of noise shocks is as movements in risk premia.




                                                             A-5
Hence,
                                      PHt                         p
                    nfat - nfat-1 =       Yt - Ct +rt-1 nfat-1 + rt - rt-1 At-1               (A.17)
                                       Pt
                                            NXt

which is the current account identity. Note that we have defined net exports NXt (the trade bal-
ance) in units of the consumer price index, so that

                                         PHt           PHt       PFt
                              NXt            Yt - Ct =     CHt -     CFt                      (A.18)
                                          Pt            Pt       Pt

A.4      Characterizing steady states
Combining the goods market clearing condition (21) with the equations for demand for domestic
goods (5) and (7), and the PCP price-setting condition (8), we see that domestic output is always
given by
                                          PHt -             PHt - 
                            Yt = (1 - )           Ct +              C                       (A.19)
                                           Pt                Et
Combining instead the equations for net exports (A.18) with these same equations, together with
PFt = Et , we see that the trade balance is always given by
                                                     -                        -
                                      PHt     PHt                 Et    Et
                           NXt =                          C -                      Ct         (A.20)
                                       Pt      Et                 Pt    Pt

We next relate all relative prices in equations (A.19) and (A.20) to the real exchange rate Qt = E
                                                                                                 Pt .
                                                                                                   t

Manipulating the price index equation (3), we see that Qt is related to the relative price of home
goods PHt / Pt through
                                                                              1
                                                          1-                 1- 
                                                    PHt             1- 
                               1 = (1 -  )                      +  Qt                         (A.21)
                                                     Pt

Denote by p H ( Q) the mapping between P    P and Q implicit in equation (A.21). We can also rewrite
                                             H

(A.21) to relate the real exchange rate Qt to the relative price of home and foreign goods (the terms
of trade) St  Et / PHt via
                                                                               1
                                                                  1- 
                                                                              1- 
                                                            -1
                               1                       Et
                            Q-
                             t = (1 -  )                                +                     (A.22)
                                                      PHt
                                 


We let s ( Q) denote the mapping between the terms of trade E / PH and the real exchange rate Q
implicit in this equation.
   Taken together, equations (A.19)­(A.22) imply that the level of the real exchange rate Qt and
aggregate domestic spending Ct uniquely determine the level of domestic output on the one hand,

                           Yt = (1 - ) ( p H ( Qt ))- Ct +  (s ( Qt )) C                      (A.23)

and the trade balance on the other,

                          NXt =  p H ( Qt ) ( pH ( Qt ))  C -  ( Qt )1- Ct
                                                         - 
                                                                                              (A.24)



                                                     A-6
Steady state.         Consider a steady state of our model, with a constant level of all aggregates
{C, CH , CF , Y, A, p, D, nfa} and relative real prices { Q, PH / P, W / P, r, i }, for given constant for-
eign discount factor shocks B and productivity Z. The real UIP condition (16) together with the
foreign Euler equation (A.14) implies that the domestic real interest rate is r = i = (  )-1 - 1.
Equations (29) and (30) imply that the long-run real wage and dividends are given, respectively,
by

                                     W            1 PH    1
                                          =            Z = p H ( Q) Z
                                     P            µ P     µ
                                                        1
                                      D =          1-     p H ( Q) Z
                                                       µ

The asset pricing equation (15) then implies that the domestic stock price is

                                              1         1
                                         p=        1-          p H ( Q) Z
                                              r         µ

Households accumulate aggregate assets A so that the steady state net foreign asset position is

                                                  nfa = A - p

where A = A H A (r, p H ( Q) Z ) is only a function of the steady state real interest rate r and real
income p H ( Q) Z. Equivalently, their aggregate consumption C must, on the one hand, satisfy

                                         C = C H A (r , p H ( Q ) Z )                               (A.25)

and on the other hand, satisfy equation (A.17),

                                    r · nfa = - NX = C - p H ( Q) Y                                 (A.26)

Moreover, from (A.23), aggregate output must be

                             Y = (1 - ) ( p H ( Q))- C +  ( pH ( Q ))
                                                                      - 
                                                                       C                            (A.27)

Combining (A.26) with (A.27) implies the steady state net export equation (A.24). Finally, the
wage Phillips curve (18), together with the production function Y = ZN , implies that long-run
wage (and price) inflation rate is equal to

                                      1                  v (Y / Z )
                              w =       w            1 1
                                                                        -1                          (A.28)
                                     1-             µw µ p H
                                                           ( Q) Zu (C )

    A steady state in our model is characterized by a 4-tuple (Y , Q, C, nfa) for output, the real ex-
change rate, consumption and the net foreign position, that simultaneously satisfies equations
(A.25), (A.26) and (A.27). A zero-inflation steady state additionally restricts this tuple to satisfy
equation (A.28) with w = 0. Hence, there always is a unique no-inflation steady state.
    We always start from such a steady state. We pick  to deliver our target for the real interest
rate r, and normalize C  = Q = 1 so that all relative prices are 1. Then, equation (A.26) implies




                                                      A-7
that C = Y + rnfa, while equation (A.27) implies that Y = (1 - ) C + , so that

                                       1-                                                     1
                           Y = 1+         · r · nfa                  and           C = 1+       · r · nfa                (A.29)
                                                                                              
We finally set Z = 1 and solve for the scaling parameter in labor disutility v such that equation
(A.28) holds for these values of Y and C, given our choice for µw , µ, and the initial steady state nfa.
In our baseline calibration we set nfa = 0, so that these normalizations imply Y = C = 1.

Unique steady state with Q = 1. After transitory monetary policy or foreign interest rate
shocks, the model always returns to a steady state. There is a one-dimensional set of such steady
states, characterized by the 4-tuples (Y , Q, C, nfa) such that (A.25), (A.26) and (A.27) simultane-
ously hold. The unique steady state with Q = 1 is therefore the initial steady state, which in our
baseline features Y = C = 1 and nfa = 0.


A.5     Representative-agent complete-market model
In the representative-agent complete markets model, all agents can buy and sell Arrow-Debreu
securities for each aggregate state st and in each country. From an "ex-ante" perspective, before
any realization of shocks, the domestic agents maximizes
                                         
                                          Pr(st ) t {u (Ct ) - v ( Nt )}                                                 (A.30)
                                        t =0 s t

where Ct is the consumption basket in (2), subject to the sequence of budget constraints at each t,

   Pt Ct +    Mt,t+1 (st+1 ) Bt+1 (st+1 ) + Et  Mt,t+1 (st+1 ) Bt+1 (st+1 )  Wt Nt + Dt + Bt + Et Bt
             s t +1                                    s t +1

where Bt+1 (st+1 ) denotes holdings of domestic Arrow securities, paying a unit of domestic cur-
                        (s
rency in state st+1 , Bt +1 t+1 ) denotes holdings of foreign Arrow securities paying a unit of foreign
currency in that state, and Mt,t+1 (st+1 ) (respectively Mt 
                                                            ,t+1 ( st+1 )) denotes the domestic-currency
(respectively foreign-currency) price at time t of these securities. The first order conditions for the
choices of Bt+1 are
                                         Ct+1 -       Pt
                                                            = Mt , t + 1                          (A.31)
                                          Ct        Pt+1
                               imply
and those for the choices of Bt +1

                                                   -
                                        Ct+1                 Pt                          E t +1
                                                                         = Mt ,t +1                                      (A.32)
                                         Ct                 Pt+1                          Et
Combining these two equations implies the standard equilibrium condition linking Arrow-Debreu
state prices in different countries and exchange rates,

                                                                E t +1        
                                             Mt , t + 1                    = Mt ,t +1
                                                                 Et
                        1                                                 1                  
In particular, since   1+ i t   = st+1 Mt,t+1 (st+1 ) and                     
                                                                         1+ i t   =  s t +1 Mt ,t+1 ( st+1 ), we recover the UIP
condition (13).


                                                                  A-8
    The foreign agent maximizes its utility function (A.12) subject to the budget constraint

                                                           1                                                  Bt
  Pt Ct
      
        +    Mt,t+1 (st+1 ) Bt+1 (st+1 ) + Et  Mt,t+1 (st+1 ) Bt+1 (st+1 )  Wt Nt + Dt + Et + Bt
            s t +1                                             s t +1

That agent's first order conditions for the choices of Bt+1 are
                                                               -
                                        B t +1     Ct +1                 Pt                   E t +1
                                                                               = Mt , t + 1                        (A.33)
                                         Bt         Ct                  Pt+1                   Et
                                            . Combining (A.31) and (A.33) we obtain
with a similar equation for the choice of Bt +1

                                                     -                                           -
                            E t +1         Ct+1                 Pt             B t +1    Ct +1          Pt
                                                                         =                                         (A.34)
                             Et             Ct                 Pt+1             Bt        Ct           Pt+1

Stationarity requires that the discount factors of of both agents are equal,  =  . Since, in addi-
tion, Pt = Pt                           
             +1 = 1 and Ct = Ct+1 = C , we can rewrite equation (A.34) as

                                                                                  -
                                                  Bt       Q t +1          Ct+1
                                                                                        =1
                                                 B t +1     Qt              Ct

This equation holds in every state st , hence, we obtain the Backus-Smith condition modified for
discount factor shocks,
                                         Qt -            -
                                           C = cst = Css
                                         Bt t
where the last line follows from the fact that B-1 = Q-1 = 1. This is equation (23).
                                                              1
  Finally, taking the sum of (A.31) across all states, using 1+ it = st+1 Mt,t+1 ( st+1 ) and the Fisher
            1 Pt+1        1
equation   1+it Pt   =   1+r t ,   we recover the Euler equation
                                                       -
                                                      Ct =  (1 + rt ) Ct-
                                                                        +1
                                                                          


which is equation (24).

Steady states.      Steady states in this model are characterized by 4-tuples (Y , Q, C, nfa) that
satisfy the same equations (A.26) and (A.27) as in the representative-agent model, while equation
(A.25) is replaced by the steady state version of equation (23),

                                                               QC - = Css
                                                                       -


As in section A.4, there is a unique steady state with Q = 1, and this is the initial steady state.

Equivalence to Gali-Monacelli.            Here, we log-linearize the equilibrium conditions in the
                                                        Bt              Ct              Qt               Et
spirit of Galí and Monacelli (2005). Denote bt  d log B  ss
                                                            , ct  d log Css
                                                                            , qt  d log Q ss
                                                                                             , et  d log E ss
and so on, for log deviations of aggregate variables from their steady state. The equation for the
price index (3) log-linearizes as
                                       pt =  p Ft + (1 - ) p Ht




                                                                        A-9
so, using that p Ft = et and qt = et - pt , we obtain
                                                              
                                         p Ht - pt = -          qt                                          (A.35)
                                                             1-
in particular, the difference between PPI inflation  Ht = p Ht - p Ht-1 and CPI inflation t =
pt - pt-1 is given by
                                                    
                                      Ht - t = -        qt                               (A.36)
                                                   1-
where qt = qt - qt-1 . Log-linearizing the demand equation (26), we have

                                                                             1
                             y t = (1 -  )         qt + ct             +       qt
                                                1-                          1-

and using (A.35), together with the definition of  in (9), we find that output is
                                                       
                                      
                             yt =       (1 -  )  +   q t + (1 -  ) c t                                      (A.37)
                                                    
                                    1-
                                                      

Log-linearizing the Euler equation (24), we obtain

                                                      1
                                     c t = c t +1 -     ( i t -  t +1 -  )                                  (A.38)
                                                      
where  = - log , while the log-linearized Backus-Smith condition (23) reads

                                                      1
                                             ct =       ( q t - bt )                                        (A.39)
                                                      
Finally, to derive the Phillips curve, combine equations (18) and (11) to obtain that  Ht = wt ,
with
                                            v ( Nt )
                               Ht = w     Z PHt
                                                        - 1 +  Ht+1
                                         µµw Pt u (Ct )

                                                                               Z PH u (C )
Log-linearizing around the steady state with zero inflation so that           µµw P v ( N )   = 1, this results in

                              Ht = w ( nt + ct - ( p Ht - pt )) + t+1

Combining this equation with production (10),

                                                    yt = nt

and the expression for the relative price of home goods in (A.35), we obtain

                                                             
                              Ht = w      yt +  ct +           qt       +  Ht+1                             (A.40)
                                                            1-

This is exactly equations (32) and (33) in Gali-Monacelli (since we do not consider productivity or
foreign spending shocks, and the terms of trade in their notation is st = et - p Ht = qt + pt - p Ht =
                1
q t + 1-  qt = 1- qt ). In particular there was no loss of generality in considering sticky wages rather
       




                                                      A-10
than sticky prices. The equivalence between the slopes of the Phillips curves obtains provided that
we set
                                                   (1 -  ) (1 -  )
                                             w =                                                 (A.41)
                                                          
where  is the Calvo probability of keeping a domestic price fixed in Gali-Monacelli.
    Equations (A.36), (A.37), (A.38), (A.39), and (A.40), characterize the log-linear model, deliver-
ing t ,  Ht , yt , ct , qt as a function of the foreign preference shock bt for a given monetary policy
rule for it .

Reduced-form two-equation system.             To see the connection with the equations derived
in Galí and Monacelli (2005), observe that we can use the Backus-Smith condition (A.39) and
the market clearing condition (A.37) to solve for ct and qt as a function of yt and the exogenous
variable bt . This gives us
                                                 1                    1
                                      1        -        ct           -   bt
                                                               =
                                     1-        
                                              1-        qt            yt

which can be inverted to read
                                                                         1
                                ct
                                         = (1 - ) 
                                                             - 1-   bt +  y t
                                qt                              1- 
                                                                  bt + y t

where we have defined, as in in Gali-Monacelli,
                                          
                                                     with       - (1 - )
                                      1 -  + 
This implies that
                                                          
                                      ct +      qt =  yt -  bt                                  (A.42)
                                             1-           
Since substituting (A.36) into the Euler equation (A.38) implies
                                              
                                 c t +1 +       qt+1 = (it -  Ht+1 - )
                                             1-
we have, using (A.42), that
                                                                   
                                yt+1 = it -  Ht+1 -  +                bt + 1                    (A.43)
                                                                   
   Next, substituting (A.42) into (A.40), the Phillips curve is
                                                             
                               Ht = w (  +  ) yt -             bt +  Ht+1
                                                             
Under flexible wages, output solves
                                                             
                                             (  +  ) yn
                                                      t =      bt                               (A.44)
                                                             




                                                     A-11
hence, the Phillips curve is

                                   Ht = w (  +  ) (yt - yn
                                                         t ) +  Ht+1                            (A.45)

which is exactly equation (36) in Galí and Monacelli (2005) augmented to include foreign discount
factor shocks, which affect the natural output level yn t according to (A.44). Finally, equation (A.43)
implies that, defining the natural real interest rate as

                                      n                      
                                     rt   +  yn
                                              t +1 -            bt + 1                          (A.46)
                                                             
the Euler equation reads
                                               -1                n
                                        yt+1 =    (it -  Ht+1 - rt )                            (A.47)
which is the counterpart of equation (37) in Galí and Monacelli (2005), where the natural PPI-based
real rate of interest is affected by foreign discount factor shocks per equation (A.44).


A.6    Representative-agent incomplete-market model
In the incomplete-market representative-agent model (henceforth "RA-IM"), the domestic agent
again maximizes the utility function (A.30), but now only has access to nominal bonds in both
countries that cannot be indexed to aggregate shocks. As in the main text, we appeal to certainty
equivalence for small shocks and solve this model from an ex-post perspective. Then, the repre-
sentative agent solves
                                            
                                            t {u (Ct ) - v ( Nt )}
                                           t =0

where Ct is the consumption basket in (2), subject to the sequence of budget constraints

                                 1                1                               
                    Pt Ct +           Bt+1 + Et       Bt+1  Wt Nt + Dt + Bt + Et Bt
                               1 + it           1 + it

with initial portfolio B0 = B0   = 0. Optimality immediately implies the UIP condition (13). Defin-
                                 
                         Bt +Et Bt
ing real wealth as at  Pt , we then have

                                          1 Pt+1          Wt      Dt
                                 Ct +             a t +1     Nt +    + at
                                        1 + it Pt         Pt      Pt
using the Fisher equation (14), this rewrites as

                                             1            Wt      Dt
                                   Ct +           a t +1     Nt +    + at
                                           1 + rt         Pt      Pt
Iterating on this equation, which clearly holds with equality, starting from a0 = 0 delivers the
country's present value budget constraint,

                                                         Ws      Ds
                                      qs Cs =  qs        Ps
                                                            Ns +
                                                                 Ps
                                     s 0          s 0

              -1 1
where qs  s  u=0 1+ru . Finally, using (29) and (30), we obtain the incomplete-market present value
budget constraint, stating that the present value of the country's consumption must be equal to


                                                    A-12
the present value of its real income,

                                                                         PHs
                                             qs Cs =  qs                  Ps
                                                                             Ys                  (A.48)
                                            s 0                 s 0

The first order condition for the choice of consumption delivers the standard Euler equation (24),
and combining the usual equations we obtain the real UIP condition (16).

Steady states.     In this model, a steady state is characterized by a 4-tuple (Y , Q, C, nfa) that
simultaneously satisfies equations (A.23) and (22), together with a long-run equation for the nfa ,

                                                           t
                                          1
                                nfa = lim
                                        t qt
                                                        qs ( p H (Qs ) Ys - Cs )                 (A.49)
                                                       s =0

where, from (24),
                                                                           1
                                                                          -
                                                                1 + rs
                                           Cs =                  1/ 
                                                                               C                 (A.50)
                                                    st

and, from (16),
                                                                      
                                                                 1 + is
                                             Qs =                1 + rs
                                                                            Q                    (A.51)
                                                       st

Hence, the nfa depends on the entire sequence of shocks, contrary what happens to the HA model.
This reflects the non-stationarity of the model. There is still a unique equilibrium with Q = 1, but
in contrast to the HA and complete market models, in general the long level of (Y , C, nfa) differs
from the initial steady state.


A.7     Two-agent complete-market model
For the two-agent complete-market model (henceforth "TA model"), we assume that the house-
hold side of the model consists of a share 1 -  of agents with unfettered access to financial mar-
kets, denoted by superscript u (for "unconstrained"), and a share  of agents without any access
to financial markets, denoted by superscript c (for "constrained").
     The consumption behavior of unconstrained agents is determined just like the behavior of the
representative agent in section A.5. We again take an "ex-ante" perspective, before any realization
of shocks. Unconstrained agents solve
                                        
                                 max     Pr(st ) · t {u (cu          u
                                                          t ) - v ( Nt ) }
                                       t =0 s t

subject to the sequence of budget constraints

   Pt cu
       t +    Mt,t+1 (st+1 ) Bt+1 (st+1 ) + Et  Mt,t+1 (st+1 ) Bt+1 (st+1 )  Wt Ntu + Dt + Bt + Et Bt
             s t +1                               s t +1

As in section A.5, this determines consumption of unconstrained agents according to the Backus-
Smith condition (23), that is
                                                       - Bt
                                       (cu
                                         t)
                                            -
                                              = (cu
                                                  ss )                                   (A.52)
                                                         Qt


                                                               A-13
where cu
       ss denotes steady state consumption of unconstrained agents, as well as the Euler equation,

                                   (cu
                                     t)
                                        -
                                          =  (1 + r t ) ( c u
                                                            t +1 )
                                                                   -
                                                                                           (A.53)

Constrained agents do not have access to financial markets. Following similar notation, they solve
                                         
                                   max    t {u (cc          c
                                                 t ) - v ( Nt ) }
                                         t =0

subject to
                                            Pt cc      c
                                                t  Wt Nt

This pins down their consumption bundle as

                                                       Wt c
                                                cc
                                                 t =     N                                 (A.54)
                                                       Pt t
Aggregate consumption is given by

                                       Ct = (1 - ) cu    c
                                                    t + ct

We assume the same equal rationing among the two types of agents that we assume among het-
erogeneous agents in our heterogeneous agent model of section 2. Thus,

                                          Ntu = Ntc = Nt

This implies that steady state consumption for the two agents is given by

                                     1         Wss       1 - µ -1   1
                           cu
                            ss =        Dss +      Nss =          +
                                   1-          Pss        1-        µ
                                   Wss       1
                           cc
                            ss =       Nss =
                                   Pss       µ


B     Proofs
B.1    Proof of proposition 1
Linearizing the goods market clearing condition (26) around the steady state with C = Y = Q =
PH = PF = E = 1, we find

              dYt = (1 - ) (- ) (dPHt - dPt ) +  (-) (dPHt - dEt ) + (1 - ) dCt            (A.55)

Linearizing the equation defining the CPI (3), we have dPt = (1 - ) dPHt + dEt . Linearizing the
equation defining the real exchange rate (6), we have dQt = dEt - dPt . Combining, we find

                                       dPt - dEt          
                              dPHt =             = dPt -    dQt                            (A.56)
                                         1-              1-




                                                  A-14
Substituting (A.56) into (A.55), we find
                                                         
                              dYt =  dQt +                 dQt + (1 - ) dCt
                                                        1-
                                           
                                    =        ( (1 - ) + ) dQt + (1 - ) dCt
                                          1-
                                           
                                    =        dQt + (1 - ) dCt                                                      (A.57)
                                          1-
where  is defined in (9). Finally, in the representative-agent model, we know from the Backus-
Smith condition and the assumption that Q = 1 that dCt = 0. This delivers equation (28).


B.2        Proof of propositions 2 and 3
In this section, we derive the "international Keynesian Cross" in its general form (38), which nests
                                                                     and dr .
(32), allowing for shocks to foreign and domestic interest rates, dit       t
     To derive (38), we start from substituting the domestic and foreign demand equations (5) and
(7) into the goods market clearing condition (21), using the price-setting equation for home goods
abroad (8), and aggregating up,
                                               -                                                   -
                                         PHt                p          Ws                 PHt
                       Yt = (1 - )                 Ct     r0 , r s ,      Ns       +                   C           (A.58)
                                          Pt                           Ps                  Et
In (A.58), we have made explicit the fact that aggregate demand for consumption Ct depends only
                               p
on the initial ex-post return r0 , reflecting valuation effects, the time path of real interest rates rs for
                                                      p
s  0 set by monetary policy (since, by (15), rt+1 = rt for all t  1), and the path of real wages
ws Ns for s  0. We denote this general "consumption function" by Ct . Note that Ct here is a more
general object compared to our usage in Section 3.2.45
    Substituting these mappings into (A.58) and using the value of real labor income in (29), we
have
                                                  p       1
              Yt = (1 - ) ( p H ( Qt ))- Ct      r0 , rs , p H ( Qs ) Ys +  ( pH ( Qt ))
                                                                                         - 
                                                                                          C          (A.59)
                                                          µ
Moreover, the valuation equation for assets, combined with (12), implies that share prices are

                                 Dt + 1 + p t + 1                              1
                          pt =                    = PDV         rs , 1 -           p H ( Qs ) Ys                   (A.60)
                                    1 + rt                                     µ
                                     p
so that the initial revaluation r0 also only depends on the path of rs , Qs , and Ys .
    We next differentiate (A.59) around the steady state with C = C  = Y = 1, and use the fact
                                             d( PHt / Pt )   dQt     d( PHt /Et )      1 dQt
that (A.21) and (A.22) respectively imply PHt     / Pt = - 1- Qt and PHt /Et = - 1- Qt to find

                                           p              1                                                 
           d Y = (1 -  )         dQ + Cv dr0 + Cr dr + CY                      dY -      dQ            +      dQ
                              1-                          µ                           1-                   1-

where CY is the Jacobian of aggregate consumption with respect to the path of output Ys , Cr is the
Jacobian of aggregate consumption with respect to real interest rates rs , Cv is the column vector
  45 For   details on why a function Ct exists, see Auclert, Rognlie and Straub (2018).




                                                          A-15
                                                                                 p
representing the increased spending from revaluation r0 , and from (A.60) we have

                                                                   1                    
                                    dr0 = Jr dr + 1 -                    Jd dY -          dQ                                          (A.61)
                                                                   µ                   1-

where Jr , Jd are the Jacobians of the present discounted value with respect to the discount rate r
and dividends, respectively.46 Substituting in these valuation effects, we have

                                                         1
         d Y = (1 -  )            d Q + C v Jr d r + 1 -   Cv Jd dY
                               1-                        µ
                                      1                              1                                              
                     + (1 -  ) - 1 -     Cv Jd       dQ + Cv dr + CY                                   dY -           dQ
                                      µ           1-                 µ                                             1-
                         
                     +      dQ
                       1-
Hence
                                                                            
         dY =          (1 -  ) Cr + C v Jr d r +   +                                   dQ
                                                                           1-
                     intertemporal subst. + valuation
                                                               expenditure switching
                              1          1                                                  1          1
                     -          CY + 1 -                 C v J d d Q + (1 -  )                CY + 1 -              Cv Jd dY
                              µ          µ                                                  µ          µ
                                         real income                                           multiplier effect

We next define
                                                             1          1
                                               M               CY + 1 -                Cv Jd
                                                             µ          µ

for the overall Jacobian of spending with respect to income Y. In the notation of section 3.2, M
corresponds to the Jacobian of Ct with respect to {Ys }. Also, define

                                                         Mr  Cr + C v Jr

for the overall Jacobian of consumption to interest rates r. Using the expression for the trade
elasticity in (9), we have that
                                                    
        d Y = (1 -  ) Mr d r +                        dQ                   -         M        d Q + (1 -  ) M d Y                     (A.62)
                                                   1-
                int. subst + valuation                                          real income         Multiplier effect
                                            D+F expenditure switching

where the response of the real exchange rate is given by
                                                                            - dr
                                                                         dis     s
                                                       dQt =    (1 + r ) s - t +1                                                     (A.63)
                                                               st

Equation (A.62) is the international Keynesian cross. It is a fixed point equation for the sequence
of output changes dY. The Jacobians Mr and M are infinite-dimensional matrices. By construction
                                                                                 2                                        2
  46 These                                               r          1      1                                 1       1
             have the simple expressions Jd =            D     1   1+r    1+r        ···    and Jr = -      1+r     1+r       ··· .


                                                                   A-16
Mr dr has finite elements. We have assumed (and numerically verified) that M is positive. Since
the columns of M have a present value of 1, this implies that MdY are finite for any present-value
summable dY since
                                                                    
                   |MdY|  M|dY|  q M|dY|  q |dY|                    (1 + r)-t |dYt | < 
                                                                   t =0


where we defined q          (1 + r ) - t         . A similar argument establishes that MdQ has finite ele-
                                           t 0
ments. Thus, (A.62) is well-defined.
  Let
                  G  ( I - (1 -  ) M ) -1 = I + (1 -  ) M + (1 -  )2 M 2 + · · ·                    (A.64)
which is a well-defined infinite-dimensional, non-negative, bounded matrix (as M is non-negative
and bounded). Then, the unique bounded solution to (A.62) must satisfy

                                                                           
                 d Y = ( I - (1 -  ) M ) -1 · (1 -  ) M r d r +              I - M dQ               (A.65)
                                                                          1-
                                                     
                      = (1 - ) GMr dr +                GdQ - GMdQ
                                                    1-

B.3    Proof of propositions 4 and 5
Proof of proposition 4. We start with the solution to the international Keynesian cross (A.65). With-
out monetary policy shocks, dr = 0, we can rewrite the solution as
                                             
                                    dY =       G (  I - (1 -  ) M ) d Q
                                            1-
which simplifies to
                                                   
                                  dY =     dQ +         (  - 1) G d Q                         (A.66)
                                      1-          1-
where the first term is just the output response in the complete-market RA model when  = 1.
Equation (A.66) immediately proves the neutrality result for  = 1. The ranking for   1 for
depreciations dQ  0 follows from the non-negativity of G (which itself is a consequence of the
non-negativity of M, see our discussion around (A.64)). The ranking for appreciations dQ  0 is
flipped.
    To obtain the equation for the trade balance (34), we linearize equation (A.24), obtaining

                                               
                    dNXt =  -           dQt +    dQt             -  ((1 -  ) dQt + dCt )
                                     1-       1-
                                                              1
Here, we used the facts that dp Ht = - 1-
                                        
                                           dQt and dp Ht = - 1- dQt . Simplifying, we find

                                                   
                                    dNXt =           ( - 1) dQt - dCt
                                                  1-
which is (34).

Proof of proposition 5. To derive the result on present values, denoted by PV (·), we first point out




                                                        A-17
that the columns of M each have a present value of 1, so that

                                             PV (MdQ) = PV (dQ)

A direct consequence is that
                                                    1
                                          PV (GdQ) =  PV (dQ)
                                                    
Using this result in conjunction with (A.66), we find

                                                    - (1 -  )
                                       PV (dY) =              PV (dQ)
                                                     1-
This shows that PV (dY) < 0 in response to a depreciation dQt  0 (with strict inequality in at
least a single period).
    When is dY0 < 0, i.e. the output response to the depreciation is contractionary on impact?
Again, building on (A.66), we find
                                                            
                                                 
                               dY0 =      dQ0 +    ( - 1)  G0,t dQt
                                       1-       1-        t =0

The threshold  for  below which dY0 is negative can simply be determined to be

                                                              dQ0
                                              = 1 -
                                                       t =0    G0,t dQt

To bound this threshold, we can use (A.64) to find that
                         
                         G0,t dQt  G0,0 dQ0  (1 - (1 - ) M0,0 )-1 dQ0
                        t =0

Thus,
                                                (1 - ) M0,0




B.4     Dollar currency pricing
In this section, we derive (36). Consider a one-time depreciation dQ0 . This affects real income in
period s by
                                  PHs            
                               d      Ys = -        1       dQ0 + dYs
                                   Ps          1 -  { s =0}
The effects on labor income is then simply

                        Ws             1      PHs                      1     1
                    d      Ns     =      d        Ys    =-       1{s=0} dQ0 + dYs
                        Ps             µ       Ps             1-       µ     µ

while the effect on dividends (12) is given by

                                        1                           1               
              dDs = -       1        1-            dQ0 + 1 -              dYs +       1        dQ0   (A.67)
                        1 -  { s =0}    µ                           µ             1 -  { s =0}


                                                       A-18
where the last term captures increased markups on exports that emerge with DCP. Following the
steps in section B.2, we see that, by definition of Mt,s , the total date-0 consumption response to
{dYs } is given by s0 M0,s dYs .
     To obtain the date-0 consumption response to dQ0 (the real income channel at date 0), denote
by MPCi agent i's date-0 MPC out of a transitory date-0 transfer. Note that agent i's exposure to
dQ0 depends on its initial income state ei0 (its share of labor income) and initial share of wealth
 ai0
Ass , multiplied by the aggregate changes in labor income and dividends respectively. We collect
these terms in an object we call net exchange rate exposure NXEi ,

                          ai0 1              1                                       ai0                 1 
                    NXEi     ·       - ei0 ·     =                                       - ei0       ·
                 1-       Ass µ 1 -          µ1-                                     Ass                 µ1-

The total date-0 consumption response is then
                                          
                              dC0 =         E [ MPCi · NXEi ] · dQ0 +  M0,s dYs
                                         1-                           s 0

Observe that net exchange rate exposures average to zero, E[ NXEi ] = 0, so that E [ MPCi · NXEi ] =
Cov ( MPCi , NXEi ). Substituting dC0 into the linearized goods market clearing condition (A.57),
we find (36).
    International Keynesian cross with DCP. We can also derive a version of the (generalized) interna-
tional Keynesian cross (38) with DCP. The main differences with the derivation in appendix B.2 are
that expenditure switching by foreign households is absent, as if  = 0, but there is an additional
term entering dividends, as in (A.67),

                                                      1          1
                                          dD =          dQ + 1 -                     dY
                                                    1-µ          µ

The change in the ex-post return at date 0, (A.61), then becomes

                                                                  1             1
                                    dr0 = Jr dr + Jd        1-        dY +        dQ
                                                                  µ           1-µ

Following the same steps as before, we then end up at

             dY =          (1 -  ) Cr + C v Jr d r +                   dQ
                         intertemporal subst. + valuation       expenditure switching

                                    1     1                                  1          1
                         -            CY - C v J d d Q + ( 1 -  )              CY + 1 -                  Cv Jd dY
                                    µ     µ                                  µ          µ
                                      real income                                multiplier effect

which is almost the same expression as before, except for reduced expenditure switching and real
income channels. To interpret this equation, we define Mr , M as before, but also define Mw  CY
as the (intertemporal) MPCs out of labor income, and M D  Cv Jd as the (intertemporal) MPCs
out of dividends. Then, the international Keynesian cross decomposition for the DCP model is
                                                                    
     d Y = (1 -  ) Mr d r +                    dQ               -     M w - M D d Q + (1 -  ) M d Y                  (A.68)
                                                                    µ
           int. subst + valuation     D expenditure switching                                    Multiplier effect
                                                                       real income



                                                            A-19
B.5    Proof of proposition 6
Proof of the non-linear neutrality result for  =  = 1. We start by proving the neutrality result non-
linearly. To do so, we state an important property that comes out of the closed economy result
in Werning (2015) based on its proof in Appendix A of Auclert, Rognlie and Straub (2020). The
consumption function that we introduce in Section 4, Ct = Ct (rt , Yt ), where we abbreviate real
income by Yt  P     Pt Yt , has the following property,
                    Ht



                                                                              Ys
                         C t ( {r s , Y s } ) = Y t · C t     (1 + r s ) ·          - 1, 1    (A.69)
                                                                             Y s +1
In particular, this implies that if an aggregate Euler equation relationship between Yt and rt holds,
         1     1+r s    1
that is, Y s
             =1 +rss · Ys+1 , this simplifies to

                                             Ct ({rs , Ys }) = Yt · Css                       (A.70)

where Css = Ct (rss, 1) denotes steady state consumption (normalized to 1 in our model).
    With this in mind, we now prove the non-linear equivalence result with  =  = 1, that is,
Yt = YtRA in response to an arbitrary monetary policy shock {rt }. We begin by deriving CtRA , YtRA
and the path of aggregate real income YtRA  P    Pt Yt
                                                 Ht   RA in the RA model.

    Since we are considering the Cole-Obstfeld case  = 1, the CPI (3) is
                                                          1-  
                                                    Pt = PHt Et

and the real exchange rate (6) is
                                                                                1- 
                                              Et    Et                   Et
                                     Qt =        = 1-   =
                                              Pt  PHt Et                PHt

In particular, the relative price of home goods in units of the CPI is
                                                                     
                                 PHt    P                     PHt
                                     = 1-Ht
                                                                                      
                                              =                         = ( Q t ) - 1- 
                                  Pt  PHt  Et                  Et

Home output is therefore given by
                                                                                  1
                                     YtRA = (1 - ) Qt1- CtRA +  Qt1-                          (A.71)

Observe that if the Backus-Smith condition CtRA = Qt holds, then (A.71) implies that aggregate
real income is simply given by

                                              PHt RA    - 
                                  YtRA =          Yt = Qt 1- YtRA = CtRA                      (A.72)
                                               Pt
Moreover, aggregate consumption satisfies the Euler equation (24),

                                                1     1 + rt 1
                                                    =                                         (A.73)
                                               CtRA   1 + rss CtRA
                                                                +1




                                                            A-20
Combining (A.72) and (A.73), we see that YtRA satisfies the same Euler equation,

                                             1          1 + rt 1
                                                    =                                        (A.74)
                                         YtRA           1 + rss YtRA
                                                                  +1

   To verify that YtRA , YtRA , CtRA are identical in the HA model, we need to show that

                                    Ct = Ct         rs , YsRA    = CtRA                      (A.75)

But (A.75) follows directly from property (A.69) of the consumption function, which simplifies to
(A.70) here given (A.74). Since the other aggregate equations of the model are the same, the result
holds under any monetary policy rule and applies to all aggregate prices and quantities. This
concludes our proof.

Proof to first-order for general  ,  such that (1 - )  +  = 2 - . We proceed in two steps. First we
prove a helpful lemma.
Lemma 1. For our heterogeneous-agent model with  = 1, we have that

                                         Mr = - ( I - M ) U                                  (A.76)

Proof to lemma 1. This result is the differential version of (A.69). To see this, construct, for any
given path {rt } a path of real income {Yt } defined recursively by

                                                    1 + rss
                                             Yt =           Y t +1
                                                    1 + rt
To first order, this equation implies that

                                                 dY = -Udr                                   (A.77)

where
                                                    1 1 1 ···
                                                                       
                                                    0 1 1 ···          
                                       U                                                     (A.78)
                                                                       
                                                    0 0 1 ···          
                                                    . . . ..
                                                                       
                                                    .
                                                    . .
                                                      . .
                                                        .    .
Now we linearize (A.69). We find

                                      d C = Mr d r + M d Y = d Y

Substituting dY with (A.77), this can be restated as

                                       Mr dr - MUdr = -Udr

As this holds for an arbitrary path dr, we find

                                             Mr - MU = -U

which is equivalent to (A.76).




                                                    A-21
   We use lemma 1 to restate the generalized Keynesian cross (38), now with arbitrary  ,  as

                                
                        dY =       + 1 -  d Q - M d Q + (1 -  ) M d Y                       (A.79)
                               1-

where dQ continues to be given by (A.63) as the implied real exchange rate response to the mon-
etary policy shock. Solving (A.79) as in section B.2, we find

                                dY = dY RA + G ( - (2 - )) dQ

Following the same steps as in section B.3, this allows us to sign the magnitude of the output
response relative to the RA solution. For example, in response to monetary easing, inducing an
exchange rate depreciation dQ  0, a value  < 2 -  results in an output response dY that lies
below the RA model's output response.


B.6    Proof of proposition 7
Proof. Linearizing (22) around the steady state (when t > 0), we obtain

                                dnfat = (1 + rss )dnfat-1 + dNXt

Iterating forward, this implies that for any t  0,
                                                
                                   dnfat =      (1 + rss )-s dNXt+s
                                               s =1

Substituting equation (34) for dNXt , this becomes

                                                                       
                        
             dnfat =
                       1-
                          (  - 1)        (1 + rss )-s dQt+s       -    (1 + rss )-s dCt+s
                                        s =1                          s =1

In the case where dQt+s = 0 for all s  1, this simplifies to
                                     
                                                              1
                                      (1 + rss )-s dCt+s =  dnfat                           (A.80)
                                    s =1

the desired expression for the present value of remaining consumption in terms of the NFA.
    For all t + s where dQt+s = 0, we have dYt+s = (1 - )dCt+s , and therefore from (A.80) we get
                                  
                                                             1-
                                  (1 + rss )-s dYt+s =        
                                                                dnfat
                                 s =1




Proof. We also prove the statement here that the present value of the output response to monetary
policy is negative whenever  < 1 - . To do so, consider equation (A.79) and take present values
on both sides. Since M preserves present values, we find

                                 
                   PV (dY) =        + 1 -  - 1 PV (dQ) + (1 - ) PV (dY)
                                1-


                                                      A-22
and, simplifying,
                                               - (1 -  )
                                     PV (dY) =            PV (dQ)
                                                 1-
This shows that the present value is negative, due to "stealing demand from the future", whenever
 < 1 - .


B.7    Representative-agent incomplete-market (RA-IM) model
The RA-IM model is a special case of the derivations in appendices B.2­B.5, with specific M and
Mr . To derive the two matrices in this case, note first that a representative agent spends any
marginal increase in the present value of its income stream by increasing consumption equally in
all periods. That is, the Jacobians of consumption with respect to labor income CY and ex-post
returns Cv are given by

                        1 -  (1 -  )  (1 -  ) 2 · · ·                      1-
                                                                                 
                     1 -  (1 -  )  (1 -  ) 2 · · ·                       1- 
              CY =  1 -  ( 1 -  )  ( 1 -  )  2 · · ·            Cv = A  1 -   .
                                                                                 
                          .        .           .      ..                     .
                                                                                 
                          .
                          .        .
                                   .           .
                                               .         .                   .
                                                                             .
                                                       D                   1
Since total steady state wealth is given by A =        r   and Jd =        A   1  2 · · · , we have that

                                                   C v J d = CY

and therefore that
                                          M = CY = (1 - ) · 1q

where we use q =     (1 + r ) - t         = t   t 0
                                                      as in appendix B.2. Observe that q 1 = (1 - )-1 ,
                                    t 0
which is why M is idempotent in the RA-IM model, that is, M2 = M. From (A.64), we can then
explicitly compute
                                                  1-
                                          G = I+        M
                                                   
   To derive the matrix Mr , observe that by the Euler equation (24), the consumption response to
small interest rate changes drt is given by

                                                           1          drs
                                          dCt = dC -
                                                                1+r
                                                               st

where, due to a zero NFA, the consumption response at infinity dC is pinned down by the re-
quirement that the present value of dCt adds to 0, and so
                                                
                                                                  1         drs
                                     dC =     (1 -  )  s   1 + r
                                             s =0                     st

In matrix notation, we can then write
                                                      1
                                          dC = -        (I - M) U dr
                                                      
                                                          Mr



                                                      A-23
where U is given by (A.78) as before. When  = 1, this is a special case of (A.76).
  The solution (A.65) to the international Keynesian cross is then given by

                                      1                
                    d Y = - (1 -  )     (I - M) Udr +     d Q + (  - 1) M d Q                  (A.81)
                                                      1-

Exchange rate shocks. Directly from (A.81), we obtain the following two results without mon-
etary policy shocks, drt = 0. First, when  = 1, the output response reduces to the RA solution
(28). This is an incarnation of our general neutrality result in proposition 4. When  = 1, the
RA-IM model has a non-trivial consumption response

                        (1 - ) dC = ( - 1) MdQ = (1 - ) ( - 1) 1q dQ

which accounts for the difference to our benchmark RA-CM model.
   Second, when dQt is decreasing towards zero, with AR(1) persistence   (0, 1), the entire
output response dYt is negative whenever

                                                      1
                                       < (1 -  )          1- 
                                                                 
                                                   1 +  1- 

This is a special case of proposition 5. The threshold  lies below 1 - , potentially by a lot given
that standard quarterly calibrations for  are in the neighborhood of 0.85, while calibrations for 
are in the neighborhood of 0.99. For our baseline calibration,

                                        0.14 · (1 - ) = 0.057

This implies that contractionary depreciations are much less likely to be obtained in a RA-IM
model than in a HA model.

                                                                                                 drs
Monetary policy shocks. When there are only monetary policy shocks, i.e. dQt = - st              1+r ,
the solution simplifies to

         1       1                                        1                                1
 dY =      dQ +               ( - (2 - )) + (1 - )2         -1      d Q +  - 1 - (1 -  )       MdQ
        1-      1-                                                                         

which immediately shows that, if  = 1 and  = 2 - , the solution collapses to the RA-CM
model's solution, in line with our general result in proposition 6. More generally, neutrality is
achieved if  = 1 + 1- .
                       



B.8     Two agent complete-markets (TA) model
Here we analytically derive the solution to the two-agent complete-market model, and show how
it fits into the general framework of the paper with a particular diagonal M matrix.
     We start from equation (A.57), which holds in any model. To obtain dCt , observe that from
(A.53), we have
                                                1 u      drs
                                          t = - css 
                                        dcu                                              (A.82)
                                                 st 1 + r




                                               A-24
From (A.54), we find that

                                  Wt             1         PHt           1            
                       dcc
                         t = d       Nt     =      d           Yt    =           -      dQt + dYt                (A.83)
                                  Pt             µ          Pt           µ           1-

where we have used (A.56). This implies

                                                 1          drs                   
                         dCt = - 1 -
                                            µ         1+r + µ                -
                                                                                 1-
                                                                                    dQt + dYt
                                                     st

Substituting dCt into (A.57), we arrive at

                                        1        drs                                                  
          dYt = - (1 - ) 1 -
                                    µ        1 + r + 1 -  dQt -  µ dQt + (1 - ) µ dYt                            (A.84)
                                            st

Solving (A.84) for dYt , we find that

                                 (1 -  ) 1 -     
                                                 µ     1       drs        - (1 -  ) µ
                                                                                       
                      dYt = -                                       +                    dQt                     (A.85)
                                  1 - (1 -  ) µ
                                                           st 1 + r   1 -  1 - (1 -  ) µ


Here, the factor 1/ 1 - (1 - )   µ is the Keynesian multiplier that hand-to-mouth agents induce,
see Bilbiie (2020) and Auclert, Rognlie and Straub (2018) for similar multipliers in the context of
fiscal policy. We now use equation (A.85) to derive analytically the response of the two agent
model to exchange rate shocks and monetary policy shocks.

Exchange rate shocks.        For exchange rate shocks, drt = 0. Equation ((A.84)) is then a special
case of equation (32), with M =   µ I. Hence, proposition (2) holds with that M matrix. Comparing
(33) with (A.85), we see that Proposition (3) also holds (here, M > 0 iff  > 0).
    Moreover, observe from (A.85) that, when  = 1, the value of /µ is irrelevant: the fraction
 - (1-  ) 
1- (1-  ) 
          µ
              collapses to 1, and we obtain the RA solution dYt =                       1- dQt
                                                                                         
                                                                                                 for any /µ. The cross-
          µ
partial with respect to  and /µ is positive, implying that for  > 1, the TA model's output
response lies above the RA model's, while the opposite is true for  < 1. Hence, Proposition 4
holds.
    Finally, in response to a depreciation dQt  0, the entire output response dYt is negative for
                                                                                         47
values of  below (1 - )     µ . This shows that Proposition 5 holds, with  = (1 -  ) µ .
    We illustrate both of these results in figure A.1. We choose /µ = 0.384 to match the quarterly
MPC of our baseline model. The red dash-dotted line with  = 1 illustrates the neutrality result:
the output responses are identical across the TA and HA models. For lower values of , the TA
model also generates a contraction, albeit a significantly more modest one than the HA model.
The intuition for this is that M =    µ I and hence misses all the off-diagonal entries that populate
the intertemporal MPC matrix of the HA model.
  47 Note that the result in proposition 5 on the present value turning negative for  < 1 -  does not carry
over to the TA model, due to the presence of complete markets between unconstrained agents and the rest
of the world.




                                                            A-25
                                             Figure A.1: Output effect of exchange rate shocks by 

                                                     TA model                                                       HA model
                                                                      =1                                                             =1
                              0.6                                                    0.6
                                                                       = 0.5                                                          = 0.5
                                                                       = 0.1                                                          = 0.1

                              0.4                                                    0.4
        dY (percent of ss)




                              0.2                                                    0.2



                              0.0                                                    0.0



                             -0.2                                                   -0.2


                                    0    5      10      15       20   25       30          0           5       10      15       20   25       30
                                                      Quarters                                                       Quarters


Note: impulse response in the TA and HA models to the shock to it   displayed in Figure 1. The share of
constrained agents in the TA model  is calibrated to match the quarterly MPC of the HA model.


Monetary policy shocks.            With  = 1, but allowing for monetary policy shocks, equation
(A.84) is a special case of (38), with M = µ I and

                                                                                                           
                                                         Mr = - ( I - M ) U = - 1 -                            U                                   (A.86)
                                                                                                           µ

where U is defined in (A.78) the triangular matrix with 1's above and on the diagonal, and zeros
elsewhere. Observe that (A.86) is a special case of our general result in (A.76).
    When there are only monetary policy shocks, i.e. dQt = - st 1dr    +r , the solution simplifies to
                                                                        s




                                                        ( - (2 - )) + (1 - )2                      1
                                                                                                                         
                                         1                                                             -1      1-    
               dYt = -                      1+
                                                                                                                     µ
                                                                                                                           drs                     (A.87)
                                        1-                                 1 - (1 -  )         
                                                                                               µ                          st 1 + r


When  = 1 and  = 2 - , the big fraction collapses to 0, and we obtain the RA model's output
response, irrespective of /µ. This is a special case of the neutrality result in proposition 6. The
cross-partial with respect to  and /µ is positive again (for accommodative monetary policy
shocks), so that for  > 2 - , the TA model's output response lies above the RA model's, in line
with our general result in proposition 6.
     We can also say what happens for  = 1 in (A.87). When  = 2 - , and  > 1, the neutrality
result fails in that the output response rises in the income share of constrained agents /µ. The
opposite holds for  < 1. One can also derive a -dependent neutrality threshold, for which dYt
is independent of /µ, namely
                                                          1
                                           = 1 + (1 -  )
                                                          
In the special case of  = 1, this collapses to  = 2 - .




                                                                             A-26
B.9        Taylor rules
In this section, we explore how the HA and RA models respond to shocks when the central bank
follows a Taylor rule, as in (20), rather than the real interest rate rule (19). We first revisit the neu-
trality results for exchange rate depreciations and monetary policy, and then consider the response
to productivity shocks as well.
    Exchange rate depreciations. A depreciation dQt  0, dit    0, affects the demand for home goods

and thus PPI inflation  Ht = wt through the Phillips curve (18). CPI inflation is then determined
by
                                                  
                                    t =  Ht +         (dQt - dQt-1 )                                (A.88)
                                                1-
and the real interest rate path by
                                                               
                        drt = dit - t+1 =  Ht -  Ht+1 -          (dQt+1 - dQt )                    (A.89)
                                                              1-
As the Phillips curve involves endogenous variables, that themselves depend on drt , this situation
is significantly less tractable than the case with a fixed real interest rate. Still, we can make progress
by focusing on AR(1) shocks to it     , with some fixed persistence   (0, 1). We show below that, in

this case, there still exists a threshold value for ,

                                1 +                                   w ( - )
                    = 1-                  (1 - , 1) ,                            >0
                             1 +  (  + )                           (1 - ) (1 - )

for which the responses of all aggregate variables, such as output, employment, and consumption
are independent of M, and hence the same for the RA and the HA model.48
    Monetary policy shocks. The path of real rates is now no longer just a function of the path of
monetary policy shocks t ; it also depends on the response of inflation, and thereby also on the
endogenous response of aggregate variables. However, the international Keynesian cross (38) still
holds, and thus, for  = 2 - , the response of aggregates to the shock is still independent of M
conditional on a given real interest rate path. This is why our neutrality result for monetary policy
goes through unchanged for the Taylor rule (20).
    Productivity shocks. The exact same logic applies to the case of productivity shocks Zt . Those
shocks affect home prices according to PHt = µWt / Zt . This causes shifts in wage inflation via the
Phillips curve (18) and thus shifts in real interest rates via (A.89). Since the responses in RA and
HA models to changes in real interest rates are still identical when  = 2 - , the responses to
productivity shocks in both models are also identical for this choice of .

Proof of the result on exchange rate depreciations with a Taylor rule. We focus on AR(1)
shocks here, such that dQt = dQt-1 for some   (0, 1). The output response with a Taylor rule
is determined by the following system of equations. The first is the international Keynesian cross
(38),
                                                    
                d Y = - (1 -  ) ( I - M ) U d r +       d Q -  M d Q + (1 -  ) M d Y            (A.90)
                                                   1-
simplified using (A.76). The second is the Phillips curve for wage inflation (18), in linearized terms
given by
                                wt = w ( dNt + dCt ) + wt+1                                     (A.91)
  48 The   response is also the same in the incomplete markets RA and the TA model.



                                                   A-27
The third is the determination of the real interest rate through the Taylor rule (A.89),
                                                                
                      drt = dit - t+1 = wt - wt+1 -               (dQt+1 - dQt )                (A.92)
                                                               1-
and the forth is the determination of the real exchange rate as
                                                          - dr
                                                       dis     s
                                            dQt =    1+r                                        (A.93)
                                                    st

    We guess and verify that all variables are exponentially decaying with the same persistence .
In this case,
                                             dr = k · di
                         dr0
with an unknown k =        .
                         di0   From (A.93), we then get that

                                            1             k -1 - 1
                                    dQ =      (di - dr) =          dr                           (A.94)
                                           1-               1-

So we can rewrite (A.90) as

                                k                                   k
     dY =            - (1 -  )             d Q - M  - (1 -  )             d Q + (1 -  ) M d Y   (A.95)
                  1-           1-k                                 1-k

Rearranging,
                                                                                      k
                                   k                                       - (1 -  ) 1- k
          dY -          - (1 -  )              d Q = (1 -  ) M     dY -                   dQ
                     1-           1-k                                         1-

we see that the solution is independent of M precisely if and only if
                                                                  k
                                                 k     - (1 -  ) 1- k
                                      - (1 -  )     =
                                   1-           1-k       1-
which is equivalent to
                                                    k
                                            = 1 - (1 -  )
                                                   1-k
For k = 0, we recover neutrality at  = 1. For k  , the monetary response dominates the
output response, so the threshold converges to   2 - . In case the neutrality result holds, the
output response is given by
                                                  k
                                   dY =        -      dQ
                                          1- 1-k
Given the linear production function, this is equivalent to the employment response, dN = dY.
The aggregate consumption response is

                                                       k
                                             dC = -       dQ
                                                      1-k




                                                    A-28
    Substituting these formulas into the linearized wage Phillips curve (A.91), we find that

                    1                      1                               k                   k
        wt =          w ( dNt + dCt ) =      w                           -               -                 dQt
                 1 -                    1 -                            1- 1-k                 1-k

and therefore that
                         -                            k                k           
             drt =           w                      -             -           +      (1 - ) dQt
                        1 -                       1- 1-k              1-k         1-

Comparing this with (A.94), we find an equation for k /(1 - k),

                        k     -                              k                 k          
            (1 -  )        =      w                        -              -          +      (1 -  )
                       1-k   1 -                         1- 1-k               1-k        1-

We solve this equation for k /(1 - k )

                               -                          k     -          
                1-+                w (  + )                  =      w    +   (1 -  )
                              1 -                        1-k   1 -     1- 1-

                                -                          k                         -
                   1-+              w (  + )                  =             1-+          w 
                               1 -                        1-k   1-                  1 - 
                                                                    (-)
                                       k            1 + (1-w
                                                           )(1- )
                                                                  
                                          =     ·
                                      1-k   1 -  1 + w (-) (  +  )
                                                     (1-)(1- )

Note that the solution lies in k  (0, ). The neutrality threshold is then given by
                                                            w (-)
                                                    1+    (1-)(1- )
                                                                    
                                 = 1-                    w (-)
                                                                           (1 - , 1)
                                                  1+   (1-)(1- ) (
                                                                    + )


C     Quantitative model details
C.1    Non-homothetic demand
The Bellman equation (1) that incorporates the preferences in (39) reads

                                                                                     (  -1) /   / (  -1)
          Vt ( a, e)     =       max u            1/ (c F - c)( -1)/ + (1 - )1/ c H
                                c F ,c H , a
                                     -v ( Nt ) + Et Vt+1 a , e
                                PFt      PHt                 p      Wt
                       s.t.         cF +      c H + a = 1 + rt a + e Nt
                                 Pt       Pt                        Pt
                                a a




                                                           A-29
Notice that, by relabeling c F  c F - c, this is equivalent to

                                                                                              (  -1) /   / (  -1)
            Vt ( a, e)       =         max u             1/ (c F )( -1)/ + (1 - )1/ c H
                                      c F ,c H , a
                                           -v ( Nt ) + Et Vt+1 a , e
                                      PFt      PHt                 p      Wt    PFt
                         s.t.             cF +      c H + a = 1 + rt a + e Nt -     c
                                       Pt       Pt                        Pt    Pt
                                      a a

                                                                 (  -1) /   / (  -1)
or, defining c = 1/ (c F )( -1)/ + (1 - )1/ c H                                        , as simply

                         Vt ( a, e)           =        max u (c) - v ( Nt ) + Et Vt+1 a , e
                                                        c, a
                                                                        p         Wt      PFt
                                          s.t.         c + a = 1 + rt a + e          Nt -     c
                                                                                  Pt      Pt
                                                       a a

where Pt is the standard CES price index (3). Hence, this is the standard consumption-saving
problem, only with a modified income process that subtracts - P        Pt c to real income in every state
                                                                        Ft

of the world. The policy functions ct ( a, e), at+1 ( a, e) for this problem, as well as the aggregates
CF and At+1 of policies integrated against the time varying distribution, can be obtained from the
                         p              PFt
sequence of inputs rt , W
                        Pt Nt ,
                          t
                                        Pt c         using standard tools. Since every agent's policy for c Ft ( a, e) =
c + c Ft ( a, e) , it follows that aggregate spending on foreign goods is simply

                                                     CFt = c + CFt
                                                                              -
                                                                        PFt
                                                               = c+               Ct                                (A.96)
                                                                        Pt

while aggregate spending on domestic goods is
                                                                              -
                                                                        PHt
                                                     CHt = (1 - )                 Ct                                (A.97)
                                                                         Pt

Note that equations (A.96) and (A.97) only require the standard CES prices index Pt , which is the
price index of an infinitely wealthy agent, and does not require the ideal price indices for agents
at different points in the distribution ( a, e).


C.2    Delayed substitution model
We introduce delayed substitution as a modification of the household side of the model, both
in the domestic economy and in the rest of the world. The basic idea is to assume that each
household has only an iid probability 1 -  in each period of being able to adjust the composition
of its consumption bundle x. With probability  , the household is required to keep the same
consumption bundle x, and consume each good in proportion to it, i.e. ck = xk c, where xk is the
amount of k in the consumption bundle and c is total consumption.
    First we work out the analytics, in a general static problem where consumption is some constant-
returns-to-scale aggregate of many goods, of the optimal bundle given the prices of each good.


                                                                 A-30
Then we show how this can problem be embedded in the dynamic incomplete markets problem
that the households in our model solve, and work out the first-order equations characterizing
household behavior. Finally, we specialize the consumption side to the nested CES of home and
foreign goods in our model, and derive the consequences.

Static problem: the optimal bundle in terms of prices. Suppose that a household has
preferences that aggregate consumption goods using some constant-returns-to-scale aggregator F

                                                c = F ( c1 , . . . , c K )                          (A.98)

We define a bundle { xk } as anything that gives a total consumption of one

                                               1 = F ( x1 , . . . , x K )                           (A.99)

and say that the price index P({ xk }, { Pk }) corresponding to this bundle is just its cost:

                                            P({ xk }, { Pk }) =      Pk xk                         (A.100)
                                                                     k

The cost of the bundle that minimizes (A.100) subject to (A.99) is the ordinary price index P.
   Consider the optimal bundle { x ^ k } given some prices { Pk }, i.e. the solution to the problem of
minimizing price (A.100) subject to (A.99). The Lagrangian is

                                        Pk x
                                           ^k -  ( F(x
                                                     ^1 , . . . , x
                                                                  ^ K ) - 1)
                                        k

and first-order conditions are
                                                      Pk =  Fk                                     (A.101)
(Note that since F is constant-returns-to-scale, the marginal cost  equals the conventional price
index P.)
   Log-differentiating gives

                                    d log Pk = d log  + d log Fk
                                                            F x ^
                                             = d log  +  kk k d log x
                                                                    ^k                             (A.102)
                                                         k
                                                              Fk

                                      ^1 , . . . , x
Log-differentiating the condition F ( x            ^ k ) = 1 gives

                                                       ^k
                                                    Fk x
                                                     F
                                                                ^k = 0
                                                          d log x                                  (A.103)
                                                k
                         ^k
                     Fkk x
We note that k         Fk                                                          ^ k does not change
                              = 0 by Euler's identity: a proportional shift in all x
                                                                             F   ^
                                                                                 x
any partial derivatives. This means that the matrix F  [ kkFk k ]kk has a null vector of ones. By
the envelope theorem, we also know that d = k dPk x         ^ k , or that d log  = k k d log Pk , where
k  Pk x^ k / P is the share of good k in the bundle. So then we need to find the solution x^ to

                                             ^ = d log P - ( d log P)1
                                      Fd log x                                                     (A.104)
                                        ^k
                                     Fk x
such that (A.103) holds, i.e. k               ^k
                                      F d log x                                        ^ to (A.104), we can
                                                    = 0. Given one such solution d log x


                                                        A-31
find exactly one that satisfies (A.103), since 1 is in the null-space of F.49 Let us denote the linear
map from d log P to this solution d log x^ by the matrix G:

                                                         ^ = Gd log P
                                                   d log x                                             (A.105)

Incomplete markets dynamic problem. Now consider a household who is solving a gen-
eralization of the standard incomplete markets problem in (1), where consumption within each
period t is given by an aggregator (A.98) of goods with prices Pt = { Pkt }. We assume that the
household picks a bundle x  { xk } of goods giving an aggregate of 1 as in (A.99), and must con-
sume in proportion to that bundle until it receives a Calvo option to reset the bundle, which has
probability 1 -  in each period. (Since the bundle has aggregate value 1, consumption of each
good in each period is given by cikt = xk cit .)
    The value function given an inherited x at date t is then

                              Pt
Vt ( a, e, x) = max U E · ¯                       +  Et Vt+1 a , e , x      +  (1 -  ) E max Vt+1 a , e , x
                E, a      P ( x, P t )                                                          x
                                     p         Wt
                  E + a = 1 + rt          a + e Nt                                                     (A.106)
                                               Pt
                  a a

where the choice is made over expenditure in real units deflated at the ordinary price index Pt , but
consumption may be less because the actual cost of consumption at the fixed bundle x is P  ¯ ( x, P t ).
   Note that the envelope condition for x, which appears only in the objective (A.106), is

                    Vt ( a, e, x)                       ¯ ( x, P t )
                                                    log P                       Vt+1 ( a , e , x)
                                  = -U ( c t ) c t                   +  Et
                        x                               x                            x
                                                                  Vt+1 ( a , e , x)
                                  = -U (ct )ct Pt +  Et                                                (A.107)
                                                                       x
                      ¯ ( x,P )
                  log P
where we use        x
                          t
                            = Pt from (A.100) to simplify and denote real consumption, i.e. the
aggregate in (A.98), by ct . Recursively expanding this out and subsuming the states a and e into
the subscript i  ( a, e), we get
                                                     
                                  Vit (xit )
                                             = Eit  (  )s U (cit+s )cit+s Pt+s                         (A.108)
                                    x              s =0

Now suppose that we are maximizing over feasible x      ^ it , i.e. solving the problem which has La-
grangian
                                             ^1 , . . . , x
                                  ^ ) -  ( F(x
                             Vit (x                        ^ K ) - 1)                         (A.109)
                                                           ^ . The first-order condition with respect
where for simplicity we suppress the i and t subscripts on x
        ^ k is
to each x
                                           
                                    Eit    (  )s U (cit+s )cit+s Pk,t+s =  Fk                          (A.110)
                                          s =0

  49 In                                       F   ^
                                                  x
      more detail: assuming that F  [ kkF k ]kk otherwise has full rank, i.e. its rank is K - 1, then we note
                                              k
that  F = 0, so that the range of F is the space orthogonal to . The right side of (A.104) is always orthogonal
to . There is therefore always a one-dimensional space of solutions to (A.104), with the difference between
any two solutions given by a multiple of 1, and exactly one of these solutions will satisfy (A.103) as well.

                                                         A-32
                                                                                                                             -1
In an aggregate steady state, with constant prices Pk,t+s = Pk , this simplifies to Pk = (Eit         s
                                                                                              s=0 (  ) U ( cit+s ) cit+s )
which is the same as the static first-order condition (A.101) but with an extra factor rescaling .
The constraint (A.99) is also the same as in the static problem. Therefore the steady-state solution
is the same (with a bundle independent of i), and while  equaled the conventional price index P
in the static problem, it now equals P times an extra factor:

                                                         
                                               P Eit     (  )s U (cit+s )cit+s        =                            (A.111)
                                                       s =0

                                                                             ^ . We get
Now consider linearizing (A.110) around the steady-state prices P and bundle x
                                                      
 Pk Eit    (  )s d(U (cit+s )cit+s ) + Eit  (  )s U (cit+s )cit+s dPk,t+s =  Fk (d log  + d log Fk )               (A.112)
          s =0                                       s =0

                            ^ k = 0 and k Pk x
and then, noting that k dFk x                ^ k = P, we can sum this weighted by x
                                                                                  ^ k to obtain
                                                             
      PEit        (  )s d(U (cit+s )cit+s ) + Eit  (  )s U (cit+s )cit+s  x
                                                                          ^ k dPk,t+s = d log                      (A.113)
                 s =0                                       s =0                       k

Now, if we multiply both sides of (A.113) by Fk , use Pk = PFk , and subtract it from (A.112), the
first term on both sides cancels and we get

                                  
                          Eit      (  )s U (cit+s )cit+s      dPk,t+s - Fk  x
                                                                            ^ k dPk ,t+s     =  Fk d log Fk
                                s =0                                           k

Now, divide both sides by Pk = PFk , we we get

                               
                                                                                                     
                        Eit    (  )s U (cit+s )cit+s        d log Pk,t+s -  k d log Pk ,t+s      =
                                                                                                     P
                                                                                                       d log Fk
                              s =0                                            k

and finally, using (A.111), we get

                                       Eit         s
                                           s=0 (  ) U ( cit+s ) cit+s ( d log Pk,t+s - k k d log Pk ,t+s )
                        d log Fk =
                                                      Eit                s
                                                              s=0 (  ) U ( cit+s ) cit+s

                                                                       ^k
                                                                   Fkk x
for each k, which in vector form (using F  [                         Fk ]kk   from the static problem) can be stacked as

                                            Eit         s
                                                s=0 (  ) U ( cit+s ) cit+s ( d log Pt - (  d log Pt ) 1 )
                                      ^=
                               Fd log x                                                                            (A.114)
                                                        Eit              s
                                                              s=0 (  ) U ( cit+s ) cit+s

                                                                       ^k
The solution x ^ is whatever satisfies (A.114) and also satisfies k FkFx
                                                                          d log x ^ k = 0.
    In the static problem, we obtained the matrix G that mapped d log P to d log x         ^ in order to solve
                                                                              ^k
Fd log x^ = d log P - ( d log P)1, subject to the same condition k FkF       x
                                                                                       ^ k = 0, for a single
                                                                                 d log x
change in log prices dlog P. Using linearity, we can combine this with (A.114) and move G inside




                                                                    A-33
the numerator to obtain
                                       Eit         s
                                           s=0 (  ) U ( cit+s ) cit+s G d log Pt
                                  ^ it =
                            d log x              
                                           Eit s=0 (  )s U (cit+s )cit+s
                                       Eit         s                          ^ static
                                           s=0 (  ) U ( cit+s ) cit+s · d log x t+s
                                     =                                                                   (A.115)
                                            Eit s=0 (  )s U (cit+s )cit+s

where we define d log x ^ static
                          t+s = G d log Pt+s to be the statically optimal bundle given prices at time
t + s, ignoring the adjustment friction, and restore the explicit i and t subscripts.
    (A.115) is our primary result: the log change around the aggregate steady state in optimum
bundle for individual i at time t, given the adjustment friction, is a weighted average of the log
change around the aggregate steady state in future static optimum bundles, with the weight on
each future date t + s being (  )s U (cit+s )cit+s .

Special cases (representative agent and log preferences). (A.115) is somewhat complex,
but there are two special cases where it simplifies dramatically. First, if there is a representative
agent, then in the aggregate steady state, consumption cit+s in (A.115) is constant over time. Sec-
ond, if U (c) = log c, then U (c)c = 1. In both cases, (A.115) collapses to just
                                                            
                                       ^ t = (1 -  )Et
                                 d log x                    (  )s d log x
                                                                        ^ static
                                                                          t+s                            (A.116)
                                                           s =0

These correspond to the cases we will consider in this paper: log preferences for the heterogeneous
agents in the domestic economy, and a representative agent in foreign economies. Note that even
in the former case, the i subscripts now disappear: all agents want to set the same bundle.50

Evolution of aggregate bundle. Note that in (A.106), the bundle x only enters the problem in
¯ (x, Pt ), which is second-order in x around the steady-state optimum. Heterogeneity in x therefore
P
has a second-order impact on total consumption cit+s of each individual.
   Disregarding these second-order terms, in period t, aggregate consumption of good k is

                                                                          
                  Ckt =        (1 -  )   s x
                                           ^ kt-s cit    di =     (1 -  )   s x
                                                                              ^ kt-s      cit di
                                        s =0                             s =0
                                     
                       =    (1 -  )   s x
                                        ^ kt-s     Ct
                                    s =0

                                     xkt

where di denotes aggregation over the idiosyncratic state space i = (s, a) (using the distribution
of agents from the aggregate steady state). For each i, the mass (1 -  ) s of agents whose bundle
were last updated in period t - s consume x    ^ kt-s cit of good k. Aggregating over all s, factoring out,
and defining xkt     s =0  sx
                            ^ kt-s to be the "average"     bundle at date t, we have simply Ckt = xkt Ct .
  50 In  the general case, without the simplification (A.116), for each agent type i in the state space,
Eit (  )s U (cit+s )cit+s can be calculated recursively for increasing s using the law of iterated expectations.
With this, we can implement (A.115) and can calculate how, for each i, d log x       ^ it depends on the path of
^ static
x t+s . (Note that this only depends on i and s, not on t, due to translation invariance.) Similar tricks are
needed to aggregate below into an effective average bundle d log xt at each date, since the choice of d log x ^ it
is no longer independent of expected consumption cit+s .

                                                        A-34
    In log deviations from steady state, we have d log Ckt - d log Ct = d log xkt , where stacking and
log-linearizing the definition of xt immediately yields
                                                                      
                                        d log xt = (1 -  )   s d log x
                                                                     ^ kt-s                                               (A.117)
                                                                  s =0


Summarizing the system. We can rewrite (A.116) and (A.117) in AR(1) form as

                                                        ^ static
                                     ^ t = (1 -  )d log x
                               d log x                    t      +  Et d log x
                                                                             ^ t +1                                       (A.118)
                                                       ^ t +  d log xt-1
                               d log xt = (1 -  )d log x                                                                  (A.119)

After calculating the statically optimal bundles d log x ^ static
                                                           t      , one can iterate backward on (A.118) to
                 ^ t , and then iterate forward on (A.119) to obtain all d log xt .
obtain all d log x

Application to our nested CES case. Suppose that the consumption aggregator function F
takes the form

                                                          (  -1) /                                             / (  -1)
           F (c H , c F1 , . . . , c Fn ) = (1 - )1/ c H              + 1/ c F (c F1 , . . . , c Fn )( -1)/

where
                                                                                      / (  -1)
                                                                 1 n (  -1) / 
                                                                 n i
                                 c F (c F1 , . . . , c Fn ) =          c Fi
                                                                    =1
                                                                  1
and the steady-state prices are assumed to be PH = 1 and PFi = n    for all i.
     It follows directly from standard CES demand that the statically optimal quantities in a bundle
(i.e. the most efficient way to achieve a value F = 1) obey

                                       ^ static
                                 d log x H      = - d log( PH / P)                                                        (A.120)
                                       ^ static
                                 d log x F      = - d log( PF / P)                                                        (A.121)
                                       ^ static
                                 d log x Fi       =          ^ static
                                                       d log x F         - d log( PFi / PF )                              (A.122)
                   1
where d log PF = n    d log PFi and d log P = (1 - )d log PH + d log PF are the standard price
indices. We interpret the limit n   as the case in this paper, with a continuum of foreign
countries.
   Specializing to the two sources of demand for home country goods in our paper, we can com-
bine (A.120) and (A.118) to obtain

                                ^ Ht = -(1 -  ) d log( PHt / Pt ) +  d log x
                          d log x                                          ^ Ht+1                                         (A.123)

and, looking from the perspective of a foreign country demanding the home good (which to it is
one of a continuum of home goods), we can combine (A.122) and (A.118), and use the fact that
there are no aggregate shocks affecting foreign countries (so that the first term on the right in
(A.122) is zero) to obtain

                                ^
                          d log x                                            ^
                                  Ht = - (1 -  )  d log( PHt / Et ) +  d log x Ht+1                                       (A.124)

Both also satisfy (A.119), i.e. d log x Ht = (1 -  )d log x ^ Ht +  d log x Ht-1 and d log x Ht = (1 -
        ^                                                          
 )d log x Ht +  d log x Ht-1 , where CHt = x Ht Ct and CHt = x Ht Ct .

                                                                A-35
    Note that one feature of this model is that the elasticities are not just time-dependent, but also
shock-dependent: d log x  ^ Ht and d log x^Ht are forward-looking, and they are therefore of greater
                                         PHt
magnitude when the shocks to d log Pt and d log P      Et are more persistent. This leads to a greater
                                                       Ht

                                   
response of d log x Ht and d log x Ht to persistent shocks, and it can explain, for instance, why per-
manent tariff changes can have different effects on export volumes than shocks to exchange rates
due to capital flows, as estimated in Fitzgerald and Haller (2018) and Cavallo, Gopinath, Neiman
and Tang (2021).


C.3    Calibrating openness and price pass-through
This appendix provides data from a representative set of countries that experienced a large depre-
ciation. This includes Mexico, which we use as our main calibration target, as well as eight other
countries with a depreciation episode studied in Burstein and Gopinath (2015).

Calibrating .       We start by providing recent data on the import/GDP ratio from the IMF
International Financial Statistics in the top panel of Table A.1. The import-GDP ratio informs the
choice of  in our benchmark model, or of the aggregate C     C in our quantitative model with non-
                                                              F

homothetic demand. This justifies our calibration to  = 0.4 for Mexico.

Calibrating  F .    To calibrate price stickiness parameters, we use information from the country's
large devaluation episode to inform our choice of exchange rate pass-through. For this exercise,
we proceed as follows. We start from the equations describing the dynamics of import prices PFt
in response to an exchange rate change, (41). Note that this equation delivers price dynamics as
a pure function of the exchange rate path Et and parameters  F and r, independently of the rest
of the model. In particular, (41) implies that the linearized price dynamics of p Ft = log PFt in
response to an impulse to the exchange rate of et = log Et are
                                         1
                                   1-   1+r  F    (1 -  F )                     1
                 p Ft - p Ft-1 =                              (et - p Ft ) +       ( p Ft+1 - p Ft )   (A.125)
                                            F                                  1+r
We conceptualize the exchange rate depreciations experienced by each country in our case study
as a one-time permanent shock to the exchange rate, from its initial level of e-1 = 0 to et = e
for t  0. Though stylized, this provides a useful approximation to the behavior of the nominal
exchange rate in these episodes (see e.g. Burstein, Eichenbaum and Rebelo 2005, figure 1). It is
easy to verify that the solution for p Ft under this particular path for et in (A.125) is:
                                                               t
                                                 p Ft = e 1 -  F                                       (A.126)

Equation (A.126) delivers a simple way to back out the Calvo price rigidity coefficient as a function
of the import price pass-through as of date t,
                                                                     1
                                                              p Ft   t
                                             F = 1 -                                                   (A.127)
                                                               e
To perform this calculation for each of our countries, we need a measure of the pass-through to
the retail price of imported goods, p Ft /e at some date t following the depreciation at t = 0. Burstein,
Eichenbaum and Rebelo (2005) (henceforth BER) measured pass-through at 24 months, corre-
sponding to t = 8, but only for dock prices, tradable retail prices and nontradable retail prices.


                                                      A-36
                             Mexico       Argentina       Brazil      Korea      Thailand       Finland       Sweden        Italy      UK

       Latest data             2019          2019          2019       2019          2019          2019          2019        2019      2019

    Imports/GDP                40%            15%           14%        37%          51%           40%           44%         29%       32%

   Depreciation year           1994          2001          1998       1997          1997          1992          1992        1992      1992

      Dock PT                 107%            87%          126%        60%          68%           116%          76%         63%       141%
  Tradable retail PT           82%            36%           36%        30%          28%            64%          29%         32%        22%
   Nontradable PT              30%             7%           11%        11%          25%            6%           14%         19%        41%

 Imported retail PT           122%            63%           52%        46%          28%           102%          34%         38%       -15%
    Implied  F                 0.00           0.78          0.91       0.93         0.96           0.00         0.95        0.94       1.00

           dY0                - 0.35         - 0.03         0.00      - 0.01        0.00          - 0.35        0.00       - 0.01     - 0.01
        7
        t=0 dYt               - 1.81         - 0.42        - 0.10     - 0.11        0.03          - 1.81       - 0.02      - 0.08      0.01

Notes: data on dock and retail pass-through are taken from Table 7.5 in Burstein and Gopinath (2015), using the ratio of the increase in
dock import prices and retail prices at 24 month to the trade weighted exchange rate at 24 month. Data on imports and international
investment position (assets, liabilities and NIP) are taken from the IMF International Financial Statistics. The bottom two rows replicate
the exercise of Table 2 for these countries.

Table A.1: Imported price pass-through, openness, and international positions for selected coun-
tries


We convert this information into a measure of the retail price of imported goods following BER's
framework. Specifically, we assume that (log) traded goods prices p Tt are made up of imported
goods prices and local goods, whose price is well proxied by the price of non-traded goods, so
that
                                    p Tt = (1 - ) p Ft +  p Nt                           (A.128)
Following BER, we assume  = 1/2, and use equation (A.128) to back out p Ft .51
     The bottom row of Table A.1 reports the result of this exercise. The first two rows report p Dt /e,
p Tt /e and p Nt /e for t = 8 quarters. The next row reports p Ft /e backed out from (A.128), and the
final row reports the implied quarterly  F from equation (A.127). As can be seen, the devaluations
suggest a lot of heterogeneity in imported price pass-through in each episode. In Mexico, this
procedures infers full price pass-through, given the large movements in tradable retail prices and
limited movement in nontradable prices. This is consistent with the large amount of price pass-
through observed at the dock in that episode. In other episodes tradable retail prices move a lot
less, so our procedure infers much more limited import price pass-through.

Calibrating w .       We also use information from Table A.1 to calibrate the wage stickiness pa-
rameter w . We use information from the time path of non-traded good prices, which in our
model correspond to p Ht , in order to discipline that parameter. Note that, in contrast to  F , which
is identified directly from the price pass-through data, w depends on the entire structure of the
model, and in particular on the relationship between monetary policy and domestic economic ac-
tivity. Moreover, the path of p Ht does not separately identify the stickiness of wages w and the
  51 We obtain similar results if we assume that the retail price of imported goods is a mix p Ft =
(1 - ) p Dt +  p Nt of dock prices and non-traded goods prices.


                                                                 A-37
                                                                                        Figure A.2: Calibrating w

                                                     Path of prices PHt                         Distance between model PHt and data                         Elasticity of asset prices to output
                           175                                                                                                                  0.15
                                           Nominal exchange rate E
                                           PHt with w = 0.95                            35
                           150                                                                                                                  0.10
                                           PHt with w = 0.66
                                                                                        30
                           125             PHt during Mexican 1994 devaluation                                                                  0.05
 Percent of steady state




                                                                                        25
                           100                                                                                                                  0.00

                                                                                        20
                            75                                                                                                                 -0.05
                                                                                        15
                            50                                                                                                                 -0.10
                                                                                        10
                            25                                                                                                                 -0.15
                                                                                         5
                             0                                                                                                                 -0.20
                                                                                         0
                           -25                                                                                                                 -0.25
                                 -2    0         2        4      6        8   10   12    0.65    0.70   0.75   0.80       0.85   0.90   0.95        0.65   0.70   0.75   0.80       0.85   0.90   0.95
                                                          Quarters                                                    w                                                         w


Note: The left panel shows the impulse response of home goods prices PHt following a permanent change in the nominal exchange
rate Et .The data is taken from Table 7.5 in Burstein and Gopinath (2015). The middle panel plots the sum of square distance between
model and data at t = 4 and t = 8, for different values of the calvo parameter w . The right panel shows the reduced-form elasticity
of the asset price to output, for different values of the Calvo parameter w .



stickiness of prices  H . We therefore follow the standard in the literature and set  H to imply a
price duration of 3 quarters. We then find w to match two features of the data. First, we look for
the best fit in terms of the path of prices in response to the pure devaluation shock as described
above. Second, we look for a coefficient that implies a reasonable degree of cyclicality of stock
prices in response to a monetary policy shock.
     Figure A.2 shows the outcome of that exercise. The left panel plots the path of prices PHt after
the devaluation in the model and in our data, the middle panel plots the sum of square distance
between model and data at t = 4 and t = 8, and the right panel plots the reduced-form elasticity of
asset prices induced by a contractionary shock to capital flows. When wages are relatively flexible
(w = 0.66), home goods prices initially go down in response to the devaluation shock, because
this shock induces a recession in the short run. This does not match the path of prices that we
observed in the Mexican devaluation. Our model infers that wages are stickier than this, in the
range of w = 0.85 or above. Second, at w = 0.85, stock prices are still countercyclical, going up
after a contractionary capital outflow. We pick w = 0.95 because it hits a tradeoff between making
asset prices roughly acyclical in response to capital flow shocks, and getting a path of prices p Ht
that lines up well with the data.
     We use the calibration in this section to consider the effect of depreciations in other countries
than our benchmark of Mexico, which featured high openness and full import pass-through. We
recalibrate our model to hit their import-GDP ratio and their degree of import price pass-through,
but keeping the MPCs the same. The bottom two rows of the table illustrates that the effects of the
same exchange rate shock are very heterogeneous across countries. Countries with lower import
price pass-through have much less of an immediate impact on output, since the real income effect
is really muted. Openness has a non-monotonic effect, since the immediate effect of an exchange
rate depreciation is not as large in an economy that is more closed, but the general equilibrium
effect of any open international position is much larger, through the logic of Proposition 7.


C.4                                   Currency mismatch in balance sheets
To incorporate currency mismatch in the net foreign asset position, we proceed as follows. We
expand the setting in section A.1 by allowing countries to invest in long-duration foreign currency

                                                                                                          A-38
assets, modeled as bonds with nominal coupons that exponentially decay at a rate , and a foreign
currency price of Qt , where  is calibrated to empirical duration data.


Investment through the mutual fund. We first assume that foreign currency exposures are
held through the mutual fund. Suppressing the choice of domestic nominal bonds and foreign
stocks for simplicity, the beginning-of-period valuation equation for the mutual fund (A.1) be-
comes
                              p                        H                       F
                         1 + it At-1 = ( Dt + pt ) Pt st -1 + E t (1 +  Q t )  t -1

where t F is the number of foreign-currency asset coupons held in period t, while the end-of

period valuation equation A.2 is
                                               H         F
                                   At = pt Pt st + Et Qt t

Optimal investment now requires, in addition to the equations in (A.4), that

                                                       1 + Q t +1
                                            1 + it   =                                         (A.129)
                                                          Qt

which gives the valuation equation for the foreign currency bond price Qt . The real value of
mutual fund assets (A.9) is now
                                                                                      F
                                                                                      t
                                p                          H                            -1
                          1 + r t A t - 1 = ( Dt + p t ) s t -1 + (1 + i t -1 ) Q t            (A.130)
                                                                                      P
In the steady state, this now reads
                               H                 F         H                 F
                    Ass = pss s- 1 + (1 +  Qss ) -1 = pss s-1 + (1 + iss ) Qss -1              (A.131)
                                                                                   fY

We continue to calibrate the steady state of the model so that nfa-1 = 0, and hence Ass = pss , but
now allow for a gross currency mismatch, where the country has a share f Y of foreign currency
assets in excess of foreign currency liabilities, relative to its GDP. Combining (A.131) with Ass =
pss , we have:
                                                            H
                                             f Y = pss 1 - s- 1

In other words, if f Y > 0, then the country has foreign currency assets that are offset by foreign di-
rect investment in the domestic stock market (s-   H < 1), while if f < 0, the country has borrowed
                                                    1                Y
in foreign currency and holds a levered position in its domestic stock market, s-  H > 1.
                                                                                     1
                                                                 
    After a depreciation induced by a change in the path of it for t  0, the country experiences
an adverse valuation effect to its liabilities. We use equation (A.129) to calculate the induced new
bond price Q0   (note that when  > 0, the increase in foreign interest rates reduces the present

value of liabilities in foreign currency term), and (16) to calculate the new real exchange rate Q0 .
                                                           p
Together with our calibration of f Y , this determines r0 via equation (A.130) and therefore the
magnitude of the valuation effect.

Investment through the government balance sheet.               When foreign currency investments
are done through the mutual fund, the valuation effects are distributed in the population accord-
ing to their holdings of mutual fund shares. To quantify the effect of alternative distribution rules,
we now assume that the government holds the country's gross currency exposure, and rebates it


                                                     A-39
                                                 Figure A.3: Calibrating f Y

                    Share of liabilities in foreign currency                    Net currency mismatch across countries
                                          Advanced countries            1.0         1994
            70
                                          Emerging countries                        2017
            60                            Developing countries                      Mexico
                                                                        0.8
            50
                                                                        0.6
  Percent




            40




                                                                  cdf
            30                                                          0.4

            20
                                                                        0.2
            10

            0                                                           0.0

             1990     1995     2000     2005     2010     2015           -100         -50              0           50          100
                                      Year                                         FX Assets - Liabilities/ GDP in percent

Note: The left panel shows the fraction of liabilities denominated in foreign currency as a share of total
liabilities, on average across advanced, emerging and developing countries, respectively. The right panel
shows the distribution, in a set of 50 countries, of the difference between foreign currency assets and liabili-
ties ("gross currency mismatch"), as a share of GDP. Source: Bénétrix et al. (2020), updating an earlier study
by Lane and Shambaugh (2010).


                                                                G in domestic assets and  G
according to various schemes. We add a government, with shares st                         t -1
coupons in foreign bonds, and budget constraint
                                                                                  G
                                                                                  t
                                                                                    -1    G
                             Bt = (1 + rt-1 ) Bt-1 - Tt + (1 + it -1 ) Q t             + st ( Dt + p t )                     (A.132)
                                                                                  P
where Tt are aggregate taxes. We distribute those taxes by modifying the household budget con-
straint (1) to read

                                 PFt      PHt                p      Wt        e 1- 
                                     cF +     c H + a = 1 + rt a + e Nt - Tt
                                 Pt        Pt                       Pt       E [ e 1-  ]

 = 1 represents lump-sum taxes, while  = 0 are proportional taxes. The higher , the more
regressive the tax system is. Finally we assume the fiscal rule

                                                        Bt = ( B )t Bt-1

When  B = 0, through (A.132), the government immediately must adjust taxes to shore up its
balance sheet loss from foreign liabilities after a depreciation. When  B > 0, the government
builds up debt and taxes later, which mitigates the immediate effect on spending.




                                                                 A-40
Calibrating  and f Y . To calibrate the coupon , we note that the duration of a bond with price
(A.129) is given by
                                                    1 + i
                                             D=
                                                  1 + i - 
We calibrate  to hit a liability duration of D = 18 quarters, as implied by Doepke and Schneider
(2006)'s estimates for the U.S.
     We calibrate f Y to data on from Lane and Shambaugh (2010) and Bénétrix et al. (2020). Lane
and Shambaugh (2010) documented aggregate foreign currency exposures for 1994 to 2004 for a
sample of 117 counties; Bénétrix et al. (2020) subsequently updated their data to 2017 for a sample
of 50 countries. These studies measure foreign currency exposure as the difference between county
i's gross foreign currency assets and gross foreign currency liabilities.52 The right panel of figure
A.3 shows the distribution of these currency exposures, normalized by GDP, from the most recent
study by Bénétrix et al. (2020). As emphasized by these authors, countries have dramatically
reduced the aggregate currency mismatch in their balance sheets since the 1990s: for instance,
while Mexico used to have around 25% more foreign currency liabilities than assets as a share of
its GDP, it now has around 5% more foreign currency assets than liabilities (the left panel illustrates
that this has tended to happen via a reduction in the fraction of the share of liabilities that are in
foreign currency.) In the latest 2017 data, only three countries in the dataset have foreign currency
liabilities exceeding assets by more than 40% of GDP: Tunisia (-63%), Egypt (-44%) and Sri Lanka
(-40%). In our exercise of section 5.6, we set f Y = -50%. This calibration therefore represents an
upper bound on the size of valuation effects.


D      Alternative models
This appendix presents three extensions of our baseline model, which we show can be reinter-
preted as versions of our baseline model with different parameters. Appendix D.1 adds produced
nontradable goods in addition to tradable goods. Appendix D.2 adds imported intermediate
goods. Both of these can be directly reinterpreted as our baseline model with an appropriate
reparameterization of the openness parameter  and the elasticity of substitution between home
and foreign goods  . Appendix D.3 considers a tradable-nontradable model of a commodity ex-
porter, which takes as given the price of exports. We show that in the standard case where a fixed
quantity of tradables (commodities) is being produced each period, akin to a fixed endowment of
tradable goods, this can be reinterpreted as our model with dollar currency pricing.


D.1     Nontradable goods
We first add nontradable goods to the model. Instead of (2), assume that household consumption
is now an aggregate between tradable goods and (home-produced) nontradable goods,

                                       (  -1) /                 (  -1) /   / (  -1)
                            c = 1/ c T             + (1 - )1/ c H, NT                             (A.133)

  52 Laneand Shambaugh (2010)'s headline measure of currency exposure for country i at time t, FXit  AGG ,

is normalized by the sum of assets and liabilities, but the supplementary data in both Lane and Shambaugh
(2010) and Bénétrix et al. (2020) report measures normalized by GDP, which correspond exactly to our f Y .




                                                     A-41
where the tradable bundle is a mix of imported tradables and home-produced tradable goods,

                                           (  -1) /                 (  -1) /   / (  -1)
                              c T = 1/ c F             + (1 - )1/ c H,T                               (A.134)

Here,  is the tradable share, while 1 -  is home bias within tradables;  is the elasticity of substi-
tution between tradables and nontradables (which is plausibly quite low), while  is the elasticity
of substitution between home and foreign goods within tradables. For this section, we assume
that the production functions for tradables and nontradables are identical, so that they always
have the same price, and that all that matters is the sum of c H,T and c H, NT .
    With this demand system, total demand for home goods coming domestic residents is
                                                        -           -                      -
                                                PH             PT                     PH
           c H  c H,T + c H, NT =    (1 -  )                            + (1 -  )              c      (A.135)
                                                PT             P                       P

At the steady state where all prices are 1, the overall home and foreign shares of consumption are
therefore
                     cH                                           cF
                         = (1 -  )  + (1 -  )  1 -      ¯;           =        ¯               (A.136)
                      c                                            c
In response to a shock to prices around the steady state, we log-linearize and find that this relative
demand changes by

                       (1 -  )                                         1-
 c    ^=-
 ^H - c                                  ^H - p
                                     ( ( p    ^T) + (p    ^ )) -
                                                     ^T - p                               ^ ) (A.137)
                                                                                     ^H - p
                                                                                    (p
                  (1 -  )  + (1 -  )                             (1 -  )  + (1 -  )

            ^ = p
Noting that p   ^ T + (1 -  ) p
                              ^ H , we can write

                                           ^ T =  -1 ( p
                                      ^H - p
                                      p                ^H - p
                                                            ^)
                                             ^ = --1 (1 - )( p
                                        ^T - p
                                        p                    ^H - p
                                                                  ^)

and substitute these into (A.137) to obtain

                  ^H - c
                  c    ^        (1 -  )                                1-
              -          =                    (-1 - -1 (1 - )) +                    
                  ^H - p
                  p    ^   (1 -  )  + (1 -  )                    (1 -  )  + (1 -  )
                           (1 - ) + (1 - )
                         =                       ¯                                                    (A.138)
                            (1 -  ) + (1 -  ) 

Note that the elasticity   ¯ in (A.138) is a weighted average of the primitive elasticities  and  .
    Define the consumption aggregator function c    ¯(c F , c H ) to maximize c subject to (A.133), (A.134)
and c H = c H,T + c H, NT . It is immediate that this has constant returns to scale. We can view total
foreign and home consumption (as calculated above) as optimizing this function subject to prices
PF and PH .
    For steady-state PF = PH = P = 1, we found c F and c H in (A.136), with         ¯ =  the steady-state
foreign share and 1 -   ¯ the home share. In (A.138) we calculated the local elasticity of substitution
of the consumption aggregator function,       ¯.
    To first order in aggregate shocks, therefore, our model remains the same when nontradables
are introduced; we need only replace the openness parameter  and elasticity of substitution be-
tween home and foreign goods  with their counterparts                ¯ and ¯ in (A.136) and (A.138).53 The
  53 The   problem of allocating within c F between different countries' varieties is unchanged; the elasticity


                                                        A-42
two implications of this equivalence mapping are the following.
    First, the import-to-GDP ratio is now ccF =  = . Hence, even in the presence of nontrad-
ables, it is appropriate to calibrate  to that ratio.
    Second,     ¯ is a weighted average of  (elasticity between home and foreign within tradables,
which could be relatively high) and  (the elasticity between nontradable and tradable, which
could plausibly be much lower), with a larger weight on  when the nontradable share is higher.
Hence,    ¯ itself could plausibly be relatively low.


D.2    Imported intermediates
We now return to the consumption basket in (2), but change the production structure to allow for
imported intermediate goods. Specifically, suppose that the continuum of firms in each country
now produce an intermediate good X using the technology X = ZN , and that the final good
Y in each country is a CES aggregate of the country's own intermediate good and the foreign
intermediate good.
    Concretely, for the home country, suppose that production of the final good is given by

                                     (  -1) /                (  -1) /   / (  -1)
                         Y = 1/ XF               + (1 - )1/ X H                           (A.139)

where X H is the home country's demand for the home intermediate, and XF is the home country's
demand for imported intermediates. Suppose further that XF (analogous to c F ) is a CES aggregate
of each other country's intermediate, with elasticity . As before, normalize all prices and quan-
tities at the steady state to 1, and assume that foreign prices and quantities do not change. Note
that a country's total value added, or GDP, equals its X .
     It follows that total demand for the home country's intermediate X is

                                              X     -           X   -
                                             PH               PH
                            X = (1 -  )                 Y+              Y                 (A.140)
                                             PH                E
where demand for Y is the same as before
                                                    -               -
                                             PH               PH
                            Y = (1 -  )                 C+              C                 (A.141)
                                              P               E
                                                                      X . Totally differentiating
Equations (29) and (30) continue to hold, replacing Y by X and PH by PH
(A.140), we get

              dX = -(1 - )(1 - ) (dPH - dP) - (1 - )(dPH - dE )
                                  X              X
                       -(1 - ) (dPH - dPH ) - (dPH - dE ) + (1 - )(1 - )dC                (A.142)

As in appendix B.1, linearizing the CPI equation, we have dP = (1 - )dPH + dE . Linearizing
the price index corresponding to (A.139), we get dPH = (1 - )dPH      X + dE .

    Writing all the relative prices in (A.142) in terms of the real exchange rate dQ = dE - dP, we

there remains .




                                                  A-43
have
                                         
                           dPH - dP = -      dQ
                                       1-
                                         1
                          dPH - dE = -       dQ
                                       1-
                           X                                  1
                         dPH - dPH =       (dPH - dE ) = -      dQ
                                      1-                   1-1-
                             X         1                    1 1
                          dPH  - dE =      (dPH - dE ) = -      dQ
                                      1-                   1-1-

and can plug this into (A.142) to obtain

                                        1     1
  dX =    (1 - ) + (1 - )           +     +                            dQ + (1 - )(1 - )dC (A.143)
                                1-     1- 1- 1-

                                                   ¯
If we define ¯  1 - (1 - )(1 - ), and      ¯  1- ¯
                                                   
                                                      (1 - ) + (1 - ) 1-                1       
                                                                                 +  1- + 1-  1- ,
                                                                                                  1

then (A.143) becomes just
                                             ¯
                                             
                                     dX =         ¯ dQ + (1 - ¯ )dC                            (A.144)
                                          1-   ¯
which is identical to equation (A.57) in appendix B.1, but with    ¯, ¯ , and dX replacing , , and dY .
With these substitutions, the International Keynesian Cross remains the same, and our analysis in
the main body of the paper goes through. The two implications of this equivalence mapping are
the following.
    First,  =  +  - , while the import-to-GDP ratio is  + . Hence, provided  and  are
not too large,  is close to the import-to-GDP ratio, though an ideal calibration would subtract the
reexported good-to-GDP ratio .
    Second, the trade elasticity  ¯ is now a more complex amalgam of four primitive elasticities:
substitution between home and foreign final goods  , substitution between different countries'
final goods , substitution between home and foreign intermediates  , and substitution between
different countries' intermediates .


D.3      Commodity exporter model
As our last alternative model, we consider a model of a commodity exporter, who takes as given
the price of tradable goods. We set this up as in Uribe and Schmitt-Grohé (2017), by assuming
that the economy possesses a constant stream of tradable goods Y T that it can sell in the world
market at fixed prices. Vice versa, there are non-tradable goods that the economy does not export.
We describe the main changes in this economy relative to the one in section 2 and argue that this
model is identical to the DCP model in section 3.4 in which dollar prices of exports are fully rigid.
    Households. Domestic households are assumed to behave as in section 2, except that they con-
sume tradable and non-tradable goods, rather than foreign and domestic goods. PTt is the price of
tradables and PNt is the price of non-tradables. The utility function u (c T , c N ) is the same as before,
with c T and c N entering a CES basket with elasticity  and a consumption share of tradables of ,
analogous to (2). The CPI is analogous to (3), individual demands analogous to (4)­(5). Foreign
                                                                       = 1.
households elastically buy or sell tradables at a fixed dollar price PT




                                                  A-44
   Production. Non-tradables are produced using the linear production function

                                             YNt = ZN NNt

and sold by a continuum of firms charging flexible prices at a markup µ. NNt is labor demand by
non-tradable producers. Tradables are produced by the Leontief production function

                                         YTt = ZT min{ NTt , L}                                  (A.145)

where L > 0 is a fixed factor the country is endowed with, such as the land on which natural
resources can be found. Again we assume YTt is sold by a continuum of firms charging flexible
prices at a markup µ. NTt is labor demand by tradable producers.
    We assume here that (A.145) is Leontief in line with the idea that tradables are basically an
endowment of the economy, YTt = ZT L = const. The only reason why we do not outright assume
that YTt is an endowment is that in a heterogeneous-agent context, it matters whose endowment
YTt is. (A.145) provides us with a simple way to split the proceeds from selling YTt into labor and
profit income.
    Rest of the model. All the remaining model ingredients are identical. For example, all firms'
dividends (tradable and non-tradable alike)
                                                           Y - W N
                                                       Et PT
                                    PNt YNt - Wt NNt         Tt   t Tt
                             Dt =                    +
                                            Pt                 Pt
are capitalized and traded, just like domestic firms' dividends before. Unions and wage stickiness,
notation for exchange rates, market structure, and monetary policy are all identical.
    Market clearing for non-tradable goods is given by
                                                               -
                                                        PNt
                                      YNt = (1 - )                 Ct                            (A.146)
                                                         Pt

essentially (26) without the second term, as non-tradable goods are not exported. We normalize
all prices Ess , Qss , Pss , PNss , PTss to 1, and quantities Css = 1, YNss = 1 - , YTss =  in the steady
state of the model.
    Consumption function. We can write consumption as function of real labor income and divi-
                 Ws
dends Ct = Ct     Ps Ns , Ds  just like before.
   Model analysis and equivalence to DCP model. Define real GDP as

                                        PTss       PNss
                                 Yt          YTt +      YNt = YT + YNt
                                        Pss         Pss
We can write dividends as                                    -P
                                        PNt Yt - Wt Nt   Et PT    Nt
                                 Dt =                  +                                         (A.147)
                                               Pt              Pt
                                                                                             = 
which is identical to (12) in the case of DCP with fully rigid dollar export prices, where CH
      = P = 1. Just like before, aggregate labor income is given by
and PH     T

                                            Wt      1 PNt
                                               Nt =       Yt                                     (A.148)
                                            Pt      µ Pt




                                                 A-45
Rewriting (A.146), we find that
                                                       -
                                                 PNt
                                  Yt = (1 - )              Ct +                            (A.149)
                                                  Pt

which is identical to the goods market clearing condition (26) with DCP. Given that (A.147)­(A.149)
are the same as in the model with DCP (section 3.4), and the consumption function is unchanged,
this proves that the model with tradable and non-tradable goods is isomorphic to the DCP model.
    International Keynesian cross. Due to the equivalence with the DCP model, we can derive an
international Keynesian cross decomposition for the commodity exporter model that is analogous
to (A.68). For a similar decomposition of the RA consumption response in a version of the com-
modity exporter model see Bianchi and Coulibaly (2021).




                                              A-46
