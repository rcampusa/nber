                                NBER WORKING PAPER SERIES




       ESTIMATING AND TESTING MODELS WITH MANY TREATMENT LEVELS
                        AND LIMITED INSTRUMENTS

                                           Lance Lochner
                                           Enrico Moretti

                                        Working Paper 17039
                                http://www.nber.org/papers/w17039


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      May 2011




Previously circulated as "Estimating and Testing Non-Linear Models Using Instrumental Variables."
We thank Josh Angrist, David Card, Pedro Carneiro, Jim Heckman, Guido Imbens, the editor, two
anonymous referees and seminar participants at the 2008 UM/MSU/UWO Summer Labor Conference,
UCSD, and Stanford for their suggestions. We also thank Matias Cattaneo and Javier Cano Urbina
for their excellent research assistance and comments, as well as Martijn van Hasselt and Youngki Shin
for their many comments and suggestions. The views expressed herein are those of the authors and
do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2011 by Lance Lochner and Enrico Moretti. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Estimating and Testing Models with Many Treatment Levels and Limited Instruments
Lance Lochner and Enrico Moretti
NBER Working Paper No. 17039
May 2011, Revised July 2014
JEL No. C01,J0

                                             ABSTRACT

Many empirical microeconomic studies estimate econometric models that assume a single finite-valued
discrete endogenous regressor (for example: different levels of schooling), exogenous regressors that
are additively separable and enter the equation linearly; and coefficients (including per-unit treatment
effects) that are homogeneous in the population. Empirical researchers interested in the causal effect
of the endogenous regressor often use instrumental variables. When few valid instruments are available,
researchers typically estimate restricted specifications that impose uniform per-unit treatment effects,
even when these effects are likely to vary depending on the treatment level. In these cases, ordinary
least squares (OLS) and instrumental variables (IV) estimators identify different weighted averages of all
per-unit effects, so the traditional Hausman test (based on the restricted specification) is uninformative
about endogeneity. Addressing this concern, we develop a new exogeneity test that compares the
IV estimate from the restricted model with an appropriately weighted average of all per-unit effects
estimated from the more general model using OLS. Notably, our test works even when the true model
cannot be estimated using IV methods as long as a single valid instrument is available (e.g. a single
binary instrument). We re-visit three recent empirical examples that examine the role of educational
attainment on various outcomes to demonstrate the practical value of our test.


Lance Lochner
Department of Economics, Faculty of Social Science
University of Western Ontario
1151 Richmond Street, North
London, ON N6A 5C2
CANADA
and NBER
llochner@uwo.ca

Enrico Moretti
University of California, Berkeley
Department of Economics
549 Evans Hall
Berkeley, CA 94720-3880
and NBER
moretti@econ.berkeley.edu
1    Introduction

    Many recent empirical papers seek to estimate causal relationships using instrumental variables
(IV), including two-stage least squares (2SLS) estimators, when concerns about causality arise. A
model frequently estimated in practice has the following form:

                                        yi = si β L + x0i γ L + νi ,                                 (1)

where yi is the outcome of individual i; xi is a k × 1 vector of exogenous covariates (including
an intercept); and si is the potentially endogenous regressor. For example, the variable si might
reflect different treatment levels of a government training program or different dosage levels for a
new drug treatment. In our empirical examples and much of our discussion below, si reflects years
of completed schooling.
    Conclusions about exogeneity of si and consistency of the ordinary least squares (OLS) estimator
are typically based on a comparison of OLS and IV estimates of β L . When a standard Hausman
test (Hausman 1978) indicates a significant difference between OLS and IV estimates, it is common
to conclude that endogeneity of si plays an important confounding role in OLS.
    Yet, in many economics applications, the true relationship between yi and si is unlikely to be
linear. In particular, suppose that the endogenous regressor si ∈ {0, 1, 2, 3, ..., S} is discrete and
the true model has the form:
                                             S
                                             X
                                      yi =         Dij βj + x0i γ + εi ,                             (2)
                                             j=1

where Dij = 1[si ≥ j] reflects a dummy variable equal to one if si ≥ j and zero otherwise,
E(εi ) = 0, and E(εi xi ) = 0. When si reflects years of schooling, the βj represent grade-specific
effects of moving from j − 1 to j years of schooling.
    The difference between the models in equations (1) and (2) is that the former assumes a uniform
per-unit or marginal effect of si across all levels of si while the latter does not. For example, in the
classic case of the return to education, the model in (1) assumes that the effect of an extra year
of elementary school is identical to the effect of the last years of high school and college, while the
model in (2) allows for sheepskin effects and other non-linearities that are likely to arise in practice.
    While variable per-unit treatment effects are likely to be important in many applications, rela-
tively few studies have focused on their practical implications when instrumental variables may be



                                                       1
needed.1 The difficulty in estimating a specification like equation (2) when endogeneity concerns
arise is that there may be many βj parameters to estimate, while researchers typically have very
few valid instruments. In theory, a single continuous instrument may be sufficient for identification.
In practice, there is often insufficient variation in the instrument to precisely estimate all per-unit
effects. Discrete-valued instruments are also common in the literature. As a consequence, empirical
studies commonly estimate models like equation (1) even when there is no theoretical reason to do
so and in some cases there is prima-facie evidence of important non-linearities between yi and si .
       We demonstrate that when the per-unit effects of changes in si vary over the range of si as in
equation (2) but the estimated model assumes that all per-unit effects are the same as in equation
(1), OLS and IV methods estimate different weighted averages of all per-unit effects. Building on
this insight, we develop a new exogeneity test that only requires a single (even binary) instrument
and is useful when per-unit treatment effects vary across treatment levels.
       We stress that our results do not apply to all non-linear models, but only to the specific case
described in equations (1) and (2). In particular, we assume: (i) a single finite-valued discrete
endogenous regressor; (ii) exogenous regressors are additively separable and enter the equation
linearly; and (iii) all coefficients (including per-unit treatment effects) are homogeneous in the
population. While these assumptions are strong, they are common in the applied microeconomics
literature.
       We are not the first to point out that estimates from a mis-specified linear model (i.e. constant
marginal or per-unit treatment effects) yield weighted averages of each marginal/per-unit effect.
Yitzhaki (1996) derives these weights in the context of OLS, while Angrist and Imbens (1995)
and Heckman, Urzua, and Vytlacil (2006) derive weights for IV estimators in the presence of both
variable multi-valued treatment effects and parameter heterogeneity. Angrist and Imbens (1995)
show conditions under which 2SLS estimates a local average treatment effect (LATE).2 In a very
general setting, Heckman, Urzua, and Vytlacil (2006) discuss ordered and unordered choice models
with unobserved heterogeneity and nonlinearity, developing weights for treatment effects using
general instruments. Heckman and Vytlacil (2005) emphasize that in the presence of parameter
heterogeneity, there is no single ‘effect’ of the regressor on an outcome, and different estimation
   1
       Angrist, Graddy, and Imbens (2000), Lochner and Moretti (2001), and Mogstad and Wiswall (2010) are notable
exceptions.
   2
     Intuitively, the LATE reflects the effect of a regressor on outcomes for individuals induced to change their behavior
in response to a change in the value of the instrument.



                                                            2
strategies provide estimates of different ‘parameters of interest’ or different ‘average effects’. While
many studies focus on parameter heterogeneity across individuals with a uniform marginal effect
over values of si (i.e. yi is linear in si ), we consider the opposite case, assuming a non-linear
relationship between yi and si that is the same for all individuals.3 Our setting is a special case
of that used by Heckman, Urzua, and Vytlacil (2006); however, our emphasis on varying per-unit
treatment effects and the endogeneity test are novel.
       We begin by showing that inappropriately assuming model (1) when per-unit treatment ef-
fects vary across treatment levels will generally yield different OLS and IV/2SLS estimates even
in the absence of endogeneity, since these estimators can be written as weighted averages of causal
responses to each marginal change in the regressor, where the sets of weights differ for the esti-
mators.4 An appealing feature of our setting is that the weights have an intuitive interpretation,
are functions of observable quantities, and can be easily estimated under very general assumptions.
Therefore, it is possible to directly compare the OLS and IV weights.
       This insight leads to our main contribution: a new exogeneity test that can be used to determine
consistency of the OLS estimator for equation (2). Before describing our test, first note that
the standard Hausman test is of limited applicability in this context. Since OLS and IV/2SLS
identify different weighted averages of all per-unit effects, the Hausman test applied to equation
(1) is uninformative about endogeneity of the regressor when per-unit treatment effects vary across
treatment levels. It may reject equality of OLS and IV/2SLS estimates even when the regressor is
exogenous, and it may fail to reject equality when the regressor is endogenous. Alternatively, in
order to implement the Hausman test for equation (2), one would need to estimate all βj parameters
using IV methods. In practice, this is often impossible when there are many treatment levels, since
researchers often have access to only a few valid instruments with limited variation. Rarely would
researchers have instruments capable of identifying, for example, 20 different grade-specific βj
parameters associated with all potential schooling levels.
   3
       Studies focused on parameter heterogeneity include Imbens and Angrist (1994), Wooldridge (1997), Heckman
and Vytlacil (1998, 1999, 2005), Card (1999), Kling (2000), Moffitt (2009), and Carneiro, Heckman and Vytlacil
(2010).
   4
     Relative to the existing literature, our models are closer to those typically estimated in practice. Angrist and
Imbens (1995) only consider discrete regressors that are indicators that place observations into mutually exclusive
categories, and they interact their instrument (also assumed to be discrete) with each of these regressors to create
a large set of effective instruments. The Heckman, Urzua, and Vytlacil (2006) discussion of instrumental variables
estimation in ordered choice models is left implicit on all covariates affecting the outcome variable.


                                                           3
       The test that we propose can be thought of as a generalization of the standard Hausman test
and is informative about the consistency of OLS estimates for all βj effects in equation (2). Our
test re-weights OLS estimates of the βj ’s from equation (2) using estimated IV/2SLS weights and
compares this with the corresponding IV/2SLS estimator of β L in equation (1). Under fairly
general conditions, our test can be implemented even when only a single valid (binary) instrument
is available.5
       Our proposed test has both strengths and weaknesses. The fact that our test requires only a
single instrument should make it attractive to empirical researchers. In many contexts, researchers
can easily use OLS to estimate models like equation (2) (e.g. regressing log wages on a set of 20
schooling dummies), yet they often have very few valid instruments with limited variation at their
disposal. A researcher can use our test to establish whether the OLS estimates are consistent
without having to estimate the more general equation (2) using IV/2SLS. If our test fails to reject
exogeneity, researchers can have some confidence in their OLS estimates. However, if our test
rejects, it does not help in estimating the true model. Our test, therefore, offers only a partial
solution to the problem of estimating multiple per-unit treatment effects with limited instruments.
       Three additional limitations are worth highlighting. First, it is important to note that we test
whether the weighted average of all OLS β̂j asymptotic biases equals zero. Therefore, our test has
no power against the possibility that some OLS β̂j estimates are asymptotically biased upwards and
others downwards in such a way as to exactly cancel each other when averaged using the IV/2SLS
weights. Still, rejection of the null implies that OLS estimates are inconsistent. Furthermore, we
discuss conditions under which all β̂j asymptotic biases would be of the same sign, in which case
our test is equivalent to testing whether all OLS β̂j estimates are consistent. In many applications,
economic theory can be informative about the likely sign of any biases. For example, in the case
of returns to schooling, most models of investment in human capital predict that OLS estimates of
β̂j are all asymptotically upward biased.
       Second, even if exogeneity cannot be rejected, researchers should exercise caution when con-
ducting inference using OLS estimates of equation (2) when the instruments are not sufficiently
   5
       Lochner and Moretti (2001) and Mogstad and Wiswall (2010) suggest that comparing re-weighted OLS estimates
with IV/2SLS estimates may be a useful heuristic approach for assessing the importance of non-linearities. In this
paper, we develop a formal econometric test for exogeneity based on this insight. Our test differs conceptually
and practically from the omnibus specification tests developed by White (1981), which essentially compare different
weighted generalized least squares estimators for a general nonlinear function.



                                                          4
strong. Like the Hausman test, our test does not have much power when instruments are weak. As
Wong (1997) and Guggenberger (2010) demonstrate, this can cause size problems with inference
in a two-stage approach where the Hausman test is used to determine exogeneity in a first stage,
and OLS estimates are used in a second stage when exogeneity cannot be rejected.6 Monte Carlo
simulations confirm that similar inference problems can arise when using our test with insufficiently
strong instruments.
       Third, our approach assumes that equation (2) reflects the true model. Mis-specification due
to, for example, non-separabilities between si and xi or due to individual-level parameter hetero-
geneity would likely invalidate our test, since this would alter the relationship between OLS and
IV estimators in unaccounted-for ways.
       In the last part of the paper, we demonstrate the practical usefulness of our test by re-examining
three recent empirical papers in which estimated 2SLS effects differ from OLS effects. In one
example, our test suggests that schooling is exogenous for incarceration among white men. As we
discuss below, this is empirically useful, since it lends credibility to OLS estimates that suggest a
highly non-linear relationship between educational attainment and the probability of imprisonment.
In contrast, our test strongly rejects exogeneity of schooling for incarceration among black men,
while the standard Hausman test does not. In this case, the endogeneity of schooling is obscured
when non-linearities between schooling and imprisonment are ignored. Our other examples produce
greater concordance between the standard Hausman test and our exogeneity test; however, for
different reasons.
       The rest of the paper is organized as follows. In Section 2, we show conditions under which
OLS, IV and 2SLS estimates of β L in equation (1) can be written as weighted averages of the
true underlying βj parameters in the more general model given by equation (2). For expositional
purposes, we will refer to si as years of schooling, so the βj reflect grade-specific marginal or per-
unit effects. Section 3 develops an exogeneity test that can be used to determine consistency of
the OLS estimator for equation (2). Section 4 presents the results from three previous empirical
examples, and Section 5 concludes.
   6
       Specifically, Wong (1997) and Guggenberger (2010) provide simulation evidence (in a linear regression model like
equation 1) for the null rejection probability of a simple hypothesis test conditional on a standard Hausman pretest
for exogeneity not rejecting. Their findings indicate that when regressor endogeneity is small, the null rejection
probability of the hypothesis test may be substantially higher than the nominal size if the instruments are not
sufficiently strong.



                                                            5
2        Estimating Weighted Average Per-Unit Treatment Effects

        In this section, we consider IV/2SLS and OLS estimators when equation (1) is estimated, but
the true model is described by equation (2). We show conditions under which these estimators
converge to a weighted average of each grade-specific βj effect and discuss the weights. We assume
throughout our analysis that all observations are independent across i = 1, ..., N individuals and
that standard conditions for the weak law of large numbers and central limit theorems apply.7


2.1        IV Estimation with a Single Instrument

        We first consider IV estimation with a single instrument, discussing OLS as a special case.
We study the case where the potentially endogenous variable si is discrete.8 Throughout the
paper, we assume εi is independent across individuals with E(εi ) = 0, xi is distributed with
density Fx (·), and E(εi xi ) = 0. The following decomposition is also useful: si = x0i δs + ηi , where
δs = [E(xi x0i )]−1 E(xi si ) by construction and E(xi ηi ) = 0.
        The following IV assumption is standard.

Assumption 1. The instrument is uncorrelated with the error in the outcome equation, E(εi zi ) =
0, and correlated with si after linearly controlling for xi , E(ηi zi ) 6= 0.

        Let Mx = I − x(x0 x)−1 x0 and s̃ = Mx s for any variable s. (We drop the i subscripts when
we refer to the vector or matrix version of a variable that vertically stacks all individual-specific
values.) With a single instrument, 2SLS estimation of equation (1) is equivalent to the following
IV estimator:

                                    L
                                  β̂IV   = (z 0 Mx s)−1 z 0 Mx y
                                                                     
                                                             XS
                                         = (z̃ 0 s̃)−1 z̃ 0    Dj βj  + (z̃ 0 s̃)−1 z̃ 0 ε
                                                               j=1
                                              S
                                              X
                                         =          ω̂jIV βj + (z̃ 0 s)−1 z̃ 0 ε
                                              j=1
    7
        For example, assume all random variables are independent and have finite first, second, and third moments.
Finite third moments enable application of central limit theorems based on independent but not necessarily identically
distributed random variables (e.g. Liapounov).
   8
     While we study the case of a discrete endogenous regressor, OLS and IV estimators will also yield different
weighted averages of marginal effects when the regressor is continuous.The insights of Yithzaki (1996) might be used
to develop weights and a related test specifically designed for the continuous regressor case.


                                                                6
                                                              N
                                                                               N                          S
                         (z̃ 0 s̃)−1 z̃ 0 D               1
                                                                                1 P
             ω̂jIV                                                                                              Dij = si , these ω̂jIV sum to
                                                              P                                               P
where                =                        j   =       N         z̃i Dij        N          z̃i s̃i . Since
                                                              i=1                       i=1                    j=1
one over j = 1, ..., S. We refer to them as “weights” even though they may be negative for some
j.9
          One helpful assumption is monotonicity in the effects of the instrument on si . Although mono-
tonicity is not necessary for deriving and estimating “weights”, it does help ensure that they are
non-negative and simplifies their interpretation. When si reflects years of schooling, monotonicity
implies that the instrument either causes everyone to weakly increase or causes everyone to weakly
decrease their schooling. Without loss of generality, we assume that si is weakly increasing in zi .
Define si (ϑ) to be the value of si for individual i when zi = ϑ.

Assumption 2. (Monotonicity) The instrument does not decrease si : P r[si (ϑ) < si (ϑ0 )] = 0, for
all ϑ > ϑ0 .

                                          L , it is useful to decompose z = x0 δ +ζ where δ = [E(x x0 )]−1 E(x z )
          To facilitate our analysis of β̂IV                             i   i z   i       z      i i         i i

and E(xi ζi ) = 0.

                                                                                         p    S
                                             L →                                                    ωjIV βj , where
                                                                                              P
Proposition 1. If Assumption 1 holds, then β̂IV
                                                                                              j=1

                                                                         P r(si ≥ j)E(ζi |si ≥ j)
                                                          ωjIV =       S
                                                                                                                                         (3)
                                                                       P
                                                                          [P r(si ≥ k)E(ζi |si ≥ k)]
                                                                       k=1

sum to unity over all j = 1, ..., S. Furthermore, if E(zi |xi ) = x0i δz and Assumption 2 (Monotonicity)
holds, then the weights are non-negative and can be written as

                                                                         E{Cov(zi , Dij |xi )}
                                                          ωjIV =       S
                                                                                                          ≥ 0.                           (4)
                                                                       P
                                                                              E{Cov(zi , Dik |xi )}
                                                                       k=1

Proof: See Online Appendix A.
          This result shows that estimating the mis-specified linear-in-schooling model using IV yields a
consistent estimate of a weighted average of all grade-specific βj effects. The weights on all grade-
specific effects are straightforward to estimate. From a 2SLS regression of Dij on si and xi using
zi as an instrument for si , the coefficient estimate on si equals ω̂jIV .
      9
          When they cannot be shown to be non-negative, we use “weights” with quotation marks to distinguish them
from cases when they are known to be proper weights that are both non-negative and sum to one.



                                                                                    7
       When the instrument affects all persons in the same direction and its expectation conditional
on xi is linear (e.g. x’s are mutually exclusive and exhaustive categorical indicator variables), the
weights are non-negative and depend on the strength of the covariance between the instrument and
each schooling transition indicator conditional on other covariates. In general, different instruments
yield estimates of different “weighted averages,” even if the instruments are all valid.
       With Assumption 1, E(zi |xi ) = x0i δz , and E(εi |xi ) = 0, it is straightforward to show that the
IV estimator converges to a weighted average of all conditional (on xi ) IV estimators, where the
weights are proportional to the covariance between the instrument and schooling conditional on xi :
                                          Z
                                     L p
                                   β̂IV → βIV (φ)h(φ)dFx (φ),

                    Cov(zi ,yi |xi =φ)
where βIV (φ) =     Cov(zi ,si |xi =φ) is the    population analogue of the IV estimator conditional on xi = φ
and h(φ) =        R Cov(zi ,si |xi =φ)      is   a weighting function that integrates to one for all xi (with
                   Cov(zi ,si |xi =a)dF (a)
                                                                 S
                                                                                                       Cov(zi ,Dij |xi =φ)
                                                                       βj ωjIV (φ), where ωjIV (φ) =
                                                                 P
h(·) ≥ 0 under Assumption 2). Notice that βIV (φ) =                                                    Cov(zi ,si |xi =φ)
                                                                 j=1
are x-specific IV “weights” for each grade-specific effect, βj . Each x-specific IV estimator is sim-
ply a weighted average of the grade-specific βj effects, where the weights are proportional to the
covariance between the instrument and Dij conditional on xi . Some re-arranging shows that the
IV weights from equations (3) or (4) can be re-written as ωjIV = ωjIV (φ)h(φ)dFx (φ).10
                                                                R

       These results complement the IV/2SLS analyses of Angrist and Imbens (1995) and Heckman,
Urzua, and Vytlacil (2006), who also consider parameter heterogeneity along with variable per-unit
treatment effects. In order to ease interpretation in the presence of parameter heterogeneity, Angrist
and Imbens (1995) make strong assumptions about the additional xi covariates and how they enter
in estimation. Specifically, they assume that the xi regressors are indicator variables that place
individuals into mutually exclusive categories and that the instrumental variable (also assumed to
be discrete) is interacted with all of these additional covariates. By contrast, Heckman, Urzua, and
Vytlacil (2006) consider a very general setting for ordered and unordered choice models; however,
their discussion of IV estimation for these models implicitly conditions on all covariates xi (deriving
IV weights analogous to ωjIV (φ) in our setting). Results in this section could, therefore, be derived
as a special case of their analysis. While our analysis ignores heterogeneity in the grade-specific
effects, it considers estimation under common assumptions about covariates and the way they
  10
       In Online Appendix A, we further show that with a binary instrument, the ωjIV (·) weights can be more easily
interpreted along the lines of the LATE analysis of Angrist and Imbens (1995).


                                                            8
typically enter during estimation. We are not focused on finding an ‘economic interpretation’ for
the IV estimator, since the weights we consider can easily be estimated. Instead, we are interested
in empirically comparing the OLS and IV weights and deriving a test for whether the different
weights can explain differences between the two estimators when per-unit treatment effects are
incorrectly assumed to be uniform (i.e. linearity between yi and si ).
       Since OLS is a special case of IV estimation, in the absence of endogeneity, the OLS estimator
for the linear-in-si model (equation 1) also converges to a weighted average of the grade-specific
effects, βj , where the weights are non-negative and sum to one.

Corollary 1. If E(εi si ) = 0 then
                                                            S
                                                  L     p   X
                                                β̂OLS →           ωjOLS βj                                         (5)
                                                            j=1

where the
                                                 P r(si ≥ j)E(ηi |si ≥ j)
                                    ωjOLS =    S
                                                                               ≥0                                  (6)
                                               P
                                                    P r(si ≥ k)E(ηi |si ≥ k)
                                              k=1

sum to unity over all j = 1, ..., S.

Proof: This result largely follows from Proposition 1 replacing zi with si . Online Appendix A shows
that the OLS weights are always non-negative.
                                                                        p
       The empirical counterpart to the OLS weights, ω̂jOLS → ωjOLS , is simply the coefficient estimate
on si in an OLS regression of Dij on si and xi . Therefore, only data on xi and si are needed to
construct consistent estimates of the asymptotic weights. Of course, the weights implied by OLS
estimation will not generally equal the weights implied by IV estimation.11 In Section 4, we graph
estimated OLS and IV weights in a few different empirical applications.
       Researchers often estimate models like equation (1) rather than the more general equation (2),
because they are limited in the instrumental variables at their disposal. Yet, even in the absence
  11
       For example, consider the case with no x regressors (except an intercept). It is straightforward to show that
 OLS
ωj+1    − ωjOLS ∝ (E(si ) − j) × P r(si = j), which is positive for j < E(si ), zero for j = E(si ), and negative when
j > E(si ). This implies that OLS estimation of the linear specification places the most weight on grade-specific βj
effects near the mean schooling level. When schooling is uniformly distributed in the population, the weights decay
symmetrically as one moves away from the mean in either direction. Contrast this with the IV weights in the case
of a binary instrument zi ∈ {0, 1} satisfying the monotonicity assumption. In this case, IV places all the weight on
schooling margins that are affected by the instrument, while the underlying distribution of schooling in the population
is irrelevant.


                                                            9
of endogeneity and individual-level parameter heterogeneity, there is no reason to expect OLS and
IV estimators to be equal for a mis-specified linear-in-si model that assumes uniform per-unit
treatment effects. As a result, standard Hausman tests applied to the mis-specified linear-in-si
model may reject the null hypothesis of ‘exogenous s’ due simply to variable per-unit treatment
effects. Below, we develop a chi-square test for whether OLS estimation of equation (2) yields
consistent estimates of the underlying βj parameters (i.e. whether E(εi |si ) = 0) even when only a
single valid instrumental variable is available. However, we first generalize our key results to the
case of many instruments.


2.2       2SLS Estimation with Multiple Instruments

       We now generalize the results to the case where we have I distinct instruments for schooling,
zi = (zi1 ... ziI )0 , but the researcher still estimates the linear-in-schooling model (1). Let si =
x0i θx + zi0 θz + ξi , with θ̂x and θ̂z reflecting the corresponding OLS estimates of θx and θz . Further
define the predicted value of schooling conditional on x and z: ŝi = x0i θ̂x + zi0 θ̂z . Then, 2SLS
estimation of equation (1) yields
                                                                 S
                                                                 X
                               L
                             β̂2SLS = (ŝ0 Mx ŝ)−1 ŝ0 Mx y =         ω̂j βj + (ŝ0 Mx ŝ)−1 ŝ0 Mx ε                   (7)
                                                                 j=1


where the “weights” ω̂j = (ŝ0 Mx ŝ)−1 ŝ0 Mx Dj = (θ̂z0 z 0 Mx z θ̂z )−1 θ̂z0 z 0 Mx Dj reflect consistent estimates
of ωj from 2SLS estimation of

                                    Dij = si ωj + x0i αj + ψij ,           ∀j ∈ {1, ..., S}.                             (8)

       We assume that Assumption 1 holds for all zi` instruments and that we have sufficient variation
in zi conditional on xi for identification. Let ζi = (ζi1 , ..., ζiI )0 be the I × 1 vector collecting all
ζi` = zi` − x0i δz` , where δz` = [E(xi x0i )]−1 E(xi zi` ) was introduced above in the single-instrument
case.12

Assumption 3. The covariance matrix for zi after partialling out xi , E(ζi ζi0 ), is full rank.

       As with the single-instrument IV estimator, we can show that the 2SLS estimator for β L in
equation (1) converges in probability to a “weighted” average of all grade-specific effects. Letting
  12                                                                                                              L        L
       In the case of a single instrument, this analysis reduces to that for IV in the previous subsection with β̂2SLS = β̂IV
and ω̂j = ω̂jIV for all j.


                                                              10
 IV reflect the grade j “weight” from the single-instrument IV estimator using z as the instrument
ωj`                                                                             i`

as defined by equation (3), the 2SLS estimator “weight” on any βj is a weighted average of each of
these single-instrument IV estimator “weights”.
                                                                          p   S                          I
                                            L                                                                      IV sum to
                                                                              P                          P
Proposition 2. Under Assumptions 1 and 3, β̂2SLS →                                  ωj βj , where ωj =         Ω` ωj`
                                                                              j=1                        `=1
unity over all j = 1, ..., S and
                                                      S
                                                      P
                                                θz`        P r(si ≥ k)E(ζi` |si ≥ k)
                                                      k=1
                                       Ω` =   I          S
                                                                                                                         (9)
                                              P         P
                                                    θzm         P r(si ≥ k)E(ζim |si ≥ k)
                                              m=1         k=1

sum to unity over all ` = 1, ..., I. Furthermore, if each instrument satisfies Assumption 2 and
                                 IV , Ω , and ω are non-negative.
E(zi` |xi ) = xi δz` , then all ωj`    `       j


Proof: See Online Appendix A.

         Not surprisingly, one can also show that the 2SLS estimator converges in probability to a
weighted average of the probability limits of all single-instrument IV estimators, where the weights
are given by Ω` in equation (9).13


3         A Wald Test for Consistent OLS Estimation of All βj ’s

         When at least one valid instrumental variable is available, the analysis of Section 2 suggests a
practical test for whether OLS estimates of B ≡ (β1 , ..., βS ) from equation (2), B̂, are consistent.14
We now develop a test that compares the 2SLS estimator from equation (1) with the weighted sum
of the grade-specific OLS estimates of the βj ’s from equation (2), using the estimated 2SLS weights
ω̂ ≡ (ω̂1 , ..., ω̂S )0 . Intuitively, if E(εi |si ) = 0 so the grade-specific OLS estimates are consistent,
then the re-weighted sum of these OLS estimates (using the 2SLS weights) should asymptotically
                                                                                     p
                                                   L
equal the 2SLS estimator from equation (1), i.e. β̂2SLS − ω̂ 0 B̂ → 0. This will not generally be true
when E(εi Dij ) 6= 0 for any j.
         Applying 2SLS to equation (8) yields estimates ω̂j and α̂j for all j. In order to derive our test
                                        L
statistic, we frame estimation of B̂, β̂2SLS , and ω̂ as a stacked generalized method of moments
    13             L             L            L
     If we define βIV,` = plim β̂IV,` where β̂IV,` is the single-instrument IV estimator using zi` as an instrument for
                                                I
                                       L    p   P       L
si in estimating equation (1), then β̂2SLS →       Ω` βIV,` , where Ω` is defined by equation (9).
                                                    `=1
    14
         Formally, B̂ = (D0 Mx D)−1 D0 Mx y, where Mx and y are defined earlier and D reflects the stacked N × S matrix
of (Di1 , ..., DiS ) for all individuals.


                                                                  11
                                                          L
(GMM) problem. This establishes joint normality of (B̂, β̂2SLS , ω̂) and facilitates estimation of the
covariance matrix for all of these estimators. From this, a straightforward application of the delta-
                                L
method yields the variance of β̂2SLS − ω̂ 0 B̂, which is used in developing a chi-square test statistic
                                                             p
                                    L
for the null hypothesis that T̂ ≡ β̂2SLS − ω̂ 0 B̂ → 0.
       It is necessary to introduce some additional notation in order to define the test statistic. We
first define the regressors for OLS estimation of equation (2), X1i = (Di0 x0i ), and the regressors,
X2i = (si x0i ), and instruments, Z2i = (zi0 x0i ), used in 2SLS estimation of equations (1) and (8).
Denote the corresponding matrices for all individuals as X1 , X2 , and Z2 , respectively. Next, let
Θ = (B 0 γ 0 β L γ L0 ω10 α10 ... ωS0 αS0 )0 reflect the full set of parameters to be estimated. Finally, let
Θ̂ denote the corresponding vector of parameter estimates, where (B 0 γ 0 ) is estimated by OLS and
(β L γ L0 ) and all (ωj0 αj0 ) are estimated via 2SLS.
       The variance of Θ can be consistently estimated from

                                                         V̂ = ÂΛ̂Â0 ,                                        (10)

where                                                                                     
                                               [X10 X1 ]−1                 0
                                      Â =                                                ,                  (11)
                                                   0             I2 ⊗ [X̂20 X̂2 ]−1 Γ̂02

Γ̂2 = (Z20 Z2 )−1 Z20 X2 , X̂2 = Z2 Γ̂2 , and 0 reflects conformable matrices of zeros.15 Furthermore,
                                                                                                          
                                               0 X )
                                        ε̂2i (X1i                          0 Z )
                                                                 ε̂i ν̂i (X1i         ε̂i Ψ̂0i ⊗ (X1i
                                                                                                   0 Z )
                          N                       1i                          2i                      2i
                        1 X                     0 X )                   0 Z )
                                                                                            
                   Λ̂ =               ε̂i ν̂i (Z2i 1i                   ν̂i Ψ̂0i ⊗ (Z2i
                                                                  ν̂i2 (Z2i 2i
                                                                                      0 Z ) ,
                                                                                         2i                   (12)
                        N   
                            i=1                   0 X ) ν̂ Ψ̂ ⊗ (Z 0 Z ) Ψ̂ Ψ̂0 ⊗ (Z 0 Z )
                                      ε̂i Ψ̂i ⊗ (Z2i 1i   i i     2i 2i     i i       2i 2i


where ε̂i = yi − Di0 B̂ − x0i γ̂, ν̂i = yi − si β̂2SLS
                                                  L    − x0i γ̂ L , and Ψ̂i = (ψ̂1i ψ̂2i ... ψ̂Si )0 with ψ̂ij =
Dij − si ω̂j − α̂j0 xi .
                                       L
       Finally, define T̂ ≡ T (Θ̂) = β̂2SLS − ω̂ 0 B̂, and let

                           Ĝ ≡ ∇T̂ = (−ω̂ 0 00x 1 00x (−β̂1 00x ) (−β̂2 00x ) ... (−β̂S 00x ))

represent the (2S + 1 + (S + 2)K) × 1 jacobian vector for T (Θ̂) (where 0x is a K × 1 zero vector).
       It is now possible to derive a chi-square test statistic.

  15
       See the proof of Theorem 1 in Online Appendix A.




                                                                 12
Theorem 1. Under Assumptions 1 and 3, if E(εi |si ) = 0, then
                                 "                     #
                                      L
                                   (β̂2SLS  − ω̂ 0 B̂)2 d 2
                         WN = N                          → χ (1).                                                        (13)
                                         ĜV̂ Ĝ0

Proof: See Online Appendix A.
                                              p                                     p
       It is important to note that T̂ → 0 need not imply that B̂ → B for two reasons. First, this
                                                            p
test cannot tell us anything about whether β̂j → βj for some grade transition j if ωj = 0. The test
only provides information about the effects of grade transitions that are affected by the instrument.
Second, the β̂j OLS estimates may be asymptotically biased upward for some j and downward for
                                         p
others. When E(εi |si ) 6= 0, B̂ → B ∗ ≡ B + {E(Di Di0 ) − E(Di x0i )[E(xi x0i )]−1 E(xi Di0 )}−1 E(Di εi ).
               p
Thus, T̂ → 0 for any B ∗ satisfying ω 0 (B − B ∗ ) = 0, where ω ≡ (ω1 , ..., ωS )0 . A test based
on Theorem 1 would have no power against these alternatives; although, rejection of the null
hypothesis would imply that B̂ does not consistently estimate B.
       Under reasonable conditions, WN can serve as a valid test statistic for the null hypothesis that
    p
B̂ → B. If ωj > 0 for all j (a testable assumption) and if E(εi Dij ) = E(εi |si ≥ j)P r(si ≥ j) were
either non-negative for all j or non-positive for all j, then all β̂j would be asymptotically biased in
                                                                                                             p
the same direction and B ∗ 6= B ⇔ ω 0 (B − B ∗ ) 6= 0. In this case, testing whether T̂ → 0 would be
equivalent to testing for consistency of B̂.16
       To better understand these conditions, consider a standard latent index ordered choice model
for schooling of the form:

                                     s∗i = µ(zi , xi ) + vi                                                              (14)

                                      si = j        if and only if j ≤ s∗i < j + 1.                                      (15)

Assume that all x regressors and instruments z are independent of both errors: (εi , vi ) ⊥⊥ (zi , xi ). It
is straightforward to show that if E(εi |vi ) is weakly monotonic in vi , then E(εi |si ≥ j) will be either
non-positive or non-negative for all j.17 Monotonicity of E(εi |vi ) is trivially satisfied by all joint
elliptical distributions (e.g. bivariate normal or t distributions), which produce linear conditional
expectation functions.
  16
       In the case where some ωj = 0, the test would be equivalent to testing for consistency of all βj with ωj > 0.
  17
       Strictly speaking, weak monotonicity is only required over the range of vi covered by j − µ(zi , xi ) (i.e. for
vi ∈ [1 − µ(zi , xi ), S − µ(zi , xi )]), so behavior in the tails of the distribution is irrelevant. See Online Appendix A for
details.



                                                                13
                                                                                            p
       In practice, one is only likely to fail to reject the null hypothesis of T̂ → 0 when B ∗ 6= B in
cases where individuals with both high and low propensities for education (conditional on observable
characteristics) have a higher (or lower) unobserved εi than individuals with an average propensity
for schooling. In the case of an ordered choice model, this would imply a U-shaped (or inverted
U-shaped) relationship for E(εi |vi ). In many economic contexts, these perverse cases seem unlikely.
       We also note that if more than one valid instrument are available, then those instruments
can be used in different combinations to perform separate tests. Because each 2SLS estimator
(distinguished by the set of instruments used) converges to a different weighted average of the true
                    0 B where Υ denotes the set of instruments used), it is unlikely that one would
B parameters (i.e. ωΥ
                    0 B = ω 0 B ∗ for all sets of instruments unless B = B ∗ .18
reject the null of ωΥ      Υ

       To demonstrate the extent to which varying per-unit treatment effects can induce differences
between OLS and IV estimates that our new exogeneity test can account for (while standard
Hausman or Durbin-Wu-Hausman tests applied to equation (1) cannot), we perform a Monte
Carlo simulation exercise based on Card’s (1995) log earnings – schooling model. In this framework,
varying per-unit treatment effects is equivalent to a non-linear relationship between log earnings and
schooling. These results are discussed in detail in Online Appendix B; however, we note here that
our test (see Theorem 1) performs well in two important respects. First, the test has nearly identical
performance to the standard Hausman test (applied to equation (1)) when all grade-specific effects
are the same. Thus, there is no ‘cost’ to using our test rather than the more traditional Hausman
test that assumes a linear relationship between log earnings and schooling. Second, our test has
very similar properties regardless of the extent of non-linearity between log earnings and schooling,
rejecting equality of the re-weighted OLS and IV estimates at noticeably higher rates for even small
deviations from exogeneity as long as the instruments are sufficiently strong.
       Of course, when the instruments are relatively weak, our test (like the standard Hausman test)
has little power to detect endogeneity since the IV estimates tend to have large standard errors. In
these cases, negligible amounts of endogeneity may be difficult to detect with our test. This can
lead to poor size properties when conducting inference using OLS estimates of the βj parameters
as discussed by Wong (1997) and Guggenberger (2010) who study this issue in the context of linear
models and use of the Hausman test to determine exogeneity. Monte Carlo results presented in
  18
       Because these test statistics are not generally independent, the critical values for this type of joint testing
procedure are likely to be quite complicated. We do not address this issue here.



                                                           14
Online Appendix B suggest caution when using OLS estimates for inference – even if our test fails
to reject exogeneity – if the instruments are relatively weak. This is particularly true when the IV
and re-weighted OLS estimates are quite different but the IV estimates are very imprecise.
         Another important limitation to keep in mind is that our test is valid only if equation (2)
represents the true model. This model assumes that the regressors are additively separable and
that the coefficients are the same for all individuals. In the case of non-separability or individual
heterogeneity in the model’s coefficients, our model would be mis-specified and our test invalid.


4         Practical Use of our Test and Three Empirical Examples

         To demonstrate the practical value of our test, we re-examine three empirical papers on the
effects of individual and maternal schooling which estimated 2SLS effects that differ non-trivially
from their corresponding OLS estimates.19 In all cases, the econometric specification assumed a
linear relationship between the outcome of interest and educational attainment as in equation (1).20
Of course, if the true relationship is non-linear so grade-specific effects differ, then differences
between OLS and 2SLS weights may explain at least some of the difference between the two
estimates. For each of the three cases, we examine the extent to which re-weighting the OLS
estimates of the βj ’s helps reconcile the difference between the potentially mis-specified OLS and
2SLS estimates that assume uniform grade-specific effects. We then test whether schooling is
exogenous using both the standard Hausman test and our proposed test.
         Results are reported in Table 1.21 Columns 1 and 2 reproduce OLS and 2SLS estimates using
the same models and similar data used in the original papers. For example, the first row indicates
that using the Lochner and Moretti (2004) data for white men, a regression of an indicator for
    19
         The instruments used in these examples have been employed in numerous studies examining a wide array of
outcomes. See, e.g. Lochner (2011).
  20
     In two of the applications we consider (Lochner and Moretti 2004, Currie and Moretti 2003), the outcome variables
are binary and a linear probability model is assumed by the authors. Heteroskedasticity of errors does not pose any
problems for our test; however, our assumption of separability between all regressors and measures of schooling
is questionable in more general binary choice models for well-known reasons. We simply follow the specifications
employed in the earlier studies, assuming the data are consistent with a linear probability model. This may not be
unreasonable in these applications given the limited range of predicted outcome probabilities across values of the
regressors – assuming an index model based on equation (2), the density for the error may be (approximately) linear
over the range of estimated index values.
  21
     Details regarding samples and estimating specifications are reported in the bottom of Table 1.



                                                         15
incarceration on years of schooling and controls yields an OLS coefficient equal to -.0010, and a
2SLS coefficient equal to -.0011. The 2SLS estimates use as instrumental variables three indicators
for different compulsory schooling ages. The difference between OLS and 2SLS is reported in
column 3. The 2SLS estimate is about 10% larger than the OLS estimate (in absolute value),
even though most reasonable explanations for the endogeneity of schooling suggest that the OLS
estimate should overstate the importance of schooling. The corresponding OLS and 2SLS estimates
for Blacks are -.0037 and -.0048, respectively.
       There are several well-understood reasons why one might find a larger 2SLS estimate (relative to
the OLS estimate), including the presence of measurement error and individual-level heterogeneity
in the effects of schooling. It is also possible that non-linearity in the incarceration-schooling
relationship may play a role. This seems particularly relevant here given the pattern of OLS
estimates for the grade-specific effects βj reported in Figures 1 and 2. If the assumption of uniform
grade-specific effects were correct and these estimates were consistent, all of the estimated β̂j should
be the same. Instead, the estimated β̂j suggest that the marginal effects of different grade transitions
vary considerably across years of schooling. Unless there are much stronger biases for some grades
than others, the figures suggest strong non-linearities in the relationship between imprisonment
and schooling, with the strongest effect for high school graduation (moving from grade 11 to 12).22
Based on these findings, Lochner and Moretti (2004) suggest that high school graduation is an
important margin for incarceration among men, but they are hesitant to draw strong conclusions
from these OLS estimates due to concerns about endogeneity.
       The lines in Figures 1 and 2 report estimates of the OLS and 2SLS weights, as defined in
Section 2. These weights are clearly very different for white men: the OLS weights are high for
years of schooling between 12 and 16, while the 2SLS weights are highest at 12 years of schooling,
implying that the effect of moving from 11 to 12 years of schooling figures prominently in the 2SLS
estimates. This is not surprising, since the instruments adopted (compulsory schooling laws) are
most effective at shifting schooling levels just before or at high school graduation. For black men,
the effect of compulsory schooling is strong at earlier grades, so that the weights are more shifted
to the left. In column 4 of Table 1, we re-weight the estimated grade-specific effects (β̂j ) using the
  22
       Standard errors for the βj estimates are all less than 0.001 (0.003) for whites (Blacks) except for the first two
grade levels. Estimates along with their standard errors are reported in Online Appendix Table C1. For comparison,
we also report average marginal effects from analogous logit specifications in Online Appendix Table C2. The pattern
of effects is quite similar.


                                                            16
2SLS weights in Figure 1.23 For whites, the re-weighted OLS estimates are 0.0012, larger than the
2SLS estimates. The re-weighted OLS estimates are larger, because 2SLS puts more weight on the
large βj associated with moving from 11 to 12 years of schooling. For blacks, the re-weighted OLS
estimate is smaller, because the 2SLS weights are more shifted to the left and, therefore, put less
weight on larger βj .
       The last three columns of Table 1 are the most important, since they report on different tests
for the exogeneity of schooling. Column 5 presents test statistics and associated p-values for our
proposed test of exogeneity (see Theorem 1), which is valid even when the effects of schooling
differ across grades. Columns 6 and 7 present results from the standard Hausman test and the
Durbin-Wu-Hausman test (applied to the linear-in-schooling specification), respectively, which are
both incorrect when the grade-specific effects differ. For white men, our test fails to reject, which
is quite important in practice, since it suggests that our OLS estimates of the βj in Figure 1 are
consistent. Given a high first stage F-statistic of 1000.3 and the fact that the re-weighted OLS
estimate is very close to the 2SLS estimate (a difference of less than 10%), it seems reasonable
to conclude from our OLS estimates of βj that high school completion has the strongest effect on
incarceration rates while college attendance has much weaker effects.24 This is extremely useful,
since with our limited set of instruments, it is impossible to estimate all 20 βj parameters using
2SLS. Indeed, 2SLS estimates from highly restricted two-parameter models that relax linearity in
schooling are very imprecise. Fortunately, our test suggests that IV methods are not necessary in
this case.
       The case of incarceration for black men is different: our test strongly rejects the hypothesis
that the re-weighted OLS and 2SLS estimates are the same (p-value of .0005), while the standard
Hausman test fails to reject. Re-weighting the OLS estimates for the βj parameters reveals that
the OLS estimates are significantly biased towards zero, on average, since the re-weighted OLS
estimate is -.0007 compared to the 2SLS estimate of -.0048. In this case, we cannot draw any strong
conclusions about the relative importance of different grades due to these biases. These findings
empirically demonstrate that when grade-specific effects may differ, the standard Hausman test
  23
       The standard error for this re-weighted effect is derived using the delta-method and the estimated covariance
matrix V̂ defined in Section 3.
 24
    See Online Appendix Table C1 for coefficient estimates and their standard errors. While it is possible that some
β̂j are biased upwards and others downwards so as to perfectly offset when the 2SLS weights are applied, this seems
highly unlikely given the economics of the problem (see, e.g., Lochner and Moretti (2004)).



                                                          17
can fail to detect an endogeneity problem when one exists.
    In the second panel, we turn to estimates of the effect of maternal schooling on infant health
from Currie and Moretti (2003). The instrument in this case is an indicator for college proximity.
(First stage F-statistics for the instruments are 398.7.) In this case, the re-weighted OLS estimates
(column 4) are generally quite similar to the OLS estimates (column 1). Looking at Figures 3 and
4, it is clear why: the OLS and 2SLS weights are nearly identical. Not surprisingly, our test and the
standard Hausman test produce very similar test statistics and the same conclusions: exogeneity
cannot be rejected for either child health outcome.
    Finally, in the bottom panel, we turn to estimates of the private return to schooling using
three dummies for compulsory schooling as instruments. While this analysis is based on that of
Acemoglu and Angrist (2000), we consider the effects of schooling on log annual earnings rather
than weekly wages for white men in their 40s. Figure 5 reports the OLS estimates of the βj
parameters as well as the OLS and 2SLS weights. OLS estimates indicate that an additional year
of schooling translates into an 8.2% increase in annual earnings, while the 2SLS estimates suggest
a much larger return. The re-weighted OLS estimates fall in between the OLS and 2SLS estimates,
although they are much closer to the OLS estimates. The effect of re-weighting is minor despite
substantially different OLS and 2SLS weights. Our test rejects the hypothesis that the re-weighted
OLS and 2SLS estimates are equal, even though the instruments are not particularly strong in this
application (the first stage F-statistic for the instruments is only 29.5).


5    Conclusions

    In applied work, OLS and IV estimates often differ. In many cases, the sign of the difference
is surprising given economic theory and plausible assumptions about the direction of endogeneity
bias. Influential work by Angrist and Imbens (1994, 1995) and Heckman and Vytlacil (2005) has
clarified the interpretation of IV estimates as a local average treatment effect when the regression
parameter of interest varies across individuals. Our work complements the existing understanding
of the differences between IV and OLS estimates when the model is mis-specified.
    We consider a specific class of models with a single finite-valued discrete endogenous regressor,
exogenous regressors that are additively separable and enter linearly, and coefficients that do not
vary across individuals. Models of this type are widely used in empirical research to study the



                                                  18
effects of multi-valued program treatments, drug dosage levels, and schooling attainment. We
focus attention on the possibility that per-unit treatment effects vary across levels of treatment.
       The growing focus on identification of causal effects in economics has led many researchers
to estimate models of this type using IV methods. Yet, due to the limited availability of valid
instruments, it is common to estimate models that assume uniform per-unit treatment effects even
when those effects are likely to vary across treatment levels as frequently suggested by more general
specifications estimated using OLS. We show that, in this case, OLS and IV/2SLS estimators
identify different weighted averages of all per-unit effects, which can lead to incorrect conclusions
about endogeneity when using a standard Hausman test.25
       The main contribution of this paper is to develop a simple generalization of the Hausman test
to assess whether differential weighting and variable per-unit treatment effects can explain the
difference between OLS and IV/2SLS estimators. Within the class of models under consideration,
this serves as a specification test for exogeneity under reasonable conditions. Conveniently, this
test only requires a single instrument, making it useful in many applications.


References

       Daron Acemoglu and Joshua D. Angrist. “How Large are Human-Capital Externalities? Evi-
dence from Compulsory-Schooling Laws,” in NBER Macroeconomics Annual 2000, Vol. 15, 9–74,
National Bureau of Economic Research, 2001.
       Angrist, D. Joshua, Kathryn Graddy, and Guido W. Imbens. “The Interpretation of Instrumen-
tal Variables Estimators in Simultaneous Equations Models with an Application to the Demand
for Fish,” Review of Economic Studies, 67, 499–527, 2000.
       Angrist, D. Joshua, and Guido W. Imbens. “Two-Stage Least Squares Estimation of Average
Causal Effects in Models with Variable Treatment Intensity,” JASA, 90, 431–442, 1995.
       Card, David. “Using Geographic Variation in College Proximity to Estimate the Return to
Schooling” in “Aspects of Labour Economics: Essays in Honour of John Vanderkamp”, edited by
Louis Christofides, E. Kenneth Grant and Robert Swindinsky. University of Toronto Press. 1995.
  25
       Other important concerns include the strength and exogeneity of the instrument(s). Our approach, abstracts
from instrument-related problems, instead addressing problems associated with mis-specification in the structural
equation if at least one exogenous instrument is available.




                                                         19
   Card, David. “The Causal Effect of Education on Earnings”. In Orley Ashenfelter and David
Card, editors, Handbook of Labor Economics Volume 3A. Amsterdam: Elsevier, 1999.
   Carneiro, Pedro, James Heckman and Edward Vytlacil. “Evaluating Marginal Policy Changes
and the Average Effect of Treatment for Individuals at the Margin,” Econometrica, 78(1), 2010.
   Currie, Janet, and Enrico Moretti. “Mother’s Education and the Intergenerational Transmission
of Human Capital: Evidence from College Openings,” Quarterly Journal of Economics, 118(4),
2003.
   Guggenberger, Patrik. “The Impact of a Hausman Pretest on the Asymptotic Size of a Hy-
pothesis Test,” Econometric Theory, 26, 369–82, 2010.
   Hausman, J.A. “Specification Tests in Econometrics”, Econometrica, 46(6), 1251-71, 1978.
   Heckman, James J., and Edward Vytlacil, “Instrumental Variables Methods for the Correlated
Random Coefficient Model,” Journal of Human Resources, 33(4), 1998.
   Heckman, James J., and Edward Vytlacil. “Structural Equations, Treatment Effects, and
Econometric Policy Evaluation,” Econometrica, Econometric Society, vol. 73(3), 669–738, 2005.
   Heckman, James J., Lance Lochner, and Petra Todd. “Earnings Functions and Rates of Re-
turn,” Journal of Human Capital, 2(1), 2008.
   Imbens, Guido, and Joshua Angrist. “Identification and Estimation of Local Average Treatment
Effects,” Econometrica, 62(2), 1994.
   Hungeford, Thomas, and Gary Solon. “Sheepskin Effects in the Returns to Education,” Review
of Economics and Statistics, 1987.
   Jaeger, David, and Marianne Page. “Degrees matter: New Evidence on Sheepskin Effects in
the Returns to Education”, Review of Economics and Statistics, 78(4), 1996.
   Kling, Jeffrey. “Interpreting Instrumental Variables Estimates of the Returns to Schooling”,
Journal of Business and Statistics, 2000.
   Lochner, Lance. “Nonproduction Benefits of Education: Crime, Health, and Good Citizenship,”
in E. Hanushek, S. Machin, and L. Woessmann (eds.), Handbook of the Economics of Education,
Vol. 4, Ch. 2, Amsterdam: Elsevier Science, 2011.
   Lochner, Lance, and Enrico Moretti. “The Effect of Education on Criminal Activity: Evidence
from Prison Inmates, Arrests and Self-Reports”, NBER Working Paper No. 8605, 2001.
   Lochner, Lance, and Enrico Moretti. “The Effect of Education on Criminal Activity: Evidence
from Prison Inmates, Arrests and Self-Reports”, American Economic Review. 94(1), 2004.


                                               20
   Lochner, Lance, and Enrico Moretti. “Estimating and Testing Non-Linear Models Using In-
strumental Variables” NBER Working Paper No. 17039, 2011.
   Moffitt, Robert. “Estimating Marginal Treatment Effects in Heterogeneous Populations,” An-
nales dEconomie et de Statistique, Special Issue on Econometrics of Evaluation, Fall 2009.
   Mogstad, Magne, and Matthew Wiswall. “Linearity in Instrumental Variables Estimation:
Problems and Solutions,” Working Paper, 2010.
   Park, Jin Heun. “Estimation of Sheepskin Effects Using the Old and New Measures of Educa-
tional Attainment in the CPS,” Economic Letters 62, 1999.
   White, Halbert, “Consequences and Detection of Misspecified Nonlinear Regression Models,”
Journal of the American Statistical Association, 76, 419–33, 1981.
   Wong, Ka-fu. “Effects on Inference of Pretesting the Exogeneity of a Regressor,” Economic
Letters, 56, 267–71, 1997.
   Wooldridge, Jeffrey. “On Two Stage Least Squares Estimation of the Average Treatment Effect
in Random Coefficient Models,” Economics Letters, 56, 1997.
   Yitzhaki, Shlomo. “On Using Linear Regressions in Welfare Economics, Journal of Business
and Economic Statistics, 14, 478–486, 1996.




                                               21
              Table 1: Replication Results and Application of Wald Test for Endogeneity


                                                                          General Wald     Hausman Test   DWH Test
                                                                          Test Statistic     Statistic     Statistic
                       L         L         L       L
                                                          P
                     β̂OLS     β̂2SLS    β̂OLS − β̂2SLS     j   ω̂j β̂j     [p-value]        [p-value]     [p-value]

1. Lochner & Moretti (2004): Effect of Years of Schooling on Imprisonment

  White Males       -0.0010    -0.0011       -0.0002       -0.0012            0.0225          0.2021        0.1600
                   (0.0000)   (0.0004)      (0.0004)      (0.0000)           [0.8808]        [0.6530]      [0.6858]

  Black Males       -0.0037    -0.0048       -0.0011       -0.0007           11.9441          0.9757        0.5154
                   (0.0001)   (0.0012)      (0.0011)      (0.0002)           [0.0005]        [0.3233]      [0.4728]

2. Currie & Moretti (2003): Effect of Maternal Education on Infant Health

Low birth weight    -0.0050    -0.0098       -0.0048       -0.0053            1.4376          1.7022        1.5566
                   (0.0001)   (0.0038)      (0.0037)      (0.0002)           [0.2305]        [0.1920]      [0.2122]

 Pre-term birth     -0.0044    -0.0104       -0.0060       -0.0046            1.7639          2.0472        1.7749
                   (0.0002)   (0.0044)      (0.0042)      (0.0002)           [0.1841]        [0.1525]      [0.1828]

3. Acemoglu & Angrist (2001): Private Returns to Schooling

Annual Earnings     0.0822     0.1442        0.0620        0.0832             5.7093          6.0028        6.0218
                   (0.0003)   (0.0256)      (0.0253)      (0.0017)           [0.0169]        [0.0143]      [0.0141]

Notes: The first four columns report estimates for reported parameters with standard errors in parentheses.
Columns for General Wald Test, Hausman, and Durbin-Wu-Hausman (DWH) Test report test statistics
                                                                                   L
                                                                                              P
[p-values] for the null hypothesis of exogeneity. General Wald Test compares β̂2SLS      and j ω̂j β̂j as
                                                                            L
described in Theorem 1, while the Hausman and DWH Tests compare β̂2SLS           and β̂LOLS . Specifications
for Lochner and Moretti (2004) use men ages 20-60 from the 1960-80 U.S. Censuses and include indicators
for three-year age categories, year, state of birth, and state of residence. Specifications for blacks also
include an indicator for whether the individual turned age 14 after 1957 and was born in the South.
Specifications from Currie and Moretti (2003) use first-time white mothers ages 24-35 from Vital Statistics
Natality records from 1970 to 1999 and include median county income, percent urban in county when the
mother was 17, and indicators for ten-year birth cohorts, mother’s age, and county-specific year of child’s
birth effects. Specifications for Acemoglu and Angrist (2001) results differ slightly from theirs, since we
only use compulsory attendance indicators for instruments and do not estimate the ‘social return’ to
schooling. Specifications use 40-49 year-old white men from the 1960-80 U.S. Censuses and include
indicators for Census year, year of birth, state of birth, and state of residence.



                                                   22
                  Figure 1: Effects of Schooling on the Probability of Incarceration for White
                                       Males (OLS Estimates and Weights)
          0.18                                                                                   0.008

          0.16
                                                                                                 0.006
          0.14
                                                                                                 0.004
          0.12

          0.10                                                                                   0.002
Weights




                                                                                                          OLS βj
          0.08                                                                                   0.000
          0.06
                                                                                                 -0.002
          0.04
                                                                                                 -0.004
          0.02

          0.00                                                                                   -0.006
                  1    2   3   4    5    6      7     8 9 10 11 12 13 14 15 16 17 18
                                                     years of schooling

                                   OLS βj                  2SLS Weights     OLS Weights


                  Figure 2: Effects of Schooling on the Probability of Incarceration for Black
                                      Males (OLS Estimates and Weights)
          0.16                                                                                   0.014

          0.14
                                                                                                 0.009
          0.12
                                                                                                 0.004
          0.10
                                                                                                 -0.001
          0.08
Weights




                                                                                                          OLS βj

          0.06                                                                                   -0.006

          0.04
                                                                                                 -0.011
          0.02
                                                                                                 -0.016
          0.00
                   1   2   3   4     5      6   7      8     9   10 11 12 13 14 15 16 17 18      -0.021
          -0.02
                                                    years of schooling
          -0.04                                                                                  -0.026

                                   OLS βj               2SLS Weights       OLS Weights
                    Figure 3: Effects of Maternal Schooling on the Probability of Low Birth
                                      Weight (OLS Estimates and Weights)
          0.25                                                                                              0.06


          0.20                                                                                              0.04


          0.15                                                                                              0.02
Weights




                                                                                                                    OLS βj
          0.10                                                                                              0.00


          0.05                                                                                              -0.02


          0.00                                                                                              -0.04
                   1    2   3    4     5      6     7    8   9    10    11   12    13   14   15   16   17
                                              years of maternal schooling
          -0.05                                                                                             -0.06

                                     OLS βj              2SLS Weights              OLS Weights


                  Figure 4: Effects of Maternal Schooling on the Probability of Pre-Term Birth
                                          (OLS Estimates and Weights)
          0.25                                                                                              0.06


          0.20                                                                                              0.04


          0.15                                                                                              0.02
Weights




                                                                                                                    OLS βj

          0.10                                                                                              0.00


          0.05                                                                                              -0.02


          0.00                                                                                              -0.04
                   1    2   3    4     5      6     7    8   9    10    11   12    13   14   15   16   17
                                                  years of maternal schooling
          -0.05                                                                                             -0.06

                                 OLS βj                 2SLS Weights              OLS Weights
                      Figure 5: Effects of Schooling on Log Annual Earnings for Men
                                       (OLS Estimates and Weights)
          0.30                                                                                          0.30

          0.25                                                                                          0.25

          0.20                                                                                          0.20

          0.15                                                                                          0.15

          0.10                                                                                          0.10
Weights




                                                                                                                OLS βj
          0.05                                                                                          0.05

          0.00                                                                                          0.00
                  1   2   3   4     5      6   7    8    9   10     11   12    13   14   15   16   17
          -0.05                                                                                         -0.05
                                               years of schooling
          -0.10                                                                                         -0.10

          -0.15                                                                                         -0.15

                                  OLS βj           2SLS Weights               OLS Weights
Online Appendix A: Proofs and Technical Results

   This is an online appendix for Lochner and Moretti (2012) that provides proofs of key propo-
sitions and theorems along with a few other technical results discussed in the paper.

Proof of Proposition 1
                                                         p                   N            p
                                                                         1
   It is straightforward to show that ω̂jIV → ωjIV , since
                                                                             P
                                                                         N         z̃i Dij → E(Dij ζi ) = P r(si ≥
                                                                             i=1
                       N          p
                   1
                             z̃i s̃i → E(ηi zi ) which is assumed to be non-zero, and ω̂jIV and ωjIV sum
                       P
j)E(ζi |si ≥ j),   N
                       i=1
                                                                                                      1    0   p
to one over j = 1, ..., S. The assumptions E(εi zi ) = 0 and E(εi xi ) = 0 imply that                 N (z̃ ε) →   0.
This proves the first part of the result.
   To prove the second part of the result, note that the assumption E(zi |xi ) = x0i δz implies
           N             N
         1 X           1 X                   p
             z̃i Dij =     [zi − xi δ̂z ]Dij → E[(zi − E(zi |xi ))Dij ] = E{Cov(zi , Dij |xi )},
         N             N
            i=1                  i=1

                             p
where δ̂z = (x0 x)−1 x0 z → δz . Denoting the density function for zi conditional on xi by Fz|x (·|·), the
                    R
Cov(zi , Dij |xi ) = [ϕ − E(ϕ|x)]P r(Dij = 1|zi = ϕ, xi )dFz|x (ϕ|xi ) is non-negative for all xi and j if
∂P r(Dij = 1|zi , xi )/∂z ≥ 0 for all xi and j. This is ensured by Assumption 2. Using the fact that
the weights sum to one concludes the proof.
QED

More Interpretable Weights

   With a binary instrument, the ωjIV (xi ) weights can be more easily interpreted along the lines
of the LATE analysis of Angrist and Imbens (1995). For zi ∈ {0, 1} and π(xi ) ≡ P r(zi = 1|xi ),

        Cov(zi , Dij |xi ) = π(xi )[1 − π(xi )][P r(Dij = 1|zi = 1, xi ) − P r(Dij = 1|zi = 0, xi )].

In this case, the x-specific weights simplify to

                                        P r(Dij = 1|zi = 1, xi ) − P r(Dij = 1|zi = 0, xi )
                   ωjIV (xi ) =       S
                                                                                               .
                                      P
                                         [P r(Dik = 1|zi = 1, xi ) − P r(Dik = 1|zi = 0, xi )]
                                   k=1

Thus, βIV (xi ) weights each βj based on the fraction of all grade increments induced by a change
in the instrument (conditional on xi ) that are due to persons switching from less than j to j or
more years of school. The effects of grade transitions at schooling levels that are unaffected by the

                                                             1
instrument receive zero weight. The IV estimator for the full sample weights each of the x-specific
estimators according to the relative covariance of schooling with the outcome measure conditional
on the value of xi .
       Under Assumptions 1 and 2, if E(xi |zi ) = E(xi ), then the weights in equations (3) or (4)
simplify considerably, becoming independent of xi :
                      P r(Dij = 1|zi = 1) − P r(Dij = 1|zi = 0)                       P r[si (0) < j ≤ si (1)]
           ωjIV =   S
                                                                                =    S
                                                                                                                      .26
                    P                                                                P
                        [P r(Dik = 1|zi = 1) − P r(Dik = 1|zi = 0)]                        P r[si (0) < k ≤ si (1)]
                    k=1                                                              k=1

The additional mean independence assumption E(xi |zi ) = E(xi ) may apply naturally to many
‘natural experiments’, making this simple expression useful in those contexts. The resulting weights
reflect the fraction of all grade increments induced by a change in the instrument that are due to
persons switching from less than j to j or more years of school. The IV estimator, therefore,
identifies the average effect of an additional year of schooling, where the average is taken across
all grade increments induced by the instrument. If individuals change schooling no more than one
grade in response to a change in the value of the instrument, then the IV estimator reflects the
average marginal effect of an additional year of school among individuals affected by the instrument.

Proof that OLS Weights are Non-negative in Corollary 1

       To see that the OLS weights are always non-negative, note that the numerator for ωjOLS equals
E(ηi Dij ). To see that this is non-negative, notice that
                                                                                 0
                                Z∞ Z∞                                   Z∞ j−φ
                                                                            Z δs
                     E(ηi ) =                     ηdFη|x (η|φ)dFx (φ) +         ηdFη|x (η|φ)dFx (φ),                         (16)
                                −∞   j−φ0 δ   s                         −∞ −∞

where Fx (·) reflects the density of xi and Fη|x (·|·) the density of ηi conditional on xi . Assuming xi
includes a constant term, E(ηi ) = 0. Since the first term in equation (16) is clearly greater than
or equal to the second term and their sum is zero, the first term must be non-negative. Of course,
the first term equals E(ηi Dij ).
QED

Proof of Proposition 2
                                                                                        p
       First, note that ŝ0 Mx ŝ = s0 Mx z(z 0 Mx z)−1 z 0 Mx s. Since,       1 0
                                                                               N s Mx z →      E[(si −x0i δs )zi0 ] = E(ηi zi0 ) 6=
                                 1 0               p
0 by Assumption 1 and            N z Mx z          → E[zi (zi0 − x0i δz )] = E(zi ζi0 ) = E(ζi ζi0 ), which is full rank by
  26
       See the Appendix of Locher and Moretti (2011) for a proof of this result.


                                                                  2
Assumption 3, the denominator for ωj is non-zero.
         S
           ŝ0 Mx Dj = ŝ0 Mx s = ŝ0 Mx ŝ, both ω̂j and ωj sum to one. Now, consider the numerator
         P
   Since
            j=1
for ω̂j :
                                                                        I
                                              1 0 0         p X
                                                θ̂z z Mx Dj →   θz` E(Dij ζi` ),
                                              N
                                                                     `=1

where θz` corresponds to the θz coefficient on zi` . Since the ωj sum to one, we can write
                                                            I
                                                            P
                                                                  θz` E(Dij ζi` )
                                                        `=1
                                             ωj   =   S P I
                                                      P
                                                                   θzm E(Dik ζim )
                                                      k=1 m=1
                                                       I                    S
                                                                                               
                                                                    IV
                                                      P                     P
                                                            θz`    ωj`            E(Dik ζi` )
                                                      `=1                   k=1
                                                  =     S P
                                                          I
                                                        P
                                                                        θzm E(Dik ζim )
                                                        k=1 m=1
                                                      I                 S
                                                                                     
                                                             IV
                                                      P                 P
                                                            ωj`     θz`   E(Dik ζi` )
                                                      `=1                k=1
                                                  =       I             S
                                                          P             P
                                                                  θzm         E(Dik ζim )
                                                        m=1             k=1
                                                      I
                                                      X
                                                                IV
                                                  =         Ω` ωj`
                                                      `=1

       IV =            E(Dij ζi` )
where ωj`             S
                      P
                                      since E(Dij ζi` ) = P r(si ≥ j)E(ζi` |si ≥ j). Substituting the latter in
                        E(Dik ζi` )
                  k=1
where it appears above, Ω` is given by equation (9).
                            1 0          p
    Also, note that            → θz [E(zi εi ) + E(zi x0i )E(xi x0i )E(xi εi )] = 0, since E(εi xi ) = 0 and
                            N ŝ Mx ε
                                        p P S
                                   L
E(zi εi ) = 0. This implies that β̂2SLS →      ωj βj .
                                                      j=1
    Finally, it is clear from the proof of Proposition 1 that if each instrument satisfies Assumption 2
and E(zi` |xi ) = x0i δz` , then all Ω` , ωj`
                                           IV , and ω are non-negative.
                                                     j

QED

Proof of Theorem 1

    Proposition 2 shows that the 2SLS estimator from equation 1 converges to a “weighted average”
of the true βj ’s with the “weights”, ω = (ω1 , ..., ωS )0 , consistently estimated by 2SLS estimation of
                                  p                     p                                           p
equation (8). That is, ω̂ → ω and β̂ 2SLS → ω 0 B. If E(εi |si ) = 0, then B̂ → B, which implies that
                  p
  L
β̂2SLS − ω̂ 0 B̂ → 0.

                                                                    3
       We write the estimation problems for equations (2), (1), and (8) in the form of a stacked linear
GMM problem. (Note that equation (2) is estimated using OLS while the remaining equations are
                                                                  L
estimated using 2SLS.) This establishes joint normality of (B̂, β̂2SLS , ω̂) in the limit and facilitates
estimation of their covariance matrix. A straightforward application of the delta-method yields
                       L
the variance of T̂ ≡ β̂2SLS − ω̂ 0 B̂, which is used in deriving a chi-square test statistic for the null
                         p
hypothesis that T̂ → 0.
       Diagonally stack the regressor and instrument vectors for all equations as follows:
                                                                             
                               X1i      0                        X1i      0
                      Xi =                    and Zi =                       ,
                                0 I2 ⊗ X2i                        0 I2 ⊗ Z2i
where I2 is an identity matrix of dimension S + 1 and 0’s reflect conformable vectors of zeros. Next,
define Yi = (yi yi Di0 )0 and Ui = (εi νi Ψ0i )0 , where Ψi = (ψ1i ψ2i ... ψSi )0 . Recall from Section 3
that Θ = (B 0 γ 0 β L γ L0 ω10 α10 ... ωS0 αS0 )0 is the full set of parameters to be estimated. (Θ̂ reflects
the corresponding vector of parameter estimates). Now, the three sets of estimating equations can
be compactly re-written as:
                                                             Yi = Xi Θ + Ui .

       Equation-by-equation estimation of (2), (1), and (8) (the first by OLS and the second and third
by 2SLS) is mathematically equivalent to GMM estimation for this system:
                            "N                 #0 " N               #
                             X                     X
                                   0                   0
                       min       Zi (Yi − Xi Θ) Ω̂    Zi (Yi − Xi Θ) ,
                                   Θ
                                         i=1                                    i=1
                                                      N
                                                                      −1
                                                                            p
                                                   1
                                                             Zi0 Zi         → [E(Zi0 Zi )]−1 ≡ Ω. Stacking all individual-
                                                       P
using the weighting matrix Ω̂ =                    N
                                                       i=1
specific matrices into large matrices and using matrix notation, this system GMM estimator is
                          −1 0
Θ̂ = X 0 Z(Z 0 Z)−1 Z 0 X    X Z(Z 0 Z)−1 Z 0 Y .
     

   Standard results in GMM estimation (under the assumptions specified in Theorem 1) imply
    √            d
that N (Θ̂ − Θ) → N (0, V ) where

                                         V     = (C 0 ΩC)−1 C 0 ΩΛΩC(C 0 ΩC)−1

                                         C = E(Zi0 Xi )

                                         Λ = E(Zi0 Ui Ui0 Zi )

and Ω is defined above.27
  27
   Substituting in for C and Ω and simplifying yields
                                        −1                                                                                           −1
V = E(Xi0 Zi )[E(Zi0 Zi )]−1 E(Zi0 Xi )    E(Xi0 Zi )[E(Zi0 Zi )]−1 Λ[E(Zi0 Zi )]−1 E(Zi0 Xi ) E(Xi0 Zi )[E(Zi0 Zi )]−1 E(Zi0 Xi )
                                                                                             
                                                                                                                                          .


                                                                        4
    Letting Γ̂ = (Z 0 Z)−1 Z 0 X, X̂i = Zi Γ̂, and Ûi = Yi − Xi Θ̂, the covariance matrix V can be
consistently estimated by
                                                                                  p
                                             V̂ = [X̂ 0 X̂]−1 Γ̂0 Λ̂Γ̂[X̂ 0 X̂]−1 → V,

where
                                                            N
                                                          1 X 0                 p
                                                   Λ̂ =       (Zi Ûi Ûi0 Zi ) → Λ.
                                                          N
                                                             i=1

Due to the ‘diagonal’ structure of Xi and Zi , it is possible to simplify the expressions for V̂ , Â, and
Λ̂ as provided in equations (10), (11) and (12) in the text.
    Standard application of the delta-method implies that the variance of T (Θ̂) can be estimated
by ĜV̂ Ĝ0 , where Ĝ is the jacobian vector for T (Θ̂) as defined in the text. With this, it is clear that

                                                                             d
                                                 WN = N T̂ 0 [ĜV̂ Ĝ0 ]−1 T̂ → χ2 (1),

which can be more simply written as equation (13).
QED

Ordered Choice Model

    Assume schooling is determined by the ordered choice model defined by equations (14) and (15)
in the paper. Then, the sign of the asymptotic bias for OLS estimation of any βj in equation (2)
depends on the sign of E(εi Dij ) = E(εi |si ≥ j) = E(E[εi |vi , zi , xi , vi ≥ j − µ(zi , xi )]).
    For illustrative purposes, consider the case in which the bias is non-negative.                           Clearly, if
                           ∂E(εi |vi ,zi ,xi )
E(εi |zi , xi ) = 0 and          ∂v               ≥ 0, then E[εi |vi , zi , xi , vi ≥ j − µ(zi , xi )] ≥ 0 for any j. Fur-
thermore, if (εi , vi ) ⊥⊥ (zi , xi ), then E(εi |vi ) = E(εi |vi , zi , xi ). Altogether, if (εi , vi ) ⊥⊥ (zi , xi )
      ∂E(εi |vi )
and     ∂v          ≥ 0, then E(εi Dij ) ≥ 0 for all j. This implies that the asymptotic bias from OLS
estimation will be non-negative for all βj parameters.




                                                                   5
Online Appendix B: Monte Carlo Analysis

       This is an online appendix for Lochner and Moretti (2012) that provides a Monte Carlo analysis
of the test developed in that paper. We first show how varying the degree of non-linearity between
yi and si can induce differences between the OLS and the IV estimates, even in the absence of
endogeneity bias. We further show that our exogeneity test accounts for this while the more
standard Durbin-Wu-Hausman test (applied to IV and OLS estimates of β L in equation 1) does
not. Second, we discuss inference in a two stage procedure in which our exogeneity test is applied
in a first stage and, if exogeneity cannot be rejected, OLS estimates from equation (2) are used to
conduct inference in a second stage.

General Setup

       As a setting, we consider a modified version of Card’s (1995) model of investment in human
capital. An individual chooses schooling si to maximize Vi (si ) = log[yi (si )] − Ci (si ) where yi (si )
is earnings and Ci (si ) is cost of schooling. We assume that the relation between log earnings and
schooling is non-linear by allowing for jumps of size κ in earnings at an arbitrary schooling level J

                                   log[yi (si )] = a + bsi + κ11(si ≥ J) + εi ,

where κ measures the degree of non-linearity between log earnings and schooling and 11(·) is an
indicator function. A larger κ implies a stronger non-linearity with a greater discrepancy between
the effect of moving from grade J − 1 to J and the effects of all other grade transitions. The
individual-specific cost of schooling is assumed to be

                                                             k2 2
                                    Ci (si ) = c + ri si +     s + κ11(si ≥ J),
                                                             2 i

where the inclusion of κ here means that the non-linearity between schooling and earnings does not
affect schooling choices. This allows us to focus on the extent to which variability in grade-specific
effects influences IV and OLS estimators and our exogeneity test given a fixed set of OLS and IV
weights.28 Finally, we assume that the instrumental variable zi shifts the cost of schooling

                                                   ri = dzi + ηi ,
  28
    Including κ in both the log earnings and cost functions is equivalent to assuming that individuals do not consider
any non-linearities when making their schooling decisions. Although the IV and OLS weights will not vary with κ in
our analysis, they will vary with the extent of ‘endogeneity’ as defined by ρ below.


                                                          1
and that individuals can only choose s ∈ {0, 1, 2, ..., S}. The parameter d relative to the variance
of ηi effectively controls the strength of the instrument.29
       If we let                                                          
                                         εi               0         σε2   σεη
                                              ∼ N         ,               
                                         ηi               0         σεη   ση2
                                                                              σεη
we can control the amount of ‘endogeneity’ by varying ρ =                    σε ση .   Note that we naturally have
monotonicity in the effects of zi on schooling.
       For each independent observation, we randomly draw a binary instrument zi ∈ {0, 1} indepen-
dently from bivariate normally distributed errors (i , ηi ). Given the value of the parameters, the
level of schooling is determined, and realized values of log(yi ) are constructed.
       In all of our simulations, we randomly draw zi with probability P r(zi = 1) = 0.5 and set other
parameters of the model as follows: a = 1.5; b = .04; c = 0; k2 = .003; σε2 = .25; ση2 = .00005;
J = 12; and S = 20. With d = 0.01 and ρ = κ = 0, this set of parameters generates a reasonable
earnings and schooling distribution relative to recent Census years.

Comparing IV and OLS Estimators and our Wald Test vs. the Durbin-Wu-
Hausman Test

       We begin by demonstrating the impacts of variable grade-specific effects on OLS and IV es-
timators when linearity in si is incorrectly assumed. We also consider the properties of our new
exogeneity test along with those of the more standard Durbin-Wu-Hausman test (applied to a
linear-in-si specification) with varying degrees of endogeneity and non-linearity between yi and si .
       Here, we set the sample size N = 1, 000 for each Monte Carlo simulation and use 10,000
simulated samples. For each model, defined by a combination of endogeneity (ρ) and non-linearity
or ‘jump size’ (κ), we compute point estimates and standard errors for the OLS and IV estimators.
Specifically, we estimate the model for all possible combinations of

                             ρ ∈ {0, 0.05, 0.1, 0.15, 0.2} and κ ∈ {0, 0.1, 0.5, 1},

setting d = 0.01 and other parameters as described above.
       Estimation results for these Monte Carlo exercises are shown in Table B1. For each model,
we report the average point estimates and their standard deviation from the simulation samples
  29
    We have made two changes to Card’s original model. First, Card (1995) allows for variation in bi , while we set
bi = b for all i. Second, Card (1995) assumes log earnings are quadratic in schooling. In our case, log earnings are
non-linear in schooling, but non-linearity is parameterized with discrete jumps. This allows for an easier interpretation
of the Monte Carlo estimates.


                                                              2
for OLS and 2SLS estimators from the mis-specified linear-in-schooling model, as well as the re-
weighted OLS estimates (from the more general model that allows for grade-specific schooling
                                           S
                                           P
effects) using the estimated 2SLS weights,   ω̂j β̂j . We next report the fraction of cases where
                                             j=1
we reject the null hypothesis of equality between the IV and re-weighted OLS estimates using the
general Wald test given in Theorem 1. Finally, we report the fraction of cases for which we reject
the null of exogeneity based on the linear-in-schooling specification using the Durbin-Wu-Hausman
(DWH) test. We use the critical value of 3.841 associated with a 0.05 significance level for both
tests. Using our test, we should reject the null hypothesis that the re-weighted OLS estimates equal
the IV estimates 5% of the time when schooling is exogenous (i.e. ρ = 0) regardless of the amount
of non-linearity (i.e. for any value of κ). We only expect to reject the null 5% of the time using the
DWH test when ρ = κ = 0.
   The first row in Table 1 indicates that when the true relation between earnings and schooling
is linear and there is no endogeneity, both OLS and 2SLS estimated returns to schooling are 4%.
The next few rows (all with ρ = 0) indicate that the difference between IV and OLS grows when we
introduce increasingly large non-linearities in the relation between earnings and schooling; however,
re-weighting the OLS estimates accounts for all of the difference. Thus, our test rejects the null
only about 5% of the time as it should. The standard DWH test rejects the null about 5% of the
time for small or no non-linearity (i.e. κ values of 0 and 0.1), but rejects much more frequently as
non-linearity becomes a more important feature of the data. For κ = 1, the DWH test rejects over
40% of the time despite the fact that schooling is exogenous.
   The remaining panels repeat the same exercise progressively increasing the amount of endo-
geneity. While re-weighting the OLS estimates using the IV weights often accounts for much of
the difference between the linear-in-schooling OLS and IV estimates, it does not generally account
for all of the difference. The greater the endogeneity (i.e. the higher is ρ), the more the difference
remains unexplained. Most importantly, our test begins to reject equality of the re-weighted OLS
and IV estimates (i.e. exogeneity of schooling) at noticeably higher rates for even minor deviations
from exogeneity (e.g. ρ = 0.05). For ρ ≥ 0.2, our test almost always rejects exogeneity. Consider,
for example, the set of results with ρ = 0.2. In the linear-in-schooling model (κ = 0), the IV
estimate is basically 0.04; however, the OLS estimate is much lower at 0.012 due to the endogeneity
of schooling. Re-weighting has a negligible effect on the OLS estimate, and we almost always reject
the null of exogeneity. When κ = 1, the linear-in-schooling OLS estimate is still smaller than the IV


                                                   3
estimate, but the re-weighted OLS estimate is much closer. The different weights and non-linearity
explain roughly one-third of the difference between linear-in-schooling OLS and IV estimates in
this case. Still, our test correctly rejects the null in almost all cases. In general, the share of
rejections is independent of the amount of non-linearity between log earnings and schooling, but it
is sharply increasing in the degree of endogeneity. It is also important to note that when the true
underlying model is linear in schooling, our more general test has very similar power to the DWH
test: rejection rates for our test are typically less than 2% lower than for the DWH when κ = 0.

Inference in a Two Stage Approach

   We next consider the properties of inference in a two stage approach to estimation. In stage 1,
our exogeneity test is applied. If exogeneity cannot be rejected, researchers may conduct inference
in a second stage using OLS estimates of the βj parameters based on equation (2) in the paper.
In an analogous context with a linear relationship between the outcome variable and endogenous
regressor, Wong (1997) and Guggenberger (2010) demonstrate potential problems with inference
when using this type of two stage approach (they consider the standard Hausman test in the first
stage).
   Because inference problems arise when the instruments are insufficiently strong, we explore this
two stage approach for different values of instrument ‘strength’ by letting the parameter d vary
from 0.002 to 0.01. We consider values of ρ ranging from 0 to 0.1, values of κ equal to 0 and 0.1,
and sample sizes of N = 1, 000 as above and N = 10, 000.
   Tables B2 (N = 1, 000) and B3 (N = 10, 000) report average first stage F-statistics (i.e. for
the regression of si on zi ) as a measure of the strength of the instruments for different values of d.
We also report average point estimates and their standard deviations for OLS and 2SLS estimators
from the mis-specified linear-in-schooling model, as well as the re-weighted OLS estimates from
the more general model that allows for varying grade-specific effects. The next column reports the
fraction of cases in which we reject the null hypothesis of equality between the IV and re-weighted
OLS estimates using the exogeneity test given in Theorem 1 (.05 significance level). The last two
columns consider inference about OLS estimates of the βj parameters in cases where we fail to
reject exogeneity. We report the fraction of cases that we reject linearity or equal grade-specific
effects (i.e. β1 = β2 = ... = βS ) and the fraction of cases for which we reject that the OLS estimates
are consistent (i.e. plim B̂ = B) using a .05 significance level in both cases. When ρ = κ = 0,


                                                  4
both tests should reject 5% of the time. When ρ = 0 and κ > 0, the second test should have a 5%
rejection rate, while the first should have a higher rejection rate.
   We highlight a few main lessons from Tables B2 and B3. First, our second stage tests for
non-linearity (i.e. variation in grade-specific effects) and consistency of the OLS estimators for all
βj parameters reject 5% of the time when they should (i.e. when ρ = κ = 0 and ρ = 0, κ = 0.1).
As expected, rejection rates for the test for linearity (i.e. uniform grade-specific effects) are notably
higher (15-16%) when κ = 0.1.
   Second, when the first stage F-statistics are low, our exogeneity test has very little power to
identify modest levels of endogeneity. For example, when N = 1, 000 and d = .003, we fail to
reject exogeneity most of the time even for values of ρ as high as 0.1 yielding a sizeable difference
between the re-weighted OLS estimate and the IV estimate. In these cases, the researcher is likely
to conclude from our test that schooling is exogenous, which then suggests that the OLS estimates
of the βj parameters from equation (2) are consistent. However, as Wong (1997) and Guggenberger
(2010) point out (when using the standard Hausman test in the first stage), inference using the
OLS estimates is likely to have poor size properties. Even a negligible amount of endogeneity (too
small to cause our test to reject exogeneity) is likely to lead one to reject plimB̂ = B when using
the OLS estimates. This problem is reflected in the high rejection rates for the second stage test of
plimB̂ = B even for cases with very low rejection rates with our exogeneity test (e.g. N = 1, 000,
d = 0.003 and ρ = 0.1). These results suggest caution in using OLS estimates for inference when the
instruments are not sufficiently strong even if our test fails to reject exogeneity. Researchers should
be particularly cautious when the IV and re-weighted OLS estimates are quite different but the
IV estimates are very imprecise. It is reassuring that these problems disappear as the instrument
becomes stronger as observed for larger values of d and first stage F-statistics. It is also the case
that our rejection rates for the test of linearity are largely independent of ρ (and d) suggesting that
endogeneity of s appears to bias all βj estimates by a similar amount in our context.




                                                   5
                           Table B1: Monte Carlo Simulations for Card Model
                           Our Exogeneity Test vs. Durbin-Wu-Hausman Test


                                                 General Wald Test    Durbin-Wu-Hausman Test
                                                  (fraction reject,       (fraction reject,
                L          L
                                   P
 ρ     κ      β̂OLS      β̂2SLS        ω̂j β̂j
                                       j           .05 sig. level)          .05 sig. level)
 0     0      0.0399     0.0399     0.0399              0.050                   0.049
             (0.0054)   (0.0096)   (0.0056)
 0     0.1    0.0540     0.0557     0.0556             0.051                    0.054
             (0.0054)   (0.0095)   (0.0056)
 0     0.5    0.1099     0.1180     0.1179             0.056                    0.172
             (0.0057)   (0.0100)   (0.0063)
 0      1     0.1801     0.1961     0.1960             0.047                    0.434
             (0.0063)   (0.0111)   (0.0080)

0.05    0     0.0330     0.0399     0.0332             0.139                    0.144
             (0.0055)   (0.0096)   (0.0057)
0.05   0.1    0.0470     0.0556     0.0489             0.139                    0.206
             (0.0054)   (0.0095)   (0.0056)
0.05   0.5    0.1030     0.1179     0.1112             0.139                    0.472
             (0.0056)   (0.0099)   (0.0063)
0.05    1     0.1729     0.1960     0.1892             0.146                    0.721
             (0.0063)   (0.0111)   (0.0080)

0.1     0     0.0260     0.0402     0.0265             0.428                    0.444
             (0.0054)   (0.0094)   (0.0056)
0.1    0.1    0.0399     0.0557     0.0420             0.430                    0.527
             (0.0055)   (0.0095)   (0.0057)
0.1    0.5    0.0959     0.1179     0.1044             0.424                    0.784
             (0.0057)   (0.0100)   (0.0064)
0.1     1     0.1659     0.1960     0.1823             0.429                    0.911

             (0.0063)   (0.0112)   (0.0081)
0.15    0     0.0191     0.0402     0.0197             0.762                    0.783
             (0.0055)   (0.0096)   (0.0057)
0.15   0.1    0.0331     0.0558     0.0354             0.760                    0.836
             (0.0055)   (0.0096)   (0.0057)
0.15   0.5    0.0890     0.1180     0.0977             0.761                    0.954
             (0.0057)   (0.0100)   (0.0064)
0.15    1     0.1590     0.1962     0.1757             0.763                    0.984
             (0.0063)   (0.0113)   (0.0080)

0.2     0     0.0119     0.0401     0.0129             0.949                    0.956
             (0.0053)   (0.0096)   (0.0055)
0.2    0.1    0.0261     0.0558     0.0286             0.951                    0.971
             (0.0054)   (0.0095)   (0.0056)
0.2    0.5    0.0820     0.1182     0.0910             0.950                    0.995
             (0.0057)   (0.0101)   (0.0064)
0.2     1     0.1519     0.1958     0.1688             0.949                    0.999
             (0.0063)   (0.0112)   (0.0081)

                       L       L
                                          P
Notes: Columns for β̂OLS   , β̂2SLS , and j ω̂j β̂j report the average (standard deviation) of
estimates. Columns for General Wald Test and Durbin-Wu-Hausman (DWH) Test report
the fraction of cases rejecting the null hypothesis of exogeneity using a .05 significance
                                        L
                                                   P
level. General Wald Test compares β̂2SLS     and j ω̂j β̂j as described in Theorem 1, while
                             L
the DWH Test compares β̂2SLS      and β̂LOLS . A sample size of N = 1, 000 is used for all
simulation samples.
                              Table B2: Monte Carlo Simulations for Card Model
                         Inference Using OLS Estimates of Nonlinear Model, N=1,000


                                                                                                                              p
                                                                         Exogeneity Test     Testing βj = β      Testing B̂ → B
                     First-Stage                                         (fraction reject,   (fraction reject,   (fraction reject,
                                      L          L       P
 d       ρ     κ     F-Statistic    β̂OLS      β̂2SLS      j   ω̂j β̂j    .05 sig. level)     .05 sig. level)     .05 sig. level)

0.002    0     0       20.75        0.0401     0.0398     0.0402              0.025               0.051               0.052
                                   (0.0066)   (0.0520)   (0.0090)
         0     0.1     20.50        0.0538     0.0538     0.0538              0.027               0.155               0.049
                                   (0.0066)   (0.0529)   (0.0093)
        0.01   0       20.70        0.0379     0.0399     0.0380              0.027               0.052               0.051
                                   (0.0066)   (0.0520)   (0.0089)
        0.01   0.1     20.63        0.0518     0.0546     0.0519              0.024               0.158               0.055
                                   (0.0067)   (0.0530)   (0.0095)
        0.03   0       20.69        0.0338     0.0402     0.0339              0.027               0.051               0.071
                                   (0.0066)   (0.0520)   (0.0089)
        0.03   0.1     20.60        0.0477     0.0543     0.0478              0.029               0.157               0.067
                                   (0.0066)   (0.0524)   (0.0093)
        0.05   0       20.86        0.0297     0.0402     0.0297              0.030               0.052               0.111
                                   (0.0066)   (0.0524)   (0.0088)
        0.05   0.1     20.53        0.0435     0.0544     0.0435              0.026               0.162               0.110
                                   (0.0066)   (0.0525)   (0.0095)
        0.1    0       20.77        0.0195     0.0414     0.0198              0.040               0.049               0.364
                                   (0.0066)   (0.0523)   (0.0087)
        0.1    0.1     20.58        0.0332     0.0550     0.0335              0.039               0.162               0.366
                                   (0.0066)   (0.0534)   (0.0094)

0.003    0     0       45.35        0.0400     0.0404     0.0400              0.044               0.054               0.054
                                   (0.0066)   (0.0334)   (0.0075)
         0     0.1     45.47        0.0543     0.0545     0.0544              0.039               0.166               0.049
                                   (0.0066)   (0.0330)   (0.0077)
        0.01   0       45.32        0.0380     0.0402     0.0381              0.037               0.050               0.051
                                   (0.0065)   (0.0327)   (0.0074)
        0.01   0.1     45.18        0.0523     0.0545     0.0524              0.040               0.161               0.051
                                   (0.0065)   (0.0330)   (0.0077)
        0.03   0       45.26        0.0339     0.0399     0.0340              0.041               0.053               0.071
                                   (0.0066)   (0.0326)   (0.0075)
        0.03   0.1     45.42        0.0483     0.0544     0.0485              0.044               0.157               0.072
                                   (0.0066)   (0.0328)   (0.0078)
        0.05   0       45.18        0.0298     0.0405     0.0299              0.056               0.050               0.112
                                   (0.0065)   (0.0335)   (0.0075)
        0.05   0.1     45.44        0.0442     0.0541     0.0444              0.049               0.163               0.108
                                   (0.0066)   (0.0332)   (0.0078)
        0.1    0       45.45        0.0200     0.0401     0.0202              0.082               0.047               0.360
                                   (0.0066)   (0.0332)   (0.0075)
        0.1    0.1     45.46        0.0342     0.0542     0.0345              0.078               0.166               0.361
                                   (0.0065)   (0.0329)   (0.0076)
                         Table B2 (continued): Monte Carlo Simulations for Card Model
                          Inference Using OLS Estimates of Nonlinear Model, N=1,000


                                                                                                                                 p
                                                                            Exogeneity Test     Testing βj = β      Testing B̂ → B
                     First-Stage                                            (fraction reject,   (fraction reject,   (fraction reject,
                                       L           L       P
  d      ρ      κ    F-Statistic     β̂OLS       β̂2SLS       j   ω̂j β̂j    .05 sig. level)     .05 sig. level)     .05 sig. level)

0.005     0     0       124.42       0.0400      0.0400     0.0400               0.047               0.046               0.049
                                    (0.0063)    (0.0191)   (0.0066)
          0    0.1      124.68       0.0548      0.0550     0.0552               0.046               0.162               0.052
                                    (0.0063)    (0.0193)   (0.0067)
        0.01    0       124.32       0.0382      0.0402     0.0382               0.045               0.046               0.047
                                    (0.0063)    (0.0190)   (0.0066)
        0.01   0.1      124.13       0.0529      0.0551     0.0534               0.048               0.153               0.053
                                    (0.0063)    (0.0194)   (0.0067)
        0.03    0       124.52       0.0343      0.0401     0.0344               0.060               0.049               0.067
                                    (0.0063)    (0.0193)   (0.0066)
        0.03   0.1      124.31       0.0492      0.0554     0.0497               0.056               0.161               0.070
                                    (0.0064)    (0.0193)   (0.0068)
        0.05    0       124.25       0.0306      0.0401     0.0307               0.081               0.055               0.101
                                    (0.0063)    (0.0194)   (0.0066)
        0.05   0.1      124.55       0.0455      0.0554     0.0460               0.077               0.168               0.103
                                    (0.0063)    (0.0193)   (0.0066)
         0.1    0       124.36       0.0214      0.0402     0.0216               0.176               0.050               0.324
                                    (0.0062)    (0.0194)   (0.0065)
         0.1   0.1      124.53       0.0361      0.0553     0.0365               0.167               0.162               0.329
                                    (0.0063)    (0.0192)   (0.0067)

0.01      0     0       494.95       0.0400      0.0400     0.0401               0.052               0.053               0.049
                                    (0.0055)    (0.0097)   (0.0056)
          0    0.1      494.93       0.0540      0.0557     0.0556               0.046               0.151               0.050
                                    (0.0054)    (0.0095)   (0.0056)
        0.01    0       494.66       0.0385      0.0399     0.0385               0.053               0.050               0.052
                                    (0.0055)    (0.0095)   (0.0056)
        0.01   0.1      494.76       0.0526      0.0557     0.0543               0.054               0.155               0.053
                                    (0.0055)    (0.0096)   (0.0057)
        0.03    0       494.75       0.0359      0.0401     0.0360               0.082               0.048               0.056
                                    (0.0055)    (0.0094)   (0.0056)
        0.03   0.1      494.09       0.0498      0.0557     0.0516               0.083               0.160               0.057
                                    (0.0055)    (0.0096)   (0.0057)
        0.05    0       494.53       0.0330      0.0399     0.0332               0.140               0.053               0.076
                                    (0.0055)    (0.0095)   (0.0057)
        0.05   0.1      494.49       0.0470      0.0557     0.0488               0.148               0.168               0.077
                                    (0.0054)    (0.0096)   (0.0056)
         0.1    0       495.21       0.0260      0.0401     0.0265               0.422               0.053               0.179
                                    (0.0055)    (0.0096)   (0.0057)
         0.1   0.1      494.55       0.0399      0.0555     0.0420               0.421               0.184               0.180
                                    (0.0055)    (0.0096)   (0.0057)

Notes: First-Stage F-statistic reports the average F-statistic from all simulation samples from first-stage regressions
                             L        L         P
of si on zi . Columns for β̂OLS   , β̂2SLS , and j ω̂j β̂j report the average (standard deviation) of estimates. Exogeneity
                   L         P
Test compares β̂2SLS and j ω̂j β̂j as described in Theorem 1. The final two columns report tests for equal grade-
specific effects (i.e. βj = β for all j) and consistency of OLS estimates for all βj in equation (2) using only subsamples
for which we fail to reject exogeneity. The fraction of cases rejecting the null for all tests is reported using a 0.05
significance level. A sample size of N = 1, 000 is used for all simulated samples.
                               Table B3: Monte Carlo Simulations for Card Model
                         Inference Using OLS Estimates of Nonlinear Model, N=10,000


                                                                                                                              p
                                                                         Exogeneity Test     Testing βj = β      Testing B̂ → B
                     First-Stage                                         (fraction reject,   (fraction reject,   (fraction reject,
                                      L          L       P
 d       ρ     κ     F-Statistic    β̂OLS      β̂2SLS      j   ω̂j β̂j    .05 sig. level)     .05 sig. level)     .05 sig. level)

0.002    0     0       197.96       0.0400     0.0397     0.0400              0.051               0.046               0.047
                                   (0.0021)   (0.0152)   (0.0022)
         0     0.1     197.97       0.0538     0.0537     0.0538              0.049               0.985               0.049
                                   (0.0021)   (0.0151)   (0.0023)
        0.01   0       198.61       0.0380     0.0399     0.0380              0.046               0.050               0.070
                                   (0.0021)   (0.0150)   (0.0021)
        0.01   0.1     198.19       0.0517     0.0535     0.0517              0.049               0.986               0.068
                                   (0.0021)   (0.0150)   (0.0023)
        0.03   0       197.88       0.0338     0.0401     0.0338              0.065               0.048               0.334
                                   (0.0021)   (0.0152)   (0.0022)
        0.03   0.1     197.77       0.0476     0.0539     0.0477              0.067               0.984               0.335
                                   (0.0021)   (0.0152)   (0.0023)
        0.05   0       198.51       0.0297     0.0402     0.0297              0.101               0.048               0.814
                                   (0.0021)   (0.0149)   (0.0022)
        0.05   0.1     197.92       0.0435     0.0541     0.0435              0.102               0.981               0.814
                                   (0.0021)   (0.0149)   (0.0023)
        0.1    0       197.95       0.0195     0.0401     0.0195              0.277               0.053               1.000
                                   (0.0021)   (0.0151)   (0.0022)
        0.1    0.1     197.56       0.0332     0.0540     0.0333              0.274               0.984               1.000
                                   (0.0021)   (0.0152)   (0.0023)

0.003    0     0       443.68       0.0400     0.0401     0.0400              0.047               0.047               0.053
                                   (0.0021)   (0.0101)   (0.0021)
         0     0.1     444.48       0.0542     0.0544     0.0543              0.048               0.984               0.053
                                   (0.0021)   (0.0100)   (0.0022)
        0.01   0       444.01       0.0380     0.0398     0.0380              0.053               0.051               0.068
                                   (0.0021)   (0.0101)   (0.0021)
        0.01   0.1     444.92       0.0523     0.0543     0.0524              0.060               0.985               0.069
                                   (0.0021)   (0.0103)   (0.0022)
        0.03   0       444.95       0.0340     0.0399     0.0340              0.091               0.051               0.318
                                   (0.0021)   (0.0100)   (0.0021)
        0.03   0.1     444.17       0.0482     0.0544     0.0484              0.095               0.984               0.324
                                   (0.0021)   (0.0102)   (0.0022)
        0.05   0       444.79       0.0300     0.0400     0.0300              0.171               0.052               0.802
                                   (0.0021)   (0.0101)   (0.0021)
        0.05   0.1     444.10       0.0442     0.0545     0.0444              0.176               0.985               0.805
                                   (0.0021)   (0.0101)   (0.0022)
        0.1    0       444.62       0.0200     0.0400     0.0200              0.529               0.052               1.000
                                   (0.0021)   (0.0100)   (0.0021)
        0.1    0.1     444.86       0.0342     0.0545     0.0344              0.533               0.988               1.000
                                   (0.0020)   (0.0101)   (0.0022)
                         Table B3 (continued): Monte Carlo Simulations for Card Model
                          Inference Using OLS Estimates of Nonlinear Model, N=10,000


                                                                                                                                 p
                                                                            Exogeneity Test     Testing βj = β      Testing B̂ → B
                     First-Stage                                            (fraction reject,   (fraction reject,   (fraction reject,
                                       L           L       P
  d      ρ      κ    F-Statistic     β̂OLS       β̂2SLS       j   ω̂j β̂j    .05 sig. level)     .05 sig. level)     .05 sig. level)

0.005     0     0      1232.11       0.0400      0.0401     0.0400               0.049               0.049               0.052
                                    (0.0020)    (0.0060)   (0.0020)
          0    0.1     1233.34       0.0547      0.0552     0.0552               0.048               0.985               0.054
                                    (0.0020)    (0.0060)   (0.0020)
        0.01    0      1232.69       0.0381      0.0399     0.0381               0.061               0.051               0.066
                                    (0.0020)    (0.0060)   (0.0020)
        0.01   0.1     1234.08       0.0529      0.0552     0.0534               0.067               0.985               0.066
                                    (0.0020)    (0.0061)   (0.0020)
        0.03    0      1234.14       0.0344      0.0399     0.0344               0.161               0.047               0.280
                                    (0.0020)    (0.0060)   (0.0020)
        0.03   0.1     1232.78       0.0492      0.0553     0.0497               0.169               0.987               0.295
                                    (0.0020)    (0.0061)   (0.0020)
        0.05    0      1233.70       0.0307      0.0400     0.0307               0.372               0.052               0.750
                                    (0.0020)    (0.0060)   (0.0020)
        0.05   0.1     1232.57       0.0455      0.0553     0.0459               0.380               0.986               0.753
                                    (0.0020)    (0.0060)   (0.0020)
         0.1    0      1233.38       0.0214      0.0400     0.0214               0.912               0.050               1.000
                                    (0.0020)    (0.0060)   (0.0020)
         0.1   0.1     1234.14       0.0362      0.0553     0.0367               0.909               0.984               1.000
                                    (0.0020)    (0.0060)   (0.0020)

0.01      0     0      4934.29       0.0400      0.0400     0.0400               0.050               0.055               0.047
                                    (0.0017)    (0.0030)   (0.0018)
          0    0.1     4931.60       0.0540      0.0557     0.0556               0.050               0.978               0.049
                                    (0.0017)    (0.0030)   (0.0018)
        0.01    0      4934.93       0.0386      0.0400     0.0386               0.089               0.054               0.061
                                    (0.0017)    (0.0030)   (0.0018)
        0.01   0.1     4934.07       0.0526      0.0556     0.0542               0.086               0.982               0.059
                                    (0.0017)    (0.0030)   (0.0018)
        0.03    0      4932.66       0.0358      0.0400     0.0359               0.395               0.052               0.176
                                    (0.0017)    (0.0030)   (0.0018)
        0.03   0.1     4933.39       0.0498      0.0556     0.0515               0.395               0.985               0.167
                                    (0.0017)    (0.0030)   (0.0018)
        0.05    0      4931.62       0.0330      0.0401     0.0332               0.808               0.053               0.416
                                    (0.0017)    (0.0030)   (0.0018)
        0.05   0.1     4931.88       0.0470      0.0556     0.0488               0.807               0.987               0.439
                                    (0.0017)    (0.0030)   (0.0018)
         0.1    0      4933.61       0.0260      0.0401     0.0264               1.000                  -                   -
                                    (0.0017)    (0.0030)   (0.0017)
         0.1   0.1     4935.82       0.0400      0.0556     0.0419               1.000               1.000               1.000
                                    (0.0017)    (0.0031)   (0.0018)

Notes: First-Stage F-statistic reports the average F-statistic from all simulation samples from first-stage regressions
                             L        L         P
of si on zi . Columns for β̂OLS   , β̂2SLS , and j ω̂j β̂j report the average (standard deviation) of estimates. Exogeneity
                   L         P
Test compares β̂2SLS and j ω̂j β̂j as described in Theorem 1. The final two columns report tests for equal grade-
specific effects (i.e. βj = β for all j) and consistency of OLS estimates for all βj in equation (2) using only subsamples
for which we fail to reject exogeneity. The fraction of cases rejecting the null for all tests is reported using a 0.05
significance level. A sample size of N = 10, 000 is used for all simulated samples.
Online Appendix C: OLS and Logit Grade-Specific Estimates and
Standard Errors

    This is an online appendix for Lochner and Moretti (2012) that reports estimates and corre-
sponding standard errors for all grade-specific effects discussed in that paper.
    Table C1 reports OLS estimates from equation (2) based on the specifications used in Figures
1-5 of the paper.
    In Table C2, we explore logit specifications for the binary outcome variables in Lochner and
Moretti (2004) and Currie and Moretti (2003). These specifications are analogous to those from
Figures 1-4 of the paper and Table C1. The specifications in Currie and Moretti (2003) include too
many fixed effects for standard software packages, so we consider conditional logit specifications
where we condition on county-year fixed effects. Table C2 reports the estimated grade-specific effect
(standard error) when all regressors (except the county-year fixed effects) are set at their sample
average and the county-year effect is set to the value that yields an estimated sample proportion for
low birth weight or pre-term birth that equals the observed sample    " proportion. That is, the table        !#
                                                                           N        S
reports the grade-specific effects (standard errors) given by : β̂j × N1               D̄ij β̂j + x̄0 γ̂ + γ̃0 ,
                                                                          P        P
                                                                               ξ
                                                                          i=1      j=1
                                                                                      !
                                                      N      S                                  N
                                                   1 P                       0
                                                                D̄ij β̂j + x̄ γ̂ + γ̃0 = N1
                                                            P                                   P
where D̄ij and x̄ are sample averages, γ̃0 solves N     Ξ                                          yi , and ξ(·)
                                                        i=1     j=1                            i=1
and Ξ(·) are the logit pdf and cdf, respectively.




                                                       1
Figure C1: Estimated Grade-Specific Schooling Effects and Standard Errors (OLS)

                                                                                                                  3. Acemoglu &
                   1. Lochner and Moretti (2004)                      2. Currie & Moretti (2003)                  Angrist (2001)
                                                                 Effect of Maternal Education on Infant          Private Returns to
                Effect of Schooling on Imprisonment                     Health and Health Inputs                     Schooling
 Years of
Schooling        White Males              Black Males           Low birth weight            Preterm birth        Annual Earnings
    1        -0.0004 (0.0012)         0.0017 (0.0039)          0.0359 (0.0354)          0.0363 (0.0415)         0.0155 (0.0332)
    2        0.0045 (0.0013)          0.0062 (0.0041)          -0.0283 (0.0412)         -0.0167 (0.0483)        0.1809 (0.0342)
    3        -0.0017 (0.0009)         -0.0018 (0.0030)         0.0302 (0.0362)          0.0331 (0.0424)         -0.0308 (0.0228)
    4        -0.0011 (0.0007)         0.0015 (0.0026)          -0.0577 (0.0319)         -0.0232 (0.0373)        0.1178 (0.0179)
    5        0.0013 (0.0006)          -0.0003 (0.0024)         0.0553 (0.0260)          0.0372 (0.0304)         0.0444 (0.0155)
    6        -0.0002 (0.0005)         0.0000 (0.0021)          0.0063 (0.0239)          -0.0154 (0.0280)        0.1055 (0.0122)
    7         0.0000 (0.0004)         0.0046 (0.0019)           0.0008 (0.0175)         -0.0068 (0.0205)        0.0850 (0.0089)
    8        -0.0020 (0.0003)          0.0028 (0.0016)          0.0009 (0.0125)          0.0046 (0.0147)         0.0859 (0.0064)
    9         0.0014 (0.0002)          0.0044 (0.0014)         -0.0090 (0.0067)          0.0021 (0.0079)         0.0904 (0.0052)
   10        -0.0024 (0.0002)         -0.0065 (0.0013)          0.0109 (0.0053)         -0.0033 (0.0062)         0.0530 (0.0054)
   11        -0.0010 (0.0002)         -0.0106 (0.0012)         -0.0164 (0.0042)         -0.0026 (0.0049)         0.0531 (0.0054)
   12        -0.0046 (0.0002)         -0.0228 (0.0010)         -0.0233 (0.0028)         -0.0232 (0.0033)         0.1135 (0.0043)
   13        -0.0014 (0.0002)         -0.0010 (0.0012)         -0.0083 (0.0011)         -0.0046 (0.0013)         0.0842 (0.0043)
   14        -0.0004 (0.0002)         -0.0056 (0.0015)         -0.0036 (0.0012)         -0.0046 (0.0014)         0.0463 (0.0053)
   15        -0.0015 (0.0002)         -0.0064 (0.0018)         -0.0007 (0.0015)         -0.0008 (0.0017)         0.0591 (0.0065)
   16         0.0007 (0.0002)         -0.0009 (0.0020)         -0.0074 (0.0014)         -0.0073 (0.0016)         0.2150 (0.0062)
   17        -0.0003 (0.0002)          0.0014 (0.0028)         -0.0033 (0.0009)         -0.0031 (0.0010)        -0.0028 (0.0040)
   18         0.0009 (0.0002)          0.0043 (0.0031)
Notes: Table reports estimated coefficients (standard errors) on all schooling dummies from equation (2) in the paper.
Specifications are the same as those in Figures 1-5 of the paper.
Figure C2: Estimated Grade-Specific Schooling Effects and Standard Errors (Logits)

                      1. Lochner and Moretti (2004)                           2. Currie & Moretti (2003)
                                                                     Effect of Maternal Education on Infant Health
  Years of         Effect of Schooling on Imprisonment                             and Health Inputs
 Schooling        White Males                 Black Males              Low birth weight             Preterm birth
     1         0.0005    (0.0009)         0.0025     (0.0054)         0.0243    (0.0274)         0.0333    (0.0372)
     2         0.0022    (0.0009)         0.0122     (0.0056)         -0.0170 (0.0333)           -0.0131 (0.0441)
     3         -0.0002 (0.0006)           -0.0021 (0.0037)            0.0190    (0.0301)         0.0253    (0.0379)
     4         -0.0005 (0.0005)           0.0020     (0.0032)         -0.0452 (0.0269)           -0.0190 (0.0313)
     5         0.0005    (0.0004)         -0.0004 (0.0027)            0.0409    (0.0225)         0.0274    (0.0248)
     6         -0.0003 (0.0003)           -0.0013 (0.0023)            0.0045    (0.0174)         -0.0080 (0.0222)
     7         -0.0001 (0.0003)           0.0032     (0.0019)         0.0007    (0.0127)         -0.0056 (0.0174)
     8         -0.0009 (0.0002)           0.0005     (0.0014)         0.0012    (0.0091)         0.0032    (0.0126)
     9         -0.0003 (0.0002)           -0.0013 (0.0011)            -0.0038 (0.0050)           0.0015    (0.0066)
    10         -0.0012 (0.0002)           -0.0050 (0.0010)            0.0069    (0.0040)         -0.0018 (0.0052)
    11         -0.0008 (0.0002)           -0.0078 (0.0010)            -0.0091 (0.0032)           -0.0020 (0.0042)
    12         -0.0036 (0.0001)           -0.0200 (0.0009)            -0.0172 (0.0023)           -0.0188 (0.0029)
    13         -0.0012 (0.0002)           0.0001     (0.0012)         -0.0077 (0.0011)           -0.0045 (0.0013)
    14         -0.0009 (0.0002)           -0.0083 (0.0017)            -0.0036 (0.0012)           -0.0047 (0.0014)
    15         -0.0024 (0.0003)           -0.0099 (0.0025)            -0.0006 (0.0015)           -0.0008 (0.0017)
    16         -0.0010 (0.0004)           -0.0099 (0.0033)            -0.0081 (0.0014)           -0.0077 (0.0016)
    17         -0.0018 (0.0006)           -0.0039 (0.0056)            -0.0029 (0.0010)           -0.0027 (0.0011)
    18         0.0016    (0.0006)         -0.0017 (0.0067)

Notes: Results for Lochner and Moretti (2004) reflect average grade-specific effects based on logit specifications
analogous to those reported in Figures 1-4 of the paper and in Table C1. Results for Currie and Moretti (2003)
are based on conditional logits where county-year fixed effects are conditioned out. Table reports marginal
effects given the average level of all other covariates and the value of the fixed effect that yields a predicted share
of observations with low birth weight or pre-term birth that matches the sample proportions. Standard errors are
in parentheses.
