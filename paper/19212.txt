                                 NBER WORKING PAPER SERIES




                          LINEAR SOCIAL INTERACTIONS MODELS

                                          Lawrence E. Blume
                                           William A. Brock
                                           Steven N. Durlauf
                                          Rajshri Jayaraman

                                         Working Paper 19212
                                 http://www.nber.org/papers/w19212


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      July 2013




Support of the Human Capital and Economic Opportunity Global Working Group, sponsored by the
Institute for New Economic Thinking, is gratefully acknowledged by all authors. Financial support
has been supplied to Blume by NSF grant CCF-0910940, WWTF Grant “Die Evolution von Normen
und Konventionen in der Wirtschaft", and ARO MURI Award No. W911NF-12-1-0509, to Brock
by the Vilas Trust, and to Durlauf by the University of Wisconsin Graduate School, the Laurits Christensen
Chair in Economics, and the Vilas Trust, all of which is greatly appreciated. We thank the editor and
three referees for very helpful comments and suggestions. Wallice Ao, Joel Han, Hon Ho Kwok, Ariel
Roginsky, Kegon Tan and Xiangrong Yu have provided superb research assistance. We are grateful
for comments from James Heckman, Youcef Msaid, Debraj Ray, Alex Rees-Jones, Dean Robinson,
Michael Strain, and Nichole Szembrot; and to George Jakubson and Charles Manski for discussions
of the issues we address. This paper was written in honor of James J. Heckman, whose influence will
be evident throughout. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Lawrence E. Blume, William A. Brock, Steven N. Durlauf, and Rajshri Jayaraman. All
rights reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Linear Social Interactions Models
Lawrence E. Blume, William A. Brock, Steven N. Durlauf, and Rajshri Jayaraman
NBER Working Paper No. 19212
July 2013
JEL No. C21,C23,C31,C35,C72,Z13

                                            ABSTRACT

This paper provides a systematic analysis of identification in linear social interactions models. This
is both a theoretical and an econometric exercise as the analysis is linked to a rigorously delineated
model of interdependent decisions. We develop an incomplete information game that describes individual
choices in the presence of social interactions. The equilibrium strategy profiles are linear. Standard
models in the empirical social interactions literature are shown to be exact or approximate special
cases of our general framework, which in turn provides a basis for understanding the microeconomic
foundations of those models. We consider identification of both endogenous (peer) and contextual
social effects under alternative assumptions on a priori information about network structure available
to an analyst, and contrast the informational content of individual-level and aggregated data. Finally,
we discuss potential ramifications for identification of endogenous group selection and differences
between the information sets of analysts and agents.


Lawrence E. Blume                                  Steven N. Durlauf
Department of Economics                            Department of Economics
Uris Hall                                          University of Wisconsin
Cornell University                                 1180 Observatory Drive
Ithaca, NY 14850                                   Madison, WI 53706-1393
lb19@cornell.edu                                   and NBER
                                                   sdurlauf@ssc.wisc.edu
William A. Brock
Department of Economics                            Rajshri Jayaraman
University of Wisconsin                            European School of Management
1180 Observatory Drive                               and Technology ESMT
Madison, WI 537061393                              Schlossplatz 1
wbrock@ssc.wisc.edu                                10178 Berlin
                                                   Germany
                                                   jayaraman@esmt.org
                                                                                                 1


         ...it is said by some that men will think and act for themselves; that none will dis-
         use spirits or anything else, merely because his neighbors do; and that moral
         influence is not the powerful engine contended for...Let me ask the man who
         would maintain this position most stiffly, what compensation he will accept to go
         to church some Sunday and sit during the sermon with his wife’s bonnet upon
         his head? Not a trifle, I’ll venture. There would be nothing irreligious in it...Then
         why not? Is it not because there would be something egregiously unfashionable
         about it? Then it is the influence of fashion; and what is the influence of fash-
         ion but the influence that other people’s actions have on our own actions, the
         strong inclination each of us feels to do as we see our neighbors do? Nor is the
         influence of fashion confined to any particular thing or class of things. It is just
         as strong on one subject as another.
                                                                          Abraham Lincoln,
                                                                         February 22, 1842
                      Address to the Washington Temperance Society of Springfield Illinois


                                       1. I NTRODUCTION

   While the proposition that individuals are subject to social influence states the
obvious, the study of social influences on individual behavior in economics is a
relatively recent phenomenon.1 In the last two decades, however, a rich theoret-
ical, econometric, and empirical literature in social economics, comprehensively
overviewed in Benhabib, Bisin, and Jackson (2011a,b), has emerged. While each
of these three dimensions — the theoretical, econometric, and empirical — has
made important advances, it is fair to say that they are yet to be well integrated.
By this we mean that the theoretical models used to study social interactions are
distinct from the econometric environments in which identification is studied, while
empirical work generally does not systematically exploit the implications of theory
and econometrics for the formulation of data analyses.

   The objective of this paper is to facilitate the integration of the theoretical,
econometric, and empirical sides of the social interactions literature through a
systematic investigation of linear social interactions models. Linear models are
the workhorse of empirical research and have been the primary subject of econo-
metric work on the identification of social interactions since Manski (1993). Our
analysis provides rigorous microfoundations for a broad class of linear social in-
teractions models.

  The central, and fundamentally optimistic, message of this paper is that in most
cases, linear social interactions models are identified. We employ a theoretically
   1
     Of course there are exceptions to this claim. Becker (1974) is an example of theoretical anal-
ysis that predate the modern literature, and Henderson, Mieszkowski, and Sauvageau (1978) and
Datcher (1982) are early and seminal contributions in the empirical study of neighborhood effects.
Examples of recent empirical applications of social interactions models include Conley and Udry
(2010) on the diffusion of technology; Nakajima (2007) on smoking; Sirakaya (2006) on crime;
Rege, Telle, and Votruba (2012) on the take up of welfare programs; and Topa (2001) and Bayer,
Ross, and Topa (2008) on labor market outcomes. Another major area of social interactions work
is education, which we discuss throughout the paper.
2


grounded model to understand the conditions under which social interaction ef-
fects are or are not identified. The identification problem is shown to depend on
three factors: the prior knowledge available to an analyst on the social structure
characterizing direct interactions between individuals, the type of data available
to the analyst — whether aggregated or individual level — and the implications
of endogenous network formation for the conditional expectations of unobserved
heterogeneity given the social structure. The onus on the empiricist lies in es-
tablishing what they know about social networks a priori and, conditional on this
information, verifying that their social interactions model satisfies the conditions
needed for identification, many of which are provided in this paper. The conditions
we describe do not involve adding stronger assumptions than have appeared in
previous papers. Rather, we show that in some cases, non-identification results
are artifices of strong assumptions and in others, we establish identification under
weaker assumptions than have been previously employed.

   We start by providing rigorous microfoundations that either exactly nest or ap-
proximate the many linear econometric models that have appeared in the social
interactions literature. This is useful for empiricists because it permits a structural
interpretation of regression parameter estimates, thereby allowing particular stud-
ies to shed light on more general contexts. Further, these microfoundations allow
one to assess whether particular regression formulations that have appeared in
various econometric and empirical studies are sensible when one considers them
as equilibrium strategy profiles that emerge from a noncooperative game of in-
complete information.

   We translate this theoretical framework into an econometric one, which we use
as a basis to study identification. Identification of utility parameters obviously
depends on the researcher’s a priori knowledge of social structures. Without
any such prior knowledge, identification fails. This is the first basic identification
result we establish. Our second set of results considers the case most commonly
assumed in the applied literature, where a researcher has full prior knowledge
of the social structure. In a generalization of Bramoullé, Djebbari, and Fortin
(2009) we show that in this case, when the researcher has access to individual
data, identification of the structural parameters is generic in a sense we make
precise. This casts the non-identification results that have been at the centre of
much of the conventional econometrics literature in a new light, since they pertain
to non-generic models which have no obvious theoretical rationale. With full prior
knowledge of social structure but access to only aggregate data, first moments do
not enable identification. However, building on approaches proposed by Glaeser,
Sacerdote, and Scheinkman (1996, 2003) and formalized by Graham (2008), we
show that second moments do.

    The assumption of full prior knowledge of social structure, although routinely
imposed in empirical work, may be conceptually untenable. Our third set of iden-
tification results explore how far one can get with partial prior knowledge of social
structure. These results, motivated in part by the availability of social network
                                                                                     3


data, indicate that when a priori information regarding the intensity of social ties
between individuals is absent, prior knowledge of the mere existence (or absence)
of ties between individuals enables identification. Identification for this case bears
a conceptual resemblance to classical rank and order conditions for identifica-
tion in linear simultaneous equations models (cf. Fisher (1966)), but the structure
of the social interactions framework means that there are interesting differences
from the standard results. Our results indicate that much more general models of
social interactions can be employed in empirical work than has been done previ-
ously, when individual-level data are available. At the same time, we argue that
there are limits to identification when data are comprised of individual observa-
tions and group level averages.

   Finally, we address the issues of endogenous network formation, and the pres-
ence of public variables observable to those in the network but unobservable to
the researcher. We treat endogenous network formation as the first stage of a
two-stage game in which our general linear social interactions model describes
payoffs from choices in the second stage. We show how the implications for
identification of endogenous network formation entirely depend on the informa-
tion available to agents at the time of network formation, so that for a number of
interesting cases endogeneity does not matter. For the case where our results
no longer apply, we indicate that the dealing with endogeneity involves the con-
struction of the equivalent of the control function invented in Heckman (1979) and
extended in Heckman and Robb (1986). This focus on information and network
formations allows us to provide identification results for environments in which
networks are durable in a sense we make precise. This places the endogeneity
issue in the realm of a particular information asymmetry between the analyst and
the population of agents

   Two previous studies are relatively close to this one. (We discuss others in
the context of our results later on.) Bramoullé, Djebbari, and Fortin (2009) con-
sider identification for known social structures. We provide a mild generalization
of their results by allowing for distinct social structures for contextual and endoge-
nous effects, i.e. the effect of network members’ exogenous characteristics and
endogenous behaviors, respectively, on individual behavior. Further, they do not
study identification when one does not know the complete social structure and
when it is endogenous. Blume et al. (2011) anticipates some of our analysis. We
employ a more general preference structure than that paper in that we allow for
distinct social structures for different types of social interactions. Our results on
identification under partial knowledge of the social structure are completely new
as are our results on identification under aggregation and our discussion of endo-
geneity and information asymmetries between the analyst and the agents under
study.

   Throughout the paper, we will employ social interactions effects between stu-
dents as an example in order to interpret assumptions and findings. The evidence
for social interactions in education is well surveyed in Epple and Romano (2011)
4


and Sacerdote (2011). This empirical literature is large, exploring social influences
on educational and other outcomes. It includes a range of environments that fall
into the general framework we study. For example, it is common to assume that
individual outcomes are determined by unweighted averages of peer outcomes
and/or characteristics, with definitions of peer groups ranging from self-identified
friendships (Patacchini, Rainone, and Zenou 2012) to classmates (Graham 2008)
to schoolmates (Bifulco, Fletcher, and Ross 2011) to Zip Codes (Corcoran et al.
1992).

    In section 2 we develop a social interactions game of incomplete information
whose Bayes-Nash equilibrium produces linear strategy profiles. Section 3 intro-
duces additional assumptions that are needed to study these equilibrium strategy
profiles as econometric models of individual outcomes. Section 4 studies identifi-
cation based on complete knowledge of the social structure that connects agents
in the population. Section 5 provides conditions under which identification will hold
for partial knowledge of social structure. Section 6 considers the implications of
alternate formulations of unobserved heterogeneity due to endogenous network
formation and information differences between the information sets of agents and
the analyst. Section 7 concludes.




                                   2. M ICROFOUNDATIONS


    In this section, we set up a theoretical model from which the econometric model
we subsequently study is directly derived. We consider a Bayesian game – a so-
cial interactions game – in which the population of network members is a set V
containing N < ∞ members. Each individual i is described by a vector of charac-
teristics ( xi , zi ), where xi ∈ R is a publicly observed characteristic, and zi ∈ R is
a private characteristic observable only to individual i.2 An individual’s type ti is a
vector ( x, zi ) ∈ R N +1 , which details i’s observable and unobservable character-
istics, and the observable characteristics of everyone else. The vector of players’
types is ( x, z) ∈ T = R2N . The a priori distribution of types is an exogenous
probability distribution ρ on T . Knowledge of ρ is common to all individuals, and
each individual’s beliefs about the types of others is a conditional distribution of ρ
given the individual’s type.

  Utility depends on an individual’s own action and characteristics as well as
network members’ actions and characteristics. Individual i chooses an action


    2
    We restrict attention to one observable and one unobservable characteristic in order to simplify
notation. All of our results are easily extended to the case when each of these is a vector.
                                                                                        5


ωi ∈ R to maximize utility:
                                              !
                                                      1
  Ui (ωi , ω−i ) =   γxi + zi + δ ∑ cij x j       ωi − ωi2
                                    j
                                                      2
                                                                               !2
                                                          φ
                                                        −     ωi − ∑ aij ω j        . (1)
                                                          2          j

Utility is separable into two components. The first line is the private component
of utility and the second is the social component. Both are strictly concave in
individual i’s action. Marginal private utility is linear in individual i’s own observ-
able characteristic xi and private characteristic zi . The term δ ∑ j cij x j captures
contextual effects – the direct influence of others’ characteristics on i’s choices.
It is a weighted average of the characteristics of neighbors in a contextual-effects
network. In our model, endogenous, or peer effects, come from social pressure,
that is, social norms. This is described in the second line as the squared distance
between individual i’s behavior ωi and the average ∑ j aij ω j of the behaviors of
his peers in an peer effects network. The parameter φ determines the marginal
rate of substitution between the private and social components of utility.

   The matrices A and C whose elements aij and cij determine peer and con-
textual effects are weighted adjacency matrices or weighted sociomatrices for the
peer- and contextual-effects network, respectively. Each has dimension N × N
and the magnitudes of the matrix elements measures the strength of network ties.
The networks themselves can be described by graphs: the peer-effects network
A has vertex set V and edge set E = {(i, j) : aij > 0}. The contextual-effects
network C is defined similarly with C instead of A.

   In the schooling example, the network is the population of N students. Each
student i choses a level of effort. Observable characteristics include indicators
of socio-economic status, such as family income. Contextual effects emerge be-
cause families with resources may contribute public goods such as school sup-
plies or volunteer time to the classroom. The unobserved type zi may capture
individual characteristics such as ability and family values concerning education,
and can include common influences such as teacher quality. The peer effect is un-
derstood here to be a pressure to conform. Peer- and contextual-effects networks
may differ, then, because the entire classroom may benefit from such things as
parent volunteers, while peer effects come only from a student’s friends.

    Our utility function nests examples in the literature such as Davezies, d’Haultfoeuille,
and Fougère (2009) and Manski and Mayshar (2003). Our model is closest to
Blume et al. (2011) but strictly nests it because we allow for distinct peer-effect
and contextual-effect sociomatrices and because we work with much weaker error
restrictions than the i.i.d. assumption made by the earlier paper. This weakening
is important in moving from the theoretical to the econometric model.
6


    Since all actions are chosen simultaneously, an equilibrium concept is required.
We see this as an incomplete information game, and look for a Bayes-Nash equi-
librium. That is, individuals choose an action to maximize the expectation of their
utility given their type and the public types of others. The Bayesian game for-
malism assumes that the description of the game hU, γ, δ, φ, A, C, ρi is common
knowledge among individuals. Futhermore, we assume that x is common knowl-
edge, and each individual alone observes his private zi . Equilibrium beliefs are
constructed from the individuals’ strategy functions and the common prior belief.
The following axioms ensure the existence of a Bayes-Nash equilibrium:

    T. 1. φ ≥ 0. A and C are non-negative, for each i ∈ V , ∑ j aij is either 0 or 1,
          and similarly for C. For all i ∈ V , aii = 0.
    T. 2. Second moments of ρ exist.

Axiom T.1 has several parts. The restrictions φ ≥ 0 and non-negative A together
impose a preference for behavioral conformity. Hence, a student is more likely to
exert effort if classmates also exert effort. The analogous restriction on C means
the effect of exogenous characteristics is proportionate to the strength of a tie.
So the age of a student’s friends may matter more than that of acquaintances
and may be positive or negative, but the sign of the contextual effects will be
the same as the sign of δ. The restriction that the row sums of the peer and
contextual effects be either 1 or 0 means that individuals in the network either care
about these variables as weighted averages, or the individual is a social isolate
— a “loner". The restriction aii = 0 ensures that i does not affect i’s behavior
via the sociomatrix. This is an obvious assumption given that this component of
utility captures the effect of others’ behaviors and not own behavior. Our model is
not circular in that a student does not directly affect his performance via his own
performance. Axiom T.2 is necessary to ensure that expected utility is well-defined
for a large class of strategies.

      Formally, a strategy for individual i is a function f i : RN+1 → R that assigns
a choice ωi to each of his possible types ( x, zi ). Denote by F the set of all
strategy profiles f ( x, z) = f 1 ( x, z1 , . . . , f N ( x, z N ) such that for each x and i,
 f i ( x, · ) : zi 7→ R is in L2ρ .3 A Bayes-Nash equilibrium of the game is a vector of
strategy profiles f ( x, z) such that each f i maximizes E(Ui (ωi , ω−i )| x, zi ), where
the expectation is taken with respect to the strategies f −i and the common prior
ρ.
Theorem 1. If the Bayesian game satisfies axioms T.1 and T.2, it has a unique
Bayes-Nash equilibrium. The equilibrium strategy profile can be written
                                                 −1
                     1                φ                                                   1
        f ( x, z) =               I−     A              (γI + δC ) x + µ( x, z) +            z         (2)
                    1+φ              1+φ                                                 1+φ
    3
     This means that the squared integral of f i ( x, · ) with respect to zi exists and is finite, ensuring
that preferences over strategies for the Bayesian game are well-defined.
                                                                                                 7


where µi ( x, z) depends only on x and zi . If z is independent of x, then µi ( x, z)
depends only on zi . If the elements of the z are all pairwise independent, then
µi ( x, z) depends only on x. If both are true,
                                                           −1      !
                              1                  φ
                  µ( x, z) =                 I−     A             − I E (z) ,                 (2a)
                             1+φ                1+φ
a constant vector.

    Theorem 1 provides sufficient conditions for the existence of a unique Bayes-
Nash equilibrium to the game, whose individual strategy profiles obey the linear
structure commonly assumed in the empirical literature. The first term in (2) de-
scribes endogenous, contextual, and direct own-effects of public types x. This
is the focus of empirical research. The third term expresses the direct effect on
equilibrium behavior of individuals’ private types z. The second term, µ( x, z),
is the effect of higher-order beliefs — individuals’ expectations of others’ private
types, their expectation of others’ expectations of their beliefs, etc. In general,
i’s higher order beliefs may be a function of ( x, zi ), others’ characteristics and i’s
private type. This may be important when network membership is endogenous
and x and the zi ’s are correlated. We consider this case in section 6. When x and
z are independent, however, µ( x, z) = µ(z), i.e. each individual’s expectation of
others’ private types depends only on his own private type. Our econometric mod-
els will make this assumption (E.4 below), and we will sweep these higher-order
beliefs into the unobserved term in the regression equation.

   There are generally speaking, two kinds of endogenous social interactions
models. We have chosen to model social interactions as coming through social
norms. We model this as a conformity effect. Another source of social interactions
comes through strategic complementarities in production. In the education litera-
ture papers such as Epple and Romano (1998) and Calvó-Armengol, Patacchini,
and Zenou (2009) take this approach in modeling peer effects.4 The interpreta-
tion of the peer effects in such papers is that the marginal cost of educational
achievement is affected by peer composition. Such an approach has the utility
function
                                                       !
                                                                                1
        Ui (ωi , ω−i ) =      γxi + zi + δ ∑ cij x j       ωi + φ ∑ aij ωi ω j − ωi2           (3)
                                               j                  j
                                                                                2
Here the first two terms describe a production function that maps effort to an
educational outcome. The second term is a strategic complementarity. The hard
work of other students spills over to increase the marginal product of student i’s
effort. This is plausible for all kinds of reasons (see Sacerdote (2011)). The third
term is the disutility of effort. The proof of theorem 1 applies to this model too,
and an equilibrium exists and is unique for 0 ≤ φ < 1.5 The difference between
   4
      Epple and Romano (2011, sec. 2.1) surveys different models of externalities between students.
   5
      This model becomes more complicated when φ ≥ 1, and so this case is assumed away in the
literature.
8


this model and that of equation (1) is that here the vector x enters the equilibrium
strategy profile through the term ( I − φA)−1 x, that is, φ rather than φ/(1 + φ)
multiplies the matrix A. Thus the two models cannot be distinguished in the joint
distribution of x and ω without further assumptions. This renders moot the issue
of identifying the source of endogenous social interaction. Hence we use the
theoretical model outlined in (2) as our basis for econometric analyses of linear
social interactions. We make this transition in the next section.


                 3. F ROM A T HEORETICAL TO AN E CONOMETRIC M ODEL

    An econometric evaluation of our theoretical model requires additional assump-
tions. In this section we introduce these assumptions and discuss their role in
identification of the utility parameters. Loosely speaking, parameters are “iden-
tified" if the map from utility parameters into the joint distribution of regressors
and outcomes is one-to-one. The following definition, due to Koopmans (1953), is
useful in translating our theoretical framework to an econometric one.
Definition 1. A structure s for the linear social network model is a list
hγ, δ, φ, A, C, ρi, where γ, δ and φ are utility parameters, A and C are peer- and
contextual-effects sociomatrices, and ρ is the a priori probability distribution on
R × R. A model is a set of structures.

   The empiricist is interested in whether the utility parameters γ, δ and φ are
identified in a model in which a number of sometimes implicit restrictions have
been imposed on A, C and ρ. Here, we make these restrictions explicit by con-
cerning ourselves with the model M, all of whose structures satisfy T.1-T.2 and
the following assumptions:

    E. 1.   The support of the marginal distribution of x has dimension N .
    E. 2.   For all i and j, aij > 0 iff a ji > 0. For some i and j, aij > 0.
    E. 3.   For all i and j, cij > 0 iff c ji > 0. For some i and j, i 6= j, cij > 0.
    E. 4.   For all i, j ∈ V , x j and zi are uncorrelated.
    E. 5.   At least one of γ and δ is nonzero.

    E.1 ensures that the N × N matrix of parameters post-multiplied by x in equa-
tion (2) is unique. Assumptions E.2 and E.3 place additional restrictions on the
sociomatrices. While these are not necessary conditions in our theorems, they
greatly simplify derivations. Each is, in itself, weak and only serves to eliminate
knife-edge cases. The first parts of E.2 and E.3 require that when j exerts social
influence on i, i also exerts social influence on j. These are weak assumptions
because nonzero elements of the sociomatrices are allowed to be arbitrarily small
and the strength of ties between two individuals may be asymmetric. We do not
require these two assumptions for most of our results, including those which rely
on holes in the network for identification. However, we prefer to maintain them
because they greatly simplify proofs. The second parts of E.2 and E.3 require,
                                                                                      9


respectively, that there exist at least one pair of agents who exert peer effects on
each other and one pair of agents who exert contextual effects on each other.
This rules out C = I . E.4 is a standard exogeneity condition with respect to x.
In the context of our theory model, it means that higher order beliefs depend only
on own-types, so µ( x, z) ≡ µ(z). We will relax this assumption in section 6.
E.5 eliminates the special case in which the x’s have no effect on the outcomes.
Lemma 1 in the appendix shows that in this special case identification fails, so we
ignore it in subsequent discussion.

  For what follows, it will be convenient to define
                                                
                                             1
                             µ = E µ(z) +       z ,
                                           1+φ
                                          1
                              ε = µ(z) +     z − µ,
                                         1+φ
                                                    −1
                                   1          φ
                        Bφ (s) =         I−      A       ,
                                  1+φ       1+φ
and

                             B(s) = Bφ (s)(γI + δC ).                               (4)
For structures in models satisfying assumptions T.1-T.2 and E.1-E.4, the equilib-
rium equation system of theorem 1 becomes
                                ω = µ + B(s) x + ε,                                 (5)
With this change of variables, the residual term ε has unconditional mean 0. Al-
though it should not be forgotten that both µ and the distribution of ε depend upon
ρ, we shall not be using either for identification (except in section 4.2). Instead, we
will identify parameters through the matrices B(s). We index these matrices by s
to emphasize that it is from the structure that we will recover utility parameters.

  Equation (5) may be contrasted with a purely statistical model of the form
                                   ω = α + Bx + e,                                  (6)
in which e is constructed to be orthogonal to (1, x ). Viewing this statistical model
through the prism of the game of section 2 and the econometric assumptions
of this section has three advantages. First, it imposes some parameter restric-
tions on the model (e.g. the row sums of B will be identical). Second, it facilitates
the interpretation of parameter values in terms of commonly accepted models of
interactive decision making. Third, it allows for causal conclusions from parame-
ter estimates because it makes clear what environmental perturbations leave the
structure unchanged.

   From E.1 it is immediate that α, B and Var(e), the covariance matrix of the re-
duced form errors from equation (6), summarize the relevant information for identi-
fication via the first and second moments of the data, and that each is unique. For
10


purposes of identification, these moments are the objects that the data provide to
the analyst.

   Most of this paper is concerned with identification of the utility parameters of
structures from the matrices B(s) of equation (5), which describe how equilibrium
strategy profiles vary with characteristics x.
Definition 2. Utility parameters γ, δ and φ are identified in a model M by B if for
all s, s0 ∈ M, if B(s) = B(s0 ) then (γ, δ, φ) = (γ0 , δ0 , φ0 ).

   Our identification definition ignores the constant term because, in comparing
the equilibrium strategy profile (5) with the statistical model (6), without restrictions
on ρε| x (the marginal prior of ε given x), the individual-specific constant terms
cannot provide additional information on γ, δ and φ.

   Since B depends on the structure only through γ, δ, φ, A and C, identification
of the utility parameters will obviously depend on what is known about A and C
a priori . Without a priori information about structures identification will fail since
the inverse image of a matrix B under the map s 7→ B(s) could contain structures
with very different sociomatrices. In section 4.1 we assume that the pair ( A, C )
is known a priori, while in section 5.1, a priori knowledge only pertains to C. Let
M( A, C ) and M(C ) denote the sets of all s ∈ M with fixed sociomatrices A
and C, and with fixed contextual-effects sociomatrix C, respectively. These should
be thought of as sub-models of M. For instance, when A and C are known a
priori, the identification exercise is that of identifying the utility parameters in the
set of structures M( A, C ). It follows from these definitions that anything identified
in M is identified in M(C ) for every contextual-effects matrix sociomatrix C,
and anything identified in M(C ) is identified in M( A, C ) for every peer-effects
sociomatrix A. Let M A and MC denote the set of all peer- and contextual-effects
sociomatrices, respectively, that satisfy the relevant parts of T.1–2 and E.1–5.

   We first establish a basic identification result. This result supposes the following
structure on observations:

 K. 1. For all i, the analyst observes (ωi , xi )

Without any a priori knowledge other than T.1–2, E.1–E.4 and K.1, the reduced
form parameters B = B(s) and the sum β = γ + δ are nonetheless identified;
that is, they are identified in M. This is critical. The remainder of the paper is
concerned with the unpacking of B = B(s) to recover utility and social interactions
parameters. The theorem goes on to state that the parameter set γ = δ = 0
is identified in M. A third result states that with an additional piece of a priori
information, the set δ = φ = 0 is identified, and in this case, by virtue of the first
result, γ is identified as well.
Theorem 2. Let M denote the model satisfying axioms T.1–T.2, E.1–E.4 and
K.1.
                                                                                            11


       i. The matrix B(s), µ, and the sum β = γ + δ are identified in M from the
          joint distribution of ω and x without any additional a priori information.
      ii. E (ω | x ) is independent of x if and only if δ = γ = 0.
     iii. If C is known a priori and it is known a priori that there are two individuals
          i and j for whom cii 6= c jj , then for all i, E (ωi | x ) = E (ωi | xi ) if and only
          if δ = φ = 0 . In this case, γ is identified as well.
Otherwise, the parameters γ, δ, φ, A, C are not identified without additional a pri-
ori information.

These results do not require E.5. But having dispensed with this case, it is conve-
nient for expository purposes to maintain E.5 for the remainder of the paper. Note
too that in case iii. it is not necessary to know the values of any elements of C, but
merely that two diagonal values are distinct.

    Theorem 2 is a negative result from the perspective of identifying social interac-
tions. The non-identifiability of δ and φ means that the structural parameters that
characterize the presence of the two possible social effects, peer and contextual,
cannot be recovered given the assumptions we have made so far. To understand
why, consider the following econometric specification, which is delivered from the
first-order conditions for expected utility maximization in the Bayes-Nash equilib-
rium:
               γ        δ                          φ                          1
                                   ∑ cij x j + 1 + φ ∑ aij E
                                                                       
       ωi =       xi +                                            ωj |x +        εi        (7)
              1+φ      1+φ           j                   j
                                                                             1+φ
This system of N equations is just a classic simultaneous equations system ex-
cept that expectations of endogenous variables appear on the right hand side of
the equation rather than realizations. The non-identification of this simultaneous
equations system is a classical result — one that is unaffected by the row summa-
bility of A and C. In fact one can interpret two stage least squares as making
exactly this substitution. From this vantage point, identification failure stems from
the absence of exclusion restrictions in the system. (See Bramoullé, Djebbari,
and Fortin (2009) for elaboration of this intuition.)

   We close this section by showing how a number of existing models constitute
special cases of our general framework. The social interactions literature has
focused on equation (7), the first order conditions for expected utility maximization,
rather than the equilibrium strategy profiles. Hence our first two examples focus
on econometric models that may be interpreted be interpreted as special cases
of (7). Our third example illustrates how our models instantiates the idea of weak
versus strong ties, a sociological distinction which is important for a variety of
economic network analyses.

Example 1: linear-in-means models. In many social networks models, individu-
als are partitioned into non-overlapping groups g. Let n g denote the size of group
g. In the linear-in-means model, an individual’s behavior depends on his average
12


group characteristics and average group behavior. This amounts to imposing the
following constraints on the sociomatrices:
                                     1
                              cij =      if i, j ∈ g,                                (8)
                                    ng
                                        1
                              aij = g           if i, j ∈ g,
                                    n −1
                              cij = aij = 0 if i ∈ g, j ∈    /g
Combined with the assumption that E (ε| x ) = 0, the first order conditions (7) may
be rewritten:
             γ              δ
     ωi =
            1+φ
                xi +
                     (1 + φ)(n g − 1)      ∑ xj
                                            j
                                                 φ                            1
                                      +            g     ∑
                                          (1 + φ)(n − 1) j6=i
                                                              E( ω j | x ) +
                                                                             1+φ
                                                                                 ε i (9)

Manski’s (1993) study of identification of social effects is based upon a large sam-
ple approximation of this model, in which for all i, n g → ∞. In the limit
                       γ        δ          φ                  1
               ωi =       xi +     x̄ g +     E(ω̄ g | x ) +     εi                (10)
                      1+φ      1+φ        1+φ                1+φ
where x̄ g and ω̄ g are group-level averages of the respective variables.

   The unweighted averaging assumed in the linear-in-means model does not
have a theoretical justification but rather reflects a modeling choice made for sim-
plicity, or because of limits on what is observable about the groups. It is trivial to
think of contexts in which weights will not be equal. For high school students, one
could easily imagine differences in sociomatrix elements that reflect relative pop-
ularity, strong versus weak friendships, and the like. One message of this paper
will be that it is not necessary to rely on the simplification of unweighted averag-
ing. While some prior information on the sociomatrices A and C is necessary for
identification of the utility parameters, the necessary information is less than that
assumed in the linear-in-means model.

    Our framework can also be used to assess the interpretability of different vari-
ations of (7) with respect to rigorous microfoundations. For example, a major
empirical study of educational peer effects is Sacerdote (2001), which examines
roommate pair interactions at Dartmouth. Sacerdote assumes that each student
i’s grade point average depends on his own ability and the ability and grade point
average of his roommate j. Sacerdote is careful to allow for measurement error in
ability. We ignore this for simplicity, since in its absence his model reduces to
                         ωi = d0 + d1 x i + d2 x j + d3 ω j + ς i .
Sacerdote follows the theoretically appropriate formulation of endogenous social
effects by employing the average of each individual’s roommates, which for pairs
is simply the outcome of the other roommate. Further, given that there is only a
                                                                                                 13


single roommate, there is no issue of the restriction of the linear-in-means model
A matrix. On the other hand, as in Lee (2007), the inclusion of ω j rather than
E(ω j ) begs the question of what information sets are available to agents, since a
roommate’s grades are not observable contemporaneously. That said, there is a
simple reinterpretation of this model as
             ωi = d0 + d1 xi + d2 x j + d3 E(ω j ) + d3 (ω j − E(ω j )) + ς i
which is isomorphic to our equilibrium best response function when roommates
are playing a Bayes-Nash game. Does this do violence to Sacerdote’s analysis?
We argue that it does not, since instrumenting for ω j is equivalent to replacing this
variable with E(ω j ). Note that in this specification, d2 and d3 are not identified
if E(ω j ) is determined by a linear combination of xi , x j and a constant. (See
corollary 1 for a further discussion.) Identification of d2 + d3 holds and is a special
case of theorem 2.6


Example 2: linear-in-means models based on neighborhoods. A second com-
mon approach to analyzing social effects has extended the linear- in-means model
by exploiting observed network data to locate individuals in neighborhoods, and
using these neighborhoods to generate sociomatrices. One example of this strat-
egy is De Giorgi, Pellizari, and Redaelli (2010) who employ administrative data
from university students to explore peer effects among classmates, where inter-
actions are determined by overlapping classroom enrollments. A similar approach
is employed in Calvó-Armengol, Patacchini, and Zenou (2009), using AddHealth
data.

  Formally, let i’s neighborhood h be the set of other agents to whom he is con-
nected and let nh be the number of agents in this set. Note that i 6∈ h. The weights
associated with a linear-in-means model based on neighborhoods correspond to
                                            1
                                     cij =     if j ∈ h,                                       (11)
                                           nh
                                            1
                                     aij = h if j ∈ h,
                                           n
                                     cij = aij = 0 if j ∈
                                                        /h
The reduced form regression that is generated by the addition of these assump-
tions to our framework is
                        ωi = d0 + d1 xi + d2 x̄ h + d3 E(ω̄ h ) + ς i                          (12)
where x̄ h and ω̄ h denote averages for neighborhood h. While equation (12) may
resemble equation (7), it in fact implies a much richer structure for social inter-
actions. Unlike the linear-in-means model, agents are no longer partitioned into
    6
     Sacerdote (2001) shows that identification can hold under restrictions on the unobservables
in his model. In our formulation of his model, this would require that ω j − E(ω j ) and ς i are un-
correlated, which Sacerdote (2001) notes involves the very stringent and arguably non-credible
requirement that ς i and ς j be uncorrelated.
14


non-overlapping groups; an agent to whom many are connected has a larger influ-
ence than one to whom few are connected because of differences in the number
of neighborhoods the respective agents inhabit.

   However, the formulation is still restrictive relative to our general C and A so-
ciomatrix formulation as (12)’s generalization of (7) involves the relaxation of the
block diagonality assumption of the linear-in-means model but retains equal val-
ues of the non-zero elements of each row of the implied sociomatrix. This could
be an inaccurate, not to mention excessively restrictive, representation of social
interactions.

    In this example too, our microfoundations can be used to evaluate the statistical
formulations of (12). For example, De Giorgi, Pellizari, and Redaelli (2010) use
ω̄ h rather than E(ω̄ h ). As argued above, our Bayes-Nash formulation is more
natural and does no violence if employed to interpret their regression. Further,
the assumption cii = 0 may not be natural.

   Calvó-Armengol, Patacchini, and Zenou (2009) make a more substantial devi-
ation from our framework. They develop a complete-information social interaction
game where individuals respond to the choices of peers in their social network.
Individuals utilities are additively separable in two choice variables, private effort
and peer-induced effort. These are perfect substitutes in the production of ob-
served output (which is not an argument of the utility function). Their model differs
from ours in two important way. First, they assume that individual characteristics
(including contextual effects) affect only the utility of private effort, and so they
elide the identification problem since individual characteristics do not feed back
into peer effects. So, for instance, if a student in a classroom had an exogenous
improvement in health status that reduced his cost of effort, and so he chose to
work more, this would have no effect on others’ effort levels or outcomes. Second,
although individual characteristics are not an argument of peer effort utility, there
is heterogeneity in equilibrium peer effort nonetheless, because ceteris paribus
the marginal utility of peer effort is assumed to scale linearly with the number of
connections one has — individuals with more contacts are assumed to be more
susceptible to peer pressure. These unusual modeling choices serve a purpose.
Calvó-Armengol, Patacchini, and Zenou make a direct connection between the
peer-effort choice and sociological measures of centrality. They derive that the
equilibrium peer effect equals the Katz-Bonacich centrality vector.

  This and other measures can be derived from our A matrix, and both models
have the advantage of deriving the rate of attenuation of influence that is a key pa-
rameter of these measures from the marginal rate of substitution between private
and social components of utility.

Example 3: strong and weak ties. Empirical work by economists on networks
has largely concerned networks with only one type of connection between agents.
Sociologists, on the other hand, have recognized that social connections may
                                                                                     15


have different manifestations, and that the distribution of different kinds of con-
nections in a social network has an impact on network outcomes. Perhaps the
most well-known distinction among connections is that of strong and weak social
ties. Granovetter (1973) argued that weak ties play an important role in job search
because they relay useful job information more frequently. Lin (2002) suggests
that weak ties are useful because weak-tie job referrals are drawn from a differ-
ent and often better distribution of openings. Montgomery (1994) has embedded
simple two-edge-type social networks into job search models to investigate the
impact of the distribution of weak versus strong ties on employment rates and
wage distributions. While the labor-market literature extolls the virtues of weak
ties, in other aspects of economic life strong ties may be more important. Some
ethnographic work suggests that strong ties have more value to poor individuals
than weak ties. The suggestion is that the poor, lacking access to markets, rely
more on reciprocity in their social networks for the provision of credit and a variety
of commodity flows (see Granovetter (1973, pp. 209–13).)

   The flexibility of weighted sociomatrices allows for the empirical distinction be-
tween strong and weak ties. Suppose that an individual i has niS strong ties and
niW weak ties. Suppose too that the ratio of the strength of strong to weak ties
is θ . Define elements of the peer- effects sociomatrix as

                      
                      1/(niW + θniS ) if j is weakly tied to i;
                      
                 aij = θ/(niW + θniS ) if j is strongly tied to i;
                      
                        0              otherwise.
                      

A statistical model with this kind of network structure can be estimated from sur-
vey data that includes information on tie strength or data on ties that would allow a
researcher to infer the nature of the tie. The AddHealth data set is an obvious can-
didate for constructing weak versus strong ties. Patacchini, Rainone, and Zenou
(2012) in fact explore this possibility by assuming that the weights on friends re-
port in the data are linearly declining in the order listed by each student and by
studying the differences between friendships report in two survey waves versus
one.


                4. I DENTIFICATION WITH KNOWN SOCIOMATRICES


   In this section, we describe identification of the primitive utility parameters γ, δ
and φ when the sociomatrices A and C are known to the analyst. We do not take
a stance on the source of this a priori knowledge. It may be the case that the
matrices are empirical constructions or chosen for theoretical reasons. Formally,
we augment the assumptions made in sections 2 and 3 with

 K. 2. A and C are exogenous and known to the analyst a priori.
16


    K.1 defines the information assumption on the sociomatrices maintained in this
section. The assumption that the analyst knows the values of the sociomatrices
is a strong one, and we believe that standard approaches to generating a priori
values of A and C are often theoretically unjustified. However, since this is in fact
how the bulk of the social interactions and networks literatures has proceeded,
it is important to understand identification for such contexts. K.2 says that the
analyst observes both the outcomes and characteristics of each member of the
population. We will relax this assumption when we consider identification with
aggregated data in Section 4.2.

   One major result of this section is that when individual data are available, there
is a precise sense in which identification of the primitive utility parameters of
the linear social networks models is “typically” the case. In this section we say
that “parameters are identified for generic pairs of sociomatrices” if the set of
sociomatrix pairs ( A, C ) for which utility parameters are not identified is a lower-
dimensional subset of M A × MC . We show this below when A and C are known
a priori. Our results indicate that concerns over simultaneity as a source of non-
identification of social effects are misplaced when A and C are known, unless
one has a justification for working with a model from the non-generic (small) set
of linear social network models in which identification fails.

    We further consider identification when data are aggregated. Consideration of
this case was initiated by Glaeser, Sacerdote, and Scheinkman (2003) and formal-
ized in Graham (2008). They employ versions of the linear-in-means model and
focus on identifying the equivalent of the contextual-effects parameter δ under the
assumption that φ = 0, i.e. peer effects are not present. Here we provide iden-
tification results that generalize the cases these authors studied. We show that
identification is possible when both effects are present and for social structures
other than the linear-in-means specification.

4.1. Individual-level data. We begin by generalizing an important result due to
Bramoullé, Djebbari, and Fortin (2009), which places conditions on the socioma-
trices that are sufficient for identification of the parameters. Our generalization
accounts for distinct peer- and contextual-effects sociomatrices. The result pro-
vides conditions such that the matrix B in the statistical model (6), when identified
with B(s) in the structural equation (5), can be used to back out the values of γ, δ
and φ. Since A and C are known a priori, “is identified” means in this subsec-
tion “is identified in M( A, C )”. The conditions, however, are abstract, and so we
elaborate on them. We show next that the set of ( A, C ) pairs for which these con-
ditions fail is a lower-dimensional subset of M A × MC . Thus identification is the
“typical case”. We provide conditions on the structure of the underlying networks
that are sufficient to guarantee identification of the utility parameters. These re-
sults can be seen as demonstrating how exclusion restrictions are sufficient for
identification.
Theorem 3. Suppose T.1–T.2, E.1–E.5, and K.1–K.2.
                                                                                                 17


         i. If A, C and AC are distinct, then linear independence of the matrices I ,
            A, C and AC is necessary and sufficient for identification of γ, δ and φ.
            The parameter γ is identified if and only if δ is identified.7
        ii. If A 6= C and AC = C, then linear independence of I , A and C is
            necessary for identification of γ, δ and φ, and sufficient to identify γ and
            δ. If γ 6= 0, then independence is also sufficient to identify φ.


   Case i of theorem 3 says that the failure of identification implies the existence
of a non-zero solution in λ1 , λ2 , λ3 and λ4 of the following equation system:

                          λ1 + λ2 cij + λ3 ∑ aij c ji = 0 for all i,
                                                j

                       λ2 cij + λ4 aij + λ3 ∑ aij c ji = 0 for all i 6= j                      (13)
                                                j


  These linear dependence conditions implicitly define the set of matrices A and
C such that identification fails. Our interest in theorem 3 lies in understanding
whether sociomatrices A and C “almost always", “sometimes", or “almost never"
satisfy these restrictions. Genericity of identification captures the idea of “almost
always".8 The following definition explains what we mean when we say that utility
parameters are generically identified.

Definition 3. The utility parameters φ, γ and φ are identified in a generic model
with a priori known A and C if there is a closed subset K of M A × MC of dimen-
sion less than that of M A × MC such that for all ( A, C ) ∈ ( M A × MC ) that are
not in K , utility parameters γ, δ and φ are identified in M( A, C ).9


   It will be useful to know that the dimensions of the set of allowable A and C
sociomatrices are dim M A = N ( N − 2) and dim MC = N ( N − 1), respec-
tively.10 Identification in a generic model means that even when identification in
M is impossible, we can identify utility parameters if we restrict the set of struc-
tures by discarding those with sociomatrices in a lower-dimensional subset of the
allowed sociomatrices. The next result says that this is indeed the case when A
and C are known a priori.

   7
    Additional conditions on A and C imply that if any one parameter is identified, so are the other
two. These conditions hold generically in C for each A and vice versa.
   8
      Our results may be seen as a complement to McManus (1992) who established generic iden-
tification for parametric nonlinear models. He studies a space of nonlinear functions each of which
is indexed by a parameter vector and employs a slightly different notion of genericity.
   9
    The dimensions of sets in this definition are well-defined because these are semi-algebraic
sets. Each is thus the finite union of manifolds, and the dimension is defined to be the largest
dimension of these manifolds.
   10
     Each row of C has one restriction, that the sum be 1 or 0, while each row of A has two: that
the sum be 1 or 0, and that every diagonal element of the matrix equal 0.
18


Corollary 1. For each peer-effects sociomatrix A such that the network contains
a component11 of size at least 3, there is generic subset of contextual-effects
sociomatrices C such that γ, δ and φ are identified in M( A, C ).


    This corollary states that utility parameters are identified in a generic model.
To place this corollary in the education context, suppose that social interactions
are confined to students in a given classroom. Interpret nonzero entries in the
peer-effects sociomatrix A as indicating direct friendship ties between students.
Corollary 1 says that if there are three or more students in this classroom who
are friends or friends-of-friends, for a generic contextual-effects sociomatrix C the
utility parameters are identified.

   The proof of the corollary indicates that there are two ways that a pair ( A, C )
of sociomatrices can cause a failure of identification. First, every individual is
either isolated in the peer-effects network or is influenced by only one person.
Second, for each A there is a low-dimensional set of contextual-effects matrices
C for which identification can fail. This second collection of pairs has the larger
dimension, but the dimension of this set is no more than dim M A (dim MC −
1). This is less than dim M A dim MC , the dimension of the set of all allowable
sociomatrix pairs.

    Corollary 1, while striking, follows from the natural intuition that a priori knowl-
edge of A and C radically decreases the number of unknown parameters in the
best response function in equation (2). With N equations describing individual
behavior, we have N exogenous variables. One would intuitively expect that the
triple (γ, δ, φ) be identified for N ≥ 3. Identification fails when the sociomatrices
are so symmetric that distinct relationships within the network become redundant.
As lemma 3 in the appendix shows, this happens most prominently when C = A
and A2 = A.

    Our finding that identification is generic for known sociomatrices contrasts with
much of the conventional wisdom in the econometric literature on the identifica-
tion of social effects. In particular, since Manski (1993), there has been a recog-
nition that for certain models in which individual choices are a linear function of
the averages of individual characteristics, identification can fail. Manski’s (1993)
demonstration that the utility parameters (γ, δ, φ) are not identified for the large
sample approximation (10) immediately follows from the fact that E(ω̄ g | x ) is lin-
early dependent on 1 and x̄ g . Manski dubbed this identification failure “the reflec-
tion problem", and it has dominated econometric work on social effects ever since.
Note that as the size n g of each group g becomes large, |( A2 )ij − Aij | → 0 and
| Aij − Cij | → 0. The large sample approximation imposes the extreme symmetry
condition described above, resulting in non-identification.

     11
      A component is a maximal connected sub-network.
                                                                                            19


    Corollary 2 gives a sufficient condition that rests on information regarding the
network rather than the specific values of the weights. Formally, this kind of in-
formation can be represented by a graph for each network with vertex set V and
a set of edges corresponding to non-zero elements in the relevant weighted so-
ciomatrix. For instance, there is an edge from i to j in the peer-effects network A
if and only if aij > 0, and similarly for the contextual-effects network C . Axioms
E.2 and E.3 mean that we can represent these networks by undirected graphs.
We write i ∼ A j if there is an edge between i and j in the peer-effects network,
i ∼C j if the edge exists in the contextual-effects network.
Corollary 2. Suppose there are distinct individuals i and j who are connected by a
sequence of edges, some in the peer-effects network and some in the contextual-
effects network, and who are not connected by a path in either the peer-effects
network or the contextual-effects network alone. Then γ, δ and φ are identified.


   This corollary demonstrates how restrictions on merely the existence of social
interactions imply identification. Its conditions are satisfied whenever components
of the networks overlap.12 For instance, if families attending a given school de-
liver contextual effects at the school level (e.g. they provide public goods) but peer
effects do not cross classrooms or grade levels, then the utility parameters are
identified. This condition cannot arise when one assume that A = C, and il-
lustrates how the existence of richer peer and contextual social structures can
facilitate rather than hamper identification.

    Taken as whole, theorem 3 and corollaries 1 and 2 show, in our judgment, that
concerns about non-identification with a priori knowledge of A and C are mis-
placed. Of course, our genericity finding in corollary 1 does not mean that a given
model is identified. Rather, it says that if the utility parameters are not identified,
then the researcher’s choice of A and C is a very special case relative to the set
of matrices that are consistent with the behavioral model we have described. It is
always possible that a researcher has a principled reason for choosing socioma-
trices under which identification fails. Our message is simply that such a reason
needs to be present to conclude that the presence of social effects in preferences
cannot be uncovered by the data.

    Corollaries 1 and 2 are instances of case i. of theorem 3, and comparing
them to previous work on identification and the linear-in-means model highlights
the fragility of the reflection problem. Previous work has already produced vari-
ations of the linear-in-means model in which, unlike Manski’s formulation, iden-
tification holds. Lee (2007), Lee, Liu, and Lin (2010), Bramoullé, Djebbari, and
Fortin (2009) and Davezies, d’Haultfoeuille, and Fougère (2009) provide positive
identification results based on (9), the exact linear-in-means model as opposed
to the large sample approximation. Bramoullé, Djebbari, and Fortin (2009) and
   12
      The exception is when the components of the peer-effects network are unions of components
of the contextual-effects network.
20


Davezies, d’Haultfoeuille, and Fougère (2009) study a version of Lee (2007), and
find that if there are at least 3 groups of different size, identification holds for the
exact model. Further, Bramoullé, Djebbari, and Fortin (2009) and Blume et al.
(2011) show that the Manski non-identification result will hold if, contrary to our
theoretical reasoning, aii is non-zero, which in the linear-in-means case implies
that if each agent reacts to an unweighted average of the expected choice, the
reflection problem reemerges even if groups are finite – a conclusion that was
anticipated in Moffitt (2001).

   The following corollary is a mild generalization of previous results and is an
instance of case ii of theorem 3.
Corollary 3. Suppose there is a component of the contextual-effects sociomatrix
C such that all cij are equal and assume that any component of the peer-effects
network is either a subset of or disjoint from the contextual-effects component.
Suppose also that there exist two pairs of individuals i 6= j and k 6= l in the
contextual-effects component such that aij 6= akl . Then γ, δ and φ are identified.

   This corollary says that if there is a subset of the network such that the linear-
in-means assumption applies with respect to contextual effects and components
associated with peer effects are either subsets or disjoint from this component,
then identification will hold if two distinct pairs of individuals have different peer-
effects sociomatrix values. This illustrates how fragile the reflection problem is.
In a classroom setting, for instance, if one takes the peer- and contextual-effects
components to be the entire classroom as the linear-in-means model does, then
a single inequality in A involving non-overlapping pairs of students is sufficient for
identification.

4.2. Aggregate Data. Individual-level data on social networks are often unavail-
able, or are incomplete due to sampling gaps. However, aggregate statistics are
widely available (e.g.: average standardized test scores at the school-level, city-
level crime incidence, county-level unemployment rates, etc.). One approach that
takes advantage of such data, originating with Glaeser, Sacerdote, and Scheinkman
(1996, 2003) and later extended by Graham (2008), focuses on the informational
content of cross-sectional data on group level averages.

   To see how such data can be related to the linear social interactions model we
have developed, consider data drawn from G + 1 non-overlapping groups num-
bered g = 0, . . . , G. Each group g contains n g members. We assume that the
primitive utility parameters γ, δ and φ are constant across the groups in order to
render the use of aggregate data interpretable, but that sociomatrices are group-
specific, so each group g is associated with a distinct set of sociomatrices A g and
C g . For many contexts, heterogeneity in social structure seems natural across
groups, even when populations are of the same size. One example is school
classrooms, where one would naturally expect different social structures, even for
classrooms of a given size.
                                                                                            21

                  g   g        g
   Denote by ωi , xi and ε i the outcomes, observed characteristics, and unob-
served characteristics, respectively, of individual i in group g and let ω̄ g , x̄ g and ε̄ g
be the group-level averages of these variables. The model is such that assump-
tions T.1–T.2, E.1–E.5 hold at the group level. In addition, we assume:

  K. 10 . For all g, A g and C g are exogenous and known to the analyst a priori.
  K. 20 . For all g, the analyst observes (ω̄ g , x̄ g ).

   Axioms K.10 establishes what, in this section, is assumed to be the analyst’s
a priori knowledge. Axiom K.20 modifies K.2 so that the analyst only observes
group-level averages of x and ω . For each group, let (ω g , x g , ε g ) denote the vec-
tors of outcomes and observed and unobserved group characteristics for group g,
respectively, and let ñ g denote the vector each of whose elements is 1/n g . Given
equations (5) and (4), ω̄ g , x̄ g , and ε̄ g are related to the individual-level variables
by
                                             g                           1
             ω̄ g ≡ ñ g ω g = ñ g µε + ñ g Bφ (γx g + δC g x g ) +       ñ g ε g      (14)
                                                                        1+φ

   A natural starting point for many empiricists would be to estimate a linear-in-
means model, which amounts to imposing the restriction on (14) that the rows and
columns of A g and C g each sum to 1. This yields
                                                           1 g
                           ω̄ g = µε + (γ + δ) x̄ g +         ε̄                          (15)
                                                          1+φ
It is easy to see from this equation that separate identification of the structural
parameters from the joint distribution of ω̄ g and x̄ g is not possible: δ and γ enter
the joint distribution only through the sum, and φ cannot be untangled from the
variance of ω̄ under our current assumptions.

    While the first moments do not permit identification, the key insight of Glaeser,
Sacerdote, and Scheinkman and Graham is that, under further assumptions, sec-
ond moments may. Glaeser, Sacerdote, and Scheinkman pointed out that con-
ditional on x̄ g , variation in ω̄ g is consistent with the variation that would be pre-
dicted in averaging i.i.d. random variables. Their argument, which is heuristic, is
that Var(ω̄ g | x̄ g ) will reveal social interactions by comparing the sample variances
for different group sizes to one in which ωi − E(ωi | x̄ g ) is i.i.d. within and across
groups.

  Following Glaeser, Sacerdote, and Scheinkman (1996) and the case in Gra-
ham (2008) where group level effects are absent, we add the following additional
constraint on the model in this section.13
                      g        g                  g        g
 E. 6. For all i, j xi and x j are i.i.d. and ε i and ε j are i.i.d.

   13
     Graham (2008) has additional identification results in the case where random group effects
are present.
22


This is a stronger i.i.d. assumption than we have had so far, namely that for all
       g       g
i, j, xi and ε i are i.i.d. Together with E.6, equation (14) yields:14
                                                            !2                      2
                                1                                               1         1 2
                                        ∑ ∑
                                                       g
                Var(ω̄ g ) =                          Bij        σx2   +                    σ    (16)
                             ( n g )2   j∈ g   i∈ g
                                                                               1+φ        ng ε

Setting one group, g = 0, as the baseline, define the following statistic for the
remaining groups g = 1, . . . , G, where Var( x ) = σx2 is observed
                                       n g Var(ω̄ g ) n0 Var(ω̄ 0 )
                                νg =                 −
                                            σx2           σx2
                                                                                                   g
   The following theorem shows that ν g can be used for identification. Define M A
         g
and MC to be the set of peer- and contextual-effects sociomatrices for group g;
that is, they satisfy the matrix assumptions T.1, E.2 and E.3.
Theorem 4. Assume T.1–T.2, E.1–E.6 and K.10 –K.20 . Suppose δ, φ, and β =
(γ + δ) 6= 0. Suppose there are groups 0, . . . , G, that G ≥ 5, and that for each
group g = 1, ...5, n g ≥ 3 and A g is not bistochastic. Then the set J of matrices
(C1 , . . . , C5 ) such that ν1 , . . . , ν5 does not identify the utility parameters γ, δ and
                                                               g
φ is a closed lower-dimensional subset of ∏5g=1 MC .

    Theorem 4 says when data are in the form of group averages, second moments
can be used to identify the utility parameters provided that the ( A g , C g ) pairs
fulfill a condition on C g that, given A g , holds generically. In addition, one needs
a certain degree of variation across the sociomatrices to allow for the different
groups to provide distinct second moments from which the utility parameters can
be backed out.

   The theorem builds on Graham (2008), who explores the case in which peer
effects are effectively absent (for all g, A g = 0), and contextual effects are char-
acterized by a linear-in-means structure where for all g, cii = 0 (all of which are
allowed by T.1–T.2 and E.1–E.5). The linear-in-means assumption reduces the
number of required groups with distinct C g ’s to 3 relative to the 5 in theorem 4.
Our result indicates that the logic of Graham’s analysis extends beyond the linear-
in-means model. It does not require the absence of a peer effect. Neither does it
require different group sizes, which in his analysis generates the necessary vari-
ation for identification. However, in our formulation, this comes at a cost: data
loss in moving from individual to group-average observations necessitates a pri-
ori information on characteristic covariances. Although we conjecture that similar
     14
      Equation (16) follows directly from
                                         
                             1                     1 1
                    ω̄ = µ + g ∑  ∑ Bij  x j +
                                                 1 + φ n g i∑
                      g     ε           g    g                     g
                                                               ( ε i − µ ε ).
                            n j∈ g i∈ g                     ∈g
                                                                                   23


statistics can be constructed with more complicated covariance structures, here,
we have assumed independence.


4.3. Mixed individual and aggregate data. We conclude this section by con-
sidering linear social interactions models that are based on a combination of
individual-level and aggregate data. A number of studies, including many in
the important first generation of empirical social interactions research, combine
individual-data from the Panel Study of Income Dynamics (PSID) with averages
of individual outcomes measured at the Zip Code level (Datcher 1982, Corcoran
et al. 1992) or the census-tract level (Sharkey and Elwert 2011). This combi-
nation exploits the geographic identifiers in the PSID to construct measures that
are interpreted as social influences. The sampling scheme for the PSID, when
combined with aggregate information, produces regressions of the form
                           ωi = b0 + b1 xi + b2 x̄ g + ηi                       (17)
where g denotes the relevant level of aggregation. This regression, to be inter-
pretable as an equilibrium strategy profile, implies assumptions of the form (8).
Since the sampling scheme we describe provides no information on A g and C g ,
this equation represents an information reduction relative to the row describing
ωi in equation (6), which we have already showed is not identified when these
matrices are unknown. Relative to the ωi row found in equation (6), equation (17)
represents a misspecified regression so the parameters in (17) will depend on the
underlying parameters γ, δ, φ, A g and C g . The one positive use of (17) is that if
b2 = 0, then neither peer nor contextual effects are present in the preferences of
agents.


      5. I DENTIFICATION WITH PARTIAL I NFORMATION ON S OCIOMATRICES

    Theorem 2 states that without prior knowledge on the sociomatrices beyond
what is necessary for the existence of a Bayes-Nash equilibrium in the quadratic-
payoff game, there is little that can be learned about the preference parameters
which constitute the primitives of the behavioral model. Section 4 explored the
polar opposite case that is employed in most empirical applications, namely iden-
tification when these matrices are (assumed to be) known. We now explore the
degree to which parameters can be identified with only partial knowledge of social
interactions.

   There are many ways in which one can model partial knowledge of A and C.
Two forms of partial knowledge are, in our view, particularly salient. First, the an-
alyst may have a priori knowledge about C without any a priori knowledge about
A beyond T.1 and E.2. This is a natural case to consider because peer effects
embodied in A represent a primitive psychological proclivity to behave similarly
to others, for which theory provides no guidance. Such guidance may, however,
exist for C. Classrooms provide a simple example. If students supply some goods
24


which are partially public, for example musical instruments, then average parental
income may be plausibly assumed to determine the level of such goods, which
constitute a contextual effect in our model. Alternatively, data sets exist in which
parental involvement in a classroom is measured (e.g. Bassani (2008) and Sui-
Chu and Willms (1996)). The total level of parental involvement can represent a
public good analogous to the musical instrument expenditures example. If social
units produce public goods, the decision mechanism will implicitly define contex-
tual effects; this occurs in Calabrese et al. (2006).

    A second type of partial knowledge of sociomatrices may come from data sets
in which individuals are asked to identify those to whom they are connected.
These data sets, leaving aside imperfections such as limits on the number of
friends that can be named, represent cases in which the analyst has information
about connections between individuals but not the sociomatrices themselves. In
such contexts, a researcher needs to make a judgment as to the interpretation
of the data on direct connections in term of the sociomatrices. Knowledge of the
presence or absence of ties between individuals in the network creates a close
parallel between identification of social interaction parameters and classical re-
sults on the identification of simultaneous equations systems, since holes in the
network (i.e. the absence of edges) in essence provide exclusion restrictions that
can be exploited.

     Throughout subsection 5.1 we impose two additional constraint on models.

 E. 6. −γ/δ is not an eigenvalue of C.
 E. 7. φ > 0.

    These constraints differ from those in section 4 since they do not pertain to
objects observed a priori. Assumption E.6 ensures that B is non-singular. As-
sumption E.7 is largely for convenience. If φ = 0, then the identified matrix B
is a linear combination of I and C. The converse is true if I , A, C and AC are
independent. This is generically true, but we would like to do better since A is
unobservable. Results such as corollary 2 show that this can be guaranteed with
modest additional a priori information about the peer-effects social network. Such
is the case, for example, in theorem 5 below.

5.1. Unknown peer-effects sociomatrix A. Peer networks are notoriously hard
to measure, and so here we investigate identification when the contextual-effects
sociomatrix C is known, but the analyst has either partial information, or none at
all, on the peer-effects sociomatrix A. For the case in which the researcher knows
C and the topology of the peer-effects network, one can establish identification
under weak conditions, as seen in theorem 5.
Theorem 5. Assume that contextual-effects sociomatrix C is known a priori. As-
sume too that the peer-effects sociomatrix A is unknown but the peer-effects net-
work is known a priori. Suppose that N ≥ 3. Suppose that there are two distinct
                                                                                                 25


individuals j and i who are known to be unconnected in the peer-effects network.
If B− 1
    ji 6 = 0, then the utility parameters γ, δ and φ are identified from the condi-
tional mean of ω given x.

    Theorem 5 demonstrates that even when the peer-effects sociomatrix A is un-
known, all three utility parameters can still be separately identified from first mo-
ments under certain conditions. The theorem presents an instance where the
analyst has partial knowledge of A. Even without knowledge of A, however, iden-
tification is possible. Denote by M0 (C ) the set of models M(C ) satisfying, T.1–
T.2 and E.1–E.7. Theorem 6 states that the phenomena of which theorem 5 is a
specific instance, is generic.
Theorem 6. Assume T.1–T.2 and E.1–E.7. Suppose only the contextual-effects
sociomatrix C is known.
       i. If N ≥ 3, then for each C ∈ MC there is a generic subset S A ⊂ M A
          such that if A ∈ S A , then γ, δ and φ are also identified in MC  0 by the

          conditional mean of outcomes given characteristics.
      ii. If E.7 is relaxed by assuming that φ = 0, then result i. holds for all but a
          generic subset of MC  0 .


   The theorem specifies conditions under which there exist two distinct (i.e. non-
identical) diagonal elements of B−1 , which as the proof establishes, is sufficient
for identification of all utility parameters. Indeed, under these conditions, the peer-
effects sociomatrix is also identified. While this may seem surprising, the intuition
can be understood by considering equation (4). The dimension of the set of peer-
effects matrices is N ( N − 2). The dimension of the set of all B(s) matrices
that come from a (known) common contextual-effects matrix C ∗ is no more than
N ( N − 1) + 1, but we can show it to be no less than N ( N − 2). We need to
recover N ( N − 2) + 3 parameters from B(s). Corollary 4 states that this recovery
is possible.15
Corollary 4. Under the conditions of theorem 6, the peer-effects sociomatrix A is
identified.

5.2. Identification with a priori qualitative network knowledge. As noted in
section 2, data sets with network data, such as AddHealth do not furnish the
sociomatrices A and C: survey respondents indicate to whom they are connected,
but not the weights. We can interpret such data as providing information about
exclusion restrictions, the location of 0’s in the A and C matrices. No survey
we know of distinguishes between peer- and contextual-effects networks. We
suggest that data collection, even if measures of interaction intensity cannot be
constructed, allow for distinct sociomatrices.
    15
      Drton, Foygel, and Sullivant (2011) provide similar results to ours on the recovery of A. How-
ever, that paper assumes the unobserved heterogeneity is jointly normal and it assumes that con-
textual effects are absent.
26


    How can such knowledge facilitate identification? In this section we show that
if the networks are sufficiently sparse, there is a path to identification which is
analogous to classical simultaneous equations results. Without loss of generality,
assume that µ = 0, since the more general case involves constant terms that
are irrelevant to the identification of parameters of interest. The matrix B, which
characterizes the equilibrium strategy profiles, is identified by theorem 2, and this
identifies the sum γ + δ.

  Let bi denote the ith row of B, and similarly for A and C. Consider the ith
equation of the system
            γ + δcii       δ                         φ                               1
     ωi =
             1+φ
                     xi +
                          1+φ    ∑ cij x j + 1 + φ ∑                aij b j · x +
                                                                                    1+φ
                                                                                        εi   (18)
                                 j ∼C i                    j∼ A i
                                                           1
        = π1 x i +   ∑ π2j x j + ∑        π3j b j · x +
                                                          1+φ
                                                              εi                             (19)
                     j ∼C i      j∼ A i
                      j 6 =i

These equations suggest regressing ωi on the the vectors x and Bx, and the
following theorem describes what can be learned from this procedure. Let B A ¬C
denote the submatrix of B whose rows correspond to individuals connected to i
through the peer-effects network and whose columns correspond to individuals
not connected to i through the contextual-effects network. Recall that i ∼ A j
indicates that there is an edge between i and j in the peer-effects network, and
i ∼C j that an edge exists in the contextual-effects network.
Theorem 7. Assume T.1–T.2 and E.1–E.4. Assume that for some i, B A ¬C has
full row rank equal to the number of individuals j connected in the peer-effects
network to i, denoted as #{ j : j ∼ A i }. Then
       i. The weights aij for j ∼ A i are identified.
      ii. φ is identified.
     iii. If there is a j 6= i such that i ∼C j, then the point (γ, δ) lies on the
          line γ + δ = β at the point (γ, δ) = (1 − cii )−1 ( β − π1 , π1 − βcii ), for
          0 ≤ cii < 1.
     iv. If there is a w 6= i such that i ∼C j and π2j = 0 for some j ∼C i, then
          this is true for all j ∼C i, δ = 0 and γ = π1 .
      v. If k, j ∼C i then cik /cij is identified.
If C is known a priori then ai (the ith row of A) and all utility parameters are
identified. A necessary condition for these conclusions is that 1 + #{ j : j ∼C
i, j 6= i } + #{ j : j ∼ A i } ≤ N .

   Theorem 7 says that under certain conditions, holes in the network can enable
identification: they serve as exclusion restrictions, which can be exploited to back
out the utility parameters. Theorem 7’s necessary condition is an order condition,
and the sufficient condition is a rank condition (see Hsiao (1983, Theorem 3.3.1)
for a clear exposition). One way to understand this theorem is to recall that un-
der our assumptions, Bx = E (ω | x ). Thus the regression of equation (19) looks
                                                                                                    27


like the second stage of a two-stage least-squares estimation procedure. The
differences between the classical results and ours lay in the fact that in the clas-
sical case identification of the second-stage parameter estimates is not an issue,
and the rank and order conditions have to do with backing structural parameter
estimates out of the second-stage estimates. Here, in contrast, the issue is first
identifying the parameters πi , then using these to recover structural parameters.
The utility of part iii. of the theorem is that information about cii may partially
identify γ and δ. In particular, if cii is known a priori, then γ and δ are identified.
Finally, note that typically i ∼C i, and in this case the necessary condition is that
the total number of edges emanating from i in either network not exceed N .

   The results in sections 5.1 and 5.2 have important implications in terms of the
interpretation of surveys that measure social networks. In terms of interpretation,
Theorems 5–7 demonstrate the importance of network structure in generating
identification. The key conditions across our results is a priori knowledge of 0’s in
the sociomatrices. Survey data on social networks do not provide information on
the intensity of bilateral interactions. Rather they provide information on whether
or not a bilateral interaction is present. Our emphasis on the importance of “holes"
in the social structure extends the argument in Bramoullé, Djebbari, and Fortin
(2009) that 0’s in a known sociomatrix allow for instruments. Our results show
that these 0’s can facilitate identification even when, unlike Bramoullé, Djebbari
and Fortin, the sociomatrices are unknown.

    Our results also suggest a potentially serious limitation in current surveys,
specifically Addhealth, which is arguably the most popular data set for the study of
social network effects. Its main draw is that high school students in its nationally
representative sample are interviewed not only about the usual demographic and
outcome variables of interest, but also about who their friends are. Unfortunately,
the data set’s friendship questions are restricted in that each student is allowed to
name up to 5 friends of each gender. This has important ramifications in view of
the result in theorem 5, which indicates that it is more useful to know who is not
someone’s friend rather than who is. Moreover, the restriction on the number of
friends means that the failure to identify someone as a friend does not mean that
there is a corresponding zero in the associated sociomatrices. While the limitation
on the number of friends that could be named in the interviews has long been un-
derstood as inducing measurement error in network structure, as far as we know,
the effects of this limitation on identification per se have not been recognized.16

   Our results provide an important generalization of Lee, Liu, and Lin (2010) as
we do not need to assume that each agent equally weights others to whom he is
directly connected. Lee, Liu, and Lin assume that the sociomatrices are functions
of the common adjacency matrix, which clearly does not need to be the case.
   16
      Another concern is that the failure to identify someone as a friend is consistent with a negative
entry in one or both of the sociomatrices we have employed. While we have assumed that all ele-
ments of A and C are non-negative (axiom T.1) negative values are certainly empirically plausible.
We thank Jesse Naidoo for this observation
28


5.3. Identification with aggregated social network data. We conclude this sec-
tion with an analysis of a different type of partial knowledge, namely partial knowl-
edge that reflects the absence of individual level data with which to evaluate social
effects. Section 5.2 provided some positive results on inference of structural pa-
rameters when social interaction effects data are aggregated. Here we show that
these effects disappear when individuals are sampled across groups and paired
with group level averages. For data sets employing the PSID, for example, it is
common to see models in which individual outcomes are assumed to depend on
individual characteristics and certain census tract aggregates. We provide a link
to this type of empirical analysis by considering the case where data are of the
form ωi , xi , ω̄ g , x̄ g , where ω̄ g and x̄ g denote group level average outcomes and
characteristics, respectively, of i’s group g. We make two knowledge assump-
tions. First, we assume that C is known because otherwise information would
be lost relative to theorem 2 and identification would obviously fail. Second, the
analyst only observes one individual per group, whom we denote as 1.

 K. 100 . C is exogenous and known to the analyst.
 K. 200 . For all g, the analyst observes (ω̄ g , x̄ g , ω1 , x1 ).

Finally, we place a restriction on the nature of observed heterogeneity, namely,
that it is i.i.d. across members of the same group.

 E. 8. For each g, xi is i.i.d. within g.

   For each individual i in the sample we observe that individual’s record and
his group averages. The presumption is that the individual’s social network is
confined to the group. The individual can be netted out of the group average, so
from equation (5) we derive two relationships: one for the behavior of everyone
but individual i, and one for the behavior of individual i.
                     E(ω̄ g | xi , x̄ g ) = µ g + b g E( x | xi , x̄ g ) + bgi xi
                                                                                    (20)
                      E(ωi | xi , x̄ g ) = µi + b−i E( x | xi , x̄ g ) + bii xi
where the bars denote group averages exclusive of individual i, and variables
with a i subscript refer to individual i. The coefficients bgi = ∑k∈ g,k6=i bki , b g =
(1/( N − 1)) ∑ j,k∈ g,k6=i Bkj , and b−i = ∑ j∈ g,j6=i bij are all sums of terms in the
matrix B.
Theorem 8. Assume T.1–T.2, E.1–E.4 and E.8, and suppose that E(ω̄ g | xi ) and
E(ωi | xi , x̄ g ) are known. Then β = γ + δ is identified, and γ, δ, φ are not identi-
fied.


   Theorem 8 shows that the assumption of a linear-in-means structure entails too
great a loss of information to allow for identification of the utility parameters. As in
other cases, if the projection of ωi onto xi and x−i differs from the projection of
ωi onto xi , then all one can say is that some sort of social interaction is present.
                                                                                                 29


This is a cautionary message given the ubiquity of these models in empirical prac-
tice. Our results provide a complement to Davezies, d’Haultfoeuille, and Fougère
(2009) who consider the problem of identification for a linear-in-means model in
which the analyst does not have data on the group aggregate variables, but does
know the group sizes. Identification is shown to hold when there are groups of at
least 3 distinct sizes. Our relatively negative result stems from the heterogeneity
in sociomatrices across groups. This precludes our use of that paper’s approach,
whereby observed means of others can be treated as mismeasured true means.
For our context, the mismeasurement involves loss of information on the weights
of the sociomatrix as well as the values of x and ω .


                       6. E NDOGENEITY OF S OCIAL S TRUCTURE

   In this section we explore the consequences of network endogeneity. We first
discuss the self-selection problem. Second, we examine how durable networks,
in which unobserved (to the analyst) determinants of social interactions arise after
the network is formed, create a distinct identification issue.

6.1. The selection problem. A standard concern in uncovering social interac-
tions is the endogeneity of the social structure. The issue is straightforward:
does a correlation between high ability friends and an individual student’s edu-
cational performance reflect a social interaction of the type we have modeled or
does it occur because the student’s unobserved type is correlated with his friend-
ship choices? This concern has generated interest in randomized assignment to
groups, as in Sacerdote (2001), as well as cases in which a “natural experiment"
alters group composition, e.g. Cipollone and Rosolia (2007).17 A focus on data in
which exogenous social structure is present delimits the domain of environments
that may be studied, so it is important to understand how endogeneity should be
understood and accounted for in more general settings.

    A natural way to extend our model of social interactions to network formation
is to formulate a two-stage game, in which networks are formed in the first stage
and actions are determined in the second. For each possible network there is
a unique second-stage equilibrium, and each individual’s expected utility of this
second-stage equilibrium is a value function for the network which gives payoffs
for the first-stage game.

   While this abstract conceptualization is useful in understanding the implications
of endogeneity, it is not one that can be directly implemented in the context of an
econometric model of network formation and subsequent choices. The reason
for this is that there simply does not exist a viable general theoretical model of
network formation. Networks for business relations, job search and classroom
   17
     Blume et al. (2011) discuss how quasi-experiments may not satisfactorily resolve self-selection
problems in identifying social interactions.
30


friendships are formed according to very different rules, and vary greatly in the
degree to which they are instrumental for the second-stage game. While network
formation games have been formulated for particular contexts, they do not even
include pair-specific weights in the decision process.

    An alternative approach is to imagine conditions that should be properties of
equilibrium outcomes for many different games. This path, first travelled by Gale
and Shapley (1962), leads to network stability concepts such as pairwise stability
(Jackson and Wolinsky 1996) and pairwise-Nash stability (Calvó-Amrengol and
Ilkiliç 2009). A network is pairwise-Nash stable if and only if a) no individual wants
to drop any edges, and b) there is no missing edge that if added would, ceteris
paribus, be a Pareto improvement for the individuals it connects. It is neither
a strictly cooperative nor a strictly non-cooperative concept. Stability expresses
the idea that breaking relations is a non-cooperative activity while forming new
relations involves mutual consent.

    While this approach has been employed in a few recent studies18 it is not a
panacea. The basic problems are threefold. First, stable networks may not ex-
ist. Non-existence, however, can be circumvented by introducing random stable
networks, that is, probability distributions on graphs which satisfy an expectation
based concept of stability — that is, one can imagine a probability distribution on
graphs for which the inequalities in the stability definition are satisfied in expecta-
tion. Existence can easily be shown in two cases: if ε is observed only just prior to
the second stage or the support of the marginal distribution of ε is finite.19 In the
first case, selection is not an issue because private types are not observed until
after the network is formed. In the second case, discreteness of the set of possi-
ble z’s rules out many common econometric models. It is quite possible, however,
that an existence proof can be provided for more general classes of models.

   A second problem for both pairwise-stable and random pairwise-stable net-
works is that factors other than the utility of second-stage choices may play a role
in determining the utility of a given network. The sociology literature is replete with
descriptions of such payoffs. For instance, there might be an independent value
to homophily — associating with people similar to oneself — which is distinct from
    18
      Badev (2013) studies the coevolution of friendship networks and smoking behaviors in an en-
vironment where agents make myopic friendship decisions among k − 1 randomly selected others.
This model is shown to converge to a k −stable Nash network, which means that no agent wishes
to deviate by simultaneously altering k − 1 friendship statuses as well as his choice. Sheng (2012)
uses pairwise stability in the context of identification of a network formation game but omits choices
that are affected by network structure. Hsieh and Lee (2012) follow a strategy related to ours but
with perfect information, considering a two-stage game in which social structure is formed in stage
1 and choices are made in stage 2.
     19
     For both cases, consider Myerson’s (1991) network formation game. In the first case, the first-
stage game is a complete-information game, and a correlated equilibrium will satisfy the needed
inequalities. In the second case, a perfect direct correlated equilibrium (Dhillon and Mertens 1996)
of Myerson’s (1991) network formation game is a pairwise-Nash stable random graph, and since
Myerson’s game is finite, these equilibria exist.
                                                                                                   31


the value of the game outcome. Structural estimation of these models, then, in-
volves specifying these additional factors. This requirement may be impossible to
realize.

    A third problem is that the set of pairwise stable random graphs will typically
not be a singleton. Thus partial-identification techniques will come into play, and it
may be that the set of pairwise stable random graphs is too large to impose useful
first-stage restrictions.

  For these reasons, we believe it makes more sense to address endogeneity by
considering its effects on inference from data on the second stage of the game.
This involves returning to our model and asking how endogeneity can invalidate
our assumptions. From this vantage point, the implications of endogeneity depend
on the information available to agents when networks form.

    If either the public types or the private types relevant for the second-stage
choice are not observed at the time the network is formed, then the missing vari-
able cannot enter into the first-stage interim payoff functions. In this case, the
linear structure of the second stage is maintained and endogeneity is not an is-
sue. By contrast, suppose that x and zi are available to agent i at the outset of the
first stage. The expected second state payoff will depend upon both of these vari-
ables, and so both will influence individuals’ first-stage choices. Consequently, an
individual i, observing that he is connected to j, can, with knowledge of x j , make
an inference about the value of z j that is dependent on x j . Thus E.4 is violated. In
this case µ( x, z) is not independent of x, and second-stage equilibrium strategy
profiles are no longer linear in x, except for special cases. (They are, however, still
described by theorem 1.) This is the selection problem. It is not just a statistical
issue. It affects the basic structure of equilibrium, because it affects inference not
only of the econometrician but of individuals constructing the network.

   How can one proceed? From the perspective of the reduced form model (5)
coefficients B, the only effect that endogeneity can have under the information
regime we have described is through E (ε| x ) = E (µ( x, z)| x ). This expression
is in fact nothing more than Heckman’s classic control function (e.g. Heckman
(1979), Heckman and Robb (1986)). So long as µ( x, z) does not depend linearly
on x, identification will still hold. To be clear, the robustness of identification to
endogenous network formation exploits the quadratic game structure that leads
to linear equilibrium strategy profiles. But this is true for general control function
approaches; they break down when E (ε| x ) is linear in x. Hence Heckman’s fun-
damental idea that self-selection can be addressed by incorporating self-selection
into the analysis, rather than using instrumental variables, applies to social inter-
actions contexts.20
   20
      The idea that selection on unobservables can aid in identification of social effects via control
functions was first shown in Brock and Durlauf (2001). Brock and Durlauf (2006) provide a more
general treatment when agents select into non-overlapping groups and the sociomatrix weights are
required to be equal as occurs for the linear-in-means model. Our current discussion makes two
32


    Where would instrumental variables approaches come into play in this setting?
Suppose that the researcher has available a vector of observable individual at-
tributes v. From the vantage point of this two-stage game, the critical question
involves the timing by which this information is revealed. If agents observe v by
the outset of the second stage, then endogenous network formation means that
one needs to analyze E (zi | x, v). But this means that v no longer constitutes an
instrument, since it is correlated with the errors in the regressions that emerge in
the second stage of the game. In this sense, the pro forma use of instruments on
the grounds that they are associated with the payoffs of network formation and not
behaviors conditional on the network is invalid. Once one introduces instruments
to account for network heterogeneity, one needs to account for their implications
for the second stage regression errors, which will, outside of special cases, be
present even if the payoff in the second stage is independent of the instrument.



6.2. Durable Networks. The preceding discussion took the point of view that
network formation transpired prior to, and only for the purpose of, second-stage
strategic interaction. An alternative (and sociologically richer) view is that a given
social network serves many purposes, and co-evolves continuously with the be-
haviors it facilitates. We submit that for many of the subjects to which social
interaction models have been applied, this is more descriptively accurate than the
preceding two-stage game. Suppose, then, that social networks are durable infor-
mal institutions, and that relations are ongoing. It is reasonable to suppose that
as a result of this process, variables that are unobserved at the time of network
formation are revealed over time to network members and generate social inter-
actions, but nonetheless may remain invisible to the researcher. Such variables
may include things like generalized ability, or personality traits that the researcher
cannot measure but may nonetheless theorize about. These variables – public to
network members but unobservable to the analyst – leave traces in the correlation
of individuals’ choices. In our view, the issue of unobserved carriers of social inter-
actions represents the complement to the standard concern about self-selection
that is the focus of Section 6.1. Endogeneity of networks, we argue, can occur
with respect to one set of variables, while social interactions occur with respect
to another. Endogeneity, from this vantage point, alters the relationship between
the variables relevant to the second stage of the game and the variables relevant
to the first. In this subsection we investigate what can be learned about utility
parameters for such variables from second moments.

  We suppose that there is a characteristic u which is unobservable to the econo-
metrician, but observable to individuals in the networks. We amend the theory


important extensions of this earlier work. First, an explicit game for the sequential formation of
social networks and the subsequent choices of actors in the network are described. Second, the
analysis indicates that the control function approach applies to a much wider class of environments
than had previously been established.
                                                                                              33


accordingly, so the utility function is now21
                                                                         !
  Ui (ωi , ω−i ) =     γxi + δ ∑ cij x j + γu ui + δu ∑ cij u j + zi         ωi
                                   j                        j
                                                                                      !2
                                                    1      φ
                                                   − ωi2 −           ωi − ∑ aij ω j         (21)
                                                    2      2                 j

The equilibrium analysis is unchanged, and the equilibrium strategy profile is
                                   −1
                    1         φ
   f ( x, u, z) =        I−      A      (γI + δC ) x
                   1+φ       1+φ
                                −1
                 1         φ                                          1
            +         I−      A      (γu I + δu C )u + µ( x, u, z) +     z (22)
               1+φ       1+φ                                         1+φ
where µ( x, u, z) is derived in a fashion analogous to µ( x, z). We make the fol-
lowing assumptions about observations:

 K. 1000 . A and C are exogenous and known to the analyst a priori.
 K. 2000 . For all i, the analyst observes (ωi , xi ), but not ui .

Under these assumptions, the econometric model becomes
                              ω = µ + B(s) x + Bu (s)u + ε                                   (5’)
where
                      Bu (s) = Bφ (s)(γu I + δu C ).
The unobserved component ε is now the entire second line of equation (22).

    We ask two questions in this framework: when are the utility parameters γ,
δ and φ identified from B(s), and when are the utility parameters corresponding
to the unobserved public variables γu and δu identified? The answer to the first
question is straightforward: if (u, z) is independent of x, then µ( x, u, z) will be
independent of x, and so all the theorems above not requiring independent errors
still apply.

    More interesting is the second question, what can be identified concerning util-
ity parameters for the unobservable public type. While social interactions effects
pertaining to unobservables have yet to be systematically investigated, there are
good reasons to think that such effects are of interest. For example, in the modern
work on cognitive and noncognitive skills, e.g. Cunha and Heckman (2007) and
Cunha, Heckman, and Schennach (2010), these skills are explicitly interpreted as
latent variables in a measurement system. It is natural to think that the skills of
others affect a student in a classroom, for example. An important extension of our
   21
     We have assumed the same sociomatrix describes contextual effects for both x and u. The
cost of relaxing this assumption is that the econometrician is required to know a priori both so-
ciomatrices.
34


result would involve an explicit consideration of unobservables when a measure-
ment system exists that relates the unobservables to observables such as test
scores. Identification will have to come from the covariance matrix, and this will
require strong independence hypotheses. We extend our econometric assump-
tions as follows:

 E. 40 . For all k, i, j ∈ V , xk , ui and ε j are pairwise independent.

It follows from E.40 that equation (2a) still holds, and that the ui will be indepen-
dent. We have the following result:
Theorem 9. Suppose that the ε i are i.i.d. with variance σε2 , that the ui are i.i.d. with
variance σu2 , and that assumptions T.1–T.2, E.1–E.3, E.40 , E.5, and K.1000 –K.2000 .
For generic pairs ( A, C ) of peer- and contextual-effects sociomatrices, the follow-
ing are identified from the covariance matrix of ω : γ, δ, φ, and σε2 , and the sets
±(1/σu2 )(γu , δu ). In particular, the sets γu = 0 and δu = 0, and the ratio γu /δu
(when it is defined) are identified.

   The parameters γu and δu are identified only up to a non-zero multiple, ±σe2 ,
but this nonetheless identifies the ratio γu /δu . Identifying this ratio is useful be-
cause we learn the relative significance of own versus contextual effects. Identi-
fication up to a sign is also interesting because we may have a priori information
that signs one of the terms. For instance, in studies of earnings in workplace
networks, ability has both an own effect and a contextual effect. While the sign
of the own effect may be obvious, the sign of the contextual effect will depend
upon whether workers and worker tasks are substitutes or complements in the
production process.

   It is possible to give conditions on edges in the network that imply the ui -
independence condition, just as was done for the ε i -independence condition in
section 4. We also conjecture that one can go further in identifying the magni-
tudes of γu and δu . Let T denote the transpose of a matrix. Since φ/(1 + φ) and
σε2 are identified, the econometrician can observe
                                                               −1
     (1 + φ)2 Bu u · ( Bu u)T = σu2 I − φ(1 + φ)−1 A                 (γu I + δu C )
                                                                                       −1
                                               · (γu I + δu C T ) I − φ(1 + φ)−1 AT          .
The difficulty in pinning down magnitudes of γu and δu is the presence of σu2 .
Suppose, however, that the components of the contextual-effects network C are
unions of components of the peer-effects network A. This is the setting of sec-
tion 4.2. Suppose C has H such components. Index all symbols by h, the com-
ponent to which they apply, and let ñh denote the row vector with all terms 1/nh
and of length nh , the size of component h. Then following Graham (2008), ratios
of the form                              .
                  ñh Buh uh · ( Buh uh )T (ñth )T e1 Bu1 u1 · ( Bu1 u1 )T (e1t )T
                                                                                                 35


are independent of the variance of ω . This is essentially a variance contrast
method. One can show with a transversality argument like that in the proof of
theorem 4, that if C has at least 4 components, then for any A and generic C,
±(δu , σu ) will be identified. The sign ambiguity remains because both the numer-
ator and denominator are linear combinations of products of degree 2.

   Of course, unobserved public variables are not the only source of correlated
shocks across individuals. Bramoullé, Djebbari, and Fortin (2009) consider the
problem of group shocks, a common shock that effects i and everyone connected
to her. They provide an identification criterion like our theorem 3 when A = C
involving independence of matrix products up to third order, which comes from a
procedure in which each individual i’s behavior is differenced from the average be-
havior of her neighbors. Bramoullé, Djebbari, and Fortin’s insight that de-meaning
individual choices using group level averages can eliminate group-specific fixed
effects, is complementary to other forms of differencing. As a whole, appropriate
choice of differencing can eliminate the role of group effects, which is why their
presence has not been a focus of this paper.22


                                       7. C ONCLUSION

    In this paper, we have provided a theoretical and econometric characterization
of linear social interactions models. Our analysis provides both a clear descrip-
tion of the behavioral assumptions needed to employ these models as well as
the conditions under which the primitive utility parameters that characterize social
influences may be recovered. Our results demonstrate the possibilities and limits
to identification as determined by the degree of prior information on the socioma-
trices that determine how the characteristics and behaviors of others affect each
individual’s utility. We show that for the most common case in the empirical liter-
ature, namely when these matrices are known a priori identification holds gener-
ically. The absence of any a priori knowledge on these matrices unsurprisingly
means that identification fails. The known sociomatrices results demonstrates that
variants of the workhorse linear-in-means model for which identification fails are
in fact knife edge cases.

   We further explore a range of possible forms of a priori knowledge that repre-
sent intermediate cases compared to these two extreme information assumptions.
These intermediate cases correspond to plausible source of a priori information
as derived from economic theory and/or empirical social structure measurement.
We also address the identification question when a researcher is limited to aggre-
gated data of various types. Finally, we demonstrate that endogenous network
formation does not constitute an unbridgeable impediment to identification.
   22
      Kwok (2012) explores the effects of alternate differencing schemes on identification. He shows
that different schemes can affect the information in the de-meaned data. Hence the choice of de-
meaning procedure matters.
36


   In terms of future research, we see a number of important directions. First, our
findings may be understood as fleshing out parts of the “assumptions/possibilities"
frontier in terms of the edges between different types of a priori information on
social structure and identification. There is no reason to believe that the cases we
have examined span the possible types of information that may be available to a
researcher, so there is certainly more work to be done in fully characterizing the
environments in which identification does or does not hold.

    Second, the operationalization of the control function approach to addressing
network endogeneity needs to be developed. Third, we have not addressed is-
sues of estimation. This suggests a necessary complementary paper to this one
if one wishes to make our results operational. For example, the positive identi-
fication results we provide on endogenous social structure formation need to be
supplemented with procedures for constructing the analog to control functions
whose existence are implicit in the identification theorem.

   Fourth, while we have addressed the question of how our identification results
are affected by endogenous social structure, we have not addressed how this
endogeneity can, when explicitly modeled, facilitate identification. For example, if
group memberships are associated with prices, then prices can help to uncover
social effects, as demonstrated in recent advances in the econometrics of hedonic
models. (See Ekeland, Heckman, and Nesheim (2004)). As discussed above,
the control functions associated with the changes in conditional error distributions
conditional on group membership may be able to facilitate identification.

   Finally, information on social interactions may be encoded in the composition
of the groups themselves. Becker’s (1957) model of taste-based discrimination
implies that information on the presence of discriminatory preferences is embod-
ied both in any black/white wage gap and in the degree of segregation of workers
across firms. All these directions emphasize the importance of extending the the-
oretical and econometric arguments developed here in directions that fully exploit
the codetermination of social structure and associated behavioral outcomes.
                                                                                 37


                                  R EFERENCES

Badev, A. 2013. “Discrete Games with Endogenous Networks: Theory and Policy.”
   Working Paper. University of Pennsylvania.
Bassani, C. 2008. “Parent Classroom Involvement and the Development of Social
   Capital: A Reading Program in East Vancouver.” Journal of Educational Enquiry
   8 (2):51–70.
Bayer, P., S. Ross, and G. Topa. 2008. “Place of Work and Place of Residence:
   Informal Hiring Networks and Labor Market Outcomes.” Journal of Political
   Economy 116 (6):1150–1196.
Becker, G. 1974. “A Theory of Social Interactions.” Journal of Political Economy
   82 (6):1063–1093.
Benhabib, J., A. Bisin, and M. Jackson. 2011a. Handbook of Social Interaction,
   vol. 1. Amsterdam: North Holland.
———. 2011b. Handbook of Social Interaction, vol. 2. Amsterdam: North Holland.
Bifulco, R., J. Fletcher, and S. Ross. 2011. “The Effect of Classmate Character-
   istics on Post-secondary Outcomes: Evidence from the Add Health.” American
   Economic Journal: Economic Policy 3 (1):25–53.
Blume, L., W. Brock, S. Durlauf, and Y. Ioannides. 2011. “Identification of Social
   Interactions.” In Handbook of Social Economics, vol. 1B, edited by J. Benhabib,
   A. Bisin, and M. Jackson. Amsterdam: North Holland, 853–964.
Bochnak, J., M. Coste, and M-F. Roy. 1987. Geometrie Algebrique Reele. Berlin:
   Springer-Verlag.
Bramoullé, Y., H. Djebbari, and B. Fortin. 2009. “Identification of Peer Effects
   Through Social Networks.” Journal of Econometrics 150:41–55.
Brock, W. and S. Durlauf. 2001. “Interaction-Based Models.” In Handbook of
   econometrics, vol. 5, edited by J. Heckman and E. Leamer. Amsterdam: North-
   Holland, 3297–3380.
———. 2006. “Multinomial Choice with Social Interactions.” In The Economy as
   an Evolving Complex System, Vol. 3, edited by S. Durlauf and L. Blume. New
   York: Oxford University Press, 175–206.
Calabrese, S., D. Epple, T. Romer, and H. Sieg. 2006. “Local Public Good
   Provision: Voting, Peer Effects, and Mobility.” Journal of Public Economics
   90 (6):959–981.
Calvó-Amrengol, A. and R. Ilkiliç. 2009. “Pairwise-Stability and Nash Equilibria in
   Network Formation.” International Journal of Game Theory 38:51–79.
Calvó-Armengol, A., E. Patacchini, and Y. Zenou. 2009. “Peer Effects and Social
   Networks in Education.” Review of Economic Studies 76:1239–1267.
Cipollone, P. and A. Rosolia. 2007. “Social Interactions in High School: Lessons
   from an Earthquake.” The American Economic Review 97 (3):948–965.
Conley, T. and C. Udry. 2010. “Learning About a New Technology: Pineapple in
   Ghana.” American Economic Review 100 (1):35–69.
Corcoran, M., R. Gordon, D. Laren, and G. Solon. 1992. “The Association be-
   tween Men’s Economic Status and their Family and Community Origins.” Jour-
   nal of Human Resources 27 (4):575–601.
38


Cunha, F. and J. Heckman. 2007. “The Technology of Skill Formation.” The Amer-
   ican Economic Review 97 (2):31–47.
Cunha, F., J. Heckman, and S. Schennach. 2010. “Estimating the Technology of
   Cognitive and Noncognitive Skill Formation.” Econometrica 78 (3):883–931.
Datcher, L. 1982. “Effects of Community and Family Background on Achievement.”
   Review of Economics and Statistics 64:32–41.
Davezies, L., X. d’Haultfoeuille, and D. Fougère. 2009. “Identification of Peer
   Effects Using Group Size Variation.” The Econometrics Journal 12 (3):397–
   413.
De Giorgi, G., M. Pellizari, and S. Redaelli. 2010. “Identification of Social Interac-
   tions through Partially Overlapping Peer Groups.” American Economic Journal:
   Applied Economics 2:241–275.
Dhillon, A. and J.-F. Mertens. 1996. “Perfect Correlated Equilibria.” Journal of
   Economic Theory 68:279–302.
Drton, M., R. Foygel, and S. Sullivant. 2011. “Global Identifiability of Linear Struc-
   tural Equation Models.” Annals of Statistics 39 (2):865–86.
Ekeland, I., J. Heckman, and L. Nesheim. 2004. “Identification and Estimation of
   Hedonic Models.” Journal of Political Economy 112 (1-2).
Epple, D. and R. Romano. 1998. “Competition Between Private and Public
   Schools, Vouchers, and Peer-Group Effects.” The American Economic Review
   88 (1):33–62.
———. 2011. “Peer effects in education: A survey of the theory and evidence.”
   In Handbook of Social Economics, vol. 1a, edited by J. Benhabib, A. Bisin, and
   M. Jackson, chap. 11. Amsterdam: North Holland, 1053–1163.
Fisher, F. 1966. The Identification Problem in Econometrics. New York: McGraw-
   Hill.
Gale, D. and L. Shapley. 1962. “College Admissions and the Stability of Marriage.”
   American Mathematical Monthly 69:9–15.
Glaeser, E., B. Sacerdote, and J. Scheinkman. 1996. “Crime and Social Interac-
   tions.” Quarterly Journal of Economics 111:507–48.
———. 2003. “The Social Multiplier.” Journal of the European Economic Associ-
   ation 1:345–53.
Graham, B. 2008. “Identifying Social Interactions Through Conditional Variance
   Restrictions.” Econometrica 76 (3):643–60.
Granovetter, M. S. 1973. “The Strength of Weak Ties.” American Journal of
   Sociology 78 (6):1360–80.
Heckman, J. 1979. “Sample Selection Bias as a Specification Error.” Economet-
   rica 47:153–161.
Heckman, J. and R. Robb. 1986. “Alternative Methods for Solving the Problem
   of Selection Bias in Evaluating the Impact of Treatments on Outcomes.” In
   Drawing inferences from self-selected samples, edited by H. Wainer. New York:
   Springer-Verlag, 63–113.
Henderson, Vernon, Peter Mieszkowski, and Yvon Sauvageau. 1978. “Peer Group
   Effects and Educational Production Functions.” Journal of Public Economics
   10 (1):97–106.
                                                                                 39


Hsiao, C. 1983. “Identification.” Handbook of econometrics 1:223–283.
Hsieh, C.-S. and L.-F. Lee. 2012. “A Structural Modeling Approach for Network
   Formation and Social Interactions with Applications to Students’ Friendship
   Choices and Selectivity on Unobservables.” Working Paper. Ohio State Uni-
   versity.
Jackson, M. and A. Wolinsky. 1996. “A Strategic Model of Social and Economic
   Networks.” Journal of Economic Theory 71 (1):44–74.
Koopmans, T. 1953. “Identification Problems in Economic Model Construction.”
   In Studies in Econometric Method, edited by William C. Hood and Tjalling C.
   Koopmans. New York: Wiley and Sons, 27–48.
Kwok, H. 2012. “Identification Problems of Linear Social Interaction Models: A
   General Analysis Based on Matrix Spectral Decompositions.” Mimeo.
Lee, L.-F. 2007. “Identification and Estimation of Econometric Models with Group
   Interactions, Contextual Factors and Fixed Effects.” Journal of Econometrics
   140:333–74.
Lee, L.-F., X. Liu, and X. Lin. 2010. “Specification and Estimation of Social In-
   teraction Models with Network Structure, Contextual Factors, Correlation and
   Fixed Effects.” Econometrics Journal 13 (2):145–176.
Lin, N. 2002. Social Capital: A Theory of Social Structure and Action, vol. 19.
   Cambridge University Press.
Manski, C. 1993. “Identification of Endogenous Social Effects: The Reflection
   Problem.” Review of Economic Studies 60:531–42.
Manski, C. and J. Mayshar. 2003. “Private Incentives and Social Interactions:
   Fertility Puzzles in Israel.” Journal of the European Economic Association
   1 (1):181–211.
McManus, D. 1992. “How Common is Identification in Parametric Models?” Jour-
   nal of Econometrics 53 (1):5–23.
Moffitt, R. 2001. “Policy Interventions, Low-Level Equilibria, and Social Interac-
   tions.” In Social dynamics, edited by Steven N. Durlauf and H. Peyton Young.
   Cambridge MA: MIT Press, 45–82.
Montgomery, J. 1994. “Weak Ties, Employment, and Inequality: An Equilibrium
   Analysis.” American Journal of Sociology 99:1212–36.
Myerson, R. 1991. Game Theory: Analysis of Conflict. Cambridge MA: Harvard
   University Press.
Nakajima, R. 2007. “Measuring Peer Effects on Youth Smoking Behaviour.” Re-
   view of Economic Studies 74 (3):897–935.
Patacchini, E., E. Rainone, and Y. Zenou. 2012. “Student Networks and Long-Run
   Educational Outcomes: The Strength of Strong Ties.” CEPR Discussion Paper
   No. DP9149.
Rege, M., K. Telle, and M. Votruba. 2012. “Social Interaction Effects in Disability
   Pension Participation: Evidence from Plant Downsizing.” The Scandinavian
   Journal of Economics 114:1208–1289.
Sacerdote, B. 2001. “Peer Effects with Random Assignment: Results for Dart-
   mouth Roommates.” Quarterly Journal of Economics 116:681–704.
40


———. 2011. “Peer Effects in Education: How Might They Work, How Big are
   They and How Much Do We Know Thus Far?” Handbook of the Economics of
   Education 3:249–277.
Sharkey, P. and F. Elwert. 2011. “The Legacy of Disadvantage: Multigenerational
   Neighborhood Effects on Cognitive Ability.” AJS; American journal of sociology
   116 (6):1934–1981.
Sheng, S. 2012. “Identification and Estimation of Network Formation Games.”
   Working Paper. University of Southern California.
Sirakaya, S. 2006. “Recidivism and Social Interactions.” Journal of the American
   Statistical Association 101 (475):863–877.
Sui-Chu, E. and J. Willms. 1996. “Effects of Parental Involvement on Eighth-Grade
   Achievement.” Sociology of education :126–141.
Topa, G. 2001. “Social Interactions, Local Spillovers and Unemployment.” The
   Review of Economic Studies 68 (2):261.
                                                                                               41


                                             A PPENDIX

In fact we prove a more general theorem. Suppose that each individual i has his
or her own φi . Define the matrices
                   1
                                                             
                                if i = j,                     φi             if i = j,
          Φij = 1 + φi                                  Φ̂ij = 1 + φi
                 0               otherwise;                     0              otherwise.
                                                             

Assumption T.1 is modified appropriately:

 T. 10 . For all i, φi ≥ 0. A and C are non-negative, for each i ∈ V , ∑ j aij is
         either 0 or 1, and similarly for C. For all i ∈ V , aii = 0.
Theorem A1. If the Bayesian game satisfies axioms T.10 and T.2, then the game
has a unique Bayes-Nash equilibrium. The equilibrium strategy profile is
                                                  −1
                  f ( x, z) = Φ I − Φ̂A                 (γI + δC ) x + g( x, z),
where g( x, z) satisfies, for each i, the relation
                                 1           φi
                                                         ∑ aij E
                                                                                        
              gi ( x, zi ) =          zi +                         g j ( x, z j )| x, zi .
                               1 + φi      1 + φi         j

If z is independent of x, then each g( x, zi ) depends only on zi . If the elements of
z are pairwise independent, then gi ( x, zi ) = (1 + φi )−1 zi + µi ( x ).

   This theorem breaks the strategy profile into two pieces. The first measures
direct and contextual effects of the public type x, and the feedback through their
peer effects. The second term measures the effects of each individual’s private
type and is estimate of the private types of others.

Proof of Theorem A1. Suppose that in the payoff function (1) the parameter φ is
indexed by i. Give F the L2ρ max norm; || f || = maxi || f i ||2 . Let
                       ψi = γxi + δ ∑ cij x j + zi ,
                                             j

so that
                                   1     φi
                       ui = ψi ωi − ωi2 − (ωi − ∑ aij ω j )2                                 (23)
                                   2     2      j

Since the strategies are in L2ρ , the expected payoff to any i of any strategy profile
f is finite, so preferences over strategies for the Bayesian game are well-defined.

  The first-order conditions for expected utility maximization are that for each i,
and given the strategy profile f −i of the other individuals and type t ∈ T ,
                ψi + φi ∑ aij E f j (ψj , z j )| x, zi − (1 + φi )ωi = 0.
                                                      
                                                                                             (24)
                           j
42


Since the problem is concave in ωi , the first-order conditions are sufficient.

     Define the operator T : F → F such that
                                      1           φi
                                                                ∑ aij E
                                                                                                
            ( T f )i (ψi , zi ) =          ψi +                           f j (ψj , z j )| x, zi .
                                    1 + φi      1 + φi           j

A fixed point of T satisfies the first-order condition for all i, ψi and zi ; thus it will
be a Bayes-Nash equilibrium profile. Assumption T.1 and a computation shows
that this map is a contraction in the norm topology with contraction constant φ =
maxi φi /(1 + φi ), and so a fixed point exists, and is unique. The fixed-point
strategy profile satisfies the sufficient first-order optimality conditions, and so it is
a Bayes-Nash equilibrium.

     Any strategy profile can be written in the form
                                                 −1
                     f ( x, z) = Φ I − Φ̂A             (γI + δC ) x + g( x, z).
where gi ( x, z) depends on z through zi alone. Apply the operator T to see that f
will be an equilibrium if and only if g( x, z) satisfies, for each i,
                                 1           φi
                                                       ∑ aij E
                                                                                           
                gi ( x, z) =          zi +                            g j ( x, z j )| x, zi .        (25)
                               1 + φi      1 + φi           j

Thus each gi depends upon z only through zi . From now on we take the argu-
ments of each gi to be x and zi . Take

                                           ∑ aij E
                                                                            
                             µ( x, z)i =               g j ( x, z j )| x, zi .
                                            j

This proves the general characterization of equilibrium strategy profiles.

     For the characterizations of the gi ( x, zi ), define the operator Tg such that

                                 1           φi
                                                       ∑ aij E
                                                                                          
                 ( Tg h)i =           zi +                           h j ( x, z j )| x, zi .
                               1 + φi      1 + φi       j

This operator too is a contraction on L2ρ , and so it has a unique fixed point, which
is clearly g. The characterizations are proven by showing that the different as-
sumptions imply that sets of g with given properties are invariant under T , and so
the fixed point must be in this set.

   To prove the second claim, suppose now that x and z are independent. Then
for any function h j : z j 7→ R,
                                                                   
                               E h j (z j )| x, zi = E h j (z j )|zi .

Consequently, the set of functions h : (z) 7→ RN is invariant under Tg . Thus each
gi depends only on zi .
                                                                                                     43


   For the third claim, observe that if the private types are independent, then if
hi ( x, zi ) is of the form (1 + φi )−1 zi + µi ( x ), then
                                                                                         
                             1             φ                 1
                                       1 + φi ∑
                                                                            
        Tg (h)i ( x, z) =         zi +              a ij          E z j | x   + µ j ( x )   ,
                           1 + φi                j
                                                           1 + φj
                                 
since E z j | x, zi = E z j | x . The sum over j is a function only of x, and so the
set of all functions of this form is invariant under Tg . Thus the fixed point has this
property too. This proves theorem A1.

  To complete the proof of theorem 1, observe that if for all i and j, φi = φj ,
and if the zi are independent of each other and of x, the fixed point of Tg can be
computed directly, and gives equation (2a).                                     

   The remainder term µ( x, z) has to do with higher-order beliefs. Suppose, to
simplify the exposition, that all the φi are identical. Equation (25) contains a re-
cursion, and by iterating it, one sees that

                    1       φ
                           1+φ ∑
  µi ( x, zi ) =                    aii0 E (zi0 | x, zi )
                   1+φ          i0
                                  2                                                            !
                              φ
                             1+φ ∑          ∑ aii0 ai0 i00 E (E (zi00 |x, zi0 ) |x, zi ) + · · ·
                         +
                                         i0 i00
The second term contains expressions whose meanings are, “i ’s expectation of
j ’s expectation of zk . . . ".

   Now we take up identification questions. We have assumed for convenience
(E.5) that γ and δ are not both 0. Lemma 1 settles the question of identification
when the true γ and δ are both 0.
Lemma 1. Assume T.1–3 and E.1–5. The set of parameters {(γ, δ, φ) : γ =
δ = 0, φ ≥ 0} is weakly identified from the conditional mean of ω . No parameter
vector (0, 0, φ) is identified.

Proof of lemma 1. Let γ∗ , δ∗ and φ∗ denote the true values of the un-starred
parameters. If γ∗ = δ∗ = 0, then B(s) = 0. If B(s) = 0, then since Bφ (s) is
non-singular, γ∗ I + δ∗ C = 0. The sociomatrix C has some positive off-diagonal
element (E.3), so the unique solution to the equation γI + δC = 0 is γ = γ∗ and
δ = δ∗ .

   If γ∗ = δ∗ = 0, then B(s) = 0, and φ affects ω only through its effect on ε.
Since E (ε| x ) = 0, E (ω | x ) is independent of the parameter φ.          

Proof of Theorem 2. Identification of µ follows from E.1 and equation (5). E (ω | x )
is an affine function whose behavior on an open set is observed. Of course
E (ω | x ) is identified; this, the spanning assumption E.1 and the orthogonality
44


assumption E.4 identify B(s). Since C is stochastic, B(s)e = (γ + δ) Bφ (s)e =
( γ + δ ) e.

   If E (ω | x ) is independent of x, then B(s) = 0. Since Bφ (s) is always non-
singular, γI + δC = 0. E.3 implies that C is not a multiple of I , so γ = δ = 0.
Conversely, if γ = δ = 0, then B(s) = 0 and ω is independent of x.

   If for all i, E (ωi | x ) = E (ωi | xi ), then B(s) = αI , and α is identified. It follows
that                                   
                               α                  αφ
                        γ−              I + δC +         A = 0.
                              1+φ              (1 + φ )2
If the a priori hypothesis is satisfied, T.1 implies that I , C and A are linearly
independent, and it follows that δ = φ = 0 and γ = α. The converse is obvious.
                                                                                

Proof of Theorem 3. Part i: Suppose that s0 and s00 are two structures in M that
are identical except perhaps for the values they assign to the parameters γ, δ
and φ. Then B(s0 ) = B(s00 ) if and only if
                     Bφ (s0 )(γ0 I + δ0 C ) = Bφ (s00 )(γ00 I + δ00 C ).                (26)

Multiply this out:

        (1 + φ00 ) I − φ00 A (γ0 I + δ0 C ) = (1 + φ0 ) I − φ0 A (γ00 I + δ00 C ),
                                                               

since Bφ (s0 ), Bφ (s00 ), and their inverses, all being power series in A, all commute.
Consequently, B(s0 ) = B(s00 ) if and only if

     (1 + φ00 )γ0 − (1 + φ0 )γ00 I + (1 + φ00 )δ0 − (1 + φ0 )δ00 C
                                                               

                                 + (φ0 γ00 − φ00 γ0 ) A + (φ0 δ00 − φ00 δ0 ) AC = 0 (27)
Independence of I , A, C and AC implies that each coefficient is 0. Now enu-
merate cases. First, suppose that one of φ0 and φ00 is 0. Wlog assume φ0 = 0.
Looking at the coefficients of A and AC, independence implies that either φ00 = 0
or γ0 = δ0 = 0. The second possibility has been dispensed with in lemma 1, so
conclude that φ00 = 0. It follows immediately from the independence hypothesis
that γ0 = γ00 and δ0 = δ00 .

   Next suppose that neither φ0 nor φ00 is 0. If either γ0 or γ00 = 0, then the other
must be 0 for the coefficient of A to equal 0. Similarly, if either δ0 or δ00 = 0, then
the other must be 0 for the coefficient of AC to equal 0. Suppose that γ0 6= 0.
Then from the coefficients for I and A deduce that (1 + φ00 )/(1 + φ0 ) = φ00 /φ0 ,
and so φ0 = φ00 . Conclude from the coefficient of I that γ0 = γ00 . A similar
argument applies to the coefficient of C if δ0 6= 0.

   To establish the other direction, suppose that αI + βC + θ A + τAC = 0 for
α, β, θ, τ not all 0. The parameters of the structures s0 and s00 will satisfy equation
                                                                                         45


(27) if and only if they satisfy the following matrix equation:
              1 + φ00 −1 − φ0
                                             0  
                                 0     0         γ         α
             −φ00      φ 0      0              00
                                       0  γ   θ    
                                                       =     .
                              1 + φ −1 − φ 0   δ 0   β 
                                    00
            
             0          0
                 0       0     −φ00    φ0        δ00       τ
The determinant of the matrix is (φ0 − φ00 )2 . Choose any φ0 6= φ00 , both non-
negative. Then there will be parameters γ0 , γ00 , δ0 and δ00 which solve the equa-
tion. Consequently, for these parameter values B(s0 ) = B(s00 ), and the two pa-
rameter vectors cannot be distinguished.

    To complete the proof we must show that even when φ cannot be identified,
if either one of γ and δ is identified, so is the other. A necessary and sufficient
condition for γ0 = γ00 is that θ = −α. Thus α( I − A) + ( βI + τA)C = 0.
For each peer- effects component b (a component is a maximal connected sub-
network), denote by πb the left Perron eigenvector of Ab and let Cb denote the
|b| × N submatrix of C consisting of the rows of b and all columns. Then ( β +
τ )πb Cb = 0 for all components b. Each πb is strictly positive, and some Cb does
not equal 0, so conclude that β = −τ . This implies from the equation system that
δ0 = δ00 . Conversely, if δ0 = δ00 , then β = −τ , and so (α + θ )πb = 0. hence
θ = − α.

Part ii. B(s0 ) = B(s00 ) if and only if
     (1 + φ00 )γ0 − (1 + φ0 )γ00 I + (δ0 − δ00 C + (φ0 γ00 − φ00 γ0 ) A = 0 .
                                             
                                                                                       (28)
Suppose that I , A and C are linearly independent. Then each coefficient in equa-
tion (28) is 0. In particular, the coefficient on C is 0, and so δ0 = δ00 ; δ is identified.

   The remaining coefficients are 0 if and only if
                                   φ0 γ00 = φ00 γ0 , and
                               (1 + φ0 )γ00 = (1 + φ00 )γ0 .
We need to show that γ0 = γ00 and φ0 = φ00 . Observe first that, from the second
equation, γ00 = 0 if and only if γ0 = 0. Next observe that if γ0 6= 0, φ0 /(1 + φ0 ) =
φ00 /(1 + φ00 ). Thus φ0 = φ00 , and it follows that γ0 = γ00 .

   For the converse, observe that if αI + βC + θ A = 0 and any coefficient is not
0, then β 6= 0 because no single coefficient can be non-zero, and if β = 0 then
A would be a multiple of I , contradicting T.1. It follows from equation (28) that δ
cannot be identified. Choose φ0 6= φ00 , and consider the equation
                           1 + φ00 −(1 + φ0 )        γ0
                                                                
                                                                    a
                                                               =       .
                            −φ00      φ0             γ00            c
This equation says that the coefficient of I is equation (28) equals α and the
coefficient of A in equation (28) equals θ . The matrix is non-singular, and so
there will be γ0 and γ00 which solve it. Consequently, φ is not identified. Finally, We
46


show by contradiction that γ is not identified. if γ is identified, then the equation
system is solved, for all φ0 6= φ00 , by some γ0 = γ00 . For this to be true, for
all φ0 6= φ00 , (φ00 − φ0 )γ0 = α and (φ0 − φ00 )γ0 = θ , so θ = −α. If so, then
α( I − A) + βC = 0. If the coefficient α equals 0, then β equals 0 as well, which
is a contradiction, so α must not equal 0. But α must equal 0, because the matrix
α( I − A) has both positive and negative elements (by T.1, the diagonal and off-
diagonal elements have different signs), while the non-zero elements of βC all
have the same sign. This establishes the contradiction.                            

Proof of Corollary 1. The result follows directly from lemma 2.                     
Lemma 2. Suppose that A is a peer-effects matrix with N ≥ 3. Suppose C is a
contextual-effects sociomatrix such that for some peer-effects component b with
subgraph sociomatrix Cbb :

      (1) The invariant distribution πb of Ab is not an eigenvector of Cbb .
      (2) Cbb has no eigenspace of dimension at least |b| − 1, and
      (3) rank Cbb ≥ 2.

Then the utility parameters are identified.

Proof of Lemma 2. It suffices to show that, generically, I , A, C and AC are in-
dependent. If so, then C 6= AC, and the criterion of the first case of theorem 3
applies. So suppose that αI + βA + θC + τAC = 0. Post-multiply the sum by
the vector of 1s, to conclude that α + β + θ + τ = 0.

     Next, observe that for each pair of component b of the peer-effects network,
                          αI + βAb + θCbb + τAb Cbb = 0,
Let πb be a left Perron eigenvector for Ab . Then (α + β)πb + (θ + τ )πb Cbb = 0.
By hypothesis, neither vector in the sum is 0, and πb and πb Cbb are linearly
independent, so α + β = θ + τ = 0.

     Rewriting the linear combination of matrices, for all components b,
                              α( I − Ab )( I + θCbb ) = 0.
Suppose that α 6= 0. The null space of I − Ab is spanned by e, so the range of
I + θCbb is the vector space spanned by e. Consequently, θ 6= 0. If rank I +
θCbb = 0, then Cbb = −θ −1 I , which contradicts the hypothesis.

   If rank I + θCbb is 1, then the null space of I + θC has rank equal to |b| − 1,
where |b| is the number of nodes in the component. Hence −θ −1 is an eigen-
value of Cbb , of geometric multiplicity |b| − 1. This too contradicts the hypothesis.
Conclude that α = 0.

   If α = 0 , then θ ( I − Ab )Cbb = 0. Again from the Perron-Frobenius Theorem,
this can only hold if rank Cbb = 1, which our hypothesis rules out.           
                                                                                    47


Lemma 3.         i. For all peer-effects sociomatrices A containing a component
       b of size nb ≥ 3, the set of contextual-effects sociomatrices C for which I ,
       A, C and AC are not independent is a closed-semi-algebraic set of lower
       dimension in MC .
   ii. If N ≥ 3 there is a closed semi-algebraic set Gc ⊂ MC which is the
       complement of a lower-dimensional in MC such that for each C in GC
       the subset SC of M A containing those peer-effects sociomatrices A for
       which I , A, C and AC are not linearly independent is semi-algebraic,
       closed, and lower-dimensional in M A .


Proof of Lemma 3. The result follows immediately from lemma 2. Part i is the
corollary.                                                                

Proof of Corollary 2. Consider the equation system
                           wI + xA + yC + zAC = 0.                               (29)
We will show that linear independence of all four matrices is the right condition
to check, and then that the only solution to equation (29) is w = x = y = z =
0. The result then follows from theorem 3. Let q0 , . . . , qn be nodes such that i)
q0 = j and qn = i; ii) each qv is linked to qv−1 and qv+1 (whenever they exist),
by an edge in the peer-effects network and/or an edge in the contextual-effects
network; and iii) this path is shortest possible among all such paths connecting
a and z. Denote by ∼ A and ∼C peer- and contextual-effects edges. Thus we
have q0 ∼ X0 q1 ∼ X1 · · · ∼ Xn−1 qn , where each Xv is either a C or an A. For
any particular v it may be possible to take either C or A for Xv , but by hypothesis
there is at least one Xv which must be a C and another which must be an A.
Furthermore, minimality of the length implies that for all w 6= v, qw 6= qv , and that
there is no A or C edge between qv and qv+u for u ≥ 2.

    Without loss of generality (run the chain backwards if necessary) there exists a
triple qv ∼ A qw ∼C qu where u = w + 1 = v + 2. Then
            ACqv qu ≥ aqv qw cqw qu > 0 but Aqv qu = Cqv qu = Iqv qu = 0.
This shows two things: First, I , A and C are already known to be distinct by virtue
of axioms T.1, E.2 and E.3. This calculation shows AC to be distinct from these
matrices. Thus, part i) of theorem 3 applies. Second, from the calculation infer
that in any solution to equation (29), z = 0.

   Next, create a “C-maximal path” by choosing Xv equal to C wherever possible
in the chain. By hypothesis, some A-edge must remain. Again without loss of
generality choose a triple qv ∼ A qw ∼C qu where u = w + 1 = v + 2. Then
aqv qw > 0 while cqv qw = Iqv qw = 0. Since z = 0, this implies that x = 0 in any
solution to equation (29). Finally, create an “ A-maximal path” and use the same
argument to infer that y = 0. If x = y = z = 0, then w = 0 and we are done. 
48


Proof of Corollary 3. Let c denote a component of the contextual-effects network
satisfying the hypotheses. Then AC = C, which is case ii) of theorem 3. If I , A
and C are linearly dependent, there are coefficients α, β and θ not all 0 such that
αI + βA + θC = 0. The coefficient α is not 0 because A is not a scalar multiple
of C. The coefficient β is not 0 because C has off-diagonal positive elements, and
the coefficient θ is not 0 because A has diagonal elements all 0 (T.1). So C is a
linear combination of I and A. But since all off-diagonal elements of C are equal,
the hypothesis on A implies this cannot be the case.                             

   The proof of theorem 4 is long, tedious, and without merit beyond its existence.
It will be useful to rewrite the social interaction effects with the parameter r =
φ/(1 + φ), with r ∈ [0, 1).

  Define a(r ) T = (1 − r )e T ( I − rA)−1 , where e is a vector of suitable length
and T denotes transpose. The effect of r is isolated in the column-sum vector a.
We need these facts:
Lemma 4. (a) For every sociomatrix A which is not bistochastic, the map r 7→
a(r ) is an injection.

     (b) For all A and r ∈ [0, 1), a(r )  0.

     (c) ∑ x a x (r ) = N .


Proof. We use the relationship a T = (1 − r )e T + ra T A which is easily derived
from the definition of a.

     (a) If a(r 0 ) = a(r 00 ) = a for r 0 6= r 00 ), then
                               (r 00 − r 0 )eT + (r 0 − r 00 ) aT A = 0,
so a T A = e T and therefore a = e, and A is bistochastic.

   (b) Without loss of generality, suppose that A is irreducible. (Otherwise con-
sider each component of the peer-effects network A separately.) (1 − r )e T ( I −
rA)−1 equals (1 − r )(e + reA + r2 eA2 + · · · ). This is the sum of nonnegative
vectors, and some eA T is strictly positive.

     (c) The row sums of A are 1.                                                    

    Another technical lemma we need is this: Fix N , and let S denote the set of all
triples (α, r, C ) which solve the equation system
                 α( ai (r ) − a j (r )) − β   ∑ ax (r)(cxi − cxj ) = 0 for i 6= j,
                                              x ∈V
and let SC ⊂ MC denote its projection onto the set of all contextual-effects so-
ciomatrices.
                                                                                                                     49


Lemma 5. The set SC is closed and has dimension at most 2 + ( N − 1)2 , which
is less than dim MC for N ≥ 3.

   The set of stochastic matrices had dimension N ( N − 1), which exceeds 2 +
( N − 1)2 when N ≥ 3. The proof involves facts about semi-algebraic sets —
sets defined by finite numbers of polynomial inequalities, which can be found, for
instance, in Bochnak, Coste, and Roy (1987).

Proof of lemma 5. This system contains N − 1 equations. According to lemma 4,
a(r )  0, and so the derivative with respect to C of the left-hand side is surjective
onto RN−1 . Consequently the solution set is a semi-algebraic set of co-dimension
N − 1, which is to say, of dimension 2 + ( N − 1)2 . It is also compact. The
projection of S onto SC is compact and has dimension at most 2 + ( N − 1)2 since
semi-algebraic functions (projection, in this case) cannot increase the dimension
of their domains.                                                                   

Proof of Theorem 4. Since x̄ g is observed, σx2 is identified. It is convenient to
define, for the gth group,
                       1       g                                           gT
                          e · Bφ (γI + ( β − γ)C g )(γI + ( β − γ)C g T ) Bφ e T .
   f g (γ, φ, β, A g , C g ) =
                        g
                      n
Then ν = f (γ, φ, β, A , C g ) − f 0 (γ, φ, β, A0 , C0 ).
      g   g           g


   Define F = F1 , . . . , F g such that

   F g (γ0 , r 0 , γ00 , r 00 , β, A g , C g ) = f g (γ0 , r 0 , β, A g , C g ) − f g (γ0 , r 0 , β, A0 , C0 )−
                                                 f g (γ00 , r 00 , β, A g , C g ) + f g (γ00 , r 00 , β, A0 , C0 )
The domain of F is taken to be R4 /∆2 × R × MA × MC where A and C denote
the peer- and contextual-effects networks, respectively and the first set is that of
all quadruples (γ0 , r 0 , γ00 , r 00 ) such that not both γ0 = γ00 and r 0 = r 00 .

   Fix the A g , C g and s, and consider the equation
                       F (γ0 , r 0 , γ00 , r 00 , β, A0 , . . . , A g , C0 , . . . , C g ) = 0.
Since β is already identified, we need only to identify γ and r. The statistic
(ν1 , . . . , ν g ) does not distinguish γ0 , r 0 from γ00 , r 00 (given β) if and only if (γ0 , r 0 , γ00 , r 00 )
solves the equation, and (γ0 , r 0 ) 6= (γ00 , r 00 ). Thus we must show that for generic
C1 , . . . , C g ,
                  F (γ0 , r 0 , γ00 , r 00 , β, A0 , . . . , A g , C0 , . . . , C g ) = 0
has no solution in R4 /∆2 .

   We will show that if F g = 0, then DC g F g is surjective onto R. If so, it follows
that DFC1 ,...,C g is surjective onto Rg . Consequently, 0 is a regular value of F,
and we conclude from the transversality theorem that for almost all C1 , . . . , C g ,
0 is a regular value of the map F (·, β, A1 , . . . , A g , C1 , . . . , A g ) : R4 /∆2 → Rg .
50


Because F is semi-algebraic, the set of critical C1 , . . . , C g for which this may fail
is closed and lower-dimensional in MC  0 . When the map has 0 as a regular value,

the inverse image of 0 is a manifold of co-dimension G. For G ≥ 5, this implies
that the solution set in R4 /∆2 has negative dimension, that is, it is empty.

    It remains only to show that if F g = 0, then DC g F g is surjective onto R. Observe
first that
           DC g F g = DC g f g (γ0 , r 0 , β, A g , C g ) − DC g f g (γ00 , r 00 , β, A g , C g ).
The derivative DC g f g is a linear map from the tangent space of MC to R. That
tangent space is spanned by the set of all matrices Hkij whose vwth entry is 1 if
v = k and w = i, −1 if v = k and w = j, and 0 otherwise. In words, Hkij shifts a
little bit of j’s influence on k to i.

     A calculation shows that
                                                                                       
  DC g f g Hkij = ak (r )(s − γ) γ ai (r ) − a j (r ) + (s − γ) ∑ a x (r )(cix − c jx )
                                                     
                                                                                       x
                ≡ ak (r )$ij (γ, r )
where a = eBφ . Thus if DC g F g is not surjective at (γ0 , r 0 , γ00 , r 00 ), then

                             ak (r 0 )$ij (γ0 , r 0 ) = ak (r 00 )$ij (γ00 , r 00 ).                 (30)


    First we show that for generic C and all γ and r, there is a pair i 6= j such that
$ij (γ, r ) 6= 0. Suppose not. Since γ 6= s, for all i, j pairs
                   γ ai (r ) − a j (r ) = (γ − s) ∑ a x (r )(c xi − c xj ).
                                       
                                                                x

Fix j. Then for all i 6= j, the equation system

                                                         ∑ ax (r)(cxi − cxj )
                                               
                           α ai (r ) − a j (r ) =
                                                          x

has a solution. From lemma 5, the set of matrices SC for which this system has
a solution is a closed and lower-dimensional subset of MC0 . So for C ∈ Sc , the
                                                                         C
equation system has no solution, and hence some $ij 6= 0.

    Now suppose that DC g F g is not surjective at (γ0 , r 0 , γ00 , r 00 ), so that equation
(30) holds. Lemma 4 states that the sum over u of ak (r ) is N , independent
of r. Consequently, summing over u in equation (30), we see that for all i and j,
$ij (γ0 , r 0 ) = $ij (γ00 , r 00 ). Since for at least one i, j pair, $ij (γ0 , r 0 ) 6= 0, it follows
that for all u, a(r 0 ) = a(r 00 ). Conclude from lemma 4 that r 0 = r 00 . Thus DC g F g
can only fail to be surjective at points (γ0 , r 0 , γ00 , r 0 ).

     A calculation now shows that for all i 6= j,

       (s − γ0 − γ00 ) ai (r 0 ) − a j (r 0 ) = (2s − γ0 − γ00 ) ∑ a x (r 0 )(c xi − c xj ),
                                             
                                                                               x
                                                                                     51


and by hypothesis γ0 6= γ00 . If s 6= 0, then at least one of s − γ0 − γ00 and
2s − γ0 − γ00 must not be 0. That is, the equation system
                    α ai (r 0 ) − a j (r 0 ) = β ∑ a x (r 0 )(c xi − c xj )
                                            
                                                      x

has a solution (α, β, r 0 , C ) has a solution with not both α = β = 0. It cannot be
the case that β = 0, for if so, then α 6= 0, and ai (r 0 ) = a j (r 0 ) for all i and j.
But if this were the case, then a(r 0 ) = e and it follows that r 0 = 0 or that A is
bistochastic. We have ruled out both cases by assumption. Since β 6= 0, it follows
that if DC g F g is not surjective, then

                     α ai (r 0 ) − a j (r 0 ) =   ∑ ax (r0 )(cxi − cxj ),
                                             
                                                  x

and again from lemma 5, this can only happen for C g ∈ SC .                          


  If −γ∗ /δ∗ is not an eigenvalue of C, then B will be non-singular, and γ∗ , δ∗
and φ∗ solve the equation

                        (1 + φ) I − φA = γB−1 + δCB−1 .                            (31)

This fact is used in the proofs of theorems 5 and 6 below.


Proof of Theorem 5. Axiom E.2 and the hypothesis imply that both a ji and aij are
0, so we have two locations with 0’s in the peer-effects sociomatrix. Let γ∗ , δ∗
and φ∗ denote the true parameter values, and recall that B = B(s) is identified
(by theorem 2). Since it is nonsingular, they solve equation (31).

   Although we do not know the matrix A, we do know that both the ji and the ij
terms are 0. We also know that β∗ = δ∗ + γ∗ is identified (by theorem 2). Thus
the following two-by-two equation system in γ and δ has as one solution δ = δ∗
and γ = γ∗ .

                                ji + δ ∑ c jk Bki = 0
                              γB− 1            −1
                                             k
                                                   γ + δ = β∗ .
Simplifying,
                            ji + ( β − γ ) ∑ c jk Bki = 0.
                          γB− 1     ∗              −1
                                                                                   (32)
                                                      k

The system is degenerate if and only if B−  1             −1                   −1
                                          ji = ∑k c jk Bki = 0. When B ji 6 = 0,
equation (32) can be solved for γ∗ , and since β∗ , this gives δ∗ . Finally, identify φ
from the diagonal of equation (31) — the equation

                             1 + φ = γ∗ B− 1   ∗      −1
                                         jj + δ c jk Bkj

has φ∗ as its unique solution.                                                       
52


Proof of theorem 6. Let γ∗ , δ∗ and φ∗ denote the true utility parameter values.
Since A has 0’s on the diagonal, the right has side of equation (31) has identical
diagonal elements when γ = γ∗ and δ = δ∗ . Consider the equation system

                         γ( Bii−1 − B11
                                     −1
                                        ) + δ( B−1 Cii − B−1 C11 ) = 0,                        (33)

for i = 2, . . . , N , with unknowns γ and δ. The system has γ = γ∗ and δ = δ∗ as
a solution. The coefficients of this system are either observable or known a priori
. This system has rank at most 1. Obviously the rank cannot be more than 2. If it
is rank 2, the unique solution would be γ = δ = 0, contradicting the hypothesis.

   There are two possibilities, then: The system (33) has rank 0 or rank 1. If
the system has rank 0, then in particular γ = 1 and δ = 0 solve the system.
Hence all the diagonal elements of B−1 are identical. A derivative calculation
and a transversality argument shows that for the complement of a closed, lower-
dimensional subset of M A , however, the system has rank 1.

   If the system (33) has rank 1, then the solution set is either δ = 0 or γ = zδ
for some z 6= 0. In the first case, we have δ = δ∗ , and so this case can only arise
when δ∗ = 0 and γ∗ = β∗ . Since β∗ is identified, we can infer γ = γ∗ = β∗ . In
the second case, δ∗ and γ∗ solve

                                                    γ + δ = β∗
                                                  γ − zδ = 0.
Notice that β∗ cannot equal 0 by assumption — otherwise −γ∗ /δ∗ is an eigen-
value of C. If z = −1 this equation system is inconsistent, which cannot be the
case. If z 6= −1, then it has a unique solution, which must be γ = γ∗ and
δ = δ∗ .                                                                     


Proof of Corollary 4. Once φ, γ and δ are identified, A is recovered from equation
(31).                                                                           


Proof of theorem 7. First we show that the conditions of the theorem are sufficient
and necessary, respectively, for identifying the parameter vectors π1 , π2 and π3 .
Expand equation (19):

     ωi = π1 x i +   ∑ π2j x j
                     j ∼C i
                      j 6 =i
                                                                               
                                                                                      1
                                ∑            ∑ bkj x j + bki xi +    ∑ bkj x j 
                                                                               
                           +            π3k                                     + 1 + φ εi   (34)
                               k∼ A i           j ∼C i               j 6 ∼C i
                                                 j 6 =i

Reorder the elements of B, and partition it as follows:
                                      j ∼C i                j 6 ∼C i                                                     53
                                                                              
               i, j ∼ A i            b11      ... ...                    b1N                                !
                                                ..         ..                         B A C B A ¬C
       B=                                                                      =                     .
                                                                              
                                                 .          .
                                                                                      B¬ A C B¬ A ¬ C
                                 
                 j 6∼ A i            b N1 . . . . . . b NN
Then the first term on the second line of equation (34) is
                                           !                      !
               B A C B A ¬C                         x j ∼C i
    π3 0
                B¬ A C B¬ A ¬ C                      x j 6 ∼C i

                                                                          = π3 B A C x j ∼C i + π3 B A ¬C x j 6 ∼C i .
Identification of the parameters requires that the dimension of the set
                            
                                xi , ( x j ) j∼C i , ( x j ) j∼C i : x ∈ suppx ρ
                                           j 6 =i               j 6 =i
be at least as big as the number of parameters to be estimated, where suppx ρ
denotes the support of the marginal distribution of x. The necessary condition
follows from the fact that N is an upper bound on this dimension. The sufficient
condition comes from observing that the dimension of this set is 1 + #{ j : j ∼C
i, j 6= i } + dim rank B A ¬C . and the needed dimension is 1 + #{ j : j ∼C i, j 6=
i } + #{ j : j ∼ A i }.

    Next we show how to recover the parameters from the πi . ∑ j π3j = (φ/(1 +
φ) ∑ j aij . Since that sum is 1, φ is identified. With φ identified, each π3j identifies
aij . If any π2j = 0 then δ = 0 and γ is identified from β. Otherwise, π2k /π2j =
ciu /cij . Since φ is identified, the sum ∑ j π2j = δ(1 − cii ). This, π1 and β deliver
the one-dimensional curve described in the theorem. Finally, it is quick to check
that failure to identify any πij causes a consequent drop in information: Of ρ and
ai if a component of π3 is unidentified, cik /cij for some pair (k, j) if one of those
components of π2 are not identified, and the curve containing γ and δ is not
identified if a component of π2 or π1 is not identified.                               

Proof of Theorem 8. Let x̂ g denote the mean of the x j for j ∈ g, including individ-
ual i. Equations (20) become
                                 E(ω̄ | xi , x̄ g ) = µ g + bg x̂ g + bgi xi
                                                                                                                   (35)
                                E(ωi | xi , x̄ g ) = µi + b−i x̂ g + bii xi
The four coefficients are identified, and the problem is to determine the values
of the utility parameters from these four values without knowing A. Observe that
b−i + bii = γ + δ, a row-sum of B. Thus γ + δ is identified. Furthermore,
bg + bgi = ( N − 1)(γ + δ). Consequently there are only three independent
values among these four coefficients. For fixed C, let FC denote the map that
takes quadruples (γ, δ, φ, A) to triples (bii , b−i , bgi ) with the given C matrix. This
map is smooth, and so the implicit function theorem can be used to study solutions
of the equation
                                  FC (γ, δ, φ, A) = (bii , b−i , bgi ).
54


    It will be convenient to take i = 1 for the calculations, to reparametrize with r =
φ/(1 + φ), and to work with the map GV : (γ, δ, r, e) :7→ (b11 , ∑k bk1 , ∑i b1i ).
This function is a non-singular linear transformation of FC , and so we can identify
utility parameters from bii , bgi and b−i if and only if we can identify them from
these sums of elements of B as well.

   We will show that there is a particular direction H for a perturbation of peer-
effects matrices A such that for generic A and any φ > 0, the derivative of
the map (γ, δ, φ, e) 7→ GC (γ, δ, φ, A + eH ) has full-rank at (γ, δ, φ, 0) and the
partial derivative ∂e 6= 0. Choose now γ∗ , δ∗ and φ∗ , and an A for which the
preceding statement holds, and denote the corresponding statistics (s1 , s2 , s3 ) ≡
   ∗ ,      ∗ ,       ∗ ). The derivative map is surjective in a neighborhood J × I of
(b11   ∑k bk1    ∑i b1i
(γ∗ , δ∗ , φ∗ , 0) where I is an open interval around ε = 0 and J is an open rec-
tangle in R3 containing (γ∗, δ∗ , r ∗ ), and so the intersection of the inverse image
       ∗ ,       ∗ ,     ∗ ) with J × I is a manifold of dimension 1. In fact, we show
of (b11    ∑k bk1    ∑i b1i
that J × I , the partial derivative ∂γδe GC : R3 → R3 is surjective. This immedi-
ately implies that r is not identified. Suppose we parametrize the manifold     locally
in a neighborhood (γ∗ , δ∗ , φ∗ , 0) as ψ(λ) = γ(λ), δ(λ), r (λ), e(λ) where
ψ(0) = (γ∗ , δ∗ , φ∗ , 0). Suppose Dψ(0) = ( xγ , xδ , xr , xe ). Then Dψ(0) 6= 0,
and
                                                   
                  0 = ∂r GC ψ(0) · xr + ∂γδe GC ψ(0) · ( xγ , xδ , xe ).
To show that r is not identified, it suffices to show that xr 6= 0. Suppose xr = 0.
Since Dψ(0) 6= 0, xr = 0 requires that ( xγ , xδ , xe ) 6= 0. If so, then DGC ψ(0) ·
Dψ(0) 6= 0, which is a contradiction.

   Now we calculate. First observe that for generic A, there will exist i and j
such that b1i 6= b1j , and a1i , a1j > 0. Next, observe that D A B · H = −r (1 −
rA)−1 HB, where r = φ/(1 + φ). Observe, too, that s2 = γ + δ. To show that
DGC (γ∗ , δ∗ , φ∗ , A) is surjective, it suffices to show that ∂γδe GC (γ∗ , δ∗ , φ∗ , A +
eH )|e=0 has rank 3. Choose H to be the matrix Hkij where i and j are as above,
u 6= 1, hki = −hkj = 1, and all other elements of H are 0. Computing,

     ∂γδe GC (γ∗ , δ∗ , φ∗ , A + 0H ) =
              (1 − r ∗ )d1,1       (1 − r ∗ ) ∑u d1u cu1              −r ∗ (bi1 − b j1 )d1k
                                                                                                 

                      1                       1                                  0
                                                                                                 
                                                                                                 
             (1 − r ∗ ) ∑v dv1       (1 − r ∗ ) ∑v ∑u dvk cu1         −r ∗ (bi1 − b j1 ) ∑u duk
where dul is the ul th element of ( I − r ∗ A)−1 . Since bi1 − b j1 6= 0 and 0 < r ∗ <
1, this matrix is non-singular if and only if the following matrix is non-singular:
                              d1,1         ∑u d1u cu1           d1k
                                                                        

                           1 + φ∗           1 + φ∗              0
                                                                        
                                                                         
                              ∑v dv1      ∑v ∑u dvk cu1     ∑u duk
                                                                                             55


Notice that δ∗ and γ∗ have disappeared. For fixed r ∗ and C it is generic in A that
this matrix is non-singular.                                                     

Proof of Theorem 9. The following conditions are generic: I , A, C and AC are
independent, and I , A + A T , C + C T , AA T and CC T are independent. We
show that these independence conditions are sufficient for the conclusions of the
theorem.

     Identification of γ, δ and φ comes from theorem 3. The covariance matrix of ω
is
Ω = (1 − r )2 σε2 I + Bu u · ( Bu u)T
     = (1 − r )2 σε2 I + (1 − r )2 σu2 ( I − rA)−1 (γu I + δu C )(γu I + δu C T )( I − rAT )−1 ,
and so

Ω̂ ≡ (1 − r )−2 ( I − rA)Ω( I − rA T )
   = σe2 I − r ( A + AT ) + r2 AAT + σu2 (γu2 I + γu δu (C + C T ) + δu2 CC T )
                                   

     = (σe2 + σu2 γu2 ) I − σe2 r ( A + AT ) + σu2 γu δu (C + C T ) + σe2 r2 AAT + σu2 δu2 CC T .
Since r is identified and A is known a priori, Ω̂ is observable. Suppose now
                              0
that σe2 , γu and δu , and σe2 , γu0 and δu0 generate the same Ω̂. As in the proof of
                                                                               0
theorem 3, independence implies here that there is a z such that z = σu2 /σu2 > 0,
   2                                0                      2
δu0 = zδu2 , γu0 δu0 = zγu δu√, σe2 = σe2 , and finally, γ0 = zγ2 . This is enough to
establish that (γ0 , δ0 ) = ± z(γ, δ).                                             
