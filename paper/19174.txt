                              NBER WORKING PAPER SERIES




                         NETWORK SECURITY AND CONTAGION

                                       Daron Acemoglu
                                      Azarakhsh Malekian
                                       Asuman Ozdaglar

                                       Working Paper 19174
                               http://www.nber.org/papers/w19174


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     June 2013




We thank various numerous seminar and conference participants for useful suggestions. We gratefully
acknowledge financial support from the Toulouse Network with Information Technology and Army
Research Office. The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Daron Acemoglu, Azarakhsh Malekian, and Asuman Ozdaglar. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Network Security and Contagion
Daron Acemoglu, Azarakhsh Malekian, and Asuman Ozdaglar
NBER Working Paper No. 19174
June 2013
JEL No. D6,D62

                                             ABSTRACT

We develop a theoretical model of security investments in a network of interconnected agents. Network
connections introduce the possibility of cascading failures due to an exogenous or endogenous attack
depending on the profile of security investments by the agents. The general presumption in the literature,
based on intuitive arguments or analysis of symmetric networks, is that because security investments
create positive externalities on other agents, there will be underinvestment in security. We show that
this reasoning is incomplete because of a first-order economic force: security investments are also
strategic substitutes. In a general (non-symmetric) network, this implies that underinvestment by some
agents will encourage overinvestment by others. We demonstrate by means of examples that there
can be overinvestment by some agents and also that aggregate probabilities of infection can be lower
in equilibrium compared to the social optimum. We then provide sufficient conditions for underinvestment.
This requires both sufficiently convex cost functions (convexity alone is not enough) and networks
that are either symmetric or locally tree-like. We also characterize the impact of network structure
on equilibrium and optimal investments. Finally, we show that when the attack location is endogenized
(by assuming that the attacker chooses a probability distribution over the location of the attack in order
to maximize damage), there is an additional incentive for overinvestment: greater investment by an
agent shifts the attack to other parts of the network.


Daron Acemoglu                                      Asuman Ozdaglar
Department of Economics                             Department of Electrical Engineering
MIT, E52-380B                                       and Computer Science
50 Memorial Drive                                   Massachusetts Institute of Technology
Cambridge, MA 02142-1347                            77 Massachusetts Ave, E40-130
and CIFAR                                           Cambridge, MA 02139
and also NBER                                       asuman@mit.edu
daron@mit.edu

Azarakhsh Malekian
MIT Laboratory for Information and Decision System
77 Massachusetts Avenue, Room 32-D608
Cambridge, MA 02139
malekian@MIT.EDU
1   Introduction
Computer, communication, transport and economic networks all depend on some degree of se-
curity for their operation. For example, a virus that infects a set of connected computers or a
malfunction in a router, domain or switch may influence the functioning of the entire network and
in the worst case scenario, will spread from one part to the rest of the network. Almost all networks
are protected with security investments. For example, individual computers use virus scans and
refrain from visiting websites that appear suspicious. Domains use firewalls and other security
devices to prevent exposure to viruses and malware. Consequently, it has long been recognized,
in Anderson and Moore’s (2006, p. 610) words, that “security failure is caused at least as often by
bad incentives as by bad design”.
    An emerging literature at the boundary of economics and computer science investigates how
these incentives are determined and how they shape security investments and resilience of net-
works. A clear positive externality exists in security investments. An agent that fails to protect itself
adequately not only increases the probability of its own infection but also increases the likelihood
that infection will spread to other agents. Based on this intuition, the literature has so far presumed
that there will be underinvestment in security (e.g., Anderson and Moore, 2006, Bachrach, Draief
and Goyal, 2012, Goyal and Vigier, 2011, Larson , 2011). These intuitions, however, are based on
analyses of “symmetric networks”. In symmetric networks, there is either no network structure
and all agents (or individuals or nodes) interact with all others or, loosely speaking, all agents oc-
cupy the same position in the network as all others. Such symmetric networks are neither realistic
nor conducive to an understanding of the role of the structure of the network on equilibrium (and
optimal) security investments. The lack of realism is obvious: there is considerable heterogene-
ity across agents in all of the aforementioned networks; domains and routers differ in terms of
their size and importance, and computer users are typically connected to very different numbers
of users and occupy different positions in the overall network. The importance of analyzing the
impact of network structure is also equally salient and has long been recognized as central for the
study of network security as the following quote, again from Anderson and Moore (2006, p. 613),
illustrates: “Network topology can strongly influence conflict dynamics... Different topologies
have different robustness properties with respect to various attacks.”
    The next example shows that the presumed underinvestment in network security need not
hold in non-symmetric networks, and in fact, infection might be much more widespread in the
socially optimal allocation than in a decentralized equilibrium.
Example 1.1. Consider the network given in Fig. 1. The underlying network S is a star with 5
nodes, each representing an agent. Each agent can protect herself against infection by investing in
security q, defined as the probability that she is “immune” to infection. Suppose that her utility
is given by the probability that she is uninfected minus her cost of security investment, assumed
                        q2
to be given by c(q) =   5 (2.9   − 1.33q). Suppose also that the initial infection (attack) hits one of
the agents uniformly at random. If this node is susceptible, it will get infected. Each infected

                                                    1
                                                  1




                                   2        3           4           5



Figure 1: The equilibrium security profile is qe = [0.2, 1, 1, 1, 1] and the social optimum is qs =
[1, 0.2, 0.2, 0.2, 0.2]


agent can infect all its susceptible neighbors. One can verify that qe = (0.2, 1, 1, 1, 1) is a pure-
strategy Nash equilibrium security profile. However, the social optimum security profile is qs =
(1, 0.2, 0.2, 0.2, 0.2). The expected (number of) infections in equilibrium is I(S, qe ) = 0.16, but
expected infections in the social optimum I(S, qs ) = 0.64.

   The key to this example and to the economic richness of security decisions in a non-symmetric
network is a simple observation: security decisions of different agents not only create positive ex-
ternalities but are typically also strategic substitutes, meaning that greater investment by an agent
reduces the desired investment of others, as can be readily seen in Example 1. This strategic sub-
stitutes property makes the analysis of non-symmetric networks particularly important.
   This paper studies equilibrium and socially optimal security investments in a general random
network subject to attack. Each agent i is connected to a subset of other agents and chooses a
security investment qi . An infection is probabilistically transmitted across connected agents. Con-
ditional on transmission to agent i, the probability of infection of this agent is 1 − qi (meaning
that with probability qi , this agent is immune to infection). This formulation is both tractable and
makes the positive externality from network investments transparent . We distinguish two types
of attacks: (1) random attacks, which are likely to hit each agent uniformly at random (and in partic-
ular independent of their security investments); (2) strategic attacks, where the location of the attack
is determined by an adversary wishing to maximize expected infection (see also Bachrach, Draief
and Goyal, 2012, Goyal and Vigier, 2011).
   We first provide a decomposition of individual payoffs into an own effect and an externality,
a tractable decomposition that underpins the rest of our analysis and appears not to have been
noticed so far in the literature. This decomposition enables us to write the payoff of an agent as
a function of network effects of others and as a linear function of her own security investment,
minus its own cost of investment. These network effects have a simple recursive structure and can
be computed by considering the network with one agent removed at a time.
   Second, using these decompositions we establish the existence of a pure-strategy Nash equi-
librium in the random attacks model. Example 1 above already shows that such equilibria may

                                                   2
feature overinvestment by some nodes and lower than optimal level of infection over the entire
network, in contrast to what has generally been presumed on the basis of the positive externality
underlying these interactions.
   Third, we show that symmetric equilibria of symmetric networks always involve underinvest-
ment as presumed by the existing literature. Intuitively, in a symmetric equilibrium the positive
externality dominates the strategic substitutes effect and thus each agent underinvests (it is easy
to see why this has to be so; if not, then all agents would overinvest, which would be inconsistent
with positive externalities). Nevertheless, we also show that symmetric networks do not preclude
non-symmetric equilibria, which may still involve overinvestment as in our Example 1 above. The
intuition for this is also simple: once the equilibrium is non-symmetric (even if the underlying net-
work is symmetric), the underinvestment of one agent will trigger overinvestment by some others,
which can dominate the underinvestment effect.
   Fourth, we introduce a special class of networks, where the network structure is represented
by a tree and cost of investments are sufficiently convex (as defined below), and show that such
networks always lead to underinvestment in security (though a tree structure is not sufficient for
this result by itself as we also illustrate by examples). The intuition for this result can be obtained
as follows: sufficiently convex cost functions ensure that when the overall probability of infection
reaching agent i increases, this agent does not increase his security investment so much as to reduce
its overall probability of infection. This combined with the tree network puts an upper bound on
how much an agent will change its investment because some other agents underinvest, enabling
us to show that, in equilibrium, all agents underinvest.
   Fifth, we show that this result generalizes to random networks with local tree structures (mean-
ing that there exists p̂ such that any subcomponent of a certain size of the network does not con-
tain a cycle with probability at least p̂). The intuition for this result follows from the previous one,
which enables us to bound the network effect of each agent on the rest of the network for each
subcomponent of the original network.
   Sixth, we strengthen this result for symmetric networks such as Erdos-Renyi graphs and we
also provide additional ranking results for symmetric networks comparing equilibrium infection
rates across different network structures. These results rely on observing that for this class of
symmetric networks not only a symmetric equilibrium exists but is also the only equilibrium.
   Seventh, we show that there is an additional reason for overinvestment in the case of strate-
gic attacks, echoing an intuition going back to de Meza and Gould (1992): preventive activities
can create negative instead of positive externalities when they shift attacks to other nodes. We
illustrate this first using a tree network with sufficiently convex cost functions, thus establishing
that even in this case overinvestment can easily result. Finally, for a symmetric random graphs
and some additional conditions on cost functions, we show that the equilibrium always involves
overinvestment.
   There is now a large literature on spreads of infections and epidemics over networks includ-
ing, among others, Molloy and Reed (1998, 2000), Newman et al. (2001), and Chung and Lu

                                                   3
(2002). Early works considering control of infections and epidemics include Sanders (1971) and
Sethi (1974). Brito et al. (1991), Geoffard and Philipson (1997), Goldman and Lightwood (2002)
and Toxvaerd (2009) analyzed certain aspects of precautionary or vaccination behavior in related
settings.
    More closely related to our paper are Bachrach, Draief and Goyal (2012) and Larson (2011), both
analyzing endogenous formation of networks (connections) together with security decisions in
the presence of infections. In Larson’s model, for example, network connections generate benefits
for agents but also spread infection. In Larson’s model each agent chooses both their expected
connectivity and a security level. Both of these papers focus on symmetric networks (e.g., Erdos-
Renyi random graphs), and thus do not obtain any of our main results. Blume et al. (2011) also
study network formation in the presence of negative contagion, but focus on providing bounds on
the inefficiency of equilibrium.1
    Also closely related are works related to “strategic attacks,” where precautionary behavior
shifts attacks from one agent to another. As mentioned above, an early paper showing this pos-
sibility is de Meza and Gould (1992). Related issues are studied in Baccara and Bar-Isaac (2008),
Bachrach, Draief and Goyal (2012), Goyal and Vigier (2011), Kovenock and Roberson (2010), and
Hoyer and Jaegher (2010), but once again without focusing on the effects of network structure.
    Our results contribute to the literature in two distinct ways. First, we generalize existing mod-
els of both random and strategic attacks to (potentially asymmetric) random networks and show
how new economic forces arise in the setting that were absent in symmetric equilibria. Second, we
provide new and powerful characterization results. We show that the oft-presumed underinvest-
ment in security investments is not generally true and overinvestment arises in a range of settings,
with both random and strategic attacks, for well-defined economic reasons. Our characterization
results then enable us to determine a range of cases where underinvestment or overinvestment
incentives dominate.


Basic Notation and Terminology

Throughout the paper unless otherwise stated, a vector is viewed as a column vector. We denote
by xi , the ith component of a vector x. For a vector x, x−T denotes the subvector that corresponds
to the indices not in set T .
    An undirected graph with node set V and edge set E is represented by G = (V, E). We let
|V | = n and |E| = m. We sometimes use the notation V (G) and E(G) to denote the node set and
the edge set of graph G. A graph without edges is called an “empty graph”. The subgraph of a
graph G is a graph H with V (H) ⊆ V (G) and E(H) ⊆ E(G). The subgraph of G = (V, E) induced
by V 0 ⊂ V , denoted by G[V 0 ], is defined as G[V 0 ] = (V 0 , {(u, v)|(u, v) ∈ E, u, v ∈ V 0 }). Also, for a
given V̄ ⊂ V , we will sometimes use the notation G−V̄ as G[V − V̄ ].
   1
     Classic references on network formation include Jackson and Wolinsky (1996) and Bala and Goyal (2000)]. See also
Jackson (2008) and Vega-Redondo (2007) for excellent book-length treatments of issues of contagion in networks and
network formation.


                                                         4
        A random graph A is drawn from a probability space (Ω, F[V ], P), where Ω is the set of all
undirected graphs with node set V , F is the family of all subsets of Ω, and for every Ã ∈ Ω, P(Ã)
is the probability of Ã. For a given i ∈ V , A−i is drawn from the probability space (Ω−i , F−i , P−i )
where Ω−i is the set of all undirected graphs with node set V−i , F−i is the family of all subsets of
Ω−i , and for a given Ã0 ∈ Ω−i , P−i (Ã0 ) = {Ã∈Ω|Ã−i =Ã0 } P(Ã). Similarly, given a random network
                                              P

A, the induced network over the node set V 0 ⊂ V is denoted by A[V 0 ] and is drawn from the
probability space (Ω0 , F0 , P0 ), where Ω0 is the set of all graphs with node set V 0 , F0 is the family of
all subsets of Ω0 , and for a given Ã0 ∈ Ω0 , P0 (Ã0 ) = {Ã∈Ω|Ã[V 0 ]=Ã0 } P(Ã).
                                                          P



        The rest of the paper is organized as follows. Section 2 presents our basic model, focusing on
the case in which attacks are random (undirected with respect to security investments). It shows
why, because of the strategic substitutes aspect of investments, the common conjecture that there
will necessarily be underinvestment in security does not always hold. Section 4 establishes that
when costs functions are “sufficiently convex” and networks are trees, the equilibrium is unique
and always involves underinvestment relative to the social optimum. Section 5 extends these re-
sults to random networks that are “locally tree-like,” meaning that they feature low probability
of a cycle within the component of the network attached to any particular agent. Section 6 es-
tablishes a similar uniqueness and underinvestment results for symmetric random networks and
for island networks (which consist of several symmetric islands sparsely connected to each other).
This section also provides a ranking of the extent of contagion across different symmetric net-
works. Section 7 considers strategic attacks (directed with respect to to the security investment
profile of agents), and shows an additional reason for overinvestment. Section 8 concludes, while
the Appendix contains all the proofs and some additional examples.


2       Model
We study the spread of infection among a set V = {1, . . . , n} of agents over a network. Agent
interactions are represented by a random network A drawn from a probability space (Ω, F, P),
where Ω is the set of undirected networks with node set V .2 We use Ar to denote a realization of
random network A and refer to it as the interaction network. We often use the terminology Ar is
generated from A, denoted by Ar ∼ A, to highlight the dependence on the random network A.3
        An attacker exposes one of the agents to an infection (virus), which then spreads dynamically
to the other agents. Attacker’s decision of which agent to target is represented by the probability
vector Φ = (ρ1 , . . . , ρn ), where ρi denotes the probability of attacking agent i. We use the notation
s to denote the selected target agent, also referred to as the seed agent. The infection is transmitted
    2
     We will use the terms agent, node and individual interchangeably throughout the paper. Similarly, we will use the
terms network and graph interchangeably.
   3
     A deterministic network G = (V, E) is a special case of this model in which P(G) = 1 and for all G0 6= G, P(G0 ) = 0.



                                                            5
on the edges of the interaction network.4
       Before the interaction network Ar and the location of the attack is realized, each agent i invests
in a security level qi ∈ [0, 1] to decrease the chance of getting infected. We use q = [qj ]j∈V and
q−i = [qj ]j∈V, j6=i to denote the security profiles (short for security investment profiles) of all agents
and all agents other than i respectively. Here, qi can be interpreted as the probability that agent i is
immune to the infection. Conversely, 1 − qi is the probability that the agent is susceptible, meaning
that if the infection reaches her, she gets infected with probability 1 − qi (independent of all other
events).5
       Given network A, security profile q and attack decision Φ, we denote the probability of node i
getting infected by Pi (A, q, Φ). The utility function of agent i, denoted by ui is given by
                                                                       
                                     ui (A, q, Φ) = vi 1 − Pi (A, q, Φ) − ci (qi ),

where vi is the value agent i derives from being uninfected and ci (qi ) is the cost agent i incurs
for investing in security level qi . We assume vi = 1 in the rest of the paper. However, all the
results hold even without this assumption. We adopt the following standard assumption on the
investment cost function.
Assumption 1 (Investment Cost). For each i, the function ci : [0, 1] → R+ is continuously differen-
tiable, strictly increasing, strictly convex, and satisfies the boundary conditions c(0) = 0, c0 (0) = 0, and
limq→1 c0 (q) = ∞.6
       We define (utilitarian) social welfare as the sum of the utilities of the agents in the network:
                                                               X
                                               W (A, q, Φ) =         ui (A, q, Φ).
                                                               i∈V

       Given network A and security profile q, we define the transmission network as the subgraph of
the interaction network Ar induced over the set of susceptible agents Vs ⊂ V and denote it by At .
The infection is transmitted through the transmission network.7 In particular, given transmission
network At and seed agent s, the set of infected agents consists of the set of agents that belong to
the same connected component with agent s in At .
   4
     For example, when the network A is generated according to an Erdös-Rényi graph with parameter p ∈ (0, 1) (i.e.,
there exists an edge between any pair of agents independently with probability p), this implies that an infected agent
transmits the infection to each of the other agents independently with probability p.
   5
     If we think of the spread of the infection dynamically over the network, this implies that if the agent is not infected
the first time the infection reaches her, she will not be infected in any of the subsequent instances.
   6
     The boundary conditions are imposed to simplify the exposition, and all of our results hold without them.
   7
     Formally, given Ar = (V, E) and a set of susceptible agents Vs ⊂ V , the transmission network At is given by
At ≡ Ar [Vs ] = (Vs , {(i, j) ∈ E | i, j ∈ Vs }). We often use the terminology At is generated from (A, q), denoted by
At ∼ (A, q), to highlight the dependence on the random network A and the security profile q. The probability of
transmission network At can be written as
                                  X                                     X                 Y             Y
                 P (At ) =                    P (At | Ar , Vs ) =                  P(Ar )     (1 − qi )   qi .
                         {Ar ,Vs | At =Ar [Vs ]}               {Ar ,Vs | At =Ar [Vs ]}   i∈Vs       i∈V
                                                                                                     / s




                                                               6
      We study two different attack models: a random attack model in which the attacker targets each
agent with attack decision Φ, which is determined exogenously and independent of the security
investments of the agents, and a strategic attack model in which the location of the attack is deter-
mined by an adversary who observes the security profiles of all agents and chooses one agent to
attack with the goal of maximizing expected infections. The random attack model represents the
scenario where the attack is an exogenous random event and one of the agents is selected at ran-
dom according to Φ. The strategic attack model on the other hand represents a strategic adversary
wishing to maximize the damage to the network.8


3     Random Attack Model
In this section, we focus on the random attack model, where the attacker’s decision is an exoge-
nously given probability vector Φ = (ρ1 , . . . , ρn ). We first present key properties of equilibria and
social optimum for this model, which will also apply (in a slightly modified form) to our analysis
of the strategic attack model. Our first result provides a characterization for the infection probabil-
ity of an agent in terms of his security level qi and a network effect caused by the other agents. We
then show that the network effect admits a simple decomposition that highlights the contribution
of the agents on infection one at a time. These characterizations enable us to express individual
utility and social welfare in a form that makes the dependence on the security levels explicit. We
use these expressions to show the existence of a pure-strategy Nash equilibrium for the resulting
game, to characterize the best response and welfare maximizing strategies of agents, and to study
the monotonicity behavior of best response strategies in response to changes in security profiles
of other agents. In the last subsection, we focus on symmetric networks (defined formally below)
and show that while such networks have a unique symmetric equilibrium that features underin-
vestment, they may also have asymmetric equilibria in which some agents over invest compared
to the social optimum.


3.1     Key Properties

Our first proposition provides a tractable decomposition of individual utility functions into an
own effect and network effects of other individuals.

Proposition 3.1 (Network Effect). Given network A, security profile q, and attack decision Φ, the infec-
tion probability of agent i satisfies

                                        Pi (A, q, Φ) = (1 − qi )P̃i (A, q−i , Φ),

where P̃i (A, q−i , Φ) is the probability of the infection reaching agent i.
   8
     A hybrid model, where the attacker can target agents according to the characteristics but not their security invest-
ments, gives results very similar to the random attack model. We do not discuss this hybrid case to economize on
space.


                                                           7
      As with all the other results in the paper, unless stated otherwise, the proof of this proposition
is provided in the Appendix.
      This result is intuitive in view of the fact that agent i is susceptible to infection with probability
1−qi . If she is immune, then she will not get infected in any case. If she is susceptible, she will only
get infected if the infection reaches her. In what follows, we refer to P̃i (A, q−i , Φ) as the network
effect of A on i.
      The network effect on an agent admits a simple decomposition and can be computed recur-
sively by considering the network with one agent removed at a time.9

Proposition 3.2 (Decomposition). Given network A, security profile q−j , and attack decision Φ, the
probability of infection reaching agent j, P̃j (A, q−j , Φ), satisfies the following: For all i ∈ V, i 6= j,

                      P̃j (A, q−j , Φ) = P̃j (A−i , q−{i,j} , Φ) + (1 − qi )Qj,i (A, q−{i,j} , Φ),

where Qj,i (A, q−{i,j} , Φ) is the probability that the infection reaches agent j only through a path that con-
tains agent i conditional on i being susceptible.

      We refer to (1 − qi )Qj,i (A, q−{i,j} , Φ) as the externality of i on j.
      This decomposition follows from considering the following mutually exclusive events under
which infection reaches agent j: (A) there exists a path from the seed agent s to j in the transmis-
sion network that does not include i, or (B) all possible paths from s to j in the transmission net-
work goes through i. The probability of first event is equal to the probability of infection reaching
agent j in the network A−i and is independent of qi (and qj ).10 The probability of the second event
can be written as the probability of infection reaching j through a path that contains i conditional
on i being susceptible (which does not depend on qi ) times the probability of i being susceptible,
which is (1 − qi ). Figure 2 illustrates different transmission networks over which infection reaches
agent j: Fig. 2(a) shows instances in which event (A) occurs, and Fig. 2(b) shows an instance in
which event (B) occurs.


3.2     Existence

Using Proposition 3.1, we can write the utility function of agent i as the following:
                                                                         
                              ui (A, q, Φ) = 1 − (1 − qi )P̃i (A, q−i , Φ) − ci (qi ).
    9
      In a graph G = (V, E), a path between nodes u and v corresponds to u = v0 , e1 , v1 , e2 , . . . , ek , vk = v where
ei = (vi−1 , vi ) ∈ E, for all 1 ≤ i ≤ k with no repeated edges and nodes.
   10
      This probability does not depend on Φi , nevertheless we keep the dependence on the entire vector Φ to simplify the
notation.




                                                            8
                   𝑗                                       𝑗                                   𝑗



 𝑎                                 𝑖     𝑎                                 𝑖             𝑎                  𝑖



                𝑠                                          𝑠                                   𝑠
                                   (a)                                                   (b)


Figure 2: Transmission networks over which the infection reaches agent j. Figure (a) shows transmission
networks in which there exists a path from s to j that does not include i (event (A) occurs). Figure (b) shows
the transmission network in which all possible paths from s to j goes through i (event (B) occurs).


Similarly, fixing any i ∈ V , from Propositions 3.1 and 3.2, social welfare takes the following form:
               X
  W (A, q) =            uj (A, q, Φ)
               j∈V
                                          
            = 1 − (1 − qi )P̃i (A, q−i , Φ) − ci (qi )
                X                                                                              
             +          1 − (1 − qj ) P̃j (A−{i} , q−{i,j} , Φ) + (1 − qi )Qj,i (A, q−{i,j} , Φ)    − cj (qj ).
                       j∈V j6=i
                                                                                                            (3.1)

     A security profile qe is a (pure-strategy) Nash equilibrium if for all i ∈ V and all qi ∈ [0, 1],

                                             ui (A, qe , Φ) ≥ ui (A, (qi , qe−i ), Φ).

Similarly, a security profile qs is a social optimum if for all q ∈ [0, 1]n ,

                                                W (A, qs , Φ) ≥ W (A, q, Φ),

i.e., qs is a global maximum of the social welfare function.

Theorem 3.1 (Equilibrium Existence). In the random attack model, for any network A, there exists a
pure-strategy Nash equilibrium.

     The existence of a pure-strategy Nash equilibrium follows from the linearity of the utility func-
tion ui (A, q, Φ) in qi , its continuity in q, and the fact that the strategy spaces are compact, and we
omit a formal proof.
     It is useful for what follows to define the best response strategy of an agent i, Bi (q−i ), as the
security level qi that maximizes her utility given the security profile q−i of other agents. Clearly:

                                               c0i (Bi (q−i )) = P̃i (A, q−i , Φ).                          (3.2)



                                                                9
       Similarly, the welfare maximizing strategy of agent i, Si (q−i ), is the security level qi that maxi-
mizes social welfare given the security profile q−i of other agents, given by
                                                               X
                        c0i (Si (q−i )) = P̃i (A, q−i , Φ) +          (1 − qj )Qj,i (A, q−{i,j} , Φ).            (3.3)
                                                               j6=i


A comparison of these two expressions immediately establishes that

                                                Bi (q−i ) ≤ Si (q−i ).                                           (3.4)

Given the profile of security investments of other agents, agent i always invests less in best re-
sponse strategy than in the welfare maximizing strategy. However, as Example 1 in the Introduc-
tion shows, this does not imply underinvestment by all agents.
       The network effect satisfies intuitive monotonicity properties given in the following proposi-
tion.

Proposition 3.3. Given network A and two security profiles q and q̂, the following properties hold for each
agent i ∈ V :

  (a) If q−i ≥ q̂−i , then P̃i (A, q−i , Φ) ≤ P̃i (A, q̂−i , Φ).

  (b) For any V̂ ⊂ V , P̃i (A−V̂ , q−(V̂ ∪{i}) , Φ) ≤ P̃i (A, q−i , Φ).

  (c) If P̃i (A, q−i , Φ) ≥ P̃i (A, q̂−i , Φ), then Bi (q−i ) ≥ Bi (q̂−i ).

       Part (a) of this proposition states the intuitive fact that probability of the infection reaching
agent i is smaller when other agents select a higher security profile. Part (b) establishes that the
probability of the infection reaching agent i is smaller in a subgraph (which is expected since
there are more paths along which infection can reach agent i in the original graph). Finally, part
(c), which will play an important role in some of our later proofs, shows that the best response
strategy of agent i is higher when the network effect of A on i is higher.


3.3      Symmetric Networks

We next focus on symmetric networks (with symmetric agents in terms of their cost function ci ,
which is denoted by c in this subsection).

Definition 1 (Symmetric Network). A random network A is symmetric if for any permutation π : V →
V , A0 = π(A) has the same distribution as A.

       The preferential attachment networks, Erdos-Renyi random graphs and random graphs with
arbitrary degree distributions are examples of symmetric networks.11
  11
   Note that the interaction network need not be symmetric; rather, agent locations within the network are identical in
expectation.


                                                          10
                 𝑎                                 𝑎                                         𝑎
                 1                                4                                           4
                 9                                15                                          9


 8                              8   4                                        4    4                          4
 9                              9   15                                       15   9                          9
𝑏                               𝑐   𝑏                                        𝑐    𝑏                          𝑐
                (𝑎)                               (𝑏)                                        (𝑐)

Figure 3: A 3-cycle network. Figure (a) shows the asymmetric equilibrium security profile, Figure (b) shows
the symmetric equilibrium security profile, and Figure (c) shows the symmetric social optimum security
profile.


     Our next result shows that in symmetric networks, a unique symmetric equilibrium security
profile exists and that investment levels and thus the symmetric equilibrium are always lower than
the (unique) symmetric social optimum.

Theorem 3.2. Suppose Assumption 1 holds. For a symmetric network, there exists a unique symmetric
equilibrium (with investment q e ) and a unique symmetric social optimum (with investment q s ). Moreover
we have q e ≤ q s .

     The key result in Theorem 3.2 is the underinvestment in security in the symmetric equilib-
rium relative to the social optimum. This result, which confirms those in the existing literature,
has a straightforward intuition, which can be seen from Eq.(3.4): given the security profile of all
other agents, an individual always has weaker incentives to invest in security in the best response
strategy than in the welfare maximizing strategy. In a symmetric equilibrium this implies that
everybody will have weaker incentives to invest in security, leading to underinvestment.
     This intuition does not extend to asymmetric equilibria of symmetric networks as the next
example shows.
                                                                                             49
Example 3.1. Consider the 3-cycle network illustrated in Fig. 3. We assume that c(q) = q 2 ( 24 − 54 q).
                                                                                                    4
One can verify that the security level at the unique symmetric equilibrium is q e =                 15 .   This example
has an asymmetric equilibrium given by      q̂e    =    ( 19 , 89 , 89 ).   Moreover, it has a unique social optimum,
                                                   4
which is symmetric with security level    qs   =   9.




4    Tree Networks with Sufficiently Convex Cost Functions
In this and the subsequent two sections, we focus on tree networks and cost functions that satisfy
a stronger requirement than convexity, which we refer to as sufficiently convexity. A graph is a tree
if it is connected and acyclic. A graph is acyclic if it has no cycle and is connected if between each
pair of nodes, a path exists.


                                                          11
    We will show that the combination of these two assumptions ensures that expected infections
at the social optimum is less than or equal to that in the equilibrium. The role of each of these
assumptions will be clarified later in this section.
    We first define our new assumption on the investment cost functions.

Assumption 2 (Sufficiently Convex Cost Function). For each i, the cost function ci : [0, 1] → R+ is
sufficiently convex if c0i (q)(1 − q) is strictly increasing over [0, 1].

    This assumption is equivalent to the function c̃(x) = c(1 − x) having an elasticity of marginal
cost greater than or equal to 1. An example of a sufficiently convex cost function is c(q) = −q −
log(1 − q).
    To understand the implications of sufficiently convex cost functions, recall the first-order con-
dition satisfied by the best response strategy Bi (q−i ) of agent i given in Eq. (3.2). In view of Propo-
sition 3.1, the infection probability of agent i, when he selects his best response strategy given the
security profile q−i , can be expressed as

                            Pi (A, (Bi (q−i ), q−i ), Φ) = (1 − Bi (q−i ))c0i (Bi (q−i )).

The key implication of Assumption 2 is that, when q−i decreases, even if agent i in response in-
creases his investment, his probability of infection will still increase. Put differently, sufficiently
convex cost functions ensure that direct effects (change in others’ investments) dominate indirect
effects (the response to this change). The next lemma states this result more formally.

Lemma 4.1. Suppose Assumptions 1 and 2 hold. Let q−i and q̂−i be such that P̃i (A, q−i , Φ) ≥ P̃i (A, q̂−i , Φ).
Then Pi (A, (Bi (q−i ), q−i ), Φ) ≥ Pi (A, (Bi (q̂−i ), q̂−i ), Φ).

    This lemma clarifies the role of the sufficiently convex cost assumption in establishing results
on “underinvestment in equilibrium” for general networks: even though underinvestment by oth-
ers triggers overinvestment by agent i, sufficiently convex cost functions ensure that i’s overall
infection probability increases when this is the case and thus bounding how much i’s investment
can increase.
    Nevertheless, Lemma 4.1 does not immediately imply that expected infections are necessarily
higher in the equilibrium than in the social optimum. This can be proven for tree networks, which
also guarantees uniqueness of equilibrium.

Theorem 4.1. Suppose Assumptions 1 and 2 hold. For any tree network, there exists a unique pure-strategy
Nash equilibrium security profile.

    Here we provide the intuition for the proof of this result, which illustrates the central roles of
both sufficiently convex cost functions and the tree structure. If there exist multiple equilibria qe
and q̂e , we can find an edge (x, y) such that qxe > q̂xe , qye < q̂ye , and for all nodes v in the subtree



                                                         12
rooted at y (i.e., nodes that reaches x through y) qve < q̂ve . By sufficiently convex cost assumption,
this implies
                    Px (A, qe , Φ) > Px (A, q̂e , Φ) but Py (A, qe , Φ) < Py (A, q̂e , Φ).           (4.1)

The idea is then to exploit the tree network structure and establish a contradiction. In particular,
because qve < q̂ve for all v in the subtree rooted at y, the probability of infection for agent y coming
from this subtree is greater under the profile qe than q̂e . In addition, if the probability of infection
for y from its upstream neighbors was also higher under the profile qe than q̂e , then this would
contradict (4.1). Moreover, if the probability of infection for y from its upstream neighbors was
lower under qe than q̂e , then this would contradict the ranking of the investments of x and y in
the two candidate equilibria, again yielding a contradiction. Intuitively, in a tree network with
sufficiently convex cost functions, greater investment in one part of the network always translates
into higher probability of infection for neighboring agents, and this precludes the possibility of
two different equilibrium profiles.
   More importantly, tree networks and sufficiently convex cost functions also ensure an unam-
biguous ranking between expected infections in equilibrium and social optimum as shown in the
next theorem.

Theorem 4.2. Suppose Assumptions 1 and 2 hold. Let I(A, q, Φ) denote expected infections in network
A with security profile q and attack decision Φ. Given tree network A, we have I(A, qe , Φ) ≥ I(A, qs , Φ)
where qe and qs are the equilibrium and the socially optimal security profiles.

   This theorem also holds for any random network where the realizations correspond to a set
of potentially disconnected trees, e.g., we start with a tree, and each edge remains active with
probability p ∈ (0, 1].
   The economic intuition of this theorem is related to the reason why such a result is not true in
general networks and without sufficiently convex cost functions. We have seen that underinvest-
ment by an agent triggers overinvestment by others (because investments in security are strategic
substitutes), and this response can have a greater impact on expected infections than underinvest-
ment by the first agent. Sufficiently convex cost functions limit the extent of the indirect response
of an agent, and the tree network by ruling out cycles ensures that we can use this bound to rank
expected infections in equilibrium and social optimum.
   The technical intuition of the proof of Theorem 4.2 is also instructive, as illustrates why tree
networks and sufficiently convex cost functions are important for the result. For this reason, while
a formal proof is provided in the Appendix, we discuss the main idea here.
   Consider the set V1 = {i ∈ V | qis ≤ qie }, i.e., V1 is the set of agents that overinvest in the
equilibrium relative to the social optimum (if V1 is empty, it means that all agents underinvest in
the equilibrium and the result follows straightforwardly). For any V̄ ⊂ V , let CI (i, A−V̄ ) denote




                                                     13
the contribution of agent i to infection in subgraph A−V̄ for a given security profile q, i.e.,
                                                                                                                  
                                                                      X
 CI (i, A−V̄ , Φ) = (1 − qi ) P̃i (A−V̄ , q−V̄ ∪{i} , Φ) +                     (1 − qj )Qji (A−V̄ , q−V̄ ∪{i,j} , Φ) . (4.2)
                                                                                                                    
                                                                 j∈V −V̄ ∪{i}


The key to the proof of Theorem 4.2 is the following lemma which establishes that for tree net-
works, the contribution of agents to infection in a subgraph is upper bounded by their contribution
to infection in the original graph.

Lemma 4.2. Given tree network A and node set V̄ ⊂ V ,
                                            X                         X
                                                   CI (i, A−V̄ ) ≤             CI (i, A).
                                         i∈V −V̄                     i∈V −V̄


   The intuition follows from the fact that for tree networks, if an agent k is removed, then the
network effect of agent i on agent j either remains constant (if the path between the two did not
include k) or decreases to zero. (if the path did include k.) This is not necessarily true for graphs
with cycles as Example A.1 in the Appendix shows.
   Using Lemma 4.2, an upper bound for expected infections in the social optimum is the follow-
ing:
                                                                           X
                               I(A, qs , Φ) ≤ I(A−V1 , qs−V1 , Φ) +               c0i (qis )(1 − qis ).
                                                                           i∈V1

Here we used Eq. (3.3) to write CI (i, A) as c0i (qis )(1−qis ) (and see also Lemma A.1 in the Appendix).
Moreover, expected infections in the equilibrium can be lower bounded as follows:
                                               X
                             I(A, qe , Φ) ≥          c0i (qie )(1 − qie ) + I(A−V1 , qe−V1 , Φ−V1 ).
                                              i∈V1


This lower bound is obtained by applying Eq. (3.2) for the agents in V1 and using Proposition
3.3(b) to provide a lower bound on expected infections among agents outside set V1 .
   These two bounds, combined with the following observations, yield the desired result.

  (1) I(A−V1 , qe−V1 , Φ−V1 ) ≥ I(A−V1 , qs−V1 , Φ−V1 ) since qis ≥ qie for all i ∈ V − V1 ;
                0 e         − qie ) ≥           0 s         − qis ) since investment cost functions are sufficiently
        P                               P
  (2)     i∈V1 ci (qi )(1                 i∈V1 ci (qi )(1
        convex and qis      < qie for all i ∈ V1 .

   Example A.2 in the Appendix shows that Assumption 2 cannot be dispensed with for the re-
sults of Theorems 4.1 and 4.2, i.e., for tree networks, if the investment cost function is not suffi-
ciently convex, the equilibrium need not be unique and expected infections in equilibrium may be
strictly lower than that at the social optimum.



                                                               14
5     Large Networks and Local Tree Structures
The previous section established that expected infections are greater in equilibrium than in the so-
cial optimum provided that investment cost functions are sufficiently convex and the network is a
tree. The latter assumption is particularly restrictive as communication networks do not generally
resemble trees (typically involve cycles, which are ruled out with the tree assumption). In this
section, we show that the same efficiency comparison holds for large networks provided that they
have a “local tree structure”.


5.1     Local Tree Structures

We start by defining the local tree concept formally.

Definition 2 (h-Local Tree Structure). A random network has h-local tree structure if the connected
component attached to each agent of the network is acyclic with probability at least h.

      In other words, a local tree structure only requires a high probability that the components
attached to an agent is acyclic (thus it allows some probability of cycles and also cycles in other
parts of the network).
      Our main result provides a relation between expected infections in equilibrium and in the social
optimum for a network with a local tree structure.

Theorem 5.1. Suppose Assumptions 1 and 2 hold. Given a network with 1 − -local tree structure, we have
I(A, p, qe , Φ) + n ≥ I(A, p, qs , Φ) where qe and qs are the equilibrium and the socially optimal security
profiles.

      The economic intuition of this result is closely related to Theorem 4.2, and again exploits suffi-
ciently convex cost functions and the structure of the network, which now, with high probability,
rules out cycles in the spread of an infection within the component of the network attached to each
agent.The proof also illustrates the relationship between this result and Theorem 4.2. In particular,
the proof considers expected infections in cyclic and acyclic components of each interaction net-
work separately. Expected infections in cyclic components is bounded above by expected number
of agents belonging to cyclic components and as a result is at most n. We then use a similar ar-
gument as in the proof of Theorem 4.2 to show that expected infections in the social optimum in
acyclic components of the interaction network is less than or equal to expected infections in the
equilibrium.


5.2     Large Networks and Local Tree Structures

One question posed by Theorem 5.1 is whether the remainder term, n, is truly small in the sense
that n(n) → 0 as n → ∞ (where we emphasize that this is not trivial because  is a function of n as
our notation (n) here underscores). We next show that for a random network model in which we

                                                     15
first generate the interaction network and then activate the edges independently with probability
p > 0, the answer is affirmative. In particular, under the right conditions on p, the network in
question has a 1 − (n)-local tree structure and n(n) → 0 as n → ∞.
    In this random network model, we first generate the interaction network and then activate
edges independently with activation probability p. We use Aa to denote a realization of random
network A under the activation probability p and refer to it as the activated network. We will use
the terminology Aa is generated from (A, p), denoted by Aa ∼ (A, p) to represent the dependence
on random graph A and the activation probability p. We next provide conditions on (A, p) under
which limn→∞ (n) as well as limn→∞ n(n) is 0.
    Let the eigenvalue λ(G) represent the second largest in absolute value of the adjacency matrix
of the degenerate network G. For a given d < n, let Gd denote the set of d− regular graphs G
with λ(G) = o(d). Combining Lemma A.5 and Theorem A.1 (see Appendix A.6), we obtain the
following theorem.

Theorem 5.2. Given random network A generated from (Ω, F, P), where Ω = {G = (V, E)|E ⊂ Ê, (V, Ê) ∈
Gd },
               √
    • If d = Ω( n) and p < d1 , the generated random network from (A, p) is a 1 − (n)-local tree network
        with limn→∞ (n) = 0.
                   1
    • If p <   n log2 (n)
                          ,   the generated random network from (A, p) is a 1 − (n)-local tree network with
        limn→∞ (n)n = 0.

    Intuitively, for p small, all components of the random graph of size n are smaller than log n
with high probability. Then the result follows by bounding the probability of a cycle within each
component.


6       Symmetric and Island Networks
The previous two sections establish a comparison between expected infections in equilibrium and
social optimum for two classes of special networks (trees and large graphs with locally tree struc-
ture) under sufficiently convex cost functions. In this section, we establish a similar comparison
for symmetric random networks and for “islands” networks, which consist symmetric “islands”
sparsely connected to each other. An important step in our results is to prove the uniqueness of
equilibrium, which rules out the possibility of highly asymmetric equilibria with counterintuitive
implications as in example in the Introduction. We end this section by providing a ranking of dif-
ferent random symmetric networks in terms of expected equilibrium infections, thus quantifying
which sorts of networks are likely to lead to greater contagion of infection.




                                                        16
6.1     Uniqueness of Equilibrium

Our next result establishes the existence of a unique symmetric pure-strategy Nash equilibrium
in symmetric networks (and no other equilibria) when the investment cost function is sufficiently
convex. An immediate corollary of this result that follows from Theorem 3.2 is then the comparison
of expected infections in equilibrium and social optimum.

Theorem 6.1. Suppose Assumptions 1 and 2 hold. Given symmetric random network A, there exists a
unique pure-strategy Nash equilibrium and a unique socially optimal security profile.

Corollary 6.1. Suppose Assumptions 1 and 2 hold. Given symmetric random network A, we have I(A, qe , Φ) ≥
I(A, qs , Φ) where qe and qs are the equilibrium and the socially optimal security profiles.

      Recall from Section 3.3 that there is underinvestment in the symmetric equilibrium of symmet-
ric networks (compared to the social optimum). The problem, however, was that there can also be
asymmetric equilibria in such symmetric networks which feature overinvestment. By establishing
uniqueness, Theorem 6.1 rules out such asymmetric equilibria and thus guarantees equilibrium
underinvestment.


6.2     Islands Network

In this subsection, we consider “islands” networks, which can be considered as a generalization
of symmetric networks in the sense that it combines a number of symmetric networks (islands).
Similar types of networks are also considered Golub and Jackson (2012).

Definition 3 (Islands networks). An islands network consists of a set of agents denoted by V , a set of
islands denoted by H = {H1 , H2 , . . . , Hn }, and a set of edges (or bridges) between the islands (i.e., between
randomly selected agents from the islands) denoted by T . Each agent v ∈ V resides on one island Hj ∈ H.
We assume that each Hi is a symmetric random network and the edges of T form a tree network when we
view each island as a supernode.

      In the rest of this section, we use Hi to denote both the symmetric random network and the re-
alized interaction network corresponding to island i. We abuse the notation and denote an islands
network by A = (V, H, T ). Our next result establishes uniqueness of equilibrium (again under
Assumptions 1 and 2).

Theorem 6.2. Suppose Assumptions 1 and 2 hold. For any islands network, there exists a unique pure-
strategy Nash equilibrium security profile.

      Our main result for this subsection establishes that under Assumptions 1 and 2 in islands net-
works, expected infections is greater in equilibrium than the social optimum.

Theorem 6.3. Suppose Assumptions 1 and 2 hold. Given islands network A = (V, H, T ), we have
I(A, qe , Φ) ≥ I(A, qs , Φ) where qe and qs are the equilibrium and the socially optimal security profiles.

                                                       17
      The proof and the intuition of this result follow those of Theorem 4.2, and are again based on
bounding the contribution of a subset of agents to the expected infections, but now focusing on
the contribution of an island (see in particular, Lemma A.6 in the Appendix).


6.3     Ranking Symmetric Networks

Our results so far have not been informative about the extent of contagion and expected infections
in a network (except for comparing between equilibrium and social optimum). In this subsection,
we provide a ranking across symmetric networks in terms of their expected equilibrium infections.
      With this objective in mind, we represent the network structure in symmetric networks using
the following equivalent characterization: a symmetric random network can be generated from
a distribution over a set of fixed graphs G (referred to as base graphs) and a uniform allocation of
each agent to one of the nodes of the base graph. To simplify the exposition, we will focus on a
degenerate distribution over the base graphs (we assume there is only one base graph) though our
results extend to the more general case. We use G to denote the base graph and Ĝ to denote the
corresponding symmetric random network.
      Our next result shows that as the base graph gets denser, expected equilibrium infections in-
creases. We say that a graph G is denser than G0 , if G has additional links relative to G0 and denote
it by G0 ⊂ G. Since the equilibrium security profile in symmetric random graphs is always sym-
metric, without loss of generality we represent the equilibrium security profile with the symmetric
equilibrium security level in the rest of this section.

Theorem 6.4. Suppose Assumptions 1 and 2 hold. Given two base graphs G1 and G2 , if G1 ⊂ G2 then
I(Ĝ1 , q1e , Φ) ≤ I(Ĝ2 , q2e , Φ) where q1e and q2e represent the equilibrium security levels for Ĝ1 and Ĝ2 .

      The economic idea here is simple. A denser network generates more interlinkages and thus
more pathways for an infection to spread. Recognizing this, agents will typically increase their
security investments in a denser network (relative to a less dense network), but under sufficiently
convex cost functions, this response will never dominate the increase in infection probabilities due
to the greater density of linkages.
      The density of connections does not enable us to compare many important networks, including
trees. We next define a partial order on trees that allows us to compare equilibrium behavior. We
start by defining the distance vector for a tree network.

Definition 4 (Distance Vector). For a given tree network T , dT = (d1 , . . . , dn ) is the distance vector of
T , where di is the number of (distinct) pair of nodes that are at distance i − 1 from each other.

      For example, the distance vector for a star base graph Sn with n nodes is dSn = (0, 2(n −
1), (n − 1)(n − 2), 0, . . . , 0). For two tree networks T1 and T2 , we define a partial order in terms of
the distance vector as follows:



                                                          18
Definition 5 (Domination, ≺). For two tree base structures T and T 0 , let dT = (d1 , . . . , dn ) and dT 0 =
(d0 , . . . , d0n ) represent their distance vector. Tree T dominates T 0 , denoted by T 0 ≺ T , if for all 1 ≤ i ≤ n,
P1i         0
                   Pi
   j=1 dj ≤           j=1 dj .

Proposition 6.1. Suppose Assumptions 1 and 2 hold. For two symmetric networks with tree base graphs
T1 and T2 , if T2 ≺ T1 then I(T̂1 , q1e , Φ) ≥ I(T̂2 , q2e , Φ) where q1e and q2e denote the equilibrium security
levels in T̂1 and T̂2 .
         One can show that for symmetric networks with tree base graphs, a star network dominates all
the other trees and the path network will be dominated by all trees. Note that this relation does
not provide a complete order over tree networks.
         Our final result in this subsection provides a comparison of expected infections for any two
symmetric networks. For a given base graph G, let %G ( nk ) denote the normalized expected size
of the connected component attached to a random agent v in the induced subgraph of G over Vk
where Vk is the set of k randomly selected agents from G.
Theorem 6.5. Suppose Assumptions 1 and 2 hold. For two symmetric networks Ĝ1 and Ĝ2 with base
graphs G1 and G2 , I(Ĝ1 , q1e , Φ) ≥ I(Ĝ2 , q2e , Φ) if for q
                                                              all x ∈ [0, 1], %G1 (x) ≥ %G2 (x), and only if there is
                                                                 2 ln(2+2/)
no  > 0 and an interval I ⊂ [0, 1] of length at least                 n       such that %G1 ( nk ) < %G2 ( nk ) −  for all
k
n   ∈ I.
         This result follows from the following characterization which enables us to express the number
of infected agents as a Bernstein polynomial of q with coefficients %G ( ni ).
Proposition 6.2. Given a base graph G with n nodes and a symmetric security profile q, expected equilib-
rium infections are given by

                                                  n                           
                                                  X
                                                                 i n−i       i  n
                                  I(G, q, Φ) =          n(1 − q) q       %G       .
                                                                             n  i
                                                  i=1


7        Strategic Attack Model
We have so far focused on the random attack model where the attack decision Φ is determined
randomly and independently from the security investments of the agents. In many applications,
however, the attack is not a random event, but the act of a strategic adversary, intended on causing
maximum damage. This, in particular, implies that an attack may not be independent of security
investments. In this section, we focus on this latter case. The main insight is that strategic attack
generates another reason for overinvestment in security relative to the social optimum, this time
even with sufficiently convex cost functions.12
    12
     One could also consider a hybrid model where the attack can be targeted across agents according to their charac-
teristics (e.g., their cost functions or their position in the network) but not according to their security investments —for
example, the attack decision takes place before or at the same time as the investment decisions. From the viewpoint
of overinvestment, this hybrid model would be similar to the random attack model, because agents cannot discourage
attacks by further increasing their investments.


                                                            19
      More specifically, we consider a strategic attacker which, after observing the security profile of
agents, selects an attack decision Φ = (ρ1 , . . . , ρn ) (where ρi is the probability of attacking agent
i) to maximize his utility given by expected infections minus the cost of the attack decision. We
assume that the cost of an attack decision Φ is given by ni=1 ζ(ρi ) where ζ is a convex function
                                                         P

and twice continuously differentiable. A key assumption in our model is that the attacker observes
the security level of all the agents. We therefore analyze the Stackelberg equilibrium of the resulting
two stage game: the agents select their security levels anticipating the decision of the attacker and
the attacker optimizes his attack strategy given the security choices. Given the best response attack
strategy of the attacker, we refer to the Nash equilibrium among the agents as the Nash equilibrium
of the security game.
      We introduce a convex cost function for the attacker both for substantive and technical reasons.
Substantively, targeting attacks according to the investment vector would require very precise
knowledge about each agent’s investments. A convex cost function enables us to capture the idea
that the closer the attacker would like to come to precisely targeting one agent over all others,
the greater the cost it has to incur. Technically, pure-strategy equilibria may generally fail to exist
for reasons similar to the non-existence of pure-strategy equilibria and Bertrand competition with
capacity constraints, as the next example illustrates.

Example 7.1. Consider the network A with 2 singleton agents. We show that attacking a single agent
without cost may lead to nonexistence of a pure-strategy Nash equilibrium. For any security profile q,
the attacker selects the agent with minimum security level to attack. We next consider all possible candi-
dates for the Nash equilibrium and present a profitable unilateral deviation for each candidate, establishing
nonexistence of a Nash equilibrium:

  (a) q1 < q2 : In this case, agent 2 has incentive to decrease q2 , decreasing the cost without changing his
        infection probability.

  (b) q1 = q2 < 1: In this case agent 2 has incentive to slightly increase q2 . This reduces the probability of
                                  1
        him being attacked from   2   to 0 while slightly increasing his cost.


7.1     Equilibrium in the Strategic Attack Model

In this section, we study the equilibrium in the strategic attack model with convex cost. In the rest
of this section, we will use the following notations. We use 1n to denote the vector of dimension
n with each entry equal to n1 . Also we define the vector of all 0 except the ith entity which is 1 by
ei . The utility function of the attacker, given network A, security profile q, and an attack decision
Φ = (ρ1 , . . . , ρn ), ua (A, q, Φ) is defined as follows:
                                                       n
                                                       X          I(A, q, ei )
                                      ua (A, q, Φ) =         ρi                − ζ(ρi ).
                                                                      n
                                                       i=1




                                                             20
In this model, since the security choices of agents impact the location of the attack, the network
effect on an agent is no longer independent of his security level, i.e., Proposition 3.1 does not hold
for this model. This implies that security investments will no longer satisfy the characterization
we used so far, cf. Eq. (3.2).
      Nevertheless, expected infections when agent i is targeted (in the strategic attack model) are
closely linked to the infection probability of agent i under random attack model we have analyzed
so far (where, recall that, each agent is attacked with equal probability independent of their secu-
rity investments). This property enables us to use the decomposition in Proposition 3.1 to write
the utility function of the attacker in closed form.

Lemma 7.1. Given random network A and security profile q, expected infections when agent i is at-
tacked is equal to the network size times infection probability of agent i under the random attack model,
i.e., I(A, q, ei ) = nPi (A, q, 1n ) = n(1 − qi )P̃i (A, q−i , 1n ).

      Intuitively, the infection probability of agent i under the random attack model is the probability
of having a path between i and a randomly selected agent. Conveniently, expected infections when
i is attacked is given by the sum (over all j) of the probability of having a path between i and j,
and thus the two are closely linked as shown in the lemma.
                                                                                                Pn         1
      Given attack decision Φ = (ρ1 , . . . , ρn ) and attack cost function ζ, let Ψ(Φ) =         i=1 ζ 00 (ρi )   and
                      |ζ 000 (ρ
                              i )|
Υ(Φ) = max1≤i≤n        ζ 00 (ρi ) .

Theorem 7.2. In the strategic attack model with convex cost, assume that c002 (Φ)Υ(1 − q) + 2Ψ(Φ) for any
attack decision Φ. Then there exists a pure-strategy Nash equilibrium.

      The condition in this theorem ensures that the utility of each agent with respect to their own
security level is concave. In the next section, we focus on symmetric random graphs. We show
that under some conditions over the attacker cost function, agents overinvest in the equilibrium
compared to the socially optimal solution.


7.2     Strategic Attacks over Symmetric Graphs

In this subsection, we consider the strategic attack model over symmetric networks. As explained
in subsection 3.3, in the random attack model the security investment of one agent creates a pos-
itive externality on other agents. Our results so far have shown that, under some assumptions,
this force ensures that expected equilibrium infections are greater than (or equal to) expected in-
fections in the social optimum — even though, without these assumptions, overinvestment is also
possible in the random attack model. In the strategic attack model, however, security investments
also create negative externalities on others because they divert the attacker to other agents. The
next example shows the possibility of overinvestment with strategic attacks.

Example 7.2. Consider the line network discussed in Fig. 4 with investment cost function c0 (q) =
   q                                                                   ρ2
2(1−q)   for both agents, and attacker cost function ζ(ρ) =            24 .   It can be verified that the unique

                                                          21
Figure 4: Agents overinvest in the equilibrium relative to social optimum. For investment cost function
            q                                            2
c0 (q) = 2(1−q) and the attack cost function ζ(ρ) = ρ20 , the security investments in the equilibrium is
qe = (0.66, 0.66) and the security investment in the social optimum is qs = (0.63, 0.63).




                                                      𝑎                             𝑏




(pure-strategy) Nash equilibrium is qe = (0.66, 0.66) while the socially optimal security profile is
qs = (0.63, 0.63).

   The rest of this subsection provides sufficient conditions for overinvestment or underinvest-
ment. The next assumption ensures that the cost function of the attacker is not “too convex” be-
cause otherwise strategic attacks would be essentially like random attacks (deviating from uniform
probabilities of attack would be too costly).

Assumption 3 (Boundedly Convex Cost Function). The function ζ : [0, 1] → R+ is boundedly
convex with α, β > 0 if

   • ζ is twice continuously differentiable, strictly increasing and strictly convex on (0, 1],

   • ζ(0) = 0, ζ 0 (0) = 0,

   • −α ≤ ζ 000 (x) < −β where 0 ≤ x ≤ 1.

Theorem
   q    7.3. Suppose Assumption 3 holds with α, β > 0. Given symmetric random network A with
      α
n ≥ β + 1, a pure-strategy Nash equilibrium always exists.

   The proof of this theorem is straightforward and involves showing that the utility of each agent
is concave under Assumption 3.
   Our main results in this section is presented next and provides sufficient conditions for overin-
vestment and underinvestment.

Theorem 7.4. Suppose Assumption 3 holds. Given symmetric random network A agents will overinvest
in the symmetric equilibrium relative to the symmetric socially optimal solution if
                           0−1 ( 1 )(1−c0−1 ( 1 ))
                     n−1 c
   • ζ 00 ( n1 ) ≤               n
                      n 1+(n−1)(1−c0−1 ( 1 ))
                       2
                                              n
                                                     when c0−1 (n) ≤ 1 −      √1 ,
                                                                               n+1
                                              n

                     n−1 c0−1 (n)(1−c0−1 (n))
   • ζ 00 ( n1 ) ≤    n2 1+(n−1)(1−c0−1 (n))
                                              ,      when c0−1 ( n1 ) ≥ 1 −    √1 ,
                                                                                n+1

                             c    0−1
                                (n)(1−c        0−1
                                         (n)) n−1              c0−1 ( 1 )(1−c0−1 ( 1 ))
   • ζ 00 ( n1 ) ≤ min( n−1                    ,       n           n
                         n2 1+(n−1)(1−c0−1 (n)) n2 1+(n−1)(1−c0−1 ( 1 ))
                                                                         ). when c0−1 ( n1 ) ≤ 1− √n+1
                                                                                                   1
                                                                                                       ≤ c0−1 (n).
                                                                                   n



                                                                   22
    Also if ζ 00 ( n1 ) ≥ 1 then agents always underinvest in the symmetric equilibrium relative to the symmetric
socially optimal solution.

    The various conditions in this theorem are intuitive. They link under/overinvestment to the
convexity of the attacker’s cost function. Overinvestment requires this cost function not to be “too
convex” since, otherwise, the attacker would choose probabilities very close to those in the random
attack model (uniform across all agents), thus muting negative externalities. When either of these
three conditions in the first part of the theorem is satisfied, negative externalities are non-trivially
present because when an agent increases its security investment, it anticipates that this will trigger
a large decline in its own probability of being the target of the attack. This creates an “arms race”
between agents and leads to overinvestment. In contrast, when the attacker’s cost function is
sufficiently convex, there will be little response of attack probabilities to security investments, in
which case the same forces as in the random attack model dominate and ensure underinvestment
(recall that under conditions of Theorem 7.4, there is underinvestment with random attacks).


8    Conclusion
This paper has developed a model of investment in security in a network of interconnected agents.
Our baseline model is one of random attacks. Network connections introduce the possibility of
cascading failures depending on the profile of security investments by the agents. The existing
literature has identified a central positive externality in this environment: security investments
reduce the likelihood of an infection spreading to other agents, and because each agent ignores
this effect, the existing literature has presumed that there will be underinvestment in security.
    We first show that this reasoning is incomplete because of another first-order economic force:
security investments are also strategic substitutes. In a general (non-symmetric) network, this im-
plies that underinvestment by some agents will encourage overinvestment by others. We demon-
strate by means of examples that not only can there be overinvestment by some agents but also
aggregate probabilities of infection can be lower in equilibrium compared to the social optimum.
    The bulk of the paper provides a detailed characterization of investment decisions over gen-
eral networks and sufficient conditions for underinvestment. Our results here rely on a new and
tractable decomposition of the probability of infection of an individual into an own and an exter-
nality effect. Using this result, we show that there will be equilibrium underinvestment when (1)
networks are locally tree-like, symmetric or comprised of sparsely connected islands of symmet-
ric networks; (2) cost functions are sufficiently convex, which guarantee that when an agent faces
a higher likelihood of being infected because of others’ choices, his or her investment does not
increase so much as to reduce her overall probability of infection.
    We also characterize the impact of network structure on equilibrium and optimal investments.
    Finally, we also extend our analysis to an environment with strategic attacks, where the attacker
chooses a probability distribution over the location of the attack in order to maximize damage. We


                                                       23
first relate probabilities of infection under strategic attacks to those under random attacks, and
then provide sufficient conditions for over and underinvestment in this case. The intuition for
overinvestment in this case is simple: greater investment by an agent shifts the attack to other
parts of the network.
   We view our paper as a first step towards a systematic analysis of contagion over networks
in the presence of precautionary behavior and security investments. Obvious next steps include
more dynamic models and models in which contagion takes different forms reflecting different
economic forces (e.g., resulting from the bankruptcy of a financial institution indebted to others as
in Acemoglu, Ozdaglar and Tahbaz-Salehi, 2013).


References
 [1] D. ACEMOGLU, A. OZDAGLAR, and A. TAHBAZ-SALEHI, “Systemic risk and stability in
     financial networks,” NBER working paper, National Bureau of Economic Research, 2013.

 [2] R. ANDERSON and T. MOORE, “The economics of information security,” Science, vol. 314,
     no. 5799, pp. 610–613, 2006.

 [3] M. BACCARA and H. BAR-ISAAC, “How to organize crime,” Review of Economic Studies,
     vol. 75, no. 4, pp. 1039–1067, 2008.

 [4] Y. BACHRACH, M. DRAIEF, and S. GOYAL, “Competig for security,” working paper, 2012.

 [5] V. BALA and S. GOYAL, “A noncooperative model of network formation,” Econometrica,
     vol. 68, no. 5, pp. 1181–1230, 2000.

 [6] L. BLUME, D. EASLEY, J. KLEINBERG, R. KLEINBERG, and E. TARDOS, “Network forma-
     tion in the presence of contagious risk,” in 12th ACM conference on Electronic commerce, pp. 1–
     10, 2011.

 [7] D. L. BRITO, E. SHESHINSKI, and M. D. INTRILIGATOR, “Externalities and compulsary
     vaccinations,” Journal of Public Economics, vol. 45, no. 1, pp. 69 – 90, 1991.

 [8] F. CHUNG and L. LU, “Connected components in random graphs with given expected degree
     sequences,” ANNALS OF COMBINATORICS, vol. 6, no. 2, pp. 125–145, 2002.

 [9] D. DE MEZA and J. R. GOULD, “The social efficiency of private decisions to enforce property
     rights,” Journal of Political Economy, vol. 100, no. 3, pp. 561–80, 1992.

[10] P. GEOFFARD and T. PHILLIPSON, “Disease eradication: Private versus public vaccination,”
     American Economic Review, vol. 87, no. 1, pp. 222–30, 1997.

[11] S. M. GOLDMAN and J. LIGHTWOOD, “Cost optimization in the SIS model of infectious
     disease with treatment,” working paper, University of California at Berkeley, 1995.

                                                   24
[12] B. GOLUB and M. JACKSON, “How homophily affects the speed of learning and best-
    response dynamics,” The Quarterly Journal of Economics, vol. 127, no. 3, 2012.

[13] S. GOYAL and A. VIGIER, “Robust networks,” Mimeo, Cambridge University, 2011.

[14] S. GOYAL and A. VIGIER, “Social interaction, vaccination, and epidemics,” working paper,
    2013.

[15] B. HOYER and K. D. JAEGHER, “Strategic network disruption and defense,” working paper,
    Utrecht School of Economics, 2010.

[16] M. O. JACKSON, Social and Economic Networks. Princeton University Press, 2008.

[17] M. JACKSON and A. WOLINSKY, “A strategic model of social and economic networks,”
    Journal of Economic Theory, vol. 71, no. 1, pp. 44 – 74, 1996.

[18] D. KOVENOCK and B. ROBERSON, “The optimal defense of networks of targets,” working
    paper, 2010.

[19] N. LARSON, “Network security,” MPRA paper, University Library of Munich, Germany,
    2011.

[20] M. MOLLOY and B. REED, “The size of the giant component of a random graph with a given
    degree sequence,” Combinatorics, Probability and Computing, vol. 7, pp. 295–305, 1998.

[21] M. MOLLOY and B. REED, “A critical point for random graphs with a given degree se-
    quence,” Random Structures and Algorithms, no. 6, pp. 161–180, 2000.

[22] M. E. J. NEWMAN, S. H. STROGATZ, and D. J. WATTS, “Random graphs with arbitrary
    degree distributions and their applications,” Physical Review E, vol. 64, p. 026118, 2001.

[23] J. L. SANDERS, “Quantitative guidelines for communicable disease control programs,” Bio-
    metrics, vol. 27, no. 4, pp. 883–893, 1971.

[24] S. P. SETHI, “Quantitative guidelines for communicable disease control program: A complete
    synthesis,” Biometrics, vol. 30, no. 4, pp. 681–691, 1974.

[25] F. TOXVAERD, “Foundations of strategic epidemiology: Recurrent infection and treatment,”
    working paper, 2009.

[26] VEGA-REDONDO, Complex Social Networks. Cambridge University Press, 2007.




                                                  25
A     Appendix
A.1    Background Material

Theorem A.1 (Frieze, Krivelevich, Martin 2003). Let G be a d− regular graph with λ = o(d). Let Gp
           α
with p =   d   be obtained from G by including each edge with probability p. If α < 1, with high probability
the maximum component size of Gp is O(log(n)).
Theorem A.2 (Bernstein Polynomials). The n + 1 Bernstein basis polynomials of degree n are defined as
bν,n (x) = nν xν (1 − x)n−ν , ν = 0, . . . , n.
             


    Let f be a continuous function on the interval [0, 1]. Consider the Bernstein polynomial

                                                     n    
                                                     X    ν
                                        Bn (f )(x) =   f     bν,n (x).
                                                          n
                                                         ν=0

Then we have,
                                             lim Bn (f )(x) = f (x)
                                             n→∞

uniformly on the interval [0, 1].
Theorem A.3 (Hoeffding’s Inequality). Let Z1 , . . . , Zn be independent, identically distributed random
variables, such that 0 ≤ Zi ≤ 1. Then,
                                                         
                                           n
                                         1 X                        2
                                    Pr      Zi − E[Z] >  ≤ 2e−2n .
                                         n
                                            i=1




A.2    Proofs of Section 3: Random Attack Model

Proof of Proposition 3.1 (Network Effect). Agent i gets infected only if i is susceptible. Let (Xi )
denote the event that agent i is susceptible. The infection probability of i can be stated as,

                                    Pi (A, q, Φ) = Pi (A, q, Φ|(Xi ))(1 − qi ).                                                          (A.1)

We next show that Pi (A, q, Φ|(Xi )) does not depend on qi . By definition, in a given transmission
                                                                              At
network At , i gets infected if s is connected to i in At . Let i −→ j denote the event that i is connected
to j in At . Using this definition, the infection probability of i conditional on (Xi ) can be written as
                                        X
           Pi (A, q, Φ|(Xi )) =                      P(A,q) (At |(Xi ))
                                             At
                                  {At |s∈At ∩i−→s}
                                        X                          X                                Y                     Y
                              =                                                          P(Ar )               (1 − qj )           qj ,
                                             At      {Ar ,V   s ⊆V   |At =Ar [V   s ]}            j∈Vs j6=i               j6∈Vs
                                  {At |s∈At ∩i−→s}



                                                              26
where the second equality follows from the definition of the probability of the transmission net-
work and the fact that conditional on (Xi ), i ∈ Vs with probability 1. This shows that Pi (A, q, Φ|(Xi ))
is independent of qi . Substituting Pi (A, q, Φ|(Xi )) with P̃i (A, q−i , Φ) in Eq. (A.1) we obtain

                                         Pi (A, q, Φ) = (1 − qi )P̃i (A, q−i , Φ).




Proof of Proposition 3.2 (Decomposition). As in the previous proof, let (Xi ) denote the event that
                                    At
agent i is susceptible and i −→ j denote the event that i is connected to j in At . In the given
network A, denote the seed node by s. In the transmission network At ∼ (A, q), for two agents j
and i with i 6= j, one of the following mutually exclusive events will happen:

 (A) s is connected to j in At−i .

 (B) s is not connected to j in At −i , but is connected to j in At .

 (C) s is not connected to j in At .

Agent j gets infected if event (A) or (B) happens. We next express infection probability of agent j
                                                                           A
as the sum of probabilities of events (A) and (B). Let i −
                                                         → j denote the event that i is connected to
j in A. Also, let Aj denote the collection of transmission networks in which j is connected to s, i.e.,
                       At
Aj = {At ∼ (A, q)|j −→ s}. The infection probability of agent j can be written as
                    X                              X                                           X
  Pj (A, q, Φ) =            P(A,q) (At ) =                       P(A,q) (At ) +                                       P(A,q) (At ),   (A.2)
                   At ∈Aj                    {At |At−i ∈Aj−i }                      {At |At−i 6∈Aj−i       At ∈Aj }
                                                                                                       T



where the first term is the probability of event (A) and the second term is the probability of event
(B).
   We first show that the first term in Eq. (A.2) can be written as
                                          X
                                                      P(A,q) (At ) = Pj (A−i , q−i , Φ).                                              (A.3)
                                  {At |At−i ∈Aj−i }


By definition
                                                                  X
                                 Pj (A−i , q−i , Φ) =                          P(A−i ,q−i ) (Āt ).                                   (A.4)
                                                           {Āt |Āt ∈Aj−i }


The probability of the transmission network Āt generated from (A−i , q−i ) can be written as the
marginal probability of the transmission network At that satisfies At−i = Āt , i.e.,
                                                                      X
                                    P(A−i ,q−i ) (Āt ) =                       P(A,q) (At ).
                                                            {At |At−i =Āt }


                                                                 27
Combining the preceding relation with Eq. (A.4), we obtain
                                                 X                X                                         X
              Pj (A−i , q−i , Φ) =                                              P(A,q) (At ) =                         P(A,q) (At ),
                                                                   t
                                            {Āt |Āt ∈Aj−i } {At |A−i =Āt }                      {At |At−i ∈Aj−i }


which shows the desired result.
   We next rewrite the second term in Eq. (A.2), i.e., probability of event (B) by conditioning it on
the event that i and j are susceptible:
            X                                                                         X
                                   P(A,q) (At ) = (1 − qi )(1 − qj )                                        P(A,q) (At |(Xi ) ∩ (Xj )). (A.5)
 {At |At−i 6∈Aj−i       At ∈Aj }                                          {At |At−i 6∈Aj−i       At ∈Aj }
                    T                                                                        T



Let Qj,i () be the function that represents the probability of event (B) conditional on the event
(Xi ) ∩ (Xj ). Clearly, {At |At 6∈Aj ∩At ∈Aj } P(A,q) (At |(Xi ) ∩ (Xj )) only depends on q−{i,j} and A
                       P
                                            −i    −i
and is independent of qi and qj . Hence, Qj,i () is a function of A, q−{i,j} , and Φ. Hence, it can be
expressed as Qj,i (A, q−{i,j} , Φ). Combining the preceding relation with Eqs. (A.2),(A.3), and (A.5)
and using Proposition 3.1, we obtain

                        Pj (A, q, Φ) = Pj (A−i , q−i , Φ) + (1 − qi )(1 − qj )Qj,i (A, q−{i,j} , Φ)
                                                                                                    
                                     = (1 − qj ) P̃j (A−i , q−i , Φ) + (1 − qi )Qj,i (A, q−{i,j} , Φ) .

By applying Proposition 3.1 to the preceding equation, we obtain

                                         Pj (A, q, Φ)
              P̃j (A, q−j , Φ) =                      = P̃j (A−i , q−{i,j} , Φ) + (1 − qi )Qj,i (A, q−{i,j} , Φ).
                                            1 − qj

which shows the desired result.

Proof of Proposition 3.3. (a) Network Effect Monotonicity in Security Profile We first show that
       given network A and two security profiles q−i and q̂−i with q−i ≥ q̂−i , we have P̃i (A, q−i , Φ) ≤
       P̃i (A, q̂−i , Φ).
       Let V̂ denote the set of agents with strictly higher security levels in the security profile q
       compared to q̂, i.e., V̂ = {v ∈ V−i | qv > q̂v }. We prove the claim by induction on |V̂ |. The
       base case is immediate: If |V̂ | = 0, then qv = q̂v for all v ∈ V−i . Hence, P̃i (A, q−i , Φ) =
       P̃i (A, q̂−i , Φ).
       We next assume that for an integer m > 0, if |V̂ | = m, the claim holds, i.e., P̃i (A, q−i , Φ) ≤
       P̃i (A, q̂−i , Φ) (Induction Hypothesis). We will next prove that the claim still holds if |V̂ | =
       m + 1. Consider an arbitrary agent 1 ∈ V̂ . Define a new security profile q̃ such that q̃v = qv
       for all v 6= 1, and q̃1 = q̂1 . Note that q−i and q̃−i only differ in the security level of agent 1.
       We first show that P̃i (A, q−i , Φ) ≤ P̃i (A, q̃−i , Φ). Using Proposition 3.2 (with the identifica-



                                                                        28
     tion j = i and i = 1), we can rewrite P̃i (A, q−i , Φ) as

            P̃i (A, q−i , Φ) = P̃i (A−1 , q−{1,i} , Φ) + Qi,1 (A, q−{i,1} , Φ)(1 − q1 )
                            ≤ P̃i (A−1 , q−{1,i} , Φ) + Qi,1 (A, q−{i,1} , Φ)(1 − q̃1 )
                            = P̃i (A−1 , q̃−{1,i} , Φ) + Qi,1 (A, q̃−{i,1} , Φ)(1 − q̃1 ) = P̃i (A, q̃−i , Φ).   (A.6)

     The inequality follows from q̃1 = q̂1 < q1 and the last equality follows from q̃j = qj for all
     j 6= 1.
     We next compare P̃i (A, q̃−i , Φ) with P̃i (A, q̂−i , Φ). First note that q̃ ≥ q̂. Moreover, we have
     |{j ∈ V−i | q̃j > q̂j }| = m. By induction hypothesis, it implies that



                                             P̃i (A, q̃−i , Φ) ≤ P̃i (A, q̂−i , Φ).                              (A.7)

     Combining Eqs. (A.6) and (A.7), we obtain P̃i (A, q−i , Φ) ≤ P̃i (A, q̂−i , Φ).

(b) Network Effect Monotonicity in Network Density We show that given V̂ ⊂ V and agent i ∈
     V − V̂ , P̃i (A−V̂ , q−V̂ ∪{i} , Φ) ≤ P̃i (A, q−i , Φ). Using Proposition 3.1, we have

                                Pi (A−V̂ , q−V̂ , Φ) = (1 − qi )P̃i (A−V̂ , q−(V̂ ∪{i}) , Φ).


     By definition, P̃i (A−V̂ , q−(V̂ ∪{i}) , Φ) is the probability of infection reaching agent i in A−V̂ .
     Consider a transmission network Āt generated from (A−V̂ , q−V̂ ) in which infection can reach
     agent i. The probability of the transmission network Āt can be written as the marginal prob-
     ability of the transmission networks At generated from (A, q) that satisfies At−V̂ = Āt . Fur-
     thermore, in any transmission network At that satisfies At−V̂ = Āt , infection can reach agent
     i. Hence, the probability of infection reaching agent i in a transmission network generated
     from (A, q) is at least P̃i (A−V̂ , q−(V̂ ∪{i}) , Φ). In other words,

                                        P̃i (A−V̂ , q−V̂ ∪{i} , Φ) ≤ P̃i (A, q−i , Φ).


(c) Best Response Monotonicity in Network Effect Given network A and security profiles q−i
     and q̂−i , if P̃i (A, q−i , Φ) ≥ P̃i (A, q̂−i , Φ), then Bi (q−i ) ≥ Bi (q̂−i ). Using Eq. 3.2, it implies
     that
                           c0i (Bi (q−i )) = P̃i (A, q−i , Φ) ≥ P̃i (A, q̂−i , Φ) = c0i (Bi (q̂−i )).

     Combining the preceding inequality with Assumption 1, it follows that Bi (q−i ) ≥ Bi (q̂−i )
     which shows the desired result.




                                                          29
Proof of Eq. (3.4). Let Bi (q−i ) and Si (q−i ) denote the best response strategy and welfare maximiz-
ing strategy of agent i. We show that Bi (q−i ) ≤ Si (q−i ). Using Eq. 3.2, we have

                                          c0i (Bi (q−i )) = P̃i (A, q−i , Φ).

Moreover, it follows from Eq. 3.3 that
                                                              X
                      c0i (Si (q−i )) = P̃i (A, q−i , Φ) +           Qj,i (A, q−{i,j} , Φ)(1 − qj ).
                                                              j6=i


By definition, Qj,i (A, q−{i,j} , Φ)(1 − qj ) is a probability. Therefore,
                                         X
                    P̃i (A, q−i , Φ) +          Qj,i (A, q−{i,j} , Φ)(1 − qj ) ≥ P̃i (A, q−i , Φ),
                                         j6=i


implying that c0i (Si (q−i )) ≥ c0i (Bi (q−i )). The claim follows by the assumption that ci () is strictly
convex (cf. Assumption 1), and therefore c0i () is a strictly increasing function.



A.3    Proofs of Subsection 3.3: Symmetric Networks

Proof of Theorem 3.2.

Existence of the symmetric pure-strategy Nash equilibrium We show that there exists a q e ∈ [0, 1]
      such that u(A, q, Φ) achieves its maximum at q = qen . Due to symmetry, we have

                               ∂                     ∂
                                  u(A, q, Φ)|q=qn =     u(A, q, Φ)|q=qn ∀ i, j ∈ V.                    (A.8)
                              ∂qi                   ∂qj

      Let

                                                            ∂
                                                 f (x) =       u(A, q, Φ)|q=xn .
                                                           ∂qj

      We next show that, f (x) is a decreasing function in x.
      The continuity and differentiability of u(A, qn , Φ) follows from Propositions 3.1, 3.2 and As-
      sumption 1. By definition,

                                 u(A, qn , Φ) = 1 − (1 − q)P̃ (A, qn−1 , Φ) − c(q).

      Hence,

                                                f (q) = P̃ (A, qn−1 , Φ) − c0 (q).

      Using Proposition 3.3(a), we have P̃ (A, qn−1 , Φ) is a decreasing function in q. Also by As-

                                                            30
      sumption 1, c0 (q) is continuous and strictly increasing, which shows that f (q) is strictly de-
      creasing in q. We next show that, there exists a unique q e ∈ (0, 1) such that f (q e ) = 0. Using
      Assumption 1 and the inequality 0 ≤ P̃ (A, qn−1 , Φ) ≤ 1 , it is guaranteed that f (0) ≥ 0 and
      f (1) < 0. Therefore, there exists a unique q e such that f (q e ) = 0. As a result, using Eq. (A.8),
      qen is the unique symmetric equilibrium.

Underinvestment in the symmetric equilibrium We next show that in the symmetric equilibrium,
      q e ≤ q s . For the sake of contradiction, assume q e > q s . We next show that under this as-
      sumption, we have c0 (q s ) ≥ c0 (q e ). Using Eqs. (3.2), (3.3), and the fact that P̃ (A, qn−1 , Φ) is
      decreasing in q, the following relations hold.

                                                                            ∂
                              c0 (q s ) = P̃ (A, qsn−1 , Φ) − (1 − q s )        P̃ (A, qsn−1 , Φ)
                                                                           ∂q s
                                      ≥ P̃ (A, qsn−1 , Φ)
                                      ≥ P̃ (A, qen−1 , Φ)
                                      = c0 (q e ),

      where the second inequality follows from Proposition 3.3(a). Nevertheless, Assumption 1
      implies that c0 (q e ) > c0 (q s ) assuming q e > q s . This contradicts the preceding inequality,
      completing the proof.




A.4   Proofs of Section 4: Sufficiently Convex Cost Functions

Proof of Lemma 4.1. Since q−i and q̂−i satisfy P̃i (A, q−i , Φ) ≥ P̃i (A, q̂−i , Φ), it follows from Propo-
sition 3.3 (c) that Bi (q−i ) ≥ Bi (q̂−i ). Using Proposition 3.1 and the characterization of the best
response strategy of an agent given in Eq. (3.2), we obtain

         Pi (A, (Bi (q−i ), q−i ), Φ) = P̃i (A, q−i , Φ)(1 − Bi (q−i )) = c0i (Bi (q−i ))(1 − Bi (q−i )).

Similarly, we have
                          Pi (A, (Bi (q̂−i ), q̂−i ), Φ) = c0i (Bi (q̂−i ))(1 − Bi (q̂−i )).

Since ci is sufficiently convex (cf. Assumption 2) and Bi (q−i ) ≥ Bi (q̂−i ), we have

                         c0i (Bi (q−i ))(1 − Bi (q−i )) ≥ c0i (Bi (q̂−i ))(1 − Bi (q̂−i )),

which using the preceding relations implies

                          Pi (A, (Bi (q−i ), q−i ), Φ) ≥ Pi (A, (Bi (q̂−i ), q̂−i ), Φ).



                                                         31
                                         Figure 5: Tree uniqueness




Proof of Theorem 4.1. Assume to arrive at a contradiction that we have two different equilibrium
security profiles qe and q̂e . Using qe and q̂e , we can partition the nodes into three sets V1 , V2 and
V3 as follows:

                                            qie > q̂ie for all i ∈ V1 ,
                                            qie = q̂ie for all i ∈ V2 ,
                                            qie < q̂ie for all i ∈ V3 .

       We first show that the sets V1 and V3 are non-empty. Assume the contrary and suppose V3 is
empty. This implies that qe ≥ q̂e . Moreover, since qe 6= q̂e , there exists an agent i ∈ V1 with
qie > q̂ie . Since q−i
                    e ≥ q̂ e , Proposition 3.3(a) implies that P̃ (A, qe , Φ) ≤ P̃ (A, q̂e , Φ). Using
                          −i                                     i     −i         i      −i
Proposition 3.3(c), it follows that qie = Bi (qe−i ) ≤ Bi (q̂e−i ) = q̂ie , yielding a contradiction. A similar
argument can be used to show that the set V1 is nonempty.
       For the rest of the proof, we use the notation L(i) to denote the set Vj , j = 1, 2, 3, that node i
belongs to, i.e., L(i) = Vj if and only if i ∈ Vj . Furthermore, we define the tree order with respect to
a node r as the partial order on the nodes of a tree with u < v if and only if the unique path from r
to v passes through u. For a tree order (with respect to an arbitrary node r), it follows immediately
that there exists an edge (x, y) ∈ E such that (a) L(x) 6= L(y), x < y, and (b) For all v 0 ∈ V such
that y < v 0 , we have L(y) = L(v 0 ). Let Y = {v ∈ V | v > y}.13
  13
   Since both V1 and V3 are non-empty, there always exists an edge (x, y) with L(x) 6= L(y) and x < y: among these
edges, pick the one with the largest distance from r.




                                                        32
       Assume without loss of generality that x ∈ V1 and y ∈ V3 , i.e.,14

                                 qxe > q̂xe ,      qye < q̂ye ,        qve < q̂ve   for all v ∈ Y.

Hence, agent x invests more in security in qe than in q̂e , and agent y and agents in set Y invest
in more security in q̂e than in qe . This is illustrated in Fig. 5. Using the sufficiently convex cost
assumption (cf. Assumption 2) and Lemma 4.1, we have

                                                Px (A, qe , Φ) > Px (A, q̂e , Φ),                     (A.9)
                                                Py (A, qe , Φ) < Py (A, q̂e , Φ).                    (A.10)

       In view of the tree network structure, we can decompose infection probability of agents x and
y using the network effect on x when y is removed from the network and the network effect on y
when x is removed from the network. More specifically, let P̂x and P̂y denote infection probabilities
of agents x and y when agents y and x are removed from the network respectively, i.e.,

                                         P̂x (q) = P̃x (A−y , q−{x,y} , Φ)(1 − qx ),
                                         P̂y (q) = P̃y (A−x , q−{x,y} , Φ)(1 − qy ).

Using P̂x and P̂y , we can write down infection probabilities of agents x and y as follows:

                                      Px (A, qe , Φ) = Pˆx (qe ) + (1 − qxe )Pˆy (qe ),              (A.11)


                                      Py (A, qe , Φ) = Pˆy (qe ) + (1 − qye )Pˆx (qe ).              (A.12)

Substituting Pˆx (q̂e ) and Pˆy (q̂e ) for Pˆx (qe ) and Pˆy (qe ) in the above equations, we obtain similar
relations for Px (A, q̂e , Φ) and Py (A, q̂e , Φ).
       Since all agents in Y belong to set V3 , it follows from Proposition 3.3(a) that

                                                      Pˆy (qe ) ≥ Pˆy (q̂e ).                        (A.13)

There are two cases to consider:

  (a) Pˆx (qe ) ≥ Pˆx (q̂e ): In this case, using Eqs. (A.12) and (A.13), we obtain Py (A, qe , Φ) ≥
         Py (A, q̂e , Φ), contradicting Eq. (A.10).
  14
       The argument that follows will also hold if we assume one of these agents belong to V2 .




                                                                  33
  (b) Pˆx (qe ) < Pˆx (q̂e ): Using Eq. (A.13) and the fact that qxe > q̂xe , we obtain
                                                                            
                              Pˆy (qe ) − Pˆy (q̂e ) ≥ Pˆy (qe ) − Pˆy (q̂e ) (1 − q̂xe )

                                                   ≥ Pˆy (qe )(1 − qxe ) − Pˆy (q̂e )(1 − q̂ex ).                   (A.14)

      Furthermore, since Pˆx (qe ) < Pˆx (q̂e ) and qye < q̂ye , we obtain
                                                                                           
                        Pˆx (qe )(1 − qye ) − Pˆx (q̂e )(1 − q̂ye ) ≥ Pˆx (qe ) − Pˆx (q̂e ) (1 − q̂ye )

                                                                  ≥ Pˆx (qe ) − Pˆx (q̂e ).                         (A.15)

      Combining Eqs. (A.14) and (A.15), we have

                            (Pˆy (qe ) + Pˆx (qe )(1 − qye )) − (Pˆy (q̂e ) + Pˆx (q̂e )(1 − q̂ye ))
                                            ≥ (Pˆx (qe ) + Pˆy (qe )(1 − qxe )) − (Pˆx (q̂e ) + Pˆy (q̂e )(1 − q̂xe )).

      Using the expressions in Eqs. (A.11) and (A.12), this implies

                       Py (A, qe , Φ) − Py (A, q̂e , Φ) ≥ Px (A, qe , Φ) − Px (A, q̂e , Φ) ≥ 0,

      where the last inequality follows from Eq. (A.9) and yields a contradiction.



Proof of Lemma 4.2. We first show the following stronger statement: Given tree network A and
set V̄ ⊂ V , for any i, j ∈ V − V̄ , we have

                               Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ) ≤ Qj,i (A, q−{j,i} , Φ).                               (A.16)

   Given tree network A, one of the following mutually exclusive events happens:

 (A) The unique path between s (seed node) and j in the tree network includes i.

 (B) The unique path between s and j in the tree network does not include i.

   If event (B) happens, the probability that infection reaches j stays unchanged after i is removed
from the tree in both A and A−V̄ which implies

                       Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(B)) = Qj,i (A, q−{j,i} , Φ|(B)) = 0.                           (A.17)

   Suppose next that event (A) happens.
We denote the unique path between s and j by s, v1 , v2 , . . . , vk = i, . . . , vm = j. Node j gets infected
in A if and only if for all 1 ≤ i ≤ m, vi is susceptible. However, in A−V̄ , j gets infected if and only


                                                          34
if for all 1 ≤ i ≤ m, vi is susceptible and vi 6∈ V̄ . Hence,

                                 Pj (A, q, Φ|(A)) ≥ Pj (A−V̄ , q−V̄ , Φ|(A)).

Furthermore, we have

                        Pj (A, q, Φ|(A)) = (1 − qj )(1 − qi )Qj,i (A, q−{j,i} , Φ|(A)),

                  Pj (A−V̄ , q−V̄ , Φ|(A)) = (1 − qj )(1 − qi )Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(A)).

   Combining the preceding relations with Eq. (A.17), we obtain

              Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ) = Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(A))P ((A))
                                                       1
                                            =                    Pj (A−V̄ , q−V̄ , Φ|(A))P ((A))
                                              (1 − qi )(1 − qj )
                                                       1
                                            ≤                    Pj (A, q, Φ|(A))P ((A))
                                              (1 − qi )(1 − qj )
                                            = Qj,i (A, q−{j,i} , Φ|(A))P ((A))
                                           = Qj,i (A, q−{j,i} , Φ),

completing the proof of Eq. (A.16). Combining this result with Eq. (4.2) and Proposition 3.3(b), we
obtain
                                                    X
         CI (i, A) = (1 − qi )(P̃i (A, q−i , Φ) +           (1 − qj )Qji (A, q−{i,j} , Φ))
                                                    j∈V−i
                                                                  X
                  ≥ (1 − qi )(P̃i (A−V̄ , q−V̄ ∪{i} , Φ) +               (1 − qj )Qji (A, q−{i,j} , Φ))
                                                                 j∈V−i
                                                                    X
                  ≥ (1 − qi )(P̃i (A−V̄ , q−V̄ ∪{i} , Φ) +                     (1 − qj )Qji (A−V̄ , q−V̄ ∪{i,j} , Φ))
                                                                 j∈V−V̄ ∪{i}

                  = CI (i, A−V̄ ),

which shows the desired result.

Proof of Theorem 4.2. If qs > qe then by using Propositions 3.1 and 3.3(a), we have Pi (A, qs , Φ) <
Pi (A, qe , Φ) for all i ∈ V implying that I(A, qs , Φ) ≤ I(A, qe , Φ). Otherwise, let V1 = {i ∈ V | qis ≤
qie }, i.e., V1 is the set of agents that overinvest compared to the social optimum. We first provide
a recursive characterization of expected infections in a given network A, using the decomposition
result presented in Proposition 3.2.

Lemma A.1. Given network A and security profile q, the expected total number of infected people satisfies




                                                            35
the following: for all V̄ ⊂ V and i ∈ V − V̄ ,

                         I(A−V̄ , q−V̄ , Φ) = CI (i, A−V̄ ) + I(A−V̄ ∪{i} , q−V̄ ∪{i} , Φ),

where CI (i, A−V̄ ) is the contribution of agent i to infection in network A−V̄ .

Proof of Lemma A.1. The expected infections in a network A−V̄ for a security profile q−V̄ , can be
stated as
                                                              X
                                   I(A−V̄ , q−V̄ , Φ) =                Pj (A−V̄ , q−V̄ , Φ).
                                                            j∈V −V̄


    Using Proposition 3.2, we have


                                    X
            I(A−V̄ , q−V̄ , Φ) =             Pj (A−V̄ , q−V̄ , Φ)
                                   j∈V −V̄
                                                                   X
                              = Pi (A−V̄ , q−V̄ , Φ) +                       Pj (A−V̄ , q−V̄ , Φ)
                                                             j∈V −V̄ ∪{i}
                                                                   X
                              = Pi (A−V̄ , q−V̄ , Φ) +                      (1 − qj )(P̃j (A−V̄ ∪{i} , q−V̄ ∪{i} , Φ)
                                                             j∈V −V̄ ∪{i}

                                             + (1 − qi )Qji (A−V̄ , q−V̄ ∪{i,j} , Φ))
                                                         X
                              = Pi (A−V̄ , q−V̄ , Φ) +            Pj (A−V̄ ∪{i} , q−V̄ ∪{i} , Φ)
                                                             j∈V −V̄ ∪{i}
                                                         X
                                                  +                  (1 − qi )(1 − qj )Qji (A−V̄ , q−V̄ ∪{i,j} , Φ)
                                                      j∈V −V̄ ∪{i}

                              = CI (i, A−V̄ ) + I(A−V̄ ∪{i} , q−V̄ ∪{i} , Φ),

showing the desired result.


    We next present the proof of Theorem 4.2 using Lemma A.1. We first show that given tree
network A, for all V̂ ⊂ V ,
                                                                              X
                                   I(A, q, Φ) ≤ I(A−V̂ , q−V̂ , Φ) +                 CI (v, A).                         (A.18)
                                                                              v∈V̂


The proof is by induction on |V̂ |. If |V̂ | = 1, then by applying Lemma A.1 and setting V̄ = ∅, we
obtain Eq. (A.18).
    Suppose next that Eq. (A.18) holds for all V̂ with |V̂ | = m for an integer m > 1. We will show
that it also holds for V̂ with |V̂ | = m + 1. Consider an agent i ∈ V̂ and let V̂−i = V̂ − {i}. Since



                                                              36
|V̂−i | = m, using induction hypothesis we have
                                                                                X
                          I(A, q, Φ) ≤ I(A−V̂−i , qs−V̂ , Φ) +                          CI (v, A).         (A.19)
                                                                  −i
                                                                               v∈V̂−i


Moreover, using Lemma A.1 and setting V̄ = V̂−i , we obtain

                        I(A−V̂−i , qV̂−i , Φ) = CI (i, A−V̂−i ) + I(A−V̂ , q−V̂ , Φ).                      (A.20)

Using Lemma 4.2, we have

                                         CI (i, A−V̂−i ) ≤ CI (i, A).                                      (A.21)

Putting Eqs. (A.19), (A.20), and (A.21) together shows that Eq. (A.18) holds for the V̂ with |V̂ | =
m + 1 completing the proof of Eq. (A.18).
   Using Eq. (A.18) with V̂ = V1 and setting q = qs , we obtain
                                                                               X
                           I(A, qs , Φ) ≤ I(A−V1 , qs−V1 , Φ) +                        CI (i, A).
                                                                               i∈V1


Since qs is the socially optimal security profile, by Eq. (3.3) we have
                                   X                      X
                                         CI (i, A) =               c0i (qis )(1 − qis ).
                                  i∈V1                    i∈V1


Combining the preceding relations, we obtain
                                                                            X
                        I(A, qs , Φ) ≤ I(A−V1 , qs−V1 , Φ) +                       c0i (qis )(1 − qis ).   (A.22)
                                                                            i∈V1


   Moreover, for the equilibrium security profile qe , using Eq. (3.2) and Proposition 3.3(b), we
obtain
                                         X                                  X
                       I(A, qe , Φ) =          Pv (A, qe , Φ) +                      Pv (A, qe , Φ)
                                        v∈V1                              v∈V −V1
                                         X                                    X
                                    =          c0v (qve )(1 − qve ) +                   Pv (A, qe , Φ)
                                        v∈V1                                v∈V −V1
                                         X
                                    ≥          c0v (qve )(1   −   qve )   + I(A−V1 , qe−V1 , Φ).           (A.23)
                                        v∈V1


   Using the sufficiently convex cost assumption and the fact that qie > qis for all i ∈ V1 , it follows




                                                          37
that
                                    X                               X
                                           c0i (qis )(1 − qis ) <          c0i (qie )(1 − qie ).            (A.24)
                                    i∈V1                            i∈V1


Moreover, since qie ≤ qis for all i ∈ V − V1 , Proposition 3.3(b) implies

                                     I(A−V1 , qs−V1 , Φ) ≤ I(A−V1 , qe−V1 , Φ).                             (A.25)

Combining Eqs. (A.22), (A.23), (A.24), and (A.25) we obtain
                                                                               X
                            I(A, qs , Φ) ≤ I(A−V1 , qs−V1 , Φ) +                     c0i (qis )(1 − qis )
                                                                              i∈V1
                                                                               X
                                            ≤ I(A−V1 , qe−V1 , Φ) +                  c0i (qie )(1 − qie )
                                                                              i∈V1
                                                        e
                                            ≤ I(A, q , Φ),

completing the proof of Theorem 4.2.


A.5    Proofs of Section 5

Before providing the proof of Theorem 5.1, we first extend the decomposition property (i.e., Propo-
sition 3.2) and Lemma A.1 for acyclic components of a network. We then use the same line of
argument as Theorem 4.2, to prove Theorem 5.1.


   We use the following notation in the rest of this section. Given random network A, for each
agent v, let (DvA ) be the event that the attached connected component to v in Ar ∼ A is acyclic and
(OvA ) be the event that the attached connected component to v in Ar has a cycle. Let P ((DvA )) and
P ((OvA )) be the probability of these events.
   Using Proposition 3.2, one can easily show that

Lemma A.2. Given network A and two nodes i and j in A, we have,

       P̃j (A, q−j , Φ|(DjA )) = P̃j (A−i , q−{i,j} , Φ|(DjA )) + (1 − qi )Qj,i (A, q−{i,j} , Φ|(DjA )),    (A.26)

where Qj,i (A, q−{i,j} , Φ|(DjA )) is the probability that infection reaches agent j only through a path that
contains agent i conditional on i being susceptible and event (DjA ) happens.

   We next extend Lemma A.1.




                                                              38
Lemma A.3. Given network A and security profile q, we have: For all V̄ ⊂ V and i ∈ V − V̄ ,
     X
              Pv (A−V̄ , q−V̄ , Φ|(DvA ))P ((DvA ))
   v∈V −V̄
                                                                X
                   = CI (i, A−V̄ |(DiA ))P ((DiA )) +                      Pv (A−V̄ ∪{i} , q−V̄ ∪{i} , Φ|(DvA ))P ((DvA )),
                                                            v∈V −V̄ ∪{i}
                                                                                                                         (A.27)

where,

  CI (i, A−V̄ |(DiA ))
                                                                     X
             = (1 − qi )(P̃i (A−V̄ , q−V̄ ∪{i} , Φ|(DiA )) +                    (1 − qj )Qji (A−V̄ , q−V̄ ∪{i,j} , Φ|(DiA ))).
                                                                 j∈V −V̄ ∪{i}


Proof. Given network A−V̄ and security profile q−V̄ , by using Lemma A.2, we have
         X
               Pv (A−V̄ , q−V̄ , Φ|(DvA ))P ((DvA ))
    v∈V −V̄
              X
     =                    Pj (A−(V̄ ∪{i}) , q−(V̄ ∪{i}) , Φ|(DjA ))P ((DjA )) + Pi (A−V̄ , q−V̄ , Φ|(DiA ))P ((DiA ))
         j∈V −(V̄ ∪{i})
                                    X
               + (1 − qi )                   (1 − qj )Qj,i (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DjA ))P ((DjA ))
                             j∈V −(V̄ ∪{i})

     = (1 − qi )P̃i (A−V̄ , q−V̄ , Φ|(DiA ))P ((DiA ))
                              X
           + (1 − qi )                 (1 − qj )Qj,i (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DjA ))P ((DjA ))
                             j∈V −(V̄ ∪{i})
                       X
               +                    Pj (A−(V̄ ∪{i}) , q−(V̄ ∪{i}) , Φ|(DjA ))P ((DjA )).                                 (A.28)
                   j∈V −(V̄ ∪{i})


Using Lemma A.3, we obtain

   CI (i, A−V̄ |(DiA ))
                                                                X
    =(1 − qi )(P̃i (A−V̄ , q−(V̄ ∪{i}) , Φ|(DiA )) +                        (1 − qj )Qji (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DiA ))).
                                                           j∈V −(V̄ ∪{i})


We next show that
                           X
                                      (1 − qj )Qji (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DiA ))P ((DiA ))
                     j∈V −(V̄ ∪{i})
                                        X
                              =                  (1 − qj )Qji (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DjA ))P ((DjA )).               (A.29)
                                    j∈V −(V̄ ∪{i})


                                                           Ar
In the interaction network Ar ∼ A, either i −
                                            6 −→ j, in which case infection can not reach i through

                                                                39
       Ar
j, or i −−→ j, which implies that i and j belong to the same connected component. In this case, the
event (DiA ) happens if and only if the event (DjA ) happens. Hence,

      Qji (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DjA ))P ((DjA )) = Qji (A−V̄ , q−(V̄ ∪{i,j}) , Φ|(DiA ))P ((DiA )).   (A.30)

Combining Eqs. (A.28), (A.29), and (A.30) we obtain Eq. (A.27), completing the proof.

    Finally, we extend Lemma 4.2 for acyclic components.
Lemma A.4. Given network A and security profile q, CI (i, A|(DiA )) ≥ CI (i, A−V̄ |(DiA )).
Proof of Lemma A.4. We show a stronger statement. We show that for any i, j ∈ V − V̄ ,

                         Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(DiA )) ≤ Qj,i (A, q−{j,i} , Φ|(DiA )).

    Let the random variable s denote the seed node. Conditional on the event (DiA ), one of the
following mutually exclusive event happens:
 (A) The only path between s and j includes i.

 (B) The path(s) between s and j do not include i.
Let P ((A)) and P ((B)) be the probability of each event conditional on the event (DiA ). Note that
P ((A)) + P ((B)) = 1. Therefore,

   Qj,i (A, q−{j,i} , Φ|(DiA )) = Qj,i (A, q−{j,i} , Φ|(A))P ((A)) + Qj,i (A, q−{j,i} , Φ|(B))P ((B)).     (A.31)

If event (B) happens, the probability that infection reaches j through i in both A and A−V̄ is 0. In
other words,

                        Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(B)) = Qj,i (A, q−{j,i} , Φ|(B)) = 0                  (A.32)

We next analyze CI () when event (A) happens. Under this event, we have

                         Pj (A, q, Φ|(A)) = (1 − qj )(1 − qi )Qj,i (A, q−{j,i} , Φ|(A))

Similarly,
                  Pj (A−V̄ , q−V̄ , Φ|(A)) = (1 − qj )(1 − qi )Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(A)).

    Conditional on (A), the path between s and j is unique and includes i. We denote this path by
s, v1 , v2 , . . . , vk = i, . . . , vm = j without loss of generality. Under this event, j gets infected in A if
and only if for all 1 ≤ i ≤ m, vi is susceptible. However, in A−V̄ , j gets infected if and only if for
all 1 ≤ i ≤ m, vi is susceptible and vi 6∈ V̄ . Hence,

                                  Pj (A, q, Φ|(A)) ≥ Pj (A−V̄ , q−V̄ , Φ|(A)).                             (A.33)


                                                         40
Combining Eqs. (A.31), (A.32), and (A.33), we obtain

                                                                  1
                 Qj,i (A−V̄ , q−V̄ ∪{j,i} , Φ|(DiA )) =                      Pj (A−V̄ , q−V̄ , Φ|(A))P ((A))
                                                          (1 − qi )(1 − qj )
                                                                  1
                                                        ≤                    Pj (A, q, Φ|(A))P ((A))
                                                          (1 − qi )(1 − qj )
                                                        = Qj,i (A, q−{j,i} , Φ|(DiA )),

completing the proof.

       Using Lemmas A.2, A.3, and A.4, we next present the proof of the main result of this section.

Proof of Theorem 5.1. The proof of this theorem uses the same line of argument as Theorem 4.2. In
this proof, we analyze expected infections in acyclic components and cyclic components separately.
Let qe be the equilibrium security profile and qs be the socially optimal security profile. If qs > qe ,
then I(A, qs , Φ) ≤ I(A, qe , Φ).
       Otherwise, similar to the previous section, partition the nodes into three sets V1 , V2 and V3 such
that:
                                                
                                                 q s ≤ qie        for all i ∈ V1 ,
                                                
                                                
                                                 i
                                                
                                                
                                                 qie = qis        for all i ∈ V2 ,
                                                
                                                
                                                qis ≥ qie        for all i ∈ V3 .
                                                
                                                


The proof follows a number of steps:

       • We first show that in the equilibrium, expected infections satisfies 15
                                                X                               X
                               I(A, qe , Φ) ≥          c0 (qie )(1 − qie ) +             Pi (A−V1 , qe−V1 , Φ).
                                                i∈V1                           i∈V −V1


       • We then show that in the social optimum, the expected infections is at most
                                             X                               X
                            I(A, qs , Φ) ≤          c0 (qis )(1 − qis ) +             Pi (A−V1 , qs−V1 , Φ) + n.   (A.34)
                                             i∈V1                           i∈V −V1


       • Putting these two steps together, we then conclude that I(A, qs , Φ) ≤ I(A, qe , Φ) + n.

       We first analyze expected infections in the equilibrium. Using a similar argument as Theo-
  15
       The attack decision in Pi (A−V1 , qe−V1 , Φ) is Φ−V1 where Φ is the attack decision of A.




                                                                  41
rem 4.2, we have
                                            X
                        I(A, qe , Φ) =            Pi (A, qe , Φ)
                                            i∈V
                                            X                               X
                                        ≥          c0 (qie )(1 − qie ) +              Pi (A−V1 , qe−V1 , Φ).                 (A.35)
                                            v∈V1                           i∈V −V1


We next present an upper bound for expected infections in the social optimum. By law of total
probability, we obtain
                                 X
                I(A, qs , Φ) =         Pi (A, qs , Φ|(DiA ))P ((DiA )) + Pi (A, qs , Φ|(OiA ))P ((OiA )).                    (A.36)
                                 i∈V

We prove Eq. (A.34) in two steps:
  1. We first show that in a (1 − )-local tree network A, we have
                                             X
                                                   Pv (A, q, Φ|(OvA ))P ((OvA )) ≤ n.
                                             v∈V


  2. We then show that, given random network A, if qs is the socially optimal security profile,
       then the following inequality holds:
       X                                             X                               X
             Pv (A, qs , Φ|(DvA ))P ((DvA )) ≤              c0 (qis )(1 − qis ) +             Pi (A−V1 , qs−V1 , Φ|(DvA ))P ((DvA )).
       v∈V                                           i∈V1                           i∈V −V1


We start by proving the first step and providing an upperbound for expected infections in cyclic
components. For each agent v, by definition of local tree, the probability that v belongs to a cyclic
component is at most . Therefore, the probability that v belongs to a cyclic component and gets
infected is also at most . Summing over all agents v, we have
                               X
                                      Pv (A, q, Φ|(OvA ))P ((OvA )) ≤ nP ((OvA )) = n.                                      (A.37)
                              v∈V

We next analyze expected infections in acyclic components in the social optimum. We show that
for any security profile q and for any V̂ ⊂ V ,
 X
       Pv (A, q, Φ|(DvA ))P ((DvA ))
 v∈V
                             X                                                            X
                        ≤              Pv (A−V̂ , q−V̂ , Φ|(DvA ))P ((DvA )) +                  CI (v, A|(DvA ))P ((DvA )). (A.38)
                            v∈V −V̂                                                      v∈V̂


The proof of Eq. (A.38) follows the same line of the argument used for Eq. (A.18) in Lemma A.1.
The proof is by induction on |V̂ |. If |V̂ | = 1, then by setting V̄ = ∅ and applying Lemma A.3, we
obtain Eq. (A.38). We next assume that for any V̂ , if |V̂ | ≤ m, then Eq. (A.38) holds (Induction

                                                                  42
hypothesis). We then prove that if |V̂ | = m + 1, the statement holds still. Consider an agent i ∈ V̂
and define V̂−i = V̂ − {i}. With a similar argument presented for Eq. (A.18) in Lemma A.1, we
obtain
            X
                  Pv (A, q, Φ|(DvA ))P ((DvA ))
            v∈V
                      X                                                                 X
                  ≤         Pv (A−V̂−i , q−V̂−i , Φ|(DvA ))P ((DvA )) +                           CI (v 0 , A|(DvA0 ))P ((DvA0 ))
                      v∈V                                                             v 0 ∈V̂−i
                      X
                  =         Pv (A−V̂ , q−V̂ , Φ|(DvA ))P ((DvA )) + CI (i, A−V̂ |(DiA ))P ((DiA ))
                      v∈V
                                           X
                                     +                CI (v 0 , A|(DvA0 ))P ((DvA0 ))
                                          v 0 ∈V̂−i
                      X                                                        X
                  ≤         Pv (A−V̂ , q−V̂ , Φ|(DvA ))P ((DvA )) +                     CI (v, A|(DvA ))P ((DvA )).
                      v∈V                                                      v∈V̂

The first inequality follows from the induction hypothesis. The first equation is implied by Lemma A.2
and the second inequality follows from Lemma A.4. Furthermore, using Lemmas 4.1, A.4, Eq. (3.3),
and assuming that c(q) is sufficiently convex, for the socially optimal security profile we have

                                CI (v, A|(DvA ))P ((DvA )) ≤ CI (v, A) = c0 (qvs )(1 − qvs ).                                        (A.39)

Combining Eqs. (A.35), (A.38), and (A.39), we obtain
     X
          Pv (A, qs , Φ|(DvA ))P ((DvA ))                                                                                            (A.40)
    v∈V
                                  X                                                                   X
                            ≤             Pv (A−V1 , qs−V1 , Φ|(DvA ))P ((DvA )) +                           CI (v, A|(DvA ))P ((DvA ))
                                v∈V −V1                                                               v∈V1
                                  X                                                                   X
                            ≤             Pv (A−V1 , qs−V1 , Φ|(DvA ))P ((DvA ))                  +          c0 (qvs )(1 − qvs )
                                v∈V −V1                                                               v∈V1
                                  X                                        X
                                                                                  0
                            ≤             Pv (A−V1 , qe−V1 , Φ)        +          c   (qve )(1    − qve )
                                v∈V −V1                                    v∈V1

                            ≤ I(A, qe , Φ).                                                                                          (A.41)

   The third inequality holds because
  1. For all v ∈ V1 , qvs < qve . Hence, by Lemma 4.1 we have

                                                      c0 (qvs )(1 − qvs ) < c0 (qve )(1 − qve ).


  2. For all v ∈ V − V1 , qvs ≥ qve . Hence, by Proposition 3.3(a), for all v ∈ V − V1 ,

                  Pv (A−V1 , qs−V1 , Φ|(DvA ))P ((DvA )) ≤ Pv (A−V1 , qs−V1 , Φ) ≤ Pv (A−V1 , qe−V1 , Φ).


                                                                     43
By combining the preceding steps we obtain the third inequality. The last inequality was proven
in Eq. (A.35).
   Finally combining Eqs. (A.36), (A.37), and (A.40), we obtain

                                         I(A, qs , Φ) ≤ I(A, qe , Φ) + n,

completing the proof.


A.6   Proofs of Subsection 5.2

In the rest of this section, we denote the component attached to v in the activated network Aa by
                                                        Aa
Aav , i.e., Aav = Aa [V̄ ] such that V̄ = {j ∈ V |j −−→ v}. By Definition 2, the random network gener-
ated from (A, p) has h-local tree structure if the attached component to each agent is acyclic with
                                 (A,p)
probability at least h. Let (Dv          ) be the event that the component attached to v in the activated
                                                                           (A,p)
network from (A, p) is acyclic. Hence, a lower bound on P ((Dv                     )) is also a lower bound on the
h parameter of the local tree structure. Given interaction network Ar ∼ A and an agent v ∈ V , we
                                     (A,p)
obtain a lower bound on P ((Dv               )) via the following steps:

   1. We first introduce an algorithm that specifies the activation order of the edges in multiple
      stages to obtain the activated network Aav .

   2. We then present a recursive computation of the lower bound of having an acyclic component
      attached to v after the kth stage of the algorithm.
                                                                                                               (A,p)
   3. We finally bound the maximum number of stages of the algorithm and consequently P ((Dv                           ))
      for a class of random networks (A, p).

   In order to generate Aav , one can first focus on Ar , and starting from a particular node v, activate
edges independently with probability p. For the sake of analysis, we use the following order on
activating the edges.


Algorithm A.1 (Activation(Ar , p, v)).

   • Initialize C1v = {v}. Initialize k = 1.

   • Initialize C̄ v = ∅. E1a = ∅.

   • While V − Ckv − C̄ v 6= ∅ do

         – For an agent vk0v − C̄ v , activate the edges between v 0 and Ckv in Ar . Denote the set of active edges
           by Ev0 .



                                                          44
                  ∗ If at least one of these edges between v 0 and Ckv are active, then, Ck+1
                                                                                          v   = Ckv ∪{v 0 }, k = k+1,
                     C̄ v = ∅, Eka = Ek−1
                                      a   ∪ Ev0 .
                  ∗ Otherwise, C̄ v = C̄ v ∪ {v 0 }.



       This algorithm (starting from v) considers one node at a time and activates all edges between
that node and all “activated nodes” (i.e., endpoints of all activated edges). The set Ckv contains
activated nodes and the set Eka contains the set of activated edges at the end of stage k.16 The set
C̄ v is used at each stage k, to discover nodes which are one hop away from the set Ckv .
                                                         (Ar ,k)
       Let Ar,k   v    a
            v = (Ck , Ek ) and let (Dv                             ) denote the event that Ar,k
                                                                                            v is acyclic. Also, let k̂ be the
number of stages of Algorithm Activation(Ar , p, v).

Lemma A.5. Given interaction network Ar and activation probability p, the following holds. For all 2 ≤
k ≤ k̂,

                                               r ,k)                          r,k                          (k−1)(k−2)
                                P ((Dv(A               )) = (1 − p)|E[Av            ]|−k+1
                                                                                             ≥ (1 − p)         2        .                      (A.42)

                                                                                                                                     (Ar ,1)
Proof. We first show the equality. The proof is by induction. In stages 1 and 2, P ((Dv                                                        )) = 1
and hence the induction basis holds. We then assume that for all k < m ≤ k̂, Eq. (A.42) holds. We
next show that this equation holds for k = m. Let v 0 be the agent that is added to C v at stage m.
The attached component to v is acyclic at the end of stage m if the following holds:
                                                                                                                                        (Ar ,m−1)
       • The component attached to v is acyclic at the end of stage m − 1, i.e., event (Dv                                                          )
         happens, and

       • For v 0 = Cm
                    v − Cv
                         m−1 , we have |Ev 0 | = 1.

                                                               (Ar ,m−1)                                r,m−1
By induction hypothesis, we have P ((Dv                                       )) = (1 − p)|E[Av                 ]|−(m−1)+1 .   We next show that
the second event happens with probability (1 − p)                                |E[Ar,m      r,m−1
                                                                                     v ]|−|E[Av     ]|−1         . This equation follows from
the fact that the number of edges between                            v0    and    v
                                                                                 Cm−1    is exactly equal to |E[Ar,m        r,m−1
                                                                                                                 v ]| − |E[Av     ]|.
Conditional on one of the edges being active, the probability of all the other edges being inac-
                                        r,m
tive is equal to (1 − p)|E[Av                 ]|−|E[Ar,m−1
                                                     v     ]|−1 .         Combining the preceding relation with the induction
hypothesis, we obtain
                                                                                             r,m
                                r ,m)                        r ,m−1)                               ]|−|E[Ar,m−1
                     P ((Dv(A           )) = P ((Dv(A                     ))(1 − p)|E[Av                  v     ]|−1

                                                                    r,m−1                                  r,m
                                                                                                                 ]|−|E[Ar,m−1
                                          = (1 − p)|E[Av                    ]|−(m−1)+1
                                                                                         (1 − p)|E[Av                   v     ]|−1
                                                                    r,m
                                          = (1 − p)|E[Av                  ]|−m+1
                                                                                   ,

completing the proof of the equality. The inequality in Eq. (A.42) is implied by the fact that in stage
     v | = m. Hence, the induced subgraph over C v has at most                                              m(m−1)
m, |Cm                                          m                                                             2         edges. In other words,
  16
       At each stage k, one node is added to Ckv implying that the algorithm will terminate.


                                                                             45
               m(m−1)
|E[Ar,m
    v ]| ≤       2    .   Combining the preceding relation with the fact that 1 − p ≤ 1, we obtain

                                                          r,m                            m(m−1)
                                        (1 − p)|E[Av            ]|−m+1
                                                                         ≥ (1 − p)         2         ,

completing the proof.

    Using the previous result, it follows that

                                                                                  (k̂−1)(k̂−2)
                                             P ((Dv(A,p) )) ≥ (1 − p)                  2         .

                                                                                                                    (A,p)
Hence, by obtaining an upperbound on k̂, we can get a lower bound on P ((Dv                                                 )). We obtain the
upperbound on k̂ using Theorem A.1 given in subsection A.1. Combining these two results, we
                                                                     (A,p)
provide conditions on (A, p) under which, P ((Dv                             )) ≥ 1 − (n) with limn→∞ (n) → 0.
    Let λ(G) represent the second largest eigenvalue in absolute value of the adjacency matrix of
the degenerate network G. For a given d < n, let Gd denote the set of d− regular graphs G with
λ(G) = o(d). Consider a random network A generated from (Ω, F, P), where Ω = {G = (V, E)|E ⊂
Ê, (V, Ê) ∈ Gd }.
    Combining Lemma A.5 and Theorem A.1, we present the proof of the main theorem of this
section.
                                                  √
Proof of Theorem 5.2. We first show that if d ∈ Ω( n) and p < d1 , the generated random network
from (A, p) is a 1 − (n)-local tree network with limn→∞ (n) = 0. We show that:
                 1
    • If p <     d,   by Theorem A.1 for all v ∈ V , C v is of size at most O(log(n)), with probability
      1 − 1 (n), where limn→∞ 1 (n) = 0.

    • If C v is of size O(log(n)), by Lemma A.5, the attached component to v in the transmission
      network is acyclic with probability at least 1 − (n) where limn→∞ (n) = 0.
                                                                                        √
Combining the above steps implies the desired result. Theorem A.1 implies that if d ∈ Ω( n) and
      1
p <   d,   the maximum component size of the transmission network is O(log(n)) with probability
1 − 1 (n). In other words, with probability 1 − 1 (n) for all v ∈ V , C v is of size O(log(n)). Let (A)
be the event that the maximum component size of the transmission network is O(log(n)).
    Moreover, by using Lemma A.5 we have
                                 X                   (|V [Aa            a
                                                           v ]|−1)(|V [Av ]|−2)
            P ((Dv(A,p) )) ≥               (1 − p)               2                P(A,p) (Aa )
                               Aa ∼(A,p)
                                              X                                   (|V [Aa            a
                                                                                        v ]|−1)(|V [Av ]|−2)
                          ≥                                          (1 − p)                  2                P(A,p) (Aa ).          (A.43)
                               {Aa ∼(A,p)| |V [Aa
                                                v ]|=O(log(n))}




                                                                    46
               √                     1
Assuming d = Ω( n), p <              d   and |V [Aav ]| = O(log(n)), we obtain

                                                     (|V [Aa            a
                                                           v ]|−1)(|V [Av ]|−2)
                                           (1 − p)               2                ≥ 1 − (n),                                        (A.44)

where limn→∞ (n) = 0. Combining Eqs. (A.43) and (A.44), we have

    lim P ((Dv(A(n),p) ))
   n→∞
                                             X                                      (|V [Aa               a
                                                                                          v (n)]|−1)(|V [Av (n)]|−2)
               ≥ lim                                                     (1 − p)                   2                   P(A(n),p) (Aa (n))
                  n→∞
                          {Aa (n)∼(A(n),p)| |V [Aa
                                                 v (n)]|=O(log(n))}

               ≥ lim (1 − 1 (n))(1 − (n)) = 1,
                  n→∞

completing the proof of the first part of the theorem. Using a similar argument, we can show that
             1
if p <   n log2 (n)
                    ,   the generated random network from (A, p) is a 1 − (n)-local tree network with
limn→∞ (n)n = 0.


A.7      Proofs of Section 6

Proof of Theorem 6.1. As we have shown in Theorem 3.2, for any symmetric network A there ex-
ists a unique symmetric equilibrium. We show that under Assumption 2, for any symmetric ran-
dom network, this is in fact the only equilibrium security profile.
    Assume the contrary. This implies that the symmetric random network A has an asymmetric
equilibrium security profile. Let q e be the security level in the symmetric equilibrium, qen denote
the symmetric equilibrium security profile and q̂e be an asymmetric equilibrium security profile.
We then show that there exist two agents i, j ∈ V such that q̂ie > q e and q̂je < q e .
    Assume to arrive at a contradiction that for all i ∈ V , q̂ie ≥ q e . Using Proposition 3.3(a), this im-
plies that for all i ∈ V , Pi (A, q̂e , Φ) ≤ Pi (A, qen , Φ). Moreover, since q̂e 6= qe , this implies that q̂ie >
q e for some agent i. Under Assumption 2, by Lemma 4.1, we obtain Pi (A, q̂e , Φ) > Pi (A, qen , Φ),
yielding a contradiction. Similarly, one can extend the argument and reach a contradiction if for
all i ∈ V , q̂ie ≤ q e . Hence, there exist two agents i, j ∈ V such that q̂ie > q e and q̂je < q e .
    We next show that

                                               Pi (A, q̂e , Φ) ≤ Pj (A, q̂e , Φ),                                                    (A.45)

using Proposition 3.2 and symmetry. Consider two agents i, j ∈ V such that q̂ie > q e and q̂je < q e .
By Proposition 3.2

         Pi (A, q̂e , Φ) = (1 − q̂ie )P̃i (A−i , q̂e{−i,−j} , Φ) + (1 − q̂ie )(1 − q̂je )Qi,j (A, q̂e−{i,j} , Φ),
         Pj (A, q̂e , Φ) = (1 − q̂je )P̃j (A−i , q̂e{−i,−j} , Φ) + (1 − q̂je )(1 − q̂ie )Qj,i (A, q̂e−{i,j} , Φ).                    (A.46)




                                                                    47
Also since A is symmetric, it follows that

                               P̃i (A−j , q̂e{−i,−j} , Φ) = P̃j (A−i , q̂e{−i,−j} , Φ),
                                  Qi,j (A, q̂e−{i,j} , Φ) = Qj,i (A, q̂e−{i,j} , Φ).                     (A.47)

Combining Eqs. (A.46), (A.47) and the fact that q̂ie > q e > q̂je , we obtain Eq. (A.45).
   Finally, assuming q̂e and qen are both equilibrium security profiles, q̂ie > q̂je and assuming c(q)
is sufficiently convex, using Eq. (3.2) we obtain

                    Pi (A, q̂e , Φ) = c0 (q̂ie )(1 − q̂ie ) > c0 (q̂je )(1 − q̂je ) = Pj (A, q̂e , Φ),

which contradicts Eq. (A.45) and shows the uniqueness of the equilibrium. With a similar line of
argument, one can show that under Assumption 2 for any symmetric random network, the socially
optimal security profile is unique and symmetric.


A.8   Proofs of Subsection 6.2

Proof of Theorem 6.2. The proof follows the proof of Theorem 3.2 and Theorem 4.1 closely. We
prove the following steps:

   1. We show that in any equilibrium security profile, all agents residing on the same island select
      the same security level.

   2. Given that the individuals on the same island use the same security level in the equilibrium,
      we show that the equilibrium security profile for the whole network is unique.

The proof of step(1) is the same as the proof of Theorem 3.2 despite the fact that the whole network
is not a symmetric random network. However, given that the individuals residing on the same
island are connected symmetrically to other islands, in expectation the location of the individuals
on the same island are symmetric with respect to each other. We next show the proof of step(2).
Given that all agents residing on the same island play symmetrically in the equilibrium security
profile, without loss of generality the equilibrium security profile for all agents on the same island
can be expressed via a scalar. In the rest of the proof, the equilibrium security profile qe denote the
equilibrium security profile of the islands and qie denote the equilibrium security level of island i.
We next show that the equilibrium security profile qe is unique. Assume to arrive at a contradiction
that we have two different equilibrium security profiles qe and q̂e . Similar to Theorem 4.1 we
partition the islands into three sets H1 , H2 and H3 as follows:

                                             qie > q̂ie for all Hi ∈ H1 ,
                                             qie = q̂ie for all Hi ∈ H2 ,
                                             qie < q̂ie for all Hi ∈ H3 .


                                                           48
   Following the same line of argument as Theorem 4.1, we show that for any tree order of the
bridges without loss of generality, we can assume that there exists a bridge (Hx , Hy ) ∈ T such that
Hx ∈ H1 , Hy ∈ H3 , and for all Hv ∈ Y where Y = {Hv ∈ H | Hv > Hy }, we have Hv ∈ H3 .
   We will abuse the notation and denote the infection probability of an agent residing on island
Hi , by PHi (). We next show that we can decompose the infection probability reaching to the
agents of island Hx and island Hy using the network effect on Hx when island Hy is removed from
the network and the network effect on Hy when island Hx is removed from the network. More
specifically, let P̂x and P̂y denote infection probabilities reaching to the agents of island Hx and Hy
when island Hy and Hx are removed from the network respectively, i.e.,

                                 P̂x (q) = P̃Hx (A−Hy , q−y , Φ)(1 − qx ),
                                 P̂y (q) = P̃Hy (A−Hx , q−x , Φ)(1 − qy ).

and let P̄x (and P̄y ) denote infection probability that reaches to the agents in island Hx if the un-
derlying network is Hx and the seed node is on island Hx , i.e., for all i ∈ Hx and for all j ∈ Hy ,

                                          P̄x (q) = Pi (Hx , qx , 1̂),
                                          P̄y (q) = Pj (Hy , qy , 1̂).



Using P̂x , P̂y , P̄x , and P̄y we can write down infection probabilities of agents x and y as follows:

                                Px (A, qe , Φ) = Pˆx (qe ) + P̄x (qxe )Pˆy (qe ),                 (A.48)
                                Py (A, qe , Φ) = Pˆy (qe ) + P̄y (qye )Pˆx (qe ).                 (A.49)

The rest of the proof follows the same line of argument as Theorem 4.1.

   Define CIH (Hi , A) as the contribution of island Hi to infection in network A, i.e.,

                               CIH (Hi , A) = I(A, q, Φ) − I(A−Hi , q, Φ).                        (A.50)

We show that for any islands connection network, the contribution of islands to infection in a
subgraph is upper bounded by their contribution to infection in the original network.

Lemma A.6. Given an islands connection network A = (V, H, T ), for any H̄ ⊂ H and Hi 6∈ H̄,

                                      CIH (Hi , A−H̄ ) ≤ CIH (Hi , A).




                                                       49
Proof of Lemma A.6. Expanding Eq. (A.50), we have

     CIH (Hi , A) = I(A, q, Φ) − I(A−Hi , q, Φ)
                                                   X
                   = |V (Hi )|PHi (A, q, Φ) +                 |V (Hj )|(PHj (A, q, Φ) − PHj (A−Hi , q, Φ)).
                                                Hj ∈H−{Hi }


Similarly, we can define CIH (Hi , A−H̄ ). We next show the following:

  (a) For any island Hi ∈ H − H̄, PHi (A, q, Φ) ≥ PHi (A−H̄ , q, Φ).

 (b) For any island Hj ∈ H − H̄ − Hi , PHj (A, q, Φ) − PHj (A−Hi , q, Φ) ≥ PHj (A−H̄ , q, Φ) −
      PHj (A−({Hi }∪H̄) , q, Φ).

Combining steps (a) and (b) implies that CIH (Hi , A−H̄ ) ≤ CIH (Hi , A), proving Lemma A.6.
   Since A−H̄ ⊂ A, by Proposition 3.3(c) it follows that for any Hi ∈ H − H̄, PHi (A, q, Φ) ≥
PHi (A−H̄ , q, Φ), establishing step (a). We next present the proof of step (b).
   Let the random variable Hs denote the island that the seed node resides on. In the islands
connection network, one of the following mutually exclusive events happens:

 (A) The unique path over bridges between island Hs and Hj in the tree T includes Hi .

 (B) The unique path of bridges between Hs and Hj in the tree T does not include Hi .

   If event (B) happens, the probability that infection reaches Hj stays unchanged after Hi is
removed from the network in both A and A−H̄ , which implies

PHj (A, q, Φ|(B)) − PHj (A−Hi , q, Φ|(B)) = PHj (A−H̄ , q, Φ|(B)) − PHj (A−({Hi }∪H̄) , q, Φ|(B)) = 0.
                                                                                                         (A.51)
Suppose next that event (A) happens. The unique path between Hs and Hj then includes Hi and
can be represented as Hs , H1 , . . . , Hk = Hi , . . . , Hm = Hj . An agent in island Hj gets infected in A
if and only if for all 1 ≤ r ≤ m, the agents corresponding to the endpoints of the bridges between
(Hr , Hr+1 ) are being infected. However, in A−H̄ , Hj gets infected if and only if for all 1 ≤ r ≤ m,
the agents corresponding to the endpoints of the bridge between (Hr , Hr+1 ) are being infected and
Hr 6∈ H̄. Hence,

   PHj (A, q, Φ|(A)) − PHj (A−Hi , q, Φ|(A)) ≥ PHj (A−H̄ , q, Φ|(A)) − PHj (A−({Hi }∪H̄) , q, Φ|(A)).




                                                       50
   Combining the preceding relations with Eq. (A.51), we obtain

             PHj (A, q, Φ) − PHj (A−Hi , q, Φ)
              = (PHj (A, q, Φ|(A)) − PHj (A−Hi , q, Φ|(A)))P ((A))
                             + (PHj (A, q, Φ|(B)) − PHj (A−Hi , q, Φ|(B))P ((B))
              ≥ (PHj (A−H̄ , q, Φ|(A)) − PHj (A−(H̄∪{Hi }) , q, Φ|(A)))P ((A))
                             + (PHj (A−H̄ , q, Φ|(B)) − PHj (A−(H̄∪{Hi }) , q, Φ|(B)))P ((B))
              = PHj (A−H̄ , q, Φ) − PHj (A−({Hi }∪H̄) , q, Φ),

   completing the proof of step (b). The result then follows from the definition of CIH .

Proof of Theorem 6.3. By Theorem 6.2, in the equilibrium and the social optimum, all agents on the
same island play symmetrically. Hence without loss of generality, we can denote the equilibrium
and the socially optimal security profiles of all agents residing on an island via a scalar. Similar to
Theorem 6.2, let qe and qs denote the equilibrium and the socially optimal security profiles of the
islands. If qs > qe then by Propositions 3.3(a) and 3.1, we have Pv (A, qs , Φ) < Pv (A, qe , Φ) for all
v ∈ V implying that I(A, qs , Φ) ≤ I(A, qe , Φ). Otherwise, let H1 = {Hi ∈ H | qis ≤ qie }, i.e., H1
is the set of islands that overinvest compared to the social optimum. The rest of the proof follows
from the following steps:

   1. We first present an upper bound for expected infections of the social optimum. We show
      that, I(A, qs , Φ) ≤ I(A−H1 , qs−H1 , Φ) + Hi ∈H1 |V (Hi )|c0i (qis )(1 − qis ). To obtain this result, we
                                                P

      show that
                                                                                  H
                                                                       P
         • For any Ĥ ⊂ H, I(A, q, Φ) ≤ I(A−Ĥ , q−Ĥ , Φ) +              Hi ∈Ĥ CI (Hi , A).
         • Furthermore, CIH (Hi , A) ≤ |Hi |c0 (qis )(1 − qis ).

      Combining the preceding relations, implies the desired inequality.

   2. We then compare this upper bound with the expected infections in the equilibrium that was
      expressed in Eq. (A.23), i.e.,
                                            X
                          I(A, qe , Φ) ≥            |Hi |c0 (qie )(1 − qie ) + I(A−H1 , qe−H1 , Φ).
                                           Hi ∈H1


We start by proving step (1). We show that for any Ĥ ⊂ H,
                                                                     X
                            I(A, q, Φ) ≤ I(A−Ĥ , q−Ĥ , Φ) +                CIH (Hi , A).              (A.52)
                                                                    Hi ∈Ĥ


The proof is by induction on |Ĥ|. If |Ĥ| = 0, then CIH (Ĥ, A) = 0. Hence, Eq. (A.52) trivially holds
(the induction basis). We next assume that if |Ĥ| = m, then Eq. (A.52) holds (induction hypothesis)

                                                          51
and we then prove that it would hold if |Ĥ| = m + 1 as well. Consider an island Hi ∈ Ĥ and let
Ĥ−i = Ĥ − {Hi }. Since |Ĥ−i | = m, by induction hypothesis we have
                                                                       X
                        I(A, q, Φ) ≤ I(A−Ĥ−i , qs−Ĥ , Φ) +                    CIH (Hj , A).                      (A.53)
                                                         −i
                                                                     Hj ∈Ĥ−i


Furthermore, by Eq. (A.50) we have

 I(A−Ĥ−i , qs−Ĥ , Φ) = I(A−Ĥ , qs−Ĥ , Φ) + CIH (Hi , A−Ĥ−i ) ≤ I(A−Ĥ , qs−Ĥ , Φ) + CIH (Hi , A), (A.54)
                −i


where the inequality follows from Lemma A.6. Combining Eqs. (A.53) and A.54, we obtain
                                             X                                                   X
   I(A, q, Φ) ≤ I(A−Ĥ−i , qs−Ĥ , Φ) +               CIH (Hj , A) ≤ I(A−Ĥ , qs−Ĥ , Φ) +               CIH (Hj , A),
                                 −i
                                           Hj ∈Ĥ−i                                             Hj ∈Ĥ


completing the proof of Eq. (A.52).
We next show that in an islands connection network, when agents select the socially optimal secu-
rity profile, we have

                                   CIH (Hi , A) ≤ |V (Hi )|c0 (qis )(1 − qis ).                                    (A.55)

Using Eq. (A.50), CIH (Hi , A) can be written as follows:

      CIH (Hi , A) = I(A, qs , Φ) − I(A−Hi , qs , Φ)
                                                   X
                   = |V (Hi )|PHi (A, qs , Φ) +                   Pd (A, qs , Φ) − Pd (A−Hi , qs , Φ).             (A.56)
                                                   d∈V −V (Hi )


   We next show that in an islands connection network A = (V, H, T ), given an island Hi ∈ H,
and two agent v, d ∈ V such that v ∈ V (Hi ) and d ∈ V (Hj ), we have

                                                    1
                  (1 − qi )Qd,v (A, qs , Φ) ≥             (P̃d (A, qs , Φ) − P̃d (A−Hi , qs , Φ)).                 (A.57)
                                                |V (Hi )|

   Let Hs denote the island that the seed node resides on. Since A is an island connection network
one of the following mutually exclusive events happens:

 (A) The unique path of bridges between Hs and Hj in T includes Hi .

(B) The unique path of bridges between Hs and Hj in T does not include Hi .

If event (B) happens, then the probability of infection reaching to d stays unchanged after Hi is
removed which implies

             (1 − qis )Qd,v (A, qs , Φ|(B)) = P̃d (A, qs , Φ|(B)) − P̃d (A−Hi , qs , Φ|(B)) = 0.


                                                        52
Suppose next that event (A) happens. In this scenario, P̃d (A−Hi , qs , Φ)|(A)) = 0. Let S, H1 , . . . , Hk =
Hi , . . . , Ht = Hj denote the unique path over the bridges in T , between islands Hs and Hj . Let
(Am ) denote the event in which agent m is the randomly selected agent from Hi that is connected
to Hk+1 . By law of total probability and assuming that the security profiles as well as the islands
are symmetric, we have: For any m ∈ V (Hi ),
                                    X
         P̃d (A, qs , Φ|(A)) =               P̃d (A, qs , Φ|(Am ))P ((Am )) = P̃d (A, qs , Φ|(Am )).                   (A.58)
                                 m∈V (Hi )


Also if event (Am ) happens, the only way to reach from Hs to Hj is through agent m. That implies

                                                                                    1
    (1 − qis )Qd,v (A, qs , Φ|(A)) ≥ P̃d (A, qs , Φ|(Am ))P ((Am )) =                     P̃d (A, qs , Φ|(Am )).       (A.59)
                                                                                |V (Hi )|

Combining Eqs. (A.59) and (A.58), we obtain

   (1 − qis )Qd,v (A, qs , Φ) = (1 − qi )Qd,v (A, qs , Φ|(A))P ((A)) + (1 − qi )Qd,v (A, qs , Φ|(B))P ((B))
                             = (1 − qis )Qd,v (A, qs , Φ|(A))P ((A))
                                   1
                             ≥           P̃d (A, qs , Φ|(Am ))P ((A))
                               |V (Hi )|
                                   1
                             =           (P̃d (A, qs , Φ) − P̃d (A−Hi , qs , Φ)).
                               |V (Hi )|

Combining the preceding relation with Eqs. (A.50) and (3.3), in the socially optimal solution for
each agent m ∈ V (Hi ), the following relations hold:
                                                                          X
     |V (Hi )|c0 (qis )(1 − qis ) = |V (Hi )|Pi (A, qs , Φ) + |V (Hi )|         (1 − qis )(1 − qds )Qd,v (A, qs , Φ)
                                                                          d∈V
                                                                   X
                                                      s
                               ≥ |V (Hi )|Pi (A, q , Φ) +                    (Pd (A, qs , Φ) − Pd (A−Hi , qs , Φ))
                                                                d∈V −V (Hi )

                               =   CIH (Hi , A),

completing the proof of Eq. (A.55). Combining Eqs. (A.54) and (A.55), we obtain
                                                                   X
                     I(A, qs , Φ) ≤ I(A−H1 , q−H1 , Φ) +                  CIH (Hi , A)
                                                                 Hi ∈H1
                                                                   X
                                    ≤ I(A−H1 , qs−H1 , Φ) +               |V (Hi )|c0i (qis )(1 − qis ),
                                                                 Hi ∈H1




                                                           53
completing the proof of step (1). Finally, by combining steps (1) and (2), we obtain
                                                                           X
                         I(A, qs , Φ) ≤ I(A−H1 , qs−H1 , Φ) +                      |V (Hi )|c0i (qis )(1 − qis )
                                                                          Hi ∈H1
                                                                           X
                                         ≤ I(A−H1 , qe−H1 , Φ) +                   |Hi |c0 (qie )(1 − qie )
                                                                          Hi ∈H1

                                         ≤ I(A, qe , Φ),

where the second inequality follows from Proposition 3.3(a) and Lemma 4.1, and the third inequal-
ity from Eq. (A.23), completing the proof of the Theorem.


A.9     Proofs of Subsection 6.3

Lemma A.4. Suppose Assumptions 1 and 2 hold. Given two symmetric networks Ĝ1 and Ĝ2 , I(Ĝ1 , q1e , Φ) ≥
I(Ĝ2 , q2e , Φ) if and only if I(Ĝ1 , q, Φ) ≥ I(Ĝ2 , q, Φ) for all q ∈ [0, 1].

Proof of Theorem A.4. Consider two symmetric random networks Ĝ1 and Ĝ2 . We first show that
if for all q ∈ [0, 1],

                                                   I(Ĝ1 , q, Φ) ≥ I(Ĝ2 , q, Φ),                                   (A.60)

then q1e ≥ q2e where q1e and q2e are the symmetric equilibrium security levels of Ĝ1 and Ĝ2 . Assume
to arrive at a contradiction that q1e < q2e . Hence, we have

                         c0 (q1e ) = P̃i (Ĝ1 , q1e , Φ) ≥ P̃i (Ĝ2 , q1e , Φ) ≥ P̃i (Ĝ2 , q2e , Φ) = c0 (q2e ).   (A.61)

First equation is implied by Eq. (3.2). First inequality is obtained by the assumption in the state-
ment, and the second inequality is the combination of Proposition 3.3(a) and the fact that q1e < q2e .
Moreover, since by Assumption 1, the function c is strictly convex, we have c0 (q1e ) < c0 (q2e ) which
is in contrast with Eq. (A.61) and shows that q1e ≥ q2e .
    Combined with Lemma 4.1, this implies Pi (Ĝ1 , q1e , Φ) ≥ Pi (Ĝ2 , q2e , Φ) which completes the
proof of the first part.


    We next show that if the condition in Eq. (A.60) does not hold, then we can find two sufficiently
convex cost functions c and ĉ such that

                           I(Ĝ1 , q1e , Φ) > I(Ĝ2 , q2e , Φ), and I(Ĝ1 , q̂1e , Φ) < I(Ĝ2 , q̂2e , Φ),          (A.62)

where q1e and q2e are the symmetric equilibrium security levels of Ĝ1 and Ĝ2 for cost function c, and
q̂1e and q̂2e are the symmetric equilibrium security levels of Ĝ1 and Ĝ2 for cost function ĉ, establish-
ing that a ranking of equilibrium in terms of expected infections is not possible. Let q̄, q̃ ∈ [0, 1] be


                                                                   54
such that

                              I(Ĝ1 , q̄, Φ) > I(Ĝ2 , q̄, Φ), and I(Ĝ1 , q̃, Φ) < I(Ĝ2 , q̃, Φ).               (A.63)

    We first present two sufficiently convex cost functions c(q) and ĉ(q) such that q1e = q̄ and q̂1e = q̃.
We then show that q2e < q1e and q̂2e > q̂1e . Combining these inequalities with Lemma 4.1 gives the
desired result. Let c(q) and ĉ(q) be such that

                                                           āq                   ãq
                                            c0 (q) =             and ĉ0 (q) =         ,
                                                         (1 − q)               (1 − q)

             I(Ĝ1 ,q̄,Φ)           I(Ĝ1 ,q̃,Φ)
where ā =       q̄n        and ã =     q̃n     .
    One can verify that          e
                                q1 = q̄ and q̂1  e      = q̃. We next show that q2e < q1e and q̂2e > q̂1e . We first show
that q2e < q1e . Assume to arrive at a contradiction that q2e ≥ q1e . Substituting q1e with q̄ and combining
with the preceding equation we have

                                                           I(Ĝ1 , q̄, Φ)   I(Ĝ2 , q̄, Φ)   I(Ĝ2 , q2e , Φ)
                     c0 (q2e ) ≥ c0 (q1e ) = c0 (q̄) =                    >                ≥                  .
                                                            n(1 − q̄)        n(1 − q̄)        n(1 − q̂2e )

First inequality follows from the fact that c0 (q) is convex and q2e ≥ q1e . Second equality follows from
Eq. (3.2), second inequality from Eq. (A.63), and the third inequality from Proposition 3.3(a). Using
                                       I(Ĝ2 ,q2e ,Φ)
Eq. (3.2), we obtain c0 (q2e ) =        n(1−q̂2e )      which is a contradiction and shows the desired result. Using
a similar line of argument, one can show that q̂2e > q̂1e .
    Using q2e < q1e and q̂2e > q̂1e together with Lemma 4.1, we obtain Eq. (A.62), completing the
proof.

Proof of Theorem 6.4. We first show the following:

Lemma A.7. Given two symmetric random networks Ĝ1 and Ĝ2 generated from two base graphs G1 and
G2 , if G1 ⊂ G2 , then Pi (Ĝ1 , q, Φ) ≤ Pi (Ĝ2 , q, Φ) for all i ∈ V and for all q ∈ [0, 1].

    The proof of this lemma follows the same line of argument as Proposition 3.3(c) closely. The
preceding lemma together with Theorem A.4 establishes our desired result.

Proof of Proposition 6.1. The infection probability of an agent in a symmetric random tree T with
distance vector d and the symmetric security level q is defined as follows:

                                                                      n
                                                                   1 X
                                                Pi (T, q, Φ) =          di (1 − q)i .
                                                                   n2
                                                                        i=1




    We first show that for two symmetric random trees (T, d) and (T 0 , d0 ) and a given vector z =



                                                                   55
(z1 , . . . , zn ) such that z1 ≥ z2 ≥ . . . ≥ zn ≥ 0, if T 0 ≺ T , then we have

                                j
                                X                           j
                                                            X
                                       (di − d0i )zi ≥ zj         (di − d0i ) for all 1 ≤ j ≤ n.                  (A.64)
                                i=1                         i=1

To prove this, we use induction on j. For j = 1 (i.e., the induction basis) the statement trivially
holds. We assume that the statement holds for j ≤ m < n. We then prove that the statement holds
for j = m + 1.
    Expanding the left hand side and substituting j with m + 1 we obtain

              j
              X                        m+1
                                       X                         m
                                                                 X
                     (di − d0i )zi =          (di − d0i )zi =          (di − d0i )zi + zm+1 (dm+1 − d0m+1 )
               i=1                      i=1                      i=1
                                                                       m
                                                                       X
                                                            ≥ zm             (di − d0i ) + zm+1 (dm+1 − d0m+1 )
                                                                       i=1
                                                                    Xm
                                                            ≥ zm+1 (   di − d0i ) + zm+1 (dm+1 − d0m+1 )
                                                                         i=1
                                                                         m+1
                                                                         X
                                                            = zm+1 (               di − d0i )
                                                                             i=1

where the first inequality follows from the induction hypothesis and the second inequality is due
to the fact that d  d0 and zm+1 < zm .
    Using this result, we next show that if T 0 ≺ T then I(T̂ , q, Φ) ≥ I(T̂ 0 , q, Φ). By the definition of
the distance function we have
                                                    n                                   n
                                                 n X                        1           X
            I(T̂ , q, Φ) − I(T̂ 0 , q, Φ) =           (d i − d0
                                                              i )(1 − q)i
                                                                          ≥   (1 − q) n
                                                                                          (di − d0i ) ≥ 0.
                                                 n2                         n
                                                     i=1                                         i=1

The preceding inequality follows from Eq. (A.64) when z is replaced by q̄ where q̄ = ((1 − q), (1 −
q)2 , . . . , (1 − q)n ). Note that q̄i ≥ q̄j ≥ 0 for all i ≤ j, hence Eq. (A.64) holds. Finally by applying
Theorem A.4, we obtain I(T̂ , q e , Φ) ≥ I(T̂ 0 , q̂ e , Φ) where q e and q̂ e denote the equilibrium security
levels of T̂ and T̂ 0 respectively.

Proof of Proposition 6.2. Let (αi ) be the event in which exactly i agents are susceptible. The ex-
pected infections can be stated as

                                                           n
                                                           X
                                        I(Ĝ, q, Φ) =            I(Ĝ, q, Φ|(αi ))P ((αi )),                      (A.65)
                                                           i=1


where P ((αi )) denotes the probability that event (αi ) happens.
    We first show that I(Ĝ, q, Φ|(αi )) = n%G ( ni ). Let V i denote the set of subsets of agents of size i,



                                                                   56
i.e., V i = {V 0 ⊂ V ||V 0 | = i}. We have
                                         X                                        1 X
                I(Ĝ, q, Φ|(αi )) =             I(Ĝ[V̄ ], q, Φ)P (V̄ |(αi )) =   n
                                                                                     I(Ĝ[V̄ ], q, Φ).              (A.66)
                                      V̄ ∈V i                                     i   V̄ ∈V i


Here, the second equality follows from the fact that for all V̄ ∈ V i , P (V̄ ) which is the probability
of having all agents in V̄ susceptible and all agents in V − V̄ immune, is the same and is equal to
                                                1
(1 − q)i q n−i . Hence, for all V̄ ∈ V i , P (V̄ |(αi )) =
                                                     .
                                               (ni)
    Now, note that for a given base graph G, %G ( ni ) denotes the normalized expected size of the
connected component attached to a randomly selected seed node v from G, in the induced sub-
graph of G over i randomly selected agents from G. In other words, %G ( ni ) denotes expected
infection rate in Ĝ when i randomly selected agents are susceptible and the rest of the agents are
immune, which implies the following:
                                                           
                              1 X                      n n       i         i
                              n
                                   I(Ĝ[V̄ ], q, Φ) = n    %G ( ) = n%G ( ).
                              i   i                    i
                                                           i     n         n
                                 V̄ ∈V

                                                                                          n
The result follows by combining this with the fact that P ((αi )) =                               (1 − q)i q n−i .
                                                                                              
                                                                                          i

Proof of Theorem 6.5. The proof consists of two parts. Given two base structures G1 [n] and G2 [n],
we first show that if for all r ∈ [0, 1] %G1 (r) ≥ %G2 (r), then I(Ĝ1 , q1e , Φ) ≥ I(Ĝ2 , q2e , Φ) for any
sufficiently convex cost function. As in the rest of the paper, let q1e and q2e denote the equilibrium
security levels of Ĝ1 and Ĝ2 . By Proposition 6.2 and assuming that %G1 (r) ≥ %G2 (r) for all r ∈ [0, 1],
we have,
                  n                        n    
                  X    n        i n−i   i    X    n                      i
  I(Ĝ1 , q, Φ) =   n    (1 − q) q %G1 ( ) ≥   n     (1 − q)i q n−i %G2 ( ) = I(Ĝ2 , q, Φ). (A.67)
                       i                n         i                      n
                   i=1                                       i=1

Combining Eq. (A.67) with Theorem A.4 shows the desired result. To prove the only if part, we
will first show the following:

Theorem A.5. For any n and  > 0 there exists δ(n) such that for all G1 and G2 if there exists an interval
I ⊂ [0, 1] of length at least δ for which %G1 ( nk ) ≥ %G2 ( nk ) +  for all         k
                                                                                      n   ∈ I, then there exists q such that
I(Ĝ1 , q, Φ) > I(Ĝ2 , q, Φ). Furthermore, limn→∞ δ(n) = 0.

Proof. Let q = (max(I) + min(I))/2. Consider a Binomial random variable X with parameters n




                                                              57
                  X
and q. Let X̂ =   n.

   1
     (I(Ĝ1 , q, Φ) − I(Ĝ2 , q, Φ)) = E[%G1 (X̂) − %G2 (X̂)]
   n
                    = E[%G1 (X̂) − %G2 (X̂)|X̂ ∈ I]P r[X̂ ∈ I] + E[%G1 (X̂) − %G2 (X̂)|X̂ 6∈ I]P r[X̂ 6∈ I]
                                                     2 /2                              2 /2
                     ≥ E[|X̂ ∈ I](1 − 2e−nδ                ) + E[−1|X̂ 6∈ I]2e−nδ
                                          2 /2
                     =  − (1 + )2e−nδ          .

The first equation follows from the definition of %G1 and the linearity of expectation, and the
second equation follows from the law of total probability. By applying Theorem A.3, we obtain
                        2 /2
P r[X̂ 6∈ I] ≤ 2e−nδ           . Combining with the fact that %G1 (X̂) − %G2 (X̂) ≥ −1, we obtain the first
inequality.
                        q
    By choosing any δ > 2 ln(2+2/)
                               n     we can ensure that I(Ĝ1 , q) − I(Ĝ2 , q) > 0 which proves the
                       q
claim. Note that limn→0 2 ln(2+2/)
                              n     = 0.

    Combining the preceding theorem with Theorem A.4 shows the desired result.


A.10     Proofs of Section 7

Proof of Theorem 7.1. Let (Xi ) denote the event that agent i is susceptible. In the random attack
model, the probability of a susceptible agent i getting infected can be stated as follows:

                                      Pi (A, q, Φ) = Pi (A, q, Φ|(Xi ))(1 − qi ).                         (A.68)

Put differently, the probability of a susceptible agent i getting infected is equal to the probability of
having a path between agent i and a randomly selected seed node s in the transmission network
At ∼ (A, q), i.e.,
                                                     1X                X
                          Pi (A, q, 1n |Xi ) =                                      P(A,q) (At |(Xi )).
                                                     n
                                                       s∈V                 At
                                                               {At |(s∈At )∩i−→s}

Moreover, to compute the expected infections after attacking agent i, we can restate it as the sum
over all agents j, the probability of agent i being connected to agent j. Using this interpretation it is
clear that I(A, q, ei ) = nPi (A, q, 1̂n ). Using Proposition 3.2, we have I(A, q, ei ) = P̃i (A, q−i , 1̂n )(1−
qi )n.

Proof of Theorem 7.2. To show the existence of the Nash equilibrium of the security game, we
show that the utility of each agent with respect to his security level is always concave if

                                       c00 (q) ≥ Ψ2 (Φ)Υ(Φ)(1 − q) + 2Ψ(Φ).                               (A.69)




                                                                  58
    Given network A and security profile q, let Φ = (ρ1 , . . . , ρn ) denote the attack decision selected
by the strategic attacker. The utility of an agent j can be written as follows:
                                                            
                             uj (A, q, Φ) = 1 − Pj (A, q, Φ) − c(qj )
                                                                                  
                                                           n
                                                           X
                                          = 1 − (1 − qj )    P̃j (A, q−j , ei )ρi  − c(qj ).                             (A.70)
                                                                     i=1


For ease of notation, let αi = P̃j (A, q−j , ei ). We show that if the inequality (A.69) holds, then
∂ 2 uj (A,q)
    ∂qj 2
               ≤ 0, proving that the utility of agent j is concave with respect to his security level. Using
Eq. (A.70), we have

                            ∂ 2 uj (A, q, Φ)    ∂ ∂uj (A, q, Φ)
                                      2      =
                                  ∂qj          ∂qj     ∂qj
                                                     n                   n
                                                ∂ X                      X    ∂ρi
                                             =     (   αi ρi − (1 − qj )   αi     − c0 (qj ))
                                               ∂qj                            ∂qj
                                                            i=1                     i=1
                                                      n                            n
                                                      X          ∂ρi               X          ∂ 2 ρi
                                                =2          αi       − (1 − qj )         αi          − c00 (qj ).          (A.71)
                                                      i=1
                                                                 ∂qj
                                                                                   i=1
                                                                                              ∂qj 2

To show the concavity of the utility function we also need to analyze the attacker’s response to
a given security profile q. The attacker’s value after attacking agent i is equal to the expected
infections after the attack. Using Theorem 7.1, expected infections is a linear function of qj and is
obtained from the following equation:

               I(A, q, ei ) = n(1 − qi )P̃i (A−{j} , q−{i,j} , 1̂n ) + n(1 − qj )(1 − qi )Qi,j (A, q−{i,j} , 1̂n ).

For ease of notation, let γi (A, q) = (1−qi )P̃i (A−j , q−i,j , 1̂n ) and βi (A, q) = (1−qi )Qi,j (A, q−{i,j} , 1̂n ).
Given network A and security profile q, the optimal attack decision Φ = (ρ1 , . . . , ρn ) is obtained
from the following program:

                                       n
                                       X
                   Maximize                  ρi (βi (A, q)(1 − qj ) + γi (A, q)) − ζ(ρi )
                                       i=1
                                       Xn
                    subject to               ρi = 1                                                                           (λ)
                                       i=1

                                      ρi ≥ 0                                                              forall i ∈ [n]     (µi )

Define
                                                                                              
                             n
                             X                                                       Xn            n
                                                                                                   X
           L(Φ, λ, µ) =            ρi (βi (A, q)(1 − qj ) + γi (A, q)) − ζ(ρi ) + λ    ρi − 1  +   µ i ρi ,
                             i=1                                                                   i=1              i=1




                                                                     59
where λ ∈ R and µi ∈ R+ .
       By the first order necessary conditions for the optimality of the solution of a nonlinear program,
we have

                               ∂                                        ∂
                                  L = βi (A, q)(1 − qj ) + γi (A, q) −     ζ(ρi ) + λ + µi = 0
                              ∂ρi                                      ∂ρi
                                  µ i ρi = 0    (for all i ∈ [n]).

Furthermore, assuming that ζ() is a convex increasing function with ζ(0) = 0, we have

                                           ∂ −1                                           
                                   ρi =       ζ max(0, βi (A, q)(1 − qj ) + γi (A, q) + λ) .                           (A.72)
                                          ∂ρi

                                                         ∂ −1                                                           17
                      P                              P                                                          
       Given that          i ρi   = 1, we have,       i ∂ρi ζ         max(0, βi (A, q)(1 − qj ) + γi (A, q) + λ) = 1.        To
evaluate Eq. (A.71), we need to analyze the second derivative of ρi with respect to qj . Having
Pn
  i=1 ρi = 1 implies that,

                                                               n
                                                               X ∂ρi
                                                                            = 0.                                       (A.73)
                                                                      ∂qj
                                                               i=1

Combining with Eq. (A.72), we obtain

                                               n                                     ∂λ
                                               X ∂ρi           −βi (A, q) −          ∂qj
                                                           =                                                           (A.74)
                                                     ∂qj               ζ 00 (ρi )
                                               i=1
                                                               n
                                                               X −βi (A, q)                    ∂λ
                                                           =                          −Ψ                               (A.75)
                                                                        ζ 00 (ρi )             ∂qj
                                                               i=1

                                                           = 0.                                                        (A.76)

Hence, we have
                                                                  Pn        −βi (A,q)
                                                      ∂λ              i=1    ζ 00 (ρi )
                                                          =                                .                           (A.77)
                                                      ∂qj                   Ψ

The second order derivative of ρi and λ with respect to qj is obtained by the following equations.

                                                              ∂ λ 2
                                                ∂ 2 ρi   − ∂q     2     ∂ρi 2 ζ 000 (ρi )
                                                                j
                                                       =            − (    )              .                            (A.78)
                                                ∂qj 2    ζ 00 (ρi )     ∂qj ζ 00 (ρi )
  17            ∂   −1
       Since   ∂ρi
                   ζ ()   is also an increasing function, we can compute λ for each choice of q by doing a binary search.




                                                                       60
                                                             Pn         ∂ρi 2 ζ 000 (ρi )
                                                ∂2λ               i=1 ( ∂qj ) ζ 00 (ρi )
                                                      =−                                    .                               (A.79)
                                                ∂qj 2                       Ψ

Replacing Eqs. (A.78) and (A.79) in Eq. (A.71), we obtain:

               ∂ 2 uj (A, q, Φ)
                                =
                     ∂qj 2
                                                                                                           
                              n                             ∂2λ
                              X         ∂ρi                   ∂ρi 2 ζ 000 (ρi ) 
                                                            ∂qj 2                              − c00 (qj )
                                                                                              
                                    αi 2    +              + (    )                (1 − q j )
                                        ∂qi     ζ 00 (ρi )     ∂qj ζ 00 (ρj )
                                                                                            
                              i=1



    We next show that if Eq. (A.69) holds, the utility of each agent is concave with respect to his
security level. We consider two cases:

  (a) ζ 000 () < 0.

 (b) Or ζ 000 () ≥ 0.
                                                                                                                        ∂2λ
In case (a), combining Eq. (A.79) and the fact that ζ 000 () < 0 and ζ 00 () ≥ 0, implies that                          ∂qj 2
                                                                                                                                > 0.
                                                                                   ∂λ
Furthermore, since 0 ≤ βi ≤ 1, it is implied that −1 ≤                             ∂qj    ≤ 0. Replacing these inequalities in
Eq. (A.71), we obtain,

               ∂ 2 uj (A, q, Φ)
                                =
                     ∂qj 2
                                                                                                           
                              n                            ∂2λ
                              X         ∂ρi             ∂qj 2              ∂ρi 2 ζ 000 (ρi )               00
                                       2 ∂qi +
                                    αi                  00            +(      ) 00            (1 − qj )
                                                                                                           − c (qj )
                                                         ζ (ρi )             ∂qj ζ (ρj )
                              i=1
                                                                                   
                                    n                          ∂2λ
                                    X         ∂ρi            ∂qj 2
                              ≤           αi 2     +                  (1   − qj ) − c00 (qj )
                                                                                  
                                                ∂qi         ζ 00 (ρi )
                                    i=1
                                                                                               
                                    n                       ∂λ             ∂2λ
                                    X         −βi −        ∂qj           ∂qj 2
                              =           αi 2                     +              (1   − qj ) − c00 (qj )
                                                                                              
                                                  Ψ                     ζ 00 (ρi )
                                    i=1
                                              n                               n
                                          ∂λ X αi                       ∂ 2 λ X αi
                              ≤ −2                         + (1 − q j )                    − c00 (qj )
                                          ∂qj   ζ 00 (ρi )              ∂qj 2   ζ 00 (ρi )
                                                i=1                                      i=1
                                          n                                   n
                                          X        αi                   ∂ 2 λ X αi
                              ≤ −2                         + (1 − q j )                    − c00 (qj )
                                                ζ 00 (ρi )              ∂qj 2   ζ 00 (ρi )
                                          i=1                                      i=1
                                                        n
                                                        X −ζ 000 (ρi )
                              ≤ 2Ψ + (1 − qj )                                  − c00 (qj )
                                                        i=1
                                                            ζ 00 (ρi )3
                              ≤ 2Ψ + Ψ2 Υ(1 − qj ) − c00 (qj ).


                                                                  61
Hence, if Eq. (A.69) holds, the utility of each agent is concave in his security level.
    With a similar argument, one can show that if Eq. (A.69) holds, then in case (b) the utility of
each agent with respect to his security level is concave, completing the proof.

Proof of Theorem 7.3. We first investigate the symmetric equilibrium security profile. Consider a
security profile in which the security level of all agents except agent i is equal to q e and the security
level of agent i is q 0 . In the rest of this section, qi denotes a vector of size i with all entries equal to
q. Assuming that the attack cost function is convex, for a symmetric random network, the attack
decision of the strategic attacker can be stated as,

                                                                                           1−ρ
                          Φ = (ρ1 , . . . , ρn ) where ρi = ρ, for all j 6= i ρj =             .
                                                                                           n−1

Let P̂ (n) = P̃ (A, qe , 1n ) and P̂ (n − 1) = Ev∈V [P̃ (A−v , qe−v , 1̂n )].
    The optimal value of ρ is obtained from the following program:

maximize                                                                                                        (A.80)
                                                                        P̂ (n) − P̂ (n − 1)                      1−ρ
     ρ(1 − q 0 )P̂ (n) + (1 − ρ)(1 − q e )(P̂ (n − 1) + (1 − q 0 )                   e
                                                                                            ) − ζ(ρ) − (n − 1)ζ(     )
                                                                               1−q                               n−1
subject to       ρ≥0                                                                                            (A.81)

     We first show that the utility of agent i with respect to q 0 is always concave if Assumption 3
holds. Using Proposition 3.1, we can rewrite the utility of agent i as follows:

                                                      n                  1
      ui (A, (q 0 , qen−1 ), Φ) = 1 − (1 − q 0 )(ρ       (1 − P̂ (n)) +     (nP̂ (n) − 1)) − c(q 0 ).           (A.82)
                                                     n−1                n−1

Hence, we have
                                                                                                  !
         ∂2                                                  n                 ∂ρ  ∂ 2ρ
               ui (A, (q 0 , qen−1 ), 1̂n ) = −c00 (q 0 ) +     (P̂ (n) − 1) −2 0 + 0 2 (1 − q 0 ) .            (A.83)
        ∂q 0 2                                              n−1                ∂q  ∂q

                                                      ∂ρ               ∂2ρ
We next show that if Assumption 3 holds,              ∂q 0   < 0 and   ∂q 0 2
                                                                                > 0. Showing these two inequalities, in
combination with the fact that P̃ (A, q, Φ) ≤ 1 will guarantee that the utility of agent i is concave.
    Applying the optimality condition of ρ on Eq. (A.81), we obtain

                                                                                 1−ρ
                                     P̂ (n − 1)(q e − q 0 ) = ζ 0 (ρ) − ζ 0 (        ).                         (A.84)
                                                                                 n−1




                                                              62
                                               ∂ρ           ∂2ρ
   Using Eq. (A.84), we can restate            ∂q 0   and   ∂q 0 2
                                                                     as follows:

                                     ∂ρ              −P̂ (n − 1)
                                           =                            1−ρ ,                                                (A.85)
                                     ∂q 0      00
                                             ζ (ρ) + n−1    1
                                                                 ζ 00 ( n−1 )
                                                                                               
                                               ∂ρ 2           000 (ρ) +        1     000 ( 1−ρ )
                                     2
                                    ∂ ρ      ( ∂q 0 )   −ζ                 (n−1)2
                                                                                   ζ       n−1
                                       0 2 =                             1       1−ρ              .                          (A.86)
                                    ∂q                   00
                                                       ζ (ρ) + n−1 ζ ( n−1 )  00


                                                                          ∂ρ
Assuming that ζ() is convex, using Eq. (A.85) it immediately follows that ∂q 0 < 0. Furthermore,
                                                                                   ∂2ρ
                  q
assuming that n ≥ αβ + 1, using Eq. (A.85) and if Assumption 3 holds, we obtain ∂q   0 2 > 0. Com-

bining these two inequalities with Eq. (A.83), it implies that given a symmetric random network,
if Assumption 3 holds then              ∂
                                      ∂ 2 q0
                                             u(A, (q 0 , q e ), Φ) < 0. Furthermore, using Eq. (A.84), one can show
that ρ is continuous in       (q 0 , qe ), therefore u(A, (q 0 , qe ), Φ) is continuous in (q 0 , qe ), completing the
proof.


Proof of Theorem 7.4. As was shown in Theorem 7.3 if Assumption 3 holds, for symmetric large
networks the utility of each agent is always concave. We first study the symmetric socially optimal
solution. Let us denote the symmetric socially optimal security level by q s . In the symmetric
socially optimal solution we have:

                                                                               ∂
                             c0 (q s ) = P̃ (A, qsn−1 , 1̂n ) − (1 − q s )         P̃ (A, qsn−1 , 1̂n ).
                                                                              ∂q s
   We next consider the symmetric equilibrium. Since all agents play the same strategy we have
     1
ρ=   n.   Let us call the symmetric equilibrium security level, q e . Using Eq. (A.82), we can rewrite
the first order condition in the equilibrium as follows:

                                                                      n                            ∂ρ
                 c0 (q e ) = P̃ (A, qen−1 , 1̂n ) − (1 − q e )(          (1 − P̃ (A, qen−1 , 1̂n )) 0 |q0 =qe ).
                                                                     n−1                           ∂q

Applying Eq. (A.85) to the preceding equation, we obtain

                                                                                         Ev∈V [P̃ (A−v , qen−2 , 1̂n )]
           c0 (q e ) = P̃ (A, qen−1 , 1̂n ) + (1 − q e )((1 − P̃ (A, qen−1 , 1̂n ))                                     ).
                                                                                                   ζ 00 ( n1 )

Knowing that the utility of each agent with respect to his security level is concave, to show that
q e ≥ q s it is enough to show that:

                                                                                   Ev∈V [P̃ (A−v , qsn−2 , 1̂n )]
                P̃ (A, qsn−1 , 1̂n ) + (1 − q s )((1 − P̃ (A, qsn−1 , 1̂n ))                                      )
                                                                                             ζ 00 ( n1 )
                                                                              ∂
                                    ≥ P̃ (A, qsn−1 , 1̂n ) − (1 − q s )           P̃ (A, qsn−1 , 1̂n ).
                                                                             ∂q s



                                                                     63
                                                                  nP̃ (A,qsn−1 ,1̂n )
   We first show that − ∂q∂ s P̃ (A, qsn−1 , 1̂n ) ≤                    1−q s           in the symmetric settings for the sym-
metric security profile    qsn .   For a given symmetric security profile qn we can rewrite P̃ (A, qn−1 , 1̂n )
as follows:
                                          n−1
                                          X
                 P̃ (A, qn−1 , 1̂n ) =          bi q i (1 − q)n−i−1 ,
                                          i=0
                                          n−1                                       n−2
              ∂                           X
                                                        i−1             n−i−1
                                                                                    X
                 P̃ (A, qn−1 , 1̂n ) =          ibi q         (1 − q)           −         (n − i − 1)bi q i (1 − q)n−i−2
              ∂q
                                          i=1                                       i=0
                                            n−2
                                            X
                                      ≥−          (n − i − 1)bi q i (1 − q)n−i−2
                                            i=0
                                             n−2
                                             X
                                      ≥ −n              bi q i (1 − q)n−i−2
                                                i=0
                                                  n−2
                                           −n     X
                                      ≥                   bi q i (1 − q)n−i−1
                                          1−q
                                                   i=0
                                         −n
                                      ≥     P̃ (A, qn−1 , 1̂n ).
                                        1−q

Now the condition that should be satisfied will be reduced to,

                                                  Ev∈V [P̃ (A−v , qsn−2 , 1̂n )]     nP̃ (A, qsn−1 , 1̂n )
                   ((1 − P̃ (A, qsn−1 , 1̂n ))                                   ) ≥                       .
                                                            ζ 00 ( n1 )                    1 − qs

Put differently, it is sufficient to show that

                           1                                          Ev∈V [P̃ (A−v , qsn−2 , 1̂n )]
                    nζ 00 ( ) ≤ (1 − q s )((1 − P̃ (A, qsn−1 , 1̂n ))                                .
                           n                                              P̃ (A, qsn−1 , 1̂n )

We next find a lower bound for the right hand side of the preceding relation, which we will denote
it by R. By definition, we have

                             1                         1 n−1
                               ≤ P̃ (A, qsn−1 , 1̂n ) ≤ +          (1 − q s ),
                             n                         n        n
                             1                                    1 n−2
                               ≤ Ev∈V [P̃ (A−v , qsn−2 , 1̂n )] ≤ +            (1 − q s ).
                             n                                    n      n

Using the preceding inequalities, it is easy to show that

                                             1                      1
                                       R≥      (1 − q s )( 1 n−1         s
                                                                           − 1)
                                             n             n + n (1 − q )
                                             n−1          q s (1 − q s )
                                           =                             .
                                               n 1 + (n − 1)(1 − q s )




                                                                    64
One can easily show that the above function is increasing between between q s ∈ [0, 1 −                      √1 ]
                                                                                                              n+1
and decreasing between q s ∈ (1 −         √ 1 , 1].      Furthermore, assuming that q s is the socially optimal
                                           n+1
solution we have
                                                    1
                                              c0−1 ( ) ≤ q s ≤ c0−1 (n).
                                                    n
We then consider the following cases:

   • c0−1 (n) ≤ 1 −      √1 ,
                          n+1

   • c0−1 ( n1 ) ≥ 1 −   √1 ,
                          n+1

   • c0−1 ( n1 ) ≤ 1 −   √1
                          n+1
                                ≤ c0−1 (n).

We will only analyze the first case. Other cases can be analyzed similarly. In the first case, R will
be minimized when q s = c0−1 ( n1 ). Hence, the sufficient condition for having overinvestment is,

                                      1
                                     00   n − 1 c0−1 ( n1 )(1 − c0−1 ( n1 ))
                                   ζ ( )≤                                    .
                                      n    n2 1 + (n − 1)(1 − c0−1 ( n1 ))

Second scenario, will be reduced to:

                                         1    n − 1 c0−1 (n)(1 − c0−1 (n))
                                   ζ 00 ( ) ≤                               .
                                         n     n2 1 + (n − 1)(1 − c0−1 (n))

And the third scenario will be reduced to

                  1        n − 1 c0−1 (n)(1 − c0−1 (n))   n − 1 c0−1 ( n1 )(1 − c0−1 ( n1 ))
            ζ 00 ( ) ≤ min( 2                           ,                                    ).
                  n         n 1 + (n − 1)(1 − c0−1 (n)) n2 1 + (n − 1)(1 − c0−1 ( n1 ))

   Next, we show that when ζ 00 ( n1 ) ≥       1
                                               n   then underinvestment always happen. We first show that
in the symmetric socially optimal solution, we have

                                                         ∂
                    P̃ (A, qsn−1 , 1̂n ) − (1 − q s )        P̃ (A, qsn−1 , 1̂n ) ≥ 2P̃ (A, qsn−1 , 1̂n ).
                                                        ∂q s

Let s denote the seed node. Using Eq. (3.3) for an agent i in the symmetric socially optimal security




                                                              65
profile, we have

              ∂                           X
    − (1 − q s )  P̃ (A, q s
                           n−1 , 1̂ n ) =      Qj,i (A, qs−n−2 , Φ)(1 − q s )
             ∂q s
                                          j6=i
      X                                                      X
    ≥   Qj,i (A, qs−n−2 , Φ|s = i)(1 − q s )P (s = i) +           Qj,i (A, qs−n−2 , Φ|s 6= i)(1 − q s )P (s 6= i)
        j6=i                                                          j6=i
        X
    ≥          Qj,i (A, qs−n−2 , Φ|s               s
                                       = i)(1 − q )P (s = i)
        j6=i
                           1
    = I(A, qs , ei )
                       n(1 − q s )
    = P̃ (A, qsn−1 , 1̂n ),

where the last inequality follows from Theorem 7.1. Since under Assumption 3, the utility of each
agent with respect to his security level is concave, to guarantee that q e ≤ q s , it suffice to show that

                                                                                  Ev∈V [P̃ (A−v , qsn−2 , 1̂n )]
                  P̃ (A, qsn−1 , 1̂n ) + (1 − q s )((1 − P̃ (A, qsn−1 , 1̂n ))                                   )
                                                                                            ζ 00 ( n1 )
                                     ≤ 2P̃ (A, qsn−1 , 1̂n ).

Assuming ζ 00 ( n1 ) ≥ 1, the preceding relation always hold.



A.11    Examples

Example A.1. Consider the network A in Fig. 6. Let n = 100, qa = qa1 = qa2 = 0.5, and qb =
qb1 = . . . = qbn−2 = 0.25. Suppose also Φi = 0.01 for all i = 1, . . . , 100. We show that CI (a1 , A) <
CI (a1 , A−a2 ). By definition, we have
                                                  X
          CI (a1 , A) = Pa1 (A, q, Φ) +                  (1 − qj )(1 − qa1 )Qj,a1 (A, q−{a1 ,j} , Φ)
                                              j∈V −{a1 }
                                                                                                                    
                                                                        X
                        = (1 − qa ) P̃a1 (A, q−{a1 } , Φ) +                  (1 − qj )Qj,a1 (A, q−{a1 ,j} , Φ) .
                                                                     j∈V −{a1 }


The network effect on a1 can be written as

                                                 1
                       P̃a1 (A, q−{a1 } , Φ) =     (1 + (n − 2)(1 − qb ) + (1 − qa )(1 − qbn−2 )).
                                                 n

The second term on the right hand side of this equation corresponds to the event that the seed
agent is in {b1 , . . . , bn } and is susceptible and the third term to the event that the seed agent is
a2 , is susceptible and at least one agent in set {b1 , . . . , bn } is susceptible. Also for each j ∈ B =



                                                                66
                                                     𝑎1           𝑎2




                                       𝑏1    𝑏2                           𝑏𝑛−3 𝑏𝑛−2


Figure 6: For the security profile q where qa = qa1 = qa2 = 0.5 and qb = qb1 = . . . = qbn−2 = 0.25,
CI (a1 , A) < CI (a1 , A−a2 ).


{b1 , . . . , bn−2 }, we have

                                                             1
                                Qj,a1 (A, q−{a1 ,j} , Φ) =     (1 + (n − 3)qa (1 − qb )).
                                                             n

The first term on the right hand side of the above equation corresponds to the event that the seed
agent is a1 and the second term to the event that the seed agent is in B − {j} and a2 is not suscep-
tible. Similarly, we have

                                                                       1
                                     Qa2 ,a1 (A, q−{a1 ,a2 } , Φ) =      (1 − qbn−2 ).
                                                                       n

The right hand side of the above equation is the probability of the event that the seed agent is a1
and at least one of the agents in B is susceptible. Putting these equations together, we obtain

                  1 − qa
CI (a1 , A) =            (1 + 2(n − 2)(1 − qb ) + 2(1 − qa )(1 − qbn−2 ) + (n − 2)(n − 3)qa (1 − qb )2 ) ≈ 14.112.
                    n

Using similar approach, we obtain

                                1 − qa
            CI (a1 , A−a2 ) =          (1 + 2(n − 2)(1 − qb ) + (n − 3)(n − 2)(1 − qb )2 ) ≈ 27.47.
                                  n

Comparing the preceding equations, we observe that CI (a1 , A) < CI (a1 , A−a2 ).


Example A.2. Consider the 5-node star network given in Fig. 1. Let c(q) = 0.2q 2 (2.9 − 1.33q),
             1
and Φi =     5,   for i = 1, . . . , 5. Note that c(q) is not sufficiently convex. One can verify that qe =
(0.2, 1, 1, 1, 1) is a pure-strategy Nash equilibrium security profile and qs = (1, 0.2, 0.2, 0.2, 0.2) is a
socially optimal security profile. The expected infections in the equilibrium is I(A, qe , Φ) = 0.16.
However, expected infections in the social optimum is I(A, qs , Φ) = 0.64.




                                                             67
