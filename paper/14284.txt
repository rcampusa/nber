                               NBER WORKING PAPER SERIES




    BAYESIAN AVERAGING, PREDICTION AND NONNESTED MODEL SELECTION

                                            Han Hong
                                           Bruce Preston

                                       Working Paper 14284
                               http://www.nber.org/papers/w14284


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    August 2008




We thank Raffaella Giacomini, Jin Hahn, Bernard Salanie, Barbara Rossi, Frank Schorfheide and Chris
Sims for comments. We also thank the NSF and the Sloan Foundation for generous research support.
The views expressed herein are those of the author(s) and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2008 by Han Hong and Bruce Preston. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Bayesian Averaging, Prediction and Nonnested Model Selection
Han Hong and Bruce Preston
NBER Working Paper No. 14284
August 2008
JEL No. C14,C52

                                            ABSTRACT

This paper studies the asymptotic relationship between Bayesian model averaging and post-selection
frequentist predictors in both nested and nonnested models. We derive conditions under which their
difference is of a smaller order of magnitude than the inverse of the square root of the sample size
in large samples. This result depends crucially on the relation between posterior odds and frequentist
model selection criteria. Weak conditions are given under which consistent model selection is feasible,
regardless of whether models are nested or nonnested and regardless of whether models are correctly
specified or not, in the sense that they select the best model with the least number of parameters with
probability converging to 1. Under these conditions, Bayesian posterior odds and BICs are consistent
for selecting among nested models, but are not consistent for selecting among nonnested models.


Han Hong
Stanford University
Landau Economics Building
579 Serra Mall
Stanford, CA 94305
doubleh@stanford.edu

Bruce Preston
Department of Economics
Columbia University
420 West 118th Street
New York, NY 10027
and NBER
bp2121@columbia.edu
 Bayesian Averaging, Prediction and Nonnested Model Selection


                                       Han Hong and Bruce Preston1
                                       Previous version: January 2006
                                         This version: August 2008




                                                   Abstract

         This paper studies the asymptotic relationship between Bayesian model averaging and post-
         selection frequentist predictors in both nested and nonnested models. We derive conditions
         under which their difference is of a smaller order of magnitude than the inverse of the square
         root of the sample size in large samples. This result depends crucially on the relation between
         posterior odds and frequentist model selection criteria. Weak conditions are given under which
         consistent model selection is feasible, regardless of whether models are nested or nonnested and
         regardless of whether models are correctly specified or not, in the sense that they select the
         best model with the least number of parameters with probability converging to 1. Under these
         conditions, Bayesian posterior odds and BICs are consistent for selecting among nested models,
         but are not consistent for selecting among nonnested models.

         JEL Classification: C14; C52
         Keywords: Model selection criteria, Nonnested, Posterior odds, BIC




1       Introduction

Bayesian methods are becoming increasingly popular, both as a framework of model selection and
also as a tool of forecasting — see, among others, Fernandez-Villaverde and Rubio-Ramirez (2004a),
Schorfheide (2000), Stock and Watson (2001), Timmermann (2005), Clark and McCracken (2006)
and Wright (2003). These methods are often used to summarize statistical properties of data,
identify parameters of interest, and conduct policy evaluation. While empirical applications of
these methods are abundant, less is understood about their theoretical sampling properties. This
paper provides a starting point for understanding the relation between Bayesian forecast averaging
and frequentist model selection and prediction in a general framework that admits the possibility
of model misspecification.
    1
    Department of Economics, Stanford University and Department of Economics, Columbia University. We thank
Raffaella Giacomini, Jin Hahn, Bernard Salanié, Barbara Rossi, Frank Schorfheide and Chris Sims for comments.
We also thank the NSF and the Sloan Foundation for generous research support. The usual caveat applies.
                                                                                                     2


We study the large sample properties of Bayesian prediction and model averaging for both nested
and nonnested models. We first show that, for a single model, the difference between Bayesian and
frequentist predictors are of smaller order of magnitude than the inverse of the square root of the
sample size in large samples, regardless of the expected loss function used in forming the Bayesian
predictors. This contrasts with the difference between
                                                      MLE    and Bayesian estimators, formed using
                                                        √ 
a variety of loss functions, which is of the order Op 1/ T .

For multiple models, we derive general conditions under which the Bayesian posterior odds place
asymptotically unit weight on the best model with the most parsimonious parameterization. Under
these conditions, the Bayesian average model forecast is equivalent to the frequentist post-selection
forecast up to a term that is of smaller order of magnitude than the inverse of the square root of
the sample size in large samples. These findings essentially combine Schwarz’ original contribution
regarding BIC — that it is an asymptotic approximation to posterior odds — with the insights by
Sin and White (1996) who demonstrate the inconsistency of BIC for selecting among nonnested
models. The conditions we derive are weaker, more general, and allow for a much wider class of
models.

An immediate consequence of multiple model comparison is that Bayesian posterior odds compar-
ison is inconsistent for selecting between nonnested models. While this procedure will select one of
the best fitting models, it does not necessarily choose the most parsimonious model with probability
converging to 1 in large samples. Consistent selection among possibly nonnested models is feasible
using nonnested model selection criteria in the spirit of Sin and White (1996).

Empirical analyses frequently find that forecasts generated from averages of a number of models
typically perform better than forecasts of any one of the underlying models — see, for instance,
Stock and Watson (2001). Our theoretical findings suggest that this can be because the models
under consideration are close to each other and are all misspecified; so that the posterior weights are
non-degenerate among the set of models under comparison. Indeed, it is shown that for nonnested
models, posterior weights will be non-degenerate, as long as the models are sufficiently close to
each other. The case of nested models is more interesting. It turns out that when the two models
are sufficiently far from each other or sufficiently close from each other, the posterior weights will
be degenerate. However, when the two models are “just close enough” but “not too close”, the
posterior weights can be non-degenerate, and, as a consequence, model averaging can outperform
each individual model.

Our results are of interest given the burgeoning use of Bayesian methods in the estimation of dy-
namic stochastic general equilibrium models in modern macroeconomics. See, inter alia, Fernandez-
                                                                                                    3


Villaverde and Rubio-Ramirez (2004a), Schorfheide (2000), Smets and Wouters (2002), Lubik and
Schorfheide (2003) and Justiniano and Preston (2004) for examples of estimation in both closed and
open economy settings. These papers all appeal to posterior odds ratios as a criterion for model
selection. By giving a classical interpretation to the posterior odds ratio, the present paper intends
to provide useful information regarding the conditions under which such selection procedures ensure
consistency. The analysis contributes to understanding the practical limitations of standard model
selection procedures given a finite amount of data.

The paper proceeds as follows. Section 2 describes model assumptions and derives their implications
on the large sample behavior of the likelihood function. Section 3 demonstrates the asymptotic
equivalence between Bayesian and frequentist predictors for a single model under weak conditions.
The rest of the paper generalizes this result to multiple models. Section 4 first derives weak
conditions under which the generalized posterior odds ratio is equivalent to BIC up to a term that is
asymptotically negligible, and under which alternative model selection criteria are feasible to select
consistently between both nested and nonnested models. Section 5 makes use of the asymptotic
equivalence between posterior odds ratio and BIC to derive the relation between Bayesian model
averaging and frequentist post-selection prediction. Finally, section 6 discusses the implications for
our results for non-likelihood-based models, and section 7 concludes.


2   Model assumptions and implications

For clarity of exposition, we identify a model with the likelihood function that is being used to
estimate model parameters. All results extend to general random distance functions that satisfy
the stochastic equicontinuity assumptions stated below.

A parameter β is often estimated by maximizing a random log-likelihood function Q̂ (β) associated
with some model f (yt , β) that depends on observed data yt and parameterized by the vector β:

                                   Q̂ (β) ≡ Q (yt , t = 1 . . . , T ; β) .

For example, under i.i.d sampling of the data, as in Vuong (1989) and Sin and White (1996), the
log-likelihood function takes the form of
                                                 T
                                                 X
                                      Q̂ (β) =         log f (yt ; β) ,
                                                 t=1

which minimizes the Kullback-Leibler distance between the parametric model and the data.

Under standard assumptions, the random objective function converges to a population limit when
the sample size increases without bound. It is assumed that there exists a function Q (β), uniquely
                                                                                                  4


maximized at β0 , which is the uniform limit of the random sample analog
                                           1                 p
                                     sup     Q̂ (β) − Q (β) −→ 0.
                                     β∈B   T

Typically, the following decomposition holds for Q̂ (β):
                               
                      Q̂ β̂ = Q̂ β̂ − Q̂ (β0 ) + Q̂ (β0 ) − T Q (β0 ) + T Q (β0 ) .
                              |      {z      } |          {z       } | {z }
                                                              (Qb)               (Qc)
                                       (Qa)


Under suitable regularity conditions, the following are true:
                                                    √ 
                    (Qa) = Op (1) ,      (Qb) = Op     T ,             (Qc) = O (T ) .

The regularity conditions under which the first equality holds are formally given below. They are
the same as those in Chernozhukov and Hong (2003). They do not require the objective function to
be smoothly differentiable, and permit complex nonlinear or simulation-based estimation methods.
In particular, conditions that require smoothness of the objective function are typically violated
in simulation-based estimation methods and in percentile-based non-smooth moment conditions.
Even for simulation-based estimation methods, it can be difficult for researchers to insure that the
simulated objective functions are smooth in model parameters.

ASSUMPTION 1 The true parameter vector β0 belongs to the interior of a compact convex
subset B of Rdim(β) .

ASSUMPTION 2 For any δ > 0, there exists  > 0, such that
                                                            
                                    1                  
              lim inf P      sup       Q̂ (β) − Q̂ (β0 ) ≤ − = 1.
                  T →∞    |β−β0 |≥δ T

                                                                             p
ASSUMPTION 3 There exist quantities ∆T , JT , ΩT , where JT → −Aβ , ΩT = O (1),
                                       1
                                      √ Ω−1/2
                                                  d
                                          T   ∆T −→ N (0, I) ,
                                        T
such that if we write
                                                                1
                RT (β) = Q̂ (β) − Q̂ (β0 ) − (β − β0 )0 ∆T +      (β − β0 )0 (T JT ) (β − β0 )
                                                                2
then it holds that for any sequence of δT → 0
                                                   RT (β)
                                     sup                        = op (1) .
                                  |β−β0 |≤δT   1 + T |β − β0 |2
                                                                                                     5

                                                 
THEOREM 1 Under assumptions (1), (2) and (3), Q̂ β̂ − Q̂ (β0 ) = Op (1).

                                     
The asymptotic distribution of Q̂ β̂ − Q̂ (β0 ) is also easy to derive in many situations. This
distribution is useful for model selection tests but is not directly used in model selection criteria
developed in section 4. In particular, satisfaction of the information matrix equality, ΩT = −Aβ +
op (1), is not necessary for our discussion of model selection criteria. This is especially relevant
under potential model misspecification.

                                       √ 
ASSUMPTION 4 Q̂ (β0 ) − T Q (β0 ) = Op   T .


Assumption 4 typically follows from an application of the central limit theorem
                               1                      
                                                         d
                              √    Q̂ (β0 ) − T Q (β0 ) −→ N (0, ΣQ ) ,                           (2.1)
                                T
where
                                                                            
                                                     1 
                            ΣQ = lim V ar           √    Q̂ (β0 ) − T Q (β0 ) .
                                                      T

For example, in the case of the log-likelihood function for i.i.d. observations, where
                                 T
                                 X
                      Q̂ (β) =         log f (yt ; β)   and Q (β) = E log f (y; β) ,
                                 t=1

such convergence follows immediately from the central limit theorem: Σ = V ar (log f (yt ; β)).

Beyond the likelihood setting, assumption 4 can in general be easily verified for extreme estimators
based on optimizating random objective functions. These include M estimator, generalized method
of moment estimators and their recent information-theoretic variants. It can be shown to hold for
generalized method of moment estimators regardless of whether the model is correctly specified or
misspecified.

The property of the final term (Qc) is immediate.


3   Bayesian predictive analysis

Consider the Bayesian inference problem of predicting yT +1 given a data set YT with observations
up to T . Typically we need to calculate the predictive density of yT +1 given YT , and for this
                                                                                                         6


purpose need to average over the posterior distribution of the model parameters β given the data
YT :
                                       Z
                       f (yT +1 |YT ) = f (yT +1 |YT , β) f (β|YT ) dβ

                                                                     eQ̂(β) π (β)
                                           Z
                                       =       f (yT +1 |YT , β) R                     dβ.
                                                                     eQ̂(β) π (β) dβ
                                                        
We will assume that f (yT +1 |YT ; β) = f yT +1 |ȲT ; β , where ȲT is a finite dimensional subcompo-
nent of Y . For example, ȲT can be yT , the most recent observation in YT . It is well understood
                                                                                   
that the first-order randomness in the prediction is driven by f yT +1 |ȲT , β . The length of the
                                                                              
prediction interval comprises two parts: the first is due to f yT +1 |ȲT , β and the second is due to
the uncertainty from estimating β. While the second part will decrease to zero as the sample size
T increases, the first part remains constant.

We are interested in the second-order uncertainty in the prediction that is due to the estimation
of the parameter β, and therefore will consider a fixed value ȳ of the random component ȲT and
density
                                               Z
                           f (yT +1 |ȳ, YT ) = f (yT +1 |ȳ, β) f (β|YT ) dβ,              (3.2)

where ȳ can potentially differ from the observed realization of ȲT in the sample. For example, one
might consider out of sample predictions where ȳ does not take the realized value of ȲT .

Point predictions can be constructed as functionals of the posterior predictive density f (yT +1 |ȳ, YT ).
For example, a mean prediction can be obtained by
                                             Z
                         E (yT +1 |ȳ, YT ) = E (yT +1 |ȳ, YT ; β) f (β|YT ) dβ.

A median prediction is given by
                                                Z         x                                  
                                                                                           1
                    med fyT +1 (·|ȳ, Y ) = inf x :            f (yT +1 |ȳ, Y ) dyT +1   ≥     .
                                                                                            2

Under suitable regularity conditions, β̂ is an asymptotic sufficient statistic for the random posterior
distribution and f (β|YT ) is approximately normal with mean β̂ and variance − T1 (Aβ )−1 :
                                                                 
                                             A         1
                                  f (β|YT ) ∼ N β̂, − (Aβ )−1 .
                                                      T
This asymptotic approximation of the posterior distribution of β by a normal distribution is the
key element of the results formally developed in section 4, and forms the basis of the following
asymptotic approximation of the predictive distribution.
                                                                                                               7

                                                                               
The density f (yT +1 |ȳ, YT ) satisfies the approximation, up to order op √1T ,
                  Z                                                      0
                                             dim(β)          1   1
                     f (yT +1 |ȳ, β) (2π)− 2 det (−T Aβ ) 2 e− 2 (β−β̂ ) (−T Aβ )(β−β̂ ) dβ
                                                                          h0 (−Aβ )h
                  Z                          
                                          h          dim(β)         1
               = f yT +1 |ȳ, β̂ + √            (2π)− 2 det (−Aβ ) 2 e−        2     dh.
                                           T

Researchers are most often interested in mean predictions and predictive intervals. Mean prediction
is convenient to analyze because of its linearity property. For instance,
                                           Z
                       E (yT +1 |ȳ, YT ) = E (yT +1 |ȳ, β) f (β|YT ) dβ
                                           Z                       
                                                                 h
                                          = E yT +1 |ȳ, β̂ + √       f (h|Y ) dh.
                                                                  T
If E (yT +1 |ȳ; β) is linear in β, then it is easy to see from the fact that f (h|Y ) is approximately
normal with mean 0 and variance −Aβ−1 that
                                                                            
                                                                        1
                               E (yT +1 |ȳ, YT ) = E yT +1 |ȳ; β̂ + op √     .
                                                                           T
Hence Bayesian mean prediction is asymptotically equivalent up to order                     √1
                                                                                 with frequentist
                                                                                             T   
prediction, where the predictive density is formed using the extremum estimate β̂, f yT +1 |ȳ, β̂ .

And even if E (yT +1 |ȳ; β) is not linear in β, as long as it is sufficiently
                                                                               smooth in β, it is still possible
                                                                 h
to use a first-order Taylor expansion of E yT +1 |ȳ; β̂ + T around β̂ to prove that the same result
                                                               √

holds. Given the generic notation of yT +1 , these arguments also apply without change to more
general functions of yT +1 , in the sense that for a general function t (·) of yT +1 ,
                                                                                   
                                                                               1
                          E (t (yT +1 ) |ȳ, YT ) = E t (yT +1 ) |ȳ, β̂ + op √       .
                                                                                  T
These results can be generalized to nonlinear predictions that can be expressed as nonlinear func-
tions of the predictive density f (yT +1 |ȳ, YT ). For example, median prediction and predictive in-
tervals can readily be constructed. In the following, we will formulate a general prediction as one
that is defined through minimizing posterior expected nonlinear and non-smooth loss functions.

A general class of nonlinear predictors λ̂ (ȳ, YT ) can be defined as the solution to minimizing an
expected loss function ρ (·), which is assumed to be convex:

                         λ̂ (ȳ, YT ) = arg min E (ρ (yT +1 , λ) |ȳ, YT )
                                             λ
                                                Z
                                      = arg min ρ (yT +1 , λ) f (yT +1 |ȳ, YT ) dyT +1 ,
                                            λ
                                                                                                     8


where the predictive density f (yT +1 |ȳ, YT ) is defined in equation (3.2). For example, to construct
a one-sided τ th predictive interval, we can take

                    ρ (yT +1 , λ) ≡ ρτ (yT +1 − λ) = (τ − 1 (yT +1 ≤ λ)) (yT +1 − λ) .

The following focuses on this loss function.

We are interested in comparing λ̂ (ȳ, YT ) to the nonlinear frequentist prediction, defined as
                                            Z                            
                      λ̃ (ȳ, YT ) = arg min ρ (yT +1 , λ) f yT +1 |ȳ, β̂ dyT +1 .
                                          λ

Also define the infeasible loss function, where the uncertainty from estimation of the unknown
parameters is absent, as
                                          Z
                           ρ̄ (ȳ, λ; β) = ρ (yT +1 , λ) f (yT +1 |ȳ, β) dyT +1

                                       =E (ρ (yT +1 , λ) |ȳ, β) .

Then the Bayesian predictor and the frequentist predictor can be written as
                                                Z
                          λ̂ (ȳ, YT ) = arg min ρ̄ (ȳ, λ; β) f (β|YT ) dβ,
                                                λ

and
                                                                      
                                    λ̃ (ȳ, YT ) = arg min ρ̄ ȳ, λ; β̂ .
                                                       λ

The next theorem establishes the asymptotic relation between λ̂ (ȳ, YT ) and λ̃ (ȳ, YT ).


THEOREM 2 Under assumptions (1), (2) and (3), and assuming that for each ȳ, ρ̄ (ȳ, λ; β)
is three times continuously differentiable in β and λ in a small neighborhood of β0 and λ0 ≡
arg minλ ρ̄ (ȳ, λ, β0 ), with uniformly integrable derivatives, then
                                     √                              p
                                       T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) −→ 0.


Note that the condition of this theorem only requires the integrated loss function ρ̄ (ȳ, λ; β) to
be smoothly differentiable in λ and β, and does not impose smoothness conditions directly on
ρ (yT +1 , λ). The results cover predictive intervals, as long as the predictive density given β is
smoothly differentiable around the percentiles to be predicted.

Different loss functions can be used to construct a variety of Bayesian point estimators from the
posterior density. Unless the loss function is convex and symmetric around 0, the corresponding
                                                                                                      9


Bayes estimator
              √is typically different from the frequentist maximum likelihood estimator at the
order of Op 1/ T . In contrast, we found that when different loss functions are used to define
different
    √ predictors,
                    Bayesian and frequentist predictors coincide with each other up to the order
op 1/ T . This is probably a more relevant result concerning loss functions because researchers
are typically more interested in using loss functions to define the properties of predictions, rather
than to define the estimator itself.


4     Posterior odds and consistent model selection

Bayesian averaging is a popular method for making predictions in the context of multiple models.
The weights used in Bayesian averaging are calculated through posterior odds ratios. To generalize
the results in the previous section to multiple models, it is important to understand first the relation
between posterior odds ratio calculation and consistent frequentist model selection criteria. This is
of independent interest given the increasing use of Bayesian methods in economics; particularly the
recent macroeconomics literature on estimation of dynamic stochastic general equilibrium models
which makes use of the posterior odds ratio for model selection and prediction.


4.1    Large sample properties of Bayes factors

The posterior distribution is an integral transformation of the model (f, Q), defined as
                                                 Z
                                                       0
                                    Q̂(β)
                                          π (β) / eQ̂(β ) π β 0 dβ 0 .
                                                               
                                   e

Associated with the posterior distribution is the Bayes factor
                                             Z
                                      PQ × eQ̂(β) π (β) dβ,

where PQ is a prior probability weight of model (f, Q).

The following theorem connects the properties of the Bayes posterior distribution to the extremum
estimator and establishes the relation between the Bayes factor and the extremum estimator analog
of BICs. Under the regularity conditions stated in assumptions 1 to 3, the Bayes factor is asymp-
totically equivalent to using BIC as a model selection criterion. While the relation between Bayes
factor and BIC comes from the original contribution by Schwartz, the conditions in the following
theorem are considerably weaker and more general.


THEOREM 3 Under assumptions (1), (2) and (3), the Bayes factor satisfies the following rela-
                                                                                                          10


tion
                               Z
                      dim(β)                                p                 dim(β)
                  T      2         eQ̂(β)−Q̂(β̂ ) π (β) dβ −→ π (β0 ) (2π)       2     det (−Aβ )−1/2 .


The formal details of the proof are relegated to an appendix. When Q̂ (β) is smoothly differentiable,
intuition can be gleaned by considering the expression:
                         Z                             Z
                      log e  Q̂(β)
                                   π (β) dβ − Q̂ β̂ = log eQ̂(β)−Q̂(β̂ ) π (β) dβ.
                                                                               
It can be approximated up to an op (1) term as follows. First, Q̂ (β) − Q̂ β̂ can be approximated
                                                    √
by a quadratic function centered at β̂, in a size 1/ T neighborhood around β̂:
                                                                 
                                     1             0 ∂ 2 Q̂T β̂         
                        Q̂ (β) − Q̂ β̂ ≈       β − β̂                 β − β̂   .
                                            2               ∂β∂β 0
                 √
Second,
    pin this 1/ T size neighborhood, the prior density is approximately constant around β0 as
π β̂ −→ π (β0 ). The impact of the prior density is negligible except for the value at π (β0 ). Out-
           √
side the 1/ T size neighborhood around β̂, the difference between eQ̂(β) and eQ̂(β̂ ) is exponentially
small, and makes only asymptotically negligible construction to the overall integral.

The appendix proves formally the approximation:
                                                       0 ∂ 2 Q̂T (β̂ )
   Z                                      Z
                                             1
            π (β) dβ − Q̂ β̂ = log π (β0 ) e 2 (
                                                β−β̂ ) ∂β∂β       0 (β−β̂ )
                          
      Q̂(β)
log e                                                                       dβ + op (1)
                                          Z            0
                                             1
                             = log π (β0 ) e 2 (β−β̂ ) T Aβ (β−β̂ ) dβ + op (1)
                                                 dim(β)
                                                                            1
                                                                               
                             = log π (β0 ) (2π) 2 det (−T Aβ )− 2 + op (1)
                                                       dim (β)           1            1
                                     = log π (β0 ) +           log (2π) − det (−Aβ ) − dim (β) log T + op (1) ,
                                       |                  2    {z        2        } 2
                                                                C (Aβ ,β )

where C (Aβ , β) can also depend on the prior weight on the model itself.


4.2    Consistent model selection

Now introduce a competing model, g (Y ; α), α ∈ Λ (generalizing the notations to multiple models
is immediate), where α is estimated by the random log-likelihood function:

                                           L̂ (α) ≡ L (yt , t = 1, . . . , T ; α) .
                                                                                                  11


Similarly to model (f, Q), we assume that the decomposition of

                        L̂ (α̂) = L̂ (α̂) − L̂ (α0 ) + L̂ (α0 ) − T L (α0 ) + T L (α0 )
                                  |       {z      } |           {z       } | {z }
                                        (La)                  (Lb)

satisfies the stochastic order properties
                                                           √ 
                     (La) = Op (1) ,           (Lb) = Op     T ,        (Lc) = O (T ) .

We also assume that assumptions (1), (2), (3) and (4), and subsequently theorems 1, 2 and 3 hold
for model (g, L).

A conventional consistent model selection criterion takes the form of a comparison between
                        
                     Q̂ β̂ − dim (β) ∗ CT       and     L̂ (α̂) − dim (α) ∗ CT ,

where CT is a sequence of constants that tends to ∞ as T goes to ∞, at a rate to be prescribed
below, and dim () indexes the parametric dimension of the model. β̂ and α̂ are maximands of the
corresponding objective functions. The second term in the model selection criteria penalizes the
dimension of the parametric model. For instance, BIC takes CT = log T and AIC adopts CT = 2.

While the discussion so far has focused on parametric likelihood models, all results can be applied
without modification to other non-likelihood-based models, including method of moment models.
They are also applicable to non-log-likelihood random criterion functions that measure other no-
tions of distance between the model and the data generating process, such as the Cressie-Read
discrepancy statistic in generalized empirical likelihood methods.

For non-likelihood-based models, in addition to penalizing the parametric dimension of the model,
the dimension of the estimation procedure, such as the number of moment conditions could also be
penalized as in Andrews and Lu (2001). The goal of the latter penalization term is to preserve the
parsimony of the model and the informativeness of the estimation procedure, thereby improving
the precision of the model with a finite amount of data. To emphasize this possibility, we will adopt
a general notation dim (f, Q) and dim (g, L), rather than dim (β) and dim (α). The first argument
refers to the parametric dimension of the model, while the second argument refers to the dimension
of the information used in the inference procedure regarding model parameters.

For the specific case of the Bayesian (Schwartz) information criteria,
                                
                      BIC = Q̂ β̂ − L̂ (α̂) − (dim (f, Q) − dim (g, L)) × log T

implicitly defining CT = log T . It now will be demonstrated that whether models
                                                                             are nested
or nonnested has important consequences for the asymptotic properties of Q̂ β̂ − L̂ (α̂) and
                                                                                                       12


consistency of the BIC as model selection criterion. The two cases of nested and nonnested models
are treated in turn.


4.2.1    Nested Models

There are two cases of interest: one model is better in the sense that Q (β0 ) 6= L (α0 ) and both
models are equally good in the sense that Q (β0 ) = L (α0 ). Consider the former. Without loss of
generality, let Q (β) be the larger nesting model and L (α) be the smaller model nested in Q (β).
When β0 6= α0 , it is typically the case that Q (β0 ) > L (α0 ). The goal of BIC is to select the correct
model, Q (β), with probability converging to 1. In this case, this will be true because

   BIC = (Qa) − (La) + (Qb) − (Lb) + T (Q (β0 ) − L (α0 )) − (dim (f, Q) − dim (g, L)) × log T,
                             √
         |   {z    } |      {z    } |         {z         }
            Op (1)       Op ( T )           O(T )

will be dominated by +T (Q (β0 ) − L (α0 )), which increases to +∞ with probability converging to
1 as T → ∞. In other words, for any M > 0,

                                            P (BIC > M ) −→ 1.

Hence, BIC selects the correct model with probability converging to 1 if there is one correct model.
More generally, BIC selects one of the correct models with probability converging to 1.

Suppose now that both models are equally good, so that Q (β0 ) = L (α0 ). Because we are discussing
nested models, this also means that β0 = α0 (with the obvious abuse of the notation of equality
with different dimensions), and that Q̂ (β0 ) = L̂ (α0 ) almost surely. In the case of likelihood models,
this means that f (Zt ; β0 ) = g (Zt ; α0 ) almost surely, since g (·) is just a subset of f (·). The true
model lies in the common subset of (β0 , α0 ) and has to be the same model.

In this case, the second term is identically equal to 0:

                     (Qb) − (Lb) = Q̂ (β0 ) − L̂ (α0 ) − (T Q (β0 ) − T L (α0 )) ≡ 0.

Given that the last terms (Qc) and (Lc) disappear as a consequence of the equality Q (β0 ) = L (α0 ),
the BIC comparison is reduced to

                       BIC = (Qa) − (La) − (dim (f, Q) − dim (g, L)) × log T.
                             |   {z    }
                                   Op (1)

The second term, which is of order O (log T ), will dominate. So if dim (f, Q) > dim (g, L), BIC will
converge to −∞ with probability converging to 1. In other words, for any M > 0,

                                        P (BIC < −M ) −→ 1.
                                                                                                    13


Hence, given two equivalent models, in the sense of Q (β0 ) = L (α0 ), the BIC will choose the most
parsimonious model (namely the one with the smallest dimension, either dim (f, Q) or (g, L)) with
probability converging to 1.

It is clear from the above arguments that, instead of using CT = log T , we can choose any sequence
of CT such that CT −→ ∞ and CT = o (T ).


4.2.2   Nonnested Models

Many model comparisons are performed among models that are not nested inside each other. A
leading example is the choice between a nonlinear model and its linearized version. For instance,
in an extensive literature on estimating consumption Euler equations, there has been debate on
the appropriateness of using log-linear versus non-linear Euler equations to estimate household
preference parameters. See, for instance, Carroll (2001), Paxson and Ludvigson (1999), and At-
tanasio and Low (forthcoming). More recently, Fernandez-Villaverde and Rubio-Ramirez (2003)
and Fernandez-Villaverde and Rubio-Ramirez (2004b) show that nonlinear filtering methods render
feasible the estimation of some classes of nonlinear dynamic stochastic general equilibrium models.
Being equipped with model selection criteria to compare multiple non-linear non-nested models is
clearly desirable.

In contrast to the case of nested models, the comparison of nonnested models imposes more stringent
requirements on CT for consistent model selection. Indeed, the further condition on CT that
     √                                                                         √
CT / T −→ ∞ is required in addition to CT = o (T ). As an example, CT = T log T will satisfy
both requirements, but CT = log T will not satisfy the second requirement. Let’s call the model
                                                    √
selection criteria N IC when we choose CT = log T T . To our knowledge these rate conditions are
first due to Sin and White (1996) in the context of smooth likelihood models.

Suppose that Q (β0 ) is greater than L (α0 ), implying model (f, β) is better than model (g, α).
Then, as before, N IC is dominated by T (Q (β0 ) − L (α0 )), which increases to +∞ with probability
                                                                                   √
converging to 1. This is true regardless of whether we choose CT = log T or CT = T log T , since
both are of smaller order of magnitude than T . Hence the behavior of N IC when one model is
better than the other is essentially the same for both nested models and nonnested models.

However, when both models are equally good, so that Q (β0 ) = L (α0 ), NIC comprises the non-
vanishing term

                       (Qb) − (Lb) = Q̂ (β0 ) − L̂ (α0 ) − (T Q (β0 ) − T L (α0 ))
                    √
which is of order O( T ). In contrast to the nested case, it is no longer true that Q̂ (β0 ) ≡ L̂ (α0 )
                                                                                                 14


with probability one when the two models are equally good. Hence the model selection criterion
takes the form

               N IC = (Qa) − (La) + (Qb) − (Lb) − (dim (f, Q) − dim (g, L)) × CT .
                                          √
                      |   {z    } |      {z    }
                         Op (1)       Op ( T )


                                                  √
Hence, for choice of penalty function CT = log T T , or any other sequence that increases to ∞
            √
faster than T , the last term dominates. So if dim (f, Q) > dim (g, L), NIC converges to −∞ with
probability converging to 1, or

                           P (N IC < −M ) −→ 1         for any   M > 0.

Thus, N IC will choose the most parsimonious model among the two models with probability
converging to 1.

In contrast, if the BIC had been used, where CT = log T , then the final term fails to dominate.
The second term, which is random, might instead dominate. It is immediate that model (f, Q)
and model (g, L) will both be selected with strictly positive probabilities. Such model selection
behavior does not have a clear interpretation when a unique ranking of models is desired. While an
analyst may be content with identifying just one of the best fitting models, regardless of whether
it is the most parsimonious or not, the definition of consistency we adopt from the literature seeks
to uniquely rank models given a model selection criterion and a particular set of assumptions. As
such, positive probability weights on multiple models fails our requirements.

While the properties of AIC and BIC for selecting among nested parametric models are well un-
derstood (e.g. see Sims (2001) and Gourieroux and Monfort (1995)), the following theorem serves
to summarize the above discussion about the NIC.


THEOREM 4 Suppose that assumptions (1), (2), (3) and (4) hold for models (f, Q) and (g, L).
Then
                                                                   √
           N IC = Q̂ β̂ − L̂ (α̂) − (dim (f, Q) − dim (g, L)) × log T T

has the following properties for (f, Q) and (g, L) either nested or nonnested:

  1. If Q (β0 ) > L (α0 ) then P (N IC > M ) −→ 1 for all M > 0;

  2. If Q (β0 ) = L (α0 ) and dim (f, Q) − dim (g, L) > 0 then P (N IC > M ) −→ 1 for all M > 0.
                                                                                                    15


4.3   Posterior odds and BIC

The posterior odds ratio between the two models is defined as
                                            R Q̂(β)
                                       PQ     e      π (β) dβ
                                   log    ×R
                                       PL     eL̂(α) γ (α) dα

when the two models have prior probability weights PQ and PL = 1 − PQ . Exploiting the approx-
imation in section 4.1, up to a term of order op (1), the log posterior odds ratio can be written
as
                                               
                          1          1                                              PQ
        Q̂ β̂ − L̂ (α̂) −     dim (β) − dim (α) log T + C (Aβ , β) − C (Aα , α) + log
                            2          2                                              PL
implicitly defining a penalization term CT = log T . It is immediately clear that this expression is
asymptotically equivalent, up to a constant that is asymptotically negligible, to BIC. As discussed
previously, this choice of CT gives a consistent model selection criterion only when comparing
nested models. In the nonnested case, when the null hypothesis contends that two models are
asymptotically equivalent in fit and therefore misspecified, it fails to select the most parsimonious
model with probability converging to 1.

Fernandez-Villaverde and Rubio-Ramirez (2004a) also explore the large sample properties of the
posterior odds ratio in the case of parametric likelihood estimation. They demonstrate, assuming
there exists a unique asymptotically superior model in the sense of Q (β) > L (α), that the pos-
terior odds ratio will select model (f, Q) with probability converging to 1 as T goes to infinity.
Theorem 3 serves to generalize this finding. First, the results presented here are established under
very weak regularity conditions. Second, only by considering a null hypothesis that admits the
possible equivalence of the two models, in the sense that Q (β) = L (α), can a complete classical
interpretation properly be given to the posterior odds ratio as a model selection criterion. Statis-
tically distinguishing models is fundamental to classical hypothesis testing. Given the absence of
prior information in classical estimation it is necessary to entertain the possibility that two or more
models are equally good in a testing framework. The results of this paper are therefore seen to be
couched naturally in the classical paradigm.


4.4   Multiple Models

The previous theorem extends directly to the case of multiple models. Suppose there are a total
of M models, of which k of them are equally good, in the sense of having the same limit objective
function with magnitude Q (β0 ), but the other M − k models have lower valued limit objective
functions. Then with probability converging to 1, both the BICs and the NICs for the k good
                                                                                                     16


models will be infinitely larger than those for the M − k inferior models. In other words, with
probability converging to 1, none of the M − k inferior models will ever be selected by either BIC
or NIC comparison.

However, the behavior of BIC and NIC can be very different among the k best models depending
on whether they are nested or nonnested. If the k best models are all nested inside each other,
both BICs and NICs will select the most parsimonious model with probability converging to 1. In
contrast, if there exist two models that are not nested inside each other, then BIC will put random
weights on at least two models. But NIC will still choose the most parsimonious model among all
the k best models.


5   Bayesian model averaging and post-selection prediction

The results in the previous section can now be applied to study prediction using the average of
two or more models. It is well known that the frequentist asymptotic distribution properties of
post-selection estimation and prediction are not affected by the model selection step, as long as the
model selection criterion is consistent. Here we demonstrate conditions under which the property
of consistent model selection is possessed by the Bayesian prediction procedure (in the sense of
asymptotically placing unitary probability weight on a single model).

With two models (f, Q) and (g, L), we can write the predictive density as

                                   BFQ                               BFL
          f (yT +1 |ȳ, YT ) =             f (yT +1 |ȳ, YT , Q) +           f (yT +1 |ȳ, YT , L)
                                 BFQ + BFL                         BFQ + BFL

where the posterior probability weights on each model are defined as
                            Z                                   Z
                                Q̂(β)
                 BFQ = PQ e           π (β) dβ and BFL = PL eL̂(α) γ (α) dα.


In the case of likelihood models eQ̂(β) = f (YT |β) and eL̂(α) = f (YT |α). In particular, note

                                            f (YT ) = BFQ + BFL

is the marginal density of the data YT . The model specific predictive densities are respectively,

                                                         eQ̂(β) π (β) f (yT +1 |ȳ, β) dβ
                                                     R
                           f (yT +1 |ȳ, YT , Q) =            R
                                                                 eQ̂(β) π (β) dβ
                                                     Z
                                                =         f (yT +1 |ȳ, β) f (β|YT , Q) dβ
                                                                                                              17

                              R
and f (yT +1 |ȳ, YT , L) =       f (yT +1 |ȳ, α) f (α|YT , L) dα. As before, a general class of predictions can
be defined by
                                                    Z
                         λ̂ (ȳ, YT ) = arg min         ρ (yT +1 , λ) f (yT +1 |ȳ, YT ) dyT +1 .
                                                λ

The following theorem establishes the asymptotic properties of the Bayesian predictor formed by
averaging the two models.

THEOREM 5 Suppose the assumptions stated in Theorem 2 hold for both models (f, Q) and
(g, L). Also assume that one of the following two conditions holds:

   1. Q (β0 ) > L (α0 ), (f, Q) and (g, L) can be either nested or nonnested.

   2. Q (β0 ) = L (α0 ) but (f, Q) is nested inside (L, g). In addition, dim (α) − dim (β) > 1.
       √                          p                                             
Then T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) −→ 0, where λ̃ (ȳ, YT ) = arg minλ ρ̄ ȳ, λ; β̂ is formed from
(f, Q).

It is clear from previous discussion that if Q (β0 ) = L (α0 ) and (f, Q) and (g, L) are not nested,
then the weight on neither BFQ nor BFL will converge to 1, and the behavior of f (yT +1 |ȳ, YT ) will
be a random average between the two models.

These theoretical results contrast with the conventional wisdom regarding forecasting: that av-
erages (or some combination) of available forecasting models perform better than any one model
taken in isolation. Recent studies by Stock and Watson (2001), Stock and Watson (2003) and
Wright (2003) adduce evidence consistent with this view. The former papers show that a range
of combination forecasts outperform benchmark autoregressive models when forecasting output
growth of seven industrialized economies and similarly that the predictive content of asset prices
in forecasting inflation and output growth when models are averaged improves upon univariate
benchmark models. The latter paper shows that Bayesian model averaging can improve upon the
random walk model of exchange rate forecasts. Understanding the fundamental cause of this dis-
junction between theoretical and empirical findings is left for future work. However, we offer the
following remarks based on our findings


5.1   Models that are locally close

For forecasts generated from averages of a number of models to perform better than forecasts of
any one of the underlying models, the Bayesian posterior weights have to be asymptotically non-
degenerate among at least two of the models that are being averaged. From the previous analysis,
                                                                                                    18


we have shown that this is possible among nonnested models when two of the models are “equally
good” (Q (β0 ) = L (α0 ).
Our analysis also suggests that among nested models, unless their dimensions are essentially the
same (dim (f, Q) = dim (g, L)), it is most likely that posterior weights will concentrate on one of
the models, either the “best” model or the most parsimonious model. It turns out that it is still
possible for the posterior weights to be non-degenerate among nested models when the two models
are “just close enough” but “not too close”. To see this, suppose that Q (β0 ) − L (α0 ) = h (T ),
where h (T ) is a function of the sample size T . Recall the decomposition for nested models:

                   (Qa) − (La) + T (Q (β0 ) − L (α0 )) − (dim (f, Q) − dim (g, L)) × CT .
                   |   {z    } |          {z         }
                      Op (1)           T ×O(h(T ))

 As long as T ×h (T ) is approximately the same order as CT , the penalization term will not dominate
the second term, and it is then possible for posterior weights to be non-degenerate if the last two
terms happen to approximately offset each other.


6   Generalized nonnested model selection criteria

While results in the previous sections are stated with the parametric log-likelihood function in
mind, they apply without modification to a wide class of random non-likelihood-based objective
functions, assuming direct comparison between Q (β) and L (α) is interpretable. Such interpretation
is possible, for example, when both are constructed as information-theoretic empirical likelihoods
corresponding to a different set of model and moment conditions.

In the case where Q̂ (β) takes the form of a quadratic norm, such as the GMM estimator, it can be
similarly shown that when Q (β0 ) 6= 0, or when the GMM model is misspecified, (2.1) continues to
hold. When Q (β0 ) = 0, or when the GMM model is correctly specified, Q̂ (β0 ) − T Q (β0 ) = Q̂ (β0 )
typically converges in distribution to the negative of the quadratic norm of a normal distribution,
a special case of which is the χ2 distribution when an optimal weighting    √  matrix is being used.
Regardless, Q̂ (β0 ) − T Q (β0 ) = Op (1) implies Q̂ (β0 ) − T Q (β0 ) = Op   T , so that the statement
           √ 
(Qb) = Op      T is valid in both cases.

For non-likelihood Q and L, the integral transformations
                              Z                                   Z
                                Q̂(β 0 )    0                           0
                                               0
                 Q̂(β)                               L̂(α)
                                                           γ (α) / eL̂(α ) γ α0 dα0 ,
                                                                               
                e      π (β) / e         π β dβ and e

can be properly interpreted as distributions. Chernozhukov and Hong (2003) show that estimation
can proceed using simulation methods from Bayesian statistics, such as Markov Chain Monte
Carlo methods, using various location measures to identify the parameters of interest. These
                                                                                                    19


so-called Laplace-type estimators are defined analogously to Bayesian estimators but use general
statistical criterion functions in place of the parametric likelihood function. By considering integral
transformations of these statistical functions to give quasi-posterior distributions, this approach
provides a useful alternative consistent estimation method to handle intensive computation of
many classical extremum estimators such as the GMM estimators of Hansen (1982), Powell (1986)’s
censored median regression, nonlinear IV regression such as Berry, Levinsohn, and Pakes (1995)
and instrumental quantile regression as in Chernozhukov and Hansen (2005).

The following provides two specific examples of generalized posterior odds ratios constructed from
non-likelihood random distance functions. They implicitly deliver a penalization term for the
dimension of the information used in the estimation procedure, though all penalize the parametric
dimension of the model.

It is worth underscoring that while penalization for parameterization is a natural choice for para-
metric likelihood models, in general it is not obvious this is necessarily the most desirable form of
penalty function outside the likelihood framework. In the context of generalized Bayesian inference,
there may be grounds to consider alternative penalty functions that also penalize the dimension
of the estimation procedure. For instance, Andrews and Lu (2001) and Hong, Preston, and Shum
(2003) consider such penalty functions that involve both the number of parameters and the number
of moment conditions. The use of additional moments in GMM and GEL contexts is desirable on
efficiency grounds.

Andrews and Lu (2001) proposed consistent model and moment selection criteria for GMM es-
timation. Interestingly, such selection criteria, which award the addition of moment conditions
and penalize the addition of parameters, can not be achieved using a generalized Bayes factor
constructed from the GMM objective function:
                                                                              T
                                                                            1X
                  Q̂ (β) = −T gT (β)0 WT gT (β) ,      where     gT (β) =       m (yt , β) ,
                                                                            T
                                                                              t=1

                                                             p
for m (yt , β) a vector of moment conditions and WT −→ W positive definite.

With the objective function Q̂ (β) and associated prior PQ , the volume
                         Z
                                                                   1
                     PQ eQ̂(β) π (β) dβ = eQ̂(β̂ ) eC (Aβ ,β ) T − 2 dim(β) × eop (1) ,

only shrinks at a rate related to the number of parameters and not the number of moment condi-
tions. Generalized Bayes factors using the quadratic GMM objective functions do not encompass
the model selection criteria proposed by Andrews and Lu (2001). This is not surprising given the
                                                                                                     20


lack of likelihood interpretation of conventional two-step GMM estimators based on a quadratic
norm of the moments.

The recent literature on generalized empirical likelihood (GEL) estimators proposes an information-
theoretic alternative to efficient two-step method of moment estimators that minimizes a likelihood
distance between the data and the model moments. A GEL estimator is defined as the saddle point
of a GEL function,
                                          
                                     β̂, λ̂ = arg max arg min Q̂ (β, λ) .
                                                    β∈B         λ∈Λ

For example, in the case of exponential tilting
                                       T
                                       X
                                             ρ λ0 m (yt , β)             ρ (x) = ex .
                                                            
                         Q̂ (β, λ) =                             where
                                       t=1

Given the connection between GEL and parametric likelihood models, it is interesting to ask
whether one can define a generalized Bayes factor based on the GELs that mimics the model
and moment selection criteria of Andrews and Lu (2001) and others. We define such a GEL Bayes
factor as
                                       Z
                                                   1
                             GELBF =      R                    π (β) dβ
                                            e−Q̂(β,λ) φ (λ) dλ
where φ (λ) is a prior density on the lagrange multiplier λ. Intuitively, a large volume of the integral
                                          Z
                                            e−Q̂(β,λ) φ (λ) dλ

indicates that λ tends to be large, and therefore that the GMM model (f, Q) is more likely to
be incorrect, or misspecified. Hence, we use its inverse to indicate the strength of the moments
involved in the GMM model. The asymptotic equivalence between this GEL Bayes factor and a
model and moment selection criteria is given in the following proposition.

Proposition 1 Suppose assumptions (1), (2) and (3) hold,     assume also that there are interior
points in the parameter space λ0 and β0 such that T Q̂ β̂, λ̂ − Q (β0 , λ0 ) = Op (1), where Q (β, λ)
is the uniform probably limit of Q̂ (β, λ) /T . Then
                                          1
                  log GELBF = Q̂ β̂, λ̂ + (dim (λ) − dim (β)) log T + Op (1) .
                                               2

As a consequence of this proposition, asymptotically the GEL Bayes factor puts all weight on models
with the best fit Q (β0 , λ0 ), and among models with equal best fit, the one with the largest number of
over-identifying moment conditions dim (λ) − dim (β). Model selection behaviors are undetermined
among models with equal fit and equal number of overidentifying moment conditions.
                                                                                                   21


7   Conclusion

This paper exploits the connections between Bayesian and classical predictions. For predictions
based on minimization of a general class of nonlinear loss functions, we demonstrated conditions
under which the asymptotic distribution properties of prediction intervals are not affected by model
averaging and the posterior odds place asymptotically unitary probability weight on a single model.
This establishes an analogue to the well-known classical result: that asymptotical distribution
properties of post-selection estimation and prediction are not affected by first-stage model selection
so long as the model selection criterion is consistent.

Of course, when confronted with multiple misspecified models, it is clear that there is no unique
approach to model selection. While the number of parameters might appropriately capture model
parsimony in the nested case, this may not necessarily be true in the nonnested case. There may
be better ways to capture model complexity in this instance. Exploring possible criteria is left for
future work.

This paper should not be interpreted as claiming that model selection criteria can be used to the
exclusion of standard measures of model fit. For example, there are a number of single model
specification tests available — see, among others, Newey (1985), Fan (1994) and Hansen (1982) —
which should be applied in assessing model fit. Even the best model chosen by model comparison
methods may be rejected by such specification tests indicating that all models are far from the
true data generating process (see Sims (2003)). Indeed, as emphasized by Gourieroux and Monfort
(1995), hypothesis testing procedures may lead to the simultaneous acceptance or rejection of two
nonnested hypothesis. The former may reflect a lack a data while the latter may suggest the testing
framework is misspecified.

It is also worth noting Bayesian inference often advocates the use of more general classes of loss
function for model evaluation – see Schorfheide (2000) for a recent discussion and promotion of such
an approach. For instance, one potential criticism of ranking models based only on statistical fit and
parameter parsimony, is that such criterion could well give rise to perverse policy recommendations
if the selected model fails to capture important components for the transmission mechanism in the
case of monetary policy. However, this will in general be true for any proposed criterion for ranking
models, whether decision theoretic or purely statistical, and only serves to emphasize that analysis
of this kind is never meant to supersede sound economic reasoning.

What this paper has attempted to treat carefully is whether models can be statistically distin-
guished, given a plausible set of models, finite sample and a particular set of assumptions. It
remains as further work to analyze the statistical properties of general classes of decision theoretic
                                                                                                22


approaches to model selection and whether said approaches resolve the inconsistency of posterior
odds ratios under our assumptions.


References
Andrews, D. (1994): “Empirical Process Methods in Econometrics,” in Handbook of Econometrics, Vol.
 4, ed. by R. Engle, and D. McFadden, pp. 2248–2292. North Holland.

Andrews, D., and B. Lu (2001): “Consistent model and moment selection procedures for GMM estimation
 with application to dynamic panel data models,” Journal of Econometrics, 101, 123–164.

Attanasio, O., and H. Low (forthcoming): “Estimating Euler Equations,” Review of Economic Dynamics.

Berry, S., J. Levinsohn, and A. Pakes (1995): “Automobile Prices in Market Equilibrium,” Economet-
  rica, 63, 841–890.

Carroll, C. D. (2001): “Death to the Log-Linearized Consumption Euler Equation! (And Very Poor
  Health to the Second-Order Approximation),” Advances in Macroeconomics.

Chernozhukov, V., and C. Hansen (2005): “An IV Model of Quantile Treatment Effects,” Econometrica,
  73(1), 245–261.

Chernozhukov, V., and H. Hong (2003): “A MCMC Approach to Classical Estimation,” Journal of
  Econometrics, 115(2), 293–346.

Clark, T. E., and M. W. McCracken (2006): “Combining Forecasts from Nested Models,” working
  paper, Federal Reserve Bank of Kansas.

Fan, Y. (1994): “Testing the Goodness of Fit of a Parametric Density Function by Kernel Me thod,”
  Econometric Theory, 10, 316–356.

Fernandez-Villaverde, J., and J. F. Rubio-Ramirez (2003): “Estimating Nonlinear Dynamic Equi-
  librium Economies: Linear versus Nonlinear Likelihood,” unpublished, University of Pennsylvannia.

       (2004a): “Comparing Dynamic Equilibrium Models to Data: A Bayesian Approach,” Journal of
  Econometrics, 123, 153–187.

         (2004b): “Estimating Nonlinear Dynamic Equilibrium Economies: A Likelihood Approach,” Uni-
  versity of Pennsylvannia, PIER Working Paper 04-001.

Gourieroux, C., and A. Monfort (1995): Statistics and Econometric Models. Cambridge University
 Press, Cambridge, UK.

Hansen, L. (1982): “Large Sample Properties of Generalized Method of Moments Estimators,” Economet-
 rica, 50(4), 1029–1054.
                                                                                                      23


Hong, H., B. Preston, and M. Shum (2003): “Generalized Empirical Likelihood-Based Model Selection
 Criteria for Moment Condition Models,” Econometric Theory, 19, 923–943.

Justiniano, A., and B. Preston (2004): “New Open Economy Macroeconomics amd Imperfect Pass-
  through: An Emprical Analysis,” unpublished, Columbia University and International Monetary Fund.

Lubik, T. A., and F. Schorfheide (2003): “Do Central Banks Respond to Exchange Rate Movements?
  A Structural Investigation,” unpublished, Johns Hopkins University and University of Pennsylvania.

Newey, W. (1985): “Maximum Likelihood Specification Testing and Conditional Moment Tests,” Econo-
  metrica, pp. 1047–1070.

Newey, W., and D. McFadden (1994): “Large Sample Estimation and Hypothesis Testing,” in Handbook
  of Econometrics, Vol. 4, ed. by R. Engle, and D. McFadden, pp. 2113–2241. North Holland.

Pakes, A., and D. Pollard (1989): “Simulation and the Asymptotics of Optimization Estimators,”
  Econometrica, 57(5), 1027–1057.

Paxson, C. H., and S. Ludvigson (1999): “Approximation Bias in Euler Equation Estimation,” NBER
  Working Paper No. T0236.

Pollard, D. (1991): “Asymptotics for Least Absolute Deviation Regression Estimator,” Econometric
  Theory, 7, 186–199.

Powell, J. L. (1986): “Censored Regression Quantiles,” Journal of Econometrics, 32, 143–155.

Schorfheide, F. (2000): “Loss Function-Based Evaluation of DSGE Models,” Journal of Applied Econo-
  metrics, 15, 645–670.

Sims, C. (2001): “Time Series Regression, Schwartz Criterion,” Lecture Note, Princeton University.

         (2003): “Probability Models for Monetary Policy Decisions,” unpublished, Princeton University.

Sin, C. Y., and H. White (1996): “Information Criteria for Selecting possibly misspecified parametric
  models,” Journal of Econometrics, 71, 207–225.

Smets, F., and R. Wouters (2002): “An Estimated Dynamics Stochastic General Equilibrium Model of
  the Economy,” National Bank of Belgium, Working Paper No. 35.

Stock, J. H., and M. W. Watson (2001): “Forecasting Output and Inflation: The Role of Asset Prices,”
  NBER Working Paper 8180.

         (2003): “Combination Forecasts of Output Growth in a Seven-country Data Set,” unpublished,
  Princeton University.

Timmermann, A. (2005): “Forecast Combinations,” in Handbook of Economic Forecasting, ed. by C. W. G.
  Graham Elliott, and A. Timmermann. North Holland.
                                                                                                        24


Vuong, Q. (1989): “Likelihood-ratio tests for model selection and non-nested hypotheses,” Econometrica,
 pp. 307–333.

Wright, J. H. (2003): “Bayesian Model Averaging and Exchange Rate Forecasts,” Board of Governers of
 the Federal Reserve System, International Finance Discussion Papers, No. 779.



A    Proof of Theorem 1

It has been shown (e.g. Pakes and Pollard (1989), Newey and McFadden (1994) and Andrews
(1994)) that under assumptions 1, 2 and 3,
                                   √               ∆T
                                    T β̂ − β0 = −A−1
                                                  β √ + op (1) .
                                                      T
Combined with assumption 3, this implies that
                       √        0 ∆
                                        T 1√        0    √        
       Q̂ β̂ − Q̂ (β0 ) = T β̂ − β0 √ −     T β̂ − β0 (JT ) T β̂ − β0 + op (1) ,
                                        T 2
               
because of RT β̂ = op (1), we can write

                                                 1 ∆T 0   ∆
                               Q̂ β̂ − Q̂ (β0 ) = − √ A−1 β √ T + op (1) .
                                                   2 T       T
                                                          ∆T
The conclusion follows from the assumptions that          √
                                                            T
                                                                = Op (1) and that −Aβ is positive definite.



B    Proof of Theorem 3
                                                 √           
Define β̃T = β0 − T1 A−1
                      β  ∆  T , and define  h  =  T  β  − β̃T   . Then through a change of variables, we
can write
                               Z                  Z     “         ”          
                       dim(β)
                                  Q̂(β)               Q̂ √h +β̃T       h
                     T    2      e      π (β) dβ = e       T       π √ + β̃T dh.
                                                                        T
Chernozhukov and Hong (2003) has shown that (equation A5 of p326) under the same set of
assumptions:
                    Z     “       ”                               
                        Q̂ √h +β̃T −Q̂(β0 )+ 2T
                                              1
                                                ∆0T A−1
                                                     β ∆T
                                                             h
                      e      T                            π √ + β̃T dh
                                                              T
                           p               dim(β)
                         −→ π (β0 ) (2π)      2     det (−Aβ )−1/2 .
                                                                                                                  25


Therefore the proof for theorem 3 will be completed if one can show that
                                             1 0 −1
                                                             
                                                                 p
                            Q̂ β̂ − Q̂ (β0 ) −    ∆T Aβ ∆T −→ 0,
                                               2T
where β̂ is the conventional M estimator, defined as (see Pakes and Pollard (1989)),
                                                            
                                Q̂ β̂ = inf Q̂ (β) + op T −1/2 .
                                                    β

This is indeed the conclusion of Theorem 3.                                                                       


C        Proof of Theorem 2
                          √                                                                                √
Define ψ̂ (ȳ, YT ) =      T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) so that λ̂ (ȳ, YT ) = λ̃ (ȳ, YT ) + ψ̂ (ȳ, YT ) / T . By
definition, ψ̂ (ȳ, YT ) minimizes the following loss function with respect to ψ,
                                 Z                             
                                                           ψ
                                    ρ̄ ȳ, λ̃ (ȳ, YT ) + √ ; β f (β|YT ) dβ.
                                                            T
                     √        
Also define h ≡ T β − β̂ as the localized parameter space around β̂. The implied density for
localized parameter h is given by
                                                1 dim(β)
                                                                       
                                                                    h
                                 ξ (h) = √                  f β̂ + √ |YT .
                                                 T                   T
Then ψ̂ (ȳ, YT ) also minimizes the equivalent loss function of
                                       Z                         
                                                     ψ         h
                            QT (ψ) = ρ̄ ȳ, λ̃ + √ ; β̂ + √         ξ (h) dh
                                                      T         T
where we are using the shorthand notations λ̂ = λ̂ (ȳ, YT ) and λ̃ = λ̃ (ȳ, YT ). For a given ψ, we are
interested in the asymptotic behavior of QT (ψ) as T → ∞. Define
                                         Z                    
                                    ψ                         h                           
             Q̄T (ψ) = ρ̄ ȳ, λ̃ + √ ; β̂ + ρ̄ ȳ, λ̃; β̂ + √      ξ (h) dh − ρ̄ ȳ, λ̃; β̂ .       (C.3)
                                     T                         T
Essentially, Q̄T (ψ) is a first order approximation to QT (ψ). Under the assumptions stated in
Theorem 2, it can be shown that for each ψ, 2
                                                       p
                                     T QT (ψ) − Q̄T (ψ) −→ 0.
                                                                                      “        ”
    2
        As T → ∞, ξ (h) converges in a strong total variation norm in probability to φ h; −A−1
                                                                                            β   , the multivariate
normal density with mean 0 and variance −A−1
                                          β . In fact, the proof of Theorem 3 shows that
                                           Z
                                             hα ξ (h) dh = Op (1) ,
                                                                                         `         ´
for all α ≥ 0. This, combined with the stated assumption that the differentiability of ρ̄ Ȳ , λ; β with respect to λ
and β, implies the stated convergence in probability.
                                                                                                           26


Because QT (ψ) and Q̄T (ψ) are both convex in ψ, and since Q̄T (ψ) is uniquely minimized at ψ ≡ 0,
the convexity lemma (e.g. Pollard (1991)) is used to deliver the desired result that
                                  √                            p
                             ψ̂ = T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) −→ 0.


An alternative proof can be based on a standard Taylor expansion of the first order conditions that
define λ̂ (ȳ, YT ) and λ̃ (ȳ, YT ). This is straightforward but the notations will be more complicated.
End of proof of theorem 2.                                                                             


D     Proof of Theorem 5

It is clear from Theorem 3 and its following discussions that under either one of the stated condi-
tions,
                                             BFQ     p
                                   wQ ≡              →1           as   T → ∞.
                                           BFQ + BFL

It is because from Theorem 3, for constants

                                 CQ = PQ π (β0 ) (2π)dim(β)/2 det (−Aβ )−1/2

and

                                 CL = PL π (α0 ) (2π)dim(α)/2 det (−Aα )−1/2

we can write

                                              CL eL̂(α̂) T − dim(α)/2 (1 + op (1))
               1 − wQ =
                          CQ eQ̂(β̂ ) T − dim(β)/2 (1 + op (1)) + CL eL̂(α̂) T − dim(α)/2 (1 + op (1))
                                                              dβ −dα
                                        CL L̂(α̂)−Q̂(β̂ )
                           (1 + op (1)) C Q
                                            e             T 2
                     =                                       dβ −dα
                                                                     .
                                           CL L̂(α̂)−Q̂(β̂ )
                       (1 + op (1)) 1 + CQ e                 T 2

           p
While wQ → 1 under the stated conditions, the specific rate of convergence depends on the specific
condition stated in Theorem 3. Under condition 1, It is clear that ∃ δ > 0 such that with probability
converging to 1, for all T large enough,

                                                 1 − wQ < e−T δ .                                        (D.4)
                                                                                                        27

                                                                     
On the other hand, when condition 2 holds, we know that L̂ (α̂) − Q̂ β̂ converges to a quadratic
norm of a normal distribution. It can then be shown that
                                            dα −dβ
                                                                 d   CL
                                                                        exp χ̄2 ,
                                                                               
                                        T      2     (1 − wQ ) −→                                    (D.5)
                                                                     CQ

where χ̄2 is typically distributed as the quadratic form of a random vector such as described in
Vuong (1989).

Using the definition of ρ̄ (ȳ, λ; β), and define ρ̄ (ȳ, λ; α) similarly, we can write λ̂ (ȳ, YT ) as the
minimizer with respect to λ of
                  Z                                            Z
              wQ ρ̄ (ȳ, λ; β) f (β|YT , Q) dβ + (1 − wQ ) ρ̄ (ȳ, λ; α) f (α|YT , L) dα.

                                         √                                          √       
As before, define ψ̂ (ȳ, YT ) =          T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) and define h ≡ T β − β̂ .    Then
ψ̂ (ȳ, YT ) equivalently minimizes, with respect to ψ,

                                       QT (ψ) =wQ Q1T (ψ) + (1 − wQ ) Q2T (ψ)

where, with λ̃ ≡ λ̃ (ȳ, YT ),
                                               Z                             
                                                                  ψ        h
                                 Q1T (ψ) =           ρ̄ ȳ, λ̃ + √ ; β̂ + √     ξ (h) dh,
                                                                   T        T
and
                                               Z                     
                                                                  ψ
                                 Q2T   (ψ) =         ρ̄ ȳ, λ̃ + √ ; α f (α|YT , L) dα.
                                                                   T

Now recall the definition of Q̄T (ψ) in equation (C.3) in the proof of theorem 2. Also define
                                                                         
                            Q̃T (ψ) = wQ Q̄T (ψ) + (1 − wQ ) ρ̄ ȳ, λ̃; α̂ .

We are going to show that with this definition
                                                    p
                                  T QT (ψ) − Q̃T (ψ) −→ 0.                                           (D.6)

If (D.6) holds, it then follows again from the convexity lemma of Pollard (1991) and the fact that
Q̃T (ψ) is uniquely optimized at ψ = 0 that
                                           √                             p
                             ψ̂ (ȳ, YT ) = T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) −→ 0.
                                                                                                               28


Finally, we will verify (D.6). With the definition of Q̃T (ψ), we can write
                                                                                   
      T QT (ψ) − Q̃T (ψ) = T wQ Q1T (ψ) − Q̄T (ψ) + T (1 − wQ ) Q2T (ψ) − ρ̄ ȳ, λ̃; α̂ .
                                                        

             p                                                                           p
Because wQ → 1, it follows from the proof of Theorem 2 that wQ T Q1T (ψ) − Q̄T (ψ) → 0. As the
sample size increases, f (α|YT , L) tends to concentrate on α̂, therefore it can also be shown that
                                                             p
                                      Q2T (ψ) − ρ̄ ȳ, λ̃; α̂ → 0.

Now if either condition 1 holds or if condition 2 holds and dα − dβ > 2, then because of (D.4) and
                    p
(D.5), T (1 − wQ ) −→ 0 and the second term vanishes in probability. Finally, in the last case where
dα = dβ + 2 under condition 2, we know from equation (D.5) that
                                               CL   d
                                                   exp χ̄2 = Op (1) .
                                                              
                                   T (1 − wQ ) −→                                               (D.7)
                                               CQ
                                                            
Hence it is also true that T (1 − wQ ) Q2T (ψ) − ρ̄ ȳ, λ̃; α̂ = op (1). Therefore (D.6) holds.    

Remark: It also follows from the same arguments as above that the results of Theorem 5 does not
hold when dα = dβ + 1. In fact, in this case, we can redefine
                                                                               ψ 
                                                               ∂ 
               Q̃T (ψ) = wQ Q̄T (ψ) + (1 − wQ ) ρ̄ ȳ, λ̃; α̂ +    ρ̄ ȳ, λ̃; α̂ √    .
                                                                ∂λ                 T
We can then follow the same logic as before to show that
                                                      p
                                  T QT (ψ) − Q̃T (ψ) −→ 0.

Note that in the definition of
                             Q̄T (ψ) in equation
                                                 (C.3) of Theorem 2, using a second order Taylor
                                      ψ
expansion we can replace ρ̄ ȳ, λ̃ + √T ; β̂ by
                                                                       
                                        1 01                         1
                                         ψ ρ̄λλ ȳ, λ̃; β̂ ψ + op         .
                                        T 2                            T
As such we can write
                         Z                                                                          
                                              h                                                  
        T Q̃T (ψ) − wQ       ρ̄ ȳ, λ̃; β̂ + √     ξ (h) dh − ρ̄ ȳ, λ̃; β̂     − (1 − wQ ) ρ̄ ȳ, λ̃; α̂
                                               T
         1                √                ∂              
       = ψ 0 ρ̄λλ λ̃; β̂ ψ + T (1 − wQ )        ρ̄ ȳ, λ̃; α̂ ψ + op (1) .
         2                                   ∂λ
                                                                           p
                                                            ∂                   ∂
It follows from both (D.7) and the convergence of ∂λ          ρ̄ ȳ, λ̃; α̂ −→ ∂λ ρ̄ (ȳ, λ0 ; α0 ) that

                      √                 ∂              
                                                          d CL          ∂ 0
                          T (1 − wQ )      ρ̄ ȳ, λ̃; α̂ −→    exp χ̄2       ρ̄ (ȳ, λ0 ; α0 )0
                                        ∂λ                  CQ          ∂λ
                                                                                                    29


where λ0 = arg minλ ρ̄ (ȳ, λ; β0 ). Hence again with convexity arguments for uniform convergence
we can show that
                           d           1                     CL              ∂
             ψ̂ (ȳ, YT ) −→ arg min ψ 0 ρ̄λλ (λ0 ; β0 ) ψ +     exp χ̄2           ρ̄ (ȳ, λ0 ; α0 )0 ψ
                                   ψ 2                       CQ                ∂λ
                                                  CL          ∂
                            = − ρ̄λλ (λ0 ; β0 )−1    exp χ̄2      ρ̄ (ȳ, λ0 ; α0 )0 .
                                                  CQ          ∂λ
                                       √                          
In other words, if dβ = dα − 1, T λ̂ (ȳ, YT ) − λ̃ (ȳ, YT ) converges in distribution to a non
degenerate random variable.
