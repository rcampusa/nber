                                 NBER WORKING PAPER SERIES




                               SIMULATION AND ESTIMATION OF
                               NONADDITIVE HEDONIC MODELS

                                           James J. Heckman
                                             Rosa Matzkin
                                             Lars Nesheim

                                          Working Paper 9895
                                  http://www.nber.org/papers/w9895


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      August 2003




This research was supported by NSF-00-99195 to James J. Heckman. We would like to thank Andrew
Chesher, Hidehiko Ichimura and Simon Lee for helpful comments. The views expressed herein are those of
the authors and not necessarily those of the National Bureau of Economic Research.

©2003 by James J. Heckman, Rosa Matzkin, and Lars Nesheim. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Simulation and Estimation of Nonadditive Hedonic Models
James J. Heckman, Rosa Matzkin, and Lars Nesheim
NBER Working Paper No. 9895
August 2003
JEL No. C51

                                           ABSTRACT

       Making use of restrictions imposed by equilibrium, theoretical progress has been made on

the nonparametric and semiparametric estimation and identification of scalar additive hedonic

models (Ekeland, Heckman, and Nesheim, 2002) and scalar nonadditive hedonic models (Heckman,

Matzkin, and Nesheim, 2002). However, little is known about the practical aspects of estimating

such models or of the characteristics of equilibrium in such models. This paper presents

computational and analytical results that fill some of these gaps. We simulate and estimate examples

of equilibrium in the additive hedonic models and provide evidence on the performance of several

estimation techniques. We also simulate examples of equilibria in nonadditive models and provide

evidence on the performance of the nonadditive estimation techniques developed in Heckman,

Matzkin, and Nesheim (2002).

James J. Heckman                              Rosa Matzkin
Department of Economics                       Department of Economics
University of Chicago                         Northwestern University
1126 East 59th Street                         Matzakin@northwestern.edu
Chicago, IL 60637
and NBER
jjh@uchicago.edu


Lars Nesheim
Institute for Fiscal Studies
and University College London
l.nesheim@ucl.ac.uk
1    Introduction

Hedonic models are general equilibrium frameworks that characterize the

pricing of diﬀerentiated goods, viewed as bundles of attributes, and the de-

mand and supply of those goods (attributes) under diﬀerent assumptions

about preferences and technology. They allow for a systematic economic

analysis of the demand and supply of quality. Quality includes enhancement

of the attributes of a good embodied in a unit of the good (such as the at-

tributes of a house or a car as in Rosen, 1974), characteristics of a job (risk

or unpleasantness as in Tinbergen, 1956, Sattinger 1975, 1980, 1993, and in

Thaler and Rosen, 1975) or the amenities oﬀered by an environmental or

recreational improvement (as in Smith and Huang, 1995 and Banzhaf, Sieg,

Smith, and Walsh, 2000). Understanding the structure of demand in mar-

kets for diﬀerentiated products is a crucial ingredient of models of monopoly

pricing (Wilson, 1993; Rochet and Stole, 2001; and Armstrong, 1996). The

hedonic model underlies general equilibrium analyses of local public goods

(Epple, 1987; Epple and Sieg, 1999; and Bayer, 2000) and models in which

social interactions are priced (Nesheim, 2001). The promise of the hedonic

approach is great. It oﬀers insight into the economics of variety and hetero-

geneity in product quality and worker skill which are hallmark features of

                                      1
modern economies. It oﬀers a consistent approach to adjusting price indices

for quality and allowing for valuation of new goods (or environmental oﬀer-

ings) that can be viewed as new packages of old attributes (Lancaster, 1966,

1975; Triplett, 2000; or the essays in Bresnahan and Gordon, 1997). With

hedonic models, it is possible to interpret wage data on heterogeneous labor,

to evaluate alternative policy proposals for workplace safety (as in Kniesner

and Leeth, 1988, 1995), to evaluate proposals to subsidize education and job

training (Teulings and van Rens, 2002; and Tinbergen, 1956), and to examine

their consequences for worker and Þrm welfare and for wage inequality.

   The potential applications of hedonic models are myriad but their appli-

cation and development, except in certain special cases, have been hindered

by computational diﬃculties, approximations that ignore the implications

of equilibrium in the hedonic model, and the widely held belief that iden-

tiÞcation of the structural parameters in a hedonic model is not possible

using data from a single market. Recent theoretical progress has been made

in understanding these issues making use of restrictions imposed by equi-

librium. Ekeland, Heckman, and Nesheim (2002) and Heckman, Matzkin,

and Nesheim (2002) have shown that contrary to the widely held belief that

identiÞcation is impossible in a single market, nonparametric and semipara-


                                     2
metric estimation and identiÞcation of scalar additive hedonic models (Eke-

land, Heckman, and Nesheim, 2002) and scalar nonadditive hedonic models

(Heckman, Matzkin, and Nesheim, 2003) is possible.

   However, little is known about the practical aspects of estimating such

models or of the characteristics of equilibrium in these two classes of models.

This paper presents computational and analytical results that Þll these gaps.

We simulate and estimate examples of equilibrium in these classes of hedonic

models and provide evidence on the performance of several estimation tech-

niques. The simulations show the shapes of the pricing function that result

from various assumptions about the underlying structural parameters in the

economy. The estimation results demonstrate that structural parameters in

an additive economy can be precisely estimated. In addition, these results

demonstrate that in a nonadditive economy nonparametric techniques can

be used to recover estimates of the structural parameters.

   In section 2 we present the general hedonic model. In section 4 we discuss

identiÞcation of the model and conditions suﬃcient for identiÞcation in the

additive and nonadditive cases. In section 5 we discuss estimation of the

model based on the earlier results. In section 6 we present simulation and

estimation results before concluding in section 7.


                                      3
2    General Hedonic Model

We Þrst present a general statement of the classical hedonic model. For speci-

Þcity, consider a labor market setting. Our analysis applies more generally,

but it is useful to have a speciÞc example in hand. Assume a static model.

Consumers (workers) match to single worker Þrms. Workers are heteroge-

neous. They have characteristics (x, ε) where x ∈ X ⊆ Rnx and ε ∈ E ⊆ Rnε

are observable and unobservable (to the econometrician) characteristics that

aﬀect their utility from diﬀerent job types. Firms are also heterogeneous.

They have characteristics (y, η) where y ∈ Y ⊆ Rny and η ∈ H ⊆ Rnη are

observable and unobservable characteristics that aﬀect the output and proÞts

they obtain from diﬀerent job types. Job types have characteristics z ∈ Z

where Z ⊆ Rnz . Z is the set of feasible job types. For example, z could be

a (possibly multidimensional) measure of the riskiness of the job. Alterna-

tively, in a housing market setting, z could be a vector of characteristics of

a neighborhood or a house. We focus attention on the classical case where

nz = nε = nη assuming a smooth equilibrium pricing function. This is the

hedonic model analyzed in Tinbergen (1956), Rosen (1974), Epple (1987)

and Kniesner and Leeth (1988, 1995). It is also the example that has dom-

inated much of the literature on hedonic models. The theoretical analysis,

                                      4
the simulation models, and the empirical results to follow in sections 4 and 6

restrict the analysis further and focus on the scalar hedonic model in which

nz = 1.

   The distribution of consumer characteristics in the population is charac-

terized by the density functions fx and fε both strictly greater than zero in

the interiors of X and E respectively. We assume x is independent of ε. Sim-

ilarly, the distribution of Þrm characteristics are characterized by the density

functions fy and fη also strictly positive in the interiors of their respective

supports. y is independent of ε.

   Workers of type (x, ε) choose jobs of type z to maximize utility. P (z) is

the earnings of workers supplying attribute vector z, which is a disamenity.

To focus on the main ideas, we study the quasilinear utility model (also

known as the transferable utility model in the assignment literature and in

the theoretical public economics literature. See Gretsky, Ostroy, and Zame,

1999 and Wooders, 1994). DeÞne U ∗ (c, z, x, ε) = c −U (z, x, ε) where x and ε

are as deÞned above and c is consumption. For simplicity assume c = P (z),

so workers consume their earnings. More generally, c = P (z) + R where

R is non-labor income, but for ease of exposition, assume R = 0. Workers

who don’t work get reservation utility V0 . We initially restrict our analysis


                                       5
to economies for which the equilibrium price function is smooth. Similar

analyses can be done for economies in which the equilibrium price function

is not smooth. Smoothness is not a generic property of hedonic models,

even when the underlying preferences are smooth.1 Given P (z), a twice

continuously diﬀerentiable price function, and assuming the utility function

is twice diﬀerentiable, for those who choose to work we obtain the following

Þrst order conditions for a maximum



                              Pz (z) − Uz (z, x, ε) = 0.                            (1)



The second order conditions (SOC) require that Pzz0 − Uzz0 be negative def-

inite. Assuming the SOC are satisÞed and using the Implicit Function The-

orem, (1) determines z = s (x, ε) , the quality of the good supplied by each

worker (x, ε) . Assuming Uzε0 is invertible it also determines the inverse map-

ping ε = se (z, x) . Note that se (z, x) implicitly depends on the marginal price

function Pz (z). The two mappings s (x, ε) and se (z, x) are the focus of both

our theoretical and empirical study of the classical hedonic model.

       Firms of type (y, η) demand attribute z and maximize proÞts which are

   1
   For examples of sorting problems with non-smooth pricing functions see Wilson (1993),
Nesheim (2001), and Heckman, Matzkin, and Nesheim (2002).


                                           6
equal to output Γ(z, y, η) minus production costs P (z) where y and η are de-

Þned above. We assume that the production function is twice diﬀerentiable.

If the Þrm hires no workers, reservation proÞts are Π0 . Otherwise, proÞts

are Π (z, y, η, P (z)) = Γ(z, y, η) − P (z) and the Þrst order conditions for a

maximum of each Þrm that enters the market are



                            Γz (z, y, η) − Pz (z) = 0                          (2)



    The second order conditions require that Γzz0 − Pzz0 be negative deÞnite.

Assuming the SOC are satisÞed and using the Implicit Function Theorem, (2)

deÞnes z = d (y, η) , the type of job demanded by each Þrm (y, η) . Assuming

Γzε0 is invertible, it also determines the inverse mapping η = de(z, y) . As on

the supply side, de(z, y) implicitly depends on the marginal price function

Pz (z) .

    In equilibrium, the density of the demanded z must equal the density of

the supplied z for all values of z. To express this condition in terms of the

primitive functions, consider the transformation deÞned by the consumer Þrst

order conditions ε = se (z, x) and x = x. The Jacobian of this transformation
       µ ∂es(z,x) ∂es(z,x) ¶      ³         ´
is det      ∂z       ∂x      = det ∂es∂z
                                      (z,x)
                                              . Assuming that all potential workers
            0        1


                                        7
actually work, this transformation induces a density of consumers supplying

each type of job z. Thus, the Supply Density is


                  Z                             µ            ¶
                                                   ∂e
                                                    s (z, x)
                          fε (e
                              s (z, x)) fx (x) det             dx.
                                                      ∂z
                  X



   Analogous arguments produce the density of z demanded. Consider the

transformation derived from the Þrms’ FOC η = de(z, y) and y = y with
             Ã                    !
                  e
                ∂ d(z,y)   e
                         ∂ d(z,y)        ³ e ´
Jacobian det       ∂z       dy      = det ∂ d(z,y)
                                             ∂z
                                                   . Assuming that all Þrms
                   0        1
enter the market, this transformation induces a density of demand for every

job type z. The Demand Density is:


                  Z                                Ã                !
                            ³        ´                 ∂ de(z, y)
                              e
                          fη d (z, y) fy (y) det                        dy.
                                                           ∂z
                  Y



   Equilibrium in hedonic markets requires that demand and supply be

equated at each point of the support of z. So, equilibrium prices must satisfy

the following second order diﬀerential equation in P (z)


                      Z                            µ           ¶
                                                    ∂es (z, x)
                        fε (es (z, x)) fx (x) det                dx =         (3)
                                                        ∂z
                      X
                      Z                          Ã            !
                                                   ∂ e(z, y)
                                                     d
                        fη (de(z, y))fy (y) det                 .
                                                       ∂z
                      Y



                                           8
      Observe that se (z, x) and de(z, y) implicitly depend on Pz and Pzz0 . In

addition, the solution depends on the structural parameters of the model:

technology of the Þrms Γ, the utility function U of the workers, and the dis-

tributions of Þrms and workers in the population (fx , fε , fy , fη ). Economic

theory implies that marginal products and marginal utilities are nonnega-

tive in most cases. In order for agents to participate in the market, Þrms

and workers must receive wages and proÞts above reservation levels. If not,

equation (3) must be suitably adjusted. These criteria generate the bound-

ary conditions that determine the solution of the diﬀerential equation for

equilibrium prices.

      Equations (1) , (2) , and (3) and the data generated by them are the focus

of our analysis. They determine all the theoretical and statistical properties

of the model. In general, equations like (3) have no closed form solution,

except for the special case of the Tinbergen model, which is developed below

that is not identiÞed in a single cross section. While progress has been made

in understanding such equations in the mathematics and numerical analysis

literature little is known about their solutions in economics.2 The inability

to compute or even characterize the equilibria from this model even in the

  2
    Notable exceptions include Kniesner and Leeth (1995), Teulings (1995), and Nesheim
(2001).


                                          9
cases of a scalar attribute has inhibited application of the hedonic model

to economic problems. It has also hindered understanding of the statistical

properties of hedonic models relevant to identiÞcation and estimation. Our

simulations presented in section 6 help remedy this problem. We Þrst present

the Tinbergen model which implicitly or explicitly has been the point of

departure for all empirical work on hedonics.




3       Tinbergen’s Linear-Quadratic Model

Assume preferences are quadratic in z and linear in c, unearned income R =

0, and that individual heterogeneity (x, ε) only aﬀects utility through the

single index θ = µθ (x) + ε where dim (θ) = dim (z) 3 . Consumers maximize


                                                     1
                       U(c, z, θ, A) = P (z) + θ0 z − z 0 Az.
                                                     2


The conditions determining a consumer maximum are



                                 Pz + θ − Az = 0

    3
    The model in this example was Þrst analyzed by Tinbergen (1956) and has been used
by Epple (1987) and Tauchen and Witte (2001) among others.




                                         10
where Pzz0 − A is negative deÞnite. On the Þrm side, assume the production

function is quadratic in z and that Þrm heterogeneity only aﬀects proÞts

through the single index ν = µν (y) + η where dim (ν) = dim (z). ProÞts are


                                               1
                   Π (z, ν, B, P (z)) = ν 0 z − z 0 Bz − P (z)
                                               2


and the conditions determining a Þrm’s optimum are



                               ν − Bz − Pz = 0



where −(B + Pzz0 ) is negative deÞnite. The distributions of θ and ν in

the population are normal. The distribution of θ is θ ∼ N(µθ , Σθ ), and the

distribution of ν is ν ∼ N(µν , Σν ).

   An arbitrary price function induces a density of demand and a density of

supply at every location z. The equilibrium price function can be found by

equating these densities at every point z and solving the diﬀerential equation

(3) . However, in the linear-quadratic-normal case one can correctly guess that

the solution to the problem is quadratic in z


                                                1
                          P (z) = π 0 + π 01 z + z 0 π 2 z
                                                2

                                        11
and then Þnd the coeﬃcients (π 0 , π 1 , π2 ) that satisfy the equilibrium equa-

tion. Assuming the price function is quadratic, the Þrst order condition for

a consumer is

                           π 1 + π 2 z + θ − Az = 0.                        (4)


For a Þrm, it is

                           ν − Bz − π 1 − π 2 z = 0.                        (5)


The second order conditions require that both A −π 2 and B +π 2 are positive

deÞnite. Thus we may solve for z from (4) to obtain



                           z = (A − π 2 )−1 (θ + π 1 )                      (6)



and from (5) to obtain



                           z = (B + π 2 )−1 (ν − π 1 ).                     (7)



These equations deÞne mappings from workers θ and Þrms ν to job types

z. These mappings determine the density of supply and demand at every

location and the types of workers and Þrms at every location. Equilibrium

is characterized by a vector π 1 and a matrix π 2 that equate demand and


                                       12
supply at all z. However, since both θ and ν are normally distributed, this

only requires equating the mean and variance of supply and demand.

   The mean supply E S (z) is obtained from (4):



             (Average Supply)        E S (z) = (A − π 2 )−1 E (θ + π 1 )



The mean demand is obtained from (7):



            (Average Demand)         E D (z) = (B + π2 )−1 E (ν − π 1 )



Since µθ = E(θ) and µν = E(ν), the condition E S (z) = E D (z) implies that



    (Equality of means)       (A − π 2 )−1 (µθ + π 1 ) = (B + π 2 )−1 (µν − π 1 ) .



Rearranging terms, we obtain an explicit expression for π 1 in terms of A, B, µθ , µν

and π 2 :



     π1 = [(A − π2 )−1 + (B + π 2 )−1 ]−1 [−(A − π 2 )−1 µθ + (B + π 2 )−1 µν ].



   To determine π 2 , compute the variances of supply and demand from (4)



                                         13
and (7) respectively to obtain:



                       ΣSz = (A − π 2 )−1 Σθ (A − π 2 )−1


                                                    −1
                       ΣD             −1
                        z = (B + π 2 ) Σν (B + π 2 )



where ΣSz is the variance of supply and ΣD
                                         z is the variance of demand. From


equality of variances of the demand and supply distributions we obtain an

implicit equation for π2 :



 (Equality of variances)     (A − π 2 )−1 Σθ (A − π2 )−1 = (B + π 2 )−1 Σν (B + π 2 )−1 .



We pin down initial conditions using the restrictions that U ≥ Ū, a reser-

vation value, and proÞts are positive (Π ≥ 0). Equilibrium proÞts as a
                           1 0
function of location are     z (B + π2 )z − π0 . Hence nonnegativity of proÞts
                           2
implies −π0 ≥ 0 since (B + π 2 ) is positive deÞnite by the second order con-

ditions. Setting reservation utility equal to zero, a similar argument on the

worker side implies π 0 ≥ 0. Hence π 0 = 0.

   Once we have solved for π 1 and π 2 , (4) and (7) also deÞne the equilib-

rium matching function linking the characteristics of suppliers (θ) to those



                                       14
of demanders (ν). For each z, this function is



                     (A − π2 )−1 (θ + π 1 ) = (B + π2 )−1 (ν − π 1 ).



Thus, the equilibrium relationship between θ and ν is



                       θ = (A − π 2 ) (B + π 2 )−1 (ν − π 1 ) − π 1 .          (8)



This relationship has important empirical implications as noted by Epple

(1987) and Kahn and Lang (1988). Conditional on location choice, worker

and Þrm characteristics are not statistically independent in equilibrium. There

is a functional relationship between them.

      In the separable case where Σθ , Σν , A, and B are diagonal, π 2 is diagonal.

Eﬀectively, this is a scalar case. In the scalar case, equality of variances

implies that (A − π 2 )2 Σν = (B + π 2 )2 Σθ . Since the second order conditions
                                                                        1        1
imply that A − π 2 > 0 and B + π 2 > 0. DeÞning σ θ = (Σθ ) 2 and σ ν = (Σν ) 2 ,

this means that4
                                           Aσν − Bσ θ
                                    π2 =              .
                                            σθ + σν

  4
      The other root violates second order conditions.




                                             15
                                     −µθ σ ν + µν σ θ
                              π1 =                    .
                                       σθ + σν

π2 , the curvature of the price function, is a weighted average of the curvatures

of workers’ and Þrms’ preference and technology functions. π 1 is a weighted

average of the means of worker and Þrm distributions of heterogenity. In

both cases, the weights depend on the relative variances of worker and Þrm

heterogeneity. If workers are much more heterogeneous than Þrms σ θ >> σ ν ,

π2 will approximately equal B, the curvature of Þrms’ technology. If σ θ = σ ν

and A = B, π 2 = 0 is a solution and the equilibrium price function is linear in
                                           A−B
z. If σ θ = σ ν , but A 6= B, then π 2 =       . In the polar cases when σ θ = 0
                                            2
or σ ν = 0 then there is eﬀectively only one type of consumer or one type of

Þrm respectively. If σ θ = 0 and σ ν > 0, then π2 = A and π 1 = −µθ . Then

prices reveal the parameters of consumer preferences. If σ ν = 0 and σ θ > 0,

π2 = B and π 1 = µν . These two polar cases are discussed in Rosen (1974).

Only in these two polar cases do prices directly reveal consumer preferences

or Þrm productivities respectively. Similar results hold when z, θ, and ν are

vectors. We next turn to an analysis of identiÞcation in the general hedonic

model.




                                           16
4     IdentiÞcation

The most direct approach to estimating hedonic models is to solve the sec-

ond order diﬀerential equation (3) implied by equilibrium for P (z) in terms

of the parameters of preferences, technology and the distributions of tastes

and productivity and to jointly estimate the demand function corresponding

to (2) , the supply function corresponding to (1) and the distributions of un-

observable preference and technology heterogeneity (fη and fε ) exploiting all

of the information in the equilibrium conditions including data on demand,

supply and the pricing function.

    Rosen (1974) suggested an intuitively plausible and computationally sim-

pler two step estimation procedure that has been widely criticized. In step

1 of his procedure, the analyst estimates P (z) from market data. In step

2, the analyst uses Þrst order conditions in conjunction with the marginal

prices obtained from step 1 to recover preferences and technology respec-

tively. Suppose that consumer and Þrm Þrst order conditions (1) and (2) are

linear and z is a scalar. These are exactly the Þrst order conditions (4) and

(5) of the Tinbergen model. (The scalar assumption is made only to simplify

the argument and is not essential.) In this case, for the consumers, equation




                                     17
(1) would be of the form



                        Pz (z) − Az + θ0 + θ01 x + ε = 0                     (9)



For the Þrms, equation (2) would be of the form



                      −Bz + ν 0 + ν 01 y + η − Pz (z) = 0                   (10)



Suppose further that the pricing function is quadratic as in Tinbergen (1956).

Then the Þrst stage of Rosen’s procedure would be to estimate the pricing

function P (z) = π 0 + π 1 z + 12 π 2 z 2 and recover estimates of π
                                                                   b1 and π
                                                                          b2 (“ˆ”

denotes estimate) and the marginal prices Pbz (z) = π
                                                    b1 + π
                                                         b2 z. The second

stage substitutes the estimated prices into (9) and (10) and estimates the

curvature parameters: Thus, Rosen proposed to estimate B and ν 1 from the

least squares regression



                   Pbz (z) = π̂ 1 + π̂ 2 z = ν 0 + ν 01 y − Bz + η.         (11)




                                         18
A parallel proposal for preferences estimates A and θ1 from the regression



                  Pbz (z) = π̂ 1 + π̂ 2 z = −θ0 − θ01 x + Az − ε.        (12)



James Brown and Harvey Rosen (1982) analyze this method. They interpret

(11) and (12) as linearized approximations to the general Þrst order condi-

tions for the model. The linear-quadratic-normal model of Tinbergen (1956)

is the framework in which these approximations are exact.

   In this approximation interpretation, the distributions of η and ε are kept

in the background. Standard linear econometric methods are applied to iden-

tify the parameters of (11) and (12) and connections among the parameters

of preferences, technology and the distributions of tastes and productivity

are not made explicit. Issues of identiÞcation are confused with issues of es-

timation. Common to an entire genre of empirical economics, this literature

focuses on Þnding “good instruments” and misses basic sources of identiÞca-

tion in hedonic models.

   Starting from (11) and (12), Brown and Rosen (1982) make three points

that have been reiterated in the subsequent empirical literature. Point One:

IdentiÞcation Can Only Be Obtained Through Arbitrary Functional Form



                                       19
Assumptions.     Since z is on both sides of (11) and (12), by a property of

least squares, a regression using the constructed price Pbz (z) = π̂ 1 + π̂ 2 z as

the dependent variable in (11) or(12) only identiÞes π 2 . In general, π 2 does

not identify any technology or preference parameter. In the special cases

where there is no variation in preference parameters ε or where there is no

dispersion in η, π 2 identiÞes preference (A) or production parameters (B)

respectively (See Rosen, 1974 or Ekeland, Heckman, and Nesheim, 2002).

   However, if the constructed price is a nonlinear function of z, this ar-

gument no longer holds. The nonlinear variation in Pbz (z) gives an added

piece of information that can help to identify technology and preference pa-

rameters. This identiÞcation strategy works because it rules out collinearity

between z and Pbz (z) , but such nonlinearity is widely viewed as an artiÞcial

source of identiÞcation that is thought to be “arbitrary.” Theorem 1 in Eke-

land, Heckman, and Nesheim (2002) proves that this nonlinearity is a generic

property of equilibrium in the hedonic model. In a parametric framework,

Nesheim (2001) shows that nonlinearity is a robust feature of a hedonic econ-

omy with social interactions. In the context of the Tinbergen economy, this

nonlinearity is generic.

   Point Two: Endogeneity. Even if such “arbitrary” assumptions are made,


                                       20
so that one can use the nonlinearity in Pbz (z) to help identify the parameters

and circumvent Point One, one still faces standard endogeneity problems. z

is correlated with η and ε in (11) and (12) respectively. Moreover, exclusion

restrictions from the other side of the market cannot be justiÞed. The equilib-

rium matching condition requires that η = −ε−(A+B)z −θ0 −θ01 x+ν 0 +ν 01 y

so that conditional on z there is a functional and statistical dependence con-

necting ε, η, z and the regressors. Conditional on z, η, ε, x and y become

stochastically dependent even if in the underlying population initially they

are mutually independent.

   With data from a single market, one is forced to hunt for “clever” instru-

ments with a questionable economic basis. Thus, even if “arbitrary” non-

linearities are invoked, standard instruments may be lacking. In Ekeland,

Heckman, and Nesheim (2002) we show that the economics of the model

guarantees valid instruments even though there are no exclusion restrictions.

In the particular case of equation (10) , when Pz (z) is nonlinear, E (z|y)

is not a linear function of y and so can be used as an instrument for z in

this equation. Hence, generically, E (z|y) is a valid instrument for z. This is

discussed at more length below and holds more generally.

   Point Three: Use of Multimarket Data. Rosen (1974), Brown and Rosen


                                      21
(1982), Epple (1987), and Kahn and Lang (1988) consider estimation of the

Þrst order conditions using multimarket data either across regions or across

time in the same region. In this case, if we assume that preference parameters

common across agents remain constant across markets while distributions

of individual heterogeneity vary across markets, we can use cross market

variation in prices and location choices to estimate the common preference

parameters. However, this identiÞcation strategy relies on assumptions that

can be tested if hedonic models can be identiÞed in a single market. Using

the techniques we discuss later in this paper, the structure of hedonic models

can be estimated and identiÞed using data from a single market for a class

of additive parametric structures that includes the linear model as a special

case.

   Our results invalidate the interpretation that has been given to Brown

and Rosen’s criticism. What has been interpreted as an identiÞcation failure

is in fact the failure of an estimation procedure, coupled with an approach

that disregards basic sources of identiÞcation and mainly focuses on Þnding

exclusion restrictions.   In Ekeland, Heckman, and Nesheim (2002) and in

Heckman, Matzkin, and Nesheim (2002) we show that when there are no

unobservable attributes and some structure is put on preferences and tech-


                                     22
nologies, everything can be identiÞed up to normalizations using single mar-

ket data. In particular, Ekeland, Heckman, and Nesheim (2002) show that

putting an additive structure on preferences is suﬃcient for identiÞcation.

We describe these results in the next section. Alternatively, if the additive

structure is too restrictive or is rejected by the data, Heckman, Matzkin, and

Nesheim (2002) shows that in the nonadditive case alternative assumptions

on preferences can lead to identiÞcation. We describe these results in section

4.2. Both sets of results consider the case where z is unidimensional.



4.1    IdentiÞcation of the additive model

To show that the preferences and technologies generating an hedonic equilib-

rium price function can be identiÞed up to normalizations, using single mar-

ket data and without any exclusion restrictions, suppose that z is one dimen-

sional. Assume further that for unknown functions Mf and nf , the produc-

tion function, Γ(z, y, η), of a typical Þrm is Γ(z, y, η) = Mf (z) + znf (y) + zη.

The Þrms’ Þrst order condition for proÞt maximization (2) becomes



                          Pz (z) = mf (z) + nf (y) + η                       (13)




                                       23
where mf (z) = ∂Mf (z) /∂z, and the second order condition is ∂mf (z) /∂z −

Pzz (z) < 0. This is a special case of (2) and is a signiÞcant generalization of

(10) ; it reduces to (10) when mf and nf are linear functions.

   In a parallel manner, we may assume that the marginal utility is also of

an additive form. The Þrst order condition (1) of the worker becomes



                         Pz (z) = mw (z) + nw (x) + ε



for some unknown functions mw and nw . These equations are the empirical

equations we seek to estimate and the equations that generate the equilibrium

of the model through equation (3) .

   In the empirical analysis, we focus on the Þrms’ equation. The analysis

is analogous for the workers. We have a dataset with observations on N

Þrms drawn at random from a single market. For each Þrm, we observe the

vector (Pz (z) , z, y) . These data are generated from the equilibrium of a single

hedonic market. This implies that for each Þrm, equation (13) holds where

η is unobservable to the econometrician, and mf (z) , nf (y) , and Fη , the

distribution of η, are to be estimated. We assume Pz (z) is known to focus on

the issue of identiÞcation and estimation of the structural parameters. In all



                                       24
cases if Pz (z) is unknown because there is measurement error in prices, then

a two stage procedure can be implemented a la Rosen (1974). First, estimate

Pz (z) , then proceed to estimate (13) replacing the true price slope with the

estimated slope. Alternatively, (13) and the equilibrium price equation (3)

can be estimated simultaneously.

      Much of the identiÞcation analysis is conducted independently of the

equilibrium equation (3); it studies the conditional cumulate distribution

function (CDF) of z implied by (13) and in particular makes use of the

transformation function5



                                T (z) = Pz (z) − mf (z) .



In terms of this function, the CDF of z is



                             Fz|y (z, y) = Fη (T (z) − nf (y))             (14)



where Fz|y (z, y) is the CDF of conditional on y evaluated at the point (z, y)

and Fη is the CDF of η. Diﬀerentiating (14) with respect to z and yi , the i0 th

  5
      See Horowitz (1996).




                                            25
component of the vector y, we have


                  ∂Fz|y (z, y)                       ∂T (z)
                               = fη (T (z) − nf (y))
                      ∂z                              ∂z

                 ∂Fz|y (z, y)                        ∂nf (y)
                              = −fη (T (z) − nf (y))         .
                     ∂yi                              ∂yi

Taking the ratio of the derivatives we have


                                     ∂Fz|y (z,y)           ∂T (z)
                                  −      ∂z                  ∂z
                                    ∂Fz|y (z,y)
                                                       =   ∂nf (y)
                                       ∂yi                  ∂yi


                         Ã                  !
                              ∂Fz|y (z,y)
                             −
DeÞning hi (z, y) = ln            ∂z
                             ∂Fz|y (z,y)        , this equation can be written
                                ∂yi



                                            µ              ¶
                                   ∂T (z)                             ∂nf (y)
                    hi (z, y) = ln                             − ln              (15)
                                    ∂z                                 ∂yi


This implies that hi (z, y) = h0 + h1 (z) + h2 (y) as shown in Ekeland, Heck-

man, and Nesheim (2002) and further that


                                                  Zz
                     T (z) = R1 + K1                   exp (h1 (s)) ds           (16)
                                                   0




                                                 26
                                                Zy
                nf (y) = C0 + K1 exp (−h0 )          exp (−h2 (s)) ds         (17)
                                                0


for some R1 , K1 , .and C0 . Since h0 , h1 , and h2 can be estimated by estimating

the CDF Fbz|y the functions T (z) and nf can be estimated up to the three

unknown constants. This in turn determines mf (z) = Pz − T (z) . Fixing the

constants and Þxing y, the CDF of η can then be estimated as



                             Fbη (e) = Fbz|y (z (e) , y)                      (18)



where z (e) satisÞes


              Zz(e)                                    Zy
 e = −R1 − K1      exp (h1 (s)) ds − C0 − K1 exp (−h0 ) exp (−h2 (s)) ds.
                  0                                            0



   Thus, the parameters mf (z) , nf (y) , and Fη (η) are identiÞed up to the

constants R1 , K1 , and C0 . The derivation of this results suggests an estima-

tion procedure. First estimate Fz|y and calculate hi (z, y) . Then using Pz (z)

and the deÞnition of T (z) , recover mf , ny , and Fη from (16) , (17) , and (18) .

We develop this further in the next section.

   The above procedure leaves the 3 constants undetermined. Additionally,

we can recover the parameter K1 if more information is available. If for


                                         27
example, total output of the Þrm is observable, this information can be used

to recover an estimate of K1 . This is developed further in Ekeland, Heckman,

and Nesheim (2002). Alternatively, if it is known that mf (z) belongs to a
                                                                         P
                                                                         M
known Þnite dimensional vector space V so that mf (z) =                        θj ξ j (z) where
                                                                         j=1

ξ j are the basis functions of the vector space, then we can go one step further

and recover the unknown parameter K1 .
                                  Rz
   To see this,deÞne Te (z) =          exp (h1 (s)) ds. Then using (16) and the deÞ-
                                  0

nition of T (z)
                                             P
                                             M
                                  Pz (z) −         θj ξ j (z) − R1
                                             j=1
                       Te (z) =                                      .                    (19)
                                                 K1

Theorem 2 in Ekeland, Heckman, and Nesheim (2002) proves that generically

Pz (z) does not belong to V. That is, generically Pz (z) is linearly independent

of mf (z) . As a result, a regression of Te (z) on Pz (z) , a constant, and the

functions ξ j for j = 1, ..., M will recover K1 .

   This procedure suggests a two step estimator for K1 . First estimate Te (z)

and then run the regression of Te (z) on Pz (z) , ξ j , and a constant. K
                                                                        b 1 is

the inverse of the coeﬃcient on Pz (z) . Our experience with this estimator

to date is unfavorable. We develop an alternative estimator in section 5.1

that estimates a semiparametric version of the model using semiparametric



                                            28
maximum likelihood where the Monte Carlo results are much better.



4.2    IdentiÞcation of the nonadditive model

Heckman, Matzkin, and Nesheim (2002) have shown that to be able to iden-

tify the preferences and technologies generating an hedonic equilibrium price

function, it is not necessary that the marginal utility and marginal product

functions be additive functions of the types speciÞed in Section 4.1. Under

certain conditions, one can identify nonadditive marginal utilities and nonad-

ditive marginal product functions, using single market data and no exclusion

restrictions. Nonadditive speciÞcations for either of these marginal functions

are capable of generating a much richer set of equilibria, such as, for example,

equilibria exhibiting bunching. Hence, it is important to be able to allow for

these more ßexible types of speciÞcations when estimating preferences and

technologies.

   Since the arguments for the identiÞcation and estimation of the marginal

product function are analogous to those used to establish the identiÞcation

of the marginal utility function, we will discuss only the latter. From the

analysis in Section 2, it follows that from the Þrst and second order condi-

tions of proÞt maximization by a worker, we can establish the existence of


                                      29
a supply function z = s(x, ε), where z denotes the quality or type of labor

supplied by a worker with observable characteristic x and unobservable char-

acteristic ε. The function s is strictly increasing in ε if Uzε < 0. Assume, as

in the previous sections, that ε is distributed independently of x, then by the

arguments introduced in Matzkin (1999), and further developed in Matzkin

(2003), it follows that, subject to some normalizations, the function s and

the distribution of ε can be nonparametrically identiÞed from the conditional

distribution of z given x. Knowledge of the function s and of the distribution

of ε, together with knowledge of Pz , allow one to identify the marginal utility

function, from the Þrst order conditions of utility maximization. This last

step requires a separability restriction on the marginal utility function, of the

type studied in Matzkin (2002, 2003).

   To present one such set of separability restrictions and normalizations,

suppose that for some unknown function m, which is strictly increasing in

its Þrst argument and strictly decreasing in its second argument



                          Uz (z, x, ε) = m (q (z, x) , ε)



where q is a known function, which is strictly increasing in each argument.



                                        30
Normalize the values of the unknown function m, by requiring that for some

value x of x, and for all t



                              m (q (t, x) , t) = Pz (t)



Then, as it is shown in Heckman, Matzkin, and Nesheim (2002), under these

restrictions and normalizations, both the distribution of ε and the function

m, are nonparametrically identiÞed from the conditional distribution of z

given x.

   The weak separability restriction in Uz allows one to recover the marginal

utility when the supply function is given. The normalization that Þxes the

value of the function m at one point of x allows one to recover the supply

function s and the distribution of ε from the conditional distribution of z

given x. To see this last point, note that the normalization restriction together

with the Þrst order conditions imply that for all ε



                                    s (x, ε) = ε




                                         31
since, when x = x and z = ε



                      Uz (ε, x, ε) = m (q (ε, x) , ε) = Pz (ε) .



The strict monotonicity of s in ε and the statistical independence between x

and ε, imply that, for all values of x and ε,



           Fε (e) = Pr (ε ≤ e) = Pr (ε ≤ e|x) = Pr (s (x, ε) ≤ s (x, e))



and that



         Pr (s (x, ε) ≤ s (x, e)) = Pr (z ≤ s (x, e) |x) = Fz|x (s (x, e)) .



Letting x = x, this implies that



                        Fε (e) = Fz|x (s (x, e)) = Fz|x (e)



Hence, we can recover the distribution of ε from the conditional distribution

of z given x = x. Next, since for all x and e, Fε (e) = Fz|x (s (x, e)) , it follows




                                         32
that, under conditions guaranteeing that Fz|x is strictly increasing,


                                −1              −1
                                                    ¡        ¢
                    s (x, e) = Fz|x (Fε (e)) = Fz|x  Fz|x (e)                    (20)



Hence, we can recover the function s from the conditional distribution of z

given x. (See Matzkin (2003) for details.)

   To see that under the separability restriction, the function m is identiÞed,

let (t1 , t2 ) denote a vector on the domain of m. Find x∗ such that



                                 q (s (x∗ , t2 ) , x∗ ) = t1                     (21)



Then, since by the deÞnition of m and the Þrst order conditions of utility

maximization



               m (t1 , t2 ) = Uz (s (x∗ , t2 ) , x∗ , t2 ) = Pz (s (x∗ , t2 ))   (22)



it follows that, from knowledge of the function s and of the marginal price

function, we can recover the function m, which gives the values of the marginal

utility function (See Heckman, Matzkin, and Nesheim (2002) for details).

Estimation of the function m and the distribution of ε follows the steps


                                             33
described above and is detailed in section 5.2.




5    Estimation

Several estimation techniques are available to implement the analysis pre-

sented in sections 4.1 and 4.2. All make use of the structure that the additive

and nonadditive models impose on Fz|y . In the case of the nonadditive model,

a fully nonparametric estimator is described in section 5.2. In the case of

the additive model, this information is suﬃcient to identify the structural

parameters up to location and scale. Additionally, if parametric restrictions

are placed on mf (z) in the additive model, the generic nonlinearity of the

hedonic model can be exploited to estimate the scale. To show how this

scale parameter can be estimated and for ease of exposition in developing

an estimator and presenting the estimation results for the additive model,

we focus on a semiparametric estimator that exploits knowledge of the func-

tional forms of mf (z) and nf (y) but which makes no further assumptions on

the distribution of η. This estimator is semiparametric in that mf and nf are

known up to a Þnite dimensional parameter set while the distribution of η is

unknown. We also restrict the exposition to the case where the dimension of



                                      34
y is 1. We develop this estimator for the additive model in the next section.



5.1    Estimation of the additive model

In our limited Monte Carlo investigations, we generate data from and develop

an estimator for speciÞcations of mf (z) and nf (y) in (13) that are linear in

the parameters. The Þrst order condition (1) may then be written:


                                  Nzf
                                  X             X
                                                Nν
                                          i
                      Pz (z) =          βiz +         ν j y j + η.                   (23)
                                  i=0           j=0



We assume that a random sample of data on (Pz (zn ) , Pzz (zn ) , zn , yn ) for

n = 1, ..., N are available for a single market. To focus on the estimation of

preferences or technology we assume that Pz (z) and Pzz (z) are known. If

instead prices were observed measured with error, the technique described

below would need to be augmented to allow for estimation of the pricing

function. The technique exploits all the information in the model and uses

the generic nonlinearity in the model to identify not only the shape of the

marginal product function but also the scale.
                     N
                     Pzf                          P
                                                  Nν
   Using mf (z) =          β i z i and nf (y) =         ν j y j , the density of the n0 th
                     i=0                          j=0




                                         35
observation zn conditional on yn is

                                                                                                           
                                       Nzf                                                    Nzf
                                       X                 X
                                                         Nν                                   X
fz|y (zn , yn ) = fbη Pz (zn ) −            β i zni −         ν j ynj  · Pzz (zn ) −              iβ i zni−1 
                                       i=0               j=0                                  i=1



where
                                                      X
                                                      N          µ             ¶
                                                                     ηk − η
                            fbη (η) = (Nh)       −1
                                                            K
                                                      k=1
                                                                        h

is the kernel density estimator of fη . We propose to estimate the parameters

by maximizing the likelihood function for the sample.

    Let β and ν be the vectors of parameters excluding β 0 and ν 0 . The

log-likelihood function for the sample is

                                                                                                       
                                                                   Nzf
                           X
                           N                                       X                         X
                                                                                             Nν
 l (β, ν, β 0 , ν 0 ) =          ln fbη Pz (zn ) − β 0 −                  β i zni − ν 0 −         ν j ynj  +
                           n=1                                       i=1                     j=1
                                                                          
                                                         Nzf
                           X
                           N                             X
                                 ln Pzz (zn ) −               iβ i zni−1 
                           n=1                           i=1



which simpliÞes to

                                                Ã                 !
                                       X
                                       N               X
                                                       N
                          l (β, ν) =         ln (Nh)−1   K (ξ kn ) +
                                       n=1                        k=1
                                                                       
                                                      Nzf
                          X
                          N                           X
                                ln Pzz (zn ) −             iβ i zni−1 
                          n=1                         i=1



                                                   36
where

                                            N
                                            Pzf                         P
                                                                        Nν       ¡          ¢
                  Pz (zk ) − Pz (zn ) −            β i (zki − zni ) −         ν j ykj − ynj
                                            i=1                         j=1
         ξ kn =
                                                       h


It is immediately obvious that β 0 and ν 0 are not identiÞed; they drop out

of the expression for ξ kn . We ignore them in the rest of the discussion. It

is also immediate that the parameters β are identiÞed if and only if Pz (z)

is not a polynomial of degree less than or equal to Nzf . Theorem (1) in

Ekeland, Heckman, and Nesheim (2002) guarantees that generically the slope

parameters in β are identiÞed. The maximum likelihood estimators of β and ν
                                                                                        N
                                                                                        Pzf
are found by maximizing the log-likelihood subject to Pzz (zn ) −                             iβ i zni−1 >
                                                                                        i=1

0 for all n. An estimator of fη is


                                                   X
                                                   N         µ            ¶
                                                                 b
                                                                 ηk − η
                         fbη (η) = (Nh)       −1
                                                         K
                                                   k=1
                                                                    h


                         N
                         P     bi z i − P b
                          zf            Nν
where b
      η k = Pz (zk ) −         β   k       ν j ykj .
                         i=1            j=1




                                               37
5.2    Estimation of the nonadditive model

The most direct procedure to estimate the function m and of the distri-

bution of ε in the nonadditive model follows the steps described in section

4.2. First, Fz|x is estimated nonparametrically using data on the joint dis-

tribution of (z, x) . this nonparametric estimator is Fbz|x Then this estima-

tor is substituted into equation (20). This deÞnes an estimator of s (x, ε) ,
                  ³        ´
sb (x, e) = Fbz|x
              −1 b
                   Fz|x (ε) . Heckman, Matzkin, and Nesheim (2002) have

shown that when Fbz|x is a kernel estimator for Fz|x , deÞned by

                                    PN       ¡   ¢ ¡        ¢
                                          e t−zi K x−xi
                                          K
                      Fbz|x (t) =    i=1
                                         PN    σ
                                                 ¡ x−xi ¢ σ

                                           i=1 K    σ



                              e is the integral of a kernel function, and σ is
where K is a kernel function, K

a bandwidth, the estimators for the distribution of ε and for the function m

are consistent and asymptotically normally distributed. Finally, using this

estimator sb (x, ε) , data on the marginal price Pz (z) , and equations (21) and

(22) , m is estimated as



                                              s (x∗ , t2 ))
                           m (t1 , t2 ) = Pz (b                            (24)




                                           38
where x∗ solves q (b
                   s (x∗ , t2 ) , x∗ ) = t1 .




6     Simulation and estimation results

In this section, we present simulation results from a range of speciÞcations

of 3 basic hedonic models. In each case, these simulations show the shape of

the equilibrium pricing function, the population density at each point z, and

the generic nonlinearity of the hedonic model. The accompanying estimation

results demonstrate the performance of the estimation techniques described

in sections 5.1 and 5.2.

    Models 1 and 2 are examples of additive hedonic models. For these models

we study the equilibria for several sets of parameter values and study how

the shape of the equilibrium price varies with alternate parameter values.

Then we simulate data from these sample hedonic economies and test the

performance of the estimation techniques on the simulated data. For each

model we simulate data from 15 parameter speciÞcations. For each speciÞ-

cation, we generate 100 independent samples each with 1000 observations.

Using these simulated data, we estimate the parameters using the technique

described in section 5.1. The mean and the variance of the parameter es-



                                                39
timates are compared with the true parameter values used to generate the

simulated data.

   Model 3 is an example of a nonadditive hedonic model. The estimation

technique that is used to estimate the parameters of the additive models is

not applicable to data generated from the nonadditive economy. Instead,

the technique from section 5.2 must be used. For model 3, we simulate data

from a sample economy and study the performance of the nonadditive model

estimator described in section 5.2.

   All models are completely speciÞed by the Þrms’ technology Γ (z, y, η) ,

the workers’ utility U (z, x, ε) , and the distributions of Þrm and worker het-

erogeneity fy , fη , fx , and fε . For each model, these objects are speciÞed and

then standard numerical methods are used to approximate Pz (z) the solu-

tion to the equilibrium diﬀerential equation (3) . Throughout the exposition

below φ (x, µ, Σ) denotes the density function of a normal random variable

with mean µ and covariance Σ. Model 1 is a quadratic model with non-

normal heterogeneity. Model 2 is an additive model in which mf , nf , mw ,

and nw are low degree polynomials. For both models we discuss features of

the equilibrium price function, simulate data, and estimate the structural

parameters describing Þrm technologies. Model 3 is a nonadditive model in


                                       40
which Þrms are homogenous and workers have Cobb-Douglas utility. It is

described further below.



6.1    Model 1: SpeciÞcation and simulation results

The simplest generalization of the normal-quadratic Tinbergen model is the

quadratic hedonic model with non-normal heterogeneity. This model speci-

Þcation imposes Nzf = 1 and Nν = 1 in equation (23) and in the analogous

equation for workers. However, in contrast to the classical Tinbergen model,

this model allows the heterogeneity parameters to be distributed as a mix-

ture of normals. Details of model 1 are given in Table A1 in appendix A.

This table details the exact functional forms that describe the model.

   For this model, preliminary investigations simulated pricing functions for

a large number of speciÞcations. In all of these speciÞcations, parameters

were restricted to cases where worker and Þrm heterogeneity were distributed

as mixtures of normals each with two components in the mixture. The ex-

treme cases of these speciÞcations include the Tinbergen-normal case when

the weights on the two components of the mixture are 0 and 1 or 1 and 0. In

this set of speciÞcations the parameters that most aﬀected the shape of the

pricing function were the mean and variance of worker and Þrm heterogeneity


                                     41
and the weights on the components of the mixture of normals distribution.

In all cases the curvature of the pricing function is a linear combination of

the curvatures of worker preferences and Þrm technologies. (See Ekeland,

Heckman, and Nesheim, 2002 and Heckman, Matzkin, and Nesheim, 2002).

      From among the speciÞcations investigated we selected 15 to report here.

The speciÞcations are detailed in Tables A2 and A3. The tables list 5

speciÞcations. For each of these speciÞcations we allowed the parameter

λη1 = λε1 = λ to vary from 0.1, to 0.5, to 0.9.6 Thus there are 3 variations of

each of 5 speciÞcations. SpeciÞcations 1 and 5 represent two extreme cases

and speciÞcations 2-4 represent linear combinations of those cases.

      The price functions associated with each speciÞcation are depicted in

Figures 1-20. For each economy, we display the slope of the price function,

the population density at each location z, and the curvature of the price

function. Figures 1-10 show how the slope, the curvature, and the density

vary as λ varies from 0.5 to 0.9 to 1.0. Figures 11-20 show how the slope,

curvature, and the density vary as λ varies from 0.0 to 0.1 to 0.5. The Þgures

largely tell the same story. When λ = 0.0 or 1.0, the slope is a straight

line, the curvature is constant, and the density is a normal density. However,

  6
    The cases in which λ = 0 and λ = 1, the Tinbergen, normal-quadratic cases, are
displayed in the Þgures for comparison.


                                       42
when λ = 0.1 or 0.9 the slope is not a straight line, the curvature is not

constant, and the density is not a normal density. These deviations from the

Tinbergen case are even stronger when λ = 0.5. The Þgures also show that

the slope of the price function deviates most sharply from a straight line in

the two extreme cases, speciÞcation 1 and speciÞcation 5. All the Þgures

show however, that the curvature deviates strongly from a constant when

heterogeneity is not normal. The closer the distribution of heterogeneity is

to normal, the closer the curvature is to a constant.



6.2    Model 1: Estimation results

The pictures described in the previous section show that there is nonlinearity

in the marginal price function and non-constancy in the curvature of the price

function when heterogeneity is not normally distributed in the population in

this quadratic model. The question remains, is that nonlinearity suﬃcient

to estimate the structural parameters in the model with precision? To shed

light on this question, we generated data from the 15 speciÞcations described

in the previous section and in Tables A2 and A3 and estimated the Model 1




                                     43
version of equation (23) ,



                        Pz (z) = −Bz + ν 0 + ν 01 y + η



We generated 100 datasets each of sample size 1000 for each speciÞcation

and then estimated the parameters B and ν 1 using the technique discussed

in section 5.1. The results are displayed in Tables A4, A5, and A6. Table

A4 displays results for each of the 5 speciÞcations listed when λη1 = λε1 =

λ = 0.5. Table A5 displays results for each speciÞcation when λ = 0.9 and

Table A6 displays results for each speciÞcation when λ = 0.1. The contrast

between Table A4 and Tables A5 and A6 give some indication of how much

the precision of the results deteriorate when the economy is closer to the

normal-quadratic Tinbergen economy which is not identiÞed.

   First consider the results in Table A4. The bias of the maximum likeli-

hood (ML) estimator is never larger than 0.04. The standard errors range

from 0.0349 in speciÞcation 1 to 0.287 in speciÞcation 4. SpeciÞcations 3 and

4 have the highest standard errors. Looking at Tables A2 and A3, these are

the speciÞcations in which the two components of the mixtures of normals

distribution are most similar. That is, these are the two speciÞcations that



                                      44
are closest to being not identiÞed.

   Table A5 and A6 investigate how the results in Table A4 change when λ =

0.9 and 0.1. In these cases, the distributions or worker and Þrm heterogeneity

are closer to being normally distributed and the price function is closer to

being linear. In these cases, the ML results are essentially unchanged. The

bias of the ML estimator is the same order of magnitude. The biggest increase

is for speciÞcation 4 when λ decreases from 0.5 to 0.1. In this case, the bias

of the ML estimator increases from 0.02 to 0.12. This is still less than 7% of

the parameter value. The standard errors of the estimates increase slightly.

The biggest increase when λ increases from 0.5 to 0.9 is in speciÞcation 1

when the standard errors increase from 0.0349 and 0.0518 to 0.12 and 0.194.

This is nearly a four-fold increase. Yet the standard errors after the increase

are still only 12% and 20% of the parameter values.

   The results indicate that the ML estimator can provide very good pa-

rameter estimates in a range of speciÞcations. These results apply to the

linear-quadratic model of Tinbergen with non-normal heterogeneity and to

the linear approximations of Brown and Rosen (1982). Far from not being

identiÞed, the parameters are estimated with a high degree of precision.




                                      45
6.3    Model 2: Simulation results

The results in Ekeland, Heckman, and Nesheim (2002) apply to additive mod-

els more general than the quadratic model. Model 2 generalizes Model 1 by

replacing the linear-quadratic terms in the production and utility functions

with nonlinear terms. Model 2 is detailed in Table A7. The speciÞcation

was chosen so that every function is a polynomial, ν (y) is strictly increas-

ing (ν 1 > 0), θ (x) is strictly increasing (θ1 > 0), and mf (z) < mw (z) This

last restriction rules out bunching. The speciÞcation allows the curvatures

of utility and preferences to be ßexible and vary with z. It also allows for a

ßexible relation between preference heterogeneity ν (y) and observable Þrm

traits y. While the power series representations detailed in Table A7 could

be replaced with orthogonal polynomial representations or representations

based on other basis functions, the power series representations were chosen

for ease of exposition.

   It was more costly in terms of computer time to simulate equilibria and

generate data from model 2. We studied a more limited set of speciÞcations.

In particular 5 speciÞcations were chosen at random from a compact parame-

ter space. The Þve chosen are detailed in Tables A8 and A9. The parameters

that were allowed to vary across speciÞcations include β, ν 1 , µη , σ η , α0 , α1 ,


                                        46
µε , and σ ε . These parameters govern the curvature of the Þrms’ technology,

the minimum slope of ν (y) , the mean and variance of unobservable Þrm het-

erogeneity, the curvature of worker preferences, and the mean and variance

of worker heterogeneity.

   Figures 21-30 display the slope of the price function, the curvature of

the price function, and the density of z for speciÞcations 1 through 5. For

each speciÞcation, three variations are plotted; one with λ = 0.5, one with

λ = 0.9, and one with λ = 1.0. Similar graphs depicting the case in which

λ = 0.0 and 0.1 are available from the authors upon request. Clearly a wide

variety of shapes of the price function are possible. In all cases, it appears

as if the price function might be well approximated by a quadratic or a

cubic but there are sharp deviations from these shapes. Simple quadratic

or cubic approximations to the price function would miss these important

deviations. Also, noteworthy is the shape of the equilibrium density of z.

In all the cases displayed, this density has many modes and is far from

being a normal density. In particular, this model is capable of generating

equilibria in which there are nearly gaps in the range of products marketed.

In Þgure 21, the fraction of Þrms demanding z < 1 is positive and large,

the fraction demanding z ∈ (1, 2) is nearly zero (though positive), and the


                                     47
fraction demanding z > 2 is positive and large. This gap in the product range

reßects two factors, the distribution of heterogeneity in the population, and

the curvature of preferences and technology.

   The value of λ does not appear to have large impacts on the slope, the

price, or the density. It does cause deviations in the shapes of these objects

but not large ones. This lack of impact is likely to be an artifact of the

set of speciÞcations investigated. In all speciÞcations, the distribution of

Þrm heterogeneity is determined by both the distribution of ν (y) and the

distribution of η. Because ν (y) is a 5th order polynomial in y, the variance

of ν (y) dominates the variance of η in all speciÞcations. Hence, η only

has small local eﬀects on the equilibrium and does not have large non-local

impacts. Nevertheless, the model is far from the normal model since ν (y) is

far from being normal.



6.4    Model 2: Estimation results

Tables A10-A19 present the estimation results for model 2. Tables A10-A14

present results for speciÞcations 1 through 5 when λ = 0.5. Tables A15-A19

present results for the same speciÞcations when λ = 0.9. Results for the cases

where λ = 0.1 are omitted to economize on space. They are available from


                                     48
the authors upon request; they are largely similar to those presented.

   In all the speciÞcations estimated the ML estimator again performs very

well. In Table A10 for instance the true value of β 1 is 0.623. The average

estimate is 0.637. The bias is 2%. This degree of bias is typical of all pa-

rameters estimates across all speciÞcations. In all cases the bias has an order

of magnitude never larger than 0.03; in the range of 2-3% of the parameter

values. The standard error of the estimates of β 1 in Table A10 is 0.243 or

39% of the parameter value. In percentage terms this standard error is the

fourth largest standard error for any parameter in any of the speciÞcations.

The other large standard errors are β 1 in Table A15, and β 1 in Tables A13

and A18. The largest standard error obtained is the standard error of the

estimate of β 1 in Table A18 which is 0.405 or 63% of the true parameter

value. Standard errors for all other parameter estimates in all speciÞcations

are much lower than this. In Table A10 the second largest standard error in

percentage terms is the standard error on ν c1 which is 0.256 or 13.8% of the

parameter value. Most of the standard errors in Tables A10 through A19

range between 5% and 20%.

   Thus, the ML estimator performs very well. Despite the high degree

of nonlinearity in these additive models, the technique recovers parameter


                                      49
estimates with small bias and reasonable standard errors.



6.5    Model 3: Simulation and estimation results

When the data reject the additive speciÞcations above, alternative techniques

are required. Some techniques for estimating nonadditive models are devel-

oped in sections 4.2 and 5.2. To evaluate the small sample properties of

these estimators for economies where either the marginal utility function or

the marginal product function, or both, are nonadditive in the unobservable

characteristics, we consider an economy where workers diﬀer in the value

of the observable characteristic x and the unobservable characteristic ε. To

focus analysis on estimation of the utility functions we generate observations

from an economy with homogenous production technologies. The marginal

price function is given by the marginal product function. The speciÞcation

that we use is described in Table 1.




                  Table 1: Model 3 Functional Forms
                Firm    Technology    Γ (z)        Az α
               Worker     Utility   U (z, x, ε) Bz β xβ−1 εδ
                       Density of x   fx (x)    U [0.5, 1.5]
                       Density of ε   fε (ε)    U [3.0, 4.0]



                                       50
   In this economy, proÞt maximization by each of the homogenous Þrms

implies that the Þrst order condition:



                            Aαz α−1 − Pz (z) = 0



and the second order condition:



                        Aα (α − 1) z α−2 − Pzz (z) ≤ 0



are satisÞed. Since all the Þrms have the same production technology, the

only possible equilibrium price function for this economy is given by



                              Pz (z) = Aαz α−1 .



This is an example of Rosen’s 1974 argument that when one side of the

market is homogenous, the price function directly reveals parameters of that

side of the market.

   The Þrst order condition for utility maximization of a worker with char-

acteristics (x, ε) is

                         Pz (z) − Bβz β−1 xβ−1 εδ = 0                   (25)


                                     51
and the second order condition is



                     Pzz (z) − Bβ (β − 1) z β−2 xβ−1 εδ < 0



Using the equilibrium price function, we get that the supply function of the

worker, describing the quality of labor supplied is

                                   µ               ¶ β−α
                                                      1
                                       Aα 1−β −δ
                            z=            x ε
                                       Bβ


as long as

                 Aα (α − 1) z α−2 − Bβ (β − 1) z β−2 xβ−1 εδ < 0


The latter inequality is satisÞed as long as

             µ             ¶ β−α
                             α−2                    µ         ¶ β−α
                                                                β−2
            Aα 1−β −δ                           Aα 1−β −δ
 Aα (α − 1)    x ε                 − Bβ (β − 1)    x ε                xβ−1 εδ < 0
            Bβ                                  Bβ


or
                       β−2      α−2 ¡       ¢ α−2
                  (Aα) β−α (Bβ) β−α x1−β ε−δ β−α [α − β] < 0


Hence, when A > 0, B > 0, ε > 0 and x > 0, if 0 < α < β, the equilibrium




                                          52
price function is

                               Pz (z) = Aαz α−1


and the supply function of a worker with characteristic (x, ε) is

                               µ        ¶ β−α
                                           1
                                   Aα            1−β    −δ
                          z=                    x β−α ε β−α                (26)
                                   Bβ


   To evaluate the estimators for the marginal utility of the workers obtained

using the estimators developed in Heckman, Matzkin, and Nesheim (2002),

we will simulate observations for pairs (x, z) generated by this supply function

and the speciÞcations described above for the distributions of x and ε. We

will require that for some strictly increasing function m



                           Uz (z, x, ε) = m (zx, ε) .



The utility function described in Table 1 satisÞes this restriction. The true

function m is m (zx, ε) = βB (zx)β−1 εδ . Assuming the true function is un-

known and assuming the true distribution of ε is unknown, we impose the




                                         53
normalization that, for all t within the relevant domain,



                             m (tx, t) = Pz (t) .



Since the equilibrium marginal price function satisÞes: Pz (z) = Aαz α−1 , the

normalization implies that



                             m (tx, t) = Aαtα−1



We could choose any value for x, and use a transformation to modify the

true marginal utility function m and the true distribution of ε to be within

the set of marginal utilities and distributions that are consistent with the

normalization imposed by our particular choice of x. However, for simplicity,

we choose the value of x and of the other parameters to be such that the true

function m and the distribution of ε are consistent with the normalization

generated by that x. Our choices for the parameters are

                          A α B      β   δ x
                         .55 .3 .15 1.1 -.8 1.

   The equilibrium marginal price function for this economy is depicted with

a solid line in Figure 31. The dotted lines represent bounds on feasible


                                     54
marginal prices produced by the restriction that an equilibrium marginal

price must satisfy equation (25) for some (x, ε) and (x, ε) are elements of a

compact set.

   Using these parameters and the derivations above we generated 100 in-

dependent samples each with 100 observations of (z, x) pairs. Using these

samples we estimated the distribution of ε, the workers’ supply function

z = s (x, ε) , and the marginal utility function m. To estimate the condi-

tional distribution of z given x, bandwidths were chosen by cross validation.

   Figure 32 displays estimates of the distribution function of ε. In both

panels of the Þgure, the solid line displays the true distribution function. The

dashed line displays an estimate. The dashed lines in the lower panel display

the median and average of the 100 estimates of the distribution function.

These track the true distribution function quite closely. The maximum gap in

the tails of the distribution is about 0.05. The maximum gap outside the tails

is negligible. The dotted lines in the panel plot the 5th and 95th percentile of

the estimates. The maximum gap between these two quantiles and the true

distribution function is about 0.2 . This graph shows that the nonparametric

estimate of the distribution function tracks the true distribution function very

well.


                                      55
   Figures 33 and 34 plot the estimates of the supply function (26) . The

upper panels display 3-dimensional graphs of this function. The lower panels

display cross sections of the function at particular values of x and ε. Figure 33

illustrates how well a single estimate of the supply function can do. Figure 34

illustrates the median and average estimate of the 100 independent estimates.

The dashed lines in the lower panels show that when ε = 3.45 or when

x = 0.62, the median and average estimates track the true supply function

with negligible error. The dotted lines depict the 5th and 95th percentile of

these estimates.

   Finally, Figures 35 and 36 portray estimates of the marginal utility func-

tion. Figure 35 show how well a single estimate can do, showing the three

dimensional m (zx, ε) in the upper panels and the marginal utility m (zx, ε)

for Þxed values of ε and zx respectively in the lower two panels. Figure

36 illustrates the average and median estimates as well as the 5th and 95th

percentile. When ε is Þxed at ε = 3.45, the median and average estimates of

m (zx, 3.45) , plotted with dashed lines, track the true function with negligi-

ble error. Similarly when zx is Þxed at zx = 3.56, the median and average

estimates are indistinguishable from the true function. Again, the dotted

lines show the 5th and 95th percentile estimates.


                                       56
7     Conclusion

Much of previous analysis of hedonic models has neglected to consider the

strong implications imposed by equilibrium on the data generated from a

hedonic model. In particular, strong restrictions on preferences and tech-

nologies like additive separability impose a great deal of structure on the

joint distribution of observable random variables. In this paper, we have

developed these points in our discussion and illustrated them with two com-

putational examples. The graphical displays of equilibrium prices in the array

of models we consider demonstrate the strong nonlinearities that are generic

features of hedonic models. Nonlinearity in these models is not arbitrary, but

emerges quite naturally. This nonlinearity in conjunction with restrictions

like additivity allow for identiÞcation and estimation of the hedonic model.

In Þnite samples of size 1000, the semiparametric maximum likelihood tech-

nique performs well in recovering estimates of structural parameters in both

the linear-quadratic model and in model 2 where the nonlinearities in the

structure of the economy are more severe. Finally, in model 3, with sample

sizes of only 100, the nonparametric techniques developed for nonadditive

models work very well.

    The structural parameter estimates obtained in these exercises are cru-

                                     57
cial for any general equilibrium analysis that seeks to address the welfare

consequences of policy changes in hedonic markets. They are also crucial

for employing hedonic methods to correct cost of living indices for changes

in the characteristics of marketed goods. Without estimation of the struc-

tural parameters underlying a hedonic market, changes in the hedonic pricing

relationship are uninterpretable.




                                    58
  Figure 1: Model 1, SpeciÞcation 1: Slope of price function

                     1

                    0.5

                     0
  p'(z)




            -0.5

                    -1

            -1.5

                    -2
                     -4   -3   -2   -1       0   1   2             3
                                         z

                    0.4
                                                         λ = 0.5
                                                         λ = 0.9
                    0.3
                                                         λ = 1.0
     Density of z




                    0.2


                    0.1


                     0
                     -4   -3   -2   -1       0   1   2             3
                                         z




Figure 2: Model 1, SpeciÞcation 1: Curvature of price function

                    0.4

                    0.2

                     0
  p''(z)




            -0.2

            -0.4

            -0.6
               -4         -3   -2   -1       0   1   2             3
                                         z

                    0.4
                                                         λ = 0.5
                                                         λ = 0.9
                    0.3
                                                         λ = 1.0
     Density of z




                    0.2


                    0.1


                     0
                     -4   -3   -2   -1       0   1   2             3
                                         z
  Figure 3: Model 1, SpeciÞcation 2: Slope of price function

                      2


                      1
     p'(z)



                      0


                     -1


                     -2
                      -4   -3   -2   -1       0   1   2             3
                                          z

                  0.5
                                                          λ = 0.5
                  0.4                                     λ = 0.9
                                                          λ = 1.0
   Density of z




                  0.3

                  0.2

                  0.1

                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z




Figure 4: Model 1, SpeciÞcation 2: Curvature of price function

                     0.2


                      0
  p''(z)




             -0.2


             -0.4


             -0.6
                -4         -3   -2   -1       0   1   2             3
                                          z

                     0.5
                                                          λ = 0.5
                     0.4                                  λ = 0.9
                                                          λ = 1.0
      Density of z




                     0.3

                     0.2

                     0.1

                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z
  Figure 5: Model 1, SpeciÞcation 3: Slope of price function

                      3

                      2

                      1
     p'(z)




                      0

                     -1

                     -2
                      -4   -3   -2   -1       0   1   2             3
                                          z

                  0.5
                                                          λ = 0.5
                  0.4                                     λ = 0.9
                                                          λ = 1.0
   Density of z




                  0.3

                  0.2

                  0.1

                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z




Figure 6: Model 1, SpeciÞcation 3: Curvature of price function

                      0


             -0.2
  p''(z)




             -0.4


             -0.6


             -0.8
                -4         -3   -2   -1       0   1   2             3
                                          z

                     0.5
                                                          λ = 0.5
                     0.4                                  λ = 0.9
                                                          λ = 1.0
      Density of z




                     0.3

                     0.2

                     0.1

                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z
  Figure 7: Model 1, SpeciÞcation 4: Slope of price function

                    2.5

                     2

                    1.5
  p'(z)




                     1

                    0.5

                     0

            -0.5
               -4         -3   -2   -1       0   1   2             3
                                         z

                    0.8
                                                         λ = 0.5
                                                         λ = 0.9
                    0.6
                                                         λ = 1.0
     Density of z




                    0.4


                    0.2


                     0
                     -4   -3   -2   -1       0   1   2             3
                                         z




Figure 8: Model 1, SpeciÞcation 4: Curvature of price function

                     0

            -0.1

            -0.2
  p''(z)




            -0.3

            -0.4

            -0.5
               -4         -3   -2   -1       0   1   2             3
                                         z

                    0.8
                                                         λ = 0.5
                                                         λ = 0.9
                    0.6
                                                         λ = 1.0
     Density of z




                    0.4


                    0.2


                     0
                     -4   -3   -2   -1       0   1   2             3
                                         z
  Figure 9: Model 1, SpeciÞcation 5: Slope of price function

                       3


                       2
      p'(z)



                       1


                       0


                      -1
                      -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                     z

                       1
                                                                         λ = 0.5
                   0.8                                                   λ = 0.9
                                                                         λ = 1.0
    Density of z




                   0.6

                   0.4

                   0.2

                       0
                      -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                     z




Figure 10: Model 1, SpeciÞcation 5: Curvature of price function

                       1


                      0.5
   p''(z)




                       0


              -0.5


                      -1
                      -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                     z

                       1
                                                                         λ = 0.5
                      0.8                                                λ = 0.9
                                                                         λ = 1.0
       Density of z




                      0.6

                      0.4

                      0.2

                       0
                      -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                     z
  Figure 11: Model 1, SpeciÞcation 1: Slope of price function

                     1.5

                      1

                     0.5
   p'(z)



                      0

             -0.5

                     -1

             -1.5
                -4         -3   -2   -1       0   1   2             3
                                          z

                     0.8
                                                          λ = 0
                                                          λ = 0.1
                     0.6
                                                          λ = 0.5
      Density of z




                     0.4


                     0.2


                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z




Figure 12: Model 1, SpeciÞcation 1: Curvature of price function

                     0.5



                      0
   p''(z)




             -0.5



                     -1
                      -4   -3   -2   -1       0   1   2             3
                                          z

                     0.8
                                                          λ = 0
                                                          λ = 0.1
                     0.6
                                                          λ = 0.5
      Density of z




                     0.4


                     0.2


                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z
  Figure 13: Model 1, SpeciÞcation 2: Slope of price function

                       2


                       1
      p'(z)



                       0


                      -1


                      -2
                       -4      -3   -2   -1       0   1   2             3
                                              z

                   0.8
                                                              λ = 0
                                                              λ = 0.1
                   0.6
                                                              λ = 0.5
    Density of z




                   0.4


                   0.2


                       0
                       -4      -3   -2   -1       0   1   2             3
                                              z




Figure 14: Model 1, SpeciÞcation 2: Curvature of price function

                      0.5



                           0
   p''(z)




               -0.5



                      -1
                       -4      -3   -2   -1       0   1   2             3
                                              z

                      0.8
                                                              λ = 0
                                                              λ = 0.1
                      0.6
                                                              λ = 0.5
       Density of z




                      0.4


                      0.2


                       0
                       -4      -3   -2   -1       0   1   2             3
                                              z
  Figure 15: Model 1, SpeciÞcation 3: Slope of price function

                       3


                       2
      p'(z)



                       1


                       0


                      -1
                       -4   -3   -2   -1       0   1   2             3
                                           z

                   0.8
                                                           λ = 0
                                                           λ = 0.1
                   0.6
                                                           λ = 0.5
    Density of z




                   0.4


                   0.2


                       0
                       -4   -3   -2   -1       0   1   2             3
                                           z




Figure 16: Model 1, SpeciÞcation 3: Curvature of price function

                      0.5



                       0
   p''(z)




               -0.5



                      -1
                       -4   -3   -2   -1       0   1   2             3
                                           z

                      0.8
                                                           λ = 0
                                                           λ = 0.1
                      0.6
                                                           λ = 0.5
       Density of z




                      0.4


                      0.2


                       0
                       -4   -3   -2   -1       0   1   2             3
                                           z
  Figure 17: Model 1, SpeciÞcation 4: Slope of price function

                      2

                     1.5

                      1
   p'(z)




                     0.5

                      0

             -0.5
                -4         -3   -2   -1       0   1   2             3
                                          z

                     0.8
                                                          λ = 0
                                                          λ = 0.1
                     0.6
                                                          λ = 0.5
      Density of z




                     0.4


                     0.2


                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z




Figure 18: Model 1, SpeciÞcation 4: Curvature of price function

                     0.2

                      0

             -0.2
   p''(z)




             -0.4

             -0.6

             -0.8
                -4         -3   -2   -1       0   1   2             3
                                          z

                     0.8
                                                          λ = 0
                                                          λ = 0.1
                     0.6
                                                          λ = 0.5
      Density of z




                     0.4


                     0.2


                      0
                      -4   -3   -2   -1       0   1   2             3
                                          z
  Figure 19: Model 1, SpeciÞcation 5: Slope of price function


                      1



                     0.5
   p'(z)




                      0



             -0.5
               -2.5         -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                    z

                     0.8
                                                                        λ = 0
                                                                        λ = 0.1
                     0.6
                                                                        λ = 0.5
      Density of z




                     0.4


                     0.2


                      0
                     -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                    z




Figure 20: Model 1, SpeciÞcation 5: Curvature of price function

                      1


                     0.5
   p''(z)




                      0


             -0.5


                     -1
                     -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                    z

                     0.8
                                                                        λ = 0
                                                                        λ = 0.1
                     0.6
                                                                        λ = 0.5
      Density of z




                     0.4


                     0.2


                      0
                     -2.5   -2   -1.5   -1   -0.5   0   0.5   1   1.5    2        2.5
                                                    z
  Figure 21: Model 2, SpeciÞcation 1: Slope of price function

                   20


                   10
   p'(z)



                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z




Figure 22: Model 2, SpeciÞcation 1: Curvature of price function

                   20


                   10
   p''(z)




                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z
  Figure 23: Model 2, SpeciÞcation 2: Slope of price function

                   20


                   10
   p'(z)



                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z




Figure 24: Model 2, SpeciÞcation 2: Curvature of price function

                   20


                   10
   p''(z)




                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z
  Figure 25: Model 2, SpeciÞcation 3: Slope of price function

                   20


                   10
   p'(z)



                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z




Figure 26: Model 2, SpeciÞcation 3: Curvature of price function

                   20


                   10
   p''(z)




                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z
  Figure 27: Model 2, SpeciÞcation 4: Slope of price function

                   20


                   10
   p'(z)



                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z




Figure 28: Model 2, SpeciÞcation 4: Curvature of price function

                   20


                   10
   p''(z)




                    0


              -10


              -20
                -4       -3   -2   -1   0   1   2   3         4
                                        z

                   0.8
                                                    λ = 0.5
                                                    λ = 0.9
                   0.6
                                                    λ = 1
    Density of z




                   0.4


                   0.2


                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z
  Figure 29: Model 2, SpeciÞcation 5: Slope of price function

                   20


                   10
     p'(z)



                    0


                  -10


                  -20
                    -4   -3   -2   -1   0   1   2   3         4
                                        z

                  0.25
                                                    λ = 0.5
                   0.2                              λ = 0.9
                                                    λ = 1
   Density of z




                  0.15

                   0.1

                  0.05

                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z




Figure 30: Model 2, SpeciÞcation 5: Curvature of price function

                   20


                   10
     p''(z)




                    0


                  -10


                  -20
                    -4   -3   -2   -1   0   1   2   3         4
                                        z

                  0.25
                                                    λ = 0.5
                   0.2                              λ = 0.9
                                                    λ = 1
   Density of z




                  0.15

                   0.1

                  0.05

                    0
                    -4   -3   -2   -1   0   1   2   3         4
                                        z
                      Figure 31: Model 3: Slope of price function

        0.085




         0.08




        0.075
p’(z)




         0.07




        0.065




         0.06




        0.055
            2.8   3       3.2      3.4       3.6       3.8          4   4.2   4.4
                                              z
                           Figure 32: Model 3: Distribution of ε



      1


     0.8


     0.6




Fε
     0.4


     0.2


      0
           3   3.1   3.2        3.3       3.4       3.5       3.6   3.7   3.8   3.9   4
                                                     ε



      1


     0.8


     0.6




Fε
     0.4


     0.2


      0
           3   3.1   3.2        3.3       3.4       3.5       3.6   3.7   3.8   3.9   4
                                                     ε
                                           Figure 33: Model 3: Supply function, single estimate




                   4.5                                                                    6

                    4                                                                     5

                   3.5                                                                    4




                                                                           True s(x,ε)
                    3                                                                     3




Estimated s(x,ε)
                   2.5                                                                    2
                     4                                                                    4
                                                            1.5                                                                               1.5
                           3.5                                                                     3.5
                                                  1                                                                             1
                                 3   0.5                                                                  3     0.5
                             ε                x                                                      ε                      x



                     6                                                                   4.5

                   5.5

                     5
                                                                                          4
                   4.5

                     4

                   3.5
                                                                     s(x,ε),x=0.62




s(x,ε), ε=3.45
                                                                                         3.5
                     3

                   2.5

                     2                                                                    3
                     0.5              1                   1.5                                  3    3.2   3.4         3.6           3.8   4
                                      x                                                                          ε
                                      Figure 34: Model 3: Supply function, median and average estimates




                        4.5                                                                        6

                         4                                                                         5

                        3.5                                                                        4




                                                                                    True s(x,ε)
                         3                                                                         3

                        2.5                                                                        2




Mean estimated s(x,ε)
                          4                                                                        4
                                                                     1.5                                                                               1.5
                                3.5                                                                         3.5
                                                           1                                                                             1

                                  x       3   0.5                                                                  3     0.5
                                                       ε                                                      ε                      x



                          6                                                                       4.5

                        5.5

                          5
                                                                                                   4
                        4.5

                          4

                        3.5
                                                                              s(x,ε),x=0.62




s(x,ε), ε=3.45
                                                                                                  3.5
                          3

                        2.5

                          2                                                                        3
                          0.5                  1                   1.5                                  3    3.2   3.4         3.6           3.8   4
                                               x                                                                          ε
                                        Figure 35: Model 3: Marginal utility function, single estimate




                      0.1                                                                                       0.1

                     0.09                                                                                      0.09

                     0.08                                                                                      0.08

                     0.07                                                                                      0.07




                                                                                       True m(z*x,ε)
                     0.06                                                                                      0.06




Estimated m(z*x,ε)
                     0.05                                                                                      0.05

                            3.8                                                                                       3.8
                                  3.6                                              5                                        3.6                                               5
                                         3.4                                   4                                                  3.4                                   4
                                               3.2                   3                                                                  3.2                   3
                                                          2                                                                                         2
                                         ε                               z*x                                                       ε                              z*x



                      0.1                                                                                       0.1


                     0.09                                                                                      0.09


                     0.08                                                                                      0.08


                     0.07                                                                                      0.07




m(z*x,ε), ε=3.45
                                                                                          m(z*x,ε), z*x=3.56




                     0.06                                                                                      0.06


                     0.05                                                                                      0.05
                                  2.5                3         3.5             4                                                  3.2         3.4       3.6             3.8
                                                         z*x                                                                                        ε
                                                   Figure 36: Model 3: Marginal utility function, median and average estimates




                                0.1                                                                              0.1

                               0.09                                                                             0.09

                               0.08                                                                             0.08

                               0.07                                                                             0.07




                                                                                          True m(z*x,ε)
                               0.06                                                                             0.06

                               0.05                                                                             0.05




Mean estimated m(z*x,ε)
                                      3.6                                                                              3.6
                                                                                 5                                                                                       5
                                             3.4                             4                                               3.4                                   4
                                                   3.2             3                                                               3.2                   3
                                                              2                                                                                2
                                              ε                        z*x                                                    ε                              z*x



                                0.1                                                                              0.1


                               0.09                                                                             0.09


                               0.08                                                                             0.08


                               0.07                                                                             0.07
                                                                                             m(z*x,ε), x=0.62




      m(z*x,ε), epsilon=3.45
                               0.06                                                                             0.06


                               0.05                                                                             0.05
                                            2.5          3             3.5           4                                       3.2         3.4       3.6             3.8
                                                             z*x                                                                               ε
A     Tables

                                  Table A1:

                        Model 1 functional forms                     2
          Firm     Technology Γ (z, y, η) (ν 0 + ν 1 y + η) z − Bz2
                                            My
                                           X          ¡            ¢
                   Density of y  fy (y)         λyi φ y, µyi , Σyi
                                                 i=1
                                                 Mη
                                                 X           ¡             ¢
                   Density of η     fη (η)              ληi φ η, µηi , Σηi
                                                 i=1
                                                                                2
         Worker       Utility     U (z, x, ε)   (θ0 + θ1 x + ε) z − Az2
                                                 X
                                                 Mx
                   Density of x     fx (x)           λxi φ (x, µxi , Σxi )
                                                 i=1
                                                 XMε
                   Density of ε     fε (ε)              λεi φ (ε, µεi , Σεi )
                                                  i=1


   (z, η, ε) are all scalars. y is of dimension ny and x is of dimension nx .
The parameters (B, ν 0 , ν 1 ) and (A, θ0 , θ1 ) are common across all Þrms and
workers respectively.




                                      59
                                                                 Table A2:
                                                 Model 1 parameter values for Þrms
                      Parameter SpeciÞcation 1 SpeciÞcation 2 SpeciÞcation 3 SpeciÞcation 4 SpeciÞcation 5
                          B            1.0              1.25                1.5            1.75             2.0
                         ν0            0.0               0.0                0.0             0.0             0.0
                         ν1            1.0               1.0                1.0             1.0             1.0
                         n y            1                 1                  1               1               1
                         My             2                 2                  2               2               2
                         λy        (1.0, 0.0)0       (1.0, 0.0)0        (1.0, 0.0)0     (1.0, 0.0)0     (1.0, 0.0)0
                         µy1           0.0               0.0                0.0             0.0             0.0
                         µy2     ·     0.0     ¸   ·     0.0     ¸    ·     0.0     ¸ ·     0.0     ¸ ·     0.0 ¸
                                    1.0 0.0           1.0 0.0            1.0 0.0         1.0 0.0         1.0 0.0
                         Σy1
                                 · 0.0 0.1 ¸ · 0.0 0.1 ¸ · 0.0 0.1 ¸ · 0.0 0.1 ¸ · 0.0 1.0 ¸
                                    0.5 0.0         0.45 0.0             0.4 0.0       0.35 0.0          0.3 0.0
                         Σy2
                                    0.0   0.5        0.0    0.45         0.0   0.4      0.0    0.35      0.0   0.3
                          Mη            2                 2                  2               2               2
                          λη1           λ                 λ                  λ               λ               λ
                          µη1         -1.0              -0.5                0.0             0.5             1.0
                          µη2          0.0               0.0                0.0             0.0             0.0
                            2
                          σ η1         1.0             0.775               0.55           0.325             0.1
                            2
                          σ η2         0.1               0.2                0.3             0.4             0.5
   Note: In all speciÞcations both η and ε are distributed as mixtures of normals with two components. λη1 = λε1 = λ are the weights
on the Þrst components of these mixtures. λη1 and λε1 are constrained to be equal for economy of presentation. Each of the speciÞcations
above was simulated 5 times with 5 diﬀerent values of λ. The Þve diﬀerent values were λ = 0.0, 0.1, 0.5, 0.9, and 1.0. The two extreme cases
represent cases where the model reduces to the linear-quadratic normal model. Figures showing the shape of the pricing function in all cases
are displayed below. Estimation results are presented for the cases λ = 0.1, 0.5, and 0.9.
                                                                 Table A3:
                                               Model 1 parameter values for workers
                          Parameter     Set 1            Set 2            Set 3            Set 4           Set 5
                              A           1.0            1.25               1.5             1.75             2.0
                              θ0          0.0              0.0              0.0              0.0             0.0
                              θ1          1.0              1.0              1.0              1.0             1.0
                             M  x          2                2                2                2               2
                             nx            1                1                1                1               1
                             λx       (1.0, 0.0)0     (1.0, 0.0)0       (1.0, 0.0)0     (1.0, 0.0)0      (1.0, 0.0)0
                             µx1          0.0              0.0              0.0              0.0             0.0
                             µ x2   ·     0.0     ¸ ·      0.0     ¸  ·     0.0     ¸ ·      0.0     ¸ ·     0.0 ¸
                                       0.1 0.0        0.15 0.0           0.2 0.0        0.25 0.0          0.3 0.0
                             Σx1
                                    · 0.0 0.1 ¸ · 0.0 0.15 ¸ · 0.0 0.2 ¸ · 0.0 0.25 ¸ · 0.0 0.3 ¸
                                       0.1 0.0        0.15 0.0           0.2 0.0        0.25 0.0          0.3 0.0
                             Σx2
                                       0.0   0.1      0.0     0.15       0.0   0.2       0.0    0.25      0.0   0.3
                              Mε           2                2                2                2               2
                              λε           λ                λ                λ                λ               λ
                              µε1         0.0             -0.5             -1.0             -1.5            -2.0
                              µε2         0.0              0.0              0.0              0.0             0.0
                                2
                              σ ε1       10.5           7.9775            5.255           2.7325            0.01
                                2
                              σ ε2        0.1            .325               .55            0.775             1.0
   Note: In all speciÞcations both η and ε are distributed as mixtures of normals with two components. λη1 = λε1 = λ are the weights
on the Þrst components of these mixtures. λη1 and λε1 are constrained to be equal for economy of presentation. Each of the speciÞcations
above was simulated 5 times with 5 diﬀerent values of λ. The Þve diﬀerent values were λ = 0.0, 0.1, 0.5, 0.9, and 1.0. The two extreme cases
represent cases where the model reduces to the linear-quadratic normal model. Figures showing the shape of the pricing function in all cases
are displayed below. Estimation results are presented for the cases λ = 0.1, 0.5, and 0.9.
                                                          Table A4:
                                                Model 1 parameter estimates
                                                            λ = 0.5
                            SpeciÞcation 1   SpeciÞcation 2    SpeciÞcation 3 SpeciÞcation 4  SpeciÞcation 5
                             B         ν1      B        ν1       B        ν1    B        ν1     B        ν1
               True value    1.0       1.0    1.25      1.0      1.5      1.0 1.75      1.0     2.0     1.0
                  ML        1.01      1.01    1.28     1.03     1.54     1.03 1.77     1.01    1.99    0.996
                          (0.0349) (0.0518) (0.0983) (0.102) (0.138) (0.116) (0.287) (0.193) (0.144) (0.0788)
    Note: Data were simulated for each speciÞcation listed in Tables A2 and A3. λη1 = λε1 = λ = 0.5 in all speciÞcations. 100 independent
samples each with sample size 1000 were generated. Then the parameters B and ν 1 were estimated using the semiparametric maximum
likelihood technique described in section 5.1. Row 1, labeled “True Value”, lists the true parameter values for each speciÞcation. For each
speciÞcation, 100 independent estimates were generated, one from each sample. Row 2, labeled “ML”, reports the averages and standard
errors of these maximum likelihood estimates.
                                                           Table A5:
                                                Model 1 parameter estimates
                                                            λ = 0.9
                             SpeciÞcation 1  SpeciÞcation 2   SpeciÞcation 3 SpeciÞcation 4  SpeciÞcation 5
                               B        ν1     B        ν1      B        ν1    B        ν1     B        ν1
                 True value   1.0       1.0  1.25      1.0      1.5     1.0   1.75     1.0    2.0      1.0
                    ML        1.02     1.03  1.26     1.02     1.56    1.06   1.75    1.00    2.01    1.00
                            (0.120) (0.194) (0.166) (0.203) (0.364) (0.336) (0.306) (0.221) (0.101) (0.0475)
    Note: Data were simulated for each speciÞcation listed in Tables A2 and A3. λη1 = λε1 = λ = 0.9 in all speciÞcations. 100 independent
samples each with sample size 1000 were generated. Then the parameters B and ν 1 were estimated using the semiparametric maximum
likelihood technique described in section 5.1. Row 1, labeled “True Value”, lists the true parameter values for each speciÞcation. For each
speciÞcation, 100 independent estimates were generated, one from each sample. Row 2, labeled “ML”, reports the averages and standard
errors of these maximum likelihood estimates.
                                                           Table A6:
                                                Model 1 parameter estimates
                                                             λ = 0.1
                            SpeciÞcation 1    SpeciÞcation 2      SpeciÞcation 3 SpeciÞcation 4 SpeciÞcation 5
                             B         ν1      B         ν1        B         ν1   B         ν1    B        ν1
               True value    1.0       1.0    1.25       1.0       1.5      1.0  1.75       1.0  2.0      1.0
                  ML        1.01      1.01    1.29      1.03      1.53     1.02  1.87      1.07 1.96     0.982
                          (0.0359) (0.0333) (0.0956) (0.0739) (0.143) (0.0959) (0.525) (0.295) (0.356) (0.185)
    Note: Data were simulated for each speciÞcation listed in Tables A2 and A3. λη1 = λε1 = λ = 0.1 in all speciÞcations. 100 independent
samples each with sample size 1000 were generated. Then the parameters B and ν 1 were estimated using the semiparametric maximum
likelihood technique described in section 5.1. Row 1, labeled “True Value”, lists the true parameter values for each speciÞcation. For each
speciÞcation, 100 independent estimates were generated, one from each sample. Row 2, labeled “ML”, reports the averages and standard
errors of these maximum likelihood estimates.
                                                              Table A7:
                                                       Model 2 functional forms
                                                                                                     Zz
                                  Firm     Technology    Γ (z, y, η)        (ν (y) + η) z +                mf (s) ds
                                                                                                0
                                                                                           Zy ÃX
                                                                                               Nν
                                                                                                                      !2
                                                           ν (y)        ν 0 + ν 1y +                       ν 2ai si        ds
                                                                                           0        i=0
                                                                                           Nzf
                                                                                           X
                                                          mf   (z)                                 β izi
                                                                                           i=0
                                                                                M
                                                                               Xy
                                                                                       ¡             ¢
                                          Density of y     fy (y)                 λyi φ y, µyi , Σyi
                                                                                i=1
                                                                               Mη
                                                                               X           ¡             ¢
                                          Density of η     fη (η)                     ληi φ η, µηi , Σηi
                                                                                i=1
                                                                                                    Zz
                                 Worker      Utility     U (z, x, ε)        (θ (x) + ε) z −                mw (s) ds
                                                                                                0
                                                                                           Zx ÃX
                                                                                               Nθ
                                                                                                                     !2
                                                           θ (x)        θ0 + θ1 x +                        θ2ai si         ds
                                                                                           0        i=1
                                                                                             Zz ÃX
                                                                                                 Nzw
                                                                                                                         !2
                                                          mw   (z)     mf   (z) +   α0 z   +                   α1ai si          ds
                                                                                               0         i=0
                                                                               X
                                                                               Mx
                                          Density of x     fx (x)                     λxi φ (x, µxi , Σxi )
                                                                                i=1
                                                                                XMε
                                          Density of ε     fε (ε)                     λεi φ (ε, µεi , Σεi )
                                                                                i=1
   (z, η, ε) are all scalars. y is of dimension Ny and x is of dimension Nx . The parameters in Table A7 are common across all Þrms and
workers respectively.
                                                                   Table A8:
                                                  Model 2 parameter values for Þrms
                      Parameter SpeciÞcation 1 SpeciÞcation 2 SpeciÞcation 3 SpeciÞcation 4 SpeciÞcation 5
                         Nzf            3                3                3              3              3      
                                        1.0                1.0                1.0              1.0              1.0
                                                                                                               
                          β       0.6228          2.7419             2.6676        0.6411         2.5746 
                                  −0.7684         0.4115             2.2527        −0.9606        −0.4444 
                                     −0.1889            −0.2051             1.4152           0.0888          −0.2047
                         ν  0           0.0                0.0                0.0              0.0              0.0
                         ν  1         0.8632             0.9712             0.6817           0.9201           0.4486
                         Nν              2                  2                  2                2                2
                         ν 2a    (1.0, 1.0, 1.0)0   (1.0, 1.0, 1.0)0   (1.0, 1.0, 1.0)0 (1.0, 1.0, 1.0)0 (1.0, 1.0, 1.0)0
                         n  y            1                  1                  1                1                1
                         My              2                  2                  2                2                2
                         λy         (1.0, 0.0)0        (1.0, 0.0)0        (1.0, 0.0)0      (1.0, 0.0)0      (1.0, 0.0)0
                         µy1            0.0                0.0                0.0              0.0              0.0
                         µ y2     ·     0.0     ¸    ·     0.0     ¸    ·     0.0     ¸  ·     0.0     ¸  ·     0.0 ¸
                                     1.0 0.0            1.0 0.0            1.0 0.0          1.0 0.0          1.0 0.0
                         Σy1
                                  · 0.0 0.1 ¸        · 0.0 0.1 ¸        · 0.0 0.1 ¸      · 0.0 0.1 ¸      · 0.0 0.1 ¸
                                     0.5 0.0            0.5 0.0            0.5 0.0          0.5 0.0          0.5 0.0
                         Σy2
                                     0.0   0.5          0.0   0.5          0.0   0.5        0.0   0.5        0.0   0.5
                         Mη              2                  2                  2                2                2
                         λη1             λ                  λ                  λ                λ                λ
                         µη1          0.4542            -0.3814             0.6770           0.1361          -0.2592
                         µη2          0.4055             0.0931            -0.1102           0.3891           0.2426
                           2
                         σ η1         0.3869             1.3644             0.6055           1.0833           0.3017
                           2
                         σ η2         1.3958             0.7567             1.7200           1.7073           1.1871
   Note: In all speciÞcations λη1 = λε1 = λ. Simulation results are presented for λ = 0.0, 0.1, 0.5 0.9. and 1.0. Estimation results are
presented for λ = 0.1, 0.5, and 0.9.
                                                                Table A9:
                                               Model 2 parameter values for workers
                      Parameter SpeciÞcation 1 SpeciÞcation 2 SpeciÞcation 3 SpeciÞcation 4 SpeciÞcation 5
                         Nzw            1                1                 1               1             1
                         α0       ·  1.4501  ¸     ·  0.7311  ¸     ·   1.1068    ¸  ·  0.9860  ¸ ·   1.3913 ¸
                                     1.2863           0.3694           −0.9445          1.4642        0.3341
                         α1
                                     0.8463           1.3758            1.7654          1.2146       −0.4712
                          θ0           0.0              0.0               0.0             0.0           0.0
                          θ1           0.5              0.5               0.5             0.5           0.5
                         N θ            1                1                 1               1             1
                         θ2a       (1.0, 1.0)0      (1.0, 1.0)0       (1.0, 1.0)0     (1.0, 1.0)0   (1.0, 1.0)0
                         nx             2                2                 2               2             2
                         M  x           2                2                 2               2             2
                         λ x       (1.0, 0.0)0      (1.0, 0.0)0       (1.0, 0.0)0     (1.0, 0.0)0   (1.0, 0.0)0
                         µx1           0.0              0.0               0.0             0.0           0.0
                         µx2     · 0.0 ¸          · 0.0 ¸            · 0.0 ¸        · 0.0 ¸       · 0.0 ¸
                                    0.3 0.0          0.3 0.0           0.3 0.0         0.3 0.0       0.3 0.0
                         Σx1
                                 · 0.0 0.3 ¸      · 0.0 0.3 ¸        · 0.0 0.3 ¸    · 0.0 0.3 ¸   · 0.0 0.3 ¸
                                    0.3 0.0          0.3 0.0           0.3 0.0         0.3 0.0       0.3 0.0
                         Σy2
                                    0.0 0.3          0.0 0.3           0.0 0.3         0.0 0.3       0.0 0.3
                         Mε             2                2                 2               2             2
                         λε1            λ                λ                 λ               λ             λ
                         µε1        -0.0069           0.7995            0.6433          0.2898        0.6359
                         µε2         0.3205          -0.3161           -0.4205         -0.3176        0.0682
                           2
                         σ ε1        1.6762           0.0393            1.3626          0.7590        1.6636
                           2
                         σ ε2        1.0056           1.4189            0.8578          0.6092        0.3793
   Note: In all speciÞcations λη1 = λε1 = λ. Simulation results are presented for λ = 0.0, 0.1, 0.5 0.9. and 1.0. Estimation results are
presented for λ = 0.1, 0.5, and 0.9.
                            Table A10:
            Model 2, SpeciÞcation 1 parameter estimates
                                λ = 0.5
                           True Value       ML
                      β1      0.623        0.637
                                         (0.243)
                      β2     -0.768       -0.767
                                        (0.0902)
                      β3     -0.189       -0.192
                                        (0.0231)
                      ν c1     1.86        1.86
                                         (0.256)
                      ν c2     1.00        0.992
                                         (0.113)
                      ν c3     1.00        1.00
                                        (0.0978)
                      ν c4    0.500        0.501
                                        (0.0426)
                      ν c5    0.200        0.203
                                        (0.0202)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.5. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                            Table A11:
            Model 2, SpeciÞcation 2 parameter estimates
                               λ = 0.5
                          True Value      ML
                      β1      2.74        2.75
                                       (0.0744)
                      β2     0.412       0.408
                                       (0.0629)
                      β3    -0.205       -0.210
                                       (0.0570)
                      ν1      1.97        1.98
                                        (0.246)
                      ν2      1.00        1.00
                                        (0.131)
                      ν3      1.00        1.00
                                        (0.123)
                      ν4     0.500       0.504
                                       (0.0480)
                      ν5     0.200       0.202
                                       (0.0175)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.5. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                            Table A12:
            Model 2, SpeciÞcation 3 parameter estimates
                               λ = 0.5
                          True Value      ML
                      β1      2.67        2.67
                                        (0.200)
                      β2      2.25        2.27
                                        (0.206)
                      β3      1.42        1.40
                                        (0.120)
                      ν1      1.68        1.69
                                        (0.275)
                      ν2      1.00        1.01
                                        (0.146)
                      ν3      1.00        1.01
                                        (0.145)
                      ν4     0.500       0.507
                                       (0.0593)
                      ν5     0.200       0.202
                                       (0.0225)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.5. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                            Table A13:
            Model 2, SpeciÞcation 4 parameter estimates
                               λ = 0.5
                          True Value      ML
                      β1     0.641       0.627
                                        (0.337)
                      β2    -0.961       -0.984
                                        (0.216)
                      β3    0.0888      0.0781
                                       (0.0651)
                      ν1      1.92        1.95
                                        (0.330)
                      ν2      1.00        1.00
                                        (0.167)
                      ν3      1.00        1.01
                                        (0.151)
                      ν4     0.500       0.509
                                       (0.0636)
                      ν5     0.200       0.204
                                       (0.0259)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.5. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                             Table A14:
             Model 2 SpeciÞcation 5 parameter estimates
                                 λ = 0.5
                           True Value       ML
                       β1     2.5746        2.58
                                          (0.103)
                       β2    -0.4444       -0.440
                                         (0.0251)
                       β3    -0.2047       -0.206
                                         (0.0072)
                       ν1     1.4486        1.44
                                          (0.193)
                       ν2      1.00        0.988
                                          (0.141)
                       ν3      1.00         1.01
                                          (0.111)
                       ν4     0.500        0.512
                                         (0.0513)
                       ν5     0.200        0.205
                                         (0.0203)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.5. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                             Table A15:
             Model 2 SpeciÞcation 1 parameter estimates
                               λ = 0.9
                           True Value     ML
                       β1    0.623       0.619
                                        (0.291)
                       β2    -0.768      -0.776
                                       ( 0.115)
                       β3    -0.189      -0.194
                                       (0.0302)
                       ν1     1.86        1.88
                                        (0.283)
                       ν2     1.00        1.00
                                        (0.149)
                       ν3     1.00        1.01
                                        (0.132)
                       ν4    0.500       0.505
                                       (0.0551)
                       ν5    0.200       0.204
                                       (0.0252)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.9. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                            Table A16:
            Model 2, SpeciÞcation 2 parameter estimates
                               λ = 0.9
                          True Value      ML
                      β1      2.74        2.75
                                       (0.0705)
                      β2     0.412       0.403
                                       (0.0553)
                      β3    -0.205       -0.216
                                       (0.0506)
                      ν1      1.97        2.00
                                        (0.228)
                      ν2      1.00        1.01
                                        (0.122)
                      ν3      1.00        1.02
                                        (0.108)
                      ν4     0.500       0.510
                                       (0.0422)
                      ν5     0.200       0.203
                                       (0.0154)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.9. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                             Table A17:
             Model 2 SpeciÞcation 3 parameter estimates
                               λ = 0.9
                           True Value     ML
                       β1     2.67        2.66
                                        (0.218)
                       β2     2.25        2.27
                                        (0.230)
                       β3     1.42        1.40
                                        (0.149)
                       ν1     1.68        1.72
                                        (0.322)
                       ν2     1.00        1.02
                                        (0.191)
                       ν3     1.00        1.02
                                        (0.183)
                       ν4    0.500       0.512
                                       (0.0766)
                       ν5    0.200       0.203
                                       (0.0284)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.9. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                            Table A18:
            Model 2, SpeciÞcation 4 parameter estimates
                               λ = 0.9
                          True Value      ML
                      β1     0.641       0.640
                                        (0.405)
                      β2    -0.961       -0.980
                                        (0.266)
                      β3    0.0888       0.079
                                       (0.0809)
                      ν1      1.92       1.933
                                        (0.366)
                      ν2      1.00       0.998
                                        (0.196)
                      ν3      1.00        1.01
                                        (0.190)
                      ν4     0.500       0.508
                                       (0.0785)
                      ν5     0.200       0.204
                                       (0.0316)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.9. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
                            Table A19:
            Model 2, SpeciÞcation 5 parameter estimates
                               λ = 0.9
                          True Value      ML
                      β1      2.57        2.58
                                        (0.137)
                      β2    -0.444       -0.440
                                       (0.0271)
                      β3    -0.205       -0.206
                                       (0.0101)
                      ν1      1.45        1.44
                                        (0.217)
                      ν2      1.00       0.987
                                        (0.165)
                      ν3      1.00        1.01
                                        (0.152)
                      ν4     0.500       0.514
                                       (0.0746)
                      ν5     0.200       0.205
                                       (0.0279)

   Note: β i , i = 1, .., 3 and ν cj , j = 1, ..., 5 are the subset of structural
parameters of Þrm technologies in Model 2 that are identiÞed. β 0 , which
equals 1.0 in all speciÞcations is not identiÞed. The parameters ν cj satisfy
                     µ2            ¶2
P5
          j−1
                      P          i
   ν cj y     = ν1 +     ν 2ai y      . 100 independent samples each of size 1000
j=1                  i=0
were generated using the parameter values in Tables A8 and A9. In all speci-
Þcations, λη1 = λε1 = 0.9. Column 1 reports the true values of the parameters
used to simulate the data. 100 independent estimates were obtained using the
maximum likelihood technique described in section 5.1. Column 2, labeled
“ML”, reports the averages and standard errors of these estimates.
References
 [1] Armstrong, M. (1996). “Multiproduct Nonlinear Pricing.” Economet-
     rica, 64(1): 51-75.
 [2] Banzhaf, H., H. Sieg, V. K. Smith, and R. Walsh (2000). “Estimating the
     General Equilibrium BeneÞts of Large Changes in Spatially Delineated
     Public Goods,” NBER Working Paper No. 7744.
 [3] Bayer, P. (2000). “Tiebout Sorting and Discrete Choices: A New Ex-
     planation for Socioeconomic Diﬀerences in the Consumption of School
     Quality,” mimeo, Yale University.
 [4] Bresnahan, T. and R. Gordon (1997). The Economics of New Goods,
     Chicago: University of Chicago Press.
 [5] Brown, J. and H. Rosen (1982). “On the Estimation of Structural He-
     donic Price Models,” Econometrica, 50: 765-769.
 [6] Ekeland, I., J. Heckman and L. Nesheim (2002). “IdentiÞcation and Es-
     timation of Hedonic Models,” forthcoming Journal of Political Economy.
 [7] Epple, D. (1987). “Hedonic Prices and Implicit Markets: Estimating
     Demand and Supply Functions for Diﬀerentiated Products,” Journal of
     Political Economy, 95: 59-80.
 [8] Epple, D. and H. Sieg (1999). “Estimating Equilibrium Models of Local
     Jurisdictions,” Journal of Political Economy, 107: 645-681.
 [9] Gretsky, N., J. Ostroy and W. R. Zame (1999). “Perfect Competition in
     the Continuous Assignment Model,” Journal of Economic Theory, 88:
     60-118.
[10] Heckman J., Matzkin R., and Nesheim, L. (2002), “Non-parametric es-
     timation of nonadditive hedonic models,” unpublished working paper.
[11] Horowitz, J. (1996). “Semiparametric Estimation of a Regression Model
     with an Unknown Transformation of the Dependent Variable,” Econo-
     metrica, 64: 103-137.
[12] Kahn, S. and K. Lang (1988). “Eﬃcient Estimation of Structural Hedo-
     nic Systems,” International Economic Review, 29: 157-166.
[13] Kniesner, T. and J. Leeth (1988). “Simulating Hedonic Labor Market
     Models: Computational Issues and Policy Applications,” International
     Economic Review, 29(4): 755-789.
[14] Kniesner, T. and J. Leeth (1995). Simulating Workplace Safety Policy,
     Boston: Kluwer Academic.
[15] Lancaster, K. (1966). “A New Approach to Consumer Theory,” Journal
     of Political Economy, 74(2): 132-157.
[16] Lancaster, K. (1975). “Socially Optimal Product Diﬀerentiation,”
     American Economic Review, 65(4): 567-585.
[17] Matzkin, R. (1999). “Nonparametric Estimation of Nonadditive Ran-
     dom Functions,” 1st version, working paper, Northwestern University.
[18] Matzkin, R. (2003). “Nonparametric Estimation of Nonadditive Ran-
     dom Functions,” forthcoming, Econometrica.
[19] Matzkin, R.L. (2002). “Estimation of Nonadditive Functions Using
     Functional Restrictions,” working paper, Northwestern University.
[20] Nesheim, L. (2001). “Equilibrium Sorting of Heterogeneous Consumers
     Across Locations: Theory and Empirical Implications,” Ph.D. Thesis,
     University of Chicago.
[21] Rochet, J.-C., and L. Stole (2001). “The Economics of Multidimensional
     Screening,” working paper, The University of Chicago.
[22] Rosen, S. (1974). “Hedonic Prices and Implicit Markets: Product Dif-
     ferentiation in Pure Competition,” Journal of Political Economy, 82:
     34-55.
[23] Sattinger, M. (1975). “Comparative Advantage and the Distributions of
     Earnings and Abilities,” Econometrica, 43(3): 455-468.
[24] Sattinger, M. (1980). Capital and the Distribution of Labor Earnings,
     New York: North Holland.
[25] Sattinger, M. (1993). “Assignment Models of the Distribution of Earn-
     ings,” Journal of Economic Literature, 31(2): 831-880.
[26] Smith, V. K., and J. C. Huang (1995). “Can Markets Value Air Qual-
     ity: A Meta-Analysis of Hedonic Property Value Models,” Journal of
     Political Economy, 103(1):209-227.
[27] Teulings, C. (1995). “The Wage Distribution in a Model of the Assign-
     ment of Jobs to Skills,” Journal of Political Economy, 103(2): 280-315.
[28] Teulings, C. and T. van Rens (2002). “Education Growth and Income
     Inequality,” Tinbergen Institute Discussion Paper TI 2002-001/3.
[29] Thaler, R. and S. Rosen (1975). “The Value of Saving A Life: Evi-
     dence From The Labor Market,” in Nester Terleckyj (ed.), Household
     Production and Consumption, National Bureau of Economic Research.
[30] Tinbergen, J. (1956). “On The Theory of Income Distribution,”
     Weltwirtschaftliches Archiv, 77: 155-73.
[31] Triplett, J. (2000). Handbook on Quality Adjustment of Price Indexes for
     Information and Communication Technology Products, Paris: OECD.
[32] Wilson, R. (1993). Nonlinear Pricing, Oxford: Oxford University Press.
[33] Wooders, M. (1994). “Equivalence of Games and Markets,” Economet-
     rica, 62(5): 1141-1160.
