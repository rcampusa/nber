                               NBER WORKING PAPER SERIES




                                    OPTIMAL ILLIQUIDITY

                                         John Beshears
                                          James J. Choi
                                       Christopher Clayton
                                        Christopher Harris
                                         David Laibson
                                       Brigitte C. Madrian

                                       Working Paper 27459
                               http://www.nber.org/papers/w27459


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2020


The project described received funding from the TIAA Institute and Wharton School’s Pension
Research Council/Boettner Center. The content is solely the responsibility of the authors and does
not necessarily represent official views of the TIAA Institute or Wharton School’s Pension
Research Council/Boettner Center. The authors gratefully acknowledge additional financial
support from the Eric M. Mindich Fund for Research on the Foundations of Human Behavior, the
National Institute on Aging (P30AG034532), and the Social Security Administration. The views
expressed in this paper are not endorsed by NIA, SSA, or any federal government agency. The
authors are grateful for comments from Emmanuel Farhi, Mike Golosov, Francesco Lippi, Ben
Lockwood, Greg Mankiw, Christian Moser, Matthew Rabin, David Richardson, John Sabelhaus,
Dmitry Taubinsky and seminar participants at the ASSA, Einaudi Institute for Economics and
Finance, Harvard University, MIT, the SSA RRC, and the NBER. We are very grateful to Kartik
Vira for outstanding research assistance. The views expressed herein are those of the authors and
do not necessarily reflect the views of the National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this
research. Further information is available online at http://www.nber.org/papers/w27459.ack

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by John Beshears, James J. Choi, Christopher Clayton, Christopher Harris, David
Laibson, and Brigitte C. Madrian. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Optimal Illiquidity
John Beshears, James J. Choi, Christopher Clayton, Christopher Harris, David Laibson,
and Brigitte C. Madrian
NBER Working Paper No. 27459
July 2020
JEL No. D02,D14,G51,H21,H31,H55

                                         ABSTRACT

We calculate the socially optimal level of illiquidity in an economy populated by households with
taste shocks and present bias (Amador, Werning, and Angeletos 2006). The government chooses
mandatory contributions to respective spending/savings accounts, each with a different pre-
retirement withdrawal penalty. Penalties collected by the government are redistributed through
the tax system. When naive households have heterogeneous present bias, the social optimum is
well approximated by a three-account system: (i) a completely liquid account, (ii) a completely
illiquid account, and (iii) an account with a ~10% early withdrawal penalty. In some ways this
resembles the U.S. system, which includes completely liquid accounts, completely illiquid Social
Security and 401(k)/IRA accounts with a 10% early withdrawal penalty. The social optimum is
also well approximated by an even simpler two-account system—(i) a completely liquid account
and (ii) a completely illiquid account—which is the most common retirement system in the
world today.

John Beshears                                   Christopher Harris
Harvard Business School                         Department of Economics
Baker Library 439                               Cambridge University
Soldiers Field                                  Sidwick Avenue
Boston, MA 02163                                Cambridge CB3 9DE ENGLAND
and NBER                                        cjharris@econ.cam.ac.uk
jbeshears@hbs.edu
                                                David Laibson
James J. Choi                                   Department of Economics
Yale School of Management                       Littauer M-12
165 Whitney Avenue                              Harvard University
P.O. Box 208200                                 Cambridge, MA 02138
New Haven, CT 06520-8200                        and NBER
and NBER                                        dlaibson@gmail.com
james.choi@yale.edu
                                                Brigitte C. Madrian
Christopher Clayton                             730 B N. Eldon Tanner Building
Yale School of Management                       Brigham Young University
165 Whitney Avenue                              Provo, UT 84602-3113
P.O. Box 208200                                 and NBER
New Haven, CT 06520-8200                        brigitte_madrian@byu.edu
christopherdclayton@gmail.com
1       Introduction
How much liquidity should be built into a socially optimal savings system? On the
one hand, flexibility allows households to consume in ways that reflect their idio-
syncratic preferences—i.e., households can respond to normatively legitimate taste
shocks. However, liquidity allows households with self-control problems (and other
types of biases or errors) to overconsume.
     If some illiquidity is optimal, how should it be implemented? Possible forms of
illiquidity include a perfectly illiquid retirement claim (like a typical defined-benefit
pension or the U.S. Social Security system) or a partially liquid account (like an
IRA or 401(k) plan, which allow penalty-based early withdrawals). In some cases,
an optimal system would combine diﬀerent types of illiquid accounts.
     In the practical policy domain, there is a partial consensus on some of these
questions. Almost all developed countries have some form of compulsory savings
that is completely illiquid (e.g., Social Security in the United States).
     Nevertheless, there are substantial diﬀerences among retirement savings sys-
tems. For example, in most developed countries, defined-contribution (DC) savings
accounts have mandatory contributions and balances that are completely illiquid
before age 55 (Beshears, et al., 2015). By contrast, in the United States, DC con-
tributions are voluntary, certain types of withdrawals are allowed without penalty,
and, for IRAs, withdrawals may be made for any reason if a 10% penalty is paid.
Liquidity engenders significant pre-retirement “leakage”: for every $1 contributed
to the DC retirement accounts of U.S. households under age 55, $0.30 to $0.40 si-
multaneously flows out of the 401(k)/IRA system, not counting rollovers or loans
(Argento, Bryant, and Sabelhaus, 2014). From a theoretical perspective, it is not
clear whether allowing such leakage is good or bad from the perspective of overall
social welfare. Nevertheless, most media coverage bemoans leakage.1
     Our paper evaluates the optimality of an -account retirement savings system
comprised of liquid, partially illiquid, and/or completely illiquid accounts. The illiq-
uidity is obtained with linear penalties for early withdrawals. Within this frame-
work, we focus on systems with two accounts and systems with three accounts.
However, we show that such two- and three-account systems come extremely close
    1
    For example, see Anne Tergesen, “The Rising Retirement Perils of 401(k) ‘Leakage’”, The
Wall Street Journal, April 2, 2017. For a similar industry perspective, see Hewitt Associates
(2009).



                                             2
to delivering the welfare obtainable from a fully general optimized (non-linear) mech-
anism. We do this by characterizing an upper bound for social welfare in the non-
linear mechanism and show that our two- and three-account systems nearly obtain
this bound.
     We study preferences that include both normatively legitimate taste shifters and
normatively undesirable self-control problems. The self-control problems are mod-
eled as the consequence of present bias (Phelps and Pollak, 1968, Laibson, 1997):
i.e., a discount function with weights {1     2         }, where the degree of
present bias is 1 − . Our model is an aggregate version (which adds interpersonal
transfers) of the flexibility/commitment framework of Amador, Werning, and An-
geletos (2006; hereafter referred to as AWA). Our model is very closely related to
the model of Moser and Olea de Souza e Silva (2017), who also generalize AWA by
allowing for mechanisms with inter-household transfers. In their model, households
have unobservable earnings ability and unobservable , whereas we study the case
of unobservable taste shocks (with exogenous earnings) and unobservable . Moser
and Olea de Souza e Silva (2017) find that second-best optimal savings institutions
have many of the properties of the U.S. retirement savings system, including forced
savings, a theme that also emerges in AWA and in our paper. Like Moser and
Olea de Souza e Silva, we find that optimal savings mechanisms are characterized
by more mandatory savings than currently exists in the U.S. system. Our paper
contributes to this literature by showing how highly simplified retirement savings
systems (e.g., two- and three-account systems with linear early-withdrawal penal-
ties) come very close to generating welfare levels that arise under the fully general
optimized non-linear mechanism.2
     We divide our analysis into the cases of homogeneous present bias and hetero-
geneous present bias. The homogeneous case implies that all agents have the same
degree of present bias—in other words, the same value of . In the case of homoge-
neous , our model implies that a single partially illiquid account with (Pigouvian)
early-withdrawal penalty  ' 1 −  approximates the fully general socially optimal
mechanism.
     We then relax the homogeneity assumption, and consider an economy in which
   2
    There is a large literature on optimal taxation when consumers have present bias, including
Laibson, Repetto and Tobacman (1998), Gruber and Köszegi (2001, 2004), O’Donoghue and Rabin
(2006), Lockwood (2016), Farhi and Gabaix (2018), Allcott, Lockwood and Taubinsky (forthcom-
ing). See Bernheim and Taubinsky (2018) for a review of the literature on behavioral public
economics.

                                              3
agents have heterogeneous present bias. In this heterogeneous-preference case, we
find that completely illiquid savings accounts play an important role in improving
welfare. Specifically, the social optimum is well-approximated by a three-account
system with a perfectly liquid savings account, a partially illiquid savings account
(with an early-withdrawal penalty of approximately 13%), and a completely illiquid
savings account. Even more strikingly, the social optimum is also well-approximated
by an even simpler two-account system with a completely liquid savings account
and a completely illiquid savings account. In both the two- and three-account
systems the completely illiquid savings account receives a substantial mandatory
contribution from the household—enough to almost smooth consumption between
working life and retirement even if all other wealth is consumed during working life.
The completely illiquid savings account caters to the households with the low 
values. Fully illiquid savings generates large welfare gains for these low- agents,
and these welfare gains swamp the welfare losses of the high- agents (who are
made only slightly worse oﬀ by shifting some of their wealth from completely liquid
accounts to completely illiquid accounts).
     To the extent that there is a role for partially illiquid accounts in the heterogeneous-
 economy, we find that such accounts should have low early-withdrawal penalties—in
most calibrations, the penalty is slightly above 10%. This implies that the partially
illiquid accounts look much like a typical 401(k) account in the U.S. Moreover, these
partially illiquid accounts display a high level of leakage in equilibrium. In other
words, early withdrawals (i.e., pre-retirement withdrawals) are commonplace. This
leakage is a double-edged sword: it results in part from legitimate taste shocks and
in part from self-control problems (i.e., low ). The costs of the partially illiquid
account to low- types (who end up paying most of the early-withdrawal penalties)
and benefits to high- types (who are net recipients of these penalties) are nearly
oﬀsetting, although the net eﬀect for all of society is slightly positive.
     Section 2 describes the planner’s problem—i.e., account allocations and early-
withdrawal penalties that maximize social welfare subject to information asymme-
tries between the planner and the households. Section 2 presents the benchmark case
against which we will compare all other cases: the laissez faire policy of completely
liquid accounts.
     Sections 3 and 4 analyze the case of homogeneous present bias. In Section
3 we follow AWA and assume that inter-household transfers are not permitted:


                                            4
i.e., any revenue collected by the government must be destroyed rather than being
redistributed, which is referred to in the literature as the assumption of ‘money
burning’. Section 4 analyzes the solution to the planner’s problem when inter-
household transfers are admitted.
     Section 5 analyzes the solution to the planner’s problem in the case of inter-
household transfers and heterogeneous present-bias. This is the most realistic bench-
mark that we study. We show that the fully optimal retirement savings system is
well-approximated by two- and three-account systems, which have a completely liq-
uid account and a (well-funded) completely illiquid account. In the three-account
system, welfare is nearly identical to welfare in the two-account system and welfare
in the fully general, non-linear system. Accordingly, little can be gained by advanc-
ing from two accounts to an arbitrary number of accounts (  2). In addition,
we find that the optimal partially illiquid account in the three-account system is
characterized by a high rate of leakage.
     Section 6 presents robustness analysis. In Section 7, we conclude and discuss the
limitations of our analysis. Three on-line appendices are used for proofs, including
our explanation of how to calculate a tight upper bound on the welfare that can be
obtained from the fully general, optimized non-linear mechanism (Appendix 2).


2    Model
We study a two-period model of consumption for a continuum of households with
unit mass. Households are indexed by a taste shock  and a present bias . In period
1, a household consumes 1 ( ). In period 2, a household consumes 2 ( ). One
can think of period 1 as working life and period 2 as retirement. We will sometimes
refer only to 1 and 2 for notational simplicity. When we use this short-hand
notation, the dependence on  and  is implied.
    In this model, we give households access to  savings accounts with initial
mandatory balances ( )                                                  
                          =1 and linear early-withdrawal penalties (  )=1 (which
will usually turn out to be positive—i.e., we will usually find   0—but our frame-
work does allow for negative penalties). We allow households to withdraw from
these accounts in any order; in equilibrium, they will choose to withdraw from the
low-penalty accounts first. This -account model is a special case of the fully gen-
eral mechanism-design problem, which we also study. We show that the welfare that


                                          5
arises from the -account framework with  ≤ 2 is very close to the welfare for
the optimal general (non-linear) mechanism. In Appendix B, we present a method
for characterizing the optimal general (non-linear) mechanism. We choose to focus
most of our non-appendix text on the -account framework because of its similarity
to the actual retirement savings systems that are currently in use around the world.


2.1     Preferences of households
We now describe the preferences of households. Let  1 (1 ) represent the utility
flow in period 1, where  is a stochastic taste shifter that is realized in period 1.3
Let 2 (2 ) represent the utility flow in period 2. Without loss of generality, there is
no taste shifter in period 2.4
    From the perspective of the self in period 1, utility flows in period 2 are dis-
counted by a standard (normative) discount factor  as well as an additional dis-
count factor, , that represents present bias, with

                                        0   ≤ 1
                                        0   ≤ 1

The agent has no present bias when  = 1.
   Putting these elements together, after realization of  the agent’s preferences in
period 1 are given by
                               1 (1 ) +   2 (2 )

    We assume that the flow utility functions, 1 and 2 , are both strictly increasing
and strictly concave. We assume that 01 and 02 converge to ∞ as their respec-
tive arguments fall to zero (see Ambrus and Egorov, 2013). Following AWA and
Beshears, et al. (2015), we assume that the taste shifter  has bounded support
             £    ¤
with closure   , where 0      ∞.
   3
     See Atkeson and Lucas (1992) for an earlier use of such taste shifters. There are also other
ways of modeling taste shifters. For example, one could assume that the utility function is (−),
where  is an additive taste shifter inside the utility function. Analyzing this case is beyond the
scope of the current paper, but is part of our ongoing work.
   4
     Specifically, including a multiplicative taste-shifter in period 2 would not change any of our
results as long as the taste shifter had expected value of one.




                                                6
2.2    Information structure
We assume that households are naive in the sense that they don’t anticipate their
own present bias and hence won’t use commitment strategies (see Strotz, 1956;
O’Donoghue and Rabin, 1999a, 1999b).
    We assume that taste shifters, , and present bias, , are private information of
each household in the economy. The social planner knows the aggregate distributions
of these (independent) parameters. We assume that the distribution function of  is
 (·) and the distribution function of  is (·). We will make assumptions on these
distribution functions in the theorems that follow.


2.3    Preferences of the social planner
The social planner and the household (with taste shifter ) have nearly identical
preferences over consumption in periods 1 and 2. The only diﬀerence is that the
social planner does not endorse present bias, implying that the planner’s preferences
for an individual household are summarized by

                                  1 (1 ) +  2 (2 )

The social planner chooses policies that maximize the social objective function:
                  Z ³                                   ´
                      1 (1 ( )) +  2 (2 ( ))  () ()
                 


Note that the social planner must take account of the (endogenous) equilibrium
policy functions of the households, 1 and 2 . The social planner can influence these
policy functions (as we explain below), but can’t control them directly because the
social planner doesn’t directly observe  and  for each household (though it can
generate a mechanism that leads agents to reveal ). Finally, the social planner
must set up a mechanism that uses total resources less than or equal to the aggregate
endowment  .


2.4    Timing
Time 0: The planner sets up  accounts with interest rate , where  is a con-
straint that we discuss in the next section. Each of the  accounts is characterized

                                            7
by two variables: an initial allocation  and a linear withdrawal penalty   , which
applies only to withdrawals in period 1. Because penalties apply only in period 1,
we refer to them as early-withdrawal penalties. Specifically, if a consumer with-
draws  dollars from account  in period 1 with withdrawal penalty  , then the
consumer receives (1 −   )  dollars.5 Without loss of generality, we assume that
there are no withdrawal penalties in period 2. From the planner’s perspective, the
choice variables are the allocations to the  accounts, ( )  =1 , and the early (i.e.,
                                                            
period-1) withdrawal penalties on those accounts, (  )=1 .
     In this framework, a completely liquid account has   = 0, a partially liquid
account has an early-withdrawal penalty such that 0     1, and a completely
illiquid account has an early-withdrawal penalty   = 1.
     The planner must satisfy intertemporal, economy-wide budget balance. We state
the budget constraint in two equivalent ways. First, the integral of equilibrium con-
sumption over states must equal the overall resources in the economy,  . Our
framework assumes a continuum population of consumers (with measure one), so
integrating over taste-parameters,  and , is the same as integrating over con-
sumers. Assuming a linear storage technology, the aggregate budget constraint can
be written:          Z µ                        ¶
                                      2 ( )
                          1 ( ) +              () () ≤                    (1)
                                          
   An equivalent way of describing budget balance is to relate allocations to re-
sources. Allocations are the accounts given to each consumer. Resources are both
the initial endowment and the revenue raised from penalties paid in equilibrium.
Let  ( ) be equilibrium period-1 withdrawals from account  for consumers
with taste shifter  and present bias . Then the household-level budget constraints
can be written:

                                          X
                                          
                          1 ( ) =         (1 −   )  ( )
                                          =1
                                            X ³                 ´
                           2 ( ) =             −  ( ) 
                                             =1

   5
    The framework admits negative penalties for period 1 consumption (i.e., subsidies for period
1 consumption).




                                               8
The societal budget constraint can be written

                  X
                                 µ
                                 X     Z                       ¶
                         =  +        ( )  () () 
                  =1                =1


Note that the account allocates resources from two sources: the societal endowment,
 , and the revenue from penalties paid from early withdrawals:

                           µ
                          X     Z                      ¶
                                ( )  () () 
                           =1



Time 1: Self 1 maximizes her perceived welfare from the perspective of time 1
(which includes present bias). This will generate withdrawals from the accounts
established at date 0. Her consumption will be 1 ( ).

Time 2: Self 2 spends any remaining funds in the accounts. Her consumption will
be 2 ( ).


2.5    Summary of the -account mechanism-design problem
We can now jointly express both the planner’s problem and the consumer’s problem.
We begin with the consumer’s problem, since consumer behavior is an input to the
planner’s problem. In essence, the consumer has only one decision to make.
   In period 1, the consumer with parameters  and  faces the problem

                                  max  1 (1 ) +   2 (2 )                   (2)
                                 (  )
                                       =1



subject to the constraints

                                             X
                                             
                                  1 =           (1 −  )                      (3)
                                             =1
                                               X
                                  2 =              ( −   )                  (4)
                                              =1


Conditional on the policy vectors ( )               
                                         =1 and (  )=1 , this generates consumption
levels 1 ( ) and 2 ( ), where we have suppressed the dependency on ( )   =1



                                                 9
and (  )
          =1 .
   In period 0, the planner faces the problem
                                   Z ³                                   ´
                  max                  1 (1 ( )) +  2 (2 ( ))  () ()   (5)
            ( )           
                 =1  (  )=1



subject to the constraints that (i) 1 ( ) and 2 ( ) are given by the consumer’s
problem (equations 2-4) and (ii) economy-wide budget balance is satisfied:
                          Z µ                      ¶
                                         2 ( )
                             1 ( ) +              () () ≤                    (6)
                                             

which is equation 1.
   In other words, the planner chooses the account allocation vector, ( )  =1 , and
the penalty vector, (  )
                          =1 , to maximize social surplus (equation 5) subject to the
constraints that agents will exhibit present bias in their choices (equations 2-4) and
that total consumption does not exceed social resources (equation 6).
   To simplify notation, and without loss of generality, henceforth we set  = 1,
 = 1 and  = 1.
   The -account problem summarized here is a restricted version of a completely
general (non-linear) mechanism-design problem (our solution method is explained
in Appendix A). We compare our results to the solution of the general mechanism-
design problem below.


2.6    Laissez faire reference case:  = 0
In the analysis that follows, we will always compare social welfare to a reference
case in which there are no early-withdrawal penalties—in other words, the agent has
access to only one account (1 =  ), and this account has no penalty for early
withdrawal ( 1 = 0). This is a pure laissez-faire system, in which the government
does nothing to distort the decisions of households.




                                                    10
3         Optimal Liquidity with Homogeneous Present
          Bias and No Inter-household Transfers
In this section, we consider a first deviation from the (laissez faire) reference case.
We allow the government to intervene by setting up multiple accounts and impos-
ing early-withdrawal penalties, but we do not allow any inter-household transfers.
This is equivalent to saying that any penalty revenue that is collected must be dis-
carded/burned (instead of being transferred to other households through the gov-
ernment budget constraint). Such money burning is a case of theoretical interest
and it has been characterized by AWA. This restriction on inter-household transfers
is equivalent to assuming that
                                      X
                                           = 1
                                           =1

In other words, the sum of the resources allocated to households (account by ac-
count) will equal the total sum of resources in society, which is  = 1. (In the next
section, we eliminate the money-burning restriction and accordingly allow inter-
household transfers to occur through the tax/penalty system.)
    In this section, we assume that all agents share a common value of  — i.e., a
common degree of present bias. Hence, the distribution function  is degenerate.
    With the assumption of no inter-household transfers, our problem can be ex-
pressed using our standard notation with the aggregate budget constraint replaced
by a household-level budget constraint:

                                1 + 2 ≤ 1 for each household.

     Assuming a degenerate , no inter-household transfers, and a weak restriction
on  , the socially optimal allocation is achieved with only two accounts (AWA,
2006): one account that is completely liquid, and a second account that is completely
illiquid in period 1 and completely liquid in period 2. Any additional accounts (with
intermediate levels of liquidity) do not have any value to the planner.
     Assume that  is diﬀerentiable6 and define Γ() ≡ (1−)   0 ()+ (). Assume
                      £    ¤
there exists  ∈   such that: (i) Γ0 ≥ 0 on (0  ); and (ii) Γ0 ≤ 0 on
                                                            £    ¤
(  ∞). Assume that  0 is bounded away from zero on   . We will maintain
    6
        We assume that  and its derivative have bounded variation. See Appendix A.


                                                 11
these assumptions on  throughout the paper.

Theorem 1 (AWA, 2006; see also Ambrus and Egorov, 2013) Assume there is a
homogeneous population-wide value of . Assume that no inter-household transfers
are possible (but money-burning is possible). Welfare is maximized by giving self 1
two accounts: a completely liquid account and a completely illiquid account.

    This result is a corollary of a result in AWA and is proven in Appendix A.7
The result depends critically on two assumptions: homogeneous  and no inter-
household transfers (i.e., money burning). Under these two assumptions (and our
maintained regularity assumptions), intermediate penalties (i.e., 0%    100%)
are socially ineﬃcient because they force resources to be destroyed—the revenue from
penalties can’t be transferred to other households and must, therefore, be wasted.
    This proposition implies that no welfare benefits are achieved by increasing the
number of accounts beyond  = 2 in the -account mechanism-design problem
(equations 2-6). But the theorem relies on a strong assumption—money burning—
which prevents inter-household transfers.


4       Optimal Liquidity with Homogeneous Present
        Bias and Inter-Household Transfers
In this section, we further relax the restrictions on government by allowing inter-
household transfers. Specifically, we now impose overall budget balance rather than
consumer-by-consumer budget balance. With overall budget balance (so that inter-
household transfers are allowed), we will show that a perfectly liquid and a perfectly
illiquid account are not jointly suﬃcient to maximize social surplus.

Theorem 2 Suppose that inter-household transfers are possible. A two-account
system with one completely liquid account and one completely illiquid account does
not maximize welfare.

    Intuitively, when inter-household transfers are allowed, it is now optimal to use
early-withdrawal penalties, because the revenue from those penalties does not need
    7
    See Ambrus and Egorov (2013), for related information about this argument. The theorem is
stated here with a slightly stronger condition on  than the condition used by AWA (see Beshears,
et al., 2015).

                                               12
to be destroyed (money burning), but can instead be reallocated to relax the plan-
ner’s budget constraint. This theorem is proven in Appendix A.


4.1    Optimal policy with quasi-linear utility
Theorem 2 tells us what is not socially optimal (namely a two-account system
comprised of a completely liquid account and a completely illiquid account), but
it does not provide guidance on what is optimal. To gain intuition about socially
optimal mechanisms, it is helpful to begin by studying the quasi-linear limit case
of our model. Specifically, we consider the case in which utility is linear in period
2, i.e. 2 (2 ) = 2 . In this way, we obtain a useful exact result that captures the
intuition behind the general case in which utility is concave in both periods.

Theorem 3 Suppose that all households have the same value of . Suppose that
inter-household transfers are possible. Assume that utility is strictly concave in
the first period, linear in the second period, and the solution is interior. Then the
socially optimal retirement system is a one-account system with a Pigouvian tax on
consumption in period 1:
                                       = 1 − 

This one-account system is also first-best eﬃcient.

Proof. The wedge between the welfare criterion of the planner and the choice-
function of the agent, which is generated by present bias   1, can be exactly
oﬀset by the early-withdrawal penalty  = 1 − . This Pigouvian tax corrects the
negative internality generated by overconsumption. With this penalty, the house-
hold’s (present-biased) Euler Equation reduces to:

                       (1 − )  01 (1 ) =   01 (1 ) =  02 (2 )

Crossing out identical terms, we obtain

                                      0 (1 ) = 02 (2 )

which is the planner’s Euler Equation (if the planner observed ).
To this point, the argument does not rely on quasi-linearity, which we now deploy
to prove that the resulting allocation is also first-best. At the margin, all agents are

                                              13
doing some consumption in period 2 (because we assume an interior solution), so for
all households the value of a marginal dollar of wealth is 02 (2 ) = 1. Accordingly,
social welfare cannot be raised by changing the level of inter-household transfers.
    The special case of quasi-linear utility turns out to be a good proxy for the
general case in which the utility function is concave in both periods. We next study
that case.


4.2    Optimal policy with  accounts
We now return to the general case in which the utility functions in periods 1 and
2, namely 1 and 2 , are both strictly concave (as opposed to the quasi-linear case,
in which 2 is linear). We continue to assume that inter-household transfers are
possible. Theorem 2 establishes that a perfectly liquid account and a perfectly
illiquid account do not jointly obtain the social optimum for this case. We now
study other account structures using simulation results. Each simulation has a
diﬀerent assumption on the number of accounts and the scope that the planner has
to set withdrawal penalties on those accounts. In our benchmark simulations, we
make the following assumptions.

 A1. The utility functions in periods 1 and 2 are 1 () = 2 () = ln();

 A2. The density of the multiplicative taste shocks is a truncated normal distri-
     bution. Specifically: we start with a normal distribution (mean  = 1 and
     standard deviation  = 025); truncate it at the symmetrically placed points
     1 −  and 1 +  (where  = 23, resulting in a distribution with support
     [1 −  1 + ]); and rescale it so that it integrates to one.

    We begin with Table 1, which reports the improvement in total welfare for dif-
ferent systems of accounts where the planner chooses the optimal  and   . The
entries in this table are percentage welfare improvements with the laissez-faire case
as the benchmark. Specifically, each entry tells us how much social welfare improves
expressed as the equivalent percentage improvement in the societal resource endow-
ment; this is typically referred to as a money metric welfare criterion. We use this
welfare reporting framework throughout the rest of the paper (with the laissez-faire
case as our benchmark in all analyses).
    The first row of Table 1 reports the case of one (flexible) account. We refer to
the account as flexible to emphasize that the planner sets the penalty-level,  1 , for

                                          14
                                                       Value of 
                                          0.1      0.2     0.3        0.4     0.5
               1 Flexible                69.658   31.775 17.124      9.630   5.347
               2 Flexible                71.648   32.698 17.605      9.882   5.478
      General Mechanism (Relaxed)        71.674   32.748 17.659      9.929   5.511
           1 Liquid, 1 Illiquid          71.633   32.648 17.482      9.671   5.196

                                                        Value of 
                                          0.6       0.7     0.8       0.9     1.0
               1 Flexible                2.794     1.283 0.446       0.067   0.012
               2 Flexible                2.860     1.314 0.458       0.070   0.012
      General Mechanism (Relaxed)        2.881     1.325 0.462       0.071   0.014
           1 Liquid, 1 Illiquid          2.542     1.018 0.256       0.015   0.000

Table 1: The welfare gain from four mechanisms (namely a single account with
an endogenous penalty (row 1); two accounts with endogenous penalties (row 2); the
general mechanism (relaxed), which allows for an arbitrary non-linear budget set
and does not impose the monotonicity restriction (row 3); and a two-account sys-
tem with one completely liquid account and one completely illiquid account (row 4))
calculated for 10 diﬀerent values of  (namely 01 02  10) in the homogeneous-
model. The welfare gain is calculated as the percentage increase in household wealth
that would produce the same average welfare in the laissez-faire case. Welfare is cal-
culated using the planner’s welfare criterion (i.e., without present bias in the welfare
objective).



this account (as well as the mandatory initial balance 1 ). The second row of Table
1 reports the case of two (flexible) accounts: now the planner sets  1 and 2 (as
well as 1 and 2 ).
    The third row of Table 1 reports an upper bound for welfare improvements that
can be achieved with the completely general non-linear mechanism. This general
non-linear mechanism does not restrict the planner to use a finite set of accounts
that each have a linear early-withdrawal penalty. The general non-linear mecha-
nism allows the planner to oﬀer households a non-linear budget set from which each
household can pick a consumption pair, (1  2 ). This non-linear mechanism is equiv-
alent to the case in which the planner has a finite set of accounts, can dictate the
order in which those accounts are depleted, and lets the number of finite accounts
get large ( → ∞).



                                          15
    Our calculation of welfare improvements in the general non-linear mechanism
is an upper bound on welfare, because we omit a monotonicity restriction when
we calculate the optimum, leading us to refer to this as a ‘relaxed’ case of the
general mechanism. In practice, this monotonicity restriction has little or even no
eﬀect on welfare. See Appendix B for a complete description of our analysis of the
general non-linear mechanism. We know that our reported upper bound for welfare
improvements in the general non-linear mechanism is tight in practice because it is
nearly identical to the welfare improvements that we calculate for highly restricted
finite-account cases with a small number of linear accounts (e.g.,  = 2), as we will
show below.
    The fourth row of Table 1 reports the case of two accounts: a completely liquid
account and a completely illiquid account.
    The columns of Table 1 represent diﬀerent cases of homogeneous , starting with
 = 01 and progressing to  = 10.8
    Table 1 reveals that a simple single-account system generates most of the obtain-
able welfare gains. For example, consider the column  = 06 (a natural value for
a homogeneous calibration in light of current estimates in the empirical literature—
see Cohen, et al., forthcoming). In this column, one flexible account generates a
social-welfare gain equal to 2794% of the endowment (relative to the laissez-faire
reference case). Two flexible accounts generate a social-welfare gain equal to 2860%
of the endowment. The general non-linear mechanism generates a welfare gain that
is weakly bounded above by 2881% of the endowment.
    This analysis also reveals another important feature of the homogeneous case:
the optimal penalties are essentially Pigouvian corrections to present bias. We can
see this in Figure 1, where we report the optimal penalty for the one-account case,
which turns out to be nearly identical to (1 − ), both of which are plotted in Figure
1. This near-Pigouvian result echoes the exact Pigouvian correction that arises in
the quasi-linear case (subsection 4.1).9
   8
     There is a growing literature on estimation of present bias (e.g., Dellavigna and Paserman,
2005; Shapiro, 2005; Dellavigna and Malmendier, 2006; Gine, Karlan, and Zinman, 2010; Meier
and Sprenger, 2010; Augenblick, Niederle, and Sprenger, 2015; see Cohen, et al., forthcoming for
a review of this literature).
   9
     Similar Pigouvian taxes also arise in the cases with more than one account. For example,
with  = 06 and two accounts, the penalties on those two accounts are respectively 0.32 and 0.42,
straddling the exact Pigouvian correction of 1 −  = 04.




                                               16
             0.9

             0.8

             0.7

             0.6
                                          1-
             0.5
      , 1-




             0.4

             0.3

             0.2

             0.1

               0

             -0.1
                0.1   0.2   0.3   0.4    0.5     0.6    0.7     0.8    0.9     1




Figure 1: The optimal penalty  ∗ and the notional Pigouvian tax 1− as a function
of  in the case in which: (i) the population has homogeneous ; (ii) the planner
is confined to a mechanism with a single account, with penalty . Note that  ∗ is
always lower than 1 − . In particular,  ∗ is negative at  = 1. This is due to the
redistributional motives of the planner: she wishes to redistribute from types with
low  to types with high .


    Finally, note that an exact Pigouvian correction (which did arise in the quasi-
linear case) is not generally socially optimal, because there is an inter-household
redistributive motive for the planner when both 1 and 2 are concave. In this
general case, the planner would like to reallocate resources from low- types to high-
 types. This redistributive motive is reflected in the fact that the socially optimal
penalties in the one-account case (for any given value of ) are all strictly below the
corresponding value of (1 − ). Intuitively, the households who will be paying the
penalties are those households with the higher  values. To transfer resources to
these households, the planner lowers the socially optimal penalty below the (1 − )
benchmark value. However, as one can see in Figure 1, this downward adjustment
is small in magnitude. Accordingly, the Pigouvian correction is the dominant force

                                          17
in these simulations.


5     Optimal Liquidity with Heterogeneous Present
      Bias and Inter-Household Transfers
In this section, we continue to allow inter-household transfers. In addition, we now
relax the assumption that consumers have homogeneous . As in the previous sec-
tion, we begin with the quasi-linear case and then provide quantitative simulations.


5.1    Optimal policy with heterogeneous present bias and
       quasi-linear utility
The eﬃcacy of Pigouvian taxation generalizes to an economy with heterogeneous
present bias and quasi-linear utility, even though the planner does not directly ob-
serve each household’s . To prove this, we exploit the revelation principle and
study mechanisms in which agents reveal their intertemporal preferences (between
periods 1 and 2). Note that a household’s preferences are

                                  1 (1 ) +  2 (2 )

This representation is observationally equivalent (in choices) to the preferences,

                                  
                                    1 (1 ) + 2 (2 )
                                  

Accordingly, intertemporal preferences have a suﬃcient statistic,  = , and
the revelation principle can be implemented with the variable . We will study
general (non-linear) mechanisms in which the agents each report  and receive a
consumption pair (1  2 ) which depends on their reported value of .

Theorem 4 Suppose that inter-household transfers are possible. Assume that util-
ity is strictly concave in the first period and linear in the second period, that the
solution is interior and that E[  |  ] is non-decreasing in  = . Then the opti-
mal allocation is characterized by

                               E[  |  ] 01 (1 ()) = 1

                                           18
and the implied (local) marginal penalty rate for period 1 withdrawals is

                                () = E[ 1 −  |  ]




    Note that this penalty is an ‘average Pigouvian correction,’ in the sense that
the marginal dollar of consumption in period 1 is penalized with the conditional ex-
pected value of 1 −, where the conditioning is done with respect to the (truthfully)
reported value of . The proof of Theorem 4 is in Appendix C.
    Theorem 4 tells us that an optimal mechanism will generate penalties ranging
from  = 1 −  to  = 1 − . Intuitively, households who report the lowest feasible
value of  =  are revealing that they have the highest feasible value of  = 
and the lowest feasible value of . They will consume relatively little in period 1 and
will face a penalty of  = 1 −  for this consumption, which is an exact Pigouvian
correction because their  value has been fully revealed. An identical argument
applies for households who report the highest feasible value of  = . They
have revealed their  =  value, and accordingly will receive an exact Pigouvian
correction embodied by a penalty of  = 1 − .


5.2    Optimal policy with  accounts
We now switch from the case of quasi-linear utility to the case in which the consumer
has log utility in both periods. In the current and the following subsections, we
study optimal mechanisms using numerical solutions. We focus on cases in which 
is uniformly distributed on the interval [02 1], implying a mean value of 06.
    As before, each simulation has a diﬀerent assumption on the (finite) number of
accounts and the scope that the planner has to set withdrawal penalties on those
accounts. In all of these cases, we make assumptions A1 and A2 from the previous
section, pinning down the utility functions 1 and 2 and the distribution function
of the taste shock  . We explore the robustness of these particular cases in Section
6.
    Table 2 reports the welfare improvements (again using a money metric) that are
obtained when the planner shifts from the laissez-faire reference system to an -
account system with (second-best) optimal disincentives to overconsume in period
1. The first row of Table 2 reports the case of one flexible account. The second

                                          19
                                 1 Flexible               3.569
                                 2 Flexible               6.136
                       General Mechanism (Relaxed)        6.144
                            1 Liquid, 1 Illiquid          6.105
                       1 Liquid, 1 Flexible, 1 Illiquid   6.137

Table 2: The welfare gain from five mechanisms (namely a single account with
an endogenous penalty (row 1); two accounts with endogenous penalties (row 2); the
general mechanism (relaxed), which allows for an arbitrary non-linear budget set and
does not impose the monotonicity restriction (row 3); a two-account system with one
completely liquid account and one completely illiquid account (row 4); and a three-
account system with one completely liquid account, one account with an endogenous
penalty and one completely illiquid account (row 5)) in the heterogeneous- model
(with  distributed uniformly between 02 and 1).



row reports the case of two flexible accounts. The third row reports the case of the
general non-linear mechanism (see the earlier discussion in Subsection 4.2 and the
full derivation in Appendix B). The fourth row reports the case of two accounts: a
completely liquid account and a completely illiquid account. The fifth row reports
the case of three accounts: a completely liquid account, a partially illiquid account,
and a completely illiquid account.
    Table 2 reveals that a one-account system no longer obtains most of the feasible
welfare gains: one flexible account generates a social-welfare gain of only 3569%
of the endowment. (Following the approach in Table 1, all welfare gains in Table
2 are reported relative to the laissez faire reference case.) With just one account,
the system cannot generate the necessary heterogeneity in marginal penalties for
early consumption. However, a two-account system does get very close to this eﬃ-
ciency bound: two flexible accounts generate a social-welfare gain equal to 6136%
of the endowment. (For the two account case, we find that one penalty is close
to zero and the other is close to one.) The general mechanism generates a wel-
fare gain that is bounded above by 6144% of the endowment. A completely liquid
and a completely illiquid account generate a welfare gain of 6105% of the endow-
ment. Finally, the three-account system (one completely liquid, one partially liquid
and one completely illiquid) generates a welfare gain of 6137% of the endowment.
The (money-metric) diﬀerences among the mechanisms with more than a single ac-
count are small in economic magnitude. To summarize, a very simple two-account


                                         20
system—one perfectly liquid and one perfectly illiquid—generates approximately op-
timal welfare gains. Such a two-account system is commonplace in most countries
in the developed world (Beshears, et al., 2015).
    To gain intuition for this result, we report a related set of analyses in Figure
2. Here, we study a two-account system. One account is completely liquid (i.e.,
1 = 0) and the other account has varying illiquidity (i.e.,  2 varies). As we vary the
penalty  2 from 0 to 1, we re-optimize the allocations 1 and 2 to the liquid and the
partially illiquid accounts. The horizontal axis shows the penalty  2 , and the vertical
axis shows the average welfare of the cross sections of the population obtained by
fixing  at one the five values 02, 04, 06, 08 and 10. In this context it should
be emphasized that all households are treated identically ex ante and, therefore,
receive the same allocations and face the same early-withdrawal penalties. Also, the
allocations are chosen to maximize the welfare of the population as a whole. The
welfare of a given  cross section is then obtained by averaging over the welfare of
the households with that particular value of .
    For the  = 02 households, welfare as perceived by the planner rises dramati-
cally as the early-withdrawal penalty increases (Figure 2). Indeed, as 2 rises from
0 to 1, the increase in welfare for the  = 02 households is equivalent, using a
money metric, to a 30% increase of wealth (the money-metric welfare improvement
is equivalent to half of the vertical distance on Figure 2). From the planner’s per-
spective, there is a substantial gain from discouraging these low- households from
excessive consumption in period 1.
    Households with other  values experience increasing and then decreasing welfare
as  2 increases from 0 to 1. However, conditional on , all households experience
a rise in expected welfare as  2 rises from zero. For low- households, this rise
occurs because higher penalties prevent low- households from overconsuming in
period 1. For high- households, this rise occurs because higher penalties generate
larger cross-subsidies from low- households to high- households. Specifically, these
cross-subsidies occur because higher penalty revenue relaxes the planner’s budget
constraint, thereby enabling the planner to give agents higher endowments in period
1. High- households are net recipients of cross-subsidies because they tend to make
smaller early withdrawals and, therefore, pay fewer penalties than low- households
(look ahead to Figure 4).
    Unlike the welfare of low- households, which rises monotonically as  2 rises,


                                           21
                                -1.3
                                           =1
                                                 =0.8
                                                          =0.6
                                -1.4

                                                                 =0.4
      Cross-Sectional Welfare




                                -1.5


                                -1.6


                                -1.7


                                -1.8                                          =0.2


                                -1.9


                                 -2
                                       0   0.1   0.2    0.3   0.4        0.5     0.6   0.7   0.8   0.9   1
                                                                          2


Figure 2: The welfare of various  cross sections of the population as a function
of  2 in the case in which: (i) the population has heterogeneous ; (ii) the planner
is confined to a mechanism with two accounts, with penalties  1 and 2 respectively;
(iii)  1 = 0 (i.e., the first account is completely liquid); (iv) the account allocations
are chosen to maximize the welfare of the population as a whole. Note that the cross
section of the population with  = 082 (not shown) is almost indiﬀerent between
the system with  2 = 0 and the system with  2 = 1.




                                                                    22
the welfare of high- households eventually peaks and thereafter falls with  2 . This
single-peaked property arises because, while initial rises in  2 simply result in greater
revenue from the early-withdrawal penalties paid by low- households, later rises
tend to eliminate early withdrawals altogether. Hence the cross-subsidy to high-
households first rises and then falls. By the time  2 reaches 1, the cross-subsidy
has been completely eliminated, and high- households are now facing a binding
constraint (if they have a suﬃciently high  value) that limits their ability to adjust
consumption in period 1, so high- households are slightly worse oﬀ on average
than they were when 2 was 0. On a money-metric basis, the  = 1 households
experience a welfare loss equivalent to 023% of their income as the planner moves
from 2 = 0 to  2 = 1 in Figure 2. However, this welfare loss is swamped by the
welfare gain experienced by the  = 02 types (which is two orders of magnitude
larger).
    Figure 3 shows the welfare of the population as a whole as a function of the early-
withdrawal penalty  2 . It confirms that—as one would expect—the enormous welfare
gains for low- households swamp the modest welfare losses for high- households,
an example of asymmetric paternalism (Camerer, et al., 2003). Although it appears
that total social welfare rises monotonically and asymptotes, social welfare actually
reaches a global maximum at 2 = 085 and then falls very slightly. However, the
fall in welfare between 2 = 085 and  2 = 1 is insignificant: it is 000002% of wealth
using a money metric. Accordingly, the social optimum is eﬀectively obtained with
one completely liquid account and one completely illiquid account.
    Figure 4 reports the gross penalties paid by households with diﬀerent values of
 (again integrating over ). As anticipated above, the penalties are hump shaped
in 2 , with the hump occurring for larger values of  2 the lower the value of . For
example, for  = 1, the hump peaks at  2 = 007. For  = 02, the hump peaks
at  2 = 051. Intuitively, high- households stop making early withdrawals even
when the penalty is low (because they value utils in period 2 almost as much as
they value utils in period 1). By contrast, low- households do not stop making
early withdrawals until the penalty reaches a relatively high level.




                                           23
                                 -1.38



                                  -1.4
      Whole-Population Welfare




                                 -1.42



                                 -1.44



                                 -1.46



                                 -1.48



                                  -1.5
                                         0   0.1   0.2   0.3   0.4        0.5   0.6   0.7   0.8   0.9   1
                                                                           2


Figure 3: The welfare of the population as a whole as a function of 2 in the case
in which: (i) the population has heterogeneous ; (ii) the planner is confined to a
mechanism with two accounts, with penalties  1 and  2  respectively; (iii)  1 = 0
(i.e., the first account is completely liquid); (iv) the account allocations are chosen
to maximize the welfare of the population as a whole. Note that: (i) while this is not
immediately apparent from the figure, the function in question is non-monotone; (ii)
the optimal penalty  ∗2 is approximately 85%; (iii)  ∗2 yields a proportional increase of
approximately 000002% in money-metric welfare relative to the case in which 2 = 1
(i.e., the case in which the second account is completely illiquid). In particular, the
welfare cost of setting the penalty on the second account too low far exceeds that of
setting it too high.




                                                                     24
                                  0.12


                                   0.1
      Cross-Sectional Penalties


                                  0.08


                                  0.06

                                                                                                 =0.2
                                  0.04
                                                                                  =0.4
                                  0.02                           =0.6
                                                          =0.8
                                               =1
                                     0


                                  -0.02
                                          0   0.1   0.2    0.3   0.4        0.5     0.6   0.7   0.8     0.9   1
                                                                             2


Figure 4: The total penalties paid by various  cross sections of the population as
a function of  2 in the case in which: (i) the population has heterogeneous ; (ii)
the planner is confined to a mechanism with two accounts, with penalties  1 and  2 
respectively; (iii)  1 = 0 (i.e., the first account is completely liquid); (iv) the account
allocations are chosen to maximize the welfare of the population as a whole.


5.3                      A three-account system that approximates the U.S. re-
                         tirement savings system
The fifth row in Table 2 reports the welfare gains for a three-account system ( = 3).
We will see that this analysis reproduces some of the features of the U.S. system.
    We constrain the first account to be completely liquid ( 1 = 0) and the third
account to be completely illiquid ( 3 = 1). Think of this third account—the illiq-
uid account—as Social Security or a defined-benefit pension. The planner picks the
penalty on the “middle” account (0   2  1) and the values of the three endow-
ments (1 , 2 and 3 ) to optimize social welfare (while satisfying the budget con-
straint). The “middle” account turns out to have an optimal penalty of  2 = 013,
which is close to the actual penalty associated with a 401(k) or IRA account, namely

                                                                       25
010.
    Adding this optimized “middle” account to the constrained two-account system
(row 4 in Table 2) only slightly raises consumer welfare relative to the two-account
system with a completely liquid and a completely illiquid account. Comparing rows
4 and 5 of Table 2, we see that the addition of the middle account increases social
welfare by 6137% − 6105% = 0032% of wealth (using a money metric).
    Our simulations reveal that the middle account is characterized by a very high
degree of leakage in equilibrium. Ninety percent of the assets in the middle account
are withdrawn to fund consumption in period 1. Figure 5 disaggregates this result,
by plotting the cumulative distribution function of the ratio 2 1 . Figure 5 shows
that 76% of households choose the maximal value of 1 (corresponding to a full
withdrawal of the funds in the partially liquid account), generating a consumption
ratio of 2 1 = 094. Another 22% of households withdraw at least some (though
not all) of the funds in the partially liquid account. Another 1% of households
choose to save all of the funds in the partially liquid account for retirement (but
no more than that). Finally, 1% of households choose to save some of the funds in
the completely liquid account for retirement (in addition to all of the funds in the
partially liquid account).
    In summary, our analysis finds that welfare is nearly as high in the two-account
system with a completely liquid account and a completely illiquid account as it is
in the three-account system that adds a partially illiquid account.10 When a third
account is added, it looks and performs somewhat like a U.S. 401(k) plan: the third
account has an optimized penalty of 013 and generates a very high rate of leakage
in equilibrium. This high leakage rate is even higher than the empirical leakage rate
observed in the U.S. system.
    One explanation for the diﬀerence between the model-predicted leakage rate
(90%) and the empirically observed leakage rate (40%) is that initial account bal-
ances in the model are generated by government fiat, whereas almost all of the
dollars in real-world 401(k)/IRA accounts are voluntarily deposited, implying that
  10
     The third account oﬀers the welfare benefit of additional separation for high- households
and low- households. However, the third account has two eﬀects that jointly oﬀset the welfare
gains from separation. First, the third account enables low- households to increase their period
1 over-consumption. Second, withdrawals from the third account generate (socially ineﬃcient)
transfers of resources from low- and high- households to high- and low- households because
of the penalties that are paid for period 1 withdrawals from the third account. These tax revenues
are redistributed in the mechanism.



                                               26
                            1

                           0.9

                           0.8

                           0.7
      Cumulative Density




                           0.6

                           0.5

                           0.4

                           0.3

                           0.2

                           0.1

                            0

                                 0.8   1   1.2   1.4   1.6   1.8         2   2.2   2.4   2.6   2.8
                                                              c 2 /c 1


Figure 5: The distribution function of the ratio 2 1 of period-2 consumption to
period-1 consumption in the population as a whole in the case in which: (i) the
population has heterogeneous ; (ii) the planner is confined to a mechanism with
three accounts, with penalties  1 ,  2 and  3  respectively; (iii)  1 = 0 (i.e., the
first account is completely liquid); (iv)  3 = 1 (i.e., the third account is completely
illiquid); (v) both  2 and the account allocations are chosen to maximize the welfare
of the population as a whole. There are two atoms in the distribution: a large atom
accounting for about 76% of the total mass near 2 1 = 094; and a small atom
accounting for about 1% of the total mass near 2 1 = 170. Individuals at the
second atom have withdrawn the entire balance from the first (liquid) account, but
have not yet touched the second account. Individuals at the first atom have withdrawn
the entire balance from both the first and the second accounts. In particular, they
have paid the penalty  2 on the entire balance of the second account.




                                                             27
they are coming from households with higher  values and lower  values in the first
place. In this sense, one can’t directly compare the leakage rate in the model (which
is the aftermath of universal forced savings in a DC system) and the leakage rate
in the US economy (which is the aftermath of voluntary savings in a DC system).
Accordingly, diﬀerential selection makes this an apples to oranges comparison.
    Another key factor that explains the high model-predicted leakage rate is the fact
that the planner endogenously (optimally) chooses to put a large fraction of each
household’s resources into the completely illiquid account, thereby reducing the mar-
ginal value of retirement consumption, and implicitly encouraging pre-retirement
withdrawals of balances in the partially illiquid account. However, we find that
leakage rates from the partially illiquid account are substantially lower under a sys-
tem in which contributions to the completely illiquid account (e.g., Social Security)
are exogenously set at a lower level than is recommended by our normative frame-
work. Our mechanism-design framework generates nearly complete consumption
smoothing between period 1 and period 2, even if the household relies only on the
resources from the completely illiquid account to finance period-2 consumption. By
implication, our framework recommends far more funding for the completely illiquid
account than we actually observe in the United States. If we adopt an empirically
more realistic (modest) funding rule for the completely illiquid account, then we
observe much lower levels of leakage from the partially illiquid account because its
balances are more urgently needed to support consumption in period 2 (i.e., retire-
ment). We return to these issues in Subsection 6.1.


6     Optimal Policy with Transfers and Heteroge-

      neous Present Bias: Robustness
In the previous section, which studied the case in which inter-household transfers
are allowed and present bias is heterogeneous in the population, three key findings
emerged:

    1. The constrained-eﬃcient social optimum is approximated by a two-account
       system, with one account that is completely liquid and a second account that
       is completely illiquid. Little welfare gain is obtained by moving beyond this
       simple two-account system.

                                         28
   2. If a third account is added, its optimized early-withdrawal penalty is 13%.

   3. The equilibrium leakage rate from this third account is 90%.

    In the current section, we document the robustness of these three findings when
the distribution of  is heterogeneous.11 With respect to the first finding, the largest
incremental welfare gain that we generate in our robustness checks by extending the
system of savings accounts beyond one completely liquid and one completely illiquid
account is 0081% of income. Hence, we continue to find that a simple system with
one completely liquid account and one completely illiquid account is approximately
socially optimal.
    With respect to the second finding, the optimized penalty on the partially illiq-
uid account ranges from 11% to 14% across our calibrated economies. Hence, we
continue to find that the partially illiquid account has a penalty that is similar to
the penalties on 401(k)s and IRAs.
    With respect to the third finding, the equilibrium leakage rate ranges from 84% to
99%. Hence, we continue to find that our simulations generate very high equilibrium
leakage rates.
    The detailed results are reported in the three panels of Table 3, which report the
welfare gain (relative to the laissez faire case) for (i) the two-account system 1 = 0
and  2 = 1, (ii) the three-account system with  1 = 0, 0   2  1, and  3 = 1,
and (iii) the upper bound of the general mechanism (i.e., the ‘relaxed’ non-linear
case described in Appendix B). For case (ii), in addition to the welfare gain, we
also report the penalty  2 and the leakage rate. Note that the upper bound on the
welfare gain—case (iii)—is always tight in the sense that it is economically close to
the constrained -account cases that we study.
    Table 3a varies the value of the coeﬃcient of relative risk aversion (). In our
benchmark calibration, we set  = 1. In Table 3a, we study the cases  = 12,
 = 1 (for comparison), and  = 2.
    Table 3b varies the shape of the density of . Recall that in our benchmark cal-
ibration, the density of the multiplicative taste shocks is truncated normal. Specif-
ically, we start with a normal distribution, with mean  = 1 and standard devi-
ation  = 025; the resulting density is truncated (and reweighted) with support
  11
    When  takes on a degenerate distribution — i.e.,  is homogeneous in the population — these
results no longer apply (see the last column in Table 3c).



                                              29
                                                             Value of   
                                                         0.5    1.0        2.0
                    1 Liquid, 1 Illiquid               8.851 6.105       3.261
               1 Liquid, 1 Flexible, 1 Illiquid        8.919 6.137       3.274
               ––––             Penalty ∗2             0.13 0.13         0.11
               ––––           Leakage Rate              0.89 0.90         0.99
               General Mechanism (Relaxed)             8.932 6.144       3.278
                  (a) Variation of the coeﬃcient of relative risk aversion 

                                                            Value of  
                                                        0.30 0.25 0.20
                    1 Liquid, 1 Illiquid               5.918 6.105 6.323
               1 Liquid, 1 Flexible, 1 Illiquid        5.958 6.137 6.344
               ––––             Penalty ∗2             0.14 0.13 0.12
               ––––           Leakage Rate              0.84 0.90 0.89
               General Mechanism (Relaxed)             5.966 6.144 6.349
                (b) Variation of the standard deviation   of the taste shock

                                                          Value     of  
                                                   +∞     1.0         0.5  0.0
                1 Liquid, 1 Illiquid               6.105 6.019      5.772 2.542
           1 Liquid, 1 Flexible, 1 Illiquid        6.137 6.053      5.810 2.841
           ––––             Penalty  ∗2           0.13 0.13         0.14 0.36
           ––––           Leakage Rate             0.90 0.90         0.90 0.73
           General Mechanism (Relaxed)             6.144 6.060      5.819 2.881
          (c) Variation of the standard deviation   of the present bias distribution

Table 3: Robustness checks for welfare gains, optimal penalties and leakage rates.
In each subtable: row 1 contains welfare gains for a two-account system with one
completely liquid account and one completely illiquid account; row 2 contains welfare
gains for a three-account system with one completely liquid account, one account with
an endogenous penalty and one completely illiquid account; rows 3 and 4 contain the
optimal penalty and leakage rate from the endogenous-penalty account associated with
the system in row 2; and row 5 contains welfare gains for the general mechanism
(relaxed), which allows for an arbitrary non-linear budget set and does not impose the
monotonicity restriction. Table 3a varies the value of the coeﬃcient of relative risk
aversion . Table 3b varies the parameter  of the truncated-normal distribution
of . Table 3c varies the parameter   of the truncated-normal distribution of .




                                              30
[1 −  1 + ], with  = 23. In Table 3b, we study the cases  = 030,  = 025
(for comparison), and  = 020.
    Table 3c varies the standard deviation of the distribution of  values (holding
the mean fixed). In our benchmark calibration, we studied the case of a uniform
distribution of  between 02 and 10. In Table 3c, we study truncated normal
distributions of , with 02 and 10 serving as the truncation points. Our original
benchmark is equivalent to the (truncated) normal case with  = ∞ and  = 06.
We now reduce   to 1, 12 and 0 (holding the truncation points and  fixed). The
case   = 0 is the degenerate case in which all agents have the same value of  = 06.
Our results do not generalize to the degenerate case (the last column of Table 3c).
As we showed in Section 5, the homogeneous- case engenders a Pigouvian tax as
the approximately optimal policy.


6.1     How our normative framework deviates from the U.S.
        retirement savings system
Our model predicts that the planner should set up a completely illiquid account
and populate it with enough assets so that, in equilibrium, there is at most a small
drop in consumption at retirement. For example, under the optimal policy with
a three-account system—one completely liquid, one partially illiquid (with an op-
timized 0.13 early-withdrawal penalty), and one completely illiquid—the respective
allocations are 364%, 162%, and 474% of assets. Accordingly, the completely illiq-
uid account alone (with 474% of total assets) is suﬃcient to generate nearly equal
consumption in periods 1 and 2, even if the household consumes all of its completely
liquid and partially illiquid assets in period 1. The high level of completely illiquid
retirement savings explains the high level of equilibrium leakage from the partially
illiquid account (in period 1). The partially illiquid account is a source of retire-
ment consumption that can be used to supplement the consumption that will be
generated by the assets in the completely illiquid account. Because the mandatory,
completely illiquid retirement savings is so large (at the social optimum), households
are not strongly motivated to preserve the assets in the partially illiquid account
until retirement. Accordingly, the equilibrium leakage rate from the partially illiquid
account is 902%.12
  12
   The high leakage rate implies that the partially illiquid account has very little impact on
almost all households (relative to a world in which the funds from the partially illiquid account


                                               31
    In the United States, the actual allocation to completely illiquid accounts is far
lower than our optimized policy implies (e.g., mandatory savings is not suﬃcient
to generate approximate consumption smoothing on its own in the United States),
implying that the partially illiquid account plays a more important role in practice
than it does in our model. To illustrate this point, we report another calibration of
the model where we exogenously set the account balance allocations (rather than
endogenously optimizing them) to better reflect the operation of the status quo
system in the United States. When we exogenously allocate 50% of assets to the
liquid account, 25% of assets to the partially illiquid account (with a 010 early-
withdrawal penalty to match the U.S. retirement savings system), and 25% of assets
to the completely illiquid account, we obtain a leakage rate from the partially illiquid
account of 456%, which is close to the leakage rate in the United States (see Argento,
Bryant and Sabelhaus, 2014).


7     Conclusions and Directions for Future Work
To summarize, we focus on the case in which agents have heterogeneous present bias
and the planner can implement mechanisms with inter-household transfers. Three
findings emerge from our analysis:

    1. The constrained-eﬃcient social optimum is well-approximated by a two-account
       system, with one account that is completely liquid and a second account that
       is completely illiquid. Little welfare gain is obtained by moving beyond this
       simple two-account system. Accordingly, the two-account system identified
       in AWA (in a model with homogeneous  and no inter-household transfers)
       turns out to be approximately optimal in our new setting (with heterogeneous
        and inter-household transfers).

    2. If a third account is added, its optimized early-withdrawal penalty is only
       slightly above 10%.

    3. In equilibrium, the leakage rate from this (partially illiquid) third account
       is high. We report a range of equilibrium leakage rates, depending on the
were instead put in the liquid account). This explains why the partially illiquid account has such
a small eﬀect on total social welfare relative to the two-account benchmark, with a completely
liquid account and a completely illiquid account.


                                               32
       calibration. With optimal allocations to all three accounts—completely liquid,
       partially illiquid, and completely illiquid—equilibrium leakage rates from the
       partially illiquid account range from 73% to 99%. By contrast, when we
       calibrate the model to match actual empirical allocations to the completely
       illiquid account (e.g., treating Social Security as the empirical analog of the
       model’s completely illiquid account), the implied equilibrium leakage rate from
       the partially illiquid account drops to 46%.

     These properties have analogs in the U.S. retirement savings system. The United
States has completely liquid accounts (e.g., a standard checking account), completely
illiquid accounts (e.g., Social Security), and a partially illiquid defined-contribution
system with a 10% penalty for early withdrawals (e.g., an IRA or a 401(k)). This
partially illiquid DC system has a leakage rate of approximately 40% (see Argento,
Bryant and Sabelhaus, 2014).
     Despite these similarities, it is inappropriate to conclude that our findings demon-
strate the social optimality of the U.S. system. Most importantly, our theoretical
model is highly stylized. First, we assume only two periods (e.g., working life and
retirement).13 Second, we assume a particular form of multiplicative taste shifter14
and a limited set of distributions of that taste shifter. Third, we assume that house-
holds are naive with respect to their present bias parameter, . Fourth, we study
a limited set of distributions of this parameter.15 Fifth, we assume a particular
conceptual formulation of self-defeating behavior (present bias).16
     Moreover, our simulations imply that retirement consumption should not be
allowed to fall far below working life consumption (recall that the illiquid account
has a high funding level when we calculate the socially optimal system). In the actual
data on U.S. households, consumption proxies appear to decline between working
life and retirement,17 raising the normative possibility that mandatory savings might
  13
     Infinite horizon problems introduce technical challenges with respect to multiple equilibria.
However, there has been progress on this issue. For example, see Harris and Laibson (2012) and
Cao and Werning (2018).
  14
     We assume () but we could have instead assumed ( − ).
  15
     Research is only beginning on the distribution of present bias. For analysis of this issue, see
Lockwood (2016), Moser and Olea de Souza e Silva (2017), and Cohen, et al., (2019).
  16
     Other models of self-control include Thaler and Shefrin (1981), Gul and Pesendorfer (2001),
Bernheim and Rangel (2004), O’Donoghue and Loewenstein (2004), Fudenberg and Levine (2006).
See Ericson and Laibson (2019) for a review of this wider class of ‘present-focused’ models.
  17
     See Stephens and Toohey (2018).



                                                33
be underutilized in the U.S.18 However, there is an active debate about both the
existence and normative interpretation of the observed distribution of consumption
changes for households transitioning from work life into retirement.19
    Our normative result on underutilization of mandatory savings is closely related
to a similar result reported in Moser and Olea de Souza e Silva (2017). Though
many elements of the two models diﬀer, both models assume that agents are present
biased, and they both imply that optimal savings mechanisms are characterized by
more mandatory savings than currently exists in the U.S. system.
    Much more robustness work is needed to interrogate the three findings that we
summarized above, as well as the additional finding that more mandatory savings
would be socially optimal. It is not yet clear whether these results will continue to
hold as future research enriches and expands this type of analysis.
  18
     In our model, mandatory savings are achieved through a funded system. Our model takes
no position on the distinction between funded (e.g., the superannuation scheme in Australia) and
unfunded (e.g., U.S. Social Security) mandatory savings systems.
  19
     See Beshears, et al., (2018) for a recent review of the literature on consumption dynamics at
and through retirement.




                                               34
8   References
Allcott, Hunt, Benjamin B. Lockwood, and Dmitry Taubinsky, forthcoming. “Re-
     gressive Sin Taxes, With an Application to the Optimal Soda Tax,” Quarterly
     Journal of Economics.

Amador, Manuel, Ivan Werning, and George-Marios Angeletos, 2006. “Commit-
   ment vs. Flexibility.” Econometrica 74, pp. 365-396.

Ambrus, Attila, and Georgy Egorov. 2013. “Comment on ‘Commitment vs. Flex-
   ibility’” Econometrica 81.5: 2113-2124.

Argento, Robert, Victoria L. Bryant and John Sabelhaus, 2014, “Early With-
    drawals from Retirement Accounts During the Great Recession,” Contempo-
    rary Economic Policy.

Atkeson, Andrew, and Robert E. Lucas. “On eﬃcient distribution with private
    information.” The Review of Economic Studies 59.3 (1992): 427-453.

Augenblick, Ned, Muriel Niederle, and Charles Sprenger, 2015. "Working over
   time: Dynamic inconsistency in real eﬀort tasks." The Quarterly Journal of
   Economics 130, no. 3: 1067-1115.

Bernheim, B. Douglas, and Antonio Rangel. 2004. "Addiction and cue-triggered
    decision processes." American economic review 94, no. 5: 1558-1590.

Bernheim, B. Douglas and Dmitry Taubinsky. 2018. “Behavioral Public Eco-
    nomics” in B. Douglas Bernheim, Stefano DellaVigna, and David Laibson
    (eds.), Handbook of Behavioral Economics, Volume 1, New York: Elsevier:
    381-516.

Beshears, John, James J. Choi, Joshua Hurwitz, David Laibson, and Brigitte C.
    Madrian. 2015. “Liquidity in retirement savings systems: An international
    comparison.” American Economic Review 105, no. 5: 420-25.

Beshears, J., James J. Choi, David Laibson, & Brigitte Madrian, 2018. “Behav-
    ioral household finance” in B. Douglas Bernheim, Stefano Dellavigna, and
    David Laibson Eds. Handbook of Behavioral Economics - Foundations and
    Applications 1. (Volume 1) Elsevier.

                                      35
Beshears, John, James Choi, Christopher Harris, David Laibson, Brigitte Madrian,
    Jung Sakong. 2020. “Which Early Withdrawal Penalty Attracts the Most
    Deposits to a Commitment Savings Account?” Journal of Public Economics.

Camerer, Colin, Samuel Issacharoﬀ, George Loewenstein, Ted O’Donoghue & Matthew
   Rabin. 2003. “Regulation for Conservatives: Behavioral Economics and the
   Case for ‘Asymmetric Paternalism’.” 151 University of Pennsylvania Law Re-
   view 101: 1211—1254.

Cao, Dan, and Iván Werning, 2018. “Saving and dissaving with hyperbolic dis-
    counting.” Econometrica 86.3: 805-857.

Cohen, Jonathan D., Keith Marzilli Ericson, David Laibson, and John Myles
   White. (Forthcoming) “Measuring time preferences.” Journal of Economic
   Literature.

DellaVigna, Stefano and Ulrike Malmendier, 2006. “Paying Not to Go to the
    Gym.” American Economic Review 96, pp. 694-719.

DellaVigna, Stefano and Daniele Paserman, 2005. “Job Search and Impatience.”
    Journal of Labor Economics 23, pp. 527-588.

Ericson, Keith Marzilli, and David Laibson. 2019. “Intertemporal choice,” in B.
     Douglas Bernheim, Stefano DellaVigna, and David Laibson (eds.), Handbook
     of Behavioral Economics, Volume 2, New York: Elsevier.

Farhi, Emmanuel, and Xavier Gabaix, 2018. “Optimal Taxation with Behavioral
    Agents.” Working paper.

Fudenberg, Drew and David K. Levine, 2006. “A Dual-Self Model of Impulse
    Control.” American Economic Review 96, pp. 1449-1476.

Gine, Xavier, Dean Karlan, and Jonathan Zinman, 2010. “Put Your Money Where
    Your Butt Is: A Commitment Contract for Smoking Cessation.” American
    Economic Journal: Applied Economics 2, pp. 213-235.

Gruber, Jonathan, and Botond Köszegi, 2001. “Is addiction ‘rational’ ? Theory
   and evidence.” The Quarterly Journal of Economics 116.4: 1261-1303.



                                      36
Gruber, Jonathan, and Botond Kőszegi, 2004. “Tax incidence when individuals
   are time-inconsistent: the case of cigarette excise taxes.” Journal of Public
   Economics 88.9-10: 1959-1987.

Gul, Faruk and Wolfgang Pesendorfer, 2001. “Temptation and Self-Control.”
    Econometrica 69, pp. 1403-1435.

Harris, Christopher, and David Laibson, 2012. “Instantaneous gratification.” The
    Quarterly Journal of Economics 128.1 (2012): 205-248.

Hewitt Associates, 2009. “The Erosion of Retirement Security from Cash-outs:
   Analysis and Recommendations.” Available at http://www.aon.com/human-
   capital-consulting/thought-leadership/retirement/reports-pubs_retirement_c
   ash_outs.jsp, accessed April 18, 2011.

Laibson, David, 1997. “Golden Eggs and Hyperbolic Discounting.” Quarterly Jour-
    nal of Economics 112, pp. 443-477.

Laibson, David I., Andrea Repetto, Jeremy Tobacman, 1998. “Self-control and
    saving for retirement.” Brookings Papers on Economic Activity , no. 1: 91-
    196.

Lockwood, Benjamin B., 2016. “Optimal income taxation with present bias.”
    University of Pennsylvania Working Paper.

Loewenstein, George and Ted O’Donoghue, 2004. “Animal spirits: Aﬀective and
    deliberative processes in economic behavior.” Available at SSRN 539843.

Meier, Stephan and Charles Sprenger, 2010. “Present-Biased Preferences and
    Credit Card Borrowing.” American Economic Journal: Applied Economics
    2, pp. 193-210.

Moser, Christian and Olea de Souza e Silva, Pedro, 2017. “Optimal Paternalis-
   tic Savings Policies” Columbia Business School Research Paper No. 17-51.
   Available at SSRN: https://ssrn.com/abstract=2959844 or http://dx.doi.org/
   10.2139/ssrn.2959844.

O’Donoghue, Ted and Matthew Rabin, 1999a. “Doing It Now or Later.” American
   Economic Review 89, pp. 103-124.

                                      37
O’Donoghue, Ted and Matthew Rabin, 1999b. “Incentives for procrastinators.”
   The Quarterly Journal of Economics 114:3, pp. 769-816.

O’Donoghue, Ted, and Matthew Rabin, 2006. “Optimal sin taxes.” Journal of
   Public Economics 90.10-11 (2006): 1825-1849.

Phelps, E. S. and R. A. Pollak, 1968. “On Second-Best National Saving and Game-
    Equilibrium Growth.” Review of Economic Studies 35, pp. 185-199.

Shapiro, Jesse, 2005. “Is There a Daily Discount Rate? Evidence from the Food
    Stamp Nutrition Cycle.” Journal of Public Economics 89, pp. 303-325.

Stephens Jr, Melvin and Toohey, Desmond, 2018. “Changes in Nutrient Intake at
    Retirement” (No. w24621). National Bureau of Economic Research.

Steyer, Robert, 2011. “DC Plan Leakage Problem Alarming, Solutions Evasive.”
    Pensions & Investments, April 4, 2011.

Strotz, R. H., 1956. “Myopia and Inconsistency in Dynamic Utility Maximization.”
    Review of Economic Studies 23, pp. 165-180.

Thaler, Richard H. and H. M. Shefrin, 1981. “An Economic Theory of Self-
    Control.” Journal of Political Economy 89, pp. 392-406.




                                      38
Online Appendices

A      Proofs of Theorems 1 and 2
A.1     Introduction
We assume that: 1  2 : ( 0 ∞) → (−∞ ∞); 01  02  0 and 001  002  0 on (0 ∞);
and 01 (0+) = 02 (0+) = ∞. Next, in order to formulate our assumptions on the
distribution function  of the taste shock , we introduce the function Γ defined by
the formula
                           Γ() = (1 − )   0 () +  ()

Our assumptions on  are then:

A1 Both  and  0 are functions of bounded variation on (0 ∞).

A2 The support of  0 is contained in [   ], where 0      ∞.

A3 There exists  ∈ [ ] such that: (i) Γ0 ≥ 0 on (0  ); and (ii) Γ0 ≤ 0 on
    ( ∞).

A4  0 is bounded away from 0 on (   ). In particular,  0 (+)  0 (−)  0.

Finally, we assume that 0    1.
   Under these assumptions, we have:

Theorem 5 Suppose that interpersonal transfers are not possible. Then welfare is
maximized by giving self 1 two accounts: a completely liquid account and a completely
illiquid account.

   This result is proved (under slightly diﬀerent assumptions) in Amador et al
(2006), and in Beshears et al (2020).
   We also have:

Theorem 6 Suppose that interpersonal transfers are possible. Then a two-account
system with one completely liquid account and one completely illiquid account never
maximizes welfare.

    This result is proved in the current appendix.

                                           39
A.2     The Optimization Problem of the Planner
If self 1 is presented with two accounts, a perfectly liquid account containing the
amount liquid  0 and a perfectly illiquid account containing the amount illiquid ≥ 0,
then the outcome will depend on her type . There will exist 1 ∈ (0 ∞) such that:
if   1 , then she consumes less than the balance liquid in her liquid account: and,
if  ≥ 1 , then she consumes the whole of liquid . The cutoﬀ 1 need not lie in [   ].
It could be that 1  , in which case there will be perfect pooling: all types will
consume the whole of liquid and both 1 and 2 will be constant. Or it could be that
1  , in which case there will be perfect separation: all types will consume less
than liquid , 1 will be strictly increasing in  and 2 will be strictly decreasing in .
     More generally, we will obtain consumption allocations 1  2 : Θ → (0 ∞) and
associated utility allocations 1  2 : Θ → R, where the latter are given by the
formulae 1 () = 1 (1 ()) and 2 () = 2 (2 ()). The overall utility allocation
(1  2 ) will be a smooth function of  for   1 , have a kink at 1 , and be constant
for   1 . The idea behind the proof is to find necessary conditions for utility
allocations of this type to be optimal, and to use these necessary conditions to
derive a contradiction.
     The first step is to formulate the optimization problem of the planner. We do this
in terms of general utility allocations 1  2 : Θ → R, reserving the notation 1  2
for the specific allocations arising from two-account systems with one completely
liquid account and one completely illiquid account. Accordingly, the planner seeks
to maximize social welfare
                                  Z
                                     ( 1 () + 2 ())  ()

over utility allocations

              (1  2 ) : [   ] → (1 (0+) 1 (∞−)) × (2 (0+) 2 (∞−))

subject to aggregate budget balance and incentive compatibility. Aggregate budget
balance can be expressed in the form
                      Z
                           ( − 1 (1 ()) − 2 (2 ()))  () ≥ 0               (BC)

where  = −1
              for  ∈ {1 2}. Incentive compatibility breaks down into two parts,

                                             40
a linear part
                                                10 +  20 = 0                    (ICL)

and a monotonic part
                                                   20 ≤ 0                         (ICM)

Remark 7 The two conditions (ICL) and (ICM) are simply the diﬀerential coun-
terpart of the usual integral representation of incentive compatibility in a mechanism-
design problem.

Remark 8 Since incentive-compatible utility allocations 1  2 are monotonic, in the
sense that 1 is non-decreasing and 2 is non-increasing, it makes sense to restrict
1 and 2 to the space of functions of bounded variation. If this is done, then 10 and
20 are both measures, and (ICL) and (ICM), therefore, both make sense.


A.3      The Case 1 ∈ (   )
Consider the case in which liquid and illiquid are such that 1 ∈ (   ). In this case,
the second step is to parameterize candidate solutions to planner’s problem in terms
                                                0                       0
                                                                             £     ¤
of 1 (  ), 2 (  ) and continuous functions 1 : [  1 ] → R and 1 : 1   → R.
More precisely, we can put:
                            R        0
                                                       £      ¤
   1. 1 () = 1 (  ) −    
                                     1 ()  for  ∈ 1   ;
                             R 1      0
   2. 1 () = 1 ( 1 ) −       
                                      1 ()  for  ∈ [  1 ];
                                    £      ¤
       0
   3. 2 () = −  1
                      0
                         () for  ∈ 1   ;
       0
   4. 2 () = −  1
                      0
                         () for  ∈ [  1 ];
                            R        0
                                                       £      ¤
   5. 2 () = 2 (  ) −    
                                     2 ()  for  ∈ 1   ;
                             R 1      0
   6. 2 () = 2 ( 1 ) −       
                                      2 ()  for  ∈ [  1 ].

                                                        0                           0
In other words: 1 is the function with derivative 1    on [  1 ), derivative 1 on
¡       ¤                                                                   0
  1   and value 1 (  ) at ; and 2 is the function with derivative 2 on [  1 ),
            0
                  ¡        ¤
derivative 2 on 1   and value 2 (  ) at .




                                                      41
Remark 9 The logic behind this parameterization is to consider 10 as a function
of bounded variation on [   ]. In this case, the left- and right-hand limits of 10 are
well defined at all points of (   ). In particular, 10 (1 +) and 10 (1 −) are both well
                                  0
defined, and we can interpret 1    (1 ) as 10 (1 +) and 1
                                                              0
                                                                 (1 ) as 10 (1 −). Analogous
remarks apply to 20 .

    The third step is to formulate the Lagrangean. This can be written
                                                        Z
                        0     0
 (1 (  ) 2 (  ) 1  1        )   =     ( 1 () + 2 ())  ()
                                                           Z
                                                        + ( − 1 (1 ()) − 2 (2 ()))  ()
                                                          Z
                                                                      0
                                                        −            2 ()   ()
                                                           [ 1 ]
                                                          Z
                                                                       0
                                                        −            2  ()   ()         (7)
                                                           [ 1  ]

where:

                                                                 0       0
   1. the arguments of  are the parameters 1 (  ), 2 (  ), 1 and 1 , and the
      multipliers ,   and   ;

   2.  is a scalar (namely the multiplier on the aggregate budget constraint);

   3.   is a finite non-negative Borel measure on [  1 ] (namely the multiplier
                                                        0
      associated with the non-positivity constraint on 2 );
                                                     £      ¤
   4.   is a finite non-negative Borel measure on 1   (namely the multiplier
                                                        0
      associated with the non-positivity constraint on 2 );
                               0         0
   5. the variables 1 , 2 , 2 and 2  on the right-hand side are determined by the
                                      0       0
      parameters 1 (  ), 2 (  ), 1 and 1 as explained above.

Remark 10 The Lagrangean does not include a term corresponding to (ICL). This
                                            0       0               0       0
is because we have used (ICL) to solve for 2 and 2 in terms of 1 and 1 .

                                                                                         0    0
    The fourth step is to note that we can associate parameters (1 (  ) 2 (  ) 1    1 )
with the reference utility curve (1  2 ) in the obvious way, and take the deriva-
                                                                        0     0
tive of the Lagrangean at the parameter values (1 (  ) 2 (  ) 1     1 ) in the direc-
                                                               0     0
tion of the alternative parameter values (1 (  ) 2 (  ) 1  1 ). Furthermore, this

                                                        42
                                                                                           0    0
calculation can be simplified by noting that the variables (1  2  2                     2 ) in the
RHS of the equation for the Lagrangean are linear in the underlying parameters
                      0     0
(1 (  ) 2 (  ) 1  1 ). Hence we can simply take the derivative of the RHS at the
point (1  2  2  2 ) in the direction of the point (1  2  02  02 ) and only then
                    0     0

substitute for (1  2  02  02 ) in terms of (1 (  ) 2 (  ) 01  01 ).
                                                                           0      0
     Taking the derivative of the RHS at the point (1  2  2              2  ) in the direction of
the point (1  2  02  02 ), we obtain
                          Z                             Z
                 0 =        ( 1 + 2 )  −  (10 (1 ) 1 + 20 (2 ) 2 ) 
                            Z                           Z
                                      0
                          −          2 ()   () −          02 ()   ()                     (8)
                             [1 ]                     [1 ]

for all feasible (1  2  02  02 ). Moreover, the constraints must all be satisfied. That
is,
                                 Z
                        0 =          ( − 1 (1 ()) − 2 (2 ()))  ()
                             0
                        0 ≥ 2 
                             0
                        0 ≥ 2 

Finally, constraint qualification must hold. That is,
                                             Z
                                                         0
                                     0 =                2 ()   ()                              (9)
                                              [1 ]
                                             Z
                                                         0
                                     0 =                2 ()   ()                            (10)
                                              [1 ]

    Furthermore, a variation (1  2  02  02 ) is feasible iﬀ it can be expressed in
terms of the underlying parameters (1 (  ) 2 (  ) 01  01 ). We therefore substitute
for the variation (1  2  02  02 ) in terms of the underlying parameters (1 (  ) 2 (  ) 01  01 )
and manipulate the RHS in such a way as to expose the linear dependence of the
RHS on 1 (  ), 2 (  ), 01 and 01 .
                                                    R                              R
    The first contribution to the RHS is  1  (). Putting  () = []  () ,
and noting that   −  and 1 are both continuous, we can integrate this contri-




                                                        43
bution by parts to obtain
      Z                                                         Z
                         £             ¤
            1  () = (   −  ) 1 − −             (   −  ) 01 
                                                              Z
                             ¡                    ¢
                           =   (  ) −  (  ) 1 (  ) − (   −  ) 01 
                             ¡                    ¢
                           =   (  ) −  (  ) 1 (  )
                               Z                               Z
                                                      0
                             −           (   −  ) 1  −             (   −  ) 01 
                                [ 1 ]                        [ 1  ]
                                                         R
The second contribution to the RHS is                        2  (). For this contribution, we have
       Z                                             Z
            2  () = [             2 ]− 02 
                                                 −
                                               Z
                          =  (  ) 2 (  ) −  02 
                                               Z                     Z
                                                             0
                          =  (  ) 2 (  ) −             2  −              02 
                                                 [ 1 ]              [ 1  ]
                                               Z                        Z
                                                             0
                          =  (  ) 2 (  ) +              1  +                01 
                                                [ 1 ]                  [ 1  ]
                             R
Next, putting Λ1 () =         []
                                       10 (1 ())  (), we have
                Z                                    Z
           −       10 (1 ) 1    = −                1  Λ01 
                                                                        Z
                                          =      − [1  Λ1 ]−   Λ1 01 
                                                                    +
                                                                   Z
                                          = −1 (  )  Λ1 (  ) +  Λ1 01 

                                          = −1 (  )  Λ1 (  )
                                              Z                       Z
                                                              0
                                            +            Λ1 1  +             Λ1 01 
                                               [ 1 ]                [ 1  ]




                                                          44
                                          R
Similarly, putting Λ2 () =               []
                                                  20 (2 ())  (),
             Z                                       Z
        −       20 (2 ) 2    = −                       2  Λ02 
                                                                              Z
                                              =   − [2  Λ2 ]−      Λ2 02 
                                                                          +
                                                                       Z
                                              = −2 (  )  Λ2 (  ) +  Λ2 02 

                                              = −2 (  )  Λ2 (  )
                                                  Z                        Z
                                                                   0
                                                +             Λ2 2  +             Λ2 02 
                                                   [ 1 ]                 [ 1  ]
                                              = −2 (  )  Λ2 (  )
                                                  Z                          Z
                                                                   0
                                                −             Λ2  1  −              Λ2  01 
                                                    [ 1 ]                   [ 1  ]

Finally, we have
                            Z                                         Z
                        −                 02 ()   ()      =                  
                                                                                    
                                                                                        01 ()   ()
                                [1 ]                                   [1 ]


and                       Z                                           Z
                      −               02 ()   ()          =                  
                                                                                    
                                                                                        01 ()   ()
                            [1 ]                                   [1 ]
   The fifth step is to equate the coeﬃcients of 1 (  ), 2 (  ), 01 and 01 to 0.
Doing so yields:

           0 =   (  ) −  (  ) −  Λ1 (  )                                                                          (11)
           0 =  (  ) −  Λ2 (  )                                                                                      (12)
                                                                                                           
           0 = −(   −  )  +                         
                                                               +  Λ1  −                
                                                                                                  Λ2  +   
                                                                                                                      (13)
                                                                                                           
           0 = −(   −  )  +                         
                                                               +  Λ1  −                
                                                                                                  Λ2  +   
                                                                                                                      (14)

                          0
Now, we certainly have 2    0 on [  1 ]. (This is because, if   1 , then self 1
                                    0              0
consumes less than liquid . Hence 1   0 and 2     0.) It therefore follows from
constraint qualification (namely (9)) that   = 0. Equation (13) therefore implies
that
            ( Λ2 −  Λ1 ) =   −  (  −  ) = (1 − )   +   = Γ           (15)



                                                                 45
                                                                         R
almost everywhere on [ 1 ], where Γ = (1 − )   0 +  and Γ() =      []
                                                                                   Γ() .
Furthermore, since  0 is of bounded variation,

                       Λ2 ()
                               →  20 (2 ())  0 (+)
                       −
                       Λ1 ()
                               →  10 (1 ())  0 (+)
                       −
                          Γ
                               → Γ(+) = (1 − )   0 (+)
                        −

as  ↓ . But, since (1 () 2 ()) is chosen freely from the ambient budget line by
the  type, we must have
                                  10 (1 ())   0 (2 ())
                                               = 2           
                                                    
We therefore have
                                Λ2 () −  Λ1 ()
                                                   →0
                                      −
as  ↓ . On the other hand,

                            Γ
                               → (1 − )   0 (+)  0
                           −

as  ↓ . Passing to the limit in equation (15), we therefore obtain

                                0 = (1 − )   0 (+)

Since the RHS is strictly positive, this is a contradiction. This establishes that we
cannot have 1 ∈ (   ).

Remark 11 We have used the assumption that   1.


A.4     The Case 1 ∈ [  ∞ )
Consider now the case in which liquid and illiquid are such that 1 ∈ [  ∞ ). In
this case, we can still derive equations (11, 12 and 13). In particular, we can still
derive equation (13). We can therefore derive a contradiction by essentially the
same argument.




                                          46
A.5     The Case 1 ∈ ( 0  ]
Consider now the case in which liquid and illiquid are such that 1 ∈ ( 0  ]. In this
case, we can still derive equations (11, 12 and 14). However, we can no longer derive
equation (13). We therefore need new arguments. The first point to note is that,
since 1 ≤ , all types  ∈ [   ] choose the point that a hypothetical 1 type would
choose from the ambient budget set. We therefore have
                             Z
                Λ1 (  ) =            10 (1 ())  () =  (  ) 10 (1 (1 ))   (16)
                              []
                             Z
                Λ2 (  ) =            20 (2 ())  () =  (  ) 20 (2 (1 ))   (17)
                              []

Furthermore, since the 1 type chooses freely from the ambient budget set, we have

                                 10 (1 (1 ))   0 (2 (1 ))
                                                = 2             
                                       1              

Using (11) and (12), we therefore obtain

                     (  ) − ( )   Λ1 (  ) 10 (1 (1 )) 1
                                     =          = 0            =                     (18)
                         ( )         Λ2 (  )  2 (2 (1 ))  

Hence
                                                   ¡                    ¢
                 (  − 1 )  (  ) =   (  ) −    (  ) −  (  )
                                      = (1 − )   (  ) +   (  )
                                      = Γ(  )                                       (19)

where Γ and Γ are as above.

Remark 12 Bearing in mind that 1 ≤ , so that Γ(1 ) = 0, this equation can also
be written
                      ( − 1 )  (  ) = Γ(  ) − Γ(1 )

or                                 Z
                               1
                                            Γ()  =  (  )
                              − 1 [1 ]
That is, 1 satisfies the equation for the optimal cutoﬀ in the problem without inter-

                                                47
personal transfers. Cf. Amador et al (2006) and Beshears et al (2020).

Remark 13 That 1 should satisfy the equation for the optimal cutoﬀ in the problem
without interpersonal transfers makes perfect sense. If 1 ≤  then all  types make
the same choice, and the optimum with interpersonal transfers happens not to involve
any transfers. It must therefore also be the optimum without interpersonal transfers,
and must therefore satisfy the equation for the optimal cutoﬀ in the problem without
interpersonal transfers.

   However, we have not yet used equation (14). It follows from this equation that

                          
                                                       ¡               
                                                                             ¢
                   =   
                              (   −  )  −   +  Λ2 −           
                                                                           Λ1 

In other words,   is absolutely continuous w.r.t. Lebesgue measure, with density

                                
                                                       ¡           
                                                                         ¢
                      0 =     
                                    (   −  ) −  +  Λ2 −       
                                                                       Λ1 

Furthermore:
                     Z
                                                                ()
         Λ1 () =             10 (1 ())  () =  () 10 (1 (1 )) =
                                                                     Λ1 (  )
                    []                                     ( )
                    () 1             () 1  (  )   1  ()
                 =          Λ2 (  ) =                  =
                   (  )             ( )             

(where the last line follows from (18) and (12)); and
                     Z
                                                                               ()
         Λ2 () =             20 (2 ())  () =  () 20 (2 (1 )) =          Λ2 (  )
                      []                                                   ( )
                      ()  (  )    ()
                 =                 =
                     (  )           

(where the last line follows from (12)). Hence

                                ( Λ2 −  Λ1 ) = ( − 1 )  ()

and

                       0 =  (   −  ) −   + ( − 1 ) 
                                = ( − 1 )  () − Γ

                                                48
   Now,  () = Γ() = 0. Hence   0 () = 0. Furthermore, we must have   0 ≥ 0
  ¡ ¢
on   . Hence
                               0 () −   0 ()
                                                     ≥ 0
                                      −
Letting  → +, we therefore obtain

                        (  0 )0 (+) = (  − 1 )  0 (+) ≥ 0

Since  0 (+)  0, it follows that 1 ≤  . Similarly, (19) implies that ( −
1 )  (  ) − Γ(  ) = 0. Hence   0 (  ) = 0. Hence

                                     0 (  ) −   0 ()
                                                             ≤ 0
                                             −

Letting  → −, we therefore obtain

                       (  0 )0 (−) = (  − 1 )  0 (−) ≤ 0

Since  0 (−)  0, it follows that 1 ≥  . These two inequalities on 1 are incon-
sistent, so we have a contradiction.

Remark 14 This is where we use the assumption   0: we would not obtain a
contradiction by combining two inequalities 1 ≤   and 1 ≥   if we had  = 0.

Remark 15 We can use the preceding analysis to obtain some perspective on why
a pooling mechanism in which all resources are placed in the illiquid account is
                                                                         0
never optimal. Suppose that we replace the inequality constraint 0 ≥ 2    with an
equality constraint and choose the multiplier   in such a way that this constraint
is respected. Then, proceeding almost exactly as above, we will obtain

                               0
                       (  0 )    = ( − 1 )  0 +  − Γ
                                    = ( − 1 )  0 − (1 − )   0
                                    = (  − 1 )  0 

Moreover we will have the boundary conditions   0 () = 0 and   0 (  ) = 0. It
                  ¡        ¢                  ¡ ¢
follows that 1 ∈     and   0  0 on   . Hence a small change in the
direction of any incentive-compatible and fully separating mechanism is desirable.

                                                49
(This would have the eﬀect of reducing 20 from 0—and increasing 10 from 0—at all
points in the range (   ).) In other words, it is always desirable to allow some
flexibility to the decision maker to respond to the information contained in .


B     Analysis of a General (Non-Linear) Mechanism
B.1     The Mechanism-Design Problem
In the general mechanism-design problem, the planner chooses a budget set

                                         ⊂ (0 ∞)2

and consumption allocations 1  2 : Θ ×  → (0 ∞) to maximize welfare
                 Z Z
                        ( 1 (1 ( )) + 2 (2 ( ))) () ()  

subject to the resource constraint
                Z Z
                       ¡                   1
                                                        ¢
                         − 1 ( ) −    
                                               2 ( )  () ()   ≥ 0

and the incentive-compatibility constraint

                 (1 ( ) 2 ( )) ∈ argmax { 1 ( e
                                                         1 ) +  2 ( e
                                                                       2 )} 
                                           1 
                                          (   2 )∈


Here,  is the density of  (associated with distribution function  in the main text);
 is the density of  (associated with distribution function  in the main text); 
is the per capita endowment; and  is the gross rate of return. Furthermore, we
assume that: Θ = [   ];  = [   ]; 0      ∞; 0      ∞;  is
continuous and bounded away from 0 on Θ;  is continuous and bounded away from
0 on .

Remark 16 For example:  might take the form
                                   ³ ¡      ¢2 ´
                               exp − 12 −
                                         
                   () = R        ³ ¡      ¢´             for  ∈ [   ]
                                     1 − 2
                            
                               exp  − 2  
                                                 


                                                50
and  () = 0 otherwise, i.e.,  might be the density of the univariate normal dis-
tribution with mean  and variance  2 truncated to the interval [   ]; and  might
take the form
                                    1
                           () =          for  ∈ [   ]
                                  −
and () = 0 otherwise, i.e.,  might be the density of the uniform distribution on
the interval [   ].


B.2     Transforming the Problem
The first step in solving this problem is to note that

                        (1  2 ) ∈ argmax { 1 (e
                                                   1 ) +  2 (e
                                                                2 )}
                                    1 
                                   (   2 )∈


iﬀ                                               n                          o
                                                     
                        (1  2 ) ∈ argmax          
                                                         1 (e
                                                             1 ) + 2 (e
                                                                        2 ) 
                                    1 
                                   (   2 )∈

The set of optimal choices of the individual therefore depends only on  =   .
Combining this fact with the assumed continuity of the distribution functions 
and  of  and  implies that, if we put Φ = [   ] where  =    and  =   ,
then the planner can work with consumption allocations 1  2 : Φ → (0 ∞) instead
of with consumption allocations 1  2 : Θ ×  → (0 ∞).
    The second step is to note that we can work with utility allocations 1  2 : Φ → R
instead of with consumption allocations 1  2 : Φ → (0 ∞). The former are related
to the latter via the formulae 1 () = 1 (1 ()) and 2 () = 2 (2 ()). We can also
invert these formulae to get 1 () = 1 (1 ()) and 2 () = 2 (2 ()).
    The third step is to note that we can change variables in the integral defining
welfare and in the integral giving the resource constraint, replacing ( ) with ( ).
    At this point, the planner’s problem can be expressed as that of choosing 1  2 :
Φ → R to maximize welfare
                     Z Z
                           (  1 () + 2 ())  ( ) ()  




                                                 51
subject to the resource constraint
           Z Z µ                             ¶
                                 1
                 − 1 (1 ()) − 2 (2 ())  ( ) ()   ≥ 0
                                 

and the incentive-compatibility constraint, which now has two parts, namely a linear
part,
                                 0 =  10 () + 20 ()                      (ICL)

and a monotonic part,
                                      0 ≤ −20 ()                             (ICM)

Remark 17 Notice that, whenever 1 and 2 are chosen from a budget set , 1
will be non-decreasing and 2 will be non-increasing. However, neither function
need be diﬀerentiable (or even continuous). Hence the derivatives 10 and 20 might
in principle be a non-negative and a non-positive measure respectively. This does
not invalidate (IC1) or (IC2), both of which make sense for measures. However, in
what follows, we will sometimes reason as if 10 and 20 exist in the usual sense.

   The fourth step is to introduce the marginal density  of  and the conditional
density  of  given , namely
                                      Z
                             () =           ( ) ()                      (20)

and
                                              ( ) ()
                              ( | ) =                                         (21)
                                                 ()
We can also introduce the conditional expectation of , namely
                                        Z
                               () =         ( | )                        (22)

Remark 18 The limits of integration in the definition of  (namely (20)) are im-
plicit in the definitions of  and . Since the integrand will only be non-zero if both
                                                       ©        ª         ©          ª
( ) and () are non-zero, these limits are max      and min      .
In particular, the support of the conditional distribution of  varies with :
              £       ©            ª¤                        £         ¤
  1. For  ∈   min        , the support of  is      . In other
     words: the range of  types that is consistent with  is increasing in , and

                                             52
     this range always includes . By the same token, the range of  types that is
     consistent with  is increasing in , and this range always includes .
                £    ©              ª ¤                          £          ¤
  2. For  ∈ max          , the support of  is      . In other
     words: the range of  types that is consistent with  is decreasing in , and
     this range always includes .
                                         £   ©             ª       ©             ª¤
  3. If        then, for  ∈ min         max        , the
     support of  is [    ]. In other words, if the range of  types is large relative
     to the range of  types, then all  types are consistent with intermediate values
     of .
                                         £   ©             ª       ©             ª¤
  4. If        then, for  ∈ min         max        , the
                      £             ¤
     support of  is        . In other words, if the range of  types is small
     relative to the range of  types, then there is no value of  for which all 
     types are consistent with that value.

    Armed with  and , the integral defining welfare and the integral giving the
resource constraint can be expressed
                          Z ³                      ´
                             ()  1 () + 2 () ()                          (W)

and               Z µ                             ¶
                                      1
                      − 1 (1 ()) − 2 (2 ()) ()  ≥ 0                      (R)
                                      
We have therefore completed the transformation of our initial two-dimensional prob-
lem into a purely one-dimensional problem.
   The Lagrangean for the one-dimensional problem can be written
                    Z ³                       ´
                        ()  1 () + 2 () () 
                       Z µ                               ¶
                                                1
                    +       − 1 (1 ()) − 2 (2 ()) () 
                                                
                      Z
                    − ( 10 () + 20 ()) () () 
                      Z
                    − 20 () () () 

where the Lagrange multipliers on the resource constraint, the incentive-compatibility

                                          53
constraint (ICL) and the incentive-compatibility constraint (ICM) take the form
 ∈ R,  : Φ → R and  : Φ → R.


B.3        The First-Order Conditions
In order to derive first-order conditions from this Lagrangean, we must first eliminate
10 and 20 . We can do this by integrating by parts. Taking the third term of the
Lagrangean, we obtain
                Z                                     Z
            −       ( 10   +   20 )      = − (( 1 )0 − 1 + 20 )   
                                                  Z            Z
                                                =   1    − (( 1 )0 + 20 )   

where we have dropped the dependence of 1 , 2 ,  and  on . Moreover
       Z                                                                  Z
   −                0
           (( 1 ) +   20 )          = − [(( 1 ) +  2 )  ]
                                                                      + (( 1 ) + 2 ) ( )0 
                                             Z
                                           =    (( 1 ) + 2 ) ( )0 


(since () = () = 0). Similarly, taking the fourth term,
                             Z                                     Z
                         −         20      = − [2    ]
                                                              + 2 ( )0 
                                                  Z
                                                =    2 ( )0 

The Lagrangean can therefore be written
                    Z µµ                          µ                    ¶¶
                                                              1
                          (  + ) 1 + 2 +   − 1 (1 ) − 2 (2 )   
                                                              
                                                     ´
                    + ( 1 + 2 ) ( )0 + 2 ( )0 

    Diﬀerentiating the latter Lagrangean with respect to 1 and 2 , we obtain the
first-order conditions
                                     ³                     ´
                                  0 =   +  −  10 (1 )  +  ( )0




                                                       54
and                    µ              ¶
                             1 0
                    0 = 1 −  2 (2 )  + ( )0 + ( )0 
                             
We also have: (IC1), namely
                                  0 =  10 + 20 ;

the complementary slackness condition associated with the resource constraint,
namely
                        R³                           ´     )
                    0≤      − 1 (1 ) − 1 2 (2 )  
                                                             ;
                    0≤
and the complementary slackness condition associated with (IC2), namely
                                                )
                                     0 ≤ −20
                                                    
                                     0≤

B.4    The Relaxed Problem
We focus on the relaxed version of the problem, in which we do not impose (IC2).
Furthermore, we look for a solution of the relaxed problem in which the resource
constraint holds as an equality. We therefore drop  from the equations and tackle
the three diﬀerential equations
                         ³                     ´
                     0 =    +  −  10 (1 )  +  ( )0                (23)
                         µ                 ¶
                                  1 0
                     0 =   1 −  2 (2 )  + ( )0                        (24)
                                 
                     0 =  1 + 20
                            0
                                                                             (25)

and the integral equation
                        Z µ                       ¶
                                         1
                     0=     − 1 (1 ) − 2 (2 )                       (26)
                                         

   The first step is to make 1 and 2 the subjects of equations (23) and (24).
Putting 1 = (10 )−1 and 2 = (20 )−1 , we obtain
                                              ³ ´
                                                1
                                1 = 1                                     (27)
                                          ³  ´
                                              2
                                2   = 2                                   (28)
                                             

                                         55
where

                                               ( )0
                               1 =   +  +                                     (29)
                                       µ         ¶
                                            ( )0
                               2 =  1 +                                         (30)
                                              

B.5     Solving (23-25) where  and  are Smooth
                                                          ©                     ª
Consider the equations (23-25) in the open region Φ̊ = Φ r            . In
this region, both  and  are smooth. Hence we may diﬀerentiate (27,28) to obtain
                                                ³  ´ 0
                                                   1   1
                                   10 = 10                                      (31)
                                                   
                                                ³  ´ 0
                                                   2   2
                                   20    = 20                                    (32)
                                                   

and, substituting (31,32) in (25),
                                         ³  ´ 0       ³  ´ 0
                                            1   1          2   2
                            0 =  10             + 20          
                                                         

    Next, provided that 1 and 2 have the same coeﬃcient of relative risk aversion
, the latter equation is homogeneous in . It therefore simplifies further to

                              0 =  10 (1 ) 01 + 20 (2 ) 02 

(If 1 and 2 have coeﬃcient of relative risk aversion , then 10 () = 20 () =
    1
1  −2

   .)
    Next, substituting for 01 and 02 and collecting terms in 00 , 0 and , we obtain
                ¡                          ¢
             0 = 2 10 (1 ) +  20 (2 ) 2 00
             + ( ( 0 + 2 ) 10 (1 ) + 0  20 (2 ))  0
               ¡ ¡                        ¢              ¡      ¢           ¢
             +   ( 00 + 0 ) −  02 10 (1 ) +  00 − 02  20 (2 ) 
             + ( 0 + ) 10 (1 ) 2                                           (33)

In other words, in the region Φ̊, equations (23-25) reduce to a second-order ordinary
diﬀerential equation for .



                                               56
B.6     Solving (23-25) where  and  have Kinks
Now consider the equations (23-25) at the points 1 =    and 2 =   , where
both  and  have kinks. We cannot diﬀerentiate (27,28) at these points. However,
we do have
                                 µ           ¶      µ           ¶
                                   1 ( +)          1 ( −)
                  ∆1 ( ) = 1               − 1               
                                                         
                                 µ           ¶      µ           ¶
                                   2 ( +)          2 ( −)
                  ∆2 ( ) = 2               − 2
                                                         

where

                                                      ( )0 ( +)
                      1 ( +) =   + ( +) +                   
                                                         ( )
                                                      ( )0 ( −)
                      1 ( −) =   + ( −) +                   
                                                         ( )
                                     µ                   ¶
                                           ( )0 ( +)
                      2 ( +) =  1 +                    
                                              ( )
                                     µ                   ¶
                                           ( )0 ( −)
                      2 ( −) =  1 +                    
                                              ( )

Hence, at  , we can impose the value-matching condition

                             0 = ∆( ) = ( +) − ( −)                           (34)

and the incentive condition

      0 =  (1 (1 ( +)) − 1 (1 ( −))) + (2 (2 ( +)) − 2 (2 ( −)))    (35)


B.7     Solving (23-25) at the Endpoints
Assuming for concreteness that 1  2 , we now have the second-order ordinary
diﬀerential equation (33) in the three open intervals (  1 ), (1  2 ) and (2   ).
Moreover, we have two boundary conditions at each of 1 and 2 . (Cf. (34) and
(35).) The obvious way of completing the equation would therefore be to require
that  take on appropriate values at the boundaries  and . However,  decays
linearly to 0 at both  and . Moreover, inspection of (33) shows that:

   1. the coeﬃcient of 00 is positive and of order 2 near  and ;

                                              57
     2. the coeﬃcient of 0 is positive and of order  near , and negative and of order
         near ;

     3. the coeﬃcient of  is negative and of order 1 near  and .

Hence  will not take on boundary values at  and  in the usual way.20 On the
other hand, the inhomogeneous term, namely

                                        ( 0 + ) 10 (1 ) 2 

is of order 2 near  and . In particular, it is bounded. Hence the relevant solution
of the equation is the one that is bounded near  and .21


B.8       Solving for 
As we have seen, we can find  by solving the second-order o.d.e. (33) with the
required boundary conditions at the internal boundaries 1 and 2 and the required
boundedness properties at the endpoints  and . Like  and ,  can be expected
to have kinks at 1 and 2 . The next step is to solve for . This can be done using
the resource equation (26).
    Indeed, if 1 and 2 have the same coeﬃcient of relative risk aversion , then we
have                                    ³ ³  ´´ ³  ´ 1
                                                     
                            ( ) =        =         
                                                    
Hence, substituting in (26),
        Z µ    ³  ´ 1               ¶              Z µ                ¶
                  1       1 ³ 2 ´ 1           − 1      1      1
                                                                   1 1
                                                                      
     0=     −          −                 =            − 1 − 2  
                                                                 

or                                            µ 1         ¶
                                          R        1 
                                                        1
                                               1 +  2  
                                   1
                                   =           R            
                                                     
  20
    Intuitively speaking, the dynamics of  move away from the endpoints  and .
  21
    Since the inhomogeneous term is of order 2 near  and , the solution can in fact be expected
to decay quadratically to 0 at both  and . In particular, we would expect that it would satisfy
(  ) = 0 (  ) = 0 and (  ) = 0 (  ) = 0. These equations cannot, however, be used as boundary
conditions. For one thing, there are too many of them! (There are 4 instead of 2.) They are simply
additional properties that we would expect the unique bounded solution to possess.



                                                   58
Bearing in mind that 1 and 2 are given in terms of  by equations (29) and (30),
this gives us a formula for  in terms of .


B.9      Completing the Solution
It is then a straightforward matter to find the remaining unknowns in the model:
1 and 2 are given in terms of  and  by (27) and (28); and 1 and 2 are given in
terms of 1 and 2 by the formulae 1 = 1 (1 ) and 2 = 2 (2 ).


C      Analysis of the Quasi-Linear Limit Case for a
       Population of Agents with Heterogeneous 
C.1      Introduction
In Subsections 4.1 and 5.1, we discuss the quasi-linear limit case of our model: i.e.,
the case in which the utility function in the second period is linear (i.e., 2 (2 ) = 2 ).
In this case, the planner’s problem can be written
        Z ³                    ´                   Z ³              ´
    max    1 (1 ) + 2 (2 )  () () = max    1 (1 ) + 2  () ()

subject to                   Z ³       ´
                                1 + 2  () () = 

                         ∈ arg max
                                 0
                                    { 1 (1 (0 )) + 2 (2 (0 ))}                   (IC)
                                  ∈Φ

for  ≡ .
    We study equilibria that satisfy the revelation principle, and, following the lit-
erature, refer to these as direct mechanisms. When we talk about , we refer to the
true value of  elicited from each agent in an equilibrium that satisfies the revelation
principle.

Proposition 19 Suppose that E[  |  ] is non-decreasing in . Then, the allocation
rule under the optimal mechanism is

                                  E[  |  ] 01 (1 ()) = 1



                                              59
Accordingly the implied marginal penalty is:

                                 () = 1 − E[  |  ]

   Accordingly, in the case of homogeneous , we get a simple Pigouvian tax,
 = 1−, because E[  |  ] is equal to the homogeneous value of  in the population.
In the case of heterogeneous , we get a -conditional Pigouvian tax: () =
1 − E[  |  ].


C.2     Derivations
C.2.1    Implementability

Given the representation of the problem in the space of , we now eﬀectively have
a single-type mechanism-design problem. We begin by transforming the problem
into the promised utility space, 1 () = 1 (1 ()) and 2 () = 2 (2 ()) = 2 ().
We invoke the standard equivalence between global incentive compatibility and the
combination of integral incentive compatibility and monotonicity. Monotonicity
implies 10 () ≥ 0, and in the standard way we solve the relaxed mechanism (not
subject to monotonicity) and verify that the solution satisfies monotonicity.
    Integral incentive compatibility is the standard condition, derived from the En-
                                                                 
velope Theorem. In particular, the Envelope Theorem implies      (1 () + 2 ()) =
1 (), and we obtain integral incentive compatibility by integrating:
                                                               Z     
                   1 () + 2 () =  1 () + 2 () +                1 ()
                                                                 


We then use integral incentive compatibility to define the function 2 in terms of
the function 1 and the constant 2 (), which gives us the implementing function
2 that guarantees integral incentive compatibility:
                                                 Z   
                  2 () =  1 () + 2 () +           1 () −  1 ()
                                                 

    We then characterize 2 () from 1 using the resource constraint. Rewriting the
resource constraint over promised utility in the  space:
                         Z
                             ¡ −1                 ¢
                              1 (1 ()) + 2 () () = 

                                           60
Rearranging:          Z                        Z
                          2 () () =  −       −1
                                                    1 (1 ()) ()


Or, in other words, given a specification of a function 1 , we can use this condition
plus the implementability condition to pin down 2 . In other words, if we substitute
in the implementability condition for 2 , we get an equation for 2 ()in terms of 1 :
                Z                                      Z µZ                         ¶
 2 () =  −       −1
                     1 (1 ()) ()   −  1 () −              1 () −  1 () ()
                                                          


C.2.2    Completing the Model

Lastly, let us rewrite the objective function in terms of  and 1 . The contribution
of type- agents to social welfare is E[  |  ] 1 () + 2 (). Therefore, the planner
objective function is:
                           Z ³                          ´
                              E[  |  ] 1 () + 2 () ()

Substituting in the characterization of 2 above, we get:
       ½Z ³                               ´          ¾
                                −1
   max     E[  |  ] 1 () − 1 (1 ()) () +                   s.t. (Monotonicity).
    1


That is, the planner chooses a non-decreasing function 1 , with the implementability
conditions above defining the function 2 that implements this outcome.

Proposition 20 Suppose that E[  |  ] is non-decreasing in . Then, the optimal
allocation rule is:
                           E[  |  ] 01 (1 ()) = 1

Proof. This condition is simply the first order condition from choosing the control
1 , and substituting back in 1 () = 1 (1 ()). Provided that E[  |  ] is non-
decreasing, the above first order condition yields a monotone function 1 (and hence
monotone 1 ), and so is implementable.




                                             61
C.3     The Optimal Penalty
Consider the implied marginal penalty () that implements the above allocation
rule. The marginal trade-oﬀ of a private agent is then:

                              (1 − ())  01 (1 ()) = 1

Therefore, the marginal penalty is:
                                              ∙      ¸
                                E[  |  ]      
                     1 − () =            =E     |  = E[  |  ]
                                               

C.4     Homogeneous 
If  is homogeneous, then E[  |  ] = , and we have:

                                     () = 1 − 

That is, we simply have a Pigouvian tax. Note that homogeneous  always satisfies
the “regularity condition” of Proposition 1 needed to guarantee monotonicity. In
fact, this result is first-best.

Proposition 21 With homogeneous , the Pigouvian tax yields a first-best alloca-
tion.

Proof. With () = 1 − , every agent sets  01 (1 ) = 1, so the allocation rule is
first-best. The resource distribution of 2 is irrelevant to social welfare, and therefore
we have the first-best social welfare.
    It is simply a social first-best allocation, since as emphasized above, any zero-
sum perturbation ∆ of 2 is also a first-best allocation rule. However, the allocation
rule above is the unique first-best implementable allocation rule. To understand why
the allocation rule is unique, note that the optimal rule 1 is unique (the solution to
the simple first order condition). The resource constraint then uniquely pins down
2 (), given 1 . Finally, integral incentive compatibility uniquely pins down the full
function 2 , given 1 and 2 ().




                                           62
C.5     Heterogeneous 
If  is heterogeneous and the regularity condition of Proposition 1 is satisfied, then
as mentioned before we have:

                                () = 1 − E[  |  ]

That is, we have an “average Pigouvian tax”: the optimal tax rate on the margin
for a type- agent is the average tax rate in that population.
    We know that () must be close to 1 −  near , where the highest  types
are the only ones with that  type. Similarly, we know that () ' 1 −  near .
This suggests a large degree of flexibility over initial withdrawals, and much tighter
restrictions on flexibility for households withdrawing a lot.




                                         63
