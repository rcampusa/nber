                                NBER WORKING PAPER SERIES




              PRE-EVENT TRENDS IN THE PANEL EVENT-STUDY DESIGN

                                       Simon Freyaldenhoven
                                         Christian Hansen
                                          Jesse M. Shapiro

                                        Working Paper 24565
                                http://www.nber.org/papers/w24565


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      April 2018




We thank Isaiah Andrews, Matias Cattaneo, Raj Chetty, Jeff Clemens, Amy Finkelstein, Josh Gottlieb,
Pat Kline, David Neumark, Matt Notowidigdo, Emily Oster, Jonathan Roth, Bryce Steinberg, and
seminar participants at Brown University, Hebrew University, the NBER Summer Institute, Stanford
University, and Tel Aviv University for helpful comments. We thank Justine Hastings for sharing
regression output. We acknowledge financial support from the National Science Foundation under
Grant No. 1558636 and Grant No. 1658037 and from the Brown University Population Studies and
Training Center. The views expressed herein are those of the authors and do not necessarily reflect
the views of the Federal Reserve Bank of Philadelphia, the Federal Reserve System, or the National
Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this research.
Further information is available online at http://www.nber.org/papers/w24565.ack

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2018 by Simon Freyaldenhoven, Christian Hansen, and Jesse M. Shapiro. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Pre-event Trends in the Panel Event-study Design
Simon Freyaldenhoven, Christian Hansen, and Jesse M. Shapiro
NBER Working Paper No. 24565
April 2018, Revised May 2019
JEL No. C23,C26

                                            ABSTRACT

We consider a linear panel event-study design in which unobserved confounds may be related both
to the outcome and to the policy variable of interest. We provide sufficient conditions to identify the
causal effect of the policy by exploiting covariates related to the policy only through the confounds.
Our model implies a set of moment equations that are linear in parameters. The effect of the policy
can be estimated by 2SLS, and causal inference is valid even when endogeneity leads to pre-event
trends ("pre-trends") in the outcome. Alternative approaches perform poorly in our simulations.


Simon Freyaldenhoven                               Jesse M. Shapiro
Research Department                                Economics Department
 Federal Reserve Bank of Philadelphia              Box B
10 Independence Mall                               Brown University
Philadelphia, PA 19123                             Providence, RI 02912
Simon.Freyaldenhoven@phil.frb.org                  and NBER
                                                   jesse_shapiro_1@brown.edu
Christian Hansen
University of Chicago Booth School of Business
5807 South Woodlawn Avenue
Chicago, IL 60637
chansen1@chicagobooth.edu




A online appendix is available at http://www.nber.org/data-appendix/w24565
1       Introduction
We are interested in estimating the causal effect β of a policy variable zit on an outcome yit in
a linear panel data model, where i indexes units and t indexes time. We are concerned that the
strict exogeneity of zit may fail due to the presence of a time-varying unobservable ηit that is
correlated with both zit and yit . In the literature on the effects of the minimum wage, yit is youth
employment, i indexes states, t indexes calendar years, and zit is an indicator for years after passage
of a minimum-wage increase. The unobserved confound ηit is labor demand. The concern is that
states tend to pass minimum-wage increases during good economic times (Card and Krueger 1995;
Neumark and Wascher 2007).
    A common diagnostic approach in such settings is to look at whether the policy change appears
to have an effect on the outcome before it actually occurs.1 The presence of such pre-event trends,
or “pre-trends,” is taken as evidence against the strict exogeneity of the policy change.
    To us, this approach seems incomplete. If pre-trends are not detected, it may be either that there
are no pre-trends or that pre-trends are present but undetected due to limited statistical power. In
the latter case, estimation under the assumption of strict exogeneity is typically inappropriate. If
pre-trends are detected, it is understood that strict exogeneity is likely to fail, but it is not clear
what to do.
    In both cases, what is needed is a notion of magnitude: given some pre-trend in the outcome,
how much of the apparent effect of the policy is due to confounds, and how much to the causal
effect of the policy? Armed with such a notion, a researcher can conduct valid inference on β
whether or not pre-trends are detected.
    In this paper, we propose to obtain such a notion from the behavior of a covariate xit that is
affected by the confound ηit but not by the policy zit . In the minimum wage context, adult em-
ployment xit responds to labor demand ηit but plausibly not to the minimum wage (Brown 1999).
Instead of using adult employment as a control variable, as is commonly done in the literature,2
we propose to look at its dynamics around minimum wage increases and use these to infer the
dynamics of ηit .
    To fix ideas, suppose we observe the outcome yit in periods t = 1, ..., T and the policy zit in
    1
      Of the 16 papers in the 2016 American Economic Review that use a linear panel data model, 11 are concerned with
the existence of pre-trends as a sign of endogeneity. Of these 11, 9 include a plot of pre-trends, of which 2 provide
a formal test of whether pre-trends are zero. In the minimum wage context, Allegretto et al. (2011) provide a plot of
pre-trends.
    2
      Brown (1999, table 3) describes 13 sets of models of the effect of the minimum wage on teenage or young adult
unemployment that have been estimated using state-level panel data. In 9 of these, there is a control for the prime-age
male unemployment rate. All of the rest include a control for the contemporaneous or past employment-to-population
ratio, either for all workers or for males only.




                                                          1
periods t = 1 − L, ..., T + L for some L ≥ 1 for units i = 1, ..., N . Say that

                                   yit = βzit + γηit + εit                                        (1)
                                    E(εit |ηit , {zit }Tt=1−L
                                                         +L
                                                              )=0                                 (2)
                                    E(xit |ηit , {zit }Tt=1−L
                                                          +L
                                                              ) = ληit ,                          (3)

where (1) defines the causal model, (2) assumes strict exogeneity of the policy with respect to the
unobserved error εit , and (3) defines the relationship of the covariate xit to the confound ηit up to
the nonzero parameter λ. If the parameter γ is known to equal zero, then the confound does not
affect the outcome, and identification of β is immediate.
                                                                         L
      Figure 1a plots coefficients from a regression of yit on ∆zi,t+l l=−L in data simulated from an
example of (1). Here and throughout, ∆ denotes the first difference operator. Because the figure
resembles event-study plots in finance (Ball and Brown 1968; MacKinlay 1997), the estimates
depicted are sometimes called “event-study estimates” (Hoynes and Schanzenbach 2009; Duggan
et al. 2016).
      Figure 1a shows a clear pre-trend in the outcome, indicating that γ 6= 0. Figure 1b shows
that the covariate xit exhibits a pre-trend similar to that of the outcome, and a relatively smaller
increase at the event time. We would like to use the covariate xit to correct for the role of the
confound ηit . Including the covariate xit as a control variable will suffice only if xit is a perfect
proxy for ηit (i.e., xit = ληit ). Subtracting the covariate from the outcome (yielding dependent
variable yit − xit ) will suffice only if the effects of the confound are exactly parallel between the
outcome and the covariate (i.e., γ = λ). Extrapolating a trend in the outcome will be suitable only
if the post-event behavior of the confound ηit can be inferred from its pre-event trend.
      The alternative that we propose can be understood with reference to Figure 1c. Here, we
rescale the series in Figure 1b so that it exactly matches that in Figure 1a in the two periods
immediately before the event. Under our maintained assumptions, comparing the two series in
Figure 1c allows us to decompose the change in the outcome at the event time into a component
due to the causal effect of the policy and a component due to the confound ηit . The adjusted plot
in Figure 1d removes the estimated effect of the pre-trend from Figure 1a, revealing the dynamics
of the outcome net of the confound, and hence β, the causal effect of interest.
      The geometry of these plots suggests an instrumental variables setup, in which Figure 1a plots
the reduced form for the outcome and Figure 1b plots the first stage. Indeed, we show that β can
be estimated by two-stage least squares (2SLS) regression of the outcome yit on the policy zit and
covariate xit , with leads (e.g., zi,t+1 ) of the policy serving as excluded instruments. An essential
assumption is that the dynamic relationship of xit to zit mirrors the dynamic relationship of ηit to
zit . This means, in particular, that xit is affected by ηit but not by zit .


                                                    2
 4




                                                                       20
 2




                                                                       0
 0




                                                                       −20
 −2




                                                                       −40
      −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+              −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+



 (a) Outcome of interest yit around event time                        (b) Unaffected covariate xit around event time
 4




                                                                       4
 2




                                                                       2
 0




                                                                       0
 −2




                                                                       −2




      −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+              −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+



(c) Overlaying outcome of interest yit (with con-                     (d) Outcome of interest yit around event time,
fidence intervals) and rescaled unaffected covari-                    using the behavior of the covariate to net out the
ate xit (triangles) around event time                                 effect of the confound

Figure 1: Hypothetical event plots. An unobserved factor potentially causes endogeneity, mani-
fested as a pre-trend in the outcome yit . A covariate xit affected by the confound, but not by the
policy, permits us to learn the dynamics of the confound and adjust for them. Depicted are regres-
sion coefficients on indicators for time relative to policy change. Solid lines depict the true causal
effect.


    We also require that there be a pre-trend in the covariate xit . We argue that a pre-trend in ηit
is natural in the many economic settings in which the policy zit changes when some unobserved
state variable ηit crosses a threshold. Indeed, the common approach of using pre-trends to diagnose
failures of exogeneity is presumably motivated, in part, by the belief that the confound ηit is likely
to exhibit a pre-trend. Our assumptions imply that a pre-trend in ηit manifests as a pre-trend in the
covariate xit , and may or may not manifest as a pre-trend in the outcome yit .
    Section 2 generalizes the setup in (1)-(3) to allow for multiple confounds, additive unit-specific
fixed effects, and exogenous controls. We show that the model admits a GMM representation, from
which standard results on estimation and inference (with large N and fixed T ) are available.


                                                                  3
    Section 3 presents Monte Carlo evidence on the finite-sample performance of our proposed
estimator under a range of alternative data-generating processes, varying both the quality of the
proxy xit and the strength of identification. We find that, when strongly identified, our estimator
outperforms the approach of controlling directly for xit , except when xit is a nearly perfect proxy
for ηit . We further find that our estimator outperforms the approach of extrapolating a linear trend
from the pre-event period and the approach of conducting a test for pre-trends before proceeding
with estimation.
    The main requirement that our approach imposes on a practitioner is to find a covariate xit
that is related to the confound ηit but unaffected by the policy zit . This is similar in difficulty to
finding a suitable control variable, but without the additional burden of ensuring that xit proxies
perfectly for ηit . (Of course, as our simulations reinforce, xit must still provide a reasonable
signal of ηit in order to permit strong identification.) The choice of covariate should be guided by
economic reasoning about the nature of the confound. In most applications we expect the number
of plausible candidate covariates to be small, and we expect that our approach will work best when
a small number of economic factors capture the important sources of endogeneity.
    Section 4 presents applications of our proposed approach to the effect of SNAP on household
spending (Hastings and Shapiro 2018), the effect of newspaper entry on voter turnout (Gentzkow
et al. 2011), and the effect of the minimum wage on youth employment (Neumark et al. 2014;
Allegretto et al. 2017). These applications illustrate a range of possibilities, including situations
with clear pre-trends in the outcome, a situation without meaningful pre-trends, and a situation in
which it is hard to tell. In some cases our proposed adjustment makes a small difference to point
estimates, in some cases a larger difference, and in some cases it simply implies greater statistical
uncertainty.
    Section 5 extends our model to cover the case of estimating a dynamic treatment effect and
discusses issues of model testing and instrument selection when the model is overidentified.
    We are not aware of an existing formal proposal to use an unaffected covariate to adjust causal
inference for pre-trends in a panel data model. In their appendix, Gentzkow et al. (2011) implement
an estimator that is similar in spirit to the one that we propose, but that is not formally justified
by our setup.3 Borusyak and Jaravel (2017) study the identification and estimation of pre-trends
in a dynamic panel data model. Roth (2018) studies the bias introduced by pre-testing for pre-
trends and shows how to correct for it.4 Neither paper considers the use of covariates to address
   3
      Specification (6) of Table B1 in Gentzkow et al. (2011) uses a dynamic first stage analogous to Figure 1b and a
static second stage analogous to (1). Gentzkow et al. (2011, footnote 5) justify this estimator informally.
    4
      See also Kahn-Lang and Lang (2018). More broadly, our recommendation to account for endogeneity in esti-
mation, rather than pre-testing for it, is in line with the large statistics and econometrics literature regarding the use
of pre-tests for model/specification choice. Guggenberger (2010), in particular, makes a very similar argument in the
context of choosing between OLS or IV estimation.



                                                            4
endogeneity, as we do here.
     Our framework is closely related to classical work on models with measurement error and on
panel data models with strict exogeneity.5 Replacement of ηit with xit produces a factor model or
measurement error model (Aigner et al. 1984). A large literature, partially reviewed in Abbring
and Heckman (2007), Heckman and Vytlacil (2007), and Matzkin (2007), shows how to establish
identification in such models, typically by imposing covariance restrictions across equations gov-
erning multiple imperfect measurements of the latent factor. Instead, we impose strict exogeneity
of the policy variable zit with respect to the measurement error in xit to achieve identification using
only a single covariate.
     There are other ways to address policy endogeneity in linear panel data models like (1). One
is to find an instrument for policy changes (Besley and Case 2000). This is an appealing approach
when feasible, but such instruments are not readily available in many settings. Our approach
replaces the requirement of an instrument that impacts the policy but not the outcome with the
requirement of a covariate that is related to the confound but unaffected by the policy. Another
approach is to impose dynamic restrictions on the relationship between xit and ηit . In a panel data
setting with mismeasured regressors, Griliches and Hausman (1986) propose to use lags of xit to
construct valid instruments for xit . This approach requires either that the measurement errors are
serially uncorrelated or that the correlation structure of the measurement error is known (Wansbeek
2001; Xiao et al. 2010). Our approach allows for arbitrary correlation in the measurement errors,
but requires that the policy be strictly exogenous with respect to these errors. Yet another approach
is to try to recover the time-series properties of ηit . Ashenfelter and Card (1985) estimate a model
of the outcome yit on data from a set of units unaffected by the policy, and use the estimated model
to construct a counterfactual for the units affected by the policy under maintained assumptions
about the determinants of the timing of policy change (see also Heckman and Robb 1985).
     Another alternative approach to estimating policy effects in event-study settings are synthetic
control methods (Abadie et al. 2010). These methods have been designed for settings with a small
number of treated units, whereas our asymptotics are based on a large number of treated units.
This makes direct formal comparison difficult. Intuitively, as synthetic control methods rely on
using pre-event observable data to construct a counterfactual trend in the absence of the policy,
conditions for valid inference tend to involve a form of exogeneity of treatment conditional on the
observables used to construct the counterfactual (e.g. Chernozhukov et al. 2017; Ferman and Pinto
2017; Li 2017). Our approach instead allows for a latent trend that cannot be directly captured with
observables, at the cost of additional economic structure.
   5
     See also Altonji et al. (2005) and Oster (2016), who propose an alternative way to use observed covariates to allow
for unobservable confounds.




                                                           5
2       Setup and Proposed Estimator

2.1     Model
We consider a static linear panel data model:

                                      yit = βzit + qit0 θ + ηit0 γ + αi + εit                                     (4)
                                      xit = qit0 ψ + Ληit + νi + uit ,                                            (5)

where yit and zit are observed scalars; qit is an observed Q × 1 vector; xit is an observed K × 1
vector; the R × 1 vector ηit , the K × 1 vector uit , and scalar εit are time-varying unobservables;
αi is a time-invariant unobserved scalar; νi is a time-invariant unobserved K × 1 vector; and the
remaining objects are conformably defined parameters. We require that K ≥ R and suppose for
simplicity that K = R. We observe data {yit , qit , xit }N,T                     N,T +`
                                                               i=1,t=1 and {zit }i=1,t=1−m for m ≥ 0 and
` ≥ R. We do not require that zit is binary. The parameter of interest is β.
    Vector qit collects all observed exogenous variables (e.g., time period indicators) in the sense
that we impose E[εit |{qit }Tt=1 ] = E[uit |{qit }Tt=1 ] = 0 for all i and t. Vector qit is low-dimensional
in the sense that Q  N . We do not impose any restrictions on the αi and νi and thus treat them
as fixed effects.
    We take two steps to simplify the presentation of the results. First, we set θ = ψ = 0. State-
ments carry over to the more general case by interpreting all data matrices as residuals from the
projection of the remaining variables onto the exogenous variables. Second, we remove the fixed
effects. Let k̃it = kit − T1 Ts=1 kis denote the within transformation for any variable kit .6 Then,
                             P

we can simplify (4) and (5) to obtain

                                             ỹit = β z̃it + η̃it0 γ + ε̃it                                       (6)
                                             x̃it = Λη̃it + ũit .                                                (7)

Remark 1. The model in (6) is static in the sense that it features neither anticipatory effects nor
dynamic treatment effects. We pursue these as an extension in Section 5.1.
Remark 2. We assume throughout that the causal effect β of the policy on the outcome is ho-
mogeneous across units i. A recent literature explores properties (and failures) of the two-way
fixed effects estimator under heterogeneous causal effects (Abraham and Sun 2018; Athey and Im-
bens 2018; de Chaisemartin and D’Haultfoeuille 2018; Goodman-Bacon 2018). We expect similar
                                                                                                         PT
    6
     We also use this convention for leads and lags of a variable, so, for example, k̃i,t−m = ki,t−m − T1 s=1 ki,s−m .
Although we simplify our model in terms of within-transformed variables, our analysis would apply to first-differenced
variables, with corresponding changes in the interpretation of the assumptions.


                                                           6
issues to arise in our setting.


2.2    Identifying Assumptions
We now state two assumptions that suffice to identify β.
Assumption 1 (Orthogonality conditions). There exists a set of non-negative integers L = {0, 1, . . . , L}
such that
                   
  (a) E z̃i,t+l ε̃it = 0 ∀ l ∈ L.
                   
  (b) E z̃i,t+l ũit = 0 ∀ l ∈ L.
Assumption 2 (Rank conditions). Let wit = (z̃it , z̃i,t+1 , · · · , z̃i,t+L )0 and define a matrix H as
H = E(wit [z̃it , x̃0it ]). Then:
  (a) rank(Λ) = R.

  (b) rank(H) = (R + 1).
     Assumptions 1 and 2 are analogous, respectively, to the exclusion and relevance conditions in
a linear instrumental variables setup. Strict exogeneity of zit in (4), as is commonly assumed in
panel event studies, implies Assumption 1(a), which allows z̃it and its leads to be correlated with
ỹit only through η̃it or through the causal effect of the policy. Strict exogeneity of zit in the first-
stage relationship (5) implies Assumption 1(b), which allows z̃it and its leads to be correlated with
x̃it only through η̃it . Strict exogeneity thus rules out a causal effect of the policy zit on the covariate
xit and any correlation between the policy zit and the measurement error uit . We do not require
the orthogonality of ε̃it and ũit , and thus the covariates xit may be correlated with the outcome yit
through channels other than the confound ηit .
     Assumption 2(a) imposes that the covariates xit contain information about all of the latent fac-
tors ηit . Assumption 2(b) is the equivalent of the usual instrumental variables relevance assumption
and can in principle be checked in the data. It requires a nonzero correlation between the noisy
proxy xit and leads of zit , i.e., a pre-trend in xit . On the other hand, because we allow for γ = 0,
our assumptions do not imply a pre-trend in yit .
Remark 3. If rank(E(wit [z̃it , η̃it0 ])) = (R + 1), then Assumption 2(b) follows from Assumption 1,
Assumption 2(a), and (7). That is, a pre-trend in the confound implies a pre-trend in the covariate.
Remark 4. Suppose that zit = 1 {∃t∗ ≤ t : ηit∗ > η ∗ } : the policy zit changes when ηit crosses
                                                             

some threshold η ∗ . Then, Assumption 2(b) will hold for a wide range of processes. Intuitively,
if ηit is autocorrelated, a threshold crossing at time t + 1 provides a signal that the latent ηit was
already large (close to the threshold) in the previous period. Economic settings covered by this
case include:

                                                     7
   • Means-tested program. We are interested in the effect of a household’s participation zit
     in a means-tested program on some outcome yit as in Hastings and Shapiro (2018). Each
     household i becomes eligible for the program when the gap ηit between the household’s
     income and a poverty line exceeds a threshold η ∗ . This setting is closely related to that
     in Ashenfelter (1978), who found that an individual’s earnings tend to decline prior to the
     individual’s entry into a job training program.

   • Firm entry. We are interested in the effect of firm entry into a market on some outcome
     yit as in Gentzkow et al. (2011). At any given time t, a single potential entrant can pay
     a one-time cost to enter market i and earn a stream of cash flows whose expected present
     discounted value is ηit . Under appropriate assumptions on ηit (for example, that it evolves
     as a random walk with i.i.d. innovations), the firm enters the first time that ηit exceeds a
     threshold η ∗ (McDonald and Siegel 1986; Dixit and Pindyck 1994). The policy zit is an
     indicator for the presence of a firm in the market.

   • State law change. We are interested in the effect of the passage of a law on some outcome
     yit . A given state i passes the law when the underlying strength ηit of its economy exceeds
     some threshold η ∗ . The policy zit is an indicator for periods following passage of the law.

Remark 5. It is also useful to consider examples of economic settings in which Assumption 2 will
fail. These include:

   • Randomized controlled trial. Suppose that the policy zit is randomly assigned and there-
     fore statistically independent of all unobservables. Then there is no pre-trend in the con-
     found, and we would expect Assumption 2(b) to fail.

   • Poor covariate. Suppose that the covariate xit is unrelated to the confound ηit . Then Λ = 0
     and Assumption 2(a) fails. A related issue is that if Λ is nearly rank-deficient, then the model
     is only weakly identified. We illustrate these issues in simulations in Section 3.

Remark 6. In order to keep notation and statements simple, we treat zit as univariate. It is straight-
forward to allow the dimension of zit to be greater than one. We allow for R > 1 throughout.
We note, however, that the rank condition in Assumption 2(b) is likely to become increasingly de-
manding as R grows, and in our simulations and applications we consider only cases with R = 1.
A model with R = 1 may be thought of as an approximation to a model with R > 1 in which
the different suspected confounds have similar dynamics around the event time. In this sense, we
think our proposed approach will be most useful in settings in which the confound can be well
approximated by a small number of economic factors.



                                                  8
2.3     GMM Representation and 2SLS Estimator
To move towards a GMM representation, use Assumption 2(a) to define the R × 1 matrix Γ̃ =
Λ(Λ0 Λ)−1 γ. Now define

                                               ṽit ≡ ε̃it − ũ0it Γ̃                                                     (8)
                                                    = ỹit − β z̃it − x̃0it Γ̃,                                           (9)

where (9) follows from (6) and (7) given the definition of Γ̃. Now from Assumption 1:

                                                     E [wit ṽit ] = 0.                                                 (10)

Assumption 2(b) guarantees that the moment conditions in (10) are sufficient to identify β (and,
incidentally, Γ̃).
    Estimation may proceed by GMM using the sample analogues of (10) as moment conditions.
For the case where T is fixed and N grows large, estimation and inference results are available
under standard regularity conditions (Newey and McFadden 1994).
    One convenient estimator justified by (10) is a 2SLS regression of ỹit on z̃it and x̃it , treating
the covariates x̃it as mismeasured regressors and the leads of z̃it as the excluded instruments.7 We
will use this 2SLS estimator in our simulations and applications.
Remark 7. In principle, any functions of the leads of the event, z̃i,t+l , l ∈ L, are valid instruments.
In practice, we expect that T will often be moderately sized, and that the closest leads will be most
informative. As a default, we therefore suggest choosing the R closest leads of z̃it as instruments,
which results in an exactly identified model. This is in line with the way we implement our estima-
tor in both our simulations and applications. We discuss issues of overidentification and instrument
selection in Section 5.2.
Remark 8. Suppose that we observe ỹit and z̃it in one sample and x̃it and z̃it in another. Then we
may proceed with two-sample instrumental variables estimation (Angrist and Krueger 1992; Inoue
and Solon 2010) using the leads of z̃it as instruments for x̃it .
Remark 9. If, in a given economic setting, we are concerned about failures of the exclusion re-
strictions in Assumption 1, we may apply existing approaches to adjust inference for plausible
violations of moment conditions (e.g., Conley et al. 2012; Andrews et al. 2017). Because As-
sumption 1(a) follows from the common assumption of strict exogeneity, we expect that in most
cases Assumption 1(b) will be the more controversial component of Assumption 1. In Section 4,
   7
      For example, in the case where R = K = L = 1, this approach is equivalent to estimating a linear instrumental
variables model with structural equation ỹit = β z̃it + Γ̃x̃it + ṽit and corresponding first stage equation x̃it = π0 z̃it +
               x                                      x
π1 z̃i,t+1 + ς˜it , where π0 and π1 are parameters, ς˜it is the first-stage error, and Γ̃ and ṽit are defined as above.


                                                              9
we discuss the economic content of Assumption 1(b) in the context of our applications.


3       Simulations
This section presents results from Monte Carlo simulations. These allow us to compare the perfor-
mance of alternative estimators and to assess the adequacy of standard asymptotic approximations
of the finite-sample distributions of our estimator.


3.1     Data-generating Processes and Estimators
Definition 1 (Data-generating processes). Throughout this section, we consider the following data-
generating processes (DGPs):

    • ηit = ρηi,t−1 + ζit , where ζit ∼ N (0, σζ2 ) are i.i.d. across i and t.

    • zit = 1({∃t∗ ≤ t : ηit∗ > η ∗ }), where η ∗ is chosen so that the average number of events is
      approximately constant across different values of the simulation parameters.8

    • K = 1 and
                                                    xit = ληit + uit ,                                          (11)

        where uit ∼ N (0, σu2 ) are i.i.d. across i and t.

    • The outcome is generated by:

                                       yit = βzit + 0.25ηit + 0.2t + αi + εit ,                                 (12)

        where β = 1, αi ∼ N (0, 1) are i.i.d. across i, εit ∼ N (0, 1) are i.i.d. across i and t, and αi
        and εit are independent for all i and t.

    All of the simulations are based on the DGPs specified in Definition 1. Section 3.2 presents
benchmark results for a design with λ = ρ = 1, σζ2 = 1 and σu2 = 4. We initialize ηit with
ηi1 = 0 and generate 20 time-series observations for each i. We then use the 10 time periods
t ∈ {6, 7, . . . , 15} as the sample for estimation.
    Section 3.3 presents more extensive results for a variety of designs with ρ ∈ [0, 1). For these,
we choose σζ2 and σu2 such that Var(η̃it ) = 1 and Var(x̃it ) = 2. To simulate these designs, we gener-
ate 20 time-series observations for each of 1000 cross-sectional units i. We initialize ηi,−19 as i.i.d.
    8
     Specifically, η ∗ = 1(ρ ≤ 0.8)(1.96 + 0.2ρ) + 1(ρ = 0.9)1.85 + 1(ρ = 1)4. Online Appendix Figure 1 shows
how the performance of our estimator changes in a specification where zit is determined by ηit and an additional noise
variable that allows us to vary the importance of ηit in determining zit .


                                                         10
draws from a standard normal distribution and use the initial 20 observations t = −19, −18, . . . , 0
as burn-in. We then keep an estimation sample of 10 time-series observations consisting of the
periods t = 6, 7, . . . , 15, retaining the full history of zit so that we can construct leads and lags.
Applying this procedure leaves us with T = 10 time-series observations on N = 1000 units, of
which approximately 200 experience an event.9 As Online Appendix Figure 3 illustrates, these
designs feature a mean-reverting confound as in, for example, Ashenfelter (1978).
    To vary the strength of identification, we will consider different values of ρ in [0, 0.9]. As ρ
increases, our instruments, the leads of zit , will become stronger, resulting in better identification.
On the other hand, as the autocorrelation in ηit approaches zero, we lose identification. Within
this design, stronger persistence in ηit will tend to exacerbate the bias that arises from failing to
account for ηit .
    To vary the quality of xit as a proxy for ηit , we vary λ to control the population R2 from the
infeasible regression of xit on ηit in (11). When this R2 equals one, xit is a perfect proxy, and the
best possible control for ηit is xit . As this R2 approaches zero, the proxy xit provides no signal
about the latent variable ηit , and identification fails.
    We consider five different feasible estimators for the policy effect β and its dynamic counter-
parts, and include individual and time fixed effects in all specifications. The first estimator we
consider ignores ηit entirely and simply regresses the outcome yit on the event indicator zit (“Fail-
ing to control for ηit ”). The second estimator uses xit as a proxy for ηit and corresponds to the
regression of the outcome yit on the event indicator zit and the covariate xit (“Using xit as proxy
for ηit ”). The third estimator is from our proposed 2SLS regression of the outcome yit on the
event indicator zit and the covariate xit , using zi,t+1 as an excluded instrument for xit (“2SLS -
one lead”). Online Appendix Figure 4 presents corresponding results using the BIC to choose the
number of first-stage leads. The fourth estimator attempts to account for the confound by extrap-
olating a linear trend from the three periods immediately preceding the event (“Extrapolating a
linear trend”).10
    The last estimator that we consider formalizes the idea of testing for pre-trends that is common
in applied work (“Pre-testing for pre-trend”). To implement this estimator, we first compute the
typical event-study estimates, normalized so that the coefficient on zi,t+1 is equal to zero. We then
perform a conventional test that the coefficient on zi,t+2 is equal to 0 at the 5% level. If we fail
to reject the hypothesis, we conclude that there is no pre-trend and proceed with the analysis as
   9
      Online Appendix Figure 2 shows the mean number of cross-sectional observations in which an event occurs across
the design space considered in the stationary case. Within each set of simulation parameters, at least 99.4 percent of
draws have between 160 and 240 units with an event. We include in our analysis all cross-sectional units, including
those in which an event does not occur (Borusyak and Jaravel 2017).
   10
      See Dobkin et al. (2018) for a recent article using this approach and Hausman and Rapson (2018) for a discus-
sion of related estimators. Online Appendix Figure 5 reports findings from an estimator that includes unit-specific
deterministic linear trends as a control (Jacobson et al. 1993).


                                                         11
in “No control.”11 If we reject the null, we conclude that there is a pre-trend and “give up.” We
formalize the notion of “giving up” by returning a confidence interval of (−∞, ∞) and no point
estimate. When evaluating point estimates for this procedure, we consider only those cases where
we do not give up. Online Appendix Figure 6 summarizes the rejection frequency of the pre-test.


3.2     Results for a Benchmark Data-generating Process
Figure 2 presents event-study estimates for a single realization from the DGP with ρ = 1. Specif-
ically, each panel of Figure 2 depicts estimates of the coefficients δk from a different method of
estimating the parameters of the following model:

                                                              5
                                                              X
              yit = δ−6+ (1 − zi,t+5 ) + δ5+ zi,t−5 +               δ−k ∆zi,t+k + ωt + αi + ηit + εit ,                (13)
                                                             k=−4


where ωt are time effects, (1 − zi,t+5 ) indicates that the event is more than five time periods in
the future, and zi,t−6 indicates the event took place more than five periods in the past. We use the
normalization that δ−1 = 0.
     Figure 2 shows both pointwise 95% confidence intervals and uniform 95% sup-t confidence
bands (Olea and Plagborg-Møller 2019). Applied papers commonly include pointwise confidence
intervals in event plots.12 These permit testing only of preselected pointwise hypotheses. Uniform
bands such as those we show here are designed to contain the true path of the coefficients 95%
of the time, and are therefore arguably more useful for giving readers a sense of what kinds of
pre-trends are consistent with the data.
     Figure 2a reports results from estimating (13) including ηit as an additional regressor. Because
ηit is unobserved, this approach is infeasible, but it provides a useful benchmark of best-case per-
formance. Point estimates of pre-event trends are reasonably small and well-estimated. Estimates
of the policy effects (δk for k > 0) are reasonably close to one, the true value.
     Figure 2b reports estimates without any control for ηit and shows both strong pre-trends and
substantial bias in the estimated effects of the policy. Figure 2c reports estimates based on including
the observable xit in place of the latent variable ηit . As xit is a noisy measure of ηit , controlling
for xit only partially mitigates the pre-trends and the bias in the estimated policy effects relative to
  11
      We designed this implementation of the pre-test procedure to match practice in empirical research based on our
survey of the 2016 American Economic Review. For example, Bustos et al. (2016) estimate the effect of their policy
variable one period in advance (Equation 13, Table A6) and report that, depending on the outcome variable, pre-trends
are either not statistically different from zero or are opposite to the causal effect they estimate (section V.B). Pierce and
Schott (2016) (Equation 3, Figure 4, and p. 1644) report that the estimated effect of their policy variable is statistically
indistinguishable from zero in all periods prior to the policy change.
   12
      Of the 9 articles in the 2016 AER that include an event plot, 7 include confidence intervals on the plot, of which
all 7 are pointwise.


                                                            12
 2




                                                                         2
 1




                                                                         1
 0




                                                                         0
 −1




                                                                         −1
       −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+              −6+   −5    −4   −3   −2   −1   event   1   2   3   4   5+



      (a) Controlling directly for ηit (infeasible)                                      (b) Failing to control for ηit
 2




                                                                         2
 1




                                                                         1
 0




                                                                         0
 −1




                                                                         −1




       −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+              −6+   −5    −4   −3   −2   −1   event   1   2   3   4   5+



              (c) Using xit as proxy for ηit                            (d) Proposed 2SLS estimator, with closest lead
                                                                        of zit as excluded instrument
 2




                                                                         2
 1




                                                                         1
 0




                                                                         0
 −1




                                                                         −1




       −6+   −5   −4   −3   −2   −1   event   1   2   3   4   5+              −6+   −5    −4   −3   −2   −1   event   1   2   3   4   5+



             (e) Extrapolating a linear trend                                            (f) Pre-testing for pre-trend

Figure 2: Exemplary event plots in the presence of a confounding factor using simulated data.
All plots are based a single draw from the benchmark DGP defined in Section 3.1 with a true
causal effect of β = 1, represented by the solid line. Each plot shows estimates of the coefficients
δk from (13) using either the infeasible estimator or one of the five feasible estimators defined
in Section 3.1. Inner confidence sets as indicated by the dashes correspond to 95% pointwise
confidence intervals, while outer confidence sets are the uniform 95% sup-t bands (with critical
values obtained via simulation). Standard errors are clustered at the individual level.


                                                                   13
Figure 2b.
    Figure 2d shows the event plot using our proposed 2SLS estimator to account for the un-
observed factor ηit . Specifically, we proxy for ηit with xit and instrument for xit with zi,t+1 .13
As expected, the proposed estimator delivers sensible estimates of pre-trends and policy effects,
though there is a loss of precision relative to the infeasible benchmark in Figure 2a. As we discuss
in Section 5.2, inspection of pre-trends in this corrected plot may be thought of as a visual test of
overidentification in a model with multiple exogenous leads.
    Figure 2e extrapolates a linear trend from the three periods immediately preceding the event.14
Let pit = (t + 1) − min{t0 : zit0 = 1} be the “event time” of period t for unit i, normalized to be
zero in the period before the policy change. Then we estimate

            yit = δ−6+ (1 − zi,t+5 )+δ5+ zi,t−5 + Ωpit 1(−4 ≤ pit ≤ 5)
                                             5
                                             X                     0
                                                                   X
                                         +         δ−k ∆zi,t+k +          δ−k ∆zi,t+k + ωt + αi + εit .         (14)
                                             k=4                   k=−4


The coefficient Ω is the slope of the trend, and each δk represents the deviation of yit relative to
the trend when −4 ≤ pit ≤ 5. Figure 2e depicts the corresponding δk . In this realization, the
trend understates the role of the confound in the immediate post-event period, and overstates it in
subsequent periods.
    Figure 2f reports estimates after pre-testing.15 As no pre-trend is detected in this particular
realization, this plot is identical to Figure 2b.
    Figure 3 shows the median and uniform confidence band for the estimates in Figure 2 across
repeated simulations from the same benchmark DGP. Figure 3 reinforces the conclusion from
Figure 2 that, among the feasible estimators, only the 2SLS estimator is centered at the true value.
In Online Appendix Table 1, we show the median bias, median absolute deviation, and coverage
of the 95% confidence intervals for an estimate of the causal parameter β from a static analogue of
the dynamic specifications depicted in Figure 3. The proposed 2SLS estimator exhibits the lowest
median bias and median absolute deviation among the feasible estimators.
  13
     Using zi,t+1 as an instrument means that we need to normalize δk for an additional k. In Figure 2d, we set
δ−2 = 0. The 2SLS specification appears noisy in the plot because there is only a modest pre-trend in xit in this
specification. Since instrument strength varies across normalizations, the precision of our estimator will also vary
across normalizations. Online Appendix Figure 7 depicts how our proposed 2SLS estimator depends on the choice of
normalization. We discuss instrument choice in Section 5.2.
  14
     Online Appendix Figure 8 shows results from extrapolating from the two, three, four, or five periods immediately
preceding the event.
  15
     Online Appendix Figure 9 shows results from pre-testing based on the hypothesis that δk is equal to zero for
multiple periods preceding the event, and from pre-testing based on the hypothesis that the slope coefficient Ω on
event time in (14) is equal to zero.




                                                         14
  2                                                                         2




  1                                                                         1




  0                                                                         0




  -1                                                                        -1




       -6+   -5     -4   -3   -2   -1   event   1   2   3   4   5+               -6+   -5    -4   -3   -2   -1   event   1   2   3   4   5+


   (a) Controlling directly for ηit (infeasible)                                            (b) Failing to control for ηit
  2                                                                         2




  1                                                                         1




  0                                                                         0




  -1                                                                        -1




       -6+   -5     -4   -3   -2   -1   event   1   2   3   4   5+               -6+   -5    -4   -3   -2   -1   event   1   2   3   4   5+


                  (c) Using xit as proxy for ηit                          (d) Proposed 2SLS estimator, with closest lead
                                                                          of zit as excluded instrument
  2                                                                         2




  1                                                                         1




  0                                                                         0




  -1                                                                        -1




       -6+   -5     -4   -3   -2   -1   event   1   2   3   4   5+               -6+   -5    -4   -3   -2   -1   event   1   2   3   4   5+


                  (e) Extrapolating a linear trend                                          (f) Pre-testing for pre-trend

Figure 3: Distribution of event plots under the presence of a confounding factor using simulated
data. All plots are based on 5,000 simulations of the benchmark DGP defined in Section 3.1 with
a true causal effect of β = 1, represented by the solid line. Each plot shows estimates of the
coefficients δk from (13) using either the infeasible estimator or one of the five feasible estimators
defined in Section 3.1. The dots in the center represent the median estimate across all realizations,
while the shaded areas depict the uniform 95% confidence band: 95% of the estimated sets of
coefficients lie within this band. In the plot labeled “Pre-testing for pre-trend,” we depict estimates
that fail to control for ηit from the 2930 realizations in which we do not detect a pre-trend.


                                                                     15
3.3    Results for a Set of Data-generating Processes
We turn next to an exploration of the full space covered by the stationary variant of the DGPs. We
consider estimates β̂ from

                                     yit = βzit + ωt + αi + ηit γ + εit ,                                    (15)

where ωt are time effects. We consider the one infeasible and five feasible estimators defined in
Section 3.1. Each estimator takes a different approach to addressing the confound ηit . In the case
of the linear extrapolation estimator, we use β̂ = 51 0k=−4 δ̂−k , with δk from equation (14), as an
                                                         P

estimate for the causal effect β.16
     Figure 4 depicts the absolute median bias of each estimator. As expected, the presence of
the unobserved confound severely biases the estimator that completely fails to control for ηit (4b).
Using xit directly to control for ηit also results in severe bias except when the R2 from the infeasible
regression of xit on ηit is very large, in which case xit is a nearly perfect proxy for ηit (4c).
Also in line with our expectations, the median of our proposed 2SLS estimator is close to the
true value across most of the parameter space (4d). The exceptions occur in the regions of weak
identification, where there is either little correlation between xit and ηit or little autocorrelation in
ηit . Extrapolating a linear trend from the pre-event period (4e) produces biased estimates across
the parameter space. Finally, pre-testing for pre-trends leads to little improvement relative to no
controls at all (4f). As Online Appendix Figure 6 illustrates, even when ρ = 0.9, we reject the null
of no pre-trend in less than 30% of simulations, even though they are always present in population.
     Figure 5 depicts the median absolute deviation of each estimator from the true parameter value.
The sampling distributions of estimators other than our proposed 2SLS estimator are dominated
by bias. Therefore, for these estimators, the plots in Figure 5 closely resemble those in Figure 4.
In contrast, our proposed estimator (5d) performs well except in regions of the parameter space in
which identification is weak.
     Figure 6 depicts the coverage of the 95% confidence interval for each estimator constructed
from the usual asymptotic approximation assuming the underlying sampling distribution is ap-
proximately normal and correctly centered. Failing to do anything to account for ηit results in
severe size distortions across the entire parameter space (6b). Coverage is likewise poor when xit
is used directly as a proxy for ηit , except when xit proxies ηit very well (6c). In contrast, empirical
coverage for the 2SLS estimator is close to 95% throughout the parameter space, except where
identification is weak (6d).17 Finally, both linear extrapolation and pre-testing result in uniformly
  16
    Online Appendix Figure 10 shows results when we instead use β̂ = δ̂0 as an estimate for the causal effect β.
  17
    Poor coverage in regions of weak identification could be corrected by applying appropriate weak-identification
robust procedures (Stock et al. 2002; Andrews and Mikusheva 2016).



                                                       16
0.5                                                                 0.5

0.4                                                                 0.4

0.3                                                                 0.3

0.2                                                                 0.2

0.1                                                        0        0.1                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

      (a) Controlling directly for ηit (infeasible)                             (b) Failing to control for ηit



0.5                                                                 0.5

0.4                                                                 0.4

0.3                                                                 0.3

0.2                                                                 0.2

0.1                                                        0        0.1                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

               (c) Using xit as proxy for ηit                       (d) Proposed 2SLS estimator, with closest lead
                                                                    of zit as excluded instrument



0.5                                                                 0.5

0.4                                                                 0.4

0.3                                                                 0.3

0.2                                                                 0.2

0.1                                                        0        0.1                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

               (e) Extrapolating a linear trend                                 (f) Pre-testing for pre-trend

Figure 4: Median bias for each estimator defined in Section 3.1. Each point represents the median
bias across 2,000 simulation replications from the DGPs in Definition 1 with ρ ∈ [0, 0.9]. The
horizontal axes in each panel correspond to the different values of ρ and of the population R2 from
the infeasible regression of xit onto ηit in (11).


                                                               17
0.5                                                                 0.5

0.4                                                                 0.4

0.3                                                                 0.3

0.2                                                                 0.2

0.1                                                        0        0.1                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

      (a) Controlling directly for ηit (infeasible)                             (b) Failing to control for ηit



0.5                                                                 0.5

0.4                                                                 0.4

0.3                                                                 0.3

0.2                                                                 0.2

0.1                                                        0        0.1                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

               (c) Using xit as proxy for ηit                       (d) Proposed 2SLS estimator, with closest lead
                                                                    of zit as excluded instrument



0.5                                                                 0.5

0.4                                                                 0.4

0.3                                                                 0.3

0.2                                                                 0.2

0.1                                                        0        0.1                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

               (e) Extrapolating a linear trend                                 (f) Pre-testing for pre-trend

Figure 5: Median absolute deviation from the true parameter value for each estimator defined in
Section 3.1. Each point represents the median absolute deviation across 2,000 simulation replica-
tions from the DGPs in Definition 1 with ρ ∈ [0, 0.9]. The horizontal axes in each panel correspond
to the different values of ρ and of the population R2 from the infeasible regression of xit onto ηit
in (11).


                                                               18
poor coverage in this simulation design (6e-6f).18


4        Applications
In this section, we apply our proposed estimator to empirical settings corresponding to the three
examples discussed in Remark 4. Together, these capture many of the scenarios a practitioner
might encounter:

     • No pre-trend in the outcome variable and a clear pre-trend in the covariate (Section 4.1).

     • A clear pre-trend in the outcome variable and a clear pre-trend in the covariate (Section 4.1).

     • An unclear pre-trend in the outcome variable and a clear pre-trend in the covariate (Section
       4.2).

     • An unclear pre-trend in the outcome variable and an unclear pre-trend in the covariate (Sec-
       tion 4.3).


4.1      The Effects of SNAP Participation on Household Spending Patterns
Hastings and Shapiro (2018) study the effect of participation in the Supplemental Nutrition As-
sistance Program (SNAP) on household spending in a panel event-study design. Here, i indexes
households and t indexes calendar quarters. The outcome yit is either at-home food expenditures or
the share of food spending going to store-brand items. The policy zit is an indicator for time peri-
ods following entry into the program. SNAP is means-tested, so households become eligible when
income ηit is sufficiently low. Past research shows that lower household income is associated with
lower at-home food expenditures (Castner and Mabli 2010) and greater store-brand share (Bron-
nenberg et al. 2015), so income is a potential confound. Hastings and Shapiro (2018) have access
to Rhode Island administrative data, which includes SNAP participation zit and a measure xit of
household income, and separate data from a grocery retailer, which includes SNAP participation
zit and the outcomes yit .19
    18
      The observed coverage of the pre-test estimator (Figure 6f) is a consequence of two offsetting patterns. When we
reject the null of no pre-trend, coverage is necessarily equal to 1 as we conclude we cannot use the data to learn about
β. When we fail to detect a pre-trend and proceed as if no confound is present, coverage is close to 0 as the estimator
is severely biased.
   19
      The results in this section are based on regression output obtained from the authors at http:
//www.brown.edu/Research/Shapiro/data/government.zip and http://www.brown.edu/
Research/Shapiro/data/retailer.zip on January 11, 2018. The measure xit of household income is
the monthly average of in-state earnings and UI benefits received by adults in the household.




                                                          19
 1                                                                   1

0.8                                                                 0.8

0.6                                                                 0.6

0.4                                                                 0.4

0.2                                                        0        0.2                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

      (a) Controlling directly for ηit (infeasible)                             (b) Failing to control for ηit



 1                                                                   1

0.8                                                                 0.8

0.6                                                                 0.6

0.4                                                                 0.4

0.2                                                        0        0.2                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

               (c) Using xit as proxy for ηit                       (d) Proposed 2SLS estimator, with closest lead
                                                                    of zit as excluded instrument



 1                                                                   1

0.8                                                                 0.8

0.6                                                                 0.6

0.4                                                                 0.4

0.2                                                        0        0.2                                                      0


 0                                                   0.3             0                                                 0.3
 0                                                                   0
         0.2                                   0.6                        0.2                                    0.6
                  0.4                                                            0.4
                        0.6                                                            0.6
                              0.8        0.9                                                  0.8        0.9
                                     1                                                               1

               (e) Extrapolating a linear trend                                 (f) Pre-testing for pre-trend

Figure 6: Coverage of the 95% confidence interval for each estimator defined in Section 3.1. Each
point represents the coverage of the 95% confidence interval across 2,000 simulation replications
from the DGPs defined in Definition 1 with ρ ∈ [0, 0.9]. The confidence interval is constructed
from the usual asymptotic approximation, with standard errors clustered at the individual level.
The horizontal axes in each panel correspond to the different values of ρ and of the population R2
from the infeasible regression of xit onto ηit in (11).

                                                               20
   Figure 7 reproduces from Hastings and Shapiro (2018) a plot of the time path of household
income around the adoption of SNAP. Specifically, denoting average monthly household income
during the quarter as xit , we depict estimates δ̂ from

                                                                                           4
                                                                                           X
              xit = δ−5+ (1 − zi,t+4 ) + δ5+ zi,t−5 +                                               δ−k ∆zi,t+k + φt + νi + uit ,   (16)
                                                                                          k=−4


where φt are time effects.
                                                      200


                                                      150
                             Average monthly income




                                                      100


                                                       50


                                                        0


                                                       -50


                                                      -100


                                                      -150
                                                             -5+   -4   -3   -2    -1   event   1    2    3   4   5+
                                                                         Quarters relative to SNAP adoption


Figure 7: Estimated changes in household income at quarters around SNAP adoption. Figure plots
estimates of coefficients δ from (16), with the time period one quarter prior to SNAP adoption
(“-1”) as the omitted category. Inner confidence sets as indicated by the dashes correspond to 95%
pointwise confidence intervals, while outer confidence sets are the uniform 95% sup-t bands (with
critical values obtained via simulation). Standard errors are clustered at the household level.

    The patterns in Figure 7 are consistent with a model in which household income is a determi-
nant of SNAP eligibility as in Remark 4. We see a clear decline in income in the time periods
leading up to a household’s adoption of SNAP. Following the adoption, we observe an increase in
household income.
    Figure 8 depicts estimates δ̂ from two specifications of

                                                                                    4
                                                                                    X
          yit = δ−5+ (1 − zi,t+4 ) + δ5+ zi,t−5 +                                           δ−k ∆zi,t−k + γηit + αi + ωt + εit ,    (17)
                                                                                   k=−4


where ωt are time effects and the outcome yit represents either monthly at-home food expenditure
(Figures 8a and 8b) or the store-brand share of food expenditures (Figures 8c and 8d).
    In Figures 8a and 8c, the term in (17) involving ηit is ignored and so no attempt is made to
control for confounds. Figure 8a shows that there is no economically meaningful pre-trend in
monthly at-home food expenditure. This is consistent with the argument in Hastings and Shapiro

                                                                                    21
                         120                                                                                             120


                         100                                                                                             100


                          80                                                                                              80
   Monthly expenditure




                                                                                                   Monthly expenditure
                          60                                                                                              60


                          40                                                                                              40


                          20                                                                                              20


                           0                                                                                               0


                         -20                                                                                             -20
                               -5+    -4   -3   -2    -1   event   1    2        3   4   5+                                    -5+    -4   -3   -2    -1   event   1    2        3   4   5+
                                            Quarters relative to SNAP adoption                                                              Quarters relative to SNAP adoption

(a) At-home food expenditure around SNAP adop- (b) At-home food expenditure around SNAP adop-
tion, not controlling for household income.    tion. Proposed 2SLS estimator, with zit+1 as ex-
                                               cluded instrument.
                               10-3                                                                                            10-3
                          4                                                                                               4


                          2                                                                                               2


                          0                                                                                               0
   Store-brand share




                                                                                                   Store-brand share

                          -2                                                                                              -2


                          -4                                                                                              -4


                          -6                                                                                              -6


                          -8                                                                                              -8


                         -10                                                                                             -10


                         -12                                                                                             -12
                               -5+    -4   -3   -2    -1   event   1    2    3       4   5+                                    -5+    -4   -3   -2    -1   event   1    2    3       4   5+
                                            Quarters relative to SNAP adoption                                                              Quarters relative to SNAP adoption

(c) Store-brand share of food expenditures around (d) Store-brand share of food expenditures around
SNAP adoption, not controlling for household in- SNAP adoption. Proposed 2SLS estimator, with
come.                                             zi,t+1 as excluded instrument.

Figure 8: Estimated changes in outcomes at quarters around SNAP adoption. Each figure plots
estimates of coefficients δ from (17), with the time period one quarter prior to SNAP adoption
(“-1”) as the omitted category. Inner confidence sets as indicated by the dashes correspond to 95%
pointwise confidence intervals, while outer confidence sets are the uniform 95% sup-t bands (with
critical values obtained via simulation). Standard errors are clustered at the household level.


(2018) that the effect of cash income on food spending is small. By contrast, Figure 8c shows a
clear pre-trend in store-brand share that is small in absolute terms but large relative to the change
on adoption. We note that, since SNAP adoption can occur at any time in the quarter, period 0 is
“partially treated.”
    Figures 8b and 8d use our proposed estimator, with the closest lead of zit serving as an excluded




                                                                                              22
instrument for xit .20 In this setting, the exclusion restriction in Assumption 1(b) requires that SNAP
receipt does not directly affect cash income. This would fail if, for example, program entry or the
anticipation of entry leads households to reduce labor supply. Assumption 1(b) also rules out that
SNAP receipt is correlated with the measurement error in the proxy xit for income.
    In the case of at-home food expenditures, Figure 8b shows that taking the income confound
into account does not alter the conclusions from the uncorrected plot in Figure 8a. This is because
the negligible pre-trend in expenditure implies a small response to changes in income.
    By contrast, Figure 8d differs markedly from Figure 8c, because the relatively large pre-trend
in store-brand share implies a significant response to changes in income. The 2SLS estimator
accounts for this pre-trend through the presence of the confound ηit , and eliminates the pre-trend
from the plot. The dynamics of store-brand share that we observe following adoption likely reflect
households’ gradual exit from the program following adoption.
    Figure 9a provides a geometric intuition for our proposed procedure. It combines a rescaled
version of Figure 7 with Figure 8c. Our proposed estimator uses the dynamics in both the house-
hold income and store-brand share in the two quarters prior to the event to infer the effect of the
confound. Geometrically this amounts to aligning the two plots in the two-period window prior
to the event. We interpret the remaining difference, depicted in Figure 8d, as an approximation of
the causal effect of SNAP adoption on the store-brand share. For comparison, Figure 9b shows
the dynamics of the confound implied by linear extrapolation from the three periods immediately
preceding the event. These dynamics differ markedly from those of the income proxy, and imply a
small initial effect of SNAP that grows larger over time.
    Figure 8 depicts two possible scenarios for applying our approach in the presence of a clear
potential confound. In the first scenario, confidence sets exclude a meaningful pre-trend in the
outcome, and our proposed method formalizes the intuitive notion that the confound does not
cause significant bias in the estimation of the policy effect. In the second scenario, there is a clear
pre-trend in the outcome, and our method adjusts causal inference for the presence of the confound.
    Table 1 presents estimates β̂ from the static analogue of (17). Although a static model does
not capture the post-treatment dynamics of the outcomes, it is a common way to summarize the
effect size (Borusyak and Jaravel 2017). The first row shows that, with no control for household
income, the estimated effect of adopting SNAP on monthly expenditure is 86 dollars, while SNAP
adoption leads to a decrease in the store-brand share of 0.4%. The second row notes that controlling
for household income directly is infeasible, as household income and the outcomes of interest are
not observed in the same data. The third row shows that, using our proposed 2SLS estimator, the
estimated effect of SNAP adoption on monthly food expenditure is 84 dollars, similar to the first
  20
    Because yit and xit are not observed jointly, we use a two-sample instrumental variables estimator (Angrist and
Krueger 1992; Inoue and Solon 2010).



                                                        23
                             10-3                                                                                          10-3
                        4                                                                                            10

                                                                                                                      8
                        2
                                                                                                                      6
                        0
                                                                                                                      4
   Store-brand share




                                                                                                 Store-brand share
                        -2                                                                                            2

                                                                                                                      0
                        -4
                                                                                                                      -2

                        -6                                                                                            -4

                                                                                                                      -6
                        -8
                                                                                                                      -8
                       -10
                                                                                                                     -10

                       -12                                                                                           -12
                             -5+    -4   -3   -2    -1   event   1    2    3     4   5+                                    -5+    -4   -3   -2    -1   event   1    2    3   4   5+
                                          Quarters relative to SNAP adoption                                                            Quarters relative to SNAP adoption

(a) Graphical intuition of proposed 2SLS estima- (b) Graphical intuition of estimator extrapolating a
tor. Dashed line depicts household income (Figure linear trend. Dashed line depicts estimate of linear
7, rescaled).                                     trend.

Figure 9: Geometric illustration of two estimators. Dashed line depicts implicit counterfactual.
Round markers depict store-brand share of food expenditures (Figure 8c) around SNAP adoption.
The vertical difference between the dashed line and the dots at event time or post-event is the
implied estimate of the dynamic causal effect for each estimator.


row. On the other hand, the estimated effect on the store-brand share is a decrease of 0.7%, an
increase in magnitude of almost 60% compared to the first row. As expected from Figure 7, the
first stage is highly significant.

                 Estimator                                                Effect of SNAP adoption on       Coefficient on lead
                                                                     monthly expenditure store-brand share   in first stage
                 No control                                                     85.97                                            -0.0044
                                                                                (1.23)                                           (0.0004)
                 Controlling for xit                                           infeasible                                    infeasible

                 Proposed 2SLS estimator                                        84.35                                            -0.0070                           -151.81
                 (one lead)                                                     (1.11)                                           (0.0004)                           (2.55)

Table 1: Estimates of the effect of SNAP adoption. In the first two columns, each row corresponds
to a different estimate β̂ from yit = βzit + ωt + γηit + αi + εit . The first row uses no control
for household income. The second row reports that controlling directly for household income is
infeasible. The third row uses our proposed 2SLS estimator, treating the closest lead of SNAP
adoption as an excluded instrument for household income. The last column shows the coefficient
on the excluded instrument in the first stage of the 2SLS estimator. Standard errors in parentheses
are clustered at the household level.

            The pre-test estimator, though not depicted in Table 1, is also feasible in this context. For

                                                                                            24
monthly expenditure, we cannot reject δ−2 = 0 at the 5% level in (17) (see Figure 8a), so the
pre-test estimator is equivalent to using no control for income. For store-brand share, we reject
δ−2 = 0 at the 5% level in (17) (see Figure 8c), so the pre-test estimator suggests to give up.


4.2    The Effect of Newspaper Entry and Exit on Electoral Politics
Gentzkow et al. (2011) study the effect of newspapers on voter turnout, exploiting variation gen-
erated by daily newspapers’ entries and exits in local markets in the US. Here, i indexes local
markets (counties) and t indexes presidential election years. The outcome yit is voter turnout. The
policy zit is the number of English-language daily newspapers in the market. Following Remark
4, it is reasonable to expect the entry of a newspaper to coincide with an improvement in market
profitability ηit . Because the state of the local economy could also affect voter turnout, market
profitability is a potential confound. Gentzkow et al. (2011) have proxies for profitability, includ-
ing a measure xit of the log of the voting-eligible population. Following Gentzkow et al. (2011),
we depict plots with first-differenced dependent variables.21
    Figure 10 depicts estimates of the coefficients δk from

                                         5
                                         X
                              ∆xit =          δ−k ∆zi,t+k + ∆φst + ∆uit ,                          (18)
                                       k=−5


where φst is a state-year fixed effect. The patterns in the figure are consistent with a model in
which the voting-eligible population approximates newspaper profitability: We see a clear increase
in population growth in the time periods leading up to a market entry, and then population growth
flattens out again after an entry has occurred.
     Figure 11 depicts estimates of the coefficients δk from three specifications of the equation:

                                  5
                                  X
                         ∆yit =          δ−k ∆zi,t+k + ∆ωst + γ∆ηit + ∆εit ,                       (19)
                                  k=−5


where ωst is a state-year fixed effect. We omit additional control variables but show in Online
Appendix Table 2 and Online Appendix Figure 11 how their inclusion affects our results. In Figure
11a, the term involving ∆ηit is omitted from (19). This specification therefore does not control for
newspaper profitability. Figure 11b controls for market profitability by directly substituting the
observed ∆xit for ∆ηit in (19). Figure 11c uses our proposed 2SLS estimator, with the closest
lead of ∆zit serving as an excluded instrument for ∆xit . In this setting, the exclusion restriction
in Assumption 1(b) requires that newspaper entry and exit do not directly affect population or its
  21
     We use the authors’ original data in our analysis, available at https://www.aeaweb.org/articles?id=
10.1257/aer.101.7.2980.


                                                   25
                             Change in log(voting−eligible population)
                                                                         .02
                                                                         .01
                                                                         0
                                                                         −.01
                                                                                −5   −4   −3   −2    −1    event   1    2    3   4   5
                                                                                               Elections relative to entry



Figure 10: Estimated changes in population at election years around newspaper entries/exits. The
plot shows estimates of coefficients δk from (18). Inner confidence sets as indicated by the dashes
correspond to 95% pointwise confidence intervals, while outer confidence sets are the uniform
95% sup-t bands (with critical values obtained via simulation). Standard errors are clustered at the
county level.


relationship to newspaper profitability. Figure 11 shows that we obtain qualitatively similar results
when controlling for xit directly and when using our proposed estimator.
    Table 2 presents estimates β̂ from the static analogue of (19), which represents the causal
effect of an additional newspaper on voter turnout. The first row shows that with no controls the
estimated effect is 0.26 percentage points per newspaper. The second row shows that controlling
for the log of the voting-eligible population leads the estimate to increase to 0.37 percentage points
per newspaper. The third row shows that our proposed 2SLS estimator gives an estimate of 0.34


                Estimator                                                                          Effect of    Coefficient on lead
                                                                                                newspaper entry   in first stage
                No control                                                                                 0.0026
                                                                                                          (0.0009)
                Controlling for xit                                                                        0.0037
                                                                                                          (0.0010)
                Proposed 2SLS estimator                                                                    0.0034                     0.0128
                (one lead)                                                                                (0.0013)                   (0.0017)

Table 2: Estimates of the effect of newspapers on voter turnout. In the first column, each row
corresponds to a different estimate β̂ from ∆yit = β∆zit + ∆ωst + γ∆ηit + ∆εit . The first
row uses no control for market profitability. The second row uses the log of the voting-eligible
population as a proxy. The third row uses our proposed 2SLS estimator, treating the closest lead of
the number of newspapers as an excluded instrument for the log of the voting-eligible population.
The second column shows the coefficient on the excluded instrument in the first stage of the 2SLS
estimator. Standard errors in parentheses are clustered at the county level.


                                                                                                       26
                                        .008




                                                                                                                                                                                                                              .008
 Change in turnout per eligible voter




                                                                                                                                                                                       Change in turnout per eligible voter
                                        .004




                                                                                                                                                                                                                              .004
                                        0




                                                                                                                                                                                                                              0
                                        −.004




                                                                                                                                                                                                                              −.004
                                        −.008




                                                                                                                                                                                                                              −.008
                                                −5   −4   −3   −2    −1   event   1                                             2         3        4        5                                                                         −5       −4       −3       −2    −1   event   1     2    3   4   5
                                                               Elections relative to entry                                                                                                                                                                       Elections relative to entry


                                        (a) Not controlling for market profitability                                                                                               (b) Using the log of voting-eligible population as
                                                                                                                                                                                   a proxy for market profitability
                                                                                                                             .008
                                                                                      Change in turnout per eligible voter
                                                                                                                             .004
                                                                                                                             0
                                                                                                                             −.004
                                                                                                                             −.008




                                                                                                                                     −5       −4       −3       −2    −1   event   1                                             2         3        4        5
                                                                                                                                                                Elections relative to entry


                                                                                  (c) Proposed 2SLS estimator, with ∆zc,t+1 as
                                                                                  excluded instrument

Figure 11: Estimated effects on voter turnout in presidential election years around newspaper
entries/exits. The plot shows estimates of coefficients δk from (19). Inner confidence sets as
indicated by the dashes correspond to 95% pointwise confidence intervals, while outer confidence
sets are the uniform 95% sup-t bands (with critical values obtained via simulation). Standard errors
are clustered at the county level.


percentage points per newspaper, which is statistically and economically similar to the estimate in
the second row.22


4.3                                              The Effect of the Minimum Wage on Youth Employment
There is an ongoing debate about the effect of the minimum wage on youth employment (Neumark
et al. 2014; Allegretto et al. 2017). Let i index states and t index quarters. The outcome yit
is the log of the teen (16-19) employment-to-population ratio. The policy zit is the log of the
                          22
    The p−values for equality of estimates relative to controlling for xit directly are 0.000 for the estimator with no
control and 0.714 for our proposed 2SLS estimator. These p−values are based on 100 cluster-bootstrap replications.


                                                                                                                                                                        27
                                 Log(prime−age employment−to−population ratio)
                                                                                 .04
                                                                                 0
                                                                                 −.04
                                                                                 −.08
                                                                                 −.12
                                                                                        −4+   −3        −2        −1      event      1          2   3+
                                                                                                   Quarters relative to minimum wage increase




Figure 12: Prime-age employment at quarters around minimum wage increases. The plot shows
estimates of coefficients δ from (20). Inner confidence sets as indicated by the dashes correspond to
95% pointwise confidence intervals, while outer confidence sets are the uniform 95% sup-t bands
(with critical values obtained via simulation). Standard errors are clustered at the state level.


state minimum wage. The control qit is the share of teenagers in the population. We may be
concerned that states implement minimum-wage increases when demand ηit for labor is strong
(Card and Krueger 1995; Neumark and Wascher 2007). We proxy for labor market conditions
using a measure xit of the log of the prime-age (25-55) employment-to-population ratio. For
prime-age workers the effect of minimum wages is plausibly small compared to other sources
of variation (Brown 1999), lending credibility to the exclusion restriction in Assumption 1(b),
which requires that the minimum wage does not affect prime-age employment or its relationship
to the level of labor demand. Directly controlling for xit , as is commonly done, fails to allow for
mismeasurement of the true demand for youth labor.
    We construct data on yit , xit , and qit from the CPS Outgoing Rotation Groups for the years
1985 − 2014.23 We obtain data on zit from David Neumark’s Minimum Wage Dataset.24 All
regressions in this section are weighted by teen population.
    Figure 12 depicts the time path of our proxy, the log of prime-age employment, around mini-
mum wage increases. Specifically, the figure depicts estimates of the coefficients δk from

                                                                                                                   3
                                                                                                                   X
            xit = δ−4+ (1 − zi,t+3 ) + δ3+ zi,t−3 +                                                                         δ−k ∆zi,t+k + qit0 ψ + φt + νi + uit .   (20)
                                                                                                                  k=−2


Here, we slightly abuse notation to define qit to exclude time-period indicators. Consistent with
our expectation, the point estimates indicate that increases in the minimum wage tend to occur
  23
      The Current Population Survey data is available at http://www.nber.org/data/morg.html. We con-
struct the employment-to-population ratios as the proportion of individuals in the corresponding age category who
self-report as either “Working” or “With a job, not at work.” We weight individual observations using the final weight
variable to obtain state-level aggregates.
   24
      The minimum wage data is available at http://www.socsci.uci.edu/˜dneumark/datasets.html.
We use the higher of the federal or state minimum wage as the prevailing minimum wage.


                                                                                                                  28
                                            .4




                                                                                                                                                                                                                                          .4
 Log(teen employment−to−population ratio)




                                                                                                                                                                                               Log(teen employment−to−population ratio)
                                            .2




                                                                                                                                                                                                                                          .2
                                            0




                                                                                                                                                                                                                                          0
                                            −.2




                                                                                                                                                                                                                                          −.2
                                            −.4




                                                                                                                                                                                                                                          −.4
                                            −.6




                                                                                                                                                                                                                                          −.6
                                                  −4+   −3        −2        −1      event                                                    1         2         3+                                                                                 −4+       −3         −2       −1      event      1          2   3+
                                                             Quarters relative to minimum wage increase                                                                                                                                                            Quarters relative to minimum wage increase



                                        (a) Not controlling for the state of economy                                                                                                       (b) Using prime-age employment as a proxy for
                                                                                                                                                                                           the state of the economy
                                                                                                                                       .4
                                                                                            Log(teen employment−to−population ratio)
                                                                                                                                       .2
                                                                                                                                       0
                                                                                                                                       −.2
                                                                                                                                       −.4
                                                                                                                                       −.6




                                                                                                                                                 −4+       −3         −2       −1      event                                                    1         2         3+
                                                                                                                                                                Quarters relative to minimum wage increase



                                                                                        (c) Proposed 2SLS estimator, with zi,t+1 as ex-
                                                                                        cluded instrument

Figure 13: Teen employment at quarters around minimum wage increases. The plot shows esti-
mates of coefficients δk from (21). In the top row, inner confidence sets as indicated by the dashes
correspond to 95% pointwise confidence intervals, while outer confidence sets are the uniform
95% sup-t bands (with critical values obtained via simulation). In the bottom figure, dashed con-
fidence intervals correspond to 95% pointwise confidence intervals, ignoring weak identification.
Standard errors are clustered at the state level.


following an increase in prime-age employment. However, the estimates are imprecise, and based
on the uniform confidence intervals, we cannot reject the hypothesis of no pre-trends.
    Figure 13 depicts estimates δ̂ from three specifications of the equation:

                                                                                                                                                                       3
                                                                                                                                                                       X
                                                   yit = δ−4+ (1 − zi,t+3 ) + δ3+ zi,t−3 +                                                                                      δk ∆zi,t+k + γηit + qit0 θ + ωt + αi + εit .                                                                                        (21)
                                                                                                                                                                      k=−2


In Figure 13a, the term involving ηit is omitted from (21). This specification therefore does not
control for the state of the labor market. Figure 13b uses prime-age employment xit directly as a
control. Figure 13c depicts the results from our proposed estimator, in which we use the closest
lead of the policy, zi,t+1 , as an excluded instrument for xit . Because the first stage for this model is
weak (cf. Table 3), the confidence set for the coefficient on xit based on inversion of the Anderson-


                                                                                                                                                                               29
                                                 Effect of    Coefficient on lead
                                            log(minimum wage)   in first stage
              No control                          -0.0114
                                                  (0.0743)
              Controlling for                     -0.0094
              prime-age employment                (0.0708)
              Proposed 2SLS estimator              0.0003                 0.0314
              (one lead)                          (0.0668)               (0.0136)
                                                 [−∞, ∞]

Table 3: Estimates of the effect of the minimum wage on teen (16-19) employment. Dependent
variable: log(employment/population). Each row corresponds to a different estimate β̂ from the
model in first differences given by (22). The first row uses no control for the state of the economy.
The second row uses the prime-age employment-to-population ratio as a proxy. The third row uses
our proposed 2SLS estimator, treating the change in the first lead of the log of the minimum wage
as an excluded instrument for the change in the log of the prime-age employment-to-population
ratio. We present both conventional standard errors and a confidence interval (in square brackets)
constructed by projection based on an inversion of the AR test for the coefficient on the change
in the log of the prime-age employment-to-population ratio. All regressions are weighted by teen
population. Standard errors are clustered at the state level.


Rubin (AR) test consists of the entire real line. A projection argument therefore implies that valid
confidence sets in Figure 13c also include the entire real line.
   Table 3 presents estimates β̂ from the following static model, represented in first differences:

                           ∆yit = β∆zit + ∆qit0 θ + ∆ωt + γ∆ηit + ∆εit .                          (22)

The first row of Table 3 shows that with no controls we estimate a statistically insignificant elas-
ticity of teen employment with respect to the minimum wage of −0.0114. The second row shows
that controlling for adult employment leads the estimated elasticity to decline in absolute magni-
tude to −0.0094. This estimate remains statistically insignificant. The third row shows that using
our proposed 2SLS estimator we estimate an elasticity of 0.0003. This estimate is statistically in-
significant according both to conventional standard errors and to a confidence interval constructed
by projection based on inversion of the AR test for the coefficient on xit , which consists of the real
line.
     This last application demonstrates the limitations of our proposed estimator. Instrument rel-
evance requires a strong pre-trend in the covariate xit . Absent such a pre-trend, our proposed
estimator is not strongly identified, and our approach implies that the econometrician cannot learn
about the parameter of interest. Arguably, however, that is a valid conclusion if we are concerned


                                                  30
about a confound ηit and are not confident that xit is a perfect proxy for that confound.


5      Extensions

5.1      Anticipatory and Dynamic Treatment Effects
The model in (6) is static in the sense that the policy has only contemporaneous effects on the
outcome. The following generalization allows for both anticipatory effects and dynamic treatment
effects:
                                                 M
                                                 X
                                     ỹit =               βm z̃i,t−m + η̃it0 γ + ε̃it .             (23)
                                               m=−G


We assume that the number of periods G and M over which anticipatory and dynamic effects
operate are known.

Assumption 1’ (Orthogonality conditions - dynamic model). There exists a positive integer L such
that for L = {−M, . . . , G − 1, G, G + 1, . . . , G + L},
                     
    (a) E z̃i,t+l ε̃it = 0 for all l ∈ L.
                     
    (b) E z̃i,t+l ũit = 0 for all l ∈ L.

Assumption 2’ (Rank conditions - dynamic model). Let wit = (z̃i,t−M , · · · , z̃it , · · · , z̃i,t+G+L )0
and define a matrix H as H = E(wit [z̃i,t−M , · · · , z̃i,t+G , x̃0it ]). Then:

    (a) rank(Λ) = R.

    (b) rank(H) = (R + M + G + 1).

     Following the same reasoning as in Section 2, Assumption 2’ (a) allows us to write

                                                                    M
                                                                    X
                             ṽit ≡ ε̃it −   ũ0it Γ̃   = ỹit −          βm z̃i,t−m − x̃0it Γ̃.    (24)
                                                                   m=−G


Assumption 1’ implies that E [wit ṽit ] = 0, and Assumption 2’(b) guarantees that these moment
conditions are sufficient to identify the causal effects βm .
    As in the static model, estimation may then proceed by GMM, for example through a 2SLS
regression of ỹit on {z̃i,t−m }M
                                m=−G and x̃it , treating the covariates x̃it as mismeasured regressors
and the leads of z̃it beyond period G as the excluded instruments.


                                                               31
5.2     Overidentification and Moment Selection
We have maintained throughout that K = R, and in our simulations and applications we use
the R closest leads of z̃it as instruments. These choices result in an exactly identified model. In
practical situations, the model may be overidentified, which raises issues of moment selection and
specification testing.

5.2.1    More Leads than Confounds

In some situations, the researcher may be interested in using more than R leads of z̃it as instru-
ments. Because the number of potential leads will usually be small and the instruments are ordered
(with closer leads more likely to be informative), BIC will often be a natural choice among formal
methods for instrument selection (Rao et al. 2001). In Online Appendix Figure 4, we present
simulation results from using BIC to select among potential leads.
    If more than R leads are used, the model is overidentified and the usual principles for choosing
an efficient GMM estimator will apply (Newey and McFadden 1994). Further, the overidentifying
restrictions can be tested, and such a test is intuitively similar to looking at whether there are pre-
trends in the event plots for our proposed 2SLS estimator. However, while such tests are valid tests
of a null of correct specification, choosing a model based on such tests will create the usual pre-test
biases (Leeb and Pötscher 2005; Guggenberger 2010).

5.2.2    More Covariates than Confounds

If the number of covariates is larger than the number of confounds (K > R), standard methods for
moment selection and combination may be used to find data-driven weights to use all covariates
efficiently (Newey and McFadden 1994).
      As in the case of multiple leads, tests for overidentification will be available in this case, and
with the same caveats.
      An alternative approach available in this case is to use the methods developed in the literature
on measurement errors (Abbring and Heckman 2007; Heckman and Vytlacil 2007). For instance,
suppose that R = 1, K = 2, and that the errors ũit are uncorrelated across covariates and with
ε̃it . Then, under a rank condition analogous to Assumption 2(b), the model is identified without
the need to treat leads of the policy as excluded instruments. Of course, whether such covariance
restrictions are appropriate will depend on the economic setting.25
  25
     In the applications we have in mind, the number of plausible proxies is small. If there are instead many covariates
that contain independent information about the unobserved confounds, one may alternatively adapt methods from the
literature on factor models in high dimensions as in, e.g., Stock and Watson (2002), Bai (2003), Bai and Ng (2010),
and Hansen and Liao (2018).



                                                          32
6    Conclusion
We consider a linear panel data model with possible endogeneity. We show how to exploit a
covariate related to the confound but unaffected by the policy of interest to perform causal inference
in this setting. We validate our proposal in simulations from a range of data-generating processes,
and apply it to three economic settings of interest. Alternative approaches, such as estimation
following a test for pre-trends, perform poorly in our simulations.




                                                 33
References
Abadie, A., A. Diamond, and J. Hainmueller (2010). Synthetic control methods for comparative
  case studies: Estimating the effect of California’s tobacco control program. Journal of the
  American Statistical Association 105(490), 493–505.

Abbring, J. H. and J. J. Heckman (2007). Econometric evaluation of social programs, part III:
  Distributional treatment effects, dynamic treatment effects, dynamic discrete choice, and gen-
  eral equilibrium policy evaluation. In J. J. Heckman and E. E. Leamer (Eds.), Handbook of
  Econometrics, Volume 6, Chapter 72, pp. 5145–5303. Elsevier.

Abraham, S. and L. Sun (2018). Estimating dynamic treatment effects in event studies with het-
  erogeneous treatment effects. arXiv:1804.05785.

Aigner, D. J., C. Hsiao, A. Kapteyn, and T. Wansbeek (1984). Latent variable models in econo-
  metrics. In Z. Griliches and M. D. Intriligator (Eds.), Handbook of Econometrics, Volume 2,
  Chapter 23, pp. 1321–1393. Elsevier.

Allegretto, S., A. Dube, M. Reich, and B. Zipperer (2017). Credible research designs for minimum
  wage studies: A response to Neumark, Salas, and Wascher. ILR Review 70(3), 559–592.

Allegretto, S. A., A. Dube, and M. Reich (2011). Do minimum wages really reduce teen employ-
  ment? Accounting for heterogeneity and selectivity in state panel data. Industrial Relations: A
  Journal of Economy and Society 50(2), 205–240.

Altonji, J. G., T. E. Elder, and C. R. Taber (2005). Selection on observed and unobserved variables:
  Assessing the effectiveness of Catholic schools. Journal of Political Economy 113(1), 151–184.

Andrews, I., M. Gentzkow, and J. M. Shapiro (2017). Measuring the sensitivity of parameter
  estimates to estimation moments. Quarterly Journal of Economics 132(4), 1553–1592.

Andrews, I. and A. Mikusheva (2016). A geometric approach to nonlinear econometric models.
  Econometrica 84(3), 1249–1264.

Angrist, J. D. and A. B. Krueger (1992). The effect of age at school entry on educational attain-
  ment: An application of instrumental variables with moments from two samples. Journal of the
  American Statistical Association 87(418), 328–336.

Ashenfelter, O. (1978). Estimating the effect of training programs on earnings. Review of Eco-
  nomics and Statistics 60(1), 47–57.



                                                34
Ashenfelter, O. and D. Card (1985). Using the longitudinal structure of earnings to estimate the
  effect of training programs. Review of Economics and Statistics 67(4), 648–660.

Athey, S. and G. W. Imbens (2018). Design-based analysis in difference-in-differences settings
  with staggered adoption. Working Paper 24963, National Bureau of Economic Research.

Bai, J. (2003). Inferential theory for factor models of large dimensions. Econometrica 71(1),
  135–171.

Bai, J. and S. Ng (2010). Instrumental variable estimation in a data rich environment. Econometric
  Theory 26(6), 1577–1606.

Ball, R. and P. Brown (1968). An empirical evaluation of accounting income numbers. Journal of
  Accounting Research 6(2), 159–178.

Besley, T. and A. Case (2000). Unnatural experiments? Estimating the incidence of endogenous
  policies. Economic Journal 110(467), 672–694.

Borusyak, K. and X. Jaravel (2017). Revisiting event study designs. Working paper.

Bronnenberg, B. J., J.-P. Dubé, M. Gentzkow, and J. M. Shapiro (2015). Do pharmacists buy
  Bayer? Informed shoppers and the brand premium. Quarterly Journal of Economics 130(4),
  1669–1726.

Brown, C. (1999). Minimum wages, employment, and the distribution of income. In O. C. Ashen-
  felter and D. Card (Eds.), Handbook of Labor Economics, Volume 3, Chapter 32, pp. 2101 –
  2163. Elsevier.

Bustos, P., B. Caprettini, and J. Ponticelli (2016). Agricultural productivity and structural transfor-
  mation: Evidence from Brazil. American Economic Review 106(6), 1320–65.

Card, D. E. and A. B. Krueger (1995). Myth and Measurement: The New Economics of the
  Minimum Wage. Princeton University Press.

Castner, L. and J. Mabli (2010). Low-income household spending patterns and measures of
  poverty. Washington, D.C.: Mathematica Policy Research.

Chernozhukov, V., K. Wüthrich, and Y. Zhu (2017). An exact and robust conformal inference
  method for counterfactual and synthetic controls. arXiv:1712.09089.

Conley, T. G., C. B. Hansen, and P. E. Rossi (2012). Plausibly exogenous. Review of Economics
  and Statistics 94(1), 260–272.

                                                  35
de Chaisemartin, C. and X. D’Haultfoeuille (2018). Two-way fixed effects estimators with hetero-
  geneous treatment effects. arXiv:1803.08807.

Dixit, A. K. and R. S. Pindyck (1994). Investment under uncertainty. Princeton University Press.

Dobkin, C., A. Finkelstein, R. Kluender, and M. J. Notowidigdo (2018). The economic conse-
  quences of hospital admissions. American Economic Review 108(2), 308–52.

Duggan, M., C. Garthwaite, and A. Goyal (2016). The market impacts of pharmaceutical product
  patents in developing countries: Evidence from India. American Economic Review 106(1), 99–
  135.

Ferman, B. and C. Pinto (2017). Placebo tests for synthetic controls. MPRA Paper No. 78079.

Gentzkow, M., J. M. Shapiro, and M. Sinkinson (2011). The effect of newspaper entry and exit on
  electoral politics. American Economic Review 101(7), 2980–3018.

Goodman-Bacon, A. (2018). Difference-in-differences with variation in treatment timing. Working
  Paper 25018, National Bureau of Economic Research.

Griliches, Z. and J. A. Hausman (1986). Errors in variables in panel data. Journal of Economet-
  rics 31(1), 93–118.

Guggenberger, P. (2010). The impact of a Hausman pretest on the asymptotic size of a hypothesis
  test. Econometric Theory 26(02), 369–382.

Hansen, C. and Y. Liao (2018). The factor-lasso and k-step bootstrap approach for inference in
  high-dimensional economic applications. Econometric Theory. Forthcoming.

Hastings, J. S. and J. M. Shapiro (2018). How are SNAP benefits spent? Evidence from a retail
  panel. American Economic Review 108(12), 3493–3540.

Hausman, C. and D. S. Rapson (2018). Regression discontinuity in time: Considerations for
  empirical applications. Annual Review of Resource Economics 10, 533–552.

Heckman, J. J. and R. Robb (1985, 10). Alternative methods for evaluating the impact of interven-
  tions. In J. J. Heckman and B. S. Singer (Eds.), Longitudinal Analysis of Labor Market Data:,
  pp. 156–246. Cambridge: Cambridge University Press.

Heckman, J. J. and E. J. Vytlacil (2007). Econometric evaluation of social programs, part II: Using
  the marginal treatment effect to organize alternative econometric estimators to evaluate social
  programs, and to forecast their effects in new environments. In J. J. Heckman and E. E. Leamer
  (Eds.), Handbook of Econometrics, Volume 6, Chapter 71, pp. 4875–5143. Elsevier.

                                                36
Hoynes, H. W. and D. W. Schanzenbach (2009). Consumption responses to in-kind transfers:
  Evidence from the introduction of the Food Stamp Program. American Economic Journal:
  Applied Economics 1(4), 109–139.

Inoue, A. and G. Solon (2010). Two-sample instrumental variables estimators. Review of Eco-
  nomics and Statistics 92(3), 557–561.

Jacobson, L. S., R. J. LaLonde, and D. G. Sullivan (1993). Earnings losses of displaced workers.
  American Economic Review 83(4), 685–709.

Kahn-Lang, A. and K. Lang (2018). The promise and pitfalls of differences-in-differences: Reflec-
  tions on ‘16 and Pregnant’ and other applications. Journal of Business & Economic Statistics.
  Forthcoming.

Leeb, H. and B. M. Pötscher (2005). Model selection and inference: Facts and fiction. Econometric
  Theory 21(1), 2159.

Li, K. T. (2017). Statistical inference for average treatment effects estimated by synthetic control
  methods. Working Paper.

MacKinlay, A. C. (1997). Event studies in economics and finance. Journal of Economic Litera-
 ture 35(1), 13–39.

Matzkin, R. L. (2007). Nonparametric identification. In J. J. Heckman and E. E. Leamer (Eds.),
 Handbook of Econometrics, Volume 6, Chapter 73, pp. 5307 – 5368. Elsevier.

McDonald, R. and D. Siegel (1986). The value of waiting to invest. Quarterly Journal of Eco-
 nomics 101(4), 707–728.

Neumark, D., J. I. Salas, and W. L. Wascher (2014). More on recent evidence on the effects of
  minimum wages in the United States. IZA Journal of Labor Policy 3(1), 24.

Neumark, D. and W. L. Wascher (2007). Minimum wages and employment. Foundations and
  Trends R in Microeconomics 3(1–2), 1–182.

Newey, W. K. and D. McFadden (1994). Large sample estimation and hypothesis testing. In R. F.
  Engle and D. L. McFadden (Eds.), Handbook of Econometrics, Volume 4, Chapter 36, pp. 2111
  – 2245. Elsevier.

Olea, J. L. M. and M. Plagborg-Møller (2019). Simultaneous confidence bands: Theory, imple-
  mentation, and an application to SVARs. Journal of Applied Econometrics 34(1), 1–17.


                                                37
Oster, E. (2016). Unobservable selection and coefficient stability: Theory and validation. Journal
  of Business Economics and Statistics. Forthcoming.

Pierce, J. R. and P. K. Schott (2016). The surprisingly swift decline of US manufacturing employ-
  ment. American Economic Review 106(7), 1632–62.

Rao, C. R., Y. Wu, S. Konishi, and R. Mukerjee (2001). On model selection. Lecture Notes-
  Monograph Series 38, 1–64.

Roth, J. (2018). Pre-test with caution: Event-study estimates after testing for parallel trends.
  Working Paper.

Stock, J. H. and M. W. Watson (2002). Forecasting using principal components from a large
  number of predictors. Journal of the American Statistical Association 97(460), 1167–1179.

Stock, J. H., J. H. Wright, and M. Yogo (2002). A survey of weak instruments and weak identifi-
  cation in generalized method of moments. Journal of Business and Economic Statistics 20(4),
  518–529.

Wansbeek, T. (2001). GMM estimation in panel data models with measurement error. Journal of
 Econometrics 104(2), 259–268.

Xiao, Z., J. Shao, and M. Palta (2010). Instrumental variable and GMM estimation for panel data
  with measurement error. Statistica Sinica 20(4), 1725–1747.




                                               38
