                               NBER WORKING PAPER SERIES




       TAXATION AND REDISTRIBUTION OF RESIDUAL INCOME INEQUALITY

                                          Mikhail Golosov
                                          Pricila Maziero
                                           Guido Menzio

                                       Working Paper 18151
                               http://www.nber.org/papers/w18151


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      June 2012




We are grateful to Jim Albrecht, Paul Beaudry, Michele Boldrin, Jan Eeckhout, Pieter Gautier, Veronica
Guerrieri, Espen Moen, Dale Mortensen, Giuseppe Moscarini, Nicola Pavoni, Tom Sargent, Rob Shimer
and Randy Wright for their comments on earlier versions of the paper. We have also received useful
comments from seminar participants at NYU, UW Madison, UBC, UAB, EUI, WashU, Queen's, Science
Po, Southampton and from participants at the Northwestern Conference in Honor of Dale Mortensen
(Evanston 2011), the NBER Summer Institute (Cambridge 2011), the Tinbergen Institute Conference
on Friction and Policy (Amsterdam 2011) and the American Economic Association Meeting (Chicago
2012). The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research. Golosov acknowledges the NSF Career grant and Sloan
Foundation for financial support.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2012 by Mikhail Golosov, Pricila Maziero, and Guido Menzio. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Taxation and Redistribution of Residual Income Inequality
Mikhail Golosov, Pricila Maziero, and Guido Menzio
NBER Working Paper No. 18151
June 2012
JEL No. H21,J64,J65

                                             ABSTRACT

This paper studies the optimal redistribution of income inequality in a model with search and matching
frictions in the labor market. We study this problem in the context of a directed search model of the
labor market populated by homogeneous workers and heterogeneous firms. The optimal redistribution
in this model, which is associated with the constrained efficient allocation, can be attained using a
positive unemployment benefit and an increasing and regressive labor income tax. The positive unemployment
benefit serves the purpose of lowering the search risk faced by workers. The increasing and regressive
labor tax serves the purpose of aligning the cost to the firm of attracting an additional applicant with
the value of an application to society.


Mikhail Golosov                                     Guido Menzio
Department of Economics                             Department of Economics
Princeton University                                University of Pennsylvania
111 Fisher Hall                                     467 McNeil Building
Princeton, NJ 08544                                 3718 Locust Walk
and NBER                                            Philadelphia, PA 19104
golosov@princeton.edu                               and NBER
                                                    gmenzio@econ.upenn.edu
Pricila Maziero
University of Pennsylvania
3620 Locust Walk SHDH 2324
Philadelphia, PA, 19104
maziero@wharton.upenn.edu
1         Introduction
Public finance has long been concerned with the optimal redistribution of labor income
inequality. Traditionally, the optimal redistribution problem has been studied under the
assumption that the labor market is frictionless and competitive and, hence, all of the
observed diﬀerences in labor income reflect diﬀerences in workers’ productivity (see, e.g.,
Mirrlees 1971, Diamond 1998 or Saez 2001). However, a large body of empirical evidence
documents the existence of substantial wage inequality among seemingly identical workers
(see, e.g., Mortensen 2003 or Autor, Katz and Kerney 2008). While this empirical evidence
is at odds with the view that the labor market is perfectly competitive, it has been shown
to be qualitatively and quantitatively consistent with the presence of search frictions in the
labor markets1 (see, e.g., Postel-Vinay and Robin 2002 or Mortensen 2003).

        In this paper, we want to study the optimal redistribution of income inequality caused by
the presence of search frictions in the labor market. To accomplish this task, we consider a
labor market populated by a continuum of risk-averse workers who are ex-ante homogenous
and by a continuum of firms that are heterogeneous with respect to their productivity. We
assume that workers are ex-ante homogeneous in order to focus on the case where no income
inequality is attributable to diﬀerences in workers’ productivity, which is the opposite of the
case traditionally studied in the public finance literature. We assume that trade in the labor
market is decentralized and frictional as in Moen (1997) and Shimer (1996). First, firms
choose which wage to oﬀer and workers choose whether to search for a job and, if so, which
wage to seek. Then, the firms and the workers oﬀering and seeking the same wage are brought
together by a matching process described by a constant return to scale matching function.
Trade in the labor market is frictional because we assume that the matching function is such
that a worker is not guaranteed to find a job and, similarly, a firm is not guaranteed to find
an employee. Instead, we assume that the probability that a worker finds a job–and the
probability that a firm finds an employee–is a smooth function of the ratio between labor
supply and labor demand at each particular wage. Moreover, we assume that a worker’s
    1
    In a recent paper, Hornstein, Krusell and Violante (2011) argue that properly calibrated search models
cannot account for much residual income inequality. Their analysis applies to a class of search models that
does not include the one that we consider in this paper. More importantly, we do not need to take a stand on
the magnitude of search-based income inequality, as we are mostly interested in understanding the optimal
way to redistribute this type of inequality, be it either large or small.


                                                     1
search strategy is his private information.

   Because of search frictions, diﬀerent types of firms oﬀer diﬀerent wages. In particular,
more productive firms choose to oﬀer higher wages in order to attract more job seekers and,
hence, to increase their probability of trade. Also because of search frictions, inherently
identical workers end up having diﬀerent incomes. In particular, workers who are employed
at more productive firms have a higher income than workers who are employed at less
productive firms, and employed workers have a higher income than unemployed workers.

   In order to find the optimal redistribution of labor income inequality, we begin by solv-
ing for the constrained eﬃcient allocation–i.e. the allocation that maximizes the workers’
expected utility subject to the technological constraints related to production and matching
and to the incentive compatibility constraints associated with the workers’ private informa-
tion about their search strategy. We find that the constrained eﬃcient allocation diﬀers from
the equilibrium allocation along two dimensions. First, in the constrained eﬃcient alloca-
tion, the number of workers seeking employment at high-productivity firms is greater than
in equilibrium, while the number of workers seeking employment at low-productivity firms
is smaller than in equilibrium. Second, in the constrained eﬃcient allocation, the diﬀerence
between the consumption of workers employed at high-productivity firms and of workers em-
ployed at low productivity firms is lower than in equilibrium, while the consumption enjoyed
by unemployed workers is higher than in equilibrium.

   The equilibrium is constrained ineﬃcient because workers face an uninsured “search
risk”–i.e. a worker’s consumption is greater when his search is successful than when his
search fails. While some measure of risk is necessary to induce workers to search for jobs,
the equilibrium search risk is, in general, ineﬃciently high. Hence, firms need to pay a wage
premium to compensate workers for the excess search risk. And since the excess search risk
is increasing in the number of workers applying to a particular job, high-productivity firms
find it optimal to attract an ineﬃciently low number of applicants and, through general
equilibrium eﬀects, low-productivity firms end up attracting an ineﬃciently large number of
applicants.

   The constrained eﬃcient allocation can be implemented by introducing a positive unem-
ployment benefit and an increasing and regressive labor income tax. The role of the positive

                                              2
unemployment benefit is to redistribute consumption between employed and unemployed
workers and, thus, to lower the search risk faced by workers. The role of the positive and
regressive labor income tax is not to redistribute consumption among employed workers, but
rather to make sure that the cost to a firm of attracting an additional applicant reflects the
value of an applicant to society.

   The fact that the optimal labor income tax is regressive is the main result of the paper.
This result is startlingly robust, in the sense that it does not depend on the shape of the
utility function of workers, on the shape of the productivity distribution of firms, or on the
shape of the matching function that brings together workers and firms. Rather, this result
is a necessary implication of two properties of the equilibrium with optimal policy. First,
redistribution only takes place between workers who successfully and unsuccessfully search
for jobs oﬀering the same wage, so that the net resources redistributed between workers who
search for jobs oﬀering diﬀerent wages is zero. This implies that the optimal tax level for
a worker at a job oﬀering a particular wage should be proportional to the inverse of the
probability of finding the job. Second, workers are ex-ante indiﬀerent between searching for
jobs oﬀering diﬀerent wages. This implies that utility from after-tax income from any job
should also be proportional to the inverse of the probability of finding the job. When utility
is strictly concave, these two conditions can hold simultaneously only if the tax schedule is
strictly concave, i.e. regressive.

   The two properties of the equilibrium which guarantee that the optimal labor income tax
is regressive are related to the directed nature of the search process. With directed search,
wage diﬀerentials among employed workers do not reflect luck, but compensation for diﬀerent
job-finding probabilities. For this reason, there is no need for redistribution among workers
employed at diﬀerent wages and, hence, among workers seeking jobs oﬀering diﬀerent wages.
Moreover, with directed search, workers choose where to search. For this reason, workers are
ex-ante indiﬀerent between searching for jobs oﬀering diﬀerent wages.

   The optimality of a regressive labor income tax is a somewhat surprising result. Con-
ventional wisdom suggests that the larger is the component of income inequality that is
residual–i.e. that does not originate from diﬀerences in workers’ productivity–the more
progressive the optimal labor income tax should be (see, e.g., Varian 1980). In our model,

                                              3
the optimal labor income tax is regressive even though, by construction, all income inequality
is residual. Intuitively, in our model, a progressive labor income tax would not be optimal
because it would induce too many workers to seek employment at low-productivity firms and
too few workers to seek employment at high-productivity firms.

   Our paper contributes to two strands of literature. First, our paper contributes to the
literature on optimal income taxation that was pioneered by Mirrlees (1971). This literature
is concerned with characterizing the properties of the income tax system that implements the
optimal redistribution of income inequality, where the extent of redistribution is limited by
the workers’ private information about their productivity. Some papers carry out this task in
a static environment (e.g., Diamond 1998, Saez 2001 and Laroque 2005), some in a dynamic
environment (e.g., Farhi and Werning 2011 or Golosov, Troshkin and Tsyvinski 2011), and
some in a frictional environment (e.g., Hungerbuhler et al. 2006 or Shaal and Taschereau-
Dumouchel 2012). Yet, all of these papers assume that the income inequality originates
from inherent productivity diﬀerences among workers. In contrast, our paper characterizes
the income tax system that implements the optimal redistribution of income inequality that
emerges among identical workers because of search frictions in the labor market.

   Second, our paper contributes to the literature on optimal unemployment insurance that
was pioneered by Shavell and Weiss (1979). This literature is concerned with characterizing
the properties of the unemployment insurance system that implements the optimal redis-
tribution between employed and unemployed workers, where the extent of redistribution is
limited by the workers’ private information about their search eﬀort. In this literature as in
our paper, workers are inherently identical and income inequality is caused by the presence
of search frictions in the labor market. However, in contrast to our paper, this literature
does not contain any insights on income taxation because it either assumes that all employed
workers earn the same wage (e.g., Hansen and Imrohoroglu 1992, Hopenhayn and Nicolini
1997, Acemoglu and Shimer 1999, and Wang and Williamson 2002), or it assumes that a
worker’s wage is his private information (e.g., Shimer and Werning 2008).

   Another contribution of our paper is to sharpen some of the results in Acemoglu and
Shimer (1999). Acemoglu and Shimer study the eﬀects of introducing an unemployment
benefit in a directed search model of the labor market in which both workers and firms are

                                              4
ex-ante homogenous. They prove that the unemployment benefit that maximizes aggregate
output is strictly positive (Proposition 6), and they conjecture that the unemployment ben-
efit that maximizes welfare also increases aggregate output (Conjecture 1). In this paper,
we show that the constrained eﬃcient allocation is implemented by introducing a positive
unemployment benefit and, when firms are heterogeneous, a positive and regressive labor
earnings tax (Theorem 1). Moreover, we prove that aggregate output in the constrained
eﬃcient allocation is higher than in the laissez-faire equilibrium (see the analysis following
Proposition 2). The first of our findings shows that a positive unemployment benefit is indeed
part of the policy mix that implements the constrained eﬃcient allocation, so that Acemoglu
and Shimer’s focus on this policy instrument is without loss in generality. The second of
our findings shows that Conjecture 1 in Acemoglu and Shimer is correct and, moreover, it
generalizes to an environment with heterogeneous firms.



2     Laissez-faire equilibrium
In this section, we lay out our directed search model of the labor market, which is in the
spirit of Moen (1997) and Acemoglu and Shimer (1999). We characterize the equilibrium
allocation and we show that the model generates labor income inequality among inherently
identical workers. In particular, the model generates income inequality between employed
and unemployed workers and across workers employed by diﬀerent firms.


2.1    Environment

The economy is populated by a continuum of homogeneous workers with measure 1. Each
worker has preferences that are described by the utility function u(c), where u : R+ → R is
a twice diﬀerentiable, strictly increasing and strictly concave function of consumption. Each
worker is endowed with one job application and one indivisible unit of labor.

    The economy is also populated by a continuum of heterogeneous firms with measure
m > 0. The type of a firm is denoted by y ∈ [y, y], 0 < y < y, and the measure of firms with
type less than y is denoted by F (y), where F : [y, y] → [0, m] is a twice diﬀerentiable and
strictly increasing function with boundary conditions F (y) = 0 and F (y) = m. A firm of
type y owns a vacancy that, when filled by a worker, produces y units of output. Firms are

                                              5
owned by workers through a mutual fund.2 Hence, the objective of the firms is to maximize
expected profits.

       Workers and firms come together through a directed search process (see, e.g., Montgomery
1991, Moen 1997 and Acemoglu and Shimer 1999). In the first stage of the process, each firm
chooses which wage w to oﬀer to a worker who fills its vacancy. Simultaneously, each worker
chooses whether to send a job application at the utility cost k > 0 and, if so, which wage
to seek. In making these decisions, firms and workers take as given the expected ratio q(w)
of applicants to vacancies associated with each wage w. Following Acemoglu and Shimer
(1999), we shall refer to q(w) as the queue length. In the second stage of the process, each
worker seeking the wage w matches with a firm oﬀering the wage w with probability λ(q(w)),
where λ : R+ → [0, 1] is a strictly decreasing function of q with boundary conditions λ(0) = 1
and λ(∞) = 0. Similarly, a firm oﬀering the wage w matches with an applicant seeking the
wage w with probability η(q(w)), where η : R+ → [0, 1] is a strictly increasing and strictly
concave function of q with boundary conditions η(0) = 0 and η(∞) = 1. The functions λ
and η satisfy the aggregate consistency condition λ(q)q = η(q).3 If a firm of type y matches
with a worker, it produces y units of output, it pays the wage w to the worker and it pays
the dividend y − w to the owners. If a firm remains unmatched, it does not produce any
output.

       We assume that the application strategy of a worker is private information–i.e. the
public cannot observe whether a worker sent a job application and, if so, which wage he
sought–while the employment status of a worker is public information–i.e. the public
observes whether a worker is employed and, if so, at which wage. The above informational
assumptions induce a moral hazard problem: the public cannot distinguish a worker who
did not search for a job and a worker who searched for a job unsuccessfully.

   2
      Qualitatively, the main result of the paper would be unchanged if we were to assume that firms are owned
by entrepreneurs rather than workers. That is, if firms were owned by workers, the optimal unemployment
benefit would still be positive and the optimal labor earning tax would still be increasing and regressive.
Diﬀerent points on the utility possibility frontier of workers and entrepreneurs would be attained by lump-
sum transfers from one group of agents to the other.
    3
      All of the matching processes commonly used in the literature satisfy these assumptions on λ and η. For
example, the assumptions are satisfied by the urn-ball matching function λ(q) = (1 − exp(−q))/q, by the
telephone-line matching function λ(q) = 1/(1 + q), and by the constant-elasticity of substitution matching
function λ(q) = (1 + q σ )−1/σ .



                                                      6
2.2    Equilibrium

An allocation is a tuple (w, q, z, S). The first element of the tuple is a function w : [y, y] →
R+ , with w(y) denoting the wage oﬀered by a firm of type y. The second element is a
function q : R+ → R+ , with q(w) denoting the queue length attracted by the wage w. The
third element, z ∈ R, denotes the dividend payment received by each worker. Finally, S ∈ R
denotes the maximized value of sending an application.

   Now, we are in the position to define an equilibrium.

Definition 1: A competitive equilibrium is an allocation (w, q, z, S) that satisfies the follow-
ing conditions:

  (i) Profit maximization: For all y ∈ [y, y],

                                   w(y) ∈ arg max η(q(w))(y − w);
                                              w≥0


 (ii) Optimal number of applications:
                   Z
                      q(w(y))dF (y) ≤ 1 and S ≥ k, with comp. slackness;


(iii) Optimal direction of applications: For all w ∈ R+ ,

                  λ(q(w)) [u(z + w) − u(z)] ≤ S and q(w) ≥ 0, with comp. slackness;


(iv) Consistency of dividends and profits:
                                  Z
                              z = η(q(w(y)))(y − w(y))dF (y).



   The above definition of equilibrium is standard (see, e.g., Moen 1997 and Acemoglu
and Shimer 1999). Condition (i) guarantees that the wage posted by a firm of type y
is profit maximizing. That is, w(y) maximizes the product of the probability of filling a
vacancy, η(q(w)), and the profit from filling a vacancy, y − w. Condition (ii) guarantees
that the measure of applications received by the firms is consistent with workers’ utility
maximization. That is, whenever S is strictly greater than k, all workers find it optimal to
search and, hence, the measure of applications received by firms is equal to one. Whenever

                                                 7
S is equal to k, workers are indiﬀerent between searching and not searching and, hence,
the measure of applications received by the firms can be smaller than one. Condition (iii)
guarantees that the distribution of applications across wages is consistent with workers’
utility maximization. That is, whenever q(w) is strictly positive, the worker’s expected
utility from searching for the wage w, λ(q(w))(u(z + w) − u(z)), is equal to the maximized
value of searching S. Whenever, q(w) is equal to zero, the worker’s expected utility from
searching the wage w may be smaller than S.4 Finally, condition (iv) guarantees that the
dividends received by the workers are equal to the firms’ profits.


2.3       Characterization of the equilibrium allocation

Let p(q) be defined as the ratio between the expected wage bill paid by a firm, η(q)w(q), and
the number of applicants attracted by a firm, q, where w(q) denotes the wage that the firm
needs to oﬀer to attract q applicants. We shall refer to p(q) as the price of an application.
From the equilibrium condition (iii) and the consistency condition η(q) = λ(q)q, it follows
that p(q) is given by
                                              ∙      µ            ¶    ¸
                                                 −1     S
                             p(q|d, S) = λ(q) u             + u(z) − z
                                                       λ(q)                                                (1)
                                       ≡ φ(q, z, S).

The first term on the right-hand side of (1) is the probability that the applicant is hired by
the firm. The second term on the right-hand side of (1) is the wage that the firm has to oﬀer
in order to attract q applicants. It is useful to denote as φ(q, z, S) the right-hand side of (1).

       The price of an application p(q) is the key object to understand the welfare properties
of the laissez-faire equilibrium and the diﬀerence between the equilibrium allocation and
the first and second best allocations. First, notice that p(q) is increasing in q, i.e. p0 (q) =
φq (q, z, S) > 0. This property follows from the fact that workers are risk averse. Given two
jobs that oﬀer the same expected payment, a risk-averse worker strictly prefers applying for
the job that oﬀers a lower wage and that is easier to get. That is, given (w1 , q1 ) and (w2 , q2 )
   4
    As in Moen (1997) and Acemoglu and Shimer (1999), we impose condition (iii) not only for wages that
are posted in equilibrium, but also for wages that are oﬀ the equilibrium path. For equilibrium wages,
condition (iii) guarantees that q is consistent with the worker’s optimal search behavior. For oﬀ-equilibrium
wages, condition (iii) imposes a restriction on the firms’ beliefs about q. The restriction is in the spirit of
subgame perfection: when a firm entertains posting an oﬀ-equilibrium wage, it expects to attract a queue
length that is optimal from the workers’ perspective.


                                                      8
such that q1 < q2 and λ(q1 )w1 = λ(q2 )w2 , a risk-averse worker strictly prefers the safer job
(w1 , q1 ) to the riskier job (w2 , q2 ). This implies that, if a firm wants to attract a longer queue,
it has to oﬀer a higher expected payment to each of its applicants to compensate them for
the additional risk they face. Second, notice that p(q) is increasing in the equilibrium value
of searching S, i.e. φS (q, z, S) > 0. Intuitively, the higher is S the higher is the expected
payment that a firm has to oﬀer to each of its applicants.

       The derivative p0 (q) measures the premium that compensates workers for the extra risk
associated with joining a marginally longer queue. Notice that the marginal risk premium
p0 (q) is increasing in the equilibrium value of searching S, i.e. φqS (q, z, S) > 0. Intuitively,
the higher is S, the larger is the diﬀerence between the consumption of the worker if his
application succeeds and if his application fails. Hence, due to the concavity of u, the worker
requires a higher wage increase in order to be willing to join a marginally longer queue. Also,
notice that the marginal risk premium p0 (q) may be increasing or decreasing in z depending
on the shape of u, i.e. φqz (q, z, S) may be positive or negative. The results in Section 3 are
derived under the assumption that p0 (q) is decreasing in z.5 The other results, including the
two main theorems in Sections 4 and 5, do not require any assumption about the relationship
between p0 (q) and z.

       Now, let qy denote the number of applicants attracted by a firm of type y. From equilib-
rium condition (i) and equation (1), it follows that qy is such that

                                       qy = arg max η(q)y − p(q)q.                                 (2)
                                                 q≥0


For all y ∈ [y, y], qy satisfies the first order condition

                                          η 0 (q)y ≤ p(q) + p0 (q)q                                (3)

and q ≥ 0 with complementary slackness. The term on the left-hand side of (3) is the
productivity of the marginal applicant, which is equal to the product between the increase
in the probability that the firm fills its vacancy, η 0 (q), and the output produced by the firm if
   5
       The assumption is satisfied when the utility function u has the HARA form
                                                        µ          ¶γ
                                                  1−γ      αc
                                         u(c) =                 +β ,
                                                    γ     1−γ

and the parameter γ belongs to the interval [1/2, 1].

                                                        9
it fills its vacancy, y. The right-hand side of (3) is the cost of the marginal applicant, which
is equal to the sum between the price of the marginal applicant, p(q), and the increase in the
price of the infra-marginal applicants, p0 (q)q. In Appendix A, we prove that the left-hand
side is strictly decreasing in q and strictly increasing in y, while the right-hand side is strictly
decreasing in q. Hence, qy is equal to zero for all y ≤ yc and qy is strictly increasing in y
for all y > yc , where the type cutoﬀ yc is such that η 0 (0)yc = p(0). In words, firms of type
y ≤ yc do not enter the labor market, while firms of productivity y > yc enter the market
and attract a queue of applicants that is strictly increasing in y.

   Next, let cy denote the consumption of a worker employed at a firm of type y ≥ yc . From
equilibrium condition (iii), it follows that cy is given by
                                             µ              ¶
                                          −1     S
                                    cy = u            + u(z) .                                  (4)
                                               λ(qy )

Since qy is strictly increasing in y, equation (4) implies that the consumption of an employed
worker, cy , is increasing in the productivity of his employer, y. Also, since S ≥ k and k > 0,
equation (4) implies that the consumption of an employed worker, cy , is strictly greater than
the consumption of an unemployed worker, z.

   Next, we characterize the consumption z of an unemployed worker. From equilibrium
condition (iv) and equation (4), it follows that z is such that
                       Z                       Z
                          η(qy )ydF (y) = z + η(qy )(cy − z)dF (y).                             (5)

Equation (5) states that the consumption of the unemployed is such that aggregate output–
which is the term on the left-hand side of (5)–is equal to aggregate consumption–which is
the term on the right-hand side of (5).

   Finally, the equilibrium condition (ii) states that the value of searching S is such that
the number of applications received by firms is equal to the number of applications sent out
by workers. That is, S is such that
                                        Z
                                            q(y)dF (y) ≤ 1                                      (6)

and S ≥ k with complementary slackness.


                                                10
       Overall, any equilibrium can be represented as a tuple (q, c, z, S) that satisfies the system
of equations (3)—(6). Notice that the equilibrium does not attain the first-best allocation–i.e.
the allocation that maximizes the workers’ expected utility given the production technology
F (y) and the matching technology λ(q). In fact, in the first best allocation, the marginal
productivity of applicants is equalized across firms so as to maximize aggregate output,
and the marginal utility of consumption is equalized across workers so as to maximize the
workers’ expected utility given aggregate output. In contrast, in the equilibrium allocation,
the marginal productivity of applicants is diﬀerent for diﬀerent types of firms. In particular,
the marginal productivity of applicants at low-y firms is lower than the marginal productivity
of applicants at high-y firms. Moreover, in the equilibrium allocation, the marginal utility
of consumption is diﬀerent across workers in diﬀerent employment states. In particular,
the marginal utility of unemployed workers is higher than the marginal utility of employed
workers, and the marginal utilities of workers employed at low-y firms is higher than the
marginal utility of workers employed at high-y firms.

       There are two reasons why the equilibrium allocation diﬀers from the first-best allocation:
the fact that workers and firms trade labor rather than job applications and the fact that
workers are risk averse rather than risk neutral. To see this, suppose that workers and
firms could trade job applications at some competitive price p. If that was the case, every
worker would sell his application, enjoy a consumption of z + p, and have a marginal utility
of u0 (z + p). Moreover, every firm would purchase applications up to the point where the
marginal productivity η 0 (q)y is equal to p. Hence, the equilibrium would implement the
first-best allocation. However, firms and workers cannot trade job application because firm
cannot observe workers who search unsuccessfully for their vacancies (and even if they did,
they would have no incentive to truthfully report that). Instead, firms and workers can only
trade successful applications. That is, they can only trade labor.

       When workers and firms trade labor, workers face some consumption risk because their
search is rewarded only when it is successful. If workers are risk neutral, this “search risk”
does not matter. In this case, a market for labor is equivalent to a market for applications
and its equilibrium attains the first best.6 If workers are risk averse, the existence of search
   6
    In Montgomery (1991), Moen (1997), Burdett Shi and Wright (2001) and Menzio and Shi (2011), workers
and firms trade labor. These papers find that the equilibrium attains the first best allocation only because


                                                    11
risk implies that the marginal utility of consumption is not equalized among workers who are
in diﬀerent employment states. Moreover, the existence of search risk implies that workers
demand a premium in order to seek jobs that attract longer queues of applicants. Hence,
p0 (q) > 0 and the marginal productivity of applicants is not equalized across diﬀerent types
of firms. Overall, under risk aversion, the equilibrium in a market where firms and workers
trade labor does not attain the first best.



3     Constrained eﬃcient allocation
In the previous section, we established that the laissez-faire equilibrium cannot implement
the first best allocation. In this section, we ask whether the equilibrium can implement the
second best allocation, i.e. the allocation that maximizes the worker’s expected utility given
the production technology F (y), the matching technology λ(q), and given that workers have
private information about their application strategy. To answer this question, we set up
the mechanism design problem, we solve it and we compare the solution to the equilibrium
allocation. We find that, unless the search cost k is too high, the equilibrium does not
implement the second best. This is because workers face a search risk which is not insured
at all in the equilibrium, while it is partially insured in the second best.


3.1     Formulation of the mechanism design problem

The problem facing the mechanism designer is to maximize the workers’ expected utility by
choosing the search strategy that workers should follow and the consumption that workers
should receive conditional on the outcome of their search. The search strategy chosen by
the mechanism designer is subject to an incentive compatibility constraint, because the
mechanism does not know whether a worker applies for a job and, if so, where he applies for
a job. The consumption profile chosen by the mechanism designer is subject to a resource
constraint, because the amount of resources assigned to workers cannot exceed the amount
of resources produced by firms. Moreover, we restrict the mechanism designer to choose a
symmetric mechanism, i.e. a mechanism that recommend the same search strategy to all
workers are assumed to be risk neutral.




                                               12
workers.7

    More specifically, a symmetric mechanism is a tuple (π, c, d, S). The first element of the
tuple is a diﬀerentiable function π : [y, y] → R+ , where π(y) denotes the probability with
which a worker should apply to a firm of type ỹ ≤ y. The second element of the tuple
is a function c : [y, y] → R+ , where c(y) denotes the consumption assigned to a worker
who is employed by a firm of type y. The third element of the tuple, z ∈ R+ , denotes the
consumption assigned to a worker who is unemployed. Finally, S ∈ R+ , denotes the worker’s
maximized value of sending an application. Notice that π(y) uniquely determines the queue
of applicants q(y) at firms of type y, q(y) = π 0 (y)/F 0 (y), as well as the measure of workers a
who apply for jobs, a = π(y). Hence, we will think of the mechanism as a tuple (a, q, c, z, S)
rather than a tuple (π, c, d, S).

    The mechanism designer chooses (a, q, c, z, S) so as to maximize the workers’ expected
utility            Z
                       [λ(qy )u(cy ) + (1 − λ(qy )) u(z) − k] qy dF (y) + (1 − a)u(z).                    (7)

There are qy dF (y) workers applying to firms of type y. Each one of these workers has a
probability λ(qy ) of becoming employed and consuming cy units of output, and a probability
1 − λ(qy ) of remaining unemployed and consuming z units of output. In either case, the
worker incurs the disutility cost k. There are also 1 − a workers who do not apply for jobs.
Each one of these workers consumes z units of output.

    The mechanism designer’s choice of (a, q, c, d, S) must be technologically feasible. First,
the mechanism must be such that the aggregate output produced by the firms is greater
than the aggregate consumption enjoyed by the workers. That is,
           Z                 Z
              η(qy )ydF (y) − [λ(qy )cy + (1 − λ(qy ))z] qy dF (y) − (1 − a)z ≥ 0.                        (8)

Second, the mechanism must be such that the measure of workers applying for jobs is smaller
   7
     The restriction to symmetric mechanisms is quite natural. In fact, the literature on the game theoretic
foundation of directed search argues that search frictions emerge precisely when workers follow symmetric
strategies. In particular, when all workers apply to diﬀerent firms with the same probability, some firms will
end up with too many applicants and some firms will end up with not enough applicants (see, e.g., Burdett,
Shi and Wright 2001, Shimer 2005 and Galenianos and Kircher 2012).




                                                     13
than one and it is equal to the measure of applications received by the firms. That is,

                                                1 − a ≥ 0,                                    (9)
                                          Z
                                     a−       qy dF (y) = 0.                                 (10)


   The mechanism designer’s choice of (a, q, c, d, S) must be compatible with the workers’
incentives to follow the recommended mixed application strategy. Hence, a worker must be
indiﬀerent between taking any one of the actions to which the mechanism assigns positive
probability, and he must prefer taking any one of these actions rather than an action to
which the mechanism assigns zero probability. This implies that, if y is such that qy > 0, the
worker’s expected utility from searching for a firm of type y must be equal to the maximized
value of searching and must be greater than the value of not searching. That is,

                                λ(qy ) [u(cy ) − u(z)] − S = 0,                              (11)

                                                     S − k ≥ 0.                              (12)

Instead, if y is such that qy = 0, the worker’s expected utility from searching for a firm of type
y must be smaller than the maximized value of searching. That is, λ(qy ) [u(cy ) − u(z)] ≤ S.
Moreover, if a < 1, the worker’s expected utility from not searching must be equal to the
maximized value of searching. That is,

                                      (1 − a)(S − k) = 0.                                    (13)


   Before characterizing the solution to the above mechanism design problem, some com-
ments are in order. The mechanism asks workers to randomize over diﬀerent application
strategies. Then the mechanism assigns consumption to workers conditional on the outcome
of their application (i.e. whether they are employed or unemployed and at which firm they
are employed). The mechanism cannot condition consumption on the workers’ application
strategy (i.e. whether and where the workers apply for a job) because this strategy is their
private information. However, if workers were allowed to make a report about the outcome of
their randomization, the mechanism could condition consumption not only on the workers’
employment status, but also on the workers’ reported search strategy. In Appendix B, we
consider this alternative version of the mechanism design problem. We find that the solution

                                                14
of the mechanism design problem with workers’ reports is the same as the solution of the
problem without reports. Intuitively, the mechanism cannot exploit the reports because the
outcome of the randomization is the workers’ private information.


3.2       Solution to the mechanism design problem

Let (a∗ , q∗ , c∗ , d∗ , S ∗ ) denote the solution to the mechanism design problem. Also, let μ∗1
denote the multiplier associated with the aggregate resource constraint on output (8) and
let μ∗2 denote the multiplier associated with the aggregate resource constraint on applications
(9). We shall refer to the solution to the mechanism design problem as either the constrained
eﬃcient allocation or the second best allocation.

      The constrained eﬃcient value of searching is8

                                                   S ∗ = k.                                     (14)

To understand this result recall that S is the reward that a worker expects to obtain when
sending a job application. For any S < k, a worker would have no incentive to apply for
a job and, hence, production and consumption would be zero. For any S ≥ k, the worker
has the incentive to apply for a job. However, since the worker is rewarded for sending an
application only if his application is successful, the higher is S the greater the consumption
risk that he faces. Hence, the constrained eﬃcient value of S is k.

      The constrained eﬃcient queue length is such that
                                                     ∙ ∗                            ¸
              0 ∗          ∗    ∗    ∗     ∗ 0 ∗
                                                      u(cy ) − u(z ∗ )     ∗     ∗      μ∗2
             η (qy )y − λ(qy )(cy − z ) + qy λ (qy )                   − (cy − z   )  =     ,   (15)
                                                          u0 (c∗y )                     μ∗1

and qy∗ ≥ 0, with complementary slackness. The left-hand side of (15) is the diﬀerence
between the value of making the worker apply to a firm of type y and the value of making
the worker not search. The first term on the left-hand side of (15) is the output produced by
the worker if he applies to a firm of type y. The second term is the negative of the amount of
output that needs to be assigned to the worker in order to compensate him for the disutility
of searching. The last term is the negative of the amount of output that needs to be assigned
to the other workers who apply to type-y firms in order to compensate them for the decline
  8
      Appendix C contains the explicit derivation of the optimality conditions (14)-(18).

                                                      15
in the probability of being hired that is caused by the marginal applicant. The right-hand
side of (15) is the maximum diﬀerence between the value of making a worker apply for a job
and the value of not making her search. That is, the right-hand side of (15) is the net value
of an application. Overall, (15) implies that the constrained eﬃcient queue length is such
that the net value of the marginal application is equalized across diﬀerent types of firms.

   The constrained eﬃcient allocation of consumption is
                                      µ                ¶
                          ∗        −1      k         ∗
                         cy = u                 + u(z ) ,                                  (16)
                                        λ(qy∗ )
                                 Z
                          ∗
                                           £     ¡       ¢¤
                         z =        η(qy∗ ) y − c∗y − z ∗ dF (y).                          (17)

The consumption assigned to employed workers, c∗y , is such that an applicant is indiﬀerent
between searching for a firm of type y and not searching at all. The consumption assigned
to unemployed workers is such that aggregate output equals aggregate consumption.

   Finally, the value of an application μ∗2 /μ∗1 is such that
                                       Z
                                           qy∗ dF (y) ≤ 1                                  (18)

and μ∗2 /μ∗1 ≥ 0, with complementary slackness. If the constrained eﬃcient allocation is such
that some workers apply for jobs and some do not, then the value of an application is zero.
Conversely, if the value of an application is strictly positive, then the constrained eﬃcient
allocation is such that all workers apply for jobs.

   In order to understand the relationship between the constrained eﬃcient allocation and
the equilibrium allocation, it is useful to notice that the optimality condition for qy∗ can be
written as
                                 η 0 (qy∗ )y = p∗ (qy∗ ) + p∗0 (qy∗ )qy∗ ,                 (19)

where
                                                                  μ∗2
                                   p∗ (q) = φ(q, z ∗ , k) +           .                    (20)
                                                                  μ∗1
That is, the constrained eﬃcient queue length qy∗ is the same queue length that a profit-
maximizing firm would choose if the price of an application was p∗ (q), where p∗ (q) is the
sum of two components. The first component, φ(q, z ∗ , k), is the amount of output that com-
pensates a worker for the disutility of sending an application. The second component, μ∗2 /μ∗1 ,

                                                   16
is the value of an application to society (net of the disutility of sending the application). In
contrast, the equilibrium queue length qy maximizes the profits of the firm given that the
price of an application is p(q) = φ(q, z, S).

   From the previous observation, it follows that the constrained eﬃcient allocation can be
decentralized as an equilibrium when μ∗2 /μ∗1 = 0, but not when μ∗2 /μ∗1 > 0. In fact, when
μ∗2 /μ∗1 = 0, qy∗ satisfies the optimality condition (19), which is the same as the equilibrium
condition (3); c∗y satisfies the optimality condition (16), which is the same as the equilibrium
condition (4); z ∗ satisfies the optimality condition (17), which is the same as the equilibrium
condition (5); and S ∗ = k satisfies the equilibrium condition (6). In contrast, when μ∗2 /μ∗1 >
0, the constrained eﬃcient allocation cannot be decentralized as an equilibrium because the
optimality condition (19) is diﬀerent from the equilibrium condition (3).

   The following proposition summarizes the above findings and establishes conditions under
which the value of an application to society, μ∗2 /μ∗1 , is equal to zero and conditions under
which μ∗2 /μ∗1 is strictly positive.

Proposition 1 (Welfare Properties of Equilibrium): Let (a∗ , q ∗ , c∗ , z ∗ , S ∗ ) denote the so-
lution to the mechanism design problem and let (μ∗1 , μ∗2 ) the multipliers associated with the
aggregate resource constraints (8) and (9). (i) If μ∗2 /μ∗1 = 0, then (q ∗ , c∗ , z ∗ , S ∗ ) is an equi-
librium. (ii) If μ∗2 /μ∗1 > 0, then (q ∗ , c∗ , z ∗ , S ∗ ) is not an equilibrium. (iii) There exist k and
k, with 0 < k ≤ k < ∞, such that μ∗2 /μ∗1 = 0 for all k > k and μ∗2 /μ∗1 > 0 for all k < k.

Proof : See Appendix D.

   There is a simple intuition behind the results stated in Proposition 1. The mechanism
designer sets the workers’ reward to searching, S ∗ , equal to the disutility of searching, k.
Since workers are rewarded for their search only when their search is successful, setting S ∗ = k
minimizes the workers’ consumption risk subject to satisfying their incentive compatibility
constraint. The mechanism designer redistributes the additional value of a worker’s search,
μ∗2 /μ∗1 , among all workers, independently of whether their search is successful or not. Hence,
μ∗2 /μ∗1 is a measure of the extent of insurance implicitly provided by the optimal mechanism.
Since workers are not provided with any insurance in the decentralized economy, it is clear
that the equilibrium can attain the constrained eﬃcient allocation only if μ∗2 /μ∗1 = 0, and


                                                   17
it is constrained ineﬃcient whenever μ∗2 /μ∗1 > 0. Moreover, as one would expect, μ∗2 /μ∗1 is
strictly positive when the amount of consumption risk required to induce workers to search
is not too large. Hence, μ∗2 /μ∗1 is strictly positive when k is not too large.


3.3    Comparing equilibrium and second best allocations

Now, we want to examine how the constrained ineﬃciency of the equilibrium manifests itself
in terms of allocations of inputs and output. To this aim, we compare the equilibrium
and the second best in terms of the number of applicants assigned to firms of type y, qy
and qy∗ , in terms of the consumption assigned to unemployed workers, z and z ∗ , and in
terms of the consumption assigned to workers employed by firms that attract q applicants,
c(q) = u−1 (S/λ(q) + u(z)) and c∗ (q) = u−1 (k/λ(q) + u(z ∗ )). We carry out the comparison
under the assumption that μ∗2 /μ∗1 > 0 and S > k. The first assumption guarantees that the
equilibrium is constrained ineﬃcient. The second assumption guarantees that all workers find
it optimal to search in equilibrium. We make this assumption for expositional convenience.

   The following proposition presents the result of the comparison between equilibrium and
second best allocations.

Proposition 2 (Equilibrium and Second Best Allocations): Let (q∗ , c∗ , z ∗ , S ∗ ) be the solu-
tion to the mechanism design problem with μ∗2 /μ∗1 > 0, and let (q, c, z, S) be a competitive
equilibrium with S > k. (i) There exists a y0 ∈ (yc , y) such that q(y0 ) = q∗ (y0 ), q(y) > q ∗ (y)
for all y ∈ (yc , y0 ), and q(y) < q∗ (y) for all y ∈ (y0 , y). (ii) There exists a q0 ∈ (0, ∞) such
that c(q0 ) = c∗ (q0 ), c(q) < c∗ (q) for all q ∈ (0, q0 ), and c(q) > c∗ (q) for all q ∈ (q0 , ∞).
Moreover, z < z ∗ .

Proof : See Appendix E.

   Proposition 2 shows that the constrained ineﬃciency of the equilibrium manifests itself
in terms of both the allocation of inputs (part i) and the allocation of output (part ii). More
specifically, part (i) of Proposition 2 shows that, in equilibrium, the number of applicants
assigned to low-y firms is higher than in the second best, while the number of applicants
assigned to high-y firms is lower that in the second best. Part (ii) of Proposition 2 shows
that the consumption assigned to unemployed workers is lower in the equilibrium than in the


                                                18
second best. Moreover, in the equilibrium, the consumption assigned to workers employed
at low-q firms is lower than in the second best, while the consumption assigned to workers
employed at high-q firms is higher than in the second best.

   The results in Proposition 2 are intuitive. In equilibrium, workers face too much con-
sumption risk when applying for a job and, consequently, firms have to pay an excessive
risk premium in order to attract applicants to their vacancies. Moreover, the excess con-
sumption risk faced by a worker when applying for a job is higher the higher the number of
workers who seek the same job. Consequently, the excess risk premium that a firm has to
pay is increasing in the number of applicants that the firm wants to attract. Formally, the
excess risk premium is given by the diﬀerence between p(q) − p(0) and p∗ (q) − p∗ (0), and
the derivative of the excess risk premium with respect to q is given by p0 (q) − p∗0 (q), which
is equal to φq (q, z, S) − φq (q, z ∗ , k). The derivative of the excess risk premium is strictly
positive because–as discussed in Section 2–φq (q, z, S) is decreasing in z and increasing in
S and–as discussed above–z < z ∗ and S > k. Since the excess risk premium is increasing
in q, high-y firms choose to attract fewer applicants than in the second best and, through
general equilibrium eﬀects, low-y firms end up attracting more applicants than in the second
best. Moreover, the fact that the excess risk premium is increasing in q also implies that
the consumption of workers employed by high-q firms is higher than in the second best and,
again through general equilibrium eﬀects, the consumption of workers employed by low-q
firms is lower than in the second best.

    Proposition 2 has some important implications for aggregate variables. First, the propo-
                                                              R
sition implies that aggregate output in the equilibrium, Y = η(qy )ydF (y), is lower that
                                           R
aggregate output in the second best, Y ∗ = η(qy∗ )ydF (y). To see why this is the case, it is
suﬃcient to notice that
                Y −Y∗
                Z y0 h                  i            Z        hR ∗                  i
                      R qy        0
                                                         y
                                                                qy
            =              qy∗
                                 η (q)ydy dF (y) −                   qy
                                                                          η 0 (q)ydy dF (y)
                    y                                    y0                                                (21)
                Z                                            Z
                    y0                £        ¤                 y                 £        ¤
            <            η 0 (qy∗0 )y0 qy − qy∗ dF (y) −              η 0 (qy∗0 )y0 qy∗ − qy dF (y) = 0,
                    y                                            y0


where the second line uses the fact that qy > qy∗ for y < y0 and qy < qy∗ for y < y0 , the
inequality in the third line uses the fact that η 0 (qy )y < η 0 (qy∗ )y < η 0 (qy∗0 )y0 for y < y0

                                                     19
and η 0 (qy )y > η 0 (qy∗ )y > η 0 (qy∗0 )y0 for y > y0 , and the last equality uses the fact that
qy dF (y) and qy∗ dF (y) both integrate up to one. Intuitively, aggregate output is lower in the
equilibrium that in the second best because, in the second best, the marginal productivity of
an application is higher at firms with a higher y and, in equilibrium, there are more workers
applying to low-y firms and fewer workers applying to high-y firms than in the second best.

   Similarly, Proposition 2 implies that aggregate unemployment in the equilibrium, U =
    R                                                         R
1 − η(qy )dF (y), is higher than in the second best, U ∗ = 1 − η(qy∗ )dF (y). To see this,
notice that
                     U − U∗
                     Z y h                 i            Z         hR               i
                          R qy∗       0
                                                             y0
                                                                     qy       0
                =               qy
                                     η (q)dy dF (y) −                  qy∗
                                                                             η (q)dy dF (y)
                         y0                                  y                                            (22)
                     Z                                       Z
                         y              £        ¤                y0             £        ¤
                <             η 0 (qy0 ) qy∗ − qy dF (y) −             η 0 (qy0 ) qy − qy∗ dF (y) = 0,
                         y0                                       y


where the second line in (22) uses the fact that qy∗ > qy for y > y0 and qy > qy∗ for y < y0 , and
the third line uses the fact that η 0 (qy∗ ) < η 0 (qy ) < η 0 (qy0 ) for y > y0 and η 0 (qy∗ )y > η 0 (qy )y >
η 0 (qy0 )y0 for y < y0 . Intuitively, unemployment is lower in equilibrium than in the second
best because, in equilibrium, applicants are more evenly distributed across diﬀerent types of
firms and the vacancy filling probability, η(q), is a concave function of applicants.



4     Policy implementation
In this section, we prove that the constrained eﬃcient allocation can be implemented as an
equilibrium by introducing a positive unemployment benefit and a positive, increasing and
regressive tax on labor income.


4.1     Environment and equilibrium

A policy is a couple (Bu , Te ). The first element of the couple, Bu ∈ R+ , denotes the benefit
paid by the policy maker to an unemployed worker. The second element of the couple is a
function Te : R+ → R+ with Te (w) denoting the tax paid to the policy maker by a worker
employed at the wage w. We are now in the position to define an equilibrium.



                                                        20
Definition 2: A competitive equilibrium with policy (Bu , Te ) is an allocation (w, q, z, S) that
satisfies the following conditions:

  (i) Profit maximization: For all y ∈ [y, y],

                                    w(y) ∈ arg max η(q(w))(y − w);
                                                  w≥0


 (ii) Optimal number of applications:
                   Z
                      q(w(y))dF (y) ≤ 1 and S ≥ k, with comp. slackness;


(iii) Optimal direction of applications: For all w ∈ R+ ,

        λ(q(w)) [u(z + w + Te (w)) − u(z + Bu )] ≤ S and q(w) ≥ 0, with comp. slackness;


 (iv) Consistency of dividends and profits:
                                   Z
                               z = η(q(w(y))) [y − w(y)] dF (y);


 (v) Balanced budget:                 Z
                             Bu =         η(q(w(y))) [Te (w(y)) + Bu ] dF (y).

   The first four conditions in Definition 2 are nearly identical to those in Definition 1. The
only diﬀerence is that, here, the consumption of an unemployed worker is given by the sum of
dividends, z, and unemployment benefits, Bu , and the consumption of an employed worker
is given by the sum of dividends, z, and after-tax wages, w − Te (w). The fifth condition in
Definition 2 guarantees that the budget of the policy-maker is balanced given the optimal
behavior of firms and workers. We shall denote with q̂y the number of applicants attracted
by a firm of type y and with ŵ(q) the wage that a firm needs to oﬀer in order to attract q
applicants.


4.2    Optimal policy

The following theorem states the main result of our paper.

Theorem 1 (Optimal Policy): The constrained eﬃcient allocation can be implemented as
a competitive equilibrium with policy (Bu∗ , Te∗ ). The optimal unemployment benefit Bu∗ is

                                                   21
positive. Specifically, Bu∗ = μ∗2 /μ∗1 . The optimal tax on labor income Te∗ is positive, increasing
and regressive. Specifically, for w ≤ yc∗ Te∗ (w) = 0, and for w > yc∗ Te∗ (w) is such that
                                     ∙                                   ¸−1
                                                        k
                         Te∗0 (w)   = Bu∗ +                                    Bu∗ .                (23)
                                              u (z − Bu + w − Te∗ (w))
                                               0  ∗   ∗




Proof : See Appendix F.

       There is a simple intuition behind Theorem 1. The constrained eﬃcient allocation of
consumption, (c∗y , z ∗ ), is such that the workers’ expected benefit from applying to a job, S ∗ ,
is equal to the cost of applying to a job, k. The constrained eﬃcient allocation of applicants,
qy∗ , is the same the would be chosen by profit-maximizing firms if the price of an application
was p∗ (q) = φ(q, z ∗ , k)+μ∗2 /μ∗1 , where the first component of the price is the cost of providing
applicants with the expected reward k and the second component of the price is the value of
an application to society (net of the disutility cost k). The optimal unemployment benefit
Bu∗ makes sure that–in equilibrium–the workers’ benefit from applying to a job is k. The
unemployment benefit achieves this goal by redistributing consumption from successful to
unsuccessful applicants. The optimal labor tax Te∗ makes sure that–in equilibrium–firms
face the application price p∗ (q). The labor tax attains this goal by raising the price of an
application beyond the cost of providing applicants with the expected benefit k. As we shall
explain below, the labor tax is regressive because of two properties of the optimum: (a)
redistribution only takes place between workers who apply to the same type of firms, and
(b) workers are ex-ante indiﬀerent between applying to diﬀerent types of firms.9

       It is useful to flash out the above intuition. Given the policy (Bu , Te ), the equilibrium
queue of applicants, q̂y , is such that

                                      q̂y = arg max η(q)y − p̂(q)q,                                 (24)
                                                  q

   9
    Theorem 1 proves that the constrained eﬃcient allocation can be implemented using an unemployment
benefit and a labor income tax. While these policies are quite natural in the context of our model, they
are not the only ones that a policy maker could use to implement the constrained eﬃcient allocation. For
example, a policy maker could use a labor income tax and a “consumption subsidy” that is paid to a worker
independently of his employment status. Alternatively, a policy maker could use an unemployment benefit
and a “vacancy tax” that varies according to the wage oﬀered by the firm and that is paid by the firm
independently of whether or not it fills its vacancy.



                                                      22
where the price of an application p̂(q) is

                                           p̂(q) = λ(q)ŵ(q),

and
                          T (q) = Te (ŵ(q)),
                                       µ                  ¶
                                   −1     S
                          ŵ(q) = u           + u(z + Bu ) − z + T (q).
                                         λ(q)
In words, the equilibrium queue of applicants, q̂y , maximizes the profits of the firm given that
the price of an application, p̂(q), is the product between the probability that the application
is successful, λ(q), and the gross wage that the firm needs to oﬀer in order to attract q
applications, ŵ(q).

   The equilibrium queue of applicants, q̂y , is equal to the constrained eﬃcient queue of
applicants, qy∗ , if and only if the the equilibrium price of an application p̂(q) is equal to p∗ (q).
Notice that p̂(q) can be written as φ(q, z+Bu , S)+λ(q)(Bu +T (q)), while p∗ (q) can be written
as φ(q, z ∗ , S ∗ ) + μ∗2 /μ∗1 . Hence, the equilibrium queue length is equal to the constrained
eﬃcient queue length if and only if z + Bu = z ∗ , S = S ∗ and λ(q)(Bu + T (q)) = μ∗2 /μ∗1 .
These are necessary conditions for the equilibrium to implement the constrained eﬃcient
allocation.

   Now, we can use the above necessary conditions to derive the optimal unemployment
benefit. In fact, notice that
                                       Z
                             Bu    =    η(q̂y ) [Te (ŵ(q̂y )) + Bu ] dF (y)
                                        Z                                                        (25)
                                    μ∗2                      μ∗
                                   = ∗ qy∗ dF (y) = 2∗ ,
                                    μ1                       μ1

where the first equality follows from the equilibrium condition (v), the second equality follows
from the necessary condition λ(q)(Bu + T (q)) = μ∗2 /μ∗1 and the consistency condition η(q) =
λ(q)/q, and the last equality follows from the fact that μ∗2 /μ∗1 and qy∗ satisfy condition (18).
The optimal unemployment benefit is equal to the ratio of multipliers μ∗2 /μ∗1 . This finding is
easy to understand. In the constrained eﬃcient allocation, the value of an application to a
worker is k, but the value of an application to society exceeds k by μ∗2 /μ∗1 . This excess value
is redistributed to all the workers independently of whether their application is successful
or not. The optimal unemployment benefit carries out this redistribution in equilibrium.

                                                  23
Unemployed workers receive μ∗2 /μ∗1 directly in the form of an unemployment benefit, while
employed workers receive μ∗2 /μ∗1 indirectly in the form of the wage premium that compensates
them for the loss of the unemployment benefit. Hence, it is the optimal unemployment benefit
that guarantees that the equilibrium value of an application to a worker is k.

       Next, we can use the necessary conditions for the constrained eﬃciency of the equilibrium
in order to derive the optimal labor income tax. In fact, notice that λ(q)(Bu +T (q)) = μ∗2 /μ∗1
implies
                                                      1 μ∗2
                                     Te (w(q)) =             − Bu
                                                    λ(q) μ∗1
                                                    µ          ¶                                        (26)
                                                       1
                                                  =         − 1 Bu ,
                                                      λ(q)
where the second equality uses the fact that Bu = μ∗2 /μ∗1 . Equation (26) implies that the
optimal labor tax is such that the taxes paid by the workers who successfully apply to a
given type of firm are equal to the unemployment benefits paid to the workers who apply
unsuccessfully to the same type of firms, i.e. λ(q)T (q) = (1 − λ(q))Bu . This property
implies that the optimal policy involves redistribution between workers who apply to the
same type of firm, but not across workers who apply to diﬀerent types of firms. In turn,
this implies that the diﬀerence in the amount of labor taxes paid by workers employed at
diﬀerent wages does not serve a redistributive purpose. Rather, diﬀerences in labor taxes are
necessary to make sure that the equilibrium price of an application, p̂(q), reflects the social
cost of an application, p∗ (q). In this sense, labor taxes are Pigovian. The fact that there is no
redistribution across workers employed at diﬀerent wages should not be surprising because–
in a directed search environment–wage diﬀerences do not reflect luck, but compensation for
diﬀerent job-finding probabilities.10

       In order to understand the shape of the optimal labor tax, we diﬀerentiate (26) with
respect to q and we obtain

                    Te0 (ŵ(q)) = T 0 (q)/ŵ0 (q)
                                  ∙                                        ¸−1                          (27)
                                                        k
                                = Bu + 0 ∗                                     Bu ,
                                           u (z − Bu + ŵ(q) − Te (ŵ(q)))

where the second line makes use of the equilibrium condition (iii). The marginal tax on labor
  10
     In a basic random search environment (e.g. Pissarides 1985 or Mortensen and Pissarides 1994), diﬀerences
in labor income among employed workers are only due to luck and, hence, they should be fully redistributed
away.

                                                     24
earnings is positive because both the numerator and the denominator in (27) are positive.
The marginal tax on labor earnings is smaller than one because the numerator in (27) is
smaller than the denominator. And the marginal tax is decreasing in labor earnings because
the after-tax wage ŵ − Te (ŵ) is increasing in w. Hence, the optimal tax on labor income is
regressive.

    The regressivity of the optimal labor income tax is a startlingly sharp result. It does not
depend on the shape of the workers’ utility function, u(c), on the shape of the distribution
of firms’ productivity, F (y), or on the shape of the matching function, λ(q). Rather, the
regressivity of the labor income tax follows directly from two properties of the equilibrium
with optimal policy: (a) redistribution only takes place between workers applying to the
same type of firm and (b) workers are ex-ante indiﬀerent between applying to diﬀerent types
of firms. In fact, these two properties are
                                      µ         ¶
                                         1
                          Te (w(q)) =        − 1 Bu ,
                                        λ(q)
                                                                  k
                        u(z + w(q) − Te (w(q))) − u(z + Bu ) =        ,
                                                                 λ(q)

and, together, they imply
                               ∙                                 ¸
                               u(z + w − Te (w)) − u(z + Bu )
                      Te (w) =                                − 1 Bu .                    (28)
                                             k

The functional equation (28) can only be satisfied by a regressive labor income tax. Under
any progressive tax, the left-hand side of (28) would be a convex function of w, while the
right-hand side of (28) would be a concave function of w.



5     Insurance market implementation
In this section, we prove that the constrained eﬃcient allocation could be decentralized
as a laissez-faire equilibrium if there was a competitive insurance market where workers
could purchase insurance against the search risk. The result implies that the constrained
ineﬃciency of the economy analyzed in Section 2 is caused by the absence of this insurance
market. Similarly, the result implies that the optimal unemployment benefit and the optimal
labor income tax derived in Section 4 serve the purpose of substituting the missing insurance
market.

                                              25
5.1    Environment and equilibrium

We consider an economy with an insurance market operating alongside the labor market. The
insurance market is populated by a continuum of insurance companies. We assume that each
insurance company oﬀers contracts of the type (w, bu , te ), where w ∈ R+ denotes the wage
that the insurance company asks the worker to seek, bu ∈ R+ denotes the payment that the
insurance company makes to the worker if his search is unsuccessful, and te ∈ R+ denotes
the payment that the worker makes to the insurance company if his search is successful.
Without loss in generality, we assume that each insurance company only oﬀers contracts
(w, bu , te ) that satisfy the worker’s participation constraint–in the sense that the terms
of the contract induce the worker to participate–and that satisfy the worker’s incentive
compatibility constraint–in the sense that the terms of the contract induce the worker to
seek the prescribed wage. Each insurance company chooses which contracts to oﬀer taking
as given the equilibrium queue length q(w). The labor market is populated by firms and
workers and operates as in Section 2. Each firm chooses which wage to oﬀer and each worker
chooses which wage to seek taking as given the equilibrium queue length, q(w), and the
equilibrium insurance contracts, (bu (w), te (w)).

   Now, we are in the position to define a competitive equilibrium.

Definition 3: A competitive equilibrium is an allocation (w, q, bu , te , z, U) that satisfies the
following conditions:

  (i) Firm’s profit maximization: For all y ∈ [y, y],

                                    w(y) ∈ arg max η(q(w))(y − w);
                                                 w≥0


 (ii) Insurance company’s profit maximization: For all w ∈ R+ ,

              (bu (e), te (e)) ∈ arg max(bu ,te ) λ(q(w))te − (1 − λ(q(w)))bu , s.t.
                              λ(q(w))u(z + w − te ) + (1 − λ(q(w)))u(z + bu ) − k ≥ U ,
                              λ(q(w)) [u(z + w − te ) − u(z + bu )] ≥ k;

(iii) Zero profits in the insurance market: For all w ∈ R+ ,

                                λ(q(w))te (w) − (1 − λ(q(w))bu (w) = 0


                                                 26
         and q(w) ≥ 0, with complementary slackness;

 (iv) Optimal number of applications:
                  Z
                    q(w(y))dF (y) ≤ 1 and U ≥ u(z), with comp. slackness;


 (v) Optimal direction of applications: For all w ∈ R+ ,

                    λ(q(w))u(z + w + te (w)) + (1 − λ(q(w)))u(z + tu (w)) − k ≤ U

         and q(w) ≥ 0, with complementary slackness;

 (vi) Consistency of dividends and profits:
                                   Z
                               z = η(q(w(y))) [y − w(y)] dF (y).


       Condition (i) guarantees that the wage w(y) maximizes the profit of a firm of type y.
Condition (ii) guarantees that (w, bu (w), te (w)) is the feasible contract that maximizes the
profits of an insurance company. To see why this is the case, notice that a contract (w, bu , te )
satisfies the worker’s participation constraint if λ(q(w))u(z + w − te ) + (1 − λ(q(w)))u(z +
bu ) − k ≥ U . A contract (w, bu , te ) satisfies the worker’s incentive compatibility constraint
if λ(q(w))[u(z + w − te ) − u(z + bu )] ≥ k. And, if the contract (w, tu , te ) is feasible, the
insurance company obtains a profit of λ(q(w))te −(1−λ(q(w)))bu . Condition (iii) guarantees
that competition in the insurance market drives the profits generated by the equilibrium
contract (bu (w), te (w)) down to zero. Conditions (iv) and (v) guarantee that the measure of
applications received by firms oﬀering diﬀerent wages is consistent with the workers’ utility
maximization. Finally, condition (vi) guarantees that the dividends received by the workers
are equal to the profits of the firms. As in Sections 2 and 4, we denote with qy the number
of applicants attracted by a firm of type y, and with w(q) the wage that a firm needs to oﬀer
in order to attract q applicants.


5.2       Constrained eﬃciency of equilibrium

The following theorem is the second major result of our paper.11
  11
    The proof of the theorem is sketched in the following pages. The complete proof is available upon
request.

                                                 27
Theorem 2 (Eﬃciency of Equilibrium with Insurance Markets): Consider the allocation
(q, w, bu , te , z, U), where qy = qy∗ , w(q) = u−1 (S ∗ /λ(q) + u(z ∗ )) + (μ∗2 /μ∗1 )/λ(q) − z ∗ , bu (w) =
Bu∗ , te (w) = Te∗ (w), z = z ∗ − Bu∗ , and U = u(z ∗ ). (i) The allocation (q, w, bu , te , z, U) is
a competitive equilibrium for the version of the economy with insurance markets. (ii) The
competitive equilibrium (q, w, bu , te , z, U ) is constrained eﬃcient.

    The second part of Theorem 2 is not surprising. In the proposed equilibrium, the equilib-
rium insurance contracts exactly reproduce the optimal tax system. That is, the equilibrium
insurance contracts are such that, if the worker remains unemployed, the payment from the
insurance company to the worker, bu (w), is equal to the optimal unemployment benefit, Bu∗ .
And if the worker finds a job at a firm oﬀering the wage w, the payment from the worker to
the insurance company, te (w), is equal to the optimal labor earning tax, Te∗ (w). Since the
optimal tax system (Bu∗ , Te∗ ) implements the constrained eﬃcient allocation, it is not sur-
prising that an equilibrium in which insurance contracts reproduce the optimal tax system
is also constrained eﬃcient.

    The first part of Theorem 2 is less obvious. In particular, one might wonder why insurance
companies, in equilibrium, choose to oﬀer contracts that exactly reproduce the optimal tax
system (Bu∗ , Te∗ ). To answer the question, consider the profit maximization problem of an
insurance company

                          max(bu ,te ) λ(q)te − (1 − λ(q))bu ,
                    s.t. λ(q)u(z + w(q) − te ) + (1 − λ(q))u(z + bu ) − k ≥ U,                          (29)
                          λ(q) [u(z + w(q) − te ) − u(z + bu )] ≥ k.

Notice that the contract (bu , te ) that maximizes the profits of the insurance company must be
such that the worker’s participation constraint holds with equality. Otherwise, by lowering
bu by some small amount , the insurance company would still be able to satisfy the worker’s
participation constraint, it would relax the worker’s incentive compatibility constraint, and
it would increase its profits. Similarly, notice that the contract (bu , te ) that maximizes
the profits of the insurance company must be such that the worker’s incentive compatibility
constraint holds with equality. Otherwise, there would exist and δ such that–by increasing
bu by and by reducing te by (1 − λ(q))/λ(q) − δ–the insurance company would still satisfy
the worker’s incentive compatibility constraint, it would relax the worker’s participation


                                                     28
constraint and it would increase its profits.

    Since the contract (bu , te ) that maximizes the profits of an individual insurance company
must satisfy both the participation and the incentive compatibility constraints with equality,
it follows that u(z + tu ) = U and λ(q) [u(z + w(q) − te ) − U] = k. Moreover, since U =
u(z + Bu∗ ) and w(q) = u−1 (S ∗ /λ(q) + u(z ∗ )) + Te∗ (w(q)) − z, it follows that bu is equal to
Bu∗ and te is equal to Te∗ (w(q)). That is, the contract that maximizes the profits of an
individual insurance company reproduces the optimal tax system. Finally, since the optimal
tax system has the property that revenues and expenditures are balanced job-by-job, i.e.
λ(q)Te∗ (w(q)) = (1 − λ(q))Bu∗ , it follows that the maximized profits of an insurance company
are equal to zero. Thus, the profit-maximizing contract is consistent with perfect competition
in the insurance market.



6     Conclusions
In this paper, we studied the optimal redistribution of income inequality caused by the pres-
ence of search and matching frictions in the labor market. We carried out the analysis using
a directed search model of the labor market populated by homogenous workers and hetero-
geneous firms. In the first part of the paper, we characterized and compared the equilibrium
allocation and the constrained eﬃcient allocations. We found that the equilibrium is not
constrained eﬃcient because workers are not insured against the risk of not finding the job
that they seek. As a result of this lack of insurance, the equilibrium number of workers
seeking employment at high-productivity firms is ineﬃciently small, while the equilibrium
number of workers seeking employment at low-productivity firms is ineﬃciently large. More-
over, the consumption of an employed worker is an ineﬃciently steep function of the number
of workers who apply for the same type of job.

    In the second part of the paper, we proved that the constrained eﬃcient allocation can
be implemented by introducing a positive unemployment benefit and an increasing and
regressive labor income tax. We showed that the unemployment benefit serves the purpose
of lowering the search risk faced by workers, and that the labor tax serves the purpose of
aligning the cost to a firm of an applicant with the value of an applicant to society. Moreover,
we showed that the regressivity of the optimal labor income tax does not depend on the shape

                                                29
of the workers’ utility function, on the shape of the distribution of firms’ productivity, or
on the shape of the matching function. Rather, the regressivity of the labor income tax
is a necessary implication of two properties of the equilibrium with optimal policy: (a)
redistribution only takes place between workers applying to the same type of firm and (b)
workers are ex-ante indiﬀerent between applying to diﬀerent types of firms.

   In this paper, we studied the optimal redistribution of residual labor income inequality in
the context of a simple model of the labor market. The simplicity of our model aﬀorded us a
clear exposition of the properties and of the role of the optimal unemployment benefits and of
the optimal labor income tax. However, in order to make substantive policy recommendation,
we would have to enrich the model along several dimensions. First, we would have to consider
a dynamic environment. Second, since many workers move from one employer to the other
without an intervening spell of unemployment, we would have to consider an environment
in which workers can search both oﬀ and on the job. Finally, since income inequality is
likely to be caused by both productivity diﬀerences and by search frictions, we would have
to introduce some degree of inherent heterogeneity among workers.




                                             30
References
 [1] Acemoglu, D., and R. Shimer. 1999. “Eﬃcient Unemployment Insurance.” Journal of
    Political Economy 107: 893-927.

 [2] Autor, D., L. Katz, and M. Kerney. 2008. “Trends in U.S. Wage Inequality: Revising
    the Revisionists,” Review of Economics and Statistics 90: 300—323.

 [3] Burdett, K., S. Shi, and R. Wright. 2001. “Pricing and Matching with Frictions.” Journal
    of Political Economy 109: 1060—85.

 [4] Diamond, P. 1998. “Optimal Income Taxation: An Example with a U-Shaped Pattern
    of Optimal Marginal Tax Rates.” American Economic Review 88: 83—95.

 [5] Farhi, E., and I. Werning. 2011. “Insurance and Taxation over the Life Cycle.” Manu-
    script, Harvard University.

 [6] Galenianos, M., and P. Kircher.2012. “On the Game-Theoretic Foundations of Compet-
    itive Search Equilibrium.” International Economic Review 53: 1-21.

 [7] Golosov, M., M. Troshkin, and A. Tsyvinski. 2011. “Optimal Dynamic Taxes.” Manu-
    script, Princeton University.

 [8] Hansen, G., and A. Imrohoroglu. 1992. “The Role of Unemployment Insurance in an
    Economy with Liquidity Constraints and Moral Hazard.” Journal of Political Economy
    100: 118—42.

 [9] Hornstein, A., P. Krusell, and G. Violante. 2011. “Frictional Wage Dispersion in Search
    Models: A Quantitative Assessment.” American Economic Review 101: 2873-98.

[10] Hopenhayn, H., and J. Nicolini. 1997. “Optimal Unemployment Insurance.” Journal of
    Political Economy 105: 412—38.

[11] Hungerbuhler, M., E. Lehmann, A. Parmentier, and B. Van der Linden. 2006. “Optimal
    Redistributive Taxation in a Search Equilibrium Model.” Review of Economic Studies
    73: 743—67.




                                             31
[12] Laroque, G. 2005. “Income Maintenance and Labor Force Participation.” Econometrica
    73: 341—76.

[13] Mirrlees, J. 1971. “An Exploration in the Theory of Optimal Income Taxation.” Review
    of Economic Studies 38: 175—208.

[14] Menzio, G., and S. Shi. 2011. “Eﬃcient Search on the Job and the Business Cycle.”
    Journal of Political Economy 119: 468—510.

[15] Moen, E. 1997. “Competitive Search Equilibrium.” Journal of Political Economy 105:
    694—723.

[16] Montgomery, J. 1991. “Equilibrium Wage Dispersion and Interindustry Wage Diﬀeren-
    tials.” Quarterly Journal of Economics 106: 163—79.

[17] Mortensen, D. 2003. Wage Dispersion: Why are Similar Workers Paid Diﬀerently?
    M.I.T. Press, Cambridge, MA.

[18] Mortensen, D., and C. Pissarides. 1994. “Job Creation and Job Destruction in the
    Theory of Unemployment.” Review of Economic Studies 61: 397—415.

[19] Pissarides, C. 1985. “Short-Run Equilibrium Dynamics of Unemployment, Vacancies
    and Real Wages.” American Economic Review 75: 676—90.

[20] Postel-Vinay F., and J. Robin. 2002. “Equilibrium Wage Dispersion with Worker and
    Employer Heterogeneity.” Econometrica 70: 2295—350.

[21] Saez, E. 2001. “Using Elasticities to Derive Optimal Income Tax Rates.” Review of
    Economic Studies 68: 205—29.

[22] Shaal, E., and M., Taschereau-Dumouchel. 2012. “Optimal Redistributive Policy in a
    Labor Market with Search and Endogenous Participation.” Manuscript, University of
    Pennsylvania.

[23] Shavell, S., and L. Weiss. 1979. “The Optimal Payment of Unemployment Insurance
    Benefits over Time.” Journal of Political Economy 87: 1347—62.

[24] Shimer, R. 1996. “Contracts in a Frictional Labor Market.” Manuscript, M.I.T.

                                           32
[25] Shimer, R. 2005. “The Assignment of Workers to Jobs in an Economy with Coordination
    Frictions.” Journal of Political Economy 113: 996-1025.

[26] Shimer, R., and I. Werning. 2008. “Liquidity and Insurance for the Unemployed.” Amer-
    ican Economic Review 98: 1922—42.

[27] Varian, H. 1980. “Redistributive Taxation as Social Insurance." Journal of Public Eco-
    nomics 14: 49—68.

[28] Wang, C., and S. Williamson. 2002. “Moral Hazard, Optimal Unemployment Insurance,
    and Experience Rating.” Journal of Monetary Economics 49: 1337—71.




                                            33
                                        Appendix
A      Concavity of the firm’s problem
We establish the strict concavity with respect to q of the firm’s profit function

                                         η(q)y − p(q)q.                                      (A1)

The first term in (A1) is the expected revenue of the firm. The second term in (A1) is the
expected wage bill of the firm, which we have written as the product between the number of
applicants attracted by the firm, q, and the price of an applicant, p(q). Recall that the price
of an applicant p(q) is defined as λ(q)w(q), where w(q) is given by
                                           µ            ¶
                                        −1    S
                               w(q) = u           + u(z) − z.                                (A2)
                                             λ(q)

    The expected revenue of the firm is strictly concave with respect to q because η(q) is a
strictly concave function. Hence, in order to establish the strict concavity of the firm’s profit
function, we only have to show that the expected wage bill of the firm is convex with respect
to q. That is, we only have to show that p00 (q)q + 2p0 (q) ≥ 0. To this aim, notice that the
first derivative of p(q) with respect to q is given by
                                        ∙                          ¸
                          0         0     u(z + w(q)) − u(z)
                         p (q) = −λ (q)                      − w(q) .                        (A3)
                                              u0 (z + w(q))

The second derivative of p(q) with respect to q is given by
                                   ∙                            ¸
                 00          00      u(z + w(q)) − u(z)
                p (q) = −λ (q)                            − w(q)
                                        u0 (z + w(q))
                                      ∙                     ¸2                               (A4)
                            (λ0 (q))2 u(z + w(q)) − u(z) −u00 (z + w(q))
                          +                                                  .
                              λ(q)          u0 (z + w(q))      u0 (z + w(q))

From the above expressions, it follows that p00 (q)q + 2p0 (q) is given by
                                                     ∙                             ¸
           00        0                0       00       u(z + w(q)) − u(z)
          p (q)q + 2p (q) = − (2λ (q) + λ (q))                               − w(q)
                                                          u0 (z + w(q))
                                            ∙                      ¸2                        (A5)
                                 (λ0 (q))2 q u(z + w(q)) − u(z) −u00 (z + w(q))
                              +                                                       .
                                   λ(q)          u0 (z + w(q))          u0 (z + w(q))

The first term on the right-hand side of (A5) is strictly positive. To see this, first notice that
[u(z + w) − u(z)] /u0 (z + w) − w > 0 because u(c) is a strictly concave function and w is


                                                34
strictly positive. Then, notice that 2λ0 (q)+λ00 (q) is strictly negative because λ00 (q)+2λ0 (q) =
η 00 (q) < 0. The second term on the right-hand side of (A5) is also positive because u(c) is a
concave function. These observations imply p00 (q)q + 2p0 (q) > 0.            ¥



B      Mechanism with reports
In this appendix, we consider a version of the mechanism design problem in which the
mechanism recommends workers to follow a mixed application strategy and workers are
required to report the outcome of their mixing before implementing their strategy. More
specifically, the mechanism asks workers to draw their recommended search action from the
cumulative distribution function π, where π(y) denotes the probability that the worker seeks
for a firm of type ỹ ≤ y. Notice that the function π uniquely determines the applicant-to-firm
ratio q and the measure of applicants, a. Hence, we can think that the mechanism chooses
a and q rather than π. After workers draw their recommended action, they make a report
to the mechanism and chooses whether and where to search for a job. Then, the mechanism
assigns cy (ŷ) units of consumption to workers who report seeking for firms of type y and
end up being employed at firms of type ŷ. Similarly, the mechanism assigns c0 (ŷ) units of
consumption to workers who report not searching and end up being employed at firms of
type ŷ. The mechanism assigns zy units of consumption to workers who report seeking for
firms of type y and end up being unemployed, and z0 units of consumption to workers who
report not searching and end up being unemployed.

    The mechanism designer chooses (a, q, c, z) so as to maximize the worker’s expected utility
             Z
               [λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy ) − k] qy dF (y) + (1 − a)u(z0 ).     (B1)

    The mechanism is subject to incentive compatibility, truth telling and resource con-
straints. First, we describe the incentive compatibility constraints. Consider an arbitrary y
such that qy > 0. The mechanism must induce a worker that reports seeking a firm of type
y to actually seek a firm of type y rather than a firm of type ŷ 6= y. That is, for all ŷ 6= y,
the mechanism must be such that

      λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy ) − k ≥ λ(qŷ )u(cy (ŷ)) + (1 − λ(qŷ ))u(zy ) − k.   (B2)


                                                  35
Moreover, the mechanism must induce a worker that reports seeking a firm of type y to
actually seek a firm of type y rather not to search. That is, the mechanism must be such
that
                            λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy ) − k ≥ u(zy ).                      (B3)

Similarly, if a < 1, the mechanism must induce a worker that reports not seeking for a job
to actually do so. That is, for all ŷ, the mechanism must be such that

                            u(d0 ) ≥ λ(qŷ )u(c0 (ŷ)) + (1 − λ(qŷ ))u(z0 ) − k.                   (B4)

   Next, we describe the truth telling constraints. Again, consider an arbitrary y such that
qy > 0. The mechanism must induce a worker that draws y to report that he is searching
for a firm of type y rather than to report that he is searching for a firm of type ŷ 6= y. That
is, for all ŷ 6= y such that qŷ > 0, the mechanism must be such that

               λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy ) ≥ λ(qŷ )u(cŷ (ŷ)) + (1 − λ(qŷ ))u(zŷ ).    (B5)

Moreover, if a < 1, the mechanism must make sure that the worker does not report that he
is not searching. That is, the mechanism must be such that

                            λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy ) − k ≥ u(z0 ).                      (B6)

Also, if a < 1, if the worker’s randomization instructs him not to search, then the worker
must have the incentive to truthfully report this to the mechanism. That is, for all ŷ such
that qŷ > 0
                            u(d0 ) ≥ λ(qŷ )u(cŷ (ŷ)) + (1 − λ(qŷ ))u(zŷ ) − k.                 (B7)

   Finally, the mechanism has to satisfy the resource constraint on output
         Z                  Z
             η(qy )ydF (y) − [λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy )] dF (y) − (1 − a)z0 ,            (B8)

and the resource constraint on applications

                                               1 − a ≥ 0,                                           (B9)
                                              Z
                                           a − qy dF (y) = 0.                                      (B10)

   We claim that the above mechanism design problem is equivalent to problem that we

                                                      36
analyzed in Section 3. First, note that we can abstract from the incentive compatibility
constraint (B2) because this constraint can always be satisfied by choosing cy (ŷ) = 0 and
the choice of cy (ŷ) does not aﬀect any other constraint or the objective function. Similarly,we
can abstract from the incentive compatibility constraint (B4). Second, note that the truth
telling constraints (B5)-(B7) are equivalent to say that there exists a U such that the worker’s
expected utility from following any recommended action is equal to U and the worker’s
expected utility from following any non-recommended action is non-greater than U. In light
of the above observations, we can replace the incentive compatibility constraints (B2)-(B4)
with
                                         U − u(zy ) ≥ 0.                                  (B11)

And we can replace the truth telling constraints (B5)-(B7) with

                        λ(qy )u(cy (y)) + (1 − λ(qy ))u(zy ) − U = 0,                     (B12)

                                                       U − u(z0 ) ≥ 0,                    (B13)

                                            (1 − a) (U − u(z0 )) = 0.                     (B14)

   After rewriting the incentive compatibility and the truth telling constraint, it is immediate
to see that the only diﬀerence between the above mechanism design problem and the one
in Section 3 is that the consumption of unemployed workers can be made contingent upon
the worker’s search strategy. However, we will now show that the mechanism designer finds
it optimal not to use these contingencies. Let φ1 and φ2 denote the multipliers associated
with the constraints (B13) and (B14). Let ρ1,y dF (y) and ρ2,y dF (y) denote the multipliers
associated with the constraints (B11) and (B12). Finally, let μ1 , μ2 and μ3 denote the
multipliers associated with the resource constraints (B8), (B9) and (B10). Consider an
arbitrary y. The first order condition with respect to zy is given by
                           £                               ¤
                   u0 (zy ) (1 − λ(qy ))(qy + ρ2,y ) + ρ1,y = μ1 qy (1 − λ(qy )).         (B15)

The first order condition with respect to cy (y) is given by
                                             £         ¤
                                  u0 (cy (y)) qy + ρ2,y = μ1 qy .                         (B16)

If ρ1,y = 0, then the first order conditions (B15) and (B16) imply zy = cy (y). However, this


                                                37
violates the incentive compatibility constraint (B11). Hence, for all y, we have ρ1,y > 0 and
U − u(zy ) = 0. In turn, this implies that zy = z for all y. That is, the mechanism designer
finds it optimal to equate the consumption among all of the unsuccessful job seekers. If a = 1,
z0 does not matter and it can be set equal to z without loss in generality. If a < 1, the truth
telling constraint (B14) implies z0 = z. That is, the mechanism designer needs to equate
the consumption between workers who do not search and workers who search unsuccessfully.
¥



C      Optimal mechanism
In this appendix, we derive the optimality conditions (14)-(18) for the solution to the mech-
anism design problem. To this aim, we need to introduce some additional notation. Let
μ1 , μ2 and μ3 denote the multipliers associated with the aggregate resource constraints (8)—
(10). Let ρy dF (y) denote the multiplier associated to the incentive compatibility constraint
(11). Finally, let ν 1 and ν 2 denote the multipliers associated to the incentive compatibility
constraints (12) and (13).
    A solution to the mechanism design problem consists of an allocation (a, q, c, z, S), a list
of multipliers on the resource constraints (μ1 , μ2 , μ3 ), and a list of multipliers on the incentive
compatibility constraints (ρy , ν 1 , ν 2 ). The solution to the mechanism design problem must
satisfy a number of first order conditions. The first order condition for cy is

                                    qy u0 (cy ) + ρy u0 (cy ) = μ1 qy .                         (C1)

The first order condition for z is
       ∙     Z               ¸       ∙Z                ¸    ∙   Z               ¸
  0                                0
 u (z) 1 − λ(qy )qy dF (y) = u (z)      ρy λ(qy )dF (y) + μ1 1 − λ(qy )qy dF (y) . (C2)

The first order condition for qy is

                      {u(z) + S − k + qy λ0 (qy ) [u(cy ) − u(z)]}
                  +   μ1 {η 0 (qy )y − λ(qy )cy − (1 − λ(qy ))z + qy λ0 (qy ) [cy − z]}         (C3)
                  ≤ μ3 − ρy λ0 (qy ) [u(cy ) − u(z)],




                                                   38
The first order condition for a is

                                      u(z) + μ2 = μ1 z + μ3 .                                 (C4)

The first order condition for S is
                                                            Z
                                 ν 1 + ν 2 (1 − a) =            ρy dF (y).                    (C5)

In addition to the first order conditions (C1)-(C5), a solution to the mechanism design prob-
lem must satisfy the resource constraints (8) and (10), as well as the incentive compatibility
constraints (11) and (13). Moreover, a solution to the mechanism design problem must be
such that

                            1 − a ≥ 0, μ2 ≥ 0 and (1 − a) μ2 = 0,                             (C6)

                           S − k ≥ 0, ν 1 ≥ 0 and (S − k)ν 1 = 0.                             (C7)

   Using equation (C2) to solve for μ1 and equation (C1) to solve for ρy , it follows that the
right-hand side of (C5) is strictly positive and, hence, ν 1 + ν 2 (1 − a) > 0. First, suppose that
the solution to the mechanism design problem is such that a = 1. In this case, ν 1 +ν 2 (1−a) >
0 implies ν 1 > 0. In turn, ν 1 and (C7) imply S = k. Next, suppose that the solution to the
mechanism design is such that a < 1. In this case, the incentive compatibility constraint
(13) implies S = k. Therefore, the solution to the mechanism design problem is always such
that
                                                  S = k.                                      (C8)

Solving equation (C1) for ρy and equation (C4) for μ2 and substituting the solutions into
the first order condition (C3), we obtain
                                                        ∙                    ¸
                                                     u(cy ) − u(d)             μ
               0                              0
              η (qy )y − λ(qy )(cy − d) + qy λ (qy )      0
                                                                   − (cy − d) = 2 .           (C9)
                                                        u (cy )                μ1

Solving the incentive compatibility constraint (11) for cy and using the fact that S = k, we
obtain                                            µ              ¶
                                          −1           k
                                     cy = u                + u(z) .                         (C10)
                                                      λ(q)




                                                      39
Solving the resource constraint (8) for z, we obtain
                                  Z
                              z = η(qy ) [y − (cy − z)] dF (y).                                               (C11)

Finally, using the optimality condition (C7) and the resource constraint (10), it is straight-
forward to verify that
                    Z                        µ   Z         ¶
                                   μ2                        μ2
                1 − qy dF (y) ≥ 0,    ≥ 0 and 1 − qy dF (y)     = 0.                                          (C12)
                                   μ1                        μ1

The optimality conditions (C8)-(C12) are the same as the conditions (14)-(18).                            ¥



D       Proof of Proposition 1
In the main text, we proved parts (i) and (ii) of the proposition. In this appendix, we prove
part (iii). Let (a∗ , q∗ , c∗ , z ∗ , S ∗ ) denote the solution to the mechanism design problem and
let μ∗1 and μ∗2 denote the multipliers associated with the resource constraints (11) and (12).
Suppose that μ∗2 / μ∗1 = 0. When μ∗2 / μ∗1 = 0, the constrained eﬃcient queue length is such
that                                                                ∙ ∗                          ¸
                   0
                                               ¡ ∗      ¢ ∗ 0 ∗
                                                                     u(cy ) − u(z ∗ )
               η       (qy∗ )y   =   λ(qy∗ )          ∗
                                                cy − z − qy λ (qy )                       ∗    ∗
                                                                                      − (cy − z )             (D1)
                                                                         u0 (c∗y )
and the constrained eﬃcient consumption for employed workers is such that
                                        µ                ¶
                                ∗    −1     k          ∗
                               cy = u             + u(z ) .                                                   (D2)
                                          λ(qy∗ )

Moreover, the constrained eﬃcient consumption for unemployed workers satisfies the resource
constraint for output                              Z
                                               ∗
                                           z =         η(qy∗ )(y − (c∗y − z ∗ ))dF (y),                       (D3)

and the constrained eﬃcient queue satisfies the resource constraint on applicants
                                  Z
                                    qy∗ dF (y) = a∗ ≤ 1.                                                      (D4)

Let q̃(y, z, k) denote the solution for q to the equations (D1) and (D2) with respect to q. It
is straightforward to verify that q̃(y, z, k) is increasing in y, increasing in d and decreasing
in k.
                                                                R
    Now, let k be the search cost such that                         q̃(y, 0, k)dF (y) = 1. Such a k exists because


                                                                40
limk→0 q̃(y, z, k) = ∞ for any y ∈ [y, y] and any z ∈ R+ . For any k <k, the constrained
eﬃcient queue length is such that
                                           Z
                                               q ∗ (y)dF (y)
                                           Z
                                    =          q̃(y, z ∗ , k)dF (y)                              (D5)
                                           Z
                                    >          q̃(y, 0, k)dF (y) = 1.

This implies that, for k <k, there is no solution to the system of equations (D1)-(D4). Hence,
the solution to the mechanism design problem must be such that μ∗2 / μ∗1 > 0. In an analogous
way, one can prove that there exists a k such that, for k > k, μ∗2 / μ∗1 = 0.          ¥



E      Proof of Proposition 2
First, we compare the consumption assigned to unemployed workers in the equilibrium and
in the second best. To this aim, notice that the workers’ expected utility is equal u(z)+S −k
in the equilibrium, and it is equal to u(z ∗ ) + S ∗ − k in the second best. Since μ∗2 /μ∗1 > 0,
the equilibrium is constrained ineﬃcient and, hence, the workers’ expected utility is strictly
lower that in the second best. That is,

                                  u(z) + S − k < u(z ∗ ) + S ∗ − k.                              (E1)

Since S > k and S ∗ = k, the above inequality implies z < z ∗ .
    Next, we compare the consumption assigned to employed workers in the equilibrium and
in the second best. In the equilibrium, the consumption assigned to a worker employed
at a firm that attracts q applicants is c(q) = u−1 (S/λ(q) + u(z)). In the second best, the
consumption assigned to a worker employed at a firm that attracts q applicants is c∗ (q) =
u−1 (S ∗ /λ(q) + u(z ∗ )). The derivatives of c and c∗ with respect to q are

                                      0        λ0 (q)   S
                                     c (q) = −      2 0
                                                             ,
                                               λ(q) u (c(q))
                                                                                                 (E2)
                                      ∗0       λ0 (q)    S∗
                                     c (q) = −                   .
                                               λ(q)2 u0 (c∗ (q))

Notice that since S > S ∗ , c(q0 ) = c∗ (q0 ) implies that c0 (q0 ) > c∗0 (q0 ). Using this observation
and the behavior of c(q) and c∗ (q) at q = 0 and q = ∞, it follows that there exists one

                                                     41
q0 ∈ (0, ∞) such that c(q0 ) = c∗ (q0 ), c(q) < c∗ (q) for q ∈ (0, q0 ) and c(q) > c∗ (q) for
q ∈ (q0 , ∞).
    Finally, we compare the allocation of applicants across firms in the equilibrium, qy , and
in the second best, qy∗ . Diﬀerentiating the first order condition (3) with respect to y and
using the fact that p(q) = φ(q, z, S), we obtain

                                                        η 0 (qy )y
                             qy0 =                                                 .                   (E3)
                                     −η 00 (qy )y + 2φq (q, z, S) + φqq (q, z, S)q

Similarly, diﬀerentiating the first order condition (19) with respect to y and using the fact
that p∗ (q) = φ(q, z ∗ , S ∗ ) + μ∗2 /μ∗1 , we obtain

                                                         η 0 (qy∗ )y
                          qy∗0 =                                                              .        (E4)
                                   −η 00 (qy∗ )y + 2φq (q, z ∗ , S ∗ ) + φqq (q, z ∗ , S ∗ )q

The diﬀerential equations (E3) and (E4) are identical, except that the function φ is evaluated
at (q, z, S) in the first equation and at (q, z ∗ , S ∗ ) in the second equation. First, using the
fact that φq (q, z, S) is strictly increasing in S and strictly decreasing in z and the fact that
z < z ∗ and S > S ∗ , we can prove that 2φq (q, z, S) + φqq (q, z, S)q is strictly greater than
2φq (q, z ∗ , S ∗ ) + φqq (q, z ∗ , S ∗ )q. This property implies that if qy = qy∗ then qy0 < qy∗0 . In turn,
this implies that there exists at most one y such that qy = qy∗ . Second, using the fact that
qy dF (y) and qy∗ dF (y) both integrate up to one, we can prove that there must exist at least
one y ∈ (yc , y) such that qy = qy∗ . Taken together the two observations imply that there exist
a y0 such that qy0 = qy∗0 , qy > qy∗ for y ∈ (yc , y0 ), and qy < qy∗ for y ∈ (y0 , y).           ¥



F      Proof of Theorem 1
Given the unemployment benefit Bu∗ and the labor earning tax Te∗ , consider the allocation
(q̂, ŵ, ẑ, Ŝ) where ẑ = z ∗ − Bu∗ , Ŝ = S ∗ q̂y = qy∗ and
                                               µ ∗             ¶
                                            −1     S
                                ŵ(q) = u              + u(z ) + T ∗ (q) − ẑ.
                                                             ∗
                                                                                                       (F1)
                                                 λ(q)

    First, we claim is that the queue length function q̂y solves the problem of the firm

                          max η(q)y − p̂(q)q,
                           q≥0
                                      ∙    µ ∗            ¶            ¸                               (F2)
                                        −1     S        ∗     ∗
                          p̂(q) = λ(q) u           + u(z ) + T (q) − ẑ .
                                              λ(q)

                                                           42
To see this, notice that the problem (F2) is strictly concave and, hence, q̂y is a solution if
and only if it satisfies the first order condition

                                η 0 (q)y = p̂(q)q + p̂(q), if q > 0,
                                                                                               (F3)
                                η 0 (q)y ≤ p̂(q)q + p̂(q), if q = 0.

Since q̂y = qy∗ , q̂y satisfies the first order condition of the mechanism design problem

                               η 0 (q)y = p∗ (q)q + p∗ (q), if q > 0,
                                                                                               (F4)
                               η 0 (q)y ≤ p∗ (q)q + p∗ (q), if q = 0.

Now, notice that the price of an applicant p̂(q) is such that
                                   ∙     µ ∗             ¶           ¸
                                      −1   S           ∗       ∗
                     p̂(q) = λ(q) u             + u(z ) + T (q) − ẑ
                                          λ(q)
                                   ∙     µ ∗             ¶      ¸
                                           S                      μ∗                           (F5)
                            = λ(q) u−1          + u(z ∗ ) − z ∗ + 2∗
                                          λ(q)                    μ1
                              = p∗ (q),

where the second line uses the definition of ẑ and the fact that λ(q)[T ∗ (q) + Bu∗ ] = μ∗2 / μ∗1 .
From (F5), it follows that q̂y satisfies the first order condition (F3) and, hence, it solves the
problem of the firm (F2).
    Second, we claim that the wage function ŵ(q) is consistent with the worker’s optimal
search strategy. To see this notice that the worker’s expected utility from seeking a job that
attracts q applicants is

                          λ(q) [u(ẑ + ŵ(q) − Te∗ (ŵ(q))) − u(ẑ + Bu∗ )]
                               ∙ µ       µ ∗              ¶¶          ¸
                                      −1    S           ∗           ∗
                        = λ(q) u u              + u(z )       − u(z )                          (F6)
                                           λ(q)
                        = S ∗ = Ŝ,

where the second line uses the definition of ẑ and ŵ(q) and the third line uses of the definition
of Ŝ.
    Third, we claim that the value of searching Ŝ is consistent with the worker’s optimal
search strategy. To this aim,it is suﬃcient to notice that Ŝ = k and
                                Z               Z
                                    q̂y dF (y) = qy∗ dF (y) ≤ 1.                               (F7)

    Fourth, we claim that the dividends received by the workers are equal to the profits



                                                43
earned by the firms. To see this, notice that the profits earned by the firms are
                 Z
                    η(q̂y ) [y − ŵ(q̂y )] dF (y)
                 Z
                            £          ¡                   ¢                  ¤
             =      η(qy∗ ) y − u−1 S ∗ / λ(qy∗ ) + u(z ∗ ) + z ∗ − Bu∗ / λ(q) dF (y)
                                                                                                   (F8)
                 Z                                    Z
                            £    ¡ ∗          ¢¤
             =      η(qy ) y − cy − z dF (y) − qy∗ Bu∗ dF (y)
                        ∗                   ∗


               = z ∗ − Bu∗ = ẑ,

where the second line uses the definitions of q̂y and ŵ(q), the third line uses the equations
ẑ + Bu∗ = z ∗ and λ(q)[Bu∗ + T ∗ (q)] = Bu∗ , the fourth line uses the fact that q ∗ , S ∗ and z ∗
satisfy the incentive compatibility constraint (10), and the last line uses the fact that q∗ , c∗
and z ∗ satisfy the resource constraint (11).
     Fifth, we claim that the budget of the policy maker is balanced. To see this, notice that
the budget of the policy maker is
                            Z
                                η(q̂y ) [Te∗ (ŵ(q̂y )) + Bu∗ ] dF (y) − Bu∗
                            Z
                                           £                ¤
                         =      qy∗ λ(qy∗ ) T ∗ (qy∗ ) + Bu∗ dF (y) − Bu∗                          (F9)
                            Z
                         =      qy∗ (μ∗2 / μ∗1 ) dF (y) − μ∗2 / μ∗1 = 0,
                                                                                                £              ¤
where the second line uses the fact that q̂y = qy∗ , the third line uses the fact that λ(qy∗ ) T ∗ (qy∗ ) + Bu∗ =
                                                                                            R
μ∗2 / μ∗1 and Bu∗ = μ∗2 / μ∗1 , and the last line uses the fact that either μ∗2 / μ∗1 = 0 or qy∗ dF (y) =
1.
     Taken together, the above observations show that the allocation (q̂, ŵ, ẑ, Ŝ) is an equilib-
rium that implements the solution to the mechanism design problem.                   ¥




                                                   44
