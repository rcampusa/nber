                                NBER WORKING PAPER SERIES




     EQUILIBRIUM PORTFOLIO STRATEGIES IN THE PRESENCE OF SENTIMENT
                      RISK AND EXCESS VOLATILITY

                                          Bernard Dumas
                                         Alexander Kurshev
                                           Raman Uppal

                                        Working Paper 13401
                                http://www.nber.org/papers/w13401


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    September 2007

We are grateful to Wei Xiong, Tony Berrada, Julien Hugonnier and Erwan Morellec for useful discussions.
We are also grateful for comments from Andrew Abel, Nick Barberis, Suleyman Basak, Tomas Bj¨ork,
Andrea Buraschi, Joao Cocco, John Cochrane, George Constantinides, John Cotter, Alexander David,
Mike Gallmeyer, Xavier Gabaix, Francisco Gomes, Lorenzo Garlappi, Joao Gomes, Tim Johnson,
Leonid Kogan, Kostas Koufopoulos, Karen Lewis, Deborah Lucas, Pascal Maenhout, Massimo Massa,
Stavros Panageas, Anna Pavlova, Ludovic Phalippou, Valery Polkovnichencko, Bryan Routledge,
Andrew Scott, Jose Scheinkman, Hersh Shefrin, Matt Spiegel, Alex Stomper, Allan Timmermann,
Skander van den Heuvel, Luis Viceira, Jiang Wang, Pierre-Olivier Weill, Hongjun Yan, Amir Yaron,
Moto Yogo, Joseph Zechner, Stanley Zin and participants at presentations given at Bank of England,
Columbia University, HEC Paris, INSEAD, Judge Institute at Cambridge University, London Business
School, London School of Economics, Massachusetts Institute of Technology, Oxford University,
Princeton University, Stanford University, University of California at Berkeley, University College
Dublin, University of Frankfurt, University of Piraeus, University of Texas at Austin, University of
Toulouse, University of Vienna, University of Zurich, Wharton School, Yale University, American
Finance Association Meeting, Citigroup Smith Barney Quantitative Conference, Duke/UNC Asset
Pricing Conference, European Finance Association Meeting, European Summer Symposium in Financial
Markets at Gerzensee, European Central Bank, Isaac Newton Institute at Cambridge University, NBER
workshop on Capital Markets and the Economy, NBER Summer Institute, NBER Asset Pricing Meeting,
the Swiss Finance Institute and the Swiss National Bank. The views expressed herein are those of
the author(s) and do not necessarily reflect the views of the National Bureau of Economic Research.

© 2007 by Bernard Dumas, Alexander Kurshev, and Raman Uppal. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Equilibrium Portfolio Strategies in the Presence of Sentiment Risk and Excess Volatility
Bernard Dumas, Alexander Kurshev, and Raman Uppal
NBER Working Paper No. 13401
September 2007
JEL No. C11,D58,D84,D91

                                                 ABSTRACT

Our objective is to identify the trading strategy that would allow an investor to take advantage of "excessive"
stock price volatility and "sentiment" fluctuations. We construct a general-equilibrium model of sentiment.
In it, there are two classes of agents and stock prices are excessively volatile because one class is overconfident
about a public signal. As a result, this class of overconfident agents changes its expectations too often,
sometimes being excessively optimistic, sometimes being excessively pessimistic. We determine and
analyze the trading strategy of the rational investors who are not overconfident about the signal. We
find that, because overconfident traders introduce an additional source of risk, rational investors are
deterred by their presence and reduce the proportion of wealth invested into equity except when they
are extremely optimistic about future growth. Moreover, their optimal portfolio strategy is based not
just on a current price divergence but also on their expectation of future sentiment behavior and a prediction
concerning the speed of convergence of prices. Thus, the portfolio strategy includes a protection in
case there is a deviation from that prediction. We find that long maturity bonds are an essential accompaniment
of equity investment, as they serve to hedge this "sentiment risk."

Bernard Dumas                                            Raman Uppal
Université de Lausanne                                   London Business School
Institut de Banque et Finance                            Regents Park
Bâtiment Extranef                                        London NW1 4SA
1015 Lausanne                                            UK
Switzerland                                              ruppal@london.edu
and NBER
bernard.dumas@unil.ch

Alexander Kurshev
London Business School
akurshev.PHD2003@london.edu
1        Introduction

The excess-volatility puzzle – identified by Shiller (1981) and LeRoy and Porter (1981) – points to
a form of market inefficiency. But, so far, the investment strategy that would serve to exploit that
form of inefficiency and would cause those responsible for excess volatility to part with their wealth
has not been identified. Suppose that a financial market is deemed to be affected by fluctuations
in market “sentiment” so that sentiment volatility causes prices to be more volatile than what
would be justified by dividend volatility alone.1 Suppose further that a Bayesian, intertemporally
optimizing investor trades in that market. We would like to know what investment policy this
person will undertake in equilibrium.

        To address this question, we build a general-equilibrium model of a financial market in which a
subpopulation of investors trades on “sentiment” and generates excess volatility. In our model, some
investors are overconfident in the sense that they give too much credence to a public information
signal. One way to capture that behavioral feature has recently been proposed by Scheinkman and
Xiong (2003). In their model of a “tree” economy, a stream of dividends is paid. Some aspect
of the stochastic process of dividends is not observable by anyone. All investors are risk neutral,
are constrained from short selling, and receive information in the form of the current dividend
and some public signals. Agents have different beliefs about the correlation between innovations
in the signal and innovations in the unobserved variables: “overconfident”agents are people who
steadfastly believe that this correlation is a positive number when, in fact, it is equal to zero. This
causes them to give too much weight to the signals.

        Here, we consider a similar setting except that all investors are risk averse and are allowed to
sell short. One class of agents knows the true correlation. They form “proper” beliefs by using
Bayes’ formula. A second class of investors are overconfident about the public signal. As a result,
they change their beliefs too often about economic prospects: when they receive a signal, they
overreact to it, which then generates excessive stock price movements. We say that volatility is
“excessive” when, for the given utility functions of agents, the level of volatility is larger than it
would be if all agents knew the correlation to be equal to zero, and we refer to the fluctuations in the
    1
    Whether financial-market volatility is actually excessive has been debated. The literature on the equity-premium
puzzle has developed a number of models, such as habit-formation models (see Constantinides (1990); Abel (1990);
Campbell and Cochrane (1999)), in which the effective discount rate is strongly time varying even though the
consumption stream remains very smooth. Using models of that kind, Menzly, Santos, and Veronesi (2004) have
recently calibrated a model of the U.S. stock market in which the volatility of stock returns is larger than the one
observed in the data. In another line of investigation, Bansal and Yaron (2004) and Hansen, Heaton, and Li (2005)
find that allowing for a small long-run predictable component in dividend growth rates and for very high elasticity of
intertemporal substitution can generate several observed asset-pricing phenomenon, including volatility of the market
return. Spiegel (1998) shows that excess volatility can be explained also in an overlapping-generations model with
small shocks to the supply of the multiple risky assets. Bhamra and Uppal (2007) show that differences in risk
aversions can also lead to large volatility.




                                                          1
probability beliefs of overconfident agents relative to agents with the proper beliefs as fluctuations
in “sentiment.” The non-zero correlation number to which overconfident investors adhere, is the
single parameter in our model that causes it to differ from a traditional rational-expectations general
equilibrium model.

    In their contest with investors who process information rationally under the proper beliefs, we
want the traders who are overconfident to be full-fledged intertemporal optimizers nonetheless. It
is well-known that complete irrationality in the manner of positive “feedback traders” à la De Long,
Shleifer, Summers, and Waldmann (1990b) can amplify the volatility of stock prices and that the
additional volatility creates “noise-trader risk” for rational arbitrageurs, thereby creating a limit to
arbitrage. However, feedback traders or traders acting randomly may not be the best representation
of irrational behavior because they are “sitting ducks” for rational investors. Furthermore, it is not
clear where the consumption units they are losing are coming from. For this reason, we prefer to
model a general equilibrium economy where the overconfident traders are intertemporal optimizers
with fully specified budget constraints, even if they have overconfident beliefs. In this way, welfare
analysis and the analysis of gains and losses of the two groups of traders remain meaningful.2

    We identify three distinct aspects of the portfolio strategy of the investors who process infor-
mation properly.3 First, these investors may not agree today with the market about its current
estimate of the growth rate of dividends: there is a difference of opinion. When the investors with
the proper beliefs are more optimistic than the market, they increase their investment in equity,
while decreasing their investment in bonds (because equity and bonds are positively correlated).
Second, all investors, whether they agree today or not, know that they will revise their forecasts
of growth, with consequent future changes in the rate of interest. Third, if there is a difference
of opinion today, investors with the proper beliefs are aware that the overconfident investors will
revise their probability beliefs differently from the way their own will be revised: the difference
of opinion drives sentiment, which is stochastic, and sentiment risk carries a risk premium. The
second and third effects cause investors with the proper beliefs to hedge; they hold fewer shares of
equity than would be optimal in a market without excess volatility. Thus, our analysis illustrates
how “risk arbitrage” must be based not just on a current price divergence but also on a model of
overconfident behavior, so that a protection can be put in place.
   2
     Models of feedback trading do not discuss the budget constraint of the feedback traders and, therefore, leave
unclear the origin of the gains that the rational arbitrageurs would make. And, even when noise traders pursue an
explicit objective, as is done in De Long, Shleifer, Summers, and Waldmann (1990a), one must be careful not to
confuse “noise risk” with some output risk induced by the noise risk, as has been pointed out recently by Loewenstein
and Willard (2006). Restricting our analysis to a pure exchange general equilibrium economy allows us to maintain
a clean distinction between output risk and noise risk.
   3
     The question being answered in our paper is the same as the one that was raised by Williams (1977) and Ziegler
(2000) in a simpler setting in which the expected growth rate of dividends is constant (although unobserved) and in
which there are fewer securities. In these two papers, the investor whose strategy one is studying is assumed to be of
negligible weight in the market, in contrast to our setting.



                                                          2
       The model we develop can be viewed as an equilibrium model of investor sentiment, in the
sense of Barberis, Shleifer, and Vishny (1998). Several studies have supported the hypothesis that
agents active in the financial markets exhibit aspects of behavior that deviate from rationality.4
This was done typically on the basis of some natural experiments, for instance, spin offs, share
repurchases, initial public offerings, reactions to news, etc. In order to sort out which behavioral
aspects actually exist in the marketplace, it would be important to conduct tests using data on asset
prices. One must, therefore, deduce theoretically the behavior of asset prices and portfolio choices
that will prevail in the financial markets as a result of a particular deviation from rationality.
That was the intent of three classic papers in this strand of the literature, which can be called
“behavioral equilibrium theory”: Barberis, Shleifer, and Vishny (1998), Daniel, Hirshleifer, and
Subrahmanyam (1998), and Hong and Stein (1999). The first two of these papers feature a single
group of agents who are non-Bayesian.5 The model of Hong and Stein (1999), like ours, features
two groups of agents with heterogeneous beliefs who, in contrast to the agents in our model, are
not intertemporal optimizers.

       The heterogeneity of beliefs between agents needs to be regenerated; otherwise Bayes’ law causes
it to die out.6 There exist basically two ways of doing that: either agents receive different informa-
tion or they receive the same information but process it differently. The first, more sophisticated
approach is to let agents receive private signals, as in the vast “Noisy-Rational Expectations” liter-
ature originating from the work of Grossman and Stiglitz (1980), Hellwig (1980) and Wang (1993),
in which agents learn also from price, a channel that is not present in our model. In most renditions
of noisy-rational expectations equilibria, the market includes noise traders who behave randomly,
a feature we would like to avoid. The second approach is the one utilized in “difference-of-opinion”
models such as Harris and Raviv (1993), Kandel and Pearson (1995), and Cecchetti, Lam, and Mark
(2000); see Morris (1995) for a discussion of this approach. Agents disagree about the basic model
they believe in, or about some fixed model parameter, and they do not learn from each others’ be-
havior: they “agree to disagree”. Under this approach, agents are viewed as being non-Bayesian,7
   4
     For a survey of the behavioral view of asset pricing, see Shefrin (2005).
   5
     The agents in Barberis, Shleifer, and Vishny (1998) update their beliefs using Bayes’ formula but they do so on
the basis of the wrong prior category of models, which they refuse to update.
   6
     For a comprehensive study of the influence of heterogeneous beliefs on asset prices, see Basak (2005) and Jouini
and Napp (2006).
   7
     One class of models shows that, with sufficiently deviant priors, Bayesian, rational learning alone can serve to
develop theoretical models with volatility that matches the data, by assuming that investors do not know the true
stochastic process of dividends (Barsky and De Long (1993)). As investors do not know the expected growth rate of
dividends, prices are revised when they receive information about it. These price revisions go beyond the change in
the current dividend because the current dividend contains information about future dividends. A similar argument
has been made by Bullard and Duffy (2001), Buraschi and Jiltsov (2005), David and Veronesi (2002), Detemple and
Murthy (1994), Duffie, Garleanu, and Pedersen (2002), Gallmeyer (2000), Timmermann (1993, 1996), and Veronesi
(1999). Brennan and Xia (2001) calibrate a model in which a single type of investors populate the financial market and
learn about the expected growth rate of dividends and, separately, about the expected growth rate of consumption.
In that model, as in ours, the expected growth rate of dividends is unobservable and needs to be filtered out, which




                                                          3
but, one can say equally well, as do Biais and Bossaerts (1998), that agents remain Bayesian and
place infinite trust on some aspect of their prior. The second approach is more easily tractable
while capturing some of the same phenomena as the first one. It is the approach we adopt here,
as it has been in the recent, related work of David (2007). In our model, the non-zero correlation
number to which overconfident investors adhere is the mechanism by which heterogeneity of beliefs
is regenerated.

    On the technical side, we adopt the exponential linear-quadratic framework, introduced in the
work of Constantinides (1992) on the term structure, in the work of Kim and Omberg (1996) on
dynamic portfolio choice, and now extensively used in term-structure and volatility modeling (see
Cheng and Scaillet (2006)). It is a very flexible functional setting in that it can handle any finite
number of state variables. In our model, asset prices are weighted averages of exponential linear-
quadratic functions of state variables, with time varying weights. Ours is, to our knowledge, the
first general-equilibrium application of that mathematical framework.

    The balance of this paper covers the following material. In Section 2, we describe agents’ beliefs
and the way beliefs evolve over time. In Section 3, we determine the equilibrium allocation of
consumption and the equilibrium pricing kernel. In Section 4, we produce the explicit solution for
all securities prices. In Section 5, we derive and study the diffusion matrix and all moments of
securities prices; we verify, of course, that overconfident investors bring about excessive volatility.
In Section 6, we identify the main factors driving the portfolio strategy of the rational trader and we
show how it can be implemented via trading in stocks and bonds, as functions of the values of the
fundamental state variables of the economy. In Section 7, we explain the link that exists between
the portfolio strategy and the trader’s ability to predict returns in the long run. In Section 8,
we derive the speed of impoverishment of the overconfident traders and demonstrate that excess
volatility may be a long-lived phenomenon. Section 9 contains the conclusion. Throughout, we
highlight our main results in propositions while technical results are presented in lemmas, with
their mathematical derivations provided in the appendix.


2    Beliefs and information structure

We wish to develop a dynamic general-equilibrium model where investors have heterogeneous expec-
tations about some aspect of the economy. In the first subsection below, we specify an endowment
economy populated by two groups of investors, Group A and Group B, who harbor different expec-
tations about the process driving aggregate dividends. In the second subsection, we show that the
then contributes positively to the volatility of the stock price. They find that they can match several moments of
stock returns.



                                                        4
dynamics of expectations that we have specified can be viewed as the result of a learning process
of the kind proposed by Scheinkman and Xiong (2003).


2.1   Beliefs and their dynamics

We consider an economy with an aggregate dividend-flow diffusion process {δ t }, which we regard
as the “fundamental” variable.


Assumption 1 Under the beliefs of Group B, the process for aggregate dividends is driven by the
following pair of stochastic differential equations, which defines a Markovian system in two state
variables, {δ t , fbB }:
               t
                                         dδ t
                                              = fbtB dt + σ δ dWδ,t
                                                                B
                                                                    ,                            (1)
                                          δt
                                                         γB
                                  dfbtB = −ζ fbtB − f dt +      B
                                                              dWδ,t ,                            (2)
                                                           σδ

where WδB is a one-dimensional process that is Brownian under the probability measure that reflects
the expectations of Group B.


   From Equation (1), we see that fbtB is the growth rate of δ conditionally expected by Group B
and Equation (2) postulates that this expected growth rate follows a mean reverting Ornstein-
Uhlenbeck process, with the mean-reverting parameter given by ζ > 0. The coefficients γ B and σ δ
are assumed to be positive and constant. An interpretation of γ B is given in the next subsection.
We refer to the pair of equations (1)–(2) as the “fundamental system”.

   Our economy is a heterogeneous-expectations economy, where the belief of Group A about the
expected growth rate of aggregate dividends differs from that of Group B.


Assumption 2 Group A believes that the expected growth rate of aggregate dividends is equal to:

                                              fbtA = fbtB − gbt .                                (3)

Hence gbt is the “ difference of opinion”. The dynamics of the difference of opinion are specified to
follow an Ornstein-Uhlenbeck process that mean reverts (ψ > 0) to zero:

                                                        B              B
                                gt = −ψb
                               db      gt dt + σ gb,δ dWδ,t + σ gb,s dWs,t ,                     (4)
                            σ gb,δ ≥ 0; σ gb,s ≤ 0.

where WsB is a second one-dimensional process, independent of Wδ , that is Brownian under the
probability measure that reflects the expectations of Group B.


                                                      5
   In the equation above, the volatilities σ gb,δ and σ gb,s are constant with the signs postulated. An
interpretation for them and a justification for the sign assumptions are given in the next subsection.

   Because of the difference of opinion about the conditionally expected growth rate of aggregate
dividends, the two groups have different probability beliefs:


Assumption 3 Group A differs from Group B in its beliefs about the aggregate dividends process.
Group A’s probability beliefs at time t are represented by a change of measure η, where {η t } is a
strictly positive martingale process. For any event eu belonging to the σ-algebra of time u, we have:
                                                                 
                                                            ηu
                                       EA           B
                                        t [1eu ] = Et          1eu .                                (5)
                                                            ηt


   In the eyes of Group B, η captures the way in which Group A’s probability beliefs differ from
theirs. We call η the “sentiment” variable. Girsanov’s theorem tells us how the difference of
opinion gets encoded into η to generate different probability beliefs. When Group B is currently
comparatively pessimistic (b
                           gt < 0), Group A views positive innovations in δ (or s) as more probable
than Group B does. This, from Girsanov’s theorem, implies positive innovations in the change of
measure η for those states of nature in which δ (or s) has positive innovations:


Lemma 1 (Girsanov)
                                          dη t      1  B
                                               = −b
                                                  gt dWδ,t .                                        (6)
                                           ηt       σδ


   We refer to the pair of equations (4)–(6) as the “sentiment system”.

   The joint dynamics of the four state variables, {δ, η, fbB , gb}, in the eyes of Group B are com-
pletely characterized by the Markovian system (1), (2), (4), and (6). Three of the four state
variables, namely δ, η and fbB , are always perfectly correlated, but δ and fbB are always positively
correlated with each other, while the diffusion vector of η has the sign opposite to the sign of gb.
Of these four state variables, two will have a direct, immediate effect on the economy. They are
the fundamental, δ, and the sentiment, η. The fundamental moves independently of sentiment
but sentiment is correlated with the fundamental for reasons that will be made clear shortly. The
other two state variables, fbB and gb, have only an indirect effect in that they solely act on the first
two: fbB is the current estimate of the drift of δ by Population B, and the difference of opinion, gb,
determines the diffusion of sentiment, η. Functionally speaking, the “fundamental system” (1)–(2)
and the “sentiment system” (4)–(6) are unrelated to each other but they are correlated. Instanta-
neously, the four state variables, {δ, fbB , η, gb}, which are driven by only two Brownians, WδB and


                                                   6
WsB , have the following 4 × 2 diffusion matrix:
                                                                       
                                                δσ δ > 0         0
                                                 γB
                                            
                                                 σδ   >   0      0      
                                                                        .                                        (7)
                                                                       
                                                  −η σgbδ
                                            
                                                                0      
                                                σ gb,δ ≥ 0 σ gb,s ≤ 0


    In summary, there are two distinct effects of heterogeneous beliefs and their dynamics.8 One
determines the volatility of sentiment, the other the volatility of volatility of sentiment so that, in
essence, our model is a model of stochastic volatility in a state variable. The difference of opinion gb
scales the diffusion of η, which implies that η has a diffusion that can take large positive or negative
values. Sentiment or heterogeneity of beliefs, η, is volatile. This first effect is cumulative over time,
or long term. Second, the difference of opinion, gb, itself is stochastic. Even when the two groups of
investors happen to agree today about the growth rate of aggregate dividends (b
                                                                              g = 0), all investors
still know that they will revise their future estimates of the growth rate, and that they will do so in
different ways, so that they will not agree tomorrow. This second effect (the effect of the dynamics
of heterogeneous beliefs) is instantaneous or short-term.

    To understand the long-run effects of a random shock pair dWtB = {dWδ,t
                                                                        B , dW B } occurring at
                                                                              s,t
date t, we shall have occasion in Section 7 to use Malliavin calculus, which is a form of calculus
that tells how shocks occurring today affect the values of variables in the distant future.


2.2    An information-processing interpretation for the formation of beliefs

In the previous subsection, the dynamics for the beliefs of the two agents are specified exogenously.
In this subsection, we show that these dynamics can be viewed as being the result of a learning
process similar to that proposed by Scheinkman and Xiong (2003).

    We start by re-specifying the process for aggregate dividends δ under the effective measure.


Assumption 10 The stochastic process for δ is:

                                                dδ t
                                                     = ft dt + σ δ dZtδ ,                                         (8)
                                                δt

where Z δ is a Brownian under the effective probability measure, which governs empirical realizations
of the process. The conditional expected growth rate of aggregate dividends, ft , behaves according
   8
     We emphasize that two state variables, gb and η, are needed in our Markovian formulation to capture the dynamics
of heterogeneous beliefs and their effects, unlike what happens in, e.g., Barberis, Shleifer, and Vishny (1998). As is
noted below, one captures an instantaneous effect and the other a lasting effect.



                                                           7
to:
                                    dft = −ζ ft − f dt + σ f dZtf ;
                                                   
                                                                             ζ > 0,                                (9)

where Z f is a Brownian under the effective probability measure.


      We assume that the conditional expected growth rate of dividends, f , is not observed by any
agent, and thus, must be estimated by them.


Assumption 20 All investors estimate, or filter out, the current value of f and its future behavior
using the observation of the current dividend, δ, and the observation of a public signal, s, which
has the following process:9
                                                    dst = σ s dZts ,                                              (10)

where Z s is a third Brownian under the objective probability measure as well.


      All three Brownians, {Z δ , Z f , Z s }, are uncorrelated with each other (under the objective prob-
ability measure and any measure equivalent to it) so that, instantaneously, innovations dZ s in the
signal convey no information about innovations dZ f in the unobserved variable. That is, the signal
is pure noise.

      Finally, we assume that agents in Group A are overconfident about the signal while agents in
Group B are not.


Assumption 30 Agents in Group A perform their filtering under the overconfident belief that the
signal, s, has positive correlation φ ∈ [0, 1] with f when, in fact, it has zero correlation. The
“model” they have in mind is:
                                                                   q
                                        dst =   σ s φdZtf   + σs    1 − φ2 dZts .                                 (11)

Group B, on the other hand, believes properly that the true correlation is zero.


      Now, because of the assumed nonzero correlation φ in the eyes of Group A, the signal provides
the agents of that group with short-run, albeit false, information about the current shock to the
dividend growth rate.

      This single number φ, which we call the “overconfidence coefficient”, parameterizes the degree
of excess confidence placed in the signal by Group A. It could be argued that overconfident agents
   9
     Note that the process specified for the signal has only a diffusion term but no drift term. We choose this
specification because it makes it easier to interpret the results. For the case where the signal has also a drift term,
we refer the reader to earlier versions of this paper.



                                                            8
should gradually detect from their empirically-realized consumption losses that their beliefs are
overconfident. We do not address this issue, but in Section 8 we show that the consumption losses
of the overconfident group are “so gradual” that detection may be difficult.

   From filtering theory (see Lipster and Shiryaev (2001, Theorem 12.7, page 36)), the conditional
expected values, fbA and fbB , of f according to individuals of Group A (φ 6= 0) and Group B obey
the following stochastic differential equations:10

                                            γ A dδ
                                                         
                           A
                                
                                   A
                                       
                                                       A     φσ f
                        dft = −ζ ft − f dt + 2
                         b        b                − ft dt +
                                                     b            ds,                                         (12)
                                            σδ   δ            σs

                                            γ B dδ
                                                       
                          B        B                   B
                        dft = −ζ ft − f dt + 2
                         b        b                − ft dt .
                                                      b                                                       (13)
                                            σδ   δ

The numbers γ A and γ B are the steady-state variances of f as estimated by Group A and B re-
spectively.11 These variances would normally be deterministic functions of time. But for simplicity
we assume, as did Scheinkman and Xiong (2003), that there has been a sufficiently long period of
learning for people of both groups to converge to their level of variance, irrespective of their prior.

    In our model, no agent knows the true state of the economy. Hence, the objective measure
is not defined on either agent’s σ-algebra and we can ignore it for the purpose of calculating the
equilibrium. In the previous subsection, we wrote the above stochastic differential equations directly
in terms of processes that are Brownian motions under subjective probability measures. We have
used B’s probability measure as the reference measure. Under this measure, the process for the
signal is:
                                                             B
                                                 dst = σ s dWs,t .                                            (14)

    Based on Assumptions 10 –30 , the following lemma gives the relation between the specification
of the model in the previous subsection and this subsection.

  10
     Observe once again that output δ serves as a signal, which causes an update of the growth rate of output, just
as the signal s does.
  11
     The steady-state variances of f as estimated by Group A and Group B are, respectively:
                                0s                           1            s                !
                        A     2@      2
                                          `     2
                                                  ´ σ 2f          B     2    2     2 1
                       γ , σδ        ζ + 1−φ             − ζ A, γ   , σ δ  ζ   + σ f 2 − ζ   .
                                                    σ 2δ                            σδ

As has been pointed out by Scheinkman and Xiong (2003), γ A decreases as φ rises, which is the reason for which
Group A is called “overconfident”. γ A starts at the value γ B when φ = 0 and would reach γ A = 0 when φ → 1. The
signal can lead Group A ultimately to complete (and foolish) unconditional certainty.




                                                        9
Lemma 2 In Equation (4) the mean-reversion parameter for the difference-of-opinion process, ψ,
and the volatilities, σ gb,δ and σ gb,s , are given by:

                                                               γA
                                                 ψ = ζ+             > 0,                                          (15)
                                                               σ 2δ

                                                          γB − γA
                                               σ gb,δ =           ≥ 0,                                            (16)
                                                             σδ
                                               σ gb,s = −φσ f ≤ 0.                                                (17)

    From the above lemma, we see that the mean-reversion parameter, ψ, is positive. The diffusion
coefficients have the property that σ gb,δ ≥ 0 and σ gb,s ≤ 0. Moreover, both coefficients are equal
to zero when the overconfidence coefficient φ takes the value zero so that gb has zero diffusion and
the rank of the diffusion matrix drops from 2 to 1. This is because, in that case, signal shocks are
ignored by all.


3     Equilibrium allocation of consumption and pricing

We are interested in the interaction between two groups, who harbor different and evolving ex-
pectations. Differences in risk aversion and differences in the rate of impatience are not our main
focus. So, we restrict our analysis to the setting in which

Assumption 4 Both groups have power utility with the same risk aversion, 1 − α, and rate of
impatience, ρ.


3.1    The individual’s optimization problem

Assuming a complete financial market,12 we can use the martingale, “static” formulation (as done
in Cox and Huang (1989) and Karatzas, Lehoczky, and Shreve (1987)). Then, the problem of
Group B is to maximize the expected utility from lifetime consumption:
                                    Z ∞
                                              1 B α
                             sup EB
                                         e−ρt   c      dt; α < 1,                                                 (18)
                              c      0        α t

subject to the lifetime budget constraint:
                                   Z ∞                   Z               ∞
                                                     B B
                                EB      ξB c
                                         t t
                                            B
                                              dt = θ  E                      ξB
                                                                              t δ t dt,                           (19)
                                           0                         0
   12
      David (2007) says that the fluctuating difference of measure η between the two groups makes the market “effec-
tively incomplete”. That is a matter of semantics. Analytically, the equilibrium can be obtained by complete-market
methods. It would probably be more descriptive of the analytical structure that is reflected in Equation (21) below,
to say that the fluctuating η causes the utility function of agents A to become “effectively state dependent” (i.e. non
von Neuman-Morgenstern) relative to the probability measure of Group B. See Riedel (2001).



                                                          10
where ξ B is the change of measure from Group B’s probability measure to the risk neutralized
                                                                                           B
measure (which we determine in the next subsection) and θ                                      is the share of equity with which B
is initially endowed. The first-order condition for consumption equates marginal utility to λB ξ B
                                                                                                 t ,
where λB is the Lagrange multiplier of the budget constraint (19):
                                                                 α−1
                                                     e−ρt cB
                                                           t               = λB ξ B
                                                                                  t .                                         (20)

                                                 A               B
       Group A holds an initial share θ = 1 − θ                      of the equity and faces an analogous optimization
problem. The only difference is that Group A uses a probability measure that is different from that
of Group B. Under B’s probability measure, the problem of A can be stated as follows:13
                                       Z ∞
                                                     1 A α
                                sup EB      η t e−ρt   c    dt,                                                               (21)
                                  c     0            α t

subject to the lifetime budget constraint:
                                   Z ∞                   Z                             ∞
                                                     A B
                                EB      ξB c
                                         t t
                                            A
                                              dt = θ  E                                    ξB
                                                                                            t δ t dt.                         (22)
                                                0                                  0

The first-order condition for consumption in this case is
                                                                  α−1
                                                    η t e−ρt cA
                                                              t             = λA ξ B
                                                                                   t ,                                        (23)

where λA is the Lagrange multiplier of the budget constraint (22).


3.2      Equilibrium pricing measure

An equilibrium is a price system and a pair of consumption-portfolio processes such that: (i) in-
vestors choose optimally their consumption-portfolio strategies, given their perceived price pro-
cesses; (ii) the perceived security price processes are consistent across investors; and (iii) commodity
and securities markets clear.

       The aggregate resource constraint, from (20) and (23), is
                                                            1
                                            λA ξ B  ρt
                                                         α−1
                                                 t e
                                                                                          1
                                                                 + λB ξ B  ρt
                                                                                        α−1
                                                                        t e                    = δt.                          (24)
                                               ηt

Solving this equation:
                                                      "             1                    1    #1−α
                                                −ρt        ηt        1−α            1       1−α
                          ξB
                           t (δ t , η t )   =e                             +                             δ t α−1 ,            (25)
                                                           λA                      λB
  13
    We could also have˜ definedˆ ξ A , the
                                        ˜ density
                                              ˆ that
                                                   ˜ makes prices martingales under A’s probability measure. For
any event e: E ξ 1e = EB ηξ A 1e = EB ξ B 1e , which implies that ξ B = ηξ A . The martingale pricing density
              A
                ˆ A
would then be defined relative to each agent’s probability measure. But the risk neutral measure is the same in the
end.



                                                                     11
and, therefore:

                                            cA
                                             t = ω(η t ) δ t ,                                                (26)
                                            cB
                                             t = (1 − ω(η t )) δ t ,                                          (27)

where:14
                                                                          1
                                                                  ηt       1−α
                                                                  λA
                                       ω(η t ) ,             1                       1    ,               (28)
                                                     ηt       1−α               1       1−α
                                                     λA
                                                                    +          λB

is the share of consumption of Group A.15 The consumption-sharing rule is linear in δ because both
groups have the same risk aversion. But its slope is stochastic because the share of consumption
allocated to each group, ω(η), is driven by sentiment, η.

       The equilibrium value of ξ B – the martingale pricing density under B’s probability measure –
depends on η, the probability density of A relative to B, that is, sentiment. In addition to reflecting
the abundance or scarcity of goods, as is usual in the absence of state preference or heterogeneous
beliefs, the state prices also incorporate a power (or Hölder) average of the probability beliefs of
the two groups (given by the term that is in square brackets in Equation (25)). As η fluctuates,
average probability belief or “sentiment” fluctuates with it. In writing his/her budget constraint
based on ξ B , Agent B anticipates A’s beliefs. This reflects “higher-order beliefs.”

       Notice in Equation (25) that the functional forms of ξ B with respect to δ and with respect to η
are very different from each other. This is because fundamental risk and sentiment risk have very
different economic effects on utility and marginal utility. From Equation (25), one can show that
the first derivative of ξ B (δ, η) with respect to δ is negative while the second derivative is positive.
The second derivative of the function ξ B (δ, η) with respect to η has the same sign as α. The cross
derivative of the function ξ B (δ, η) is unambiguously negative. These derivatives have the following
economic interpretation.

       The fundamental, δ, has the customary aggregate effect on both groups: when output increases,
marginal utility decreases. Thus, an increase in future expected output decreases the expected value
of discount factors. Furthermore, marginal utility is convex with respect to δ. Jensen’s inequality
implies that an increase in fundamental risk increases the expected value of discount factors, which
is the familiar precautionary-saving motive.16
  14
     For arbitrary (but von Neuman Morgenstern) utility, ω would be defined as the ratio of Group A’s absolute risk
tolerance over the sum of absolute risk tolerances of Group A and Group B. See Lintner (1969) and Basak (2005).
In the isoelastic case, this ratio reduces to the share of consumption.
  15
     Along any sample path of the economy, ω(η) is monotonically increasing with η. Thus, we can use ω as a
representation of η. As state variable, η is equivalent to the consumption shares of the two subpopulations.
  16
     For arbitrary (but von Neuman Morgenstern) utility, the curvature of ξ B with respect to the fundamental δ is
equal to total absolute risk aversion multiplied by total absolute prudence. See Basak (2005).



                                                              12
    In contrast to the fundamental, which is an aggregate shock, sentiment acts as a wedge between
the two groups.17 Because the second derivative of ξ B (δ, η) with respect to η has the same sign as
α, if α < 0 (risk aversion greater than 1), discount factors are concave with respect to η so that an
increase in sentiment risk (the variance of η), by Jensen’s inequality, reduces the expected values
of all the future stochastic discount factors written with respect to B’s measure.


3.3     Securities-market implementation of the complete-market equilibrium

Because there are two Brownians that agents care about, WδB and WsB , three securities that are
linearly independent are required to complete financial markets and implement the equilibrium.
The choice of securities is arbitrary. We assume that there is a riskless, instantaneous bank deposit
with a rate of interest r. The second security, equity or total wealth, pays the aggregate dividend
δ perpetually. The third security we introduce is a perpetual bond paying continuously and indef-
initely a coupon equal to one unit of consumption per unit of time. We shall denote the price at
date t of the bond as Pt and the price of equity as Ft .

    The equilibrium price of a fixed-income bond, which we denote by P , can be obtained directly
from the pricing measure (25):18
                                                                      ∞
                                                                                            ξB
                                                    Z                                       
                                         B                                                   u
                                      P f , η, gb, t =
                                        b                                 EB
                                                                           δ,η,fbB ,b
                                                                                                 du.                      (29)
                                                                  t
                                                                                    g       ξB
                                                                                             t

Similarly, the equilibrium price of long-lived equity is the discounted sum of all future dividends.
This is also the total wealth of the economy, which we denote by F :
                               Z ∞                B 
                                                    ξu
                                                                 Z ∞            B 
                                                                                ξu δu
                      B                 B                             B
              F δ, f , η, gb, t =
                     b                 Eδ,η,fbB ,bg B δ u du = δ     Eη,fbB ,bg B     du.                                 (30)
                                   t                ξt            t             ξt δt

We shall also have occasion to refer to the single-payoff versions of these securities, in which case
we shall add a superscript T for the maturity date of the payoff. So, for instance, the price today
of a claim paying a single dividend δ T is:
                                                                                  B 
                                                                                ξ
                                       F   T
                                                   δ, f , η, gb, t = Eδ,η,fbB ,bg TB δ T .
                                                      bB              B
                                                                                                                          (31)
                                                                                  ξt
   17
      For arbitrary (but von Neuman Morgenstern) utility, Basak (2005) shows that the curvature of the ξ B with
respect to η is given by a combination of the risk aversions and the prudences of the two groups. One can verify on
his formula that the knife-edge case of zero curvature is the case in which both groups have log utility. A special case
of his result is obtained here for isoelastic utility.
   18
      The “growth conditions” sufficient to guarantee that the time integrals in the case of perpetual securities converge
(and that the interchange of the integration and expectation operators in (29) and (30) is allowed) are provided in
Lemma 6. Similar to the way it has been done in Brennan and Xia (2001), one can show that the condition for the
equity price to converge requires that the long-run growth rate of aggregate dividends be less than the long-run risk
free rate. It is worth noting that this condition depends only on the anticipated behavior of dividends, EB     fbB
                                                                                                                    [( δδu )ε ],
                                                       ηu χ
and not on the anticipated behavior of sentiment, EB
                                                   b [( η ) ], which implies that it is independent of the heterogeneity
                                                   g
of agents in the economy.



                                                                  13
4        Transform analysis and other technical issues

From Equation (25) for the martingale pricing density under B’s probability measure and Equa-
tions (29) and (30) for the prices of the bond and equity, we see that the joint conditional
distribution of η u and δ u , given δ t , η t , fbtB , gbt at t will be needed to characterize the prices of
distant-maturity claims, and hence, portfolio policies.                             That joint distribution is not easy to
obtain but, remarkably, its characteristic or moment generating function or Fourier transform
      h  ε  χ i
        δu    ηu
EBbB     δ     η   ; u ≥ t; ε, χ ∈ R (or C) can be obtained in closed form.
 f ,b
    g


Proposition 1                1. The moment-generating-function for the joint distribution of δ and η at ma-
         turity u under the measure of Group B is given by
                                                 ε         χ 
                                              δu          ηu                           
                               EB
                                fbB ,b
                                     g
                                                                      = Hf fbB , t, u; ε × Hg (b
                                                                                               g , t, u; ε, χ) ,          (32)
                                               δ          η

         where
                                 ( 
                                                 1  bB     h              i 1
                   B                                                  −ζ(u−t)
             Hf f , u, t; ε = exp ε f (u − t) +
                  b                                    f −f 1−e                 + ε (ε − 1) σ 2δ (u − t)
                                                   ζ                               2
                                                                                      )
              ε2 γ B h          i2 ε 2 σ 2 h                                        i
                                         f
             + 2 1 − e−ζ(u−t) +              2ζ (u − t) − 3 + 4e−ζ(u−t) − e−2ζ(u−t)     ,           (33)
               2ζ                   4ζ 3

               g , u, t; ε, χ) = exp A1 (χ; u − t) + ε2 A2 (χ; u − t) + εb
                                                                         g B (χ; u − t) + gb2 C (χ; u − t) .
                                    
           Hg (b
                                                                                                                          (34)
         and where the functions A1 , A2 , B and C are given in the proof. Moreover, the moment-
         generating-function is finite and real for 0 ≤ χ ≤ 1 and ε ∈ R.
                                                      
           ∂
                        fbB , u, t; ε = Hf fbB , u, t; ε ζε 1 − e−ζ(u−t) and has the sign of ε.
                                                                        
    2.         Hf
         ∂ fbB

                                                                                                 ∂Hg
    3. For 0 ≤ χ ≤ 1, in a neighborhood of gb = 0, the derivative                                 ∂b
                                                                                                   g   is nonnegative if ε < 0
         (εB (χ; u − t) ≥ 0) and nonincreasing (C (χ; u − t) ≤ 0).


    Observe, from Equations (32), (33) and (34), that the moment-generating-function for the joint
distribution of δ and η takes the form of a product of a function Hf , which is linear exponential in
fbB , with a function Hg , which is quadratic exponential in gb with all coefficients being functions only
of time and being available in closed form. The formula is a generalization of Heston (1993) and Kim
and Omberg (1996) (recently extended by Liu (2006)) and perhaps others. Our economy’s dynamic
system belongs to the category of exponential affine-quadratic models. Cheng and Scaillet (2006) in


                                                                        14
a term-structure context, have recently clarified the manner in which exponential affine-quadratic
models can be reformulated as exponential affine models,19 for which solutions are well-known.

       The inverse transformation to obtain securities prices can be performed in general by means
of the Fast Fourier Transform (see the appendix). For the sake of speed, precision and simplicity,
we conduct the calculation of these prices for the special case in which risk aversion is an integer,
(1 − α) ∈ N, which excludes the cases of risk aversion smaller than 1 (that is, α > 0). While in
general the measure (25) is a weighted power mean of the two terms corresponding to the two
groups, in the special case of risk aversion being an integer, the pricing measure can be written
in an alternative way by expanding the bracket into an exact finite sum by virtue of the binomial
formula:20
                         "              1                       1    #1−α                    1−α
                                                                                                                          j
                                                                                                         η u λB 1−α
                                                                                                           
                               ηu       1−α             1       1−α                         1 X j
                                               +                              =                   C1−α
                               λA                      λB                                  λB j=0          λA

                                                                                              1−α
                                                                                                           ω(η u ) j
                                                                                                                    
                                                                                            1 X j
                                                                              =                   C1−α                 ,                      (35)
                                                                                           λB j=0        1 − ω(η u )

       j                                                                    1−α
                                                                                  
where C1−α denotes the binomial coefficient                                  j        . Therefore, using the moment generating func-
tion obtained in (32), the price of the bond in (29) is obtained by integrating the following over
future times u:21

                             ξB
                                              
                              u (δ u , η u )
                                                                                  
             EB
              η,fbB ,b
                                                    = e−ρ(u−t) Hf fbB , t, u; α − 1 × [1 − ω(η)]1−α                                           (36)
                     g        ξB
                               t (δ, η)
                                                                1−α                            j                                   
                                                                X      j            ω(η)                                         j
                                                            ×         C1−α                           Hg        gb, t, u; α − 1,           ,
                                                                                  1 − ω(η)                                      1−α
                                                                j=0


and the price of equity in (30) is obtained from:22

                              ξB
                                                   
                               u (δ u , η u ) δ u
                                                                                  
              EB
               η,fbB ,b
                                                        = e−ρ(u−t) Hf fbB , t, u; α × [1 − ω(η)]1−α                                           (37)
                      g        ξB
                                t (δ, η) δ
                                                                      1−α                            j                           
                                                                      X      j               ω(η)                              j
                                                                 ×          C1−α                           Hg gb, t, u; α,              .
                                                                                           1 − ω(η)                           1−α
                                                                      j=0

  19
     That would be done in our context simply by introducing an additional state variable: Z , gb2 .
  20
     Yan (2006) uses a similar approach. Recall that 1 − α > 0. The parameter χ in the function Hg takes values
ranging from 0 to 1.
  21
     To obtain the bond price, the parameter ε in the Hg function is set at α − 1, which is negative unambiguously.
  22
     To obtain the stock price, the parameter ε in the Hg function is set at α, which is negative when risk aversion is
greater than 1.




                                                                             15
Asset prices in our framework are weighted sums of exponential-quadratic functions. The time vary-
ing weights, ω(η), capture the role of the fluctuating distribution of consumption in the population,
itself arising from sentiment fluctuations, η.


5    Excess volatility

In this section, we verify that overconfident beliefs induce higher volatility of asset returns than
would be the case if all investors had proper beliefs. To do so, we study the diffusion matrix of
stocks and bonds, which will also be needed when making up portfolios.

    The diffusion vector of the stock, F , and the bond, P , is its sensitivity or “exposure” to the
shocks in the fundamental and in the signal, dWδB and dWsB , respectively. It can be obtained
from the gradient of the price function postmultiplied by the diffusion matrix of state variables
(Equation (7)). Each security’s price exposure, therefore, has four components corresponding to
                                                                                             
the four elements of the gradient vector: ∂F
                                           ∂δ , ∂F ∂F ∂F
                                                   ,  ,
                                                 bB ∂η ∂bg   for the stock, and   ∂P ∂P ∂P ∂P
                                                                                  ∂δ ,   ,  ,
                                                                                       bB ∂η ∂b
                                                                                              g
                                                                          ∂f                                                    ∂f
for the bond, all these derivatives being known in closed form. The diffusion vectors are:

                                                                                                     δσ δ        0
                                                                                                                          
                                                 ∂F           ∂F         ∂F       ∂F         γB
                                             "                                          #
                                                                                                                 0
                                    
                           diffF
                                                                                                                           
                                                 ∂δ          ∂ fbB       ∂η       ∂b
                                                                                   g         σδ
                                         =                                                                                 .        (38)
                                                                                                                           
                                                 ∂P           ∂P         ∂P       ∂P             g
                           diffP                                                             −η σδ              0
                                                                                                b
                                                 ∂δ          ∂ fbB       ∂η       ∂b
                                                                                   g                                       
                                                                                                   γ B −γ A
                                                                                                      σδ       −φσ f

    Given the emphasis of this article, however, it will be useful to separate the diffusion components
that arise from the movements of the difference of opinion, gb. We define the diffusion arising from
the first three state variables as:
                                                                                                               
                                                       "    ∂F          ∂F       ∂F
                                                                                           #         δσ δ     0
                                   diff3 F                    ∂δ         ∂ fbB     ∂η                γB
                                                     ,        ∂P          ∂P       ∂P
                                                                                               
                                                                                                     σδ       0 
                                                                                                                .                   (39)
                                   diff3 P
                                                                                               
                                                              ∂δ         ∂ fbB     ∂η
                                                                                                   −η σgbδ    0

Clearly, the total exposures are:
                                                                             "         #
                                                                              ∂F
                               diffF                 diff3 F                      ∂b
                                                                                   g
                                                                                           h
                                                                                                γ B −γ A
                                                                                                                       i
                                             =                           +        ∂P               σδ         −φσ f        .         (40)
                               diffP                 diff3 P                      ∂b
                                                                                   g

                  ∂F            ∂P
The derivatives   ∂b
                   g   and      ∂b
                                 g     capture the exposures to changes in the difference of opinion. By
definition, the exposures to Ws shocks arises only from these derivatives. Item 3 of Lemma 1 above
implies that, in a neighborhood of gb = 0,

                                             ∂F                                        ∂P
                                                             ≥ 0, and                                ≥ 0,                            (41)
                                             ∂b
                                              g      g
                                                     b=0                               ∂b
                                                                                        g      g
                                                                                               b=0



                                                                             16
  Table 1: Choice of parameter values and benchmark values of the state variables
       This table lists the parameter values used for all the figures in the paper. These values are similar to
       the estimation results reported in Brennan and Xia (2001). The table also indicates the benchmark
       values of state variables, which are the reference values taken by all state variables except for the
       particular one being varied in a given graph.
           Name                                                                           Symbol      Value
           Parameters for aggregate endowment and the signal
           Long-term average growth rate of aggregate endowment                              f¯        0.015
           Volatility of expected growth rate of endowment                                   σf         0.03
           Volatility of aggregate endowment                                                 σδ         0.13
           Mean reversion parameter                                                          ζ           0.2
           Parameters for the agents
           Agent A’s correlation between signal and mean growth rate                        φ           0.95
           Agent B’s correlation between signal and mean growth rate                        —              0
           Agent A’s initial share of aggregate endowment                                 λB /λA           1
           Time-preference parameter for both agents                                         ρ          0.10
           Relative risk aversion for both agents                                          1−α             3
           Benchmark values of the state variables
           The level of aggregate dividends                                                    δ          1
           The change from B’s measure to A’s measure                                         η           1
           The population average belief about expected rate of growth                       fbB          f
           The difference in opinions: fbB − fbA                                              gb      −0.03


when risk aversion is greater than 1, because ε is set at α and at α − 1 respectively. It also implies
that these derivatives are nonincreasing in gb.


5.1       Illustration

In order to illustrate the effect of expectations and their dynamics on securities prices, we specify
numerical values for the parameters of the model. Even though our objective is not to match the
magnitude of particular moments in the data, we would like to work with parameter values that
are reasonable.23 The parameter values that we specify are based on the estimation undertaken in
Brennan and Xia (2001) for a model similar to ours.24 We limit ourselves to the case in which risk
aversion is greater than one (α < 0). The particular values chosen for all the parameters are listed
in Table 1.
  23
     The range of parameter values that can be considered is restricted by the need to satisfy the growth conditions in
Lemma 6, so that the prices of perpetual assets (equity and consol bond) are well defined. This limits, in particular,
the range of values for the discount rate, or for risk aversion, that can be considered. Because of this constraint,
the risk aversion we consider is somewhat too low to account for the equity premium by itself. The presence of
overconfident traders, however, suffices to bring the equity premium up to realistic levels.
  24
     We have not set the volatility of the signal, σ s , at any particular number because that is immaterial and what
matters is only the level of the correlation with the expected rate of growth of the fundamental.




                                                          17
       As we analyze securities’ returns and portfolio strategies, we display results for the following
four cases:

Case 1. Where all agents have the proper beliefs (φ = 0) and are in agreement about the growth
         rate of aggregate dividends (b
                                      g = 0, or zero difference of opinion). This corresponds to the
         setting in a standard model where all agents have homogeneous beliefs and identical priors.

Case 2. Where all agents have the proper beliefs (φ = 0) but disagree about the growth rate
          g 6= 0). This corresponds to the setting where agents have the same beliefs but different
         (b
         priors.

Case 3. Where one group of agents is overconfident (φ = 0.95)25 but currently in agreement with
         the other group about the growth rate (b
                                                g = 0). Because Group A is overconfident in the
         signal, even though they currently agree with Group B, they will disagree in the future.

Case 4. Where one group of agents is overconfident (φ = 0.95) and disagrees today about the
                      g 6= 0). In this case, agents of the two groups have different beliefs and these
         growth rate (b
         beliefs fluctuate randomly over time.

       Our results are displayed in figures. Each plot in the figures has on the x-axis either current dif-
ference of opinion, gb, or the relative share of aggregate consumption of the overconfident Groups A,
ω. Each plot has typically three curves on it, with the dotted line representing the case where all
agents have the proper beliefs (φ = 0), the dashed line representing the case where Group A is
overconfident (φ = 0.95) and the continuous line representing the construct “diff3 ” containing three
terms only, agents A being, however, overconfident.

       Note that when φ = 0, everyone has proper beliefs and so they ignore the signal. This implies
that effectively there is only one shock in the economy Consequently, one risky security is sufficient
to complete the financial market; that is, the equity and the bond are redundant relative to each
other.

       Figure 1 portrays the relative diffusion vectors for stocks and bonds with respect to the Wδ
shock. We draw three inferences from this figure. First, we see that the dotted curves for the case
of proper beliefs and the solid line for the case of overconfident beliefs but ignoring the derivative
with respect to gb are very close to each other in all the plots:
                                            diffF                 diff3 F
                                                                         
                                              F           ≈         F              .                           (42)
                                            diffP                 diff3 P
                                              P     φ=0             P       φ6=0
                                                          B
  25
    When we vary the parameter φ, we adjust the ratio λλAη in such a way that the time-0 lifetime budget constraints
of the two groups still hold, with unchanged time-0 endowments of securities.



                                                          18
                                      Figure 1: Diffusion of equity and bond
       The figure has four plots. The top two show the diffusion of equity and bond rates of return
       with respect to the output shock as functions of the current difference of opinion, gb, for a value of
       sentiment such that ω = 0.5. The bottom two plots show the same as functions of ω for a value of the
       difference of opinion gb = −0.03. Each plot in the figure has three curves on it, with the dotted line
       representing the case where all agents have the proper beliefs (φ = 0), the dashed line representing
       the case where Group A is overconfident (φ = 0.95) and the solid line representing the construct
       “diff3 ” containing three terms only, Group A being, however, overconfident. All other parameter
       values used in this figure are given in Table 1.
                    Expos of equity to W∆                                                    Expos of bond to W∆
                                                                                                   -0.075

                             0.08                                                                    -0.1

                                                                                                   -0.125
                             0.06
                                                                                                    -0.15

                             0.04                                                                  -0.175
                                                                                                                                        `
                                                                                                                                        g
                             0.02                                          -0.1          -0.05                      0.05          0.1
                                                                                                   -0.225
                                                             `
                                                             g                                      -0.25
       -0.1       -0.05                   0.05         0.1



   Expos of equity to W∆                                                   Expos of bond to W∆

           0.12                                                                                                                         Ω
                                                                                             0.2       0.4     0.6         0.8      1
           0.11                                                               -0.025

                                                                 Ω             -0.05
                       0.2      0.4      0.6     0.8         1
           0.09                                                               -0.075
           0.08                                                                   -0.1
           0.07
                                                                              -0.125
           0.06
                                                                               -0.15
           0.05




                                                                                  
Analyzing this small difference, one would find that the derivatives F1 ∂F , 1 ∂F
                                                                        ∂δ F ∂ fbB
                                                                                     for the stock
                 
and P1 ∂P    1 ∂P
        ∂δ , P bB   for the bond hardly change with φ and that the difference arises mostly from
                  ∂f
                                                                                                       1 ∂F          1 ∂P 26
a slight dependence on φ of the derivatives with respect to sentiment                                  F ∂η   and    P ∂η .      Second,
comparing the dashed line for the case of overconfidence to the other two in any plot, we conclude
that the changes in the diffusion vector of assets arising from overconfidence are almost entirely the
result of the gb component. To understand the effect of gb, recall from Lemma 1, that the intercept
                                                       ∂F            ∂P
and slope of the two partial derivatives               ∂b
                                                        g   and      ∂b
                                                                      g   have respectively the signs of the εB (≥ 0) and
C (≤ 0) terms of the moment generating function. Furthermore, as we have indicated earlier in
Lemma 2, overconfidence has a marked effect on the diffusion of the difference of opinion gb, with
the signs indicated in Equation (7). Because (γ B − γ A )/σ δ ≥ 0, the traders know that a positive
  26
    Prior to integrating the present values of payoffs over future times, these logarithmic derivatives would be exactly
independent of φ. The value of φ affects only the relative weighting of the future payoffs.




                                                                     19
dWδB shock will increase the difference of opinion (see also Equation (4)) and because −φσ f ≤ 0,
a positive dWsB shock will decrease it.

       Thirdly, we see from Figure 1 that equity is mostly positively exposed to the realized innovation
in the fundamental, dWδB , whereas the bond is negatively exposed. The reason for this difference
between the equity and the bond is that a positive shock to the fundamental affects equity in
two ways: it changes the immediate payoff upward but also the valuation operator downward; the
positive effect dominates, at least in a neighborhood of gb = 0.27 For bonds, an innovation in the
fundamental has only a valuation effect, which is negative (diffP < 0). The signal innovation,
dWsB , is similar in its effects but it has no immediate payoff implication, so that both the equity
and the bond have a negative exposure to it, which, however, is not displayed in the figure.


5.2      Volatilities and correlation

The volatilities of assets are obtained from the diffusion vectors described in the previous subsection.
The effect of the overconfidence of Group A is generally to increase the volatility of asset prices.
This occurs because of the greatly increased volatility of the state variable gb representing the
difference of opinion, which also increases the volatility of sentiment, η.

       Figure 2 plots the volatilities of the rate of return on equity and the bond, and the correlation
between them. In the first column of the figure, these three quantities are plotted against difference
of opinion, gb, for the two cases of overconfident beliefs (φ = 0.95, dashed line) and proper beliefs
(φ = 0, dotted line). In the second column of the figure, these three quantities are plotted for the
same two cases but now against the relative weight of Group A, ω.

       From the first two plots in the left column of Figure 2, we see that overconfident investors
create “noise” that increases the volatility of both risky assets—the stock and the bond.                     28   The
last row of the plots in Figure 2 shows that the correlation between stock and bond returns increases
or decreases with the presence of overconfident investors, as well as with the difference of opinion
between the two investor groups, depending on whether it is equal to plus or minus 1 in the absence
of overconfidence. In a neighborhood of gb = 0, when risk aversion is greater than 1, it increases
as the prices of the equity and the bond move in the same direction when expectations of future
growth fluctuate.
  27
     This is in part the result of the unambiguous negative effect of an increase in fbB on the price of equity for the
case where α < 0. However, a fundamental shock dWδB has an effect also on the other state variables.
  28
     The values produced by the model for the volatility of bond returns (and interest rates) are regrettably too high
to fit real-world data. With a risk aversion smaller than 1, David (2007) was able to match the volatility of interest
rates much better. Alternatively, if one wanted to match interest-rate volatility, one could introduce habit formation.




                                                          20
         Figure 2: Volatilities of equity and bond returns and their correlation
    The first column of this figure plots against dispersion in beliefs, gb, the volatilities of equity and
    bond returns and their correlation, assuming that the two groups of investors have equal weight,
    ω = 0.5. In the second column of this figure, the same quantities are plotted but now against the
    relative weight of Group A in the population, ω, assuming that gb = −0.03. There are two curves
    in each plot: the dotted curve is for the case of proper beliefs (φ = 0) and the dashed curve is for
    overconfident beliefs (φ = 0.95). All other parameter values used in this figure are given in Table 1.
                               Equity volatility                                           Equity volatility
                                                                              0.2
                                   0.12
                                                                             0.18
                                    0.1
                                                                             0.16
                                   0.08
                                                                             0.14
                                   0.06                                      0.12

                                   0.04                                                                                  Ω
                                                                                     0.2     0.4      0.6      0.8   1
                                   0.02                                      0.08

                                                                `
                                                                g            0.06
                -0.1   -0.05                       0.05   0.1


                               Bond volatility
                                                                                            Bond volatility
                                   0.26
                                                                             0.325

                                                                               0.3
                                   0.24
                                                                             0.275
                                   0.22                                       0.25

                                                                             0.225
                                                                `
                                                                g
               -0.1    -0.05                       0.05   0.1                                                            Ω
                                                                                     0.2      0.4      0.6     0.8   1
                                   0.18                                      0.175

                                                                              0.15
                                   0.16


                                 Correlation
                                                                                              Correlation
                                                                              0.75
                                    0.2
                                                                               0.5
                                                                    `
                                                                    g
               -0.1    -0.05                       0.05   0.1                 0.25
                                   -0.2                                                                                  Ω
                                                                                     0.2      0.4      0.6     0.8   1
                                   -0.4                                      -0.25

                                   -0.6                                       -0.5

                                   -0.8                                      -0.75

                                                                                -1
                                     -1




   An exception to the increase in volatility arising from overconfidence is to be seen in the right-
hand column, middle row. When the consumption share of overconfident investors, ω, is sufficiently
low, it is possible for the volatility of bonds to be reduced by overconfidence, because of the opposite
effects of η and gb on the volatility of the bond price.

   In summary, overconfident investors create “noise”, which tends to increase the volatility of
both stock and bond returns and also the correlation between them. The volatilities and correlation
mostly increase with an increase in the relative weight of Group A in the population. We are going
to see now that overconfident investors also chase away from the bond and equity markets the
investors with proper beliefs.




                                                                        21
6     Equity-and-bond portfolio strategy of Group B analyzed ac-
      cording to motive

We now study the fluctuations of the wealth of Group B and deduce from it the main features of
the portfolio strategy of the investors with the proper beliefs.

    The wealth of agents of Group B can be determined by applying the same approach that we
used to find the equity and bond prices (see the appendix). To do so, we interpret the wealth of
agents of Group B as the price of a “security” whose flow payoff at future times u is the consumption
(27) of these investors:29

                                                                ∞
                                                                     ξB
                                                         Z                      
                   B                                                  u B
               F           δ, fbB , η, gb, t        =                EB cu du
                                                                      δ,η,fbB ,b
                                                        t            ξB
                                                                      t
                                                                               g
                                                        Z ∞                         
                                                    = δ     e−ρ(u−t) Hf fbB , t, u; α × [1 − ω(η)]1−α                                      (43)
                                                                 t
                                                                −α                             j                              
                                                                X       j          ω(η)                                     j
                                                           ×           C−α                           Hg       gb, t, u; α,           du.
                                                                                 1 − ω(η)                                  1−α
                                                                j=0



   Following Cox and Huang (1989), the portfolio choice of Group B in terms of equities and bonds
can be calculated from Group B’s demand for exposure to WδB , WsB shocks, which are themselves
                                                                  

obtained by multiplying the gradient vector of B’s wealth with respect to the four state variables by
the diffusion matrix of the four state variables given in Equation (7). If the investors had available
elementary securities on the shocks, the exposures would indicate the desired amounts of holdings.
If, however, they have access to an equity share and a bond, the investor needs to use these to
synthesize the desired exposures, to solve for θ| , a 1 × 2 vector, in the following system of two
equations:

                                                                                            σδ             0
                                                                                                                 
                                  h                                              i  γB                    0      
                                                   ∂F B    ∂F B         ∂F B        σδ
                                      FB                    ∂η           ∂b
                                                                          g             g
                                                                                                                  
                                                   ∂ fbB                            −η σδ                 0
                                                                                       b                         
                                                                                                                  
                                                                                        γ B −γ A
                                                                                           σδ          −φσ f

                                                                                                  σδ             0
                                                                                                                      
                                                                ∂F      ∂F       ∂F          γB
                                                   "                                    #
                                                       F                ∂η       ∂b
                                                                                  g          σδ                 0     
                                               |               ∂ fbB
                                      = θ                                                                              ,                  (44)
                                                                                                                       
                                                                ∂P      ∂P       ∂P              g
                                                       0                                     −η σδ              0
                                                                                                b
                                                               ∂ fbB    ∂η       ∂b
                                                                                  g                                    
                                                                                                γ B −γ A
                                                                                                   σδ          −φσ f
  29
     Again, Formula (43) applies only when risk aversion is an integer greater than zero, therefore, at least equal to
1. Hence it applies only for α < 0. The parameter ε of the characteristic function is set at α and the parameter χ
                                  α
takes values ranging from 0 to − 1−α > 0. The latter is a positive rational number smaller than 1.



                                                                               22
                                       Figure 3: Diffusion of wealth
      The figure has two plots. The one on the left shows the diffusion of the wealth of Group B with
      respect to output shocks as a function of the current difference of opinion, gb, for a value of sentiment
      such that ω = 0.5. The right-hand plot shows the same as a function of ω, for a value of the
      difference of opinion gb = −0.03. Each plot in the figure has three curves on it, with the dotted line
      representing the case where all agents have the proper beliefs (φ = 0), the dashed line representing
      the case where Group A is overconfident (φ = 0.95), and the continuous line representing the
      construct “diff3 ” containing three terms only, Group A being, however, overconfident. All other
      parameter values used in this figure are given in Table 1.
                  Expos of B wealth to W∆
                                                                        Expos of B wealth to W∆
                         0.15                                                     0.05
                                                                                  0.04
                          0.1
                                                                                  0.03

                         0.05                                                     0.02
                                                                                  0.01
                                                              `
                                                              g
   -0.1        -0.05                   0.05             0.1                                                                     Ω
                                                                                                0.2       0.4   0.6   0.8   1
                        -0.05                                                  -0.01
                                                                               -0.02
                         -0.1




where the left hand-side contains the investor’s target exposures and the right-hand side the expo-
sures of the available securities, which we have analyzed in Section 5. We now study the terms of
the left-hand side of the equation.


6.1      Target exposures

Defining:
                                                                                                  
                                              h                               i          σδ      0
                                                          ∂F B        ∂F B               γB
                                diff3 F B ,       FB                   ∂η η
                                                                                  
                                                                                         σδ      0 
                                                                                                   ,                       (45)
                                                          ∂ fbB
                                                                                  
                                                                                      −η σgbδ    0

we can write:
                                                                  ∂F B h   γ B −γ A
                                                                                                  i
                                 diffF B = diff3 F B +                        σδ         −φσ f        .                     (46)
                                                                   ∂b
                                                                    g

   In Figure 3, the components of the exposure strategy as fractions of B’s wealth are drawn
against the current difference of opinion, gb, and against the current weight of the overconfident
group A, ω, the exact same format being used as in Figure 1 for the exposures of equity and the
bond.

   Three conclusions emerge from the comparison of the three curves in both plots of Figure 3.
First, the dotted and the solid line are close to each other:

                                              diffF B                 diff3 F B
                                                                  ≈                      .                                  (47)
                                                FB       φ=0            FB        φ6=0



                                                                   23
    Second, the dashed line is vastly different from the other two. As was the case for equity and
for the same reasons, the only components of exposure demands that are markedly affected by the
presence of overconfidence are the gb components. As has been well explained by Merton (1973),
a state variable has an impact on Group B’s wealth for two possible economic reasons: (i) it can
change the prospect for the immediate return on a given portfolio held by Group B, and (ii) it
can affect the investment opportunities in the future that Group B will face when rebalancing
their portfolio. The effects of Type (ii) can be explained by means of the concept of “favorable
or unfavorable shift in the investment opportunity set” introduced by Merton (1973), where “a
favorable shift” is defined as a change in a state variable such that, for given immediately anticipated
returns, consumption rises for a given level of wealth.30 Lemma 1 implies that, in a neighborhood
                                                                              ∂F B
of gb = 0, when risk aversion is greater than 1, the derivative                ∂b
                                                                                g    is nonnegative: an increase in the
                                                                                                           γ B −γ A
difference of opinion is an unfavorable shift for Group B (as it is for everyone). Because                    σδ      ≥ 0,
the traders with the proper beliefs know that a positive dWδB shock will increase the difference of
opinion (see also Equation (4)). To offset this, they construct their portfolio to have a positive
exposure to dWδB .31

    Finally, a comparison of the gap between the dotted and the dashed curves in Figure 3 and
in the equity plot of Figure 1 reveals that this gap is smaller in Figure 3. This is the effect of a
general result, which is strongly supported by the numerical experiments we have conducted: To
each maturity T, Group B desires to have an exposure to difference-of-opinion risk per unit of
wealth that is smaller than that contained in one consumption-unit worth of equity:

                                          1     ∂F B,T              1 ∂F T
                                                               <                     .                                (48)
                                        F B,T    ∂bg     g
                                                         b=0       F T ∂b
                                                                        g      g
                                                                               b=0



6.2    Portfolio choice

We discuss the cases φ = 0 and φ 6= 0 separately because, as mentioned above, if everyone has
proper beliefs (φ = 0) then of the two risky securities one is redundant. That is, the portfolio
  30
     For instance, because ε, in the calculation of F B,T (for a single-maturity claim) is set at α < 0, Lemma 1 implies
that:
                                                1 ∂F B,T        1 ∂F T
                                                B,T
                                                            = T          < 0,
                                              F      ∂ fbB     F ∂ fbB
and therefore:
                                                 1 ∂F B        1 ∂F
                                                          < 0;         < 0.
                                                F B ∂ fbB      F ∂ fbB
An increase in their estimate of growth is a favorable shift for Group B (as it is for everyone): their wealth decreases,
their consumption increases.
  31
     Because −φσ f ≤ 0, the opposite is true for the signal shock.




                                                           24
equation (44) reduces to:
                                                                                                                                                                  
                                                           σδ    0                                                                                    σδ         0
                                                i  γB                                                        ∂F          ∂F        ∂F            γB
                                                                                             "                                               #
       h
                    ∂F B     ∂F B       ∂F B                     0    
                                                                           |
                                                                                                 F                        ∂η        ∂b
                                                                                                                                     g                           0   
           FB                                      σδ                                                       ∂ fbB                                σδ
                                                                       = θφ=0                                                                                        , (49)
                                                                                                                                                                    
                              ∂η         ∂b
                                          g                                                                   ∂P          ∂P        ∂P
                    ∂ fbB                          −η σgb                                           0                                            −η σgb
                                                                                                                                                
                                                          δ
                                                                 0                                          ∂ fbB        ∂η        ∂b
                                                                                                                                     g                   δ
                                                                                                                                                                 0   
                                                     0           0                                                                                  0            0

so that the portfolio is indeterminate. In this case, one of the optimal portfolio choices is where
Group B invests nothing in bonds and uses the equity to take a position on the risk of all state
variables:
                                                                         h                               i
                                                                                 diffF B
                                                           θ| |φ=0 =              diffF φ=0          0       .                                                           (50)


    A more “natural”portfolio choice may be for B to hold equity in proportion to its wealth and
to use the bond to take a position on sentiment risk, η, and the risk of growth of the economy, fbB ,
which are perfectly correlated with each other in this case. In this way, they would use equity to
manage the fundamental or output system and would use the bond to manage the sentiment risk
η:32,33
                                                       "                                                                            #
                                                                                          1 ∂F B
                                                            FB                     B                − 1T ∂F
                                    |
                                θ |φ=0,alt =                F T φ=0
                                                                               g FP
                                                                             −ηb         F B ∂η
                                                                                        1 ∂P
                                                                                                      F   ∂η
                                                                                                γ B − P1 ∂P ηb
                                                                                                             g
                                                                                                                                         .                               (51)
                                                                                        P ∂ fbB          ∂η
                                                                                                                              φ=0

That last portfolio composition is represented in Figure 4 by the dotted lines. When there is zero
difference of opinion (and φ = 0), then both agents are identical, and therefore, they hold the same
                                                  h B            i
                                                     F
portfolio. That is, both (50) and (51) reduce to:    FT
                                                               0   .
                                                                                            φ=0

       Turning now to the case φ 6= 0, a few algebraic manipulations indicate that the system of
equations (44) is equivalent to:
                                                                                                                                                              
                                                            σδ       0                                                                               σδ      0
                                                   i  γB                                                 ∂F          ∂F        ∂F            γB
                                                                                            "                                            #
           h
                     ∂F B     ∂F B       ∂F B                        0                         F                     ∂η        ∂b
                                                                                                                                 g                           0   
               FB                                                                                        ∂ fbB
                                                                          = θ|
                                                      σδ                                                                                     σδ
                                                                                                                                                                  , (52)
                                                                                                                                                                
                               ∂η         ∂b
                                           g                                                              ∂P          ∂P        ∂P
                     ∂ fbB                            −η σgb                                    0                                            −η σgb
                                                                                                                                            
                                                             δ
                                                                     0                                  ∂ fbB        ∂η        ∂b
                                                                                                                                 g                   δ
                                                                                                                                                             0   
                                                        0            1                                                                          0            1

which can be written:
                                                                                        "                             #
                                                                                                                 ∂F
                                               h
                                                                 ∂F B
                                                                             i              diff3 F
                                                   diff3 F B      ∂b
                                                                   g             = θ|                            ∂b
                                                                                                                  g
                                                                                                                 ∂P       .                                              (53)
                                                                                            diff3 P              ∂b
                                                                                                                  g

Our principal result follows from this equation:
  32
   When deriving (51) from (49), we used the results in Footnote 30.
  33
   A third possibility would be the limit as φ → 0 of the portfolio applicable when φ 6= 0 (see below Equation (54)).
That limit would just be equal to the value of (54) calculated at φ = 0.




                                                                                 25
                                            Figure 4: Portfolio choice
   The figure has four plots. The top two show Group B’s demand for equity and bond as a fraction of
   their wealth against the current difference of opinion gb for a value of sentiment such that ω = 0.5. The
   bottom two plots show the same against ω for a value of the difference of opinion gb = −0.03. Each
   plot in the figure has three curves on it, with the dotted line representing the case where all agents
   have the proper beliefs (φ = 0), the dashed line representing the case where Group A is overconfident
   (with φ = 0.95) and the solid line representing the limit of the latter when φrightarrow0. All other
   parameter values used in this figure are given in Table 1.
                    B demand for equity                                                           B demand for bond

                            2
                                                                                                       0.4

                          1.5
                                                                                                       0.2

                                                                                                                                          `
                                                                                                                                          g
                            1                                            -0.1            -0.05                         0.05         0.1

                                                                                                      -0.2
                          0.5
                                                                                                      -0.4
                                                            `
                                                            g
    -0.1         -0.05                0.05            0.1                                             -0.6



  B demand for equity                                                    B demand for bond
                                                                Ω               0.5
                    0.2     0.4     0.6        0.8          1
           0.9
                                                                                0.4
           0.8
                                                                                0.3
           0.7

           0.6                                                                  0.2

           0.5                                                                  0.1
           0.4
                                                                                                                                          Ω
                                                                                             0.2          0.4    0.6          0.8     1
           0.3




Proposition 2 For as long as φ 6= 0, the portfolio choice is independent of the specific value of φ
except through the value functions F, P and F B , and the solution is:

                                                       ∂F B                                          ∂F
                                      dif f 3 F B       ∂b
                                                         g                            dif f 3 F      ∂b
                                                                                                      g
                                                       ∂P T                           dif f 3 F      ∂F
                                          dif f 3 P     ∂b
                                                         g                                           ∂b
                                                                                                      g
                            θF =                                    ; θP =                                   ,                        (54)
                                                       ∂F                                            ∂F
                                          dif f 3 F    ∂b
                                                        g                             dif f 3 F      ∂b
                                                                                                      g
                                                       ∂P                                            ∂P
                                          dif f 3 P    ∂b
                                                        g                             dif f 3 P      ∂b
                                                                                                      g


where θF is the number of units of equity demanded and θP the number of units of the bond.


   Figure 4 contains a lot of information about the solution (54). The dashed lines represent
                                                                                      
the portfolio demands relative to B’s wealth (portfolio shares), that is, θFFBF , θFPBP for the case
φ = 0.95. The solid line represents the limit of (54) when φ → 0. Quite obviously these two lines in
all four plots are very close to each other. So, even though the proposition rigorously says that the


                                                                    26
portfolio demand does not depend on the specific value of φ “except through the value functions F ,
P and F B ,” we can practically ignore the caveat when examining the fractional composition of the
portfolio. The demand for securities depends negligibly on the degree of overconfidence (although
equilibrium prices and consumption allocations do depend on it), for as long as it is not equal
to zero. The only thing that matters for B’s portfolio demand is whether there exist people in
the market who are somewhat overconfident. This conclusion is obviously in line with our earlier
remarks about Equations (42) and (47). The modicum of variation in portfolio demand in relation
                                                                           1 ∂F B
to the value of φ is mostly due to the sensitivity                        F B ∂η
                                                                                     to sentiment risk. In the bottom plots
of Figure 4, the demands are drawn against the consumption share ω of overconfident investors in
the population. Evidently, even a limitingly small presence of overconfident investors in the market
causes Group B to follow the portfolio strategy that takes overconfidence into account.

   When gb = 0, the demands for equity and for bonds are:

                            1 ∂F B γ B           1    ∂F B                                            1 ∂F γ B          1 ∂F
                   σδ +    F B ∂ fbB σ δ        FB     ∂b
                                                        g                                     σδ +    F ∂ fbB σ δ      F T ∂b
                                                                                                                            g
                         1 ∂P γ B                 1   ∂P                                              1 ∂F B γ B       1 ∂F B
                                                                                             σδ +
      FB                 P ∂ fbB σ δ             P    ∂b
                                                       g
                                                               g
                                                               b=0          FB                       F B ∂ fbB σ δ    F B ∂bg
                                                                                                                                 g
                                                                                                                                 b=0
 θF =                                                                ; θP =                                                            .
      F                                γB                                   P                                   γB
            g
            b=0       σ δ + F1 ∂F                1
                                                FT
                                                      ∂F
                                                                                      g
                                                                                      b=0      σ δ + F1 ∂F             1
                                                                                                                      FT
                                                                                                                           ∂F
                                 ∂ fbB σ δ            ∂b
                                                       g                                                  ∂ fbB σ δ        ∂b
                                                                                                                            g
                          1 ∂P γ B               1    ∂P                                           1 ∂P γ B            1   ∂P
                         P T ∂ fbB σ δ          PT    ∂b
                                                       g                                          P T ∂ fbB σ δ       PT   ∂b
                                                                                                                            g
                                                              g
                                                              b=0                                                               g
                                                                                                                                b=0
                                                                                                                                      (55)
                                               1     ∂F B,T          1    ∂F T        α 1    ∂P T
Because, for given maturity T ,              F B,T
                                                               =    F T ∂ fbB
                                                                                 =   α−1 P T ∂ fbB   < 0, (Lemma 1) and since
                                                      ∂ fbB
       1 ∂F B,T            1 ∂F T
0<   F B,T ∂b
            g         <   F T ∂b
                               g g            (Lemma 1 and Equation (48)), it follows that similar equalities
                g
                b=0               b=0
and inequalities hold also but approximately for the integrated prices and thus we have the following
result: When gb = 0, Group B holds fewer units of equity and bonds than the number corresponding
to their share of wealth:
                                                              FB
                                                 θF <                and θP < 0.                                                      (56)
                                                              FT

   The reason Group B holds fewer units of equity and bonds than the number corresponding
to their share of wealth is that their share of wealth invested in equity and bonds would contain
too much difference-of-opinion risk. Risk averse investors with the proper beliefs of Group B are
deterred by the presence of the overconfident traders, whose difference of opinion is a source of risk
in their eyes. Hence, investors with the proper beliefs prefer to take refuge in the riskless short-term
asset, unless they are very optimistic about future growth. Thus, the short-term deposit is the only
safe haven from sentiment risk. These results imply that the presence of overconfident investors
not only distorts the stock and bond markets, but also scares away rational investors. In the words
of De Long, Shleifer, Summers, and Waldmann (1990a), “noise traders create their own space.”


                                                                     27
    That property is, of course, illustrated in Figure 4 (top left plot) as are a number of additional
features of Group B’s demand. The demand schedule for equity is upward sloping as a function
of gb. The reason for this is that even though Group B are driven away by the presence of the
overconfident traders, they overcome their fear when they are very optimistic about future growth.


7    On long-run predictability

There exists a logical link between the phenomenon of excessive volatility and the long-run pre-
dictability of stock returns. Campbell and Shiller (1988a,b) and Cochrane (2001, page 394 ff ),
have pointed out that the dividend-price ratio would be constant over time if dividends were un-
predictable (specifically, if they followed a geometric Brownian walk) and expected returns were
constant. Because the dividend-price ratio is changing, its changes must be predicting either future
changes in dividends or future changes in expected returns. This statement is true in any economic
model, unless there are violations of the transversality conditions. Empirically, the dividend-price
ratio hardly predicts subsequent dividends. It must, therefore, predict returns. But, if it predicts
returns, it can serve as valuable information for a rational person trading in the market. We now
show how that aspect is embedded in our model and in the equilibrium portfolio strategy that
we have just described.34 As we saw, that strategy was crucially driven by the derivatives of the
                                                                 ∂F B ∂F           ∂P
price functions with respect to the difference of opinion:         g , ∂b
                                                                  ∂b    g,   and    g.
                                                                                   ∂b    In essence, we want to
produce an interpretation of these derivatives in terms of anticipated returns.

    In performing that task, it will be convenient to use Malliavin derivatives. Just as the standard
derivative measures the local change of a function to a small change in an underlying variable, the
Malliavin derivative measures the change in a path-dependent function implied by a small change
in the initial value of the underlying Brownian motions. In the context of our model, Malliavin
calculus allows for a very clean and insightful interpretation of the results, and in particular, allows
us to distinguish between instantaneous effects and long-term effects.35
                 B X the response at time u of a process X to a unit dW B shock having occurred
    Denoting by Dδ,t u                                                 δ

at time t with u ≥ t, and by DtB Xu = {Dδ,t
                                        B X , D B X } the row vector of responses to the two
                                            u  s,t u
           B , dW B }, we compute below the Malliavin derivatives of the four state variables.
shocks, {dWδ,t   s,t

Observe that DtB Xt is another notation for the diffusion vector of the process X at time t.

  34
     For recent work studying long run risk and return, see Alvarez and Jermann (2005) and Hansen and Scheinkman
(2005).
  35
     An introduction to Malliavin calculus with applications to problems in finance can be found in Detemple and
Zapatero (1991, Appendix A) and Detemple, Garcia, and Rindisbacher (2003, Appendix D). For additional details
on Malliavin calculus, see Ocone and Karatzas (1991), Nualart (1995), and Øksendal (1997).




                                                      28
Lemma 3 The Malliavin derivatives for the four state variables are:
                           h B        i
        DtB fbuB = e−ζ(u−t) γσ      0   ,                                                                                      (57)
                               δ
                            h B A              i
        DtB gbu = e−ψ(u−t) γ σ−γ         −φσ f   ,                                                                             (58)
                                  δ


                DtB δ T                         1                h B        i
                                                    1 − e−ζ(T −t)      γ
                                             
                            =         σδ 0        +                    σδ   0   ,                                              (59)
                 δT                             ζ
                                                                                  !
                                              i Z T                           B
                DtB η T           h
                                      −b
                                       gt             −ψ(u−t) g bu         dWδ,u    h
                                                                                                   γ B −γ A
                                                                                                                       i
                            =         σδ     0 −     e               du  +                                    −φσ f        .   (60)
                 ηT                               t             σ 2δ        σδ                        σδ



       Observe from Equations (57) and (58) that the responses in fbuB and gbu follow deterministic
paths. From Equations (59) and (60) we see that the perturbations in the fundamental δ and the
sentiment η accumulate the perturbations in fbB and gb; shocks occurring today have a declining
effect on future values of the fundamental and the sentiment.36 Given Equations (30), (25) and
(35), one can, for instance, calculate the Malliavin derivatives of the discounted price F T of a single
dividend to be paid at time T > t:37
                   B                                                                                         
    B T         B ξT                Dt δ T             Dt η T                Dt δ t             Dt η t Dt δ T
  Dt F    = Et            (α − 1)          + ω (η T )            − (α − 1)           − ω (η t )       +        δT
                   ξBt               δT                 ηT                    δt                 ηt     δT
                              "
                                  B                                           Z T              
                T Dt δ t    B ξT                                   Dt η t                     B
          = F            + Et        δ T    [ω (η T ) − ω (η  t )]        + α           D t u du
                                                                                           f
                                                                                           b                     (61)
                   δt           ξBt                                 ηt             t
                          ( Z                "                     #)! #
                                 T                       dWδ,u  B
                                               gbu
               + ω (η T ) −         (Dt gbu ) 2 du +                       .
                               t               σδ           σδ

       Because DtB F T is the diffusion vector of equity, there is a direct association between the four
partial derivatives and the four terms of the Malliavin derivative:

                          ∂F T          FT
                                  =        ,                                                                                   (62)
                           ∂δ           δt
                          ∂F T               1h               i
                                  = αF T        1 − e−ζ(T −t) ,                                                                (63)
                          ∂ fbB              ζ
                                                 B              B T
                                        EB
                                                          
                          ∂F T           t δ T ξ T ω (η T ) − ξ t F ω (η t )
                                  =                                                ,                                           (64)
                           ∂η                            ξB
                                                          t ηt
                                                  (                                    "                      #)
                                                                                                        B
                          ∂F T                                ξB        T                            dWδ,u
                                                                   Z
                                                                                           gbu
                                  = −EB
                                      t
                                                               T
                                                  ω (η T ) δ T B            e−ψ(u−t)            du +               .           (65)
                           ∂b
                            g                                 ξt    t                      σ 2δ       σδ
  36
       The time-integral in the right-hand side of (60) contains terms that interact the effect of current shocks (Dt gbu )
                       dW B
with future shocks σδ,uδ
                           , because the current shocks have an impact on the diffusion gbu that is applied to future
shocks to get the diffusion of η u .
  37
     Here we follow closely Detemple, Garcia, and Rindisbacher (2003).


                                                                   29
Equation (65) in particular, and similar ones written for the bond and the wealth of B, provide
                                                                   ∂F
us with the promised interpretation of the derivative              ∂b
                                                                    g   with respect to the difference of opinion:
it captures the covariation over the entire investment horizon between future output and future
changes in the difference of opinion weighted by the future weight of the overconfident population.
We have thus identified the relevant statistics that the asset manager of Group B needs to have in
mind over the entire future. The explicit solutions for F , P and F B that we have exhibited allow
one to forecast the terms in the curly brackets on the right-hand side of (65).

      We would like to show now how sentiment risk contributes to anticipated returns in general,
irrespective of the specific menu of securities available in the market.


7.1      Instantaneous pricing of risk

By construction (see Cox and Huang (1989)), the instantaneous market price of risk (or Sharpe
ratio) is equal to minus the diffusion of the pricing measure. It is the instantaneous response of
the stochastic discount factor to shocks occurring today. Knowing the pricing measure (25), Itô’s
lemma gives directly the following result (which we state without proof):


Lemma 4 In equilibrium, the market prices of risk in the eyes of Group B are:38

                             DtB ξ B                |             DtB δ t           DB η
                                B
                                   t
                                       = − κB
                                            t            = (α − 1)         + ω (η t ) t t                    (66)
                              ξt                                    δt                ηt
                                                                              h          i
                                                                 0 − gbω (η) σ1δ 0 .
                                                                 
                                       = −        (1 − α) σ δ                                                (67)


      From Equation (67), we see that the prices of risk κB contain an instantaneous premium for the
output shock Wδ but no instantaneous premium for the signal shock Ws . If there is no difference
            g = 0), the prices of risk κB include only the traditional reward for fundamental risk
of opinion (b
(1 − α) σ δ . As soon as there is a difference of opinion, investors realize that “sentiment” will
fluctuate randomly in response to output shocks. Hence, they start charging a premium also for
the risk arising from the vagaries of others. The premium is proportional to the product of the
difference of opinion gb with the relative weight ω of the overconfident population.

      It is noteworthy that, once the current values of the state variables η, fbB , gb (describing the
current population and its expectations) are given, the instantaneous return and risk reward on
 38
      The risk-neutral measures for Groups A and B differ only in the market prices of risk:
                                “ ”| ˆ                                   h         i
                                  κA = (1 − α) σ δ 0 − gb [1 − ω (η)] σ1δ 0 .
                                                          ˜




                                                            30
immediate-maturity instruments do not depend on the degree of overconfidence, φ, of Group A.
The overconfidence coefficient, φ, affects only the future dynamics of the state variables. For that
reason, it has an impact on returns but only for assets maturing beyond the immediate date, a
topic to which we turn now.


7.2   Long-run pricing of risk

The multiperiod rate of return of an asset that delivers a unit payoff at time T in a given state and
that was bought at time t (t < T ) in a given state is ξ t /ξ T . However, that would be the relevant
long-run return if one were to buy that asset at t and hold it until T . If there exists a financial
market that allows repricing and retrading tomorrow of assets bought today, we show now that this
is the not the concept of long-run return that is relevant for portfolio choice. As will be apparent
in Equation (71) below, the long-run excess return that is relevant is the long-run response DtB ξ B
                                                                                                   T
of the stochastic discount factor to shocks occurring today. From Equation (25), we have:

                                  DtB ξ B
                                        T           DtB δ T            DtB η T
                                          = (α − 1)         + ω (η T )         .                              (68)
                                   ξBT               δT                 ηT

Notice again the crucial role of the relative weight of the overconfident group in the perturbation
of the pricing kernel.

   The long-run return has two components: the first arising from the fluctuations in output and
                                                                                                  DtB η T
the second arising from the vagaries of the overconfident population. The term, ω (η T )           ηT       , which
would not be present in a market without overconfident investors (ω = 0), is a predictable com-
ponent and it modifies the long-run behavior of returns. Long-run returns are very much affected
by the current values of state variables, a situation commonly referred to in the Finance literature
as “return predictability”. In this model, however, return predictability is not as simple as has
been commonly envisaged in the empirical Finance literature. For instance, there exists sometimes
a positive relation between expected return on equity and the dividend yield and sometimes a
negative one. This matter is analyzed by Berrada (2006).
                             DtB η T
   Using (60) to expand       ηT       in (68), one can write:

             DtB ξ B         DtB ξ B
                                                Z T 
                   T               t                     B bB
                                                                                      DtB η t
                B
                         =      B
                                     + (α − 1)         D t u du + [ω (η T ) − ω (η t )]
                                                           f
              ξT              ξt                  t                                      ηt
                                       ( Z               "                 #)
                                              T                         B
                                                                     dWδ,u
                                                   B
                                                         gbu
                             + ω (η T ) −        Dt gbu         du +          .                               (69)
                                            t              σ 2δ       σδ




                                                       31
Thus, the long-run price of risk is equal to the short-run price of risk, plus the impact DtB fbuB of
future changes in beliefs of Group B, plus the short-run impact of the sentiment weighted by the
future change in the weight of the overconfident population, and the impact DtB gbu of future changes
in the difference of opinion. Because future consumption is a function of the state price for the
future maturity, these four components drive Group B’s portfolio strategy.


7.3   Portfolio strategy in terms of short-run and long-run returns

Let F B,T denote the price at date t today of a single-maturity unit of consumption to be consumed
at date T > t:
                                                                           1     
                                                                          B α−1 +1
                                            ξB
                                                              1       ξ
                           F B,T , EB        T B
                                                      = λB eρT α−1 EB  T
                                                              
                                    t          cT                   t
                                                                                   .               (70)
                                            ξB
                                             t                             ξB
                                                                            t


The Malliavin derivatives of the price can be written:

                                            B B                      B  B B
                                                                                     DtB ξ B
                                                                                            
                                  1    B,T Dt ξ t      α          B ξT    Dt ξ T           t
            DtB F B,T      = −       F            +           B
                                                           E cT B                  −            ,   (71)
                               1−α          ξB
                                             t      α−1 t           ξt     ξB
                                                                            T          ξBt
                                                            B  B B
            DtB F B,T         κB                                           DtB ξ B
                                                                                   
                                t       α      1    B    B ξT     Dt ξ T         t
                           =        +             E cT B                 −             .            (72)
             F B,T           1 − α α − 1 F B,T t           ξt      ξB
                                                                    T        ξB
                                                                              t


Proposition 3 Group B’s portfolio reflects two motivations:


  1. The first term of the equation is a myopic portfolio seeking to reap immediate excess return
      per unit of risk ,

  2. The second term is an intertemporal hedge which incorporates the prospect of longer-run
      returns. For each future consumption date T, the second term can be further split into:

      (a) A hedge against future shocks to fbuB , u ∈ [t, T ]:
                                                            B Z T         
                                               1          B ξT
                                        α B,T EB
                                               t         cT B          B bB
                                                                      Dt fu du ;
                                         F                  ξt   t


       (b) A myopic exposure to the immediate movement in the sentiment η, which is also a hedge
           against future movements in the equilibrium distribution of consumption:

                                                       B
                                                                            DtB η t
                                                                                   
                                      α     1   B   B ξT
                                               E cT B [ω (η T ) − ω (η t )]           ;
                                    α − 1 F B,T t     ξt                     ηt




                                                          32
       (c) A hedge against the product of A’s future consumption share ω (η T ) with the future shocks
           to gbu , u ∈ [t, T ]:
                                       "           ( Z            "                 #)#
                                            B           T                        B
                                                                              dWδ,u
                           α     1   B   B ξT              B
                                                                  gbu
                                    E cT B ω (η T ) −     Dt gbu         du +           .
                         α − 1 F B,T t     ξt         t             σ 2δ       σδ


    As Equations (69) and (71) reveal, the more “strategic” exploitation of the long-run predictabil-
ity created by overconfident investors is imbedded in the intertemporal hedge. Group B knows that
its share of consumption will fluctuate, that it will revise its expectations of growth, that the other
group also will and that it will do so in a manner different from theirs. So, these are the three
considerations that are incorporated in when they choose the hedging component of their portfolio.
In contrast to the intertemporal hedging portfolio in Merton (1971), which is expressed in terms
of the partial derivatives of the investor’s value function, the three expressions given in Item 2
of Proposition 3 show explicitly how Group B’s expectations of future growth, sentiment, and
difference of opinion influence the hedging component of the portfolio.


8    Epilogue: Survival

We now return to the question we asked originally concerning the potential for gains that the
excessive volatility creates for the investors with the proper beliefs who follow the portfolio strategy
that we described in the previous section. By asking whether rational risk arbitrageurs can take
advantage of overconfident investors, we simultaneously ask whether investors with the proper
beliefs eliminate overconfident investors from the economy very quickly, or whether overconfident
investors can survive for some time. The main goal of this exercise is to demonstrate that the
phenomena we have analyzed in this article do not go away quickly, contra Alchian (1950) and
Friedman (1953).

    The survival of irrational traders is an issue that was raised by De Long, Shleifer, Summers,
and Waldmann (1990a, 1991) in a partial-equilibrium setting, in which traders did not affect prices.
The survival of excessively optimistic or pessimistic agents, in an economy in which one category of
agents knows the true probability distribution, is the focus of recent papers by Kogan, Ross, Wang,
and Westerfield (2006) and Yan (2006). Here, however, we consider a different kind of overconfident
agents, who change their mind too frequently, being sometimes too optimistic and at other times
too pessimistic about the growth rate of aggregate dividends, as compared to investors with the
proper beliefs, not as compared to the truth. Kogan, Ross, Wang, and Westerfield (2006) considers
agents who consume only at some terminal horizon date so that their saving rate is not optimized
and the growth of the economy is not an important factor in the analysis. Yan (2006), in contrast,


                                                  33
                       Figure 5: Survival of the overconfident Group A
    The plot on the left gives the probability density function (pdf) of Group A’s share of consumption,
    ω u , after the passage of u years. The plot on the right shows the expected value under the objective
    measure of Group A’s consumption share, EP       0 ω u , as a function of time measured in years, with
    current time assumed to be 0 and future time denoted by u on the x-axis. In the second plot, the
    dotted line represents the case where φ = 0 and all agents have the correct beliefs, while the solid
    line represents the case where φ = 0.50 and the dashed line represents the case where φ = 0.95
    implying that Group A is overconfident. The parameter values used here are given in Table 1. In
    particular, the two groups of investors have equal initial weights, ω 0 = 1/2.
    pdf                                                                 EP Ωu
    14                                                                  0.5

    12
                                                                        0.4
    10                                  u   =   5
     8                                  u   =   20                      0.3
                                        u   =   100
     6                                  u   =   300                     0.2
     4
                                                                        0.1
     2

              0.25       0.5       0.75                   1
                                                              Ωu                                                    u
                                                                                100   200   300   400   500   600




considers agents who consume intertemporally and make optimal savings decisions. In an economy
with a specification that is very close to ours, Berrada (2004) has discussed the issue of survival by
means of simulations.

   Most previous studies, with the exception of Berrada (2004), have defined “survival” in terms
of the “irrational” agents’ asymptotic share of wealth as the horizon goes to infinity. In general,
however, wealth is a sufficient summary statistic neither of an agent’s welfare nor of his or her
influence on asset prices. Under von Neuman-Morgenstern, time-additive utility, the share of
consumption is such a summary statistic. Therefore, we measure the survival of overconfident
agents in the economy by studying the evolution of the share of the total dividend that will be
consumed by them. The probability distribution of this share is computed under the objective, or
true, probability measure rather than under the measure of either Group A or B.

   Group A’s ratio of consumption to aggregate dividends is given by Equation (28). To compute
the distribution of this ratio under the true or effective probability measure, we need the conditional
distribution of η , given η , ft , fbA , andfbB at t. As in Section 4, we first obtain its characteristic
                  u            t    t                 t
function (see Lemma 5 in the appendix). Then, the expected value and the probability distribution
of the share of Group A’s consumption in (28) can be obtained by means of Fourier inversion (as
shown in Equation (A61) of the appendix).

    We study the case where Groups A and B start out with the same estimate of the future growth
rate, that is, fbA = fbB and also consume the same share of aggregate dividend, ω 0 = 1/2. Recall
also that we are assuming that both categories of agents have the same, time additive, isoelastic


                                                                   34
utility function. In the left plot of Figure 5, we plot the probability density function of Group A’s
share of consumption after the passage of different numbers of years. We see from the left plot
that as time passes, the density moves to the left, and thus, Group A’s share of consumption is
decreasing. To understand the rate at which this share is decreasing, in the right plot we plot the
expected value of this share, EP0 [ω u ], against time measured in years. This plot in the right plot
considers three cases: one, where Group A has the proper beliefs (φ = 0), the second where Group A
is overconfident with φ = 0.50, and the third where it is even more confident with φ = 0.95.

    Both plots confirm that ultimately, overconfident agents become extinct in that their share of
consumption vanishes. This is simply the result of the fact that ω is a monotonic function (28) of
a positive martingale η. As is the case for any positive martingale, the probability mass (or the
mode of the distribution) accumulates towards zero. Equation (6) implies that

                                       1 t 2 1
                                       Z              Z t          
                                                              1  B
                           η t = exp −     gb     du −     gbu dWδ,u ,                          (73)
                                       2 0 u σ 2δ       0     σδ

so that this long-run decrease takes place at the rate gb2 . But, the more interesting observation is
that, in contrast to what is typically assumed in models of rational asset pricing, overconfident
agents do not lose out right away. For instance, the right-hand side plot in Figure 5 shows that
after 100 years the overconfident agents’ expected share of consumption of the aggregate dividends
is still at 20% compared to the initial share of 50%. Recall that in Figure 2 we showed that the
relation between the volatility of equity returns and the consumption share of Group A is close to
being linear. The fact that the overconfident group is not eliminated from the population instantly
implies that the phenomenon of excess volatility will also not be eliminated quickly.


9    Conclusion

In a capital market characterized by excessive volatility, we have analyzed the return behavior that
would prevail in equilibrium and the trading strategy that would allow a rational investor with the
proper beliefs to take advantage of the excess volatility generated by the presence of overconfident
investors. To achieve our goal, we have constructed a general-equilibrium “difference-of-opinion”
model in which stock prices are excessively volatile, using the device proposed by Scheinkman and
Xiong (2003). In our model, there are two groups of agents, and one group (overconfident) believes
that the magnitude of the correlation between the innovations in the signal and innovations in
some unobserved variable (the expected growth rate of dividends) is larger than it actually is.
Consequently, when a signal is received, this group of agents adjusts their beliefs too much and




                                                 35
overreacts to it, which then generates excessive stock price movements. The excess movement was
regarded as a “sentiment” factor.

   For given beliefs, however, both classes of agents are rational in their decision making, in the
sense that both are intertemporal optimizers. In this way, the overconfident investors are not sitting
ducks. We show that investors with the proper beliefs have to engage in a fairly intricate investment
strategy to triumph over the overconfident ones. And their victory can be achieved only in the
fairly long run.

   We believe that our undertaking brings two benefits. First, given that we have worked out in
careful detail the optimal portfolio strategies to be followed by rational investors with the proper
beliefs, our model should be of practical use to hedge funds who play the price-convergence game
and in so doing expose themselves to “market sentiment” risk. They often have at their disposal
perfect-market pricing models that allow them to spot pricing anomalies. But, that is not sufficient
information to put into place a “risk arbitrage” strategy, including the optimal timing of trades
into the strategy, of trades out of the strategy, plus the accompanying hedges. For that purpose,
hedge funds also need a model of the equilibrium stochastic process which describes how sentiment
will drive price spreads. We provide one such model.

   Second, the model parsimoniously combines the technical virtues of continuous-time, rational-
expectations equilibrium asset pricing models (including the use of the martingale approach) with
a single, well-defined, almost axiomatic deviation from the case where all agents have the proper
beliefs. In this way, it has allowed us to analyze the equilibrium consequences of that specific
deviation. We hope that this model, or similar models obtained by this method, can become
workhorses in the development of behavioral equilibrium theory.




                                                 36
Appendix: Proofs for lemmas

Proof for Lemma 2: Volatilities of the state variables

Substituting Equations (1) and (14) into (12) and (13) gives the expressions in Equations (15),
(16), and (17). The sign for each expression can then be established using the expressions for γ A
and γ B in Footnote 11 and by showing that γ A is decreasing in φ, while γ B is equal to γ A evaluated
at φ = 0.


Proof for Proposition 1: The moment-generating function

To prove this lemma, we need to determine:
                                                   
                        H δ, η, fbB , gb, t, u; ε, χ = EB
                                                        δ,η,fbB ,b
                                                                 g
                                                                   [(δ u )ε (η u )χ ] .                             (A1)

This function satisfies the linear PDE:
                                                             ∂H                            
                            0 ≡ LH δ, η, fbB , gb, t, u; ε, χ +     δ, η, fbB , gb, t, u; ε, χ ,        (A2)
                                                                ∂t
                                                            
with the initial condition H δ, η, fbB , gb, t, t; ε, χ = δ ε η χ , and where L is the differential generator
                        
of δ t , η t , fbtB , gbt under the probability measure of Group B.
       Spelling out (A2) we have:
                                              ∂H             γA       1 ∂2H
                                                                  
                  ∂H bB        ∂H  bB
              0 =     δf −           ζ f −f −         gb ζ + 2 +                (δσ δ )2                            (A3)
                  ∂δ           ∂ fbB               ∂b
                                                    g          σδ       2 ∂δ 2
                                              "            2             #
                    1 ∂2H         2 1   1 ∂2H     γB − γA                2
                  +         (ηb
                              g) 2 +                            + (φσ f )
                    2 ∂η 2          σδ     g2
                                        2 ∂b          σδ
                                   B 2
                    1 ∂2H           γ      ∂2H           ∂2H                     ∂2H
                                                              δ γB − γA +                δγ B
                                                                           
                  +     2              −      δηbg+
                    2      B        σδ     ∂δ∂η         ∂δ∂bg                   ∂δ∂  bB
                                                                                     f
                      ∂ f b

                    ∂2H
                               B
                                γ − γA        ∂2H       γB      ∂2H
                                                                         B
                                                                          γ − γA
                                                                                    
                                                                                              ∂H
                  −       ηbg         2    −         ηbg 2 +                   2        γB +     .
                    ∂η∂bg            σδ      ∂η∂ fbB σ δ        g ∂ fbB
                                                               ∂b            σδ               ∂t

       The solution of this PDE is
                                                                        
                  H δ, η, fbB , gb, t, u; ε, χ = δ ε η χ × Hf fbB , t, u; ε × Hg (b
                                                                                  g , t, u; ε, χ) ,                 (A4)

where Hf (fbB , t, u; ε) and Hg (b
                                 g , t, u; ε, χ) are defined in (33) and (34).39 Substituting (A4) into the
PDE and simplifying, we find that the functions of time, A1 , A2 , B and C, that are present in (34)
  39
    To see that Hf , which is defined in (33), is the moment generating function for δ u /δ under Group B’s measure,
one can verify that δ ε Hf (fbB , t; u, ε) solves the PDE in (A4) but with all terms that are the partial derivatives of H
with respect to either η or gb dropped.




                                                           37
need to solve the following ODEs:

              C 0 (u − t) = aC 2 (u − t) − 2bC (u − t) + c,     C (0) = 0,                    (A5)
               0                                                −ζ(u−t)
             B (u − t) = B (u − t) [aC (u − t) − b] + k + le
                              h             i
                           +2 m + ne−ζ(u−t) C(u − t),        B (0) = 0,                       (A6)
                           a
             A01 (u − t) =   C (u − t) ,  A1 (0) = 0,                                         (A7)
                           2         h                a          i
             A02 (u − t) = B (u − t) m + ne−ζ(u−t) + B (u − t) ,        A2 (0) = 0,           (A8)
                                                      4
where
                                        "       2            #
                                        γB − γA              2
                               a = 2                + (φσ f ) ,                               (A9)
                                           σδ
                                        γA
                                                B
                                                 γ − γA
                                                         
                               b = ζ + 2 +χ                  ,                               (A10)
                                        σδ          σ 2δ
                                   1           1
                               c =   χ (χ − 1) 2 ,                                           (A11)
                                   2          σδ
and
                                          γB 1
                                                 
                               k = −χ 1 +           ,                                        (A12)
                                           ζ σ 2δ
                                        γB 1
                                l = χ           ,                                            (A13)
                                         ζ σ 2δ
                                            γB γB − γA
                                                          
                                        B      A
                               m = γ −γ +                    ,                               (A14)
                                               ζ      σ 2δ
                                     γB γB − γA
                                                 
                               n = −                .                                        (A15)
                                      ζ    σ 2δ

   Of the ODEs (A5)–(A8), all are first-degree linear with constant coefficients, except (A5),
which is a Riccati (i.e., quadratic) equation. Radon’s lemma says that one solution is of the form:
C (u − t) = y (u − t) /x (u − t) , where y and x satisfy a system of two linear ODEs with constant
coefficients. We can, therefore, obtain the solution. Denoting
                                                p
                                            q = b2 − ac,                                     (A16)

and
                                                  2cm + k (b + q)
                          υ 1 = 0,           ϑ1 =                   ,                        (A17)
                                                         q
                                                  2cm + k (b − q)
                          υ 2 = 2q,          ϑ2 =                    ,                       (A18)
                                                         q
                                                   2cn + l (b + q)
                          υ 3 = ζ,           ϑ3 =                  ,                         (A19)
                                                       q−ζ
                                                  2cn + l (b − q)
                          υ 4 = 2q + ζ,      ϑ4 =                 ,                          (A20)
                                                       q+ζ
                          υ 5 = q,           ϑ5 = − (ϑ1 + ϑ2 + ϑ3 + ϑ4 ) ,                   (A21)


                                                    38
we obtain
                           c 1 − e−2q(u−t)
                                              
      C (u − t) =                                 ,                                                       (A22)
                      q + b + (q − b) e−2q(u−t)
                           P5         −υ i (u−t)
                              i=1 ϑi e
      B (u − t) =                                 ,                                                       (A23)
                      q + b + (q − b) e−2q(u−t)
                      a u
                         Z
   A1 (u − t) =              C (τ − t) dτ                                                                 (A24)
                      2 t
                      1h                                
                                                                            −2q(u−t)
                                                                                     i
                =         (b − q) (u − t) + ln (2q) − ln q + b + (q − b) e              ,
                     Z2 u              h                 a          i
   A2 (u − t) =            B (τ − t) m + ne−ζ(τ −t) + B (τ − t) dτ                                        (A25)
                       t                                 4
                       5                                                      5
                     X                                                     a X
                =          ϑj [mD1 (υ j ; u − t) + nD1 (υ j + ζ; u − t)] +       ϑi ϑj D2 (υ i + υ j ; u − t)
                                                                           4
                     j=1                                                                   i,j=1

where, denoting by H the standard hypergeometric function,
                                e−p(τ −t)
                   Z u
  D1 (p; u − t) =                         −2q(u−t)
                                                   dτ                                                                     (A26)
                    t q + b + (q − b) e
        
            2q(u−t)−ln(2q)+ln(q+b+(q−b)e−2q(u−t) )
        
        
                          2q(q+b)                 ,                                                                  p = 0,
    =              h                                                                                        i
                    H 1, p , 1 + p , − q−b − e−p(u−t) H 1, p , 1 +                       p      q−b −2q(u−t)
        
               1
                                                                                         2q , − q+b e               , p > 0,
        
        
            p(q+b)         2q        2q     q+b                               2q

and
                                 u
                                             e−p(τ −t)
                           Z
        D2 (p; u − t) =                                   2 dτ
                             t   q + b + (q − b) e−2q(u−t)
                                       "                                                   #
                                1        1            e−p(u−t)
                       =                   −                       + (2q − p) D1 (p; u − t) . (A27)
                           2q (q + b) 2q q + b + (q − b) e−2q(u−t)

   To show that the function Hg (bg , t, u; ε, χ) is well defined for χ ∈ [0, 1] and u ≥ t, first note that
the radicand in the expression (A16) for q may be written as a quadratic trinomial of χ:
                                           b2 − ac = q2 χ2 + q1 χ + q0 ,                                                  (A28)
where
                                                         φ2 σ 2f
                                           q2 = −                  ,                                                      (A29)
                                                          σ 2δ
                                                     φ2 σ 2f
                                           q1 = 2                ,                                                        (A30)
                                                         σ 2δ
                                                                           σ 2f
                                           q0 = ζ 2 + 1 − φ2                         .                                    (A31)
                                                                              σ 2δ

Because φ ∈ [0, 1] and ζ > 0, it is immediate that q2 ≤ 0, q0 > ζ 2 , and
                                                                       σ 2f
                                          q2 + q1 + q0 = ζ 2 +                > ζ 2.                                      (A32)
                                                                       σ 2δ


                                                           39
                               √
So, when χ ∈ [0, 1], q =           b2 − ac is real. Moreover, q > ζ so that {ϑi }5i=1 are finite.
   Taking into account that a ≥ 0, and for χ ∈ [0, 1], c ≤ 0 and
                            s                    s
                                      2
                                    σ f                           σ 2f
                       b = χ ζ 2 + 2 + (1 − χ) ζ 2 + 1 − φ2 2 > ζ,                                          (A33)
                                    σδ                             σδ

we obtain that q − b ≥ 0 and

                                        q + b + (q − b) e−2q(u−t) ≥ q + b > 0.                              (A34)

Therefore, when χ ∈ [0, 1] and u ≥ t, the functions C (u − t) and B (u − t) are well defined and
bounded; the integrals A1 (u − t) and A2 (u − t) are convergent, and thus, their closed-form expres-
sions (A25) and (A8) are also well defined.
   To derive the properties of Hg , note that

                              1 ∂Hg
                                     g , t, u; ε, χ) = εB (χ; u − t) + 2b
                                    (b                                  g C (χ; u − t) .                    (A35)
                              Hg ∂b
                                  g

Because η u is a martingale under  i measure of Group B, for 0 ≤ χ ≤ 1, it must be the case by
                             h χthe
                          B    ηu
Jensen’s inequality that Egb    η    ≤ 1 for any value of gb. Because from (34)
                            χ 
                         ηu
               EB                          g , t, u; 0, χ) = exp A1 (χ; u − t) + gb2 C (χ; u − t) ,
                                                                
                g                    = Hg (b                                                                (A36)
                b
                         η

this implies C (χ; u − t) ≤ 0.
   We prove that B (χ; u − t) is non-positive by contradiction. Assume the function B (u − t)
takes positive values. Then because this function is smooth and B (0) = 0, there must exist u1 ≥ t
such that B (u1 − t) = 0 and B 0 (u1 − t) > 0. However, it can be shown that the RHS in (A6) is
nonpositive at u1 . Actually, because B (u1 − t) = 0 the first term in (A6) is equal to zero. Then
from (A12) and (A13), k, k + l ≤ 0 and hence k + le−ζ(u1 −t) ≤ 0. Finally, m + ne−ζ(u1 −t) ≥ 0
because from (A14) and (A15)

                                              m + n = γ B − γ A ≥ 0,                                        (A37)
                                                       a
                                                 m ≡      ≥ 0,                                              (A38)
                                                      4ζ

where the last identity can be verified by substituting the expressions for γ A and γ B into (A9) and
(A14). Therefore, by contradiction, we have shown that B (u − t) ≤ 0.


Proof for Lemma 3: Malliavin derivatives of state variables

The solution of Equation (2) being:
                                                                                           u
                           B    B
                                   
                                         B
                                            h
                                                  −ζ(u−t)
                                                          i Z                                  γB   B
                          fu = ft + f − ft × 1 − e
                          b    b        b                  +                                      dWδ,v ,
                                                                                       t       σδ

it follows that:                                                  h            i
                                                                      γB
                                            DtB fbuB = e−ζ(u−t)       σδ   0       .                        (A39)


                                                           40
   Similarly, the solution of Equation (4) being:
                                                  Z u
                                        −ψ(u−t)               B             B
                           gbu = gbt × e        +     σ gbδ dWδ,v + σ gbs dWs,v ,
                                                                         t

it follows that:
                                           DtB gbu = e−ψ(u−t)
                                                                                                       
                                                                                      σ gbδ     σ gbs       .                                    (A40)

   Because the solution of Equation (1) is:
                                     Z T                   Z T      
                                             B  1 2                 B
                       δ T = δ t exp        fu − σ δ du + σ δ
                                            b                     dWδ,u ,
                                       t        2              t

it follows that:
                                                                            Z       T                      
                        DtB δ T                                                              DtB fbuB
                                                                   
                                  = δT ×               σδ 0             +                                   du ,
                                                                                 t
                                                           T
                        DtB δ T       DtB δ t
                                                       Z                        
                                  =             +                  DtB fbuB du,
                          δT            δt             t
                                                                                                                           i
                                                                          1h               ih
                                                                                                                   γB
                        DtB δ T                                              1 − e−ζ(T −t)
                                                                   
                                  = δT ×               σδ 0             +                                          σδ   0        .               (A41)
                                                                          ζ

   Similarly, Equation (6) for η implies:

                                       1 t 2 1
                                         Z            Z t          
                                                              1  B
                           η t = exp −      gb    du −     gbu dWδ,u ,                                                                           (A42)
                                       2 0 u σ 2δ       0     σδ
so that:
                                      (                                                            "                        #)
                                                                     Z       T dWδ,uB
                                       h                       i       1
              DtB η T                        − σgbtδ                                 DtB gbu
                                                                                               
                           = ηT ×             0 −                  gbu 2 du +                                                        ,
                                                       t              σδ          σδ
                                                     "                 #
                                       Z T                           B
              DtB η T        DtB η t                     1       dWδ,u
                                            DtB gbu gbu 2 du +
                                                   
                           =         −                                   ,                                                                       (A43)
               ηT              ηt       t                σδ       σδ
                                                            "                  #
                                          i Z T                         dW  B
                             h                                 1           δ,u
                                  g
                                                  e−ψ(u−t) gbu 2 du +
                                                                                                                                        
                           =   − σδ 0 −
                                  bt
                                                                                   σ gbδ                                         σ gbs       .
                                              t               σδ          σδ


Proof for Lemma 5: Moment-generating function of η under the effective measure

Lemma 5 The moment generating function of η under the effective probability measure is
                                  χ
                                  η
                        EgbA ,bgB u = HP gbA , gbB , t, u; χ ,
                          P
                                                            
                                                                                       (A44)
                                  η

where gbA , fbA − f , gbB , fbB − f , and
                                     n                              2                    2
     HP gbA , gbB , t, u; χ = exp AP (χ; u − t) + C A (χ; u − t) gbA + C B (χ; u − t) gbB
                           
                                                            o
                                 + 2bg A gbB C AB (χ; u − t) ,                               (A45)

for certain functions of time AP , C A , C B , and C AB that are given in the proof.


                                                                        41
Proof: We wish to compute the following expected value:
                             e η, gbA , gbB , t, u; χ = EP A B [η u ]χ .
                                                     
                            H                            η,b
                                                           g ,b
                                                              g                                                 (A46)

Under the objective probability measure, the processes η, gbA and gbB obey the following stochastic
differential equations:
                                          γA        γA δ
                                            
                     db A
                       gt = −b   A
                               gt ζ + 2 dt +             dZt + φσ f dZts − σ f dZtf ,        (A47)
                                          σδ        σ δ
                                          γB        γB δ
                                            
                     db B
                       gt = −b   B
                               gt ζ + 2 dt +             dZt − σ f dZtf ,                    (A48)
                                          σδ        σ  δ
                      dη t                    1                   1
                           = gbtB − gbtA gbtB 2 dt − gbtB − gbtA     dZ δ .
                                        
                                                                                             (A49)
                       ηt                    σδ                    σδ t

                 e η, gbA , gbB , t, u; χ satisfies the linear PDE:
                                         
    The function H

                                   e η, gbA , gbB , t, u; χ + ∂ H η, gbA , gbB , t, u; χ ,
                                                                       e                            
                          0 ≡ LH                                                                                  (A50)
                                                                      ∂t
with the initial condition H η, gbA , gbB , t, t; χ = η χ , where L is the differential generator of η t , gbtA , gbtB
                                                                                                                       

under the objective probability measure. Spelling out (A50) using (A47) and (A48), we have:
                                                              e          γA                             γB
                                                                                             e             
                      ∂H e                B 1             ∂H                              ∂H
               0 =         η gbt − gbt gbt 2 − A ζ + 2 gb − B ζ + 2 gbB
                                B      A                                           A
                       ∂η                        σδ       ∂b g            σδ               ∂b
                                                                                            g             σδ
                                                                                      A
                                                                                         2                     !
                         1 ∂2H e
                                        B        A 2 1
                                                                1 ∂2H   e         γ                   2     2
                      +            η gbt − gbt                 +                             + (φσ f ) + σ f
                         2 ∂η 2                          σ 2δ     2 ∂ (bg A )2       σ 2δ
                                              2           !
                         1 ∂2H  e        γB              2          ∂2H e
                                                                                 B
                                                                                              A
                                                                                           A γ
                      +                           +  σ   f     −            η  gt   −    gt
                              g B )2      σ 2δ                          gA                      σ 2δ
                                                                               b         b
                         2 ∂ (b                                    ∂η∂b
                          ∂2H                     B             ∂2H  e  γAγB                  
                                               A γ                                                     ∂H
                              e                                                                         e
                                       B                                                      2
                      −          η   gt  −   g t           +                            +   σ f     +      .      (A51)
                              gB                    σ 2δ         g A ∂bgB      σ 2δ
                                     b       b
                         ∂η∂b                                  ∂b                                      ∂t

    The appropriate solution of this PDE is
                                  e η, gbA , gbB , t, u; χ = η χ × HP gbA , gbB , t, u; χ ,
                                                                                        
                                 H                                                                              (A52)
             gbA , gbB , t, u; χ is defined in (A45) and
                                
where HP
                                                       "             2        !              2      !
                                                                γA                       γB
                                      Z u
                                                            A                2     B                2
                 AP (u − t) =               (τ − t) C                   + σf + C                 + σf
                                         t                       σ 2δ                     σ 2δ
                                                    A B            
                                               AB γ γ            2
                                      +2C                     + σf      dτ .                                    (A53)
                                                        σ 2δ
By Radon’s   lemma, the functions of time C A , C AB and C B are obtained as elements of the matrix
           A     AB
     
        C      C
Z=        AB           , itself defined as follows. Let matrices X (u − t) and Y (u − t) be the unique
        C       CB
solution of the linear Cauchy problem
                                  ( .
                                     X = Q11 X + Q12 Y, X (0) = I,
                                      .                                                          (A54)
                                     Y = Q21 X + Q22 Y, Y (0) = 0,


                                                          42
where I is the 2 × 2 identity matrix. Then Z (u − t) = Y (u − t) [X (u − t)]−1 . The coefficients in
(A54) are given by:
                              1
                                χ (χ − 1) σ12          − 12 χ2 σ12
                                                                         !
                              2
                 Q21 =                          δ                δ          ,                     (A55)
                                 − 12 χ2 σ12        1
                                                    2 χ (χ  +  1)    1
                                                                    σ 2δ
                                            δ
                                                                 A                A
                                                                                            
                                     >           ζ + (1 − χ) γσ2               χ γσ2
                 Q11 = − Q22 = 
                                   
                                                            B
                                                                   δ                δ
                                                                                         B
                                                                                            ,    (A56)
                                                      −χ γσ2             ζ + (1 + χ) γσ2
                                                            δ                            δ
                                            2
                                                                                           
                                       A
                                     (γ )
                                                                                A    B
                                                         2      2               γ γ        2
                             −2       σ 2δ
                                               + (φσ f ) + σ f            −2 σ2 + σ f 
                 Q12 =                                                        δ2            , (A57)
                                                                                (γ B )
                                            A B           
                                             γ γ        2                                 2
                                                                                               
                                     −2 σ2 + σ f                         −2       σ2
                                                                                        + σf
                                                    δ                           δ

which completes the proof.


Proof for Lemma 6: Determining wealth and prices of equity and bond
                                                                                                    ξB           ξB
                                                                                                h        i   h           i
                                                                                                                  u δu
Knowing the characteristic function (32), the single-maturity claims prices Eη,fbB ,bg  , Eη,fbB ,bg u
                                                                                                    ξB           ξB δt
              h B Bi                                                                                 t            t
               ξ u cu
and Eη,fbB ,bg ξB cB can be obtained by one of two methods. One is applicable only if 1 − α ∈ N.
                 t  t
                        1       1 1−α
                        η u 1−α       1−α
Then the bracket        λA
                                + λ1B           can be expanded into an exact finite series by virtue
of the binomial formula as in Equation (35) of the text. The overall calculation in this case is
greatly simplified. It leads to the prices of single-maturity claims (36), (37) and (43).40 The second
method is general in that it applies for any value of risk aversion. This method is the inverse Fourier
transform, for which the formulae are given below and which can be computed by means of the
Fast Fourier Transform:
                  B
                  ξ                                        
      Eη,fbB ,bg uB
        B
                      = e−ρ(u−t) Hf fbB , t, u; α − 1                                                      (A58)
                  ξt
                                                         " Z                                          #
                                                               +∞  −iχ
                                    1 − ω(η) 1−α 1
                             Z ∞                
                                                                    η                                     deη
                          ×                                                  g , t, u; α − 1, iχ) dχ
                                                                    e
                                                                         Hg (b                                ,
                              0     1  − ω(e η )           2π −∞    η                                     eη
              B 
               ξu δu                                   
     B
   Eη,fbB ,bg B       = e−ρ(u−t) Hf fbB , t, u; α                                                          (A59)
               ξt δt
                                                         " Z                                    #
                                                               +∞  −iχ
                                    1 − ω(η) 1−α 1
                             Z ∞                
                                                                    η                              deη
                          ×
                                                                    e
                                                                         Hg (b
                                                                             g , t, u; α, iχ) dχ        ,
                              0     1 − ω(e  η)            2π −∞    η                              eη
              B B
              ξ u cu       −ρ(u−t)
                                                       
   EB
    η,fbB ,b
           g ξ B cB
                      =   e        H  f   f
                                          b B
                                              , t, u; α                                                    (A60)
                t t
                                                  " Z +∞  −iχ                               #
                                    1 − ω(η) −α 1
                             Z ∞
                                                                   η                             deη
                          ×
                                                                   e
                                                                        Hg (b
                                                                            g , t, u; α, iχ) dχ       .
                              0     1 − ω(e  η)           2π −∞    η                              η
                                                                                                  e
Similarly, the share of consumption of Group A under the objective probability measure is:
                                              " Z                                       #
                                    Z ∞            +∞  −iχ
                                                1      η                                  deη
          EPη,bgA ,bgB [ω (η u )] =                          HP gbA , gbB , t, u; iχ dχ
                                                       e                            
                                        ω (e
                                           η)                                                 . (A61)
                                     0         2π −∞   η                                  eη
  40
       The χ argument belongs to [0, 1] allowing us to apply Lemma 1 to conclude that Hg is well defined.



                                                          43
    Finally, we would like to consider only economies where the prices of perpetual claims are finite.
Because the prices of perpetual claims involve time integrals of (A58) and (A59) (or (36) and(37))
and these integrals have an infinite upper bound, we need to check for convergence. The conditions
for convergence of prices are derived in the lemma below

Lemma 6 The growth conditions for the price of perpetual equity, F , and the price of the perpetual
bond, P , to be well defined are, respectively:

                                           G (α) < ρ and G (α − 1) < ρ,                                        (A62)

where
                                                      1               ε2 σ 2f
                                          G (ε) = εf + ε(ε − 1)σ 2δ +         .                                (A63)
                                                      2                2ζ 2

                                                      b−q −q(u−t)
Proof : Because for u ≥ t and χ ∈ [0, 1],             q+b e               < 1, we can take Taylor series in (A23):

                                                                                  ∞ 
                                                                    ϑi eυi (u−t) X b − q −2q(u−t) j
                                     P5                        P5
                                           ϑi eυi (u−t)
                                                                                                 
                                       i=1                      i=1
          B (u − t) =                                      =                            e         ,
                               (q + b) 1 − b−q   e −2q(u−t)       (q + b)             q+b
                                            q+b                                  j=0
                              ∞ h
                              X                                       i
                          =         hIj e−jq(u−t) + hII
                                                     j  e−(jq+ζ)(u−t)
                                                                        ,                                      (A64)
                              j=0

where hIj , and hII
                 j are certain functions of χ (and independent of time) such that the series in (A64)
is uniformly convergent.
       Define                                                            
                          Π fbB , gb, t, u; ε, χ = e−ρ(u−t) Hf fbB , t, u; ε Hg (b
                                                                                 g , t, u; ε, χ) .             (A65)

Because in (34) A1 , A2 , C ≤ 0, we have Π ≤ Π, where
                                                               
                Π fbB , gb, t, u; ε, χ = e−ρ(u−t) Hf fbB , t, u; ε exp [εb
                                                                         g B (χ; u − t)] .                     (A66)

Substituting (A64)and (33), we find that the function Π may be written as:
                                                        (
                                                 
        Π fbB , gb, t, u; ε, χ  = π 0 fbB , gb; ε, χ exp [G (ε) − ρ] (u − t) + π 1 (ε) e−2ζ(u−t)
                                                                                                   
                    ∞ h
                    X                                                                           i
                +               g ; ε, χ) e−(j+1)q(u−t) + π II
                          π Ij (b                           j        fbB , gb; ε, χ e−(jq+ζ)(u−t)    ,         (A67)
                                                                                                   
                    j=0

where the series converges uniformly.
   Following the line of argument in Brennan and Xia (2001, Theorem 6)41 one can easily show
that, when χ ∈ [0, 1], the integrals
                                     Z ∞                     
                                        Π fbB , gb, t, u; ε, χ du                      (A68)
                                                t
  41
    To show that for integral (A68), one should additionally note that, because q, ζ > 0 and the series in (A67) is
uniformly convergent, it tends to zero when u → ∞.



                                                                 44
and                  Z    ∞                             Z                  ∞                           
                              Π fbB , gb, t, u; ε, 0 du =                        e−ρ(u−t) Hf fbB , t, u; ε du                               (A69)
                      t                                                  t
are finite if and only if G (ε) − ρ < 0.
   Assume first that 1 − α ∈ N. Then (30) and (29) imply that the prices are well defined as
                    R∞                                                        n    o1−α
                                                                                  j
long as the integral t Π fbB , gb, t, u; ε, χ du is convergent for every χ ∈ J = 1−α      and when
                                                                                                                                      j=0
ε = α for the stock and ε = α − 1. Therefore, convergence of integral (A69) is a necessary condition
(because χ = 0 ∈ J) and convergence of integral (A68) is a sufficient condition (because Π ≤ Π)
for the prices to be well defined. It only remains to notice that, for each price, these conditions are
identical and are given by (A62).
    Now, let α be any real number such that 1 − α > 0. Observe that when y > 0, the function
                  x
f (x) = 1 + y 1/x increases with x > 0:

                                 1           x−1 h                                   i
                f 0 (x) =           1 + y 1/x        x 1 + y 1/x ln 1 + y 1/x − y 1/x ln y
                                 x
                                 1           x−1 h                           i
                          >         1 + y 1/x        xy 1/x ln y 1/x − y 1/x ln y = 0.                                                      (A70)
                                 x
Therefore,
                     "            1                      1    #1−α       "              1                      1     #1−[α]
               1          ηu       1−α              1       1−α                    ηu       1−[α]            1       1−[α]
                 <                        +                              ≤                          +                                 .     (A71)
              λB          λA                       λB                              λA                       λB
                                       1                    1    1−α
                                ηu       1−α            1       1−α
Replacing the bracket           λA
                                               +       λB
                                                                             with its lower and upper bounds (A71) in the
expressions (29) and (30) for securities market prices and applying the above results for the case of
1 − α ∈ N, we obtain necessary (when the lower bound is substituted; χ = 0) and sufficient (when
                                          j
the upper bound is substituted; χ = 1−[α]   , j = 0, ..., 1 − [α]) conditions for the prices to be well
defined. The fact that, for each price, the necessary and sufficient conditions are identical and are
given by (A62) completes the proof.




                                                                        45
                                         References
Abel, A. B., 1990, “Asset Prices under Habit Formation and Catching Up with the Joneses,”
     American Economic Review, 80, 38–42.
Alchian, A., 1950, “Uncertainty, Evolution and Economic Theory,” The Journal of Political Econ-
     omy, 58, 211–221.
Alvarez, F., and J. Jermann, Urban, 2005, “Using Asset Prices to Measure the Persistence of the
     Marginal Utility of Wealth,” Econometrica, 73, 1977–2016.
Bansal, R., and A. Yaron, 2004, “Risks for the Long Run: A Potential Resolution of Asset Pricing
     Puzzles,” Journal of Finance, 59, 1481–151.
Barberis, N., A. Shleifer, and R. Vishny, 1998, “A Model of Investor Sentiment,” Journal of Fi-
     nancial Economics, 49, 307–43.
Barsky, R. B., and J. B. De Long, 1993, “Why Does the Stock Market Fluctuate?,” Quarterly
     Journal of Economics, 108, 291–311.
Basak, S., 2005, “Asset Pricing with Heterogeneous Beliefs,” Journal of Banking and Finance, 29,
     2849–2881.
Berrada, T., 2004, “Bounded Rationality and Asset Pricing,” Working paper, HEC Montreal.
Berrada, T., 2006, “Incomplete Information, Heterogeneity and Asset Pricing,” Journal of Financial
     Econometrics, 4, 136–160.
Bhamra, H. S., and R. Uppal, 2007, “The Effect of Introducing a Non-Redundant Derivative On
     the Volatility of Stock-Market Returns When Agents Differ in Risk Aversion,” forthcoming in
     Review of Financial Studies.
Biais, B., and P. Bossaerts, 1998, “Asset Prices and Trading Volume in a Beauty Contest,” Review
     of Economic Studies, 65, 307–40.
Brennan, M. J., and Y. Xia, 2001, “Stock Price Volatility and Equity Premium,” Journal of Mon-
     etary Economics, 47, 249–83.
Bullard, J., and J. Duffy, 2001, “Learning and Excess Volatility,” Macroeconomic Dynamics, 5,
     272–302.
Buraschi, A., and A. Jiltsov, 2005, “Model Uncertainty and Option Markets with Heterogeneous
     Agents,” forthcoming in Journal of Finance.
Campbell, J. Y., and J. H. Cochrane, 1999, “By Force of Habit: A Consumption-Based Explanation
     of Aggregate Stock Market Behavior,” Journal of Political Economy, 107, 205–51.
Campbell, J. Y., and R. J. Shiller, 1988a, “The Dividend-Price Ratio and Expectations of Future
     Dividends and Discount Factors,” Review of Financial Studies, 1, 195–227.
Campbell, J. Y., and R. J. Shiller, 1988b, “Stock Prices, Earnings, and Expected Dividends,”
     Journal of Finance, 43, 661–76.
Cecchetti, S. G., P.-s. Lam, and N. C. Mark, 2000, “Asset Pricing with Distorted Beliefs: Are
     Equity Returns Too Good to Be True?,” American Economic Review, 90, 787–805.
Cheng, P., and O. Scaillet, 2006, “Linear-Quadratic Jump-Diffusion Modelling,” Working paper,
     HEC Geneva, University of Geneva.
Cochrane, J. H., 2001, Asset Pricing, Princeton University Press.
Constantinides, G. M., 1990, “Habit Formation: A Resolution of the Equity Premium Puzzle,”
     Journal of Political Economy, 98, 519–43.


                                               46
Constantinides, G. M., 1992, “A Theory of the Nominal Term Structure of Interest Rates,” Review
     of Financial Studies, 5, 531–552.
Cox, J. C., and C.-f. Huang, 1989, “Optimal Consumption and Portfolio Policies When Asset Prices
     Follow a Diffusion Process,” Journal of Economic Theory, 49, 33–83.
Daniel, K., D. Hirshleifer, and A. Subrahmanyam, 1998, “Investor Psychology and Security Market
     Under- and Overreactions,” Journal of Finance, 53, 1839–85.
David, A., 2007, “Heterogenous Beliefs, Speculation, and the Equity Premium,” forthcoming in
     Journal of Finance.
David, A., and P. Veronesi, 2002, “Option Prices with Uncertain Fundamentals: Theory and
     Evidence on the Dynamics of Implied Volatilities,” Working paper, University of Chicago.
De Long, J. B., A. Shleifer, L. H. Summers, and R. J. Waldmann, 1990a, “Noise Trader Risk in
     Financial Markets,” Journal of Political Economy, 98, 703–38.
De Long, J. B., A. Shleifer, L. H. Summers, and R. J. Waldmann, 1990b, “Positive Feedback
     Investment Strategies and Destabilizing Rational Speculation,” Journal of Finance, 45, 379–
     95.
De Long, J. B., A. Shleifer, L. H. Summers, and R. J. Waldmann, 1991, “The Survival of Noise
     Traders in Financial Markets,” Journal of Business, 64, 1–20.
Detemple, J., and S. Murthy, 1994, “Intertemporal Asset Pricing with Heterogenous Beliefs,” Jour-
     nal of Economic Theory, 62, 294–320.
Detemple, J. B., R. Garcia, and M. Rindisbacher, 2003, “A Monte Carlo Method for Optimal
     Portfolios,” Journal of Finance, 58, 401–446.
Detemple, J. B., and F. Zapatero, 1991, “Asset Prices in an Exchange Economy with Habit For-
     mation,” Econometrica, 59, 1633–57.
Duffie, D., N. Garleanu, and L. H. Pedersen, 2002, “Securities Lending, Shorting, and Pricing,”
     Journal of Financial Economics, 66, 307–39.
Friedman, M., 1953, Essays in Positive Economics, University of Chicago Press, Chicago, IL.
Gallmeyer, M., 2000, “Beliefs and Volatility,” Working paper, Carnegie Mellon University.
Grossman, S. J., and J. E. Stiglitz, 1980, “On the Impossibility of Informationally Efficient Mar-
     kets,” American Economic Review, 70, 393–408.
Hansen, L. P., J. C. Heaton, and N. Li, 2005, “Consumption Strikes Back? Measuring Long Run
     Risk,” Working paper, University of Chicago.
Hansen, L. P., and J. A. Scheinkman, 2005, “Long Term Risk: An Operator Approach,” Working
     paper, Princeton University.
Harris, M., and A. Raviv, 1993, “Differences of Opinion Make a Horse Race,” Review of Financial
     Studies, 6, 473–506.
Hellwig, M. F., 1980, “On the Aggregation of Information in Complete Markets,” Journal of Eco-
     nomic Theory, 26, 279–312.
Heston, S. L., 1993, “A Closed-Form Solution for Options with Stochastic Volatility with Applica-
     tions to Bond and Currency Options,” Review of Financial Studies, 6, 327–43.
Hong, H., and J. C. Stein, 1999, “A Unified Theory of Underreaction, Momentum Trading, and
     Overreaction in Asset Markets,” Journal of Finance, 54, 2143–84.
Jouini, E., and C. Napp, 2006, “Consensus Consumer and Intertemporal Asset Pricing with Het-
     erogeneous Beliefs,” forthcoming in Review of Economic Studies.


                                               47
Kandel, E., and N. D. Pearson, 1995, “Differential Interpretation of Public Signals and Trade in
     Speculative Markets,” The Journal of Political Economy, 103, 831–872.
Karatzas, I., J. Lehoczky, and S. Shreve, 1987, “Optimal Portfolio and Consumption Decisions
     for a ‘Small Investor’ on a Finite Horizon,” SIAM Journal of Control and Optimization, 25,
     1157–1186.
Kim, T. S., and E. Omberg, 1996, “Dynamic Nonmyopic Portfolio Behavior,” Review of Financial
     Studies, 9, 141–61.
Kogan, L., S. Ross, J. Wang, and M. Westerfield, 2006, “The Survival and Price Impact of Irrational
     Traders,” Journal of Finance, 61, 195–229.
LeRoy, S. F., and R. D. Porter, 1981, “The Present-Value Relation: Tests Based on Implied Variance
     Bounds,” Econometrica, 49, 555–74.
Lintner, J., 1969, “The Aggregation of Investor’s Diverse Judgments and Preferences in Purely
     Competitive Security Markets,” Journal of Financial and Quantitative Analysis, 4, 347–400.
Lipster, R. S., and A. N. Shiryaev, 2001, Statistics of Random Processes II, Applications, Springer
     Verlag, second edn.
Liu, 2006, “Portfolio Selection in Stochastic Environments,” forthcoming in Review of Financial
     Studies.
Loewenstein, M., and G. A. Willard, 2006, “The Limits of Investor Behavior,” Journal of Finance,
     61, 231–258.
Menzly, L., T. Santos, and P. Veronesi, 2004, “Understanding Predictability,” Journal of Political
     Economy, 112, 1–47.
Merton, R. C., 1971, “Optimum Consumption and Portfolio Rules in a Continuous Time Model,”
     Journal of Economic Theory, 3, 373–413.
Merton, R. C., 1973, “The Theory of Rational Option Pricing,” Bell Journal of Economics and
     Management Science, 4.
Morris, S., 1995, “The Common Prior Assumption in Economic Theory,” Economics and Philoso-
     phy, 11, 227–253.
Nualart, D., 1995, The Malliavin Calculus and Related Topics, Springer-Verlag, New York.
Ocone, D., and I. Karatzas, 1991, “A Generalized Clark Representation Formula with Application
     to Optimal Portfolios,” Stochastics and Stochastics Reports, 34, 187–220.
Øksendal, B., 1997, “An Introduction to Malliavin Calculus with Applications to Economics,”
     Unpublished lecture notes: www.nhh.no/for/dp/1996/wp0396.pdf.
Riedel, F., 2001, “Existence of Arrow-Radner Equilibrium with Endogenously Complete Markets
     under Incomplete Information,” Journal of Economic Theory, 97, 109–122.
Scheinkman, J. A., and W. Xiong, 2003, “Overconfidence and Speculative Bubbles,” Journal of
     Political Economy, 111, 1183–1219.
Shefrin, H., 2005, A Behavioral Approach to Asset Pricing, Academic Press Inc., London.
Shiller, R. J., 1981, “Do Stock Prices Move Too Much to be Justified by Subsequent Changes in
     Dividends?,” American Economic Review, 71, 421–36.
Spiegel, M., 1998, “Stock Price Volatility in a Multiple Security Overlapping Generations Model,”
     Review of Financial Studies, 11, 419–447.
Timmermann, A., 1996, “Excess Volatility and Predictability of Stock Prices in Autoregressive
     Dividend Models with Learning,” Review of Economic Studies, 63, 523–57.


                                                48
Timmermann, A. G., 1993, “How Learning in Financial Markets Generates Excess Volatility and
     Predictability in Stock Prices,” Quarterly Journal of Economics, 108, 1135–45.
Veronesi, P., 1999, “Stock Market Overreaction to Bad News in Good Times: A Rational Expec-
     tations Equilibrium Model,” Review of Financial Studies, 12, 975–1007.
Wang, J., 1993, “A Model of Intertemporal Asset Prices under Asymmetric Information,” Review
     of Economic Studies, 60, 249–82.
Williams, J. T., 1977, “Capital Asset Prices with Heterogeneous Beliefs,” Journal of Financial
     Economics, 5, 219–39.
Yan, H., 2006, “Natural Selection in Financial Markets: Does It Work?,” Working paper, Yale
     University.
Ziegler, A., 2000, “Optimal Portfolio Choice under Heterogeneous Beliefs,” European Finance Re-
     view, 4, 1–19.




                                              49
