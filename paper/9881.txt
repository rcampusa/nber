                                  NBER WORKING PAPER SERIES




                              THE EFFECT OF SCHOOLING AND
                          ABILITY ON ACHIEVEMENT TEST SCORES

                                            Karsten Hansen
                                           James J. Heckman
                                           Kathleen J. Mullen

                                          Working Paper 9881
                                  http://www.nber.org/papers/w9881


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       July 2003




This research is supported by grants from NICHD-40-4043-000-85-261 and NSF SES-0099195.We thank
Chris Winship for a stimulating discussion which influenced this paper. (See his related research reported in
Winship, 2001). We have benefitted from numerous comments by Derek Neal and Chris Winship on various
aspects of this paper. We also thank Joseph Kaboski, Salvador Navarro, Sergio Urzua, participants of the
Empirical Economics workshop and the Theory and Econometrics workshop at the University of Chicago,
and an anonymous referee for helpful comments. The views expressed herein are those of the authors and not
necessarily those of the National Bureau of Economic Research.

©2003 by Karsten Hansen, James J. Heckman, and Kathleen J. Mullen. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
The Effect of Schooling and Ability on Achievement Test Scores
Karsten Hansen, James J. Heckman, and Kathleen J. Mullen
NBER Working Paper No. 9881
July 2003
JEL No. C35, C15, I21

                                           ABSTRACT

        This paper develops two methods for estimating the effect of schooling on achievement test
scores that control for the endogeneity of schooling by postulating that both schooling and test
scores are generated by a common unobserved latent ability. These methods are applied to data on
schooling and test scores. Estimates from the two methods are in close agreement. We find that the

effects of schooling on test scores are roughly linear across schooling levels. The effects of

schooling on measured test scores are slightly larger for lower latent ability levels. We find that
schooling increases the AFQT score on average between 2 and 4 percentage points, roughly twice
as large as the effect claimed by Herrnstein and Murray (1994) but in agreement with estimates
produced by Neal and Johnson (1996) andWinship and Korenman (1997). We extend the previous

literature by estimating the impact of schooling on measured test scores at various quantiles of the
latent ability distribution.

Karsten Hansen                                       James J. Heckman
Kellogg School of Management                         Department of Economics
Northwestern University                              The University of Chicago
Evanston, IL 60657                                   1126 East 59th Street
karsten-hansen@northwestern.edu                      Chicago, IL 60637
                                                     and NBER
                                                     jjh@uchicago.edu

Kathleen J. Mullen
Department of Economics
The University of Chicago
1126 East 59th Street
Chicago, IL 60637
kjmullen@midway.uchicago.edu
1       Introduction
There are two widely held and mutually inconsistent conceptions of ability and scholastic achievement
tests. The first view claims that cognitive ability is essentially fixed at a relatively early age (around
age seven) and is virtually unchanged afterward. According to this view, achievement tests and IQ tests
measure the same fundamental cognitive skill. The correlation between IQ and achievement tests is high
and proponents of this view use these two types of tests interchangeably. According to scholars who
advocate this point of view, schooling and other influences barely budge measured IQ. (See the evidence
summarized in Herrnstein and Murray, 1994, Appendix 2.) A consensus estimate in this literature is that
a year of schooling raises measured IQ by about one point (Jencks, 1972; Herrnstein and Murray, 1994).1
    A second widely held view claims that schooling raises achievement measured by tests and more
successful types of schooling raise measured achievement more. This is the premise of large scale testing
programs designed to monitor the performance of schools. Debates about the eﬀectiveness of vouchers and
interventions hinge on their eﬀects on measured achievement (see, e.g., Hanushek, 2002). This literature
implicitly separates out latent ability (IQ) from measured ability and views schooling as a mechanism for
either enhancing or revealing ability. Proponents of this view argue that schooling can increase measured
ability by as much as 2 to 4 points (Winship and Korenman, 1997; Neal and Johnson, 1996), or 2.9 to 5.7
AFQT points (2.7 to 5.4 percentage points).
    This paper presents evidence that the measure of IQ used by Herrnstein and Murray is strongly aﬀected
by schooling. Postulating that latent ability cannot be aﬀected by schooling, we test whether manifest
ability is aﬀected by schooling when both schooling and manifest ability are aﬀected by latent ability.
Manifest ability is widely regarded as a determinant of socioeconomic success. Gaps in test scores across
socioeconomic groups are widely viewed as a major source of social problems (Jencks and Phillips, 1998;
Herrnstein and Murray, 1994). We examine whether measured ability gaps can be eliminated by schooling.
    Our measures of ability are the ASVAB achievement (competency) tests used to screen persons entering
the military. ASVAB stands for Armed Services Vocational Aptitude Battery and is described in more
detail below. We find that schooling, especially in the high school years, is an important determinant of
measured achievement. It operates diﬀerently at diﬀerent latent ability levels.
    In order to establish these conclusions, we need to address the problem of reverse causality. There
is a well-established empirical regularity that measured test scores predict schooling. Individuals choose
to attend school in part based on their own intelligence which is measured by test scores. In addition,
admission into colleges and fellowship support is based, in part, on scores on tests like the Scholastic
Assessment Test (SAT). The central econometric question addressed in this paper is how to characterize
and solve the problem of joint causality: schooling causing test scores and test scores causing schooling.
    1
    IQ is assumed to have mean 100 and standard deviation 15. Many of the papers in the literature obtain estimates
using the Armed Forces Qualification Test (AFQT), the test used in this paper, which has a scale of 0-105. Typically
estimates are converted into “IQ points” by computing the eﬀect of education in terms of standardized AFQT score and
then, assuming that a standard deviation increase in AFQT is equivalent to a standard deviation increase in IQ score, by
further multiplying by 15. Herrnstein and Murray (1994) estimate an increase of 1.1 IQ points per year of education, or
1.6 AFQT points (1.5 percentage points), using our estimate of the standard deviation of AFQT, 21.6.



                                                           1
Our solution is based on a model of test scores as manifestations of latent ability (and other determinants)
with schooling determined by latent ability (and other determinants). Our framework accounts for ceiling
eﬀects (on some easy tests, students with very diﬀerent ability levels get perfect scores) and endogeneity
of schooling (which includes choice of date of entry into schooling as well as choice of final schooling level).
    We find that the eﬀects of schooling on test scores for a given level of ability are approximately linear
across schooling levels. Eﬀects are slightly larger for those with lower ability. Schooling increases the
AFQT score on average between 2 and 4 percentage points. This is roughly twice as large as the eﬀect
claimed by Herrnstein and Murray (1994).
    The plan of this paper is as follows. Section 2 presents our framework and discusses some important
conceptual issues. Section 3 applies the method of control functions, developed by Heckman (1976, 1980)
and Heckman and Robb (1985, 1986), to identify schooling eﬀects on tests using a special feature of the
National Longitudinal Survey of Youth (NLSY) data. A nonparametric version of the method is developed,
but it suﬀers from certain practical limitations in more general cases. Section 4 presents a parametric
econometric model motivated by choice theory for the joint determination of schooling and test scores.
This method allows us to supplement the nonparametric control function method to impose additional
identifying information to develop a method for determining the eﬀects of schooling on test scores in more
general data sets than the NLSY and to account for ceiling eﬀects on tests. Section 5 presents empirical
results. Section 6 concludes. Appendix A describes the data. The estimation algorithm for the control
function approach is presented in Appendix B. The likelihood and the Bayesian computational methods
used to estimate it are presented in Appendix C.


2         The Relationship Between Ability and Schooling
Let T (s) be the test score of a person with s years of schooling at the time the test is taken. For notational
simplicity, we keep implicit the conditioning on all other variables that determine T (s) except latent ability
f . The other variables might include age, socioeconomic status of the parents, and other environmental
and genetic factors. We account for some of these additional variables in our empirical work.
    Our model of test scores is based on an extension of the factor analysis model used in psychometrics
(see e.g., Lord and Novick, 1968). Test score T (s) is a manifestation of latent ability f mediated by
schooling:
                                         T (s) = µ(s) + λ(s)f + ε(s)                                        (1)
where it is assumed that ε(s) is independent of f . Both f and ε(s) are assumed to have zero means. This
amounts to a normalization and a definition of the mean, µ(s). We extend the standard model of factor
analysis by allowing the level of s selected to depend on f . For externally-manipulated levels of schooling,
µ(s) in equation (1) is the eﬀect of schooling that is uniform across latent ability levels and λ(s) is the
eﬀect of schooling on revealing or transforming latent ability f . The marginal causal eﬀects of changing
schooling from s0 to s on levels and slopes are µ(s) − µ(s0 ) and λ(s) − λ(s0 ) respectively using the usual
ceteris paribus logic familiar to all economists.2
    2
        Throughout this paper we maintain the traditional separable-in-the-errors model of equation (1). A more general

                                                            2
    The psychometric and educational testing literatures are fundamentally ambiguous about what con-
stitutes cognitive ability. Is it f , T (s), µ(s) or µ(s) + λ(s)f ? Neal and Johnson (1996), Winship and
Korenman (1997), Winship (2001), and Herrnstein and Murray (1994) take measured test scores (T (s))
to be cognitive ability. Yet the logic of IQ testing interprets f as cognitive ability. A reinterpretation of
equation (1) writes λ(s)f as ability determined at schooling level s. Knowing only T (s) and S = s, we
cannot decide which of these interpretations is correct. Without further information, the model is funda-
mentally underidentified because we do not observe f . We can identify the combination of parameters
in
                          E(T (s)|S = s) = µ(s) + λ(s)E(f |S = s) + E(ε(s)|S = s)                         (2)
but the causal status of an estimated eﬀect of S is unclear because both E (f | S = s) and E (ε(s) | S = s)
may depend on S. Thus latent cognitive ability (f ) may determine S and so may measured ability (T (s)
and hence ε(s) given f ). If the test studied does not directly aﬀect schooling decisions, e.g. through its
use in admission criteria, as is the case for the test analyzed in this paper, then E(ε(s)|S = s) = 0.3
    The empirical literature recognizes the problem of reverse causality, and adopts diﬀerent strategies
for identifying diﬀerent parameters. Herrnstein and Murray (1994) and Winship and Korenman (1997)
implicitly adopt µ(s) as their parameter of interest, assume that µ(s) = sβ (linearity) and use an “early”
test score (obtained at an earlier age) to proxy f .4 Let proxy P be

                                                 P = γ 0 + γ 1 f + ε(P )                                                (3)

where f and ε(P ) are independent, and γ 0 ,γ 1 are assumed not to be functions of the S in (1). Solving for
f and substituting into (1) we obtain
                                                             ·                 ¸
                                               γ 0 λ(s)              λ(s)ε(P )
                          T (s) = µ(s) − λ(s) +          P + ε(s) −              .                       (4)
                                               γ1     γ1                γ1

    Observe that the composite error is correlated with P unless P is a perfect proxy for f (ε(P ) = 0) ,
the implicit assumption used by Herrnstein and Murray (1994).5 Herrnstein and Murray also implicitly
assume that λ(s) does not depend on s. Then, using ordinary least squares applied to (4), they estimate
the marginal eﬀect of schooling which in their setup is β (µ(s) = sβ). If λ(s) = λ, but ε(P ) 6= 0, and if
λγ 1 > 0 (so that f aﬀects P and T (s) in the same way), then least squares based on (3) is upward biased.
More generally, if λ depends on s, the bias is ambiguous and depends on specific parameter configurations.
The combination of parameters µ(s) − λ(s) γγ 0 becomes the implicit parameter estimated and it does not
                                                  1
answer the questions posed in the literature.
    Winship and Korenman (1997) consider the problem of measurement error in their proxy P . They draw
on work by Ashenfelter and Krueger (1994) who claim that the reliability (the proportion of variance of
P that is true, γ 21 σ 2f , relative to the total variance γ 21 σ 2f + σ 2ε ) of IQ measures is typically above 0.9.
nonseparable model would be desirable but is beyond the scope of this paper.
   3
     Even though the tested know their scores they are not directly used by schools or firms to screen persons and we assume
that they do not aﬀect subsequent actions.
   4
     These authors also include additional control variables which we do not discuss.
   5
     Pakes and Olley (1995) make the same assumption in a diﬀerent context.

                                                             3
Winship and Korenman carry out a variety of sensitivity analyses, estimating the model under diﬀerent
assumptions about the reliability of the early IQ score, which they let take on values between 0.8 and 1.
They obtain a wide range of estimates of the eﬀect of schooling on AFQT, from 1.5 to 5 points. Correcting
for measurement error under what Winship and Korenman believe to be “reasonable assumptions about
the extent of measurement error,” they estimate the eﬀect of education to be 2.7 IQ points per year of
school and they state that “a year of education most likely increases IQ by somewhere between 2 and 4
points.”
    Neal and Johnson take a diﬀerent approach. They choose β in the specification µ(s) = sβ as their
parameter of interest and use month of birth (which determines years of schooling attained by a given
birth cohort) as an instrument to avoid dependence of S on f .6 This forced variation in schooling attained
among children of the same nominal birth cohort is a source of identifying variation. We estimate a richer
set of parameters and consider how schooling aﬀects test scores at diﬀerent levels of the latent ability
distribution. However, our estimates of the same parameter are in agreement with theirs.
    A variety of other studies, surveyed by Ceci (1991), rely on various “natural experiments” of uncertain
quality. Winship and Korenman (1997) survey and criticize this literature.
    In this paper, we estimate µ(s) and λ(s) for diﬀerent levels of schooling without imposing the para-
metric restrictions used in the previous literature. We explicitly account for the endogeneity of completed
schooling. In addition we estimate the distribution of latent ability (f ) and compare it with measured
ability. We can identify the eﬀect of schooling on measured test scores at diﬀerent latent ability (f ) levels.
This allows us to identify where in the overall distribution of ability schooling interventions are the most
eﬀective. We first develop estimators based on the principle of control functions.


3       Simple Identification Strategies Based on Control Functions
Our first approach to this problem exploits an unusual feature of the NLSY data. The test we study is
given to a nationally representative sample of people. Some people who take the test are in school while
others have finished school. We observe completed schooling for all individuals. Let ST denote schooling
that a person has at the date of the test. We observe the test score T (ST ) which can be expressed as

                                         T (ST ) = µ(ST ) + λ(ST )f + ε(ST ).                                          (5)
Letting S denote the final level of schooling that is actually attained, S ≥ ST . Let A be the age at which
a person is tested. If we redefine age so that schooling starts at age 0 and if we assume that dropouts do
not return to school, then we observe ST = A < S if the test date comes before a person has completed
his schooling.7 If he has completed schooling by the time of the test, then we observe ST = S.
    Using the control function approach introduced in Heckman (1976, 1980) and Heckman and Robb
(1985, 1986), and assuming no maturation eﬀects (no independent eﬀect of age on performance on the
    6
     In most school districts, in a given year any 5 year-old child whose birthday falls after October 1 must wait to start
school in the following year.
   7
     Cameron and Heckman (2001) present evidence that few high school dropouts return to school.


                                                            4
test) and that everyone starts school at the same age, we may write observed tests conditional on final
schooling and schooling at the test date as

                          E(T (ST )|ST = sT , S = s) = µ(sT ) + λ(sT )E(f |ST = sT , S = s)                      (6)
                                                              +E(ε(ST )|ST = sT , S = s).

To simplify the notation we keep other conditioning variables implicit.
   Because sampling is random across ages, if individuals consider only their final schooling level when
making schooling decisions, irrespective of their path to schooling and there is no dropping out and re-
entry, conditional on S = s the observed ST is random with respect to f . Thus E(f | ST = sT , S = s) =
E(f | S = s). Further, if the test is not used to make decisions about schooling, E(ε(ST ) | ST = sT ,
S = s) = 0.
   Under these assumptions we obtain

                               E(T (ST ) | ST = sT , S = s) = µ(sT ) + λ(sT )E(f | S = s).                       (7)

From this equation it is clear that we cannot identify the scale of f without some normalization. Setting
λ (1) = 1 is one such normalization. We can identify λ(sT ) up to the normalization because for two
diﬀerent schooling levels s, s0 ≥ sT , s 6= s0 ,

        E(T (ST ) | ST = sT , S = s) − E(T (ST ) | ST = sT , S = s0 ) = λ(sT )[E(f | S = s) − E(f | S = s0 )].

Assuming λ(sT ) 6= 0, we may form the ratio
                         E(T (ST ) | ST = s0T , S = s) − E(T (ST ) | ST = s0T , S = s0 )   λ(s0T )
                                                                                         =
                         E(T (ST ) | ST = sT , S = s) − E(T (ST ) | ST = sT , S = s0 )     λ(sT )
for two values sT 6= s0T , both less than or equal to s, s0 . Therefore with one normalization we can identify
                                                              ¡ ¢
all of the λ(sT ), sT = 1, ..., S̄ − 1 (we cannot identify λ S̄ because there is only one possible value of s
for ST = S̄).
    Taking expectations with respect to ST alone we obtain

                                 E (T (ST ) | ST = sT ) = µ (sT ) + λ(sT )E[f |ST = sT ].8                       (8)

Recall that we know λ(sT ), sT = 1, . . . , S̄ − 1, from the preceding argument. Subtracting (8) from (7) we
obtain

           E(T (ST ) | ST = sT , S = s) − E(T (ST ) | ST = sT ) = λ(sT )[E(f | S = s) − E(f | ST = sT )]

so we can identify for s ≥ sT , sT = 1, . . . , S̄ − 1,
                                                      E(T (ST ) | ST = sT , S = s) − E(T (ST ) | ST = sT )
               E(f | S = s) − E(f | ST = sT ) =                                                            .     (9)
                                                                              λ(sT )
   Let E(f | S = s) = as and E(f | ST = sT ) = bsT . We can form a matrix of the following identifiable
combination of parameters:
   8
       Note that E(ε(ST )|ST = sT ) = E[E[ε(ST )|ST = sT , S = s]|ST = sT ] = 0.

                                                               5
                                                                                                
                                   aS̄ − b1    aS̄−1 − b1           ...   ...    ... a1 − b1
                                                                                                
                                  aS̄ − b2    aS̄−1 − b2           ...   ...    ...    ∼        
                                                                                                
                                      ...          ...             ...   ...    ∼      ∼        
                                                                                                
                                                                                                
                                 aS̄ − bS̄−1 aS̄−1 − bS̄−1         ...   ∼      ∼      ∼        
                                       ∼            ∼               ...   ∼      ∼      ∼

where “∼” in a cell denotes the absence of data on the entry. We also know as a consequence of E (f ) = 0
that if we define Pj = Pr(S = j)
                                              XS̄
                                                  aj Pj = 0.                                         (10)
                                                     j=1

Letting Pej be Pr(ST = j), we also obtain
                                                     X
                                                     S̄
                                                           bj Pej = 0.                                          (11)
                                                     j=1

Taking a weighted sum across row 1 of the matrix, we identify b1 since

                                  X
                                  S̄                      X
                                                          S̄                    X
                                                                                S̄
                                        Pj (aj − b1 ) =         aj Pj − b1            Pj = −b1
                                  j=1                     j=1                   j=1

                               P
by (10) and the fact that S̄j=1 Pj = 1. Going across the first row element by element, we obtain aj , j =
1, . . . , S̄. Going down the first column, we obtain the remaining bj , j = 1, . . . , S̄ −1. Using (11) we identify
                                                        ¡ ¢
bS̄ . Thus the model is fully identified except for λ S̄ .
      Attractive as these results are, there are three reasons to be cautious about estimates derived from this
identification strategy: (a) Age eﬀects (maturation eﬀects) may aﬀect test scores independently of any
eﬀect of schooling because persons may acquire life experiences that raise their test scores independently
of their schooling at the date of the test. Our procedure has to be modified to distinguish age eﬀects
from schooling eﬀects. (b) Persons start school at diﬀerent ages. Less able people (those with lower f )
may start school at later ages, making an assumption of an identical school starting age for all persons
problematic. Simply conditioning on the starting age N to solve this problem is not satisfactory given
its likely dependence on f . (c) In principle there might be a separate N eﬀect on test scores apart from
the dependence of N on f if there are discouragement eﬀects (students older than their classmates may
feel inferior and be less motivated). The confluence of an endogenous N and independent age eﬀects is
problematic.
      Modeling the starting age N along with the schooling level S does not pose any conceptually new
problem as long as there are no age at test eﬀects. We can use diﬀerent (ST , N), (S, N) pairs and replace
(ST , S) in the preceding analysis. Data cells may thin out but the previous identification strategy works.
      Allowing for age in addition to N produces a fundamental identification problem if we maintain the
“no return to school for dropouts” assumption. Observe that by definition ST = min {A − N, S}, so that
S, ST and A − N cannot be freely varied. A more general model that incorporates age and entry writes
the test score T as T (A, ST , S, N) where A is the age at the test, ST is the level of schooling at the


                                                                6
date of the test, S is the final level of schooling attained and N is the age at which the person enters
school. For simplicity normalize N = 0 to be the “normal age” of starting school. If A and ST both aﬀect
the measured test score directly, while S and N do not directly aﬀect the test score but potentially are
stochastically dependent on latent ability f , we may write

                                  T (A, ST , S, N) = µ(A, ST ) + λ(A, ST )f + ε(A, ST ).9                                        (12)

Then conditioning on observable (A, ST , S, N) we obtain

       E(T (A, ST , S, N)|A = a, ST = sT , S = s, N = n) = µ(a, sT ) + λ(a, sT )E(f |S = s, N = n)                               (13)

where we assume ε(A, ST ) is independent of all other variables. Observe that when ST < S, fixing N and
ST determines A:
                                              A = ST + N                                            (14)
    This exact linear dependence does not apply to persons with completed schooling (ST = S). In that
subpopulation, S and ST cannot be independently varied so the control function identification strategy
previously developed breaks down but the exact linear dependence (14) does not hold so that we can
independently vary A and ST = S for each N. If we parameterize µ (A, ST ) and λ (A, ST ), we can identify
separate eﬀects of age and schooling at the test date.10 With suﬃcient structure, we can extrapolate
µ (A, ST ) and λ (A, ST ) back to ages and schooling levels at schooling levels ST < S. This method is
pursued in Section 4.
    In our data, there are eﬀectively two starting ages N ∈ N = {0, 1}. Given our “no return to school
for dropouts” assumption, in the sample S > ST , people who start school one year later are also one
year older at schooling level ST than are people who start school at a normal age. We cannot identify a
separate N eﬀect from an A eﬀect.
    If we condition on each value of N = n and repeat the preceding identification argument for each N,
we identify µ (sT , n) and λ (sT , n) , s, s0 ≥ sT from the sample S ≥ ST by conditioning on ST = sT and
N = n in (8). When N = 0, ST = A if schooling is incomplete at the test date (S > ST ). We identify
a joint schooling and age eﬀect for each N. When N = 1, we can identify the eﬀect of being one year
older on µ (sT ) and λ (sT ) for samples in which S > ST . This eﬀect is indistinguishable from the eﬀect of
starting one year later. We can test for an age (at test or entry) eﬀect by testing µ (sT , 0) = µ (sT , 1) and
λ (sT , 0) = λ (sT , 1).11 This argument can be modified in a straightforward way to account for the case of
more than two elements in N .
    While intuitively appealing, the method based on control functions does not exploit all of the infor-
mation in the S = ST sample. Data where S = ST is the more commonly occurring case. It is not
   9
     If N causally aﬀects the test, then (12) is modified to read T (A, ST , S, N ) = µ (A, ST , N )+λ (A, ST , N ) f +ε (A, ST , N ) .
  10
     Thus with µ(A, ST ) = ϕ1 (A) + ϕ2 (ST ) and λ(A, ST ) = η1 (A) + η2 (ST ) we can break these linear dependencies. Multi-
plicative versions can work as well. This is the strategy used in section 4 to achieve identification of these eﬀects. See the
closely related identification analysis of Heckman and Vytlacil (2001).
  11
     Observe that for persons for whom S = ST , age at test is not restricted by (14). Thus we can in principle identify age
eﬀects when we use S = ST observations, but we cannot use the control function method developed in this section to solve
the selection problem.

                                                                  7
straightforward to use the control function method to account for ceiling eﬀects. When S = ST , it is
possible in principle to isolate separate A, N and S eﬀects. We now present a diﬀerent method designed
to analyze the entire sample more fully.


4    A Discrete-Continuous Econometric Model of Schooling and
     Test Scores
This section develops a more explicitly structured semiparametric model that does not rely on special
features of the NLSY data and that enables us to condition more finely. The model also enables us to link
our work to more conventional models of schooling and wages, and identify separate S, A and N eﬀects.
Initially we assume S = ST and then we extend the analysis to allow for the case S > ST .
    Unlike the control function method developed in Section 3, the method discussed in this section
requires more than one test. Suppose that we have data on K (≥ 2) tests associated with diﬀerent levels
of schooling S = s. Array the tests into a vector

                                         T (s, x) = µ(s, x) + Q(s, x)

where the kth component of Q, Qk (s, x), has a factor structure Qk (s, x) = λk (s)f + εk (s), k = 1, ..., K,
s = 1, ..., S like the one used in sections 2 and 3. Exact stochastic specifications are given in section 4.1.
   We use the following notation
                                                                    
                                                           T1 (s, x)
                                                                    
                                            T (s, x) =        ...   
                                                           TK (s, x)
                                                                    
                                                           µ1 (s, x)
                                                                    
                                             µ(s, x) =        ...   
                                                           µK (s, x)
                                                                    
                                                           Q1 (s, x)
                                                                    
                                        and Q(s, x) =         ...   .
                                                           QK (s, x)
   We initially work with Q and produce a semiparametric identification theorem for the distribution
of Q and other variables. Then we identify the distributions of the components of the Q. The X are
determinants of tests. We assume Q(s, x) ⊥      ⊥X throughout. We observe T (s, x) only if S = s. The
schooling states in this section can be defined in a suﬃciently general way to include diﬀerent schooling-
entry ages as diﬀerent states. Other definitions for the states are possible (e.g. the Cartesian product of
schooling, entry age, schooling quality, etc.), so S can be interpreted in a general way.
   In order to account for the endogeneity of schooling, we construct the following model of schooling
choice, which we adjoin to the system of test scores:

                                  V (s) = ϕs (Z) + η(s),      s = 1, . . . , S̄,                         (15)

                                                      8
where V (s) is the utility associated with schooling level s, and Z is a vector of determinants of utility.
                       ¡              ¢
We assume that η = η(1), . . . , η(S̄) is absolutely continuous with support RS̄ . This joint system of
test scores and choice equations is a mixed discrete-continuous choice model as in Heckman (1974a,b).
Optimal schooling is sb = arg maxs {V (s)}S̄s=1 . The Z variables may be state-specific or general. Suﬃcient
conditions for nonparametric identifiability of versions of this model are available in the literature.12 We
present a new analysis.
    We observe T (s, x) for each schooling level conditional on ŝ = s. We assume:

                                 (Q(s, x), η) ⊥
                                              ⊥ (Z, X),    for all s = 1, . . . , S̄.
                                 The (Q(s, x), η) have zero means and finite variances.                             (A-1)

                   (Q(s, x), η) for all s = 1, . . . , S̄ are absolutely continuous with support RK+S̄ .            (A-2)
Under these assumptions, we can write

           Pr(T (s, x) < t|ŝ = s, X = x, Z = z)                                                                      (16)
                         = Pr(Q(s, x) < t − µ(s, x)|V (s) > V (s0 ), s0 6= s, s0 = 1, ..., S̄), s = 1, ..., S̄,

where both t and T (s, x) are vectors.
    Adapting an argument from Heckman and Honore (1990), for each choice ŝ = s we can trace out each
of the components of µ(s, x) over their supports for each corresponding component of t up to intercepts
which we can obtain by a limit argument presented below.13
    In this paper we assume the following functional form for utility. For Z a 1 × J vector of variables
aﬀecting choices we assume a linear-in-parameters model:

                                                     ϕs (Z) = Zγ(s).

       We define
                                              ϕs,s0 (Z) = Z (γ(s) − γ(s0 )) ,
        and
                                                 η(s, s0 ) = η(s) − η(s0 ).
If the j th coordinate of γ(s) is zero, the variable does not aﬀect the sth level of utility. We adopt the nota-
tional convention that the first coordinate of Z is the intercept. Array the contrasts of the unobservables
into a vector of length S̄ − 1 where the entry η (s, s) (= 0) is deleted:

                                                    ¡                    ¡     ¢¢
                                             η (s) = η (s, 1) , . . . , η s, S̄ .
As a consequence of these assumptions, we may write
  12
      Matzkin (1993) and Thompson (1989) consider the special case where utility functions are identical across choices. In
the linear-in-parameters case, they assume γ(s) = γ. See Cameron and Heckman (1998) for a more general analysis.
  13
      The easiest way to see how this argument works is to integrate out all components of T except the k th . For diﬀerent
(tk , x) values, we can trace out pairs that keep the left side of (16) constant. (Recall that we know this CDF). Applied
sequentially, this produces the components of µ (s, x) up to constants.

                                                              9
                       Pr(T (s, x) < t|ŝ = s, X = x, Z = z) Pr(ŝ = s|X = x, Z = z)
                       = Pr(Q(s, x) < t − µ(s, x), η(1, s) < ϕs,1 (z), . . . , η(S̄, s) < ϕs,S̄ (z))                    (17)
                                                    s = 1, ..., S̄.
We know the left-hand side of these expressions and seek to determine all of the parameters generating
the right-hand side including the joint distribution of the unobservables. We have already established
how to identify the components of µ (s, x) up to intercepts. These can be obtained without assuming any
structure for γ(s), s = 1, . . . , S̄.
    First consider identification of the test system by a limit argument. We assume that the coordinates of
the contrast-in-choices vector are “variation free” or more precisely that they are measurably separated,
so they can be independently varied over their supports:

              Support ([ϕs,1 (Z), ϕs,2 (Z), ..., ϕs,s−1 (Z), ϕs,s+1 (Z), ..., ϕs,S̄ (Z)]) = RS̄−1
              all s = 1, . . . , S̄, where the components are measurably separated with respect                       (A-3)
              to each other (“variation free”).14

This assumption says that the support of the diﬀerence in the deterministic portions of the contrasts in
utility functions matches the support of the corresponding error terms and that we can independently
manipulate each argument holding the other arguments fixed. 15 As a consequence of (A-3) and our
choice of functional forms for ϕs (Z) , there exist limit sets Zs for each s = 1, . . . , S̄ such that as Z →
Zs, Pr(ŝ = s|Z = z) → 1 for s = 1, ..., S̄. These limit sets can be constructed by making coordinates of
Z arbitrarily large or small. In these limit sets, we can identify

                                               Pr(Q(s, x) < t − µ(s, x)),                                               (18)

for each s = 1, ..., S̄. Coordinate by coordinate, we can identify the intercepts of µ(s, x) since the mean
of each coordinate of Q(s, x) exists and is known.16 For each coordinate, we may form tk − µk (s, x), k =
1, ..., K, for each fixed s, x. From (18), in each limit set we may identify the joint distribution of Q(s, x)
from the variation in the tk which traces out the cumulative distribution function of Q(s, x), s = 1, ..., S̄.17
     Turning to identification of the choice system, consider choice system s with S̄ − 1 contrasts

                                        V (s) − V ( ) ,           = 1, . . . , S̄; 6= s.

    Define the set of variables that appear with nonzero coeﬃcients in the s and utility systems by index
sets on the Z and the associated γ coeﬃcients:
                                            ©                              ª
                                    Lc,s, = j|γ j (s) 6= 0 and γ j ( ) 6= 0
  14
     See Florens, Mouchart and Rolin (1990) for a precise definition of measureable separability.
  15
     The supports of both can be bounded by straightforward modifications of the initial assumptions. Then we require that
the supports match.
  16
     We can alternatively use a median zero assumption.
  17
     Use of these limit sets raises the possibility that identification is achieved only on null sets. Using a version of the
argument presented in Aakvik, Heckman and Vytlacil (1999) adapted to this context shows that this possibility is not
revelant.

                                                             10
where γ j (k) is the j th coordinate of the k th system of utility coeﬃcients associated with the j th component
of Z. The variables that are common to all (s, ) pairs, = 1, . . . , S̄, 6= s, are associated with the
subscripts in
                                                          \S̄
                                                   Lc,s = Lc,s, .
                                                                        =1
                                                                        6=s


Define the set of unique variables (relative to s, ) as those with nonzero coeﬃcients in s or but not both:
                                     ©                                        ª
                            Lu,s, = j|γ j (s) = 0 or γ j ( ) = 0 but not both .

These coeﬃcients are unique within the (s, ) pair (in s or , but not both). Many intermediate cases may
arise where variables are common between s and but not between s and 0 , for various and 0 values
( , 0 6= s).
    Consider the binary choice between s and . Suppose that (A-3) is satisfied. In particular suppose that
for all choices 0 (s, 6= 0 ) apart from s and there are variables with zero coeﬃcients in γ (s) and γ ( )
with nonzero coeﬃcients in γ ( 0 ) that have full support in R. This produces (A-3) given our assumed
functional form for utility. The following explicit exclusion condition produces identification:

         There are nonempty sets of indices
         Bs, , 0 , 00 = {j | j > 1, j ∈           / Lu,s, , j ∈ (Lc, 0 , 00 ∪ Lu, 0 , 00 )} for all 0 , 00 6= s, .
                                      / Lc,s, , j ∈                                                                       (A-3’)
         Thus for some γ j ( 0 ) , γ j ( 00 ) , and j > 1, with zero coeﬃcients in s and , the support
         of the associated Zj is R, for all 0 , 00 = 1, . . . , S̄, 0 , 00 6= s, .


       Setting these variables to limit values, we obtain a limit binary choice model
                                                                 Ã                   !
                                                                   (γ (s) − γ ( )) Z
                                Pr (V (s) > V ( ) |Z) = Feη(s, )                 1
                                                                       (σ (s, )) 2
                                                                       η(s, )
where σ (s, ) = V ar (η (s) − η ( )) and e
                                         η (s, ) =                              1   . By an argument due to Manski (1988), if we
                                                                   (σ(s, )) 2
assume that
                                                   Z ∈ RJ is of full rank,18                                               (A-4)
we can identify
                                                  γ j (s) − γ j ( )
                                                                   1                j ∈ Lc,s,
                                                       (σ (s, )) 2
and either
                                             γ j (s)              γj ( )
                                                       1   or                 1     ,    j ∈ Lu,s, ,
                                          (σ (s, ))    2        (σ (s, )) 2
for variables excluded from s or (but not both). By virtue of (A-3), we can identify the marginal
distribution of η (s, ) = η (s) − η ( ) up to scale. The mean of this distribution is assumed to be zero.
  18
     Clearly this is a suﬃcient condition. We only need to have the components of Z with nonzero coeﬃcients possessing
full rank, i.e., the components of {j | j ∈ (Lc,s, ∪ Lu,s, )} .

                                                                       11
This allows us to identify the intercept of the s, contrast. In addition, we can identify the marginal
distribution of η (s) − η ( ) up to scale, Feη(s, ) , s = 1, . . . , S̄, = 1, . . . , S̄, 6= s.
    We can repeat this argument for each utility contrast (s with 0 6= ), and identify either contrasts in
parameters (for those common across all utility contrasts) or unique parameters. Using parameters that
are unique across the Lu,s, sets for various s values we can identify ratios of variances from ratios of utility
contrasts. For example, suppose that γ j (s) = 0 while at the same time for various values, γ j ( ) 6= 0.
At the same time suppose γ j (s0 ) = 0 but γ j ( ) 6= 0 then we can identify
                                                    γj ( )
                                                                    ·           ¸ 12
                                                  σ(s, ) 2
                                                           1
                                                                   σ (s0 , )
                                                   γj ( )
                                                                 =                     .
                                                            1
                                                                   σ (s, )
                                                  σ(s0 ,   )2

We can repeat this argument for all s = 1, . . . , S̄; = 1, . . . , S̄ to identify diﬀerent combinations of
parameters. Depending on the various configurations of Lu,s, , Lc,s0 , , s 6= s0 , = 1, . . . , S̄, 6= s or s0
respectively, we can identify diﬀerent ratios of variances.
   Exclusions of the type just utilized are not strictly required to identify the model. As noted by Cameron
and Heckman (1998) and extended by Aakvik, Heckman and Vytlacil (1999), the choice model can be
identified with no exclusions if the contrast vectors are linearly independent:
                [γ (s) − γ ( )]S̄s, =1, 6=s is of full rank, and the number of continuous Zvariables         (A-5)
                with support in Ris S̄ − 1or greater.
   Assumption (A-5) constitutes an alternative to identification by exclusion. The essential idea in this
argument is that we can fix each contrast and vary the others (oﬀ to limit values), achieving a limit
binary choice model. In this case (under A-4), we can obtain identification of the marginals Feη(s, ) ,
s = 1, . . . , S̄; = 1, . . . , S̄, 6= s and the normalized contrasts
                              γ (s) − γ ( )
                                        1     ,                = 1, . . . , S̄, 6= s, s = 1, . . . , S̄.
                                σ (s, ) 2
However in this case, without exclusions, we cannot identify the ratios of variances obtained with exclu-
sions. For details of this argument see Cameron and Heckman (1998) and Aakvik, Heckman and Vytlacil
(1999).
    From exclusion restrictions or rank conditions on the coeﬃcients of contrast vectors in utilities, we can
obtain identification of the choice system and the utility contrasts up to scale. We state a more general
                                                                                             ¡                 ¢
result for the joint choice-test score system. We can identify the full joint distribution of Q (s, x) , η (s)
under the following assumption:


             Support ([ϕs,1 (Z), ϕs,2 (Z), ..., ϕs,s−1 (Z), ϕs,s+1 (Z), ..., ϕs,S̄ (Z), µ(s, x)]) = RS̄−1+K ,
             s = 1, . . . , S̄, an assumption that the components are measurably separated                    (A-6)
             (“variation free”) with respect to each other.
                                                                                         ¡           ¢
This is an assumption guarantees that we can vary the coordinates of the ϕs,s0 (z) , µ freely. We can
obtain the ϕs,s0 (z) (up to scale) using either exclusions or rank conditions. Exploiting this assumption,
we obtain the following theorem.

                                                                    12
                                                                                                                     1
Theorem 1. Under assumptions (A-1)-(A-4) and (A-6), µ(s, x), γ(s) − γ( ) (up to scale [σ(s, )] 2 ), s =
1, ...S̄, = 1, ..., S̄ and the joint distributions of (Q(s, x), η (s) ) (the second coordinate up to scale) s = 1, ...S̄
are identified.
                                                                                              γ(s)−γ( )
       Proof. We have already established identification of µk (s, x), k = 1, ..., K,                  1    and the marginal
                                                                                               [σ(s, )] 2
distribution of η(s, s0 ) up to scale and joint distributions of Q(s, x). Under (A-6), we can vary each
component of ϕs,s0 (z) and µ (s, x) for each s0 = 1, ..S̄, s 6= s0 , holding the other components fixed. For all
possible values of upper limits, we can trace out the joint distribution of (Q(s, x), η (s) ) nonparametrically.
We can do this for all s.¥                                                                             h     i1
                                                                                                     σ(s, )                 2
    With exclusion restrictions we can improve on Theorem 1 by identifying ratios of the scale σ(s      0, )
                    0                                                 0
for some and s, s as previously discussed.Note that either (A-3) or (A-5) can be used to implement
(A-3) but (A-3) is the key condition.
    This proof can be adapted to the case where T are indicator functions of latent variables using the
argument in Carneiro, Hansen and Heckman (2003). Thus we can nonparametrically identify the distribu-
tion of the unobservables generating choices and test scores. In addition we can nonparametrically identify
the µ (x) and the contrasts in utilities up to scale. We next turn to a factor analysis of the distributions
of unobservables.


4.1       Factor Models
In this paper we assume that the error term in the utilities has a one-factor specification,19

                                       η (s) = α(s)f + u(s),          s = 1, . . . , S̄.                                 (19)

Define the 1 × S̄ vector u as
                                                     ¡             ¡ ¢¢
                                                  u = u (1) , .., u S̄
where the u (s) are mutually independent. We now assume K ≥ 2 test scores at each schooling level with
a factor structure Qk (s, x) = λk (s)f + εk (s), k = 1, . . . K , so test scores can be written as

                                   Tk (s) = µk (s) + λk (s)f + εk (s) k = 1, . . . K.                                    (20)

The µk (s) may be functions of X. For the rest of this section, we keep dependence on X implicit for the
sake of notational simplicity. Array these K tests into a vector equation system for each schooling level
s:
                                T (s) = µ(s) + λ(s)f + ε(s), s = 1, . . . , S̄                       (21)
where T (s) = (T1 (s), ..., TK (s)) , µ(s) = (µ1 (s), ..., µK (s)), λ(s) = (λ1 (s), ..., λK (s)) , and ε(s) = (ε1 (s), ..., εK (s)) .
We assume that the components of ε(s) are mutually independent within and across each s and are inde-
pendent of f.
  19
   Heckman (1981) and McFadden (1984) use factor structure error terms for discrete choice models. We extend their
models to accomodate both discrete and continuous random variables.



                                                             13
       We assume for the factor structure model

               Independence for the full model: (X, Z)⊥⊥ (f, u, ε(s)) ; f ⊥
                                                                          ⊥u⊥⊥ε (s) , s = 1, . . . , S̄.                   (A-7)


                     Error terms u(s)for the choice model are mutually independent and have                                (A-8)
                     V ar (u (s)) = σ 2 (s) , s = 1, . . . , S̄.

Some normalizations are needed for identification of the choice model. One possible normalization is
σ 2 (s) = 1. Other normalizations are possible and are developed below.
     The input for the factor analysis is the joint distribution of the unobservables produced from Theorem
1. Since we can only identify contrasts in latent utility levels, there are S̄ systems with K tests each and
S̄ − 1 utility-normalized contrasts.
     The utility contrasts and the test scores form S̄ systems of K + S̄ − 1 random variables to which
standard factor analysis (e.g. Anderson and Rubin, 1956) can be applied. Initially we assume no exclusion
restrictions so that ratios of variance of η (s)−η ( ) and of η (s0 )−η ( ) are not known, (s 6= s0 ). We develop
the case of exclusion restrictions at the end of this section. Under these definitions and normalizations,
we obtain from (19) and (20) the following system of covariances for each system s = 1, . . . , S̄
                                                                                          2
                          σ (s, s0 ) = V ar (η (s, s0 )) = (α (s) − α (s0 )) σ 2f + σ 2 (s) + σ 2 (s0 )                     (22)

                                     Cov(η(s,s0 ),η(s,s00 ))       (α(s)−α(s0 ))(α(s)−α(s00 ))σ 2f +σ2 (s)
                                               1           1   =                      1          1
                                      σ(s,s0 ) 2 σ(s,s00 ) 2                 σ(s,s0 ) 2 σ(s,s00 ) 2                         (23)
                                                                                    0 00
                                                       s = 1, . . . , S̄, s 6= s , s .
       Recalling that Qk (s, x) = λk (s)f + εk (s), we obtain
                                              Cov(Qk (s),η(s,s0 ))        λk (s)(α(s)−α(s0 ))σ2f
                                                              1       =                    1
                                                     σ(s,s0 ) 2                   σ(s,s0 ) 2                                (24)
                                            s0 = 1, . . . , S̄, s0 6= s,        k = 1, . . . , K

                                     Cov(Qk (s), Qk0 (s)) = λk (s)λk0 (s)σ 2f                         k 6= k0 .             (25)
The left hand sides of (23), (24) and (25) are known as a consequence of Theorem 1. If we make one
normalization, e.g. λ1 (1) = 1, and if the conditions of Theorem 1 apply we can identify all of the contrasts
α(s)−α(s0 ) 0                  0
       1 , s = 1, . . . , S̄, s 6= s, s = 1, . . . , S̄, and the factor loadings λk (s) , s = 1, . . . , S̄, k = 1, . . . , K, and
     0
 σ(s,s ) 2
σ 2f , provided  that K ≥ 2 and K + S̄ − 1 ≥ 3.
       To see this, suppose s = 1. From the system (24) with s = 1, we may form the ratios
                                      Cov(Qk (1), η(1, s0 ))
                                                             = λk (1) k = 1, . . . , K.
                                      Cov(Q1 (1), η(1, s0 ))
From (25), for s = 1 we can obtain σ 2f since we know λk (1) and λk0 (1), for all k, k 0 = 1, . . . , K assuming
                                                                           0)
one normalization. From (24), given λk (1) and σ 2f we can obtain α(s)−α(s
                                                                        0
                                                                               0
                                                                          1 , s = 1, . . . , S̄. In this analysis
                                                                                                  σ(s,s ) 2
we assume that λk (s) 6= 0, k = 1, . . . , K, s = 1, . . . , S̄.20
  20
    If this is not so then the eﬀective dimension of the test system is reduced to the number of tests with nonzero factor
loadings. A comparable analysis applies to the utility system.

                                                                       14
   Turning to the system s = 2, armed with σ 2f , we can identify all factor loadings λk (2), k = 1, . . . , K,
from (24) for s = 2, using our knowledge of α(1)−α(2)       2                          0
                                                  1 , and σ f . From (23), for s = 2, s 6= 1, we can identify
                                                                      σ(1,2) 2
α(s)−α(s0 )     0
          1   , s = 3, ..., K. By the same line of reasoning, we can identify all of the λk (s), k = 1, ..., K, s =
 σ(s,s0 ) 2
1, ..., S̄.
     Using (23), we can identify

                             σ 2 (s)                 Cov (η (s, s0 ) , η (s, s00 ))          (α (s) − α (s0 )) (α (s) − α (s00 )) σ 2f
                               1            1    =                1                  1   −                         1            1        (26)
                    σ (s, s0 ) 2 σ (s, s00 ) 2         σ (s, s0 ) 2 σ (s, s00 ) 2                       σ (s, s0 ) 2 σ (s, s00 ) 2
since we know all of the right hand side terms either from data or the preceding argument. If we normalize
σ (s, s0 ) = 1 and σ (s, s00 ) = 1 for all s, s0 , we identify σ 2 (s) , s = 1, ..., S̄.21 If we normalize σ 2 (s) = 12 , then
                                                                                              2
                                                       σ (s, s0 ) = (α (s) − α (s0 )) σ 2f + 1.

We have identified (by the previous argument)
                                                           (α (s) − α (s0 )) σ f
                                                                                 1       = τ (s, s0 )
                                                                [σ (s, s0 )]     2



where
                                                                       |τ (s, s0 )| < 1.
Thus this normalization is equivalent to the normalization
                                                                                  1
                                                          σ (s, s0 ) =                       > 1.
                                                                           1 − [τ (s, s0 )]2
    When S̄ + K − 1 < 3, the argument breaks down. Since S̄ = 2 is the minimum number of choices for
the system to be interesting, the breakdown comes with one test and two choices.22 In this case, the only
information is in (24) which is
                                                                 λ1 (1)(α(1) − α(2))σ 2f
                                                                                         1
                                                                        [σ (1, 2)] 2
                                                                 λ1 (2)(α(2) − α(1))σ 2f
                                                                                         1         .
                                                                            [σ (1, 2)] 2
Even normalizing λ1 (1) = 1, we can only identify λ1 (2) and the combination of parameters (α(1)−α(2))σ 2f
up to an unknown scale. Additional normalizations must be made to identify these components separately.
   From the joint distribution of (17) we can identify the distribution of f and the distributions of the
uniqueness (ε1 (s), ..., εK (s), and u(s), s = 1, ..., S̄). To see why, recall that from Kotlarski’s Theorem (1967)
that if

                                                                      X1 = Y + Z1
                                                                      X2 = Y + Z2
  21
       Obviously the choice of these particular normalizations is arbitrary.
  22
       In that case we lose the information in (23) and (25).

                                                                                 15
where Y ⊥⊥Z1 ⊥ ⊥Z2 , from the joint distribution of (X1 , X2 ) we can identify the distributions of Y, Z1 , Z2
under a mean zero assumption for Z1 and Z2 (E(Z1 ) = 0; E(Z2 ) = 0) or for Y (E(Y ) = 0).From the
analysis of Theorem 1 we know the joint distribution of T (s), s = 1, ..., S̄, k = 1, ..., K. Using (20) and
invoking the normalizations previously discussed in the text following equation (26), we can write for
λk (s) 6= 0,
                         Tk (s) − µk (s)        εk (s)
                                         =f+           k = 1, ..., K, s = 1, . . . , S̄.
                              λk (s)           λk (s)
The expression on the left is known since λk (s), µk (s), s = 1, ..., S̄, k = 1, ..., K, are identified by the
previous argument. Applying Kotlarski’s theorem we can identify the distribution of f nonparametrically
and the distributions of λεkk(s)
                               (s)
                                   , k = 1, ..., K, s = 1, ..., S̄, and hence the distributions of εk (s), k = 1, ..., K, s =
1, ..., S̄.
     From the joint distributions of
                                       Ã                    !
                             0                            0
                     η (s, s )           α (s) − α (s )             u (s) − u (s0 )
                                 1 =                    1     f+                  1 s0 = 1, ..., S̄, s0 6= s
                   (σ (s, s0 )) 2          (σ (s, s0 )) 2            (σ (s, s0 )) 2
we obtain a two-factor model with the distribution of the first factor (f ) known from the preceding analysis
(as well as its factor loading). u (s) is a second factor that is common across all outcomes based on s-
contrasts and its factor loading is known by the normalizations previously presented. u (s0 ) is independent
of u (s) and u (s00 ) , s00 6= s, s0 and f by assumption. Using deconvolution we can remove f from the
                                    0
marginal distributions of η(s,s0 ) 1 and apply Kotlarski’s theorem to identify the joint distribution of u (s)
                                    (σ(s,s )) 2
            0    0              0         23
and u (s ) , s = 1, ..., S̄, s 6= s. The model is strongly overidentified when going across s systems.
    Thus far we have not exploited the information available through exclusion restrictions. Suppose that
there is at least one variable in V (s) that does not appear in V (s0 ) , s, s0 = 1, . . . , S̄, s0 6= s, with full
support (R). Then we can identify σ (s, ) , s 6= l, s = 1, . . . , S̄, = 1, . . . , S̄ up to a common scale. Thus
we can identify the α (s) − α (s0 ) up to a common scale for all s, s0 . With this information in hand, fewer
normalizations have to be imposed. Thus we can relax one of the normalizations given under equation
(20). If the exclusions are only partial, we identify various σ (s, ) up to diﬀerent common scales depending
on the particular exclusions employed. We do not develop this topic further in this paper.
    Recall that we have defined “S” in a general way. It can consist of diﬀerent combinations of years of
schooling completed (S) and age at entry date (N) and other states. Thus we can work with an indicator
variable D (S, N, ...) that defines schooling states for all S, N, ... combinations as discussed in Section 3.
This is the model that we estimate.
  23                                                                                                                                    η(s,s0 )
       Since we know the distribution of f from the analysis of the test score data, we can write the density of                                   1   which
                                                                                                                                      (σ(s,s0 )) 2
is known by virtue of Theorem 1 as
                                Ã                             !          Ã                        !          Ã                    !
                                             η (s, s0 )                      α(s) − α(s0 )                       u(s) − u(s0 )
                                    gη                    1       = gf                   1    f       ∗ gu                   1
                                           (σ (s, s0 )) 2                    (σ (s, s0 )) 2                      (σ (s, s0 )) 2
where * denotes convolution. We know the first term on the right-hand side (including the factor loadings). Thus we can form
                                η (s,s0 )     α(s)−α(s0 )                                                         u(s)−u(s0 ) 0
the characteristic functions of      0
                                          1 ,
                                                   0
                                                      1 f and using the inversion theorem identify the density of
                                                                                                                       0
                                                                                                                          1 ,s =
                                     (σ(s,s )) 2   (σ(s,s )) 2                                                                         (σ(s,s )) 2
1, ..., S̄, s0 6= s. For each s system, u(s) constitutes a separate factor apart from f .

                                                                                 16
4.2       Allowing for Tests Taken During Schooling and Age Eﬀects
The preceding framework is for the analysis of data on completed schooling (S = ST ). Let ST be schooling
at the test date. From the assumption that persons who drop out do so only once24 , and recalling that
the age at the test date is A, we obtain ST = A − N (from (14)) if the individual is still in school at the
date of the test. Conditioning on N and A, ST is a number, not a random variable.
    Assuming that sampling is random with respect to A, we can write the density of ST as the convolution
of N (which we model) and a random variable A independent of N (and all other variables) whose
distribution we know from the sampling rule. We abstract from any issues of selective survival since the
sample is young.
    The density of ST conditional on X = x and Z = z is

                                                   X
                                                   Ā
                        g (sT | X = x, Z = z) =       gN (a − sT | X = x, Z = z) P (A = a)
                                                   a=A
         £ ¤
where A, Ā is the range of survey ages (14-21 in the NLSY data we analyze) and

                                                                   1
                                               P (A = a) =               .
                                                              Ā − A + 1

   The density of test scores in the preceding section is conditional on ST = S (an event which was
assumed to hold with probability one). Now we postulate that the event ST < S (further schooling after
the test) may occur. Conditional on ST < S, ST is a degenerate random variable given A, N. Thus ST is
exogenous given A, N and ST < S (i.e. ST ⊥  ⊥f | N, A, ST < S).
   We may pool the data on ST for ST < S with the data on ST for ST ≥ S using this insight. Details
about the likelihood for the pooled data are given in Appendix C.


4.3       Accounting for Ceiling Eﬀects
In the NLSY data a substantial number of test score observations “hit the ceiling,” i.e., they achieve the
maximum score on a particular test component. This is documented in Table A-3 (see Appendix A). To
account for these ceiling eﬀects use a latent test score T ∗j so that
                                               
                                               T (s) if T ∗ (s)< c ,
                                                   k          k       k
                                      Tk (s) =
                                               ck            ∗
                                                         if T (s)≥ ck ,
                                                                   k


where ck is the maximum attainable score on test component k. Let the latent test score for an individual
with schooling level s at the test date be

                                          Tk∗ (s) = Xβ k (s) + λk (s)f + εk (s)
 24
      As previously noted this assumption is supported for schooling through high school in Cameron and Heckman (2001).




                                                           17
where X is a set of observed covariates and f is the unobserved factor. Identification with censored random
variables can be established by a straightforward modification of Theorem 1 given suﬃcient support on
X.25


5      Empirical results
We now present findings from estimating the joint schooling and test score model on the NLSY data
discussed in Appendix A. We consider four completed schooling groups: high school dropouts, high
school graduates, individuals with some college, and four-year college graduates. We group GEDs with
high school dropouts.26 We group associate’s degrees (junior college graduates) with some college. In
addition we group respondents into two categories by age at entry into schooling. Let N = 0 if an
individual began schooling at age 6 or earlier; let N = 1 otherwise.27 We estimate a choice model with
4 × 2 = 8 potential outcomes (combinations of completed schooling and age at entry).
    Over two-fifths of the sample (870 individuals, or 42.11% of the sample) had yet to complete high
school as of July-October 1980 when the ASVAB was administered. As a consequence we are able to
break up this group into three subgroups of schooling level at the test date — those with nine years of
schooling or less (205), those with ten years of schooling (322), and those with eleven years of schooling
including some dropouts with more than eleven reported years of schooling (342). We are thus able to
trace out schooling and ability eﬀects for six levels of schooling, including high school graduation and
college attendance. Appendix A describes the features of our sample and the variables used to estimate
the models.


5.1     Control Function Estimates
We first present nonparametric estimates from the control function estimators outlined in Section 3.
Appendix B describes the econometric procedure used to produce the estimates. It is written for the
specific case analyzed in this paper, with six values of ST and four values of S.
   Tables 1 and 2 present estimates for the simple case analyzed at the beginning of Section 3, where
we do not control for age eﬀects or endogeneity of entry into schooling. Table 1 reports estimates of
the factor loadings λ(sT ). Since the model is overidentified we can compute estimates of λ(sT ) using
  25
     A prototype for this proof is in Carneiro, Hansen and Heckman (2003), who show how to identify a related model under
the case that analysts only observe 1 (Tk∗ (s) < ck ) or 1 (Tk∗ (s) ≥ ck ) . Extension to the censored case is straightforward and
for the sake of brevity is omitted here.
  26
     The GED is an exam certification for high school equivalency for those who do not earn the degree the traditional route
by finishing high school. Our grouping is based on work by Cameron and Heckman (1993).
  27
     Of the 1,404 individuals in the “normal/ahead” category, (N = 0) 1,087 (77.42%) entered school at age 6 and 317
(22.58%) entered school at an earlier age. Since we model choice of schooling and age at entry jointly, further stratifying into
3 age-at-entry categories would produce a model with 12 possible choices and some cells would be very small. Specification
checks suggest that combining the “normal” and “ahead” groups is fairly innocuous.




                                                               18
information for diﬀerent completed schooling groups.28 In Table 1 both the unrestricted estimates and
estimates obtained by imposing the overidentifying restrictions using a minimum distance approach are
shown.29 The χ2 -statistics do not reject the overidentifying restrictions. Recalling that λ(1) has been
normalized to one, the estimates of the remaining λ(sT )’s indicate a decreasing eﬀect of latent ability on
test scores as schooling at the date of the test increases (the estimates of λ(sT ) are decreasing with sT ).
Table 2 reports the minimum distance estimates of the intercepts and control functions. Again the χ2 -test
fails to reject the overidentifying restrictions implied by the model. Estimated schooling eﬀects (for the
average person, with f = 0) range from 3.61 to 9.02 AFQT points per year of schooling. The estimates
imply an expected test score function which is roughly linear in schooling. As expected, the estimates of
the control functions (which are conditional expectations of the factor f ) are increasing in schooling. The
control functions for the diﬀerent completed schooling categories are clearly statistically diﬀerent from
one another. We identify the scale of f by normalizing λ(1) = 1. Thus, any comparisons are conditional
on this normalization, a feature shared with the structural estimates reported below.
     We can interpret λ(sT ) [E[f |S = s] − E[f |S = s0 ]] as the expected diﬀerence in test scores for two
individuals with the same schooling at the test date, sT , but with diﬀerent levels of completed schooling.
The fact that λ is declining in sT implies that the test score diﬀerence between individuals with diﬀerent
completed schooling levels declines with schooling at the test date. In other words, the test magnifies
diﬀerences in latent ability at low schooling levels and dampens diﬀerences at higher schooling levels.30
     Tables 3 and 4 present nonparametric control function estimates for the case where f depends on the
age of schooling entry, E(f |N = n, ST = sT ), but N does not otherwise enter the model. In this case
we can identify λ(S̄) by diﬀerencing test scores conditioning on fixed ST , S = S̄ and varying N = 0, 1.
Appendix B.1 presents the estimation procedure used to construct these estimates. Knowing λ(S̄) we can
identify µ(S̄). Table 3 reports the loadings estimated using the minimum distance approach. Again we
fail to reject the overidentifying restrictions. In addition, the pattern of declining estimates with schooling
is still present. The loading for college λ(6) is estimated to be zero. This is most likely caused by the
presence of ceiling eﬀects as this pattern is not found to the same extent using the structural model
(see next section). Table 4 presents the estimated intercepts and control functions. There is now less
evidence for the restrictions implied by the model (the p-value for the χ2 -test is 0.01). However, the
estimated test score function (assuming f = 0) is quite similar to the one estimated without entry eﬀects
— especially during the high school years before diverging slightly at the “Some College” level. Estimated
schooling eﬀects therefore remain high, between 2.37 and 8.93 AFQT points per year of schooling. The
control functions now depend on both schooling and entry age. As expected the estimates are increasing in
completed schooling and entry state (individuals who start at an older age have on average lower cognitive
ability). Note, however, that entry state has a much smaller eﬀect for the “Some College” and “College”
category than for the lower schooling categories.
  28
     We obtain six diﬀerent estimates of λ(2) by comparing diﬀerent completed schooling groups following the discussion in
section 3.
  29
     Since we can only identify ratios of the λ(sT ) we have normalized λ(1) to one.
  30
     This could be due to ceiling eﬀects. The structural model estimates reported in the next section takes ceiling eﬀects
into account.


                                                           19
    Table 5 presents estimated intercepts and control functions for a model allowing direct N−eﬀects on
the test score in addition to controlling for potential dependence of f on N. As discussed in Section 3,
estimating a model controlling for both entry age N and age at the test date A requires more structure
in order to break the fundamental identification problem resulting from the confluence of N and A. The
estimated intercepts µ(N, ST ) are uniformly larger for late-starters (who are older when they take the
test) than they are for those who begin their schooling at the normal time.31 Recall, however, that if there
are independent age eﬀects, then the diﬀerence µ(1, ST ) − µ(0, ST ) captures those eﬀects as well as any
discouragement eﬀects. As noted in Section 3 we cannot identify an independent age eﬀect.32 However,
we can reject the joint hypothesis of no A and N eﬀects. The evidence points to a much stronger role
for age (maturation) in influencing test scores than any discouragement eﬀects from being held back as
people who are older at any schooling level have higher test scores.
    In the next section we present estimates from the structural, semi-parametric model discussed in
Section 4. Taking a structural approach to the problem we can estimate a more general model of schooling
  31
    Note that in order to estimate the model we must restrict µ(ST , 0) = µ(ST , 1) for some ST . We report estimates for the
model imposing the restriction for ST = 5.To see why we most impose equality between at least one pair of intercepts, note
that the moment conditions for this case are (letting T̄ denote the conditional mean of T and c (s, n) = E [f |S = s, N = n]):

                                     T̄ (s, sT , n) = µ(sT , n) + λ(sT )c(s, n),        ∀s, sT , n,                         (27)

where c(s, n) ≡ E[f |S = s, N = n]. In the sample, n = 0, 1 and s = 1, 2, 3, 4. This gives us (8 − 1) = 7 control functions
to estimate since the weighted sum of the control functions is zero. Note that given sT and n we have a maximum of four
conditions for determining µ(sT , n):

                                    T̄ (s, sT , n) = µ(sT , n) + λ(sT )c(s, n),       s = 1, . . . , 4.                     (28)

  How much data is needed to identify the control functions? Suppose we consider only one sT value , say sT = 1, and
n = 0, 1. This yields eight moment conditions:

                                      T̄ (s, 1, 0) = µ(1, 0) + λ(1)c(s, 0),        s = 1, . . . , 4,
                                      T̄ (s, 1, 1) = µ(1, 1) + λ(1)c(s, 1),        s = 1, . . . , 4.

   Note that under our previous assumptions we had µ(1, 0) = µ(1, 1) ≡ µ(1). If this restriction holds the model is identified,
since by taking contrasts we can identify the 7 diﬀerences c(s, 0) − c(4, 1) and using the sum restriction on the control
functions we get that all of the c(s, n) are identified and then the single intercept µ(1) is identified. Recall the argument in
Section 3.
   If we allow for separate intercepts, µ(1, 0) 6= µ(1, 1), the model is no longer identified, since we can now only identify the
diﬀerences c(s, 0) − c(4, 0) and c(s, 1) − c(4, 1). Thus, we can only identify six diﬀerences and so we cannot identify the
control function elements. Note that this problem persists no matter how many sT values we use. We can only identify the
six diﬀerences mentioned above. To obtain the required normalization we can restrict µ(sT , n = 0) = µ(sT , n = 1) for one
sT value.
   32
      Given our “no return to school for dropouts” assumption, people who start school one year later are also one year older
at schooling level ST than are people who start school at a normal age if they have not completed their schooling at the test
date (S = ST ). However, in order to estimate the model we must include individuals with completed schooling at the test
date (S = ST ) in order to observe the boundary group S = 1. Conditioning on the entire sample means that varying N is
not equivalent to varying A and, even in the absence of N eﬀects, we cannot identify an independent age eﬀect using this
procedure.


                                                                 20
and test scores allowing for both age eﬀects, endogenous entry into schooling and testing ceiling eﬀects.
We can also condition on covariates such as family background and local labor market variables which
may influence the choice of schooling. However, the estimates from the control function approach are in
broad agreement with estimates from the structural model.


5.2     Estimates From the Structural Model
We now present empirical results from the structural model of schooling and test scores presented in Section
4. We use Bayesian MCMC methods to estimate the sample likelihood for the model of Section 4. Details
of the algorithm are presented in Appendix C. Our use of Bayesian methods is only a computational
convenience. Under our identifying assumptions, the priors we use are asymptotically irrelevant. Our
identification analysis is strictly classical.
    Table 6 reports exclusion and inclusion restrictions for each equation of the structural model. The com-
mon variables in the choice system (included in all but the “college/behind” index) are family background
- urban status, broken home status, number of siblings, southern dummy, mother’s and father’s education,
family income - and birth cohort dummies. Choice-specific variables are: local wage and unemployment
rate for high school dropouts, high school graduates, and those with some college for equations with the
corresponding schooling groups, and tuition and distance to four-year college in the college equations.
Quarter-of-birth dummies are included in the “behind” equations. We invoke identification assumption
(A-5) because we lack exclusions. We adopt linear-in-parameters utility functions.
    We parameterize the latent test score equations as follows:

                           Tk∗ (s) = Xβ k (s) + λk (s)f + εk (s), k = 1, .., K; s = 1, .., S̄T

where X is a set of observed covariates, including age, which we restrict to have a linear eﬀect. Covariates
in the test score equations include family background variables, age (as of December 31, 1980), and
a dummy variable for in-school status at the test date. We estimate twenty-four test equations: four
equations for each AFQT component (Word Knowledge, Paragraph Comprehension, Arithmetic Reasoning
and Mathematics Knowledge) for each of six levels of schooling at the test date.33
   The computational algorithm used to estimate the model parameters is discussed in detail in Appendix
C. Due to space constraints detailed parameter estimates of the models are posted at
http://home.uchicago.edu/~kjmullen/Schooling_JOE.htm.

5.2.1    Model Fit

We first discuss the fit of the estimated model to the data. Tables 7 and 8 describe the fit of the model to
the data for the schooling choice and test systems, respectively. The fit reported in Table 7 is quite good
both overall and in partitions of the data on selected covariates. Figures 1(a)-(f) plot the fitted AFQT
  33
     In addition to the covariates above we included a dummy variable in the test score equations for having completed
strictly less than 9 years of school to allow for possible heterogeneity in the grade school and ninth grade composite group;
the coeﬃcient on this dummy was insignificant for all tests.


                                                             21
test score distribution against the actual empirical CDF for each schooling group. We pass χ2 goodness of
fit tests at conventional levels of significance for most groups though the figures reveal a slight tendency
to underpredict scores for the lowest schooling category and to overpredict test scores for the highest two
schooling groups. The goodness of fit statistics are reported in Table 8. The fit is worst for the most
heterogeneous groups, “ninth grade or less” and “some college.” In fact, the poor fit in the “some college”
category causes us to fail the overall test of fit.34 Excluding that group we would pass the overall test.

5.2.2   Estimated Cognitive Ability Distribution

Figure 2 displays the estimated latent ability or factor distribution plotted against “residualized AFQT”
(constructed by running an ordinary least squares regression of standardized AFQT score on family
background and cohort dummies). Recall that the location and scale of the latent ability distribution
must be set since they are not identified in the model. This is a standard result in factor analysis.
Recall that we set the location by constraining the unconditional mean of the factor to be zero (note the
residualized AFQT distribution also has mean zero by construction). The scale is set by a normalization
in one of the test score equations. Specifically, we set to 1 the coeﬃcient on the factor in the equation
for the Word Knowledge test component (standardized to have within-sample mean 0 and variance 1)
estimated for individuals who had completed eleven years of schooling at the test date.35
    The estimated factor density is not normal and closely tracks but does not completely resemble the
conventional residualized AFQT density. Residualized AFQT computed by OLS (not accounting for
schooling or selection eﬀects) is an imperfect measure of cognitive ability. While the mean of the factor is
fixed to 0, the estimated median, 0.1158, is positive, so that more than half of the population has above
average ability. However the estimated range of the factor distribution is skewed negative: a person who
is at the 2.5th percentile in ability is more than half a standard deviation further away from the average
(at −1.4846) than a person at the 97.5th percentile (with ability 1.1131).

5.2.3   Allowing for Age and Endogenous Entry Dates

By using the sample S = ST , we break the dependence between A and N given by (14). We parameterize
age eﬀects on test scores by assuming

                                           λ(A, S) = λ(S)36
                                           µ(A, S) = β 1 (S) A + β 2 (S)

where β 1 (S) and β 2 (S) are unrestricted functions of S. In this paper we explicitly model the relationship
between entry date N and latent ability f . The model specifies a joint S × N space. How important is it
to account for endogeneity of N ? Figure 3 plots the distributions of latent ability f conditional on entry
status N. Note that individuals who are behind their peers on average have lower latent ability than their
 34
    The P value for the overall fit of the model excluding some college is 0.1050.
 35
    The estimated standard deviation of the factor is 0.7027.
 36
    Attempts to estimate age-dependent λ led to very imprecise estimates.



                                                            22
counterparts who are age-grade normal or ahead, especially those who do not attend any college. Failing
to correct for endogenous entry eﬀects would lead us to underestimate the eﬀect of cognitive ability on
dropping out versus graduating high school, especially at lower levels.37
    Figure 4 plots the estimated age at test eﬀects for each N ∈ N = {0, 1} group. The estimated
maturation eﬀects are roughly constant across ages. As in the control function estimates, the net eﬀect
of age at the test on measured test scores is positive.

5.2.4    Schooling Behavior

The structural approach models the schooling decision explicitly. Thus we can estimate the relationship
between cognitive ability f and schooling choice. Correcting for endogenous schooling eﬀects on AFQT
turns out to have some interesting implications for inference about the eﬀects of ability on schooling
choice. Figure 5 (a)-(b) plots schooling choice probabilities as a function of observed ability for a simple
multinomial choice model that conditions on residualized AFQT (i.e., observed minus predicted AFQT,
where predicted AFQT is formed by regressing standardized raw AFQT score on family background
characteristics and cohort dummies, not correcting for schooling eﬀects), stratified by entry age. This
                                                                               P
model assumes that residualized AFQT is a perfect proxy for latent ability so K  k=1 Tk (s)−Xβ = α1 +α2 f
where α1 , α2 are constants. In this conventional specification, measured ability is a strong predictor of
schooling decisions, especially high school dropout and college-going decisions. For those who are age-
grade normal or ahead of their age-peers in their schooling, the probability of dropping out conditional
on a low residualized AFQT score (e.g., a score of -1.8 at the 2.5th percentile) is about 31.9% compared
to the population rate of 10.7%. For individuals who are behind their peers the diﬀerence is even more
pronounced: the predicted probability of dropping out conditional on a score at the 2.5th percentile is
57.7%, compared with population a rate 27.2%. At the upper end of the AFQT distribution, the estimated
probabilities of graduating college with an AFQT score of 1.46 at the 97.5th percentile are 71.2% and
67.5% for the “normal/ahead” and “behind” groups, respectively. The corresponding population rates are
33.9% and 21.6%, respectively.
    Figures 6 (a)-(b) plot estimates from the model of Section 4. For small values of the factor f (i.e., at
the 2.5th percentile corresponding to the estimated factor distribution) the probabilities of dropping out
of high school (21.2% and 42.8%) are almost 11 and 15 percentage points smaller than the comparable
probabilities estimated by the simple model above. Larger factor values imply college probabilities of
65.8% and 56.9% which are just over 10 percentage points lower than those estimates produced by the
model using residualized AFQT.
    Aside from measurement error bias, there is a fundamental econometric problem associated with
estimating a schooling choice model which conditions on a measure of ability which has been constructed
without accounting for reverse causation (i.e., that schooling aﬀects measured ability). Ignoring the
  37
    Note that in the structural model we do not allow for direct N -eﬀects on test scores, which would increase the dimension
of the test score system to 2 × 4 × 6 = 48 equations. We do, however, allow for linear age eﬀects in the means (these are
graphed in Figure 4). The evidence from the control function approach outlined in Section 5.1 supports the idea that age
eﬀects are more important than “late starter” eﬀects.



                                                             23
simultaneity problem leads to substantial overstatement of the role of cognitive ability in explaining
schooling decisions.
    Figures 7 and 8 demonstrate the importance of this point. Figure 7 (a)-(b) plots the estimated
residualized AFQT densities conditional on completed schooling, stratified by entry status. The estimated
densities are standardized so that the unconditional density has variance 1 to facilitate comparison with
the structural model estimates. A key feature to note is the degree of separation in the conditional
“ability” distributions. Failing to correct for schooling eﬀects on measured ability leads one to predict
a strong causal relationship between schooling choice and cognitive ability. Figures 8 (a)-(b) show the
estimated factor distributions (again, standardized) estimated from our corrected model conditional on
completed schooling and entry date. In the corrected model, the cognitive ability distributions are much
less stratified.
    Taken together, these findings suggest that the previous literature has overstated the role of latent
cognitive ability on explaining schooling. This leaves more room for non-cognitive factors. (See the
evidence on the importance of noncognitive factors in Heckman and Rubinstein, 2001)

5.2.5    Eﬀect of Ability on AFQT

An important feature of the structural approach developed in this paper which distinguishes it from
conventional models of determinants of achievement test scores is that we can estimate the eﬀects of
latent ability on manifest test scores in addition to causal schooling eﬀects on test scores. The usual
approach treats unobserved ability as a nuisance variable that biases the parameter of interest, the eﬀect
of schooling on measured ability, and focuses on ways to eliminate its influence. We model latent ability
and its influence on schooling explicitly, allowing us to investigate the relationship between latent ability
and measured ability.
    Figures 9(a)-(d) show the marginal eﬀect of a standard deviation increase in latent ability on each of
the four AFQT test components for diﬀerent schooling levels at the test date.38 In several cases the gap
in the expected test score between two persons one standard deviation apart in intelligence (unless one of
them is at or near the maximum score) is quite large, up to 20% of the total number of points possible
on the test. Schooling aﬀects verbal and mathematical skills diﬀerently. Moreover, we can see that while
the marginal eﬀects of ability decrease with additional schooling for the two verbal test components, the
marginal eﬀects of ability on the mathematics components are roughly constant or slightly increasing over
schooling levels.
    Figure 10 shows that the marginal eﬀect of a standard deviation increase in cognitive ability, aggregated
over the four test components, ranges from 12.5 to 17.8 AFQT points, or about 12 to 17% of the maximum
possible score of 105. The eﬀect increases initially from ninth to tenth grade where it reaches its peak
  38
    In Figure 9(a) the collapse of the confidence bands at 11 years of schooling is due to a normalization, i.e., setting
λ(ST = 3) = 1 in an equation where standardized Word Knowledge (WK) is the dependent variable. Multiplying λ by the
standard deviation of the original WK test (7.0327) converts the eﬀect into test score points. Multiplying further by the
standard devation of the latent factor (0.7027) gives the eﬀect in points on the WK test of increasing the latent ability by
one standard deviation.



                                                            24
and appears to fall thereafter. In a formal test we cannot reject the hypothesis that the marginal eﬀect
of latent ability on AFQT score is the same across all schooling levels at the 5% significance level. Recall
that this is the implicit assumption used by Winship and Korenman (1997), Herrnstein and Murray (1994)
and Neal and Johnson (1996).

5.2.6    Eﬀect of Schooling on AFQT

In Figure 11 we switch perspectives and show the eﬀect of schooling on test scores for fixed levels of latent
ability. This figure demonstrates strong eﬀects of schooling on test scores. From grade school to college
a given individual can expect to improve his performance on the AFQT by about 18 to 31 points (16 to
29.5 percentage points), depending on his initial ability level. Figure 11 shows that the largest schooling
eﬀects are found for individuals with very low ability levels. However even with more than 15 years of
schooling the test scores of the individuals at the 2.5th percentile do not quite reach the average test score
that persons at the median achieve with just a ninth education.
    Individuals at the very top of the ability distribution (the 97.5th percentile) are within roughly five
points of the test score ceiling by 11 years of schooling. The estimated AFQT test score functions are
roughly parallel across ability levels. In fact the gap in AFQT scores between the 25th and 75th percentiles
closes only four points (after widening slightly at first) between ninth grade and the college years. The
functions are roughly linear.
    Figure 11 shows that the eﬀects of schooling on AFQT are highest during the early high school years
for all ability levels, between grades 9 and 11, between 3.5 and 6.6 points on average per year, varying
by ability level. After ninth grade schooling eﬀects decrease with latent ability. The average estimated
annual schooling eﬀect, varying across ability levels, is between 3.4 and 4.1 AFQT points (or 3.2 to 3.9
percentage points). Figure 12 plots estimated schooling eﬀects with 95% confidence bands for the average
person (with f = 0), which vary from 1.2 points (transiting from 11th to 12th grade) to 5.4 points (from
9th to 10th grade), with an average schooling eﬀect of 3.7 AFQT points (3.5 percentage points). In other
words, a one year increase in schooling is associated on average (across schooling levels) with a 0.16-0.19
standard deviation increase in the AFQT score across ability levels; the estimated increase in AFQT score
per year of education for the average person (f = 0) is 0.17 standard deviation.


5.3     Comparison of Control Function and Structural Model Results
Figures 13 and 14 summarize our estimates obtained from using both nonparametric and structural
approaches. Figure 13 plots the estimated ratios of the factor loadings λ(sT )/λ(1).39 Note that the
general pattern of declining ability eﬀects is consistent across all models although it is more pronounced
for the nonparametric estimates.
    Figure 14 plots estimated intercepts µ(sT ) for all models.40 Again the models are in agreement espe-
cially for the high school years. The control function estimates (which do not control for other determinants
  39
    The structural model estimates of the factor loadings of the four AFQT components are converted into estimated
marginal eﬀects for overall AFQT score, as in Figure 9.
 40
    Recall that the structural model controls for covariate eﬀects. The appropriate comparison to the control function

                                                         25
of test scores) tend to be steeper than the structural model estimates which control for family background
variables. The control function estimates range from 2.37 to 9.02 AFQT points while the structural esti-
mates vary less and tend to be smaller, ranging from 2.79 to 4.2 points on average. Overall, the agreement
is close.


6     Summary, Conclusions and Applications to the Returns to
      Schooling
This paper develops two methods for estimating the eﬀect of schooling on measured test scores when both
schooling and measured test scores depend on latent ability. The methods are applied to NLSY data, and
produce estimates that are in general agreement with each other.
    We find that schooling increases the AFQT score on average between 2.79 and 4.2 points per additional
year of education. The eﬀect of schooling on test scores is constant across schooling levels. Our estimates
are roughly twice as large as the estimates reported in Herrnstein and Murray (1994). They are in line with
the estimates reported in the literature reviewed by Winship and Korenman (1997) who report schooling
eﬀects on the order of 2 to 4 IQ points, or 2.9 to 5.7 AFQT points. Our analysis shows that schooling
has small equalizing eﬀects on measured test scores especially for those with low ability and low levels of
schooling. Our analysis also demonstrates that the estimated eﬀect of latent cognitive ability on attending
school has been overstated in the previous literature that does not correct for reverse causality between
schooling and test scores.
    Our analysis also has important implications for the empirical literature on the eﬀects of ability and/or
tests on wages. Suppose that
                                      ln W = α0 + α1 s + α2 f + ξ 1 (W ).41                              (29)
 The causal eﬀect of a unit increase in schooling is α1 . A common strategy in the empirical literature on
wage equations is to proxy f by T to avoid ability bias arising from the dependence of f on s. Using (1)
in equation (29) to solve out for f , we obtain

                                                  (T (s) − µ(s) − ε(s))
                         ln W = α0 + α1 s + α2                            + ξ 1 (W )
                                                          λ(s)
                                               α2 µ(s)     α2                        α2
                                 = α0 + α1 s −          +      T (s) + ξ 1 (W ) −       ε(s).
                                                λ(s)      λ(s)                     λ(s)

This is a bad proxy for two reasons: (a) The usual problem that α2 ε(s)/λ(s) is correlated with T (s);
and (b) A novel problem that even if ε(s) = 0, so T (s) is a perfect proxy for f , we acquire additional
s-dependent terms arising from the fact that schooling determines test scores, and the estimated marginal
eﬀect of schooling on earnings is biased for α1 unless µ(s) = µ and λ(s) = λ (that is, unless schooling has
parameter µ(sT ) is therefore the expected AFQT score evaluated at f = 0 and fixing covariates at the mean.
  41
     Recall that the scale of f is set by our normalization of a factor loading in the test score measurement system.




                                                             26
no eﬀect on test scores).42 Thus, we get biased estimates of the causal eﬀect of schooling from the proxy
even if ε (s) ≡ 0.
    Using estimates of the structural model we construct a measure of ability f, fb, correcting for endogenous
schooling at the test date (as well as correcting for family background and age eﬀects).43 Estimates are
reported in both Tables 9 and 10. We find that substituting our schooling-corrected measure of ability
for OLS-residualized AFQT in a regression of log wages on years of schooling, ability, experience and
experience squared increases the estimated coeﬃcient on schooling by over 1.5 percentage points, from an
estimated return of 10.22% to a higher 11.76% in our sample of white males. Previously used measures
of ability include the eﬀect of schooling on ability. Purging the measure of ability for this eﬀect results in
a substantially larger estimated eﬀect of schooling on wages.
    If the true model for wages is instead

                                          ln W = α0 + α1 S + α2 T + ξ 2 (W )                                              (30)

so that the test score directly aﬀects earnings as a signal of productivity (see, e.g., Altonji and Pierret,
2001), the true marginal return to schooling is
                                               ∂ ln W            ∂T
                                                       = α1 + α2                                                          (31)
                                                  ∂s             ∂s
                                                ∂T (s)   ∂µ(s) ∂λ(s)
                                         where         =       +       f.                                                 (32)
                                                  ∂s      ∂s        ∂s
Assuming α2 > 0, an approach that ignores the eﬀect of S on T understates the total eﬀect of schooling
on wages because it ignores its indirect eﬀect through measured ability. Tests of the relative importance
of schooling and signals (T ) on wages ignore the eﬀect of S on T . An estimated increase in AFQT score
of 3 to 4 points per year of additional schooling biases downward estimates of the return to schooling on
wages by 1.28 to 1.71 percentage points. Accordingly, in their analysis Altonji and Pierret overstate the
contribution of signalling to the growth of labor market earnings because they neglect the role of schooling
in producing the signal.
    These results, and the results reported in Section 5, show that it is important to address carefully
the problem of endogenous schooling eﬀects when using measures of cognitive ability. Simply proxying
latent ability with an available test score in a wage equation does not solve the problem of ability bias
when estimating a return to schooling even if measurement error is zero unless the test score is unrelated
to schooling. Similarly, even if the measured test score, as opposed to underlying latent ability, has a
causal eﬀect on wages, ignoring schooling eﬀects will lead one to underestimate the eﬀect of schooling on
wages. To identify the eﬀects of schooling on test scores it is necessary to control for the endogeneity of
schooling decisions. Otherwise, schooling eﬀects on ability are overstated. When we regress the test score
  42
     Take, for example, the simple case where µ(s) = sβ, λ(s) = λ, and ε(s) ≡ 0. Then the estimated coeﬃcient on s is
α1 − β/λ. Including the proxy will lead to downward-biased estimates of α1 if β > 0 (assuming the test is positively related
to latent ability f , i.e. λ > 0).
  43
     Let the symbol b denote a consistent estimate of a model parameter (see Appendix C for the estimation algorithm).
                                                                                          PK λ\
Then for any individual with characteristics x and schooling at the test date sT let fb =        k (sT )              \
                                                                                                       2 (Tk − x(sT )β (sT ))
                                                                                             k=1 σ k (sT )            k
where K is the number of test scores observed.

                                                             27
on schooling, we get an average eﬀect of 5.58 AFQT points per year of schooling (see Table 11). Using
quarter of birth as an instrument, as reported in Table 12, we get a lower eﬀect of 4.51, which is still
larger than the estimate from the structural model, although not far from it. Our approach goes beyond
the standard IV method to explore the impact of schooling interventions on persons at diﬀerent places of
the latent ability distribution.




                                                  28
References
 [1] Aakvik, A., J. Heckman and E. Vytlacil, (1999). “Training Eﬀects on Employment when the Train-
     ing Eﬀects are Heterogeneous: An Application to Norwegian Vocational Rehabilitation Programs,”
     Unpublished manuscript, University of Chicago, 1999.

 [2] Altonji, J. and Pierret, C. (2001). “Employer Learning and Statistical Discrimination,” Quarterly
     Journal of Economics, 116(1): 313-50.

 [3] Anderson, T.W. and H. Rubin (1956). “Statistical Inference in Factor Analysis,” in J. Neyman, ed.,
     Proceedings of Third Berkeley Symposium on Mathematical Statistics and Probability, University of
     California Press, pp. 111-150.

 [4] Ashenfelter, O., and Krueger, A. (1994). “Estimates of the Economic Returns to Schooling from a
     New Sample of Twins,” American Economic Review, 84: 1157-1173.

 [5] Cameron, S. and J. Heckman (1993). “The Nonequivalence of High School Equivalents,” Journal of
     Labor Economics, 11(1): 1-47.

 [6] _____ (1998). “Life Cycle Schooling and Dynamic Selection Bias: Models and Evidence for Five
     Cohorts of American Males,” Journal of Political Economy, 106(2): 262-333.

 [7] _____ (2001). “The Dynamics of Educational Attainment for Black, Hispanic, and White Males”,
     Journal of Political Economy, 109(3): 455-499.

 [8] Carneiro, P., K. Hansen and J. Heckman (2003). “Estimating Distribution of Counterfactuals with an
     Application to the Returns to Schooling and Measurement of the Eﬀect of Uncertainty on Schooling
     Choice,” Forthcoming, International Economic Review.

 [9] Ceci, S. J. (1991). “How Much Does Schooling Influence General Intelligence and Its Cognitive Com-
     ponents?: A Reassessment of the Evidence,” Developmental Psychology, 27: 703-722.

[10] Florens, J., M. Mouchart and J. Rolin (1990). Elements of Bayesian Statistics. New York : M. Dekker.

[11] Hanushek, E. (2002). “Publicly Provided Education,” in A. Auerbach and M. Feldstein, eds., Hand-
     book of Public Economics, Amsterdam: North Holland. Forthcoming.

[12] Heckman, J. (1974a). “Eﬀects of Child-Care Programs on Women’s Work Eﬀort,” Journal of Political
     Economy, 82(2, Part II): S136-S163.

[13] _____ (1974b). “Shadow Prices, Market Wages, and Labor Supply,” Econometrica, 42(4): 679-94.

[14] _____ (1976). ”Simultaneous Equation Models with both Continuous and Discrete Endogenous
     Variables With and Without Structural Shift in the Equations,” Studies in Nonlinear Estimation,
     Ballinger, Lexington, Massachusetts.


                                                   29
[15] _____. (1980). “Addendum To Sample Selection Bias As A Specification Error,” in E. Stromsdorfer
     and G. Farkas, Evaluation Studies Review Annual, Vol. 5. Sage Publications.

[16] _____ (1981). “Statistical Models For Discrete Panel Data”, in C. Manski and D. McFadden, eds.,
     Structural Analysis of Discrete Data With Econometric Applications, Cambridge: MIT Press.

[17] Heckman, J. and B. Honoré (1990). “The Empirical Content of the Roy Model,” Econometrica,
     Volume 58(5): 1121-49.

[18] Heckman, J. and R. Robb (1985). “Alternative Methods for Evaluating the Impact of Interventions:
     An Overview,” Journal of Econometrics 30(1-2): 239-67.

[19] _____ (1986). “Alternative Methods for Solving the Problem of Selection Bias in Evaluating the
     Impact of Treatments on Outcomes,” in Howard Wainer., ed., Drawing Inferences from Self-selected
     Samples (New Jersey: Lawrence Erlbaum Associates. Reprinted 2000).

[20] Heckman, J. and Y. Rubinstein (2001). “ The Importance of Noncognitive Skills: Lessons from the
     GED Testing Program.” American Economic Review 91(2): 145-49.

[21] Heckman, J. and E. Vytlacil (2001). “Identifying the Role of Cognitive Ability in Explaining the
     Level of and Change in the Return to Schooling.” Review of Economics and Statistics, 2001.

[22] Herrnstein, R. and C. Murray (1994). The Bell Curve. New York: The Free Press.

[23] Jencks, C. (1972). Inequality: a Reassessment of the Eﬀect of Family and Schooling in America. New
     York: Basic Books.

[24] _____ and M. Phillips. (1998). “America’s Next Achievement Test: Closing the Black-White Test
     Score Gap,” American Prospect, Issue 40 (Sept.-Oct.), 44-53.

[25] Kotlarski, Ignacy (1967).“On characterizing the gamma and normal distribution,” Pacific Journal of
     Mathematics, Volume 20, 69-76.

[26] Lord, Frederic M. and M. R. Novick. (1968). Statistical Theories of Mental Test Scores. With contri-
     butions by Allan Birnbaum. Reading, Mass. : Addison-Wesley.

[27] Manski, C. (1988). “Identification of Binary Response Models,” Journal of the American Statistical
     Association Volume 83(403) (September): 729-38

[28] Matzkin, R. (1993). “Nonparametric Identification and Estimation of Polychotomous Choice Models,”
     Journal of Econometrics, 58, 137-68.

[29] McFadden, D. (1984). “Econometric Analysis of Qualitative Response Models”, in Z. Griliches and
     M.D. Intriligator, eds., Handbook of Econometrics, Vol. II, Amsterdam: North Holland.



                                                   30
[30] Neal, D. and W. Johnson (1996). “The Role of Premarket Factors in Black-White Wage Diﬀerences,”
     Journal of Political Economy, 104(5): 869-95.

[31] Pakes, A. and S. Olley (1995). “ A Limit Theorem for a Smooth Class of Semiparametric Estimators,”
     Journal of Econometrics. Volume 65(1): 295-332.

[32] Richardson, S., L. Leblond, I. Jaussent and P. J. Green, (2001). “ Mixture Models in Measurement
     Error Problems, with Reference to Epidemiological Studies,” Working paper, Imperial College, Lon-
     don.

[33] Robert, C.P. and G. Casella. (1999). Monte Carlo Statistical Methods, (New York: Springer).

[34] Thompson, T.S. (1989). “Identification of Semiparametric Discrete Choice Models”, Discussion Paper
     249, University of Minnesota Department of Economics.

[35] Winship, Christopher (2001). “Does Going to College Make You Smarter?” Unpublished manuscript.
     Harvard University.

[36] Winship, C. and S. Korenman (1997). “Does Staying in School Make You Smarter? The Eﬀect of
     Education on IQ in The Bell Curve,” in B. Devlin, S. Fienberg, D. Resnick and K. Roeder, eds.,
     Intelligence, Genes, and Success: Scientists respond to The Bell Curve. New York: Copernicus
     Press. 215-34.




                                                  31
Appendix A              Data

      This paper uses data from the National Longitudinal Survey of Youth (NLSY) to estimate the joint
model of schooling and test scores presented in Section Three. The NLSY is a representative sample of
American young men and women between the ages of 14 and 21 years of age at the time of the first interview
in 1979. The NLSY is comprised of three subsamples: (1) a random sample of 6,111 non-institutionalized
civilian youths; (2) a supplemental sample of 5,295 youths designed to oversample civilian Hispanics, blacks,
and economically disadvantaged whites; (3) a sample of 1,280 youths who were aged 17-21 as of January 1,
1979, and who were enlisted in the military as of September 30, 1978. The NLSY collects information on
parental background, schooling decisions, labor market experiences, cognitive and noncognitive test scores
and other behavioral measures on these individuals on an annual basis.

         Our analysis is restricted to a sample of 2,066 white males from the main subsample for whom
there is information on schooling, parental background, and other variables aﬀecting schooling decisions.
Parental background may include mother’s and father’s education, family income, number of siblings,
geographic information such as urban status and region of the country in which the family resides, and
whether or not the individual comes from a broken home (i.e. non-traditional family). Where information
on mother’s education, father’s education, and/or family income is missing, we impute values for the
missing variables. (Exact imputation rules are posted at our website http://home.uchicago.edu/
~kjmullen/Schooling_JOE.htm) In addition, direct and implicit (opportunity) costs of schooling are
needed. These variables are introduced in the relevant schooling choice equations. These include tuition,
distance to school, and local labor market variables such as local wages and unemployment rates (strati-
fied by completed schooling level). Distance to nearest four-year college is constructed as follows: if there
exists a college in the county where a person resides then distance to nearest college is zero; otherwise we
compute distance in miles to the nearest county with a college, measuring distance between two counties
as the distance between their two centers. This distance is constructed using county of residence at age
17; for those individuals older than 17 in 1979 we use the county of residence in 1979. Tuition at age 17
is the average tuition in colleges in county of residence at age 17. If there is no college in the county,
then average tuition in the state is used instead. Local labor market variables for the county of residence
are gathered from the 5% sample in the 1980 census. We compute local unemployment rates and average
local wages for high school dropouts, high school graduates, and individuals with some college. We assume
that the 1980 variables are a close proxy for local labor market conditions in the years in which NLSY
respondents are assumed to be making the schooling decisions analyzed in this paper. Appendix tables
A-1 and A-2 present means and standard deviations for the variables stratified by final schooling and by
schooling at the test date, respectively, and overall.

         In 1980, NLSY participants were administered a series of achievement tests known as the Armed
Forces Vocational Aptitude Battery (ASVAB). The math and verbal scores of the ASVAB can be aggre-
gated into a measure called the Armed Forces Qualification Test (AFQT). These include tests of Word
Knowledge, Paragraph Comprehension, Arithmetic Reasoning and Mathematics Knowledge. In our ap-
plication AFQT is constructed as the sum of these four tests. Appendix table A-3 presents the number of
questions, allotted completion time, and maximum possible score for each test. In addition, the fraction
of individuals who attain the maximum possible score on each test are presented, overall and by schooling
group at the test date. Accounting for top censoring by modeling the AFQT distribution as the sum of
censored-normal subcomponents is empirically relevant: while only seven individuals out of 2,066 (less
than half of one percent) achieve the maximum possible AFQT score (by achieving the maximum score on
all four test components), 19% of the sample (391 individuals) attain the maximum score on at least one

                                                     32
of the four tests. The table reveals that accounting for top censoring is more important for people with
higher levels of schooling at the time of the test; in some cases twenty to thirty percent of the individuals
in those groups are censored on one or more components.

        The NLSY contains longitudinal data on highest grade completed, year last enrolled in school (if
not currently enrolled), high school degree or equivalency status, type of degree (diploma or GED) for
the years 1979-2000 as well as highest degree attained and year highest degree attained after 1988. Final
schooling categories were constructed primarily using degree information from last year observed provided
that the respondent was 21 or older if the final state was coded as high school dropout or high school
graduate or that the respondent was 25 or older if the individual attended some college. GED recipients
were classified as high school dropouts. For those individuals without specific degree information, the
highest grade completed variable was used. For the remaining 2% of the sample, the age restriction was
relaxed provided the last year the respondent was enrolled was two years prior to last observed schooling
state. The age restriction was placed to ensure that individuals who were actually censored were not
mistakenly included in the sample; for example an individual who dropped out of the sample at age
eighteen with a high school degree may have gone on to attend some college or complete a four-year degree
and should not be coded as a high school graduate. In addition, 53 cases were discarded from the sample
due to inconsistent schooling history or lack of suﬃcient information to conclude schooling status (final or
at the test date, see below).

        Schooling level and enrollment status at the test date were constructed as follows. The ASVAB was
administered during July-October 1980. Respondents were interviewed during January-August 1980 and
again in January-July 1981. Note also that the NLSY constructs a measure of schooling and enrollment
status as of May 1 of each survey year. Since the academic year commonly ends in June (May for college),
individuals typically advance to a higher completed grade level in May/June. We use highest grade
completed and enrollment status as reported in the 1980 survey as measures of schooling and enrollment
at the test date if the interview was conducted during July-August 1980, otherwise we use the variables
reported in 1981 if the survey was conducted during January-April 1981. For those remaining we use
the NLSY-constructed variables for May 1, 1981. We re-coded schooling state at the test date for 32
individuals to be compatible with final schooling state (mostly changing highest grade completed at the
test date to 11 for high school dropouts). For the remaining 1% of the sample we used schooling and
enrollment histories to come up with plausible categories for schooling at the test date.

         In addition to schooling categories, measures of age-at-entry group were constructed. For those
individuals who finished school before 1979 the survey asks the date at which they were last enrolled and
the highest grade they had completed at that date. Recall that we assume continuous schooling profiles
so that there are no skips or breaks in schooling from age at initial entry forward. We constructed our
measure of age at initial entry date as follows. For those individuals enrolled in school in 1979, we let age
at initial entry date equal years of schooling completed in 1979 minus age in 1979. For those individuals
who had finished school prior to 1979 we made the same calculate using highest grade completed and
age at last date of enrollment. In our empirical work we constructed two categories of endogenous entry
status: “behind” if age at initial entry is greater than 6 years (the median age of entry), “normal” if age
at initial entry is 6 years or less.




                                                     33
Appendix B              Estimation Procedure for Control Function Model
Consider the case in which we assume no age eﬀects and random entry into schooling. We group individuals
into six categories of schooling at test date and four categories of completed schooling. The combinations
of schooling at test date and final schooling are represented by the matrix
                                                                  
                                                a11 a12 a13 a14
                                              a21 a22 a23 a24 
                                                                  
                                              a31 a32 a33 a34 
                                        A=   ∼ a42 a43 a44  ,
                                                                                                    (B.1)
                                                                  
                                              ∼ ∼ a53 a54 
                                                ∼ ∼ ∼ a64

where aij represents the average test score for individuals with level i of schooling at the test date and
level j of final schooling. A “−” means that no observations are available for that cell.
    Since we can only identify ratios of the loadings λ (j) , j = 1, . . . , 6 we normalize λ (1) = 1. Then we
have six conditions identifying λ (2) :
                                            a21 − a2j
                                    λ (2) =           ,        j = 2, 3, 4,
                                            a11 − a1j
                                            a22 − a2j
                                    λ (2) =           ,        j = 3, 4,
                                            a12 − a1j
                                            a23 − a24
                                    λ (2) =           .
                                            a13 − a14
   We impose the restrictions using a minimum distance framework. Let Y2 (A) be the vector of the six
unrestricted estimators. λ (2) is estimated by minimizing

                             q (λ (2)) = (Y2 (A) − ιλ (2))0 W2 (Y2 (A) − ιλ (2)) ,                      (B.2)

where W2 is the inverse of an estimate of the asymptotic covariance matrix of Y2 (A). The minimum is
easily found to be
                                                       −1
                                     λ̂ (2) = (ι0 W2 ι) ι0 W2 Y2 (A) .                         (B.3)
   For λ (3) we have six similar conditions:
                                            a31 − a3j
                                    λ (3) =           ,        j = 2, 3, 4,
                                            a11 − a1j
                                            a32 − a3j
                                    λ (3) =           ,        j = 3, 4,
                                            a12 − a1j
                                            a33 − a34
                                    λ (3) =           .
                                            a13 − a14
with a similar expression for the minimum distance estimator (but with a diﬀerent weight matrix W3 ).
   For λ (4) we only have three conditions:
                                             a42 − a4j
                                     λ (4) =           ,        j = 3, 4,
                                             a12 − a1j
                                             a43 − a44
                                     λ (4) =           .
                                             a13 − a14

                                                      34
   Finally, for λ (5) there is only one condition:
                                                                    a53 − a54
                                                       λ (5) =                .                                  (B.4)
                                                                    a13 − a14
Here no minimum distance approach is needed. λ (6) is not identified.
    With all loadings estimated we can estimate intercepts µ (1) , . . . , µ (5) and control functions c1 (j) =
E [f |S = j] , j = 1, ..., 4; and c2 (j) = E [f |ST = j] , j = 1, ..., 6. The model implies the following restrictions:

                                   a1j     =     µ (1) + λ (1) c1 (j) ,           j   = 1, 2, 3, 4,
                                   a2j     =     µ (2) + λ (2) c1 (j) ,           j   = 1, 2, 3, 4,
                                   a3j     =     µ (3) + λ (3) c1 (j) ,           j   = 1, 2, 3, 4,
                                   a4j     =     µ (4) + λ (4) c1 (j) ,           j   = 2, 3, 4,
                                   a5j     =     µ (5) + λ (5) c1 (j) ,           j   = 3, 4,

and
                                    P
                                    4
                                         nij aij
                                   j=1
                                                   = µ (i) + λ (i) c2 (i) ,            i = 1, ..., 6
                                     P
                                     4
                                           nij
                                     j=1

where nij is the sample size of cell (i, j) . Finally the restriction
                                                         P
                                                         4
                                                              nij c1 (j)
                                                        j=1
                                                                           =0
                                                                n
                         P
                         6
is imposed where nj =          nij is the count of individuals with final schooling level j. These conditions imply
                         i=1
24 restrictions on the 15 parameters θ = µ (1) , ..., µ (5) ; c1 (1) , ..., c1 (4) ; c2 (1) , ..., c2 (6) . The minimum
distance problem is to minimize

                                         q (θ) = (Y (A) − Hθ)0 W (Y (A) − Hθ) ,                                  (B.5)

where Y (A) is a linear function of the A elements, H is a known matrix (given estimates of the loadings)
and W is the inverse of an estimate of covariance matrix of Y (A). The minimum distance estimate of θ is
                                                                    −1
                                                 θ̂ = (H 0 W H)          H 0 W Y (A) .                           (B.6)

   Extending to the case controlling for endogenous entry into schooling is straightforward.

Appendix B.1             Allowing for Endogenous Entry
The combinations of schooling at test date and final schooling are represented by the matrices,
                                                                           
                              a11 ∼ ∼ ∼                      b11 b12 b13 b14
                            a21 a22 a23 a24              b21 b22 b23 b24 
                                                                           
                            a31 a32 a33 a34              b31 b32 b33 b34 
                       A=                                                                                   (B.7)
                               ∼    a    a   a    , B =  ∼ b42 b43 b44  ,
                                    42   43  44                            
                             ∼ ∼ a53 a54                  ∼ ∼ b53 b54 
                               ∼ ∼ ∼ a64                     ∼ ∼ ∼ b64

                                                                    35
where aij represents average test score for individuals with level i of schooling at test date, level j of final
schooling and who started school at a normal or early age (N = 0). bij represents average test score
for individuals with level i of schooling at test date,level j of final schooling and who started school late
(N = 1). A zero means that no observations are available for that cell.1
    Since we can only identify ratios of the loadings λ(j), j = 1, . . . , 6, we normalize λ(1) = 1.
    We now have seven conditions identifying λ(2):

                                                    a21 − b21
                                             λ(2) =           ,
                                                    a11 − b11
                                                    b21 − b2j
                                             λ(2) =           ,       j = 2, 3, 4,
                                                    b11 − b1j
                                                    b22 − b2j
                                             λ(2) =           ,       j = 3, 4,
                                                    b12 − b1j
                                                    b23 − b24
                                             λ(2) =           .
                                                    b13 − b14
      As before the restrictions are imposed in a minimum distance framework.
      There are seven conditions for λ(3):

                                                    a31 − b31
                                             λ(3) =           ,
                                                    a11 − b11
                                                    b31 − b3j
                                             λ(3) =           ,       j = 2, 3, 4,
                                                    b11 − b1j
                                                    b32 − b3j
                                             λ(3) =           ,       j = 3, 4,
                                                    b12 − b1j
                                                    b33 − b34
                                             λ(3) =           .
                                                    b13 − b14
   λ(4) and λ(5) have the same conditions as for case 1 (this is because the cells a(1, 2) and a(1, 3) are
empty).
   Note that it is not possible to estimate the ration λ(6)/λ(1) as this would require observations in the
a(1, 4) cell. However we can estimate the ratio λ(6)/λ(2) by the condition:

                                                       λ6   a64 − b64
                                                          =                                                          (B.8)
                                                       λ2   a24 − b24
With this estimate in hand, we can obtain an estimate of the ratio λ6 /λ1 by multiplying with the estimate
of λ2 /λ1 .
    With all loadings estimated we can estimate intercepts µ(1), . . . , µ(6) and control functions c(1, 0), . . . , c(4, 0),
  1
      Due to the small size of our sample, we do not observe individuals in the cells i = 1 and j ≥ 2 of matrix A.




                                                              36
c(1, 1), . . . , c(4, 1). The model implies the following restrictions:

                                   a1j   = µ(1) + λ(1)c(j, 0),       j = 1, 2, 3, 4,
                                   b11   = µ(1) + λ(1)c(1, 1),
                                   a2j   = µ(2) + λ(2)c(j, 0),       j   = 1, 2, 3, 4,
                                   b2j   = µ(2) + λ(2)c(j, 1),       j   = 1, 2, 3, 4,
                                   a3j   = µ(3) + λ(3)c(j, 0),       j   = 1, 2, 3, 4,
                                   b3j   = µ(3) + λ(3)c(j, 1),       j   = 1, 2, 3, 4,
                                   a4j   = µ(4) + λ(4)c(j, 0),       j   = 2, 3, 4,
                                   b4j   = µ(4) + λ(4)c(j, 1),       j   = 2, 3, 4,
                                   a5j   = µ(5) + λ(5)c(j, 0),       j   = 3, 4,
                                   b5j   = µ(5) + λ(5)c(j, 1),       j   = 3, 4,
                                   a64   = µ(6) + λ(6)c(4, 0),
                                   b64   = µ(6) + λ(6)c(4, 1),

and
                                             X
                                             4 X
                                               1
                                                       c(s, n)P (s, n) = 0.
                                             s=1 n=0

These conditions imply 34 restrictions on the 14 parameters θ = µ(1), . . . , µ(6), c(1, 0), . . . , c(4, 1). The
minimum distance estimator is used to impose the conditions.




                                                           37
Appendix C                Estimation Procedure for Structural Model
Let S ∈ {1, . . . , S̄} denote joint choice of completed schooling and age at entry. For clarity we create a
special notation in this appendix and let Z(s) be the set of Z variables with nonzero coeﬃcients in the sth
choice equation:
                               V (s) = z(s)γ(s) + α(s)f + u(s),      s = 1, ..., S.
where u(s) ∼ N(0, 1). We observe S = argmax{V (s)}.
                                               s
   Let ST ∈ {1, . . . , S̄T } be observed schooling at test date. Let T ∗ (ST ) be the vector of latent test scores
conditional on schooling level sT , where Tk∗ (ST ) denotes the kth test. For k = 1, ..., K, let

                     Tk∗ (ST ) = X(ST )β k (ST ) + λk (ST )f + εk (ST ),      ST = 1, ..., ST .

where εk (ST ) ∼ N(0, σ k (ST )2 ). We observe
                                             ½ ∗
                                               Tk (sT ) if Tk∗ (sT ) < ck
                                        Tk =
                                               ck       if Tk∗ (sT ) ≥ ck

if and only if ST = sT where ck is the known maximum value of test k.
    Let
                                              XI
                                           f∼    pi N(µi , σ 2i ).
                                                     i=1

We set I = 3.
                                                                                                       S̄T ,K
    Let θ denote the vector of model parameters {γ(s)}S̄s=1 , {α(s)}S̄−1
                                                                       s=1 , {β k (s), λk (s), σ k (s)}s=1,k=1 . We
estimate the model parameters via Bayesian Markov Chain Monte Carlo (MCMC) methods. The goal
is to sample from the posterior distribution of the parameters θ and the parameters of the distribution
of the factor f , conditional on observed outcomes, S and ST , and covariates from a random sample of
individuals indexed i = 1, .., n. The posterior is only a computational device. We are doing maximum
likelihood-based inference using MCMC as a computational tool. We impose a noninformative flat prior on
all slope coeﬃcients, γ and β. We put proper priors on the variance parameters from the Inverse Gamma
family of distributions and on the factor loadings from the Normal distribution family. Under standard
regularity conditions, the priors are asymptotically irrelevant.
    The data for each individual are test scores, schooling at test date and completed schooling/entry age,
T (ST ), ST , S, plus covariates, A, X, Z, where A is age of test date. The likelihood contribution for one
individual is
                  p(T (ST ) = t, S = s, ST = sT |A = a, X = x, Z = z) =
                            Z
                                ¡                                 ¢
                              p t|S = s, ST = sT , A = a, X = x, f ×
                                                                  ¢                                          (C.1)
                        Pr(ST = sT |S = s, A = a, X = x, Z = z, f ×
                                                                                      ¢ ¡ ¢
                                                                     Pr(S = s|f, Z = z p f df.

   However, this likelihood simplifies due to the exact dependence between S, A, ST described in the text.
In particular,
                                           ¢
  Pr(ST = sT |S = s, A = a, X = x, Z = z, f =
                                                                1(sT = a)1(a ≤ sc ) + 1(sT = sc )1(a > s), (C.2)

                                                           38
where sc denotes the schooling dimension of S (recall that S includes states for both completed schooling
and age of entry). So the likelihood contribution for an individual who has not yet completed schooling is

                 p(T (ST ) = t, S = s, ST = sT |A = a, X = x, Z = z) =
                  Z
                      ¡                                          ¢
                     p t|S = s, ST = sT , A = a, X = x, f, sT = a ×
                                                                                     ¢ ¡ ¢
                                                                    Pr(S = s|f, Z = z p f df,

while the likelihood contribution for an individual who has completed schooling is

                 p(T (ST ) = t, S = s, ST = sT |A = a, X = x, Z = z) =
                  Z
                      ¡                                          ¢
                    p t|S = s, ST = sT , A = a, X = x, f, sT = sc ×
                                                                                     ¢ ¡ ¢
                                                                    Pr(S = s|f, Z = z p f df.

The two likelihood contributions are functionally identical - the only diﬀerence is what value of sT is
conditioned on.
   To resolve the high dimensional integrals in these likelihood contributions we augment the likelihood
with latent utilities V , determining choice of S, factors f and latent test scores T ∗ .

  p(T ∗ , V, f, ST = sT |A = a, X = x, Z = z) =
                                                    ¡                              ¢             ¢ ¡ ¢
                                                   p T ∗ |ST = sT , A = a, X = x, f p(V |f, Z = z p f , (C.3)

where sT is either a or completed schooling depending on the individual having completed schooling or
not at test date. Integration of (C.3) with respect to V, T ∗ , f leads us back to the original likelihood.
    The (augmented) sample likelihood is defined as the product of (C.3) over all individuals. We can easily
implement a Gibbs sampling algorithm which samples iteratively from the posterior distributions of the
parameters and latent data conditional on the observed data. The stationary distribution of the Markov
chain generated by this algorithm is the joint posterior distribution of the parameters.
    The MCMC algorithm is implemented as follows. Given initial starting values for the parameters
and V ,f ,T ∗ for m = 1, 2, ... we can update the values of the other parameters and sample from the
following conditional distributions (note that we implicitly are conditioning on the data as well as all other
parameters). Table C-1 summarizes the specifications of the prior distributions for the estimates reported
in the paper.

  1. The conditional posterior distribution of the latent utilities V is just the product of the individual
     conditional posterior distributions of Vi by independence. Let Si be observed final schooling for
     individual i and let Zi (s) be all covariates entering schooling alternative s. The elements of Vi are
     sampled from truncated normals (as in McCulloch and Rossi (1994)),
                                  (
                                   TN[max 6=s {Vi ( )},∞) (Zi (s)γ(s) + α(s)fi , 1), if s = Si ,
                         Vi (s) ∼
                                   TN(−∞,Vi (Si )] (Z(s)γ(s) + α(s)fi , 1),          if s 6= Si .

  2. Conditional on V = {Vi (s)}i,s , the distribution of γ(s) follows from a classical linear regression model
     with noninformative prior.

                                               d Ω(s)),
                                      γ(s) ∼ N(γ(s), d               s = 1, . . . , S̄,

                                                        39
   where
                                    d = (Z(s)0 Z(s))−1 Z(s)0 (V (s) − α(s)f )
                                    γ(s)
                                    d = (Z(s)0 Z(s))−1 ,
                                    Ω(s)

   where V (s) = (V1 (s), . . . , Vn (s)) and Z(s)0 = (Z1 (s), . . . , Zn (s)).

3. Assuming a normal N(µ1 , ψ 21 ) prior the conditional distribution of α(s) is:

                                             d Ω(s)),
                                    α(s) ∼ N(α(s), d                s = 1, . . . , S̄ − 1.

   where
                                             µ                           ¶
                                     d = Ω c1 f (V (s) − Z(s)γ(s)) +
                                                 0                   µ1
                                     α(s)
                                                                     ψ21
                                           µ          ¶−1
                                      c1 =         1
                                      Ω     f 0f + 2
                                                   ψ1

   α(S̄) is set to zero for identification. Similarly, coeﬃcients for covariates common across alternatives
   are set to zero for γ(S̄). We set µ1 = 0 and ψ21 = 1.

4. For each test equation, k = 1, . . . , K, at each schooling level, s = 1, .., S̄T , we estimate the coeﬃcients
   on the control variables as follows:
                             ¡                                                                   ¢
                  β k (s) ∼ N (X(s)0 X(s))−1 X(s)0 (Tk∗ (s) − λk (s)f ), σ k (s)2 (X(s)0 X(s))−1 ,

   where only those individuals who have completed schooling level s at the test date are included.

5. The factor loadings in the test equations are sampled as
                                  ³               ´
                       λk (s) ∼ N λ[ k (s), \
                                            Ωk (s)  , k = 1, . . . , K; s = 1, . . . , S̄T ,

   where
                                               µ 0 ∗                              ¶
                               [        \        f (Tk (s) − X(s)β k (s)) µk (s)
                               λk (s) = Ωk (s)                           +
                                                          σ k (s)2         ψk (s)
                                        µ 0                ¶−1
                               \k (s) =
                                            ff         1
                               Ω            k   2
                                                  + k            ,
                                         σ (s)       ψ (s)

   using only the individuals who have schooling level s at the test date and using a normal prior
   N(µk (s), ψ k (s)). We use µk (s) = 0 and ψk (s) = 1.

6. Assuming an Inverse Gamma prior IG(as , bs ) and letting n(s) be the number of individuals in school-
   ing group s at the test date, we have:
                                             µ                                ¶
                                       2       n(s)        ek (s)0 ek (s)
                                σ k (s) ∼ IG        + as ,                + bs ,
                                                2                2

   where ek (s) = Tk∗ (s) − X(s)β k (s) − λk (s)f . We set as = 2 and bs = 1.


                                                         40
7. The factors f and the parameters of the factor distribution are sampled as follows. Let gi ∈ {1, . . . , I}
   denote the mixture component from which fi is sampled. Note that gi is unobserved. Conditional
   on gi the conditional distribution of fi is easily found to be
                                                        ³      ´
                                                          b b
                                                fi ∼ N fi , Γi

   where
                              "                PS̄                                                  #
                  fbi = Γbi       PK       s=1 α(s)(Vi (s) − Zi (s)γ(s))+
                                                    2     ∗                               2
                                 (λ (s
                             k=1 k T i )/σ k (sT i ) )(Tik − Xi (sT i β k (sT i )) + (1/σ gi )µgi
                       Ã S̄                                                !−1
                        X           XK
                 Γbi =      α(s)2 +    λk (sT i )2 /σ k (sT i )2 + 1/σ 2gi     ,
                              s=1        k=1

   where ST i is individual i’s schooling at test date.
   Conditional on f the mixture parameters are sampled by the usual trick of first updating the gi
   indicators and then sampling the mixture
                                     P       parameters conditional on the gi ’s, cf. Robert and Casella
   (1999). We impose the restriction Ii=1 pi µi = 0 using the method in Richardson et.al. (2001).

8. The test scores for individuals who hit the ceiling on a test are sampled from truncated normals, i.e.,
                                            ¡                                                     ¢
                            Tik∗ ∼ TN(ck ,∞) Xi (sT i )0 β k (sT i ) + λk (sT i )fi , σ k (sT i )2 .




                                                      41
                                            Table A-1
                             Sample Means By Final Attainment Status
                                      NLSY, White Males
         Variables            Overall                   By Final Years of Education
                                        HS Dropout      HS Graduate     Some College   College Graduate
No. Observations               2066         330              722             395              619
Urban Dummy                   0.7517       0.7394          0.7105           0.7443          0.8110
                             (0.4321)     (0.4396)        (0.4538)         (0.4368)       (0.3918)
From Broken Home              0.1999       0.4000          0.1814           0.1924          0.1196
                             (0.4000)     (0.4906)        (0.3856)         (0.3947)       (0.3247)
Number of Siblings            2.9942       3.6900          3.0997           3.0152          2.4862
                             (1.9805)     (2.3302)        (1.8728)         (2.1147)       (1.6559)
Southern Dummy                0.2493       0.3818          0.2119           0.2506          0.2213
                             (0.4327)     (0.4866)        (0.4089)         (0.4339)       (0.4155)
Mother's Education           12.1343      10.5019         11.5817          12.2393         13.4105
(N=1884)                     (2.3326)     (2.3080)        (1.9751)         (1.9270)       (2.2662)
Father's Education           12.4202      10.1341         11.4407          12.6711         14.4179
(N=1942)                     (3.3135)     (3.0890)        (2.7352)         (2.9093)       (3.1170)
Family Income (Thousands)    22.3244      14.7412         20.7361          22.5783         28.1310
(N=1695)                    (14.3756)     (9.7335)       (11.6325)        (13.2189)      (17.5746)
Born in First Quarter         0.2464       0.2364          0.2493           0.2658          0.2359
                             (0.4310)     (0.4255)        (0.4329)         (0.4423)       (0.4249)
Born in Second Quarter        0.2483       0.2606          0.2396           0.2329          0.2617
                             (0.4321)     (0.4396)        (0.4271)         (0.4232)       (0.4399)
Born in Third Quarter         0.2672       0.2727          0.2659           0.2709          0.2633
                             (0.4426)     (0.4460)        (0.4421)         (0.4450)       (0.4408)
Behind Peers                  0.3204       0.5455          0.3033           0.3038          0.2310
                             (0.4668)     (0.4987)        (0.4600)         (0.4605)       (0.4218)
Born in 1957                  0.1026       0.0970          0.0983           0.1266          0.0953
                             (0.3035)     (0.2964)        (0.2980)         (0.3329)       (0.2939)
Born in 1958                  0.0978       0.0606          0.0886           0.1139          0.1179
                             (0.2971)     (0.2390)        (0.2844)         (0.3181)       (0.3228)
Born in 1959                  0.1094       0.1000          0.1260           0.1038          0.0985
                             (0.3122)     (0.3005)        (0.3321)         (0.3054)       (0.2983)
Born in 1960                  0.1336       0.1394          0.1482           0.1114          0.1276
                             (0.3403)     (0.3469)        (0.3555)         (0.3150)       (0.3339)
Born in 1961                  0.1317       0.1272          0.1343           0.1392          0.1260
                             (0.3382)     (0.3338)        (0.3413)         (0.3466)       (0.3321)
Born in 1962                  0.1641       0.1667          0.1634           0.1671          0.1616
                             (0.3704)     (0.3732)        (0.3700)         (0.3735)       (0.3683)
Born in 1963                  0.1389       0.1636          0.1316           0.1215          0.1454
                             (0.3459)     (0.3705)        (0.3383)         (0.3271)       (0.3528)
Local Dropout Wage            6.5651       6.5853          6.5993           6.5913          6.4976
                             (1.2256)     (1.3347)        (1.2512)         (1.2165)       (1.1377)
Local Dropout                 0.0697       0.0684          0.0718           0.0710          0.0672
Unemployment Rate            (0.0231)     (0.0237)        (0.0231)         (0.0240)       (0.0219)
Local HS Graduate Wage        7.5509       7.5600          7.5186           7.5742          7.5689
                             (1.4599)     (1.5218)        (1.3438)         (1.4226)       (1.5780)
Local HS Unempl. Rate         0.0573       0.0552          0.0609           0.0588          0.0531
                             (0.0254)     (0.0266)        (0.0254)         (0.0264)       (0.0235)
Local Wage for Some           7.6666       7.6679          7.6692           7.7600          7.6033
College                      (1.4020)     (1.4245)        (1.4148)         (1.4042)       (1.3733)
Local Unempl. Rate for        0.0371       0.0355          0.0395           0.0378          0.0347
Some College                 (0.0156)     (0.0160)        (0.0155)         (0.0162)       (0.0148)
4-Year College Tuition       19.8694      18.0718         21.3384          19.5033         19.3481
(tens)                       (7.8463)     (7.2133)        (7.7863)         (8.3439)       (7.6350)
                                       Table A-1, Continued
                              Sample Means By Final Attainment Status
                                       NLSY, White Males
         Variables            Overall                    By Final Years of Education
                                         HS Dropout      HS Graduate     Some College   College Graduate
Distance to 4-Year College     8.1149      10.4564          8.3852           9.2578          5.8219
                             (16.4639)    (19.9424)       (15.9885)        (16.8611)      (14.3320)
Word Knowledge                26.8930      20.1000         25.1911          28.6886         31.3538
                             (7.03266)     (8.1892)        (6.5495)         (5.0356)       (3.6514)
Paragraph Comprehension       10.9719       7.7848         10.1801          11.8152         13.0565
                              (3.3182)     (3.5822)        (3.2502)         (2.5227)       (1.6166)
Arithmetic Reasoning          19.7333      13.0242         17.6191          20.9747         24.9838
                              (7.2253)     (5.8957)        (6.5290)         (5.9915)       (5.0460)
Math Knowledge                14.6438       8.3272         11.9834          15.5873         20.5121
                              (6.5385)     (4.0018)        (5.0292)         (5.5759)       (4.5122)
Overall AFQT                  72.2420      49.2364         64.9737          77.0658         89.9063
                             (21.6023)    (18.7146)       (18.1901)        (16.0706)      (12.2652)
                                                  Table A-2
                                     Sample Means by Education at Test Date
                                              NLSY, White Males

                                                 By Years of Education at Test Date (July-October 1980)
                                                                                                               College
      Variables           Overall      <=9           10              11       HS Graduate     Some College    Graduate
No. Observations            2066       205          322             343            747             376           73
Urban Dummy                0.7517     0.7171       0.7360         0.7405         0.7349          0.8138        0.8219
                          (0.4321)   (0.4515)     (0.4415)       (0.4390)       (0.4417)        (0.3898)      (0.3852)
From Broken Home           0.1999     0.3805       0.2671         0.2187         0.1620          0.1197        0.1096
                          (0.4000)   (0.4867)     (0.4431)       (0.4139)       (0.3687)        (0.3250)      (0.3145)
Number of Siblings         2.9942     3.7366       2.9534         2.9767         2.9411          2.8830        2.2877
                          (1.9805)   (2.4968)     (1.8897)       (1.9330)       (1.8523)        (2.0375)      (1.3487)
Southern Dummy             0.2493     0.4341       0.2484         0.2449         0.2129          0.2340        0.2055
                          (0.4327)   (0.4969)     (0.4328)        (.4307)       (0.4096)        (0.4240)      (0.4068)
Mother's Education        12.1343    10.4892      11.7412        12.0709        11.9636         13.0822       13.7455
(N=1884)                  (2.3326)   (2.4653)     (2.0647)       (2.3630)       (2.1499)        (2.1671)      (2.0925)
Father's Education        12.4202     9.9712       12.057        12.0709        12.0971         13.8783       14.2364
(N=1942)                  (3.3135)   (3.3274)     (3.2026)       (3.1889)       (3.0071)        (3.1258)      (3.3331)
Family Income (Thous.)    22.3244    15.0775      20.1549        22.7529        22.7557         27.9788       25.9860
(N=1695)                 (14.3756)   (9.0086)    (12.0373)      (13.1427)      (13.0989)       (18.1897)     (17.8028)
In School at Test Date     0.5034     0.3902       0.7702         0.7055         0.2249          0.7261        0.3973
                           (.5001)   (0.4890)     (0.4214)       (0.4565)       (0.4178)        (0.4466)      (0.4927)
Born in 1957               0.1026     0.0634       0.0248         0.0321         0.1098          0.1622        0.5068
                          (0.3035)   (0.2443)     (0.1559)       (0.1764)       (0.3128)        (0.3692)      (0.5034)
Born in 1958               0.0978     0.0293       0.0155         0.0350         0.1017          0.1835        0.4658
                          (0.2971)   (0.1690)     (0.1238)       (0.1840)       (0.3025)        (0.3876)      (0.5023)
Born in 1959               0.1094     0.0634       0.0248         0.0437         0.1446          0.2128        0.0274
                          (0.3122)   (0.2443)     (0.1559)       (0.2048)       (0.3519)        (0.4098)      (0.1644)
Born in 1960               0.1336     0.0585       0.0404         0.0816         0.1754          0.2447        0.0000
                          (0.3403)   (0.2353)     (0.1971)       (0.2742)       (0.3805)        (0.4305)      (0.0000)
Born in 1961               0.1317     0.0780       0.0373         0.0816         0.1954          0.1862        0.0000
                          (0.3382)   (0.2689)     (0.1897)       (0.2742)       (0.3968)        (0.3898)      (0.0000)
Born in 1962               0.1641     0.1561       0.0776         0.2391         0.2637          0.0080        0.0000
                          (0.3704)   (0.3638)     (0.2680)       (0.4271)       (0.4409)        (0.0891)      (0.0000)
Born in 1963               0.1389     0.1415       0.2609         0.4840         0.0094          0.0027        0.0000
                          (0.3459)   (0.3494)     (0.4398)       (0.5005)       (0.0964)        (0.0516)      (0.0000)
Word Knowledge            26.8930    18.4488      24.2888        26.2828        27.5636         31.7766       32.9452
                         (7.03266)   (7.2581)     (7.3532)       (6.3737)       (5.9219)        (3.5437)      (2.2292)
Paragraph                 10.9719     7.0878       9.8758        10.9679        11.2503         13.0000       13.4384
Comprehension             (3.3182)   (3.3302)     (3.6382)       (3.1589)       (2.8090)        (1.8504)      (1.2582)
Arithmetic Reasoning      19.7333    12.0683      17.0870        18.9650        19.9545         25.0532       26.8767
                          (7.2253)   (5.6755)     (6.9550)       (6.7120)       (6.4590)        (4.9727)      (3.7228)
Math Knowledge            14.6438     0.3805      12.7702        13.7843        14.1245         20.1197       21.8493
                          (6.5385)   (0.4867)     (6.3278)       (6.1909)       (5.7016)        (4.7017)      (3.7256)
Overall AFQT              72.2420     3.7366      64.0217        70.0000        72.8929         89.9495       95.1096
                         (21.6023)   (2.4968)    (21.5587)      (19.3215)      (17.8026)       (12.4515)      (8.9047)
                                             Table A-3
                           ASVAB Test Information: AFQT Subcomponents
                            Word         Paragraph     Arithmetic      Math
                          Knowledge   Comprehension    Reasoning     Knowledge              Overall AFQT
Number of Questions          35             15             11           25                       86
Time (in minutes)            11             13             36           24                       84
Max. Possible Raw Score      35             15             30           25                      105

                                      Fraction of Observations Censored in Each Subsystem
                                                                                              At Least 1
                            Word        Paragraph         Arithmetic         Math              AFQT
Schooling at Test Date    Knowledge   Comprehension       Reasoning        Knowledge         Component
9 Years or Less            0.0000        0.0098            0.0049           0.0000             0.0146
10 Years                   0.0155        0.0311            0.0248           0.0217             0.0745
11 Years                   0.0496        0.0787            0.0437           0.0408             0.1370
12 Years/ HS Graduate      0.0535        0.0656            0.0348           0.0388             0.1392
Some College               0.2128        0.1649            0.1622           0.1303             0.4521
College Graduate           0.3151        0.1781            0.2740           0.2192             0.5890
Overall                    0.0799        0.0789            0.0634           0.0557             0.1893




                                         Table C-1
          Specification of Priors for Reported Structural Model Estimates
Parameter          Prior Distribution                               Prior Specification
        S̄
{γ(s)}s=1          Noninformative flat prior on nonzero coeﬃcients.
                   Degenerate prior with point mass at zero for
                   restricted coeﬃcients. (See Table 6.)
        S̄−1
{α(s)}s=1          N(µ1 , ψ 21 )                                    µ1 = 0, ψ 21 = 1
           S̄T ,K
{β k (s)}s=1,k=1   Noninformative flat prior.
           S̄T ,K
{λk (s)}s=1,k=1 N(µk (s), ψ k (s))                                  µk (s) = 0, ψ k (s) = 1
        2 S̄T ,K
{σ k (s) }s=1,k=1 IG(as , bs )                                      as = 2, bs = 1
                              Table 1
             Non-parametric Estimates of Factor Loadings
                        Comparison Groups (s, s0)
      (1,2) (1,3) (1,4) (2,3) (2,4) (3,4) MD∗               χ2
λ̂(2) 2.26    1.38   1.00    1.03    0.81    0.68    0.83  6.31
      (1.52) (0.45) (0.15) (0.54) (0.16) (0.27) (0.13) (p = 0.28)
λ̂(3) 0.71    0.73   0.87    0.73    0.89    0.98    0.87  0.83
      (0.72) (0.27) (0.13) (0.40) (0.16) (0.34) (0.12) (p = 0.98)
λ̂(4)                        0.89    0.66    0.52    0.61  3.01
                            (0.41) (0.12) (0.19) (0.12) (p = 0.22)
λ̂(5)                                        0.56    0.56  (na)
                                            (0.20) (0.20)  (na)
∗
MD = minimum distance
We normalize λ(1) = 1.

                                  Table 2
       Non-parametric Estimates of Intercepts and Control Functions
                                 Intercepts
     µ̂(1)       µ̂(2)          µ̂(3)          µ̂(4)         µ̂(5)
    56.91        65.93          71.63          75.24         82.58
    (1.27)      (0.95)         (0.78)         (0.61)        (0.63)
                           Control Functions
    E[f |S =Dropout]                                        -15.89
                                                            (1.15)
    E[f |S =High School]                                    -10.70
                                                            (0.74)
    E[f |S =Some College]                                     1.95
                                                            (0.99)
    E[f |S =College]                                         19.70
                                                            (0.76)
    E[f |ST =9th Grade or Less]                             -10.99
                                                            (0.95)
    E[f |ST =10th Grade]                                     -2.23
                                                            (0.87)
    E[f |ST =11th Grade]                                     -2.23
                                                            (0.75)
    E[f |ST =High School]                                    -3.63
                                                            (0.56)
    E[f |ST =Some College]                                   13.33
                                                            (0.71 )
    E[f |ST =College]                                        19.70
                                                            (7.33)
                           2
                          χ = 10.61 (p = 0.30)
                                          Table 3
                        Non-parametric Estimates of Factor Loadings
                          Controlling for Endogenous Start Date
                        λ̂(2)    1.23             1.13
                                (0.22)         (p = 0.98)
                        λ̂(3)    0.96             1.45
                                (0.18)         (p = 0.96)
                        λ̂(4)    0.94             0.01
                                (0.23)         (p = 0.92)
                        λ̂(5)    0.41             N/A
                                (0.25)            N/A
                        λ̂(6)    0.00             N/A
                                (0.90)            N/A




                                              Table 4
                  Non-parametric Estimates of Intercepts and Control Functions
                             Controlling for Endogenous Start Date
                                             Intercepts
 µ̂(1)               µ̂(2)                 µ̂(3)    µ̂(4)              µ̂(5)         µ̂(6)
57.13               66.06                  72.25 74.62                87.10          95.10
(1.35)              (0.96)                (0.77) (0.65)               (0.54)        (1.04)
                                       Control Functions
E[f|S =Dropout, N =Normal]                -11.14 E[f |S =Dropout, N = Behind]       -17.03
                                          (1.34)                                    (1.38)
E[f|S =High School, N =Normal]             -5.24 E[f |S =High School, N = Behind]   -12.02
                                          (0.74)                                    (1.15)
E[f|S =Some College, N =Normal]            2.26 E[f |S =Some College, N = Behind]    -1.26
                                          (0.95)                                    (1.73)
E[f|S =College, N =Normal]                 15.80 E[f |S =College, N = Behind]       14.08
                                          (0.71)                                    (1.38)
E[f|ST =9th Grade or Less, N =Normal] -6.73 E[f |ST =9th Grade or Less, N =Behind] -12.45
                                          (2.26)                                    (1.14)
E[f|ST =10th Grade, N =Normal]              0.84 E[f |ST =10th Grade, N =Behind]     -7.52
                                          (0.71)                                    (1.33)
E[f|ST =11th Grade , N =Normal]             1.21 E[f |ST =11th Grade , N =Behind]    -8.23
                                          (0.86)                                    (1.22)
E[f|ST =High School , N =Normal]           -0.52 E[f |ST =High School, N =Behind]    -6.30
                                          (0.56)                                    (1.07)
E[f|ST =Some College, N =Normal]           11.19 E[f |ST =Some College , N =Behind]   7.85
                                          (0.98)                                    (1.22)
E[f|ST =College, N =Normal]                N/A E[f |ST =College, N =Behind]          N/A
                                           N/A                                       N/A
                                      χ2 = 37.40 (p = 0.01)
                                                     Table 5
                           Non-parametric Estimates of Intercepts and Control Functions
                  Allowing for N-Eﬀects in Intercepts and Controlling for Endogenous Start Date
                                                    Intercepts
µ̂(ST = 1, N = 0) µ̂(ST = 2, N = 0)  µ̂(ST = 3, N = 0) µ̂(ST = 4, N = 0) µ̂(ST = 5, N = 0) µ̂(ST = 6, N = 0)
      53.68             62.15               69.98               72.30              86.65          95.10
      (3.40)            (1.76)              (1.35)              (1.25)            (0.57)         (1.14)
µ̂(ST = 1, N = 1) µ̂(ST = 2, N = 1)  µ̂(ST = 3, N = 1) µ̂(ST = 4, N = 1) µ̂(ST = 5, N = 1) µ̂(ST = 6, N = 1)
      62.81             74.27               77.03               79.40              86.65          95.11
      (2.75)            (3.25)              (2.65)              (2.60)            (0.57)         (2.58)
                                                 Control Functions
E[f |S =Dropout, N = Normal ]                -8.14        E[f|S =Dropout, N = Behind ]           -22.81
                                            (1.88)                                               (2.75)
E[f |S =High School, N = Normal ]            -2.68        E[f|S =High School, N = Behind ]       -17.61
                                            (1.34)                                               (2.64)
E[f |S =Some College, N = Normal ]            4.74        E[f|S =Some College, N = Behind ]       -6.06
                                            (1.42)                                               (2.72)
E[f |S =College, N = Normal ]               18.05         E[f|S =College, N = Behind ]             9.51
                                            (1.17)                                               (2.33)
                                                    χ2 = 30.32
Note. N = 0 is normal, N = 1 is behind.
                                                                     Table 6
                                                     Covariates Included in Structural Model
                                         Utility Associated with Schooling,                Utility Associated with Schooling,       Test Score
                                          Entry Normal/Ahead of Peers:                             Entry Behind Peers               Equations:
                                  HS Dropout HS Grad. Some Coll. Coll. Grad.       HS Dropout     HS Grad. Some Coll. Coll. Grad.
Intercept                            Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Urban Dummy                          Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Broken Home Dummy                    Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Number of Siblings                   Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
South Dummy                          Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Mother’s Education                   Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Father’s Education                   Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Family Income                        Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Cohort Dummies                       Yes          Yes          Yes          Yes       Yes           Yes          Yes           -         -
Local Wage for Dropouts              Yes            -           -            -        Yes             -           -            -         -
Local Dropout Unempl. Rate           Yes            -           -            -        Yes             -           -            -         -
Local Wage for HS Grads               -           Yes           -            -         -            Yes           -            -         -
Local HS Grad. Unempl. Rate           -           Yes           -            -         -            Yes           -            -         -
Local Wage for Some College           -             -          Yes           -         -              -          Yes           -         -
Local Some Coll. Unempl. Rate         -             -          Yes           -         -              -          Yes           -         -
Tuition to Nearest 4-Yr. Coll.        -             -           -           Yes        -              -           -           Yes        -
Distance to Nearest 4-Yr. Coll.       -             -           -           Yes        -              -           -           Yes        -
Quarter of Birth Dummies              -            -            -            -        Yes           Yes          Yes          Yes        -
Age as of December 31, 1980           -             -           -            -         -              -           -            -        Yes
In School at Test Date                -             -           -            -         -              -           -            -        Yes
Factor                               Yes          Yes          Yes          Yes       Yes           Yes          Yes           -        Yes
Conditional on:                       -             -           -            -         -              -           -            -    Schooling at
                                                                                                                                     Test Date
                                                Table 7
                                   χ2 -Statistics for Choice Model
                           Average Choice Probabilities in Selected Groups
                             Dropout HS Grad. Some Coll. Coll. Grad.         χ2 -Statistic   P-value
Overall (N=2066)
Normal/Ahead Actual             0.0726     0.2435    0.1331      0.2304
                  Predicted     0.0716     0.2452    0.1359      0.2273
Behind            Actual        0.0871     0.1060    0.0581      0.0692
                  Predicted     0.0843     0.1052    0.0605      0.0697        0.6775        0.9985
Individuals from urban area (N=1553)
Normal/Ahead Actual             0.0734     0.2292    0.1301      0.2473
                  Predicted     0.0722     0.2330    0.1335      0.2420
Behind            Actual        0.0837     0.1011    0.0592      0.0760
                  Predicted     0.0802     0.1007    0.0622      0.0760        0.9032        0.9962
Individuals from rural area (N=513)
Normal/Ahead Actual             0.0702     0.2865    0.1423      0.1793
                  Predicted     0.0698     0.2822    0.1433      0.1830
Behind            Actual        0.0975     0.1209    0.0546      0.0487
                  Predicted     0.0968     0.1188    0.0555      0.0504        0.1345        1.0000
Individuals with less than 3 siblings (N=968)
Normal/Ahead Actual             0.0610     0.2231    0.1312      0.3171
                  Predicted     0.0562     0.2383    0.1405      0.2926
Behind            Actual        0.0589     0.0857    0.0496      0.0733
                  Predicted     0.0607     0.0886    0.0501      0.0721        4.0925        0.7691
Individuals with 3 or more siblings (N=1098)
Normal/Ahead Actual             0.0829     0.2614    0.1348      0.1539
                  Predicted     0.0851     0.2513    0.1319      0.1698
Behind            Actual        0.1120     0.1239    0.0656      0.0656
                  Predicted     0.1052     0.1198    0.0697      0.0675        3.1838        0.8675
Avg. parents’ education < 12 years (N=803)
Normal/Ahead Actual             0.1270     0.2827    0.1009      0.0934
                  Predicted     0.1234     0.2730    0.1173      0.1204
Behind            Actual        0.1694     0.1469    0.0523      0.0274
                  Predicted     0.1407     0.1365    0.0556      0.0331        13.3411       0.0642
Avg. parents’ education ≥ 12 years (N=1263)
Normal/Ahead Actual             0.0380     0.2185    0.1536      0.3175
                  Predicted     0.0386     0.2276    0.1478      0.2953
Behind            Actual        0.0348     0.0800    0.0618      0.0958
                  Predicted     0.0485     0.0852    0.0636      0.0929        8.3124        0.3059
Four-year College Tuition ≤ $2,000 (N=1008)
Normal/Ahead Actual             0.0863     0.2004    0.1290      0.2500
                  Predicted     0.0791     0.2214    0.1364      0.2370
Behind            Actual        0.1032     0.0982    0.0605      0.0724
                  Predicted     0.0969     0.0995    0.0568      0.0722        4.4722        0.7241
Four-year College Tuition > $2,000 (N=1058)
Normal/Ahead Actual             0.0595     0.2845    0.1371      0.2117
                  Predicted     0.0644     0.2679    0.1354      0.2181
Behind            Actual        0.0718     0.1134    0.0558      0.0662
                  Predicted     0.0723     0.1106    0.0641      0.0672        2.9245        0.8919
Zero Distance to Four-Year College (N=1552)
Normal/Ahead Actual             0.0689     0.2397    0.1308      0.2577
                  Predicted     0.0686     0.2398    0.1357      0.2493
Behind            Actual        0.0754     0.1018    0.0541      0.0715
                  Predicted     0.0772     0.0983    0.0577      0.0730        1.3616        0.9867
Nonzero Distance to Four-Year College (N=514)
Normal/Ahead Actual             0.0837     0.2549    0.1401      0.1479
                  Predicted     0.0805     0.2617    0.1365      0.1608
Behind            Actual        0.1226     0.1187    0.0700      0.0623
                  Predicted     0.1057     0.1259    0.0692      0.0597        2.4023        0.9343
                                                  Table 8
                                2
                             χ -Statistics for Predicted AFQT Distributions
                              Conditional on Schooling Level at Test Date
                     Schooling Level            N    No. bins χ2 -Statistic P-value
                     Ninth Grade or Less        205         8      16.8349   0.0185
                     Tenth Grade                322        12       7.2653   0.7772
                     Eleventh Grade             343        13      12.3787   0.4158
                     High School Graduate 747              26      30.5079   0.2058
                     Some College               376        13      35.3758   0.0004
                     College Graduate            73         5      10.3990   0.0342
                     Overall                   2066        77     112.7616   0.0040
                     Note: Bins were chosen to include approx. equal numbers of observations
                     in each cell. No. bins was chosen to average roughly 25-30 people per bin,
                     except last group due to small size.




                                              Table 9
Estimates from OLS Regression of Log Wage in 1998 on Years of Schooling and Residualized AFQT
Variable                   Coeﬃcient Std. Error         t      P > |t|  95 % ConÞdence Interval
Years of Schooling in 1998     0.1022     0.0101     10.08      0.000    0.0823       0.1221
Experience                    -0.5657     0.0457      -1.24     0.216   -0.1463       0.0332
           2
Experience                     0.0028     0.0013       2.23     0.026    0.0003       0.0053
OLS-Residualized AFQT          0.0988     0.0221       4.48     0.000    0.0555       0.1421
Constant                       1.4812     0.4749       3.12     0.002    0.5493       2.4132
Source                               SS              Degrees of Freedom            MS
Model                              62.4505                    4                 15.6126
Residual                          249.9216                  977                  0.2558
                                     Number of Obs. = 982
                                        F (4, 977) = 61.03
                                       P rob. > F = 0.0000
                                           R2 = 0.1999
                                      Adjusted R2 = 0.1966
                                       Root MSE = 0.5058
Note: Regressions estimated on observations with nonmissing wages
                                               Table 10
                        Estimates from OLS Regression of Log Wage in 1998
                   on Years of Schooling and Schooling Corrected Ability Measure
Variable                    Coeﬃcient Std. Error         t       P > |t|  95 % Confidence Interval
Years of Schooling in 1998     0.1176       0.0094     12.46      0.000   0.0991       0.1362
Experience                    -0.0589       0.0461     -1.28      0.202   -0.1494      0.0316
Experience2                    0.0029       0.0013      2.29      0.022    0.0004      0.0054
fˆ                             0.1483       0.0734      2.02      0.044    0.0042      0.2923
Constant                       1.2708       0.4758      2.67      0.008    0.3371      2.2045
Source                                 SS              Degrees of Freedom           MS
Model                                58.3832                    4                 14.5958
Residual                            253.9890                  977                 0.2600
                                       Number of Obs. = 982
                                          F (4, 977) = 56.14
                                         P rob. > F = 0.0000
                                             R2 = 0.1869
                                        Adjusted R2 = 0.1836
                                         Root MSE = 0.5099
Note: Regressions estimated on observations with nonmissing wages




                                             Table 11
       Estimates from OLS Regression of AFQT Score on Years of Schooling at Test Date
Variable             Coeﬃcient Std. Error           t       P > |t|   95 % Confidence Interval
Years of Schooling      5.5800      0.2867      19.4600     0.0000    5.0177        6.1423
Urban Status            0.2610      0.8569       0.3000     0.7610   -1.4195        1.9415
Broken Home             0.9417      0.9729       0.9700     0.3330   -0.9662        2.8496
Number of Siblings     -0.5773      0.1898      -3.0400     0.0020   -0.9496       -0.2051
Southern               -2.6561      0.8535      -3.1100     0.0020   -4.3298       -0.9823
Mother’s Education      1.9069      1.3426       1.4200     0.1560   -0.7261        4.5400
Father’s Education      8.0419      1.2635       6.3600     0.0000    5.5640       10.5197
Family Income          0.1250       0.0299       4.1900     0.0000    0.0665        0.1836
Age                     0.1239      0.2562       0.4800     0.6290   -0.3785        0.6264
In School               8.6112      0.9174       9.3900     0.0000    6.8122       10.4103
Constant              -11.9674      4.0363      -2.9600     0.0030  -19.8830       -4.0517
Source                          SS              Degrees of Freedom              MS
Model                       407339.225                   10                  40733.923
Residual                    556311.768                  2055                  270.711
                                    Number of Obs. = 2066
                                      F (10, 2055) = 150.47
                                       P rob. > F = 0.0000
                                           R2 = 0.4227
                                     Adjusted R2 = 0.4199
                                      Root MSE = 16.453
Note: Instruments for years of schooling: quarter of birth dummies, urban status, broken home, number of siblings,
southern residence, mother’s education, father’s education, family income and cohort dummies.
                                              Table 12
Estimates from Instrumental Variables Regression of AFQT Score on Years of Schooling at Test Date
Variable             Coeﬃcient Std. Error          t       P > |t|      95 % ConÞdence Interval
Years of Schooling      4.5164      0.9203      4.9100     0.0000   2.7117           6.3212
Urban Status            0.2174      0.8605      0.2500     0.8010   -1.4702          1.9050
Broken Home            0.8077       0.9823      0.8200     0.4110   -1.1187          2.7341
Number of Siblings     -0.6708      0.2054     -3.2700     0.0010   -1.0735         -0.2680
Southern               -2.8466      0.8705     -3.2700     0.0010   -4.5538         -1.1393
Mother’s Education      2.2952      1.3844      1.6600     0.0970   -0.4197          5.0102
Father’s Education     8.5196       1.3271      6.4200     0.0000   5.9169          11.1223
Family Income           0.1347      0.0310      4.3400     0.0000    0.0739          0.1955
Age                    0.7564       0.5799      1.3000     0.1920   -0.3809          1.8936
In School               9.6624      1.2624      7.6500     0.0000   7.1868          12.1381
Constant              -13.1093      4.1571     -3.1500     0.0020  -21.2619         -4.9567
Source                          SS             Degrees of Freedom                MS
Model                       403614.616                  10                    40361.462
Residual                    560036.378                 2055                    272.524
                                      Number of Obs. = 2066
                                       F (10, 2055) = 114.26
                                        P rob. > F = 0.0000
                                            R2 = 0.4188
                                       Adjusted R2 = 0.4160
                                        Root MSE = 16.508
Note: Instruments for years of schooling: quarter of birth dummies, urban status, broken home, number of siblings,
southern residence, mother’s education, father’s education, family income and cohort dummies
       Figure 1: Actual (Diamond) vs. Predicted (Circle) AFQT Cummulative Distribution Functions Conditional on Schooling at Test Date
                     (a) Ninth Grade or less                                                           (b) Tenth Grade
 1                                                                            1

0.8                                                                         0.8

0.6                                                                         0.6

0.4                                                                         0.4

0.2                                                                         0.2

 0                                                                            0
  20           40          60         80           100     120                 20        40             60         80         100    120
                         (c) Eleventh Grade                                                        (d) High School Graduate
 1                                                                            1

0.8                                                                         0.8

0.6                                                                         0.6

0.4                                                                         0.4

0.2                                                                         0.2

 0                                                                            0
  40      50        60      70      80        90     100   110                 20        40             60         80         100    120
                         (e) Some College                                                            (f) College Graduate
 1                                                                            1

0.8                                                                         0.8

0.6                                                                         0.6

0.4                                                                         0.4

0.2                                                                         0.2

 0                                                                            0
  60           70          80         90           100     110                 85             90             95             100      105
               Figure 2: Estimated Factor (Solid) vs. Residualized AFQT (Dashed) Distributions
0.7




0.6




0.5




0.4




0.3




0.2




0.1




  0
 -2.5   -2   -1.5         -1           -0.5          0            0.5           1           1.5   2   2.5
                     Figure 3: Factor Densities Conditional on Age at Entry by Final Schooling Group
           (a) High School Dropouts                                                     (b) High School Graduates
0.7                                                                  0.7
                                         Normal                                                                     Normal
0.6                                      Behind                      0.6                                            Behind

0.5                                                                  0.5

0.4                                                                  0.4

0.3                                                                  0.3

0.2                                                                  0.2

0.1                                                                  0.1

 0                                                                     0
 -3   -2    -1          0           1     2        3                   -3        -2       -1           0    1       2        3
                        f                                                                              f


                 (c) Some College                                                         (d) College Graduates
0.8                                                                    1
                                         Normal                                                                     Normal
0.7                                      Behind                                                                     Behind
                                                                     0.8
0.6

0.5                                                                  0.6
0.4

0.3                                                                  0.4

0.2
                                                                     0.2
0.1

 0                                                                     0
 -3   -2    -1          0           1     2        3                   -3        -2       -1           0    1       2        3
                        f                                                                              f
                       Figure 4: Estimated Effect of One Additional Year of Age on AFQT Score (With 95% Confidence Bands)
              5



              4



              3



              2



              1
AFQT Points




              0



              -1



              -2



              -3



              -4



              -5
                   9   10              11              12              13             14              15              16    17
                                                               Years of Schooling
                                  Figure 5: Schooling Choice Probabilities as a Function of Residualized AFQT, No Factor
                                                                (a) Normal/Ahead of Peers
                             1

                                                                                     Dropout
                            0.8                                                      HS Grad
                                                                                     Some College
Probability of Choice




                                                                                     College Grad
                            0.6

                            0.4

                            0.2

                             0
                                    10        20        30         40        50       60         70       80        90
                                                        Percentile of Residualized AFQT Distribution

                                                                     (b) Behind Peers
                             1

                                                                                     Dropout
                            0.8                                                      HS Grad
    Probability of Choice




                                                                                     Some College
                                                                                     College Grad
                            0.6

                            0.4

                            0.2

                             0
                                    10        20        30         40        50       60         70       80        90
                                                        Percentile of Residualized AFQT Distribution
                                   Figure 6: Schooling Choice Probabilities as a Function of Factor
                                                       (a) Normal/Ahead of Peers
                         1

                                                                              Dropout
                        0.8                                                   HS Grad
Probability of Choice




                                                                              Some College
                                                                              College Grad
                        0.6

                        0.4

                        0.2

                         0
                              10    20         30        40         50          60      70        80   90
                                                        Percentile of f Distribution

                                                            (b) Behind Peers
                         1

                                                                              Dropout
                        0.8                                                   HS Grad
Probability of Choice




                                                                              Some College
                                                                              College Grad
                        0.6

                        0.4

                        0.2

                         0
                              10    20         30        40         50          60      70        80   90
                                                        Percentile of f Distribution
  Figure 7: Kernel Estimated Densities of Standardized Residualized AFQT Conditional on Schooling
                                       (a) Normal/Ahead of Peers

0.7
           HS Dropout
0.6        HS Graduate
           Some College
0.5        College
0.4
0.3
0.2
0.1
 0
          -3              -2           -1             0               1             2
                                   Standardized Residualized AFQT

                                           (b) Behind Peers

0.7
                                                                                   HS Dropout
0.6                                                                                HS Graduate
                                                                                   Some College
0.5                                                                                College
0.4
0.3
0.2
0.1
 0
          -3              -2           -1             0               1             2
                                   Standardized Residualized AFQT
           Figure 8: Standardized Factor Densities Conditional on Schooling
                              (a) Normal/Ahead of Peers

0.7
                          Dropout
0.6                       HS Grad
                          Some College
0.5                       College Grad
0.4
0.3
0.2
0.1
 0
      -3        -2             -1              0              1                2
                                     Standardized f

                                    (b) Behind Peers

0.7
                                                                              Dropout
0.6                                                                           HS Grad
                                                                              Some College
0.5                                                                           College Grad
0.4
0.3
0.2
0.1
 0
      -3        -2             -1              0              1                2
                                     Standardized f
Figure 9: Marginal Effect of Standard Deviation Increase in Factor on AFQT Components Conditional on Schooling (With 95% Confidence Bands)
                     (a) Word Knowledge                                                      (b) Paragraph Comprehension
   7                                                                      3.5

   6                                                                        3

                                                                          2.5
   5
                                                                            2
   4
                                                                          1.5
   3
                                                                            1

   2                                                                      0.5

   1                                                                        0
       8      10        12         14          16        18                     8       10          12         14          16      18
                      Years of Schooling                                                          Years of Schooling


                    (c) Arithmetic Reasoning                                                     (d) Math Knowledge
   7                                                                        7

 6.5
                                                                            6
   6

 5.5                                                                        5
   5

 4.5                                                                        4

   4
                                                                            3
 3.5

   3                                                                        2
       8      10        12         14          16        18                     8       10          12         14          16      18
                      Years of Schooling                                                          Years of Schooling
Figure 10: Marginal Effect of a Standard Deviation Increase in Latent Ability Factor on Overall AFQT Score Conditional on Schooling Level
                                                       (with 95% Confidence Bands)

                  22




                  20




                  18




                  16
    AFQT Points




                  14




                  12




                  10




                  8




                  6
                       8   9         10           11          12            13         14          15          16           17
                                                             Years of Schooling
                                                                                                 Figure 11: Effect of Schooling on AFQT Score Conditional on Factor
                                                         110
                                                                   Maximum Possible Score

                                                         100
Expected Value of Test Score, Covariates Fixed at Mean




                                                         90



                                                         80



                                                         70



                                                         60


                                                                                                                                                                           2.5th percentile
                                                         50                                                                                                                25th percentile
                                                                                                                                                                           50th percentile
                                                                                                                                                                           75th percentile
                                                                                                                                                                           97.5th percentile
                                                         40



                                                         30



                                                         20
                                                               8             9              10             11            12            13             14              15         16            17
                                                                                                                        Years of Schooling
                          Figure 12: Estimated Annualized School Effects for Person with Average Ability

              12




              10




              8




              6
AFQT Points




              4




              2




              0




              -2




              -4
                10   11                12             13                14            15              16   17
                                                       Years of Schooling
                       Figure 13: Comparison of Control Function and Structural Estimates of Ratios of Factor Loadings
        1.4




        1.2




         1


                                                                                                         Structural model

        0.8



l(ST)
 l(1)   0.6                                                                         Control function, not controlling
                                                                                    for endogenous N or age effects



        0.4
                                                                                               Control function, controlling for
                                                                                               endogenous N only


        0.2




         0
              9   10              11               12              13              14               15                  16         17
                                                           Years of Schooling
                 Figure 14: Comparison of Control Function vs. Structural Estimates of Expected Test Score (f=0)
100



95

                                                          Control function, controlling
90                                                        for endogenous N only



85                                                                                                          Structural model
          Control function, controlling for
          endogenous N and allowing for
80        N-intercept effects (N=Behind)
                                                                            Control function, not controlling
                                                                            for endogenous N or age effects
75



70
                                    Control function, controlling for
                                    endogenous N and allowing for
                                    N-intercept effects (N=Normal/Ahead)
65



60



55



50
      9     10                11              12               13                14               15               16          17
                                                       Years of Schooling
