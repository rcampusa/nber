                              NBER WORKING PAPER SERIES




                PORTFOLIO REBALANCING IN GENERAL EQUILIBRIUM

                                       Miles S. Kimball
                                      Matthew D. Shapiro
                                       Tyler Shumway
                                          Jing Zhang

                                      Working Paper 24722
                              http://www.nber.org/papers/w24722


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     June 2018




We thank seminar participants at Columbia University, the Federal Reserve Bank of Minneapolis,
Utah State University, the University of Windsor, the University of Southern California, the
University of California at San Diego, the University of Michigan, the Bank of Japan, and the
2012 Society for Economic Dynamics meeting for helpful comments. We are grateful for the
financial support provided by National Institute on Aging grant 2-P01-AG026571. The views
expressed here are those of the authors and do not necessarily represent those of the Federal
Reserve Bank of Chicago, the Federal Reserve System, or its Board of Governors. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Miles S. Kimball, Matthew D. Shapiro, Tyler Shumway, and Jing Zhang. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Portfolio Rebalancing in General Equilibrium
Miles S. Kimball, Matthew D. Shapiro, Tyler Shumway, and Jing Zhang
NBER Working Paper No. 24722
June 2018
JEL No. D53,E44,G11

                                         ABSTRACT

This paper develops an overlapping generations model of optimal rebalancing where agents differ
in age and risk tolerance. Equilibrium rebalancing is driven by a leverage effect that influences
levered and unlevered agents in opposite directions, an aggregate risk tolerance effect that
depends on the distribution of wealth, and an intertemporal hedging effect. After a negative
macroeconomic shock, relatively risk tolerant investors sell risky assets while more risk averse
investors buy them. Owing to interactions of leverage and changing wealth, however, all agents
have higher exposure to aggregate risk after a negative macroeconomic shock and lower exposure
after a positive shock.

Miles S. Kimball                                Tyler Shumway
Department of Economics                         Ross School of Business
University of Colorado                          University of Michigan
256 UCB                                         701 Tappan Street
Boulder, CO 80309                               Ann Arbor, MI 48109-1234
and NBER                                        shumway@umich.edu
miles.kimball@colorado.edu
                                                Jing Zhang
Matthew D. Shapiro                              Research Department
Department of Economics                         Federal Reserve Bank of Chicago
University of Michigan                          230 S LaSalle Street
611 Tappan St                                   Chicago, IL 60604
Ann Arbor, MI 48109-1220                        Jing.Zhang@chi.frb.org
and NBER
shapiro@umich.edu
1     Introduction

Understanding how different people trade in response to large market movements, or how

they rebalance their portfolios, is central to finance and macroeconomics. Studying rebalanc-

ing in a meaningful way requires a model that incorporates investor heterogeneity because,

if all investors are identical, then all will hold the same portfolio and there will be no trade.

We study optimal rebalancing behavior with a simple general equilibrium overlapping gen-

erations model that features heterogeneity in both age and risk tolerance. The model is

focused on asset allocation, with one risky asset in fixed supply and a risk-free asset in zero

net supply. We find that both general equilibrium and lifecycle considerations have large

effects on optimal rebalancing and thus should be inherent parts of asset allocation mod-

els. Optimal rebalancing is fairly complex, with trading driven by leverage, aggregate risk

tolerance, and intertemporal hedging effects.

    Understanding the effects that drive optimal rebalancing behavior is particularly impor-

tant for two reasons. First, as more empirical work is done on the rebalancing behavior of

individuals it is important to have a benchmark for equilibrium behavior in an economy in

which investors behave optimally. While our model is quite simple, it helps to provide such

a benchmark. Second, to meet the needs of investors with different horizons and preferences,

the mutual fund industry has created a number of products called “lifecycle” or “target-

date” funds that are designed to serve as the whole portfolio for a large group of investors

over their lifespans. To the extent that these funds follow simple linear rules of thumb for

allocating assets across time, their allocations will be both suboptimal and generally infea-


                                                1
sible if universally adhered to because simple rules ignore general equilibrium constraints.

Our model helps to illustrate how “universal target-date” funds can be structured. Universal

target-date funds follow an optimal strategy over time and are feasible in general equilibrium.

       Empirical work on observed rebalancing is still relatively rare. Its primary finding is that

most investors appear to display inertia in their asset allocations.1 To motivate our analysis

along these lines, we plot nonparametric estimates of stock share as a function of age from

three waves of the Survey of Consumer Finances around the recent financial crisis. The left

panel of Figure 1 depicts stock shares in the 2004 and 2007 waves, between which stock

prices rose about 30 percent. The right panel covers 2007 and 2010, between which prices

fell about 28 percent. Both plots also give the “passive” share implied by market returns

and initial shares. Average rebalancing by age is therefore given by the difference between

the passive curve and the actual curve for the second wave in each plot.2

       Several interesting features are immediately apparent when looking at the plots. First,

older investors have consistently higher stock shares in these data, which may be due to

cohort effects such as those described in Malmendier and Nagel (2011). Second, there is

substantial rebalancing in the data. While many individual investors may display inertia

in their asset allocations, in aggregate investors do appear to react to market movements.

Third, most age groups do not simply revert to their initial share. Rather, older investors,
   1
      Calvet, Campbell and Sodini (2009) use four years of Swedish data to show that households only par-
tially rebalance their portfolios, or they only partially reverse the passive changes in their asset allocations.
Brunnermeier and Nagel (2008) find similar results using data from the Panel Study of Income Dynamics.
    2
      The curves are estimated with simple nonparametric regressions using Epanechnikov kernels. The passive
curves are plotted assuming the stock returns reported in the text and total average non-stock returns of 6%
between 2004 and 2007 and 4% between 2007 and 2010. To be included in the sample each individual must
report at least $10,000 of financial wealth and some positive stock holding. There are 1389, 1260, and 1313
observations in 2004, 2007 and 2010, respectively.


                                                       2
                                                      Figure 1: Rebalancing, SCF Data
                   .4




                                                                                             .4
                                                              2007




                                                                                             .35
                   .35




                                                                                                                                2007




                                                                               Stock Share
     Stock Share




                                                                                             .3
                                                               2004
                   .3




                               Passive Implied 2007                                                                             2010




                                                                                             .25
                   .25




                                                                                             .2
                                                                                                                         Passive Implied 2010




                                                                                             .15
                   .2




                         20            40              60             80                           20         40          60                    80
                                                Age                                                                Age

                              (a) From 2004 to 2007                                                     (b) From 2007 to 2010



who on average hold more stock to begin with, buy more stock than required to return to

their initial positions when the market rises. They also sell more stock than required to

return to their initial position when the market falls. Younger investors display the opposite

pattern, selling more than required to return to their initial position when prices rise, and

buying shares as markets fall. In other words, rather than the stock share by age function

either reverting back to the initial share or shifting to the passive share, it appears to pivot

in each wave. While our model will not capture every feature of these plots, it highlights the

importance of the general equilibrium constraints that the plots suggest, and it allows older

investors to behave differently than younger investors, as they appear to do in the data.

   Though our model is intentionally simple, it sheds light on the counter-intuitive implica-

tions of general equilibrium. Our first set of implications is for the direction of rebalancing

in equilibrium. We show that after a negative macroeconomic (and return) shock, more risk

averse investors buy risky assets while less risk averse investors sell. After a positive shock the

opposite happens. This finding is consistent with the pivots in the plots above. Our second


                                                                           3
set of implications is for portfolio shares in equilibrium. After a negative shock all investors

hold a higher risky asset share than they held before the shock. Risk tolerant investors hold

levered positions that makes their risky asset share rise when prices fall. However, falling

prices reduce their relative wealth, so aggregate risk tolerance falls and expected returns rise.

Because expected returns are higher after prices fall, agents’ desired risky asset shares after

a negative shock are higher than before the shock. Thus, while the risk tolerant investors

sell shares after a negative shock, their selling only partially offsets the increase in their risky

asset shares. Again, after a positive shock the opposite happens. Finally, we show that the

effect of intertemporal hedging is quite small in our general equilibrium setting.

    Section 2 describes intuitively the three effects that drive our equilibrium outcomes: the

leverage, aggregate risk tolerance, and intertemporal hedging effects. Section 3 discusses

how our work relates to other research. In Section 4 we describe the overlapping generations

model in detail. The model has a partially closed-form solution, which makes the intuition

more transparent and substantially eases the solution of the model. Section 5 presents our

quantitative solution of the model. Section 6 presents our conclusions.




2     Preview

Most of the earliest models of asset allocation in general equilibrium feature homogeneous

agents, with the implication that agents will never trade or rebalance, as in Lucas (1978).

We refer to such an implication as the buy and hold rule. Other models, when considered

in partial equilibrium, imply that agents should always revert to their initial stock share, as


                                                 4
in Merton (1971). We refer to this implication as the constant share rule. Optimal portfolio

rebalancing deviates from these two very different rules for at least three reasons in our

model and more generally. First, there is a leverage effect. Since the risk-free asset is in zero

net supply in our model, there will always be some investors that hold a levered position in

the risky asset. For those with a levered position, their passive risky asset share actually

declines as the market rises, and vice versa. Levered investors need to buy when the market

rises and sell when it falls in order to keep their risky-asset shares constant, which is the

opposite of standard rebalancing advice. Second, there is an aggregate risk tolerance effect.

As the wealth of different types of agents shifts, aggregate risk tolerance also shifts, which in

turn affects equilibrium prices and expected returns. Movements in aggregate risk tolerance

induce people to trade in response to market movements in a way that does not maintain a

constant share. In our specification, the aggregate risk tolerance effect is substantial. Third,

there is an intertemporal hedging effect. Since future expected returns are time-varying,

young agents have an incentive to hedge changes in their investment opportunities when

they are middle aged. In principle, intertemporal hedging can have a significant effect on

asset demand, but for reasons we will explain, in our specification it is quite difficult to

generate enough mean reversion in asset returns to generate a substantial intertemporal

hedging effect. We discuss hedging in Section 4.

   A simple example can help clarify the leverage effect. Suppose an investor wants to

maintain a levered portfolio with a share of 200% in the risky asset. With a $100 stake to

begin with, the investor borrows $100 to add to that stake and buys $200 worth of the risky



                                               5
asset. If the risky asset suddenly doubles in value, the investor then has $400 worth of the

risky asset and an unchanged $100 of debt, for a net financial wealth of $300. The constant

share rule generally has investors sell assets when their prices rise. After this increase in

the price of the risky asset, however, the share of the investor’s net financial wealth in the

risky asset is only 400/300 = 133%, since the investor’s net financial wealth has risen even

more than the value of the risky asset. Therefore, if the goal is to maintain a 200% risky

asset share, the investor needs to borrow more to buy additional shares. Hence, levered

investors rebalance in a direction that is the opposite of unlevered investors. The general

equilibrium constraint that each buyer must trade with a seller is partially met by having

levered investors trade with unlevered investors.

   The aggregate risk tolerance effect is a consequence of general equilibrium adding up.

It arises because the share of the risky asset held by an individual is a function of that

individual’s risk tolerance relative to aggregate risk tolerance; and aggregate risk tolerance

must move in general equilibrium when there are shocks that affect the distribution of wealth.

We will now show that this feature of general equilibrium makes it impossible for all investors

to maintain a constant portfolio share. Returns adjust to make people willing to adjust their

portfolio shares in a way that allows the adding-up constraint to be satisfied.

   To see this, consider the aggregation of an economy characterized by individuals who

have portfolio shares determined as in Merton (1971). That is, an individual i’s share of

investable wealth Wi held in the risky asset would be


                                             P Si     S
                                      θi ≡        = τi ,                                   (1)
                                             Wi       σ

                                               6
where P is the price of the risky asset and Si is the amount of the risky asset. The only

heterogeneity across individuals here comes from individual risk tolerance τi and the only

heterogeneity over time comes from a time-varying expected Sharpe ratio (expected excess

return over volatility) S or from volatility σ. After aggregating this expression and imposing

adding up constraints, we can derive an expression for the risky asset share that does not

depend on the distribution of the asset’s return:

                                                     "        #−1
                                                      X Wi τi            τi
                                           θi = τi                   =      ,                                 (2)
                                                         i
                                                             W           T


                      Wi τi
                              is aggregate risk tolerance.3
              P
where T =         i    W


    This equation implies that neither the buy and hold rule nor the constant share rule

makes sense in general equilibrium. As prices change, wealth effects cause aggregate risk

tolerance to change. This induces rebalancing for all types of investors. This result also

appears in Dumas (1989), Wang (1996), and other papers. In our model we make precise

the exact nature of this rebalancing.
   3
     Recall that the risk free asset is in zero net supply, so the total value of all investable wealth must equal
the total value of the risky asset. Multiplying (1) through by each type’s wealth and aggregating across
types yields                                                "          #
                                   X             X            X          S
                                        θi Wi =      P Si =      Wi τi     = W.                                (3)
                                                                         σ
                                       i             i           i

Dividing equation (3) through by aggregate wealth and comparing the resulting expression to equation (1)
allow us to derive (2)




                                                             7
3     Relation to the Literature

There is a great deal of research about asset allocation and portfolio choice in finance and

economics. These topics have become particularly interesting recently as economists have

begun to study household finance in detail following Campbell (2006). Three papers that

discuss optimal trading behavior are Dumas (1989), Longstaff and Wang (2012), and Wang

(1996). Dumas (1989) solves for the equilibrium wealth sharing rule in a dynamic equilibrium

model with more and less risk tolerant investors. This paper nicely illustrates the importance

of the distribution of wealth as a state variable. Longstaff and Wang (2012) discuss the

leverage effect that we describe. Like our model, these papers find that more risk tolerant

investors sell after negative market returns while less risk tolerant investors buy. All three of

these papers feature continuous time models, in which prices evolve according to Brownian

motion processes and agents trade continuously. As Longstaff and Wang (2012) explain,

more risk tolerant investors trade in a dynamic way to create long positions in call options,

while less risk tolerant investors create short call positions. As we discuss below, that paper’s

main contribution is about the size of the credit market. Dumas (1989) shows that more risk

tolerant investors would like to hold perpetual call options. Since investors are continuously

hedging to create options positions, these models generally imply infinite trading volume.

Our model differs from these by featuring lifecycle effects, discrete time, and relatively large

price movements, which will be more realistic for many investors. None of these papers

focuses on rebalancing behavior.

    Two papers that show how optimal portfolio choice changes when some of the assumptions


                                               8
of classic models are weakened are Liu (2007) and Kim and Omberg (1996). Kim and Omberg

(1996) show that optimal behavior can be quite complex when investors are not myopic,

with some investors hedging while others speculate. Liu (2007) shows that the properties of

dynamic portfolio choice models can be quite different from those of static choice models.

   Relatively little of the research on portfolio choice, however, considers the general equi-

librium constraints that we apply in our model. Three recent papers that feature general

equilibrium are Cochrane, Longstaff, and Santa-Clara (2008), Garleanu and Panageas (2015),

and Chan and Kogan (2002). Cochrane, Longstaff, and Santa-Clara (2008) has heteroge-

neous assets rather than heterogeneous agents, so it is not about trade. Garleanu and

Panageas (2015), like our paper, models investor heterogeneity in risk preference and age

in an overlapping generations model. Chan and Kogan (2002) examines the aggregate risk

tolerance effect in detail. All of these papers focus on the behavior of asset prices, showing

that general equilibrium can generate return predictability that is consistent with empirical

evidence. None of these papers explores the implications of market returns for either trading

or the portfolio choice of different types of individuals, which is the focus of our paper.

   The focus of our paper is much closer to the focus of Campbell and Viceira (2002). They

find an important intertemporal hedging component of portfolio choice. In our model the

leverage effect and the time-varying aggregate risk tolerance effect are much more important.

The intertemporal hedging effect in our model is intentionally weak because we do not build

in features that might lead to hedging such as mean reversion in fundamentals or noise

traders. We have experimented with several different sets of parameter values to see if we



                                               9
can make the intertemporal hedging effect larger in our context, but we have not been able

to find a scenario in which it matters very much. Approaches such as Campbell and Viceira

that use actual asset returns, which might reflect mispricing, have greater scope for finding

intertemporal hedging.

   There is a large and important literature about labor income risk and portfolio choice, in-

cluding Bodie, Merton, and Samuelson (1992), Jaganathan and Kocherlakota (1996), Cocco,

Gomes, and Maenhout (2005), and Gomes and Michaelides (2005). In a recent paper that

is related to our work, Glover, Heathcote, Krueger, and Rios-Rull (2014) find that young

people can benefit from severe recessions if old people are forced to sell assets to finance

their consumption, causing market prices to fall more than wages. We purposely abstract

from human capital considerations by assuming that agents only earn labor income before

they have an opportunity to rebalance. Our aim is thus to focus on the general equilibrium

effects while suppressing the important, but complex effects of human capital.

   The leverage effect that we find is of course related to the effect discussed by Black (1976).

Geanakoplos (2010) has recently developed a model emphasizing how shocks to valuation

shift aggregate risk tolerance. Risk tolerant investors, who take highly levered risky positions,

may go bankrupt after bad shocks, thereby decreasing aggregate risk tolerance and further

depressing prices. This analysis hence features both the leverage and aggregate risk tolerance

effects. The details of his model are quite different from ours. Moreover, the focus of his

analysis is defaults, which will not occur in our setting. Nevertheless, both his model and

our model feature time varying aggregate risk tolerance driven by changes in the distribution



                                               10
of wealth.

       As mentioned in the introduction, Calvet, Campbell, and Sodini (2009) and Brunner-

meier and Nagel (2008) examine portfolio rebalancing with administrative holdings data

and survey data, respectively. Both papers find that people do not completely rebalance,

or that investors do not completely reverse the passive changes in their asset allocations.

This finding is consistent with optimal rebalancing according to our model. Moreover, the

leverage effect implies that investors with high initial shares will change their allocations in

the opposite direction from that predicted by full rebalancing, or, in other words, that risk

tolerant investors will chase returns. In fact, regressions in the online appendix of Calvet,

Campbell, and Sodini (2009) indicate that the coefficients on passive changes in allocation

are increasing in initial stock share. This is exactly what we would expect to find.4

       When academic researchers think about asset allocation, they generally include all risky

assets (including all types of corporate bonds) in their definition of the risky mutual fund

that all investors should hold. In our model, regardless of how one might divide assets into

safe or risky categories, we define the “risky asset” or the “tree” to be the set of all assets

in positive net supply. We define the risk-free asset to be in zero net supply. The levered

position in trees in our model encompasses both stock holdings and the risky part of the

corporate bonds.

       By contrast, when practitioners think about portfolio choice they generally treat stocks,

bonds, and cash-like securities as separate asset categories in their allocation and rebalancing
   4
    Since Calvet, Campbell, and Sodini (2009) have detailed data on investors’ actual holdings and returns,
some portion of the returns their investors experience are idiosyncratic. This rationalizes the fact that the
coefficients in the online appendix of Calvet, Campbell, and Sodini (2009) increase in initial share but they
do not become positive for investors with high initial shares.


                                                     11
recommendations, as Canner, Mankiw, and Weil (1997) point out. To understand the size

of the leverage effect, it is important to remember that stock is a levered investment in

underlying assets. Thus, for example, if the corporate sector is financed 60% by stock and

40% by debt, an investor with more than 60% in stock is actually levered relative to the

economy as a whole. If some corporate debt can be considered essentially risk-free then it

should be possible to express such an investor’s position as a portfolio of a levered position in

the underlying assets of the economy and some borrowing at the risk-free rate. The leverage

effect will be important for all investors that hold a levered position in the underlying assets

of the economy—which is everyone who has an above-average degree of leverage (though

typically not everyone who has an above-median degree of leverage).




4     Model

We include in the model only the complications necessary to study rebalancing meaningfully.

The economy has an infinite horizon and overlapping generations. There is heterogeneity in

preferences to generate trade within generations. Specifically, there are two types of agents

with different degrees of risk tolerance. The level of risk tolerance is randomly assigned

at the beginning of the agent’s life and remains unchanged throughout life. Each agent

lives for three equal periods: young (Y ), middle-aged (M ), and old (O). Agents work in a

representative firm and receive labor income when they are young and live off their savings

when they are middle-aged and old. All agents start life with zero wealth and do not leave

assets to future generations; that is, they have no bequest motive. There is no population


                                               12
growth, so there is always an equal mass across the three cohorts. In this section, we provide

the details of how we model and specify the technology, the asset markets, and the agents’

preferences and their resulting decision problems.



4.1       Technology and Production

Our setup has a character very similar to that of an endowment economy. There is a

fixed supply of productive assets or “trees.” Hence, we have a Lucas (1978) endowment

economy, though unlike Lucas, we will have trade because not all agents are identical, and

the endowment includes labor as well as “trees.” The young supply labor inelastically. Trees,

combined with labor, produce output that is divided into labor income and dividend income.

The labor income stream serves to provide resources to each generation. The dividend income

provides a return to risky saving. This setup allows us to provide resources to each generation

without inheritance. As noted above, by providing labor income only at the start of the life,

we intentionally abstract from the interaction of human capital with the demand for risky

assets.

   The production function is Cobb-Douglas,


                                            1
                                     Yt =     Dt Ktα Lt1−α ,                                  (4)
                                            α


where Kt is the fixed quantity of trees, Lt is labor, α is capital’s share in production, and

Dt is the stochastic level of technology. We normalize the quantity of trees Kt to be one.

                                                                                      Dt
The quantity of labor is also normalized to be one. Therefore, total output is Yt =   α
                                                                                         ,   total


                                               13
                  (1−α)Dt
labor income is      α
                          ,   and total dividend income is Dt . That is, given our normalization

total dividends equal the stochastic level of technology. All labor income goes to the young,

since they are the only ones supplying labor. Dividend income will be distributed to the

middle-aged and old agents depending on their holdings of the risky tree.

     In order not to build in mean reversion mechanically, we assume that the shock to divi-

dends Gt+1 is i.i.d, so

                                           Dt+1 = Dt Gt+1 .                                  (5)


In our calculations, we parameterize the dividend growth as having finite support {Gn }N
                                                                                       n=1 ,


where Gn occurs with probability πn each period. The dividend growth shocks are realized

at the beginning of each period before any decisions are made.



4.2     Assets

Before turning to agents’ decision problems, it is helpful to define assets and returns. In our

economy, there are two assets available to agents: one risk-free discount bond and one risky

tree security. The risk-free bond is in zero net supply, and the risky tree has a fixed supply

of one. We parameterize the dividend growth process to have two states. These two assets

provide a complete market.

     One unit of a bond purchased at period t pays 1 unit of consumption in period t + 1

regardless of the state of the economy then. A bond purchased at time t has a price of 1/Rt ,

so
                                                                      1
                     Rt = the gross risk-free interest rate =                 .              (6)
                                                                price of bond

                                                 14
One unit of the tree has a price Pt in period t and pays Dt+1 + Pt+1 if sold in period t + 1.

Thus, the gross tree return is
                                                   Pt+1 + Dt+1
                                         RTree
                                          t    =               ,                                  (7)
                                                        Pt

and the excess tree return is
                                                   Pt+1 + Dt+1
                                         Zt+1 =                .                                  (8)
                                                      Pt Rt


4.3     Agents’ Decision Problems

Since this paper focuses on asset allocation, we specify preferences so that there is meaningful

heterogeneity in risk tolerance, but the consumption-saving tradeoff is simple. We use the

Epstein-Zin-Weil preferences with a unit elasticity of intertemporal substitution (Epstein

                                                                                                 1
and Zin 1989, Weil 1990). The utility of agents born in date t with risk tolerance τj =          γj
                                                                                                      is

given by


                   1 − ρY
 ρY ln(CYj t ) +                                    j                             j      1−γj
                                                                                              
                          ln Et exp (1 − γj )ρM ln(CM t+1 ) + (1 − ρM ) ln Et+1 (COt+2 )         , (9)
                   1 − γj


where CYj t , CM,t+1
               j          j
                     and CO,t+2 denote consumption at young, middle, and old ages, and ρY

and ρM govern time preference when young and when middle-aged. The parameters ρY and

ρM will turn out to be the average propensities to consume. With an underlying discount

rate equal to δ, we have
                                                       1
                                           ρY =                                                  (10)
                                                   1 + δ + δ2




                                                    15
and
                                                1
                                        ρM =       .                                   (11)
                                               1+δ

The degree of risk tolerance can be either high (j = H) or low (j = L). Because this utility

has a recursive form, we work backwards.


Old Agents


The problem for old agents at date t is trivial. They simply consume all of their wealth,
                                 j                                      j
so total consumption of the old COt equals the total wealth of the old WOt . Note that

capitalized W denotes wealth per person.


Middle-aged Agents


A middle-aged agent at date t chooses consumption when middle-aged and a probability

distribution of consumption when old by choosing bond holding BM t and tree holding SM t

to maximize intertemporal utility


                                                                         1
                             j                         j      1−γj
                                                                      1−γ
                      ρM ln(CM t ) + (1 − ρM ) ln Et (COt+1 )
                                                                         j   ,         (12)



subject to the budget constraints


                              j      j             j      j
                             CM t + BM t /Rt + Pt SM t = WM t ,                        (13)


                         j       j       j      j
                        COt+1 = WOt+1 = BM t + SM t (Pt+1 + Dt+1 ).                    (14)


                                              16
Recall that the middle-aged agents have no labor income, so they must live off of their wealth
 j
WM t.


     Consider the portfolio allocation of this middle-aged agent where θ is the share of savings

(invested wealth) in the risky asset. The optimal portfolio decision is given by


                                                                               1
                       j                                      1−γj          1−γj
                      θM t = arg max Et {(1 − θ)Rt + θRt Zt+1 }                       .    (15)
                                    θ∈Θ




It is convenient to define the certainty equivalent total return


                                n                                            1
                                                                          o 1−γ
                                                                   1−γj
                       φjM t              j
                               = Et (1 − θM          j
                                            t )Rt + θM t Rt Zt+1
                                                                              j
                                                                                  .        (16)



Given the homotheticity of preferences and the absence of labor income after youth, the
                         j                j
optimal portfolio share θM t that yields φM t also maximizes expected utility from consumption


when old. Thus, the middle-aged agent’s problem is equivalent to solving the following

decision problem:


                                                                                             1
            j                  j    j
                                                     Et {(1 − θ)Rt + θRt Zt+1 }1−γj
                                                                                          1−γj
 max ρM ln(CM t )+(1−ρM ) ln(WMt −C Mt )+(1−ρM ) ln                                               ,
 j
CM t ,θ∈Θ

                                                                                           (17)

which has the familiar special structure found with an intertemporal elasticity of substitution
                                                        j                                    j
equal to one. Since only the first two terms depend on CM t , the first order condition for CM t


is
                                          ρM     1 − ρM
                                           j
                                               = j      j
                                                            ,                              (18)
                                          CM t  WM t − CM t




                                                  17
which has the solution
                                             j         j
                                            CM t = ρM WM t .                               (19)


That is, log utility in the intertemporal dimension leads to a simple consumption function

and makes saving and portfolio choices independent. Thus, the maximized utility of the

middle aged is given by



                VMj t(WM
                       j                  j                             j   j
                                                                              
                         t ) = ρM ln(ρM WMt ) + (1 − ρM ) ln (1 − ρM )WMt Mt .
                                                                          φ                (20)


               j                      j              j                         j
Bond holdings BM t are given by (1 − θM t )(1 − ρM )WM t Rt and tree holdings SM t are given

    j             j
by θM t (1 − ρM )WM t /Pt .



Young Agents


With no initial wealth, the young have only their labor income for consumption and saving.

Labor income of both types of young agent in period t is



                                     WYj t = WY t = (1 − α)Dt /α.                          (21)



A young agent of type j decides on consumption and bond and tree holdings (BYj t , SYj t ) (that
                                       j
together determine middle-aged wealth WM,t+1 ) to maximize the utility


                                     1 − ρY
                   ρY ln(CYj t ) +                              j       j        
                                            ln Et exp((1 − γj )VM,t+1 (WM,t+1 ))           (22)
                                     1 − γj




                                                   18
subject to the budget constraints



                                       CYj t + BYj t /Rt + Pt SYj t = WYj t                             (23)



and
                                     j
                                    WM,t+1 = BYj t + SYj t(Pt+1 + Dt+1 ).                               (24)


   Substituting the maximized middle-aged utility given by equation (20) into (22) yields

the following decision problem for a young agent:



         max             ρY ln(CYj t ) + (1 − ρY ) ln(WYj t − CYj t)                                    (25)
        CYj t ,θ∈Θ
                                         n                                                      1 o
                                              Et (1 − θ)Rt + θRt Zt+1 )(φjM,t+1)1−ρM
                                                                                        1−γ  1−γ
                         +(1 − ρY ) ln                                                      j       j




                         +(1 − ρY ) [ρM ln(ρM ) + (1 − ρM ) ln(1 − ρM )] .



Only the first two terms depend on CYj t . Again because of log utility, optimal consumption

is very simple. It is given by

                                                  CYj t = ρY WYj t.                                     (26)


Since only the third term of equation (25) depends on θ, the optimal tree portfolio share θYj t

for the young maximizes the certainty equivalent, time-aggregated total return function for

the young, φjY t . That is,


                                 n                                                         1
                                                                                        o 1−γ
                                                                                 1−γj
                θYj t   = arg max Et [(1 − θ)Rt + θRt Zt+1 ](φjM,t+1)1−ρM                       j
                                                                                                        (27)
                              θ∈Θ




                                                         19
and
                        n                                                                      1
                                                                                            o 1−γ
                                                                                     1−γj
               φjY t   = Et [(1 − θYj t)Rt + θYj t Rt Zt+1 ](φjM,t+1)1−ρM                       j
                                                                                                    .   (28)


Comparing the middle-aged portfolio problem in (16) with the young portfolio problem

in (28), we find that the young solve a more complicated problem given their longer life

span. Middle-aged agents with only one more period of life simply maximize the certainty

equivalent return of their portfolio investment next period, as in equation (16). Young agents

with two more periods to live need to pay attention to the covariance between portfolio

returns from youth to middle-age and the certainty equivalent of the returns going forward

beyond middle age.


Value of a Universal Target-Date Fund as Numeraire


Since future expected returns are time-varying, the multi-period decision problem of the

young creates an opportunity for intertemporal hedging (Merton 1973). To sharpen the

interpretation of intertemporal hedging, define


                                                              1
                              QjM,t+1 =                                          ,                      (29)
                                          ρρMM (1   −   ρM )1−ρM (φjM,t+1)1−ρM


which prices the variable annuity or “universal target date fund” for a given age and risk

aversion. It yields, at lowest cost, a lifetime utility equal to the lifetime utility from one

unit of consumption at period t + 1 and one unit of consumption at period t + 2. That is,

the agent will be indifferent between being limited to consuming one unit of consumption




                                                        20
at both middle and old age and having wealth of QjM,t+1 to deploy optimally.5 The sense in

which the universal target date fund is “universal” is that it remains the optimal thing to do

even if everyone else has a universal target date fund in equilibrium. Given this definition

of the universal target date fund, equation (28) can be rewritten as follows:

                                               (                                1
                                                                       )1−γj  1−γ j
                                                 (1 − θ)Rt + θRt Zt+1       
             φjY t      −ρM
                     = ρM (1 − ρM ) ρM −1
                                          max Et                                     .                       (30)
                                          θ∈Θ           QjM,t+1             


Thus, a young agent maximizes the simple certainty equivalent of his or her portfolio’s return

relative to the return on the universal target date fund. In other words, this universal target

date fund paying out in periods t + 1 and t + 2 serves as a numeraire for returns from t to

t + 1.6
   5
     To see this, note that by (12), consumption of one at both middle and old age yields a lifetime utility of
zero for the middle-aged agent. Unit middle-aged holdings of QM,t+1 must therefore make the middle-aged
lifetime utility given by (17) equal to zero once the optimal consumption and portfolio share are substituted
in, so
                 ρM ln(ρM QjM,t+1 ) + (1 − ρM ) ln((1 − ρM )QjM,t+1 ) + (1 − ρM ) ln(φjM,t+1 ) = 0.

The value of QjM,t+1 given in (29) is the solution to this equation. The universal target date fund itself
implicitly replicates the optimal portfolio strategy for the agent.
   6
     Note that, because of its definition as the amount of wealth yielding lifetime utility equal to the lifetime
utility from consumption constant at one, equation (20) can be rewritten
                                        j     j           j           j
                                       VM t (WM t ) = ln(WM t ) − ln(QM t ).

Defining the corresponding price of the universal target date fund in youth that can give lifetime utility
equivalent to the lifetime utility of one unit of consumption in each of the three periods of life, [QjY t ]−1 =
ρρYY (1 −ρY )1−ρY [ρρMM (1 −ρM )1−ρM ]1−ρY (φjY t )1−ρY , the maximized utility for a young agent that results from
substituting in the optimal decisions can be similarly written as

                                        VYj t (WYj t ) = ln(WYj t ) − ln(QjY t ).

Thus, the price of the universal target-date fund fully captures the dependence of the value function on the
investment opportunity set. Note that, unless γ = 1, wealth and Q are no longer additively separable after
the application of the appropriate curvature for risk preferences.




                                                          21
4.4     Market Clearing

In our economy, the safe discount bonds are in zero net supply, and the risky tree has an

inelastic supply normalized to one. We now substitute the asset demands we derived in the

previous subsection into the asset market clearing conditions. Recall that the individual-level

risky tree (S) and safe bond (B) demands of the young are given by SYj t = (1−ρY )WYj t θYj t/Pt

and BYj t = (1 − ρY )WYj t Rt (1 − θYj t). The asset demands of the middle-aged are given by
 j               j    j            j               j         j
SM t = (1 − ρM )WM t θM t /Pt and BM t = (1 − ρM )WM t (1 − θM t )Rt . The old have no asset


demand. Summing over the type j and the generations, the asset market clearing conditions

can be written as


                             1 X                  j    j               j j 
                     1=               ψj (1 − ρM )WM t θM t + (1 − ρY )WY t θY t           (31)
                             Pt j=H,L


and
                      X                  j          j                 j        j
                                                                                     
                0=           ψj (1 − ρM )WM t (1 − θ Mt ) + (1 − ρY )WYt (1 − θ Yt )   ,   (32)
                     j=H,L


where

                         ψj = the constant fraction of agents of type j.


Note that Rt is determined implicitly in equation (32) because the θ are functions of Rt .

   In addition to the asset market clearing conditions, the goods market clearing condition

is also instructive. It is


                     Dt   ρY (1 − α)Dt           H         L
                        =              + ρM (ψH WM t + ψL WM t ) + WOt ,                   (33)
                     α          α

                                                   22
where the wealth level of the old WOt is given by the sum across the two types. Note that

the propensity to consume out of wealth is 1 for the old, so there is no parameter multiplying

WOt . Since the asset demands for old agents are equal to zero regardless of the level of risk

aversion, we do not need to keep track separately of the wealth of each old group.

   The total financial wealth of the economy is the sum of the value of the tree Pt and the

dividend Dt , since the risk-free asset is in zero net supply. At the beginning of the period

all financial wealth is held by the middle-aged and the old. Hence, the total wealth of the

old is

                                                  H         L
                              WOt = Pt + Dt − ψH WM t − ψL WM t .                        (34)


Substituting this expression into equation (33) and solving for Pt gives rise to an equation

for Pt based only on contemporaneous variables:


                                     1−α                    H         L
                    Pt = (1 − ρY )       Dt + (1 − ρM )(ψH WM t + ψL WM t ).             (35)
                                      α


The right-hand side of (35) can be interpreted simply as the sum of savings supplies, and

therefore total asset demands, of the young and middle aged, determined by their propensities

to save and initial levels of wealth.

   Normalizing all the variables in the above equation by dividend Dt gives the expression

for the price-dividend ratio pt ,


                                       1−α                 H         L
                      pt = (1 − ρY )       + (1 − ρM )(ψH wM t + ψL wM t ),              (36)
                                        α



                                                 23
where lower case letters denote the corresponding variables divided by the dividend Dt .

Thus, the price-dividend ratio pt is linear in the total (per-dividend) middle-aged wealth

     H        L
ψ H wM t + ψLwM t . The first term on the right-hand side of (36) corresponds to the demand


for saving of the young, which is a constant share of dividends and is therefore a constant

in the per-dividend expression.

   Having an analytic expression for the price-dividend ratio both adds transparency to our

analysis and simplifies the solution of the model. Analytic expressions for portfolio shares

and expected returns for the risky and risk-free assets are not available. In Section 5, we

will turn to numerical solutions of the model. Unlike the price-dividend ratio, which only

depends on total middle-aged wealth, portfolio shares and expected returns will depend on

the distribution of wealth among the middle-aged agents. This distribution depends on the

history of shocks. For example, as we will discuss explicitly in Section 5, a good dividend

growth shock raises the share of wealth held by the middle-aged risk-tolerant agents who

invested heavily in the risky asset when young. This increased wealth share of the risk-

tolerant agents in turn affects asset demands and expected returns.



4.5     Equilibrium Solution

4.5.1   State Variables


Consider the state variable vector at the moment prices are determined. At that moment,

the wealth of each group of agents is known. Because all preferences are recursive, nothing

from the past directly enters into the preferences induced over actions now and in the fu-



                                            24
ture. The sum of human wealth and non-human wealth for each agent, together with the

stochastic process for returns from that moment on fully determines what actions maximize

an agent’s utility. Each agent’s decision problem has a perfect scale symmetry because of the

homotheticity of preferences together with linear budget constraints. This scale symmetry

aggregates perfectly. Thus, only wealth relative to Dt matters for behavior. Furthermore,

the scale symmetry means that behavior can be smoothly aggregated across agents within

a type, so that, in effect, there is a representative agent of each type. Thus, despite the

complexity of the agents’ asset allocation choices (particularly the choices of the young, who

have to worry about intertemporal hedging), the set of possible equilibria is determined en-

tirely by forward-looking considerations. These decisions are conditioned on the wealth of

each type at that moment when prices and therefore pre-consumption wealth are known.

   These considerations indicate that the dynamic stochastic equilibrium from any point on

only needs to be a function of the vector of normalized wealth levels for each type of agent.

(Recall that the normalization is dividing through by the dividend, D.) What is less obvious

is that, once all old agents are considered as belonging to one type, since their risk aversion

no longer matters for their behavior, the vector of possible normalized wealth levels spans

only a two-dimensional space. For convenience, represent a point on this two-dimensional

space by the normalized wealth of the daring and cautious middle-aged agents. By (36), the

sum of middle-aged wealth, together with the constant value of the wealth of the young in

relation to the dividend determines the price of the tree and hence the value of all wealth. Of

the nonhuman wealth owned at the beginning of the period, everything not in the hands of



                                              25
middle-aged agents must be in the hands of the old, since the absence of inheritance means

that the young begin their first period of economic life with zero nonhuman wealth. Thus,

the wealth of the old can be deduced from the wealth of the two middle-aged types. And as

                                                                               1−α
mentioned already, the normalized human wealth of the young is constant at      α
                                                                                   .   So we can

take the state variable vector to be the two-dimensional vector of normalized wealth levels

of the middle-aged types where wealth is measured prior to consumption.

   Because the forward-looking behavior of each type (other than the old, who are simple)

makes the dynamic stochastic general equilibrium complex, it is not possible to give a closed-

form expression for the Markov transition from one period to the next. But again, since each

representative agent’s range of behavior only depends on that type’s wealth and forward-

looking expectations for returns given different possible states of the economy, no lagged

variable needs to enter into the determination of the equilibrium. Taking as given the

outcome of the complex decision problem of agents in one period (including the complexity

of needing to figure out the entire forward-looking dynamic stochastic general equilibrium),

it is possible to give a closed form solution for the price of the tree in the next period. We

discuss this in the next subsection.


4.5.2   Markov Representation


To show that our model is Markov, we make two points. First, the optimal portfolios are

entirely forward-looking. Individual agents only care about the intertemporal probabilistic

pattern of returns over their lifetime. The expected return distribution is entirely determined

by the state vector of the aggregate normalized wealth levels of the two types of middle-aged

                                              26
agents. Second, given the forward-looking portfolio behavior of agents, what happens in the

next period is fully determined.

   Once agents have made their decisions at time t, the key facts that go forward to the next

period are the assets owned by the daring and cautious middle-aged agents (j = {L, H}).

The middle-aged wealth next period is given by the portfolio choice of the young in the

current period, prices and returns next period. Specifically, consider a young household of

type j = {H, L} with savings of (1−ρY ) 1−α
                                         α
                                            . By investing optimally a share θYj t of her savings

in the risky asset, her wealth at the beginning of the next period (turning middle-aged) after

the dividend growth rate shock is given by


                                                           
                   j               j      Rt     j 1 + pt+1             1−α
                  wM,t+1   = (1 − θY t )      + θY t          (1 − ρY )     .               (37)
                                         Gt+1         pt                 α


In the square brackets of the right-hand side, the first term is the return on the part of

savings in bonds and the second term is the return on the part of savings in the tree. The

total returns from both bonds and tree imply their wealth when middle-aged.

   To derive the law of motion of wealth, we use equation (36) to eliminate the future price

pt+1 from equation (37), and obtain

                                                                 1
                            H
                                           A2 B1 − (A1 +        ψL )B2           1
                           wM,t+1   =                      1              1        ,        (38)
                                        A1 B1 − (A1 +     ψL )(B1   +    ψH )
                                                                                ψH


                                                         1
                            L
                                           A2 (B1 +     ψH )   − A1 B2        1
                           wM,t+1   =            1             1                ,           (39)
                                        (A1 +   ψL )(B1   +   ψH ) −   A1 B1 ψL




                                                   27
where
                                    (1 − ρM )(1 − ρY ) 1−α
                                                        α
                                                           θYL t
                             A1 = −
                                                 pt
                                  "                                       #
                             1 − α (1 − θYL t )Rt θYL t 1 + (1 − ρM ) 1−α
                                                                       α
              A2 = (1 − ρY )                     +                           ,
                               α       Gt+1                      pt

                                       (1 − ρM )(1 − ρY ) 1−α
                                                           α
                                                              θYHt
                              B1 = −                               ,
                                                  pt
                                  "                                     #
                             1 − α (1 − θYHt )Rt θYHt 1 + (1 − ρM ) 1−α
                                                                     α
              B2 = (1 − ρY )                    +                          .
                               α      Gt+1                  pt

Note that A1, A2 , B1 , and B2 are time varying. See Appendix A.1 for how they are deter-

mined.

   We now present a complete characterization of the solution (see Section 4.5.3 and Ap-

pendix A.1) and demonstrate that there exists a stationary Markov equilibrium of the model

(see Section 4.5.4 and Appendix A.2). We discuss the computation of the equilibrium in Ap-

pendix A.3.

   The proof of the existence of the equilibrium follows directly from applying the results

of Duffie, Geanokoplos, Mas-Collel, and McLennan (1994a) including an unpublished proof

graciously supplied by Andrew McLennan (Duffie, Geanokoplos, Mas-Collel, and McLennan,

1994b). Appendix A.2 extends that proof by showing that it applies to our three-period

model rather than their two-period model and that its logic applies to the Epstein-Zinn

preferences that we assume.




                                               28
4.5.3   Definition of Equilibrium


The model and its solution in the paper are stated in terms of variables indexed by time, no-

tation which is natural for the analysis of shocks that lead to rebalancing. In this section, we

turn to a proof of the existence of the stationary Markov equilibrium. Since the equilibrium

is in terms of the time invariant functions, we use bold to denote the equilibrium functions

associated with these variables. Consistent with the notation tradition of the literature on

Markov equilibria, the prime (0) denotes the next period variables or functions.

   We review the relevant notation. The idiosyncratic dividend growth rate shock G has

a finite support {Gn }N
                      n=1 with probability πn for each Gn . The middle-aged post-shock

             L    H
wealth w = (wM , wM ) is the state variable of the economy. We will use lower-case letters of

variables to indicate the values of the variables divided by same-dated dividends: x = X/D.

ρY and ρM denote the marginal propensities to consume for the young and the middle aged,

respectively. ψj denotes the constant fraction of agents of type j in each cohort. γj is the

risk aversion parameter of type j. α denotes the capital share, so the labor income of the

young is wYj = wY =   1−α
                       α
                            for both j = H, L.

   We first define the recursive equilibrium by collecting the equations that fully characterize

the equilibrium, and then discuss these equations in more detail. Equation numbers in

the square brackets cross-reference the equations for the variables. (Note that the cross-

referenced equations are not normalized by dividends [capital letters instead of lower case

letters].) We denote the equations defining the stationary Markov equilibrium in terms of

functions as SM.1, SM.2, etc. to distinguish them from the equations elsewhere in the text,



                                                 29
which are expressed in terms of variables.


   The recursive equilibrium consists of price functions {p(w), R(w), Z(w, G0 )}, allocations

{cjY (w), cjM (w), cO (w), θYj (w), θM
                                     j
                                       (w)}j=H,L , associated return functions {φjM (w)}j=H,L ,

and the law of motion of wealth w0 (w, G0 ) = (wM
                                                L0
                                                   (w, G0 ), wM
                                                              H0
                                                                 (w, G0 )), such that


  1. Given prices and laws of motion of wealth, the allocations solve the household problems:



                                               cjY (w) = ρY wY ,            [26]                                      (SM.1)


                                                             j
                                               cjM (w) = ρM wM ,            [19]                                      (SM.2)


                                                       H        L
                               cO(w) = 1 + p(w) − (ψH wM + ψ L wM ),                         [34]                     (SM.3)

                                                   (p(w0 (w, G0 )) + 1)G0
                                    Z(w, G0 ) =                           ,             [8]                           (SM.4)
                                                       R(w)p(w)
                                      h                           1
                                                              i 1−γ
                 j                                     0 1−γj        j
                θM (w)   = arg max EG0 {1 − θ + θZ(w, G )}             ,                            [15]              (SM.5)
                                   θ∈Θ

                                    n                                                        1
                                                                                    o1−γj  1−γ j
        φjM (w)   = R(w) EG0              1−    j
                                               θM (w)   +    j
                                                            θM (w)Z(w, G0 )                            ,     [16]     (SM.6)




                                    n                                                                1
                                                                                            o1−γj  1−γ j
           j
          θY   (w) = arg max EG0          [1 − θ + θZ(w, G   0
                                                                 )]φjM (w 0 (w, G0 ))1−ρM                    . [27]   (SM.7)
                         θ∈Θ




                                                        30
  2. Prices clear goods markets:


                                                             H        L
                          p(w) = (1 − ρY )wY + (1 − ρM )(ψH wM + ψ L wM ),      [36]        (SM.8)



        and bond markets:


                 X         n                                                    o
                                      j       j
            0=           ψj (1 − ρM )wM (1 − θM (w)) + (1 − ρY )wY (1 − θYj (w)) . [32] (SM.9)
                 j=H,L



        Note that Rt is determined implicitly in the bond market equation through the depen-

        dency of the portfolio shares on it.


  3. Wealth evolves consistent with portfolio allocations and prices:




                                                    1 + p(w0(w, G0))
                                                                    
                                      R(w)
          H0
         wM  (w, G0)           H
                       = (1 − θY (w))         H
                                           + θY (w)                    (1 − ρY )wY . [38] (SM.10)
                                       G0                 p(w)


                                                    1 + p(w0(w, G0))
                                                                    
                                      R(w)
          L0
         wM  (w, G0)           L
                       = (1 − θY (w))         L
                                           + θY (w)                    (1 − ρY )wY ,   [39] (SM.11)
                                       G0                 p(w)


See Appendix A.1 for further discussion of these equations and the determination of their

solution.


4.5.4     Existence of Equilibrium


PROPOSITION. There exists a recursive equilibrium that satisfies equations (SM.1)-

(SM.11).


                                                  31
       Proof. See Appendix A.2.

       Duffie, Geanokoplos, Mas-Colell, and McLennan (1994) have a result (Proposition 1.2)

under quite general conditions that if an equilibrium always exists for any finite-horizon, then

an ergodic Markov equilibrium also exists in the infinite horizon. The proof in Appendix

A.2 shows that their general proof applies to our specific setting.


4.5.5      Alternative State Variable Representation


The combination of the price-dividend ratio and aggregate risk tolerance is sufficient to fully

characterize the state of the model economy at any point in time. In terms of our model,

aggregate risk tolerance is


                                    WYHtτH + WM
                                              H         L         L
                                                t τH + WY t τL + WM t τL
                               Tt =                                      ,                                 (40)
                                                    Wt


                                                                                j
where the savings or invested wealth of each type j = {H, L} and a = {Y, M} is Wat =
             j
(1 − ρa )ψj wat Dt and the total invested wealth across all types is Wt = WYHt + WM
                                                                                  H      L
                                                                                    t + WY t +

 L 7
WM t. Both the price dividend ratio and aggregate risk tolerance are simple functions of

  H      L      8
(wM t , wM t ).   One could in fact view (pt , Tt) as the state vector for the economy as an

                                                            H      L
alternative to the equivalent description of the state by (wM t , wM t). We study the dynamics
   7
     Note that the relevant wealth for this aggregation in our model is savings or invested wealth, i.e., wealth
after consumption. In the continuous-time Merton model, there is no consumption during the investment
period, so the distinction between before- and after-consumption wealth is absent.
   8
     Recall (36) and rewrite (40) as
                                                                            H            L
                       (1 − ρY )[(1 − α)/α][ψH τH + ψL τL ] + (1 − ρM )[ψH wM t τH + ψL wM t τL ]
                Tt =                                                    H         L
                                                                                                  .
                                  (1 − ρY )[(1 − α)/α] + (1 − ρM )[ψH wM t + ψL wM t ]

These two equations are easily invertible (indeed, given pt and Tt they translate into a pair of linear equations
    H        L                                                        H     L
in wM t and wM t ). Thus, there is a one-to-one mapping between (wM t , wM t) and the vector (pt , Tt).



                                                        32
of both variables below.




5     Quantitative Results

In this section, we examine numerical solutions of a particular parameterization of our model

focusing on the optimal portfolio allocations and rebalancing behavior of households in gen-

eral equilibrium. Portfolios vary across agents with different levels of risk tolerance. In

particular, the optimal portfolio share is larger than the market portfolio share (100%) for

the high-risk-tolerance agents and lower than the market portfolio share for the low-risk-

tolerance agents. The portfolio tree shares of all types comove in response to the dividend

growth rate shock: declining after a good shock and rising after a bad shock. The underlying

wealth dynamics ensure that such comovements in the portfolio shares are consistent with

general equilibrium.



5.1    Parameterization and Solution

Table 1 summarizes the parameter values used in the quantitative analysis. A model period

corresponds to 20 years in the data. The 20-year discount rate of 0.67 corresponds to an

annual discount rate of 0.98. Consequently, ρM is 0.75 and ρY is 0.69. Capital’s share

is 0.33. The cross-sectional heterogeneity in risk tolerance is set to match the findings in

Kimball, Sahm, and Shapiro (2008). They estimate the mean risk tolerance to be 0.21 and

the standard deviation to be 0.17. The distribution they estimate has skewness of 1.84. We

match these three moments by giving 92% of agents a low risk tolerance τL of 0.156 and


                                             33
8% of agents a high risk tolerance τH of 0.797. We refer to the low-risk-tolerance agents as

cautious agents and the high-risk-tolerance agents as daring agents.

   The dividend growth shock process is assumed to be i.i.d with two states of equal prob-

                                                                            1.005 20
ability. In the bad state, the detrended gross growth rate is G1 = 0.67 ≈ ( 1.025 ) and in

                                   1.045 20
the good state, it is G2 = 1.5 ≈ ( 1.025 ) . With our 20-year time horizon, these parameters

imply that the dividend growth rate is 2.5% per year in expected terms, 0.5% per year in

the bad state and 4.5% per year in the good state. The dividend growth rate shocks capture

generational risk. The mean scenario mimics the experience of the United States, the good

scenario mimics that of South Korea, and the bad scenario mimics that of the Japan in the

last two decades. Since all key variables below are expressed on a per-dividend basis and the

elasticity of intertemporal substitution is equal to 1, the trend growth rate of 2.5% per year

does not affect any of our analysis.

                           Table 1: Benchmark Parameter Values
       Capital’s Share                                       α             0.33
       Discount Rate                                         δ             0.33
       Middle-aged Average Propensity to Consume            ρM             0.75
       Young Average Propensity to Consume                  ρY             0.69

       Low Risk Tolerance                                   τL            0.156
       High Risk Tolerance                                  τH            0.797
       Fraction of Low Risk Tolerance Agents                ψL             0.92
       Fraction of High Risk Tolerance Agents               ψH             0.08

       i.i.d. Dividend Growth Shock Process
       Detrended Growth Rate                             (G1 , G2)     (0.67, 1.50)
       Probability                                       (π1 , π2 )    (0.50, 0.50)



   As noted above, our model does not have an analytical solution, so we solve the model

numerically. To make the model stationary, we normalize relevant variables with same-dated

                                                34
dividends. Given six types of agents and two types of assets in our model, it might seem

that the dimension of the state space would be large. As shown in Section 4.5, however,

we are able to reduce the state space to two endogenous variables: the wealth levels of the

                                                     H      L
middle-aged cautious and middle-aged daring agents (wM t , wM t ). We are able to omit states


governing the dividend growth rate from the state space due to the i.i.d. assumption. We

discretize the state space in our numerical solution, but we allow the decision variables to

be continuous. We use the recursive dynamic technique to solve the model. For the detailed

computational algorithm see Appendix A.

   We now present the quantitative behavior of our model economy, focusing particularly

on asset holdings. Our findings on price and return dynamics are not the main contribution

of this paper, so we discuss them in Appendix B.



5.2    The Dynamics of Risk Tolerance

Understanding the endogenous wealth dynamics across agents is central to understanding the

dynamics of asset holdings. The history of shocks matters because it affects the distribution

of wealth and therefore aggregate risk tolerance. We define aggregate risk tolerance in

Equation (40). We display impulse response functions, starting from the average steady state

and then show the average response of the economy after a good or bad shock in period 1.

Figure 2 shows how aggregate risk tolerance responds to both positive and negative shocks.

The plot is symmetric because it gives deviations from the mean and good shocks and bad

shocks are equally likely.



                                             35
                                                                                   Figure 2: Aggregate Risk Tolerance
                                                                                                                                     %       &   '   '   (   )   *       '       +            ,           -   .   /   0   1   -   '   (   2




                                                                                                                        "       $




                                                                                                                        "       #




                                                                                                                        "      !




                                                                                                                        "   




                                                                                                                        "       




                                                                                                                        "           




                                                                                                                         "       




                                                                                                                                                                                                                                                   !




                                                                                                                                                                           3       4        5   6       7   8




   The impulse response shown in Figure 2 shows aggregate risk tolerance rises as a result

of a good shock and falls as a result of a bad shock. While the long-run average aggregate

risk tolerance is about 0.227, it falls to 0.202 after a bad shock and rises to 0.25 after a good

shock. This is because a good shock corresponds to a positive return and an increase in the

wealth of daring agents. The shock in period 1 matters less for risk tolerance in period 2

because one of the affected cohorts dies, and another affected cohort reaches the simplicity

of old age. Yet on average the period 1 movement in risk tolerance rebounds so that it is

more than reversed in period 2.

   What explains the dependence of aggregate risk tolerance in period 2 on the shock in

period 1? A good shock at time 1 puts a large share of invested wealth in the hands of daring

middle-aged agents, who then hold a large fraction of all available shares of the risky asset,

leaving less for their more cautious peers and for the young cohort as a whole. Thus, the

overall holdings of the young cohort are less aggressive when they enter economic life on the


                                                                                                                   36
heels of a good dividend-growth-rate shock than when they enter economic life on the heels

of a bad dividend-growth-rate shock. This is particularly relevant for daring young agents,

as it means that the fraction of all invested wealth in middle age that they hold is less than

it would otherwise be. Thus, after a good shock in period 1 the wealth of daring middle aged

agents in period 2 is unusually low, and therefore the aggregate risk tolerance in that state

of the world is also unusually low. This explanation is symmetric, so that after a bad shock

in period 1 risk tolerance is unusually high in period 2. Similar reasoning can explain how

shocks affect risk tolerance in later periods. In principle each shock affects all future values

of aggregate risk tolerance, but in practice the effect of any shock tends to average out after

3 periods.

   Figures 3 plots the impulse responses for wealth shares after bad and good shocks and

Figure 4 shows how the aggregate wealth shares of different types of agents sum to one.

Consistent with the rest of our results, the wealth share of the middle aged daring goes

down after a bad shock and up after a good shock. The wealth share of the middle aged

cautious shows the opposite pattern, and the wealth share of the young does not vary much

with shocks.



5.3    Portfolio Choice and Rebalancing

Most modern discussions of asset pricing in general equilibrium focus on the properties of

asset prices and returns. Asset holdings are left implicit. Since we are particularly concerned

with implications for individual asset demands, we look directly at portfolio choice and



                                              37
                                                                                                                                                                                                                                                                                  Figure 3: Wealth Shares by Type
                                                    A                        B               C               D               E                   F                       G                   H                        I                       J               K       L       M       N       J       G       D                            O                                                                                                                                                                                             ^                       _                               `           `           a       b       c            `            d                       e                           f       g                   h                   i               j           f           `               a                       k




        9       >               @                                                                                                                                                                                                                                                                                                                                                                                   V           [               ]




        9       >               ?                                                                                                                                                                                                                                                                                                                                                                                   V           [               \




        9       >           =                                                                                                                                                                                                                                                                                                                                                                                       V           [           Z




        9       >               ;                                                                                                                                                                                                                                                                                                                                                                                   V           [               X




                                9                                                                                                                                                                                                                                                                                                                                                                                                                   V




                                        9                    :                                                                                                                                           ;                                                                                                                    <                                                                            =                                                    V                                                                                        W                                                                                                         X                                                                                                                                                               Y                                                                           Z




                                                                                                                                                                 P                       Q                    R               S       T               U                                                                                                                                                                                                                                                                                                                                                                                      l             m           n           o       p                   q




                                                r            s           t           u               v               w               x       y       z       u                   v                                                                                                        r               s           t               u            v       {       x       t   |   z   s           t   }                ~                   z                                                                                                                                                                                                                                                                                                                                                                                                                           




                                                                                                                                                                                 Figure 4: Aggregating Wealth Shares by Type
                                                                     ¡                   ¢               £               ¤                   ¥                       ¦                   §                        ¨                       ©               ª       «       ¬       ­       ©       ¦           £                           ®                                                                                                                                                                                                  ½                           ¾                           ¿           ¿           À       Á        Â           ¿                Ã                   Ä                           Å       Æ                       Ç                   È               É           Å       ¿               À                       Ê




                                                                                                                                                                                                                                                                                                                                                                                                                         ¶       º                   µ




                                                                                                                                                                                                                                                                                                                                                                                                                     µ               º               ¼




                                                                                                                                                                                                                                                                                                                                                                                                                     µ               º               »




                                                                                                                                                                                                                                                                                                                                                                                                                     µ               º           ¹




                                                                                                                                                                                                                                                                                                                                                                                                                     µ               º               ·




                                                                                                                                                                                                                                                                                                                                                                                                                                                       µ




                                                                                                                                                                                                                                                                                                                                                                                                                                                               µ                                                                                        ¶                                                                                                             ·                                                                                                                                                           ¸                                                                           ¹




                                                                                                                                                             ¯                       °                    ±               ²       ³               ´                                                                                                                                                                                                                                                                                                                                                                                               Ë            Ì               Í       Î           Ï               Ð




                                            Ñ            Ò       Ó               Ô               Õ               Ö               ×       Ó               Ø               Ù   Ò                   Ó                    Ú                                                                                           Ñ               Ò            Ó       Ô       Õ       Û       ×           Ü   Ù   Ô   Õ                    Ý                   Ù           Þ            Þ       ß       à       á       â       ã   ä       å       æ               â       ç                   è   é       ê           ç           ë                                                                                             ì                   é       å       å           í           ä           î                   ï           ð               ñ       ò                   ó       ï           ô   õ   ö       ð




                                                                                                                                                                                                                                                                                                                                                                                                               38
rebalancing in response to shocks in this subsection. Figure 5 plots the impulse response

of the equilibrium tree holdings of different types of agents to both bad and good shocks.

Figure 6 plots the same thing in a cumulative fashion to show explicitly that the holdings

always sum to one.

                                                                                                                                           Figure 5: Equilibrium Tree Holdings
                              þ            ÿ                                                                                                                                                                                                                                                                                                        !               "       #           $       %        &       "                   '




      ÷   ü       ý                                                                                                                                                                                                                  




      ÷   ü   û                                                                                                                                                                                                                  




      ÷   ü   ú                                                                                                                                                                                                                  




      ÷   ü       ù                                                                                                                                                                                                                  




      ÷   ü           ø                                                                                                                                                                                                                  




                  ÷                                                                                                                                                                                                                    




                          ÷           ø                                                                    ù                                                      ú                                           û                                                                                                                                                                                                                                                                   




                                                                                                                                                                                                                                                                                                                                      (       )       *       +   ,           -




                                  .    /       0   1       2   3       4       5   6       1   2                                             .        /       0       1   2   7   4   0   8   6   /   0   9                :       6           ;       ;   <   =   >   ?   @   A   B       C   ?           D   E   F   @                                       G           E   B           B       H   A       I    J   K       L        M        N   J       O   P   Q   R   O   S




   Like the impulse response plot of aggregate risk tolerance in Figure 2, the period 0 value

in these plots is the long-run mean tree holding for each group. Also like Figure 2, these

figures are symmetric in the shock, in that the impulse response for positive shocks is the

opposite relative to that mean of the impulse response for the negative shocks. Both figures

show that tree holdings respond substantially to good and bad shocks. After a bad shock,

the tree holdings of the young agents of both types increase. The holdings of daring middle

aged investors fall substantially while those of cautious middle-aged investors rise. After a

good shock the holdings of daring middle-aged investors rise substantially and those of the


                                                                                                                                                                                                                  39
                                                                                                                                                          Figure 6: Tree Holdings in Aggregate
                              \           ]       ^       _           `       a       b                   c                   d               e       f   g   h   i   eb       _               j                                                                                                        y           z       {           {       |       }   ~       {                                                                 {       |           




          U   Y       T                                                                                                                                                                                                                         r   v        q




      T       Y       [                                                                                                                                                                                                                     q       v        x




      T       Y       Z                                                                                                                                                                                                                     q       v        w




      T       Y   X                                                                                                                                                                                                                         q       v       u




      T       Y       V                                                                                                                                                                                                                     q       v        s




                      T                                                                                                                                                                                                                                         q




                          T           U                                                                               V                                                            W                                               X                                    q                                               r                                                       s                                                                    t                                       u




                                                                                              k               l           m           n   o       p                                                                                                                                                                                                                                        




                                                                                                                                                                                                                                                                   ¡       ¢          £   ¤   ¥   ¦       £       §                                           ¨           ¥   ¡   ¡       ©       ª   «        ¬       ­   ®       ¯   «   °   ±   ²   ¬




other types fall. By period 2 these effects are largely reversed.

   The effects in Figures 5 and 6 are driven by the same type of logic used to explain

aggregate risk tolerance above. After a bad shock the wealth of middle-aged daring investors

has declined substantially and they hold less of the risky asset. Because the risky asset is

relatively cheap, other investor types (young daring, young cautious, middle-aged cautious)

are happy to hold more. The middle-aged cautious investors are rebalancing in the direction

(but not the exact extent) a constant share rule would imply. The logic after a good shock

is the reverse.

   The findings of these figures are developed further in Table 2. The first three columns

of Table 2 report the portfolio share of each type of agent. The statistics in the table help

us to isolate three important effects: leverage, aggregate risk tolerance, and intertemporal

hedging.


                                                                                                                                                                                                                                       40
   First, leverage arises endogenously, with the daring agents being highly levered and with

the cautious agents holding a risky, but unlevered portfolio. As shown in the first column

of Table 2, the cautious agents hold only about 48% of their savings (invested wealth) in

the risky asset and the rest in the risk-free bonds. By contrast, the daring agents invest on

average 568% of their invested wealth in the risky asset by selling the risk-free bonds to the

cautious agents. This difference in portfolio shares across types enables shocks to change the

distribution of wealth across types.

        Table 2: Portfolio Choice, Savings Weight and Asset Demand by Type (Percent)
                          Portfolio Share θ                 Savings Weight       Wi
                                                                                 W         Tree Amount θW
                                                                                                        W
                                                                                                          i

      Gt                Average Bad Good                    Bad      Good                  Bad     Good
      Cautious             48      53      43               92.8     85.0                   49      36
         Young             47      53      42               60.1     61.7                   32      26
         Middle            49      53      44               32.7     23.3                   17      10

      Daring               568        704       432           7.2         15.0              51            65
        Young              570        706       433           5.2          5.4              37            23
        Middle             566        701       432           2.0          9.6              14            42

      Total                  90       105        74        100.0         100.0             100           100
        Young                89       105        73         65.3          67.1              69            48
        Middle               90       105        75         34.7          32.9              31            52
      Note: The portfolio share is the ratio of risky assets and savings of each type, the savings weight is the
      fraction of each type’s savings in total savings, and the tree amount is the amount of tree held by each type.
      In particular, the tree amount equals the savings weight times the portfolio share for each type. Both the
      tree amount and the savings weight should sum up to 100 percent across types. Savings is after-consumption
      wealth. Gt denotes the dividend growth rate shock in period t.




   Second, as the second and third columns of Table 2 show, one of the most striking

implications of the model is that all types have a higher mean portfolio tree share after

a bad shock than after a good shock due to the aggregate risk tolerance effect. A bad

shock pushes down aggregate risk tolerance and raises the expected excess return. As a

result, all types of agents choose a larger portfolio share. After a good shock, aggregate risk

                                                           41
tolerance rises, the expected excess return declines, and all agents decrease their portfolio

shares. It may seem surprising that all agents are able to move their portfolio shares in the

same direction in general equilibrium. Section 5.5 below shows that changes in the wealth

distribution combined with the effects of leverage, in particular, changes in the share of all

invested wealth in the hands of middle-aged daring agents, allow all portfolio shares to move

in the same direction.

       Third, Table 2 indicates that for each level of risk tolerance the portfolio share of the

young is similar to that of the middle-aged. Recall that we abstract from the dynamic

interaction between human capital and portfolio choice by having labor income only at

the beginning of the life. The comparison between young and middle-aged portfolios for

a given level of risk tolerance thus isolates the pure intertemporal hedging effect. Table 2

indicates that the intertemporal hedging effect is small quantitatively. Qualitatively, the

cautious young have a lower portfolio share than the cautious middle-aged, while the daring

young have a higher portfolio share than the daring middle-aged. Section 5.7 discusses these

implications in detail.9

       The average young portfolio share has important implications for the dynamics of the

total middle-aged wealth and aggregate risk tolerance next period. Recall that the cautious

agents account for 92% of the population and the daring agents account for the other 8%.

The average young portfolio share is 105% (= 0.92 × 53 + 0.08 × 704) after a bad shock

and 74% (= 0.92 × 43 + 0.08 × 433) after a good shock. Thus, the young hold a slightly
   9
    Our results do not appear to be special to the parameterization that we have assumed. In Appendix C
we both halve and double the variation in risk tolerance and the magnitude of economic shocks. The results
we obtain are qualitatively the same.



                                                   42
more daring portfolio (105%) than the market portfolio (100%) after a good shock, but a

much more conservative portfolio (74%) after a bad shock. These patterns for the portfolio

share of the young contribute to the history dependence of aggregate risk tolerance that we

discussed in the previous subsection.



5.4       Prices and Returns

In this section we describe the prices and returns implied by the model in order to make the

intuition behind our rebalancing results clear. Table 3 presents the summary statistics based

on a model simulation of 10,000 periods, which is a sufficiently long sample to eliminate the

simulation uncertainty. Returns are expressed as annual rates. The log risk free rate has a

mean of 1.9% and a standard deviation of 22 basis points. The log realized tree return is

on average 3.63% with a standard deviation of 2%. Thus, the model economy generates a

1.7% risk premium with a standard deviation of 2%, resulting in an average Sharpe Ratio of

0.85. Although our model is not specifically designed to deliver a large risk premium, it goes

a substantial fraction of the way toward explaining the historical premium. The model’s

Sharpe Ratio is quite high because the return volatility implied by the model is low. This

results from our choice to match the volatility of macroeconomic shocks rather than market

shocks.

   Similarly, the model’s expected returns and price-dividend ratio are much less volatile

than in historical data. For instance, the price-dividend ratio is on average 19, with a

standard deviation of 0.54. Because shocks to the fundamentals are i.i.d. in the growth



                                             43
                        Table 3: Summary Statistics on Prices, Annualized
      Variable                       Mean        Standard        Correlation      Auto
                                                 Deviation         with G       Correlation
      ln(Risk Free Rate)             1.92%        0.22%             0.808        −0.059
      ln(Realized Tree Return)       3.63%        2.00%             0.996          0.028
      ln(Realized Excess Return)     1.70%        2.00%             0.997        −0.057
      Expected ln(Tree Return)       3.61%        0.16%             0.285        −0.353
      Expected ln(Excess Return)     1.68%        0.13%           −0.968         −0.172
      Tree Return Volatility         2.00%        0.05%           −0.985         −0.114
      Sharpe Ratio                   0.85         0.05            −0.955         −0.203
      Tree Price-Dividend Ratio     18.94         0.54            −0.471         −0.246


rate, movements in the realized return on the risky asset move essentially one-for-one with

the dividend shock. Moreover, the i.i.d. growth shock means that any forecastability of

returns comes from general equilibrium effects, not from the fundamentals per se. It turns

out that these general equilibrium effects have a contribution to returns that is relatively

small compared to sheer good and bad luck, so there is relatively little serial correlation in

the realized risky return and the risk-free rate.

     The expected excess return is critical for portfolio choice. It is strongly negatively corre-

lated with the dividend growth rate shock and is somewhat mean reverting. Mechanically,

these results are coming from movements in the risk-free rate, which is highly correlated with

the shock to the dividend growth rate. Intuitively, the risk-free rate is moving because the

shock to dividends changes the wealth of daring agents and therefore shifts the aggregate risk

tolerance. We discuss the dynamics of the price dividend ratio in more detail in Appendix

B.

     We plot the Sharpe ratio of the risky asset in Figure 7. Consistent with the findings in

Table 3, the Sharpe ratio increases after a bad shock and decreases after a good shock.




                                                44
                                                                                                                                   Figure 7: Sharpe Ratio
      ¹   ¾   Á    ¹       Â       Ã   Ä   Å   Æ   Ç       È       É               Ê       Ë       Ì   Í   Î   Ê   Ç   Ä       Ï                   Ö   Û   Þ    Ö        ß       à   à   á   â   ã   à       ä       å               æ   ç   è   é   ê   æ   à   á       ë




      ¹   ¾   ¿    ¿                                                                                                                               Ö   Û   Ü    Ü




      ¹   ¾   ¿    À                                                                                                                               Ö   Û   Ü    Ý




      ¹   ¾   ¿   ½                                                                                                                                Ö   Û   Ü   Ú




      ¹   ¾   ¿    »                                                                                                                               Ö   Û   Ü    Ø




      ¹   ¾   ¿    ¹                                                                                                                               Ö   Û   Ü    Ö




                       ¹       º                                       »                                                   ¼              ½                         Ö        ×                                       Ø                                               Ù       Ú




                                                       ³       ´           µ   ¶       ·       ¸                                                                                                         Ð       Ñ       Ò   Ó   Ô       Õ




5.5           Correlated Movements in Portfolio Shares

It may seem surprising that all types of agents move their portfolios in the same direction in

a general equilibrium. The key forces behind this finding are the changes in the total wealth

and therefore in the invested wealth levels of the middle-aged agents that generate changes

                                           θWi
in the tree holdings                        W
                                                               of each type to satisfy the adding-up constraint


                                                                                           WYLt L    WH         WL L         H
                                                                                                                            WM
                                                   1=                                          θY t + Y t θYHt + M t θM t +    t H
                                                                                                                                θ .                                                                                                                                              (41)
                                                                                           Wt        Wt          Wt         Wt M t


   To understand the implications of this constraint, look first at the “savings weights,” the

                                                                                                                                                                        Wi
weights for invested wealth or after-consumption wealth                                                                                                                 W
                                                                                                                                                                           ,             reported in the middle columns

of Table 2. The cautious agents have a larger savings weight than the daring because the

cautious have a larger mass. The savings weight of the cautious is, however, lower after a good

shock (85%) than after a bad shock (92.8%), so the aggregate risk tolerance increases after a


                                                                                                                                              45
good shock. Both the daring and cautious young agents have a slightly larger savings weight

after a good shock than after a bad shock. The cautious middle-aged have a much smaller

savings weight after a good shock (23.3%) than after a bad shock (32.7%). In contrast, the

daring middle-aged have a much larger savings weight after a good shock (9.6%) than after

a bad shock (2%).

   Now, examine the quantity of trees held by each type of agent in the last two columns of

Table 2. The quantity of trees held by each type equals that type’s portfolio share multiplied

by the savings weight of each type. Even though the economy has relatively fewer daring

agents, the tree holdings of the daring agents are comparable in total size to those of the

cautious agents due to their heavily levered position. After a good shock, the young agents

have slightly higher savings weights but much lower portfolio shares, leading to much lower

total tree holdings. After a good shock, the middle-aged cautious agents have a much lower

savings weight and thus an even lower quantity of tree holdings given their decreased portfolio

share. On the other hand, the middle-aged daring agents have a much higher savings weight

after a good shock, almost four times higher. The increase in their savings weight dominates

the decline in their portfolio share, implying a larger total quantity of tree holdings by the

middle-aged daring agents.

   This effect can be illustrated with the impulse response plot in Figure 8. This figure plots

the reaction of each investor type to bad and good shocks by comparing their portfolio shares

to their long-run mean portfolio shares. The shares of the young daring and middle-aged

daring are so similar that the lines are very difficult to distinguish in the plot. The figure



                                              46
clearly shows that after a good shock, all portfolio shares drop. After a bad shock they rise.




                                                                                                                        Figure 8: Portfolio Shares relative to Mean
                                       õ            ö       ÷       ø       ù           ú               û           ü           ý           þ   ÿ             þ   û       ø                                                                                                                                                                                                                                                                  




           í   ñ   ï                                                                                                                                                                                                                             




           í   ñ       î                                                                                                                                                                                                                         




           í   ñ           í                                                                                                                                                                                                                     




           í   ñ       ì                                                                                                                                                                                                                         




       ì       ñ       ô                                                                                                                                                                                                                                




       ì       ñ       ó                                                                                                                                                                                                                                




       ì       ñ       ò                                                                                                                                                                                                                                




                               ì           í                                                                            î                                                           ï                                               ð                                                                                                                                                                                                                                                                




                                                                                                                                                                                                                                                                                                                                                !       "       #       $       %           &




                                   '        (   )       *       +       ,       -   .       /   *           +                                               '           (       )       *       +   0   -   )   1   /   (   )   2            3       /       4   4   5   6   7   8   9   :   ;   <       8   =       >   ?   9                                           @               >   ;           ;       A   :       B       C   D           E       F       G   C   H   I   J   K   H   L




   In our parameterization all types of agents in the economy adjust their portfolio shares

in the same direction in response to the dividend growth shocks. In particular, all increase

their portfolio shares after a bad shock and decrease them after a good shock. This is also

true for the all of the dramatically different alternative parameterizations that we consider

in Appendix C, in which we double and halve the size of the shock and double and halve

the distribution of risk tolerance. It may be possible, however, to find counterexamples.

Although it need not always be that everyone’s shares move in the same direction, we

consider this the natural case since the expected return is the main determinant of the

optimal shares for people to hold. While intertemporal hedging also matters in determining

optimal holdings, the variation in the expected return is much larger than the variation in


                                                                                                                                                                                                                                        47
hedging so its effect dominates. We discuss the magnitude of hedging effects below.

    Even though all agents move their portfolio shares in the same direction, some must sell

while others buy in order to attain their new positions. The changes in the underlying wealth

distribution make such portfolio behavior consistent with general equilibrium.



5.6     Rebalancing by Cohort

So far we have been focusing on the portfolio dynamics of each type of agent at a point

in time. Now we track the portfolio rebalancing of each cohort over time. When young,

the agents choose an optimal portfolio share after the dividend shock. At the beginning of

middle age, before any rebalancing, the value of their tree holdings as a share of their middle-

aged wealth changes passively in response to the realized dividend shock and the realized

tree return. We refer to this portfolio share as the realized portfolio share.10 The agents

then choose the optimal portfolio share for their middle age (governing wealth accumulation

between then and old age). We present the sequence of the three portfolio shares in Table 4.

Because we are tracking cohorts (or individuals), we group equilibrium observations by the

history of shocks rather than reporting an impulse response as we have done previously. GY

and GM denote the shocks that the agents experience when young and when middle-aged,

respectively.

    Let’s first examine the passive movements of the portfolio share of each cohort. Since

the cautious young agents are not levered, the realized middle-age portfolio share rises sub-
  10
    This realized portfolio share implicitly assumes that consumption is financed by asset sales in proportion
to asset shares, including proportionate paying off of debt for agents who have negative bond holdings.




                                                     48
                     Table 4: Rebalancing: Portfolio Share, by Cohort (Percent)
                            Cautious Agents                                    Daring Agents
     GY , GM          Young Realized Middle-Aged                    Young     Realized Middle-Aged
     Bad, Bad          53.1   52.0         53.4                      706        988          700
     Good, Bad         41.8   39.9         53.4                      433        594          702
     Bad, Good         53.1   71.0         42.7                      706        166          395
     Good, Good        41.8   59.0         45.9                      433        161          467
     Note: GY and GM denote the shocks that agents experience when young and when middle-aged, respectively.



stantially after a good shock at their middle age, and declines slightly after a bad shock. By

contrast, since the daring young agents are highly levered, their realized middle-age portfolio

share rises after a bad shock, but declines after a good shock. In addition, the magnitude of

the changes in their portfolio share is quite large. For instance, the realized portfolio share

rises from 706% to 988% after a history of two bad shocks, and declines from 706% to 166%

after a bad shock when young followed by a good shock at middle age.

   If the constant share rule were more or less correct, the agents would undo the movements

in the realized middle-aged portfolio shares and return to the portfolio share when young. In

terms of the direction of the adjustment at middle age, the constant share rule is consistent

with the behavior of the cautious agents. The cautious agents do not, however, return to the

same portfolio share when young. In fact, the new optimal level is typically quite different

from the optimal share when young. The difference in the optimal shares between the two

periods is particularly large when the shock they experience when young is different from

the shock at middle age.

   In addition to the quantitative differences, there are two types of qualitative differences

between the optimal rebalancing shown in Table 4 and the constant share rule. First, even



                                                        49
returning to the same tree share requires opposite adjustments for people who seek to be more

levered than the economy as a whole as compared to agents who seek to be less levered than

the economy as a whole. Second, for the daring agents, the direction of their adjustments

at middle age is sometimes opposite to the direction that would restore their tree share to

what they had earlier. In particular, after a bad shock when young followed by a good shock

at middle age, the daring middle-aged agents further increase their portfolio share above the

realized portfolio share.



5.7    Intertemporal Hedging

Intertemporal hedging in our model arises when the portfolio shares shift consistently by

age to take into account any predictability in returns. Referring back to Table 2, there is

little difference in the portfolio choice between the young and the middle-aged. Given that

our generational model produces only limited predictability in returns, it is not surprising

that we see little intertemporal hedging. On the other hand, the qualitative implications of

intertemporal hedging are still interesting and deserve some discussion.

   To understand these patterns of intertemporal hedging, recall the portfolio choice problem

of the young in equation (28) and of the middle-aged in equation (16). Unlike the middle-

aged, who care about simple real returns, the young care about returns relative to the returns

of the variable annuity, as indicated by (30). Table 5 presents the annuity price conditional

on the current and past shocks.

   For the cautious agents, the variable annuity price is higher after a bad shock than after



                                             50
                          Table 5: Period-t Variable Annuity Price
                                       Cautious         Daring
                           Gt        Bad Good         Bad Good
                           Mean      0.894 0.882     0.785 0.790
                           Gt−1
                              Bad    0.891   0.889   0.762   0.802
                              Good   0.897   0.876   0.767   0.779


a good shock. The combination of a low risk-free rate and lower expected tree returns late

in life after a bad shock makes it harder to finance a comfortable retirement (see Table 3).

This unfavorable movement in the variable annuity price after a bad shock increases the

effective risk of holding tree shares when young. By contrast, this variable annuity price

is irrelevant for the middle-aged cautious agents; they care only about one-period returns.

Thus, the young cautious agents invest less in the tree than the middle-aged cautious agents.

The annuity price variation in period t is larger when the dividend shock is good in period

t − 1. Thus, this finding is reinforced when the cautious agents experienced a good shock

when young.

   For the daring agents, however, the variable annuity price is lower after a bad shock than

after a good shock, since they tend to be so highly levered that the increase in the equity

premium after a bad shock makes it easier for them to finance a comfortable retirement. This

variable annuity price pattern helps the daring agents smooth consumption at their middle

age, and thus the young daring agents invest more in the risky asset than the middle-aged

daring agents. The variation in the period-t annuity price is larger when the dividend shock

is bad (which yields a greater covariance of the equity premium with the later shock) than

when the dividend growth shock is good. Thus, quantitatively, the young daring agents invest



                                              51
more in risky assets than the middle-aged daring agents, especially when they experience a

bad shock in their youth.




6     Conclusion

We develop a model to illustrate how optimizing agents of different ages and risk preferences

rebalance in equilibrium. The dynamics of portfolios differ starkly from benchmark models

where agents either hold constant portfolio shares or buy and hold the market portfolio. The

model includes agents with different risk tolerance, so there is meaningful trade, and three

periods of life, so there is meaningful rebalancing over time. The model has a partial analytic

solution. In particular, the state of the economy can be summarized by the distribution of

wealth of middle-aged investors. This analytic solution both helps make the findings of the

paper transparent and simplifies the solution of the full dynamic equilibrium model.

    There are several effects that are key to understanding rebalancing in equilibrium. First,

there is a leverage effect. In the model, leverage arises endogenously because of the het-

erogeneity in risk preferences. Shocks to the valuation of risky assets cause levered agents

to rebalance in the opposite direction from unlevered agents. Second, there is an aggregate

risk tolerance effect. Shocks to the valuation of risky assets affect agents’ wealth differently

depending on their initial position in the risky asset. Such shifts in the distribution of wealth

change aggregate risk tolerance and therefore the demand for assets going forward. Note

that the leverage and aggregate risk tolerance effects are connected because leverage magni-

fies how valuation shocks change the distribution of wealth. For example, after a bad shock


                                               52
leverage increases. The levered agents sell to reduce their leverage and the unlevered agents

buy. But the increase in leverage is so great that even after rebalancing levered agents have

higher exposure to risky assets. Therefore, all agents become more exposed to risk after a

bad shock, and the opposite is true after a good shock

   Third, there is an intertemporal hedging effect whereby equilibrium time variation in ex-

pected returns affects the portfolio choices of young investors as they exploit mean reversion

in asset returns. This intertemporal hedging effect arising from mean reversion is what is

often highlighted in analyses emphasizing time- or age-variation in portfolio shares. While

it is present in our model, it is quantitatively weak by design. The model is solved under

a specification with i.i.d. growth rates, so mean reversion in returns is not built into the

specification. Other analyses of intertemporal hedging in the literature are based on empiri-

cal properties of actual returns, which might include mean reversion arising from mispricing.

Our model has all agents frictionlessly optimizing, hence many sources of mean reversion that

may be present in the data are intentionally not present in the model in order to highlight

the implications of equilibrium for rebalancing.

   Some key implications of the model are broadly consistent with recent rebalancing expe-

rience by age in data from the Survey of Consumer Finances. Determining the implications

of our model for standard rebalancing data requires some thought. Our model features the

underlying fundamentals: one risky asset and risk-free borrowing and lending. Data from

markets feature stocks, bonds and other types of risky assets. Of course, these financial

assets are claims on the fundamentals that also depend on the corporate capital structure.



                                             53
In particular, leverage in the corporate sector has important implications for the risk expo-

sure of stockholders. For example, consider an investor with 100 percent stocks when the

capital structure in the economy is half equity and half debt. In terms of our model, that

investor will have a risky asset share of two. Because of the leverage effect described in the

model, as stock prices rise a 100 percent stock investor will have a lower risky tree share

before rebalancing because her wealth grows faster than the value of her equity. What is

going on is that when the value of all capital in the economy increases, stocks become less

levered relative to the economy as a whole. Thus, to maintain the same leverage relative to

the economy as a whole, an investor who began with 100 percent in stocks would need to

buy more stocks after this market uptick. However, a finding of the paper is that because

of general equilibrium forces, an investor will not rebalance to the same tree share as before

the market uptick, but to a somewhat lower tree share, tempering somewhat the need to

buy more stock. This example highlights how intuition about portfolios in terms of stocks

must be interpreted with caution because of the underlying leverage of the corporate sector.

   Looking back at the implied rebalancing from Survey of Consumer Finances data re-

ported in Figure 1, several features of the recent history are consistent with the model but

inconsistent with both the constant share and buy and hold rules. In the SCF data some

of the older investors behave like the daring agents in the model, perhaps because of cohort

effects. In Panel A, which reflects recent positive returns, older investors are actively buy-

ing to increase their stock share above the passive implied level for 2007. The reason they

need to buy is that, because they are levered, when there is a good shock their exposure



                                             54
to risk decreases as wealth increases more than the value of their equity holdings. Younger

investors are either actively selling or simply not buying as much. Younger investors act like

the cautious agents in our model, avoiding large risky asset holdings after a positive shock.

In Panel B, which reflects recent negative returns, the patterns are reversed. Older investors

sell more than the passive implied quantity of assets, and younger investors buy more than

what would leave them at their passive level. These patterns are broadly consistent with the

model, but inconsistent with a constant share or buy and hold rule.

   Our framework is useful for understanding how portfolios would respond to a stock market

crash in an economy where all investors were behaving optimally. Contrary to both the

constant share and buy and hold rules, after a market crash our investors increase their

share in risky assets relative to the pre-crash levels, though by different amounts depending

on their risk tolerance.

   Finally, our analysis points to a principle that must hold much more generally than the

particular model we study here: funds that serve a nontrivial fraction of investors will have to

take into account general equilibrium constraints to be feasible and optimal. In particular,

many existing target-date funds, which follow simple linear allocation rules regardless of

economic conditions, will not be optimal for most people. Moreover, as target-date funds

become ubiquitous, they will become infeasible since they will not find counterparties to

trade with as they rebalance. Our particular model points to how “universal target-date

funds,” or funds that are optimal for all investors given risk tolerance and age, should adjust

their target asset allocation in response to economic shocks.



                                              55
56
References
Black, F., 1976. Studies of stock price volatility changes. Proceedings of the 1976 Meetings
of the American Statistical Association, Business and Economical Statistics Section, 177-181.

Bodie, Z., Merton, R. C., Samuelson, W. F., 1992. Labor supply flexibility and portfolio
choice in a life cycle model. Journal of Economic Dynamics and Control 16, 427-449.

Brunnermeier, M. K., Nagel, S., 2008. Do wealth fluctuation generate time-varying risk aver-
sion? Micro-evidence on individuals’ asset allocation. American Economic Review 98(3),
713-736.

Calvet, L. F., Campbell, J. Y., Sodini, P., 2009. Fight or flight, portfolio rebalancing by
individual investors. Quarterly Journal of Economics 124, 301-348.

Campbell, J. Y., Viceira, L. M., 2002. Strategic Asset Allocation: Portfolio Choice for Long-
Term Investors, Oxford University Press, New York.

Campbell, J. Y., 2006. Household finance. Journal of Finance 61(4), 1553-1604.

Canner, N., Mankiw, G., Weil, D., 1997. An asset allocation puzzle. American Economic
Review 87(1), 181-191.

Chan, Y. L., Kogan, L., 2002. Catching up with the joneses: Heterogeneous preferences and
the dynamics of asset prices. Journal of Political Economy 110(6), 1255-1285.

Cocco, J., Gomes, F., Maenhout, P., 2005. Consumption and portfolio choice over the life-
cycle. Review of Financial Studies 18(2), 491-533.

Cochrane, J. H., 2008. Is now the time to buy stocks? Wall Street Journal, Nov. 12 2008.

Cochrane, J. H., Longstaff F. A., Santa-Clara, P., 2008. Two trees. Review of Financial
Studies 21(1), 347-385.

Duffie, D., J. Geanokoplos, A. Mas-Collel, and A. McLennan, 1994a. Stationary Markov
Equilibria, Econometrica 62(4): 745-781.

Duffie, D., J. Geanokoplos, A. Mas-Collel, and A. McLennan, 1994b. Stationary Markov
Equilibria, unpublished proof.

Dumas, B., 1989. Two-person dynamic equilibrium in the capital market. Review of Finan-
cial Studies 2(2), 157-188.


                                             57
Epstein, L., Zin, S., 1989. Substitution, risk aversion, and the temporal behavior of con-
sumption and asset returns: A theoretical framework. Econometrica 57, 937-969.

Garleanu, N., Panageas, S., 2015. Young, old, conservative and bold: The implications of
heterogeneity and finite lives for asset pricing. Journal of Political Economy 123(3), 670-685.

Geanakoplos, J., 2010. The leverage cycle. NBER Macroeconomics Annual 24, 1-65.

Gomes, F., Michaelides, A., 2005. Optimal life-cycle asset allocation: Understanding the
empirical evidence. Journal of Finance 60(2), 869-904.

Glover, A., Heathcote, J., Krueger D., Rios-Rull, J., 2014. Intergenerational redistribution
in the great recession. Working paper, University of Minnesota.

Jaganathan, R., Kocherlakota, N., 1996. Why should older people invest less in stocks than
younger people? Federal Reserve Bank of Minnesota Quarterly Review 20(3), 11-23.

Kim, T. S., Omberg, E., 1996. Dynamic nonmyopic portfolio behavior. Review of Financial
Studies 9, 141-161.

Kimball, M. S., Sahm, C., Shapiro, M., 2008. Imputing risk tolerance from survey responses.
Journal of the American Statistical Association 103, 1028-1038.

Liu, J., 2007. Portfolio selection in stochastic environments. Review of Financial Studies
20, 1-39.

Longstaff, F. A., Wang, J., 2012. Asset pricing and the credit market. Review of Financial
Studies 25, 3169-3215.

Lucas, R. E., 1978. Asset prices in an exchange economy. Econometrica 46, 1429-1445.

Malmendier, U., Nagel, S., 2011. Depression babies: Do macroeconomic experiences affect
risk taking? Quarterly Journal of Economics 126, 373-416.

Merton, R., 1971. Optimum consumption and portfolio rules in a continuous-time model.
Journal of Economic Theory 3, 373-413.

Merton, R., 1973. An intertemporal capital asset pricing model, Econometrica 41, 867-887.

Radner, R., 1972. Existence of Equilibrium of Plans, Prices and Price Expectations in a
Sequence of Markets, Econometrica 40(2): 289-303.

Sharpe, W. F., 2010. Adaptive asset allocation. Financial Analysts Journal 66(3), 45-59.

                                              58
Wang, J., 1996. The term structure of interest rates in a pure exchange economy with het-
erogeneous investors. Journal of Financial Economics 41, 75-110.

Weil, P., 1990. Non-expected utility in macroeconomics. Quarterly Journal of Economics
105, 29-42.




                                           59
Appendix A: Stationary Markov Equilibrium


A.1       Definition of Equilibrium
This appendix defines the equilibrium and discusses its solution. For convenience, Section
4.5.3 is repeated here. As discussed in Section 4.5.3, the time-invariant equilibrium functions
associated with the model’s variables are denoted in bold. Consistent with the notation tra-
dition of the literature on Markov equilibria, the prime (0) denotes the next period variables
or functions.
    The idiosyncratic dividend growth rate shock G has a finite support {Gn }N    n=1 with prob-
                                                                            L    H
ability πn for each Gn . The middle-aged post-shock wealth w = (wM            , wM ) is the state
variable of the economy. We will use lower-case letters of variables to indicate the values of
the variables divided by same-dated dividends: x = X/D. ρY and ρM denote the marginal
propensities to consume for the young and the middle aged, respectively. ψj denotes the
constant fraction of agents of type j in each cohort. γj is the risk aversion parameter of type
j. α denotes the capital share, so the labor income of the young is wYj = wY = 1−α    α
                                                                                         for both
j = H, L.
    We first define the recursive equilibrium by collecting the equations that fully characterize
the equilibrium, and then discuss these equations in more detail. Equation numbers in the
square brackets denote the corresponding equations in the main text. (Note that the cross-
referenced equations are not normalized by dividends [capital letters instead of lower case
letters].)

    The recursive equilibrium consists of price functions {p(w), R(w), Z(w, G0 )}, allocations
{cjY (w), cjM (w), cO (w), θYj (w), θM
                                     j
                                       (w)}j=H,L , associated return functions {φjM (w)}j=H,L ,
and the law of motion of wealth w0 (w, G0 ) = (wM  L0
                                                      (w, G0 ), wM
                                                                 H0
                                                                    (w, G0 )), such that

  1. Given prices and laws of motion of wealth, the allocations solve the household problems:
                                           j
                                          cY (w) = ρY wY ,      [26]                                   (SM.1)
                                                        j
                                          cjM (w) = ρM wM ,     [19]                                   (SM.2)
                                                   H        L
                           cO(w) = 1 + p(w) − (ψH wM + ψ L wM ),                 [34]                  (SM.3)
                                                            0          0
                                     (p(w (w, G )) + 1)G
                                                       0
                              Z(w, G0 ) =                , [8]                                         (SM.4)
                                          R(w)p(w)
                                  h                           1
                                                          i 1−γ
               j                                   0 1−γj        j
              θM (w) = arg max EG {1 − θ + θZ(w, G )}
                                 0                                 ,                    [15]           (SM.5)
                             θ∈Θ
                               n                                                    1
                                                                           o1−γj  1−γ j
        φjM (w)   = R(w) EG0         1−    j
                                          θM (w)   +    j
                                                       θM (w)Z(w, G0 )                      ,   [16]   (SM.6)


                                                A-1
                                  n                                                                1
                                                                                          o1−γj  1−γ j
           j
          θY   (w) = arg max EG0        [1 − θ + θZ(w, G   0
                                                               )]φjM (w 0 (w, G0 ))1−ρM                    . [27]   (SM.7)
                        θ∈Θ




  2. Prices clear goods markets:
                                                           H        L
                        p(w) = (1 − ρY )wY + (1 − ρM )(ψH wM + ψ L wM ),                          [36]              (SM.8)

     and bond markets:
             X     n                                                  o
                             j       j                          j
        0=      ψj (1 − ρM )wM (1 − θM (w)) + (1 − ρY )wY (1 − θY (w)) . [32] (SM.9)
                j=H,L


     Note that Rt is determined implicitly in the bond market equation through the depen-
     dency of the portfolio shares on it.
  3. Wealth evolves consistent with portfolio allocations and prices:


                                                1 + p(w0(w, G0))
                                                                
                                 R(w)
        H0
       wM  (w, G0)        H
                  = (1 − θY (w))         H
                                      + θY (w)                     (1 − ρY )wY . [38] (SM.10)
                                  G0                  p(w)

                                               1 + p(w0(w, G0))
                                                               
        L0     0          L      R(w)    L
       wM (w, G ) = (1 − θY (w))      + θY (w)                    (1 − ρY )wY , [39] (SM.11)
                                  G0                 p(w)

    The first three consumption equations are relatively straightforward. Equations (SM.1)
and (SM.2) specify optimal consumption of young and middle-aged households, derived
from their savings-consumption tradeoffs under inter-temporal log utility, and old households
consume everything as in equation (SM.3).
    The next four equations are related to the portfolio problems. To streamline the portfolio
problems of the young and the middle-aged, we define two return functions in equations
(SM.4) and (SM.6). The excess return function Z(w, G0 ) in equation (SM.4) specifies the
excess return of risky tree investment conditional on the dividend growth shock G0 next
period. The total return function φjM (w) in equation (SM.6) gives the total return on
savings under the optimal portfolio choice for the middle-aged, which are in the utility form
given the Epstein-Zin-Weil preferences. Equation (SM.5) gives the optimal risky asset share
for the middle-aged households. Equation (SM.7) gives the optimal risky asset shares of the
young.
    The market clearing conditions specify the equilibrium price functions. The goods-market
clearing condition in equation (SM.8) is actually savings supply equals savings demand, and
specifies the tree price as a function of the sum of middle aged wealth, and the interest rate
function R(w) is implicitly given by the bond market clearing condition in equation (SM.9),
where optimal portfolio shares are functions of the interest rate R.


                                                    A-2
    Let’s discuss in greater detail the law of motion for the middle-aged wealth vector. The
next-period middle-aged wealth vector is given by the portfolio choice of the young in the
current period, prices, and returns conditional on the dividend growth shock G0 next period.
Specifically, consider a young household of type j = {H, L} with savings of (1 − ρY )wY .
                                    j
By investing optimally a share θY (w) of her savings in the risky asset, her returns at the
beginning of the next period (turning middle-aged) after the dividend growth rate shock G0
are given by equations (SM.11) and (SM.10). In the square brackets of the right-hand side,
the first term is the return on the part of savings in bonds and the second term is the return
on the part of savings in the tree. The total returns from both bonds and tree imply their
wealth when middle-aged for each possible dividend growth rate shock.
    To derive the law of motion of wealth in a way that makes the Markov nature more
transparent, plug in the following relation into equations (SM.11) and (SM.10)

                  p(w0(w, G0)) = (1 − ρM ) wY + ψH wM
                                                    H0
                                                       (w, G0) + ψLwM
                                                                    L0
                                                                       (w, G0) .
                                                                              


We derive
                                                   !
                                             L (w)
                       (1 − ρM )(1 − ρY )wY θY                                                L (w)
                                                                        (1 − ρM )(1 − ρY )wY θY
                 1                                        L0                                            H0
                    −                                ψL wM   (w, G0 ) −                             ψH wM  (w, G0 )
                ψL                 p(w)                                             p(w)
                           "                                                 #
                                   L (w))R(w)
                             (1 − θY             θYL (w) (1 + (1 − ρ ) w )
                                                                     M    Y
         =    (1 − ρY )wY                      +                               ,
                                     G0                     p(w)


                                                                                                   !
               (1 − ρM )(1 − ρY )wY θYH (w)                                                H (w)
                                                                     (1 − ρM )(1 − ρY )wY θY
                                                L0               1                                         H0
             −                              ψL wM  (w, G0 ) +      −                                   ψH wM  (w, G0 )
                           p(w)                                ψH                p(w)
                         "                                                #
                                 H (w))R(w)
                           (1 − θY               H (w) (1 + (1 − ρ )w )
                                                θY                 M   Y
        =    (1 − ρY )wY                      +                             .
                                   G0                       p(w)



   Thus, we have
                                     1     L0                  H0
                           (A1 +       )ψLwM  (w, G0) + A1 ψH wM  (w, G0) = A2 ,
                                    ψL
                                      0                       1      H0
                                  L
                           B1 ψL wM (w, G0) + (B1 +             )ψH wM  (w, G0) = B2 ,
                                                             ψH
where
                                                                        L
                                                  (1 − ρM )(1 − ρY )wY θY (w)
                                     A1 = −
                                                             p(w)
                                                   L           L                         
                                              (1 − θY (w))R(w) θY (w) (1 + (1 − ρM ) wY )
                A2 = (1 − ρY )wY                              +                             ,
                                                      G0                 p(w)
                                                                        H
                                                  (1 − ρM )(1 − ρY )wY θY (w)
                                     B1 = −                                   ,
                                                              p(w)
                                                   H           H                        
                                              (1 − θY (w))R(w) θY (w) (1 + (1 − ρM )wY )
                B2 = (1 − ρY )wY                              +                            .
                                                      G0                 p(w)


                                                          A-3
   And we have
                                                                   1
                         H0
                                             A2 B1 − (A1 +        ψL )B2            1
                        wM  (w, G0)   =                      1               1          (SM.12)
                                          A1 B1 − (A1 +     ψL )(B1     +   ψH )
                                                                                   ψH
                                                         1
                         L0
                                             A2 (B1 +   ψH )    − A1 B2         1
                        wM  (w, G0)   =            1             1
                                                                                  .     (SM.13)
                                          (A1 +   ψL )(B1   +   ψH )   − A1 B1 ψL

   The next-period middle-aged wealth w0 is given by the optimal portfolio choice of the
young and the prices, which, aside from the shock G0 , are both functions solely of current
middle-aged wealth w.



A.2      Existence of Equilibria
This section establishes the existence of the recursive equilibrium for our model. We first
state the result and then illustrate the proof.

PROPOSITION. There exists a recursive equilibrium that satisfies equations (SM.1)-
(SM.11).

    Duffie, Geanokoplos, Mas-Colell, and McLennan (1994) have a result (Proposition 1.2)
under quite general conditions that if an equilibrium always exists for any finite-horizon,
then an ergodic Markov equilibrium also exists in the infinite horizon. In this section, we
will show that their general proof applies to our specific setting. Their proposition is stated
as follows.

     PROPOSITION 1.2: Let G : S → P(S) be an expectations correspondence
     and K be a compact subset of S. If, for every T ∈ N, there exists a T -horizon
     equilibrium {S1, ....ST } for G such that St ∈ K almost surely for all t, then G
     has an ergodic Markov equilibrium.

    Duffie, Geanakoplos, Mas-Colell, and McLennan (1994) establish the existence of ergodic
Markov equilibria for a stochastic overlapping generations model in Theorem 2.1 as an exam-
ple of their general theory. Their overlapping generations model is an endowment economy
with very general assumptions on fundamentals. It allows for l goods, n assets and m types
of agents in each cohort with an exogenous Markov shock process. They first establish that
an equilibrium exists for any finite horizon of their overlapping generations model, and then
invoke Proposition 1.2 to establish that a Markov equilibrium exists in the infinite horizon.
    Their example nests our overlapping generations model as a special case with l = 1, n = 2,
m = 2, and an i.i.d. shock process, except for two minor differences. One minor difference
is that agents live for two periods in their setup instead of three periods in ours. The other
difference is that they assume that the utility is von Neumann-Morgenstern, while ours is

                                                  A-4
Epstein-Zin-Weil. These two minor modifications in our model do not affect the arguments
of their proof. The difference between two and three periods does not change the basic
argument of the proof. Furthermore, their proof uses only the continuity, monotonicity, and
concavity of the utility function, and the Epstein-Zin-Weil preferences have all these three
properties. The Epstein-Zin-Weil preferences do not satisfy the Independence of Irrelevant
Alternatives (IIA) of the von Neumann-Morgenstern utility, but this property is not required
for the proof. Thus, the generalization of the preferences does not change the proof either.
    This appendix therefore proceeds by (a) giving a formal proof closely following an OLG
theorem of Duffie, Geanokoplos, Mas-Colell, and McLennan that an equilibrium exists for
any finite horizon, and then (b) formally applying Proposition 1.2 to establish that a Markov
equilibrium exists in the infinite horizon.
    Below we show that their proof that equilibria exist for any finite horizon T ∈ N goes
through with our two minor modifications. The original proof was omitted in their paper.
We thank Andrew McLennan for providing us a copy of the omitted proof, which is attached
with this document for your reference. We go through their proof line by line, taking care
of any minor modifications that we have to make for our setup. We adopt their notation in
this section of the appendix for an easy comparison.

    We now outline a proof, similar to Radner’s (1972), that T -horizon equilibria exist for
any T . Fix T ≥ 1. The space of T -period deterministic price paths is P , the set of pairs
(p, q) where p = (p1 , ..., pT ) and q = (q1, ..., qT ) are T -tuples of functions pt : Gt → [0, 1]2 and
qt : Gt → [0, 1] with (pt (G1 , G2 , ..., Gt), qt(G1 , G2 , ..., Gt)) ∈ ∆3 for all t and (G1 , G2 , ..., Gt).
p is asset price and q is goods price. ∆3 denotes the price simplex. In our model, there are
two types of assets, risk-free bonds and risky trees, and one good, implying that pt has two
dimensions and qt has one dimension.
    The truncated consumption set is ℵ = [0, L] where L is a number large enough to include
the total endowment in any period. In our setup, L > α1 > 1, since α1 is total endowment
of goods in every period. The truncated portfolio set is Γ = [−L, L]2. For the risky tree,
the demand is bounded in [0, 1], and for the risk-free bond, it is bounded by [−L, L]. These
bounds are introduced to ensure that excess demand is bounded and compact-valued. In
equilibrium, these constraints do not bind.
    The first difference between our setting and that of Duffie et al. is that we have a three-
period rather than two-period generations model. That implies that we need to take care of
an extra cohort in each period and one extra period for each generation. As is shown below,
this generalization is straightforward.
    An excess demand is a tuple (ζY , ζM , ζO , ξY , ξM ), where ζY = (ζYH1 , ζYL1 , ..., ζYHT , ζYLT ),
          H      L           H      L              H    L            H     L            H      L           H      L
ζM = (ζM    1 , ζM 1 , ..., ζM T , ζM T ), ζO = (ζO1 , ζO1 , ..., , ζOT , ζOT ), ξY = (ξY 1 , ξY 1 , ..., ξY T , ξY T ),
                H       L          H     L                                       i   t             i         t
and ξM = (ξM 1 , ξM 1, ..., ξM T , ξM T ) are T -tuples of functions ζY t : G → R, ζM t : G → R,
 i
ζOt  : Gt → R, ξYi t : Gt → Γ, and ξM         i       t                     i
                                                t : G → Γ. Here ζjt denotes the excess demand for
                                                                                        i
goods for cohort j = {Y, M, O} and type i = {H, L} in period t, and ξjt                    denotes the excess
demand for assets for cohort j = {Y, M} and type i = {H, L} in period t.
    The excess demand (ζY , ζM , ζO , ξY , ξM ) is (truncated) individually feasible if, for all i, t,


                                                         A-5
and Gt ,
                                      eiY t (Gt ) + ζYi t (Gt ) ∈ ℵ,
                                      X
                         eiM t(Gt ) +     ξYi at−1(Gt )da (Gt ) + ζM i     t
                                                                       t (G ) ∈ ℵ,
                                       a
                                       X
                         eiOt(Gt ) +         i
                                            ξM                       i    t
                                               at−1 (Gt )da (Gt ) + ζOt (G ) ∈ ℵ,
                                       a

where eijt denotes the endowment of agent of type i and age j in period t; ξjat    i
                                                                                       is the excess
demand of asset a = 1, 2 of type i and age j in period t, and da denotes the dividend paid
out by asset a in period t. In our setup, only the young have the labor endowment eiY t (Gt ),
which is proportional to the dividend, so eiM t(Gt ) = eiOt(Gt ) = 0.
    The excess demand (ζY , ζM , ζO , ξY , ξM ) is budget feasible for price path (p, q) if, for all i,
t, and Gt ,
                            pt (Gt ) · ξYi t (Gt ) + qt (Gt ) · ζYi t(Gt ) ≤ 0,
                   pt (Gt ) · ξM
                               i     t         t     i     t         t     i
                                 t (G ) + qt (G ) · ζM t (G ) ≤ pt (G ) · ξY t−1 (G
                                                                                   t−1
                                                                                       ),
                              qt(Gt ) · ζOt
                                         i
                                            (Gt ) ≤ pt (Gt ) · ξM
                                                                i
                                                                  t−1 (G
                                                                        t−1
                                                                            ).
    The excess demand (ζY , ζM , ζO , ξY , ξM ) is optimal for price path (p, q) if it is individually
feasible, budget feasible for (p, q), and no individual has another individually feasible and
budget feasible plan that yields higher utility. Note that since preferences are increasing,
continuous, and concave, the set of optimal excess demands for (p, q) is compact and convex.
    The second difference between our setting and theirs is that we use the Epstein-Zin-Weil
preferences, while they use the von Neumann-Morgenstern utility. Note that the utility
function properties used in the proof apply equally to both their and our preferences.
    An aggregate excess demand is a pair Ψ = (ψθ , ψx) where ψθ = (ψθ1 , ..., ψθT ) and ψx =
(ψx1, ..., ψxT ) are T -tuples of functions ψθt : Gt → R2 and ψxt : Gt → R. The aggregate
excess demand (ψθ , ψx) is said to be derived from (ζY , ζM , ζO , ξY , ξM ) if for all t and Gt
                                            X
                                ψθt (Gt ) =      ξYi t (Gt ) + ξM
                                                                i     t
                                                                        
                                                                  t (G ) ,
                                               i

and                                    X
                          ψxt(Gt ) =          ζYi t(Gt ) + ζM
                                                            i     t     i    t
                                                                               
                                                              t (G ) + ζOt (G ) .
                                        i

Note that if (ζY , ζM , ζO , ξY , ξM ) is budget feasible for (p, q) and (ψθ , ψx ) is derived from
(ζY , ζM , ζO , ξY , ξM ), then

                               pt (Gt ) · ψθt (Gt ) + qt (Gt )ψxt(Gt ) ≤ 0,

for all t and Gt . This is Walras’ Law.
    For each price path (p, q) let Ψ(p, q) be the set of aggregate excess demands derived
from excess demands that are optimal for (p, q). The usual arguments show that Ψ is
a compact convex valued upper semicontinuous correspondence. In the proof McLennan

                                                    A-6
provided, Duffie, Geanakoplos, Mas-Colell, and McLennan established a generalization of
the Debreu-Gale-Kuhn-Nikaido lemma as follows.

       Proposition: Let A and B be positive integers, and let ∆A = {ρ ∈ RA
                                                                                        P
                                                                                     +|   a ρa =
                                    A B         A B
       1}. Suppose that F : (∆ ) → (R ) is an upper semicontinuous compact
       convex valued correspondence whose image is contained in a bounded subset of
       (RA )B , and suppose that rb ·zb ≤ 0, b = 1, ..., B, whenever z = (z1 , ..., zB) ∈ F (r).
       Then there exists r? ∈ (∆A )B and z ? ∈ F (r?) with z ? ≤ 0.

     This Proposition guarantees the existence of a price path (p? , q ?) and an aggregate ex-
cess demand (ψθ?, ψx?) ∈ Ψ(p? , q ?) with ψθ?(Gt ) ≤ 0 and ψx? (Gt ) ≤ 0 for all t and Gt . Let
(ζY? , ζM
        ?
          , ζO? , ξY? , ξM
                         ?
                           ) be an optimal excess demand vector for (p? , q ?) whose derived aggre-
gate excess demand is (ψθ? , ψx?). To show that (p? , q ?) and (ζY? , ζM             ?
                                                                                        , ζO? , ξY? , ξM
                                                                                                       ?
                                                                                                         ) constitute
a T -period equilibrium it now suffices to show that the plans for individuals specified by
(ζY? , ζM
        ?
          , ζO? , ξY? , ξM
                         ?
                           ) are optimal, i.e., the constraints ζjti? ∈ ℵ and ξjt      i?
                                                                                           ∈ Γ do not rule out
utility-improving plans that are budget feasible and individually feasible in the absence of
these artificial constraints. But (ζY? , ζM     ?
                                                  , ζO? , ξY? , ξM
                                                                 ?
                                                                   ) specifies consumption bundles and port-
folios that are feasible in the aggregate, so the artificial constraints are satisfied with strict
inequality, and the desired result follows from the concavity of all utility functions. Thus,
we establish the existence of equilibrium in any finite horizon case for our setting.

    Since the amount of each good available in each state and date is bounded uniformly,
both above and away from zero, there is a compact set K almost surely containing all states
reached in any such T -horizon equilibrium. Therefore, Proposition 1.2 implies the existence
of a stationary Markov equilibrium in our setting for the infinite horizon.

    To recap the strategy of the proof, we cite Duffie et. al. page 763:

           We induce a T -period equilibria for all finite horizons T ∈ N as follows. ...
       For each T these preferences induce a T -period finite-state Radner (1972) style
       event-tree economy. Then, by an argument similar to Radner’s, we establish the
       existence of an S T -valued random variable that is a T -horizon equilibrium for G,
       in the sense of our central results. ... Since the amount of each good available
       in each state and date is bounded uniformly, both above and away from zero,
       there is a compact set K almost surely containing all states reached in any such
       T -horizon equilibrium. Proposition 1.2 now implies the existence of a compact
       self-justified set J for g, and the desired conclusion follows from Proposition 1.3.


    This section shows that their proof applies to our model. Therefore, there exists a
stationary Markov equilibrium for our model.



                                                        A-7
A.3       Equilibrium Solution
Having shown the existence of Markov equilibria, we now describe how to find such an equi-
librium. This section details the computation algorithm in our paper. We use backward
induction to solve for time-invariant equilibrium functions. We start from a terminal pe-
riod to serve as the transversality condition and to rule out sunspots. We solve the model
backward from the last period. In each period t, we obtain the optimal policy functions
{cjY t(w), cjMt(w), cjOt(w), θYj t(w), θMt
                                        j
                                           (w), Rt (w), pt(w), Zt (w, Gt+1 ), wt0 (w, Gt+1 )}. We
move backward until the optimal policy functions in period t and period t − 1 converge
to obtain the time-invariant equilibrium functions {cjY (w), cjM (w), cjO(w), θYj (w), θM   j
                                                                                              (w),
                      0            0
R(w), p(w), Z(w, G ), w (w, G )}. Note that we need to index functions by time since the
                           0

solution iterates backwards until the policy functions converge to the stationary equilibrium.
Now we describe this backward induction.

A.3.1      Last Period T
Optimal choices at time T are simple: all agents consume their wealth and the stock price
is zero. Since there is no saving, the portfolio share is irrelevant. Thus, for j = H and L, we
have
                                             H    L
                                       pT (wM  , wM ) = 0,
                                  cjY T (wM
                                          H    L
                                            , wM ) = (1 − α)/α,
                                                        j
                                     cjMT (wM
                                            H    L
                                              , wM ) = wM ,
                                   H    L              H        L
                             cOT (wM , wM ) = 1 − ψ H wM − ψ L wM .
Nonnegative consumption for all agents implies the set of state variables in period T is
Ωw      H    L      2      H      L
 T = {(wM , wM ) ∈ R+ |ψH wM + ψLwM ∈ [0, 1]}.


A.3.2      Period T − 1
In Period T − 1, the asset market equilibrium conditions and goods-market equilibrium
condition are modified: the marginal propensity to consume and the optimal risky asset
share for the young become the same as for the middle aged. The stock price is given by
                        H    L                                 H        L
                                                                          
                pT −1 (wM , wM ) = (1 − ρM )wY + (1 − ρM ) ψH wM + ψ L wM   .        (A.1)

It is easy to derive the optimal consumption:

                                  cjY T −1 (wM
                                             H    L
                                               , wM ) = ρM wY ,
                                                          j
                                  cjMT−1 (wM
                                           H    L
                                             , wM ) = ρM wM ,




                                              A-8
                         H    L                 H    L          H        L
                cOT −1 (wM , wM ) = 1 + pT −1 (wM , wM ) − (ψH wM + ψ L wM )
                                                                H        L
                                                                            
                                  = 1 + (1 − ρM )wY − ρM ψH wM    + ψ L wM    .                                              (A.2)

   We now derive bounds for variables of interest. First, nonnegative consumption implies
the set of state variables in period T − 1 is
                                                                            
            w          H    L      2      H     L        α + (1 − α)(1 − ρM )
          ΩT −1 = (wM , wM ) ∈ R+ |ψH wM + ψL wM ∈ 0,                            .
                                                                 αρM

This implies (1 − ρM ) 1−α
                        α
                           ≤ pT −1(w) ≤ (1 − ρM ) αρ1M .
               G1
   Second, pT −1 (w)
                     ≤ RT −1 (w) ≤ pT GN
                                      −1 (w)
                                             . If the tree return is larger than RT −1 even for
                                       G1
the lowest shock realization, i.e., pT −1 (w)
                                              > RT −1 (w), the households will all borrow in
bonds to invest in the tree, and the excess demand of bonds is negative. If the excess return
is lower than RT −1 even for the highest realization, i.e., pT GN
                                                               −1 (w)
                                                                      < RT −1 (w), the households
will all buy bonds, and the excess demand of bonds is positive. To clear the market, it must
                    G1
be the case that pT −1 (w)
                           ≤ RT −1 (w) ≤ pT G N
                                             −1 (w)
                                                    .
                           j                      j
   In period T − 1, θMT −1 (w) = θY T −1 (w) since both the young and the middle-aged have
only one more period to live. Consider the middle-aged portfolio problem for each w:
                                                                                                             1
                                                 N                                                1−γj ! 1−γ i
           j
                                                 X                                 Gn
          θMT −1 (w) = arg max                          πn 1 − θ + θ                                               .
                                         θ∈Θ
                                                 n=1
                                                                            RT −1 (w)pT −1 (w)

                                                                                          Gn
We directly plug in the excess return ZT −1 (w, Gn ) =                             RT −1 (w)pT −1 (w)
                                                                                                      since pT (w)           = 0.
                                                                                         Gn
Nonnegative consumption when old implies that                           1 − θ + θ RT −1 (w)pT −1 (w) ≥ 0 for all Gn .        This
                1                    1
implies −     GN        ≤θ≤           G1      .
                                 −1             1− R
          R T −1 (w)p T −1 (w)                         T −1 (w)p T −1 (w)

   Label the objective function as F jM :
                                                                                                      1
                                         N                                                 1−γj ! 1−γ i
                    j
                                         X                                 Gn
                   FM (θ) ≡                    πn 1 − θ + θ                                                 .
                                         n=1
                                                                   RT −1 (w)pT −1 (w)

We solve the optimal θ as the solution to the first order condition
                               N                                            −γj                          
     j 0        j
                               X                              Gn                             Gn
   (FM ) (θ) = FM (θ)γj               πn 1 − θ + θ                                                       − 1 = 0.            (A.3)
                               n=1
                                                       RT −1 (w)pT −1 (w)             RT −1 (w)pT −1 (w)

The solution to the first order condition θ̂ satisfies
                                 N                                             −γj −1                               2
    j 00         j
                                 X                                Gn                               Gn
  (FM ) (θ̂) = −FM (θ̂)γj              πn γj 1 − θ̂ + θ̂                                                       −1           < 0.
                                 n=1
                                                           RT −1 (w)pT −1 (w)               RT −1 (w)pT −1 (w)

The two power terms on the right hand side of the above equation are positive, implying the


                                                                 A-9
                      j
second derivative of FM  at θ̂ is negative. Thus, the solution θ̂ to the first-order condition is
also globally optimal and thus unique. This result can be established straightforwardly by
contradiction.

   Then we use the market clearing condition for bonds to obtain RT −1 (w):
                    X       h                     i
                                  j                   j
                                                             
                        ψj 1 − θMT −1 (w; RT −1 ) wM    + wY = 0.                             (A.4)
                       j=H,L

                   j
To establish that θMT −1 (w; RT −1 ) is continuous in RT −1 , we invoke the implicit function
                     j 0                                                                 j      00
theorem. Since (FM     ) is continuous and differentiable in both θ and R, and (FM         ) is
                                j
nonzero, the policy function θMT −1 (w; RT −1 ) given by equation (A.3) is continuous in RT −1.
         j
Since θMT  −1 (w; RT −1 ) is continuous in RT −1 , the excess demand of bonds in the left hand
side of equation (A.4) is continuous in RT −1 . As RT −1 approaches pG 1
                                                                     T −1
                                                                          from above, the excess
                    j
returns go up, and θM T −1 approaches positive infinity, implying a negative excess demand of
bonds. On the other side, as RT −1 approaches pGT −1
                                                  N
                                                      from below, the excess returns go down,
      j
and θM  T −1 approaches positive infinity, implying a positive excess demand of bonds. The
continuity of the excess demand function over RT −1 implies that there exists at least one
RT −1 which implies zero excess demand in the bond markets. Therefore, in period T − 1,
we have proven the existence of the interest rate function RT −1 (w).
   The certainty equivalent total next-period return function for the middle-aged is
                                                                                                 1
                           N                                                          1−γj ! 1−γ j
                           X                                              Gn
φjMT −1 (w) = RT −1 (w)                  j
                                 πn 1 − θMT−1        j
                                              (w) + θMT−1 (w)                                          .
                           n=1
                                                                  pT −1 (w)RT −1 (w)

                                                 j            j
   The young’s decision on portfolio choice θY T −1 = θMT −1 implies that his next-period
wealth {wT0 −1 (w, Gn )} is given by equations (SM.12) and (SM.13).

A.3.3      Period T − k with k ≥ 2 (A Generic Period)
Now consider a generic period: T − k with k ≥ 2. The tree price is given by
                                                           H        L
                    pT −k(w) = (1 − ρY )wY + (1 − ρM )(ψH wM + ψ L wM ).

It is easy to derive the optimal consumption:

                                      cjY T −k(w) = ρY wY ,
                                                       j
                                      cjMT −k(w) = ρM wM ,
                                                       H        L
                       cOT −k(w) = 1 + pT −k(w) − (ψH wM + ψ L wM ).



                                             A-10
   Again, nonnegative consumption implies that the set of state variables in period T − k is
                                                                            
          w         H    L     2     H         L        α + (1 − α)(1 − ρY )
        ΩT −k = (wM , wM ) ∈ R+ |ψH wM + ψLwM ∈ 0,                                .
                                                                 αρM

This implies (1−ρYα)(1−α) ≤ pT −k(w) ≤ α(1−ρM )+(1−α)(1−ρ
                                                  αρM
                                                           Y)
                                                              .
    Here is some intuition for the bounds on the tree price. The lower bound is given by
the minimum possible demand for the tree. Suppose the middle-aged have zero financial
wealth, so they have a zero demand for savings. The old always have zero demand for
savings. In that case, demand for net savings, which can only be provided by the tree, is
equal to young’s demand for savings, and the young’s demand for savings will determine
the tree price. Since the young have to live through the next two periods without labor
income, they need savings of (1−ρYα)(1−α) , which gives the lower bound for the tree price.
Now consider the upper bound for the tree price. The young still demand (1−ρYα)(1−α) in
savings, but now suppose the middle-aged own all the financial wealth of the economy 1 + pt
and so have savings demand of (1 − ρM )(1 + pt ). Then the maximum tree price is given by
pt = (1−ρYα)(1−α) + (1 − ρM )(1 + pt ), which can be solved to give the upper bound on the tree
price.
    Now we need to show the existence of the price function RT −k(w), the law of mo-
tion of wealth wT0 −k(w, Gn ) and the portfolio function ΘT −k(w) = {θYHT −k(w), θYL T −k(w),
  H            L
θMT  −k(w), θMT −k(w)} such that (i) given prices and the law of motion for wealth, the
portfolio choices ΘT−k(w) are optimal; (ii) the law of the motion is consistent with the
agents’ choices; and (iii) the prices clear the markets.
    Given the interest rate RT −k(w), and the next-period state variable wT0 −k(w, Gn ), the
agents know the next period tree price pT −k+1 (wT0 −k(w, Gn )), and the total return for the
                             j
middle-aged next period, φMT −k+1 (wT0 −k(w, Gn )) by solving the problem of period T −k+1.
The implied excess returns are
                                                                         
                                         Gn pT −k+1 (wT0 −k(w, Gn )) + 1
                       Zt−k(w, Gn ) =                                      .
                                                pT −k(w)RT −k(w)

We have Zt−k(w, G1 ) ≤ 1 ≤ Zt−k(w, GN ) following similar arguments as in period T − 1.
             G1 (pT −k+1 (wT
                           0
                             −k (w,G1 ))+1)              GN (pT −k+1 (wT
                                                                       0
                                                                         −k (w,GN ))+1)
This implies           pT −k (w)
                                            ≤ RT −k(w) ≤           pT −k (w)
                                                                                        . Thus, using
the bounds for the tree prices, we have
                                                                              
                     R          G1 ρM (1 − ρY (1 − α)) GN (1 − ρY (1 − α))
                    ΩT −k =                           ,                          .
                                1 − αρM − (1 − α)ρY ρM (1 − ρY )(1 − α)

   With the information they have, the middle-aged solve the following problem:
                                                                                        1
                                             N
                                         (                                          ) 1−γ
                                                                                        j
                  j
                                                   πn [1 − θ + θZT −k(w, Gn)]1−γj
                                             X
                θMT−k(w) = arg max                                                          .   (A.5)
                                   θ∈Θ
                                             n=1



                                                     A-11
 Again as in period T − 1, we have a unique global optimizing solution. Nonnegative
consumption when old implies that 1 − θ + θZT −k(w, Gn ) ≥ 0 for all Gn . This implies
         1
− ZT −k (w,GN )−1
                  ≤ θ ≤ 1−ZT −k1 (w,G1 ) . The optimal portfolio choices give φjMT −k(w), which is
needed to solve the problem of period T − k − 1.
   The young’s portfolio problem is given by equation (SM.7). Let’s rewrite the objective
function as follows:
                   (   N
                                                                                         ) 1
                                                                            1−ρM 1−γj 1−γj
     j                                                   j
                       X
                                                                  0
   FY (θ) =                  πn [1 − θ + θZT −k(w, Gn)] φMT −k+1 wT−k (w, Gn)                  .
                       n=1

Solve for the optimal θ as the solution to the first order condition
                                N
                                X                                 (1−ρM )(1−γj )       ZT −k (w, Gn ) − 1
 (FYj )0 (θ) = FYj (θ)γj              πn φjM T −k+1 wT0 −k (w, Gn )                                           γ = 0. (A.6)
                                n=1
                                                                                     (1 − θ + θZT −k (w, Gn )) j

The solution to the first order condition θ̂ also satisfies
                                   N                                   (1−ρM )(1−γj )                             2
  j                  j        γj
                                   X            j
                                                                                             (ZT −k (w, Gn) − 1)
(FY )00 (θ̂)   =   −FY   (θ̂)            πn γj φM T −k+1 wT0 −k (w, Gn)                                            γj +1 < 0.
                                   n=1                                                     1 − θ̂ + θ̂ZT −k (w, Gn )


   Thus, there is a unique optimal portfolio share θYj T −k(w). Nonnegative consumption
                                       1
when middle-aged implies that − ZT −k (w,GN )−1
                                                ≤ θ ≤ 1−ZT −k1 (w,G1 ) .

   Thus, given functions {RT −k(w), wT0 −k(w, Gn )}, we can solve for the optimal portfolio
ΘT −k(w) from equations (A.5) and (A.6). For the optimal portfolio choices to be an equilib-
rium allocation, they must be consistent with the law of motion of wealth given by (SM.12)
and (SM.13). Also, they need to satisfy the bond market clearing condition given RT −k(w):
        X       h        h               i               h               i    i
                               j                               j            j
             ψj (1 − ρY ) 1 − θY T −k(w) wY + (1 − ρM ) 1 − θMT −k(w) wM = 0.
          j=H,L


    We cannot establish the uniqueness of the interest rate that clears the bond markets.
                                             j
However, numerically for our parameters, θM    T −1 decreases with RT −1 and the excess demand
decreases with RT −1 , as illustrated in Figure 9. For a reasonably typical value of w, the top
two panels plot the optimal portfolio shares over different values of the risk-free interest
rate for the low-risk-tolerant and the high-risk-tolerant households, and the bottom panel
plots the excess demand. As the risk-free rate increases and the excess tree return decreases,
households decrease their risky asset shares. The excess demand increases with the interest
rate. Thus, there exists a unique RT −1 that clears the bond market. One stable method for
solving R(w) is thus the bisection technique, starting with the lower bound set at a value
                        G1
slightly higher than pT −1 (w)
                               and the upper bound set at a value slightly lower than pT G N
                                                                                          −1 (w)
                                                                                                 .




                                                                A-12
                                         Figure 9: Numerical Solution Illustration 1
                                15

                                10




               θ LMT-1
                                  5

                                  0
                                   0.7       0.75       0.8                   0.85   0.9   0.95
                                                              Interest Rate
                                  1
               MT-1




                                0.5
              θH




                                  0
                                   0.7       0.75       0.8                   0.85   0.9   0.95
                                                              Interest Rate
                                  5
                Excess Demand




                                  0

                                 -5

                                -10
                                   0.7       0.75       0.8                   0.85   0.9   0.95
                                                              Interest Rate




A.3.4     Stationary Equilibrium
We use the above procedure for each period going backward until the policy functions con-
verge. We then have the stationary Markov equilibrium for our model.




                                                               A-13
Appendix B: Price and Return Dynamics
In this appendix we describe the price and return dynamics implied by the model in more
detail.
    The dependence of the risky asset share of the young cohort as a whole on the shock right
before they begin investing makes it possible to explain the behavior of the price-dividend
ratio. Recall that the price-dividend ratio is determined exactly by the total middle-aged
wealth in each period. See Equation (36). Because of the Cobb-Douglas production function
and the constant average propensity to consume, the invested wealth of the young cohort is
a fixed fraction of output, or equivalently, in a fixed ratio to the dividend. Their later wealth
in middle age in comparison with the dividend at that time depends on their overall portfolio
return compared to the growth rate of the dividend. Let us explain the general level of the
price-dividend ratio after each of the four possible histories of the last two shocks.
    A good shock leading into the youth of the current middle-aged cohort depressed their
risky asset share when young, and they were significantly underlevered relative to the econ-
omy as a whole. Then a second good shock will actually cause the growth rate of their wealth
to fall behind the growth rate of the dividend (which equals the growth rate of economic
production as a whole). Middle-aged wealth that is smaller relative to the expanded size
of the economy will then lead to a low price-dividend ratio (in part because dividends are
large). In contrast, a bad shock as they go into middle age causes the economy to grow more
slowly than their relatively safer portfolio, leading to a high middle-aged wealth to dividend
ratio, which in turn implies a high price-dividend ratio.
    The bad shock leading into the youth of the current middle-aged cohort led that cohort
to have slightly elevated risky asset holdings and thus to be slightly overlevered relative to
the economy as a whole. A good shock at middle age then leads them to have a high level
of wealth relative to the economy as a whole, leading in turn to a high price-dividend ratio.
In contrast, a bad shock at middle age causes them to have a low level of wealth relative to
the economy as a whole, leading in turn to a low price-dividend ratio.
    Note that the last shock makes a bigger difference for the price-dividend ratio between
the (Good, Good) and (Good, Bad) histories than it does between the (Bad, Good) and
(Bad, Bad) histories. The reason is that the daring middle-aged agents in the previous
period pulled more dramatically ahead of the economy after a good shock leading into their
middle age than they fell behind the economy after a bad shock leading into their middle
age. This led the current middle-aged cohort to have a significantly underlevered portfolio
after a good shock leading into their youth, but only slightly overlevered portfolio after a
bad shock leading into their youth.
    To summarize the history dependence of prices, we present the key price statistics con-
ditional on the current shock, the past shock, and the two past shocks in Table A1. The
kind of reasoning above can be extended to interpret the consequences of a longer history
of shocks, but the most recent shocks have the most powerful effect on the model economy.
One reason we include the effects of a three-shock history is the identity relating the realized




                                             A-14
tree return to the history of the price-dividend ratio:
                                                                         
                    Tree  Pt + Dt      Dt     1 + (Pt /Dt )          1 + pt
                  Rt =             =                          = Gt            .
                            Pt−1      Dt−1 Pt−1 /Dt−1                 pt−1

Thus, the realized tree return depends on the values of the price-dividend ratio in two
different periods. Among three-shock histories, the realized tree return is highest after
(Good, Good, Good) since the two good shocks at t − 2 and t − 1 depress pt−1 , while the
good shock at t gives a high Gt .11 The realized tree return is lowest after the three-shock
history (Good, Bad, Bad) because the combination of a good shock at t − 2 followed by a
bad shock at t − 1 elevates pt−1 , while the bad shock at t gives a low Gt .

                                Table A1: History Dependence of Key Variables
                            Pt /Dt               log RTree
                                                      t                  log Rt            E(log RTree
                                                                                                  t    )          E(log Zt )
  Gt                     Bad Good              Bad Good               Bad Good             Bad Good              Bad Good
  Mean                  19.20 18.69            1.61 5.60              1.75 2.10            3.91 4.08             2.16 1.98
  Gt−1
     Bad                18.99     19.23        1.51     5.60          1.81    1.96         3.96     3.95         2.15     1.98
     Good               19.41     19.17        1.71     5.60          1.68    2.23         3.86     4.20         2.18     1.97
  Gt−2 , Gt−1
     Bad, Bad           19.07     19.32        1.58     5.67          1.79    1.94         3.94     3.93         2.15     1.99
     Good, Bad          18.90     19.15        1.45     5.54          1.84    1.99         3.98     3.97         2.14     1.98
     Bad, Good          19.21     17.81        1.53     5.41          1.74    2.33         3.91     4.29         2.17     1.95
     Good, Good         19.59     18.52        1.87     5.79          1.62    2.12         3.81     4.11         2.19     1.99
  Note: Pt /Dt denotes the price-dividend ratio, log Rt denotes the log risk free interest rate, log RTree
                                                                                                         t    denotes the log
  realized tree return, given by log(Dt + Pt ) − log Pt−1 , E(log RTree
                                                                   t    ) denotes the expected log tree return, and E(log Zt )
  denotes the expected log excess return. All prices are annualized. All prices are in percentage, except the price-dividend
  ratio. Gt , Gt−1 and Gt−2 denote the dividend growth rate shock in period t, t − 1 and t − 2, respectively.


    Table A1 also shows that the risk free rate is higher after a good shock than after a
bad shock in period t. This pattern becomes particularly pronounced after a good shock in
period t − 1. The expected tree return is higher after a good shock in period t. However, the
pattern does not hold when we consider a two-period history of shocks. After a good shock
in period t − 1, the expected tree return is higher after a good shock. In contrast, after a
bad shock in period t − 1, the expected tree return is higher after a bad shock. The expected
excess return is lower after a good shock in period t, given the high aggregate risk tolerance
after a good shock in period t. The expected excess return is especially low after a history
of the bad and good shocks.




  11
    The realized tree return is second-highest after the three-shock history (Bad, Bad, Good) not only
because two bad shocks at t − 2 and t − 1 depress pt−1 somewhat, but also because the tail end of a bad
shock at t − 1 followed by a good shock at t puts pt at a reasonably high level as well as giving a high Gt .


                                                               A-15
Appendix C: Alternative Parameterizations
We solve the model with different sets of numerical assumptions to determine how robust
our primary findings are. First, we recalculate the risk tolerances of cautious and daring
agents setting the standard deviation of risk tolerance equal to 0.085, which is half of the
standard deviation of the risk tolerances listed in Table 1. We then solve the model with
the other assumptions in Table 1 and report results analogous to Table 2 below. Next we
we double the standard deviation of risk tolerances. Finally, we both halve and double the
standard deviations of economic shocks and report the results below. In each case we find
results that are qualitatively similar to those obtained with our main parameterization in
the text.

                                  Table A2: Low Dispersion in Tolerance
                         Portfolio Share θ                 Savings Weight       Wi
                                                                                W         Tree Amount θW
                                                                                                       W
                                                                                                         i

     Gt                Average Bad Good                    Bad      Good                  Bad     Good
     Cautious             72      76      69                92       88                    70      61
        Young             72      76      69                60       61                    46      42
        Middle            73      76      70                32       27                    24      19

     Daring               359        388       330            8           12               30            39
       Young              360        389       330            5            5               20            18
       Middle             359        388       330            2            7               10            22

     Total                  95       101        90        100.0         100.0             100           100
       Young                95       101        90          66            66               66            59
       Middle               96       101        90          34            34               34            41
     Note: The portfolio share is the ratio of risky assets and savings of each type, the savings weight is the
     fraction of each type’s savings in total savings, and the tree amount is the amount of tree held by each type.
     In particular, the tree amount equals the savings weight times the portfolio share for each type. Both the
     tree amount and the savings weight should sum up to 100 percent across types. Savings is after-consumption
     wealth. Gt denotes the dividend growth rate shock in period t.




                                                         A-16
                            Table A3: High Dispersion in Tolerance
                    Portfolio Share θ                  Savings Weight       Wi
                                                                            W         Tree Amount θW
                                                                                                   W
                                                                                                     i

Gt                Average Bad Good                     Bad      Good                  Bad     Good
Cautious             23      27      18                 94       81                    25      14
   Young             21      27      15                 60       62                    16      10
   Middle            24      28      21                 34       19                     9       4

Daring               860        1226      495            6            19               75           86
  Young              853        1213      492            5             5               63           27
  Middle             868        1238      499            1            14               12           59

Total                  90        123        56       100.0         100.0              100          100
  Young                88        122        54         65            67                79           37
  Middle               92        124        59         35            33                22           63
Note: The portfolio share is the ratio of risky assets and savings of each type, the savings weight is the
fraction of each type’s savings in total savings, and the tree amount is the amount of tree held by each type.
In particular, the tree amount equals the savings weight times the portfolio share for each type. Both the
tree amount and the savings weight should sum up to 100 percent across types. Savings is after-consumption
wealth. Gt denotes the dividend growth rate shock in period t.




                              Table A4: Low Dispersion in Growth
                    Portfolio Share θ                 Savings Weight       Wi
                                                                           W         Tree Amount θW
                                                                                                  W
                                                                                                    i

Gt                Average Bad Good                    Bad      Good                  Bad     Good
Cautious             66      69      63                93       89                    64      56
   Young             66      69      62                60       61                    42      38
   Middle            66      69      63                32       29                    22      18

Daring               454        489       418            7           11               36            44
  Young              454        490       418            5            5               26            22
  Middle             453        489       418            2            5               10            22

Total                  97       103        91        100.0         100.0             100           100
  Young                97       103        90          66            66               68            60
  Middle               97       103        91          34            34               32            40
Note: The portfolio share is the ratio of risky assets and savings of each type, the savings weight is the
fraction of each type’s savings in total savings, and the tree amount is the amount of tree held by each type.
In particular, the tree amount equals the savings weight times the portfolio share for each type. Both the
tree amount and the savings weight should sum up to 100 percent across types. Savings is after-consumption
wealth. Gt denotes the dividend growth rate shock in period t.




                                                    A-17
                              Table A5: High Dispersion in Growth
                    Portfolio Share θ                  Savings Weight       Wi
                                                                            W         Tree Amount θW
                                                                                                   W
                                                                                                     i

Gt                Average Bad Good                     Bad      Good                  Bad     Good
Cautious             19      22      17                 93       75                    20      12
   Young             19      22      15                 59       65                    13      10
   Middle            20      22      18                 34       10                     7       2

Daring               746        1091      401            7            25               80           88
  Young              750        1100      401            5             6               57           24
  Middle             742        1083      401            2            19               23           64

Total                  77        108        47       100.0         100.0              100          100
  Young                77        108        46         64            70                70           34
  Middle               78        107        48         36            30                31           66
Note: The portfolio share is the ratio of risky assets and savings of each type, the savings weight is the
fraction of each type’s savings in total savings, and the tree amount is the amount of tree held by each type.
In particular, the tree amount equals the savings weight times the portfolio share for each type. Both the
tree amount and the savings weight should sum up to 100 percent across types. Savings is after-consumption
wealth. Gt denotes the dividend growth rate shock in period t.




                                                    A-18
Appendix D: Key Model Variables
We list all of the important model variables with a short description in this table. In the
table j ∈ {H, L} and g ∈ {Y, M, O}. Note that key model parameters are defined in Table
??.

                              Table A6: Key Model Variables
      Variable   Per Dt   Description
      Dt                  Total dividends and level of technology
      Pt         pt       Price of one unit of tree
      Yt         yt       Aggregate output
      Rt                  Gross risk free rate
      Zt                  Excess tree return
         j
      Cgt        cjgt     Consumption for age g and tolerance j
      Wgtj       wgtj
                          Wealth for age g and tolerance j
        j          j
      Sgt        sgt      Tree holdings for age g and tolerance j
         j
      Bgt        bjgt     Bond holdings for age g and tolerance j
       j
      θgt                 Risky asset share for age g and tolerance j
      φjgt                Certainty equivalent total return for age g and tolerance j




                                           A-19
