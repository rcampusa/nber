                                 NBER WORKING PAPER SERIES




                     STRUCTURAL EQUATIONS, TREATMENT EFFECTS
                        AND ECONOMETRIC POLICY EVALUATION

                                           James J. Heckman
                                            Edward Vytlacil

                                         Working Paper 11259
                                 http://www.nber.org/papers/w11259


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      March 2005




This paper was presented by Heckman as the Fisher-Schultz Lecture at the Eighth World Meetings of the
Econometric Society, Seattle, Washington, August 13, 2000. This paper was also presented at the seminar
on Applied Price Theory at the Graduate School of Business, University of Chicago in October 2000, at a
seminar at Upsalla University, December 2000, at Harvard University, April 2001, and at the Montreal
Econometrics Seminar, September 2003. We thank Jaap Abbring, Richard Blundell and two anonymous
referees for helpful comments on the first round reports. We benefited from the close reading of Ricardo
Avelino, Jean-Marc Robin, Sergio Urzua, and Weerachart Kilenthong on the second draft. We have benefited
from a close reading by Jora Stixrud and Sergio Urzua on the third draft. We have also benefited from
comments by an anonymous referee on the second draft of this paper. Sergio Urzua provided valuable
research assistance in programming the simulations reported in this paper and was assisted by Hanna Lee.
Urzua made valuable contributions to our understanding of the random coefficient case and cases with
negative weights and made numerous valuable comments on this draft, as did Weerachart Kilenthong. See
our companion paper (Heckman, Urzua, and Vytlacil, 2004) where these topics are developed further. This
research was supported by NSF 97-09-873, NSF-00-99195, NSF SES-0241858, and NIH R01 HD043411,
and the American Bar Foundation. The views expressed herein are those of the author(s) and do not
necessarily reflect the views of the National Bureau of Economic Research.

©2005 by James J. Heckman and Edward Vytlacil. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is
given to the source.
Structural Equations, Treatment Effects and Econometric Policy Evaluation
James J. Heckman and Edward Vytlacil
NBER Working Paper No. 11259
March 2005
JEL No. C1

                                           ABSTRACT

This paper uses the marginal treatment effect (MTE) to unify the nonparametric literature on
treatment effects with the econometric literature on structural estimation using a nonparametric
analog of a policy invariant parameter; to generate a variety of treatment effects from a common
semiparametric functional form; to organize the literature on alternative estimators; and to explore
what policy questions commonly used estimators in the treatment effect literature answer. A
fundamental asymmetry intrinsic to the method of instrumental variables is noted. Recent advances
in IV estimation allow for heterogeneity in responses but not in choices, and the method breaks down
when both choice and response equations are heterogeneous in a general way.

James J. Heckman
Department of Economics
The University of Chicago
1126 E. 59th Street
Chicago, IL 60637
and NBER
j-heckman@uchicago.edu

Edward Vytlacil
Stanford University
vytlacil@stanford.edu
       Evaluating the impacts of public policies, forecasting their effects in new environments, and predicting
the effects of policies never tried are three central tasks of economics. The structural approach and the
treatment effect approach are two competing paradigms of policy evaluation.
       The structural approach emphasizes clearly articulated economic models that can be used to accom-
plish all three tasks under the exogeneity and parameter policy invariance assumptions presented in that
literature. (See Hansen and Sargent, 1981; Hendry, 1995.) Economic theory is used to guide the con-
struction of models and to suggest included and excluded variables. The functional form and exogeneity
assumptions invoked in this literature are sometimes controversial (see, e.g., Angrist and Krueger, 1999)
and the sources of identification of parameters of these models are often not clearly articulated.
       The treatment effect literature as currently developed focuses on the first task—evaluating the impact
of a policy in place—in the special case where there is a “treatment group” and a “comparison group,”
i.e. a group of nonparticipants. In the language of that literature, “internal validity” is the primary goal
and issues of forecasting out of sample or of evaluating new policies receive little attention.1 Because
of its more limited goals, fewer explicit functional form and exogeneity assumptions are invoked. The
literature on treatment effects has given rise to a new language of economic policy analysis where the link
to economic theory is often obscure and the economic policy questions being addressed are not always
clearly stated. Different instruments answer different economic questions that typically are not clearly
stated. Relationships among the policy parameters implicitly defined by alternative choices of instruments
are not articulated.
       This paper unites the two approaches to policy evaluation using the Marginal Treatment Effect (MTE )
under the assumption that analysts have access to treatment and comparison groups. The MTE is the
mean response of persons to treatment at a margin that is precisely defined in this paper. It is a willingness
to pay measure when outcomes are values under alternative treatment regimes.
       Under the conditions specified in this paper, the MTE can be used to construct and compare alter-
native conventional treatment effects, a new class of policy relevant treatment effects and the probability
limits produced from instrumental variable estimators and matching estimators. Using the MTE, this
paper unites the selection (control function) approach, defined in a nonparametric setting, with the recent
   1
    Internal validity means that a treatment parameter defined in a specified environment is free of selection bias. It is
defined more precisely below.



                                                            2
literature on instrumental variables.
      A major focus in the recent microeconomic policy evaluation literature, and a major theme of this
paper, is on constructing and estimating models with heterogeneity in responses to treatment among
otherwise observationally identical people. This literature emphasizes that responses to treatment vary
among observationally identical people, and crucially, that agents select (or are selected) into treatment
at least in part based on their own idiosyncratic response to it. This emphasis is in marked contrast
to the emphasis in the conventional representative-agent macro time series literature that ignores such
heterogeneity despite ample microeconometric evidence on it.2
      Entire classes of econometric evaluation estimators can be organized by whether or not they allow for
the possibility of selection based on unobserved components of heterogeneous responses to treatment. In
the presence of such heterogeneity, a variety of different mean treatment effects can be defined for different
instruments and conditioning sets. In the absence of such heterogeneity, these different treatment effects
collapse to the same parameter.3
      The dependence of estimated treatment parameters on instruments is an important and not widely
understood feature of models with heterogeneous responses on which people act.4 Instrument-dependent
parameters arise in this class of models, something excluded by assumption in conventional structural
econometric models that emphasize the estimation of invariant parameters. Two economists analyzing the
same data set but using different valid instruments will estimate different parameters that have different
economic interpretations. Even more remarkably, two economists using the same instrument but with dif-
ferent notions about what variables belong in choice equations will interpret the output of an instrumental
variable analysis differently. Intuitions about “identifying strategies” acquired from analyzing conventional
models where responses to treatment do not vary among persons are not valid in the more general setting
analyzed in this paper. The choice of an instrument defines the treatment parameter being estimated.
The relevant question regarding the choice of instrumental variables in the general class of models stud-
ied in this paper is “What parameter is being identified by the instrument?” rather than the traditional
question of “What is the efficient combination of instruments for a fixed parameter?”—the question that
  2
    Heckman (2001) summarizes the evidence on heterogeneity in responses to treatment on which agents select into treat-
ment.
  3
    See Heckman (1997); Heckman and Robb (1985, 1986); Heckman and Vytlacil (1999).
  4
    This dependence was first noted by Heckman and Robb (1985, p. 196). See also Angrist, Graddy, and Imbens (2000).



                                                           3
has traditionally occupied the attention of econometricians who study instrumental variables. Even in the
presence of least squares bias, and even assuming large samples, IV based on classical assumptions may
be more biased for a given policy parameter than OLS. The cure may be worse than the disease.
      We extend the method of instrumental variables to estimate economically interpretable parameters
in models with heterogeneous treatment outcomes. We note a fundamental asymmetry intrinsic to the
method of instrumental variables. Treatment outcomes can be heterogeneous in a general way that we
make precise in this paper. Choice equations cannot be heterogeneous in the same general way. When
choices and treatment outcomes are analyzed symmetrically, the method of instrumental variables and
our extension of it breaks down, and more explicit structural approaches are necessary to solve policy
evaluation problems.
      The plan of this paper is as follows. Section 1 presents a prototypical microeconometric structural
model as a benchmark to define and motivate the various treatment parameters used in the literature and
to compare and contrast structural estimation approaches with those used in the literature on treatment
effects. We then define our general model and assumptions in Section 2. Our model extends the treatment
effect literature by introducing choice theory into it and by using a weaker set of assumptions than those
used in the structural literature to define and identify the marginal treatment effect (MTE ). This section
shows how the MTE can be used to generate and unify the various treatment parameters advocated in
the recent literature and provides an economic foundation for the treatment effect literature. We derive a
set of testable restrictions implied by our model, and we apply the general analysis to the special case of
a parametric Generalized Roy Model.
      The conventional treatment parameters do not, in general, answer questions of economic or policy
interest. Section 3 shows how to use the MTE to define policy relevant parameters that answer well posed
economic questions. Evaluation of different policies requires different weights for the MTE. The MTE
plays the role of a policy invariant structural parameter in conventional econometrics for a class of policy
interventions defined in this paper.5
      Section 4 organizes entire classes of econometric estimators on the basis of what they assume about
the role of unobservables in the MTE function, conditional on X. Our analysis shows that traditional
instrumental variables procedures require that the marginal treatment effect is the same for all persons
  5
      Hendry (1995) discusses the role of policy invariant parameters in macro-forecasting and policy evaluation.


                                                               4
of given X characteristics. When the marginal treatment effect varies over individuals with the same
X, we show how the instrumental variables estimand (the probability limit of the instrumental variables
estimator) can be written as a weighted average of MTE, where our general expressions nest previous
results in the literature as special cases. The interpretation of the IV estimand depends not only on
the choice of instrument used but also on what other variables are included in the choice model even if
they are not used as instruments. We show that it is not always possible to pick an instrument that
answers a particular policy problem of interest, and we show that not all instruments answer well defined
policy questions. We present necessary and sufficient conditions to construct an instrument to produce
a particular policy counterfactual, and show how to construct the instrument when the conditions are
satisfied. We develop necessary and sufficient conditions for a particular instrument to answer some well
defined policy question, and show how to construct the policy counterfactual when the conditions are
satisfied. We focus on instrumental variables in this paper but also consider matching and ordinary least
squares as special cases of our general model for IV.
   Section 5 returns to the policy evaluation problem. The treatment effect literature can be used to answer
certain narrowly focused questions under weaker assumptions than are required to recover conventional
structural parameters that answer a broad range of questions. When we attempt to address the broader
set of questions entertained in the structural econometrics literature, additional conditions are required to
extrapolate existing policies to new environments and to provide accurate forecasts of new policies never
previously experienced. The weaker identifying assumptions invoked in the treatment effect literature
are possible because of the narrower set of questions addressed by that literature. In the language of the
treatment effect literature, internal validity (absence of selection bias) does not imply external validity (the
ability to generalize). When the same policy forecasting questions addressed by the structural literature are
asked of the treatment effect literature, the assumption sets used in the two literatures look very similar,
especially for nonparametric versions of structural models. External validity requires stronger conditions.
   Section 6 discusses the fundamental role played by the assumed absence of general forms of heterogeneity
in choice equations invoked in the recent literature under the rubric of “monotonicity” assumptions. When
both choices and treatment outcomes are modelled symmetrically, the method of instrumental variables
breaks down, and a different approach to policy analysis is required. Section 7 concludes.



                                                        5
1       A Latent Variable Framework

The treatment effect literature investigates a class of policies that have partial participation at a point in
time so there is a “treatment” group and a “comparison” group. It is not helpful in evaluating policies
that have universal participation. In contrast, the structural econometrics literature can evaluate policies
with universal participation by using functional form and support conditions to substitute for lack of a
comparison group (see Heckman and Vytlacil, 2005). Throughout this paper we follow the conventional
practice in the literature and ignore general equilibrium effects.6
      In order to link our discussion to the literature on structural econometrics, it is fruitful to compare how
the two different approaches analyze a Generalized Roy Model for two potential outcomes (Y0 , Y1 ). This
model is widely used in applied econometrics (see Amemiya, 1985, and Heckman, 2001).
      Write potential outcomes (Y0 , Y1 ) for conditioning variables X as


                                                   Y0 = µ0 (X) + U0                                                  (1a)


and
                                                  Y1 = µ1 (X) + U1 ,                                                 (1b)

where Y1 is the outcome if treated and Y0 is the outcome if not treated.7 In a model of educational
attainment, Y1 is the present value of college earnings and Y0 is the present value of earnings in the
benchmark no-treatment state (e.g. high school). Let D = 1 denote receipt of treatment so that Y1 is
observed, while D = 0 denotes that treatment was not received so that Y0 is observed. In the educational
attainment example, D = 1 if the individual selects into college, D = 0 otherwise. The observed outcome
Y is given by
                                               Y = DY1 + (1 − D)Y0 .                                                 (1c)

Let
                                                  C = µC (Z) + UC                                                    (1d)
   6
     See, however, the studies by Heckman, Lochner, and Taber (1998), who demonstrate the empirical importance of inves-
tigating general equilibrium effects in the context of evaluating the returns to schooling.
   7
     Throughout this paper, we denote random variables/random vectors by capital letters and potential realizations by the
corresponding lower case letter. For example, X denotes the random vector, and x denotes a potential realization of the
random vector X.


                                                            6
denote the cost of receiving treatment. Net utility is D∗ = Y1 − Y0 − C and the agent selects into treatment
if the net utility from doing so is positive, D = 1[D∗ ≥ 0].
      The original Roy Model (1951) is a special case of this framework when there are zero costs of treatment,
µC (Z) = 0 and UC = 0. The generalized Roy model allows for costs of treatment, both driven by observable
determinants of the cost of treatment, Z, and unobservable determinants of the cost of treatment, UC . For
example, in the educational attainment example, tuition and family income operate through direct costs
µC (Z) to determine college attendance, while UC might include disutility from studying. The model can
be generalized to incorporate uncertainty about the benefits and costs of treatment and to allow for more
general decision rules. Let I denote the information set available to the agent at the time when the agent
is deciding whether to select into treatment. If, for example, the agent selects into treatment when the
expected benefit exceeds the expected cost, then the index is D∗ = E(Y1 − Y0 − C | I). The decision to
participate is based on I and D = 1[D∗ ≥ 0] where D∗ is a random variable measurable with respect to
I.8
      Conventional approaches used in the structural econometrics literature assume that (X, Z) ⊥⊥ (U0 , U1 , UC ),
       ⊥” denotes independence. In addition, they adopt parametric assumptions about the distributions
where “⊥
of the error terms and functional forms of the estimating equations, and identify the full model that can
then be used to construct a variety of policy counterfactuals. The most commonly used specification of
this model writes µ0 (X) = Xβ0 , µ1 (X) = Xβ1 , µC (Z) = ZβC and assumes (U0 , U1 , UC ) ∼ N (0, Σ). This
is the normal selection model (Heckman, 1976).
      The parametric normal framework can be used to answer all three policy evaluation questions. First,
it can be used to evaluate existing policies by asking how policy-induced changes in X or Z affect (Y, D).
Second, it can be used to extrapolate old policies to new environments by computing outcomes for the
values of X, Z that characterize the new environment. Linearity and distributional assumptions make
extrapolation straightforward. Third, this framework can be used to evaluate new policies if they can be
expressed as some known functions of (X, Z). For example, consider the effect of charging tuition in an
environment where tuition has never before been charged. If tuition can be put on the same footing as
(made comparable with) another measure of cost that is measured and varies, or with returns that can be
  8
      See Cunha, Heckman, and Navarro (2005) for a version of this model.




                                                            7
measured and vary, then we can use the estimated response to the variation in observed costs or returns
to estimate the response to the new tuition policy.9
        This paper relaxes the functional form and distributional assumptions used in the structural literature
and still identifies an economically interpretable model that can be used for policy analysis. Recent
semiparametric approaches relax both distributional and functional form assumptions of selection models,
but typically assume exogeneity of X (see, e.g., Powell, 1994) and do not estimate treatment effects except
through limit arguments (Heckman, 1990; Andrews and Schafgans, 1998).10 The treatment effect literature
seeks to bypass the ad hoc assumptions used in the structural literature and estimate treatment effects
under weaker conditions. The goal of this literature is to examine the effects of policies in place (i.e. to
produce internally valid estimators) rather than to forecast new policies or old policies on new populations.




2         Treatment Effects

We now present the model of treatment effects developed in Heckman and Vytlacil (1999) and Heckman,
Urzua, and Vytlacil (2004), which relaxes most of the controversial assumptions discussed in Section 1. It
is a nonparametric selection model with testable restrictions that can be used to unify the treatment effect
literature, identify different treatment effects, link the literature on treatment effects to the literature in
structural econometrics and interpret the implicit economic assumptions underlying instrumental variables
and matching methods. We follow Heckman and Vytlacil (1999) and Heckman, Urzua, and Vytlacil (2004)
in considering binary treatments. Heckman and Vytlacil (2005) and Heckman, Urzua, and Vytlacil (2004)
extend this analysis to the case of a discrete, multi-valued treatment, for both ordered and unordered
models, while Florens, Heckman, Meghir, and Vytlacil (2002) develop a related model with a continuum
of treatments.
        We use the general framework of Section 1, equations (1a)–(1d), and define Y as the measured outcome
    9
     For example, in a present value income maximizing model of schooling, costs and returns are on the same footing so
knowledge of how schooling responds to returns is enough to determine how schooling responds to costs. See Section 5.1.
  10
     A large part of the literature is concerned with estimation of slope coefficients (e.g., Ahn and Powell, 1993) and not the
counterfactuals needed for policy analysis. Heckman (1990) develops the more demanding conditions required to identify
policy counterfactuals.



                                                              8
variable. We do not impose any assumption on the support of the distribution of Y . We use the more
general nonlinear and nonseparable outcome model


                                                   Y1 = µ1 (X, U1 )                                                     (2a)

                                                   Y0 = µ0 (X, U0 ).                                                    (2b)


Examples include conventional latent variable models: Yi = 1 if Yi∗ = µi (X) + Ui ≥ 0 and Yi = 0 otherwise;
i = 0, 1. Notice that in the general case, µi (X, Ui )−E(Yi | X) 6= Ui , i = 0, 1, so even if the µi are structural,
the E(Yi | X) are not.11
       The individual treatment effect associated with moving an otherwise identical person from “0” to “1”
is Y1 − Y0 = ∆ and is defined as the effect on Y of a ceteris paribus move from “0” to “1”. These
ceteris paribus effects are called “causal effects.” To link this framework to the literature on structural
econometrics, we characterize the decision rule for program participation by an index model:


                      D∗ = µD (Z) − UD ;          D = 1 if D∗ ≥ 0 ;             D = 0 otherwise,                         (3)


where (Z, X) is observed and (U1 , U0 , UD ) is unobserved. The random variable UD may be a function
of (U0 , U1 ). For example, in the Roy Model UD = U1 − U0 , and in the Generalized Roy Model UD =
U1 −U0 −UC . Without loss of generality, Z includes all of the elements of X. However, our analysis requires
that Z contain at least one element not in X. The following assumptions are weaker than those used in
the conventional literature on structural econometrics or the recent literature on semiparametric selection
models and at the same time can be used to both define and identify different treatment parameters.12
The assumptions are:


(A-1) µD (Z) is a nondegenerate random variable conditional on X;

(A-2) The random vectors (U1 , UD ) and (U0 , UD ) are independent of Z conditional on X;

(A-3) The distribution of UD is absolutely continuous with respect to Lebesgue measure;
  11
    See Heckman and Vytlacil (2005) for alternative definitions of structure.
  12
    As noted in Section 2, and Heckman and Vytlacil (2001b), a much weaker set of conditions is required to define the
parameters than is required to identify them. As noted in Section 5, stronger conditions are required for policy forecasting.


                                                             9
(A-4) The values of E|Y1 | and E|Y0 | are finite; and

(A-5) 1 > Pr(D = 1 | X) > 0.


       Assumptions (A-1) and (A-2) are “instrumental variable” assumptions that there is at least one vari-
able that determines participation in the program that is not in X and that is independent of potential
outcomes (Y0 , Y1 ) given X. These are the assumptions used in the natural and social experiment litera-
tures where randomization or pseudorandomization generates instruments. (A-2) also assumes that UD is
independent of Z given X and is used below to generate counterfactuals. Assumption (A-3) is a technical
assumption made primarily for expositional convenience. Assumption (A-4) guarantees that the conven-
tional treatment parameters are well defined. Assumption (A-5) is the assumption in the population of
both a treatment and a control group for each X. Observe that there are no exogeneity requirements for
X. This is in contrast with the assumptions commonly made in the conventional structural literature and
the semiparametric selection literature (see, e.g., Powell, 1994). A counterfactual “no feedback” condition
facilitates interpretability so that conditioning on X does not mask the effects of D. Letting Xd denote a
value of X if D is set to d, a sufficient condition that rules out feedback from D to X is:


(A-6) X1 = X0 almost everywhere.


Condition (A-6) is not strictly required to formulate an evaluation model, but it enables an analyst who
conditions on X to capture the “total” or “full effect” of D on Y (see Pearl, 2000). This assumption
imposes the requirement that X is an external variable determined outside the model and is not affected
by counterfactual manipulations of D. However, the assumption allows for X to be freely correlated with
U1 , U0 and UD so it can be endogenous in this sense. In this paper, we examine treatment effects conditional
on X, and we maintain assumption (A-6) in this paper.
       Define P (Z) as the probability of receiving treatment given Z: P (Z) ≡ Pr(D = 1 | Z) = FUD |X (µD (Z)),
where FUD |X (·) denotes the distribution of UD conditional on X.13 We often denote P (Z) by P , suppressing
the Z argument. As a normalization, we impose UD ∼ Unif[0, 1] and µD (Z) = P (Z). This normalization
is innocuous given our assumptions, because if the latent variable generating choices is D∗ = ν(Z) − V,
  13
    Throughout this paper, we will refer to the cumulative distribution function of a random vector A by FA (·) and to
the cumulative distribution function of a random vector A conditional on random vector B by FA|B (·). We will write the
cumulative distribution function of A conditional on B = b by FA|B (· | b).


                                                          10
where V is a general continuous random variable, we can apply a probability transform to reparameterize
the model so that µD (Z) = FV |X (ν(Z)) and UD = FV |X (V ).14
       Vytlacil (2002) establishes that assumptions (A-1)–(A-5) for selection model (2a), (2b) and (3) are
equivalent to the assumptions used to generate the LATE model of Imbens and Angrist (1994). Thus the
nonparametric selection model for treatment effects developed in this paper is equivalent to an influential
instrumental variable model for treatment effects. Our latent variable model satisfies their assumptions
and their assumptions generate our latent variable model. Our latent variable model is a version of the
standard sample selection bias model.
       Our model and assumptions (A-1)–(A-5) impose two testable restrictions on the distribution of (Y, D,
Z, X). First it imposes an index sufficiency restriction: for any measurable set A and for j = 0, 1,


                            Pr(Yj ∈ A | X, Z, D = j) = Pr(Yj ∈ A | X, P (Z), D = j).


This restriction has empirical content when Z contains two or more variables not in X. Second, the
model also imposes a testable monotonicity restriction in P = p for E(Y D | X = x, P = p) and
E(Y (1 − D) | X = x, P = p) which we develop in Appendix A.
       Even though the model of treatment effects developed in this paper is not the most general possible
model, it has testable implications and hence empirical content. It unites various literatures and produces
a nonparametric version of the widely used selection model, and links the treatment literature to economic
choice theory.


Definitions of Treatment Effects

The difficulty of observing the same individual in both treated and untreated states leads to the use
of various population level treatment effects widely used in the biostatistics literature and applied in
economics.15 The most commonly invoked treatment effect is the Average Treatment Effect (ATE ):
  14
     This representation is valid whether or not (A-2) is true. However, (A-2) imposes restrictions on counterfactual choices.
For example, if a change in government policy changes the distribution of Z by an external manipulation, under (A-2) the
model can be used to generate the choice probability from P (z) evaluated at the new arguments i.e., the model is invariant
with respect to the distribution Z.
  15
     Heckman, LaLonde, and Smith (1999) discussed panel data cases where it is possible to observe both Y0 and Y1 for the
same person.



                                                             11
∆ATE (x) ≡ E(∆ | X = x) where ∆ = Y1 − Y0 . This is the effect of assigning treatment randomly
to everyone of type X assuming full compliance, and ignoring general equilibrium effects.                          The av-
erage impact of treatment on persons who actually take the treatment is Treatment on the Treated
(TT ): ∆TT (x) ≡ E(∆ | X = x, D = 1). This parameter can also be defined conditional on P (Z):
∆TT (x, p) ≡ E(∆ | X = x, P (Z) = p, D = 1).16
         The mean effect of treatment on those for whom X = x and UD = uD , the Marginal Treatment Effect
(MTE ), plays a fundamental role in our analysis:


                                       ∆MTE (x, uD ) ≡ E(∆ | X = x, UD = uD ).                                           (4)

The MTE is the expected effect of treatment conditional on observed characteristics X and conditional on
UD , the unobservables from the first stage decision rule. For uD evaluation points close to zero, ∆MTE (x, uD )
is the expected effect of treatment on individuals with the value of unobservables that make them most
likely to participate in treatment and who would participate even if the mean scale utility µD (Z) were
small. If UD is large, µD (Z) would have to be large to induce people to participate.
         One can also interpret E(∆ | X = x, UD = uD ) as the mean gain in terms of Y1 − Y0 for persons with
observed characteristics X who would be indifferent between treatment or not if they were exogenously
assigned a value of Z, say z, such that µD (z) = ud . When Y1 and Y0 are value outcomes, MTE is a mean
willingness to pay measure. MTE is a choice-theoretic building block that unites the treatment effect,
selection and matching literatures.
         A third interpretation is that MTE conditions on X and the residual defined by subtracting the
expectation of D∗ from D∗ : ŨD = D∗ − E (D∗ | Z, X) . These three interpretations are equivalent under
separability in D∗ , i.e., when (3) characterizes the choice equation, but lead to three different definitions of
MTE when a more general nonseparable model is developed. This point is developed further in Section 6.
         The LATE parameter of Imbens and Angrist (1994) is a version of MTE. Define Dz as a counterfactual
choice variable, with Dz = 1 if D would have been chosen if Z had been set to z, and Dz = 0 otherwise.
Let Z(x) denote the support of the distribution of Z conditional on X = x. For any (z, z 0 ) ∈ Z(x) × Z(x)
such that P (z) > P (z 0 ), LATE is E(∆ | X = x, Dz = 1, Dz0 = 0) = E(Y1 − Y0 | X = x, Dz = 1, Dz0 = 0),
    16
      These two definitions of treatment on the treated are related by integrating out the conditioning p variable: ∆TT (x) =
R1
0
     ∆TT (x, p)dFP (Z)|X,D (p|x, 1) where FP (Z)|X,D (·|x, 1) is the distribution of P (Z) given X = x and D = 1.


                                                              12
the mean gain to persons who would be induced to switch from D = 0 to D = 1 if Z were manipulated
externally from z 0 to z. From the latent index model, it follows that LATE can be written as


          E(Y1 − Y0 | X = x, Dz = 1, Dz0 = 0) = E(Y1 − Y0 | X = x, u0D ≤ UD < uD ) = ∆LATE (x, uD , u0D )


for uD = Pr(Dz = 1) = P (z), u0D = Pr(Dz0 = 1) = P (z 0 ), where assumption (A-2) implies that Pr(Dz =
1) = Pr(D = 1 | Z = z) and Pr(Dz0 = 1) = Pr(D = 1 | Z = z 0 ). Imbens and Angrist define the
LATE parameter as the probability limit of an estimator. Their analysis conflates issues of definition
of parameters with issues of identification. Our representation of LATE allows us to separate these
two conceptually distinct matters and to define the LATE parameter more generally. One can imagine
evaluating the right hand side of this equation at any uD , u0D points in the unit interval and not only at
points in the support of the distribution of the propensity score P (Z) conditional on X = x where it is
identified. From assumptions (A-2), (A-3), and (A-4), ∆LAT E (x, uD , u0D ) is continuous in uD and u0D and
 lim ∆LATE (x, uD , u0D ) = ∆MTE (x, uD ).17
u0D ↑uD
       Heckman and Vytlacil (1999) use assumptions (A-1)–(A-5) and the latent index structure to develop
the relationship between MTE and the various treatment effect parameters shown in the first three lines
of Table IA. For example, in that table ∆TT (x) is a weighted average of ∆MTE :

                                                  Z    1
                                     TT
                                   ∆      (x) =            ∆MTE (x, uD ) hT T (x, uD ) duD ,
                                                   0



where
                                                 1 − FP |X (uD | x)      SP |X (uD | x)
                           hT T (x, uD ) = R 1                      =                   ,                         (5)
                                                  1 − FP |X (t | x) dt E (P (Z) | X = x)
                                            0

and SP |X (uD | x) is Pr(P (Z) > uD | X = x) and hTT (x, uD ) is a weighted distribution (See Heckman
and Vytlacil, 2001b). The parameter ∆TT (x) oversamples ∆MTE (x, uD ) for those individuals with low
values of uD that make them more likely to participate in the program being evaluated. Treatment on the
untreated (TUT) is defined symmetrically with TT and oversamples those least likely to participate. The
  17
    This follows from Lebesgue’s theorem for the derivative of an integral and holds almost everywhere with respect to
Lebesgue measure. The ideas of the marginal treatment effect and the limit form of LATE were first introduced in the
context of a parametric normal Generalized Roy model by Björklund and Moffitt (1987), and were analyzed more generally
in Heckman (1997). Angrist, Graddy, and Imbens (2000) also define and develop a limit form of LATE.




                                                                  13
various weights are displayed in Table IB. The other weights, treatment effects and estimands shown in
this table are discussed later. A central theme of this paper is that under our assumptions all estimators
and estimands can be written as weighted averages of MTE.
      Observe that if E(∆ | X = x, UD = uD ) = E(∆ | X = x), so ∆ is mean independent of UD given
X = x, then ∆MTE = ∆ATE = ∆TT = ∆LATE . Therefore in cases where there is no heterogeneity in terms
of unobservables in MTE (∆ constant conditional on X = x) or agents do not act on it so that UD drops
out of the conditioning set, marginal treatment effects are average treatment effects, so that all of the
evaluation parameters are the same. Otherwise, they are different. Only in the case where the marginal
treatment effect is the average treatment effect will the “effect” of treatment be uniquely defined.
      Figure 1A plots weights for a parametric normal Generalized Roy Model generated from the parameters
shown at the base of Figure 1B. We discuss the contents of Figure 1B in section 4. A high uD is associated
with higher cost, relative to return, and less likelihood of choosing D = 1. The decline of MTE in terms
of higher values of uD means that people with higher uD have lower gross returns. TT overweights low
values of uD (i.e., it oversamples UD that make it likely to have D = 1). ATE samples UD uniformly.
Treatment on the Untreated (E(Y1 − Y0 | X = x, D = 0)) or TUT, oversamples the values of UD unlikely
to have D = 1.
      Table II shows the treatment parameters produced from the different weighting schemes. Given the
decline of the MTE in uD , it is not surprising that TT > ATE > TUT. The difference between TT and
ATE is a sorting gain: E(Y1 − Y0 | X, D = 1) − E(Y1 − Y0 | X), the average gain experienced by people
who sort into treatment compared to what the average person would experience. Purposive selection on
the basis of gains should lead to positive sorting gains of the sort found in the table. We return to this
table to discuss the other numbers in it.
      Heckman (2001) presents evidence on the nonconstancy of the MTE drawn from a variety of studies
of schooling, job training, migration and unionism. With the exception of studies of unionism, a common
finding in the empirical literature is the nonconstancy of MTE given X.18 The evidence from the literature
suggests that different treatment parameters measure different effects, and persons participate in programs
based on heterogeneity in responses to the program being studied. The phenomenon of nonconstancy of
the MTE that we analyze in this paper is of substantial empirical interest.
 18
      However, most of the empirical evidence is based on parametric models.


                                                            14
       The additively separable latent index model for D (equation 3) and assumptions (A-1)–(A-5) are far
stronger than what is required to define the parameters in terms of the MTE. The representations of
treatment effects defined in Table IA remain valid even if Z is not independent of UD , if there are no
variables in Z that are not also contained in X, or if a more general nonseparable choice model generates
D (so D∗ = µD (Z, UD )). No instrument is needed to define the parameters. These issues are discussed
further in Section 6.
       Assumptions (A-1)–(A-5) will be used to interpret what instrumental variables estimate, and to relate
instrumental variables to the policy relevant treatment effects. They are sufficient to identify ∆MTE (x, uD )
at any uD evaluation point that is a limit point of the support of the distribution of P (Z) conditional on
X = x.19 As developed in Section 6, without these assumptions and representations (in particular equation
(3)) for the choice equations, the IV method and our extension of it does not identify any economically
interpretable parameters.
       The literature on structural econometrics is clear about the basic parameters of interest although it is
not always clear about the exact combinations of parameters needed to answer specific policy problems.20
The literature on treatment effects offers a variety of evaluation parameters. Missing from that literature
is an algorithm for defining treatment effects that answer precisely formulated policy questions. The MTE
provides a framework for developing such an algorithm which we now develop.



3        Policy Relevant Treatment Parameters

The conventional treatment parameters do not always answer economically interesting questions. Their
link to cost benefit analysis and interpretable economic frameworks is often obscure.21 Each answers a
different question. Ignoring general equilibrium effects, ∆TT is one ingredient for determining whether or
not a given program should be shut down or retained. It is informative on the question of whether the
  19
     For example, if we additionally impose that the distribution of P (Z) conditional on X has a density with respect to
Lebesgue measure, then (A-1)–(A-5) enable us to identify ∆MTE (x, uD ) at all (x, uD ) evaluation points in the support of the
distribution of (X, P (Z)).
  20
     In a fundamental paper, Marschak (1953) shows how different combinations of structural parameters are required to
forecast the impacts of different policies. It is possible to answer many policy questions without identifying any of the
structural parameters individually. The treatment effect literature partially embodies this vision, but typically does not
define the economic question being answered, in contrast to Marschak’s approach. See Heckman (2001) and Heckman and
Vytlacil (2005).
  21
     Heckman and Vytlacil (2005) develop the relationship between these parameters and the requirements of cost benefit
analysis.

                                                             15
persons participating in a program benefit from it in gross terms.22 The parameter ∆MTE estimates the
gross gain from a marginal expansion of a program. Many investigators estimate a treatment effect and
hope that it answers an interesting question. A more promising approach to defining parameters is to
postulate a policy question or decision problem of interest and to derive the treatment parameter that
answers it. Taking this approach does not in general produce the conventional treatment parameters or
the estimands produced from instrumental variables.
       We consider a class of policies that affect P , the probability of participation in a program, but do not
affect ∆MTE . The policies analyzed in the treatment effect literature that change the Z not in X are more
restrictive than the general policies that shift X and Z analyzed in the structural literature. An example
from the schooling literature would be policies that change tuition or distance to school but do not directly
affect the gross returns to schooling. Since we ignore general equilibrium effects in this paper, the effects
on (Y0 , Y1 ) from changes in the overall level of education are assumed to be negligible.
       Let a and a0 denote two potential policies and let Da and Da0 denote the choices that would be made
under policies a and a0 . Let the corresponding decision rules be Da = 1[Pa (Za ) ≥ UD ], Da0 = 1[Pa0 (Za0 ) ≥
UD ], where Pa (Za ) = Pr(Da = 1 | Za ) and Pa0 (Za0 ) = Pr(Da0 = 1 | Za0 ). To simplify the exposition,
we will suppress the arguments of these functions and write Pa and Pa0 for Pa (Za ) and Pa0 (Za0 ). Define
(Y0,a , Y1,a , UD,a ) as (Y0 , Y1 , UD ) under policy a, and define (Y0,a0 , Y1,a0 , UD,a0 ) correspondingly under policy
a0 . We assume that Za and Za0 are independent respectively of (Y0,a , Y1,a , UD,a ) and (Y0,a0 , Y1,a0 , UD,a0 )
conditional on Xa and Xa0 . Let Ya = Da Y1,a + (1 − Da )Y0,a and Ya0 = Da0 Y1,a0 + (1 − Da0 )Y0,a0 , denote the
outcomes that would be observed under policies a and a0 , respectively.
       We define ∆MTE as policy invariant if

 Policy Invariance E(Y1,a | UD,a = u, Xa = x) and E(Y0,a | UD,a = u, Xa = x) are invariant to the choice
         of policy a.

Policy invariance can be justified by the strong assumption that the policy change does not change the
counterfactual outcomes, covariates, or unobservables, i.e., (Y0,a , Y1,a , Xa , UD,a ) = (Y0,a0 , Y1,a0 , Xa0 , UD,a0 ).
However, ∆MTE is policy invariant if this assumption is relaxed to the weaker assumption that the policy
change does not affect the distribution of these variables conditional on X:
  22
    It is necessary to account for costs to conduct a proper cost benefit analysis. See the discussion in Heckman and Vytlacil
(2005) for nonparametric cost-benefit analysis.

                                                             16
(A-7) The distribution of (Y0,a , Y1,a , UD,a ) conditional on Xa = x is the same as the distribution of
         (Y0,a0 , Y1,a0 , UD,a0 ) conditional on Xa0 = x.


We assume (A-7) holds and discuss invariance further in Appendix B.
       For the widely used Benthamite social welfare criterion V (Y ) , comparing policies using mean outcomes,
and considering the effect for individuals with a given level of X = x, we obtain the policy relevant
treatment effect, PRTE, denoted ∆PRTE (x):

                                                                Z     1
   E(V (Ya ) | X = x) − E (V (Ya0 ) | X = x) =                            ∆MTE
                                                                           V   (x, uD ){FPa0 |X (uD | x) − FPa |X (uD | x)} duD ,   (6)
                                                                  0



where FPa |X (· | x) and FPa0 |X (· | x) are the distributions of Pa and Pa0 conditional on X = x, respectively,
defined for the different policy regimes and ∆MTE
                                              V   = E(V (Y1,a ) − V (Y0,a ) | UD, a = u, Xa = x).23,24
The weights are derived in Appendix B under the assumption that the policy does not change the joint
distribution of outcomes. To simplify the notation, throughout the rest of this paper, we assume that
V (Y ) = Y. Modifications of our analysis for the more general case are straightforward.
       Define ∆P̄ (x) = E(Pa | X = x) − E(Pa0 | X = x), the change in the proportion of people induced
into the program due to the intervention. Assuming ∆P̄ (x) is positive, we may define per person af-
                                            FP           (uD |x)−FPa |X (uD |x)
                                                 a0 |X
fected weights as hPRTE (x, uD ) =                           ∆P̄ (x)
                                                                                   . These are the weights displayed in Table IB.
As demonstrated in the next section, in general, conventional IV weights ∆MTE
                                                                          V   differently than either
the conventional treatment parameters (∆ATE or ∆TT ) or the policy relevant parameters, and so does not
recover these parameters.
       Instead of hoping that conventional treatment parameters or favorite estimators answer interesting
economic questions, one approach developed in this paper is to estimate ∆MTE
                                                                         V   and weight it by the
appropriate weight determined by how the policy changes the distribution of P to construct ∆PRTE . An
alternative approach produces a policy weighted instrument to identify ∆PRTE by standard instrumental
  23
    We could define policy invariance for ∆MTE in terms of expectations of V (Y1,a ) and V (Y0,a ).
  24
    If we assume that the marginal distribution of Xa and Xa0 are the same as the marginal distribution of a benchmark X,
the weights can be integrated against the distribution of X to obtain the total effect of the policy in the population:

  E(V (Ya )) − E (V (Ya0 )) = EX {E(V (Ya ) | X) − E (V (Ya0 ) |X)}
                                                      Z Z 1                                                             
                                                   =          ∆MTE
                                                                V   (x, u D ){FPa0 |X (u D | x) − F Pa |X (u D | x)} du D dFX (x).
                                                                          0




                                                                              17
variables. We develop both approaches in the next section. Before doing so, we first consider what
conventional IV estimates and conditions for identifying ∆MTE . We also consider matching methods and
OLS.



4      Instrumental Variables, Local Instrumental Variables, OLS

       and Matching

In this section, we use ∆MTE to organize the literature on econometric evaluation estimators. We assume
(A-7) but for simplicity suppress the “a” and “a0 ” subscripts. We focus primarily on instrumental variable
estimators but also briefly consider the method of matching. We present the method of local instrumental
variables. Well established intuitions about instrumental variable identification strategies break down
when ∆MTE is nonconstant in uD given X. Two sets of instrumental variable conditions are presented in
the current literature for this more general case: those associated with conventional instrumental variable
assumptions which are implied by the assumption of “no selection on heterogenous gains” and those
which permit selection on heterogeneous gains. Neither set implies the other, nor does either identify the
policy relevant treatment effect in the general case. Each set of conditions identifies different treatment
parameters.
    In place of standard instrumental variables methods, we advocate a new approach to estimating policy
impacts by estimating ∆MTE using local instrumental variables (LIV ) to identify all of the treatment
parameters from a generator ∆MTE . ∆MTE can be weighted in different ways to answer different policy
questions. For certain classes of policy interventions discussed in Section 5, ∆MTE possesses an invariance
property analogous to the invariant parameters of traditional structural econometrics.
    We also consider whether it is possible to construct an instrument such that instrumental variables
directly estimate ∆PRTE . We establish necessary and sufficient conditions for the existence of such an
instrument. We also address the inverse question of whether instrumental variable estimators always answer
well-posed policy questions. In general, they do not. We present necessary and sufficient conditions for
a particular instrument to answer some policy counterfactual and characterize what question is answered
when an answer exists.



                                                    18
4.1     Conventional Instrumental Variables

In the general case with ∆MTE (x, uD ) nonconstant in uD , linear IV does not estimate any of the treatment
effects previously defined. Let J(Z) denote an instrument written as a function of Z. We sometimes
denote J(Z) by J, leaving implicit that J is a function of Z. The standard conditions J(Z) 6⊥
                                                                                            ⊥ (U1 , U0 ) and
Cov (J(Z), D) 6= 0 do not, by themselves, imply that instrumental variables using J(Z) as the instrument
will identify conventional or policy-relevant treatment effects. We must supplement the standard conditions
to identify interpretable parameters. To link our analysis to conventional analyses of IV, we invoke familiar-
looking representations of additive separability of outcomes in terms of (U1 , U0 ) so Y1 = µ1 (X) + U1 and
Y0 = µ0 (X) + U0 , but this is not strictly required. All derivations and results in this section hold without
any additive separability assumption if µ1 (x) and µ0 (x) are replaced by E(Y1 | X = x) and E(Y0 | X = x),
respectively, and U1 and U0 are replaced by Y1 − E(Y1 | X) and Y0 − E(Y0 | X), respectively.
   Two distinct sets of instrumental variable conditions in the literature are those due to Heckman and
Robb (1985, 1986) and Heckman (1997), and those due to Imbens and Angrist (1994). In the case where
∆MTE is nonconstant in uD , linear IV estimates different parameters depending on which assumptions are
maintained. To establish this point, it is useful to briefly review the IV method in the case of a common
treatment effect defined conditional on X, where Y1 − Y0 = ∆, with ∆ a deterministic function of X, and
where additive separability in outcomes is assumed, as in conventional models. Using (1a) and (1b) with
U1 = U0 = U , and assuming E(U |X) = 0, we may write Y = µ0 (X) + D∆ + U where ∆ = µ1 (X) − µ0 (X).
By the law of iterated expectations, E(U | X) = 0 and Z ⊥
                                                        ⊥ U | X imply E(U J(Z) | X) = 0. The
standard instrumental variables intuition is that when E(U J | X) = 0 and Cov (J, D | X) 6= 0, linear IV
identifies ∆:

        Cov (J, Y |X)   Cov (J, D∆|X)    Cov (J, D|X)
(IV )                 =               =∆              = ∆ = µ1 (X) − µ0 (X)
        Cov (J, D|X)     Cov (J, D|X)    Cov (J, D|X)

where the second equality follows from the assumption that ∆ is a deterministic function of X. This
intuition breaks down in the heterogeneous response case where the outcomes are generated by different
unobservables (U0 6= U1 ) so Y = µ0 (X) + D∆ + U0 , where ∆ = µ1 (X) − µ0 (X) + U1 − U0 . This is a variable
response model.
   There are two important cases of the variable response model. The first case arises when responses are
heterogeneous, but conditional on X: people do not base their participation on these responses. In this

                                                     19
case, the following condition holds:

        ⊥ ∆ | X =⇒ E(∆ | X, UD ) = E(∆ | X), ∆M T E (x, uD ) is constant in uD and ∆M T E = ∆AT E =
(C-1) D ⊥
     ∆T T = ∆LAT E .

The second case arises when the following condition holds:

(C-2) D 6⊥
         ⊥ ∆|X and E(∆ | X, UD ) 6= E(∆ | X).



In this case ∆MTE is nonconstant and the treatment parameters differ among each other.
   Application of the standard IV equation to the general variable coefficient model produces the first
equality in IV above. Now, however, ∆ is not a deterministic function of X and thus we cannot simply take
∆ outside of the covariance term as in the third term of (IV ). Plugging in ∆ = µ1 (X) − µ0 (X) + U1 − U0 ,
we obtain
                       Cov (J, D∆|X)                     Cov (J, D(U1 − U0 )|X)
                                     = µ1 (X) − µ0 (X) +                        .
                        Cov (J, D|X)                         Cov (J, D|X)

Our independence assumptions imply that J is independent of U1 − U0 conditional on X, but do not imply
that J is uncorrelated with D(U1 −U0 ) conditional on X. Thus, in general, the covariance in the numerator
of the second term is not zero. Knowledge of (X, Z, D) and (X, Z, (U0 , U1 )) dependencies is not enough to
determine the covariance in the second term. We need to know joint (X, Z, D, U0 , U1 ) dependencies.
   A sufficient condition for producing (C-1) is the strong information condition that decisions to partici-
pate in the program are not made on the basis of U1 − U0 :

(I-1) Pr(D = 1 | Z, X, U1 − U0 ) = Pr(D = 1 | Z, X).

Given our assumption that (U1 − U0 ) is independent of Z given X, one can use Bayes’ Theorem to show
that (I-1) implies the weaker mean independence condition:

(I-2) E(U1 − U0 | Z, X, D = 1) = E(U1 − U0 | X, D = 1)

which is generically necessary and sufficient for linear IV to identify ∆TT and ∆ATE .
   Case (C-2) is inconsistent with (I-2). IV estimates ∆LATE under the conditions of Imbens and Angrist
(1994). ∆LATE , selection models, and LIV, introduced below, analyze the more general case covered by

                                                    20
(C-2). Different assumptions define different parameters. In addition, as we establish in Section 4.3, even
under the same assumptions, different instruments define different parameters and traditional intuitions
about instrumental variables break down.


4.2       Estimating the MTE Using Local Instrumental Variables

Heckman and Vytlacil (1999, 2001b) resolve this confusion using the Local Instrumental Variable (LIV )
estimator to recover ∆MTE pointwise. Conditional on X = x, LIV is the derivative of the conditional
expectation of Y with respect to P (Z) = p :

                                                      ∂E(Y | X = x, P (Z) = p)
                                      ∆LIV (x, p) ≡                            .                                       (7)
                                                                ∂p

E(Y1 − Y0 |X, P (Z)) exists (almost everywhere) by assumption (A-4), and E(Y |X, P (Z)) can be recovered
over the support of (X, P (Z)). Assumptions (A-2), (A-3) and (A-4) jointly allow one to use Lebesgue’s
theorem for the derivative of an integral to show that E(Y1 − Y0 | X = x, P (Z) = p) is differentiable in
                             ∂
p. Thus we can recover       ∂p
                                E(Y   | X = x, P (Z) = p) for almost all p that are limit points of the support
of distribution of P (Z) conditional on X = x.25 Under our assumptions, LIV identifies MTE for all limit
points in the support of the distribution of P (Z) conditional on X. This expression does not require
additive separability of µ1 (X, U1 ) or µ0 (X, U0 ).26
       Under standard regularity conditions, a variety of nonparametric methods can be used to estimate
the derivative of E(Y | X, P (Z)) and thus to estimate ∆MTE . With ∆MTE in hand, if the support of the
distribution of P (Z) conditional on X is the full unit interval, one can generate all the treatment parameters
defined in Section 2 as well as the policy relevant treatment parameter presented in Section 3 as weighted
versions of ∆MTE . When the support of the distribution of P (Z) conditional on X is not full, it is still
possible to identify some parameters. For example, Heckman and Vytlacil (2001b) show that to identify
ATE under our assumptions, it is necessary and sufficient that the support of the distribution of P (Z)
  25
     For example, if the distribution of P (Z) conditional on X has a density with respect to Lebesgue measure, then all
points in the support of the distribution of P (Z) conditional on X are limit points of that support and we can identify
              ∂E(Y | X = x, P (Z) = p)
∆LIV (x, p) =                             for p (almost everywhere).
                          ∂p
  26
     Note, however, it does require our model and assumptions, including the assumption of additive separability between UD
and Z in the latent index for selection into treatment. See the discussion in Section 6.



                                                            21
conditional on X includes 0 and 1. Thus, identification of ATE does not require that the distribution
of P (Z) conditional on X be the full unit interval or that the distribution of P (Z) conditional on X
contain any limit points. Sharp bounds on the treatment parameters can be constructed under the same
assumptions imposed in this paper without imposing full support conditions. The resulting bounds are
simple and easy to apply compared with those presented in the previous literature.27
       To establish the relationship between LIV and ordinary IV based on P (Z) and to motivate how LIV
identifies ∆MTE , notice that from the definition of Y that the conditional expectation of Y given P (Z) is


                       E(Y | P (Z) = p) = E(Y0 | P (Z) = p) + E(∆ | P (Z) = p, D = 1)p,


where we keep the conditioning on X implicit. Our model and conditional independence assumption (A-2)
imply
                                 E(Y | P (Z) = p) = E(Y0 ) + E(∆ | p ≥ UD )p.

Applying the IV or Wald estimator for two different values of P (Z), p and p0 , for p 6= p0 , we obtain:

           E(Y | P (Z) = p)-E(Y | P (Z) = p0 )     ATE   E(U1 -U0 | p ≥ UD )p-E(U1 -U0 | p0 ≥ UD )p0
                                               = ∆     +                                             ,          (8)
                         p − p0                                            p − p0

where the expression is obtained under the assumption of additive separability in the outcomes so (1a)
and (1b) apply. Note that exactly the same equation holds without additive separability if one replaces U1
and U0 with Y1 − E(Y1 |X) and Y0 − E(Y0 |X).
       When U1 ≡ U0 or (U1 − U0 ) ⊥⊥ UD , (case (C-1)), IV based on P (Z) estimates ∆ATE because the second
term on the right hand side of the expression (8) vanishes. Otherwise, IV estimates a difficult-to-interpret
combination of MTE parameters which we analyze further below.
       Another representation of E(Y | P (Z) = p) that reveals the index structure under additive separability
more explicitly writes (keeping the conditioning on X implicit) that

                                                                 Z   p
                                                      ATE
                       E(Y |P (Z) = p) = E (Y0 ) + ∆        p+           E(U1 − U0 |UD = uD )duD .              (9)
                                                                 0
  27
    For example, see Heckman and Vytlacil (2001a) for a comparison of sharp bounds under the nonparametric selection
model with the Manski (1990) sharp bounds under a weaker mean independence condition. Heckman and Vytlacil (2005)
survey and synthesize this literature and Heckman and Vytlacil (2001b) develop the bounds.


                                                        22
We can differentiate with respect to p and use LIV to identify ∆MTE :

                           ∂E(Y | P (Z) = p)
                                             = ∆ATE + E(U1 − U0 |UD = p) = ∆MTE (p).
                                  ∂p

       Notice that IV estimates ∆ATE when E (Y | P (Z) = p) is a linear function of p. Thus a test of the
linearity of E(Y | P (Z) = p) in p is a test of the validity of linear IV for ∆ATE , i.e., it is a test of
whether or not the data are consistent with a correlated random coefficient model. The nonlinearity of
E(Y | P (Z) = p) in p provides a way to distinguish whether Case (C-1) or Case (C-2) describes the
data. It is also a test of whether or not agents can at least partially anticipate future unobserved (by the
econometrician) gains (the Y1 − Y0 given X) at the time they make their participation decisions. This
analysis generalizes to the nonseparable outcomes case. We use separability in outcomes only to simplify
the exposition and link to more traditional models. In particular, exactly the same expression holds with
exactly the same derivation for the nonseparable case if we replace U1 and U0 with Y1 − E(Y1 |X) and
Y0 − E(Y0 |X), respectively.28
       Figure 2A plots two cases of E (Y | P (Z) = p) based on the Generalized Roy Model used to generate
the example in Figure 1A and 1B. When ∆MTE does not depend on uD the expectation is a straight
line. Figure 2B plots the derivatives of the two curves in Figure 2A. When ∆MTE depends on uD , people
sort into the program being studied positively on the basis of gains from the program, and one gets the
curved line depicted in Figure 2A. The levels and derivatives of E(Y | P (Z) = p) and standard errors can
be estimated using a variety of semiparametric methods. The derivative estimator of ∆MTE is the local
instrumental variable (LIV ) estimator of Heckman and Vytlacil (1999, 2001b). Thus it is possible to test
condition (C-1) using simple econometric methods. In the case without regressors, X, the null hypothesis
is the parametric null of linearity.29
    28
       Making   the conditioning on X explicit, we obtain that E(Y | X = x, P (Z) = p) = E(Y0 | X = x) + ∆ATE (x)p +
Z   p
     E(U1 − U0 |X = x, Ud = uD )duD , with derivative with respect to p given by ∆MTE (x, p).
 0
  29
    Thus, one can apply any one of the large number of available tests for a parametric null versus a nonparametric alternative
(see, e.g., Ellison and Ellison, 1999; Zheng, 1996). With regressors, the null is nonparametric leaving E(Y | X = x, P (Z) = p)
unspecified except for restrictions on the partial derivatives with respect to p. In this case, the formal test is a test of a
nonparametric null versus a nonparametric alternative, and a formal test of the null hypothesis can be implemented using
the methodology of Chen and Fan (1999).




                                                              23
4.3       What Does Linear IV Estimate?

It is instructive to consider what linear IV estimates when ∆MTE is nonconstant, and conditions (A-1)–
(A-5) hold. We consider the general nonseparable case. We consider instrumental variables conditional on
X = x using a general function of Z as an instrument, and then specialize our result using P (Z) as the
instrument. Let J(Z) be any function of Z such that Cov (J(Z), D | X = x) 6= 0. Define


                       βIV (x; J) ≡ [Cov (J (Z) , Y | X = x)] / [Cov (J (Z) , D | X = x)] .


Appendix B derives an expression for the numerator of this expression, using (1c) and (A-2) and letting
˜
J(Z) ≡ J(Z) − E(J(Z) | X)

                                    Z     1
            Cov (J (Z) , Y | X) =                            ˜
                                              ∆MTE (X, uD )E(J(Z) | X, P (Z) ≥ uD ) Pr(P (Z) ≥ uD | X)duD .             (10)
                                      0



The denominator follows by a similar argument. By iterated expectations Cov (J(Z), D | X) = Cov (J(Z), P (Z) | X
Thus
                                                        Z
                                  βIV (x; J) =               ∆MTE (x, uD )hIV (uD | x; J) duD ,

where
                                                ˜
                                              E(J(Z) | X = x, P (Z) ≥ uD ) Pr(P (Z) ≥ uD | X = x)
                    hIV (uD | x; J) =                                                             ,                     (11)
                                                         Cov (J (Z) , P (Z) | X = x)

assuming the standard rank condition Cov (J (Z) , P (Z) | X = x) 6= 0. The weights integrate to unity,

                                                   Z    1
                                                            hIV (uD | x; J) duD = 1,
                                                    0



and can be constructed from the data on X, P (Z), J(Z) and D. Assumptions about the properties of the
weights are testable.30
       We first discuss additional properties of the weights for the special case where J(Z) = P (Z) (the
propensity score is the instrument), and then analyze the properties of the weights for a general instrument
  30
     Expressions for IV and OLS as weighted averages of marginal response functions, and the properties and construction
of the weights, were first derived by Yitzhaki in 1989 in a paper that was eventually published in 1996 (See Yitzhaki, 1996).
He does not use the MTE, however.




                                                                    24
J(Z). From equation (11),

                               [E(P (Z) | X = x, P (Z) ≥ uD ) − E(P (Z) | X = x)] Pr(P (Z) ≥ uD | X = x)
        hIV (uD |x; P (Z)) =                                                                             .
                                                          V ar (P (Z) | X = x)

Figure 1B plots the IV weight for J (Z) = P (Z) and the MTE for our Generalized Roy model example
(see also Table 1B). Let pMin
                          x   and pMax
                                   x   denote the minimum and maximum points in the support of the
distribution of P (Z) conditional on X = x. The weights on MTE corresponding to the use of P (Z) as
the instrument are nonnegative for all evaluation points, are strictly positive for uD ∈ (pMin  Max
                                                                                           x , px   ) and are
zero for uD < pMin
               x   and for uD > pMax
                                 x   .31
       Our expression for the weights does not impose any support conditions on the distribution of P (Z)
conditional on X, and thus does not require either that P (Z) be continuous or discrete. To demonstrate
this, consider two extreme special cases: (i) when P (Z) is a continuous random variable, and (ii) when
P (Z) is a discrete random variable.
       First consider the case where the distribution of P (Z) conditional on X has a density with respect
to Lebesgue measure with nonnegative density on the interval (pMin  Max
                                                               x , px   ). In this case, ∆LIV (x, uD ) is
well defined for all uD ∈ (pMin  Max
                            x , px   ) such that hIV (uD | x; P (Z)) > 0. Using the fact that ∆LIV (x, uD ) =
∆MTE (x, uD ) at evaluation points where LIV is well defined, we can rewrite the expression for the IV
estimator as
                                                  Z   pMax
                                                       x
                               βIV (x; P (Z)) =              ∆LIV (x, uD )hIV (uD | x; P (Z))duD .32
                                                  pMin
                                                   x


       Next consider the case where the distribution of P (Z) conditional on X has density with respect to
counting measure. For simplicity, assume that the support of the distribution of P (Z) conditional on X
  31
       For uD evaluation points between pMin
                                         x   and pMax
                                                  x   , uD ∈ (pMin  Max
                                                               x , px   ), we have that

                     E (P (Z) | P (Z) ≥ uD , X = x) > E (P (Z) | X = x) and Pr(P (Z) ≥ uD | X = x) > 0,

so that hIV (uD | x; P (Z)) > 0 for any uD ∈ (pMin  Max
                                               x , px   ). For uD < pMin
                                                                     x ,

                                     E (P (Z) | P (Z) ≥ uD , X = x) = E (P (Z) | X = x) .

For any uD > pMaxx   , Pr(P (Z) ≥ uD | X = x) = 0. Thus, hIV (uD | x; P (Z)) = 0 for any uD < pMin
                                                                                                 x   and for any uD > pMaxx  .
                                                   Min Max                                Min
hIV (uD |x; P (Z)) is strictly positive for uD ∈ (px , px ), and is zero for all uD < px and all uD > pMax     x   . Whether
the weights are nonzero at the endpoints depends on the distribution of P (Z). However, since the weights are defined for
integration with respect to Lebesgue measure, the value taken by the weights at pMin
                                                                                   x   and pMax
                                                                                              x   does not affect the value of
the integral.
  32
     Angrist, Graddy, and Imbens (2000) develop a special case of this expression for a scalar instrument.




                                                                   25
contains a finite number of values, {p1 , ..., pK } with p1 < p2 < · · · < pK . Then E(P (Z) | X = x, P (Z) ≥
uD ) is constant in uD for uD within any (pj , pj+1 ) interval, and Pr(P (Z) ≥ uD ) is constant in uD for uD
within any (pj , pj+1 ) interval, and thus hIV (uD | x; P (Z)) is constant in uD over any (pj , pj+1 ) interval. Let
qj denote the value taken by hIV (uD | x; P (Z)) for uD ∈ (pj , pj + 1). Then, letting q̃j = qj (pj+1 − pj )

                                         Z
                   βIV (x; P (Z)) =          E(∆|X = x, UD = uD )hIV (uD | x; P (Z))duD
                                         K−1
                                         X Z pj+1
                                    =                 E(∆|X = x, UD = uD )qj duD
                                         j=1     pj

                                         K−1                  Z   pj+1
                                         X                                                                 1
                                    =          qj (pj+1 − pj )            E(∆|X = x, UD = uD )                     duD
                                         j=1                    pj                                    (pj+1 − pj )
                                         K−1
                                         X
                                    =          ∆LATE (x, pj , pj+1 )q̃j .33
                                         j=1



The properties of the weights for general J(Z) depend critically on the relationship between J(Z) and
P (Z). Defining T (p | x; J) = E(J | P (Z) = p, X = x) − E(J|X = x),

                                                               R1
                                                                  uD
                                                                       T (t | x; J)dFP |X (t|x)
                                         hIV (uD | x; J) =                                        .                      (12)
                                                                     Cov (J, P | X = x)

From this expression, we learn that the IV estimator with J(Z) as an instrument satisfies the following
properties:


  (i) Two instruments J and J ∗ weight MTE equally at all uD evaluation points if and only if E(J|X =
         x, P (Z) = p) − E(J|X = x) = E(J ∗ |X = x, P (Z) = p) − E(J ∗ |X = x) for all p in the support of the
         distribution of P (Z) conditional on X = x.

 (ii) The support of hIV (uD | x; J) is contained in (pMin  Max
                                                       x , px   ). Therefore hIV (t | x; J) = 0 for t < pMin
                                                                                                         x

         and for t > pMax
                      x   . Using any instrument other than P (Z) leads to nonzero weights only on a subset
         of (pMin  Max
              x , px   ), and using the propensity score as an instrument leads to nonnegative weights on a
         larger range of evaluation points than using any other instrument.

(iii) hIV (uD | x; J) is nonnegative for all uD if E(J | X = x, P (Z) ≥ p) is weakly monotonic in p. Using J
  33
       In this special case, our analysis is a latent variable version of the formula in Imbens and Angrist (1994).


                                                                     26
     as an instrument yields nonnegative weights on ∆MTE if E(J | X = x, P (Z) ≥ p) is weakly monotonic
     in p. This condition is satisfied when J(Z) = P (Z). More generally, if J is a monotonic function
     of P (Z), then using J as the instrument will lead to nonnegative weights on ∆MTE . There is no
     guarantee that the weights for a general J (Z) will be nonnegative for all uD , although the weights
     integrate to unity and thus must be positive over some range of evaluation points. We produce
     examples below where the instrument leads to negative weights for some evaluation points.


   The propensity score plays a central role in determining the properties of the weights. The IV weighting
formula critically depends on T (p | x; J) and hence on the relationship between the instrument J(Z) and
the propensity score. For example, whether two instruments provide the same weights on MTE depends
on their relationship with P (Z) (item (i) above), the possible support of the IV weights depends on the
support of P (Z) (item (ii)) and whether an instrument will provide positive weights on MTE depends on
the instrument’s relationship with P (Z) (item (iii)).
   The interpretation placed on the IV estimand depends on the specification of P (Z) even if only Z1 (e.g.
a coordinate of Z) is used as the instrument. This drives home the point about the difference between IV
in the traditional model and IV in the more general model with heterogeneous responses analyzed in this
paper. In the traditional model, the choice of any valid instrument and the specification of instruments
in P (Z) not used to construct a particular IV estimator does not affect the IV estimand. In the more
general model analyzed in this paper, these choices matter. Two economists, using the same J(Z) = Z1 ,
will obtain the same IV point estimate, but the interpretation placed on that estimate will depend on the
specification of the Z in P (Z) even if P (Z) is not used as an instrument. The weights can be positive for
one instrument and negative for another.
   Table II gives the IV estimand for the Generalized Roy Model used to generate Figures 1A and 1B
using P (Z) as the instrument. The model generating D = 1 [β 0 Z > V ] is given at the base of Figure 1B
                                                
(Z is a scalar, β is 1, V is normal, UD = Φ σEVσV ). We compare the IV estimand with the policy relevant
treatment effect for a policy defined at the base of Table II. If Z > 0, persons get a bonus Zt. Their
decision rule for Z > 0 is D = 1 [Z(1 + t) > V ]. People are not forced into participation in the program.
Given the assumed distribution of Z, and the other parameters of the model, we obtain hPRTE (uD ) as
plotted in Figures 3A-3C (the scales differ across the graphs). We use the per capita PRTE and consider


                                                     27
three instruments. Table III presents estimands for three instruments in the Generalized Roy models for
three environments.
   The first instrument we consider is P (Z), which ignores the policy (t) effect on choices. It is estimated
on a sample with no policy in place. Its weight is plotted in Figure 3A which also displays the OLS weight
(discussed later). The IV weights for P (Z) and the weights for ∆PRTE differ. This is as it should be
because ∆PRTE is making a comparison across regimes but IV in this case is making a comparison within
a no policy regime. Given the shape of ∆MTE (uD ), it is not surprising that the estimand for IV based on
P (Z) is so much above the ∆PRTE which weights a lower-valued segment of ∆MTE (uD ) more heavily.
   The second instrument we consider exploits the variation induced by the policy in place and fits it
on samples where the policy is in place. On intuitive grounds, this instrument might be thought to work
well for identifying the PRTE, but in fact it does not. The instrument is P̃ (Z, t) = P (Z(1 + t1 [Z > 0]))
which jumps in value when Z > 0. This is the choice probability in the regime with the policy in place.
Figure 3B plots the weight for this IV along with the weight for P (Z) as an IV (repeated from 3A). While
this weight looks a bit more like the weight for ∆PRTE , it is clearly different.
   Figure 3C plots the weight for an ideal instrument for PRTE : a randomization of eligibility. This
compares the outcomes in a population with the policy in place with outcomes where it is not. We use an
instrument B such that
                         
                          1 if a person is eligible to participate in the program
                         
                      B=
                          0 otherwise.
                         


Persons for whom B = 1, make their participation choices under the policy with a jump in Z, t1(Z > 0)
in their choice sets. If B = 0, persons are embargoed from the policy and there is no bonus. This is a
prepolicy regime. We assume Pr[B = 1 | Y0 , Y1 , V, Z] = Pr[B = 1] = 0.5 so all persons are equally likely to
receive or not receive eligibility for the bonus and assignment does not depend on model unobservables in
the outcome equation. The Wald estimator in this case is

                                      E(Y | B = 1) − E(Y | B = 0)
                                                                        .
                                  Pr(D = 1 | B = 1) − Pr(D = 1 | B = 0)




                                                      28
The IV weight for this estimator is a special case of equation (11):

                                                                                  
                                       E B − E(B) | P̂ (Z) ≥ uD Pr P̂ (Z) ≥ uD
                      hIV (uD | B) =                                         ,
                                                   Cov B, P̂ (Z)


where P̂ (Z) = P (Z (1 + t1[Z > 0]))B P (Z)(1−B) . Here, the IV is eligibility for a policy and IV is equiva-
lent to a social experiment that identifies the mean gain per participant who switches to participation in
the program. It is to be expected that this IV weight and hPRTE are identical.


Monotonicity

Monotonicity property (iii) is strong. For a general J(Z), there is no guarantee that it will be satisfied even
if J(Z) is independent of (Y0 , Y1 ) given X and if J(Z) is correlated with D given X = x so that standard
IV conditions are satisfied. Thus if Z is a K-dimensional vector and J(Z) = Z1 , even if conditional on
Z2 = z2 , . . . , ZK = zK , P (Z) is monotonic in Z1 , there is no guarantee that Z1 used as an instrument for
D has positive weights on the MTE.
   If we redefine IV for Z1 to be conditional on Z2 = z2 , . . . , ZK = zK , the weights are positive. Condi-
tioning on instruments not used to form the primary covariance relationship is a new concept that does
not appear in the conventional IV literature. In conventional cases governed by condition (C-1), any valid
instrument identifies the same parameter. In the general case analyzed in this paper, different choices of
instruments and the conditioning sets of other Z variables define different parameters.
   Figure 4 demonstrates the possibility of negative weights for the model given at its base. In this figure,
we use V rather than normalized FV (V ) = UD in order to use familiar normal algebra. This simulation is
generated from a classical normal error term selection model with nonnormal instruments. The instruments
are generated as mixtures of normals from two underlying populations. One can think of this example as a
two-component ecological model with different J(Z), P (Z) covariance relationships in the two components.
An alternative way of saying the same thing is that there are different (J(Z), β 0 Z) covariance relationships
in the two subpopulations generating D = 1(β 0 Z > V ). In the first component, the covariance between
J(Z) and β 0 Z is .98. In the second, the covariance varies as shown in Table IV where the IV is Z1 but
the choice probability depends on Z1 and Z2 (µD (Z) = β 0 Z). Ceteris paribus, increasing Z1 increases the



                                                      29
probability that D = 1. Symmetrically, increasing Z2 holding Z1 constant also increases this probability.
Yet, since Z1 and Z2 covary, varying Z1 implicitly varies Z2 , which may offset the ceteris paribus effect
of Z1 and produce nonmonotonicity and negative weights. In this example there are different covariance
relationships in different normal subcomponents of the data. As Z1 increases, P (Z) increases for some
people and decreases for other people, leading to two-way flows into and out of treatment for different
people. IV estimates the effect of Z1 on outcomes not controlling for the other elements of Z. For the
configuration of parameters shown there (and for numerous other configurations), the IV weight is negative
over a substantial range of values.
   The negativity of the weights over certain regions exhibited in Figure 4 makes clear that Z1 (and more
generally J(Z)) fails the monotonicity condition (iii) and does not estimate a gross treatment effect. Some
agents withdraw from participation in the program when Z1 is raised (not holding constant Z2 ) while
others enter, even though ceteris paribus a higher Z1 raises participation (D). Thus the widely held view
that IV estimates some treatment effect of a change in D induced by a change in Z1 , is in general false.
It estimates a net effect and not a treatment effect, because monotonicity may be violated. Heckman,
Urzua, and Vytlacil (2004) present stark examples where MTE is negative, the weights are negative and
instrumental variable estimates of treatment effects are positive. Table IV shows how the IV estimand
changes with the weights even though the treatment parameters are the same in all three examples.
   Monotonicity condition (iii) is testable. Whether condition (iii) corresponds to positive weights on
MTE depends on whether all of our assumptions hold, particularly (A-2) and representation (3). If the
weights are negative, the change in J(Z) induces two way flows into and out of treatment. Since it is
possible to estimate the joint density of (J(Z), P (Z)) given X nonparametrically, under our assumptions
it is possible to test for the positivity of the weights which under our assumptions is also a test for
monotonicity condition (iii). However (A-2) itself is not testable. Monotonicity condition (iii) is distinct
from the condition termed “monotonicity” by Imbens and Angrist (1994). We discuss their condition in
Section 6.




                                                    30
4.4    Policy Relevant Instrumental Variables

We have just analyzed what IV estimates in terms of weighting MTE. Instead of picking an instrument
and hoping that it estimates something interesting, it is more natural to define an economically interesting
parameter and see if instrumental variables identify it. Suppose that there is a parameter defined as a
weighted average of ∆MTE conditional on X = x. Can we construct a function of Z to use as an ordinary
instrument so that the resulting estimand corresponds to the desired weighted average of ∆MTE ? This
question is especially interesting if the estimand is a policy counterfactual. We also consider whether there
is any policy counterfactual estimated by a given instrument. We initially consider the case where P (Z)
is a continuous random variable. We return at the end of this section to consider the case where the
distribution of P (Z) is discrete.
                                                                            R
   Suppose that we seek to recover a parameter defined by                       ∆MTE (x, u)w(u|x)du by the method of linear
instrumental variables. We know from equation (12) the form of the weights corresponding to the IV
estimator for any particular instrument J(Z). We seek an instrument J(Z) that has associated weights
on MTE given by equation (12) that are the same as those on the desired parameter

                                        R1
                                         uD
                                              T (t | x; J)dFP |X (t|x)
                           w(uD |x) =                                           = hIV (uD | x, J) .
                                              Cov (J, P | X = x)

Assuming that FP |X has a density with respect to Lebesgue measure, the second term in this expression
is differentiable in u (almost everywhere). Assuming that w(uD |x) is also differentiable at all points of
                                               T (uD |x;J)fP |X (uD |x)
evaluation, it follows that w0 (uD |x) = −         Cov (J,P |X=x)
                                                                        .   The following proposition provides conditions
under which an instrument exists with the desired properties.

Proposition 1. Under the following conditions


  (i) FP |X (·) has a density with respect to Lebesgue measure;

                                                                                                             R1
 (ii) w(·|x) satisfies the following properties: w(uD |x) differentiable in uD for all uD ∈ [0, 1],           0
                                                                                                                  w(uD |x)duD =
      1, and w(1|x) = w(0|x) = 0;

(iii) fP |X (t|x) = 0 implies w0 (t|x) = 0;




                                                              31
there exists an instrument Jx (Z) such that Cov (Jx , D | X = x) 6= 0 and w(uD |x) = hIV (uD | x, Jx ). An
                                                     34
instrument that satisfies these conditions is
                                             
                                                 w0 (P (Z)|x)
                                             
                                             
                                                 fP |X (P (Z)|x)
                                                                    if fP |X (P (Z)|x) > 0
                                  Jx (Z) =
                                                                    if fP |X (P (Z)|x) = 0.35
                                             
                                             0
                                             


Under (i), conditions (ii) and (iii) are necessary and sufficient for the existence of such an instrument.


Proof. See Appendix C.                                                                                             Q.E.D.

       Condition (i) is a regularity condition requiring that P (Z) be a continuous random variable. We
examine the case where P (Z) is discrete at the end of this section. Condition (ii) requires that the
desired weights on MTE be proper weights in the sense of integrating up to one, and also that the weights
satisfy the regularity conditions that the weights are differentiable and that the weights are zero when
evaluated at the uD values of zero and one. The first and third of these conditions mimic the properties of
any IV weights, and the second condition mimics the property of any IV weights when the instrument is
continuous. Condition (iii) is a strong, but natural, condition. It requires that the support of the propensity
score includes the support of w0 (·|x). Thus, the density of the propensity score has to be positive at any
evaluation point where w0 (· | x) is nonzero. This condition will always be satisfied if fP |X (t|x) > 0 for all
t ∈ [0, 1]. Given (i), if (ii) or (iii) fails, then no instrument exists that provides the desired weights. If the
desired weights do not integrate to one or are not differentiable, then as long as P (Z) is continuous (has
a distribution that is absolutely continuous with respect to Lebesgue measure), there will not exist any
instrument that provides the desired weights. If the weights are nonconstant over an interval outside of
the support of the propensity score, then no such instrument can be constructed that would provide the
desired weights.
       One implication of Proposition 1 is that if P (Z) is continuous, when the MTE depends on uD in a
nontrivial way there does not exist any instrument that provides the weights corresponding to ATE or TT.
To see this, recall that the weights for ATE and TT do not satisfy w(1 | x) = w(0 | x) = 0, so that the
  34
     When such an instrument exists, it will not be unique, since the IV estimand will be invariant to rescaling or location
shifts for the instrument.
  35
     Note that fP |X (P (Z)|x) > 0 with probability 1 so that Jx (Z) = w0 (P (Z)|x)/fP |X (P (Z)|x) with probability 1.


                                                                   32
weights for ATE and TT do not satisfy condition (ii) of the proposition. Thus, under assumptions (A-1)-
(A-5) and under the additional assumptions of the proposition, no instrument exists giving the weights for
ATE or TT if P (Z) is a continuous random variable. This statement leaves open the question of whether
instruments will exist that answer policy counterfactuals. We now specialize the previous proposition for
the special case of policy weights, using the notation for policy counterfactuals from Section 3.

Proposition 2. Assume


  (i) FP |X (·), FPa0 |X (·) and FPa |X (·) have densities with respect to Lebesgue measure where P is the initial
        (benchmark) probability and Pa0 and Pa are the probabilities associated with two policies (possibly)
        distinct from the benchmark policy.

 (ii) E(Pa |X = x) 6= E(Pa0 |X = x);

(iii) for any t, fP |X (t|x) = 0 implies fPa |X (t|x) − fPa0 |X (t|x) = 0.


      Define Jx to be a policy relevant instrument if it satisfies Cov (Jx , D | X = x) 6= 0 and

                                        R1
                                         uD
                                              T (t | x; Jx )dFP |X (t|x)           FPa0 |X (t | x) − FPa |X (t | x)
                 hIV (uD | x, Jx ) =                                        =                                       .
                                             Cov (Jx , P | X = x)                E(Pa0 | X = x) − E(Pa | X = x)

Given condition (i) and (ii), condition (iii) is necessary and sufficient for the existence of such an instru-
                                                                            36
ment. If the instrument exists, it can be constructed as:
                                        
                                         fPa0 |X (P (Z)|x)−fPa |X (P (Z)|x)
                                        
                                                                                 if fP |X (P (Z)|x) > 0
                                                     fP |X (P (Z)|x)
                             Jx (Z) =
                                                                                  if fP |X (P (Z)|x) = 0.37
                                        
                                        0
                                        


Proof. Follows by verifying the conditions of Proposition 1. See Appendix C.                                                                  Q.E.D.

      Condition (i) requires that the propensity score be a continuous random variable in a benchmark
regime and under both alternative regimes. Condition (ii) requires that a fraction of individuals selecting
into treatment under regime a is different than the fraction under regime a0 . Condition (iii) imposes the
 36
      If such a Jx (Z) exists, then any linear function of Jx (Z) will also produce the desired set of weights.
 37                                                                              (fP        |X (P (Z)|x)−fPa |X (P (Z)|x))
                                                                                       a0
      Note that fP |X (P (Z)|x) > 0 with probability 1 so that Jx (Z) =                          fP |X (P (Z)|x)             with probability 1.



                                                                       33
requirement that the densities of the propensity score in the two regimes only differ at evaluation points
in the support of the benchmark propensity score. If (iii) fails, then no policy relevant instrument can be
constructed.
       An immediate corollary of the proposition is that IV using the propensity score as the instrument
recovers the policy relevant parameter if

                                                           fPa0 |X (P (Z)) − fPa |X (P (Z))
                                                                                           
                                       P (Z) = α(X) + β(X)                                    ,                 (13)
                                                                      fP |X (P (Z))

where α(X) = E(P (Z)|X) and β(X) = −V ar (P (Z) | X), i.e. only if the propensity score is linear in
{fPa0 |X (P (Z)) − fPa |X (P (Z))}/fP |X (P (Z)).
       A related question asks whether, given an instrument, there exists a policy counterfactual such that
the given instrument is the policy relevant instrument for that counterfactual. We investigate this question
for policy counterfactuals starting from a benchmark distribution of P (Z) (the benchmark policy is a so
Pa (Za ) = P (Z)) to some new policy characterized by Pa0 (Za0 ). We first answer the question for the special
case where the propensity score is the instrument. Solving for fPa0 |X (P (Z)) in (13), the propensity score
will be the policy relevant instrument for a policy characterized by

                                                                                                       
                                                                          uD − E(P (Z)|X)
                                          fPa0 |X (uD ) = fP |X (uD ) 1 −                                   .   (14)
                                                                           V ar (P (Z) | X)

If fPa0 |X given by equation (14) is a proper density, then instrumental variables using the propensity score
directly estimates the effect of a policy intervention that changes the density of the propensity score from
fP |X to fPa0 |X where fPa0 |X is given by equation (14). To be a proper density, fPa0 |X must integrate to one
and be nonnegative for all evaluation points. fPa0 |X (·) integrates to one.38 fPa0 |X (·) will be nonnegative and
thus a proper density if and only if uD − E(P (Z)|X) ≤ V ar (P (Z)) for all uD such that fP |X (uD ) > 0. If
we let pMax
        x   denote the maximum of the support of P (Z) conditional on X, we can rewrite this condition
as pMax
    x   − E(P (Z)|X = x) ≤ V ar (P (Z) | X = x). Nothing guarantees that this condition holds so one
cannot guarantee that an instrument produces any policy counterfactual. Not all instruments answer well
posed policy questions.
                                              
  38
       R                     uD −E(P (Z)|X)                        R
           fP |X (uD ) 1 −    V ar (P (Z)|X)       duD = 1 since       uD fP |X (uD )duD = E(P (Z)|X)



                                                                              34
      We next consider the question of whether a general instrument is the policy relevant instrument for
some policy. Following the same series of steps used to establish (14), if the instrument J(Z) answers a
corresponding policy question, then the policy imposes the restriction that

                                                                                                    
                                                       E(J(Z)|X, P (Z) = uD ) − E(J(Z)|X)
                       fPa0 |X (uD ) = fP |X (uD ) 1 −                                                   .
                                                               Cov (J, P (Z) | X)

The implied fPa0 (·) integrates to one. It is nonnegative for all evaluation points if and only if

                                       E(J(Z)|X, P (Z) = uD ) − E(J(Z)|X)
                                                                          ≤1
                                               Cov (J, P (Z) | X)

for all uD such that fP |X (uD ) > 0. If this condition fails, the instrument is not the policy relevant
instrument for any policy. Nothing in the structure of the problem imposes this requirement.
    The preceding analysis conditions on X. Suppose that we wish to recover unconditional parameters,
                       R R MTE               
e.g., those defined by     ∆    (x, u)w(u|x)du dFX (x). If the conditions of Proposition 1 hold for X = x
(almost everywhere), then one solution would be to construct Jx (Z) for each x, estimate the parameter
conditional on X for each x, and then average over x values. However, from the construction of Jx (Z), one
can use instrumental variables unconditional on X with the constructed J(Z) as the instrument to obtain
the desired parameter in one step.

Proposition 3. Assume that the conditions of Proposition 1 hold for almost all X. Construct

                                                
                                                   0
                                                 w (P (Z)|X)
                                                
                                                
                                                   fP |X (P (Z))
                                                                    if fP |X (P (Z)) > 0
                                       J(Z) =
                                                                    if fP |X (P (Z)) = 0.39
                                                
                                                0
                                                

Then
                                                  Z Z                                     
                             Cov (J(Z), Y )                   MTE
                                            =              ∆        (x, uD )w(uD | x)du dFX (x).
                             Cov (J(Z), D)

Proof. See Appendix C.                                                                                               Q.E.D.

Thus far we have considered the case where P (Z) is a continuous random variable. Is it possible to
construct an instrument that produces the desired weights if P (Z) is discrete? The following proposition
 39
      Note that fP |X (P (Z)|X) > 0 with probability 1 so that J(Z) = w0 (P (Z)|X)/fP |X (P (Z)|X) with probability 1.


                                                                   35
shows that instrumental variables estimators are only able to produce a very narrow range of weights if
P (Z) is discrete. In particular, they only produce weights given by step functions with the jumps in the
weight function occurring only at the support points of P (Z).

Proposition 4. Under the following conditions


  (i) The support of the distribution of P (Z) conditional on X is a finite set, {p1 , ..., pK } with p1 < p2 <
         . . . < pK and with Pr[P (Z) = pj | X = x] > 0 for each j = 1, ..., K;

                                                       R1
 (ii) w(·|x) satisfies the following properties:        0
                                                            w(uD |x)du = 1, and w(uD |x) = 0 for uD ≤ p1 and for
         uD > p K ;

(iii) w(uD |x) is constant in u over the interval (pj , pj+1 ] for j = 1, ..., K;


there exists an instrument Jx (Z) such that Cov (Jx , D | X = x) 6= 0 and

                                                     R1
                                                       uD
                                                            T (t | x; Jx )dFP |X (t|x)
                                        w(uD |x) =                                       .
                                                          Cov (Jx , P | X = x)

An instrument that satisfies these conditions is

                                     K
                                     X               1
                          Jx (Z) =                                (wj − wj+1 )1[P (Z) = pj ],
                                     j=1
                                           Pr[P (Z) = pj | X = x]


where wj denotes the (constant) value of w(uD |x) over the interval (pj−1 , pj ] for j = 2, ..., K − 1, and where
w1 = wK+1 = 0.40 Given condition (i), conditions (ii) and (iii) are necessary and sufficient for the existence
of such an instrument.

Proof. See Appendix C.                                                                                             Q.E.D.

       Thus, if P (Z) is a discrete random variable, only a very limited set of possible weights on P (Z) can be
captured through proper choice of the instrument so the class of policies that can be generated by IV is
very limited. We next use our framework to analyze the OLS estimator and the assumptions about ∆MTE
imposed in one widely used version of the method of matching.
  40
     When such an instrument exists, it will not be unique, since the IV estimand will be invariant to rescaling or location
shifts for the instrument.


                                                               36
4.5    OLS Weights and Matching

The OLS estimator can also be represented as a weighted average of ∆MTE . The weight is given in
Table IB where U1 and U0 are defined as deviations from conditional expectations, U1 = Y1 − E(Y1 | X),
U0 = Y0 − E(Y0 | X). Unlike the weights for ∆TT and ∆ATE , these weights do not necessarily integrate
to one and they are not necessarily nonnegative. The OLS weights for the Generalized Roy Model are
plotted in Figure 1B. The negative component of the OLS weight leads to a smaller OLS treatment
estimate compared to the other treatment effects in Table II.
   Table II shows the estimated OLS treatment effect for the Generalized Roy example. For a binary
regressor D, OLS conditional on X identifies


             ∆OLS (X) = E(Y1 | X, D = 1) − E(Y0 | X, D = 0)

                         = E(Y1 − Y0 | X, D = 1) + {E(Y0 | X, D = 1) − E(Y0 | X, D = 0)},


where the term in braces is the “selection bias” term—the difference in pretreatment outcomes between
treated and untreated individuals. It is also the bias for ∆TT . The large negative selection bias in this
example is consistent with comparative advantage as emphasized by Roy (1951). People who are good in
sector 1 (i.e. treatment) may be very poor in Sector 0 (no treatment). The differences among the policy
relevant treatment effects, the conventional treatment effects and the OLS estimand are illustrated in Fig-
ure 3A and Tables II and III. As is evident from Table II, it is not at all clear that the instrumental variable
estimator, with instruments that satisfy classical properties, performs better than OLS in identifying the
policy relevant treatment effect.
   If there is no selection conditional on covariates, UD ⊥
                                                          ⊥ (Y1 , Y0 ) | X, then E(U1 | X, UD ) = E(U1 |
X) = 0 and E(U0 | X, UD ) = E(U0 | X) = 0 so that the OLS weights are unity and OLS identifies
                                                ⊥ (Y1 , Y0 ) | X implies that ∆MTE (x, uD ) does not
ATE. OLS is a form of matching. Furthermore, UD ⊥
vary with uD , i.e., ∆MTE (X, uD ) = ∆MTE (X, u0D ) for uD , u0D (almost everywhere) so all treatment effects
are the same. Observe that given the assumed conditional independence in terms of X, we can identify
ATE and TT without requiring a Z satisfying (A-2). If there is such a Z, the conditional independence
condition implies under (A-1)–(A-5) that E(Y | X, P (Z) = p) is linear in p. This conditional independence
assumption is invoked in the method of matching and has come into wide spread use. The method is based

                                                      37
upon the assumption that there is no purposeful selection into the program based on unmeasured (by the
econometrician) components of gain41 .
       One can weaken the assumption that UD ⊥
                                             ⊥ (Y1 , Y0 ) | X to the condition that Y1 and Y0 are mean
independent of D conditional on X.42 However, D will be mean independent of Y1 , Y0 conditional on X
without UD being independent of Y1 , Y0 conditional on X only if fortuitous balancing occurs with regions
of positive Y1 , Y0 dependence on UD and regions of negative Y1 , Y0 dependence on UD just exactly offsetting
each other. Such balancing is ruled out in the Roy model and in the Generalized Roy Model.43,44 We next
apply our framework to analyze policy forecasting problems.



5        Out of Sample Policy Forecasting, Forecasting the Effects of

         New Policies and Structural Models Based on the MTE

Section 3 introduced the concept of the Policy Relevant Treatment Effect and invokes a policy invariance
assumption. In this section, we present conditions for constructing PRTE for new environments and for
new programs using historical data.
       Using the terminology of Campbell and Stanley (1966), estimating the impact of a program in place
in a particular environment is the problem of “internal validity.” Extrapolating internally valid estimates
to new environments, “external validity,” or forecasting the effects of new policies, are also important
problems which we now address.
       Let a ∈ A denote a policy characterized by random vector Za . Let e ∈ E denote an environment
  41
      See Heckman and Navarro (2004) and Heckman and Vytlacil (2005)for a more extensive discussion of matching estimators.
  42
      See Heckman, Ichimura, Smith, and Todd (1998) and Heckman, Ichimura, and Todd (1997). If the goal of the analysis
is to estimate ∆TT , one can get by with the weaker assumption that only Y0 is mean independent of D conditional on X
since E (Y1 | D = 1, X = x) is identified from observational data so there can be selection arising from dependence between
Y1 and D.
   43
      In particular, assume Yj = µj (X)+Uj for j = 0, 1, assume D = 1[Y1 −Y0 ≥ C(Z)+UC ], and let UD = UC −(U1 −U0 ). Then
if UC ⊥⊥ (U1 − U0 ), and UC has a log concave density, then E(Y1 − Y0 |X, UD = uD ) is decreasing in uD , ∆TT (x) > ∆ATE (x),
and the matching conditions do not hold. If UC ⊥⊥ (U1 − U0 ) but UC does not have a log concave density, then it is still
the case that (U1 − U0 , UD ) is negative quadrant dependent. One can show that (U1 − U0 , UD ) being negative quadrant
dependent implies that ∆TT (x) > ∆ATE (x), and thus again that the matching conditions cannot hold. See Heckman and
Vytlacil (2005) for further discussion.
   44
      It is sometimes said that the matching assumptions are “for free” (See Gill and Robins, 2001) because one can always
replace unobserved F (Y1 | X = x, D = 0) with F (Y1 | X = x, D = 1) and unobserved F (Y0 | X = x, D = 1) with
F (Y0 | X = x, D = 0). This ignores the counterfactual states generated under the matching assumptions that (C-1) is true
in the population. The assumed absence of selection is not a “for free” assumption, and produces fundamentally different
counterfactual states for the same model under matching and selection assumptions.



                                                             38
characterized by random vector Xe . A history, H, is a collection of policy-environment (a, e) pairs that
have been experienced and documented. We assume that the environment is autonomous so the choice of
a does not affect Xe . Letting Xe,a denote the value of Xe under policy a, autonomy requires that

(A-8) Xe,a = Xe        ∀a, e     (autonomy).

Autonomy is a more general notion than the concept introduced in (A-6). They are the same when the
policy is a treatment. General equilibrium feedback effects can cause a failure of autonomy. In this section
we will assume autonomy, in accordance with the partial equilibrium tradition in the treatment effect
literature.45
       Evaluating a particular policy a0 in environment e0 is straightforward if (a0 , e0 ) ∈ H. One simply looks at
the associated outcomes and treatment effects formed in that policy environment and applies the methods
previously discussed to obtain internally valid estimates. The challenge comes in forecasting the impacts
of policies (a0 ) in environments (e0 ) for (a0 , e0 ) not in H.
       We show how ∆MTE plays the role of a policy-invariant functional that aids in creating counterfactual
states never previously experienced. We focus on the problem of constructing the policy relevant treatment
effect ∆PRTE but our discussion applies more generally to the other treatment parameters.
       Given the assumptions invoked in Section 3, ∆MTE can be used to evaluate a whole menu of policies
characterized by different conditional distributions of Pa0 . In addition, given our assumptions, we can focus
on how policy a0 , which is characterized by Za0 , produces the distribution FPa0 |X which weights an invariant
∆MTE without having to conduct a new investigation of (Y, X, Z) relationships for each proposed policy.46


5.1        Constructing Weights for New Policies in a Common Environment

The problem of constructing ∆PRTE for policy a0 (compared to ā) in environment e when (a0 , e) ∈
                                                                                                / H entails
constructing E (V (Ya0 )). We maintain the assumption that the baseline policy is observed, so (ā, e) ∈ H.
We assume (A-1)–(A-5), (A-7) and (A-8) and use (3) to characterize choices. The policy does not change
the distribution of (Y0 , Y1 , UD ) conditional on X. Under these conditions, equation (6) is a valid expression
  45
    However, see Heckman, Lochner, and Taber (1998) for an example of a nonautonomous treatment model.
  46
    Ichimura and Taber (2002) present a discussion of local policy analysis in a more general framework without the MTE
structure, using a framework developed by Hurwicz (1962).




                                                           39
for PRTE and constructing PRTE only requires identification of ∆MTE and constructing FPa0 |Xe from the
policy histories He , defined as the elements of H for a particular environment e, He = {a : (a, e) ∈ H}.
   Associated with the policy histories a ∈ He is a collection of policy variables {Za : a ∈ He }. Suppose
that a new policy a0 can be written as Za0 = Ta0 ,j (Zj ) for some j ∈ He where Ta0 ,j is a known deterministic
transformation and Za0 has the same list of variables as Zj . Examples of policies that can be characterized
in this way are tax and subsidy policies on wages, prices and incomes that affect unit costs (wages or
prices) and transfers. Tuition might be shifted upward for everyone by the same amount, or tuition might
be shifted according to a nonlinear function of current tuition, parents’ income, and other observable
characteristics in Zj .
   Constructing FPa0 |Xe from data in the policy history entails two distinct steps. From the definitions,
Pr(Pa0 ≤ t | Xe ) = Pr(Za0 : Pr(Da0 = 1 | Za0 , Xe ) ≤ t | Xe ). If (i) we know the distribution of Za0 , and
(ii) we know the function Pr(Da0 = 1 | Za0 = z, Xe = x) over the appropriate support, we can then recover
the distribution of Pa0 conditional on Xe . Given that Za0 = Ta0 ,j (Zj ) for a known function Ta0 ,j (·), step
(i) is straightforward since we recover the distribution of Za0 from the distribution of Zj by using the fact
that Pr(Za0 ≤ t | Xe ) = Pr(Zj : Ta0 ,j (Zj ) ≤ t | Xe ). Alternatively, part of the specification of the policy
a0 might be the distribution Pr(Za0 ≤ t | Xe ). We now turn to the second step, recovering the function
Pr(Da0 = 1 | Za0 = z, Xe = x) over the appropriate support.
   If Za0 and Zj contain the same elements though possibly with different distributions, then a natural
approach to forecasting the new policy is to postulate that


                               Pj (z) = Pr(Dj = 1 | Zj = z, Xe )                                           (15)

                                       = Pr(Da0 = 1 | Za0 = z, Xe ) = Pa0 (z),                             (16)


i.e. that over a common support for Zj and Za0 the known conditional probability function and the desired
conditional probability function agree. Condition (15) will hold, for example, if Dj = 1[µD (Zj ) − UD ≥ 0],
Da0 = 1[µD (Za0 ) − UD ≥ 0], Zj ⊥⊥ UD | Xe , and Za0 ⊥
                                                     ⊥ UD | Xe . Even if condition (15) is satisfied on a
common support, the support of Zj and Za0 may not be the same. If the support of the distribution of
Za0 is not contained in the support of the distribution of Zj , then some form of extrapolation is needed.
Alternatively, if we strengthen our assumptions so that (15) holds for all j ∈ He , we can identify Pa0 (z) for


                                                      40
           S
all z in     Supp (Zj ). However, there is no guarantee that the support of the distribution of Za0 will be
               j∈He
            S
contained in j∈He Supp (Zj ), in which case some form of extrapolation is needed.
       If extrapolation is required, then one approach is to assume a parametric functional form for Pj (·).
Given a parametric functional form, one can use the joint distribution of (Dj , Zj ) to identify the unknown
parameters of Pj (·) and then extrapolate the parametric functional form to evaluate Pj (·) for all evaluation
points in the support of Za0 . Alternatively, if there is overlap between the support of Za0 and Zj ,47 so there
is some overlap in the historical and policy a0 supports of Z, we may use nonparametric methods presented
in Matzkin (1994) with functional restrictions (e.g. homogeneity) to construct the desired probabilities on
new supports or to bound them. Under the appropriate conditions, we may use analytic continuation to
extend Pr(Dj = 1|Zj = z, Xe = x) to a new support for each Xe = x (Rudin, 1974).
       The approach just presented is based on the assumption stated in equation (15). That assumption is
quite natural when Za0 and Zj both contain the same elements, say they both contain tuition and parent’s
income. However, in some cases Za0 might contain additional elements not contained in Zj . As an example,
Za0 might include new user fees while Zj consists of taxes and subsidies but does not include user fees. In
this case, the assumption stated in equation (15) is not expected to hold and is not even well defined if Za0
and Zj contain a different number of elements.
       A more basic approach analyzes a class of policies that operate on constraints, prices and endowments
arrayed in vector C. Given the preferences and technology of the agent, a given C = c, however arrived at,
generates the same choices for the agent. Thus a wage tax offset by a wage subsidy of the same amount
produces a wage that has the same effect on choices as a no-policy wage. Policy j affects C (e.g. it
affects prices paid, endowments and constraints). Define a map Φj : Zj −→ Cj which maps a policy j,
described by Zj , into its consequences (Cj ) for the baseline, fixed-dimensional vector C. A new policy a0 ,
characterized by Za0 , produces Ca0 that is possibly different from Cj for all previous policies j ∈ He .
  47
                                                                                                             S
    If we strengthen condition (15) to hold for all j ∈ He , then the condition becomes that Supp (Za0 ) ∩       j∈He   Supp (Zj ) is
not empty.




                                                             41
   To construct the random variable Pa0 = Pr (Da0 = 1 | Za0 , Xe ), we postulate that


                Pr Dj = 1 | Zj ∈ Φ−1
                                                    
                                  j (c), Xe = x         = Pr (Dj = 1 | Cj = c, Xe = x)

                                                        = Pr (Da0 = 1 | Ca0 = c, Xe = x)

                                                        = Pr Da0 = 1 | Za0 ∈ Φ−1
                                                                                            
                                                                              a0 (c), Xe = x ,




where Φ−1                            −1
       j (c) = {z : Φj (z) = c} and Φa0 (c) = {z : Φa0 (z) = c}. Given these assumptions, our ability to

recover Pr (Da0 = 1 | Za0 = z, Xe = x) for all (z, x) in the support of (Za0 , Xe ) depends on what Φj functions
have been historically observed and how rich the histories of Cj , j ∈ He are. For each za0 evaluation point
in the support of the distribution of Za0 , there is a corresponding c = Φa0 (za0 ) evaluation point in the
support of the distribution of Cj = Φj (Zj ). If, in the policy histories, there is at least one j ∈ He such
that Φj (zj ) = c for a zj with (zj , x) in the support of the distribution of (Zj , Xe ) then we can construct the
probability of the new policy from data in the policy histories. The methods used to extrapolate Pa0 (·) over
new regions, discussed previously, apply here. If the distribution of Ca0 (or Φa0 and the distribution of Za0 )
is known as part of the specification of the proposed policy, the distribution of FPa0 |Xe can be constructed
using the constructed Pa0 . Alternatively, if we can relate Ca0 to Cj by Ca0 = Ψa0 ,j (Cj ) for a known function
Ψa0 ,j or if we can relate Za0 to Zj by Za0 = Ta0 ,j (Zj ) for a known function Ta0 ,j , and the distributions of Cj
and/or Zj are known for some j ∈ He , we can apply the method previously discussed to derive FPa0 |Xe and
hence the policy weights for the new policy.
   This approach assumes that a new policy acts on components of C like a policy in He , so it is possible
to forecast the effect of a policy with nominally new aspects. The essential idea is to recast the new
aspects of policy in terms of old aspects previously measured. Thus in a model of schooling, let D =
1 [Y1 − Y0 − B ≥ 0] where Y1 − Y0 is the discounted gain in earnings from going to school and B is the
tuition cost. Here the effect of cost is just the negative of the effect of return. Historically, we might only
observe variation in Y1 − Y0 (say tuition has never previously been charged). But B is on the same footing
(has the same effect on choice, except for sign) as Y1 − Y0 . This identified historical variation in Y1 − Y0
can be used to nonparametrically forecast the effect of introducing B, provided that the support of Pa0
is in the historical support generated by the policy histories in He . Otherwise, some functional structure
(parametric or semi-parametric) must be imposed to solve the support problem for Pa0 .

                                                        42
      As another example, following Marschak (1953), consider the introduction of wage taxes in a world
where there has never before been a tax. Let Zj be the wage without taxes. We seek to forecast a post-tax
net wage Za0 = (1 − τ ) Zj + b where τ is the tax rate and b is a constant shifter. Thus Za0 is a known
linear transformation of policy Zj . We can construct Za0 from Zj . We can forecast under (A-2) using
Pr (Dj = 1 | Zj = z) = Pr (Da0 = 1 | Za0 = z). This assumes that the response to after tax wages is the
same as the response to wages at the after tax level. The issue is whether Pa0 |Xe lies in the historical
support, or whether extrapolation is needed. Nonlinear versions of this example can be constructed.
      As a final example, environmental economists use variation in one component of cost (e.g. travel cost)
to estimate the effect of a new cost (e.g. a park registration fee). See Smith and Banzhaf (2004). Relating
the costs and characteristics of new policies to the costs and characteristics of old policies is a standard,
but sometimes controversial, method for forecasting the effects of new policies.
      In the context of our model, extrapolation and forecasting are confined to constructing Pa0 and its
distribution. If policy a0 , characterized by vector Za0 , consists of new components that cannot be related
to Zj , j ∈ He , or a base set of characteristics whose variation can be identified, the problem is intractable.
Then Pa0 and its distribution cannot be formed using econometric methods applied to historical data.
      When it can be applied, our approach allows us to simplify the policy forecasting problem and concen-
trate our attention on forecasting choice probabilities and their distribution in solving the policy forecasting
problem. We can use choice theory and choice data to construct these objects to forecast the impacts of
new policies, by relating new policies to previously experienced policies.


5.2       Forecasting the Effects of Policies in New Environments

When the effects of policy a are forecast for a new environment e0 from baseline environment e, and
Xe 6= Xe0 , in general both ∆MTE (x, uD ) and FPa |Xe will change. In general, neither object is environment
invariant.48 The new Xe0 may have a different support than Xe or any other environment in H. In
addition, the new (Xe0 , UD ) stochastic relationship may be different from the historical (Xe , UD ) stochastic
relationship. Constructing FPa |Xe0 from FPa |Xe and FZa |Xe0 from FZa |Xe can be done using (i) functional
form (including semiparametric functional restrictions) or (ii) analytic continuation methods. Notice that
the maps Ta,j and Φa may depend on Xe and so the induced changes in these transformations must also
 48
      We suppress the dependence of UD on a for notational convenience.

                                                            43
be modelled. There is a parallel discussion for ∆MTE (x, uD ). The stochastic dependence between Xe0 and
(U1 , U0 , UD ) may be different from the stochastic dependence between Xe and (U1 , U0 , UD ). We suppress
the dependence of U0 and U1 on e and a only for convenience of exposition and make it explicit in the next
paragraph.
    Forecasting new stochastic relationships between Xe0 and (U1 , U0 , UD ) is a difficult task. It can be
avoided if we invoke the traditional exogeneity assumptions of classical econometrics:

(A-9) (U1,e,a , U0,e,a , UD,e,a ) ⊥⊥ (Xe , Za ) ∀e, a.

Under (A-9), we only encounter the support problems for both ∆MTE and the distribution of Pr (Da = 1 | Za , Xe )
in constructing policy counterfactuals.
    Conditions (A-7), (A-8) and (A-9) are unnecessary if the only goal of the analysis is to establish internal
validity, the standard objective of the treatment effect literature. Autonomy and exogeneity conditions
become important issues if we seek external validity. An important lesson from this analysis is that as we
try to make the treatment effect literature do the tasks of structural econometrics (i.e. make out of sample
forecasts), the assumptions invoked in the two literatures come together.


5.3     A Comparison of Three Approaches

Table V compares the strengths and limitations of the three approaches to policy evaluation that we have
discussed: the structural approach, the conventional treatment effect approach, and the recently developed
approach to treatment effects based on the MTE function developed in this paper.
    The approach based on the MTE function and the structural approach share interpretability of pa-
rameters. Like the structural approach, it addresses a range of policy evaluation questions. The MTE
parameter is less comparable and less easily extrapolated across environments than are structural parame-
ters, unless nonparametric versions of invariance and exogeneity assumptions are made. However, ∆MTE is
comparable across populations with different distributions of P (conditional on Xe ) and results from one
population can be applied to another population under the conditions presented in this section. Analysts
can use ∆MTE to forecast a variety of policies. This invariance property is shared with conventional struc-
tural parameters. Our framework solves the problem of external validity which is ignored in the standard
treatment effect approach. The price of these advantages of the structural approach is the greater range of

                                                         44
econometric problems that must be solved. They are avoided in the conventional treatment approach at
the cost of producing parameters that cannot be linked to well-posed economic models and hence do not
provide building blocks for an empirically motivated general equilibrium analysis or for investigation of the
impacts of new public policies. ∆MTE estimates the preferences of the agents being studied and provides
a basis for integration with well posed economic models. If the goal of a study is to examine one policy
in place (the problem of internal validity), the stronger assumptions invoked in this section of the paper,
and in structural econometrics, are unnecessary. Even if this is the only goal of the analysis, however, our
approach allows the analyst to generate all treatment effects and IV estimands from a common parameter
and provides a basis for unification of the treatment effect literature.



6     Monotonicity, Uniformity, Nonseparability, Independence and

      Policy Invariance: The Limits of Instrumental Variables

The analysis of this paper and the entire recent literature on instrumental variables estimators for models
with heterogeneous responses (i.e., models with outcomes of the form (2a) and (2b)) relies critically on
the assumption that the treatment choice equation has a representation in the additively separable form
(3). From Vytlacil (2002), we know that, under our assumptions. this assumption is equivalent to the
assumption of monotonicity as defined by Imbens and Angrist (1994). Using the notation of Section 2,
Imbens and Angrist define monotonicity as the following condition: if the Z are changed for everyone from
Z = z to Z = z 0 , Dz ≥ Dz0 or Dz ≤ Dz0 for all UD conditional on X. A better name for this condition
would be “uniformity” since it describes a condition across people rather than the shape of a function for
a particular person.
    This uniformity condition imparts an asymmetry to the entire instrumental variable enterprise. Re-
sponses are permitted to be heterogeneous in a general way, but choices of treatment are not. In this
section, we relax the assumption of additive separability in (3). We establish that in the absence of addi-
tive separability or uniformity, the entire instrumental variable identification strategy in this paper and the
entire recent literature collapses. Parameters can be defined as weighted averages of an MTE but MTE
and the derived parameters cannot be identified using any instrumental variable strategy.



                                                      45
       One natural benchmark nonseparable model is a random coefficient model of choice D = 1 [Zβ ≥ 0]
where β is a random coefficient vector and β ⊥
                                             ⊥ (Z, U0 , U1 ) . If β is a random coefficient with a nondegen-
erate distribution and with components that take both positive and negative values, uniformity is clearly
violated. However, it can be violated even when all components of β are of the same sign if Z is a vector.
       To consider a more general case, relax the assumption of equation (3) to consider a more general case


                                                      D∗ = µD (Z, UD ) ,                                                   (17a)


where µD (Z, UD ) is not necessarily additively separable in Z and UD , and UD is not necessarily a scalar.49
In the random coefficient example, UD = β.


                                                       D = 1 [D∗ ≥ 0] .                                                    (17b)


We maintain assumptions (A-1)–(A-5) and (A-8).
       In special cases, (17a) can be expressed in an additively separable form. For example if D∗ is weakly
separable in Z and UD , D∗ = µD (θ (Z) , UD ) for any UD where θ (Z) is a scalar function, µD is increasing
in θ (Z), and UD is a scalar, then we can write (17b) in the same form as (3):

                                                             h            i
                                                    D = 1 θ (Z) ≥ Ũ ,


where Ũ = µ−1
            D (0; UD ) and Ũ ⊥
                              ⊥ Z | X, and the inverse function is expressed with respect to the first
argument. Vytlacil (2002) shows that any model that does not satisfy uniformity (or “monotonicity”) will
not have a representation in this form.50
       In the additively separable case, the MTE (4) has three equivalent interpretations. (i) UD is the
only unobservable in the first stage decision rule, and MTE is the average effect of treatment given the
unobserved characteristics in the decision rule (UD = uD ) . (ii) A person with UD = uD would be indifferent
  49
     The additively separable latent index model is more general than it may at first appear. It is shown in Vytlacil (2004)
that a wide class of threshold crossing models without the additive structure on the latent index will have a representation
with the additively separable structure on the latent index.
  50
     In the random coefficient case where Z = (1, Z1 ) where Z1 is a scalar, and β = (β0 , β1 ) if β1 > 0 for all realizations, we
can write the choice rule in the form of (3): Z1 β1 > −β0 ⇒ Z > − ββ10 and UD = − ββ10 . This trick does not work in the general
case.



                                                                 46
between treatment or not if P (Z) = uD , where P (Z) is a mean scale utility function. Thus, the MTE is
the average effect of treatment given that the individual would be indifferent between treatment or not
if P (Z) = uD . (iii) One can also view the additively separable form (3) as intrinsic in the way we are
defining the parameter and interpret the MTE (4) as an average effect conditional on the additive error
term from the first stage choice model. Under all interpretations of the MTE and under the assumptions
used in the preceding sections of this paper, MTE can be identified by LIV ; the MTE does not depend
on Z and hence it is policy invariant and the MTE integrates up to generate all treatment effects, policy
effects and all IV estimands.
      The three definitions are not the same in the general nonseparable case (17a). Heckman and Vytlacil
(2001b) extend MTE in the nonseparable case using interpretation (i). MTE defined this way is policy
invariant to changes in Z . They show that LIV is a weighted average of the MTE with possibly negative
weights and does not identify MTE. If uniformity does not hold, the definition of MTE allows one to
integrate MTE to obtain all of the treatment effects, but the instrumental variables estimator breaks
down.
      Alternatively, one could define MTE based on (ii):


                         ∆MTE
                          B   (x, z) = E (Y1 − Y0 | X = x, UD ∈ {uD : µD (z, uD ) = 0}) .


This is the average treatment effect for individuals who would be indifferent between treatment or not at a
given value of z. Heckman and Vytlacil (2001b) show that in the nonseparable case LIV does not identify
this MTE and that MTE does not change when the distribution of Z changes, provided the support of
MTE does not change.51 In general, this definition of MTE does not allow one to integrate up MTE to
obtain the treatment parameters.
      A third possibility is to force the index rule into an additive form by taking µ∗D (Z) = E (µD (Z, UD ) | Z),
defining UD∗ = µD (Z, U ) − E (µD (Z, U ) | Z) and define MTE as E (Y1 − Y0 | X = x, UD∗ = u∗D ). Note that
UD∗ is not independent of Z, is not policy invariant and is not structural. LIV does not estimate MTE.
With this definition of the MTE it is not possible, in general, to integrate up MTE to obtain the various
treatment effects.
 51
      If the support of Z changes, then the MTE must be extended to a new support.



                                                          47
   For any version of the nonseparable model, except those that can be transformed to separability,
index sufficiency fails. To see this most directly, assume that µD (Z, UD ) is absolutely continuous with
respect to Lebesgue measure. Define Ω (z) = {uD : µD (z, uD ) ≥ 0}. In the additively separable case,
P (z) ≡ Pr (D = 1 | Z = z) = Pr (uD ∈ Ω (z)) , P (z) = P (z 0 ) ⇔ Ω (z) = Ω (z 0 ) . This produces index
sufficiency. In the more general case of (17a) it is possible to have (z, z 0 ) such that P (z) = P (z 0 ) and
Ω (z) 6= Ω (z 0 ) so index sufficiency does not hold.


6.1    Implications of Nonseparability

In this section, we develop generalization (i), leaving development of the other interpretations for another
occasion. We focus on PRTE. The analysis of the other treatment parameters follows by parallel arguments.
   For any uD in the support of the distribution of UD , define ΩuD = {z : µD (z, uD ) ≥ 0}. For example,
in the random coefficient case, with UD ≡ β and D = 1[Zβ ≥ 0], we have Ωb = {z : zb ≥ 0}, where b is a
realization of β. Define 1A (t) to be the indicator function for the event t ∈ A. Then, Appendix B shows
that


E(Ya ) − E(Ya0 ) = E [E(Ya |X) − E(Ya0 | X)]                                                   (18)
                                                                                       
                                                Pr[Za ∈ ΩuD | X = x]
                   Z Z
                 =     E(∆ | X = x, UD = uD )                           dFUD |X (uD |x) dFX (x).
                                                                                        
                                                 − Pr[Za0 ∈ ΩuD | X = x]


Thus, without additive separability, we can still derive an expression for PRTE and by similar reasoning
the other treatment parameters. However, to evaluate the expression requires knowledge of MTE, of
Pr[Za ∈ ΩuD | X = x] and Pr[Za0 ∈ ΩuD | X = x] for every (uD , x) in the support of the distribution
of (UD , X), and of the distribution of UD . In general, if no structure is placed on the µD function, one
can normalize UD to be unit uniform (or a vector of unit uniform random variables) so that FUD |X will
be known. However, in this case the ΩuD = {z : µD (z, uD ) ≥ 0} sets will not in general be identified. If
structure is placed on the µD function, one might be able to identify the ΩuD = {z : µD (z, uD ) ≥ 0} sets
but then one needs to identify the distribution of UD conditional on X. If structure is placed on µD , one
cannot in general normalize the distribution of UD to be unit uniform without undoing the structure being
imposed on µD .


                                                        48
       In particular, consider the random coefficient model D = 1[Zβ ≥ 0] where UD = β is a random vector,
so that Ωβ = {z : zβ ≥ 0}. In this case, if all of the other assumptions hold, including Z ⊥
                                                                                           ⊥ β | X, and
the policy change does not affect (Y1 , Y0 , X, β), the PRTE is given by


  E(Ya ) − E(Ya0 ) = E [E(Ya |X) − E(Ya0 | X)]
                                                                                     
                                                Pr [Za ∈ Ωb | X = x]
                     Z Z
                   =     E(∆ | X = x, β = b)                            dFβ|X (b | x) dFX (x).
                                                                                      
                                                 − Pr [Za0 ∈ Ωb | X = x]


Because structure has been placed on the µD (Z, β) function, the sets Ωβ are known. However, evaluating
the function requires knowledge of the distribution of β which will not in general be identified without
further assumptions.52 Normalizing the distribution of β to be a vector of unit uniform random variables
produces the distribution of β but eliminates the assumed linear index structure on µD and results in Ωβ
sets that are not identified.
       Even if the weights are identified, Heckman and Vytlacil (2001b) show that it is not possible to use LIV
to identify MTE without additive separability between Z and UD in the selection rule index. Appendix D
develops this point for the random coefficient model. Thus, without additive separability in the latent index
for the selection rule, we can still create an expression for PRTE (and the other treatment parameters)
but both the weights and the MTE function are no longer identified using instrumental variables.
       One superficially plausible way to avoid these problems would be to define µ̃D (Z) = E(µD (Z, UD ) | Z)
and ŨD = µD (Z, UD ) − E(µD (Z, UD ) | Z), producing the model D = 1[µ̃D (Z) − ŨD ≥ 0]. We keep
the conditioning on X implicit. One could redefine MTE using ŨD and proceed as if the true model
possessed additive separability between observables and unobservables in the latent index. This is the
method pursued in approach (iii).
       For two reasons, this approach does not solve the problem of providing an adequate generalization
of MTE. First, with this definition, ŨD is a function of (Z, UD ), and a policy that changes Z will then
also change ŨD . Thus, policy invariance of the MTE no longer holds. Second, this approach generates
a ŨD that is no longer statistically independent of Z so that assumption (A-2) no longer holds when ŨD
is substituted for UD even when (A-2) is true for UD . Lack of independence between observables and
  52
    See, e.g. Ichimura and Thompson (1998) for conditions for identifying the distribution of β in a random coefficient
discrete choice model when Z ⊥
                             ⊥ β.


                                                          49
unobservables in the latent index both invalidates our expression for PRTE (and the expressions for the
other treatment effects) and causes LIV to no longer identify MTE.
   The nonseparable model can also restrict the support of P (Z) . For example, consider a standard normal
                                                                                                           
random coefficient model with a scalar regressor (Z = (1, Z1 )) . Assume β0 ∼ N (0, σ02 ), β1 ∼ N β̄1 , σ12 ,
and β0 ⊥
       ⊥ β1 . Then                                                                !
                                                                      β̄1 z1
                                                   P (z1 ) = Φ   p                    ,
                                                                  σ02 + σ12 z12

where in this usage Φ is the standard cumulative normal distribution. If the support of z1 is <1 , then in
the standard additive model σ12 = 0 and P (z1 ) has support [0, 1] . When σ12 > 0, the support is strictly
                                                                                                  
within the unit interval.53 In the special case when σ02 = 0, the support is one point P (z) = Φ σβ̄11   .
We cannot, in general, identify ATE, TT or any treatment effect requiring the endpoints 0 or 1.
      Thus the more general case model of nonuniformity presented in this section does not satisfy the index
sufficiency property, and the support of the treatment effects and estimators is, in general, less than full.
The random coefficient model for choice may explain the empirical support problems for P (Z) found in
Heckman, Ichimura, Smith, and Todd (1998).


6.2       Implications of Dependence

We next consider relaxing the independence assumption (A-2) to allow Z ⊥
                                                                       ⊥ UD | X while maintaining
the assumption that Z ⊥⊥ (Y1 , Y0 ) | (X, UD ) . We maintain the other assumptions, including additive
separability between Z and UD in the latent index for the selection rule (equation (3)) and the assumption
that the policy changes Z but does not change (UD , Y0 , Y1 , X). Thus we assume that the policy change
does not change the MTE function (policy invariance). Given these assumptions, we derive in Appendix B
the following expression for PRTE in the nonindependent case:


      E (Ya ) − E (Ya0 ) = E [E (Ya | X) − E (Ya0 | X)]                                                  (19)
                                                                                                 
                                          Pr[µD (Za0 ) < uD | X = x, UD = uD ] 
        Z Z
      =  E(∆ | X = x, UD = uD )                                                  dFUD |X (uD | x) dFX (x).
                                                                                                   
                                            − Pr[µD (Za ) < uD | X = x, UD = uD ]
                     h                   i
 53
      The interval is Φ −|β
                         σ1
                           1|
                                , Φ   |β1 |
                                       σ1      .




                                                                 50
Although we can derive an expression for PRTE without requiring independence between Z and UD , to
evaluate this expression requires knowledge of MTE and of P r[µD (Za0 ) < uD | X = x, UD = uD ] and of
P r[µD (Za ) < uD | X = x, UD = uD ]) for every (x, uD ) in the support of the distribution of (X, UD ). This
requirement is stronger than in the case of independence since the weights no longer depend only on the
distribution of Pa (Za ) and Pa0 (Za0 ) conditional on X. To evaluate these weights requires knowledge of the
function µD and of the joint distribution of (UD , Za ) and (UD , Za0 ) conditional on X, and these will in
general not be identified without further assumptions.
   Even if the weights are identified. Heckman and Vytlacil (2001b) show that it is not possible to use LIV
to identify MTE without independence between Z and UD conditional on X. Thus, without conditional
independence between Z and UD in the latent index for the decision rule, we can still create an expression
for PRTE but both the weights and the MTE function are no longer identified without invoking further
assumptions.
   One superficially appealing way to avoid these problems is to define ŨD = FUD |X,Z (UD ) and µ̃D (Z) =
FUD |X,Z (µD (Z)), so D = 1[µD (Z) − UD ≥ 0] = 1[µ̃D (Z) − ŨD ≥ 0] with ŨD ∼ U nif [0, 1] conditional on X
and Z and so ŨD is independent of X and Z. It might seem that the previous analysis would carry over.
However, by defining ŨD = FUD |X,Z (UD ), we have defined ŨD in a way that depends functionally on Z and
X, and hence we violate invariance of the MTE with respect to the shifts in the distribution of Z given X.


6.3    Do We Need Uniformity?

The monotonicity or uniformity condition and the additional condition of positive weights for MTE are
both required to obtain gross treatment effects using IV. If these conditions are violated, changes in Z
induce two way flows with some people changing into treatment and others leaving it. Thus IV does not
identify the “gross effect” of treatment. Recall from our discussion in Section 4.3 that even if we have
monotonicity or uniformity as defined in this section (a necessary and sufficient condition for the existence
of representation (4)), the discussion in Section 4.3 reveals that in a model with multiple instruments we
may still obtain negative IV weights unless we condition on the other instruments.
   Monotonicity and independence are invoked when the treatment (indicated by D) is the policy being
evaluated. But treatments are only a subset of all possible policies of interest and if the goal is to evaluate



                                                      51
the effects of a policy on aggregate outcomes, as in ∆PRTE , the monotonicity requirement may not be
needed. In that case, one is interested in the net impact of the policy and not the impact of treatment
operating through a particular mechanism or treatment. The policy of interest may entail two-way flows.
       Consider the case where D indicates schooling, which is the treatment. Define D = 1 if the person
goes to college and D = 0 otherwise. Suppose that the policy being studied is the introduction of a
physical education (PE) requirement in colleges along with mandatory augmented athletics facilities. The
policy has no effect on (Y1, Y0 ) (e.g. potential earnings) but it affects the choice of college, so it is a
valid Z. Some people hate PE while others love it and are attracted by colleges with good gyms, so
monotonicity (uniformity) is violated. If Za = z is the policy with PE and Za0 = z 0 is the policy without
PE, E(Y |Za = z)−E(Y |Za0 = z 0 ) is a perfectly valid policy parameter—the effect of the policy on aggregate
outcomes—even if uniformity is violated and ∆MTE is not policy invariant. One only needs uniformity,
policy invariance and the other assumptions only when the policy is a treatment.


6.4       The Limits of Instrumental Variable Estimators

The treatment effect literature focuses on a class of policies that move treatment choices in the same
direction for everyone. General instruments do not have universally positive weights on ∆MTE . They are
not guaranteed to shift everyone in the same direction. They do not necessarily estimate gross treatment
effects. However, the effect of treatment is not always the parameter of policy interest. Thus, in the
example just presented, schooling is the vehicle through which policy operates. One might be interested
in the effect of schooling (the treatment effect) or the effect of the policy. These are separate issues unless
the policy is the treatment.
       Generalizing the MTE to the case of a nonseparable choice equation that violates the monotonicity
condition, we can define but cannot identify the policy parameters of interest. If we make the model
symmetrically heterogeneous in outcome and choice equations, the method of instrumental variables and
our extensions of it break down in terms of estimating economically interpretable parameters. This case is
beyond the outer limits of an entire literature, although it captures intuitively plausible phenomena. More
general structural methods are required.54
  54
    The framework of Carneiro, Hansen, and Heckman (2003) can be generalized to allow for random coefficients models
in choice equations, and lack of policy invariance in the sense of (A-7). However, a fully semiparametric analysis does not



                                                            52
7     Summary and Proposed Extensions

This paper develops an approach to policy evaluation based on the marginal treatment effect (∆MTE ),
which provides a choice-theoretic foundation for organizing the treatment effect literature. All of the
conventional treatment effect parameters can be expressed as different weighted averages of ∆MTE . These
conventional treatment effect parameters do not, in general, answer economically interesting questions.
We define the policy relevant treatment effect as the solution to a Benthamite policy criterion for policies
operating on decisions to participate, but not on potential outcomes. The policy relevant treatment effect
can be represented as a weighted average of ∆MTE where the weights differ in general from the weights used
to generate conventional treatment effects. Thus the conventional treatment effects are not guaranteed to
answer policy relevant questions.
    Instrumental variable estimators and OLS estimators converge to expressions that can be represented
as weighted averages of ∆MTE parameters, with the weights in general different from those used to define
the various treatment effects and the weights not necessarily positive so they do not identify a gross
treatment effect. We show how to check whether the weights are positive. Conventional IV and matching
assumptions impose a strong condition on the ∆MTE —that selection into programs is not made in terms
of any unobservable gain from program participation.
    We present methods for estimating ∆MTE based on local instrumental variables and we develop a new
instrumental variable for recovering policy relevant treatment effects using standard instrumental variable
methods. We present conditions for using IV to estimate well-posed policy questions. We show that
IV need not generate any interesting policy counterfactual, and that there are policy counterfactuals for
which no IV can be generated. In a model of heterogeneous responses, there is no natural superiority of
conventional IV over OLS in estimating policy relevant parameters. We develop the conditions required
to forecast the effects of old policies on new environments and the effects of new policies. These issues
are typically ignored in the treatment effect literature but are central to the structural policy evaluation
literature.
    The model presented in this paper and the models presented in the recent literature on instrumental
variables in heterogeneous response models are fundamentally asymmetric. Responses to treatment are
appear to be possible. This generalization is under preparation for publication.



                                                             53
allowed to be heterogeneous in a general way, but choices of treatment are not. When we develop a
symmetrically heterogeneous model, the method of instrumental variables breaks down entirely, and a
different approach to econometric policy analysis is required.

    Department of Economics, University of Chicago, 1126 E. 59th Street, Chicago, IL, 60637, U.S.A.
jjh@uchicago.edu,


                                                    and


    Dept. of Economics, Stanford University, 579 Serra Mall, Palo Alto, CA, 94305, U.S.A.
vytlacil@stanford.edu



Appendices

A      Testable Monotonicity in P Restriction

Theorem 1. Assume Y0 , Y1 , and D are determined by equations 2a, 2b and 3 respectively. Assume con-
ditions (A-1) through (A-5) hold.


  (i) Let g0 , g1 be any real valued functions such that g0 (Y0 , X), g1 (Y1 , X) ≥ 0 with probability 1. Then
      E((1 − D)g0 (Y, X) | X, P (Z) = p) is weakly decreasing in p and E(Dg1 (Y, X) | X, P (Z) = p) is
      weakly increasing in p.

 (ii) Let g0 , g1 be any real valued functions such that g0 (Y0 , X), g1 (Y1 , X) > 0 with probability 1. Then
      E((1 − D)g0 (Y, X) | X, P (Z) = p) is strictly decreasing in p and E(Dg1 (Y, X) | X, P (Z) = p) is
      strictly increasing in p.


Proof. Consider assertion (i). Consider E(Dg1 (Y, X)|X = x, P (Z) = p) for some x. Let p1 , p0 denote any
two points in the support of the distribution of P (Z) conditional on X = x such that p1 > p0 . Then




                                                     54
E (Dg1 (Y, X)|X = x, P (Z) = p1 ) − E (Dg1 (Y, X)|X = x, P (Z) = p0 )


     = E(1[UD ≤ P (Z)]g1 (Y1 , X)|X = x, P (Z) = p1 ) − E(1[UD ≤ P (Z)]g1 (Y1 , X)|X = x, P (Z) = p0 )

     = E(1[UD ≤ p1 ]g1 (Y1 , X)|X = x) − E(1[UD ≤ p0 ]g1 (Y1 , X)|X = x)

     = E({1[UD ≤ p0 ] + 1[p0 < UD ≤ p1 ]}g1 (Y1 , X)|X = x) − E(1[UD ≤ p0 ]g1 (Y1 , X)|X = x)

     = E(1[p0 < UD ≤ p1 ]g1 (Y1 , X)|X = x)

     ≥ 0,


where the first equality follows from the definition of D and uses the fact that Dg1 (Y, X) = Dg1 (Y1 , X); the
second equality uses independence condition (A-2); the third equality uses the fact that p0 < p1 and thus
that 1[UD ≤ p1 ] = 1[UD ≤ p0 ] + 1[p0 < UD ≤ p1 ]; the fourth equality follows from linearity of expectations;
the final inequality follows from g1 (Y1 , X) ≥ 0 with probability 1. The proof that E((1 − D)g0 (Y, X) |
X, P (Z) = p) is decreasing in p follows from a similar argument. Assertion (ii) follows from a trivial
modification of the last line of the above proof.                                                         Q.E.D.


   Consider the following examples of g0 and g1 :


  (i) If Y1 , Y0 are known to be nonnegative (for example, Y1 , Y0 are indicator variables, or Y1 , Y0 are wages),
      then we may choose gj (Y, X) = Y . In this example, Theorem 1 implies that E((1 − D)Y | X, P (Z) =
      p) is weakly decreasing in p and E(DY | X, P (Z) = p) is weakly increasing in p. More generally,
      if Y1 , Y0 are known to be bounded from below by a function of X so that Y1 ≥ l1 (X), Y0 ≥ l0 (X)
      with probability 1, then we may choose gj (Y, X) = Y − lj (X) so that Theorem 1 implies that
      E((1 − D)(Y − l0 (X)) | X, P (Z) = p) is weakly decreasing in p and E(D(Y − l1 (X)) | X, P (Z) = p)
      is weakly increasing in p.

 (ii) Without any assumptions on the support of the distribution of Y1 , Y0 , let t denote a real number and
      take gj (Y, X) = 1[Y ≤ t] for j = 0, 1. Then Theorem 1 implies that Pr(D = 0, Y ≤ t | X, P (Z) = p)
      is weakly decreasing in p and Pr(D = 1, Y ≤ t | X, P (Z) = p) is weakly increasing in p. More
      generally, let A denote any measurable subset of the real line, and take gj (Y, X) = 1[Y ∈ A] for



                                                       55
         j = 0, 1. Then the conclusion of the proposition can be rewritten as Pr(D = 0, Y ∈ A | X, P (Z) = p)
         is weakly decreasing in p and Pr(D = 1, Y ∈ A | X, P (Z) = p) is weakly increasing in p.


       For any choice of g0 , g1 , the restriction of Theorem 1 leads to the prediction that regression functions
E((1 − D)g0 (Y, X) | X, P (Z) = p) and E(Dg1 (Y, X) | X, P (Z) = p) satisfy the monotonicity conditions.
This is an example of a nonparametric null with shape restrictions versus a nonparametric alternative. A
formal test of the null hypothesis can be implemented using the methodology of Ghosal, Sen, and van der
Vaart (2000).
       The restrictions of Theorem 1 nest the Imbens-Rubin (1997) restrictions on IV as a special case. They
assume a binary Z, and obtain the density of Y1 and Y0 from the observed data and derive the testable
restriction that these densities be nonnegative.55 Our analysis is more general.56



B         Derivation of PRTE and IV Weights

Proof. (Equation (6)) To simplify the notation, assume that V (Y ) = Y . Modifications required for the
more general case are obvious. Define 1A (t) to be the indicator function for the event t ∈ A. Then

E (Ya | X)

               Z     1
           =     E(Ya |X, Pa (Za ) = p) dFPa |X (p)
                 0
             Z 1 Z 1                                                                          
           =          [1[0,p] (uD )E(Y1,a | X, UD = uD ) + 1(p,1] (uD )E(Y0,a | X, UD = uD ) du dFPa |X (p)
              0     0
             Z 1 Z 1                                                                                   
           =          [1[uD ,1] (p)E(Y1,a | X, UD = uD ) + 1(0,uD ] (p)E(Y0,a | X, UD = uD ) dFPa |X (p) duD
              0     0
             Z 1
                                                                                               
           =      (1 − FPa |X (uD ))E(Y1,a | X, UD = uD ) + FPa |X (uD )E(Y0,a | X, UD = uD ) duD .
                 0
  55
    See also Heckman, Smith, and Taber (1998) for a closely related test.
  56
    For ease of exposition, suppress conditioning on X. Take the case where Z = 0, 1, and P (1) > P (0). Consider the Y1
outcome; the analysis for Y0 is completely symmetric. For binary Z with P (1) > P (0), our restriction can be rewritten
as E(Dg1 (Y )|Z = 1) ≥ E(Dg1 (Y )|Z = 0). Take g1 (Y ) = 1[Y ∈ A] for any pre-specified set A, for example, the intervals
examined in the histogram analyzed in the Imbens-Rubin paper. In this special case, our monotonicity restriction is that
Pr(D = 1, Y ∈ A|Z = 1) − Pr(D = 0, Y ∈ A|Z = 0) > 0, and the restriction is the same as the Imbens and Rubin restriction
of a nonnegative density. Our analysis replaces their densities with the probability that Y lies in any given set. Thus, their
restriction is a very special case of the general monotonicity restriction developed in this paper.




                                                             56
This derivation involves changing the order of integration. Note that from (A-4),


         E|1[0,p] (uD )E(Y1,a | X, UD = uD ) + 1(p,1] (uD )E(Y0,a | X, UD = uD )| ≤ E(|Y1 | + |Y0 |) < ∞,


so the change in the order of integration is valid by Fubini’s theorem. Comparing policy a to policy a0 ,

                                             Z     1
               E (Ya | X) − E (Ya0 | X) =              E(∆ | X, UD = uD )(FPa0 |X (uD ) − FPa |X (uD )) duD ,
                                               0



which gives the required weights. (Recall ∆ = Y1 − Y0 and from (A-7) we can drop the a, a0 subscripts on
outcomes and errors.)                                                                                           Q.E.D.


   Relaxing (A-7): Implications of Noninvariance for PRTE.

   Suppose that all of the assumptions invoked up to Section 3 are satisfied, including additive separability
in the latent index choice equation (3) (equivalently, the monotonicity or uniformity condition). Impose
the normalization that the distribution of UD is unit uniform. Suppose however, contrary to (A-7), that
the distribution of (Y1 , Y0 , UD , X) is different under the two regimes a and a0 . Thus, let (Y1,a , Y0,a , UD,a , Xa )
and (Y1,a0 , Y0,a0 , UD,a0 , Xa0 ) denote the random vectors under regimes a and a0 , respectively. Following the
same analysis as used to derive equation (6), the PRTE conditional on X is given by


E(Ya | Xa = x) − E (Ya0 |Xa0 = x)
        Z 1
                                                                                  
     =       E(Y1,a − Y0,a | Xa = x, UD,a0 = u) FPa0 |Xa0 (u | x) − FPa |Xa (u | x) du
        Z0 1
     +       [E(Y0,a | Xa = x, UD,a = u) − E(Y0,a0 | Xa0 = x, UD,a0 = u)] du
         0
        Z 1                                                                                                
                                                                                                          
     +        (1 − FPa0 |X (u | x)) E(Y1,a − Y0,a | Xa = x, UD,a = u) − E(Y1,a0 − Y0,a0 | Xa0 , UD,a0 = u) du .
           0



Thus, when the policy affects the distribution of (Y1 , Y0 , UD , X), the PRTE is given by the sum of three
terms: (I) the value of PRTE if the policy did not affect (Y1 , Y0 , X, UD ); (II) the weighted effect of the
policy change on E(Y0 | X, UD ); and (III) the weighted effect of the policy change on MTE. Evaluating
the PRTE requires knowledge of the MTE function in both regimes, knowledge of E(Y0 | X = x, UD = u)
in both regimes, as well as knowledge of the distribution of P (Z) in both regimes. Note, however, that

                                                                57
if we assume that the distribution of (Y1,a , Y0,a , UD,a ) conditional on Xa = x equals the distribution of
(Y1,a0 , Y0,a0 , UD,a0 ) conditional on Xa0 = x, then E(Y1,a | UD,a = u, Xa = x) = E(Y1,a0 | UD,a0 = u, Xa0 = x),
E(Y0,a | UD,a = u, Xa = x) = E(Y0,a0 | UD,a0 = u, Xa0 = x), and thus that terms (II) and (III) are zero and
the expression for PRTE simplifies to the expression of equation (6).


Proof. (Equation (10))


 Cov (Jx (Z) , Y | X) = E ([Jx (Z) − E (J (Z) | X)] Y | X)

                         = E ((J (Z) − E (J (Z) | X)) (Y0 + D (Y1 − Y0 )) | X)

                         = E ((J (Z) − E (J (Z) | X)) D (Y1 − Y0 ) | X)
                                                                  
                                ˜
                         = E J(Z)    1[UD ≤ P (Z)] (Y1 − Y0 ) X
                                                                              
                                ˜
                         = E J(Z)    1[UD ≤ P (Z)] E (Y1 − Y0 | X, Z, UD ) X
                                                                            
                                ˜
                         = E J(Z)    1[UD ≤ P (Z)] E (Y1 − Y0 | X, UD ) X
                                                                                         
                                  ˜
                         = E E J(Z) 1[UD ≤ P (Z)] X = x, UD E (Y1 − Y0 | X, UD ) X
                           Z 1                                                                   
                         =         ˜
                                 E(J(Z) | X, P (Z) ≥ uD ) Pr(P (Z) ≥ uD )E (Y1 − Y0 | X, UD = uD ) duD
                            0
                           Z 1
                         =                      ˜
                               ∆MTE (X, uD )E(J(Z)  | X, P (Z) ≥ uD ) Pr(P (Z) ≥ uD )duD
                              0




   The third equality follows from (3); the fourth equality follows from the law of iterated expectations
with the inside expectation conditional on (X, Z, UD ); the fifth equality follows from assumption (A-2);
the sixth equality follows from the law of iterated expectations with the inside expectation conditional
on (X = x, UD ); the seventh equality follows from Fubini’s Theorem and the normalization that UD is
distributed unit uniform conditional on X; and the final equality follows from plugging in the definition
of ∆MTE . Yitzhaki (1996, 1999) was the first to develop the interpretation of IV as a weighted average
although he did not develop the MTE.                                                                     Q.E.D.




                                                       58
Proof. (Equation (18)) E (Ya | X)

       Z
   =   E(Ya |X, UD = uD , Za = z) dFUD ,Za |X (uD , z)
     Z                                                                           
   =     1ΩuD (z)E(Y1 |X, UD = uD , Za = z) + 1ΩcuD (z)E(Y0 |X, UD = uD , Za = z) dFUD ,Za |X (uD , z)
     Z                                                          
   =     1ΩuD (z)E(Y1 |X, UD = uD ) + 1ΩcuD (z)E(Y0 |X, UD = uD ) dFUD ,Za |X (uD , z)
     Z Z                                                                       
   =         1ΩuD (z)E(Y1 |X, UD = uD ) + 1ΩcuD (z)E(Y0 |X, UD = uD ) dFZa |X (z) dFUD |X (uD )
     Z
   =   [Pr[Za ∈ ΩuD | X]E(Y1 |X, UD = uD ) + (1 − Pr[Za ∈ ΩuD | X])E(Y0 |X, UD = uD )] dFUD |X (uD )


where ΩcuD denotes the complement of ΩuD and where the first equality follows from the law of iterated
expectations; the second equality follows by plugging in our threshold crossing model for D; the third
equality follows from independence Z ⊥⊥ (Y1 , Y0 , UD ) | X; the fourth and fifth equalities follow by an
application of Fubini’s Theorem and a rearrangement of terms. Fubini’s Theorem may be applied by
assumption (A-4). Thus comparing policy a to policy a0 , we obtain (18).

                             Z
  E(Ya | X) − E(Ya0 | X) =       E(∆ | X, UD = uD )(Pr[Za ∈ ΩuD | X] − Pr[Za0 ∈ ΩuD | X]) dFUD |X (uD ).


                                                                                                   Q.E.D.


Proof. (Equation (19))




                                                    59
E (Ya | X)

                  Z
              =       E(Ya |X, UD = uD , Za = z) dFUD ,Za |X (uD , z)
                                                                      
                       1[0,µD (z)] (uD )E(Y1 | X, Z = z, UD = uD ) 
                  Z
              =                                                        dFUD ,Za |X (uD , z)
                        +1(µD (z),1] (uD )E(Y0 | X, Z = z, UD = uD )
                                                              
                       1[0,µD (z)] (uD )E(Y1 | X, UD = uD ) 
                  Z
              =                                                dFUD ,Za |X (uD , z)
                        +1(µD (z),1] (uD )E(Y0 | X, UD = uD )
                                                                                      
                        1[0,µD (z)] (uD )E(Y1 | X, UD = uD ) 
                  Z    Z
              =                                                       dFZa |UD (z | uD ) dFUD |X (uD )
                                                                                         
                       
                              +1(µD (z),1] (uD )E(Y0 | X, UD = uD )
                                                                                     
                       (1 − Pr[µD (Za ) < uD | UD = uD ]) E (Y1 | X, UD = uD ) 
                  Z
              =                                                                       dFUD |X (uD )
                        + Pr [µD (Za ) < uD | UD = uD ] E (Y0 | X, UD = uD )


where the first equality follows from the law of iterated expectations; the second equality follows by plugging
in our model for D; the third equality follows from independence Z ⊥
                                                                   ⊥ (Y1 , Y0 ) | X, UD ; the fourth equality
follows by an application of Fubini’s Theorem; and the final equality follows immediately. Thus comparing
policy a to policy a0 , we obtain (19) in the text.                                                        Q.E.D.



C      Proofs of Propositions

Proof of Proposition 1
    We first show that, given (i), conditions (ii) and (iii) are sufficient for the instrument Jx (Z) defined the
proposition to have the desired properties. As a preliminary step, note that

                                       Z     1                                   Z   1
                                                                   0
                      E(Jx |X = x) =             1[fP |X (p|x) > 0]w (p|x)dp =           w0 (p|x)dp = 0,
                                         0                                       0



where the first equality comes from plugging in the proposed Jx and using condition (i); the second
equality follows from condition (iii); and the final equality follows from condition (ii). We now check that




                                                             60
the proposed Jx is correlated with D under conditions (i) to (iii).

                                                                Z    1                                    Z   1
                                                                                           0
Cov(Jx (Z), D | X = x) = Cov(Jx (Z), P (Z) | X = x) =                    1[fP |X (p|x) > 0]w (p|x)pdp =           w0 (p|x)pdp = −1,
                                                                 0                                        0



where the first equality follows from the law of iterated expectations; the second equality comes from
plugging in the proposed Jx and using E(Jx |X = x) = 0; the third equality uses condition (iii) and the
final equality follows from integration by parts using condition (ii). We now check that the proposed
instrument Jx implies the desired weights on ∆MTE . With the proposed Jx , for u such that fP |X (u|x) > 0,

                                          T (u | x; Jx )fP |X (u|x)
                                      −                             = w0 (u|x),
                                          Cov (Jx , P | X = x)

where the equality comes from plugging in the proposed Jx and using E(Jx |X = x) = 0 and Cov (Jx , P |
X = x) = −1. Thus, for u such that fP |X (u|x) > 0, we have that −T (u | x; Jx )fP |X (u|x)/Cov (Jx , P |
X = x) = w0 (u|x) as desired. For u such that fP |X (u|x) = 0, condition (iii) implies that w0 (u|x) = 0, and
thus trivially −T (u | x; Jx )fP |X (u|x)/Cov (Jx , P | X = x) = w0 (u|x) for u such that fP |X (u|x) = 0.
   We now show that, given condition (i), conditions (ii) and (iii) are necessary. First, consider condition
(ii). We have previously established that the weights corresponding to any instrument must integrate
to one, and that the weights corresponding to any instrument must satisfy w(0 | x) = 0. One can also
directly verify that w(1 | x) = 0 unless the conditional distribution of P (Z) has a mass point at 1. The
conditional distribution of P (Z) does not have a mass point at 1 by condition (i). Using condition (i),
one can apply Lebesgue’s theorem for the derivative of an integral to show that the weights corresponding
to any instrument will be differentiable. Thus, given condition (i), the weights corresponding to any
instrument will satisfy condition (ii), and thus condition (ii) is a necessary condition for there to exist
an instrument that corresponds to the desired weights. Now assume conditions (i) and (ii), and consider
condition (iii). Suppose that (iii) does not hold, so that there exists a set of t values such that fP |X (t|x) = 0
but w0 (t|x) > 0. Then, for such values of t,

                                                T (t | x; Jx )fP |X (t|x)
                                            −                             =0
                                                Cov (Jx , P | X = x)

for any potential instrument Jx while w0 (t|x) > 0, and thus trivially there cannot exist an instrument Jx

                                                           61
such that
                                            T (t | x; Jx )fP |X (t|x)
                                        −                             = w0 (t|x)
                                            Cov (Jx , P | X = x)

for all t. Thus, given condition (i), conditions (ii) and (iii) are necessary for the existence of an instrument
with the desired properties.                                                                                 Q.E.D.
   Proof of Proposition 2
   Define
                                                 FPa0 |X (· | x) − FPa |X (· | x)
                                  w(·|x) ≡                                        .
                                               E(Pa | X = x) − E(Pa0 | X = x)

We now show that conditions (i) and (ii) of Proposition 2 imply conditions (i) and (ii) of Proposition 1
when w(·|x) is defined in this manner. Note that condition (i) of Proposition 2 immediately implies that
condition (i) of Proposition 1 holds. Condition (i) of Proposition 2 implies that w(·|x) is differentiable for
all evaluation points with
                                                  fPa0 |X (· | x) − fPa |X (· | x)
                                  w0 (·|x) =                                       .
                                               E(Pa | X = x) − E(Pa0 | X = x)
                                                                                            R1
Since FPa |X (·) and FPa0 |X (·) are distribution functions, one can directly verify that   0
                                                                                                 w(u|x)du = 1. Since
the propensity score is always bounded by 0 and 1, using condition (i), FPa |X (1 | x) = FPa0 |X (1 | x) = 1
and FPa |X (0 | x) = FPa0 |X (0 | x) = 0 and thus w(1|x) = w(0|x) = 0. Defining w(·|x) in this manner, we
have that conditions (i) and (ii) of Proposition 2 imply conditions (i) and (ii) of Proposition 1. Given

                                                  fPa0 |X (· | x) − fPa |X (· | x)
                                  w0 (·|x) =                                       ,
                                               E(Pa | X = x) − E(Pa0 | X = x)

we have that condition (iii) of Proposition 2 is equivalent to condition (iii) of Proposition 1 for this choice
of w(·|x). The result now follows directly from Proposition 1.                                               Q.E.D.
   Proof of Proposition 3
   Assume that the conditions of Proposition 1 hold almost everywhere with respect to X. From the proof
of Proposition 1, under the stated conditions, E(J(Z) | X) = 0, Cov (J(Z), D | X) = −1, and

                                Cov (J(Z), Y | X)
                                                          Z
                                                  =           ∆MTE (X, u)w(u|X)du.
                                Cov (J(Z), D | X)

It follows that Cov (J(Z), D | X) = Cov (J(Z), D | X) = −1, that Cov (J(Z), Y ) = E(J(Z)Y ) =


                                                           62
             
E E(J(Z)Y | X) , and thus that

            Cov (J(Z), Y )                     
                           = E −E(J(Z)Y | X)
            Cov (J(Z), D)
                                                   Z Z 1                    
                                 Cov (J(Z), Y | X)           MTE
                           = E                      =       ∆    (x, u)w(u|x)du dFX (x).
                                 Cov (J(Z), D | X)       0



                                                                                                            Q.E.D.
   Proof of Proposition 4
   We first show that, given condition (i), conditions (ii) and (iii) are sufficient for the instrument
Jx (Z) defined by the proposition to have the desired properties. For notational convenience, define
πl = Pr[P (Z) = pl ], for l = 1, ..., K. As a preliminary step, note that with this definition of Jx (Z),

                                    K                       K
                                   X   1                   X
                    E(Jx |X = x) =        [wl − wl+1 ]πl =     [wl − wl+1 ] = w1 − wK+1 = 0
                                   l=1
                                       πl                  l=1


where we use the fact that w1 = wK+1 = 0. We now check that the proposed Jx is correlated with D under
conditions (i) to (iii).


                     Cov(Jx (Z), D | X = x) = Cov(Jx (Z), P (Z) | X = x)
                                               K                           K
                                              X   1                      X
                                            =        [wl − wl+1 ]pl πl =      [pl − pl−1 ]wl
                                              l=1
                                                  πl                      l=2
                                              XK Z pl                  Z 1
                                            =          w(t | x)dt =        w(t | x)dt = 1,
                                                   l=1   pl−1             0



where the first equality follows from the law of iterated expectations; the second equality comes from
E(Jx |X = x) = 0 and plugging in the proposed Jx (Z); the third equality rearranges terms in the sum
using w1 = wK+1 = 0; the fourth equality uses condition (iii) and the definition of wl ; the fifth equality
uses linearity of integration; and the final equality uses condition (ii). We now check that the proposed
instrument Jx implies the desired weights on ∆MTE . Using Cov(Jx (Z), D | X = x) = 1 and that E(Jx (Z) |
X = x) = 0, the IV weights corresponding to the proposed Jx (Z) as given by hIV (u) = E(Jx (Z) 1[P (Z) ≥
u]). We immediately have hIV (u) = w(u | x) = 0 for u ∈ (pK , 1] and for u ∈ [0, p1 ]. For u ∈ (pj−1 , pj ],




                                                         63
j = 2, ..., K, we have

                              K                                 K
                             X   1                             X
  E(Jx (Z) 1[P (Z) ≥ u]) =           [wl − wl+1 ]1[pl ≥ u]πl =     [wl − wl+1 ] = wj − wK+1 = wj = w(u | x)
                             l=1
                                 π l
                                                               l=j



where the first equality comes from plugging in the proposed Jx (Z); the second equality follows from
u ∈ (pj−1 , pj ]; the third equality follows by rearranging terms; the fourth equality follows from wK+1 = 0;
and the final equality follows by the definition of wj and the fact that u ∈ (pj−1 , pj ].
    We now show that, given condition (i), conditions (ii) and (iii) are necessary. First, consider condition
(ii). One can verify that the weights corresponding to any instrument must integrate to one. One can
also verify that the weights corresponding to any instrument must satisfy w(u | x) = 0 for u ≤ pM
                                                                                                x
                                                                                                  in


and for u > pM
             x
               ax
                  , where pM
                           x
                             in
                                and pM
                                     x
                                       ax
                                          are the minimum and maximum values in the support of the
conditional distribution of P (Z). Given condition (i), one can immediately verify that the IV weights for
any instrument must satisfy condition (iii). Thus, given condition (i), the weights corresponding to any
instrument will satisfy conditions (ii) and (iii), and thus, given condition (i), conditions (ii) and (iii) are
necessary conditions for there to exist an instrument that corresponds to the desired weights.         Q.E.D.



D      Local Instrumental Variables for the Random Coefficient

       Model

Consider the model:
                                                D = 1[Zβ ≥ 0],

where β is a random variable. For ease of exposition, we leave implicit the conditioning on X covariates.
Assume that (Y0 , Y1 , β) ⊥⊥ Z. Assume that β has a density that is absolutely continuous with respect to
Lebesgue measure on <K . We have


                         E(Y | Z = z) = E(DY1 | Z = z) + E((1 − D)Y0 | Z = z).




                                                       64
To simplify the exposition, first consider the first term, E(DY1 | Z = z). Using the model, the independence
assumption, and the law of iterated expectations, we have

                                                                          
                       E(DY | Z = z) = E 1[zβ ≥ 0]Y1 = E 1[zβ ≥ 0]E(Y1 | β)
                                                                         
                                             [K] [K]   [−K] [−K]
                                     = E 1 z β ≥ −z        β       E(Y1 | β)


where the final outer expectation is over β. Consider taking the derivative with respect to the Kth element
of Z assumed to be continuous. Let Z [K] denote the Kth element of Z and Z [−K] denote all other elements
of Z, and write Z = (Z [−K] , Z [K] ). Likewise, partition z, β, and b as z = (z [−K] , z [K] ), β = (β [−K] , β [K] ),
and b = (b[−K] , b[K] ), where z is a realization of Z and b is a realization of β. For simplicity, suppose that
the Kth element of z is positive, z [K] > 0. We obtain

                                                                                  
                                       [K] [K]       [−K] [−K]                   [−K]
                E(DY | Z = z) = E E 1 z β ≥ −z           β       E(Y1 | β)     β

                                             −z [−K] β [−K]
                                                                              
                                        [K]                                  [−K]
                              = E E 1 β ≥                     E(Y1 | β)    β         ,
                                                  z [K]

where the inside expectation is over β [K] conditional on β [−K] , i.e., is over the Kth element of β conditional
on all other components of β. Thus,

                                                        Z
                          ∂
                                E(DY | Z = z) =             E(Y1 | β = M (b[−K] ))w̃(b[−K] )db[−K] ,
                         ∂z [K]

where
                                         −z [−K] b[−K] 0                   z [−K] b[−K]      [−K] −z
                                                                                                     [−K] [−K]
                                                                                                          b
             M (b[−K] ) = ((b[−K] )0 ,         [K]
                                                      )  and w̃(b [−K]
                                                                       ) =      [K]  2
                                                                                        f (b     ,      [K]
                                                                                                               )
                                             z                                (z )                    z

with f (·) the density of β (with respect to Lebesgue measure), and where for notational simplicity we
suppress the dependence of the function M (·) and the weights w̃(·) on the z evaluation point. In this
expression, we are averaging over E(Y1 | β = b), but only over b evaluation points such that zb = 0. In
particular, the expression average over the K − 1 space of b[−K] , while for each potential realization of b[−K]
it is filling in the value of b[K] such that z [K] b[K] = −z [−K] b[−K] so that z [K] b[K] +z [−K] b[−K] = 0. Note that the
                                                                          [−K] b[−K]
weights w̃(b−K] ) will be zero for any b[−K] such that f (b[−K] , −z       z [K]
                                                                                       ) = 0, i.e., the weights will be zero for



                                                                65
any b[−K] such that there does not exist b[K] in the conditional support of β [K] with z [K] b[K] = −z [−K] b[−K] .
   Following the same logic for E((1 − D)Y0 | Z = z) we obtain

                                                  Z
                     ∂
                           E((1 − D)Y | Z = z) = − E(Y0 | β = M (b[−K] ))w̃(b[−K] )db[−K]
                    ∂z [K]

and likewise have
                                                                                   Z
                                        ∂
                                              Pr(D = 1 | Z = z) =                      w̃(b[−K] )db[−K]
                                       ∂z [K]

so that
                          ∂
                               E(Y    | Z = z)
                                                            Z
                        ∂z [K]
                      ∂
                                                        =       E(Y1 − Y0 | β = M (b[−K] ))w(b[−K] )db[−K] ,
                    ∂z [K]
                             Pr (D = 1 | Z = z)

where
                                                                              Z
                                                [−K]              [−K]
                                          w(b          ) = w̃(b          )/       w̃(b[−K] )db[−K] .

   Now consider the question of whether this expression will include both positive and negative weights.
                             z [−K] b[−K]              [−K] [−K]
Recall that w̃(b[−K] ) =        (z [K] )2
                                          f (b[−K] , −z z[K]b    ).      Thus,


                     w̃(b[−K] ) ≥ 0 if z [−K] b[−K] > 0,                      w̃(b[−K] ) ≤ 0 if z [−K] b[−K] < 0,


and will be nonzero if z [−K] b[−K] 6= 0 and there exists b[K] in the conditional support of β [K] with z [K] b[K] =
z [−K] b[−K] , i.e., with zb = 0. We thus have that there will be both positive and negative weights on the
MTE if there exists values of b in the support of β with both z [−K] b[−K] > 0 and zb = 0, and there exists
other values of b in the support of β with z [−K] b[−K] < 0 and zb = 0.




                                                                      66
References

Ahn, H., and J. Powell (1993): “Semiparametric Estimation of Censored Selection Models with a
  Nonparametric Selection Mechanism,” Journal of Econometrics, 58(1-2), 3–29.

Amemiya, T. (1985): Advanced Econometrics. Harvard University Press, Cambridge, MA.

Andrews, D. W., and M. M. Schafgans (1998): “Semiparametric Estimation of the Intercept of a
  Sample Selection Model,” Review of Economic Studies, 65(3), 497–517.

Angrist, J., K. Graddy, and G. Imbens (2000): “The Interpretation of Instrumental Variables
  Estimators in Simultaneous Equations Models with an Application to the Demand for Fish,” Review of
  Economic Studies, 67(3), 499–527.

Angrist, J. D., and A. B. Krueger (1999): “Empirical Strategies in Labor Economics,” in Handbook
  of Labor Economics, ed. by O. Ashenfelter, and D. Card, vol. 3A, pp. 1277–1366. North-Holland, New
  York.

Björklund, A., and R. Moffitt (1987): “The Estimation of Wage Gains and Welfare Gains in Self-
  Selection,” Review of Economics and Statistics, 69(1), 42–49.

Campbell, D. T., and J. C. Stanley (1966): Experimental and quasi-experimental designs for research.
  Rand McNally, Skokie.

Carneiro, P., K. Hansen, and J. J. Heckman (2003): “Estimating Distributions of Treatment
  Effects with an Application to the Returns to Schooling and Measurement of the Effects of Uncertainty
  on College Choice,” International Economic Review, 44(2), 361–422, 2001 Lawrence R. Klein Lecture.

Chen, X., and Y. Fan (1999): “Consistent Hypothesis Testing in Semiparametric and Nonparametric
  Models for Econometric Time Series,” Journal of Econometrics, 91(2), 373–401.

Cunha, F., J. J. Heckman, and S. Navarro (2005): “Separating Uncertainty from Heterogeneity in
  Life Cycle Earnings, The 2004 Hicks Lecture,” Oxford Economic Papers, 57(191-261), 1–72.

Ellison, G., and S. F. Ellison (1999): “A Simple Framework for Nonparametric Specification Testing,”
  Journal of Econometrics, 96, 1–23.

                                                   67
Florens, J.-P., J. J. Heckman, C. Meghir, and E. Vytlacil (2002): “Instrumental Variables,
  Local Instrumental Variables and Control Functions,” Discussion Paper CWP15/02, CEMMAP.

Ghosal, S., A. Sen, and A. W. van der Vaart (2000): “Testing Monotonicity of Regression,” The
  Annals of Statistics, 28(4), 1054–1082.

Gill, R. D., and J. M. Robins (2001): “Graphical Models and Causal Inference - Causal Inference for
  Complex Longitudinal Data: The Continuous Case,” Annals of Statistics, 29(6), 1–27.

Hansen, L. P., and T. J. Sargent (1981): “Rational Expectations Models of Dynamically Interre-
  lated Variables,” in Linear Rational Expectations Models of Dynamically Interrelated Variables, ed. by
  R. Lucas, and T. Sargent, pp. 127–156. University of Minnesota Press, Minneapolis.

Heckman, J. J. (1976): “The Common Structure of Statistical Models of Truncation, Sample Selection
  and Limited Dependent Variables and a Simple Estimator for Such Models,” Annals of Economic and
  Social Measurement, 5(4), 475–492.

         (1990): “Varieties of Selection Bias,” American Economic Review, 80(2), 313–18.

         (1997): “Instrumental Variables: A Study of Implicit Behavioral Assumptions Used in Making
  Program Evaluations,” Journal of Human Resources, 32(3), 441–62, Addendum published vol. 33 no. 1
  (Winter 1998).

        (2001): “Micro Data, Heterogeneity, and the Evaluation of Public Policy: Nobel Lecture,” Journal
  of Political Economy, 109(4), 673–748.

Heckman, J. J., H. Ichimura, J. Smith, and P. E. Todd (1998): “Characterizing Selection Bias
  Using Experimental Data,” Econometrica, 66(5), 1017–1098.

Heckman, J. J., H. Ichimura, and P. E. Todd (1997): “Matching as an Econometric Evaluation
  Estimator: Evidence from Evaluating a Job Training Programme,” Review of Economic Studies, 64(4),
  605–654.




                                                  68
Heckman, J. J., R. J. LaLonde, and J. A. Smith (1999): “The Economics and Econometrics of
  Active Labor Market Programs,” in Handbook of Labor Economics, ed. by O. Ashenfelter, and D. Card,
  vol. 3A, chap. 31, pp. 1865–2097. North-Holland, New York.

Heckman, J. J., L. Lochner, and C. Taber (1998): “General-Equilibrium Treatment Effects: A
  Study of Tuition Policy,” American Economic Review, 88(2), 381–86.

Heckman, J. J., and S. Navarro (2004): “Using Matching, Instrumental Variables, and Control
  Functions to Estimate Economic Choice Models,” Review of Economics and Statistics, 86(1), 30–57.

Heckman, J. J., and R. Robb (1985): “Alternative Methods for Evaluating the Impact of Interventions,”
  in Longitudinal Analysis of Labor Market Data, ed. by J. Heckman, and B. Singer, vol. 10, pp. 156–245.
  Cambridge University Press, New York.

        (1986): “Alternative Methods for Solving the Problem of Selection Bias in Evaluating the Impact
  of Treatments on Outcomes,” in Drawing Inferences from Self-Selected Samples, ed. by H. Wainer.
  Springer-Verlag, New York.

Heckman, J. J., J. Smith, and C. Taber (1998): “Accounting for Dropouts in Evaluations of Social
  Programs,” Review of Economics and Statistics, 80(1), 1–14.

Heckman, J. J., S. Urzua, and E. Vytlacil (2004): “Understanding Instrumental Variables in
  Models with Essential Heterogeneity,” Review of Economics and Statistics Lecture, 2002. Revised.

Heckman, J. J., and E. Vytlacil (1999): “Local Instrumental Variables and Latent Variable Models
  for Identifying and Bounding Treatment Effects,” Proceedings of the National Academy of Sciences, 96,
  4730–4734.

        (2001a): “Instrumental Variables, Selection Models, and Tight Bounds on the Average Treatment
  Effect,” in Econometric Evaluation of Labour Market Policies, ed. by M. Lechner, and F. Pfeiffer, pp.
  1–15. Center for European Economic Research, New York.

         (2001b): “Local Instrumental Variables,” in Nonlinear Statistical Modeling: Proceedings of the
  Thirteenth International Symposium in Economic Theory and Econometrics: Essays in Honor of Takeshi


                                                  69
  Amemiya, ed. by C. Hsiao, K. Morimue, and J. L. Powell, pp. 1–46, New York. Cambridge University
  Press.

           (2005): “Econometric Evaluation of Social Programs,” in Handbook of Econometrics, Volume 6,
  ed. by J. Heckman, and E. Leamer, p. forthcoming. Elsevier, Amsterdam.

Hendry, D. (1995): Dynamic Econometrics. Oxford University Press, New York.

Hurwicz, L. (1962): “On the Structural Form of Interdependent Systems,” in Logic, Methodology and
  Philosophy of Science, ed. by E. Nagel, S. P., and A. Tarski. Stanford University Press.

Ichimura, H., and C. Taber (2002): “Semiparametric Reduced-Form Estimation of Tuition Subsidies,”
  American Economic Review, 92(2), 286–92.

Ichimura, H., and T. S. Thompson (1998): “Maximum Likelihood Estimation of a Binary Choice
  Model with Random Coefficients of Unknown Distribution,” Journal of Econometrics, 86(2), 269–95.

Imbens, G. W., and J. D. Angrist (1994): “Identification and Estimation of Local Average Treatment
  Effects,” Econometrica, 62(2), 467–75.

Imbens, G. W., and D. B. Rubin (1997): “Estimating Outcome Distributions for Compliers in Instru-
  mental Variables Models,” Review of Economic Studies, 64(4), 555–74.

Manski, C. F. (1990): “Nonparametric Bounds on Treatment Effects,” American Economic Review,
  80(2), 319–23.

Marschak, J. (1953): “Economic Measurements for Policy and Prediction,” in Studies in Econometric
  Method, ed. by W. Hood, and T. Koopmans, pp. 1–26. Wiley, New York.

Matzkin, R. (1994): “Restrictions of Economic Theory in Nonparametric Methods,” in Handbook of
  Econometrics, ed. by R. Engle, and D. McFadden, vol. 4, pp. 2523–58. North-Holland, New York.

Pearl, J. (2000): Causality. Cambridge University Press, Cambridge, England.

Powell, J. L. (1994): “Estimation of Semiparametric Models,” in Handbook of Econometrics, Volume
  4, ed. by R. Engle, and D. McFadden, pp. 2443–2521. Elsevier, Amsterdam.

                                                   70
Roy, A. (1951): “Some Thoughts on the Distribution of Earnings,” Oxford Economic Papers, 3(2), 135–
  146.

Rudin, W. (1974): Real and Complex Analysis. McGraw-Hill, New York, second edn.

Smith, V. K., and H. S. Banzhaf (2004): “A Diagrammatic Exposition of Weak Complementarity and
  the Willig Condition,” American Journal of Agricultural Economics, 86(2), 455–66.

Vytlacil, E. (2002): “Independence, Monotonicity, and Latent Index Models: An Equivalence Result,”
  Econometrica, 70(1), 331–41.

         (2004): “Additive Separability and Latent Index Models of Binary Choice: Representative Re-
  sults,” Unpublished Paper, Stanford Univerity, Department of Economics.

Yitzhaki, S. (1996): “On Using Linear Regressions in Welfare Economics,” Journal of Business and
  Economic Statistics, 14(4), 478–86.

         (1999): “The Gini Instrumental Variable or ‘The Double IV Estimator’,” Unpublished manuscript,
  Hebrew University, Department of Economics.

Zheng, J. X. (1996): “A Consistent Test of Functional Form via Nonparametric Estimation Techniques,”
  Journal of Econometrics, 75, 263–289.




                                                  71
                       Table IA

Treatment Effects and Estimands as Weighted Averages

           of the Marginal Treatment Effect
          Z 1
ATE(x) =       ∆MTE (x, uD )duD
         Z 10
TT(x) =       ∆MTE (x, uD )hTT (x, uD )duD
          0                   "Z                     #
                                  uD
                        1               MTE
LATE(x, uD , u0D ) =                 ∆      (x, u) du
                     uD − u0D u0D
           Z 1
TUT (x) =      ∆MTE (x, uD ) hTUT (x, uD ) duD
             0
            Z 1
PRTE(x) =       ∆MTE (x, uD ) hPRTE (x, uD )duD
        Z 1 0
IV(x) =     ∆MTE (x, uD )hIV (x, uD )duD
         0Z
             1
OLS(x) =       ∆MTE (x, uD )hOLS (x, uD )duD
            0
                                                                           Table IB
                                                                            Weights
hAT E (x, uD ) = 1
                  Z      1                         
                                                              1
hT T (x, uD ) =                   f (p | X = x)dp
                       uD                               E(P | X = x)
                      Z          uD                    
                                                                     1
hT U T (x, uD ) =                      f (p|X = x) dp
                              0                             E ((1 − P ) |X = x)
                                                              
                              FP ∗ ,X (uD | x) − FP,X (uD | x)
hP RT E (x, uD ) =                                               where ∆P̄ (x) = E(P | X = x) − E(P ∗ | X = x)
                                           ∆P (x)
                  Z      1                                                 
                                                                                       1
hIV (x, uD ) =                (p − E(P | X = x))f (p | X = x)dp                                 for P (Z) as an instrument
                      uD                                                        V ar(P | X = x)

                      E(U1 | X = x, UD = uD )h1 (x, uD ) − E(U0 | X = x, UD = uD )h0 (x, uD )
hOLS (x, uD ) = 1 +                                                                           , if ∆M T E (x, uD ) 6= 0,
                                                  ∆M T E (x, uD )
                = 0 otherwise
                Z    1                                              
                                                              1
h1 (x, uD ) =             f (p | X = x)dp
                  uD                                    E(P | X = x)
                Z    uD                          
                                                              1
h0 (x, uD ) =                 f (p | X = x)dp
                  0                                   E((1 − P ) | X = x)
                               Table II
                  Treatment Parameters and Estimands
                    in the Generalized Roy Example
Treatment on the Treated                                                      0.2353
Treatment on the Untreated                                                    0.1574
Average Treatment Effect                                                      0.2000
Sorting Gaina                                                                 0.0353
Policy Relevant Treatment Effect (P RT E)                                     0.1549
Selection Biasb                                                              -0.0628
Linear Instrumental Variablesc                                                0.2013
Ordinary Least Squares                                                        0.1725

aT T   − AT E = E(Y1 − Y0 | D = 1) − E(Y1 − Y0 )
b OLS   − T T = E(Y0 | D = 1) − E(Y0 | D = 0)
c Using   Propensity Score P (Z) as the instrument.
Note: The model used to create Table II is the same as those used to create Figures 1A
and 1B. The P RT E is computed using a policy t characterized as follows:
If Z > 0 then D = 1 if Z(1 + t) − V > 0.
If Z ≤ t then D = 1 if Z − V > 0.
For this example t is set equal to 0.2.
                                   Table III
Linear Instrumental Variable Estimands and the Policy Relevant Treatment Effect
Using Propensity Score P (Z) as the Instrument                          0.2013

Using Propensity Score P (Z (1 + t (1 [Z > 0]))) as the Instrument                       0.1859

Using a dummy B as an Instrumenta                                                        0.1549

Policy Relevant Treatment Effect (P RT E)                                                0.1549
a The   dummy B is such that B = 1 if an individual belongs to a randomly assigned eligible
population, 0 otherwise.
                                              Table IV
                 The IV Estimator and Cov(Z1 , β 0 Z) Associated with each Value of Σ2
                                         (Group 2 Covariance)
                 Weights         Σ2         IV            Cov(Z1 , β 0 Z) = β 0 Σ12
                              0.6 −0.3
                   h1                        0.133                 −0.30
                           −0.3     0.6 
                              0.6 −0.1
                   h2                        0.177                 −0.02
                            −0.1
                                    0.6 
                               0.6 0.1
                   h3                        0.194                   0.26
                               0.1 0.6

Weights for Mixture of Normals IV :
                »                       »                    ”2 –                      »                    ”2 ––
                      P1 β 0 Σ1                   v−β 0 µ1            P β 0 Σ1                 v−β 0 µ2
                                             “                                             “
                              1
                                    exp − 21                      + 02       2
                                                                                  exp − 12                        fV (v)
                    (β 0 Σ1 β)1/2              (β 0 Σ1 β)1/2        (β Σ2 β)1/2              (β 0 Σ2 β)1/2
hIV (v) =                              " „                      «2 #                          "     „                    «2 # ,
                P1 β 0 Σ1
                        1                           −β 0 µ1                  P2 β 0 Σ1                      −β 0 µ2
                                    exp −                            +               2
                                                                                          exp    −
            (β 0 Σ1 β+σV2 )1/2               (β 0 Σ1 β+σV2 )1/2        (β 0 Σ2 β+σV2 )1/2             (β 0 Σ2 β+σV2 )1/2
where Σ11 and Σ12 are the first rows of Σ1 and Σ2 , respectively. Clearly, hIV (−∞) = 0, hIV (∞) = 0.
The weights clearly integrate to one over the support of V = (−∞, ∞). Observe that if P2 = 0, the weights must
be positive. Thus the structure of the covariances of the instruments is a key determinant of the positivity
of the weights for any instrument. It has nothing to do with the ceteris paribus effect of Z1 on P (Z) in the
general case (changing Z1 holding all other components of Z fixed). Now observe that a necessary condition
for hIV < 0 is that sign β 0 Σ11 = − sign β 0 Σ12 , i.e., that the covariance between Z1 and β 0 Z be of opposite
                         `      ´         `      ´

signs in the two populations. Without loss of generality assume that β 0 Σ11 > 0. If it equals zero, we fail the
rank condition. fV (v) is the density of V .
                                                        Table V
                               Comparison of Alternative Approaches to Program Evaluation
                          Structural Econometric           Treatment Effect                   Approach Based
                                 Approach                      Approach                          on M T E
Interpretability      Well defined economic            Link to economics         Interpretable in terms of
                      parameters and                   and welfare comparisons   willingness to pay;
                      welfare comparisons              obscure                   weighted averages of the
                                                                                 M T E answer well-posed
                                                                                 economic questions

Range of Questions    Answers many                        Focuses on one treatment    With support conditions,
Addressed             counterfactual questions            effect or narrow range      generates all
                                                          of effects                  treatment parameters

Extrapolation to      Provides ingredients for            Evaluates one program in    Can be partially extrapolated;
New Environments      extrapolation                       one environment             extrapolates to new policy environments
                                                                                      with different distributions of the
                                                                                      probability of participation due solely
                                                                                      to differences in distributions of Z;

Comparability         Policy invariant parameters         Not generally               Partially comparable;
Across Studies        comparable across studies           comparable                  comparable across environments
                                                                                      with different distributions of the
                                                                                      probability of participation due solely
                                                                                      to differences in distributions of Z.

Key Econometric       Exogeneity, policy invariance       Selection bias              Selection bias: exogeneity and policy
Problems              and selection bias                                              invariance if used for forecasting

Range of Policies     Programs with either partial        Programs with partial       Programs with partial coverage
that Can Be           or universal coverage,              coverage
Evaluated             depending on variation              (treatment and              (treatment and
                      in data (prices/endowments)         control groups)             control groups)

Extension to          Need to link to time series data;   Difficult because link to   Can be linked to nonparametric
General Equilibrium   parameters compatible with          economics is not            general equilibrium models under
Evaluation            general equilibrium theory          precisely specified         exogeneity and policy invariance
                                                         Figure 1A
          Weights for the Marginal Treatment Eﬀect for Diﬀerent Parameters



            h(u D )                                                                                                          MTE
               3.5                                                                                                               0.35



                3

                                    MTE

               2.5


                             TT
                2                                                                                        TUT




               1.5




                1
                                                ATE



               0.5




                    0                                                                                                            0
                        0    0.1          0.2   0.3      0.4       0.5          0.6    0.7         0.8         0.9           1
                                                                     uD




                                                         Figure 1B
Marginal Treatment Eﬀect vs Linear Instrumental Variables and Ordinary Least Squares
                                      Weights


                                                                                                                     MTE
          h TT(u D )                                                                                                 h    (u )
                                                                                                                      OLS   D
                 5                                                                                                           0.5


                    4



                 3
                                   MTE



                    2



                 1                                                                           IV



                                                                         OLS
                     0



                 -1



                -2



                 -3                                                                                                          -0.3
                         0   0.1          0.2   0.3     0.4        0.5         0.6    0.7         0.8      0.9           1

                                                                   uD




Y1 = γ + α + U1                      U1 = σ1 ε                            γ = 0.67                       σ 1 = 0.012
Y0 = γ + U0                          U0 = σ0 ε                            α = 0.2                        σ 0 = −0.050
D = 1 if Z − V > 0                   V = σV ε³                 ´          ε ∼ N (0, 1)                   σ V = −1.000
                                                       V
                                     UD = Φ           σV σε                                              Z ∼ N (−0.0026, 0.2700)
                                                                 Figure 2A
                                                  Plot of the E(Y |P (Z) = p)


                            25
                                                  E[Y|P(Z)=p]
                                                                When C2 Holds (Agents Act on Heterogeneity)
                                                  E[Y|P(Z)=p]
                                                                When C1 Holds (Agents Do Not Act on Heterogeneity)




                            20




                            15
              E[Y|P(Z)=p]




                            10




                             5




                             0
                                 0    0.1   0.2      0.3         0.4         0.5         0.6          0.7            0.8      0.9        1
                                                                              p




                                                                 Figure 2B
      Plot of the IdentiÞed Marginal Treatment Eﬀect from Figure 2A (the Derivative).


                            0.4
                                                                                               MTE
                                                                                                   Agents Act on Heterogeneity
                                                                                               MTE
                                                                                                    Agents Do Not Act on Heterogeneity
                      0.35



                            0.3



                      0.25
             MTE




                            0.2



                      0.15



                            0.1



                      0.05



                             0
                                  0   0.1   0.2       0.3         0.4         0.5          0.6         0.7           0.8         0.9     1
                                                                              u
                                                                                D




   Note: Parameters for the general heterogeneous case are the same as those used in Figures
1A and 1B. For the homogeneous case we impose U1 = U0 (σ 1 = σ0 = 0.012).
                                                                      Figure 3A
Marginal Treatment Eﬀect vs Linear Instrumental Variables, Ordinary Least Squares, and
       Policy Relevant Treatment Eﬀect Weights: When P (Z) is the Instrument
                                                      The Policy is Given at the Base of Table II

                                 0.06
                                                                                                         MTE
                                                                                                         h
                                                                                                           IV(Z)
                                 0.05                                                                    h
                                                                                                           OLS
                                                                                                         h
                                                                                                            PRTE
                                 0.04


                                 0.03


                                 0.02
              Weights and MTE




                                 0.01


                                    0


                                -0.01


                                -0.02


                                -0.03


                                -0.04
                                        0       0.1       0.2   0.3   0.4    0.5    0.6   0.7   0.8   0.9            1
                                                                              u
                                                                               D




                                                                      Figure 3B
    Marginal Treatment Eﬀect vs Linear IV with Z as an Instrument, Linear IV with
P (Z (1 + t (1 [Z > 0]))) = P̃ (Z, t) as an Instrument, and Policy Relevant Treatment Eﬀect
                                             Weights
                                                For The Policy DeÞned at the Base of Table II


                                  0.04
                                                                                                      MTE
                                                                                                      h
                                                                                                        IV(Z)
                                0.035                                                                 h ~
                                                                                                        IV(P(Z,t))
                                                                                                      h
                                                                                                       PRTE
                                  0.03


                                0.025


                                  0.02
           Weights and MTE




                                0.015


                                  0.01


                                0.005


                                        0


                             -0.005


                                -0.01
                                            0   0.1       0.2   0.3    0.4   0.5    0.6   0.7   0.8   0.9            1
                                                                              u
                                                                                D
                                                         Figure 3C
Marginal Treatment Eﬀect vs IV Policy and Policy Relevant Treatment Eﬀect Weights
                                       For The Policy DeÞned at the Base of Table II


                            0.04
                                                                                           MTE
                                                                                           h
                                                                                             IV(B)
                           0.035                                                           h
                                                                                               PRTE


                            0.03


                           0.025


                            0.02
        Weights and MTE




                           0.015


                            0.01


                           0.005


                               0


                          -0.005


                           -0.01
                                   0   0.1   0.2   0.3    0.4   0.5    0.6   0.7   0.8   0.9          1
                                                                 u
                                                                   D
                                                                  Figure 4
IV Weights when Z ∼ p1 N (µ1 , Σ1 ) + p2 N (µ2 , Σ2 ) for Diﬀerent Values of Σ2


                     0 .0 7
                                                                                                                  h
                                                                                                                    1
                                                                                                                  h
                                                                                                                    2
                     0 .0 6                                                                                       h
                                                                                                                   3



                     0 .0 5



                     0 .0 4
   I V W e ig h t




                     0 .0 3



                     0 .0 2



                     0 .0 1



                         0


            -
                    0 .0 1



                    -0 . 0 2
                          4           3          2            1              0             1         2        3         4
                                                                             v



 Y1 = γ + α + U 1                               U1 = σ 1 -                                      - ∼ N (0, 1)
   Y0 = γ + U 0                                 U0 = σ 0 -                           σ 1 = 0.012, σ 0 = −0.05, σ V = −1
  I = β0Z − V                                   V = σV -
                                                ½                                            γ = 0.67, α = 0.2
                                                   1 if I > 0
                                             D=
                                                   0 if I ≤ 0


                                              Z ∼ p1 N (µ1 , Σ1 ) + p2 N (µ2 , Σ2 )
                                                                                                ∙             ¸
                                      £              ¤            £              ¤                  1.4 0.5
                               µ1 =       0 −1           , µ2 =       0 1                Σ1 =
                                                                                                    0.5 1.4
                                                                                                £             ¤
                                          p1 = 0.45, p2 = 0.55                            β=        0.2 1.4

                                           Cov(Z 1 , β 0 Z) = β 0 Σ11 = 0.98 (Group 1)



                                                                      ∙                     ¸
                                                                          Cov(U1 −U 0 , V )
                                  ∆MT E (v) = α+                                              v
                                                                             V ar(V )
                                                           E(Z 1 |β 0 Z > v) Pr (β 0 Z > v)
                                          hIV (v) =                   Cov(Z 1 , D)
                                                           Z ∞         Cov(Z 1 , D)
                                              β IV       = Z ∞ ∆MT E (v)hIV (v)dv
                                              αIV        = −∞ ∆MT E (v)hIV (v)dv
                                                                      −∞
