                                NBER WORKING PAPER SERIES




 SECOND-ORDER APPROXIMATION OF DYNAMIC MODELS WITH TIME-VARYING
                              RISK

                                          Gianluca Benigno
                                          Pierpaolo Benigno
                                           Salvatore Nisticò

                                        Working Paper 16633
                                http://www.nber.org/papers/w16633


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2010




Financial support from and ERC Starting Independent Grant is gratefully acknowledged. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National Bureau
of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2010 by Gianluca Benigno, Pierpaolo Benigno, and Salvatore Nisticò. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Second-Order Approximation of Dynamic Models with Time-Varying Risk
Gianluca Benigno, Pierpaolo Benigno, and Salvatore Nisticò
NBER Working Paper No. 16633
December 2010
JEL No. C63

                                                ABSTRACT

This paper provides first and second-order approximation methods for the solution of non-linear dynamic
stochastic models in which the exogenous state variables follow conditionally-linear stochastic processes
displaying time-varying risk. The first-order approximation is consistent with a conditionally-linear
model in which risk is still time-varying but has no distinct role -- separated from the primitive stochastic
disturbances -- in influencing the endogenous variables. The second-order approximation of the solution,
instead, is sufficient to get this role. Moreover, risk premia, evaluated using only a first-order approximation
of the solution, will be also time varying.


Gianluca Benigno                                        Salvatore Nisticò
London School of Economics                              Universita' di Roma Tor Vergata
Department of Economics                                 Dipartimento di Diritto e Procedura Civile
Houghton Street                                         and LUISS Guido Carli
London WC2A 2AE ENGLAND                                 Dipartimento di Scienze
g.benigno@lse.ac.uk                                     Economiche e Aziendali
                                                        Viale Romania 32
Pierpaolo Benigno                                       00197 Rome - Italy
Dipartimento di Scienze                                 snistico@luiss.it
 Economiche e Aziendali
Luiss Guido Carli
Viale Romania 32
00197 RomeITALY
and NBER
pbenigno@luiss.it
1         Introduction
In the last decade, there has been an increasing interest among researchers and policymak-
ers in developing dynamic general equilibrium models to study business cycle properties of
macroeconomic variables and to conduct policy analysis. This research agenda has been
accompanied by parallel developments in solution methods and estimation techniques
aimed at handling different challenges that richer models pose to economists. For exam-
ple, second-order approximation techniques have been proposed by Schmitt-Grohé and
Uribe (2004) and Benigno and Woodford (2008) to address welfare comparisons across
policy regimes while Bayesian analysis has been developed for estimating dynamic general
equilibrium models (An and Schorfeide, 2007).
        In this work, we propose a solution method for non-linear dynamic stochastic models
in which the exogenous stochastic processes display time-varying risk. While the use of
models with time-varying risk is quite popular in finance, only recently there has been
considerable attention on the role and the effects that risk or uncertainty and their vari-
ations over time have on macroeconomic variables.1 Our solution method is based on
appropriately-defined first and second-order approximations of the solution which can be
effective in studying how time-variation in the exogenous risk influences the equilibrium al-
location in standard macroeconomic models. This is in contrast with other solution meth-
ods, recently proposed, relying on third-order approximations as in Fernandez-Villaverde
et al. (2009).2
        We consider a class of non-linear dynamic stochastic models in which the exogenous
state variables follow conditionally-linear stochastic processes where either variances or
standard deviations of the primitive shocks are modelled through stochastic linear pro-
cesses. We show that a first-order approximation of the solution can be consistent with
a conditionally-linear model in which the process for the exogenous state variables is not
approximated and still displays time-varying volatility. Indeed, whether the exogenous
state process is approximated or not does not affect the other coefficients of the linear
    1
     Bloom (2009) examines the effects of an increase in uncertainty on investment and hiring decisions
by firms, Bloom, Floetotto and Jaimovich (2009) extend a canonical real business cycle model to study
the impact of change in the variance to productivity innovation on economic activity while Fernandez-
Villaverde, Guerron-Quintana, Rubio-Ramirez and Uribe (2009) show how changes in the volatility of the
foreign real interest rate are an important mechanism in explaining the behavior of output, consumption
and investment in emerging market economies.
   2
     Bloom et al. (2009), following Krussell and Smith (1998), use instead a value function iteration ap-
proach which is more computationally demanding and difficult to implement even in small scale dynamic
general equilibrium models.



                                                   1
approximation nor the dimension of the relevant endogenous state variables.3
       There are three clear advantages of following a conditionally-linear approximation in-
stead of a fully-linear approximation. First, the approximated linear solution would still
display a role for time-varying risk in affecting the evolution of the endogenous variables
of the model.4 However, this is not a “distinct and direct” role, as risk and primitive
shocks are not disjoint arguments: if shocks are zero, risk does not influence directly the
endogenous variables. Second, the fact that stochastic volatility enters the first-order ap-
proximation, although not disjointly, has important implications also for higher-order ap-
proximations. In particular, we show that a second-order approximation of the policy rules
is sufficient to imply a “distinct and direct” role for time-varying volatility in affecting the
endogenous variables, whereas with other approaches a more computationally-demanding
third-order approximation is needed. Third, a conditionally-linear approximation, where
volatility is still time-varying, can be sufficient to characterize time variation in covari-
ances and therefore in risk premia, whereas a standard linear approximation would only
deliver constant risk premia.
       Our paper is related to Justiniano and Primiceri (2008) since their partially-nonlinear
approximation, as a first-order approximation of the solution, agrees with our proposed
conditionally-linear approximation when the exogenous state variables follow conditionally-
linear processes. We also provide a second-order approximation of the solution to charac-
terize a distinct role for exogenous risk in affecting the endogenous variables. In particular
we consider two models of time-varying volatility, one with a stochastic linear process for
the standard deviation of the primitive shocks, as in Justiniano and Primiceri (2008), and
another with a linear process for the variance.5 The latter model is indeed also more
parsimonious in the second-order approximation.
       Our contribution can also be read as a generalization of the second-order approxima-
tion methods of Schmitt-Grohé and Uribe (2004), Kim et al. (2008) and Gomme and
Klein (2008) to the case in which the exogenous state variables follow heteroskedastic
processes. Recent works by Fernandez-Villaverde et al. (2009, 2010) have provided ap-
proximation methods for exactly the same model as ours in which the standard-deviation
   3
      We follow here the insights of Justiniano and Primiceri (2008) which indeed define a partially-
nonlinear approximation.
    4
      This role has been particular relevant for Justiniano and Primiceri (2008) to deliver a model that
can be estimated parsimoniously in order to investigate which sources of risk have contributed the most
to the fall in macroeconomic volatility associated with the US Great Moderation.
    5
      Justiniano and Primiceri (2008), however, model the log of the standard deviation as a stochastic
linear process.



                                                   2
of the primitive shocks is time-varying. However, they consider a fully-linear approx-
imation in which even the process for the exogenous state variable is linearized.6 By
doing this, time-varying volatility is lost in the first-order approximation and, to get a
distinct role for risk in affecting the endogenous variables, a third-order approximation
is needed. Amisano and Tristani (2009) analyze models where volatility is subject to
discrete switching-regime changes and show that the time-varying volatility can affect the
second-order approximation. Finally, there are other contributions which have been inter-
ested in characterizing how time-varying risk affects endogenous variables. But in these
cases, as in Rudebush and Swanson (2008), exogenous state variables follow homoskedas-
tic processes as in Schmitt-Grohé and Uribe (2004) and time-varying endogenous (not
exogenous) risk affects the endogenous variables only in a third-order approximation.
        The structure of this work is the following. Section 2 presents first and second-order
approximations in a model in which the exogenous state variables have time-varying
linear process for the conditional standard deviation. Section 3 considers the case in
which time-varying risk is modelled using a linear process for the conditional variance of
the primitive shocks. Section 4 applies our methods to the benchmark neoclassical growth
model. Section 5 concludes.


2         A model with time-varying standard deviations
We consider the following general model which encompasses a wide variety of dynamic
stochastic models:
                                   Et {f (yt+1 , xt+1 , yt , xt )} = 0,                              (1)

where Et {·} denotes the mathematical expectations operator conditional on the informa-
tion available at date t and f (·) is a vector, of size n, of functions. The vector yt , of
non-predetermined variables, is of size ny × 1 while the vector xt of state variables is of
size nx × 1, with ny + nx = n. In particular, the vector xt can be partitioned into a vector
of endogenous state variables kt and a vector of exogenous predetermined variables zt of
size nz × 1, as follows:                            "        #
                                                        kt
                                             xt =                .
                                                        zt
    6
    This is because they do not necessarily assume a conditionally-linear process for the exogenous state
variables.




                                                    3
The vector zt follows the exogenous stochastic process given by

                                          zt+1 = Λz zt + Zξt+1                                           (2)

where Z and Λz are matrices of order nz × nz . The vector ξt+1 is also of dimension nz × 1
and is given by
                                             ξt+1 = Ut εz,t+1                                            (3)

where εz,t+1 is a nz × 1 vector of innovations, which are assumed to have a bounded
support and to be independently and identically distributed with mean zero and vari-
ance/covariance matrix Iz , where Iz is an identity matrix of dimension nz × nz ; Ut is a
diagonal matrix of dimension nz × nz whose elements on the diagonal are collected into
vector ut , of dimension nz × 1. In particular ut follows the exogenous stochastic linear
process given by
                              ut+1 = σz (Iz − Λu )ū + Λu ut + σv V εv,t+1                               (4)

where V and Λu are matrices of order nz × nz , εv,t+1 is a nz × 1 vector of innovations
which are assumed to have a bounded support and to be independently and identically
distributed with mean zero and variance/covariance matrix Iz ; ū is a vector of dimension
nz × 1 while σz and σv are scalars with σz ,σv ≥ 0.7 We also assume that the initial
condition on the process for ut is such that ut0 −1 = σz ū.8
       Given equations (3) and (4), the model generalizes the framework of Schmitt-Grohé
and Uribe (2004) to a case in which the volatility is time varying and stochastic. In
particular, the process for the exogenous state variable (2) is conditionally linear where
each element of the vector ut captures the conditional standard deviation of each element
of the stochastic disturbance ξt+1 ; such standard deviations are allowed to vary over
time in a stochastic way following the autoregressive process described by equation (4).
The model boils down to the framework of Schmitt-Grohé and Uribe (2004) under the
assumptions σv = 0 and ūi = 1 for all i = 1, ..., nz , since in this case

                                             ξt+1 = σz εz,t+1 .
   7
      Fernandez-Villaverde et al. (2009, 2010) and Justiniano and Primiceri (2008) model a linear process
for the log of the standard deviations to assure that variances remain always positive. This is not necessary
in our case since we are assuming a bounded support for the shock εv,t which is needed anyway, for the
goodness of the approximation.
    8
      Notice that in (3), there is no need to add another scalar of the type σξ as a perturbation parameter
since the variables on the diagonal matrix Ut are already subject themselves to perturbation. Indeed,
this is why we add the perturbation parameters σz and σv in (4) and assume an initial condition for ut
of the form ut0 −1 = σz ū.



                                                     4
We make three important remarks on the above structure which are important to define
the class of models which we are interested in. First, equation (4) is not part of the
equilibrium conditions (1). Second, the vector ut is not a distinct argument of the set
of equilibrium conditions with respect to what is already captured by the state vector
xt . Third, the vector of exogenous state variables zt follows a conditionally-linear process
given by (2). We are not interested in characterizing approximations of more general
models in which the exogenous state variables follow instead non-linear models.


2.1    Solution
Given the above defined model and structure of the stochastic processes, a solution of (1)
takes the form
                                     yt = g(xt , ut , σz , σv )                          (5)

                              xt+1 = h(xt , ut , σz , σv ) + h̄ξ ξt+1                    (6)

for generic functions g(·) and h(·) where h̄ξ is a known nx × nz matrix of the form
                                             "     #
                                                0
                                       h̄ξ ≡         .
                                                Z

   We are interested in a second-order approximation of (5) and (6) around a deterministic
steady state in which σz = σv = 0 and ut = σz ū = 0. In this deterministic steady state
xt = x̄ and yt = ȳ satisfy

                                      ȳ = g(x̄, 0, 0, 0)
                                      x̄ = h(x̄, 0, 0, 0)

or, equivalently
                                       f (ȳ, x̄, ȳ, x̄) = 0.


2.2    First-order approximation
First, we characterize a first-order approximation of (5) and (6). We guess and verify that
this approximation takes the form
                                            ỹt = ḡx x̃t                                (7)

                                    x̃t+1 = h̄x x̃t + h̄ξ ξt+1                           (8)



                                                 5
where ỹt ≡ yt − ȳ, x̃t ≡ xt − x̄ and ḡx and h̄x are the Jacobian matrices of the functions g(·)
and h(·) with respect to x, of size ny × nx and nx × nx , respectively, and evaluated at the
steady state. To verify this guess, we take a first-order approximation of (1), obtaining

                    Df¯ŷ · Et ỹt+1 + Df¯x̂ · Et x̃t+1 + Df¯y · ỹt + Df¯x · x̃t = 0         (9)

where Df¯ŷ , Df¯x̂ , Df¯y , and Df¯x are matrices containing the respective gradients of the
vector of functions f (·) taken with respect to the arguments of the function and evaluated
at the above-defined steady state. In particular hats denote the gradient with respect to
time t + 1 vectors, ŷ stands for yt+1 and x̂ for xt+1 .
   To verify our guess, we plug (7) and (8) into (9) noting that Et ξt+1 = 0. It follows
that the matrices ḡx and h̄x have to satisfy the following set of n × nx conditions.

                            Df¯ŷ ḡx h̄x + Df¯y ḡx + Df¯x̂ h̄x + Df¯x = 0.                 (10)

The above set of conditions can be solved using standard algorithms. Indeed, it corre-
sponds to that of Schmitt-Grohé and Uribe (2004) in the case in which the volatility is
non stochastic: the matrices ḡx and h̄x are the same as in their framework. However,
the overall solution given by (7) and (8) does not correspond to their solution since the
driving stochastic disturbance is still a non-linear process, which is described by (3). In
particular, (7), (8) together with (3) and (4) represent the best conditionally-linear so-
lution of (9) given that the exogenous state variables follow (2)-(4) and given that the
vector ut does not enter the set of equations (1) nor their arguments. Notice first that
(9) just imposes restrictions on the linear approximations of the functions g(·) and h(·)
of (5) and (6). Since Et ξt+1 = 0, the approximations (7) and (8) are conditionally linear.
Moreover since h̄ξ is known, the best approximation of the term h̄ξ ξt+1 , in equation (6),
is just the term itself which is what appears in (8).
   Fernandez-Villaverde et al. (2009, 2010) assume that

                                        ξt+1 = Ωt+1 σz εz,t+1                                (11)

where Ωt+1 is a diagonal matrix whose diagonal contains the vector of standard deviations
ωt+1 ; the log of the standard deviations follow

                           log ωt+1 = log ω̄ + Λω log ωt + σω Vω εω,t+1                      (12)

given appropriately defined matrices Λω and Vω , given the vector log ω̄ and stochastic
disturbances εω,t+1 where σω and σz are scalars with σω , σz ≥ 0. If εω,t+1 and εz,t+1 are

                                                   6
statistically independent, the process for the exogenous state variables is also conditionally
linear.9 In this framework, Fernandez-Villaverde et al. (2009, 2010) look for a fully
linear approximation in which (11) is also linearized. However, an appropriate linear
approximation of (11) – also with respect to the scalar σz – would be zero and therefore the
overall first-order approximation of the solution would no longer be stochastic. However,
an alternative linear approximation would be to approximate ξt+1 as a linear function of
σz εz,t+1 in a way that also (8) becomes linear in the stochastic disturbances σz εz,t+1 . In
their case a linear approximation of the exogenous state variables takes the form

                                     x̃t+1 = h̄x x̃t + h̄ξ Ω̄σz εz,t+1 ,                             (13)

in which Ω̄ is the diagonal matrix containing the vector ω̄ on its diagonal. Applying this
approximation to our context requires to set σv = 0 in (4) to obtain a linear approximation
of the exogenous state variables of the form

                                     x̃t+1 = h̄x x̃t + h̄ξ Ū σz εz,t+1 ,                            (14)

in which Ū is the diagonal matrix containing the vector ū on its diagonal. Solution (14)
is now in the form of a linear multivariate autoregressive process, but it is not the best
conditionally-linear approximation of (6). In our approximation (7) and (8) together with
(3) and the linear process (4) are all that is needed to characterize the conditionally-linear
approximation. In Fernandez-Villaverde et al. (2009, 2010), it suffices instead to consider
(7), (8) and (14) where time-varying volatility ceases to play a role. However, there is no
restriction in our and their approximation methods that should require to linearize also
ξt+1 . This is not even a requirement for analytical tractability since conditionally linear
heteroskedastic models are commonly used and most recently in macro models.10
       Indeed, we will show that there are actually several advantages of our conditionally-
linear approximation. A first one is that in our case, first-order approximations will
retain a role for stochastic volatility, as in Justiniano and Primiceri (2008), although not
a distinct role, since risk enters only jointly with the structural shock. In Fernandez-
Villaverde et al. (2009, 2010), on the contrary, first-order approximations will lose any
role for time-varying risk. Such difference between our and their linear approximations
will also be importantly reflected in the second-order approximation and especially in
   9
     Fernandez-Villaverde et al. (2009, 2010) do not assume explicitly conditional linearity and, perhaps,
they are looking at the broader class of non-linear processes for the exogenous state variables.
  10
     See Justiniano and Primiceri (2008) for further arguments to justify what they call a “partially
nonlinear” approximation in the same model of Fernandez-Villaverde et al. (2009, 2010). This would be
a conditionally-linear approximation when εω,t+1 and εz,t+1 are statistically independent.


                                                      7
the role that time-varying volatility plays in it. A further advantage of our approach,
indeed, is that time-varying volatility will play a “distinct and direct” role already in a
second-order approximation whereas in Fernandez-Villaverde et al. (2009, 2010) at least
a third-order approximation is needed. With “distinct and direct” role, we mean that
the impulse response functions of the variables of interest with respect to the primitive
volatility shock εv,t+1 can be in general different from zero.11 As a consequence, a very
appealing implication of our method is that risk premia evaluated using first-order ap-
proximations will be time-varying, in contrast to the constant risk premia implied by
the framework of Fernandez-Villaverde et al. (2009, 2010). In their context, indeed,
higher-order approximations will be needed to characterize time-varying risk premia.
       We conclude this section by noting that a complete linear approximation to (5) and
(6) can be represented as

                                      ỹt = ḡx x̃t + ḡu ut + ḡz σz + ḡv σv

                              x̃t+1 = h̄x x̃t + h̄u ut + h̄z σz + h̄v σv + h̄ξ ξt+1 .

However, plugging the above equations into (9) shows that ḡu , ḡz , ḡv , h̄u , h̄z , h̄v are all
zero matrices.


2.3       Second-order approximation
In this section, we characterize a second-order approximation of the solutions (5) and (6).
We guess and verify that it takes the form
                       1                      1                    1          1
        ỹt = ḡx x̃t + (Iy ⊗ x̃0t )ḡxx x̃t + (Iy ⊗ u0t )ḡuu ut + ḡvv σv2 + ḡzz σz2 + ḡzu σz ut    (15)
                       2                      2                    2          2
                  1                      1                   1          1
 x̃t+1 = h̄x x̃t + (Ix ⊗ x̃0t )h̄xx x̃t + (Ix ⊗u0t )h̄uu ut + h̄vv σv2 + h̄zz σz2 + h̄zu σz ut + h̄ξ ξt+1 (16)
                  2                      2                   2          2
where Iy and Ix are identity matrices of order ny × ny and nx × nx , respectively, ⊗ denotes
the Kronecker product and ḡxx , ḡuu , ḡzz , ḡvv , ḡzu , h̄xx , h̄uu , h̄zz , h̄vv , h̄zu are conformable
matrices, corresponding to the Magnus-Neudecker Hessian matrices of functions ḡ and h̄
with respect to the arguments in the indexes.12 Specifically, ḡxx is defined as
                                  ∂ 2 g(x, u, σz , σv )         h                   0 i
                         ḡxx =                         = Dx vec  D x g(x̄, 0, 0, 0)    ,
                                        ∂x∂x0
  11
     Accordingly, since in our first-order approximation there is no distinct role for volatility in affecting
the endogenous variables, the impulse response of any variable with respect to a volatility shock is always
zero.
  12
     See Magnus and Neudecker (1999).


                                                         8
evaluated at the steady state, and consists of ny vertically stacked symmetric nx × nx ma-
trices (ḡxx is therefore of size ny · nx × nx ). All remaining matrices are defined analogously.
   To evaluate this guess, we take a second-order approximation of (1), to get
          
   0 = Et Df¯i · ỹt+1 + Df¯i · x̃t+1 + Df¯i · ỹt + Df¯i · x̃t
                   ŷ             x̂               y            x

                  1 0
                + ỹt+1    · Df¯ŷiŷ · ỹt+1 + x̃0t+1 · Df¯ŷx̂
                                                             i
                                                                 · ỹt+1 + ỹt0 · Df¯ŷy
                                                                                      i
                                                                                          · ỹt+1
                  2
                                             1
                + x̃0t · Df¯ŷx
                             i
                                · ỹt+1 + x̃0t+1 · Df¯x̂x̂i
                                                              · x̃t+1 + ỹt0 · Df¯x̂y
                                                                                   i
                                                                                       · x̃t+1
                                             2                                                      
                                             1                                            1
                + x̃t · Df¯x̂x · x̃t+1 + ỹt · Df¯yy · ỹt + x̃t · Df¯yx · ỹt + x̃t · Df¯xx · x̃t ,
                    0        i                 0        i             0      i                 0  i
                                                                                                         (17)
                                             2                                            2

for each i = 1, ..., n and where f i denotes the i-component of the vector f .
   The second-order approximation of (1) can be cast in a more compact form as
                                                    0            
                     
                     
                            ỹ t+1         In ⊗ ỹ t+1         ỹ t+1
                                                                        
                                                                        
                                                                        
                     
                                                                 
                                                                        
                           x̃t+1  1  In ⊗ x̃t+1           x̃t+1 
              0 = Et Df ¯                                  ¯
                                     + 2  I ⊗ ỹ       H f  ỹ  ,                                  (18)
                                                                  
                     
                     
                             ỹ t        n      t         t     
                                                                       
                               x̃t          In ⊗ x̃t              x̃t
                     
                                                                       
                                                                        

where Df¯ ≡ Df¯ŷ Df¯x̂ Df¯y Df¯x denotes the n × 2n Jacobian matrix of function f ,
                                   

and H f¯ the corresponding 2n2 × 2n Magnus–Neudecker Hessian matrix, evaluated at the
steady state:
                                          H f¯ = Dvec (Df¯)0 .
                                                           

   We use equations (7) and (8) into (18) to evaluate the second-order terms and (15)
and (16) to evaluate the first-order terms, taking into account the restrictions (10).
  Making use of Et ξt+1 = 0, we obtain:
             
   1        ¯
0 = Et Dfŷ (ḡx ⊗ x̃0t ) h̄xx x̃t + (ḡx ⊗ u0t ) h̄uu ut + ḡx h̄zz σz2 + ḡx h̄vv σv2 + 2ḡx h̄zu σz ut
   2
   + Iy ⊗ u0t+1 ḡuu ut+1 + Iy ⊗ (h̄x x̃t + h̄ξ ξt+1 )0 ḡxx (h̄x x̃t + h̄ξ ξt+1 ) + ḡzz σz2 + ḡvv σv2
                                                          
                                                                                                        
                         ¯             0                      0                     2          2
   + 2ḡzu σz ut+1 + Dfx̂ (Ix ⊗ x̃t ) h̄xx xt + (Ix ⊗ ut ) h̄uu ut + h̄zz σz + h̄vv σv + 2h̄zu σz ut
                                                                                         
        ¯           0                     0                  2           2
   + Dfy (Iy ⊗ x̃t ) ḡxx xt + (Iy ⊗ ut ) ḡuu ut + ḡzz σz + ḡvv σv + 2ḡzu σz ut

     + In ⊗ (ḡx h̄x x̃t + ḡx h̄ξ ξt+1 )0 H f¯ŷ · w̃t+1 + In ⊗ (h̄x x̃t + h̄ξ ξt+1 )0 H f¯x̂ · w̃t+1
                                                                                    
                                                               
               0 0       ¯                        0     ¯
     + (In ⊗ x̃t ḡx ) H fy · w̃t+1 + (In ⊗ x̃t ) H fx · w̃t+1 ,                                         (19)


                                                       9
                 0
where w̃t+1 ≡ [ỹt+1        x̃0t+1       ỹt0   x̃0t ]0 is a 2n × 1 vector and H f¯ŷ , H f¯x̂ , H f¯y , and H f¯x are
the Magnus-Neudecker Hessian matrices of the vector of functions f (·) taken with respect
to the arguments of the function and evaluated at the above-defined steady state, such
that                                                           
                                                                H f¯ŷ
                                                                       

                                                               H f¯x̂ 
                                                                      
                                                          ¯
                                                         Hf = 
                                                                      .
                                                                   ¯
                                                               H fy 
                                                                       

                                                                H f¯x
Specifically, H f¯ŷ is defined as

                                                     H f¯ŷ = Dvec (Df¯ŷ )0 ,
                                                                           


and analogously for the other terms. Moreover, equations (7) and (8) imply

                                                    w̃t+1 = M̄x x̃t + M̄ξ ξt+1 ,                                (20)

where Mx and Mξ are matrices of order 2n × nx and 2n × nz , respectively, defined by
                                                                                            
                                          ḡx h̄x                                    ḡx h̄ξ
                                                                                            
                                 h̄x                                            h̄ξ         
                          M̄x ≡ 
                                 ḡ
                                                     
                                                                       M̄ξ ≡ 
                                                                               0
                                                                                               .
                                                                                                               (21)
                                 x                                           (ny ×nz )      
                                  Ix                                            0(nx ×nz )

    From equation (19), and using (20), we can collect the quadratic terms in the vector
x̃t , to obtain
            
     1
                  Df¯ŷ · ḡx ⊗ x̃0t h̄xx x̃t + Df¯ŷ ⊗ x̃0t h̄0x ḡxx h̄x x̃t + Df¯x̂ ⊗ x̃0t h̄xx xt
                                                                                           
  0 = Et
     2
         + Df¯y ⊗ x̃0t ḡxx xt + In ⊗ x̃0t h̄0x ḡx0 H f¯ŷ · M̄x x̃t + In ⊗ x̃0t h̄0x H f¯x̂ · M̄x x̃t
                                                                                    
                                                                                                      
                                  + (In ⊗ x̃t ḡx ) H f¯y · M̄x x̃t + (In ⊗ x̃t ) H f¯x · M̄x x̃t . (22)
                                                    0 0                             0



Following Gomme and Klein (2008), given a generic n · m × m matrix A consisting of
n square matrices Ai stacked vertically, with i = 1, ..., n, we define trm(A) as the n × 1
vector of traces of the n matrices Ai :

                                trm(A) = [tr(A1 ) tr(A2 ) ... tr(An )]0 .




                                                                10
We can use the above operator to show that moment condition (22) implies the following
set of n · nx × nx equations:

  0 = Df¯ŷ · ḡx ⊗ Ix h̄xx + Df¯ŷ ⊗ h̄0x ḡxx h̄x + Df¯x̂ ⊗ Ix h̄xx
                                                              

              + Df¯y ⊗ Ix ḡxx + In ⊗ h̄0x ḡx0 H f¯ŷ · M̄x + In ⊗ h̄0x H f¯x̂ · M̄x
                                                                      

                                                          + (In ⊗ ḡx0 ) H f¯y · M̄x + H f¯x · M̄x , (23)

which can be solved for the unknown matrices ḡxx and h̄xx , given h̄x , ḡx , Df¯ and H f¯.
   We can then collect the remaining terms and obtain
            
     1    ¯
  0 = Et Dfŷ (ḡx ⊗ u0t ) h̄uu ut + ḡx h̄zz σz2 + ḡx h̄vv σv2 + 2ḡx h̄zu σz ut + Iy ⊗ u0t+1 ḡuu ut+1
                                                                                               
     2
                                                                                       
                          0      0                         2         2
                                   
              + Iy ⊗ ξt+1 h̄ξ ḡxx h̄ξ ξt+1 + ḡzz σz + ḡvv σv + 2ḡzu σz ut+1
                                                                                    
                + Df¯x̂ (Ix ⊗ ut ) h̄uu ut + h̄zz σz + h̄vv σv + 2h̄zu σz ut
                                     0                    2         2

                                                                                    
                 + Df¯y (Iy ⊗ ut ) ḡuu ut + ḡzz σz + ḡvv σv + 2ḡzu σz ut
                                      0                   2         2

                                                                                                 
                  + In ⊗ ξt+1 h̄ξ ḡx H f¯ŷ · M̄ξ ξt+1 + In ⊗ ξt+1 h̄ξ H f¯x̂ · M̄ξ ξt+1 . (24)
                                0    0 0                                   0     0
                                                                                  


   Given a generic square matrix A, of order m, we define diagm(A) as the diagonal
matrix whose main diagonal is that of matrix A. Moreover, given a generic n · m × m
matrix B consisting of n square matrices Bi stacked vertically, with i = 1, ..., n, we define
dgm(B) as the n · m × m matrix that stacks vertically the m × m diagonal matrices
diagm(Bi ):
                     dgm(B) = [diagm(B1 ) diagm(B2 ) ... diagm(Bn )]0 .

We can use the above operator to show, for generic and conformable matrices A and B:

                0
                    A0 BAξt+1 = Et trm I ⊗ ξt+10
                                                 A0 BAξt+1 =
                                                       
  Et       I ⊗ ξt+1
                               trm (I ⊗ A0 ) BAEt ξt+1 ξt+1
                                                        0
                                                              = trm [(I ⊗ A0 ) BAUt Ut0 ] ,
                                                          


where “trm” is the matrix trace operator defined earlier, and in the last equality we used
          0
Et (ξt+1 ξt+1 ) = Ut Ut0 , as implied by equation (3). Moreover, since Ut is a diagonal matrix
whose vector on the main diagonal is ut , the following also holds:

                    trm [(I ⊗ A0 ) BAUt Ut0 ] = trm {dgm [(I ⊗ A0 ) BA] · ut u0t } ,


                                                  11
from which we can conclude:
                       0
                         A0 BAξt+1 = trm {dgm [(I ⊗ A0 ) BA] · ut u0t } .
                           
             Et I ⊗ ξt+1                                                                            (25)

    Recall the definition of the process for the standard deviations:

                             ut+1 = σz (Iz − Λu )ū + Λu ut + σv V εv,t+1 .

We can use the above definition to write the quadratic term in ut+1 in equation (24) as:
   n                      o         n 
 Et Dfŷ ⊗ ut+1 ḡuu ut+1 = Et σz2 Df¯ŷ ⊗ ū0 (Iz − Λu )0 ḡuu (Iz − Λu )ū
        ¯     0
                                                                

                + Df¯ŷ ⊗ u0t Λ0u ḡuu Λu ut + σv2 Df¯ŷ ⊗ ε0v,t+1 V 0 ḡuu V εv,t+1
                                                                     
                                                                                       o
                                                             ¯       0            0
                                                                                   
                                                  + 2σz Dfŷ ⊗ ū (Iz − Λu ) ḡuu Λu ut . (26)

    Using the above to collect all second-order terms in ut from equation (24), considering
equation (25) and exploiting the operators “trm” and “dgm”, we obtain the following
system of n · nz × nz equations

  0 = Df¯ŷ · ḡx ⊗ Iz h̄uu + Df¯ŷ ⊗ Λ0u ḡuu Λu + Df¯x̂ ⊗ Iz h̄uu + Df¯y ⊗ Iz ḡuu
                                                                                    
                   h                                                                         i
           + dgm Df¯ŷ ⊗ h̄0ξ ḡxx h̄ξ + In ⊗ h̄0ξ ḡx0 H f¯ŷ · M̄ξ + In ⊗ h̄0ξ H f¯x̂ · M̄ξ , (27)
                                                                              


which can be solved for matrices ḡuu and h̄uu , given h̄x , ḡx , h̄xx , ḡxx , Df¯ and H f¯. Notice
that h̄uu and ḡuu will therefore consist of nx and ny , respectively, vertically stacked matrices
of dimensions nz × nz which will be diagonal matrices.
    We can further collect terms in σz ut from equation (24), considering equation (26) and
using the trm operator, to obtain a set of n × nz equations:

  0 = (Df¯ŷ · ḡx + Df¯x̂ )h̄zu + Df¯ŷ · ḡzu Λu + Df¯y · ḡzu + Df¯ŷ ⊗ ū0 (Iz − Λu )0 ḡuu Λu , (28)
                                                                                         


which can be solved for the unknown matrices ḡzu and h̄zu , given ḡx , ḡuu , and Df¯.
    Similarly, we can collect the terms in σz2 obtaining a set of n × 1 equations

  0 = (Df¯ŷ · ḡx + Df¯x̂ )h̄zz + (Df¯ŷ + Df¯y )ḡzz
                          + 2Df¯ŷ · ḡzu (Iz − Λu )ū + Df¯ŷ ⊗ ū0 (Iz − Λu )0 ḡuu (Iz − Λu )ū, (29)
                                                                               


which can be solved for ḡzz and h̄zz , given ḡx , ḡzu , ḡuu , and Df¯.
    Finally, we can collect the terms in σv2 obtaining a set of n × 1 equations
                                                                     h                    i
           0 = (Df¯ŷ · ḡx + Df¯x̂ )h̄vv + (Df¯ŷ + Df¯y )ḡvv + trm (Df¯ŷ ⊗ V 0 )ḡuu V ,        (30)

which deliver ḡvv and h̄vv , given ḡx , ḡuu , and Df¯.

                                                    12
3        A model with time-varying variances
In this section we discuss a more parsimonious model with time-varying volatility in
which the volatility is modeled through an autoregressive linear process for conditional
variances rather than for conditional standard deviations, as in the previous section. The
only difference with respect to the previous model is in equation (4) which we now replace
with
                              u2t+1 = σz2 (Iz − Λu ū2 ) + Λu u2t + σv2 V εv,t+1 .                (31)

Each element of u2t is the corresponding squared value of each element of ut , which still
corresponds to the diagonal of matrix Ut as in (3); ū is a vector of dimension nz ×1 with ū2
being a vector of the same dimension whose elements are each the square of the respective
element of ū; V and Λu are matrices of order nz × nz , εv,t+1 is a vector of innovation of
dimension nz × 1 which are assumed to have a bounded support and to be independently
and identically distributed with mean zero and variance/covariance matrix Iz ; σv and σz
are scalars with σv , σz ≥ 0.
       Differently from the previous model, it is now the conditional variance of each element
of the stochastic disturbances ξt+1 which is modeled as a linear process, (31). As a
consequence, the scale factors σz and σv have been appropriately squared.
       It is straightforward to show that a first-order approximation of this alternative model
is identical to that of the previous section except that now (4) replaces (31).
       Instead, a second order approximation will be of the form
                                          1                      1          1
                           ỹt = ḡx x̃t + (Iy ⊗ x̃0t )ḡxx x̃t + ḡuu u2t + ḡzz σz2 ,           (32)
                                          2                      2          2
                                1                        1              1
               x̃t+1 = h̄x x̃t + (Ix ⊗ x̃0t )h̄xx x̃t + h̄uu u2t + h̄zz σz2 + h̄ξ ξt+1 ,           (33)
                                2                        2              2
where the sizes of matrices ḡx , ḡxx , ḡzz , and h̄x , h̄xx , h̄zz , are the same as in the previous
section. Instead ḡuu and h̄uu are matrices of order ny × nz and nx × nz , respectively.13
       We now evaluate the second-order expansion (18), using equations (7) and (8) for the
second-order terms, taking into account (31), and the second-order guess solutions (32)
and (33) for the first-order terms, taking into account the restrictions implied by (10).
  13
       Notice that the expansion with respect to σv2 is zero up to second-order terms.




                                                       13
   We obtain:
             
     1
  0 = Et Df¯ŷ (ḡx ⊗ x̃0t ) h̄xx x̃t + ḡx h̄uu u2t + ḡx h̄zz σz2 + ḡzz σz2
     2
                                                                                                 
                                  0                                 2              2           2
                                   
     + Iy ⊗ (h̄x x̃t + h̄ξ ξt+1 ) ḡxx (h̄x x̃t + h̄ξ ξt+1 ) + σz ḡuu (Iz − Λu )ū + ḡuu Λu ut
                                                                                                  
          ¯          0                     2          2           ¯            0           2
     + Dfx̂ (Ix ⊗ x̃t ) h̄xx xt + h̄uu ut + h̄zz σz + Dfy (Iy ⊗ x̃t ) ḡxx xt + ḡuu ut + ḡzz σz  2



          + In ⊗ (ḡx h̄x x̃t + ḡx h̄ξ ξt+1 )0 H f¯ŷ · w̃t+1 + In ⊗ (h̄x x̃t + h̄ξ ξt+1 )0 H f¯x̂ · w̃t+1
                                                                                         
                                                                    
                    0 0       ¯                        0     ¯
          + (In ⊗ x̃t ḡx ) H fy · w̃t+1 + (In ⊗ x̃t ) H fx · w̃t+1 ,                                       (34)

From the above equations it is clear that matrices ḡxx and h̄xx are equivalent to those of
the previous model and satisfy equation (23).
  We can collect the remaining terms:
           
          ¯                                                 0
 0 = Et Dfŷ ḡx h̄uu u2t + ḡx h̄zz σz2 + ḡzz σz2 + Iy ⊗ ξt+1 h̄0ξ ḡxx h̄ξ ξt+1
                                                                    

                                                                                   
                     2                    2            2       ¯           2
                + σz ḡuu (Iz − Λu )ū + ḡuu Λu ut + Dfx̂ h̄uu ut + h̄zz σz       2

                                                                                                                      
                                      0
                                          h̄0ξ ḡx0       H f¯ŷ · M̄ξ ξt+1 + In ⊗    0
                                                                                          h̄0ξ       H f¯x̂ · M̄ξ ξt+1 . (35)
                                                                                                
                          + In ⊗     ξt+1                                            ξt+1

   Given a generic n·m×m matrix A consisting of n square matrices Ai stacked vertically,
with i = 1, ..., n, we define dgv(A) as the m × n matrix that stacks horizontally the main
diagonals of each of the m × m matrices Ai :

                         dgv(A) = [diagv(A1 ) diagv(A2 ) ... diagv(An )],

where diagv(Ai ) is an m × 1 vector collecting the elements on the main diagonal of Ai .
We can use the above operator, together with the matrix trace operator defined in the
previous section, to show, for generic and conformable matrices A and B:

                0
                    A0 BAξt+1 = Et trm I ⊗ ξt+1  0
                                                   A0 BAξt+1 =
                                                          
 Et        I ⊗ ξt+1
                                                                                         0
          trm (I ⊗ A0 ) BAEt ξt+1 ξt+1
                                   0
                                         = trm [(I ⊗ A0 ) BAUt Ut0 ] = dgv [(I ⊗ A0 ) BA] u2t .
                                     


   Using the above to express the quadratic terms in ξt+1 in equation (35) in terms of u2t ,
we collect the latter to obtain the following system of n × nz conditions:

 0 = Df¯ŷ · ḡx + Df¯x̂ h̄uu + Df¯ŷ · ḡuu Λu + Df¯y · ḡuu
                        
                  h                                                                  i0
                       ¯      0                    0 0      ¯           0   ¯
                                                                        
          + dgv Dfŷ ⊗ h̄ξ ḡxx h̄ξ + In ⊗ h̄ξ ḡx H fŷ · M̄ξ + In ⊗ h̄ξ H fx̂ · M̄ξ , (36)


                                                               14
which can be solved for matrices h̄uu and ḡuu .
    Finally, we can collect the terms in σz2 from equation (35), to show that matrices h̄zz
and ḡzz solve the following system of n × 1 equations:

            0 = Df¯ŷ ḡx + Df¯x̂ h̄zz + Df¯ŷ + Df¯y ḡzz + Df¯ŷ ḡuu (Iz − Λu ) ū2 .
                                                    
                                                                                           (37)


4     Application: the neoclassical growth model
To apply our method to a simple example, we consider the standard neoclassical growth
model as it is also done in Schmitt-Grohé and Uribe (2004). We denote with Ct consump-
tion and with Kt the capital stock at the beginning of period t. The parameters β, δ, γ and
α represent (respectively) the subjective discount factor, the depreciation rate of capital,
relative risk aversion and the return to scale of capital in the production function. The
equilibrium conditions of the model are given by:


                         Kt+1 − eat Ktα − (1 − δ)Kt + Ct = 0                               (38)
                      (                                )
                                               Ct+1 −γ
                                                
                         at+1 α−1
                    Et β αe Kt+1 + (1 − δ)                  −1=0                           (39)
                                                  Ct
                                      at+1 = ρat + ut εa,t+1                               (40)

∀t ≥ 0, given K0 and a0 = 0; where at denotes the log of the productivity shock. In
particular, the innovation εa,t+1 to the log-productivity process (40) is identically and
independently distributed process with mean zero and unitary variance; ut captures the
time-varying conditional standard deviation of at+1 and ρ is a parameter, with 0 ≤ ρ < 1.
We model the square of ut , i.e. the conditional variance of at+1 , as an exogenous stochastic
linear process
                             u2t+1 = (1 − λ)σa2 ū2 + λu2t + σv2 εv,t+1                    (41)

with initial condition u20 = σa2 ū2 where λ is a coefficient such that 0 ≤ λ < 1, while σa
and σv are non-negative scalars; ū is a positive parameter and the innovation εa,t+1 is
identically and independently distributed process with mean zero and unitary variance.
Notice that since Et (ut εa,t+1 ) = 0, the log-productivity process (40) is a conditionally
linear stochastic process.
    We can cast this model in the general notation of Section 2. Defining ct ≡ ln Ct ,




                                                15
kt ≡ ln Kt , we can write yt = [ct ] and xt = [kt , at ] and therefore
                                                                                      
                                        β αeat+1 +(α−1)kt+1 + (1 − δ) e−γct+1 − e−γct
                                                                     
                                                                                       
 Et {f (yt+1 , yt , xt+1 , xt )} = Et 
                                           ekt+1 − eat +αkt − (1 − δ)ekt + ect          = 0. (42)
                                                                                        
                                                          at+1 − ρat

According to (5) and (6), a solution to (42) takes the form

                                     ct = g(kt , at , ut , σa , σv )                           (43)
                                    kt+1 = h(kt , at , ut, σa , σv )                           (44)
                                        at+1 = ρat + ξt+1

with ξt+1 ≡ ut εa,t+1 and where the square of ut follows (41).
   In the non-stochastic steady-state, in which σa = σv = 0 and f (ȳ, ȳ, x̄, x̄) = 0, the
following system is used to solve for K̄ and C̄

                                       δ K̄ − K̄ α − C̄ = 0,

                                   β αK̄ α−1 + (1 − δ) = 1.
                                                     

Using the calibration of Schmitt-Grohé and Uribe (2004), i.e. β = 0.95, δ = 1, α = 0.3,
ρ = 0, γ = 2, we obtain:

                              K̄ = 0.1664,                 C̄ = 0.4175.

According to (7) and (8), a first-order approximation of (43) and (44) takes the form

                                         c̃t = gk k̃t + ga at                                  (45)

                                       k̃t+1 = hk k̃t + ha at                                  (46)

where we have defined c̃t ≡ ln Ct − ln C̄, k̃ ≡ ln Kt − ln K̄ and the coefficients gk , ga , hk
and ha coincide with those of Schmitt-Grohé and Uribe (2004):

                                  gk = 0.2525, ga = 0.8417
                                 hk = 0.4191, ha = 1.3970.

   However, there is an important difference between our approximation and that of
Schmitt-Grohé and Uribe (2004). In our case, at follows the conditionally-linear and
heteroskedastic process (40), in which the conditional variance is modelled as in (41). In

                                                  16
their framework, instead, shocks are homoskedastic and at follows the following linear
process:
                                      at+1 = ρat + σa ūεa,t+1 .                              (47)

In Fernandez-Villaverde et al. (2009, 2010) the original stochastic process for the exoge-
nous state variables is heteroskedastic as in (11) and (12), but a linear approximation of
this process would be consistent with (47) in which risk is no longer time-varying. Instead,
in our first-order approximation stochastic volatility still matters and will be particularly
relevant when estimating the model, as it is done in Justiniano and Primiceri (2008).
   However, as mentioned in section 2.2, in our first-order approximation risk does not
play a “distinct and direct” role. To see this point, we discuss the impulse response
functions. Defining the impulse response of a generic variable xt at time t + j with respect
to the shock εt as
                                       ∂(Et xt+j − Et−1 xt+j )
                              I(xt+j |εt ) =                   ,
                                                 ∂εt
we obtain that the impulse response with respect to the shock εa,t is given by

                          I(c̃t+j |εa,t ) = gk I(k̃t+j |εa,t ) + ga I(at+j |εa,t )

                        I(k̃t+j+1 |εa,t ) = hk I(k̃t+j |εa,t ) + ha I(at+j |εa,t )

for each j > 0 with I(k̃t |εa,t ) = 0 where

                                   I(at+j+1 |εa,t ) = ρI(at+j |εa,t )

for each j > 0 and
                                           I(at |εa,t ) = σa ū.

The impulse response with respect to the shock εa,t will not be affected by the fact that
shocks are heteroskedastic or not and therefore will coincide with those of Schmitt-Grohé
and Uribe (2004). However, even if we compute the impulse response with respect to
risk, i.e. with respect to the shock εv,t , this will be zero at all times: I(c̃t+j |εv,t ) = 0 and
I(k̃t+j |εv,t ) = 0 for each j > 0. Therefore risk will not play a distinct and separate role in
affecting the variables of interest even in our first-order approximation. To get this role,
we need to go to a second-order approximation.
   Following (32) and (33), the second-order approximation will be of the form
                                   1         1          1                      1
             c̃t = gk k̃t + ga at + guu u2t + gkk k̃t2 + gaa a2t + gka at k̃t + gσσ σa2
                                   2         2          2                      2
                                   1         1          1                      1
           k̃t+1 = hk k̃t + ha at + huu u2t + hkk k̃t2 + haa a2t + hka at k̃t + hσσ σa2
                                   2         2          2                      2
                                                    17
where again at follows (40) and u2t follows (41). To compute the numerical values for
the remaining coefficients, we consider the calibration adopted by Schmitt-Grohé and
Uribe (2004) for the structural parameters, and σa = σv = ū = 1 and λ = 0.5 for the
parameters entering equation (41) and governing the dynamics of stochastic volatility.
This calibration implies:

 guu = −0.1444,           gkk = −0.0051,         gaa = −0.0569,           gka = −0.0171,    gσσ = −0.0478,
 huu = 0.3622,          hkk = −0.0070,         haa = −0.0778,            hka = −0.0233,     hσσ = 0.1199.

It is also clear that second-order-approximation impulse response function with respect to
the shock εa,t will not be affected by the fact that shocks are heteroskedastic or not and
therefore will correspond to those of Schmitt-Grohé and Uribe (2004). Instead, now there
is a distinct role for risk to affect the variables of interest. Indeed, the impulse responses
with respect to the shock εv,t will be of the form

                              I(c̃t+j |εv,t ) = gk I(k̃t+j |εv,t ) + guu I(u2t+j |εv,t )

                             I(k̃t+j+1 |εv,t ) = hk I(k̃t+j |εv,t ) + huu I(u2t+j |εv,t )

for each j > 0 with I(k̃t |εv,t ) = 0 where

                                        I(u2t+1+j |εv,t ) = λI(u2t+j |εv,t )

for each j > 0 and
                                                 I(u2t |εv,t ) = σv2 .

Obviously, in Schmitt-Grohé and Uribe (2004) there is no role at all for time-varying
volatility while in Fernandez-Villaverde et al. (2009, 2010) there will not be a distinct
role and therefore impulse responses with respect to εv,t will be zero. To get this role,
they have to go to higher-order approximations.
       In Figure 1 we show the impulse response of consumption and capital to 1% change in
risk to productivity shock. The impact response of consumption and investment depends
on the relative strength of two opposite forces. On the one hand, higher volatility tends
to increase the supply of saving for future production and therefore for precautionary
reasons.14 On the other hand, higher volatility increases the expected excess return on
capital reducing its appeal as an asset to accumulate. Under our parametrization, in par-
ticular with δ = 1, the precautionary-saving effect dominates and on impact consumption
  14
       This channel is stronger when the depreciation is larger, and is clearly dominant with full depreciation.


                                                         18
 0.25                                                       1
                                  consumption                                  variance of prod. shocks
                                  capital
                                                          0.9
  0.2

                                                          0.8


 0.15
                                                          0.7


                                                          0.6
  0.1

                                                          0.5

 0.05
                                                          0.4


                                                          0.3
       0


                                                          0.2

ï0.05
                                                          0.1


 ï0.1                                                       0
           0   2     4        6         8       10              0     2        4          6     8         10




Figure 1: Dynamic response of consumption and capital to a 1% innovation to the variance of produc-
tivity shocks. Percentage points.


decreases while investment rises.15 In the following periods because of capital accumu-
lation, production and consumption increase above their steady state levels as long as
agents still accumulate capital above steady state.
       As we have already discussed, another important advantage of our approach with
respect to Schmitt-Grohé and Uribe (2004) and Fernandez-Villaverde et al. (2009, 2010)
is that risk-premia evaluated using first-order approximation will be time-varying. To see
this, let rt+1 be the risk-free real rate, and define rk,t+1 as the return on capital from
period t to period t + 1:

                                  rk,t+1 = αeat+1 +(α−1)kt+1 + (1 − δ).

Using the above, we can show that in a second-order approximation the expected excess
return of capital is given by
                                           1
                    Et (r̃k,t+1 − r̃t+1 ) + vart (r̃k,t+1 ) = γcovt (r̃k,t+1 , ∆c̃t+1 )
                                           2
where r̃k,t+1 and r̃t+1 denote the log deviation from steady state of the real return on capital
and the risk-free rate, respectively. The right-hand side measures the risk premium and
  15
     When γ = δ = 1, saving is always a constant fraction of income and therefore risk does not have a
distinct role.




                                                     19
this will be time-varying because

covt (r̃k,t+1 , ∆c̃t+1 ) = φcovt (at+1 + (α − 1)k̃t+1 , gk k̃t+1 + ga at+1 )
                             h                                                         i
                                      2                                             2
                         = φ Et ga at+1 + ((α − 1)ga + gk )k̃t+1 at+1 + (α − 1)gk k̃t+1
                                               h                   i h                    i
                                            −Et at+1 + (α − 1)k̃t+1 Et gk k̃t+1 + ga at+1

                     = φga u2t

which will indeed depend on the time-variation of the variance u2t , where φ ≡ 1 − β(1 − δ).
In Schmitt-Grohé and Uribe (2004) and Fernandez-Villaverde et al. (2009, 2010), this
risk premium, computed using a first-order approximation, will be constant.


5     Conclusion
Recent models used in macroeconomics examine the role of stochastic volatility for the
equilibrium allocation. To solve these models, researchers have appealed to global solu-
tions or high-order approximation techniques. Global-solution techniques suffer from the
‘curse of dimensionality’, since the number of state variables limits their computational
efficiency. Commonly used approximation techniques require third-order expansion of the
equilibrium conditions in order to display a distinct role for stochastic volatility.
    Here we propose a first and second-order approximation method to study the role
of time-varying exogenous risk in discrete-time dynamic stochastic models which en-
compass standard dynamic general equilibrium models with rational expectations. In
our framework, an important assumption is that the exogenous state variables follow a
conditionally-linear stochastic process in which either the variance or the standard devi-
ation of the primitive shocks are modelled through a stochastic linear process. In this
way, we generalize the framework and the method developed by Schmitt-Grohé and Uribe
(2004), Kim et al. (2008) and Gomme and Klein (2008) to the case in which the exogenous
state variables follow an heteroskedastic process.
    The main contribution of our paper is to show that first and second-order approxi-
mations of the solution are sufficient to capture most of the relevant elements needed to
study the impact of uncertainty in standard macroeconomic models. There are three main
advantages following our method. First, a first-order approximation falls in the broader
class of conditionally-linear approximations displaying a role for time-varying volatility,
although not a distinct one. Second, given that a first-order approximation retains a role

                                              20
for stochastic volatility, the second-order approximation of the solution implies that the
time-varying volatility of primitive shocks can directly affect the endogenous variables.
Third, it follows from the previous results that risk-premia evaluated using first-order
approximations will be time-varying. All these advantages translate into a more parsimo-
nious model, more easily tractable for estimation purposes.
      In addition to characterizing the second-order approximation of the solution when
shocks are conditionally linear, the paper offers a set of MATLAB codes designed to
compute the coefficients of the first and second-order approximations and provides a
simple example to illustrate the applicability of the method.16 In general, indeed, our
method can be applied easily to several macroeconomic models ranging from real business
cycle models, to monetary models and also to asset-pricing or finance models. In Benigno
et al. (2010), we employ this method to analyze how risk and monetary policy interact to
determine prices, exchange rates and asset prices in an open-economy model.




 16
      The set of codes is available under the webpage of the authors.


                                                    21
References
 [1] Amisano, Gianni. and Oreste Tristani (2009), “A DSGE Model of the Term Structure
    with Regime Shifts,” mimeo, European Central Bank.

 [2] An, Sungbae and Frank Schorfheide (2007),. “Bayesian Analysis of DSGE Models,”
    Econometric Reviews, vol. 26(2-4), pages 113-172.

 [3] Benigno, Gianluca, Pierpaolo Benigno, Salvatore Nisticò (2010), “Risk, Monetary
    Policy and the Exchange Rate,” in preparation for the NBER Macroeconomic Annual
    2011.

 [4] Benigno, Pierpaolo and Michael Woodford (2008), “Linear-Quadratic Approxima-
    tion of Optimal Policy Problems” Discussion Papers 0809-01, Columbia University,
    Department of Economics.

 [5] Bloom, Nicholas (2009). “The Impact of Uncertainty Shocks,” Econometrica, vol.
    77(3), pages 623-685.

 [6] Bloom, Nicholas, Nair Jaimovich and M. Floetotto (2009), “Really Uncertain Busi-
    ness Cycles,” unpublished manuscript.

 [7] van Binsbergen, Jules, Jesus Fernandez-Villaverde, S.J. Koijen and Juan F. Rubio-
    Ramirez (2010), “The Terms Structure of Interest Rates in a DSGE Model with
    Recursive Preferences,” unpublished manuscript.

 [8] Fernandez-Villaverde, Jesus, Pablo Guerron-Quintana, Juan F. Rubio-Ramirez and
    Martin Uribe (2009), “Risk Matters: The Real Effects of Volatility Shocks,” NBER
    Working Paper No. 14875.

 [9] Fernandez-Villaverde, Jesus, Pablo Guerron-Quintana and Juan F. Rubio-Ramirez
    (2010), “Fortune or Virtue: Time-Varian Volatilities Versus Parameter Drifting in
    U.S. Data,” unpublished manuscript.

[10] Gomme, Paul and Paul Klein (2008), “Second-order approximation of dynamic mod-
    els without the use of tensors,” forthcoming Journal of Economic Dynamics and
    Control

[11] Justiniano Alejandro and Giorgio Primiceri (2008), “The Time Varying Volatility of
    Macroeconomics Fluctuations,” American Economic Review 98, 604-641.

                                            22
[12] Kim Jinill, Sunghyun Kim, Ernst Schaumburg, Christopher A. Sims (2008), “Calcu-
    lating and Using Second-Order Accurate Solutions of Discrete Time Dynamic Equi-
    librium Models,” Journal of Economic Dynamics and Control, Volume 32, Issue 11,
    pp. 3397-3414.

[13] Krusell, Per and Anthony A. Smith & Jr. (1998), “Income and Wealth Heterogeneity
    in the Macroeconomy,” Journal of Political Economy, vol. 106(5), pages 867-896.

[14] Magnus, Jan and Heinz Neudecker (1999). Matrix Differential Calculus With Appli-
    cations in Statistics and Econometrics, John Wiley and Sons.

[15] Rudebusch, Glenn D. and Eric T. Swanson (2008), “The Bond Premium in a DSGE
    Model with Long-Run Real and Nominal Risks,” unpublished manuscript, Federal
    Reserve Bank of San Francisco.

[16] Schmitt-Grohé Stephanie and Martin Uribe (2004), “Solving Dynamic General Equi-
    librium Models using a Second-Order Approximation to the Policy Function,” Jour-
    nal of Economic Dynamics and Control 28, pp. 755-775.




                                         23
