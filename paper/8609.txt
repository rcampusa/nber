                                  NBER WORKING PAPER SERIES




                 RISK AVERSION AND OPTIMAL PORTFOLIO POLICIES IN
                   PARTIAL AND GENERAL EQUILIBRIUM ECONOMIES


                                              Leonid Kogan
                                              Raman Uppal


                                          Working Paper 8609
                                  http://www.nber.org/papers/w8609


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                     November 2001



Financial support from the Rodney L.White Center for Financial Research is gratefully acknowledged. We
are grateful to Bernard Dumas for detailed suggestions on the manuscript.We would also like to acknowledge
comments from Harjoat Bhamra, John Campbell, George Chacko, Lorenzo Garlappi, Francisco Gomes, Mark
Grinblatt, Denis Gromb, Ulrich Haussmann, Claus Munk, Vasant Naik, Jiang Wang, Tan Wang and seminar
participants at Boston College,London Business School,London School of Economics, UBC Commerce, the
UBC Pacific Institute for Mathematical Sciences, the Wharton Lunch Seminar Series, UCLA, University of
Vienna, SIRIF Conference on Dynamic Portfolio Strategies, TMR-HERMES Conference on Savings,
Portfolios and Pensions, and the Western Finance Association Meetings (Sun Valley,2000). The views
expressed herein are those of the authors and not necessarily those of the National Bureau of Economic
Research.


© 2001 by Leonid Kogan and Raman Uppal. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is given
to the source.
Risk Aversion and Optimal Portfolio Policies in
Partial and General Equilibrium Economies
Leonid Kogan and Raman Uppal
NBER Working Paper No. 8609
November 2001
JEL No. G12, G11, D52, C63



                                              ABSTRACT


        In this article, we show how to analyze analytically the equilibrium policies and prices in an
economy with a stochastic investment opportunity set and incomplete financial markets, when agents
have power utility over both intermediate consumption and terminal wealth, and face portfolio
constraints. The exact local comparative statics and approximate but analytical expression for the
portfolio policy and asset prices are obtained by developing a method based on perturbation analysis to
expand around the solution for an investor with log utility. We then use this method to study a general
equilibrium exchange economy with multiple agents who differ in their degree of risk aversion and face
borrowing constraints. We characterize explicitly the consumption and portfolio policies and also the
properties of asset returns. We find that the volatility of stock returns increases with the cross-sectional
dispersion of risk aversion, with the cross-sectional dispersion in portfolio holdings, and with the
relaxation of the constraint on borrowing. Moreover, tightening the borrowing constraint lowers the risk-
free interest rate and raises the equity premium in equilibrium.




Leonid Kogan                                                       Raman Uppal
Sloan School of Management                                         London Business School
Massachusetts Institute of Technology                              6 Sussex Place
50 Memorial Drive, E52-455                                         Regent's Park, London
Cambridge, MA 02142                                                United Kingdom
and NBER                                                           NW1 4SA
Tel: 617-253-2289                                                  Tel: 44-20-7706-6883
Email: lkogan@mit.edu                                              Email: ruppal@london.edu
1        Introduction

Merton (1969, 1971) shows that in an environment where investment opportunities vary over time,
investors optimizing over a single period will choose portfolios that are diﬀerent from investors
optimizing over multiple periods. This is because the optimal intertemporal portfolio is not nec-
essarily instantaneously mean-variance eﬃcient, but also provides a hedge against future shifts in
the investment opportunity set.1 However, these papers do not indicate how one can obtain ex-
plicit solutions: in the dynamic programming formulation of Merton, obtaining an explicit solution
requires one to solve a nonlinear partial diﬀerential equation for which a closed-form solution is
typically not available.

        To obtain explicit solutions to the non-linear diﬀerential equation characterizing the intertem-
poral portfolio problem, research building on the work of Merton has proceeded in three directions.
One strand—for example, Liu (1998) and Wachter (1998) in partial equilibrium and Wang (1996)
in general equilibrium—assumes that ﬁnancial markets are complete, and then uses the martingale
technique of Cox and Huang (1989) to determine the optimal consumption and portfolio rules in
two distinct steps: ﬁrst, consumption is identiﬁed by solving a static optimization problem, and
then the optimal portfolio rules are obtained by solving a linear diﬀerential equation. A second
strand—for instance, Kim and Omberg (1996) and Liu (1998)—assumes that investors derive utility
only from terminal wealth and not from intermediate consumption, which is one of the sources of
the non-linearity in the diﬀerential equation. Then, under a particular speciﬁcation of the invest-
ment opportunity set, this assumption allows them to solve the dynamic programming equation in
closed form. A third approach, developed by Campbell (1993), allows for intermediate consump-
tion and incomplete ﬁnancial markets, but chooses a convenient speciﬁcation for the evolution of
the investment opportunity set, and then makes appropriate approximations in order to overcome
the non-linearity of the problem.2 Thus, the ﬁrst approach needs to make restrictive assumptions
about the structure of ﬁnancial markets, while the other two approaches work only for particular
speciﬁcations for the evolution of the investment opportunity set; moreover, all three approaches
    1
     The static and dynamic portfolios will coincide only under speciﬁc conditions for the utility function (unit risk
aversion) or asset returns (independence between changes in the investment opportunity and asset returns). Results
in the empirical literature suggest that it is unlikely that either condition is true; a discussion of this literature is in
Campbell and Viceira (1999).
   2
     For models set in discrete time one needs to log-linearize the budget equation and the ﬁrst-order conditions, and
for models set in continuous time one needs to log-linearize the Hamilton-Jacobi-Bellman equation.
Risk aversion and optimal portfolio policies                                                         2


are not suitable when there are constraints on portfolio positions.

   This article contributes to the literature on portfolio choice and asset pricing in two ways. First,
we develop a method to analyze analytically the equilibrium policies and prices in an economy with
a stochastic investment opportunity set and incomplete ﬁnancial markets, when agents have power
utility over both intermediate consumption and terminal wealth. This method can be applied
to characterize portfolio policies in partial-equilibrium models where the risk-free interest rate,
the expected stock return and the volatility of stock returns can change over time. This method
can also be used to study general equilibrium economies with portfolio constraints when there
are multiple investors who diﬀer in their risk aversion, and hence, the investment opportunity set
evolves endogenously.

   Our second contribution is to apply this method to a particular general equilibrium setting in
order to understand the eﬀect on asset prices of portfolio constraints and of heterogeneity. We
study a general equilibrium exchange economy with an arbitrary number of agents who diﬀer
in their degree of risk aversion and face borrowing constraints. Our main ﬁndings are that the
volatility of stock returns increases with the cross-sectional dispersion of risk aversion, with the
cross-sectional dispersion of portfolio holdings, and as one relaxes the constraint on borrowing.
Moreover, tightening the borrowing constraint lowers the risk-free interest rate and raises the
equity premium in equilibrium.

   Our analytical characterization of portfolio policies and prices in economies with an arbitrary
number of agents, who diﬀer in their risk aversion and face borrowing constraints, extends the
analysis of a production economy in Dumas (1989) and of an exchange economy in Wang (1996).
In contrast to our work, both these papers assume that ﬁnancial markets are complete and do
not consider the case of portfolio constraints; moreover, the model in Dumas can be solved only
numerically even when there are only two agents, while Wang can solve for only some of the
quantities of the model in closed form and even this is possible only for particular permutations of
the number of agents and the degree of risk aversion for each of these agents.

   Several papers study economies in which agents have heterogeneous preferences in the presence
of portfolio constraints. Cuoco (1997) characterizes the risk premium in an economy where agents
diﬀer with respect to their risk aversion face portfolio constraints. Detemple and Murthy (1997)
Risk aversion and optimal portfolio policies                                                       3


also study a heterogeneous-agent general equilibrium model with portfolio constraints where the
heterogeneity arises from diﬀerences in beliefs rather than diﬀerences in risk aversion (all agents
have log utility); they show that some of their results on pricing would extend to an economy where
agents diﬀer in risk aversion, but do not provide an explicit characterization of optimal policies.
Marcet and Singleton (1999) use simulation methods to analyze an economy where agents face
borrowing constraints and diﬀer with respect to their labor income and risk aversion. In contrast
to these papers, we provide an explicit characterization in terms of exogenous variables for the
consumption and portfolio policies, the riskless rate and the stock price, and also for the mean and
volatility of stock returns.

   Identifying the equilibrium in multiagent economies with incomplete ﬁnancial markets is a
diﬃcult problem and to date the literature does not have an explicit general characterization in
terms of exogenous variables. Cuoco and He (1994a,b) show that with incomplete markets one can
still construct a representative agent, but in this case the weights assigned to individual agents in
this aggregation evolve stochastically. However, their characterization of equilibrium is in terms of
endogenous variables. Our approach can be viewed as a convenient way of expressing the solution
in terms of the primitives in economies where ﬁnancial markets are incomplete and agents diﬀer in
their degree of risk aversion.

   Our method relies on asymptotic analysis, which allows one to obtain in closed-form the approx-
imate (asymptotic) expressions for portfolio and consumption policies. The basic idea of asymptotic
methods is to formulate a general problem, ﬁnd a particular case that has a known solution, and use
this as a starting point for computing the solution to nearby problems. In the context of portfolio
problems, the solution for the investor with log utility (with unit risk aversion) provides a conve-
nient starting point for the expansion. We need to emphasize, though, that while our method allows
for exact comparative statics results around the case of log utility, it provides only approximations
to the portfolio rules and asset prices, and thus, it should be viewed as being complementary to
numerical methods rather than a substitute. While the asymptotic solution is designed to provide a
local approximation (for risk aversion close to unity), general theoretical results on the magnitude
of the approximation error are currently not available—see Judd (1996, 1998, Ch. 13–15) for a
discussion of these issues. However, there are a number of methods to evaluate the quality of the
approximate solution numerically (for instance, see Den Haan and Marcet, 1994, and Judd, 1996
Risk aversion and optimal portfolio policies                                                        4


and 1998) that can also be applied to the portfolio problems considered here.

    The rest of the paper is arranged as follows. In Section 2, we describe the method for analyzing
portfolio decisions in the context of an arbitrary vector process driving investment opportunities.
In Section 3, we apply this method to a particular general equilibrium exchange economy where
investors vary in their degree of risk aversion and face leverage constraints. We conclude in Sec-
tion 4. The main results of each section are highlighted in propositions and the proofs for all the
propositions are collected in the appendix.



2     An asymptotic approach to consumption and portfolio choice

In this section, we undertake an asymptotic analysis of a model of consumption and portfolio selec-
tion with a stochastic investment opportunity set, when the agent derives utility from intermediate
consumption and bequest, and faces constraints on her portfolio position. We show that one can ob-
tain an explicit asymptotic expression for the solution of the intertemporal consumption-portfolio
problem, as long as the value function of the analogous problem for the agent with logarithmic
preferences is known in closed form.

    The section is structured as follows. We start by describing a partial-equilibrium economy with
an arbitrary stochastic vector process for the state variables that drives changes in the investment
opportunity set. Following this, we ﬁrst derive the consumption and portfolio rules in the absence
of constraints and then consider the eﬀect of constraints on portfolio positions. We conclude by
discussing how these results can be extended to a general equilibrium setting.


2.1   The economy

In this section, we describe the features of the model: the preferences of agents, the ﬁnancial assets
that they can choose to hold, and the stochastic nature of the investment opportunity set.
Risk aversion and optimal portfolio policies                                                                        5


2.1.1      Preferences

The utility function of the agent is time-separable and is given by
                                                                                                           
                                       T
                                           −ρt 1                                                     1 γ    
                     ψ · E0                e            (Ctγ   − 1) dt + (1 − ψ) · e  −ρT
                                                                                            E0         WT − 1 ,
                                   0                γ                                                γ

where ρ is the constant subjective time discount rate, Ct is the ﬂow of consumption, and the
preference parameter ψ controls the relative weight of intermediate consumption and the end-of-
period wealth (bequest) in the agent’s utility function. The agent’s relative risk aversion is given
by 1 − γ, and for agents with unit risk aversion (γ = 0), utility is given by the logarithmic function:
                                                  T                  
                                                         −ρt
                              ψ · E0                    e      ln Ct dt + (1 − ψ) · e−ρT E0 [ln WT ] .
                                                0




2.1.2      Financial assets

The agent can allocate her wealth to two assets: a short-term riskless asset (bond) with rate of
return rt , and a stock (paying zero dividend).3 The price of the stock, Pt , evolves according to

                                                            dPt
                                                                = µP t dt + σP t dZP t ,                           (1)
                                                            Pt

where µP t is the instantaneous expected return and σP t is the volatility. Our convention is to
denote stochastic variables with a subscript “t”; thus, in the above speciﬁcation, the riskless rate,
rt , the expected return on the stock, µP t , and the volatility of stock returns, σP t , are permitted to
be stochastic.


2.1.3      The investment opportunity set

The investment opportunity set is described by the vector of state variables, Xt . The state vector
is assumed to change over time according to

                                                                     
                                                dXt = µX (Xt ) dt + σX (Xt ) · dZXt ,                              (2)

where the covariance between the stock returns process and the state vector process is denoted by
σP X . With the above speciﬁcation, the riskless rate and the expected rate of return and volatility
  3
      The extension to multiple risky assets is straightforward.
Risk aversion and optimal portfolio policies                                                                                        6


of the risky asset may depend on the state vector:

                             rt = r (Xt ) ,             µP t = µP (Xt ) ,           σP t = σP (Xt ) ,

implying that the instantaneous market price of risk is also stochastic:

                                                                         µP t − rt
                                                      φt = φ (Xt ) ≡               .
                                                                           σP2 t


2.2     Consumption and portfolio policies in the absence of portfolio constraints

In the above economy, denoting by πt the proportion of the agent’s wealth invested in the risky
asset, the wealth of the agent evolves according to

                                                              
                           dWt = (rt + πt (µP t − rt )) Wt − Ct dt + πt σP t Wt dZPt .                                            (3)

The value function J (W, X, t) of the optimal control problem is deﬁned by

                                            T                                                                               
                                                  −ρ(s−t) 1                                                           1 γ    
  J (Wt , Xt , t) = sup ψ · Et                    e             (Csγ   − 1) ds + (1 − ψ) · e      −ρ(T −t)
                                                                                                             Et         WT − 1 ,
                     {Cs ,πs }            t                 γ                                                         γ

subject to equations (1), (2), and (3). Deﬁning the consumption-wealth ratio c ≡ C/W , the
function J (W, X, t), satisﬁes the Hamilton-Jacobi-Bellman equation

                 
                     ψ
                     γ   ((W c)γ − 1) + Jt − ρJ + (r + π(µP t − rt ) − c) JW W + 12 π 2 W 2 JW W σP2
      0 = max                                                                                                                 .
           c,π                      + µX · JX + 12 σX
                                                      ·J                  
                                                         XX · σX + πW σP X · JW X



   Given the homogeneity of the utility function, the solution to this equation has the following
functional form:
                                                            A(t)                       γ
                                    J (W, X, t) =                       eg(X,t) W          −1 ,                                   (4)
                                                             γ

where
                                                                1+ρ                         ψ
                                      A(t) =            1−ψ               e−ρ(T −t) +         .
                                                                 ρ                          ρ

The exact solution for the optimal consumption policy and portfolio weight can be obtained from
Risk aversion and optimal portfolio policies                                                         7


the ﬁrst-order conditions implied by the Hamilton-Jacobi-Bellman equation:
                                                          1/(γ−1)
                                       1
                          c(X, t) =      A(t) eγ g(X,t)             ,
                                       ψ

                                        JW            JW JW X σP X (X)
                         π(X, t) = −          φ(X) −
                                       W JW W        W JW W JW σP2 (X)

                                       1           γ σP X (X) ∂g(X, t)
                                  =       φ(X) +                        ,                           (5)
                                      1−γ        1 − γ σP2 (X)   ∂X

where the second line is obtained by using (4).

   In general, the unknown function g (X, t) cannot be computed in closed form. Our approach
is to obtain an asymptotic approximation to g (X, t), where the expansion is with respect to the
risk aversion parameter, γ. In order to use our results also in a general equilibrium setting with
multiple agents who diﬀer in their risk aversion, we deﬁne γ ≡  a, where a is used to index agent
types so that diﬀerences in a lead to diﬀerences in risk aversion, while the parameter  allows us
to set the magnitude of these diﬀerences. With the above speciﬁcation, we look for g (X, t) as a
power series in :
                                                                      
                               g (X, t) = g0 (X, t) +  g1 (X, t) + O 2 ,                          (6)

where g0 (X, t) is obtained from the value function of an agent with logarithmic utility ( = 0):


                               J (W, X, t) = A(t) ln W (t) + g0 (X, t) .


Note that the ﬁrst-order asymptotic expansions are suﬃcient to obtain exact local comparative
statics results for the dependence of the optimal policies on the risk aversion parameter. The
asymptotic expansions will also approximate the optimal consumption and portfolio policies when
the risk aversion parameter γ is suﬃciently close to zero (that is, when  is close to zero).

   We now derive the asymptotic expansions for the consumption-portfolio problem (by substitut-
ing (6) into (5)) and explain how one can obtain the function g0 (X, t). Following this, we examine
the comparative statics properties of the optimal policies.


Proposition 2.1 The first-order asymptotic expansions for the optimal consumption and portfolio
Risk aversion and optimal portfolio policies                                                                        8


choice are

                                     ψ         ψ                           A(t)          
                    c (X, t) =           − a           g0 (X, t) + ln               + O 2 ,                     (7)
                                    A(t)      A(t)                          ψ

                                      1             a σP X (X) ∂g0 (X, t)     
                    π (X, t) =            φ(X) +          2                 + O 2 .                              (8)
                                    1− a        1 −  a σP (X)    ∂X

An asymptotically equivalent expression for the portfolio choice is given by

                                                  φ(X)   σ  (X) ∂g0 (X, t)              
                     π (X, t) = φ(X) +  a              + P2X                        + O 2 ,                     (9)
                                                 σP (X)   σP (X)    ∂X

where the function g0 (X, t) is

                                         T
                   1 − e−ρ(T −t)     1
g0 (X, t) = ψ ln ψ               −ψ         e−ρ(s−t) ln A(s) ds +
                      ρA(t)         A(t) t
                                                                                             
                          T                                                       2          2
              1                    ψ                       ψ               φ (Xs )  σ P (Xs )
                 Et         A(t) −    1 − e−ρ(s−t)      −      + r (Xs ) +                      ds .
            A(t)        t          ρ                      A(s)                      2


    The two expressions for the portfolio weight, (8) and (9), are equally easy to manipulate. The
role of the risk aversion coeﬃcient is more apparent in (9), while (8) retains the exact form of the
myopic portfolio demand, expanding only the hedging demand.

    Comparing the asymptotic weight in (8) to the exact one in (5), we see that the only diﬀerence
is that under the standard approach one needs to identify the unknown function g(X, t), while in
our approach one needs to identify only g0 (X, t), the value function for the log investor. It is much
easier to solve for the value function of the log investor. The intuition for this is well-known:4 the
substitution eﬀect and the income eﬀect arising from a change in the investment opportunity set
are of exactly the same magnitude and opposite sign for an investor with log utility. Consequently,
this investor has zero demand for hedging future changes in the investment opportunity set, and
so her portfolio coincides with the myopic portfolio. Similarly, log-utility investors do not adjust
their consumption-wealth ratio for changes in the investment opportunity set, and so it is easy to
identify this ratio as a deterministic function of time, 1/A(t). As long as the function g0 (X, t) is
known in closed form, one can obtain explicit ﬁrst-order asymptotic expressions for the optimal
   4
     Early results on the properties of the log utility function are in Leland (1968) and Mossin (1968). These results
were developed further in Hakansson (1971) and Merton (1971).
Risk aversion and optimal portfolio policies                                                         9


consumption and portfolio policies. For example, the class of aﬃne processes will yield closed-form
solutions.

   Analyzing the consumption-portfolio rules given in Proposition 2.1, we see that the zero-order
components of these expansions correspond to the well-known solution for the case where the agent
has a logarithmic utility function ( = 0): the optimal consumption-wealth ratio, c ≡ C/W , is given
by the deterministic function 1/A(t), and the optimal portfolio policy is myopic and independent of
changes in the investment opportunity set. The ﬁrst-order terms capture the eﬀect of risk aversion
when the coeﬃcient of relative risk aversion deviates from one ( deviates from zero). In particular,
one can interpret the expression for the optimal portfolio in (8) as

                                 1             a        1        ∂g0 (X, t)      
                π (X, t) =            φ (X) +             2 σP X ·              +O 2 ,
                             1 −  
                                    a      1 −  a    σP
                                                             
                                                                      ∂X
                                                                              
                             myopic demand             hedging demand

where the ﬁrst bracketed term represents the portfolio weights under constant investment oppor-
tunity set, the myopic demand, and the second term characterizes the demand arising from the
desire to hedge against changes in the investment opportunity set. The important thing to note in
the above expression is that it relies on g0 , which can be determined explicitly, rather than on g,
which cannot be identiﬁed generally.

   The equation above allows one to obtain the intuitive comparative static results: the hedging
demand is asymptotically proportional to the risk aversion parameter and vanishes as  approaches
zero. The hedging demand is also proportional to the scalar product of the vector of “betas” of the
state variables with respect to the risky asset, σP−2 σP X , and the “delta” of the function g0 (X, t)
with respect to the state vector, ∂g0 (X, t) /∂X. Finally, the equation shows that the hedging
demand is zero when the shocks to the state variables are uncorrelated with the returns on the
stock (σP X = 0).

   The asymptotic expansions (7) and (9) approximate the optimal consumption and portfolio
policies when the risk aversion parameter  is suﬃciently close to zero. They also provide exact
local comparative static results for the dependence of the optimal policies on the risk aversion
Risk aversion and optimal portfolio policies                                                                  10


parameter:
                                                                      
                     ∂c (X, t)            −ψ                  A(t)
                                      = a        g0 (X, t) + ln           ,                                  (10)
                        ∂ =0             A(t)                 ψ
                                                                             
                     ∂π (X, t)                      1            ∂g0 (X, t)
                                     = a φ (X) + 2        σ (X) ·               .                           (11)
                        ∂        =0              σP (X) P X          ∂X

Equation (11) indicates that the optimal position in the risky asset can either increase or decrease
with the risk aversion coeﬃcient, depending on the magnitude of the second term in equation (11),
which is the sensitivity of the hedging demand with respect to the parameter .

   Inﬁnite-horizon economies are a special case of the general formulation of the previous section.
Because of the importance of inﬁnite-horizon models, we present the result for this case below as a
separate proposition, which can be obtained from Proposition 2.1 by setting ψ = 1 and taking the
limit as T → ∞.


Proposition 2.2 The first-order asymptotic expansions for the optimal consumption and portfolio
choice are
                                                          
                     c (X) = ρ −  aρ g0 (X) − ln (ρ) + O 2 ,                                               (12)

                                    1             a σP X (X) ∂g0 (X)      2
                     π (X) =            φ(X) +                         + O   ,                              (13)
                                 1 − a        1 −  a σP2 (X) ∂X

with an asymptotically equivalent expression for the portfolio choice being

                                                               σP X (X) ∂g0 (X)       
                      π (X) = φ(X) +  a φ(X) +                                    + O 2 ,
                                                                σP2 (X) ∂X

where the function g0 (X) is
                                                                                                   
                                               ∞
                                                                     φ (Xt )2 σP (Xt )2         
                                                                                                
             g0 (X) = ln ρ − 1 + E0                e−ρt    r (Xt ) +                          dt X0 = X .
                                           0                                  2                 



2.3   Consumption and portfolio policies in the presence of portfolio constraints

Up to this point, it had been assumed that the agent’s consumption-portfolio choice was uncon-
strained. We now extend the analysis to allow for constraints on the portfolio weights. To simplify
Risk aversion and optimal portfolio policies                                                                  11


the exposition, we analyze only the inﬁnite-horizon problem explicitly. It should be clear from our
presentation how the solution of the ﬁnite-horizon problem in Proposition 2.1 must be modiﬁed to
account for constraints.

   We consider constraints of the form that restrict the portfolio weight on the risky asset to lie
between a lower and an upper bound:

                                            π (X) ≤ π (X) ≤ π (X) ,

where these bounds are allowed to depend on the state of the economy. Other than allowing for
state-dependence, this speciﬁcation of portfolio constraints is a specialization of the formulation in
Cvitanic and Karatzas (1992) to the case of one risky asset. By restricting our attention to the
constraint on portfolio proportions, we are ruling out more general types of constraints, e.g., the
constraints on the absolute amount invested in each asset (see Grossman and Vila (1992), Cuoco
(1997)).

   The value function of the agent’s constrained optimization problem now satisﬁes
                                 1
                                                                                                   
                                 a   ((W c) a − 1) − ρJ + r + πφσP2 − c JW W + 12 π 2 W 2 JW W σP2
    0=          max                                                                                    .
           c,π∈[π(X),π(X)]                   + µX · JX + 12 σX
                                                               ·J              
                                                                  XX · σX + πW σP X · JW X



Proposition 2.3 In the presence of constraints, the optimal portfolio choice is given by
                                         
                                           (X) ,
                                           π              π (X) ≤ π
                                                                   (X) ≤ π (X) ,
                                         
                                 π (X) =   π (X) ,         (X) < π (X) ,
                                                          π
                                         
                                         
                                           π (X) ,         (X) > π (X) ,
                                                          π

where
                                                         1            ∂g0c (X)        
                    ≡ φ (X) +  a φ (X) +
                   π                                        σ    (X) ·             + O 2 .                 (14)
                                                     σP2 (X) P X         ∂X

and the optimal consumption policy is given by
                                                                           
                                   c (X) = ρ −  aρ (g0c (X) − ln (ρ)) + O 2 .

The value function of the log investor in the presence of constraints is

 g0c (X) = ln ρ − 1                                                                                          (15)
                                                                                                           
                           ∞
                                                                             1                       
            +E                 e−ρt    r (Xt ) + π0 (Xt ) φ (Xt ) σP (Xt )2 − π02 (Xt ) σP2 (Xt ) dt X0 = X ,
                       0                                                     2
Risk aversion and optimal portfolio policies                                                         12


where
                                   
                                    φ (Xt ) ,     π (Xt ) ≤ φ (Xt ) ≤ π (Xt ) ,
                                   
                        π0 (Xt ) =   π (Xt ) ,     φ (Xt ) < π (Xt ) ,                             (16)
                                   
                                   
                                     π (Xt ) ,     φ (Xt ) > π (Xt ) .


   The function g0c (X) in (14), where the superscript “c” indicates the presence of constraints,
is the counterpart of the function g0 (X) in (13): it deﬁnes the value function of the log-utility
maximizer subject to the same portfolio constraints and the same investment opportunity set as
the investor with (non-log) power utility function.

   As in the unconstrained case, an explicit asymptotic expression for the optimal consumption
and portfolio policies is available as long as the solution of the analogous problem for the agent
with the logarithmic utility function is known in closed form.


2.4     Consumption and portfolio policies in general equilibrium

The results in Propositions 2.1, 2.2 and 2.3 can be used as building blocks in the analysis of
a broad range of models. In particular, they allow one to obtain asymptotic expressions for the
prices of assets in equilibrium economies that otherwise can only be studied numerically. Successful
application of our results is possible as long as it is possible to obtain explicit solutions for agents
with logarithmic utility functions. In that case, the asymptotic demand functions, equations (7) and
(8) for the ﬁnite-horizon case or (12) and (13) for the inﬁnite-horizon case, are known in closed form
and for equilibrium models the asset prices can be determined from the market clearing conditions.

   We now explain how the results of the previous section can be used to analyze heterogeneous-
agent economies, and in the next section we study a particular application. Speciﬁcally, consider
an inﬁnite-horizon economy populated by heterogeneous agents, each with power utility function.
Recall that γ ≡  a, where diﬀerences in a lead to diﬀerences in risk aversion, while  controls the
magnitude of these diﬀerences. In such an economy the investment opportunity set depends on the
cross-sectional distribution of wealth among the agents, as well as on the exogenous state variables
and the small parameter . Thus, the expanded state vector is given by

                                         Xt = {X0t , {Wt (a)}} ,
Risk aversion and optimal portfolio policies                                                     13


where X0t denotes the vector of exogenous state variables and {Wt (a)} is the set of individual
wealth values for the agents in the economy.

   Because the moments of returns on ﬁnancial assets explicitly depend on , we can approximate
them by an asymptotic power series. Speciﬁcally, a moment of returns mt can be expressed as

                           mt = m(Xt , ) = m0 (X0t ) +  m1 (Xt ) + O(2 ).                   (17)

The leading term in the expansion coincides with the corresponding moment in an economy with
 = 0, i.e., in a homogeneous-agent economy with log-utility maximizing agents. This implies that
m0 depends only on the exogenous state vector X0t .

   Next, consider the term g0 (X, ) in the value function of the log-utility maximizer in our
heterogeneous-agent economy. Since the moments of returns depend on , so does the function
g0 , according to Proposition 2.2. Thus,

                               g0 (X, ) = g0,0 (X0 ) +  g0,1 (X) + O(2 ).                   (18)

The leading term g0,0 corresponds to the value function in the homogeneous-agent economy with
log-utility maximizing agents and hence does not depend on the wealth distribution.

   We can now use Proposition 2.2 to obtain asymptotic expansions for the individual portfolio
policies in a heterogeneous-agent economy.


Proposition 2.4 The optimal consumption and portfolio policies in a heterogenous-agent economy
are given by:
                                                          
                   c (X) = ρ −  aρ g0,0 (X0 ) − ln ρ + O 2 ,
                                                                              
                                                   σP X,0 (X0 ) ∂g0,0 (X0 )           
                   π (X) = φ(X) +  a φ(X) +         2 (X )                        + O 2 .
                                                    σP,0 0         ∂X0


where g0,0 is given in (18).


   Thus, to obtain a valid asymptotic expansion of the consumption and portfolio policies in a
general equilibrium economy one simply has to replace the function g0 in Proposition 2.2 with it’s
leading term g0,0 . This greatly simpliﬁes computation of the equilibrium, because the function g0,0
Risk aversion and optimal portfolio policies                                                                          14


corresponds to the value function of the log investor in a homogeneous economy, and therefore, can
be obtained without solving for the equilibrium in the heterogeneous economy. In the next section,
we show how one can use the method developed above to analyze a heterogenous-agent economy
in the presence of portfolio constraints.



3     A general equilibrium exchange economy

In this section, we study an exchange (endowment) economy with multiple agents who diﬀer in
their level of risk aversion.5 Wang (1996) analyzes this economy for the case where there are two
agents who do not face any portfolio constraints.6 We extend the analysis of Wang in several
directions. First, we show how one can characterize the equilibrium for the case where there is
an arbitrary number of agents. In contrast to Wang, we also obtain closed-form (asymptotic)
expressions for the mean and volatility of the stock return process. This analysis allows us to relate
the volatility of stock returns to the heterogeneity of investors in their degree of risk aversion and
to the cross-sectional dispersion in stock holdings.

    Second, in Section 3.2, we introduce a leverage constraint that restricts how much investors
can borrow to lever their investment in the stock. The model can no longer be solved using the
representative-agent approach used in Wang (1996). We use the asymptotic approach to character-
ize the equilibrium in the presence of constraints, ﬁrst for the case where there are only two agents,
and then for the case where there is a continuum of agents. We then analyze the relation between
the constraint on leverage and the volatility of stock returns, and also the interaction between the
leverage constraint and heterogeneity across investors.


3.1    The economy with unconstrained agents

We assume that there are two assets available for trading in the economy. The ﬁrst asset is a
short-term risk-free bond, available in zero net supply, which pays the interest rate rt that will
be determined in equilibrium. The second asset is a stock, which is a claim on the aggregate
   5
     We report only the analysis of the exchange economy considered in Wang (1996); the analysis of the production
economy studied in Dumas (1989), with the addition of portfolio constraints, can be obtained from the authors.
   6
     Wang (1996) also discusses how the model could be solved when there are up to 4 agents, each having a particular
value for the risk aversion parameter; with more than 4 agents a closed-form solution is not available for general wealth
distributions.
Risk aversion and optimal portfolio policies                                                        15


endowment, et , that evolves according to

                                       det = µe et dt + σe et dZet ,

where µe and σe are constant parameters. We assume that the growth rate of the endowment is
positive, µe − σe2 /2 > 0. The cumulative stock return process is

                                     dPt + et dt
                                                 = µRt dt + σRt dZt ,                             (19)
                                         Pt

with µRt and σRt to be determined in equilibrium.

   Assume that agents in the economy diﬀer in their degree of risk aversion, γ(a) =  a. Without
loss of generality, assume that there is a single agent of each type a. Let Wt (a) be the wealth
                         
of the individual agent, a Wt (a) is the aggregate wealth in the economy, which is also equal to
                                                        
the value of the stock market, Pt , and ωt (a) ≡ Wt (a)/ a Wt (a). The investment opportunity set
depends on the cross-sectional distribution of wealth across agents, and thus, the correspondence
with the general formulation in Section 2 is that Xt = {Wt (a)}. If  were equal to zero, then all
the agents would have logarithmic preferences. As a result, they would hold the same portfolio and
their wealth would be perfectly correlated; in this case, the cross-sectional distribution of wealth in
the economy would be constant over time.



3.1.1   Individual policies

We start by identifying the value function of an agent in an economy where  = 0 (that is, all
agents have log utility). In such an economy, the value function of a representative agent equals
                                                                ∞                  
                               1                                        −ρt
                                 (ln W0 + g0,0 ) = E0                 e       ln et dt .
                               ρ                              0

                                                      1
The expectation on the right-hand side equals         ρ   ln e0 + A, where

                                                  1               σe2
                                           A≡             µe −
                                                  ρ               2

and also, W0 is the aggregate wealth in the economy, which is equal to the price of the stock, 1ρ e0 .
Thus,
                                               g0,0 = ln ρ + A.
Risk aversion and optimal portfolio policies                                                       16


Substituting the above value for g0,0 into Proposition 2.4 then leads to the consumption and portfolio
policies:

                                         ct (a) = ρ −  aρ A + O(2 )                            (20)

                                         πt (a) = (1 +  a) φt + O(2 ),                         (21)

                                                  2 , along with the riskless interest rate, r , is
where the market price of risk, φt = (µRt − rt )/σRt                                          t

determined in equilibrium.



3.1.2       Equilibrium

The equilibrium in this economy is deﬁned by the stock price process, Pt , the interest rate process
rt , and the portfolio and consumption policies, such that (i) given the price processes for ﬁnancial
assets, the consumption and portfolio choices are optimal for the agents, (ii) the goods market and
the markets for the stock and the bond clear.

    The conditions for market clearing in the stock and commodity markets are:
                                             
                                                   πt (a)ωt (a) = 1,                             (22)
                                               a
                                             
                                                   ct (a)Wt (a) = et ,                           (23)
                                              a

where, if one wishes to consider a continuum of agents, the summation signs should be replaced
by integrals. Using these market-clearing conditions along with the expressions for the optimal
consumption and portfolio polices for individual investors, and deﬁning
                                                                                   2
                          Ea [a] ≡        a ωt (a),      vara [a] ≡ Ea [a2 ] − Ea [a] ,
                                     a

we have the following characterization of the equilibrium in the unconstrained economy.


Proposition 3.1 For the exchange economy described above, in equilibrium:


  (i) The stock price is given by

                                     Pt            1    1
                                             =       +  A Ea [a] + O(2 ),                      (24)
                                     et            ρ    ρ

while the moments of the cumulative return process are
Risk aversion and optimal portfolio policies                                                                          17


                                       µRt = (µe + ρ) −  ρA Ea [a] + O(2 ),                                      (25)

                                       σRt = σe + 2 A σe vara [a] + O(3 ).                                       (26)

 (ii) The interest rate is given by

                                 rt = (µe − σe2 + ρ) +  (σe2 − ρA)Ea [a] + O(2 ).                                (27)

(iii) The optimal portfolio policy is
                                                                   
                                           πt (a) = 1 +  a − Ea [a] + O(2 ).                                     (28)

 (iv) The cross-sectional wealth distribution evolves according to

                          dωt (a)
                                     =  ρA (a − Ea [a]) dt +  σe (a − Ea [a]) dZt + O(2 ).                      (29)
                          ωt (a)


       Observe that the ﬁrst moment of stock returns in (25) can be computed only up to order O(2 )
terms because we know Pt /et only up to O(2 ) terms. However, the second moment, given in
equation (26), is known to higher order. Based on this, we have the following result.


Proposition 3.2 Asymptotically, the volatility of stock returns is increasing in the cross-sectional
heterogeneity of risk aversion.


       To understand the intuition behind this result, consider the equilibrium stock price (24). The
price-dividend ratio is decreasing in average risk aversion. This is because the expected stock return
is increasing in average risk aversion, as shown in (25). Moreover, the average risk aversion in the
economy ﬂuctuates over time in response to the aggregate endowment shocks. According to (21),
agents with relatively high risk aversion are less exposed to the stock market risk. Therefore, the
fraction of total wealth controlled by agents with higher-than-average risk aversion declines as the
stock market rises, as shown in (29). As a result, the average risk aversion in the economy is
negatively aﬀected by the aggregate endowment shocks, implying a positive eﬀect on the price-
dividend ratio.7 The positive impact of the endowment shocks on the price-dividend ratio increases
   7
    Chan and Kogan (2001) discuss the countercyclical nature of expected stock returns due to investor heterogeneity
in a setting were individuals have catching-up-with-the-Joneses preferences. Our setting uses a more common speci-
ﬁcation of individual preferences, but the same intuition for time-variation in expected returns applies in both cases.
While Chan and Kogan rely on numerical analysis and focus on the dynamics of conditional moments of stock re-
turns, we derive an explicit asymptotic relation between the level of return volatility and the degree of cross-sectional
heterogeneity.
Risk aversion and optimal portfolio policies                                                        18


the volatility of stock returns. Because the outlined eﬀect is due to the cross-sectional diﬀerences in
investors’ risk aversion, it comes as no surprise that its magnitude is related to the cross-sectional
dispersion of individual types, as captured by (26).

   Given individual risk aversion coeﬃcients are not directly observable, it is useful to re-state
Proposition 3.2 in terms of individual portfolio choices. Because vara [πt (a)] = 2 vara [a] + O(3 ),
there exists a positive linear asymptotic relation between the volatility of stock returns and the
cross-sectional dispersion of individual portfolio holdings.



3.1.3    Comparison with the exact solution

In order to demonstrate that the analytical results described above capture the salient qualitative
features of the exact solution, we solve numerically the unconstrained model for the case where there
are only two agents. Based on the exact solution obtained numerically, we present in Figure 1 the
parametric plots showing the relation between the cross-sectional dispersion of portfolio holdings
(vara [π(a)]) and the conditional volatility of stock returns (scaled by the volatility of endowment
process). There are four plots, each for a diﬀerent degree of heterogeneity across the two investors,
which is given by the parameter . The solid line in each plot corresponds to the asymptotic solution
while the dashed line is for the exact numerical solution.

   Consistent with our analytic asymptotic results, all four plots show that the volatility of stock
returns tends to increase with the cross-sectional dispersion of portfolio holdings. Given the nature
of the asymptotic expansions we are using, it is not surprising to ﬁnd that the asymptotic solution
is closer to the exact solution in the ﬁrst three plots, where the degree of heterogeneity in the
economy is smaller ( closer to zero) and investors have risk aversion closer to unity, relative to
the fourth plot, where  is much further away from zero. Nevertheless, even in the latter case the
relation between return volatility and cross-sectional dispersion is positive.


3.2     The economy with portfolio constraints

Now, assume that agents are restricted in the amount they can borrow in order to lever up their
investment in the stock. In particular, individual portfolio positions must satisfy:

                                               πt ≤ 1 +  L.
Risk aversion and optimal portfolio policies                                                                     19


Observe that we specify the limit on borrowing, L, to be proportional to the small parameter .
This is because the equilibrium portfolio policies in the unconstrained economy, as given by Propo-
sition 3.1, imply that the amount of borrowing by individual agents is proportional to ; therefore,
in order for the leverage constraint to have an impact for small values of the small parameter, it
must be suﬃciently tight, i.e., formally, it must be proportional to  as well.

    In the presence of the leverage constraint, based on Proposition 2.3 the individual portfolio
policies take the form
                                                                  !
                               πt (a) = min (1 +  a) φt , 1 +  L + O(2 )

                                        = 1 +  min [a + φ1t , L] + O(2 ),

where the market price of risk is expanded as φt = 1 +  φ1t + O(2 ).8 We will say that the leverage
constraint is binding for an agent of type a when b + φ1t ≥ L.



3.2.1    Equilibrium in the constrained economy with two agents

We start by considering the case where there are only two classes of agents, a and a , with a < a .
Then, the market clearing condition in the stock market is:

                                       
                               1 =          πt (a)ωt (a)
                                        a
                                             
                                  = 1+            min [a + φ1t , L] ωt (a) + O(2 ).
                                               a

                                           c , then identifying the optimal consumption and port-
Proceeding as before, by ﬁrst identifying g0,0
folio policies, and ﬁnally using the market clearing conditions to obtain the price processes, we have
the following.


Proposition 3.3 In equilibrium, the leverage constraint is binding when ωt (a )(a − a ) − L ≥ 0.
In this region:
   8
     The leading term in the expansion φ0t = 1 is the market price of risk in the economy populated with log-utility
agents.
Risk aversion and optimal portfolio policies                                                                           20


  (i) The stock price is given by

                                        Pt           1    1
                                               =       +  A Ea [a]) + O(2 ),
                                        et           ρ    ρ

while the moments of the cumulative return process are
                                   µRt = (µe + ρ) −  ρA Ea [a] + O(2 ),                                           (30)
                                                              
                                   σRt = σe + 2 Aσe L a − a ωt (a ) + O( 3 ).                                (31)

 (ii) The interest rate is

                                                                    ωt (a )
                        rt = (µe − σe2 + ρ) +  σe2 L                         + a − ρAEa [a] + O(2 ).             (32)
                                                                    ωt(a )

(iii) The portfolio policy is
                                                                           
                                                           ωt (a )
                                  πt (a) = 1 +  min a − L           − a , L + O(2 ).
                                                                        
                                                           ωt(a )

 (iv) The cross-sectional wealth distribution for the two types of agents evolves according to:

                           dωt (a )                                      ωt (a )
                                             =  ρA a − Ea [a] dt −  σe L           dZt + O(2 ),
                            ωt (a )                                        ωt (a )

                           dωt (a )                          
                                             =  ρA a − Ea [a] dt +  σe L dZt + O(2 ).
                            ωt (a )

    When the leverage constraint is not binding, the solution is asymptotically the same as in the
unconstrained case.


    Imposing the leverage constraint lowers the risk free interest rate. Formally, the diﬀerence
between interest rates in the unconstrained and the constrained economies, given by

                                              ωt (a )                           
                                     σe2                 ω t (a
                                                                  )(a
                                                                        − a
                                                                             ) − L   + O(2 ),
                                              ωt (a )

is asymptotically positive, because ωt (a )(a − a ) − L ≥ 0 whenever the leverage constraint is bind-
ing. The expected stock return is asymptotically unaﬀected, according to (30). Thus, tightening
the leverage constraint increases the equilibrium equity premium, µRt − rt .9
   9
     Heaton and Lucas (1996) observe similar behavior of asset returns in their incomplete-market model in response
to an increased diﬀerence in borrowing and lending rates. Their analysis relies on numerical simulations and the
intuition behind their results is diﬀerent. In their model, individuals have the same risk aversion but face idiosyncratic
endowment shocks. As a result, an increase in trading costs raises individual consumption variability, and hence,
lowers the risk-free rate of return due to the demand for precautionary savings.
Risk aversion and optimal portfolio policies                                                        21


   We now explain the intuition for this result. Start by considering the situation where trading
in the stock is not allowed in equilibrium. Then, one class of agents would borrow to increase their
current consumption, thereby reducing the growth rate of their consumption. Hence, imposing
the borrowing constraint would reduce current consumption and increase the consumption growth
rate of the constrained agent while reducing the growth rate for the unconstrained agent. This
would lower the equilibrium interest rate, which is linked to the consumption growth rate of the
unconstrained agent.

   Now, consider the situation where agents can trade also the risky asset. This complicates
matters in general. Intuitively, holding the asset price processes ﬁxed, adding the leverage constraint
reduces the aggregate demand for the risk free asset, which suggests that tightening the leverage
constraint would result in a lower interest rate in equilibrium. However, this argument ignores
the potential impact of the constraint on stock returns. We ﬁnd that the leverage constraint has
only a higher-order eﬀect on the moments of stock returns in our model, as can be seen from
comparing Propositions 3.1 and 3.3. To understand the reason for this, note that the stock price
is determined by market clearing for the consumption good, and the consumption policy (the
consumption to wealth ratio) itself is aﬀected by the leverage constraint only through its eﬀect
on the investment opportunity set. Because the consumption policy of investors with logarithmic
preferences is independent of the investment opportunity set, for agents with utility functions
close to logarithmic, the impact of changes in the investment opportunity set on the consumption
policy is of order  (see Proposition 2.3). Moreover, the time-varying component of the investment
opportunity set is itself of order  in equilibrium, since the economy is perturbed around the
logarithmic representative agent case where the investment opportunities are constant over time.
Therefore, these two eﬀects imply that the impact of the leverage constraint on consumption policies
is of order 2 (see Proposition 2.4). Thus, the constraint has only a second-order eﬀect on the
equilibrium price-dividend ratio and the moments of stock returns.

   The above argument explains the impact of the leverage constraint on the risk-free rate and the
equity premium in our model. We summarize these observations in the following proposition.


Proposition 3.4 Asymptotically, the interest rate in the constrained economy is lowered and the
equity premium is increased by tightening the borrowing constraint.
Risk aversion and optimal portfolio policies                                                                                22


   Next, we relate the volatility of stock returns to the leverage constraint and compare it to the
volatility in the unconstrained economy.


Proposition 3.5 Asymptotically, the volatility of stock returns in the constrained economy is lower
than in the unconstrained economy:

                                                          c     u
                                                         σRt ≤ σRt + O( 3 ),

       c and σ u denote the volatility of stock returns in the constrained and the unconstrained
where σRt     Rt

economy respectively. Moreover, the volatility of stock returns is reduced by tightening the borrowing
constraint.


   As we argued above, the volatility of stock returns is positively related to the variability of the
average risk aversion in the economy. The leverage constraint reduces the cross-sectional diﬀerences
in individual portfolio holdings, and hence, the variability of the cross-sectional wealth distribution
and the average risk aversion. As a result, the constraint on borrowing lowers the volatility of stock
returns.


3.2.2      The economy with portfolio constraints and a continuum of agents

In the previous section, we found that constraints on leverage lower the volatility of stock returns.
We carried out our analysis for the special case of only two types of agents. In this section, we
extend this result to an economy with a continuum of agents.

   Assume that agents have risk aversion between −â and +â, with an arbitrary wealth distribu-
tion, ωt (a). Then, market clearing in the stock market implies

                                       L−φ1t                                  â
                             0=                    (a + φ1t )ωt (a)da +              L ωt (a)da,
                                       −â                                   L−φ1t


and, the volatility of the returns process is:

                                                 â
           Pt             A
     d          =          + O(2 )                   adωt (a)da
           et             ρ                      −â
                                                     L−φ1t                                 â               
                                   2 Aσe
                = [. . .] dt +                                aωt (a) (a + φ1t ) da +               Laωt (a)da + O(3 ),
                                        ρ          −â                                       L−φ1t
Risk aversion and optimal portfolio policies                                                         23


which then allows us to show the following.


Proposition 3.6 Asymptotically, the interest rate in the constrained economy is lowered, the equity
premium is increased, and the volatility of stock returns is reduced by tightening the borrowing
constraint.


4    Conclusion

In this article, we have provided an asymptotic analysis of the optimal consumption and portfolio
decisions of an investor who has preferences over intermediate consumption and faces an economic
environment with stochastic investment opportunities and portfolio constraints. Our results include
comparative statics results for optimal policies and analytic asymptotic expressions for equilibrium
asset prices. In addition to the analysis of the portfolio policy of a single agent, we have shown
how the portfolio-choice problem in the presence of a stochastic investment opportunity set can
be embedded in a general equilibrium setting, even when there are multiple investors who diﬀer
in their degree of risk aversion and face constraints on their portfolio positions. Throughout our
analysis, we have not needed to rely on the assumption that ﬁnancial markets are complete.

    The model developed in the paper can be extended in several directions. For instance, we
have assumed that agents have time-additive power utility rather than the more general recursive
preferences described in Kreps and Porteus (1978) and Duﬃe and Epstein (1992). Given that log
utility is a special case also of the Kreps-Porteus speciﬁcation of recursive utility, it is possible to
extend the asymptotic method to the case of recursive preferences. Similarly, the method can also
be applied to an economy where agents exhibit habit-persistence. Moreover, the general equilibrium
model studied in the paper is of an exchange economy but the method applies also to a production
economy.

    One limitation of the analysis we have presented is that it applies only to those situations where
there exists a closed-form solution for an investor with logarithmic utility. However, even when an
explicit solution does not exist for the log investor, one may apply asymptotic analysis, but with
the perturbation now being around a parameter diﬀerent from that governing risk aversion.
Risk aversion and optimal portfolio policies                                                                                            24


Appendix: Proofs for all propositions

Proof of Proposition 2.1

The result follows by substituting (6) into (5). First- and higher-order terms in the expansion
of g(X) do not aﬀect the ﬁrst-order asymptotic expansion of the optimal consumption-portfolio
policy. The equivalent asymptotic expression (9) is obtained by expanding (8) in powers of  and
eliminating terms of order two and higher.

   To obtain g0 , we use the deﬁnition of the value function of the log-utility maximizer, with
optimal consumption c(Xt , t) = ψ/A(t) substituted in,
                                                    T                               
                                                          −ρ(s−t)        Ws
              J(Wt , Xt , t) = ψEt                        e         ln              ds + (1 − ψ)e−ρ(T −t) Et [ln WT ] ,               (A1)
                                                  t                      A(s)

where the wealth process Wt evolves according to

        dWt                  ψ
                  =    −         + r(Xt ) + π(Xt , t) µP (Xt ) − r(Xt )                         dt + π(Xt , t)σP (Xt ) dZP t .
        Wt                  A(t)

Thus,
                                       s                                                               s
                                               ψ              φ(Xu )2 σP (Xu )2
     ln(Ws ) = ln(Wt ) +                    −      + r(Xu ) +                   du +                         φ(Xu )σP (Xu ) dZP u ,
                                    t         A(u)                    2                              t


where we have used the expression for the optimal portfolio policy of the log investor, π(Xt , t) =
φ(Xt ). Substituting this into (A1) yields
J(Wt , Xt , t) =
            T                                                                s                                                          
                  −ρ(s−t)                             −ψ              φ(Xu )2 σP (Xu )2
   ψEt     e           ln ψ − ln A(s) + ln(Wt ) +         + r(Xu ) +                    du                                            ds
         t                                        t A(u)                      2
                                      T                                     
             −ρ(T −t)                     −ψ             φ(Xu )2 σP (Xu )2
   + (1 − ψ)e         Et ln(Wt ) +            + r(Xu ) +                   du .
                                       t A(u)                    2

Integration by parts completes the proof of the proposition.



Proof of Proposition 2.2

The results follow by setting ψ = 1 and taking the limit as T → ∞ for the corresponding expressions
in Propositions 2.1 while noting that in the limit, A(t) = 1/ρ.
Risk aversion and optimal portfolio policies                                                       25


Proof of Proposition 2.3

As in Proposition 2.2, this result follows by replacing the function g(X) in the expression for the
optimal consumption-portfolio policy with its asymptotic expansion. Only the leading term in
the expansion must be retained, which corresponds to the solution of the log-utility maximizer’s
problem.

   To obtain g0c note that the wealth process of the log-investor evolves according

            dWt
                    =    −ρ + r(Xt ) + π0 (Xt )φ(Xt )σP (Xt )2 dt + π0 (Xt )σP (Xt ) dZP t ,
             Wt

where π0 (Xt ) is the optimal portfolio policy of the log-utility maximizer, given by (16). Repeating
the steps of the proof of Proposition 2.2 we obtain the desired result.



Proof of Proposition 2.4

Substituting the expansions (17) and (18) into the expression for the consumption policy and
portfolio weights in Proposition 2.2, and eliminating the higher-order terms, yields the result.



Proof of Proposition 3.1

Divide equation (23) by aggregate wealth, which equals Pt , to get
                                          et   
                                             =   ct (a)ωt (a).
                                          Pt   a

According to Proposition 2.2, the individual consumption policy is

                                       ct (a) = ρ −  aρA + O(2 ).

Together, these two results imply that

                   Pt  1        1                      1
                      =                     + O(2 ) = (1 + AEa [a]) + O(2 ).                (A2)
                   et  ρ a (1 −  aA) ωt (a)           ρ

   Using

                               dPt        d(Pt /et ) det   det d(Pt /et )
                                      =             +    +    ·           ,                     (A3)
                               Pt         (Pt /et )   et   et   Pt /et

   and
Risk aversion and optimal portfolio policies                                                      26


                            dωt (a) = O()dt + O()dZt                                          (A4)

we ﬁnd that
                                      dPt
                                          = µe dt + σe dZt + O(2 ),
                                       Pt

which then implies that

                                                et
                                µRt = µe +         + O(2 )
                                                Pt

                                       = (µe + ρ) −  ρA Ea [a] + O(2 )

   and
                                σRt = σe + O(2 ).

Using the condition in equation (22) for equilibrium in the stock market,

                µRt − rt
                    2    (1 +  Ea [a]) = 1,
                  σRt

   we have that
                             µRt − rt
                                 2       = 1 −  Ea [a] + O(2 )                                (A5)
                               σRt

   so that
                                                  2
                                      rt = µRt − σRt (1 −  Ea [a]) + O(2 ),

                                         = (µe − σe2 + ρ) + (σe2 − ρA)Ea [a] + O(2 ).

Also, using (A5), the expression for the optimal portfolio weight in equation (21) reduces to

                                   πt (a) = 1 +  (a − Ea [a]) + O(2 ).


   To derive the process for stock returns in terms of exogenous variables, and to determine the
higher-order terms in the asymptotic expansions of the moments of the return process, we start by
describing the evolution of Wt (a):

dWt (a)                                       !
          =    πt (a)(µRt − rt ) + rt − ct (a) dt + πt (a)σRt dZt
Wt (a)
                                                                                                  !
          =    σe2 (1 − Ea [a]) 1 + (a − Ea [a]) + µe − σe2 + ρ + (σe2 − ρA)Ea [a] − ρ(1 − aA) dt

               + σe (1 + (a − Ea [a])) dZt + O(2 )
Risk aversion and optimal portfolio policies                                                                       27

                                                                                               !
                  =     σe2 +  σe2 (a − 2Ea [a]) + µe − σe2 + ρ + (σe2 − ρA)Ea [a] − ρ + ρAa dt

                        + σe (1 + (a − Ea [a])) dZt + O(2 )
                                                     !
                  =     µe + (σe2 + ρA)(a − Ea [a]) dt + σe (1 + (a − Ea [a])) dZt + O(2 ).

Next,

        dωt (a)         dWt (a) dPt       1           !  dW (a) dP 
                                                                t        t
                      =         −     + 2 dPt , dPt −                ,
         ωt (a)          Wt (a)    Pt    Pt                 W  t (a)   Pt
                                                   
                      = µe + (σe2 + ρA)(a − Ea [a]) dt + σe (1 + (a − Ea [a]))dZt − µe dt − σe dZt

                          + σe2 dt − σe2 (1 + (a − Ea [a]))dt + O(2 )

                      =  ρA(a − Ea [a])dt +  σe (a − Ea [a])dZt + O(2 ).

Finally, this leads to the following result: from (A2),
                                                      
                              A        
     d(Pt /et ) =                              a dωt (a)   + O(2 ) · dωt (a)
                               ρ           a
                                                               
                                                                          Aσe 
                          2        2
                  =            A          a(a − Ea [a])ωt (a) dt + 2           a(a − Ea [a])ωt (a)dZt + O(3 )
                                       a
                                                                            ρ a

                                                     Aσe
                  = 2 A2 vara [a]dt + 2                vara [a]dZt + O(3 ),
                                                      ρ

   and so, from (A3),
          dPt
                  = 2 ρA2 vara [a]dt + 2 Aσe vara [a]dZt + µe dt + σe dZt + 2 A σe2 vara [a]dt + O(3 )
          Pt
                                                                                  
                  =          µe + 2 (ρA2 + σe2 A)vara [a] dt + σe + 2 A σe vara [a] dZt + O(3 ).



Proof of Proposition 3.2

The result follows from diﬀerentiating the expression for the volatility of stock returns in (26) with
respect to vara [a].



Proof of Proposition 3.3

The introduction of portfolio constraints changes equation (27) and onwards, but because equations
(24) and (25) are based on (20), these results are still valid.
Risk aversion and optimal portfolio policies                                                    28


   From equation (22):

      1 = Ea [πt (a)]
                                         2                               2    
                       µRt − rt         σRt                               σRt
        = Ea (1 +  a)     2    χ a≤L            + Ea (1 +  L) χ a > L            ,
                         σRt          µRt − rt                          µRt − rt

where χ(·) is an indicator function. This equation is used to determine r as follows. Assuming that
a < a and that the constraint binds for a ,

                                           µRt − rt
                              1 = 1 +  a       2    ωt (a ) + (1 +  L)ωt (a ),
                                               σRt

which implies that

                         µRt − rt        ωt (a ) −  Lωt (a )
                             2      =
                           σRt            ωt (a ) (1 +  a )

                                               ωt (a )
                                    = 1−         L      + a + O(2 )
                                               ωt (a )
                                                                          
                                             2               ωt (a )   
                               rt   = µRt − σRt 1 −  L                +a    + O(2 ).        (A6)
                                                             ωt (a )


   Consider the region where the constraint is binding:

                                                                    ωt (a )
                                               L ≤ a − L                    − a
                                                                    ωt(a )
                                                                L
                                      ⇒ ωt (a ) ≥                   .
                                                          a   − a

In this region,
                                                                              
             dWt (a )                                    2 ωt (a )
                                                                        
                          = µe +  ρA a − Ea [a] − σe L                          dt
              Wt (a )                                             ωt (a )
                                                                            
                                       
                                                        ωt (a )      
                            + σe 1 +  a 1 −  L                   +a          dZt
                                                         ωt(a )
                                                                                
                                                            2 ωt (a )
                                                                           
                          = µe +  ρA a − Ea [a] + Lσe L                           dt
                                                                    ωt (a )
                                                   
                                          ωt (a )
                            + σe 1 −  L              dZt + O( 2 );
                                          ωt (a )

            dWt (a )                               
                          =    µe +  ρA a − Ea [a] + L dt + σe (1 +  L) dZt + O( 2 ).
            Wt (a )
Risk aversion and optimal portfolio policies                                                                       29


Thus,

                             dωt (a )                                ωt (a )
                                          = ρA a − Ea [a] dt −  σe L           dZt ;
                              ωt (a )                                  ωt (a )

                            dωt (a )                     
                                          = ρA a − Ea [a] dt +  σe L dZt .
                             ωt (a )

Using these results,
                                                                                  
                       Pt                A                        
                  d             =           dZt + O( 2 )               a dωt (a)
                       et                 ρ                         a

                                                     Aσe L                         
                                = [. . .] dt + 2           a ωt (a ) − a ωt (a ) dZt + O( 3 )
                                                      ρ
                                                     Aσe L     
                                = [. . .] dt + 2           a − a ωt (a ) dZt + O( 3 ).
                                                      ρ

So,
                                                            
                                 σRt = σe + 2 Aσe L a − a ωt (a ) + O( 3 ).                               (A7)

Substituting this expression into (A6) yields the formula for the risk-free rate.



Proof of Proposition 3.5

Using the expression in (A7) and the fact that the leverage constraint binds only when
ωt (a )(a − a ) ≥ L, we see that

                               c
                                                       2
                              σRt ≤ σe + 2 Aσe a − a ωt (a )ωt (a ) + O( 3 ).

Note that

                                                                                          2
                 var[a] = (a )2 ωt (a ) + (a )2 ωt (a ) − a ωt (a ) + a ωt (a )

                            = (a )2 ωt (a )ωt (a ) + (a )2 ωt (a )ωt (a ) − 2a a ωt (a )ωt (a )
                                        2
                            = a − a ωt (a )ωt (a ).

Therefore,
                                                   c     u
                                                  σRt ≤ σRt + O(3 ).
Risk aversion and optimal portfolio policies                                                               30


Proof of Proposition 3.6

Assume that agents have risk aversion between −â to +â, with a general wealth distribution, ω(a).
Then,
                                       L−φ1t                                      â
                           0=                   (b + φ1t )ωt (a)da +                       L ωt (a)da.
                                    −â                                            L−φ1t

Diﬀerentiating the above with respect to L, we have:

                              L−φ1t
                                        ∂φ1t                                        ∂φ1t
                  0 =                        ωt (a)da + (L − φ1t )ωt (L − φ1t ) 1 −
                              −â        ∂L                                          ∂L
                                                                              â
                                                          ∂φ1t
                          −Lωt (L − φ1t ) 1 −                          +                 ωt (a)da,
                                                           ∂L              L−φ1t


which then implies that
                                                     " â
                                            ∂φ1t      L−φ ωt (a)da
                                                 = − " L−φ1t1t          ≤ 0.                             (A8)
                                             ∂L                ωt (a)da
                                                          −â


   Since the ﬁrst-order terms in expansions of the mean and the volatility of stock returns are
not aﬀected by the leverage constraint, this implies that asymptotically the interest rate in the
constrained economy is lowered and the equity premium is increased by tightening the borrowing
constraint.

   Now, we compute the volatility of the returns process:

                                                               â
                                            Pt        A
                                        d          =                adωt (a) + O(3 ).
                                            et        ρ       −â


The wealth of agents for whom the constraint does not bind changes according to

                        dWt (a)
                                        = [...] dt + [1 +  (a + φ1t )] σe dZt + O(2 ),
                         Wt (a)

                          dωt (a)
                                        = [...] dt +  (a + φ1t ) σe dZt + O(2 ).
                          ωt (a)

For the constrained agents,

                                        dωt (a)
                                                = [...] dt + Lσe dZt + O(2 ),
                                         ωt (a)
Risk aversion and optimal portfolio policies                                                                                      31


so,

                                              L−φ1t                                      â                  
          Pt                       Aσe
      d        = [. . .] dt + 2                        aωt (a) (a + φ1t ) da +                       Laωt (a)da dZt + O(3 ).
          et                        ρ         −â                                          L−φ1t


Thus,

                                   L−φ1t                             â                  
      ∂σRt,2           Aσe                              ∂φ1t
               = 2                           aωt (a)        da +                  aωt (a)da
       ∂L               ρ          −â                   ∂L         L−φ1t
                                                                                                                            
                                                                                          
                       Aσe 
                           
                                      L−φ1t
                                                                      ∂φ1t                       â                           
               = 2                             (a − L + φ1t ) ωt (a)       da +                       (a − L + φ1t ) ωt (a)da
                        ρ           −â                          ∂L
                                                                                          L−φ1t                        
                                                     (−)                                                    (+)
                                                                             (−)

               ≥ 0

where σRt = σe2 + 2 σRt,2 + O(3 ) and we have used (A8) to establish the second equality and to
determine the sign of ∂φ1t /∂L.
Risk aversion and optimal portfolio policies                                                                                                                            32




                                     Figure 1: Volatility of stock returns in a heterogeneous economy
                             The ratio of the conditional volatility of stock returns to the volatility of the endowment pro-
                             cess, σRt /σe , is plotted against the cross-sectional variance of portfolio holdings, vara [π(a)].
                             The solid line corresponds to the analytical asymptotic solution, the dashed line is com-
                             puted numerically. The following parameter values are used: µe = .02, σe = .03, ρ = .02.
                             There are two types of agents in the economy, a = 0 and a = 1. The small parameter 
                             takes values of .5, −.5, −1, and −4.



                                                   = .5                                                                                  = −.5
                             1.15                                                                                     1.15
Return volatility, σR / σe




                                                                                         Return volatility, σR / σe
                              1.1                                                                                      1.1




                             1.05                                                                                     1.05




                               1                                                                                        1
                                0          0.05               0.1           0.15                                         0          0.05               0.1             0.15
                                     Dispersion of portfolios, var [π(a)]                                                     Dispersion of portfolios, var [π(a)]
                                                                    a                                                                                        a




                                                   = −1                                                                                    = −4
                             1.15                                                                                        2

                                                                                                                       1.9

                                                                                                                       1.8
Return volatility, σR / σe




                                                                                                         e




                                                                                                                       1.7
                                                                                         Return volatility, σ / σ




                              1.1
                                                                                                         R




                                                                                                                       1.6

                                                                                                                       1.5

                                                                                                                       1.4
                             1.05
                                                                                                                       1.3

                                                                                                                       1.2

                                                                                                                       1.1

                               1                                                                                         1
                                0          0.05               0.1           0.15                                          0      0.1           0.2               0.3    0.4
                                     Dispersion of portfolios, vara[π(a)]                                                     Dispersion of portfolios, vara[π(a)]
Risk aversion and optimal portfolio policies                                                    33


                                               References

Campbell, John Y., 1993, Intertemporal asset pricing without consumption data, American Eco-
   nomic Review 83, 487-512.

Campbell, John Y. and Luis M. Viceira, 1999, Consumption and portfolio decisions when expected
   returns are time varying, Quarterly Journal of Economics 114, 433-495.

Chan, Yeung Lewis and Leonid Kogan, 2000, Heterogeneous preferences, catching up with the
   Joneses and the dynamics of asset prices, Working paper, U. of Pennsylvania.

Cox, John C. and Chi-fu Huang, 1989, Optional consumption and portfolio policies when assets
    prices follow a diﬀusion process, Journal of Economic Theory 49, 33-83.

Cuoco, Domenico, 1997, Optimal consumption and equilibrium prices with portfolio constraints
   and stochastic income, Journal of Economic Theory 72, 33-73.

Cuoco, Domenico, and Hua He, 1994a, Dynamic aggregation and computation of equilibria in
   ﬁnite-dimensional economies with incomplete ﬁnancial markets, Working paper, University
   of Pennsylvania.

Cuoco, Domenico and Hua He, 1994b, Dynamic equilibrium in inﬁnite-dimensional economies
   with incomplete ﬁnancial markets, Working paper, University of Pennsylvania.

Cvitanić, Jakša and Ioannis Karatzas, 1992, Convex duality in constrained portfolio optimization,
    Annals of Applied Probability 2, 767-818.

Den Haan, Wouter J. and Albert Marcet, 1994, Accuracy in simulations, The Review of Economic
    Studies 61.1, 3-17.

Detemple, Jerome and Shashidhar Murthy, 1997, Equilibrium asset prices and no-arbitrage with
    portfolio constraints, Review of Financial Studies 10.4, 1133-1174.

Duﬃe, Darrell and Larry G. Epstein, 1992, Stochastic Diﬀerential Utility, Econometrica, 60, 353-
   394.

Dumas, Bernard, 1989, Two-person dynamic equilibrium in the capital market, Review of Finan-
   cial Studies, 2, 157-188.

Grossman, Sanford J. and Jean-Luc Vila, 1992, Optimal dynamic trading with leverage con-
    straints, Journal of Financial and Quantitative Analysis 27, 151-168.

Hakansson, Nils H., 1971, On optimal myopic portfolio policies with and without serial correlation
    of yields, Journal of Business 44, 324-334.

Heaton, John and Deborah Lucas, 1996, Evaluating the eﬀects of incomplete markets on risk
    sharing and asset pricing, Journal of Political Economy 104(3), 443-487.

Judd, Kenneth L., 1996, Approximation, perturbation, and projection methods for economic
    growth models, in H. Amman, D. Kendrick, and J. Rust, eds., Handbook of Computational
    Economics, Elsevier, Amsterdam.
Risk aversion and optimal portfolio policies                                                    34


Judd, Kenneth L., 1998, Numerical Methods in Economics, MIT Press, Cambridge, MA.

Kim, Tong Suk and Edward Omberg, 1996, Dynamic nonmyopic portfolio behavior, Review of
   Financial Studies 9, 141-161.

Kreps, David and E. Porteus, 1978, Temporal resolution of uncertainty and dynamic choice the-
    ory,” Econometrica, 46, 185-200.

Leland, Hayne (1968), Dynamic portfolio theory, Ph.D. thesis, Harvard University.

Liu, Jun, 1998, Portfolio selection in stochastic environments, Working paper, Stanford University.

Marcet, Albert and Kenneth Singleton, 1999, Equilibrium asset prices and savings of heteroge-
   neous agents in the presence of incomplete markets and portfolio constraints, Macroeconomic
   Dynamics, forthcoming.

Merton, Robert C., 1969, Lifetime portfolio selection under uncertainty: The continuous time
    case, Review of Economics and Statistics 51, 247-257.

Merton, Robert C., 1971, Optimum consumption and portfolio rules in a continuous time model,
    Journal of Economic Theory 3, 373-413.

Mossin, Jan, 1968, Optimal multiperiod portfolio policies, Journal of Business 41, 215-229.

Wachter, Jessica, 1998, Portfolio and consumption decisions under mean-reverting returns: An
   exact solution for complete markets, Working paper, Harvard University.

Wang, Jiang, 1996, The term structure of interest rates in a pure exchange economy with hetero-
   geneous investors , Journal of Financial Economics 41.1,75-110.
