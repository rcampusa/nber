                                NBER WORKING PAPER SERIES




              EVALUATING PORTFOLIO POLICIES: A DUALITY APPROACH

                                           Martin B. Haugh
                                            Leonid Kogan
                                             Jiang Wang

                                         Working Paper 9861
                                 http://www.nber.org/papers/w9861


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      July 2003




The views expressed herein are those of the authors and not necessarily those of the National Bureau of
Economic Research

©2003 by Martin B. Haugh, Leonid Kogan, and Jiang Wang. All rights reserved. Short sections of text not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit including ©
notice, is given to the source.
Evaluating Portfolio Policies: A Duality Approach
Martin B. Haugh, Leonid Kogan, and Jiang Wang
NBER Working Paper No. 9861
July 2003
JEL No. G11, C63

                                             ABSTRACT

The performance of a given portfolio policy can in principle be evaluated by comparing its expected
utility with that of the optimal policy. Unfortunately, the optimal policy is usually not computable

in which case a direct comparison is impossible. In this paper we solve this problem by using the

given portfolio policy to construct an upper bound on the unknown maximum expected utility. This
construction is based on a dual formulation of the portfolio optimization problem. When the upper

bound is close to the expected utility achieved by the given portfolio policy, the potential utility loss
of this policy is guaranteed to be small. Our algorithm can be used to evaluate portfolio policies in

models with incomplete markets and position constraints. We illustrate our methodology by
analyzing the static and myopic policies in markets with return predictability and constraints on
short sales and borrowing.

Martin B. Haugh                     Leonid Kogan                        Jiang Wang
Department of IE and OR             Sloan school of Management          Sloan School of Management
Columbia University                 MIT                                 MIT
New York, NY 10027                  Cambridge, MA 02142                 Cambridge, MA 02142
martin.haugh@columbia.edu           and NBER                            and NBER
                                    lkogan@mit.edu                      wangj@mit.edu
1    Introduction

Optimal portfolio choice is one of the central subjects in ﬁnance (see e.g., Merton, 1990). Yet
analytical solutions are known only in a few special cases, under restrictive assumptions on the
market structure and/or the investor’s utility function. Most problems of practical interest cannot
be solved in closed form and must be analyzed using approximations. But how costly are the
approximation errors of a candidate portfolio policy to the investor? To answer this question,
one must compare the expected utility under the candidate policy with the expected utility under
the optimal policy. Such a direct comparison is impossible when the optimal policy cannot be
computed explicitly. In this paper, we construct an upper bound on the expected utility under the
optimal policy based on the dual formulation of the portfolio optimization problem developed by
Cvitanic and Karatzas (1992). When the upper bound is close to the expected utility achieved by
a candidate portfolio policy, the utility cost of choosing such a suboptimal policy is guaranteed to
be small. Our method applies to models with incomplete markets and position constraints.
The most general class of tractable problems are those where the ﬁnancial market is dynamically
complete. Market completeness allows one to use the martingale techniques to restate the portfolio
choice problem in an equivalent static form. This was ﬁrst shown by Cox and Huang (1989),
Karatzas, Lehoczky, Sethi, and Pliska (1986) and Shreve (1986). The static problem often leads
to analytical solutions and is also amenable to simulation techniques (see e.g., Detemple, Garcia,
and Rindisbacher 2000). When the ﬁnancial market is incomplete due to position constraints or
non-spanned risks, explicit solutions have been obtained for only a few special cases. For example,
Kim and Omberg (1996) solve the portfolio choice problem assuming an aﬃne non-spanned process
for the market price of risk and no portfolio constraints (with power utility function). Liu (1998)
extends their results to multi-variate problems.
The martingale approach has been generalized by a number of researchers using stochastic dual-
ity theory to allow for portfolio constraints and non-spanned risks. They include Cuoco (1997),
Cvitanic and Karatzas (1992), He and Pearson (1991), and Karatzas, Lehoczky, Shreve, and Xu
(1991), among others. However, explicit solutions are rare. Notable exceptions are problems with
logarithmic preferences, or problems with constant relative risk aversion (CRRA) preferences and
deterministic investment opportunity set (see, for example, Karatzas and Shreve 1998, Section 6.6).
For most portfolio choice problems, explicit solutions are not available and one must rely on nu-
merical approximations. Various types of approximate methods have been used in the literature.
They include the log-linear analytical approximations of Campbell and Viceira (1999, 2002) (see
also Campbell, Chan and Viceira 2002 and Chacko and Viceira 2002), ﬁnite-diﬀerence PDE solu-
tion methods (e.g., Brennan 1998, Brennan, Schwartz, and Lagnado 1997, Brennan and Xia 2001,
and Xia 2001), Markov-chain approximations (e.g., Munk, 1999), numerical dynamic programming
based on state-space discretization for discrete-time problems (e.g., Ait-Sahalia and Brandt 2001,
Balduzzi and Lynch 1999, Brandt 1999, Barberis 2000, Dammon, Spatt, and Zhang 2000, and
Lynch 2001) and the approximate dynamic programming approach of Brandt, Goyal, and Santa-
Clara (2001). Other techniques for solving dynamic optimization problems that are applicable to
portfolio choice problems are described in Judd (1996) and Rust (1996).
An important limitation of the approximate solution methods is that it is usually diﬃcult to eval-
uate the accuracy of the obtained approximations. Judd (1996) points out that there are few
theoretical results on the convergence properties of the numerical algorithms used in economic ap-
plications and even when such results are available, asymptotic convergence does not guarantee

                                                 1
the accuracy of any given approximation. Moreover, some of the existing approaches are based on
a single approximation, rather than a sequence of successive approximation (e.g., the log-normal
approximation method used by Campbell and Viceira, 1999), and for these the notion of asymp-
totic convergence is not even applicable. Den Haan and Marcet (1994) and Judd (1996) suggest
procedures for testing how accurately the ﬁrst-order optimality conditions are satisﬁed. Such tests,
however, provide little information about the economic impact of the approximation errors.
The method we propose allows us to evaluate the quality of approximations for portfolio choice
problems by providing an upper bound on the utility loss associated with an approximate solution.
If a sequence of progressively reﬁned approximate portfolio policies were generated using an iterative
numerical algorithm then our method could be used to determine at what point the quality of the
approximation becomes acceptable. At that point the algorithm could then be terminated. Since
our approach does not depend on the particular method used to construct the approximate policy
and value function, it can be applied to any approximate solution method. Moreover, in principle
our methodology could be used to guide the numerical algorithm as well. In this paper, however,
we will focus on evaluating the quality of a ﬁxed portfolio policy and not attempt to construct and
evaluate a sequence of approximations.
Our approach is based on the duality formulation of the portfolio choice problem proposed by
Cvitanic and Karatzas (1992). For a given portfolio choice problem, which is subject to position
constraints, we can deﬁne a ﬁctitious, unconstrained problem with modiﬁed price processes such
that the maximum expected utility achieved in the ﬁctitious problem is at least as high as in
the original problem. Under certain assumptions, the constructed upper bound can be shown
to be tight, i.e., to coincide with the maximum expected utility for the original problem. Since
the ﬁctitious problem is unconstrained, we can solve it explicitly using the well-known martingale
techniques of Cox and Huang (1989). The solution gives an upper bound on the maximum expected
utility (the value function) of the original problem. (Haugh and Kogan, 2003, develop a similar
algorithm for the problem of pricing American options, which is an optimal stopping problem. As
in this paper, the upper bound on the value function is constructed using a dual formulation of the
original problem.)
In order to evaluate an approximation for the optimal policy and value function, we can use this up-
per bound when the value function itself is not available. The goal is to make the upper bound tight
by properly choosing the ﬁctitious problem, in particular the ﬁctitious market with the modiﬁed
price processes. Our key insight is to perform such a modiﬁcation using the information contained
in the approximate portfolio policy to be evaluated. In particular, one must ﬁrst use the approxi-
mation for the portfolio policy to ﬁnd an approximate value function. Then, the approximation to
the value function is used to deﬁne the candidate return processes for all the assets in the ﬁctitious
ﬁnancial market, as implied by the optimality conditions of the original portfolio choice problem.
The implied return processes in general do not qualify to be the return processes in the ﬁctitious
problem. Our next step is to choose the qualiﬁed ﬁctitious return processes that are “closest” to
the candidate processes. We then solve the unconstrained optimization problem in the ﬁctitious
market. The value function of this ﬁctitious problem gives an upper bound on the value function
of the original problem.
We illustrate our method with a few simple numerical examples. These are not designed to be
fully realistic, but rather serve to demonstrate the potential of our algorithm. Since it is not the
purpose of this paper to develop new schemes for computing approximate portfolio policies, to


                                                  2
simplify implementation, we adopt very simple, analytical approximations to the portfolio policies.
In particular, we evaluate the quality of static and myopic portfolio policies in a market with return
predictability under constraints on short sales and borrowing. A static portfolio policy is obtained
by ignoring time-variation in the investment opportunity set and ﬁxing the instantaneous moments
of stock returns at their long-run average values. To obtain a myopic policy, we assume at any
point in time that the investment opportunity will remain constant thereafter. By comparing the
expected utility under the static strategy with our upper bound one can measure the economic
importance of return predictability. A small gap between the upper bound and the value function
under the static policy would indicate that return predictability is not economically important for
the problem at hand.
Similar logic can be applied to the myopic policy. A small gap under the myopic policy indicates
that the hedging component of the optimal portfolio policy has little impact on the expected utility.
The analysis of the myopic policy is particularly relevant since the existing literature analyzing the
patterns of predictability in stock returns commonly ignores the hedging component of portfolio
policies (see, for example, Johannes, Polson and Stroud 2002, Kandel and Stambaugh 1996, Pastor
2000, Pastor and Stambaugh 2000, and Stambaugh 1999). This is motivated by the fact that for
most realistic problems the optimal portfolio policy cannot be computed numerically due to the
curse of dimensionality and analytical solutions are only available for highly restrictive settings,
which typically rule out portfolio constraints and limit the range of possible speciﬁcations for the
return processes. Several authors have argued in the context of speciﬁc applications that hedging
demand is relatively small (e.g., Ait-Sahalia and Brandt 2001, Ang and Bekaert, 2000, Brandt 1999,
Chacko and Viceira 2002 and Gomes 2001). Based on this, one may be tempted to assume that for
“similar” problems, hedging demand can be safely ignored. However, we know that this cannot be
the case in general and for important classes of problems hedging demand is crucial. These classes
include long-horizon problems (Barberis 2000, and Campbell and Viceira 1999, 2002) and problems
with non-linear dynamics or non-standard preferences (Chan and Kogan 2002). Using our method,
one can verify that for a particular problem under consideration ignoring the hedging component
of the optimal portfolio policy has little eﬀect on the expected utility.
The rest of the paper is organized as follows. Section 2 formulates the portfolio choice problem.
Section 3 reviews the duality theory while Section 4 describes the algorithm for constructing the
upper bound on the optimal expected utility. Section 5 illustrates our approach for several types
of portfolio choice problems and approximate strategies. We conclude in Section 6.



2    The Model

We now formulate a portfolio choice problem under incomplete markets and portfolio constraints.


The investment opportunity set

There are N stocks and an instantaneously riskfree bond. The vector of stock prices is denoted
by Pt = (P1t , . . . , PN t ) and the instantaneously riskfree rate of return on the bond is denoted by
rt . Without loss of generality, we assume that the stocks pay no dividends. The instantaneous


                                                  3
moments of asset returns depend on the M -dimensional vector of state variables Xt :

                                     rt = r(Xt )                                                       (1a)

                                   dPt = Pt [µP (Xt ) dt + ΣP (Xt ) dBt ]                              (1b)

                                  dXt = µX (Xt ) dt + ΣX (Xt ) dBt                                     (1c)

where P0 = X0 = 0, Bt = (B1t , ..., BN t ) is a vector of N independent Brownian motions, µP and
µX are N - and M -dimensional drift vectors, and ΣP and ΣX are diﬀusion matrices of dimension N
by N and M by N , respectively. We assume that the diﬀusion matrix of the stock return process
ΣP is lower-triangular and non-degenerate: x ΣP ΣP  x ≥ x2 for all x and some  > 0. Then,
one can deﬁne a process ηt , given by

                                           ηt = Σ−1
                                                 P t (µP t − rt )

In a market without portfolio constraints, ηt corresponds to the vector of instantaneous market
prices of risk of the N stocks (see, e.g., Duﬃe 1996, Section 6.G). We adopt a standard assumption
that our return generating process is suﬃciently well behaved, so that the process ηt is square-
integrable:
                                             T          
                                         E0      ηt 2 dt < ∞.
                                               0


Portfolio constraints

A portfolio consists of positions in the N stocks and the riskfree bond. We denote the proportional
holdings of risky assets in the total portfolio value by θt = (θ1t , . . . , θN t ). To rule out arbitrage,
                                                                                      T
we require the portfolio policy to satisfy a square integrability condition: 0 θt 2 dt < ∞ almost
surely. The value of the portfolio changes according to
                                                                            
                         dWt = Wt rt + θt (µP t − rt ) dt + θt ΣP t dBt .                              (2)

We assume that the portfolio shares are restricted to lie in a closed convex set K, containing the
zero vector:

                                                   θt ∈ K.                                              (3)

For example, if short sales are not allowed, then the constraint set takes form K = {θ : θ ≥ 0}.
If in addition to prohibiting short sales borrowing is not allowed, then K = {θ : θ ≥ 0, 1 θ ≤ 1}
where 1 = (1, . . . , 1).


The objective function

We assume that the portfolio policy is chosen to maximize the expected utility of wealth at the
terminal date T , E0 [U (WT )]. The function U (W ) is assumed to be strictly monotone with positive
slope, concave and smooth. Moreover, it is assumed to satisfy the Inada conditions at zero and

                                                     4
inﬁnity: limW →0 U  (W ) = ∞ and limW →∞ U  (W ) = 0. In our numerical examples, we use the
utility function with constant relative risk aversion (CRRA) so that U (W ) = W 1−γ /(1 − γ).
In summary, the portfolio choice problem is to solve for

                        V0 ≡ sup E0 [U (WT )] subject to           (1), (2) and (3)              (P)
                             {θt }

where V0 denotes the value function at 0.



3    Review of the Duality Theory

In this section we brieﬂy review the duality approach to the constrained portfolio optimization
problem, following Cvitanic and Karatzas (1992) and Schroder and Skiadas (2003). We build on
these theoretical results to construct bounds on the performance of portfolio policies in Section 4
below.
Starting with the portfolio choice problem (P), we can deﬁne a ﬁctitious problem (P (ν) ), based
on a diﬀerent ﬁnancial market and without the portfolio constraints. First we deﬁne the support
function of K, δ(·) : RN → R ∪ ∞, by

                                        δ(ν) ≡ sup (−ν  x).                                     (4)
                                                    x∈K

The eﬀective domain of the support function is given by

                                       K ≡ {ν : δ(ν) < ∞}.                                       (5)

Because the constraint set K is convex and contains zero, the support function is continuous and
bounded from below on its eﬀective domain K. We then deﬁne the set D of Ft -adapted RN valued
processes to be
                                             T                T         
                                                                          2
            D ≡ νt , 0 ≤ t ≤ T : νt ∈ K, E0      δ(νt ) dt + E0      νt  dt < ∞ .           (6)
                                                     0                     0

For each process ν in D, we deﬁne a ﬁctitious market M (ν) , in which the N stocks and the riskfree
bond are traded. The diﬀusion matrix of stock returns in M (ν) is the same as in the original market.
However, the riskfree rate and the vector of expected stock returns are diﬀerent. In particular, the
riskfree rate process and the market price of risk in the ﬁctitious market are deﬁned respectively
by

                                            (ν)
                                         rt       = rt + δ(νt )                                 (7a)
                                            (ν)
                                         ηt       = ηt + Σ−1
                                                          P t νt                                (7b)

                                                                               (ν)
where δ(ν) is the support function deﬁned in (4). We assume that ηt is square-integrable. Fol-
                                                              (ν)
lowing Cox and Huang (1989), the state-price density process πt in the ﬁctitious market is given



                                                         5
by
                                             t                              t                               t
                        (ν)                                    1                                                     
                       πt     = exp −             rs(ν) ds   −                    ηs(ν) ηs(ν) ds   −               ηs(ν) dBs                    (8)
                                          0                    2          0                                0

and the vector of expected returns is given by
                                                      (ν)           (ν)                  (ν)
                                                    µ P t = rt            + ΣP t ηt .

The dynamic portfolio choice problem in the ﬁctitious market without position constraints can be
equivalently formulated in a static form (e.g., Cox and Huang, 1989, Karatzas and Shreve, 1998,
Section 3):
                                                                    
                                                               (ν)
                   V (ν) ≡ sup E0 [U (WT )] subject to E0 πT WT ≤ W0 .                     (P (ν) )
                                  {WT }


Due to its static nature, the problem (P (ν) ) is easy to solve. For example, when the utility function
is of the CRRA type with relative risk aversion γ so that U (W ) = W 1−γ /(1− γ), the corresponding
value function in the ﬁctitious market is given explicitly by
                                                                  γ
                                    (ν)     W01−γ              γ−1
                                                            (ν) γ
                                  V0    =             E0 π T          .                             (9)
                                             1−γ

It is easy to see that for any admissible choice of ν ∈ D, the value function in (9) gives an upper
bound for the optimal value function of the original problem. In the ﬁctitious market, the wealth
dynamics of the portfolio are given by
                                                                             
                            (ν)    (ν)    (ν)           (ν)
                         dWt = Wt        rt + θt ΣP t ηt     dt + θt ΣP t dBt                (10)

so that

           dWt
                 (ν)
                           dWt                                             
                                    (ν)                (ν)
               (ν)
                       −       =   rt − rt + θt ΣP t ηt − ηt dt = δ(νt ) + θt νt dt.
            Wt              Wt

                                                                                                                           (ν)
The last expression is non-negative according to (4) since θt ∈ K. Thus, Wt                                                      ≥ Wt ∀ t ∈ [0, T ]
and
                                                                (ν)
                                                               V0         ≥ V0 .                                                              (11)

In this paper, we use this property of the ﬁctitious problem (P (ν) ) to construct an upper bound on
the value function of the original problem (P).
Results in Schroder and Skiadas (2003) imply that if the original optimization problem has a
solution, then the upper bound is “tight,” i.e., the value function of the ﬁctitious problem (P (ν) )
coincides with the value function of the original problem (P):
                                                      (ν ∗ )
                                                    V0         ≡ inf V (ν) = V0 .                                                             (12)
                                                                    {ν}

(see Schroder and Skiadas, 2003, Proposition 3(b) and Theorems 7 and 9). The above equality

                                                                      6
                                                                         (ν ∗ )
holds for all times, and not just at time 0, i.e., Vt    = Vt . Cvitanic and Karatzas (1992) have
shown that the solution to the original problem exists under additional restrictions on the utility
function, most importantly that the relative risk aversion does not exceed one. Cuoco (1997) proves
a more general existence result, imposing minimal restrictions on the utility function.



4    The Performance Bound

The theoretical duality results of Section 3 suggest that one can construct an upper bound on the
value function of the portfolio choice problem (P) by computing the value function of any ﬁctitious
problem (P (ν) ). The ﬁctitious market is deﬁned by the process νt as in (7). Of course, one can
pick any ﬁctitious market from the admissible set D to compute an upper bound. Such a bound
is uninformative if it is too loose. Since our objective is to evaluate a particular candidate policy,
we can construct a process νt based on such a policy to obtain tighter bounds. The solution to
the portfolio choice problem under the ﬁctitious market deﬁned by νt then gives us a performance
bound on the candidate policy.
In order to construct the ﬁctitious market as deﬁned by νt , we ﬁrst use the solution to the dual
problem (which also gives the solution to the original problem) to establish the link between the
                                           ∗
optimal policy θ ∗ and value function V (ν ) , and the corresponding ﬁctitious asset price processes,
as deﬁned by ν ∗ . Not knowing the optimal portfolio policy and value function, we instead use
their approximations to obtain the candidate process for ν ∗ , which is denoted by ν̃. This candidate
process in general does not belong to D and cannot be used to deﬁne a ﬁctitious problem. Instead,
we search for a qualiﬁed process ν in D, which is “closest” to ν̃. We then use ν as an approximation
to ν ∗ to deﬁne the ﬁctitious problem in (P (ν) ). Since ν ∈ D, the solution to the corresponding
unconstrained problem in M (ν ) provides a valid performance bound for the candidate policy.
According to the dynamic programming principle,
                                                                                                   (ν ∗ )
                                                                                                                  
                          (ν ∗ )                                                                   πT
                 Vt =   Vt         = sup Et [U (WT )]                 subject to          Et        (ν ∗ )
                                                                                                             WT       ≤ Wt .
                                     {WT }                                                         πt
                                                                                           (ν ∗ )       (ν ∗ )
The ﬁrst-order optimality conditions then imply U  (WT ) = λt πT /πt         where λt is the Lagrange
multiplier on the time-t budget constraint. On the other hand, according to the envelope condition,
the partial derivative of the value function with respect to the portfolio value satisﬁes ∂Vt /∂Wt = λt
                                                                                            (ν ∗ ) (ν ∗ )
(see Karatzas and Shreve 1998, Section 3.7, Theorem 7.7 for a formal proof). Thus, πT /πt                 =
U  (WT )/(∂Vt /∂Wt ) and hence
                                               (ν ∗ )
                                             πs             ∂Vs /∂Ws
                                              (ν ∗ )
                                                        =            ,             ∀ s ≥ t.
                                             πt             ∂Vt /∂Wt

The above equality implies that

                                                            (ν ∗ )                ∂Vt
                                                  d ln πt            = d ln           .                                        (13)
                                                                                  ∂Wt
                                                        (ν ∗ )
In particular, the stochastic part of d ln πt                    is equal to the stochastic part of d ln ∂Vt /∂Wt . If Vt

                                                                     7
is smooth, Ito’s lemma, and equations (8) and (2) imply that
                                                                                        −1
                  (ν ∗ )                ∂ 2 Vt /∂Wt2                         ∂Vt                     ∂ 2 Vt
                 ηt        = −Wt                             Σ    ∗
                                                              P t θt −                       Σ
                                                                                              Xt                      (14)
                                         ∂Vt /∂Wt                            ∂Wt                    ∂Wt ∂Xt

where θt∗ denotes the optimal portfolio policy for the original problem. In the special but important
                                                                                                    (ν ∗ )
case of a CRRA utility function (which we analyze in more detail below) the expression for ηt
simpliﬁes. In particular, the ﬁrst term in (14) becomes equal to γΣ         ∗
                                                                        P t θt , where γ is the relative
risk aversion coeﬃcient of the utility function, and one only needs to compute the ﬁrst derivative
of the value function with respect to the state variables Xt to evaluate the second term in (14).
This simpliﬁes numerical implementation, since it is generally easier to estimate ﬁrst-order than
second-order partial derivatives of the value function.
Given an approximation to the optimal portfolio policy θt , one can compute the corresponding
approximation to the value function, Vt , deﬁned as the conditional expectation of the utility of ter-
minal wealth, under the portfolio policy θt . We can then construct a process ν as an approximation
to ν ∗ , using (14). Approximations to the portfolio policy and value function can be obtained using
a variety of methods (e.g., Brandt, Goyal, Santa-Clara, 2001). In this paper, we take θt as given
and use it to construct an upper bound on the unknown true value function V0 .
Assuming that the approximate value function V is suﬃciently smooth, we can replace Vt and θt∗
in (14) with Vt and θt and obtain
                                                                               −1                       
                   (ν)                 ∂ 2 Vt /∂Wt2                        ∂ Vt                     ∂ 2 Vt
                  ηt       = −Wt                          Σ
                                                           P t θt −                     Σ
                                                                                         Xt                      .    (15)
                                       ∂ Vt /∂Wt                           ∂Wt                     ∂Wt ∂Xt

We then deﬁne νt as a solution to (7b).
Obviously, ηt is a candidate for the market price of risk in the ﬁctitious market. However, there is
no guarantee that ηt and the corresponding process νt belong to the feasible set D deﬁned by (6).
In fact, as we illustrate below, for many important classes of problems the support function δ(νt )
may be inﬁnite for some values of its argument. Thus, we look for a price-of-risk process ηt ∈ D
that is “close” to ηt . To guarantee that ηt ∈ D without sacriﬁcing tractability, we impose two
constraints

                                                       
                                                        η − η ≤ A1                                                  (16a)

                                                                 ν ) ≤ A2
                                                               δ(                                                   (16b)

where A1 and A2 are positive constants that can be taken to be arbitrarily large. The condition
(16a) implies that the process νt is square-integrable, since we have assumed that ηt is square
                                    
                η − η2 = ν ΣP −1 ΣP −1 ν ≥ A
integrable and                                    ν 2 for some A > 0.
We now deﬁne ηt and νt as a solution of the following problem:

                                                            η − η2
                                                       min                                                          (17)
                                                          ν, η

subject to δ(ν) < ∞, (7b), (16a) and (16b).
The value of ηt and ν can be computed quite easily for many important classes of portfolio choice

                                                                   8
problems. In particular, we consider the three examples mentioned in Section 2.


Incomplete markets

Assume that only the ﬁrst L stocks are traded. The positions in the remaining N − L stocks are
restricted to zero. In this case the set of feasible portfolio policies is given by

                                       K = {θ | θi = 0 for L < i ≤ N }                                 (18)

and hence the support function δ(ν) is equal to zero if νi = 0, 1 ≤ i ≤ L and is inﬁnite otherwise.
Thus, as long as νi = 0, 1 ≤ i ≤ L, the constraint (16b) does not need to be imposed explicitly. To
ﬁnd η and ν we must solve

                                                      η − η2
                                                 min                                                 (19)
                                                   η, ν

subject to

                                                 η = η + ΣP −1 ν
                                                νi = 0,          1≤i≤L
                                                 2
                                         
                                          η − η        ≤   A21

The diﬀusion matrix ΣP is lower triangular and so is its inverse. Using this, the solution can be
expressed explicitly as

                                 ηi = ηi ,          1≤i≤L
                                 ηj     = ηj + a(ηj − ηj ),        L<j≤N
                                           η − η)
                                  ν = ΣP (

where
                                                                1/2 
                                          A21 − η − η2(L)                              L
                                                                                         
                   a = min 1,                                        ,   η2(L)   =         ηi2 .
                                       η − η2 − η − η2(L)                            i=1

Note that when the constant A1 is very large, it will invariably be the case that a = 1, and therefore
ηj = ηj for L < j ≤ N .


Incomplete markets and no short sales

Consider the market in which only the ﬁrst L stocks can be traded and no short sales (of the stocks)
are allowed. The set of admissible portfolios is given by

                              K = {θ | θ ≥ 0, θi = 0 for L < i ≤ N }                                   (20)

and the support function is equal to zero if νi ≥ 0, i = 1, . . . , L and is inﬁnite otherwise. As in
the previous case, the constraint (16b) is automatically satisﬁed. Thus, ν can be determined as a


                                                            9
solution of a standard quadratic programming problem:

                                                  η − η2
                                             min                                             (21)
                                                ν, η

subject to

                                            η = η + ΣP −1 ν
                                          νi ≥ 0,                1≤i≤L
                                            2
                                   
                                    η − η          ≤     A21 .


Incomplete markets, no short sales, and no borrowing

Consider the same market as in the previous case, but no short sales and borrowing are allowed.
Then the set of admissible portfolios is given by

                         K = {θ | θ ≥ 0, 1 θ ≤ 1, θi = 0 for L < i ≤ N }.                     (22)

The support function is given by δ(ν) = max(0, −ν1 , . . . , −νL ), which is ﬁnite for any vector ν.
Because in this case δ(ν) ≤ ν, the relation ν = ΣP (η − η) ≤ ΣP A1 (see 16a, 16b) implies
that as long as A2 is suﬃciently large compared to A1 , one only needs to impose (16a) and (16b)
is redundant. Thus, one needs to solve the following problem:

                                                 η − η2
                                            min                                              (23)
                                             η, ν

subject to

                                                 η = η + ΣP −1 ν
                                      η − η2 ≤ A21 .
                                     

Then the ﬁctitious market is described by

                                                                A1
                                η = η + min 1,                         (η − η)
                                                              η − η
                                        η − η) .
                               ν = ΣP (

Again, by setting A1 to be suﬃciently large we will invariably obtain η = η.



5     Numerical Experiments

The method described in the previous section can be applied to various problems of portfolio choice.
In this section we illustrate its performance based on several numerical experiments. But ﬁrst we
summarize our algorithm as a sequence of four basic steps:

    1. Start with an approximation to the optimal portfolio policy of the original problem, and the


                                                         10
     corresponding approximation to the value function, which can be obtained using a variety of
     methods. In this paper we simply assume that such approximations are available.

  2. Use the approximate portfolio policy and partial derivatives of the approximate value function
     to construct a process ηt according to the explicit formula (15). The process ηt is a candidate
     for the market price of risk in the ﬁctitious market.

  3. Construct a process ηt that is close to ηt and satisﬁes the conditions for the market price risk
     of a ﬁctitious market in the dual problem. This involves solving a quadratic optimization
     problem (17).

  4. Compute the value function from the static problem (P (ν) ) in the resulting ﬁctitious market
     deﬁned by the market price of risk process ηt . This can be accomplished eﬃciently using
     Monte Carlo simulation. This results in an upper bound on the value function of the original
     problem.

The lower bound on the value function is obtained by simulating the terminal wealth distribution
under the approximate portfolio strategy.


Calibration

In our numerical experiments we assume that the utility function is of the constant relative risk
aversion (CRRA) type so that U (W ) = W 1−γ /(1 − γ). We consider three values for the relative
risk aversion parameter γ = 1.5, 3, and 5. We also consider two values for the problem horizon:
T = 5 and T = 10 years.
We specify our model as a continuous-time version of the discrete-time market model in Lynch
(2001). He considers a ﬁnancial market with three traded risky assets and a single state variable.
To represent the same market in our framework, we assume that there is a total of four risky assets,
the ﬁrst three of which are traded, and a single state variable, i.e., we consider an incomplete market
with N = 4, M = 1, and L = 3, meaning that the ﬁrst three stocks can be traded.
The dynamics of asset returns is given by

                                   rt = r                                                        (24a)

                                 dPt = Pt [(µ0 + Xt µ1 ) dt + ΣP dBt ]                           (24b)

                                 dXt = −kXt dt + ΣX dBt                                          (24c)

The diﬀusion matrix ΣX is of size 1 by 4 and we assume that the fourth row of the matrix ΣP
coincides with ΣX . This assumption is made for convenience, and it economizes on the number of
parameters to be reported. Note that since the fourth risky asset is not traded, one can specify the
fourth row of ΣP arbitrarily, as long as the matrix ΣP satisﬁes the necessary regularity conditions.
We set the initial value of the state variable to zero, X0 = 0, in all numerical examples below.
Lynch considers two choices for the state variable X: the dividend yield and the term spread.
The dividend yield captures the rate at which dividends are paid out, as a fraction of the total

                                                  11
stock market value. Speciﬁcally, Lynch uses a continuously compounded twelve-month yield on the
value-weighted NYSE index. The term spread is the diﬀerence in yields between twenty-year and
one-month Treasury securities. Both of these predictive variables are normalized to have zero mean
and unit variance. He also considers two sets of risky assets: three portfolios obtained by sorting
stocks on their size or on their book-to-market ratio. Details of the procedure are reported in Lynch
(2001), here we are interested only in the parameters of the stock return process, as summarized in
Tables 1 and 2 of Lynch (2001). Thus, by considering two choices of risky assets and two choices
of the predictive variable, we have four sets of calibrated parameter values. These are reported in
Table 1 below. We set the riskfree rate r = 0.01 throughout.


Approximate policies

As in Lynch (2001), we consider two types of portfolio policies. The ﬁrst policy, which we call
“static”, ignores predictability of stock returns. It is deﬁned using the unconditional average
returns instead of the time-varying conditional expected returns on the stocks. Speciﬁcally,
                                             1 
               θtstatic = arg max (µ                  
                                    0 − r)θ − γ θ ΣP ΣP θ,          subject to θ ∈ K.            (25)
                               θ             2
This is an optimal portfolio policy in a dynamic model with a constant investment opportunity set
and cone constraints on portfolio positions, e.g., (Karatzas and Shreve, 1998, Sec. 6.6).
As we discussed in the introduction, a small gap between the upper bound and the expected
utility under the static policy indicates that return predictability is not economically important
for the problem at hand. The reverse, however, is not necessarily true — when the upper bound
is signiﬁcantly higher than the lower bound, we cannot formally conclude that the static portfolio
policy is signiﬁcantly inferior to the optimal strategy. We discuss these issues in more detail in the
context of the numerical examples below.
The second portfolio policy we consider is the “myopic” policy. It is deﬁned in the same way as a
static policy, except the instantaneous moments of asset returns are ﬁxed at their current values,
as opposed to their long-run average values:
                                              1 
              θtmyopic = arg max (µ                    
                                   P t − r)θ − γ θ ΣP ΣP θ,         subject to θ ∈ K.            (26)
                              θ               2
The approximate portfolio policy in (26) ignores the hedging component of the optimal trading
strategy. By comparing the corresponding expected utility with an upper bound we will be able
to evaluate the economic importance of hedging as a component of the portfolio policy. In a
portfolio choice problem similar to ours, Lynch ﬁnds a signiﬁcant hedging demand for some of the
parameter values he considers. In particular, for the third parameter set when there are no portfolio
constraints, Lynch ﬁnds that the optimal policy is very diﬀerent from the myopic approximation.
Below we will show that even though the myopic strategy may be far from optimal in terms of
actual portfolio holdings, the utility loss due to using it may not be very large. As we previously
emphasized, the advantage of our method is that such results can be obtained without knowing the
optimal strategy, which would be the case for most realistic applications.
Our algorithm for evaluating portfolio strategies relies on an approximate value function Vt . In
general, one has to estimate Vt as the conditional expectation of the utility of terminal wealth under

                                                 12
the approximate strategy θt . This could be done for example using standard regression methods.
Instead, we choose a particularly straightforward closed-form expression for Vt . This simpliﬁes
computations, while still allowing us to illustrate the conceptual steps involved in estimating the
upper bound on the value function. The cost of using a simpliﬁed closed-form formula for Vt is a
potentially wider gap between the upper bound and the true value function.
Because the utility function is of CRRA type, the true value function has a homothetic functional
form, Vt = g(t, Xt )Wt1−γ . As a drastic simpliﬁcation, we ignore the dependence of the value function
on the state variable and set Vt = g(t)Wt1−γ . The exact form of the function g(t) does not aﬀect the
speciﬁcation of the artiﬁcial market below. Note that removing the dependence of the approximate
value function on X does not eliminate it from the price of risk in the ﬁctitious market, given by
(14). This is because the leading term in that expression depends on Xt through the approximate
portfolio policy, θt .
We will see in the numerical examples below, even such a simplistic approximation to the value
function can lead to informative bounds on the true value function. However, in realistic practical
applications, one should use more accurate approximations to the value function to achieve tighter
bounds whenever possible.


Simulation

For each of the approximate portfolio strategies, we estimate the corresponding expected utility
of terminal wealth as well as the upper bound on the true value function using Monte Carlo
simulation. The expected utility under the suboptimal portfolio policy provides a lower bound
on the true value function of the problem. We estimate the former by simulating independently
100, 000 or 1, 000, 000 paths of stock prices and state variables according to (24a)–(24c). We used
100, 000 paths to estimate the bounds for the problems with constraints on short sales only as
the corresponding quadratic subproblem in that case needs to be solved numerically. We used
1, 000, 000 paths for all other cases. (The problems were solved using Matlab so the computational
times for the various problems are not particularly informative.) We compute the portfolio value
along each path under the approximate portfolio strategy and record the utility of the terminal
wealth. We then average over the simulated paths to estimate the expected utility. In simulations,
we discretize the continuous-time diﬀusion processes using a standard Euler scheme with a time
step t = 0.01 years.
As we showed in Section 4, the true value function is bounded from above by the value function in
the ﬁctitious market, which in turn is given by
                                                              γ
                                   (ν)     W01−γ           γ−1
                                                        (ν) γ
                                 V0     =         E0 π T                                     (27)
                                           1−γ
                          (ν)
We simulate the process πT by discretizing the integrals in (8) with the same time step t = 0.01.
The market price of risk and the riskfree rate in the ﬁctitious market are computed according to
the procedure described in Section 4. In our simulations we do not impose the constraint (16a),
since one can directly verify under our assumption about the return generating process and the
approximate trading strategy that the process νt is square integrable. The second constraint (16b)
does not need to be imposed explicitly for the problems we are considering below, as discussed in
Section 4.

                                                 13
Incomplete Markets

We ﬁrst consider the incomplete market model, in which portfolio positions in tradable asset are
unconstrained. Table 2 reports the estimates of the expected utility both under the static and
myopic portfolio strategies (25, 26), which provide lower bounds on the true value function, as well
as the corresponding estimates of the upper bound. Expected utility is reported as a continuously
compounded certainty
                       equivalent
                                  return, R. The value of R corresponding to the value function V0
is deﬁned by U W0 eRT = V0 . We also report the exact value function, which can be computed
explicitly using the results in Kim and Omberg (1996) and Liu (1998). Table 2 contains results for
four parameters sets, three values of the risk aversion parameter γ and two values of the economy
horizon T .
One can see that there is a sizeable gap between the expected utility achieved by the static strat-
egy and the corresponding upper bound on the true value function. For most of the parameter
combinations considered, the diﬀerence, expressed as annualized certainty equivalent return, is in
the range of 1% – 3%.
The diﬀerence between the upper bound and the lower bound can be decomposed into a sum of
two terms:

                                U B − LB = (V − LB) + (U B − V ).                                  (28)

The ﬁrst term is the utility loss of the approximate portfolio strategy under consideration. It
captures the utility loss due to using a sub-optimal portfolio strategy. The second term is the
diﬀerence between the upper bound and the true value function and it depends on how tight the
estimated upper bound is. Ideally, we would like to know the ﬁrst term, but since the true value
function is not known, we can only estimate the sum of two terms, i.e., the diﬀerence U B − LB.
This diﬀerence is large because either or both of the two terms on the right-hand side are large. In
particular, the magnitude of the second term depends on the accuracy of the approximate portfolio
policy and value function used to estimate the upper bound. Table 2 indicates that in this particular
case, the magnitude of the second term is relatively small, as can be seen from the diﬀerence between
the upper bound, U B s , and the exact solution, V u . (The exact solution is available for this special
case from Liu 1998. This will not be the case once we impose portfolio constraints below.) This
is somewhat surprising, since the diﬀerence between the lower and the upper bound suggests that
the static policy is quite far from being optimal.
To summarize, the above results do not allow us to conclude that predictability can be safely
ignored for the problems under consideration. However, without knowing the exact solutions we
could not argue that the economic value of predictability is large either. More generally, one should
not view the diﬀerence U B − LB we construct as a formal test statistic for optimality of a given
portfolio policy, since we haven’t established that the diﬀerence U B − LB must be “small” when
a portfolio policy used to construct the upper bound is close to being optimal. One can, however,
draw deﬁnitive conclusions from the cases when the diﬀerence U B − LB is small, which implies
that the considered suboptimal portfolio policy has a small utility cost.
We now turn to the corresponding results for the myopic strategy, also shown in Table 2. As we
have discussed in the introduction, using our method, one can verify that for a particular problem
under consideration ignoring hedging component of demand has little eﬀect on the expected utility.
For the problems with a ﬁve-year horizon, the diﬀerence between the point estimates of U B and

                                                  14
LB tends to be in the .1% – .2% range, except for the third parameter set, where it reaches
approximately .6%. Thus, we conclude that for most of the parameter sets, the hedging component
of demand is not very signiﬁcant economically with a ﬁve-year model horizon.
When we increase the problem horizon to ten years, the gap U B − LB increases. For the second
and fourth parameter sets the diﬀerence remains small, under .2%, but for the third parameter set
it now reaches as much as 1.5%, for the case of γ = 5. These observations are consistent with our
intuition that hedging demand tends to be more important for problems with longer horizons and
for larger values of risk aversion. (It is well known that the myopic policy is optimal for γ = 1 in
this case, and therefore it is not surprising that it performs well for values of γ close to one).


No short sales and no borrowing

We now consider the market in which both short sales and borrowing are prohibited, i.e., portfolio
policies must satisfy (22). Table 3 reports the estimates of the expected utility both under the static
and myopic portfolio strategies and the corresponding estimates of the upper bound. We also report
the value function obtained by relaxing the portfolio constraints on the three risky assets, which is
the same as the values reported in Table 2. Table 3 contains results for four parameters sets, three
values of the risk aversion parameter γ and two values of the economy horizon T .
As in the case of incomplete markets and no position constraints, there is a signiﬁcant gap between
the expected utility achieved by the static strategy and the corresponding upper bound on the true
value function. As before, we decompose the diﬀerence between the upper bound and the lower
bound as in (28). Table 3 indicates that the magnitude of the second term is substantial at least
for some of the parameter sets. In particular, for γ = 5, the estimated upper bound often exceeds
the value function of the unconstrained problem, which in turn is greater then or equal to the true
value function. As in the incomplete market case, we cannot conclude that predictability can be
safely ignored for the problems under consideration.
The results for the myopic strategy are similar to those in Table 2. For the problems with a ﬁve-year
horizon, the diﬀerence between the point estimates of U B and LB tends to be in the .1% – .2%
range, except for the third parameter set, where it reaches approximately .5%. Thus, we conclude
that for most of the parameter sets, the hedging component of demand is not very signiﬁcant
economically with a ﬁve-year model horizon. A closer examination of the portfolio composition
under the myopic policy (not reported here) suggests that our conclusions may be too conservative,
at least for the third parameter set. Because of the binding short sale constraints, the myopic policy
is likely to be close to the optimum most of the time. Thus, if we were to use a more accurate
approximation to the approximate value function Vt , our upper bound would likely be tighter than
the values reported in Table 3. As we pointed out earlier, our objective here is not to maximize
the accuracy of computations, but rather to illustrate the concepts, and we therefore do not pursue
this issue any further.


No short sales

In the numerical experiments above we assumed that neither borrowing nor short sales are allowed.
As we showed in Section 4, in this case the ﬁctitious market used to estimate the upper bound is

                                                  15
particularly straightforward to deﬁne. We now consider the case when short sales are prohibited, but
borrowing is allowed. Then, to deﬁne the ﬁctitious market one must solve a quadratic optimization
problem (21).
Table 4 reports the results and in order to reduce the computational eﬀort we only consider the case
of T = 5 years. Unlike the previous two cases, when we impose no short sales constraint we have
to solve a quadratic optimization problem numerically for every point in time on each simulated
path. This increases the computational cost. To reduce the total computation time, we limit the
model horizon to T = 5 years and only use 100, 000 simulated paths.) A comparison with Table 3
reveals a peculiar regularity. Because the borrowing constraint rarely binds for the myopic policy
when γ = 3 and γ = 5, the corresponding expected utility, LB, is similar to the values reported in
Table 3. However, the upper bound tends to be much tighter for these cases compared to Table 3,
even though the true value function for the problem considered in Table 4 exceeds the one for the
problem corresponding to Table 3 (since the latter problem is a more constrained version of the
former). The situation is reversed for γ = 1.5, but in that case the static policy calls for borrowing,
hence the expected utilities cannot be directly compared across the two tables. Nevertheless, one
can observe that for γ = 1.5 the diﬀerence U B − LB is signiﬁcantly larger than for γ = 3 and
γ = 5.
For the myopic strategy, the diﬀerence U B −LB is very similar to the corresponding values in Table
3. It is as high as .4% for the parameter set three and is less than .2% for all other parameter sets,
demonstrating that the hedging component of demand is not crucial when borrowing is allowed.
A comparison with the results for the static strategy shows that the gap U B − LB for the static
strategy is primarily due to the diﬀerence between the true value function and the lower bound,
and the corresponding upper bounds are relatively tight.



6    Conclusion

In this paper we developed a method for evaluating the quality of approximations for portfolio
choice problems by providing an upper bound on the utility loss associated with an approximate
solution. Our algorithm relies on the duality theory for constrained portfolio optimization. Starting
from an approximate portfolio policy, we construct a ﬁctitious ﬁnancial market without portfolio
constraints in which the optimization problem can be easily solved. The resulting value function
is estimated using Monte Carlo simulation and provides an upper bound on the (unknown) value
function of the original problem.
Our method is independent of the nature of the original approximation and can be used in combi-
nation with various algorithms for approximating optimal portfolio strategies. The algorithm can
also be applied to verify that an approximate strategy is in fact close to the optimum in terms of
expected utility. This applies not only to problems that can be potentially handled by traditional
numerical methods, but also to large-scale problems, since the computational time required by our
simulation-based method does not grow exponentially with the dimension of the state space or the
number of risky assets.
In our analysis we consider problems with the objective deﬁned over the terminal wealth. Extend-
ing our results to models with intermediate consumption is straightforward and will require an
approximate consumption policy in addition to the trading strategy.

                                                  16
Our formulation currently does not cover an important class of portfolio choice problems with
illiquid (nontradable) assets and liquidity constraints. Such problems are of great practical and
theoretical importance, but they rarely allow for explicit analytical solutions and are mostly handled
using numerical methods. Since general results for the quality of such numerical approximations
are not available, an algorithm for estimating the quality of approximate portfolio policies would
be very valuable.
Another promising direction for future research is to explore combining our methodology with
recently developed approximate dynamic programming (ADP) techniques. The bounds we obtain
could be used for both guiding the choice of approximation architecture in ADP applications, as
well as evaluating the resultant policies.
We are pursuing the above extensions in ongoing research.




                                                 17
Ait-Sahalia, Y. and M. Brandt. 2001. Variable Selection for Portfolio Choice. Journal of Finance.
    56 1297-1351.

Ang, A. and G. Bekaert. 2002. International Asset Allocation with Time-Varying Correlations.
    Working paper. Columbia University, New York.

Balduzzi, P. and A. Lynch. 1999. Transaction Costs and Predictability: Some Utility Cost
    Calculations. Journal of Financial Economics. 52 47-78.

Barberis, N. 2002. Investing for the Long Run When Returns are Predictable. Journal of Finance.
    55 225-264.

Brandt, M. 1999. Estimating Portfolio and Consumption Choice: A Conditional Euler Equations
    Approach. Journal of Finance. 54 1609-1645.

Brandt, M., A. Goyal, and P. Santa-Clara. 2001. A Simulation Approach to Dynamic Portfolio
    Choice with an Application to Industry Momentum. Working paper. UCLA, Los Angeles.

Brennan, M.. 1998. The Role of Learning in Dynamic Portfolio Decisions. European Finance
    Review. 1 295-306.

Brennan, M. and Y. Xia. 2001. Dynamic Asset Allocation Under Inﬂation. Working paper.
    UCLA, Los Angeles.

Brennan, M., E. Schwartz, and R. Lagnado. 1997. Strategic Asset Allocation. Journal of Eco-
    nomic Dynamics and Control. 21 1377-1403.

Campbell, J. and L. Viceira. 1999. Consumption and Portfolio Decisions When Expected Returns
   are Time Varying. The Quarterly Journal of Economics. 114 433-495.

Chan, Y. and L. Kogan. 2001. Catching Up with the Joneses: Heterogeneous Preferences and the
   Dynamics of Asset Prices. Forthcoming in Journal of Political Economy.

Campbell, J. and L. Viceira. 2002. Strategic Asset Allocation – Portfolio Choice for Long-Term
   Investors. Oxford University Press, USA.

Campbell, J., Y. Chan and L. Viceira. 2002. A Multivariate Model of Strategic Asset Allocation.
   Forthcoming in Journal of Financial Economics.

Chacko, G. and L. Viceira. 2002. Dynamic Consumption and Portfolio Choice with Stochastic
    Volatility in Incomplete Markets. Working paper, Harvard University, Boston.

Cox, J. and C.F. Huang. 1989. Optimal Consumption and Portfolio Policies When Asset Prices
    Follow a Diﬀusion Process. Journal of Economic Theory. 49 33-83.

Cuoco, D. 1997. Optimal Consumption and Equilibrium Prices with Portfolio Constraints and
   Stochastic Income. Journal of Economic Theory. 72 33–73.

Cvitanic, J. and I. Karatzas. 1992. Convex Duality in Constrained Portfolio Optimization. Annals
    of Applied Probability. 2 767-818.

Dammon, R., C. Spatt and H. Zhang. 2000. Optimal Consumption and Investment with Capital
   Gains Taxes. Review of Financial Studies. 14 583-616.

                                              18
Detemple, J., R. Garcia, and M. Rindisbacher. 2000. A Monte-Carlo Method for Optimal Port-
    folios, CIRANO Working Paper 2000s-05.

Gomes, F. 2002. Exploiting Short-Run Predictability. Working paper. London Business School,
   London.

Haugh, M. and L. Kogan. 2003. Pricing American Options: A Duality Approach. Forthcoming
   in Operations Research.

den Haan, W. and A. Marcet. 1994. Accuracy in Simulations. Review of Economic Studies. 61
    3-17.

He, H. and N. Pearson. 1991. Consumption and Portfolio Policies with Incomplete Markets and
    Short-Sale Constraints: The Inﬁnite-Dimensional Case. Journal of Economic Theory. 52
    259-304.

Johannes, M., N. Polson and J. Stroud. 2002. Sequential Optimal Portfolio Performance: Market
    and Volatility Timing. Working paper. Columbia University, New York.

Judd, K. 1996. Approximation, Perturbation, and Projection Methods in Economic Analysis. In
    H.M. Amman, D.A. Kendrick, J. Rust (eds.), Handbook of Computational Economics, Volume
    I. Elsevier Schience, Amsterdam.

Kandel, S. and R. Stambaugh. On the Predictability of Stock Returns: An Asset-Allocation
   Perspective. Journal of Finance. 51 385-424.

Karatzas, I., J. Lehoczky, S. Sethi and S. Shreve. 1986. Explicit Solution of a General Consump-
    tion/Investment Problem. Mathematics of Operationas Research. 11 261-294.

Karatzas, I., J. Lehoczky, S. Shreve, and G. Xu. 1991. Martingale and Duality Methods for
    Utility Maximization in an Incomplete Market. SIAM Journal of Control and Optimization.
    29 702-730.

Karatzas, I. and S. Shreve. 1998. Methods of Mathematical Finance. Springer-Verlag, New York,
    NY.

Kim, T. S. and E. Omberg. 1986. Dynamic Nonmyopic Portfolio Behavior. Review of Financial
   Studies. 9 141-61.

Munk, C. 1998. Optimal Consumption/Investment Policies with Undiversiﬁable Income Risk and
   Liquidity Constraints. Working paper. Odense University, Denmark.

Liu, J. 1998. Dynamic Portfolio Choice and Risk Aversion. Working paper. Stanford University,
     Palo Alto.

Lynch, A. 2001. Portfolio Choice and Equity Characteristics: Characterizing the Hedging De-
    mands Induced by Return Predictability. Journal of Financial Economics. 62 67-130.

Pastor, L. 2000. Portfolio Selection and Asset Pricing Models. Journal of Finance. 55 179-223.

Pastor, L. and R. Stambaugh. 2000. Comparing Asset Pricing Models: An Investment Perspec-
    tive. Journal of Financial Economics. 56 335-81.

                                              19
Pliska, S. 1986. A stochastic Calculus Model of Continuous Trading: Optimal Portfolios. Mathe-
     matics of Operations Research. 11 371-382.

Rust, J., 1996. Approximation, Perturbation, and Projection Methods in Economic Analysis. In
    H.M. Amman, D.A. Kendrick, J. Rust (eds.), Handbook of Computational Economics, Volume
    I. Elsevier Schience, Amsterdam.

Schroder, M. and C. Skiadas. (2003) Optimal Lifetime Consumption-Portfolio Strategies under
    Trading Constraints and Generalized Recursive Preferences. Working Paper No. 285. Kellogg
    School of Management, Northwestern University, Evanston.

Stambaugh, R. 1999. Predictive Regressions. Journal of Financial Economics. 54 375-421.

Xia, Y. 2001. Learning About Predictability: The Eﬀect of Parameter Uncertainty on Optimal
     Dynamic Asset Allocation. Journal of Finance 56 205-247.




                                             20
                                              Parameter set 1

                        k      µ0      µ1                       ΣP

                      0.366   0.081   0.034        0.186   0.000     0.000    0.000
                              0.110   0.059        0.228   0.083     0.000    0.000
                              0.130   0.073        0.251   0.139     0.069    0.000
                              0.000   0.000       -0.741   -0.037    -0.060   0.284

                                              Parameter set 2

                        k      µ0      µ1                       ΣP

                      1.671   0.081   0.046        0.186   0.000     0.000    0.000
                              0.110   0.070       0.227    0.082     0.000    0.000
                              0.130   0.086       0.251    0.139     0.069    0.000
                              0.000   0.000       -0.017   0.149     0.058    1.725

                                              Parameter set 3

                        k      µ0      µ1                       ΣP

                      0.366   0.142   0.065        0.256   0.000     0.000    0.000
                              0.109   0.049       0.217    0.054     0.000    0.000
                              0.089   0.049       0.207    0.062     0.062    0.000
                              0.000   0.000       -0.741   0.040     0.034    0.288

                                              Parameter set 4

                        k      µ0      µ1                       ΣP

                      1.671   0.142   0.061        0.256   0.000     0.000    0.000
                              0.109   0.060       0.217    0.054     0.000    0.000
                              0.089   0.067       0.206    0.062     0.062    0.000
                              0.000   0.000       -0.017   0.212     0.096    1.716


Table 1: Calibrated model parameters. The four sets of parameters correspond to: (1) size
sorted portfolios and the dividend yield as a state variable; (2) size sorted portfolios and the term
spread as a state variable; (3) book-to-market sorted portfolios and the dividend yield as a state
variable; (4) book-to-market sorted portfolios and the term spread as a state variable. Parameter
values are based on the estimates in Tables 1 and 2 of Lynch (2001).




                                                    21
                                        T =5                                                T = 10

                        γ = 1.5           γ =3            γ =5                 γ = 1.5        γ =3            γ =5

                                                             Parameter set 1
                 s
            LB            7.50             4.64            3.27               7.70             4.84            3.42
                      (7.48, 7.52)     (4.63, 4.65)    (3.27, 3.28)       (7.69, 7.71)     (4.84, 4.85)    (3.42, 3.43)
            U Bs          9.44             5.94            4.20              10.12             6.72            4.88
                      (9.40, 9.48)     (5.86, 6.01)    (4.10, 4.30)      (10.09, 10.15)    (6.65, 6.79)    (4.76, 5.00)
            LB m          9.35             5.72            3.97               9.94             6.18            4.29
                      (9.32, 9.37)     (5.70, 5.73)    (3.96, 3.98)       (9.92, 9.96)     (6.16, 6.19)    (4.28, 4.29)
            U Bm          9.44             5.94            4.20              10.12             6.72            4.88
                      (9.40, 9.48)     (5.86, 6.01)    (4.10, 4.30)      (10.09, 10.15)    (6.65, 6.79)    (4.76, 5.00)
             Vu           9.44             5.95            4.19              10.09             6.62            4.75

                                                             Parameter set 2

            LB s          6.55             3.69            2.59               6.53             3.67            2.58
                      (6.52, 6.58)     (3.67, 3.70)    (2.58, 2.60)       (6.51, 6.55)     (3.66, 3.69)    (2.58, 2.59)
                 s
            UB            9.07             5.00            3.40               9.16             5.07            3.46
                      (9.02, 9.11)     (4.95, 5.05)    (3.35, 3.46)       (9.13, 9.20)     (5.03, 5.11)    (3.41, 3.51)
            LB m          9.02             4.92            3.33               9.10             4.95            3.35
                      (8.99, 9.05)     (4.90, 4.93)    (3.32, 3.34)       (9.08, 9.12)     (4.94, 4.97)    (3.34, 3.36)
            U Bm          9.07             5.00            3.40               9.16             5.07            3.46
                      (9.02, 9.11)     (4.95, 5.05)    (3.35, 3.46)       (9.13, 9.20)     (5.03, 5.11)    (3.41, 3.51)
             Vu           9.02             4.92            3.33               9.08             4.94            3.34

                                                             Parameter set 3

            LB s         14.67             8.59            5.73              15.06             8.98            6.02
                     (14.64, 14.70)    (8.57, 8.60)    (5.72, 5.74)      (15.04, 15.08)    (8.97, 8.99)    (6.01, 6.02)
                 s
            UB           16.84            10.43            7.27              17.84            11.90            8.76
                     (16.78, 16.90)   (10.32, 10.55)   (7.09, 7.45)      (17.80, 17.88)   (11.78, 12.01)   (8.54, 8.98)
            LB m         16.64             9.88            6.61              17.47            10.60            7.10
                     (16.61, 16.68)    (9.86, 9.90)    (6.59, 6.62)      (17.44, 17.49)   (10.58, 10.61)   (7.09, 7.12)
            U Bm         16.84            10.43            7.27              17.84            11.90            8.76
                     (16.78, 16.90)   (10.32, 10.55)   (7.09, 7.45)      (17.80, 17.88)   (11.78, 12.01)   (8.54, 8.98)
             Vu          16.79            10.32            7.06              17.76            11.55            8.12

                                                             Parameter set 4

            LB s         13.17             7.10            4.66              13.18             7.11            4.67
                     (13.14, 13.21)    (7.08, 7.12)    (4.65, 4.68)      (13.15, 13.21)    (7.09, 7.13)    (4.66, 4.69)
                 s
            UB           15.93             8.47            5.54              16.06             8.59            5.62
                     (15.87, 15.99)    (8.40, 8.55)    (5.46, 5.63)      (16.01, 16.10)    (8.52, 8.66)    (5.53, 5.71)
            LB m         15.91             8.45            5.48              16.02             8.51            5.51
                     (15.87, 15.95)    (8.42, 8.47)    (5.46, 5.49)      (15.99, 16.05)    (8.49, 8.54)    (5.49, 5.53)
            U Bm         15.93             8.47            5.54              16.06             8.59            5.62
                     (15.87, 15.99)    (8.40, 8.55)    (5.46, 5.63)      (16.01, 16.10)    (8.52, 8.66)    (5.53, 5.71)
             Vu          15.91             8.45            5.47              16.00             8.49            5.49


Table 2: Incomplete markets. The four parameter sets are deﬁned in Table 1. The rows
marked LB s and LB m report the estimates of the expected utility achieved by using the static
and myopic portfolio strategies, respectively. The estimates are based on 1, 000, 000 independent
simulations. Expected utility is reported as a continuously compounded certainty equivalent return.
Approximate 95% conﬁdence intervals are reported in parentheses. The rows marked U B s and U B m
report the analogous results for the upper bound on the true value function computed according
to the procedure described in Section 4. The row marked V u reports the optimal value function
for the problem.




                                                                 22
                                         T =5                                              T = 10

                          γ = 1.5          γ =3           γ =5                 γ = 1.5       γ =3           γ =5

                                                             Parameter set 1
                   s
              LB            7.39            4.64           3.28               7.57            4.84           3.42
                        (7.37, 7.41)    (4.63, 4.65)   (3.27, 3.28)       (7.56, 7.58)    (4.83, 4.85)   (3.42, 3.43)
              U Bs          9.22            7.23           6.33               9.59            7.80           7.00
                        (9.19, 9.25)    (7.19, 7.26)   (6.29, 6.37)       (9.57, 9.62)    (7.78, 7.83)   (6.97, 7.02)
              LB m          8.09            5.57           3.91               8.35            5.99           4.22
                        (8.07, 8.11)    (5.56, 5.59)   (3.89, 3.92)       (8.34, 8.36)    (5.98, 6.00)   (4.21, 4.23)
              U Bm          8.15            5.84           4.18               8.45            6.48           4.77
                        (8.12, 8.18)    (5.79, 5.90)   (4.08, 4.28)       (8.43, 8.47)    (6.42, 6.54)   (4.60, 4.94)
              Vu            9.44            5.95           4.19              10.09            6.62           4.75

                                                             Parameter set 2

              LB s          6.54            3.69           2.60               6.52            3.67           2.58
                        (6.52, 6.57)    (3.68, 3.71)   (2.59, 2.61)       (6.51, 6.54)    (3.66, 3.69)   (2.58, 2.59)
                   s
              UB            9.54            6.94           5.79               9.59            7.00           5.84
                        (9.50, 9.57)    (6.90, 6.98)   (5.74, 5.83)       (9.57, 9.62)    (6.96, 7.03)   (5.80, 5.87)
              LB m          7.88            4.85           3.30               7.91            4.87           3.31
                        (7.86, 7.90)    (4.84, 4.87)   (3.29, 3.31)       (7.90, 7.93)    (4.86, 4.88)   (3.30, 3.32)
              U Bm          7.93            4.98           3.42               7.95            5.01           3.44
                        (7.89, 7.96)    (4.93, 5.03)   (3.37, 3.48)       (7.93, 7.98)    (4.97, 5.04)   (3.39, 3.49)
              Vu            9.02            4.92           3.33               9.08            4.94           3.34

                                                             Parameter set 3

              LB s         10.03            6.76           4.62              10.22            7.12           4.87
                       (10.01, 10.04)   (6.75, 6.78)   (4.61, 4.63)      (10.21, 10.23)   (7.11, 7.12)   (4.87, 4.88)
                   s
              UB           10.71            8.83           7.38              11.04            9.51           8.17
                       (10.68, 10.74)   (8.78, 8.88)   (7.33, 7.42)      (11.02, 11.06)   (9.47, 9.54)   (8.13, 8.21)
              LB m         10.17            7.65           5.35              10.37            8.18           5.80
                       (10.15, 10.18)   (7.63, 7.66)   (5.33, 5.36)      (10.36, 10.38)   (8.17, 8.19)   (5.79, 5.81)
              U Bm         10.23            8.05           5.85              10.47            8.88           6.79
                       (10.20, 10.26)   (7.98, 8.11)   (5.69, 6.01)      (10.46, 10.49)   (8.82, 8.94)   (6.34, 7.25)
              Vu           16.79           10.32           7.06              17.76           11.55           8.12

                                                             Parameter set 4

              LB s          9.22            5.31           3.57               9.21            5.29           3.56
                        (9.20, 9.24)    (5.29, 5.32)   (3.56, 3.58)       (9.19, 9.22)    (5.27, 5.30)   (3.54, 3.57)
                   s
              UB           10.23            7.69           5.91              10.26            7.72           5.95
                       (10.19, 10.26)   (7.63, 7.74)   (5.86, 5.97)      (10.23, 10.28)   (7.68, 7.77)   (5.89, 6.00)
              LB m          9.51            6.07           4.05               9.51            6.08           4.06
                        (9.49, 9.53)    (6.05, 6.09)   (4.04, 4.06)       (9.50, 9.53)    (6.06, 6.09)   (4.05, 4.07)
              U Bm          9.54            6.20           4.19               9.55            6.22           4.20
                        (9.51, 9.57)    (6.15, 6.26)   (4.12, 4.25)       (9.52, 9.57)    (6.17, 6.26)   (4.14, 4.26)
              Vu           15.91            8.45           5.47              16.00            8.49           5.49


Table 3: No short sales and no borrowing. The four parameter sets are deﬁned in Table 1. The
rows marked LB s and LB m report the estimates of the expected utility achieved by using the static
and myopic portfolio strategies, respectively. The estimates are based on 1, 000, 000 independent
simulations. Expected utility is reported as a continuously compounded certainty equivalent return.
Approximate 95% conﬁdence intervals are reported in parentheses. The rows marked U B s and U B m
report the analogous results for the upper bound on the true value function computed according
to the procedure described in Section 4. The row marked V u reports the optimal value function
for the model with incomplete markets and without the portfolio constraints.




                                                                 23
                                           γ = 1.5            γ =3          γ =5

                                                     Parameter set 1

                               LB s          7.47             4.62           3.27
                                         (7.41, 7.53)     (4.59, 4.65)   (3.25, 3.29)
                                    s
                               UB           10.35             6.28           4.32
                                        (10.21, 10.49)    (6.06, 6.50)   (4.02, 4.62)
                               LB m          9.04             5.58           3.89
                                         (8.96, 9.12)     (5.53, 5.62)   (3.86, 3.92)
                               U Bm          9.14             5.77           4.04
                                         (9.02, 9.27)     (5.56, 5.98)   (3.75, 4.33)
                                Vu           9.44             5.95           4.19

                                                     Parameter set 2

                               LB s          6.52             3.67           2.58
                                         (6.44, 6.60)     (3.63, 3.72)   (2.56, 2.61)
                                    s
                               UB           10.76             5.85           3.88
                                        (10.60, 10.92)    (5.67, 6.03)   (3.69, 4.08)
                               LB m          8.92             4.86           3.30
                                         (8.82, 9.01)     (4.81, 4.91)   (3.26, 3.33)
                               U Bm          9.01             4.98           3.38
                                         (8.87, 9.15)     (4.82, 5.14)   (3.20, 3.56)
                                Vu           9.02             4.92           3.33

                                                     Parameter set 3
                                    s
                               LB           11.19             6.76           4.61
                                        (11.12, 11.26)    (6.72, 6.80)   (4.59, 4.64)
                               U Bs         14.68             8.89           6.09
                                        (14.50, 14.85)    (8.61, 9.18)   (5.70, 6.48)
                               LB m         12.80             7.82           5.34
                                        (12.71, 12.89)    (7.77, 7.88)   (5.30, 5.38)
                               U Bm         12.99             8.22           5.73
                                        (12.83, 13.14)    (7.95, 8.49)   (5.35, 6.11)
                                Vu          16.79            10.32           7.06

                                                     Parameter set 4
                                    s
                               LB            9.71             5.29           3.55
                                         (9.61, 9.81)     (5.23, 5.34)   (3.52, 3.59)
                               U Bs         13.67             7.32           4.75
                                        (13.49, 13.85)    (7.10, 7.54)   (4.50, 5.01)
                               LB m         11.36             6.10           4.04
                                        (11.25, 11.47)    (6.04, 6.16)   (4.00, 4.08)
                               U Bm         11.47             6.21           4.09
                                        (11.30, 11.63)    (6.02, 6.41)   (3.86, 4.33)
                                Vu          15.91             8.45           5.47


Table 4: No short sales, static portfolio strategy. The four parameter sets are deﬁned in Table
1 and the problem horizon is T = 5 years. The rows marked LB s and LB m report the estimates
of the expected utility achieved by using the static and myopic portfolio strategies, respectively.
The estimates are based on 100, 000 independent simulations. Expected utility is reported as a
continuously compounded certainty equivalent return. Approximate 95% conﬁdence intervals are
reported in parentheses. The rows marked U B s and U B m report the analogous results for the
upper bound on the true value function computed according to the procedure described in Section
4. The row marked V u reports the optimal value function for the model with incomplete markets
and without the portfolio constraints.




                                                         24
