                                    NBER WORKING PAPER SERIES




TELLING FROM DISCRETE DATA WHETHER THE UNDERLYING CONTINUOUS-TIME
                        MODEL IS A DIFFUSION


                                              Yacine Ait-Sahalia


                                             Working Paper 8504
                                     http://www.nber.org/papers/w8504


                         NATIONAL BUREAU OF ECONOMIC RESEARCH
                                  1050 Massachusetts Avenue
                                    Cambridge, MA 02138
                                        October 2001




I am grateful to the Editor and the referee, as well as Robert Bliss, Halyna Frydman, Peter Glynn, Lars Hansen,
Samuel Karlin, Huston McCulloch and Jim Stock for helpful discussions and comments, and to seminar
participants at the American Mathematical Society, Berkeley, Cornell, the Econometric Society, the Federal
Reserve Bank of Atlanta, the Fields Institute in Mathematical Sciences, the Institute of Mathematical Statistics,
LSE, the NBER Summer Institute, NYU, Ohio State, Stanford, ULB, the University of Chicago, the University
of Illinois, the University of Iowa, UNC Chapel Hill, the University of Washington, Vanderbilt, the Western
Finance Association and Wharton. Financial support from an Alfred P. Sloan Research Fellowship and the NSF
(Grant SES-9996023) is gratefully acknowledged. Some of the material contained here circulated previously in
a draft under the title “Do interest rates really follow continuous-time diffusions?” The views expressed herein are
those of the author and not necessarily those of the National Bureau of Economic Research.


© 2001 by Yacine Ait-Sahalia. All rights reserved. Short sections of text, not to exceed two paragraphs, may be
quoted without explicit permission provided that full credit, including © notice, is given to the source.
Telling from Discrete Data Whether the Underlying Continuous-Time
Model is a Diffusion
Yacine Ait-Sahalia
NBER Working Paper No. 8504
October 2001
JEL No. G12, C22, C52



                                               ABSTRACT


        Asset returns have traditionally been modeled in the literature as following continuous-time
Markov processes, and in many cases diffusions. Can discretely sampled financial rate data help us decide
which continuous-time models are sensible? Diffusion processes are characterized by the continuity of
their sample paths. This cannot be verified from the discrete sample path: by nature, even if the
underlying sample path were continuous, the discretely sampled data will always appear as a sequence
of discrete jumps. Instead, this paper relies on a characterization of the transition density of the discrete
data to determine whether the discontinuities observed in the discrete data are the result of the
discreteness of sampling, or rather evidence of genuine jump dynamics for the underlying continuous-
time process. I then focus on the implications of this approach for option pricing models.




Yacine Ait-Sahalia
Department of Economics / Bendheim Center for Finance
Princeton University
Princeton, NJ 08540-5296
and NBER
609-258-4015
yacine@princeton.edu
                                                      1




         In many instances in financial econometrics, we make inference about a postulated
continuous-time model on the basis of discretely sampled observations. Among potential
continuous-time models, most specifications adopted have been diffusions, although the
literature is more and more frequently allowing for jumps (see Ahn and Thompson (1988), Bates
(1991), Das and Foresi (1996), Duffie, Pan and Singleton (2000), Aït-Sahalia, Wang and Yared
(2001) among others).

         A diffusion process is a Markov process with continuous sample paths. Suppose we
observe the process every ∆ units of time, with ∆ not necessarily small. Presented with such a
discrete subsample of the continuous-time path, can we tell whether the underlying model that
gave rise to the data was a diffusion, or should jumps be allowed into the model? Intuition
suggests that the answer should be no. After all, the discrete data are purely discontinuous even
if the continuous-time sample is not so, faced with two discontinuous samples, how could we
ever rule out that one came from a diffusion but not the other? It turns out that this question is
not as hopeless as it first sounds. A finer look reveals that there are different degrees of
discontinuity in the discrete observations, some compatible with the continuity of the underlying
sample path, some not.

         The approach I use relies on identifying a necessary and sufficient restriction on the
transition densities of diffusions, at the sampling interval of the observed data. The theory is
based on Karlin and McGregor (1959b)’s notion of coincidence probabilities combined with
crossing arguments. The total positivity restriction characterizes the continuity of the
unobservable complete sample path. It must be satisfied by the transitions densities of a diffusion
and is valid for every sampling interval including long ones.

         In a nutshell, the argument is based on the fact that if a diffusion on the real line starts
below another diffusion, it cannot finish above the second one without their sample paths having
crossed at least once.1 Since the discrete data reveal the transition density at whatever sampling
interval is available, one can actually discriminate between diffusions and non-diffusion Markov
processes on the basis of their discrete subsamples.




1 An alternative property is that the eigenvalues of the infinitesimal generator of the diffusion are all real
and nonnegative (see Mandl (1968)). This property has been exploited by Florens, Renault and Touzi
(1998). As a practical matter, however, eigenvalues and eigenfunctions of generators can be difficult to
calculate. The first eigenvalue and eigenfunctions can be determined only in certain special cases (see e.g.,
Aït-Sahalia (1996a) and Hansen, Scheinkman and Touzi (1998)).
                                                   2



        An essential property of the characterization is that if the transitions over an interval of
length ∆ satisfy the inequality characterization, then longer transitions will satisfy it as well. That
is, we only need to focus on a single criterion, rather than attempt to verify a large number of
conditions, to determine whether the process is a diffusion. Furthermore, the criterion can
determine whether a discrete transition function is compatible with some diffusion without
requiring that a list of potential candidate diffusions be exhibited.

        To provide some intuition, I give the corresponding version of the criterion for discrete-
state models, both for continuous-time Markov chains and discrete-time trees. In a discrete-state
world, by definition, all the state changes are jumps and the appropriate notion of continuity
distinguishes between small or continuous jumps, which are those from one state to an
immediately adjacent one, from large or discontinuous jumps, which are those from one state to
a nonadjacent one. One consequence for trees in option pricing is that binomial and trinomial
trees with branches continuously spaced are inappropriate as approximations to jump-diffusions,
despite their common use in that context.

        Finally, I employ the criterion function to determine whether the risk-neutral transition
density of the S&P 500 implied by observed option prices is compatible with an underlying
continuous-time diffusion for the index, or whether jumps should be included. The latter happens
to be the case empirically. I examine the consequences of this finding for the implied diffusion,
implied tree and Edgeworth expansion approaches that are widely used in practice to price and
hedge equity derivatives. Another possible empirical motivation, which is not pursued here,
would be to substantiate, or invalidate, the approach of modeling the dynamics of the short term
interest rate, or other factors taken individually, as continuous-time diffusions: should they be
diffusions, or something else within the Markov class?

        The paper is organized as follows. Section I examines the implications of the continuity
of the sample paths for the discrete data and obtains a necessary and sufficient characterization
of the transition density of diffusions. Section II interprets this criterion in terms of discrete-state
processes. Section III gives two examples and two consequences. Section IV focuses on the
dynamics implicit in S&P 500 option prices. Section V summarizes the results and concludes.
                                                           3



           I. Implications of the Continuity of the Sample Paths for
                                the Discrete Data

A. Sample Path – Level Characterization of Continuity

        I start with some mathematical preliminaries and by establishing the notation used
throughout the paper. Let us assume that the process                       {rt , t ≥ 0}   is Markovian. That is, the
continuous-time process {rt , t ≥ 0} is defined on a probability space                      (W, ¡, P ) , takes values in
D Õ » and, with Ft     ∫ s (rs : s £ t ) , assume that

                                       P (rt +s Œ I | Ft ) = P ( rt + s Œ I | rt )                                    (1)

for all t, s ≥ 0 and open interval I in D. This by itself can be an interesting hypothesis to examine
(see the companion paper Aït-Sahalia (2000)), but will be maintained throughout this paper. We
are then interested in learning, from discrete observations {r0 , rD , r2 D ,             …, rnD   } , whether it belongs
to the smaller class of diffusion processes. Note that I restrict attention to univariate processes,
so the state space is an interval D on the real line.

        Let p (s, y | t, x ) be the conditional density of rs=y given rt=x. This is the transition
function of the process. To be able to infer the transition function from a time series of
observations on r, we must assume that the joint densities of the process are time-homogenous.
That is, each pair of observations (rt+∆, rt) at each date t are drawn from the same joint density,
which I denote as p ( D, y, x ) and is independent of t. This assumption lets us in effect transform
what would have been a single data point, the observed path, into repeated observations on the
pair (rt+∆, rt) drawn from a common distribution (see Figure 1).

        Then let p ( D, y | x ) denote the transition function of the process over a time interval of
length ∆, i.e., the conditional density of rt+∆=y given rt=x. Without time-homogeneity, the
transition function would be p ( t + D, y | t, x ) , i.e., a function of t and ∆ separately. This does not
mean that we are only considering stationary processes. Time-homogeneity is necessary for the
stationarity of the process, i.e., all finite dimensional distributions being identical no matter
where taken in time, but not sufficient. For instance, a Brownian motion is time-homogenous but
of course not stationary.

        I further assume that the sample paths of r are right-continuous, so the finite-dimensional
distributions determine the probabilities of all events, and that r is a strong Markov process. That
is, r restarts at the first passage of a given point and retains its transition densities afterwards.
More precisely, recall that Fs is the σ-algebra generated by {rt ,0 £ t £ s} . A stopping time of the
                                                        4



process {rt , t ≥ 0} is a random variable τ such as the events                  {t £ t}   belong to Ft for all t≥0.
Then {rt , t ≥ t} is a Markov process independent of Ft and has the same transition densities as
before τ. A sufficient condition on the transition density p of the process which guarantees that it
is a strong Markov process is Feller’s property: for every bounded continuous real function f,
and for every t>0, x   Ú D
                              f (y)p(t, y | x)dy defines a continuous function on D (see Ray (1956)

and Friedman (1975), Theorem 2.2.4).

        Note also that the transition densities of a Markov process must satisfy the Chapman-
Kolmogorov equation

                               p ( 2D, y | x ) = Ú p ( D, y | z ) p ( D, z | x ) dz
                                                   r
                                                                                                                (2)
                                                  r



for every x in D, Y⊂D, and ∆>0. This fact will be handy later.

        Then a diffusion is a process satisfying the assumptions above and whose sample paths
are continuous everywhere, except possibly for jumps from the boundaries of the state space D.

B. Transition – Level Characterization of Continuity

        Given that the full path is not observable, the first step in the approach will be to move
away from the sample path characterization of diffusions that was just given, and examine what
can be said about their transitions. Since the process is Markovian, and its transitions are time-
homogenous, the information contained in the discrete data can be summarized through the
transition function p(∆,y|x). The following example describes what an easy solution to the
problem would be, if it were available. Suppose that we find, using any available data analysis
technique, that the discrete data can be represented accurately by the conditional density

                                                       (
                                        rt + D | rt ~ N g 0 + g 1rt , d02   )                                   (3)


i.e., a Gaussian transition density with affine mean and constant variance.

        Can we then construct a continuous-time diffusion which, based on the empirical
evidence (3), could have generated the data as a discrete sample off its continuous sample path?
The answer is yes. Consider the diffusion

                                         drt = k (a - rt ) dt + sdZ t                                           (4)
                                                            5



for which p(∆,y|x) is Gaussian with E [ rt + D | rt ] = rt + (a - rt ) exp[ -kD] and V [ rt + D | rt ] =
s 2 (1 - exp[ -2kD]) /(2k ) . Now set k = - Ln[1 - g 1 ]/ D , a = g 0 /(1 - g 1 ) and s 2 = -2d 02 Ln[1 - g 1 ]
/ [(1 - g 12 ) D] : the continuous-time diffusion is fully determined. Based on the available data, we
cannot rule out (4) as a continuous-time model that could have generated the discrete data.

         Unfortunately, such explicit calculations are impossible to conduct in most cases, since,
in general, one cannot compute in closed-form the transition function p(∆,y|x) implied by a
particular diffusion model, or vice versa, although very accurate closed-form approximations can
be formed, see Aït-Sahalia (1997, 1999). On the other hand, this explicit calculation, whenever
available, provides a constructive answer to the problem in that not only do we get to answer that
a diffusion could have generated the discrete data, but we also get to identify that diffusion.

         Alternatively, if we knew what specific diffusion to look for, i.e., had an idea as to what
functions µ and σ2 to use in drt = m ( rt ) dt + s ( rt ) dZ t , then we could place a restriction on the
discrete transitions of the process for any ∆, even without knowing in closed-form what its
transition density is. As shown in Aït-Sahalia (1996b), time-homogeneity of the transition
density can be exploited by re-writing the forward and backward Fokker-Planck-Kolmogorov
equations: note that by stationarity p (s, y | t, x ) = p (s - t, y | 0, x ) ∫ p (s - t, y | x ) for any s > t > 0
and therefore ∂p ∂s = - ∂p ∂t . We can then eliminate derivatives of p with respect to ∆ = s-t,
i.e., the left hand side terms in:

                    Ï∂p ( D, y | x )      ∂                          1 ∂2
                   Ô
                    Ô ∂D             = - (m ( y ) p ( D , y | x )) +
                                         ∂y                          2 ∂y 2
                                                                             (s 2 ( y ) p ( D, y | x ))
                   Ì                                                                                           (5)
                   Ô ∂p ( D, y | x ) = m ( x ∂ p ( D, y | x + 1 s 2 ( x ∂ 2 p ( D, y | x
                   ÔÓ ∂D                    ) (               ))            ) 2(                   ))
                                             ∂x                    2          ∂x

for all x and y in the interior of D since the two right hand sides must be equal.2 So the terms that
could not be estimated with discrete data, i.e., the derivatives ∂p                   ∂D , are now gone. But if we
wish to test whether p(∆,y|x) could possibly be the discrete transition function from a diffusion,
(5) is of no help, since obviously we cannot examine every possible pair of functions (µ,σ2),
unless by sheer luck we happened to stumble upon the right choice for (µ,σ2).




2The  rationale for eliminating the term ∂p / ∂∆ is that it this term cannot be estimated given data sampled at
a fixed interval ∆. We can only estimate p(∆|y,x), p(2∆|y,x), etc., and their derivatives with respect to the
starting and ending state levels x and y.
                                                             6



C. Implications of Continuity for Small Time Transitions

         So, what can be said about the transition densities of a diffusion without pre-committing
to specific choices of (µ,σ2)? In other words, does the fact that the underlying model is a
diffusion –any diffusion-- imply that its transition densities will have distinguishing features? I
will maintain that the transition functions of the process preserve the probability, in the sense
that

                                      lim     Úy            p ( D, y | x ) dy = 1                       (6)
                                      DÆ 0         - x £e




for any fixed ε>0 and x in the interior of D. For technical reasons, let me also assume throughout
that the convergence in equation (6) occurs at least at some unrestricted polynomial rate.3

         The natural first approach is to examine whether the small time characterizations of
continuity, i.e., those valid in the limit where ∆ goes to zero, extend to any discrete time interval.
For instance, it is known that the sample paths of r are almost surely continuous functions of t if
and only if, for every compact interval I Õ D and ε>0, Lindeberg’s condition

                                             1
                                                             p ( D, y | x ) dy = 0
                                             D Ú y - x >e
                                     lim                                                                (7)
                                     DÆ 0



is satisfied uniformly in x on D (see Ray (1956)). This condition maps out the continuity of the
sample path into a bound on the size of the probability of leaving a given neighborhood in the
amount of time ∆; intuitively, this probability must be small as ∆ goes to 0 if the sample paths
are to remain continuous. Condition (7) says how small this probability must be as ∆ gets
smaller: the answer is o(∆), that is, negligible compared to ∆. Condition (6) only says that it is of
order o(∆ α ) for some α>0. Condition (7) says that α must be greater than or equal to one.

         In terms of deciding whether the discrete data came from a diffusion, condition (7)
represents a step forward compared to the notion of continuity of the sample path. However it is
also clear that this condition still cannot be used as a basis of a test for diffusions. Indeed, unless
we are presented with ultra-high frequency data, we do not have the necessary data to examine




3 This means that, as ∆ goes to zero, the difference between the integral on the right hand side of equation
(6) and its limit one is of order o( D a ) , for some α>0.
                                                                7



the behavior of the transition densities as the sampling interval ∆ goes to zero.4 Condition (7)
does not restrict the observable transition function p ( D, y | x ) for the fixed sampling interval of
the dataset.5 An alternative is to focus on a sufficient characterization for the continuity of
sample paths such as Kolmogorov’s criterion: if there exist three constants β, γ, C >0 such that
as ∆ goes to 0

                                              E È rt +D    - rt ˘˚ £ C D1+g
                                                               b
                                                                                                                (8)
                                                 Î

then the process r (has a version which almost-surely) has continuous sample paths (see e.g.,
Friedman (1975), Theorem 1.2.2). For the same reason, this criterion can not be used either to
form a test: it only restricts the transitions of the process over infinitesimal instants6 and does not
extend to longer time intervals.

          How about checking whether the density is determined by its conditional mean and
variance? The Markov process r is entirely determined by the two functions µ and σ2 defined by
the limits

                               Ï lim     1
                                                        ( y - x ) p ( D, y | x ) dy = m ( x )
                               ÔÔ DÆ0    D Ú y - x <e
                                Ì                                                                               (9)
                                Ô lim    1
                                                        ( y - x ) p ( D, y | x ) dy = s ( x )
                                         D Ú y - x <e
                                                                 2                        2
                                ÓÔ DÆ0

uniformly for x in the interior of D (see e.g., Feller (1971), Section X.4). But this is equally
unhelpful, as it is only true in the limit where ∆ goes to 0. If all discrete transitions were
characterized by the first two moments, then they would all be Gaussian.




4 Testing whether the underlying data generating process is a diffusion might not be a sensible thing to do
with ultra-high frequency data given market microstructure noise (such as bid-ask bounces). This might be
less of an issue with decimalization.

5Since   the Markov property is assumed, we can imply the shorter transitions p(∆/m,y|x), m≥2, from the
longer ones, p(∆,y|x) by solving equation (2), i.e., solving p(∆, y | x) = ∫r p(∆ / 2, y | z )p(∆ / 2, z | x )dz for
                                                                                          r


the function p(∆/2,y|x). To base a test on the behavior of p(∆/m,y|x) as m→∞ would necessitate that this
difficult numerical task be repeated a number of times.
6For  alternative characterizations, all sharing a local character in ∆, see Gikhman and Skorohod (1969),
section IV.5.
                                                  8



D. Transition – Level Characterization of Continuity for Any Sampling Interval

        In light of the above discussion, we would like a characterization of diffusions that
satisfies the following criteria: (D1) the characterization must not rely on observing very fine
transitions in time of the process; (D2) unlike the approaches suggested just above, it must not
require that either we already know what candidate drift and diffusion functions (µ,σ2) to use or
that the discrete transition happen to match those of the small set of diffusions for which a
closed-form solution is available; (D3) it should be based on a necessary and sufficient
characterization of diffusions; (D4) and require that a single property be checked, for the
particular sampling interval ∆ of the available data; (D5) but nevertheless be sufficient to ensure
that the property is satisfied for the longer observable time intervals. By that, I mean that if we
observe the process at say, the daily frequency, and verify that the property holds at that
frequency, then it should automatically be the case that the property is also satisfied at the lower
observable frequencies of one observation every two days, or one every three days, etc.

        So, what works? The approach that I propose to use to discriminate between diffusions
and non-diffusions on the basis of discrete-time information relies on total positivity of order 2
property of the transition function of a diffusion (see Karlin and McGregor (1959b)). This
approach leads to identifying and then verifying the necessary and sufficient condition that the
function p(∆,y|x) must satisfy if it were to correspond to the discrete transition function of a
continuous-time diffusion, without ever requiring that we identify in closed-form the diffusion.
Unless the transition function p(∆,y|x) fails to satisfy that condition, after accounting for the
sampling noise of the estimator if any, the hypothesis that the discrete observations came from a
diffusion will not be rejected.

        What follows is a heuristic approach that delivers the main result of this theory.
Consider two processes {rt , t ≥ 0} and {rt , t ≥ 0} on   » , having the same transition probability
densities p, but otherwise independent. Suppose that rt = x , while rt = x with x < x . The
essential consequence of the continuity of sample paths is that, at any future date t+∆, r cannot
be above r without their sample paths having crossed at least once between t and t+∆. Consider
two potential values at t+∆, y < y , and two sets Y and Y
                                                          such that all values in Y are smaller

               . The probability that r
that those in Y                                       t + D Œ Y
                                        t + D Œ Y and r
                                                                , without their sample paths having

ever crossed between t and t+∆ is (see Figure 2):
                                                             9



                 (
              Pr rt + D Œ Y, rt +D Œ Y,
                                      
                                         {"t Œ [t, t + D],rt π rt } rt = x, rt = x      )
                                (
                         = Pr rt +D     Œ Y, rt +D Œ Y | rt = x, rt = x   )                                (10)

                          - Pr rt +D(    Œ Y, rt +D Œ Y,
                                                       
                                                          {$t Œ [t, t + D] / rt = rt } rt = x, rt = x   )
        To evaluate the second term on the right-hand side, let τ be the first coincidence time
between t and t+∆, i.e., the smallest τ such that rt = rt (see Figure 3). Of course, we do not
actually observe the time τ, since we do not see what happens between t and t+∆; we simply
know that τ exists as part of the event to be evaluated, and that τ is a stopping time by the strong
Markov property discussed above.

        By the reflection principle and the communality of distributions, after time τ, we can no
longer tell which is r and which is r . Therefore we can interchange them as

                 (
              Pr rt + D Œ Y, rt +D Œ Y,
                                      
                                         {$t Œ [t, t + D] / rt = rt } rt = x, rt = x    )
                         = Pr rt +D(    Œ Y, rt +D Œ Y,
                                                      
                                                         {$t Œ [t, t + D] / rt = rt } rt = x, rt = x   )    (11)

                         = Pr rt +D(    Œ Y, rt +D Œ Y | rt = x, rt = x       )
where the last equality follows since the sample paths r and r must have crossed between t and
t+∆, for r, having started below r at t, to finish above it at t+∆. This fact intrinsically
characterizes the continuity of the sample paths. For instance, if the process can have jumps, r
and r may reverse order without ever crossing (see Figure 4).

        Incidentally, Figures 3 and 4 illustrate why the argument is inherently univariate. If the
process can evolve in three dimensions as opposed to being restricted to the plane, then the two
replications r and r can interchange order without jumping, and without ever crossing as they do
in Figure 3. Just imagine in Figure 4 that, instead of representing a jump on the plane, the dotted
part of the path of r represents a bridge that goes continuously over, or under, the path of r. In
that situation, the two paths of r and r remain continuous throughout, yet the two processes have
reversed order without crossing.

        Back now to the univariate case, by independence of r and r , we have

                     ÏPr (rt + D Œ Y, rt +D Œ Y rt = x, rt = x ) = P ( D, Y | x ) P ( D, Y | x )
                     Ô
                     Ì                                                                                         (12)
                     ÔÓPr (rt +D Œ Y, rt +D Œ Y rt = x, rt = x ) = P ( D, Y | x ) P ( D, Y | x )
                                                              10



where P ( D, Y | x ) ∫ Ú         p ( D, y | x ) dx denotes the common cumulative distribution function of
                           yŒY

the two processes.

         Consequently the probability that rt + D Œ Y and rt + D Œ Y
                                                                     , without their sample paths


having ever crossed between t and t+∆, is

                            P ( D, Y | x ) P   (D,Y | x ) - P ( D, Y | x ) P (D,Y | x )
                                                                                           > 0.                (13)


The inequality follows from the fact that the probability of any possible event is positive. For the
inequality to be strict, assume that every transition is possible in the sense that P ( D, Y | x ) > 0 for
every x in D, Y⊂D, and ∆>0, i.e., the process is strict. Otherwise, replace strictly greater by
greater or equal to in inequality (13). Intuitively, this inequality states that the probability that the
relative ranking of r and r remain unchanged, between t and t+∆, is greater than the probability
that their ranking be reversed. If the process is a diffusion, then inequality (13) must be satisfied
for every x < x and Y < Y
                          in the state space.



         Assuming that the density function p ( D, y | x ) is continuous in y for each x, it follows
from inequality (13) that the transition function of any diffusion process must obey the inequality

                  d ( D, y, y | x, x ) ∫ p ( D, y | x ) p ( D, y | x ) - p ( D, y | x ) p ( D, y | x ) > 0   (14)

for any x < x and y < y in D.

E. Properties of the Transition – Level Characterization of Continuity

         I now verify that the total positivity characterization (14) of diffusions satisfies the
criteria that I had set earlier to be the basis of a discriminating criterion for discretely sampled
diffusions. Firstly, inequality (14) is valid for any ∆, not just infinitesimally small ones, so (D1)
is satisfied. Secondly, (D2) is obviously verified as well: unlike condition (5), inequality (14)
makes no reference to the unknown µ and σ2 functions of the diffusion process. I now check that
this inequality is not only necessary, but also sufficient to characterize a diffusion process:

Proposition 1: If its transition densities satisfy the inequality (14) for every ∆>0, then the
process is a diffusion.

         Therefore, if inequality (14) holds for all ∆>0, then the process r has (almost surely)
continuous sample paths. Hence the characterization of diffusions (14) satisfies (D3).
Determining whether the discrete data could have come from a diffusion will be based on
                                                     11



checking the property (14), or its equivalent forms (13) or (15) below, for the sampling interval ∆
corresponding to that of the data, thereby satisfying (D4). All that remains to be proved is that
(D5) is satisfied, i.e.:

Proposition 2: If inequality (14) holds for the sampling interval ∆, then it must hold for longer
observable time intervals as well.

         Thus all five requirements are satisfied. Finally, condition (14) can be expressed in even
simpler terms when the transition function is smooth:

Proposition 3: Assume that p(∆,y|x) is strictly positive and twice-continuously differentiable on
D×D. Then (14) is equivalent to:

                             ∂2
                                  Ln( p( ∆ , y | x )) > 0 for all ∆>0 and (x,y)∈D×D.               (15)
                           ∂ x∂ y

         In the rest of the paper, I will refer to inequality (15) as the “diffusion criterion.” Given a
transition function p(∆,y|x), satisfying (15) is equivalent to the proposition that the underlying
continuous-time model that gave rise to those discrete transitions was a diffusion. For a given ∆,
finding a pair of (x,y) where the criterion fails is sufficient (absent sampling noise) to reject the
hypothesis that the underlying model could have been a diffusion.

         One final remark. We know that if X is a diffusion, then any deterministic, twice-
continuously differentiable and strictly monotonic function of X will also be a diffusion.7 It
would be desirable for the diffusion criterion to also satisfy this invariance property. This is
indeed the case. Namely, we have that:

Proposition 4: The criterion (15) is invariant with respect to Itô transformations of the process.




7 Such transformations are commonly used in finance, for instance to go from an arithmetic Brownian
motion to a geometric Brownian motion, from a Cox-Ingersoll-Ross square-root process to a Bessel
process, from a CEV process (with geometric mean) to a Bessel process, etc. Indeed, most closed-form
solutions we rely on are obtained through such a transformation.
                                                                12



                         II. Interpretation: Discrete-State Processes

A. Continuous-Time, Discrete-State Markov Chains

          To help interpret condition (14), or equivalently (15), and understand its implications for
trees in derivative pricing, consider a continuous-time, stationary, Markov chain that can only
take countable discrete values, say, {...,-1,0,1,...}. When does such a process have continuous
sample paths? Obviously, the notion of continuity of a sample path depends on the state space: in
,    this is the usual definition of a continuous function. More generally, by continuity one means
continuity with respect to the order topology of the state space of the process. In a discrete state
space, the appropriate notion of continuity of the chain’s sample paths is the following intuitive
one: it constraints the chain to never jump by more than one state at a time, either up or down. It
turns out that the restriction on the chain’s transition probabilities analogous to (14)
characterizes precisely this form of continuity.

          Specifically, assume that the Markov chain is right-continuous and let J0,J1,... be the
jump times of the chain X= {X t }t ≥ 0 , defined by

                                                                 {
                                            J 0 = 0, J n +1 = inf t ≥ J n / X t π X J n     }                      (16)

for n=0,1,..., with the convention that inf {               ∆} = •     (see Figure 5). Consider now the restriction
for the transition matrix of the Markov chain that is analogous to condition (14) for the
conditional density of a diffusion, namely

                    (
                  d D, j, j | i, i   )        (                    ) (
                                           ∫ Pr X t + D = j X t = i Pr X t +D = j X t = i         )
                                                                                                                   (17)
                                                    (
                                             - Pr X t +D = j X t    = i ) Pr ( X   t +D   = j X t = i   )   ≥0


for all quadruplets of states such that i < i and j < j , and all real ∆>0 (by stationarity, the
probabilities above are independent of t). The inequality is strict if we further assume that
Pr (X t + D = j X t = i) > 0 for every pair of states (i,j) and every ∆>0. Then we have:8

Proposition 5: Condition (17) is equivalent to the restriction that X can only jump from a given
state to one of the two immediately adjacent states.

          That is, for every state i, there exists 0 £ l i £ 1 such that:9



8   See Karlin and McGregor (1959a) for birth and death Markov chains.
                                                        13



                                                       λ i        if j = i + 1
                                                       
                             Pr ( Yn +1 = j Yn = i ) = 1 − λi     if j = i − 1                  (18)
                                                       0          otherwise
                                                       

For instance, the example in Figure 5 violates the continuity condition (17) at jump times J2 and
J 3.

B. Discrete-Time, Discrete-State Trees

           If we not only discretize the state space but also discretize the time dimension, then the
natural representation of the dynamics of the process takes the form of a tree. Let Yn in this case
denote the state of the process after n moves, i.e., Yn=Xn∆. In full generality, a tree is multinomial
so that if Yn=i is the state after n moves, then Yn+1 can take any one of the possible states. As in
the continuous-time Markov chain with transitions described by equation (18), continuity now
means that the only possible moves occur to the immediately adjacent states or, in tree parlance,
nodes. That is, binomial and trinomial trees are the natural approximation of a diffusion since by
construction they restrict moves to take place to the immediately adjacent nodes. Conversely,
binomial and trinomial trees with branches spaced with the same order of magnitude cannot
approximate discontinuous processes such as jump-diffusions and more general Lévy processes
despite the fact that they are commonly used in practice to price derivatives written on assets
with discontinuous price dynamics. Basically, a jump is a move by one than one state at a time
and, from what precedes, allowing for the possibility of jumps requires non-zero probabilities of
moves to non-adjacent nodes (see Figure 6). I will explore below the implications of this for
option pricing models based on binomial trees.


                                          III. Some Examples

           For now, I return to the continuous-state case of diffusions and give a few examples
illustrating the applicability of the criterion function (15) to discriminate between diffusion and
non-diffusion continuous-time models on the basis of their discrete-time transition functions.




9   Note that λi is independent of n by stationarity.
                                                          14



A. Example 1: Brownian Motion vs. Cauchy Jump Process

           The simplest possible illustration of the applicability of criterion (15) to distinguish a
diffusion from a non-diffusion Markov process is provided by contrasting a Brownian motion,
which has continuous sample paths, with a Cauchy process, which jumps.10 The Brownian
motion density

                            p ( D, y | x ) = (2ps 2 D) -1 / 2 exp   {- (y - x)   2
                                                                                            }
                                                                                     (2s 2 D)      (19)

satisfies (15), since   ∂ 2 Ln(p( D, y | x)) ∂x∂y = 1 (s 2 D) > 0 . However, the Cauchy density

                                                               (
                                     p ( D, y | x ) = ( D p ) (y - x)2 + D 2         )             (20)


does not satisfy (15) --nor, consequently, (7)-- since

                                ∂ 2 Ln(p( D, y | x))    Ê D 2 - (y - x)2 ˆ
                                                     = 2Á 2                <0
                                                        Ë D + (y - x)2 ˜¯
                                                                                                   (21)
                                       ∂ x∂ y

for y sufficiently far apart from x: y - x        > D . However, being Markov processes, they of course
both satisfy the Chapman-Kolmogorov equation (2). They also satisfy the conservation
requirement (6). Figure 7 plots the transition densities and the diffusion criterion (15) for these
two models.

B. Example 2: Variance Gamma Lévy Process

           This example illustrates that the approach applies to all non-diffusion processes – not
just the usual Poisson jumps, but also more general Lévy jump processes. The Variance Gamma
Lévy process is obtained by evaluating a Brownian motion at a random time with Gamma
distribution. The result is a pure jump Lévy process. To create a model for stock prices, let
St = S0 exp (mt + VG t ) where VG t        = BM g . BMt is an arithmetic Brownian motion with drift θ
                                                   t
                   2
and diffusion σ , and γt is a random variable with a Gamma distribution with mean one and
variance ν. The transition density of X t = Ln(St ) given X0 is given by (see Madan, Carr and
Chang (1998)):




10 While   both models have time-homogenous transition densities, neither model is stationary.
                                                                        15


                                                                        D 1

 p ( D, y | x ) =
                       (                         )
                  2 exp z(y | x)q / s 2 Ê z(y | x) 2 ˆ 2 n
                                                                         -
                                                                             4                    Ê z(y | x) 2 (q2 + 2s 2 / n) ˆ
                                                                                 BesselK D      1 Á                             ˜ (22)
                     2psn D / n G ( D / n ) ËÁ q2 + 2s 2 / n ˜¯                                - Á
                                                                                              n 2Ë              s 2
                                                                                                                               ¯˜

where z(y | x) = y - x - mD and BesselKα is the modified Bessel function of the second kind of
order α. Of course, this density violates the diffusion criterion.


        IV. The Implied Model from Option Prices: Is It a Diffusion?

A. The Transition Density Implicit in Option Prices

          I now turn to the empirical question of determining whether the dynamic model for the
underlying asset that is implied by observed option prices could be a diffusion. Suppose that we
are interested in pricing at date zero a derivative security written on a traded underlying asset
                           l              q
with price process X t | t ≥ 0 , and with payoff function                                YbX D g at some future date ∆. Let us
assume for simplicity that the riskless rate r and the dividend yield δ paid by the asset are
constant. It is well-known that when markets are dynamically complete, the only price of the
derivative security that is compatible with the absence of arbitrage opportunities is

                      P0       =   e - rD E   ÈÎ Y (X D )   X0   = x ˘˚ =
                                                                    0        e - rD Ú
                                                                                     0
                                                                                        +•
                                                                                             Y ( x ) p (D, x | x ) dx
                                                                                                               0                 (23)


where p(∆,x|x0) is the transition function (or risk-neutral density, or state-price density) induced
by the dynamics of the underlying asset price.

          Throughout this section, whenever I refer to the implied dynamics, or the implied model,
I refer to their risk-neutral version. Note however that because the risk-neutral and actual
probability measures assign zero probability to the same events (they have the same null sets),
the underlying asset does not jump under one set of probabilities if and only if it does not jump
under the other. So if we do not reject the null hypothesis that the underlying asset is a diffusion
under the risk-neutral measure, then it must also be a diffusion under the actual probability
measure. Conversely, if we reject it under the risk-neutral measure, then the underlying asset
must be allowed to jump under the actual probability measure as well.

          The Black-Scholes option pricing formula is the prime example of equation (23), when
the underlying asset is a diffusion with σ(x) = σ x, σ constant. The corresponding transition
density is the lognormal density
                                                                  16



                p BS ( D, x | x 0 ) =
                                             1
                                          2pDsx
                                                   exp   {- (   Ln(x / x 0 ) - (r - d - s 2 / 2) D   ) (2s D)}
                                                                                                     2    2
                                                                                                                 (24)


and so the integral in equation (23) can be evaluated explicitly for specific payoff functions, such
as the call option’s      Y (X D ) = max (0, X D - K ) for a fixed strike price K:
                                                                     {
                                   H BS ( D, K, x 0 , s ) = e - rD FD F (d1 ) - KF (d 2 )    }                   (25)


where FD = x 0 exp {(r - d) D} is the forward price for delivery of the underlying asset at date ∆
           (                                )
and d1 = Ln(K / x 0 ) + (s 2 / 2) D (sD1 / 2 ) , d 2 = d1 - sD1 / 2 .

          At this point, the common practice when pricing and hedging equity options is to
describe the market prices of call options for a given maturity ∆ as given by the parametric
equation (25) except that the volatility parameter for that maturity is a smooth function
s IMP (K / FD ) of the option's moneyness M = K / FD :

                                        H ( D,K, x 0 ) = H BS    (D,K, x , s (K / FD )) .
                                                                          0   IMP                                (26)


The function        s IMP (K / FD ) is often known as the “implied volatility smile.” A direct
differentiation of the basic no-arbitrage pricing equation (23) with respect to the strike price,
yields the corresponding risk neutral density.11

          In the present setup, the only transition function compatible with the observed option
prices H must be

                              ∂2
      p ( D, K | x 0 ) = e rD     H ( D, K, x 0 )
                             ∂K 2
                              ∂2
                      = erD 2 H BS ( D, K, x 0 , s IMP (K / FD ))                                      (27)
                             ∂K
                             Ï ∂2H        2 ds IMP ∂ 2 H BS 1 Ê ds IMP ˆ ∂ 2 H BS 1 d 2 s IMP ∂H BS ¸Ô
                      = erD ÔÌ BS
                                                                        2
                                      +                    +                     + 2                 ˝
                            ÔÓ ∂K
                                   2
                                         FD dM ∂K∂s FD2 ÁË dM ˜¯ ∂s 2             FD dM 2 ∂s Ô˛




11See Banz and Miller (1978) and Breeden and Litzenberger (1978), and Aït-Sahalia and Lo (1998) for a
nonparametric version.
                                                                17



B. Telling Whether the Implied Dynamic Model is a Diffusion

         I now turn to an empirical implementation of formula (27) with option price data. Option
prices, or equivalently their implied volatilities, give us the function H in equation (26). Then
equation (27) gives us the transition function for one maturity ∆ implicit in the cross-section of
option prices at one point in time. I will then check whether this transition function is compatible
with an underlying diffusion model for the asset price by applying the criterion (15) to that
implied transition function.

         The data come from the Chicago Board Options Exchange (CBOE) and represent price
quotes for call and put options on the Standard & Poor's 500 Index (SPX). The options are
European, and to illustrate the methodology, I will focus on a single randomly chosen trading
day, March 19, 2001. I repeated the experiment on different days, drawn from different time
periods, to insure the robustness of the findings; the results are similar. I report the results for the
most complete cross-section of traded strikes that day, the June 2001 expiration. Table I contains
the full dataset used in the empirical application.

         The raw data present three challenges. First, future dividends are not observable; second,
S&P 500 futures are traded on the Chicago Mercantile Exchange, and cannot easily be time-
stamped synchronously with the options to obtain F∆; and third, there are often substantial
differences in the traded volume and open interest in the call and put with the same strike and
maturity, except near the money where both are usually very liquid. I solve the first problem by
relying on the spot-forward parity relationship under which the left hand side of equation (26)
depends on the dividend yield δ only through F∆. To solve the second problem, I use prices of at-
the-money options, where both the put and call are liquid, to infer the value of the implied
futures F∆ according to put-call-parity:

                                                        {
                                  FD = K + e - rD H ( D, K, x 0 ) - G ( D, K, x 0 ) }                          (28)


where G denotes the put price and K is the strike closest to being at-the-money. Note that this
equation does not require that the spot price of the index be recorded; it simply requires the
market prices of the at-the-money call and put. Given the futures price F∆, I then replace the
prices of all illiquid options, with the price implied by put-call parity applied at each value of the
strike price, using the price of the more liquid option. For instance, if the put is more liquid then
the   call    price     is   inferred          from      that    of   the   put   with   the   same   strike     as
H ( D,K, x 0 ) = G ( D, K, x 0 ) + e   rD
                                            (FD - K )   (this equation is instead solved for G given H when the
call is more liquid). This solves the third problem. After this procedure, all the information
                                                      18



contained in liquid put prices has been extracted and resides in corresponding call prices. I can
now concentrate exclusively on call options.

            The first step consists in estimating the implied volatility function              s IMP (K / FD ) in
equation (26) . The data reveal quite clearly that an appropriate model for the implied volatility
smile is a simple third order polynomial:

                       s IMP (K / FD ) = b0 + b1 (K / FD ) + b2 (K / FD ) + b3 (K / FD ) .
                                                                        2                3
                                                                                                             (29)

In fact, Table II shows that this model fits the data so well (R2 = 0.99!) that one cannot help but
wonder whether self-fulfilling prophecies are at play here. The same is true of other trading days
and maturities in this market: the estimated parameters change, but not the quality of the fit.
These options do indeed appear to “trade on a curve,” the curve which is displayed in the top
part of Figure 8. In the same way that in the 1970s and pre-1987 1980s the Black-Scholes model
in its standard constant volatility form was a reasonably well-accepted paradigm, the current
pricing model appears to be well-represented by equation (29) or slight variations of it, including
for instance slightly different definitions of moneyness. The bottom plot in Figure 8 reports the
estimated transition function from equation (27) corresponding to the implied volatility smile in
the top plot.

            I then apply the diffusion criterion (15) to test whether the underlying continuous-time
model that produced the observed discrete-time transition represented by the function
p( D, K | x 0 )   could have been a diffusion. Figure 9 displays the criterion function
∂ Ln(p( D, K | x 0 )) ∂x 0 ∂K , which gives the answer: the criterion function is negative in places,
 2


hence the underlying model for the S&P 500 index cannot be a diffusion.

            Could the sampling noise, introduced by the fact that we need to estimate the parameters
{s i | i = 0,...,3} in equation (29), be sufficient to overturn the rejection of the diffusion
hypothesis? The fact that model (29) describes the data in an accurate yet parsimonious way
suggests that this is unlikely, but let us verify this formally. The effect of the estimation of the
implied volatility parameters in equation (29) on the accuracy of the transition density estimator
resulting from equation (27) can be assessed by the delta method. The parameter vector β is
estimated using a sample of size n from the regression                      s = s IMP (K / FD ) + e , of implied
volatilities σ on moneyness K / FD ; ε is white noise with variance s2 and M denote the vector of
                                                                                                (
observed K / F . The distribution of the parameter estimates b̂ is n1/ 2 (bˆ - b) Æ N 0, V , where
                  D                                                                                  b   )
                  -1
Vb = s (M 'M) . From this it follows that
        2
                                                           19



                     Ê ∂ 2 Ln(p(
                              ˆ D, K | x 0 )) ∂ 2 Ln(p( D, K | x 0 )) ˆ
                n1/ 2 Á                      -                        ˜ æææd
                                                                              Æ N (0, D '.Vb .D )
                     Ë        ∂K∂x 0                 ∂K∂x 0           ¯  n Æ•




where D denotes the gradient of         ∂ 2 Ln(p( D, K | x 0 )) ∂x 0 ∂K with respect to the parameter vector
β, and D’ the transposed vector. D is easily calculated from equation (27).

           A formal test can be based on calculating the minimum value reached by the criterion
function     ∂ 2 Ln(p( D, K | x 0 )) ∂x 0 ∂K over the interval of traded strikes (K, K ) . Define this
minimum, as a function of the parameters of the implied volatility smile, to be λ(β). Let κ(β) be
the strike level at which this minimum is reached, i.e., the solution of the first order condition for
the   minimization         of    the    criterion      function.       The   minimum    value       is   l (b) ∫
∂ Ln(p( D, k (b) | x 0 )) ∂x 0 ∂K . Keep differentiating each operation with respect to β to get to the
 2


gradient —l of the minimum λ(β) with respect to β. Then again by the delta method,


                                    (              )
                                n1/ 2 l (bˆ ) - l (b) æææd
                                                       n Æ•        (
                                                            Æ N 0, —l ¢.Vb .—l .  )                         (30)


Given estimates b̂ and V̂b of the implied volatility smile, we calculate lˆ ∫ l (bˆ ) (negative
                                     ˆ ∫ —l ¢.V
otherwise there is no rejection) and V        ˆ .—l by evaluating the gradient at b̂ . Then the
                                               l            b
probability that the diffusion null hypothesis is true in the one-sided test of H 0 : l (b) ≥ 0 against
H1 : l (b) < 0 is given by


                          (
                     Prob H 0 true | lˆ ,V )           (
                                         ˆ = Prob l > 0 | lˆ , V
                                          l                            )      (
                                                               ˆ = 1 - F - n1/ 2 V
                                                                l                 l        )
                                                                                 ˆ -1/ 2 lˆ .               (31)


where Φ is the standard Normal cumulative distribution function.

           Not surprisingly, I find empirically that this noise is insufficient by itself to account for
the negativity of the criterion function, i.e., the probability (31) is essentially zero, with the
minimum value l̂ being negative and approximately ten times larger than its standard error
n -1/ 2 V
       l
        ˆ 1/ 2 . The rejection of the diffusion hypothesis follows.12 Given the quality of the fit of the
implied volatilities, it is not surprising that the sampling noise is not sufficient to overturn the




12 The situation would be quite different if the implied volatility model (29) were nonparametric, since we
would then be subjected to the curse of differentiation in equation (27) and the sampling noise would be
substantially greater. But given the fit of the basic parametric model, there seems to be no need for
additional flexibility when modeling implied volatilities, at least with S&P 500 index options during that
time period.
                                                                    20



rejection, i.e., to make the negativity of ∂ 2 Ln(p( D, K | x 0 )) ∂x 0 ∂K                               become statistically
insignificant.

          One last remark. Recall that the test for diffusion relies on a one factor assumption for
the underlying asset returns. Could it be that rejecting that the underlying asset returns came
from a diffusion is due to that univariate maintained hypothesis? The answer is no. Suppose that
the model for the underlying asset price involves two factors, X as before and Y. For
concreteness, think of Y as representing either another asset or X’s stochastic volatility. Let
p ( D, x, y | x 0 , y0 ) be the corresponding transition density. The price of a derivative contract with
payoff dependent on X∆ is

                              P0 = e - rD E ÈÎ Y (X D ) X 0 = x 0 , Y0 = y0 ˘˚
                                                  +• +•
                                   = e - rD Ú       Ú     Y ( x ) p ( D, x, y | x 0 , y 0 ) dxdy
                                             -• 0
                                            +•  +•
                                   = e - rD -• 0 Y
                                           Ú Ú                  {   +•
                                                            ( x ) Ú-• p ( D, x, y | x 0 , y0 ) dy  }dx
                                               +•
                                   = e - rD Ú Y ( x ) p ( D, x | x 0 , y 0 ) dx
                                              0

                                          +•
where now p ( D, x | x 0 , y 0 ) ∫ Ú           p ( D, x, y | x 0 , y0 ) dy represents the marginal in x from the
                                         -•
conditional density of (x,y) given (x0,y0). Since the conditioning information is irrelevant in
equation (27), the density extracted by the method of equation (27) should therefore be
p ( D, x | x 0 , y0 ) instead of p ( D, x | x 0 ) .

          Hence if there were an additional factor, it should appear in the conditioning set of that
density. For that, it should appear in the pricing formula H. Given that H is given by equation
(26), the only place an additional factor could enter would be in the function                              s IMP , i.e., in the
market-driven implied volatility smile. So to the extent that the market prices options using a
deterministic smile model (the function                 s IMP which does not depend upon a second factor), and
the evidence suggests that this is an accurate description of the reality (recall that R2 = 0.99 for
model (29)), the transition density implied by the market data will be a function of (x,x0) only,
not (x,x0,y0). By contrast, it is clear that trying to model the evolution in time of the transition
density would undoubtedly require additional factors.
                                                  21



C. Consequences for Approximations of the Dynamics of the Underlying Asset and
Implied Models

        Dupire (1994) showed that, if the underlying model is a diffusion, then the call pricing
function H t ( D, K, x 0 ) for maturity ∆ at instant t necessarily satisfies the following forward form
of the no-arbitrage pricing partial differential equation

                          ∂H t              ∂H 1 ∂ 2 H t
                               = − {r − δ} K t +         σ(K, t) 2 K 2 − δH t                     (32)
                           ∂∆               ∂K 2 ∂K 2

from which it follows immediately that the “implied volatility function” compatible with the call
pricing function is

                                   ∂H           ∂H          1 ∂ Ht 2 
                                                                  2
                      σ2 (K, t) =  t + {r − δ} K t + δH t          K .                        (33)
                                   ∂∆           ∂K          2 ∂K
                                                                    2
                                                                        

Dumas, Fleming and Whaley (1998) used this methodology to empirically test different
specifications of the function σ2 against option data.

        The analysis of the preceding section shows that, in light of the options data, there exists
no such implied volatility function no matter how general it is allowed to be, since the
underlying model is not a diffusion. In other words, the right hand side of (33) will not produce a
function of (K,t) only. An appropriate modification of equation (32) allowing for discontinuities
in the sample paths of the underlying asset would have to include difference terms (in addition
to, or instead of, the differential terms).

        Derman and Kani (1994) and Rubinstein (1994) propose binomial and trinomial tree
approximations to the risk-neutral dynamics of the underlying asset that, by construction,
replicate the observed option prices. Combining the empirical result of this section –that the
underlying model is not a diffusion—with the characterization of tree approximations for
continuous path processes in Section II.B, the conclusion is that these implied trees should be
extended to more than three path possibilities at each node in order to be approximate
discontinuous price paths. Otherwise, their continuous-time limit is constrained to be a
continuous path process which we have seen is not the case empirically.

        Therefore, contrary to the common practice in derivative pricing, jump-diffusion
processes should be approximated by multinomial trees with more than three branches at least at
some of their nodes. Of course, a binomial or trinomial tree could approximate a jump process
                                                              22



but only if at least one of the branches leads to a discrete change in the asset value, i.e., a change
of order 1. This is not usually the case when trees are used in practice: the branches are often
equally spaced, or at least the price changes from one node to the next over a time interval of
length ∆t are continuous in magnitude, i.e., of order                  ∆t .

D. Structural Alternatives to Implied Volatility Smiles

          Modeling option prices by an implied volatility smile is inherently a purely descriptive
approach. It is a very accurate description of actual market prices, but nevertheless remains a
reduced-form approach. One of the main structural alternatives to the implied smile approach
consists in extending the Black-Scholes in a variety of possible directions, which all involve
relaxing the Normality assumption for the underlying asset returns that is built into equation (24)
for the price density.

          Consider first the ad hoc Edgeworth expansions that have been proposed in the
literature.13 These expansions replace the Normal density for returns with an Edgeworth
expansion that allows for excess skewness and kurtosis in risk-neutral asset returns. If the stock
price is S, the riskless rate r, σ the standard deviation of the stock return, and µ3 and µ4 denote
the standardized skewness and kurtosis respectively, these expansions for the log-returns are
typically in the form


                    p ( D, x | x 0 ) =
                                            {        }
                                         exp - z 2 / 2 Ê m3 3
                                                         1+        (  m
                                                                              )       ( ˆ
                                                              z - 3z + 4 z 4 - 6z 2 + 3 ˜   )
                                             2p
                                                       Á
                                                       Ë    6         24                ¯
                                                                                                 (34)


where

                                                              x - x0   - ( r - s 2 / 2) D
                                     z = z ( D, x | x 0 ) =
                                                                        s D

with x = Ln(S∆) and x0 = Ln(S0). Given equation (34), option pricing formulae can be obtained
by applying equation (23) with the density p for prices replaced by its implication from the
returns density (34).

          Note that the transition density p(∆,x|x0) in this model is a function of (x,x0) only
through z = x – x0. Note that, beyond option pricing, this form of space-homogeneity has




13   See for example Jarrow and Rudd (1982).
                                                             23



important statistical consequences when combined with time-homogeneity. Even if the model is
not stationary, its first differences are, thereby making the analysis of maximum-likelihood
estimators substantially simpler. Indeed, treating the first observation as fixed, the likelihood
function is

                   n (q ) ∫   Â i =1 Ln {pq (D, riD | r(i -1) D )} = Â i =1 Ln {pq ( D, riD - r(i -1) D )}
                                  n                                      n
                                                                                                              (35)


and in the latter form involves only the data (ri∆ - r(i-1)∆).

         But could equation (34) represent the transition density of a diffusion? In other words,
we need to find out what are the diffusions with space-homogeneous transition functions. Using
the diffusion criterion, it turns out that the class of such processes is rather small:14

Proposition 6: The only diffusion with a space-homogenous transition function is the
(arithmetic) Brownian motion, i.e., the process with σ(x) = σ and µ(x) = µ both constant.

         The Edgeworth expansion (34) is in the space-homogenous class p(∆,x|x0) = q(∆,x-x0).
But from Proposition 6 the Gaussian distribution is the only diffusion process with a space-
homogeneous transition function q(∆,x-x0). Hence there is no diffusion model for the underlying
stock returns that can be represented by these ad hoc expansions, other than the Gaussian density
for which µ3 = µ4 = 0. Note that this is not just saying that equation (34) is not, in general, a
proper density. There is just no density, other than the Gaussian, that can represent a diffusion
and be space-homogeneous.15

         This leads quite naturally to the next idea. How about maintaining the Gaussian
assumption but making the conditional mean and variance more complex than in the Black-
Scholes model? Could that accommodate a diffusion process? Unfortunately, the answer is, here
too, negative. Suppose that we restrict attention to processes with Gaussian distributions, and use




14 The result can be obtained differently by calculating the Laplace transform of a Polya frequency density
of order 2 (see Karlin (1968, Chapter 7) for definitions and Theorem 5.2).
15 Since the transition density of the Variance Gamma Lévy process is space-homogeneous but not
Gaussian, it cannot represent the transition function of a diffusion. However, the function p(∆,K|x0)
produced by equation (27) is not a function of K – x0. Hence Proposition 6 cannot be applied to rule out
immediately the possibility of an underlying diffusion model when using an implied volatility smile. We
must use the diffusion criterion (15) to be able to tell.
                                                       24



the results here to prove differently a well-known result regarding Markov processes with
Gaussian transitions. Namely, we have:

Proposition 7: The Ornstein-Uhlenbeck process

                                         dX t = (a   - b X t ) dt + s dZt                                  (36)

is not only the only diffusion with a Gaussian transition function, but also the only such Markov
process.

         The conditional mean and variance of the process are affine and constant respectively,
E[X t + D | X t = x] = a / b + (x - a / b)e -bD and V[X t + D | X t   = x] = s 2 (1 - e -2bD ) 2b , which reduce
to E[X t + D | X t = x] = x and V[X t +D | X t   = x] = s 2 D if β=0 (the arithmetic Brownian motion
special case). The implication of this for potential structural extensions of the Black-Scholes
model wishing to remain within the diffusion class is that, in the same fashion that the model
cannot be extended to non-Gaussian but space-homogenous densities, it cannot be extended
either to Gaussian densities with conditional mean and variances that are more complex than
affine and constant respectively. The latter extension would in fact take us even outside of the
Markov class in which case pricing via risk-neutral expectations conditioned on the current asset
price given by equation (23) no longer holds.


                                            V. Conclusions

         Within the Markov world, diffusion processes are characterized by the continuity of their
sample paths. When looking at discrete data, are the discontinuities observed the result of
discreteness, or are they the result of non-diffusion behavior on the part of the underlying
continuous-time data-generating process? This paper examined the implications for the discrete
data of having been generated by a univariate diffusion, on the basis of a criterion that uniquely
characterizes the transition densities of diffusions, and is equivalent to continuity of the
continuous-time, unobservable, sample paths. It relies solely on the transition function, an object
that can be inferred from the discrete observations.

         I also interpreted this characterization in terms of discrete-state processes, first
continuous-time Markov chains and then discrete-time trees. The intuitive result is that the
characterization is this case means that the process can only jump by one state at a time. I then
drew some implications for the approximations used in derivative pricing, depending upon
whether the underlying model is or is not a diffusion. Finally, I tested whether the underlying
                                                     25



model for the asset price dynamics that is implied by S&P 500 option prices could have been a
diffusion, and spelled out some implications for the implied diffusion, implied tree and
Edgeworth expansions approaches to option pricing.

         One final remark. From a discretely sampled time-series {r0 , rD , r2 D , …, r
                                                                                      nD   } , one could
test nonparametrically the hypothesis that the data were generated by a continuous-time diffusion
{rt , t ≥ 0} . Formally,
                           ÔÏH 0 : ∂ 2 Ln(p( D, y | x)) ∂x∂y > 0   for all x, y
                            Ì
                            ÔÓH1 : ∂ 2 Ln(p( D, y | x)) ∂x∂y £ 0   for some x, y

and one could base a test on checking whether (15) holds for a nonparametric estimator of the
density p ( D, y | x ) . Locally polynomial estimators can be used for that purpose (see Aït-Sahalia
(2000)). Their use in the present context is left to future work.
                                               26




                                         References


Ahn, Chang Mo and Howard E. Thompson, 1988, Jump-diffusion processes and the term
structure of interest rates, Journal of Finance 43, 155-174.
Aït-Sahalia, Yacine, 1996a, Nonparametric pricing of interest rate derivative securities,
Econometrica 64, 527-560.
Aït-Sahalia, Yacine, 1996b, Testing continuous-time models of the spot interest rate, The Review
of Financial Studies 9, 385-426.
Aït-Sahalia, Yacine, 1997, Maximum-likelihood estimation of discretely-sampled diffusions: A
closed-form approximation approach, Econometrica, forthcoming .
Aït-Sahalia, Yacine, 1999, Transition densities for interest rate and other nonlinear diffusions,
Journal of Finance 54, 1361-1395.
Aït-Sahalia, Yacine, 2000, Testing the Markov hypothesis in discretely-sampled continuous-time
processes, Working paper, Princeton University.
Aït-Sahalia, Yacine, and Andrew Lo 1998, Nonparametric estimation of state-price-densities
implicit in financial asset prices, Journal of Finance 53, 499-547.
Aït-Sahalia, Yacine, Yubo Wang, and Francis Yared, 2001, Do option markets correctly price
the probabilities of movement of the underlying asset?, Journal of Econometrics 102, 67-110. .
Banz, Rolf, and Merton Miller, 1978, Prices for state- contingent claims: Some estimates and
applications, Journal of Business 51, 653-672.
Breeden, Douglas, and Robert H. Litzenberger, 1978, Prices of state-contingent claims implicit
in option prices, Journal of Business 51, 621-651.
Bates, David, 1991, The crash of '87: Was it expected? The evidence from options markets,
Journal of Finance 46, 1009-1044.
Cox, John C., John E. Ingersoll, and Stephen A. Ross, 1985, A theory of the term structure of
interest rates, Econometrica 53, 385-407.
Das, Sanjiv R. and Silverio Foresi, 1996, Exact solutions for bond and option prices with
systematic jump risk, Review of Derivatives Research 1, 7-24.
Duffie, Darrell, Jun Pan, and Kenneth Singleton, 2000, Transform analysis and asset pricing for
affine jump-diffusions, Econometrica 68, 1343-1376.
Dumas, Bernard, Jeffrey Fleming, and Robert E. Whaley, 1999, Implied volatility functions:
Empirical tests, Journal of Finance 53, 2059-2106.
Derman, Emanuel, and Iraj Kani, 1994, Riding on the smile, RISK 7, 32-39.
Dupire, Bruno, 1994, Pricing with a smile, RISK 7, 18-20.
Feller, William, 1954, The general diffusion operator and positivity preserving semi-groups in
one dimension, Annals of Mathematics 60, 417-436.
Feller, William, 1971, An Introduction to Probability Theory and Its Applications, Volume II,
Second Edition (John Wiley & Sons, New York).
                                               27



Florens, Jean-Pierre, Eric Renault, and Nizar Touzi, 1998, Testing for embeddability by
stationary scalar diffusions, Econometric Theory 14, 744-769.
Friedman, Avner, 1975, Stochastic Differential Equations and Applications, Volume 1
(Academic Press, New York).
Gikhman, I.I. and A.V. Skorohod, 1969, Introduction to the Theory of Random Processes (W.B.
Sauders Company, Philadelphia).
Hansen, Lars Peter, José A. Scheinkman and Nizar Touzi, 1998, Identification of scalar
diffusions using eigenvectors, Journal of Econometrics, 86, 1-32.
Jarrow, Robert and Andrew Rudd, 1982, Approximate option valuation for arbitrary stochastic
processes, Journal of Financial Economics 10, 347-369.
Karlin, Samuel, 1968, Total Positivity, Volume I (Stanford University Press, Stanford).
Karlin, Samuel and James McGregor, 1959a, Coincidence properties of birth-and-death
processes, Pacific Journal of Mathematics 9, 1109-1140.
Karlin, Samuel and James McGregor, 1959b, Coincidence probabilities, Pacific Journal of
Mathematics 9, 1141-1164.
Kou, Steven, 1999, A jump diffusion model for option pricing with three properties: leptokurtic
feature, volatility smile, and analytical tractability, Working paper, Columbia University.
Madan, Dilip B., Peter P. Carr and Eric C. Chang, 1998, The variance Gamma process and
option pricing, European Finance Review 2, 79-105.
Mandl, Petr, 1968, Analytical Treatment of One-Dimensional Markov Processes (Springer-
Verlag, Berlin).
Merton, Robert C., 1976, Option pricing when underlying stock returns are discontinuous,
Journal of Financial Economics 3, 125-144.
Norris, James R., 1997, Markov Chains (Cambridge University Press, Cambridge, U.K.).
Ray, Daniel, 1956, Stationary Markov processes with continuous paths, Transactions of the
American Mathematical Society 82, 452-493.
Rubinstein, Mark, 1994, Implied binomial trees, Journal of Finance 49, 771-818.
Vasicek, Oldrich, 1977, An equilibrium characterization of the term structure, Journal of
Financial Economics 5, 177-188.
                                                             28



                                                     Appendix


Proof of Proposition 1

         To prove this claim, it suffices to show that (14) implies that the convergence in (7) is
uniform in x , which is known to be a necessary and sufficient condition for the continuity of the
sample paths. Let I be a compact interval included the domain D=( r , r ) of the process r. That
(7) holds for every fixed e > 0 and fixed x in I is fairly innocuous. Indeed, assume (this is a mild
additional requirement) that the convergence in the limit (6) occurs at an arbitrary polynomial
rate, that is

                   P ( D,(r, x - e) » (x + e, r ) | x ) = 1 - Ú              p ( D, y | x ) dy   £ ce ,x D k   e ,x
                                                                                                                               (37)
                                                                  y - x £e



for some constants cε,x>0 and κ>0 (κ is not necessarily greater or equal to 1). Then it follows
from (13) that

                 P ( D,(x + e, r ) | x ) P ( D,(x + e / 4, x + 3e / 4) | x + e / 2)
                                                                                                                               (38)
                                     £ P ( D,(x + e / 4, x + 3e / 4) | x ) P ( D,(x + e, r ) | x + e / 2)

From (37), we have that

                                   ÏÔP ( D,(x + e / 4, x + 3e / 4) | x ) £ ce / 4,x D k
                                    Ì
                                    ÔÓP ( D,(x + e, r ) | x + e / 2) £ ce / 2,x +e / 2 D
                                                                                         k




and, since from (6) there exists z >0 such that P ( D,(x + e / 4, x + 3e / 4) | x + e / 2)                            ≥ 1/ 2 for all
0 £ D £ z , it follows from (38) that P ( D,(x + e, r ) | x )                 £ 2 d x,e D   2k
                                                                                                 for some constant dε,x>0.
This process can be repeated an arbitrary number of times, each time multiplying the constant κ
by a factor of 2. Therefore the constant κ can be replaced by 1, or for that matter any number, but
1 will be sufficient in what follows.

         The crucial aspect now is to prove the uniformity of the convergence in x. Fix ε>0 and
let x 0 < x1 <   …< x   m   be a finite partition of I, such that x i - x i -1 = e 2 for i=1,...,m. Fix e >0.
From what precedes wit κ now replaced by 1, for each i=1,...,m, there exists ξi>0 such that for all
∆, 0 £ D £ xi implies P ( D,(x i     + e 2, r ) | x i ) £ (e 2) D . For x in I, consider the particular xi such
that x - e   2 < x i -1 £ x < x i < x + e 2 . For 0 £ D £ xi , it follows from (13) that
                                                                           29



              P ( D,(x + e, r ) | x ) P ( D,(r, x + e) | x i ) £ P ( D,(x + e, r ) | x i ) P                  (D,(r, x + e) | x )
                                                                            £ P ( D,(x + e, r ) | x i )
                                                                                                                                      (39)
                                                                            £ P ( D,(x i + e 2, r ) | x i )
                                                                            £ (e 2) D

         Now, from (6), there exists zi >0 such that P ( D,(r, x i -1 + e) | x i ) ≥ 1 2 for all 0 £ D £ zi .
Next, for ∆ satisfying 0 £ D £ inf {hi , zi } , we have that P ( D,(x + e, r ) | x )                                            £ eD
                                                                                                                                    since
P ( D,(r, x + e) | x i ) ≥ P ( D,(r, x i -1 + e) | x i ) . Now define
                                                                  hI ∫ inf {{xi , zi }| i = 1, , m} , which is              …
independent of the particular x in I. Thus there exists hI >0 such that for any 0 £ D £ hI ,
 P ( D,(x + e, r ) | x ) £ eD
                               for all x in I. Similarly, there exists c I >0 such that for any 0 £ D £ c I ,
 P ( D,(r, x - e) | x ) £ eD
                             for all x in I. Since


                   Ú y-x        p ( D, y | x ) dy      = P ( D,(r, x - e) | x ) + P ( D,(x + e, r ) | x ) £ 2eD
                                                                                                              ,
                           >e



it follows that the convergence in (7) holds uniformly over x in the compact interval I.

Proof of Proposition 2

         First recall that diffusions are Markov processes, hence they must satisfy the Chapman-
Kolmogorov equation (2). Therefore

          d ( 2 D, y, y | x, x ) = Ú         p ( D, y | z ) p ( D, z | x ) p ( D, y | z ) p ( D, z | x ) dzdz
                                            r     r

                                          r Úr

                                               p ( D, y | z ) p ( D,z | x ) p ( D, y | z ) p ( D, z | x ) dzdz
                                            r     r
                                      -Ú
                                          r Úr


                                                Úr d ( D, y, y | z,z ) p ( D, z | x ) p ( D,z | x ) dzdz
                                           r      r
                                     = Úr

                                                     d ( D, y, y | z, z ) ÈÎ p ( D,z | x ) p ( D, z | x )
                                           r      r
                                     =Ú
                                         r Úr, z < z  


                                                                                 - p ( D,z | x ) p ( D, z | x )˘˚ dzdz


where we have exploited the symmetry property that d ( D, y, y | z,
                                                                   z ) = - d ( D, y, y       ) for any
                                                                                       | z, z

(z, z ), so we only need to integrate over the half-quadrant where z< z . As a result

                     d ( 2 D, y, y | x, x ) =           Úr Úr, z <z d ( D, y, y | z, z ) d ( D, z,z | x, x ) dzdz
                                                            r   r
                                                                                                                           >0         (40)
                                                                    




since (14) holds for all transitions of length ∆. The same argument shows that the property is
satisfied for all integer multiples of ∆, i.e., for all observable frequencies.
                                                               30



Proof of Proposition 3

        Consider x < x                  and y < y . Rearranging inequality (14) yields the equivalent
formulation

          1    Ê Ï Ln(p( D, y | x))
                                     - Ln(p( D, y | x)) ¸ Ï Ln(p( D, y | x))
                                                                               - Ln(p( D, y | x)) ¸ˆ
               Á Ì                                        ˝ -Ì                                     ˝˜¯ > 0 . (41)
        y - y Ë Ó                 x - x                 ˛ Ó                x - x                ˛

The necessity of (15) then follows by taking the limit as x                       Æx    +
                                                                                             and y Æ y + in (41). The
sufficiency of (15) follows from the fact that a function whose derivative is positive is
                                     ∂        ∂
increasing: at a fixed x, Ln(p) x is an increasing function of y, hence ∂Ln(p( D, y | x)) ∂x >
∂Ln(p( D, y | x)) ∂x . Thus {Ln(p(D, y | x)) - Ln(p(D, y | x))} {y - y} is an increasing function of
x. Then (41), or equivalently (14), follows.

Proof of Proposition 4

        We want to show that, if condition (15) is satisfied by the transition density pX of a
process X, then the same condition is fulfilled by the transition density pY of the process
Y = j -1 (X) where the function               j is twice continuously differentiable and strictly monotonic.16
Indeed the transition density of Y is given by the Jacobian formula:

                                ∂                                ∂
          p Y ( D, y | y 0 ) =    Prob (Yt + D £ y Yt = y0 ) =      Prob ( X t + D £ j(y) X t = j(y0 ))
                               ∂y                               ∂y
                                                                                                                   (42)
                                ∂ j (y)
                              = ÈÍ Ú p X ( D, x | j(y0 )) dx ˘˙ = j '(y) p X ( D, j(y)| j(y0 ) )
                               ∂y Î                           ˚

Consequently, if X is a diffusion then d X ( D, x | x 0 ) ∫ ∂ 2 Ln(p( D, y | x)) ∂x∂y > 0 from condition
(15) and it follows from equation (42) that

                                      ∂2
              d Y ( D, y | y 0 ) ∫           Ln(p Y ( D, y | y 0 )) = j '(y)j '(y0 )d X ( D, j(y) | j(y0 ) ) > 0   (43)
                                     ∂y 0 ∂y

so the transition function of the Y process automatically satisfies condition (15).




16 Such transformations are commonly used in finance, for instance to go from an arithmetic Brownian
motion to a geometric Brownian motion, from a Cox-Ingersoll-Ross square-root process to a Bessel
process, from a CEV process (with geometric mean) to a Bessel process, etc. Indeed, most closed-form
solutions we rely on are obtained through such a transformation.
                                                             31



Proof of Proposition 5

         With J0,J1,... denoting the jump times of the chain X= {X t }t ≥ 0 , and S1,S2,... its holding
times, defined by

                                             ÏJ n - J n -1            if J n -1 < •
                                      Sn = Ì                                                              (44)
                                             Ó•                       otherwise

right-continuity forces Sn>0 for all n. If Jn+1=∞ for some n, define X • ∫ X J n , otherwise X∞ is
undefined. For convenience, we set Xt=∞ if t is greater than the first explosion time
                      •
sup {J n / n ≥ 0} = Â n =1 Sn .

         From the theory of continuous-time Markov chains (see e.g., Norris (1997), page 87),
condition (18) on the transition matrix of the jump chain Y is equivalent to the restriction that
the generator matrix A of the Markov chain X be of the Jacobi form: zero entries except on the
diagonal, supra-diagonal and infra-diagonal lines, i.e.:

                                Ê                ˆ
                              A=Á       0 b -a -b a 0  ˜˜                                               (45)
                                Á
                                                  ¯
                                                   i              i   i             i

                                Ë

where αi>0, β i>0 and then l i = ai (ai + bi ) . The element [aij] of A determines the rate at which
the chain moves from state i to state j.

         To prove that (17) is equivalent to (45), first note from (2) --where the integral is
replaced by a sum over all the possible intermediary states-- that it suffices to prove the
equivalence for an infinitesimal ∆, and the equivalence will then be carried forward in time by
repeated use of (2). Next express the transition matrix P(∆) in terms of the generator matrix A:

                                                                          •   Dk Ak
                                        P ( D ) = exp [ DA ] = Â k =1                   .                 (46)
                                                                               k!

         Suppose that A has a non-zero element outside the three lines indicated in (45), say
a i -1,i +1 = g i -1 >0, with a i -1,i -1 = -ai -1 - bi -1 - g i -1 now being the required diagonal term on the
row. Then it follows from P ( D ) = I + DA + o( D) that (17) is violated since

                                  d ( D,i,i + 1| i - 1,i ) = -g i -1D + O( D 2 )            <0            (47)

By contrast, if A has the form (45), then it follows from
                                                             32



                                          P ( D ) = I + DA + D 2 A 2 / 2 + o( D 2 ) .                                (48)

that

                 d ( D,i,i + 1| i - 1,i ) = ai ai -1D 2 - ai ai -1D 2 / 2 + o( D 2 ) = ai ai -1D 2 / 2 ≥ 0           (49)


and similarly for the other transitions. The equivalence is therefore proved. Note that the form of
the generator (45) characterizes birth and death processes, where the size of the population either
goes up or down by one individual at a time. As a special case, this class includes Poisson
processes for which Yn=n with probability one, so λi=1 for all i.

Proof of Proposition 6

The criterion (15) in the case of a transition density depending only on z reduces to
∂ 2 Ln(p( D, z)) ∂z 2 < 0 , i.e., log-concavity of the density. A large number of densities are log-
concave. But one must remember that the process must be Markovian, i.e., satisfy (2). The
combination of both is enough to reduce the set of admissible models to the arithmetic Brownian
motion.

          Indeed, consider the leading term at order              D -1 of the expansion of the transition density
of such a space-homogeneous diffusion:


             (                        )       1
          Ln p (X−1) ( ∆, x 0 + z | x 0 ) = − Ln ( 2π∆ ) − Ln ( σ(x 0 + z) ) −
                                              2
                                                                                 1
                                                                                2∆
                                                                                   ( γ(x 0 + z) − γ (x 0 ) )2        (50)


(see Aït-Sahalia (1997, 1999)). We are asking when this function depends on z but not on x0. By
a Taylor expansion in z around 0, the right hand side of equation (50) is independent of x0 if and
only if the function σ is, in which case γ(x) = x/σ. Looking then at the next order term,


                     (                         )       (                        ) ∫
                                                                                        γ (x 0 + z)
                       X ( ∆, x 0 + z | x 0 ) − Ln p X ( ∆, x 0 + z | x 0 ) =                         µ Y ( v ) dv
                                                     ( −1)
                 Ln p (0)                                                                                          (51)
                                                                                        γ (x 0 )



where

                                 µ Y (y) = µ( γ −1 (y)) / σ( γ −1 (y)) − σ′( γ −1 (y)) / 2 .                         (52)

Given that γ is linear, the right-hand-side of equation (51) can only be independent of x0 if µY(.)
is constant. From equation (52) and σ(x) = σ, γ(x) = x/σ, this can only occur if µ(x) = µ is
constant. Hence the only process with space-homogeneous transition density is the arithmetic
Brownian motion with σ(x) = σ and µ(x) = µ both constant.
                                                                33



Proof of Proposition 7

           First note that if (X t + D , X t ) has a Gaussian distribution, then so does X t + D | X t and
moreover E [X t + D | X t ] must be affine in Xt and V [ X t + D | X t ] constant in Xt. This follows for
instance from Theorem III.6.5 page 86 of Feller (1971). Let us therefore consider Gaussian
transition functions p(∆,y|x) with conditional mean e D ( x ) ∫ E [ X t + D | X t = x ] = a D              + bD x   and
conditional variance v D ∫ V [ X t +D | X t = x ] , and let us see what further restrictions on the
dependence of α∆, β ∆ and v∆ on ∆ make these functions compatible with the conditions (2) for
Markovianity and (15) for diffusion. That is, should further restrictions on the conditional mean
and variance be placed to insure that the discrete observations are embeddable in a diffusion?

           It turns out that in this case the Markov requirement alone is sufficient to reduce the set
of compatible transition densities to the Ornstein-Uhlenbeck case which we already know is a
diffusion.17 In other words, there exists no non-diffusion Markov process with Gaussian
transitions. Equivalently, this means that for Gaussian transitions once the Markov requirement
is imposed, the diffusion condition (15) is automatically satisfied. Indeed, the Chapman-
Kolmogorov equation (2) implies by a direct calculation that

                             a 2 D = a D (1 + b D ) , b 2 D = b 2D      , v2 D     = v D (1 + b D2 ) .

With α0=0, β 0=1 and v0=0, the only solution is of the form


                            a D = a (1 - e -bD ) , b D = e-bD           , vD   =      v
                                                                                        (
                                                                                        1 - e -2bD    )
                                                                                     2b

where α, β and v>0 are constants. Applying now condition (15) to

                            p ( D, y | x ) = (2pv D )
                                                        -1/ 2
                                                                exp   {- (y - e (x))
                                                                                 D
                                                                                            2
                                                                                                (2v D )}

yields    ∂ 2 Ln(p( D, y | x)) ∂x∂y = b D v D > 0 . Therefore the diffusion condition puts no additional
constraints on the model’s parameters in the Gaussian case so that saying that the process is
Markovian and Gaussian is enough to reduce the admissible set to the Ornstein-Uhlenbeck class.




17   Note that this includes the arithmetic Brownian motion as the special case where β=0.
                                                     34



                                                 Table I
                                           SPX Option Data


                  Strike          Call Price        Moneyness           Implied Volatility
                   750              408.50            0.6449                   0.4131
                   800              359.90            0.6879                   0.3903
                   850              311.60            0.7309                   0.3638
                   900              264.40            0.7739                   0.3463
                   950              218.40            0.8169                   0.3274
                   995              178.30            0.8556                   0.3081
                  1025              153.00            0.8814                   0.2978
                  1050              132.70            0.9029                   0.2885
                  1075              113.60            0.9244                   0.2805
                  1100               95.30            0.9459                   0.2706
                  1125               78.60            0.9674                   0.2624
                  1130               75.30            0.9717                   0.2601
                  1140               69.30            0.9803                   0.2575
                  1150               63.20            0.9889                   0.2533
                  1160               57.60            0.9975                   0.2502
                  1170               52.30            1.0061                   0.2473
                  1175               49.60            1.0104                   0.2451
                  1180               47.50            1.0147                   0.2453
                  1190               42.50            1.0233                   0.2412
                  1200               37.80            1.0319                   0.2372
                  1210               33.60            1.0405                   0.2341
                  1225               28.00            1.0534                   0.2303
                  1250               20.35            1.0749                   0.2253
                  1275               14.05            1.0964                   0.2190
                  1300                9.50            1.1179                   0.2144
                  1325                6.10            1.1394                   0.2092
                  1350                3.85            1.1609                   0.2057
                  1375                2.40            1.1824                   0.2033
                  1400               1.475            1.2039                   0.2017
                  1425               0.875            1.2254                   0.1999
                  1450               0.475            1.2469                   0.1968
                  1475               0.350            1.2684                   0.2019
                  1500               0.225            1.2898                   0.2035

These options are European calls on the S&P 500 index with prices recorded on March 19, 2001, at 10:30
AM CST. For each option’s price, I use the bid-ask midpoint. The riskless rate is r=5.50% (which,
following market convention, is slightly higher than the 3-month T-Bill rate, reflecting the fact that T-Bill
rate is not the relevant riskless rate faced by traders). The options expire on June 15, 2001. With the
calendar convention, these options have ∆ = 88 days to expiration. The at-the-money implied forward price
of the index for that maturity is F∆=1,162.93 while the value of the index itself is X0=1,151.10. Time
calculations are performed with a 365-day calendar. The moneyness of an option with strike K is M =
K / FD .
                                                    35



                                                 Table II
                                  Fitted Implied Volatility Smile




                 Variable            Coefficient         t-statistic          p-value

                     1                 0.4775              10.02               6.10-11
                     M                 0.5221               3.42               2.10-3
                    M2                 -1.3714              -8.59              2.10-9
                    M3                 0.6208              11.39               3.10-12




This table reports the results of fitting the model (29) to the implied volatility data given in Table I. M
denotes the option’s moneyness M = K / FD . The R2 of the regression is 0.9993; the adjusted R2 is 0.9992.
The fitted implied volatility function s IMP (K / FD ) is plotted in Figure 8.
                                                       36



                      Figure 1: Discrete and Continuous Sample Paths




                rt

                                                            discrete observations
                                  ∆       ∆        ∆        (sampled ∆ apart)

          r∆
          r0
          r2∆


          r3∆
                                                                          full sample path
                                                                          (unobservable)




                                                                                                      t
                              0       ∆       2∆       3∆




This figure contrasts the discretely-observed sample path from the continuous-time one (which generated
the observed sample). It also illustrates the notion of repeated sampling under time-homogeneity, with pairs
of successive observations (ri∆,r(i+1)∆), sampled ∆ units of time apart and drawn from a common joint
distribution which depends on ∆ but not i.
                                                     37



                        Figure 2: Two Sample Paths with No Crossing




                 rt                                               r t+∆



                                                                    ~
                                                                    y           ~
                                                                                Y


             ~
             x

             x

                                                                                Y
                                                                    y


                                                                                           time
                 t                                              t+∆




This figure shows the sample paths between two successive sampling dates t and t+∆ followed by the two
processes r (thin curve) and r (thick curve), with r positioned at time t at x, below r which starts at x .
The processes reach time t+∆ having maintained the same order throughout, r finishing in the set Y below
               .
r in the set Y
                                                      38



                              Figure 3: Two Sample Paths Crossing



                        rt                                               r t+∆



                                                                           y~           ~
                                                                                        Y


                   x~
                                            C
                   x

                                                                                       Y
                                                                          y


                                                                                                   time
                        t               τ                              t+∆




This figure shows the sample paths between two successive sampling dates t and t+∆ followed by the two
processes r (thin curve) and r (thick curve), with r starting below r at date t but finishing above it at date
t+∆. If the sample paths are continuous, this can only happen if they cross (at least) once in between. In the
figure, the coincidence time (where the two processes are in the same state C) is denoted at τ.
                                                      39



                             Figure 4: Two Sample Paths with Jumps




                        rt                                               r t+∆



                                                                           y~           ~
                                                                                        Y


                   x~

                   x
                                   jump
                                                                                       Y
                                                                          y


                                                                                                   time
                        t                                              t+∆



This figure shows the sample paths between two successive sampling dates t and t+∆ followed by the two
processes r and r , with r starting above r at date t but finishing below it at date t+∆. By contrast with the
situation illustrated in Figure 3, if the sample paths can jump, this reversal of order may happen without the
two processes having ever been coincident, i.e., having occupied the same state at the same time. Note that
in both Figure 3 and Figure 4, we do not observe what actually happens between t and t+∆ (we only see the
process every ∆ units of time). We will draw inference about what happened in between from the ∆-apart
sample, specifically from features of the transition density p(∆,y|x).
                                                     40



                              Figure 5: Discrete Time Markov Chain



      Xt

  3


  2

  1

  0                                                                                                    t
      J0                 J1         J2 J3                     J4    J5           J6

 -1

 -2




This figure illustrates the concept of continuity of sample paths for a continuous-time, discrete-state
Markov chain. By definition, all the state changes are “jumps” and the appropriate notion of continuity
distinguishes between “small” or “continuous” jumps, which are those from one state to an immediately
adjacent one (+1 or –1), from “large” or “discontinuous” jumps, which are those from one state to a
nonadjacent one. The jumps occurring at jump times J1, J4, J5 and J6 are all of size +1 or –1, so that the
process jumps from one state to an immediately adjacent one. By contrast, the jump taking place at jump
times J2 and J3 are of size +2 and –5 respectively. The first set is compatible with continuity of the sample
paths whereas the second set is not.
                                                     41



                 Figure 6: Discrete-Time, Discrete-State Multinomial Tree




                                                          pi+2

                                                          pi+1
                                                          pi       adjacent        nonadjacent
                     Yn = i
                                                                    nodes             nodes
                                                          pi-1

                                                          pi-2


                                         ∆




This figure illustrates the concept of continuity of sample paths for a discrete-time, discrete-state
multinomial tree. For the approximated continuous-time, continuous-state process to be Markovian, the tree
must be recombining. For the approximated process to be a diffusion, the tree must lead to continuous
sample paths, which in this case means that all the discrete-time jumps along the tree must occur from one
node to an immediately adjacent state. If at date n∆ the process is in state i, then for the tree to be an
approximation to a continuous-path process it must be that the only non-zero branch probabilities are pi-1, pi
and pi+1. Since binomial and trinomial trees only have adjacent nodes, these by construction can only
approximate a continuous-time, continuous-state process with continuous sample paths – that is., a
diffusion. Conversely, for the tree to approximate a process with discontinuous sample paths, some of the
nonadjacent nodes must be attainable.
                                                      42



                Figure 7: Diffusion and Jump-Diffusion Transition Functions




                                                     3




                                                     2




                                                     1




            -1                 -0.5                                      0.5                   1



                                                 250


                                                 200


                                                 150


                                                 100


                                                   50


           -1                 -0.5                                        0.5                      1




The top plot in this figure represents the transition densities of a Brownian motion (solid curve) and a
Cauchy process (dotted curve) as a function of the difference z = y – x between the forward and backward
state values. The fact that the tails of the Cauchy distribution are larger is apparent. The bottom plot graphs
the criterion function ∂ 2 Ln(p(∆, y | x)) ∂x∂y for both distributions. While the criterion is always positive
for the Brownian motion (solid curve), it is negative in the tails (where z is large in absolute value) for the
Cauchy distribution (dashed curve).
                                                            43



                               Figure 8: SPX Implied Volatility Smile and State-Price Density




          implied volatility    0.4



                               0.35



                                0.3



                               0.25



                                0.2
                                            0.7   0.8    0.9     1         1.1     1.2        1.3
                                                           moneyness


                                0.003

                               0.0025
          transition density




                                0.002

                               0.0015

                                0.001

                               0.0005

                                      0
                                          600     800     1000      1200         1400       1600
                                                          strike price K


                                                                                    
The top plot in this figure reports the fitted implied volatility function K / FD s IMP ( K / FD ) . The dots
represent the actual implied volatilities from Table I. The parameter estimates are reported in Table II. The
                                                                                        
solid curve bottom plot in the figure represents the implied transition density K p( D, K | x 0 ) for the
maturity ∆ and current index value x0 described in Table I. For comparison purposes, the Black-Scholes
state-price density (dotted curve) evaluated at the at-the-money implied volatility is also included. The
skewness of the implied density is apparent. All by itself, however, skewness is not sufficient indication of
non-diffusion behavior.
                                                                                    44


                                    Figure 9: Diffusion Criterion Applied to the State-Price Density


                                                            1


           diffusion criterion                            0.75

                                                           0.5

                                                          0.25

                                                             0

                                            -0.25
                                                                 600     800       1000      1200    1400
                                                                                  strike price K


                                                          1300


                                                          1250
                                 current index value X0




                                                          1200                                          Criterion

                                                                                                             1.5

                                                          1150                                               1.5

                                                                                                             1.3

                                                                                                             1.
                                                          1100
                                                                                                             0.75

                                                                                                             0.5
                                                          1050
                                                                                                             0.25

                                                                                                            0
                                                          1000


                                                           950
                                                              600      800     1000    1200   1400
                                                                             strike price K



The two plots in this figure determine whether the option-implied transition density is compatible with a
diffusion model for the underlying (risk-neutral) asset price dynamics. The top plot graphs the criterion
function K             
                ∂ 2 Ln(p(∆, K | x 0 )) ∂x 0 ∂K for the fixed ∆ and x0 corresponding to the option data that are
given in Table I. For display purposes, the criterion function is multiplied by a fixed constant (this is
irrelevant to the conclusions, since we only care about the sign of the criterion). Notice that there are
regions where the criterion function becomes negative The bottom plot is a contour plot, for the fixed ∆ in
the data, of the three-dimensional surface (K, x 0 )                                  
                                                               ∂ 2 Ln(p(∆, K | x 0 )) ∂x 0 ∂K . White areas in the
contour plot indicate regions where the criterion function is negative. Anything short of nonnegativity of
the criterion function for all values of (K, x 0 ) is incompatible with an underlying diffusion model. The
conclusion from the analysis is that there exists no diffusion model that could have generated the transition
density (reported in Figure 8) which prices these options.
