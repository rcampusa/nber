                                NBER WORKING PAPER SERIES




      ESTIMATION OF AFFINE TERM STRUCTURE MODELS WITH SPANNED OR
                   UNSPANNED STOCHASTIC VOLATILITY

                                            Drew D. Creal
                                           Jing Cynthia Wu

                                        Working Paper 20115
                                http://www.nber.org/papers/w20115


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      May 2014




We thank Yacine Ait-Sahalia, Boragan Aruoba, Michael Bauer, Alan Bester, John Cochrane, Frank
Diebold, Rob Engle, Jim Hamilton, Chris Hansen, Guido Kuersteiner, Ken Singleton, two anonymous
referees, and seminar and conference participants at Chicago Booth, NYU Stern, NBER Summer Institute,
Maryland, Bank of Canada, Kansas, UMass, and Chicago Booth Junior Finance Symposium for helpful
comments. Drew Creal thanks the William Ladany Faculty Scholar Fund at the University of Chicago
Booth School of Business for financial support. Cynthia Wu also gratefully acknowledges financial
support from the IBM Faculty Research Fund at the University of Chicago Booth School of Business.
This paper was formerly titled "Estimation of non-Gaussian affine term structure models." The views
expressed herein are those of the authors and do not necessarily reflect the views of the National Bureau
of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Drew D. Creal and Jing Cynthia Wu. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Estimation of Affine Term Structure Models with Spanned or Unspanned Stochastic Volatility
Drew D. Creal and Jing Cynthia Wu
NBER Working Paper No. 20115
May 2014, Revised October 2014
JEL No. C13,E43,G12

                                              ABSTRACT

We develop new procedures for maximum likelihood estimation of affine term structure models with
spanned or unspanned stochastic volatility. Our approach uses linear regression to reduce the dimension
of the numerical optimization problem yet it produces the same estimator as maximizing the likelihood.
It improves the numerical behavior of estimation by eliminating parameters from the objective function
that cause problems for conventional methods. We find that spanned models capture the cross-section
of yields well but not volatility while unspanned models fit volatility at the expense of fitting the cross-
section.


Drew D. Creal
University of Chicago
Booth School of Business
5807 South Woodlawn Ave
Chicago, IL 60637
dcreal@chicagobooth.edu

Jing Cynthia Wu
University of Chicago
Booth School of Business
5807 South Woodlawn Avenue
Chicago, IL 60637
and NBER
cynthia.wu@chicagobooth.edu
1     Introduction

We propose new estimation procedures for affine term structure models (ATSMs) with
spanned or unspanned stochastic volatility that use linear regression to simplify and stabilize
estimation. For spanned models, our procedure recovers the maximum likelihood estimator
but only requires numerically optimizing over a lower dimensional parameter space. The
stability of our method makes it possible for us to study local maxima, explain why they
exist, and their economic implications. We show how our insights from spanned models can
be extended to estimate unspanned stochastic volatility (USV) models despite the fact that
for USV models the likelihood function is not known in closed-form. Estimating a range of
popular models, we find that models with spanned volatility fit the cross section of the yield
curve better, while those with unspanned volatility fit the volatility better.
    ATSMs are popular among policy makers, practitioners, and academic researchers for
studying bond prices, monetary policy, and the macroeconomic determinants of discount
rates; for overviews, see Piazzesi(2010), Duffee(2012), Gürkaynak and Wright(2012), and
Diebold and Rudebusch(2013). As the literature on ATSMs has developed over the last
decade, there is a consensus that estimation can be challenging; see, e.g. Duffee(2002), Ang
and Piazzesi(2003), Kim and Orphanides(2005), and Hamilton and Wu(2012). New proce-
dures for Gaussian ATSMs have made them easier to estimate, further increasing their pop-
ularity; see, Joslin, Singleton, and Zhu(2011), Christensen, Diebold, and Rudebusch(2011),
Hamilton and Wu(2012), Adrian, Crump, and Moench(2012) and Diez de Los Rios(2013).
However, these procedures do not address models with stochastic volatility. Moreover, in
USV models as proposed by Collin-Dufresne and Goldstein(2002) and Collin-Dufresne, Gold-
stein, and Jones(2009), the likelihood function is not known in closed-form. Potential solu-
tions to this problem are the closed-form expansions of the likelihood for continuous-time
models developed by Aı̈t-Sahalia(2008) and Aı̈t-Sahalia and Kimmel(2010) and the expec-
tation maximization (EM) algorithm. Combining our approach with these could potentially
improve estimation; we demonstrate this for the EM algorithm explicitly.

                                              2
   Our main contribution are new procedures for estimating ATSMs with spanned or un-
spanned stochastic volatility. For models with spanned factors where volatility factors price
bonds, we propose to maximize a concentrated likelihood that when optimized gives exactly
the same estimator as maximizing the original likelihood function. However, it only re-
quires numerically optimizing over a subset of the parameters. The concentrated likelihood
function is simple to construct from linear regressions. Using this approach, estimation of
spanned models only takes a fraction of a second to several minutes compared to hours when
optimizing the original likelihood.
   For USV models where the volatility factors do not price bonds, the log-likelihood func-
tion is not known in closed-form adding another layer of difficulty. Nevertheless, we show
how the intuition behind the concentrated likelihood for spanned models can be extended to
estimate USV models using the EM algorithm of Dempster, Laird, and Rubin(1977). The
maximization step of the EM algorithm solves a similar problem as optimizing the likeli-
hood function of a spanned Gaussian ATSM. Consequently, we can construct a concentrated
objective function for the EM algorithm using linear regressions just as we did for spanned
models.
   Our method outperforms conventional approaches both in terms of stability of conver-
gence and speed. A study for a 3-factor model with one spanned volatility factor shows that
our method guarantees convergence as long as it is locally identified, and it converges to
a number of local maxima repeatedly. Aside from being able to find the global maximum,
our method helps us to locate and understand the economic implications of different local
maxima. Conversely, the conventional method of directly maximizing the original likelihood
never converges fully to any of the local maxima, nor does it converge to the same point
twice in repeated trials even when it is initialized under the same local mode. This makes it
difficult for researchers to differentiate between points near a well-behaved local maximum
having the same economic meaning and locations corresponding to local maxima that are
economically different. The median time it takes for our new procedure is less than 2 minutes


                                             3
for this model, whereas the conventional approach takes over 2 hours.
      Using our method, we shed light on how local maxima with different economic implica-
tions are created in non-Gaussian spanned models. In Gaussian models, different rotations
of the factors (such as re-ordering of the factors) result in equivalent global maxima, with
identical economic implications. In non-Gaussian models with spanned factors, rotations
can have substantial economic impacts. The non-Gaussian state variables must be positive
and enter the conditional variance. This creates an asymmetry between the Gaussian and
non-Gaussian factors resulting in local maxima that are not economically equivalent.
      Another contribution of this paper is to develop a family of discrete-time non-Gaussian
ATSMs that encompasses continuous-time models, including both spanned models as in
Duffie and Kan(1996), Duffee(2002), Cheridito, Filipovic, and Kimmel(2007), and Aı̈t-
Sahalia and Kimmel(2010) as well as USV models as proposed by Collin-Dufresne and Gold-
stein(2002). Gouriéroux, Monfort, and Polimenis(2002) proposed a one factor discrete-time
non-Gaussian model and Le, Singleton, and Dai(2010) generalized it to have multiple fac-
tors. Our model encompasses any admissible rotation of a multivariate discrete-time Cox,
Ingersoll, and Ross(1985) process, allowing the factors to be correlated. The model nests the
risk-neutral dynamics of other discrete-time ATSMs.1 In our model, the physical and risk
neutral dynamics follow the same stochastic process but with different parameters. The mar-
ket prices of risk have the extended affine form of Cheridito, Filipovic, and Kimmel(2007),
which is different than Le, Singleton, and Dai(2010). Finally, we also provide the restrictions
needed to generate USV in discrete-time versions of the continuous-time models studied by
Collin-Dufresne, Goldstein, and Jones(2009) and Joslin(2010).
      We apply our estimation method to a range of popular spanned and unspanned models
with three and four factors. Judging by the estimated likelihood, a model with three spanned
non-Gaussian factors has the highest likelihood followed by one of the USV models. Gaussian
and non-Gaussian models with spanned factors fit the cross-section of yields equally well.
  1
    In this paper, we do not consider the class of non-Gaussian ATSMs built from the non-central Wishart
process of Gouriéroux, Jasiak, and Sufana(2009).


                                                   4
However, spanned models do not capture the volatility well at any maturity, even for the
best fitting model. This is because the non-Gaussian state variables must simultaneously
fit the conditional mean and variance. Maximum likelihood places more weight on the first
moment. In order to guarantee unspanned volatility factors, USV models place restrictions
on the bond loadings. This causes USV models to sacrifice some cross-sectional fit; their
pricing errors are larger than spanned models. On the other hand, USV models fit the
dynamics of yield curve volatility well. The USV restrictions are not unique and we show
that the choice of which USV restrictions are imposed is not inconsequential.
    This paper continues as follows. In Section 2, we specify a general class of discrete-time,
non-Gaussian affine term structure models. In Section 3, we describe our new approach
to estimation for both spanned and unspanned models. Section 4 describes the data and
parameter restrictions of the models. Section 5 studies a three factor spanned model in
depth. In Section 6, we study eight three and four factor spanned and unspanned models.
In Section 7, we discuss directions for future research and conclude.



2     Model

In this section, we describe a class of discrete-time ATSMs with stochastic volatility that
encompass both spanned models, as in Duffie and Kan(1996), Dai and Singleton(2000),
Cheridito, Filipovic, and Kimmel(2007); and unspanned models, as proposed by Collin-
Dufresne and Goldstein(2002).


2.1    Bond prices

The model has a G × 1 vector of conditionally Gaussian state variables gt , whose volatilities
are captured by an H × 1 vector of positive state variables ht . Under the risk-neutral
measure Q, the Gaussian state variables follow a vector autoregression with conditional




                                               5
heteroskedasticity


                              Q            Q        Q                                Q
         gt+1 = µQ    Q
                                                                              εQ                  0
                                                                                                     
                 g + Φg gt + Φgh ht + Σgh εh,t+1 + εg,t+1 ,                    g,t+1 ∼ N 0, Σg,t Σg,t ,   (1)
                                       H
                                       X
     Σg,t Σ0g,t   =   Σ0,g Σ00,g   +         Σi,g Σ0i,g hit ,
                                       i=1

       εQ
        h,t+1
                                   Q
                  = ht+1 − E (ht+1 |It )


where It captures agents’ information set at time t.
   The volatility factors ht are an affine transformation of the exact discrete-time equivalent
of a multivariate Cox, Ingersoll, and Ross(1985) process


                       ht+1 = µh + Σh wt+1                                                                (2)
                                                      
                                          Q    Q
                      wi,t+1 ∼ Gamma νh,i   + zi,t+1 ,1 ,                    i = 1, . . . , H             (3)
                                                      
                       Q                0 −1 Q
                      zi,t+1 ∼ Poisson ei Σh Φh Σh wt ,                      i = 1, . . . , H             (4)


where ei denotes the i-th column of the identity matrix IH . We discuss the admissibility
restrictions and interpretation of the parameters of the model in Section 2.2.
   The price of a zero-coupon bond with maturity n at time t is the expected price of the
same asset at time t + 1 discounted by the short rate rt under the risk neutral measure


                                        Ptn = EQ              n−1
                                                                 
                                               t exp (−rt ) Pt+1 .




The short rate is a linear function of the state vector


                                                        0         0
                                             rt = δ0 + δ1,h ht + δ1,g gt .


Given the dynamics of gt and ht under Q, bond prices are an exponentially affine function




                                                                6
of the state variables


                                   Ptn = exp ān + b̄0n,h ht + b̄0n,g gt .
                                                                        



The loadings ān , b̄n,h and b̄n,g can be expressed recursively in matrix notation as

                                            h                          i0            1
                                                        Q            Q
     ān = −δ0 + ān−1 + µQ0     b̄
                               g n−1,g   +    µ h −   Φ   µ
                                                        h h  + Σ   ν
                                                                  h h     b̄n−1,h + b̄0n−1,g Σ0,g Σ00,g b̄n−1,g
                                                                                   2
                                                                   −1
           +µ0h ΦQ0   −10
                              IH − diag ιH − Σ0h b̄n−1,gh               Σ0h b̄n−1,gh
                                                              
                  h Σh

           −νhQ0 log ιH − Σ0h b̄n−1,gh + Σ0h b̄n−1,gh
                                                           
                                                                                                                (5)
                                                      1
   b̄n,h = −δ1,h + ΦQ0                 Q0
                                                          IH ⊗ b̄0n−1,g Σg Σ0g ιH ⊗ b̄n−1,g
                                                                                             
                       gh b̄n−1,g + Φh b̄n−1,h +
                                                     2
                                                             −1  0
           −ΦQ0    −10                             0
                                 
              h  Σ h     I  H  −   diag   ιH  −  Σ   b̄
                                                   h n−1,gh          Σh b̄n−1,gh                                (6)

   b̄n,g = −δ1,g + ΦQ0
                    g b̄n−1,g                                                                                  (7)


with initial values ā1 = −δ0 , b̄1,g = −δ1,g and b̄1,h = −δ1,h , see Appendix B for a derivation.
The matrix Σg Σ0g is a GH ×GH block diagonal matrix with elements Σi,g Σ0i,g for i = 1, . . . , H
and b̄n−1,gh = Σ0gh b̄n−1,g + b̄n−1,h . The loadings must satisfy the restriction that the i-th
component of Σ0h b̄n−1,gh < 1 for i = 1, . . . , H.
    Bond yields ytn ≡ − n1 log (Ptn ) are linear in the factors


                                        ytn = an + b0n,h ht + b0n,g gt                                         (8)


with an = − n1 ān , bn,h = − n1 b̄n,h and bn,g = − n1 b̄n,g .
    Gouriéroux and Jasiak(2006) built the univariate version of the non-Gaussian process
(2)-(4) and Gouriéroux, Monfort, and Polimenis(2002) used it to construct a one factor
ATSM. Le, Singleton, and Dai(2010) extended the process to allow for multiple factors;
their specification under Q is (2)-(4) but with µh = 0 and Σh diagonal.




                                                        7
2.1.1     Unspanned stochastic volatility models

USV models (see Collin-Dufresne and Goldstein(2002)) impose restrictions on the parameters
under Q guaranteeing that the bond loadings for the volatility factors bn,h in (8) are zero for
all maturities. Yields consequently only depend on the Gaussian factors ytn = an + b0n,g gt .
The bond loadings (5)-(7) simplify to

                                                          1 0            0
                          ān = −δ0 + ān−1 + µQ0
                                               g b̄n−1,g + b̄n−1,g Σ0,g Σ0,g b̄n−1,g               (9)
                                                          2
                         b̄n,g = −δ1,g + ΦQ0
                                          g b̄n−1,g                                              (10)


which are the same as Gaussian ATSMs. Unlike Gaussian ATSMs, however, USV models
constrain some of the Q parameters (i.e. elements of ΦQ
                                                      g ) in order to set the non-Gaussian

loadings to zero. In Section 4.2.2, we provide conditions under which discrete-time ATSMs
exhibit USV as in Collin-Dufresne, Goldstein, and Jones(2009).


2.2      Physical dynamics

Analogous to the popular class of Gaussian ATSMs, we specify the dynamics of gt and ht
under P to have the same dynamics as under Q. The Gaussian state variables follow a vector
autoregression with conditional heteroskedasticity


                                                                       εg,t+1 ∼ N 0, Σg,t Σ0g,t , (11)
                                                                                               
            gt+1 = µg + Φg gt + Φgh ht + Σgh εh,t+1 + εg,t+1 ,
                                          H
                                          X
        Σg,t Σ0g,t   =   Σ0,g Σ00,g   +         Σi,g Σ0i,g hit ,
                                          i=1
          εh,t+1 = ht+1 − E (ht+1 |It ) .


The Gaussian state variables are a function of the non-Gaussian state variables through both
the autoregressive term Φgh ht and the covariance term Σgh εh,t+1 . The parameters controlling
the conditional mean are different under P and Q measures, while the scale parameters Σgh
and Σi,g for i = 0, . . . , H are the same.

                                                                   8
   The model for ht+1 under the physical measure P is


                      ht+1 = µh + Σh wt+1                                                      (12)

                    wi,t+1 ∼ Gamma (νh,i + zi,t+1 , 1) ,         i = 1, . . . , H              (13)

                    zi,t+1 ∼ Poisson e0i Σ−1
                                                       
                                          h  Φh Σh w t   ,       i = 1, . . . , H              (14)


where νh = (νh,1 , . . . , νh,H ) are shape parameters, Φh is a matrix controlling the autocorre-
lation of ht+1 , Σh is a scale matrix, and µh is a vector determining the lower bound of ht+1 .
Sufficient conditions for non-negativity of ht are that elements of µh , Σh , and Σ−1
                                                                                   h Φh Σh are

non-negative. The discrete-time equivalent of the Feller condition νh,i > 1 ensures that the
process does not attain its lower bound. A similar set of restrictions must be satisfied under
Q. The scale parameters Σh are the same under both probability measures and so is the
parameter µh . The latter restriction is required for no-arbitrage.
   The conditional mean of the volatility factors ht+1 can be written in matrix form as


                        E (ht+1 |It ) = (IH − Φh ) µh + Σh νh + Φh ht .


It is a linear function of its own lag ht , similar to a vector autoregression. The conditional
variance is also an affine function of ht


            V (ht+1 |It ) = Σh diag(νh − 2Σ−1        0             −1
                                                                           0
                                           h Φh µh )Σh + Σh diag 2Σh Φh ht Σh .




In Appendix A.2, we provide the transition density of ht+1 for any admissible rotation.
   A nice property of the model (11)-(14) for the vector (h0t , gt0 )0 is that any admissible affine
transformation remains within the same family of distributions.


Proposition 1 Let gt and ht follow the process of (11)-(14) with parameters θ. Consider




                                                9
an admissible affine transformation of the form
                                                                   
                            h̃t   ch   Chh Chg   ht 
                                =    +              .
                             g̃t     cg     Cgh Cgg     gt


The new process g̃t and h̃t remains in the same family of distributions under updated param-
eters θ̃. The parameters νh and Σ−1
                                 h Φh Σh are invariant to rotation.


Proof: See Appendix C.1.
The admissibility restrictions and the relationship between the new and old parameteriza-
tions can be found in Appendix C.1. This proposition helps to understand identification
in Section 4.2.1. The admissibility constraints ensure that the non-Gaussian state variables
                                                                                       0
always remain positive after applying a transformation from (h0t , gt0 )0 to h̃0t , h̃0t and that
there exists another admissible rotation to get back to the original factors.


2.3       Stochastic discount factor

In this section, we demonstrate how an agent gets compensated for risk exposure when
holding a zero-coupon bond under stochastic volatility. Given the dynamics of the state
vector under P and Q measures, the market prices of risk have the extended affine form of
Cheridito, Filipovic, and Kimmel(2007). The full expression is in Appendix D. To provide
intuition, the log of the stochastic discount factor (SDF) can be decomposed up to a first order
approximation into the risk free rate plus three components describing risk compensation

                                 1
                     mt+1 = −rt − λ0gt λgt − λ0gt g,t+1 − λ0wt w,t+1 − λ0zt z,t+1        (15)
                                 2

where i,t+1 are standardized shocks with mean zero and identity covariance matrix, and λit
is the price of risk i for each of the three types of shocks in the model.2 In addition to the
risk-free rt , the agent gets compensated for being exposed to the Gaussian shock g,t+1 in
  2
      This approximation is not used during estimation.

                                                    10
(11), the gamma shock w,t+1 in (13), and the Poisson shock z,t+1 in (14). The prices of
these risks are defined as


      λgt = V(gt+1 |It , ht+1 , zt+1 )−1/2 E (gt+1 |It , ht+1 , zt+1 ) − EQ (gt+1 |It , ht+1 , zt+1 )
                                                                                                    


      λwt = V(wt+1 |It , zt+1 )−1/2 E(wt+1 |It , zt+1 ) − EQ (wt+1 |It , zt+1 ) ,
                                                                               


      λzt = V(zt+1 |It )−1/2 E(zt+1 |It ) − EQ (zt |It ) .
                                                         



The market prices of risk have an intuitive form as the Sharpe ratio measuring per unit
risk compensation. Specifically, they are the difference in the conditional means of each
shock under P and Q standardized by a conditional standard deviation. The time-varying
quantities of risk are a feature of non-Gaussian models that are not available in Gaussian
models.


USV models In USV models, the components of the SDF associated with the Gaussian
factors (the first three terms in (15)) are the only parts that are directly observable from
bond yields. The risk premium for non-Gaussian factors can only be estimated jointly by
also observing derivatives because the Q parameters of the volatility process do not enter
the likelihood and are unidentified by observing only yields.


2.4     State space representation

Define xt as the vector of spanned factors; i.e., xt = (gt0 , h0t )0 in spanned models and xt = gt in
USV models. Stacking ytn in order for N different maturities n1 , n2 , ..., nN gives Yt = A+Bxt
where A = (an1 , . . . , anN )0 , B = (b0n1 , ..., b0nN )0 . If more yields are observed than the number of
spanned factors (N > N1 ), not all yields can be priced exactly. Following the literature, we
                                                             (1)
assume that N1 linear combinations of the yields Yt                = SY1 Yt are priced without error and
                                                             (2)
the remaining N2 = N − N1 linear combinations Yt                   = SY2 Yt are observed with Gaussian




                                                    11
measurement errors. Given this assumption, the observation equations are


                                  (1)
                               Yt       =       A1 + B1 xt                                (16)
                                  (2)
                               Yt       =       A2 + B2 xt + ηt     ηt ∼ N (0, Ω)         (17)


where A1 ≡ SY1 A, A2 ≡ SY2 A, B1 ≡ SY1 B, and B2 ≡ SY2 B. The state space representation
of the model is completed using the dynamics of the state variables (11)-(14).



3     Estimation methodology

In this section, we introduce new estimation procedures for spanned and unspanned models,
both of which use least square regressions to simplify and stabilize estimation. Our approach
is based on the following observations: (i) The parameter vector θ can be separated into those
parameters that enter the bond loadings and those that do not (e.g. µg , Φg , Φgh ); (ii) Given
the parameters that enter the loadings, we can calculate the bond loadings and solve for the
                                     
                              (1)
spanned factors xt = B1−1 Yt − A1 using (16); (iii) The P parameters (e.g. µg , Φg , Φgh )
of the Gaussian VAR for the factors gt plus Ω enter the objective function as a quadratic
form. The first order conditions for these parameters (µg , Φg , Φgh , Ω) are linear and can be
solved by running (generalized) least squares regressions of (11). Using this basic insight,
we show how to eliminate these parameters from the numerical optimization problem.


3.1     Spanned models

Given the parameters of the model θ, the likelihood function is

                                                       
                               (2)   (1)           (1)
      p (Y1:T ; θ) = p       Y1:T |Y1:T ; θ    p Y1:T ; θ
                   T
                   Y                       T
                                             Y                       T Y
                                                                     Y H
                         (2) (1)          −T
                 =   p Yt |Yt ; θ |J (θ)|      p (gt |ht , It−1 ; θ)     p (hit |It−1 ; θ) (18)
                     t=1                                      t=1            t=1 i=1




                                                         12
                                                                                        (1)
where J (θ) is the Jacobian of the transformation from xt = (gt0 , h0t )0 to Yt , see Appendix
E for the log-likelihood ` (θ) = log p (Y1:T ; θ).3 Direct maximization of the log-likelihood is
however extremely challenging as interest rates are close to non-stationary, the bond loadings
are non-linear functions of the models’ parameters, and the maximization must impose the
condition that ht > 0.
       Our approach to spanned models is a result of the following proposition:

Proposition 2 If the model is given by equations (11)-(14) and (16)-(17) with all spanned
factors, then the maximum likelihood estimator θ̂ = argmax ` (θ) can be solved by maximizing
                                                      θ

the concentrated likelihood max ` θ̂c (θm ) , θm , where θc = (µg , Φg , Φgh , Ω) and θm are the
                                 θm

remaining parameters of the model. The function θ̂c (θm ) is obtained by solving max ` (θm , θc )
                                                                                              θc

using the GLS estimates for the P dynamics (11) and the OLS estimates for the variance-
covariance matrix Ω in (17).

Proof: See Appendix F.1.
       The proposition raises two points. First, optimizing the concentrated likelihood gives
exactly the same solution as maximizing the original likelihood function in (18). However,
it only requires numerically optimizing over θm instead of both θm and θc . Second, the
concentrated likelihood function can be constructed from linear regressions. The method we
propose is an immediate result of Proposition 2.
                                                                                 
Procedure 1 Maximize the concentrated log-likelihood function max ` θ̂c (θm ) , θm . For
                                                                               θm

a given value of θm , the concentrated likelihood can be constructed as follows:

 (i.) Given θm , calculate the bond loadings A and B and the state variables gt and ht from
                          
                   (1)
      xt = B1−1 Yt − A1 .
   3
    The stationary distribution is only known for special sub-classes of the affine family of models. In this
paper, we assume a diffuse initial condition and start from t = 2. This provides an analytical solution for
the first order conditions of the likelihood. If a researcher wants to include the stationary distribution as
the initial condition, we recommend using our procedure first, and then using these estimates as starting
values to optimize the likelihood with the initial condition. While including the initial conditions enforces
stationarity, it can also introduce a downward bias in estimates of the autoregressive parameters; see, e.g.
Bauer, Rudebusch, and Wu(2012).

                                                     13
(ii.) Given gt and ht , calculate εh,t+1 and Σg,t . Run a GLS regression


                           gt+1 − Σgh εh,t+1 = µg + Φg gt + Φgh ht + Σg,t εg,t+1                        (19)


      to calculate µ̂g (θm ) , Φ̂g (θm ) , Φ̂gh (θm ).

(iii.) Calculate the covariance matrix

                                             T                           0
                                 1 X  (2)              
                                                           (2)
                    Ω̂ (θm ) =           Yt − A2 − B2 xt Yt − A2 − B2 xt                                (20)
                               T − 1 t=2

                                                                             
(iv.) Substitute θ̂c (θm ) = µ̂g (θm ) , Φ̂g (θm ) , Φ̂gh (θm ) , Ω̂ (θm ) back into the original likeli-
      hood to form the concentrated likelihood.


   In Appendix F, we also derive the analytical gradients of the concentrated log-likelihood.
Our derivation is based on the following proposition. It decomposes the gradient into pieces
according to whether a parameter enters the bond loadings, the P dynamics, or both.
                                                                                        
Proposition 3 The gradient of the concentrated log-likelihood ` θ̂c (θm ) , θm can be decom-
posed into three terms:
                                                                                        
    d` θ̂c (θm ) , θm , A (θm ) , B (θm )            ∂` θ̂c , θm , A, B    ∂` θ̂c , θm , A, B ∂A (θ )
                                                                                                    m
                       0
                                                 =              0
                                                                         +             0          0
                     dθm                                   ∂θ                      ∂A          ∂θm
                                                          m             
                                                       ∂` θ̂c , θm , A, B ∂vec B (θm )0
                                                                                          
                                                     +                                      .
                                                          ∂vec (B 0 )0        ∂θm  0



The first term is the partial derivative of the P dynamics and Jacobian with respect to θm .
This measures the effect parameters have on the log-likelihood through the time series of the
factors. The second and third terms measure the effect parameters have on the log-likelihood
through the bond loadings A and B.

Proof: See Appendix F.2

                                                       14
The expressions for the gradient can be used for other affine models such as models for
defaultable bonds and credit default swaps.


3.2    Unspanned models

In a USV model, the pricing equation (16) can be inverted to calculate the Gaussian factors
gt conditional on the parameters that enter the bond loadings. However, the volatility
factors ht cannot be observed by inverting the pricing formula. The likelihood of the model
                                       
                   (2)   (1)        (1)
p (Y1:T ; θ) = p Y1:T |Y1:T ; θ p Y1:T ; θ is no longer known in closed-form. The first term
                                                                       
     (2)    (1)                                                      (1)
p Y1:T |Y1:T ; θ remains the same as in (18). The second term p Y1:T ; θ is associated with
the P dynamics of the factors and is an integral over the path of the latent volatility

                                                  Z         Z
                   (1)                         −T
         p       Y1:T ; θ       = |J (θ)|               ...       p (g1:T |h0:T −1 ; θ) p (h0:T −1 ; θ) dh0 . . . dhT −1


                                                                   (1)
where J (θ) is the Jacobian from gt to Yt . This integral does not have a closed-form
solution. We use the Monte Carlo Expectation Maximization (MCEM) algorithm to estimate
the model, see Wei and Tanner(1990).
   The EM algorithm consists of two steps: the expectation and maximization steps, which
are iterated back and forth until convergence of the algorithm to a stationary point of the
likelihood. The first step calculates the expected value of the complete data log-likelihood

                                    "   T                                      T
                                        X                                    X
                 (i)
                                                   (2)
      Q θ|θ                = E              log p Yt |gt ; θ − T log |J (θ)| +   log p (gt |gt−1 , ht−1 ; θ)
                                      t=1                                                  t=1
                                      −1
                                    T
                                                                                #
                                    X
                                +         log p (ht |ht−1 ; θ) + p (h0 ; θ) .                                              (21)
                                    t=1

                                                                                           
This expectation is taken with respect to the posterior distribution p h0:T −1 |Y1:T ; θ(i) , which
                                                                                        
depends on the parameters θ(i) from the previous iteration. The function Q θ|θ(i) is known
as the intermediate quantity of the EM algorithm and it is a function of θ. In the second
                                                                                          
step of the EM algorithm, the intermediate quantity is maximized θ(i+1) = argmax Q θ|θ(i)
                                                                                                                θ


                                                                     15
to determine the parameters for the next iteration.
   For USV models, the intermediate quantity has the same form as the log-likelihood
for spanned Gaussian models. This means that maximization of the intermediate quantity
at each iteration of the EM algorithm is (essentially) equivalent to estimating a Gaussian
ATSM. This is why we can construct a concentrated version of the intermediate quantity
from the output of linear regressions. For USV models, we separate the parameters into
three groups: θc = (µg , Φg , Ω) are the parameters that can be concentrated out, θm,h =
(νh , Φh , Σh ) are the parameters that govern the dynamics of the volatility, and θm,b are
the parameters that enter the bond loadings. We only need to optimize numerically over
θm,h and θm,b , as the parameters in θc can be determined analytically as a function of θm,b .
                                                                                            
Moreover, the intermediate quantity can be additively separated into two pieces Q θ|θ(i) =
                                 
Q1 θm,b , θc |θ(i) + Q2 θm,h |θ(i) . The first component corresponds to the first three terms in
(21), and depends only on the parameters θm,b and θc . The remaining terms in (21) are the
                              
second component Q2 θm,h |θ(i) , which depend only on the volatility parameters θm,h .
   Our procedure can be implemented as follows:

Procedure 2 The maximum likelihood estimator for USV models can be obtained by iter-
ating over the following two steps:
                                                                           
(a.) E-step: compute the expectations in the intermediate quantity Q θ|θ(i) from (21).
                               
 (b.) M-step: maximize Q θ|θ(i) over θ to determine θ(i+1) . This can be separated into two
      sub-steps.
                                                                                    (i+1)
     (b1.) Maximize Q1 θm,b , θc |θ(i) with respect to θm,b and θc to determine θm,b and
                                                                                       
            (i+1)
           θc . This can be solved equivalently by maximizing Q1 θm,b , θ̂c (θm,b )|θ(i) with
           respect to θm,b , where the concentrated objective function can be constructed as
           follows:

           (i.) Given θm,b , calculate the bond loadings A and B and the state variables gt
                                          
                                   (1)
                from xt = B1−1 Yt − A1 .

                                              16
           (ii.) Given gt , run a GLS regression

                                                                        1
                                              gt+1 = µg + Φg gt + S̄t2 εg,t+1                         (22)


                 to calculate µ̂g (θm,b ) , Φ̂g (θm,b ).

          (iii.) Calculate the covariance matrix Ω̂ (θm,b ) as in (20).
                                                                              
          (iv.) Substitute θ̂c (θm,b ) = µ̂g (θm,b ) , Φ̂g (θm,b ) , Ω̂ (θm,b ) back into the intermedi-
                 ate quantity.
                                                                    (i+1)
     (b2.) Maximize Q2 θm,h |θ(i) with respect to θm,h to determine θm,h .


Appendix H contains details of our implementation. This procedure for USV models has
many similarities with our earlier procedure for spanned models.4 The difference between
the GLS regression in (19) of Procedure 1 and the regression in (22) of Procedure 2 is
their covariance matrices. The EM algorithm imputes the latent values of ht by taking
their expectations. Finally, we note that with only a few minor modifications, the analytical
gradients for the likelihood of the spanned model from Proposition 3 can be used to calculate
the gradients of the intermediate quantity in (21).
    In our experience, it takes only a few iterations of the EM algorithm to approach the
maximum when estimating the USV models of Section 4.2.2. The rate of convergence of the
EM algorithm near the maximum is known to be slow. Once the EM algorithm approaches
the maximum, a researcher can switch to alternative estimation procedures for non-Gaussian
state space models.5
    For USV models, the expectation in Step 1 cannot be calculated in closed-form, requiring
a Monte Carlo version of the EM algorithm. We calculate the expectations using sequential
   4
     There are several versions of the EM algorithm all of which lead to the MLE; see Meng and Rubin(1993).
These authors discuss issues such as concentrating the intermediate quantity as well as sequentially maxi-
mizing the intermediate quantity over subsets of θ.
   5
     USV models are an example of a non-linear, non-Gaussian state space model. General approaches for
estimating non-Gaussian state space models include importance sampling (Durbin and Koopman(2012) and
Richard and Zhang(2007)), particle filters (see Malik and Pitt(2011)), and MCMC (see Jacquier, Johannes,
and Polson(2007)).


                                                      17
Monte Carlo methods or particle filters; see Creal(2012) for a survey. In particular, we use
the particle filtering algorithm of Godsill, Doucet, and West(2004) to draw paths of h0:T −1
from the joint posterior distribution p (h0:T −1 |Y1:T ; θ); see Appendix H.2 for details. The
particle filter also allows us to calculate filtered (one-sided) estimates of the volatility as well
as an estimate of the likelihood function p (Y1:T ; θ).


3.3    Discussion

We discuss how our approach can be applied to a wide range of ATSMs.

Example #1: observable macroeconomic variables

   Our approach can estimate models with observable macroeconomic variables and with
homoskedastic or heteroskedastic shocks; examples with homoskedasticity are Ang and Pi-
azzesi(2003) and Hamilton and Wu(2012). Our procedure works the same as before except
the state vector xt now contains the yield factors as well as the observed macroeconomic
factors. For step (i.) of Procedure 1 or 2, we back out the latent component of xt conditional
                                                (1)
on a subset of the parameters, the yields Yt , and the macro variables. Given xt , we can
concentrate a large number of parameters out of the objective function including many of
the parameters introduced by adding the macroeconomic variables.

Example #2: Hidden factors

   Recently, Duffee(2011) argued that more than three factors are needed to explain the
time-series dynamics of yields and risk premia, where these additional factors are “hidden”
from the cross-section of yields because the factors are not priced. For simplicity, we illustrate
the basic ideas here for Gaussian models. Extensions to spanned or unspanned non-Gaussian
models are straightforward.
                                                                     0      0
                                                                                      0
   The Gaussian state vector can be separated into sub-vectors gt = g1,t , g2,t            whose di-




                                                18
mensions are G1 × 1 and G2 × 1, respectively. The dynamics under the P measure are


                                                              ε1,t+1 ∼ N 0, Σ0,g Σ00,g
                                                                                         
          g1,t+1 = µg,1 + Φg,11 g1t + Φg,12 g2t + ε1,t+1                                      (23)

          g2,t+1 = µg,2 + Φg,21 g1t + Φg,22 g2t + ε2,t+1      ε2,t+1 ∼ N (0, IG2 )            (24)


The dynamics of g1,t are the same under the Q measure but with the restrictions that
ΦQ
 g,12 = 0 and the last G2 entries of δ1g are zero. These restrictions imply that only g1,t

directly impacts yields as the bond loadings on g2,t are zero by construction.
   Given the parameters that enter the bond loadings, the factors that price bonds are
                                           
                                       (1)
conditionally observable g1,t = B1−1 Yt − A1 just as in step (i.) of Procedure 1. We
can treat g1,t as the observed data and (23) is the new observation equation for a linear,
Gaussian state space model. The remaining state variables g2t have transition equation
(24) and are serially correlated shocks to the factors g1t that price bonds. We can use the
Kalman filter to estimate this model, which is equivalent to a GLS regression where the
errors are serially correlated. To concentrate the parameters (µg,1 , µg,2 , Φg,11 , Φg,21 ) out of
the likelihood as in step (ii) of Procedure 1, we can either place these parameters in the state
vector or use the augmented Kalman filter of de Jong(1991), see also Chapter 5 of Durbin
and Koopman(2012).

Example #3: parameter constraints

   In our approach, a researcher can impose constraints – such as in Ang and Piazzesi(2003),
Kim and Wright(2005), Cochrane and Piazzesi(2008) and Bauer(2014) – and still concentrate
out parameters by linear regression. We denote the penalized or constrained log-likelihood
function `p (θ) as


                                `p (θ)   = log p (Y1:T ; θ) + p(θ),


where p(θ) is the penalty term. If the constraints are only on the Q parameters, a researcher


                                                19
can directly apply our Procedures 1 and 2. If the goal is to constrain either the P param-
eters or the relationship between the P and Q parameters, the penalty term is a vector of
Lagrange multipliers times the constraints. Step (ii.) of Procedure 1 or 2 can be replaced
by constrained GLS. If the constraints are linear in µg , Φg , Φgh , there is a unique solution.
Popular restrictions in the literature are all in this category. If the penalty term p(θ) is a
quadratic function of µg , Φg , Φgh , step (ii.) of Procedures 1 or 2 reduces to ridge regression
and the parameters can be shrunk to a pre-specified value similar to a Bayesian VAR. A
researcher may want to shrink the P parameters toward the Q parameters, which are often
measured more precisely.

Example #4: serially correlated measurement errors

   Although often assumed to be i.i.d. normal in the literature, several authors have found
the measurement errors ηt in (17) to be serially correlated; see, e.g. Hamilton and Wu(2014).
Procedures 1 and 2 can be extended to cover models with serially correlated errors without in-
creasing the dimension of the numerical optimization. For example, if ηt has VAR(1) dynam-
ics ηt = Φη ηt−1 + κt with κt ∼ N (0, Ω), then we can concentrate out θc = (µg , Φg , Φgh , Ω, Φη )
by least squares. Conditional on θm , we calculate the bond loadings A and B and factors xt
and, from these, the values of ηt and ηt−1 which are implicitly a function of θm . To concen-
trate Φη and Ω out of the objective function, we compute their least squares estimates from
the regression ηt = Φη ηt−1 + κt and plug these values back into the log-likelihood.

Relation to Joslin, Singleton, and Zhu(2011) and Hamilton and Wu(2012)

   Both Joslin, Singleton, and Zhu(2011) and Hamilton and Wu(2012) use linear regression
to estimate some parameters of Gaussian models.6 In the special case of Gaussian models
with observable factors (A1 = 0 and B1 = I), our method is identical to the ML estimator
of Joslin, Singleton, and Zhu(2011). Like the procedure in this paper, the approach of
   6
     The work by Adrian, Crump, and Moench(2012) and Diez de Los Rios(2013) are also similar in spirit
to these methods. They focus only on Gaussian models. Our discussion here applies to these papers as well.



                                                   20
Hamilton and Wu(2012) works for a wider range of Gaussian models. Their minimum chi-
square estimator is asymptotically equivalent to the ML estimator in this paper.
    The critical difference is that our procedures are designed for non-Gaussian models.
Leveraging the analytical solution for linear regressions has not been explored in this area.
For spanned models with both Gaussian and non-Gaussian factors, being able to rotate the
factors is important. If a researcher takes an arbitrary basis of yields (such as principal
components) and assumes that they can be separated a priori into observable Gaussian and
non-Gaussian factors, it will restrict the likelihood. Our approach lets the data decide what
linear combination of yields are the factors.



4       Data and parameter restrictions

4.1     Data

We use the Fama and Bliss(1987) zero coupon bond data available from the Center for
Research in Securities Prices (CRSP). The data is monthly and spans from June 1952 through
June 2012 for a total of T = 721 observations with maturities of (1, 3, 12, 24, 36, 48, 60)
                                                                                      (1)
months. For three factor models, the yields measured without error Yt                       include the (1,
                                                                             (1)
12, 60) month maturities. In models with four spanned factors, Yt                  are the (1, 12, 24, 60)
month maturities.


4.2     Parameter restrictions

4.2.1    Identifying restrictions for spanned models

We impose the following restrictions for identification. For the Gaussian part, these are: (i)
µQ            Q                        7
 g = 0; (ii) Φg in ordered Jordan form; (iii) δ1g = ι is a column vector of ones; and (iv)

Σi,g is lower triangular. For the non-Gaussian part, (i) µh = 0. (ii) ΦQ
                                                                       gh = 0. (iii) Elements

   7
     For the case where ΦQ
                         g has real distinct eigenvalues, it is a diagonal matrix with diagonal elements in
descending order.


                                                    21
of the vector δ1h = ±1 can take either sign8 , which unlike Gaussian-only models will lead to
inequivalent maxima as we explain in Section 5.2; (iv) Σh is diagonal.
    To guarantee non-negativity and admissibility of the factors, we also impose the discrete-
                                                      Q
time equivalent of the Feller condition νh,i > 1 and νh,i > 1 for i = 1, . . . , H. The matrices
                   −1 Q
Σh , Σ−1
      h Φh Σh and Σh Φh Σh must also be non-negative.



4.2.2    USV restrictions

We focus on discrete-time USV models similar to the continuous-time models presented
in Collin-Dufresne, Goldstein, and Jones(2009) and Joslin(2010).9 We label these models
U1 (4) because they have one unspanned volatility factor and three Gaussian factors. USV
restrictions are not unique. We present several models whose restrictions under Q result in
non-Gaussian loadings where bn,h = 0 for all maturities.
    The first model, labeled U1 (4)(φ, φ2 , ψ), has the following set of restrictions: (1) δ1,h =
0 and Σgh = 0. (2) ΦQ                                           2
                    g is a diagonal matrix with eigenvalues φ, φ , ψ. (3) All entries

of Σ1,g Σ01,g are zero but the (1, 1) element. This entry is Σ21,g,11 . (4) ΦQ                Q
                                                                                   gh,3 = 0; Φgh,1 =
δ1,g,1 2                 (1−φ2 )δ1,g,1
                                  2
      Σ
(1−φ) 1,g,11
             ; ΦQ
                gh,2 = − 2(1−φ)2 δ     Σ21,g,11 . In this model, only the Gaussian factor associated
                                   1,g,2

with the eigenvalue φ has stochastic volatility as the remaining entries of Σ1,g Σ01,g are zero
for all the other Gaussian factors. The USV restrictions force two of the eigenvalues of ΦQ
                                                                                          g to

be related as φ and φ2 . These restrictions summarize three different USV models depending
on the relative size of φ and ψ. We label the models U1 (4)(φ > φ2 > ψ), U1 (4)(φ > ψ > φ2 ),
U1 (4)(ψ > φ > φ2 ). Each one of them is identified after imposing an ordering on the
eigenvalues.10
   8
     In theory, δ1h = 0 is also admissible and creates additional local maxima. We would like to thank an
anonymous referee for pointing this out. Unlike a Gaussian model, the Jensen’s inequality term prevents
bn,h from being zero for maturities n ≥ 2 even when δ1h = 0. In practice, this model is not well identified, as
the factor loadings coming from the Jensen’s inequality term are extremely small and close to 0. We found
that the likelihood values under this restriction are significantly smaller in such models.
   9
     Papers that document the potential existence of USV factors include Heidari and Wu(2003), Li and
Zhao(2006), Trolle and Schwartz(2009), and Andersen and Benzoni(2010).
  10
     We do not consider the case where the eigenvalues may be identical and we restrict our attention to
eigenvalues that are less than one.



                                                      22
       A second model, labeled U1 (4)(φ, φ2 , φ4 ), allows two out of the three Gaussian factors to
share a common stochastic volatility factor. The restrictions for this model are (1) δ1,h = 0
and Σgh = 0. (2) ΦQ                                           2   4
                  g is a diagonal matrix with eigenvalues φ, φ , φ . (3) All entries of

Σ1,g Σ01,g are zero but the (1, 1) and (2, 2) elements. These entries are Σ21,g,11 and Σ21,g,22 .
              δ1,g,1 2              δ1,g,2           (1−φ2 )δ1,g,1
                                                              2
                                                                                         (1−φ4 )δ1,g,2
                                                                                                  2
(4) ΦQ                      Q               2
      gh,1 = 1−φ Σ1,g,11 ; Φgh,2 = (1−φ2 ) Σ1,g,22 − 2(1−φ)2 δ     Σ21,g,11 ; ΦQ
                                                                               gh,3 = − 2(1−φ2 )2 δ    Σ21,g,22 .
                                                                 1,g,2                              1,g,3

In this model, two diagonal entries in the covariance matrix                  Σ1,g Σ01,g   are non-zero. The
additional flexibility in Σ1,g Σ01,g comes at the expense of another restriction on the diagonal
components of ΦQ                                     2   4
               g . This model is unique because φ > φ > φ .

       These restrictions lead to the following proposition

Proposition 4 If the model has risk neutral dynamics (1)-(4) and satisfies the restrictions
of U1 (4)(φ, φ2 , ψ) or U1 (4)(φ, φ2 , φ4 ), then the model exhibits USV where bn,h = 0 ∀ n.

Proof: see Appendix G.
Intuitively, USV models free up the volatility factors to fit the heteroskedasticity of yields
because they still enter the covariance matrix of the Gaussian factors in their P dynam-
ics. The cost of adding USV factors comes from the constraints they place on ΦQ
                                                                              g . These

constraints can sacrifice the cross-sectional fit of the model.
       We impose the identifying restrictions of Section 4.2.1 for the Gaussian factors. For the
non-Gaussian portion of the model, we need an additional restriction on the scale parameters
Σ1,g or Σh , as they enter the likelihood in the same way. We set Σh = 0.01.



5        A three factor model

In this section, we use a three factor model with one spanned volatility factor A1 (3) (in
the Dai and Singleton(2000) notation) to demonstrate the performance of our method and
to discuss the local maxima that arise in spanned non-Gaussian models. This model has
been the preferred model by many researchers in the literature.11 For an A1 (3) model, the
  11
    This model has been widely considered as the benchmark non-Gaussian ATSM, see Dai and Single-
ton(2000), Cheridito, Filipovic, and Kimmel(2007), Collin-Dufresne, Goldstein, and Jones(2008), and Aı̈t-

                                                       23
concentrated likelihood drops the number of parameters by one-third from 24 parameters to
16 parameters.


5.1     Performance comparison

To illustrate the mileage we gain from using our method, we compare our approach to the
conventional method that does not concentrate out (µg , Φg , Φgh ) or use analytical gradients.
We perform an experiment where we estimate the A1 (3) model on the CRSP dataset 100
times from 100 different starting values using both methods.12 We compare our method and
the direct approach along two dimensions: convergence and speed. To measure the former,
we use the likelihood ratio (two times the difference in log-likelihoods).
    The global solution found by our method has a log-likelihood of 36647.69 (estimates and
quasi-maximum likelihood standard errors can be found on the right hand side of Table 2).
We achieve an identical value for all 17 random starting values whenever the parameters were
initialized in this region or mode of the parameter space.13 Seventeen equals the number
of times (one-sixth) that it started in this region. Conversely, the conventional method
does not find this log-likelihood once nor does the method reproduce the same (incorrect)
estimates for each of these 17 starting values. The highest log-likelihood value found by
the standard approach is 36645.29. The differences between the two methods is significant
across these 17 starting values. The conventional method yields log-likelihood values ranging
between 36645.29 to 36636.82, and it only achieves the former for one starting value. With
our method producing the same number repeatedly, we can conclude that it is a maximum.
    An immediate benefit of the stable behavior of our method is that we are able to find that
the A1 (3) model has 6 local modes with three well-behaved local maxima and three regions
of the log-likelihood that appear to be locally unidentified. The three well-behaved local
Sahalia and Kimmel(2010) for examples.
  12
     To make the comparison as parallel as we can, we write the likelihood function the same way, impose
the same identifying restrictions, and use the same scaling and initial values for the parameters except that
the conventional method has additional parameters entering the numerical optimizer.
  13
     We consider two log-likelihoods to be numerically identical if they agree up to 2 decimal points. In
practice, the log likelihood values are identical up to 8 decimal points.

                                                     24
maxima are listed in Table 1 and we will discuss the properties of the model that create these
local modes in Section 5.2. Our method converges 17/100 times to Local 1, 14/100 times to
Local 2, and 17/100 times to Local 3. The median likelihood ratio between our procedure and
the un-concentrated log-likelihood with no analytical gradient is 29.5 indicating a substantial
difference between the two procedures. The conventional method, even if it gets close to a
local maximum, always stops before it fully converges. This makes it difficult for researchers
to differentiate between points that are near a well-behaved local maximum that have the
same economic meaning and locations corresponding to local maxima that are economically
different.
   Estimation time is another important dimension along which we compare our approach
to the conventional method. The median estimation time for our procedure to estimate from
a random starting value is less than 2 minutes, whereas the conventional approach of directly
maximizing the log-likelihood function takes more than 2 hours. To perform our study with
100 starting values, it takes our method about 4 hours, whereas it takes roughly 9 days to
complete the same exercise with the conventional method.
   In summary, our method addresses all of the following problems with the conventional
method. The conventional method is painfully slow. It does not achieve the global maximum.
And, it is extremely hard to assess convergence behavior and the number of local maxima
because conventional approaches do not repeatedly find the same local maximum even when
started in that region of the parameter space.


5.2     Local maxima

Using our approach simplifies estimation and helps uncover some features of the log-likelihood
surface that may be obscured by directly maximizing the log-likelihood. In this section,
we discuss the characteristics of the model that create local maxima and their economic
consequences.
   In Gaussian models, a change in the sign of δ1g rotates the factors from gt to −gt .


                                              25
                               Table 1: Local maxima in the A1 (3) model
                                         Local 1   Local 2    Local 3
                                 ht         level    slope curvature
                                 ΦQh      0.9961    0.9528      0.5812
                                   Q
                                 Φg       0.9514    1.0001      0.9983
                                          0.5358    0.5881      0.9389
                                 δ1,h          1         1          -1
                                 LLF 36647.69 36482.56 36530.19
Estimates of ΦQ      Q
              h and Φg from the A1 (3) model with corresponding log-likelihood. Each value is a different
local maximum depending on the sign of δ1,h and whether the non-Gaussian factor is the level, slope, or
curvature.



This rotation is economically irrelevant because the estimated model switches between two
global maximums. Unlike Gaussian models, fixing the sign of δ1h in spanned models is not
inconsequential, because the state variable ht is positive by definition. Changing the sign
of δ1h does not rotate ht to −ht . Therefore, there can exist inequivalent local maxima for
each combination of different signs of δ1h . For each of the local maxima, the estimated
latent factor ht is different, which changes the conditional variance of gt and consequently
the log-likelihood.
       Reordering the eigenvalues in ΦQ has completely different implications for spanned non-
Gaussian models than for Gaussian models.14 If the eigenvalues are reordered in a multi-
factor Gaussian model, it implies equivalent global maxima with the same economic im-
plication. However, with non-Gaussian spanned factors, they can yield inequivalent local
maxima. Using the A1 (3) model as an example, the factors are labeled as level, slope and
                                                     Q
curvature. Reordering the eigenvalues across ΦQ
                                              g and Φh does not generally change the shape

of the factors but it does change whether ht is the level, slope, or curvature. Any change
in ht from one type of factor (level) to another (slope/curvature) implies a different condi-
tional variance for gt making the likelihood no longer equivalent. Changing the order of the
  14
       We collect the autoregressive parameters together in matrices as
                                                                                  !
                                                                      ΦQ
                                                  
                                        Φh    0              Q         h     0
                             Φ =                            Φ    =
                                        Φgh   Φg                      ΦQ
                                                                       gh   ΦQg




                                                       26
                              Q
eigenvalues within ΦQ
                    g and/or Φh results in an equivalent global maximum. The intuition is

the same as re-ordering of the factors gt within a Gaussian ATSM.
    In an ATSM with spanned non-Gaussian factors, it is not clear a priori which local
maximum created by these characteristics of the model will be the global maximum. One
must intentionally search each region that potentially has a local maximum and compare
their likelihood values. To illustrate this idea, we present different local maxima for the A1 (3)
model corresponding to different signs of δ1,h and different orderings of the eigenvalues. We
report ΦQ , δ1,h , and log-likelihood values in Table 1. In the first column, ht is the level factor
and δ1,h is positive. This is the global maximum in this case. In our sample, volatility is
high during episodes where interest rates are high, so the level factor tends to explain the
volatility best and δ1,h is positive. The next two columns present what happens when ht is
the slope or curvature factor. Due to the nature of the data we are using, the likelihood
function drops significantly from the global maximum to these alternative local maxima. In
theory, there are six potentially different local maxima for each combination of eigenvalues
and sign of δ1,h but in practice there are only three well-behaved local maxima. For the rest,
we observe parameters hitting a boundary or eigenvalues of the autoregressive parameters
being numerically 1. Each of these local maxima correspond to models where volatility
declines in the 1970’s, which contradicts the data. Those points can be locally unidentified,
meaning that there exists a region of the parameter space where a subset of the parameters
are unidentified. For models with unspanned volatility factors, the issues of multiple modes
do not appear, because the likelihood surface of USV models is similar to spanned Gaussian
models.



6     Model comparison

In this section, we use our methodology to estimate a collection of popular and prominent
ATSMs. The models that we estimate include three factor spanned models AH (3) with



                                                27
              Table 2: Maximum likelihood estimates for the A0 (3) and A1 (3) models.


   G = 3, H = 0      LLF =       37080.94                  G = 2, H = 1      LLF =       36647.69
        µg                                                       Σh νh           µg                                 νh
     6.97e-05        -4.85e-05    -3.37e-04                    3.00e-05      -1.34e-05    3.32e-05                1.9332
    (4.92e-05)      (1.12e-04)   (7.06e-05)                        —        (5.14e-05)   (2.78e-05)              (2.0989)
        Φg                                                        Φh
      1.0074          0.0475      0.0665                        0.9943
     (0.0084)        (0.0137)    (0.0316)                      (0.0061)
                                                                  Φgh          Φg
      -0.0115         0.9375      0.0192                        0.0077       0.9854       0.0657
     (0.0184)        (0.0309)    (0.0607)                      (0.0132)     (0.0224)     (0.0462)
      -0.0366         -0.0585     0.6306                        -0.0405      -0.0729      0.6434
     (0.0111)        (0.0183)    (0.0535)                      (0.0077)     (0.0152)     (0.0426)

        µQ
         g                                       δ0             Σh νhQ         µQ
                                                                                g                         δ0        νhQ
         0             0            0          0.0083          4.09e-05         0           0          -0.0011    2.6371
        —              —            —         (0.0005)            —            —            —         (0.0002)   (0.2879)
        ΦQg                                                       ΦQ
                                                                   h           ΦQg
      0.9950          0.9538      0.5299                        0.9961       0.9514       0.5358
     (0.0007)        (0.0031)    (0.0295)                      (0.0006)     (0.0029)     (0.0293)
       Σ0,g                                                     Σh
     3.99e-04          0            0                        1.55e-05
    (2.62e-05)         —            —                       (1.68e-06)
                                                                Σgh             Σ0,g                     Σ1,g
     -3.09e-04       5.09e-04         0                       -0.8932         3.61e-11        0        0.0063        0
    (4.54e-05)      (3.66e-05)       —                       (0.0587)       (1.11e-11)        —       (0.0004)      —
     -4.50e-06       -2.52e-04    3.78e-04                    0.0538         -1.89e-11    -5.80e-12    -0.0035    0.0046
    (2.23e-05)      (2.82e-05)   (2.37e-05)                  (0.0397)       (8.52e-12)   (1.30e-12)   (0.0003)   (0.0003)
       δ1,g                                                      δ1,h          δ1,g
        1              1            1                             1             1           1
        —              —            —                             —             —           —
 p                                                       p
  diag (Ω) × 1200                                         diag (Ω) × 1200
       3m              2 yr        3 yr        4 yr            3m             2 yr         3 yr        4 yr
     0.2243           0.1251      0.1235      0.1077         0.2245          0.1248       0.1236      0.1078


Maximum likelihood estimates with quasi-maximum likelihood standard errors. Left: Gaussian A0 (3) model.
Right: non-Gaussian A1 (3) model. The identifying restrictions µQ
                                                                g = 0, δ1,g = ι, and δ1,h = 1 are imposed
during estimation.


H = 0, 1, 2, 3 volatility factors and four factor spanned models AH (4) with H = 0, 1. We
also estimate four USV models from Section 4.2.2: three versions of U1 (4)(φ, φ2 , ψ) as well
as the U1 (4)(φ, φ2 , φ4 ) model. We report the estimates as well as quasi-maximum likelihood
standard errors as in White(1982) for eight models that have better empirical performance,
leaving out the estimates for models with lower likelihoods for brevity.




                                                          28
                          Figure 1: Bond loadings for six different three factor models.
                       A0(3) model                                               A1(3) model                                              A3(3) model
  1                                                           1                                                       18

0.9                                                          0.9                                                      16
                                                                                                         0.996
0.8                                            0.995         0.8                                                      14                                          0.997
                                                                                                         0.951
                                               0.954                                                                                                              0.954
                                                                                                         0.536
0.7                                            0.530         0.7                                                      12                                          0.535

0.6                                                          0.6                                                      10

0.5                                                          0.5                                                       8

0.4                                                          0.4                                                       6

0.3                                                          0.3                                                       4

0.2                                                          0.2                                                       2

0.1                                                          0.1                                                       0

  0                                                           0                                                       −2
      0      10   20       30        40   50            60         0   10   20       30        40   50           60        0    10   20       30        40   50           60

                  A3(3) diagonal model                                      USV1(4)(φ,φ2,ψ) model                                    USV1(4)(ψ,φ,φ2) model
  1                                                                                                                    1
                                                               1
                                                                                                         0.987
 0.9                                            0.997                                                                 0.9
                                                             0.9                                         0.974
                                                0.954                                                    0.495                                                    0.997
 0.8                                            0.535                                                                 0.8                                         0.907
                                                             0.8
                                                                                                                                                                  0.823
 0.7                                                                                                                  0.7
                                                             0.7

 0.6                                                         0.6                                                      0.6

 0.5                                                         0.5                                                      0.5

 0.4                                                         0.4                                                      0.4

 0.3                                                         0.3                                                      0.3

 0.2                                                         0.2                                                      0.2

 0.1                                                         0.1                                                      0.1

  0                                                            0                                                       0
       0     10   20       30        40   50            60         0   10   20       30        40   50           60         0   10   20       30        40   50           60




Bond loadings B as a function of maturity n. Top row from left to right: A0 (3) model, A1 (3) model, A3 (3)
model. Second row: A3 (3) model with diagonal ΦQ                   2                             2
                                                  h , U1 (4)(φ > φ > ψ) model, U1 (4)(ψ > φ > φ ) model.
Reported in each graph are the eigenvalues of the risk-neutral feedback matrix ΦQ . To make the restricted
A3 (3) model easily comparable, we report the absolute value of the loadings for this model.


6.1           Estimates and model fit

Three factor spanned models Estimates with standard errors for the A0 (3) and A1 (3)
models are included in Table 2. These two models have historically drawn most of the
attention in the term structure literature. For the A0 (3) model, the concentrated likelihood
drops the number of parameters entering the numerical optimizer from 22 to 10 (excluding
Ω), while this number drops from 24 to 16 for the A1 (3) model. The likelihood for the A0 (3)
model at 37080.94 is significantly higher than the A1 (3) model at 36647.69.
           Surprisingly, among the models that we estimated, the A3 (3) model has the highest
likelihood with a value of 37385.28, substantially higher than the A0 (3) model. We report
estimates for this model on the right panel of Table 3. In order to satisfy the admissibility



                                                                                   29
                                     Q
restrictions, all values in Σh , Σ−1           −1
                                  h Φh Σh and Σh Φh Σh must be non-negative.
                                                                             15
                                                                                We also
                                                                                Q
impose the discrete-time equivalent of the Feller condition, i.e. νh,i > 1 and νh,i > 1 for
i = 1, . . . , H.16 In the A3 (3) model, we found that some of these parameters were near
their boundaries. We fix them at the boundary when calculating the standard errors. For
comparison purposes, we also report on the left panel of Table 3 estimates of an A3 (3)
model where the matrices Φh and ΦQ
                                 h are restricted to be diagonal in which case the estimated

parameters are not close to the boundaries. Finally, we note that the A2 (3) model (estimates
not reported for brevity) had the lowest likelihood among the models we estimated with a
value of 36120.34.
       The bond loadings for the A0 (3), A1 (3), and diagonal A3 (3) models are almost the same,
see Figure 1. This happens for two reasons. First, the functional form of the bond loading
recursions are the same up to Jensen’s inequality. Second, the size of the measurement errors
in the cross-section of yields are small relative to the magnitude of the time series shocks
causing an efficient estimator (like maximum likelihood) to emphasize the fit of the cross
section. The estimated factors of these models have high correlations (ranging from 0.95
to 1). Interestingly, the bond loadings for the unrestricted A3 (3) model appear to be non-
stationary, even though the eigenvalues of ΦQ
                                            h for this model are inside the unit circle and are

nearly identical to the other models.17 The average pricing errors are similar in these models,
with the more restricted diagonal A3 (3) model having larger values. The measurement errors
are about 22 basis points for 3 months, 12 for 2 years, 12 for 3 years and 11 for 4 years.
These errors have the same magnitude as those reported in Ang and Piazzesi(2003).
       Differences between these models are largely driven by their ability to fit the time series
  15
     Multiple non-Gaussian factors tend to make the inversion problem more complicated. We solve this with
randomized starting values, and use several iterations of “fminsearch” in MATLAB for each starting value
to get an initial value that does not produce negative volatility. It takes roughly 20 trials (within a minute)
to locate a starting value for the A3 (3) model.
  16
     No arbitrage requires that the stochastic discount factor Mt+1 is strictly positive which is guaranteed
by the Feller condition, see Appendix D for details.
  17
     Unlike Gaussian models, the bond loading recursions b̄n,h for multi-factor non-Gaussian models in (6)
are non-linear difference equations. The stability conditions for these equations appear to be determined by
more than the eigenvalues of ΦQ  h . We leave the conditions for stability of b̄n,h for future research.




                                                      30
component of the likelihood. For example, in the A1 (3) model, the conditional mean under P
is more restricted than the A0 (3) model as the Gaussian factors cannot enter the conditional
mean of the non-Gaussian factors. The economic implication of this restriction for the A1 (3)
model is that the level factor does not depend on the past values of slope and curvature
factors. This is apparently counterintuitive. If the slope is high in the last period, i.e., the
long rate is much higher than the short rate (more than explained by compensating for risk),
then it means the market expects the short rate will increase in the future. On average, the
next periods’ short rate or level will increase.


Four factor USV models The two best fitting USV models are the U1 (4)(φ > φ2 > ψ)
and U1 (4)(ψ > φ > φ2 ) models, whose estimates are in Table 4. See Section 4.2.2 for the
definition of the models. We calculate the likelihood for USV models by the particle filter,
see Creal(2012). The likelihood for the best fitting U1 (4)(φ > φ2 > ψ) model is 37331.25,
which is lower than the unrestricted A3 (3) model but substantially higher than other spanned
models.
   The bond loadings for USV models are not as flexible compared to spanned models due
to the USV restrictions explained in Section 4.2.2. The first USV model constrains the two
largest eigenvalues of ΦQ for the level and slope factors to be related as φ and φ2 . Without any
restrictions on the eigenvalues of ΦQ as in the A0 (3) and A1 (3) models, these are estimated
to be 0.995 and 0.954. In the U1 (4)(φ > φ2 > ψ) model, if the level factor has φ = 0.995,
the USV restriction would require the slope factor to be more persistent φ2 = 0.990 than
it would be without the restriction (0.954). Conversely, if the model tried to fit the slope
factor first, the USV restriction would not allow the level factor to be persistent enough.
As a compromise, the two eigenvalues in the U1 (4)(φ > φ2 > ψ) model are closer to each
other than what the data would like with estimated values φ = 0.9868 and φ2 = 0.9738.
Consequently, the loadings on the level and slope factors in this model lie in between the
loadings for spanned models, see Figure 1. Due to the more restrictive loadings, it is not



                                               31
                    Table 3: Maximum likelihood estimates for two A3 (3) models.
        diagonal         LLF =       36949.94                      flexible       LLF =       37385.28
         Σh νh                                                     Σh νh
        5.48e-05        2.75e-04     3.27e-04                     5.35e-07       4.45e-05     9.35e-06
           —               —            —                            —              —            —
           νh                                                        νh
         7.2325         10.7472       5.3456                          1           3.1176         1
        (5.2324)        (4.9148)     (1.2905)                        —           (2.7588)        —
           Φh                                                        Φh
         0.9918             0            0                         0.9587         0.0010          0
        (0.0056)           —            —                         (0.0102)       (0.0003)        —
            0            0.9511          0                         0.3109         0.9133       0.5975
           —            (0.0136)        —                         (0.2807)       (0.0259)     (0.1841)
            0               0         0.8133                          0           0.0226       0.7876
           —               —         (0.0298)                                    (0.0018)     (0.0408)

         Σh νhQ                                                    Σh νhQ
        2.01e-05        3.10e-04     6.63e-04                     8.10e-07       1.43e-05     9.35e-06
           —               —            —                            —              —            —
           νhQ                                        δ0             νhQ                                        δ0
         2.6464         12.0937      10.8396       -0.0070         1.5151           1            1          -9.12e-04
        (0.7721)        (5.2723)     (1.9412)     (0.0016)        (1.7822)          —            —         (4.82e-04)
           ΦQh                                                       ΦQh
         0.9996             0            0                         0.9890         0.0002          0
        (0.0005)           —            —                         (0.0014)       (0.0000)        —
            0            0.9479          0                            0           0.8850       1.3287
           —            (0.0018)        —                            —           (0.0333)     (0.2776)
            0               0         0.4837                       0.4968         0.0206       0.6122
           —               —         (0.0239)                     (0.0964)       (0.0047)     (0.0490)
           Σh                                                         Σh
        7.58e-06             0            0                        5.35e-07           0            0
       (1.27e-06)           —            —                        (5.84e-08)         —            —
            0            2.56e-05         0                            0          1.43e-05         0
           —            (6.60e-06)       —                            —          (3.05e-06)       —
            0               0         6.12e-05                         0             0         9.35e-06
           —                —        (5.95e-06)                       —              —        (2.43e-06)
          δ1,h                                                       δ1,h
           1               1            -1                            1             1            -1
           —               —            —                             —             —            —
    p                                                         p
     diag (Ω) × 1200                                           diag (Ω) × 1200
          3m              2 yr         3 yr        4 yr             3m             2 yr         3 yr         4 yr
        0.2247           0.1324       0.1286      0.1112          0.2230          0.1274       0.1236       0.1077
Maximum likelihood estimates with asymptotic quasi-maximum likelihood standard errors. Left: A3 (3) model
with diagonal matrices ΦQ h and Φh . Right: A3 (3) model. The identifying restrictions µh = 0, and δ1,h =
(1, 1, −1) are imposed during estimation.


surprising that the average pricing errors for this model are larger than for spanned models.
Moreover, the Gaussian factors whose eigenvalues share the relationship φ and φ2 are highly
correlated with a correlation of -0.928. This number is 0.43 in absolute value for the A0 (3)
and A1 (3) models for example.
   Estimation of an A0 (3) that includes the same restrictions on ΦQ                    2
                                                                   g as the U1 (4)(φ > φ >

ψ) model but no stochastic volatility has a likelihood of 37040.5. This indicates that this


                                                             32
           Table 4: Maximum likelihood estimates for two U1 (4)(φ, φ2 , ψ) models.
      G = 3, H = 1      LLF =       37331.25                     G = 3, H = 1           LLF =       37241.05
            µg                                                             µg
        2.11e-04        -1.88e-04    -2.37e-04                         7.42e-04         -1.17e-03    8.49e-06
       (5.04e-07)      (3.66e-07)   (2.39e-06)                        (8.80e-05)       (8.42e-05)   (5.76e-06)
            Φg                                                            Φg
          1.0724        0.1181        0.1107                            1.1316          0.3251        0.0520
        (0.0020)       (0.0008)     (0.0009)                           (0.0427)        (0.1009)     (0.0161)
         -0.0788        0.8736       -0.0555                            -0.2881         0.4463       -0.0923
        (0.0008)       (0.0015)     (0.0005)                           (0.0213)        (0.0715)     (0.0149)
         -0.0321        -0.0372       0.6347                            0.0348          0.0349        0.9995
        (0.0000)       (0.0001)     (0.0070)                           (0.0162)        (0.0233)     (0.0029)

           µQ
            g                                       δ0                    µQ
                                                                           g                                        δ0
            0             0            0          0.0061                   0              0            0          0.0115
           —              —            —         (0.0000)                 —               —            —         (0.0007)
           ΦQg                                                            ΦQg
         0.9868         0.9738       0.4931                             0.9073          0.8231       0.9967
        (0.0004)          —         (0.0019)                           (0.0045)           —         (0.0004)
           Σ0,g                                                           Σ0,g
        1.16e-03             0           0                              1.21e-03            0            0
       (2.41e-06)           —           —                             (7.24e-05)           —            —
        -1.23e-03        2.44e-04       0                              -1.30e-03        2.13e-05        0
       (2.83e-06)      (1.14e-07)       —                             (4.63e-06)       (4.40e-05)       —
        5.04e-05        -4.27e-04    1.66e-10                          -3.67e-04        7.05e-05     3.31e-04
       (9.23e-08)      (2.10e-06)   (3.90e-13)                        (1.06e-04)       (1.43e-04)   (9.73e-05)
           Σ1,g                                                           Σ1,g
        7.05e-04          0            0                                8.35e-04          0            0
       (1.44e-06)         —            —                              (4.03e-05)          —            —
            0             0            0                                   0              0            0
            —             —            —                                   —              —            —
            0             0            0                                   0              0            0
            —             —            —                                   —              —            —
          νh              Φh           Σh                                 νh              Φh           Σh
           1            0.9598       0.0100                             1.0658          0.9539       0.0100
          —            (0.0086)        —                               (0.0319)        (0.0101)        —
          δ1,g                                                           δ1,g
           1              1            1                                  1               1            1
           —              —            —                                  —               —            —
    p                                                            p
     diag (Ω) × 1200                                                 diag (Ω) × 1200
          3m             2 yr         3 yr        4 yr                    3m             2 yr         3 yr        4 yr
        0.2266          0.1298       0.1316      0.1101                 0.2266          0.1298       0.1316      0.1101
Maximum likelihood estimates with quasi-maximum likelihood standard errors for two unspanned models.
Left: U1 (4)(φ > φ2 > ψ) model. Right: U1 (4)(ψ > φ > φ2 ) model. The USV and the identifying restrictions
Σh = 0.01, µQg = 0, and δ1,g = (1, 1, 1) are imposed during estimation.



single USV restriction is rejected relative to the benchmark Gaussian A0 (3) model of Table 2
by a likelihood ratio test. On the other hand, the addition of unspanned stochastic volatility
factors increases the likelihood by 37331.25 - 37040.5 = 290.75. The primary source is a
significantly better fit of the dynamics of volatility, as we discuss further below.
   When the USV restriction is imposed on the second and third largest eigenvalues as in
the U1 (4)(ψ > φ > φ2 ) model of Table 4, it constrains the bond loadings of the slope and


                                                            33
curvature factors because the eigenvalues in ΦQ
                                              g associated with these factors now share the

relationship φ and φ2 . This restriction causes them to be closer than they would otherwise
have been if left unrestricted. The U1 (4)(φ, φ2 , φ4 ) model imposes even stronger restrictions
on ΦQ
    g because it only has a single free parameter. It has likelihood 36889.44 (parameter

estimates not reported), which is well below the benchmark A0 (3) model.


Four factor spanned models Finally, we consider two four factor spanned models: the
Gaussian A0 (4) model and the non-Gaussian A1 (4) model. There are a total of 35 parameters
in the A0 (4) model and only 20 of these parameters enter the numerical optimizer, while there
are 39 parameters in the A1 (4) model and 15 of these can be concentrated out. Parameter
estimates and standard errors for both models are in Table 5. While adding another Gaussian
factor increases the likelihood relative to the A0 (3) model to 37194.34 for the A0 (4), the
additional factor is not as important as adding an USV factor.


Repeated eigenvalues When we estimated the A1 (4) model, we found that it had re-
peated eigenvalues and our estimates in Table 5 have imposed them using the Jordan de-
composition. If we use a diagonal matrix for ΦQ , the matrix B1 will be singular and one
element in ΦQ is unidentified.18 To illustrate this point, Table 6 reports different sets of
parameter values all with the same likelihood. Across the four local maxima, the values of
ΦQ                           Q
 h , the last eigenvalue of Φg , and the log-likelihood function are almost identical but the

first two eigenvalues of ΦQ
                          g vary across different optima. The last column of Table 6 shows

the results when we impose repeated eigenvalues (from the model reported in Table 2). The
estimates of ΦQ                           Q
              h , the last eigenvalue of Φg and the likelihood function have the same values

as before. However, the first two eigenvalues of ΦQ
                                                  g are identical by definition and are equal

to the average of the first two eigenvalues in those local maxima. The log-likelihood value
also does not change.
  18
    For a matrix with repeated eigenvalues, the Jordan decomposition imposes the additional restrictions
necessary to obtain identification. With two repeated eigenvalues in ΦQ        g , the Jordan decomposition is
        0
vec ΦQg    = (λ 1 1 0 ; 0 λ1 0 ; 0 0 λ2 ) where λ1 and λ 2 are the unique eigenvalues.


                                                     34
           Table 5: Maximum likelihood estimates for the A0 (4) and A1 (4) models.



   G = 4, H = 0      LLF =       37195.84                    G = 3, H = 1      LLF =       36729.22
        µg                                                        Σh νh           µg                                    νh
     3.89e-04        -9.73e-04    1.28e-03     -8.19e-04        5.64e-05       3.07e-04     -3.76e-05    -3.10e-04    2.6780
    (1.73e-04)      (2.11e-04)   (3.07e-04)   (3.68e-04)            —         (1.76e-04)   (1.84e-05)   (1.79e-04)   (1.8951)
        Φg                                                          Φh
      1.0336         0.0874       -0.0142      0.0908             0.9901
     (0.0352)       (0.0536)     (0.0475)     (0.0646)          (0.0073)
                                                                   Φgh           Φg
      -0.0783        0.8338        0.2044      -0.0788            0.0037       0.8668        1.1695      0.0911
     (0.0626)       (0.0893)     (0.1298)     (0.1734)          (0.0260)      (0.0644)     (0.4487)     (0.0974)
      0.0889         0.1541        0.6935      0.1926             0.0016       0.0153        0.8156      0.0028
     (0.0766)       (0.1312)     (0.1731)     (0.2259)          (0.0031)      (0.0062)     (0.0456)     (0.0097)
      -0.0851        -0.1405      -0.0398       0.5456           -0.0352       -0.0095      -0.1235      0.6508
     (0.0528)       (0.0901)     (0.0924)     (0.1377)          (0.0257)      (0.0555)     (0.4361)     (0.0974)

        µQ
         g                                                        Σh νhQ         µQ
                                                                                  g                                     νhQ
         0             0            0            0              2.71E-05          0           0            0          1.2839
        —              —            —            —                 —             —            —            —         (0.3516)
        ΦQg                                                        ΦQh           ΦQg
      0.9922         0.9604       0.8764       0.6964            0.9952        0.9121         —          0.7021
     (0.0024)       (0.0116)     (0.0303)     (0.0504)          (0.0011)      (0.0075)        —         (0.0324)
       Σ0,g                                                          Σh
     6.94e-04          0            0            0               2.11e-05
    (2.33e-04)         —            —            —              (3.75e-06)
                                                                    Σgh           Σ0,g
     -1.47e-03       9.77e-04         0           0                0.9248       8.37e-04       0            0
    (2.80e-04)      (3.98e-04)        —           —              (0.4737)     (2.90e-04)       —            —
     1.66e-03        -1.39e-03    8.74e-04        0               -0.2171      -9.03e-05    7.43e-13        0
    (1.96e-04)      (4.33e-04)   (3.21e-04)       —              (0.0333)     (2.69e-05)   (4.22e-12)       —
     -8.06e-04       5.65e-04     -7.18e-04    4.04e-04           -1.5635      -7.96e-04    9.41e-11     4.03e-10
    (3.69e-04)      (2.68e-04)   (3.59e-04)   (2.68e-05)         (0.4198)     (2.72e-04)   (1.75e-11)   (6.48e-11)
                                                                                  Σ1,g
                                                                               1.04e-02         0           0
                                                                              (2.48e-03)       —            —
                                                                               -6.75e-04    8.15e-04         0
                                                                              (2.75e-04)   (7.96e-05)       —
                                                                               -9.01e-03    1.12e-03     4.68e-03
                                                                              (2.69e-03)   (4.10e-04)   (3.04e-04)
        δ0                                                           δ0
     3.92e-03                                                    -4.44e-04
    (6.45e-04)                                                  (3.67e-04)
       δ1,g                                                         δ1,h         δ1,g
        1              1            1            1                   1            1           1            1
        —              —            —            —                   —            —           —            —
 p                                                         p
  diag (Ω) × 1200                                           diag (Ω) × 1200
       3m             3 yr         4 yr                          3m             3 yr         4 yr
     0.2390          0.1013       0.0982                       0.2408          0.1005       0.0981


Maximum likelihood estimates with quasi-maximum likelihood standard errors. Left: Gaussian A0 (4) model.
Right: non-Gaussian A1 (4) model. The identifying restrictions µQ
                                                                g = 0, δ1,g = ι, and δ1,h = 1 are imposed
during estimation.




                                                           35
         Figure 2: Estimated conditional volatility of yields from four different affine models.
      x 10
             −3                 1 month maturity                               x 10
                                                                                      −4                 1 year maturity                                  −4
                                                                                                                                                       x 10                      5 year maturity

                                                           A1(3) model                                                              A (3) model                                                            A1(3) model
                                                                          16                                                            1          9
                                                           GAS model                                                                GAS model                                                              GAS model
                                                           A (3) model                                                              A (3) model                                                            A (3) model
                                                              0                                                                         0          8                                                           0
  2                                                                       14


                                                                          12                                                                       7

1.5                                                                                                                                                6
                                                                          10

                                                                                                                                                   5
                                                                           8
  1
                                                                                                                                                   4
                                                                           6

                                                                                                                                                   3
                                                                           4
0.5
                                                                                                                                                   2
                                                                           2
                                                                                                                                                   1
                  1960   1970      1980      1990      2000       2010                     1960   1970      1980      1990      2000        2010                   1960   1970     1980       1990      2000       2010
         −3                     1 month maturity                                  −4
                                                                               x 10                      1 year maturity                               x 10
                                                                                                                                                              −4                 5 year maturity
      x 10

                                                          A3(3) model                                                              A3(3) model                                                              A3(3) model
                                                                          16                                                                       9
                                                          GAS model                                                                GAS model                                                                GAS model
                                                          A0(3) model                                                              A0(3) model                                                              A0(3) model
 2                                                                        14                                                                       8


                                                                          12                                                                       7

1.5                                                                                                                                                6
                                                                          10

                                                                                                                                                   5
                                                                           8
 1                                                                                                                                                 4
                                                                           6
                                                                                                                                                   3
                                                                           4
0.5
                                                                                                                                                   2
                                                                           2
                                                                                                                                                   1
                  1960   1970      1980      1990      2000       2010                     1960   1970     1980       1990      2000        2010                   1960   1970      1980      1990      2000        2010

      x 10
             −3                 1 month maturity                               x 10
                                                                                      −4                 1 year maturity                               x 10
                                                                                                                                                              −4                 5 year maturity

                                                    U1(4)(φ,φ2,ψ) model   16                                                 U1(4)(φ,φ2,ψ) model   9                                                 U1(4)(φ,φ2,ψ) model
                                                    GAS model                                                                GAS model                                                               GAS model
  2                                                 A0(3) model                                                              A0(3) model           8                                                 A0(3) model
                                                                          14


                                                                          12                                                                       7

1.5                                                                                                                                                6
                                                                          10

                                                                                                                                                   5
                                                                           8
  1
                                                                                                                                                   4
                                                                           6
                                                                                                                                                   3
0.5                                                                        4
                                                                                                                                                   2
                                                                           2
                                                                                                                                                   1
                  1960   1970      1980      1990      2000        2010                    1960   1970      1980      1990      2000        2010                   1960   1970      1980      1990      2000        2010

      x 10
             −3                 1 month maturity                               x 10
                                                                                      −4                 1 year maturity                               x 10
                                                                                                                                                              −4                 5 year maturity

                                                    U1(4)(ψ,φ,φ2) model   16                                                 U1(4)(ψ,φ,φ2) model   9                                                 U1(4)(ψ,φ,φ2) model
                                                    GAS model                                                                GAS model                                                               GAS model
                                                    A0(3) model                                                              A0(3) model           8                                                 A0(3) model
  2                                                                       14


                                                                          12                                                                       7

1.5                                                                                                                                                6
                                                                          10

                                                                                                                                                   5
                                                                           8
  1
                                                                                                                                                   4
                                                                           6
                                                                                                                                                   3
                                                                           4
0.5
                                                                                                                                                   2
                                                                           2
                                                                                                                                                   1
                  1960   1970       1980     1990       2000       2010                    1960   1970      1980      1990       2000       2010                   1960   1970      1980      1990      2000        2010




Estimated conditional volatility of yields from different affine models compared to the multivariate generalized
autoregressive score model and the A0 (3) with constant volatility. Across the columns are the one month,
one year, and 5 year maturities. Top row: A1 (3) model. Second row: A3 (3) model. Third row: U1 (4)(φ >
φ2 > ψ) model. Bottom row: U1 (4)(ψ > φ > φ2 ) model.



                                                                                                             36
                                  Table 6: Repeated Eigenvalues
                                 Local 1   Local 2   Local 3 Repeated
                         ΦQ
                          h       0.9952    0.9952    0.9952    0.9952
                         ΦQ
                          g       0.9130    0.9164    0.9126    0.9121
                                  0.9112    0.9075    0.9115         –
                                  0.7021    0.7025    0.7021    0.7021
                        LLF     36729.22 36729.20 36729.22 36729.22
Estimates from the A1 (4) model when repeated eigenvalues are not imposed compared to when they are. The
table illustrates how this can create identification problems in affine models.



6.2       Volatility

The blue lines in Figure 2 are the conditional volatilities from four different models; across
the rows are the A1 (3), A3 (3), U1 (4)(φ > φ2 > ψ) and U1 (4)(ψ > φ > ψ 2 ) models.19 The
three columns represent maturities of 1 month, 1 year, and 5 years. The volatilities for
the USV models are the filtered (one-sided) estimates calculated from the particle filter.
To provide a point of comparison, we also plot in these graphs the unconditional volatility
from the A0 (3) model in green and in red estimates of the conditional volatilities from the
multivariate generalized autoregressive score model of Creal, Koopman, and Lucas(2011)
and Creal, Koopman, and Lucas(2013).20
       The estimated volatilities from spanned models (first two rows) are much less volatile
than GAS volatility. A similar observation was made by Collin-Dufresne, Goldstein, and
Jones(2009). With only a single volatility factor, the A1 (3) model does not fit yield volatil-
ity at any maturity. The A3 (3) model adds flexibility with two more factors, which improves
the fit for volatility at shorter horizons, especially for the recent episode of low volatility.
At longer horizons, the fit to volatility appears to be the same as the A1 (3) model. This
is because the estimated level (volatility) factor is similar across both the A1 (3) and A3 (3)
models, and the long term volatility loads mostly on it. Ultimately, spanned models lack
  19
    The volatilities from the remaining models have the same qualitative features and are not shown.
  20
    The generalized autoregressive score model with time-varying covariance matrix is similar to a multi-
variate GARCH model. To make the volatilities of yields comparable across models, we use a VAR(1) for
                                 (1)
the conditional mean of yields Yt and allow the errors to have time-varying volatilities and correlations.




                                                   37
flexibility because the non-Gaussian state variables ht serve a dual role: they must simultane-
ously fit the conditional mean and variance. The maximum likelihood estimator chooses the
parameter vector θ to fit the conditional mean first before fitting the conditional variance.
    USV models are designed to fit volatility by separating the role of Gaussian and non-
Gaussian factors. The U1 (4)(φ > φ2 > ψ) model performs much better than spanned models
at fitting the volatility across different maturities, although it only has a single stochastic
volatility factor. It does a particularly good job for short and medium maturities. At longer
maturities, it fits the high volatility periods of the early 1980’s well, although misses the
period of low volatility early in the sample.
    Our results suggest, however, that not all USV models fit yield volatility equally well
and researchers must be careful when choosing USV restrictions. We demonstrate this
point by comparing the performance of the two best USV models U1 (4)(φ > φ2 > ψ)
and U1 (4)(ψ > φ > φ2 ). Instead of having stochastic volatility on the level factor, the
U1 (4)(ψ > φ > φ2 ) model has stochastic volatility on the slope factor. It fits the volatility
at shorter maturities equally well but, at longer maturities, it exhibits almost no stochastic
volatility. This is because the eigenvalue associated with the slope factor that has stochastic
volatility is φ = 0.9073 as opposed to φ = 0.9868 in the first USV model. The bond loadings
on this factor decay rapidly as maturity increases, meaning that long maturities have no
stochastic volatility. To summarize, although USV models are designed to fit the volatility,
the restrictions needed to impose USV are not unique and the choice of which restriction to
impose is not innocuous.



7     Conclusion

We provide new estimation procedures for non-Gaussian affine term structure models with
spanned or unspanned stochastic volatility. The new estimation approach for spanned mod-
els leverages the fact that many of the parameters can be concentrated out of the likelihood



                                                38
function. By optimizing the concentrated likelihood, it provides exactly the same solution as
maximizing the original likelihood. But, it improves the estimation dramatically by reduc-
ing the number of parameters that need to be maximized numerically. We demonstrate the
improvement in performance with our method. Using our procedure, we show what charac-
teristics of spanned non-Gaussian models cause local maxima to exist and how alternative
local maxima may have dramatically different economic implications. We apply a similar
idea to the concentrated likelihood to estimate unspanned models.
   Estimating a wide range of popular models, we find that models with spanned volatility
have similar cross sectional fit for yields. They fit better than the USV models, because the
latter impose restrictions on the cross section in order to introduce USV factors. Models with
USV fit the volatility better by design. The choice of how to impose USV restrictions is not
innocuous as some USV models can severely limit yield volatility at particular maturities.
   USV models make an effort to fit the volatility of yields. Future work on term struc-
ture models aiming to fit both the conditional mean and volatility of yields simultaneously
will likely require (1) multiple unspanned volatility factors, and (2) the ability to relax the
restrictions that USV impose on the cross section.



References

    Abramowitz, Milton, and Irene A. Stegun (1964) Handbook of Mathematical Functions
        Dover Publications Inc, New York, NY.

    Adrian, Tobias, Richard K. Crump, and Emanuel Moench (2012) “Pricing the term
        structure with linear regressions.” Journal of Financial Economics 110, 110–138.

    Aı̈t-Sahalia, Yacine (2008) “Closed-form likelihood expansions for multivariate diffu-
        sions.” The Annals of Statistics 36, 906–937.

    Aı̈t-Sahalia, Yacine, and Robert L. Kimmel (2010) “Estimating affine multifactor term
        structure models using closed-form likelihood expansions.” Journal of Financial Eco-

                                              39
   nomics 98, 113–144.

Andersen, Torben, and Luca Benzoni (2010) “Do bonds span volatility risk in the U.S.
   treasury market? A specification test for affine term structure models.” The Journal
   of Finance 65, 603–653.

Ang, Andrew, and Monika Piazzesi (2003) “A no-arbitrage vector autoregression of term
   structure dynamics with macroeconomic and latent variables” Journal of Monetary
   Economics 50, 745–787.

Bauer, Michael D. (2014) “Bayesian Estimation of Dynamic Term Structure Models
   under Restrictions on Risk Pricing” Federal Reserve Bank of San Francisco Working
   Paper.

Bauer, Michael D., Glenn D. Rudebusch, and Jing Cynthia Wu (2012) “Correcting esti-
   mation bias in dynamic term structure models.” Journal of Business and Economic
   Statistics 30, 454–467.

Cheridito, Patrick, Damir Filipovic, and Robert L. Kimmel (2007) “Market price of
   risk specifications for affine models: theory and evidence” Journal of Financial Eco-
   nomics 84, 123–170.

Christensen, Jens H.E., Francis X. Diebold, and Glenn D. Rudebusch (2011) “The affine
   arbitrage-free class of Nelson-Siegel term structure models.” Journal of Econometrics
   164, 4–20.

Cochrane, John H., and Monika Piazzesi (2008) “Decomposing the yield curve” Unpub-
   lished manuscript, Booth School of Business, University of Chicago.

Collin-Dufresne, Pierre, and Robert S. Goldstein (2002) “Do bonds span the fixed in-
   come markets? Theory and evidence for unspanned stochastic volatility.” The Jour-
   nal of Finance 57, 1685–1730.

Collin-Dufresne, Pierre, Robert S. Goldstein, and Charles Jones (2008) “Identification
   of maximal affine term structure models.” The Journal of Finance 63, 743–795.

                                        40
Collin-Dufresne, Pierre, Robert S. Goldstein, and Charles Jones (2009) “Can the volatil-
   ity of interest rates be extracted from the cross section of bond yields? An investiga-
   tion of unspanned stochastic volatility.” Journal of Financial Economics 94, 47–66.

Cox, John C., Jonathan E. Ingersoll, and Stephen A. Ross (1985) “A theory of the term
   structure of interest rates” Econometrica 53, 385–407.

Creal, Drew D. (2012) “A survey of sequential Monte Carlo methods for economics and
   finance.” Econometric Reviews 31, 245–296.

Creal, Drew D., Siem Jan Koopman, and André Lucas (2011) “A dynamic multivariate
   heavy-tailed model for time-varying volatilities and correlations.” Journal of Busi-
   ness and Economic Statistics 29, 552–563.

Creal, Drew D., Siem Jan Koopman, and André Lucas (2013) “Generalized autoregres-
   sive score models with applications.” Journal of Applied Econometrics 28, 777–795.

Dai, Qiang, and Kenneth J. Singleton (2000) “Specification analysis of affine term struc-
   ture models.” The Journal of Finance 55, 1943–1978.

de Jong, Piet (1991) “The diffuse Kalman filter” The Annals of Statistics 19, 1073–83.

Dempster, Arthur P., Nan M. Laird, and Donald B. Rubin (1977) “Maximum likelihood
   from incomplete data via the EM algorithm” Journal of the Royal Statistical Society,
   Series B 39, 1–38.

Diebold, Francis X., and Glenn D. Rudebusch (2013) Yield Curve Modeling and Fore-
   casting. Princeton University Press, Princeton, NJ.

Diez de Los Rios, Antonio (2013) “A new linear estimator for Gaussian dynamic term
   structure models.” Unpublished manuscript, Bank of Canada.

Duffee, Gregory R. (2002) “Term premia and interest rate forecasts in affine models”
   The Journal of Finance 57, 405–443.




                                         41
Duffee, Gregory R. (2011) “Information in (and not in) the term structure” The Review
   of Financial Studies 24, 2895–2934.

Duffee, Gregory R. (2012) “Bond pricing and the macroeconomy” Working paper, Johns
   Hopkins University.

Duffie, Darrell, and Rui Kan (1996) “A yield factor model of interest rates” Mathemat-
   ical Finance 6, 379–406.

Durbin, James, and Siem Jan Koopman (2012) Time Series Analysis by State Space
   Methods Oxford University Press, Oxford, UK 2 edition.

Fama, Eugene F., and Robert R. Bliss (1987) “The information in long maturity forward
   rates” American Economic Review 77, 680–692.

Godsill, Simon J., Arnaud Doucet, and Michael West (2004) “Monte Carlo smoothing
   for nonlinear time series.” Journal of the American Statistical Association 99, 156–
   168.

Gouriéroux, Christian, and Joann Jasiak (2006) “Autoregressive gamma processes.”
   Journal of Forecasting 25, 129–152.

Gouriéroux, Christian, Joann Jasiak, and Razvan Sufana (2009) “The Wishart autore-
   gressive process of multivariate stochastic volatility.” Journal of Econometrics 150,
   167–181.

Gouriéroux, Christian, Alain Monfort, and Vassilis Polimenis (2002) “Affine term struc-
   ture models.” Institut National de La Statistique et des Etudes Economiques.

Gürkaynak, Refet S., and Jonathan H. Wright (2012) “Macroeconomics and the term
   structure” Journal of Economic Literature 50, 331–367.

Hamilton, James D., and Jing Cynthia Wu (2012) “Identification and estimation of
   Gaussian affine term structure models.” Journal of Econometrics 168, 315–331.




                                         42
Hamilton, James D., and Jing Cynthia Wu (2014) “Testable implications of affine term
   structure models.” Journal of Econometrics 178, 231–242.

Heidari, Massoud, and Liuren Wu (2003) “Are interest rate derivatives spanned by the
   term structure of interest rates?” The Journal of Fixed Income 13, 75–86.

Jacquier, Eric, Michael Johannes, and Nicholas G. Polson (2007) “MCMC maximum
   likelihood for latent state models” Journal of Econometrics 137, 615–640.

Joslin, Scott (2010) “Can unspanned stochastic volatility models explain the cross sec-
   tion of bond volatilities?” Working paper, University of Southern California, Mar-
   shall School of Business.

Joslin, Scott, Kenneth J. Singleton, and Haoxiang Zhu (2011) “A new perspective on
   Gaussian affine term structure models” The Review of Financial Studies 27, 926–
   970.

Kim, Don H., and Athanasios Orphanides (2005) “Term structure estimation with sur-
   vey data on interest rate forecasts.” Federal Reserve Board, Finance and Economics
   Discussion Series 2005-48.

Kim, Don H., and Jonathan H. Wright (2005) “An arbitrage-free three-factor term
   structure model and the recent behavior of long-term yields and distant-horizon
   forward rates.” Federal Reserve Board, Finance and Economics Discussion Series
   2005-33.

Le, Anh, Kenneth J. Singleton, and Qiang Dai (2010) “Discrete-time affine term struc-
   ture models with generalized market prices of risk.” The Review of Financial Studies
   23, 2184–2227.

Li, Haitao, and Feng Zhao (2006) “Unspanned stochastic volatility: evidence from hedg-
   ing interest rate derivatives.” The Journal of Finance 61, 341–378.

Malik, Sheheryar, and Michael K. Pitt (2011) “Particle filters for continuous likelihood
   evaluation and maximisation.” Journal of Econometrics 165, 190–209.

                                        43
Meng, Xiao-Li, and Donald B. Rubin (1993) “Maximum likelihood estimation via the
   ECM algorithm: A general framework.” Biometrika 80, 267–278.

Piazzesi, Monika (2010) “Affine term structure models” in Handbook of Financial Econo-
   metrics, edited by Y. Ait-Sahalia and L. P. Hansen Elsevier, New York pages 691–
   766.

Richard, Jean Francois, and Wei Zhang (2007) “Efficient high-dimensional importance
   sampling” Journal of Econometrics 141, 1385–1411.

Trolle, Anders B., and Eduardo S. Schwartz (2009) “A general stochastic volatility
   model for the pricing of interest rate derivatives.” The Review of Financial Studies
   22, 2007–2057.

Wei, Greg C. G., and Martin A. Tanner (1990) “A Monte Carlo implementation of the
   EM algorithm and the poor man’s data augmentation algorithms.” Journal of the
   American Statistical Association 85, 699–704.

White, Halbert L. (1982) “Maximum likelihood estimation of misspecified models.”
   Econometrica 50, 1–25.




                                       44
Appendix A                         Distributions
We define the distributions found in the paper. The notation for them is local to the appendix.



Appendix A.1                      Gamma and multivariate gamma distributions
                                                                                  1     νh −1 −νh
                                                                                                  exp − wt+1
                                                                                                               
A gamma r.v. wt+1 ∼ Gamma (νh , κ) has p.d.f p (wt+1 |νh , κ) =                 Γ(νh ) wt+1 κ               κ    and E (wt+1 )                =
                                                                                              νh
                                                                                            1
νh κ and V (wt+1 ) = νh κ2 . The Laplace transform is                E [exp (uwt+1 )] = 1−κu       , which exists only if κu <                1.
    A multivariate gamma random vector ht+1 ∼ Mult. Gamma (νh , Σh , µh ) can be obtained by shifting and
rotating a vector of uncorrelated gamma r.v.’s. Let ht+1 = µh + Σh wt+1 where wt+1 is an H × 1 vector with
elements wi,t+1 ∼ Gamma (νh,i , 1) for i = 1, . . . , H. The H × 1 vector of (non-negative) location parameters
is µh , Σh is a full rank H × H matrix of (non-negative) scale parameters, and νh > 0 is a H × 1 vector of
shape parameters. The p.d.f of ht+1 can be determined by a standard change-of-variables

                                                 H
                                                 Y      1                         νh,i −1
                                  = |Σ−1                       e0i Σ−1                     exp −e0i Σ−1
                                                                                                                    
        p (ht+1 |νh , Σh , µh )       h |                           h [ht+1 − µh ]                   h [ht+1 − µh ]
                                                 i=1
                                                     Γ (νh,i )


where ei is an H × 1 unit vector. The mean and variance are E [ht+1 ] = µh + Σh νh and V [ht+1 ] =
Σh diag (νh ) Σ0h . The Laplace transform is

                                   Z    ∞
       E [exp (u0 ht+1 )]    =              exp (u0 ht+1 ) p (ht+1 |νh , Σh , µh ) dht+1
                                    0
                                                   Z    ∞                           H
                                                                                    Y      1       νh,i −1
                             =     exp (u0 µh )             exp (u0 Σh wt+1 )                     wi,t+1   exp (−wt+1 ) dwt+1
                                                    0                               i=1
                                                                                        Γ (νh,i )
                                                   H                       νh,i                      H
                                                                                                                                          !
                                             0
                                                   Y            1                               0
                                                                                                       X
                             =     exp (u µh )                                       = exp u µh −            νh,i log [1 −   e0i Σ0h u]
                                                   i=1
                                                            1 − e0i Σ0h u                              i=1


The Laplace transform exists only if e0i Σ0h u < 1 for i = 1, . . . , H.



Appendix A.2                      Multivariate non-central gamma distributions
A H × 1 non-central gamma (NCG) random vector ht+1 ∼ Mult.-N.C.G. (νh , Φh ht , Σh , µh ) is a Poisson
mixture of multivariate gamma r.v.’s as in (12)-(14). The process ht remains positive and well-defined as
long as µh ≥ 0, Σ−1
                 h Φh Σh ≥ 0, νh > 1, and elements of Σh cannot be negative. A standard multivariate NCG

random variable (the discrete-time CIR process) is obtained by setting µh = 0 and letting Σh be a diagonal
matrix. Further properties of the univariate NCG process are described in Gouriéroux and Jasiak(2006).




                                                                      45
       As long as Σh has full rank, the p.d.f. can be found by integrating out the Poisson r.v.’s

                                                                 H
                                                                                                                                   !
                                                                 X
p (ht+1 |νh , Φh ht , Σh , µh )   =   |Σ−1
                                        h | exp              −          e0i Σ−1
                                                                             h    [ht+1 − µh ] +            e0i Σ−1
                                                                                                                 h Φh   [ht − µh ]
                                                                 i=1
                                      H
                                      Y                              νh,i −1
                                                  e0i Σ−1
                                                       h [ht+1 − µh ]
                                      i=1
                                         ∞
                                        X                    1             1  0 −1                                     zi,t+1
                                                                                 ei Σh [ht+1 − µh ] e0i Σ−1
                                                                                                   
                                                                                                         h Φh [ht − µh ]
                                      zi,t+1      =0
                                                     Γ (νh,i + zi,t+1 ) zi,t+1 !


Using the definition of the modified Bessel function of the first kind21 , the p.d.f. can be expressed as

                                                                                  H
                                                                                                                                                 !
                                                                                  X
            p (ht+1 |νh , Φh ht , Σh , µh )        =    |Σ−1
                                                          h | exp           −           e0i Σ−1
                                                                                             h    [ht+1 − µh ] +        e0i Σ−1
                                                                                                                             h Φh    [ht − µh ]
                                                                                  i=1
                                                        H
                                                        Y                                      νh,i2 −1                           − νh,i2 −1
                                                                     e0i Σ−1
                                                                          h [ht+1 − µh ]                      e0i Σ−1
                                                                                                                   h  Φh [ht − µh ]
                                                        i=1
                                                                 q                                       
                                                                       −1
                                                                    0
                                                                                      0 −1              
                                                        Iνh,i −1 2 ei Σh [ht+1 − µh ] ei Σh Φh [ht − µh ] .


The Laplace transform can be derived from the law of iterated expectations

                                                                                                               H                       νh,i +zi !
                   0
                                                                0                                      0
                                                                                                               Y            1
         E [exp (u ht+1 )]    = Ez       Eh|z [exp (u ht+1 )] = Ez                           exp (u µh )
                                                                                                               i=1
                                                                                                                        1 − e0i Σ0h u
                                                       H                         νh,i            H                      zi !
                                                       Y             1                             Y             1
                              =    exp (u0 µh )                                             Ez
                                                       i=1
                                                                 1 − e0i Σ0h u                     i=1
                                                                                                             1 − e0i Σ0h u
                                                       H                               H                                           0 0 !
                                                                                                             e0i Σ−1
                                                                                  νh,i Y
                                                                     1                                            h Φh [ht − µh ] ei Σh u
                                                       Y
                                              0
                              =    exp (u µh )                                                    exp
                                                       i=1
                                                                 1 − e0i Σ0h u              i=1
                                                                                                                     1 − e0i Σ0h u
                                                         H                                             H
                                                                                                                                  !
                                                         X             e0i Σ0h u 0 −1                 X
                              =    exp u0 µh +                                    e Σ Φh (ht − µh ) −     νh,i log (1 − e0i Σ0h u)
                                                          i=1
                                                                     1 − e0i Σ0h u i h                i=1


where e0i Σ0h u denotes the i-th element of the H ×1 vector Σ0h u. The Laplace transform exists only if e0i Σ0h u < 1
for i = 1, . . . , H.



Appendix A.3                      Mixture of Gaussian and mult. NCG distributions
From standard results in statistics, the multivariate (G × 1) Gaussian r.v. gt+1 ∼ N gt+1 |µg , Σg Σ0g has
                                                                                                      

Laplace transform E [exp (u0 gt+1 )] = exp µ0g u + 21 u0 Σg Σ0g u for any real (G × 1) vector u. Consider
                                                                 

a (G + H) × 1 vector xt+1 = (h0t+1 , gt+1
                                      0
                                          )0 where ht+1 is an H × 1 vector having a multivariate NCG
                                                                                      z
                                        x λ                                       x2
  21
                                                  P∞          1
       This is defined as Iλ (x) =      2              z=0 Γ(λ+z+1)z!             4         , see Abramowitz and Stegun(1964).



                                                                             46
distribution p (ht+1 |νh , Φh ht , Σh , µh ) and gt+1 is a G × 1 vector of conditionally Gaussian r.v. gt+1 ∼
N µg + Σgh ht+1 , Σg Σ0g . Let u = (u0h , u0g )0 where uh and ug are H × 1 and G × 1 vectors, respectively. Using
                          

the law of iterated expectations, the Laplace transform is


       E [exp (u0 xt+1 )]   = E exp u0g gt+1 exp (u0h ht+1 ) = Eh Eg|h exp u0g gt+1 exp (u0h ht+1 )
                                                                                            
                                                                                      
                                                                1
                            = Eh exp (µg + Σgh ht+1 )0 ug + u0g Σg Σ0g ug exp (u0h ht+1 )
                                                                2
                                                       
                                           1
                            = exp u0g µg + u0g Σg Σ0g ug Eh exp u0g Σgh + u0h ht+1
                                                                                  
                                           2
                                                                          H
                                                 1                       X
                            =     exp u0g µg + u0g Σg Σ0g ug + u0gh µh −     νh,i log (1 − e0i Σ0h ugh )
                                                 2                       i=1
                                     H
                                                                         !
                                           0 0
                                    X     ei Σh ugh 0 −1
                                  +                    e Σ Φh (ht − µh )
                                    i=1
                                        1 − e0i Σ0h ugh i h


where ugh = Σ0gh ug +uh is an H ×1 vector. The Laplace transform exists only if e0i Σ0h ugh < 1 for i = 1, . . . , H.
This is the key expression for solving for closed-form zero-coupon bond prices.




Appendix B                        Bond pricing
                                                                                                       
Bond prices can be solved by induction. Guess that bond prices are Ptn = exp ān + b̄0n,h ht + b̄0n,g gt for
                                                                                  0
some coefficients ān , b̄n,h , and b̄n,g . At maturity n = 1 when the payoff is Pt+1 = 1, we find


                            Pt1       EQ             0                  0         0
                                                                                       
                                  =    t exp (−rt ) Pt+1   = exp −δ0 − δ1,h ht − δ1,g gt


such that ā1 = −δ0 , b̄1,g = −δ1,g and b̄1,h = −δ1,h . Next, consider an n-period bond whose price in the next
           n−1
period is Pt+1 . We find


 Ptn     EQ             n−1
                               = EQ                0        0                      0            0
                                                                                                       
       =  t exp (−rt ) Pt+1          t exp −δ0 − δ1,h ht − δ1,g gt exp ān−1 + b̄n−1,h ht+1 + b̄n−1,g gt+1

                    0         0
                                  gt + ān−1 EQ       0              0
                                                                              
       = exp −δ0 − δ1,h ht − δ1,g             t exp b̄n−1,h ht+1 + b̄n−1,g gt+1


                                                                                                                0
where the expectation is taken with respect to the distribution of the random vector xt+1 = h0t+1 , gt+1
                                                                                                     0



               Q
                                                  
                               Q
        ht+1   ∼ Mult-NCG νh,i   , ΦQ
                                    h ht , Σh , µh
               Q
                                                  h                                       i            
                                    Q                                Q            Q     Q             0
        gt+1   ∼ N µQg + Φ Q
                             g
                           g t  + Φ   h
                                    gh t   + Σ  gh   ht+1 −   (IH − Φh )µh + Σ  ν
                                                                               h h  + Φ   h
                                                                                        h t    , Σ   Σ
                                                                                                  g,t g,t




                                                            47
This expectation has the same form as the Laplace transform provided in Appendix A. We find

               
                        0        0                 1
Ptn   =   exp −δ0 − δ1,g   gt − δ1,h ht + ān−1 + b0n−1,g Σg,t Σ0g,t b̄n−1,g
                                                   2
            h                                                                i0
                              Q                      Q            Q       Q
          + µQg + Φ Q
                      g
                    g t   + Φ   h
                              gh t −  Σ gh   (IH − Φ h )µh + Σ  ν
                                                               h h    + Φ   h
                                                                          h t     b̄n−1,g
                                        H                                           H
                                                                                                                    !
                                  0    X     e0i Σ0h b̄n−1,gh 0 −1 Q              X    Q
           + Σ0gh b̄n−1,g + bn−1,h µh +                                                              0 0
                                                                                                                  
                                                                e Σ Φ [ht − µh ] −     νh,i log 1 − ei Σh b̄n−1,gh
                                       i=1
                                            1 − e0i Σ0h b̄n−1,gh i h h             i=1
                                            h                         i
                                           0                 Q0 0          Q0 0 0
      =   exp −δ0 + ān−1 + µQ0
                             g b̄n−1,g + µh bn−1,h + Φh Σgh b̄n−1,g − νh Σh Σgh b̄n−1,g
                                              H                                   H
            1 0                0
                                             X    Q            0 0
                                                                             X         e0i Σ0h b̄n−1,gh 0 −1 Q
          + bn−1,g Σ0,g Σ0,g b̄n−1,g −           νh,i log 1 − ei Σh b̄n−1,gh −                            e Σ Φ µh
            2                                i=1                                 i=1
                                                                                      1 − e0i Σ0h b̄n−1,gh i h h
          + b̄0n−1,g ΦQ          0
                                     
                       g − δ1,g gt
            "H
              X e0 Σ0 b̄n−1,gh                   Q
                                                             
                                                                 Q           Q
                                                                               
          +           i h
                          0  0
                                        e0i Σ−1         0
                                             h Φh + b̄n−1,g Φgh − Σgh Φh − δ1,h
                                                                                     0

              i=1
                  1  −  e   Σ    b̄
                          i h n−1,gh
                                                            
            1                       0
          + IH ⊗ b̄n−1,g Σg Σ0g ιH ⊗ b̄n−1,g ht
                                                          
            2

where Σg Σ0g is a GH ×GH matrix with diagonal elements Σi,g Σ0i,g for i = 1, . . . , H and b̄n−1,gh = Σ0gh b̄n−1,g +
b̄n−1,h . The Laplace transform exists only if e0i Σ0h b̄n−1,gh < 1 for i = 1, . . . , H.




Appendix C                      Factor rotations

Appendix C.1                  Proof of Proposition 1
The admissibility restrictions needed to keep ht positive are: (1.) Chg = 0; (2.) Chh is such that all elements
Chh Σh are non-negative; (3.) ch is such that ch + Chh µh is non-negative; (4.) Chh and Cgg are full rank.
For some values of θ, these restrictions may allow ch and Chh to be negative.
                                                    0
                                                                                                                     0
    Under these restrictions, the process h̃0t , g̃t0 is a member of the same family of distributions as (h0t , gt0 )
only under a new parameters θ̃. The proof is immediate by comparing the Laplace transform of these random
variables before and after rotating them. The mapping between the parameters θ̃ and θ is


                                                      −1                                              −1
              µ̃h = ch + Chh µh         Φ̃h = Chh Φh Chh          Σ̃h = Chh Σh          Φ̃g = Cgg Φg Cgg


                            −1                                                      −1
                                                                                                     −1
µ̃g = cg + Cgg µg − Cgg Φg Cgg cg + Cgh ([IH − Φh ] µh + Σh νh ) − Cgh Φh − Cgg Φg Cgg Cgh + Cgg Φgh Chh ch

                                         −1
                                                          −1                                        −1
             Φ̃gh =     Cgh Φh − Cgg Φg Cgg Cgh + Cgg Φgh Chh               Σ̃gh = (Cgh + Cgg Σgh ) Chh




                                                           48
                                          H
                                          X                                                      H
                                                                                                 X
                                                                0 0 −1                                                 0 0 −1
    Σ̃0,g Σ̃00,g = Cgg Σ0,g Σ00,g Cgg
                                   0
                                      −         Cgg Σi,g Σ0i,g Cgg ei Chh ch    Σ̃i,g Σ̃0i,g =         Cgg Σj,g Σ0j,g Cgg ej Chh ei
                                          i=1                                                    j=1






Appendix D                          Stochastic discount factor
We define the stochastic discount factor as

                            exp (−rt ) p (gt+1 |It , ht+1 , zt+1 ; θ, Q) p (ht+1 |It , zt+1 ; θ, Q) p (zt+1 |It ; θ, Q)
              Mt+1    =
                                 p (gt+1 |It , ht+1 , zt+1 ; θ, P) p (ht+1 |It , zt+1 ; θ, P) p (zt+1 |It ; θ, P)

where the distributions are Gaussian, gamma, and Poisson. The exact SDF is
                                                                  PH 0 −1 Q                    
                                  exp −rt − 21 εQ0        Q
                                                   g,t+1 εg,t+1 −     i=1 ei Σh Φh [ht − µh ]
                       Mt+1     =                               PH                          
                                     exp − 12 ε0g,t+1 εg,t+1 − i=1 e0i Σ−1   h Φh [ht − µh ]
                                   H
                                                                                               !zi,t+1
                                                                                  Q
                                  Y      Q
                                       νh,i −νh,i Γ (νh,i + zi,t+1 )    e0i Σ−1
                                                                              h Φ h [ht − µh ]
                                      wi,t+1                            0 Σ−1 Φ [h − µ ]
                                                        Q               e
                                  i=1             Γ   ν   +  zi,t+1
                                                             h,i          i   h   h   t    h



where εg,t+1 = Σ−1                                                         −1
                g,t (gt+1 − µg − Φg gt − Φgh ht − Σgh εh,t+1 ) and wt+1 = Σh [ht+1 − µh ]. No arbitrage

requires that Mt+1 > 0 which implies that wt+1 > 0. The Feller conditions νh > 1 and νhQ > 1 guarantee
that wt+1 > 0 under both probability measures.
     For intuition, break the log-SDF mt+1 = log (Mt+1 ) into three terms; one for each of the shocks


                                      mt+1        = −rt + mg,t+1 + mh,t+1 + mz,t+1


                                                                           Q                             Q
where mi,t+1 is the compensation for risk i. Let λg = µg − µQ                             Q
                                                            g , λh = νh − νh , Λg = Φg − Φg , Λh = Φh − Φh ,

and Λgh = Φgh − ΦQ
                 gh .

     For the Gaussian part, we find mg,t+1 = − 21 λ0gt λgt − λ0gt g,t+1 where g,t+1 = Σ−1
                                                                                         g,t εg,t+1 is a standard,

zero mean Gaussian shock. The price of Gaussian risk is


                          λgt   =    Σ−1
                                      g,t {(λg + Λg gt + Λgh ht ) − Σgh [Σh λh + Λh (ht − µh )]}



This generalizes the expression for Gaussian ATSMs, with a time-varying quantity of risk Σg,t .




                                                                   49
       Recall that wt+1 = Σ−1
                           h (ht+1 − µh ). We will write risk compensation in terms of wt+1 .


                   H
                   X                                           
                                  Q               Q
                                                      + zi,t+1 − 1 log e0i Σ−1                0 −1
                                                                                          
mh,t+1     =             − log Γ νh,i + zi,t+1 + νh,i                       h (ht+1 − µh ) − ei Σh (ht+1 − µh )
                   i=1
                   H
                   X
                         log Γ (νh,i + zi,t+1 ) − (νh,i + zi,t+1 − 1) log e0i Σ−1                0 −1
                                                                                             
                                                                               h (ht+1 − µh ) + ei Σh (ht+1 − µh )
                   i=1
                                                  
                   H
                   X        Γ (νh,i + zi,t+1 )         Q
                                                             
                                                               log e0i Σ−1
                                                                                       
           =           log                  − νh,i − νh,i            h  (ht+1 − µh )
                                Q
                   i=1      Γ νh,i  + zi,t+1
                   H                                                         H
                                             ν −ν Q
                   X                                                       X
           ≈             log [νh,i + zi,t+1 ] h,i h,i − λh,i log (wi,t+1 ) =   −λh,i [log (wi,t+1 ) − log (νh,i + zi,t+1 )]
                   i=1                                                                   i=1
                   H                                          H
                   X                 wi,t+1 − νh,i − zi,t+1      X        λh,i       wi,t+1 − νh,i − zi,t+1
           =           −λh,i log 1 +                           ≈     −√                  √
                   i=1
                                          νh,i + zi,t+1          i=1
                                                                       νh,i + zi,t+1      νh,i + zi,t+1

                                                                                                                               wi,t+1 −νh,i −zi,t+1
The compensation for gamma risks is approximately mh,t+1 ≈ −λ0wt w,t+1 where w,t+1,i =                                           √
                                                                                                                                     νi +zi,t+1

is a gamma r.v. standardized to have mean 0 and variance 1.22 The market price of risk is λwt,i =
    λh,i
√              .   We note that V (wit |zt ) = νh,i + zi,t .
  νh,i +zi,t+1

       Consider the non-Gaussian part due to the Poisson distribution

                             H
                             X                                      
                                                        Q                                         Q
          mz,t+1         =         zi,t+1 log e0i Σ−1
                                                   h  Φ h (ht − µh )   − log (zi,t+1 !) − e0i Σ−1
                                                                                               h Φh (ht − µh )
                             i=1
                           −zi,t+1 log e0i Σ−1                                    0 −1
                                                             
                                            h Φh (ht − µh ) + log (zi,t+1 !) + ei Σh Φh (ht − µh )
                            H
                                               e0i Σ−1
                                                                
                                                     h Λh Σh wt
                           X
                         =     zi,t+1 log 1 − 0 −1                 + e0i Σ−1
                                                                          h Λh Σh wt
                           i=1
                                               ei  Σh  Φh Σh w t
                             H
                             X         e0i Σ−1
                                             h Λh Σh wt
                         ≈         −zi,t+1
                                        0 Σ−1 Φ Σ w
                                                          + e0i Σ−1
                                                                 h Λh Σh wt
                           i=1
                                       ei h       h h t
                            H                                                      H
                                                     zi,t+1 − e0i Σ−1                    e0i Σ−1
                                                                             
                                                                   h Φh Σh wt                 h Λh Σh wt
                           X                                                      X
                         =     −e0i Σ−1
                                     h  Λ  h Σh wt         0  −1                =     − q                z,t+1,i
                           i=1
                                                          ei Σh Φh Σh wt          i=1      e0 Σ−1 Φ Σ w        i   h   h   h    t



                                                                        zi,t+1 −e0i Σ−1
                                                                                     h Φh Σh wt
The log SDF is mz,t+1 ≈ −λ0zt z,t+1 where z,t+1 =                          √                    is Poisson r.v. standardized to have
                                                                              e0i Σ−1
                                                                                   h Φh Σh wt
                                                e0i Σ−1
                                                      h Λh Σh wt
mean 0 and variance 1 and λzt,i = √                                 .
                                                  e0i Σ−1
                                                       h Φh Σh wt


  22                                                            Γ(a+x)                            1
                                                                                                      
    Our derivation uses the approximation that                  Γ(b+x)       ∝ xa−b 1 + O         x        for large x. We also use the fact
that log(1 + x) = x for small x.




                                                                        50
Appendix E                                Log-likelihood for spanned models
Dropping the initial condition, the conditional log-likelihood for the general affine model is given by

                                                                                               T                            T
                                                                  T −1           1X                  1X
     `(θ)     =        CONST − (T − 1) log |B1 | −                     log |Ω| −       tr Ω−1 ηt ηt0 −       log Σg,t−1 Σ0g,t−1
                                                                    2            2 t=2                 2 t=2
                             T
                         1X                     −1          
                       −       tr Σg,t−1 Σ0g,t−1     εgt ε0gt
                         2 t=2
                                                  T X
                                                  X H                                      T X
                                                                                           X H
                       −(T − 1) log|Σh | −                     e0i Σ−1
                                                                    h (ht − µh ) −                   e0i Σ−1
                                                                                                          h Φh (ht−1 − µh )
                                                  t=2 i=1                                  t=2 i=1
                           T X
                             H                                                         T X
                                                                                         H
                           X     (νh,i − 1)                                   (νh,i − 1)
                                                                                       X
                                             log e0i Σ−1                                 log e0i Σ−1
                                                                                                                   
                       +                               h [ht − µh ] −                             h Φh [ht−1 − µh ]
                         t=2 i=1
                                      2                               t=2 i=1
                                                                                   2
                         XT X H                q                                            
                                                        −1
                                                      0
                                                                      0 −1                 
                       +         log Iνh,i −1 2 ei Σh [ht − µh ] ei Σh Φh [ht−1 − µh ]
                           t=2 i=1


where Iλ (x) is the modified Bessel function of the first kind and ei is the H × 1 unit vector.




Appendix F                                Proofs and Analytical Derivatives
In this appendix, we prove the propositions in the paper. We begin with a preliminary lemma.


Lemma 1 The derivative of the concentrated log-likelihood function can be computed as the partial derivative
                                d`(θ̂c (θm ),θm )  ∂`(θ̂c ,θm )
of the log-likelihood function:        dθ 0       = ∂θ0         , where θ̂c (θm ) = arg max ` (θc , θm )
                                                         m                  m
                                                                                                                    θc


                  d`(θ̂c (θm ),θm )       ∂`(θ̂c ,θm )       ∂`(θc ,θm )                           ∂`(θ̂c ,θm )
Proof:                     0
                         dθm          =      ∂θm 0       +      ∂θc0     |θc =θ̂c dθ̂dθ
                                                                                     c (θm )
                                                                                        0      =      ∂θm 0     ,   where   ∂`(θc ,θm )
                                                                                                                               ∂θc0     |θc =θ̂c   = 0 by the
                                                                                        m

definition of θ̂c . 



Appendix F.1                          Proof of Proposition 2
Proof First, we show that optimizing the original likelihood and optimizing the concentrated likelihood
lead to equivalent solutions. Solving max ` (θ) requires ∂`(θ  c ,θm )
                                                              ∂θm0     = 0 and ∂`(θ∂θm0,θc ) = 0. The solution
                                       θ                                              c
                                         d`(θ̂c (θm ),θm )                       ∂`(θ̂c ,θm )
                      
to max ` θ̂c (θm ) , θm has the property        dθ 0       = 0. By Lemma 1,           ∂θ 0     = 0. This with
     θm                                                                     m                                                   m
∂`(θc ,θm )
   ∂θc0     |θc =θ̂c   = 0 by the definition of θ̂c constitute the two F.O.C.’s for the original problem.
     Second, showing θ̂c can be solved by least squares given θm is straightforward. A value for θm maps
into a value for the loadings A and B though (9)-(10), and therefore xt by (16). Given the factors, equation




                                                                                51
(11) is a linear regression with heteroskedasticity, hence GLS. Given yields, factors and bond loadings, Ω in
equation (17) is the variance-covariance matrix in a linear regression with homoskedasticity, hence OLS. 



Appendix F.2                    Proof of Proposition 3
We use the result in Lemma 1 to derive the gradients for the concentrated log likelihood based on the original
log-likelihood, which makes the derivation easier.


Proof A direct result of Lemma 1 is ( c m mdθm0 m
                                   d` θ̂ (θ ),θ ,A(θ ),B(θm ))                       ∂`(θ̂c ,θm ,A(θm ),B(θm ))
                                                               =                                   0
                                                                                                 ∂θm            .      Applying the chain
rule,
                                                                                               
                ∂` θ̂c , θm , A (θm ) , B (θm )              ∂` θ̂c , θm , A, B  ∂` θ̂c , θm , A, B ∂A (θ )
                                                                                                          m
                                 0
                                                         =            0
                                                                               +
                               ∂θm                               ∂θm                     ∂A0            0
                                                                                                      ∂θm
                                                                              
                                                             ∂` θ̂c , θm , A, B ∂vec B (θm )0
                                                                                                
                                                           +                0            0
                                                                                                  .
                                                                ∂vec (B 0 )          ∂θm





Appendix F.3                    Gradients
We now provide the analytical gradient. Note that θ̂c = (µ̂g , Φ̂g , Φ̂gh , Ω̂) are optimized by θ̂c = argmax ` (θc , θm )
                                                                                                          θc
                                       q
                                              −1
                                           0
                                                            0 −1                                   −1
detailed in Proposition 2. Let h̃it = 2 ei Σh [ht − µh ] ei Σh Φh [ht−1 − µh ] , ĥt = Σh (ht − µh ), and
ˆ
ĥt−1 = Σ−1
          h Φh (ht−1 − µh ). The matrices Sg and Sh extract the Gaussian gt = Sg xt and non-Gaussian

factors ht = Sh xt from xt .

                                                                                                !                                       
                       T                                                T                               T                     ∂Iνh,i −1 h̃it
         ∂`            X                           −1               1X               e0i ĥt           X          1
                = −          ε0gt Σg,t−1 Σ0g,t−1         Σgh Σh ei +       log                      +
                                                                                        ˆ
                                                                                                                       
        ∂νh,i          t=2
                                                                     2 t=2          e0i ĥt−1           t=2   Iνh,i −1 h̃it       ∂νh,i
                       T                                           0
   ∂`                  X                            −1
          0     = −          vec Σ0gh Σg,t−1 Σ0g,t−1     εgt h0t−1
∂vec (Φh )             t=2
                       T X
                         H                                  0 X   T XH                                         0
                       X         
                                        −1                0              (νh,i − 1)    
                                                                                              −1              0
                   −         vec (Σ0h ) ei (ht−1 − µh ) −                           vec (Σ0h ) ei (ht−1 − µh )
                                                                            0ˆ
                     t=2 i=1                                     t=2 i=1 2ei ĥt−1
                                                    
                      T X H                  Iνh,i h̃it
                              (νh,i − 1) +                   2e0 ĥ                            0
                                                       i t vec (Σ0h )−1 ei (ht−1 − µh )0
                     X
                   +
                     t=2 i=1       h̃it     Iνh,i −1 h̃it      h̃it


                        ∂Iλ (x)       λ                                                                                              ∂Iλ (x)
where we have used        ∂x      =   x Iλ (x)   + Iλ+1 (x), see, Abramowitz and Stegun(1964). The derivative                          ∂λ

is a complicated expression that is easier to compute numerically. The derivatives for parameters entering


                                                                  52
the loadings are calculated by the chain rule. Take derivatives of ` w.r.t. the loadings A1 , A2 , B1 and B2 .
Then, take derivatives of the loadings w.r.t. the parameters.

∂`     ∂` ∂A               ∂`      ∂` ∂A      ∂`        ∂vec (B 0 )               ∂`      ∂` ∂A      ∂`        ∂vec (B 0 )
    =                       0   =      0  +           0     0                      0   =      0  +           0     0
∂δ0   ∂A0 ∂δ0             ∂δ1,g      0
                                  ∂A ∂δ1,g ∂vec (B 0 ) ∂δ1,g                     ∂δ1,h      0
                                                                                         ∂A ∂δ1,h ∂vec (B 0 ) ∂δ1,h

  ∂`           ∂` ∂A             ∂`          ∂` ∂A                  ∂`      ∂`    ∂A         ∂`      ∂vec (B 0 )
          =                             =                            0 =          0 +          0     0
 ∂νhQ0        ∂A0 ∂νhQ0         ∂µQ0
                                  g         ∂A0 ∂µQ0
                                                  g             ∂vec ΦQ
                                                                               0
                                                                           ∂A ∂vec ΦQ            0
                                                                                          ∂vec (B ) ∂vec ΦQ
                                                                       g             g                      g


                                 ∂`          ∂`     ∂A           ∂`        ∂vec (B 0 )
                                       0 =                 +
                                            ∂A0 ∂vec ΦQ 0                0           0
                                                              ∂vec (B 0 ) ∂vec ΦQ
                                                                           
                             ∂vec ΦQgh                 gh                        gh


                                    ∂`      ∂`     ∂A          ∂`        ∂vec (B 0 )
                                     0 =                +
                                           ∂A0 ∂vec ΦQ 0               0     0
                                                            ∂vec (B 0 ) ∂vec ΦQ
                                                       
                                ∂vec ΦQh              h                         h


The derivatives of the remaining parameters that enter both the loadings and the P dynamics are

                  d`     ∂`     ∂` ∂A                         d`               ∂`           ∂`    ∂A
                      =      +                                        0 =              0 +
                 dµh0   ∂µh0   ∂A0 ∂µ0h                  dvech (Σ0,g )    ∂vech (Σ0,g )    ∂A ∂vech (Σ0,g )0
                                                                                               0




                         d`                    ∂`            ∂`    ∂A             ∂`        ∂vec (B 0 )
                                0      =              0 +                  0 +            0            0
                     dvec (Σh )             ∂vec (Σh )      ∂A0 ∂vec (Σh )     ∂vec (B 0 ) ∂vec (Σh )
                         d`                     ∂`            ∂`     ∂A              ∂`       ∂vec (B 0 )
                                0      =               0  +                    +
                    dvec (Σgh )             ∂vec (Σgh )      ∂A0 ∂vec (Σgh )0               0
                                                                                 ∂vec (B 0 ) ∂vec (Σgh )
                                                                                                          0

                        d`                       ∂`            ∂`      ∂A                d`       ∂vec (B 0 )
                                0      =                  0 +                    +
                   dvech (Σi,g )            ∂vech (Σi,g )     ∂A0 ∂vech (Σi,g )0              0
                                                                                   ∂vec (B 0 ) ∂vech (Σi,g )
                                                                                                              0




                                T                                        0
            ∂`                  X                            −1                         0 0
                    0   = −           vec Σ0gh Σg,t−1 Σ0g,t−1     εgt νh0 − (T − 1)vec Σ−1
                                                                                        h
         ∂vec (Σh )             t=2
                                T X
                                  H                                   T X
                                                                        H
                                X                       0        0 X           0 ˆ 0 0
                            +              vec       Σ−1
                                                      h     ei ĥ0t +     vec Σ−1
                                                                               h     ei ĥt−1
                                t=2 i=1                             t=2 i=1
                                T X
                                  H                                             T X  H
                                X   (νh,i − 1)                0         0 X         (νh,i − 1)                0 ˆ 0 0
                            −                      vec Σ−1 h       e  ĥ
                                                                     i t
                                                                        0
                                                                            +                     vec Σ−1       h   ei ĥt−1
                                         2e0i ĥt                                         0ˆ
                              t=2 i=1                                          t=2 i=1 2ei ĥt−1
                                                                
                               T X H                    I         h̃it
                                       (νh,i − 1) +
                                                          νh,i               2e0 ĥ          0 ˆ 0 0
                                                                    i t vec Σ−1
                              X
                            −                                                              h     ei ĥt−1
                              t=2 i=1        h̃it      Iνh,i −1 h̃it          h̃it
                                                                
                               T X H                    Iνh,i h̃it               ˆ
                                        (ν
                                       h,i     − 1)                         2e0 ĥ             0          0
                                                                    i t−1 vec Σ−1
                              X
                                                                                                           0
                            −                        +                                        h      e i ĥt
                              t=2 i=1        h̃it      Iνh,i −1 h̃it            h̃it




                                                                  53
                                                          T                                                    0
                                    ∂`                    X                                −1
                                           0         =          vec        Σg,t−1 Σ0g,t−1           εgt ε0ht
                                ∂vec (Σgh )               t=2




                           T                                                                   0
              ∂`          X       h
                                             0
                                                   −1       0
                                                                     i
                                                                                0
                                                                                      −1          L
                      0 =     vec    Σg,t−1 Σg,t−1     εgt ε gt − IG   Σ g,t−1 Σg,t−1     Σ0,g    DG
         ∂vech (Σ0,g )    t=2

                         T                                                                     0
           ∂`           X       h
                                          0
                                                −1       0
                                                                 i
                                                                          0
                                                                                −1                L
                    0 =     vec    Σ     Σ
                                    g,t−1 g,t−1     ε   ε
                                                      gt gt − IG   Σ     Σ
                                                                    g,t−1 g,t−1     Σ   h
                                                                                     i,g i,t−1    DG
       ∂vech (Σi,g )    t=2



                          T                                                           T X
                                                                                        H                           T X
                                                                                                                      H
         ∂`               X                              −1                          X                             X
                = −             ε0gt Σg,t−1 Σ0g,t−1            Σgh (IH − Φh ) +                     e0i Σ−1
                                                                                                         h +                  e0i Σ−1
                                                                                                                                   h Φh
        ∂µ0h              t=2                                                             t=2 i=1                   t=2 i=1
                          T X
                            H                                   T X
                                                                  H
                          X   (νh,i − 1)                        X   (νh,i − 1)
                    −                              e0i Σ−1
                                                        h +                                e0i Σ−1
                                                                                                h Φh
                                        2e0i ĥt                                  ˆ
                          t=2 i=1                               t=2 i=1      2e0i ĥt−1
                                                     
                       T X H                  I      h̃it
                               (νh,i − 1) +
                                               ν            2 h 0 0 −1                ˆ
                      X                         h,i
                                                                                                    i
                    −                                        ei ĥt ei Σh Φh + e0i ĥt−1 e0i Σ−1
                                                                                                 h
                      t=2 i=1      h̃it      Iνh,i −1 h̃it h̃it


                                      T                                          T
                               ∂`    X                             ∂`           X
                                                                                              0 −1 0
                                         ηt0 Ω−1
                                                                                                  
                                   =                                        0 =     vec x t ηt Ω
                              ∂A02   t=2
                                                                ∂vec (B20 )     t=2




            T h
 ∂`         X                                                          −1
        =         −ηt0 Ω−1 B2 B1−1 + ε0gt Σg,t−1 Σ0g,t−1                     [(IG − Φg ) Sg − (Φgh + Σgh − Σgh Φh ) Sh ] B1−1
∂A01        t=2
                                                                                                       H
             1                  −1 h                             −1 i0 X
            + vec Σg,t−1 Σ0g,t−1      IG − εgt ε0gt Σg,t−1 Σ0g,t−1             vec Σi,g Σ0i,g Shi B1−1
                                                                                             
             2                                                             i=1
                T X
                  H                                T X
                                                     H
                X                                  X   (νh,i − 1)
            +             e0i Σ−1    −1
                               h Sh B1 −                                    e0i Σ−1    −1
                                                                                 h Sh B1
                t=2 i=1                            t=2 i=1      2e0i ĥt
                T X
                  H                                  T X
                                                       H
                X                                    X   (νh,i − 1)
            +             e0i Σ−1       −1
                               h Φh Sh B1 +                                    e0i Σ−1       −1
                                                                                    h Φh Sh B1
                                                                       ˆ
                t=2 i=1                              t=2 i=1      2e0i ĥt−1
                                              
               T X H                   Iνh,i h̃it        ˆ
                        (ν
                       h,i   − 1)                   2e0 ĥ
                                                  i t−1 e0i Σ−1
              X
                                                                       −1
            −                      +                            h Sh B1
              t=2 i=1      h̃it      Iνh,i −1 h̃it      h̃it
                                              
               T X H                   I νh,i h̃it   2e0 ĥ
                       (νh,i − 1) +              i t e0i Σ−1
              X
                                                                       −1
            −                                                 h Φh Sh B1
              t=2 i=1      h̃it      I νh,i −1  h̃it
                                                      h̃it




                                                                     54
                                                        T h
   ∂`                                          0       X                                       0
           0   = −(T − 1)vec B1−1                   +         −vec xt ηt0 Ω−1 B2 B1−1
∂vec (B10 )                                             t=2
                                                       −1                                 0
                  +vec         xt ε0gt   Σg,t−1 Σ0g,t−1         (Sg − Σgh Sh ) B1−1
                                               −1                                    0
                  −vec xt−1 ε0gt Σg,t−1 Σ0g,t−1     (Φg Sg + [Φgh − Σgh Φh ] Sh ) B1−1
                                                                                                              H
                   1                  −1 h                              −1 i0 X
                  + vec Σg,t−1 Σ0g,t−1       IG − εgt ε0gt Σg,t−1 Σ0g,t−1             vec Σi,g Σ0i,g Shi B1−1 ⊗ x0t−1
                                                                                                                    
                   2                                                              i=1
                      T X
                        H                                               T X
                                                                          H
                      X                                        0       X   (νh,i − 1)                                      0
                  +                vec xt e0i Σ−1    −1
                                               h Sh B1              −                                vec xt e0i Σ−1    −1
                                                                                                                 h Sh B1
                      t=2 i=1                                           t=2 i=1      2e0i ĥt
                      T X
                        H                                                        T X
                                                                                   H
                      X                                                 0       X   (νh,i − 1)                                       0
                  +                vec xt−1 e0i Σ−1       −1
                                                 h Φh Sh B1                  +                            vec xt−1 e0i Σ−1       −1
                                                                                                                        h Φh Sh B1
                                                                                                ˆ
                      t=2 i=1                                                    t=2 i=1   2e0i ĥt−1
                                                                       
                     T X H                  Iνh,i h̃it       ˆ
                             (νh,i − 1) +               2e0 ĥ                   −1 0
                                                      i t−1 vec xt e0i Σ−1
                    X                                                               
                  −                                                        h S h B1
                    t=2 i=1      h̃it      Iνh,i −1 h̃it    h̃it
                                                   
                     T X H                  Iνh,i h̃it
                             (νh,i − 1) +               2e0 ĥ                     −1 0
                                                      i t vec xt−1 e0i Σ−1
                    X                                                                  
                  −                                                        h Φh Sh B1
                    t=2 i=1      h̃it      Iνh,i −1 h̃it  h̃it


    The derivatives of A and B w.r.t. the parameters can be computed recursively as a function of maturity
along with ān , b̄n,g and b̄n,h . The derivatives of Bg and Bh have separate recursions. Let b̄n,g,ψ denote
the derivatives of the Gaussian loadings b̄n,g at maturity n w.r.t. a parameter ψ. All recursions are written
assuming that ψ is a full vector/matrix of parameters with no restrictions. If the matrix has fewer parameters
than entries, the user will have to multiply the respective recursion by a selection matrix. Let d¯n−1 =
                                                                                             
                                                                                Q0 Q0 −10 ¯−2
diag ιH − Σ0h b̄n−1,gh be a diagonal H × H matrix. Let c̄0n−1 = ν Q0 d¯−1                        0
                      
                                                                        n−1 − µh Φh Σh dn−1 Σh be an

1 × H vector.


                           ā0n,µQ       = ā0n−1,µQ + b̄0n−1,g
                                  g                     g
                            1×G

                           ā0n,µh       = ā0n−1,µh + b̄0n−1,h + b̄0n−1,g Σgh ΦQ     0         ¯−1 −1 Q
                                                                                h − b̄n−1,gh Σh dn−1 Σh Φh
                            1×H

                           ā0n,ν Q      = ā0n−1,ν Q − log ι0H − b̄0n−1,gh Σh − b̄0n−1,g Σgh Σh
                                                                              
                                 h                      h
                            1×H
                                                                                  0 L
                      ā0n,Σ0,g          = ā0n−1,Σ0,g + vec b̄n−1,g b̄0n−1,g Σ0,g DG
                  1×G(G+1)/2

                          ā0n,δ1h       = ā0n−1,δ1h + µ0h b̄n−1,h,δ1h + c̄0n−1 b̄n−1,h,δ1h
                           1×H




                                                                         55
           ā0n,ΦQ       = ā0n−1,ΦQ + µ0h b̄n−1,h,ΦQ + c̄0n−1 b̄n−1,h,ΦQ
                   gh                gh                       gh                gh
            1×GH

        ā0n,Σi,g        = ā0n−1,Σi,g + µ0h b̄n−1,h,Σi,g + c̄0n−1 b̄n−1,h,Σi,g             i = 1, . . . , H
      1×G(G+1)/2

             ā0n,ΦQ     = ā0n−1,ΦQ + µ0h b̄n−1,h,ΦQ + c̄0n−1 b̄n−1,h,ΦQ
                 h                   h                    h                 h
             1×H 2
                                                                            0 0
                             +vec        Σ0gh b̄n−1,g − Σ−10 ¯−1 0
                                                         h dn−1 Σh b̄n−1,gh µh
                                                                                  h                                i0
           ā0n,Σgh      = ā0n−1,Σgh + µ0h b̄n−1,h,Σgh + c̄0n−1 b̄n−1,h,Σgh + vec b̄n−1,g µ0h ΦQ0
                                                                                                h  − νh
                                                                                                       Q0 0
                                                                                                         Σh + c̄0
                                                                                                                n−1
            1×GH

            ā0n,δ1g     = ā0n−1,δ1g + µ0h b̄n−1,h,δ1g + c̄0n−1 b̄n−1,gh,δ1g
             1×G
                                                        
                                     0 Q0 0      Q0 0 0                   0           0
                             + µQ0
                                g + µh Φh Σgh − νh Σh Σgh b̄n−1,g,δ1g + b̄n−1,g Σ0,g Σ0,g b̄n−1,g,δ1g

             ā0n,ΦQ     = ā0n−1,ΦQ + µ0h b̄n−1,h,ΦQg + c̄0n−1 db̄n−1,gh,ΦQg
                 g                   g
              1×G2
                                                                 
                                       0 Q0 0          Q0 0 0
                           + µQ0 g + µh Φh Σgh − νh Σh Σgh b̄n−1,g,ΦQ       g
                                                                              + b̄0n−1,g Σ0,g Σ00,g b̄n−1,g,ΦQg
                                                                                                                    0
                                                                                        ¯−1 0               0 Q0 −10
         ā0n,Σh         = ā0n−1,Σh + µ0h b̄n−1,h,Σh + c̄0n−1 b̄n−1,h,Σh + vec Σ−10h dn−1 Σh b̄n−1,gh µh Φh Σh
      1×H(H+1)/2
                                                     0                                0
                             −vec Σ0gh b̄n−1,g νh0        + vec b̄n−1,gh c̄0n−1 Σ−10
                                                                                 h



      ∂vec(A)
and     ∂δ0        = ιN and with b̄1,g,δ1g = −IG , b̄1,h,δ1h = −IH . All other initial conditions start at zero.


       b̄n,g,δ1g     =    ΦQ0
                           g b̄n−1,g,δ1g − IG
        G×G

                          ΦQ0           + IG ⊗ b̄0n−1,g
                                                                   
       b̄n,g,ΦQg     =     g b̄n−1,g,ΦQ
                                      g
        G×G2

       b̄n,h,δ1h     =    ΦQ0 −10 ¯−2 0
                           h Σh dn−1 Σh b̄n−1,h,δ1h − IH
        H×H

      b̄n,h,ΦQ       =    ΦQ0 −10 ¯−2 0                     0
                           h Σh dn−1 Σh b̄n−1,h,ΦQ + IH ⊗ b̄n−1,g
              gh                                          gh
       H×GH
                                                                                 0 L
 b̄n,h,Σi,g          =    ΦQ0 −10 ¯−2 0                                0
                           h Σh dn−1 Σh b̄n−1,h,Σgi + ei vec b̄n−1,g b̄n−1,g Σi,g DG                       i = 1, . . . , H
H×G(G+1)/2

       b̄n,h,ΦQ      =    ΦQ0 −10 ¯−2 0                     0                  0         ¯−1 −1
                           h Σh dn−1 Σh b̄n−1,h,ΦQ − IH ⊗ b̄n−1,g Σgh + IH ⊗ b̄n−1,gh Σh dn−1 Σh
            h                                             h
        H×H 2

                          ΦQ0 −10 ¯−2 0                Q0 −10
                                                              IH − d¯−2
                                                                         0     0
      b̄n,h,Σgh      =     h Σh dn−1 Σh b̄n−1,h,Σgh − Φh Σh          n−1 Σh ⊗ b̄n−1,g
       H×GH
                                                                   0
       b̄n,h,δ1g     =    ΦQ0 −10 ¯−2 0                 Q         Q
                           h Σh dn−1 Σh b̄n−1,gh,δ1g + Φgh − Σgh Φh    b̄n−1,g,δ1g
        H×G

                       + IH ⊗ b̄0n−1,g Σg Σ0g ιH ⊗ b̄n−1,g,δ1g
                                                              
                                                                      0
       b̄n,h,ΦQg     = ΦQ0 −10 ¯−2    0
                        h Σh dn−1 Σh b̄n−1,gh,ΦQg
                                                  +   ΦQ
                                                       gh −  Σ  gh Φ Q
                                                                     h    b̄n−1,g,ΦQg
        H×G2
                                                              
                       + IH ⊗ b̄0n−1,g Σg Σ0g ιH ⊗ b̄n−1,g,ΦQg
                                      
                                                                                                              
  b̄n,h,Σh           = ΦQ0 −10 ¯−2    0               Q0 −10
                        h Σh dn−1 Σh b̄n−1,h,Σh − Φh Σh        ⊗ b̄0n−1,gh Σh d¯−1   −1
                                                                                n−1 Σh   + ΦQ0 −10 ¯−2    0
                                                                                            h Σh dn−1 ⊗ b̄n−1,gh
H×H(H+1)/2



                                                                       56
where we also need to account for the derivatives of b̄n,gh = Σ0gh b̄n,g + b̄n,h as


                b̄n−1,gh,δ1g = Σ0gh b̄n−1,g,δ1g + b̄n−1,h,δ1g           b̄n−1,gh,ΦQg = Σ0gh b̄n−1,g,ΦQg + b̄n−1,h,ΦQg
                   H×G                                                    H×G2


Many of the derivatives of the loadings are zero for all maturities including b̄n,g,µh , b̄n,h,µQg ,b̄n,g,δ1h , b̄n,g,ΦQ ,
                                                                                                                                h
                                                                                                  G×H       H×G       G×H   G×H 2
b̄n,g,Σh , b̄n,g,Σ0,g ,b̄n,h,Σ0,g , b̄n,g,ΦQ , b̄n,g,Σi,g , b̄n,g,Σgh , b̄n,g,ν Q , b̄n,h,ν Q .
                                           gh                                  h           h
G×H 2      G×G(G+1)/2 H×G(G+1)/2 G×GH H×G(G+1)/2 G×GH                     G×H         H×H




Appendix G                          USV restrictions

Appendix G.1                     Proof of Proposition 4
We provide proofs for the U1 (4)(φ, φ2 , ψ) and U1 (4)(φ, φ2 , φ4 ) models.


Proof for U1 (4)(φ, φ2 , ψ): Showing bn,h = 0 is equivalent to b̄n,h = 0. We prove b̄n,h = 0 by induction
over n. At n = 1, we have b̄1,h = −δ1,h = 0. Next, suppose b̄n,h = 0, then under the restriction that Σgh = 0,
we find that b̄n,gh = 0. Imposing the restrictions on Σ1,g Σ01,g and from (6), the loading recursion reduces to

                                                                                      1 2
                             b̄n+1,h = ΦQ               Q               Q                       2
                                        gh,1 b̄n,g,1 + Φgh,2 b̄n,g,2 + Φgh,3 b̄n,g,3 + b̄n,g,1 Σ1,g,11
                                                                                      2

                                                                                                                  n
                                                                                     1−φ
The restrictions on ΦQ
                     g together with (7) implies the solution for b̄n,g : b̄n,g,1 = − 1−φ δ1,g,1 , b̄n,g,2 =
      2n                           n
− 1−φ                       1−ψ
   1−φ2 δ1,g,2 , b̄n,g,3 = − 1−ψ δ1,g,3 . Substituting these above gives


                                                   1 − φn                1 − φ2n                1 − ψn
                      b̄n+1,h   = −ΦQ
                                    gh,1                  δ1,g,1 − ΦQ
                                                                    gh,2       2
                                                                                 δ1,g,2 − ΦQ
                                                                                           gh,3        δ1,g,3
                                                    1−φ                  1−φ                     1−ψ
                                                        2
                                           1 (1 − φn ) 2
                                       +               δ   Σ2
                                           2 (1 − φ)2 1,g,1 1,g,11

                                       0       1         2
Collect terms related to (φn ) , (φn ) , (φn ) , ψ n , we get the following three equations

                                                                                    ! 
                                                                       2
                                                                  1 δ1,g,1
                                                                                                       
                               δ1,g,1    δ1,g,2          δ1,g,3                                 δ1,g,3
     b̄n+1,h     =      −ΦQ       −          ΦQ     Q
                                                 − Φgh,3        +           Σ 2            Q
                                                                                     + Φgh,3             ψn
                          gh,1
                           1−φ          1 − φ2gh,2
                                                         1 − ψ 2 (1 − φ)2 1,g,11                1−ψ
                                                   !                                           !
                                     2                                            2
                      Q    δ1,g,1   δ1,g,1     2       n        Q   δ1,g,2   1 δ1,g,1   2
                   + Φgh,1        −         Σ        φ + Φgh,2             +           Σ         φ2n
                           1 − φ (1 − φ)2 1,g,11                   1 − φ2    2 (1 − φ)2 1,g,11

                                                                                      0       1         2
The restrictions on ΦQ                                                n      n      n     n
                     gh guarantee that the coefficients in front of (φ ) , (φ ) , (φ ) , ψ are all zero. Hence,

b̄n+1,h = 0. 



                                                                   57
Proof for U1 (4)(φ, φ2 , φ4 ): We prove b̄n,h = 0 by induction. First, at maturity n = 1, we have
b̄1,h = −δ1,h = 0. Next, suppose b̄n,h = 0, then b̄n,gh = 0 because Σgh = 0 under the USV restrictions. From
(6), the non-Gaussian loading simplifies to

                                                                  1 0
                                             b̄n+1,h = ΦQ0                     0
                                                        gh b̄n,g + b̄n,g Σ1,g Σ1,g b̄n,g                               (G.1)
                                                                  2

Substituting the parameter restrictions on Σ1,g Σ01,g into the equation, we find

                                                                           1 2               1 2
                  b̄n+1,h = ΦQ               Q               Q                       2                 2
                             gh,1 b̄n,g,1 + Φgh,2 b̄n,g,2 + Φgh,3 b̄n,g,3 + b̄n,g,1 Σ1,g,11 + b̄n,g,2 Σ1,g,22
                                                                           2                 2

                                                                                                              n
                                                                                               1−φ
The parameter restrictions on ΦQ
                               g together with (7) implies the solution for b̄n,g : b̄n,g,1 = − 1−φ δ1,g,1 , b̄n,g,2 =
      2n                         4n
− 1−φ                       1−φ
   1−φ2 δ1,g,2 , b̄n,g,3 = − 1−φ4 δ1,g,3 . Substituting these in, we find


                                              1 − φn                 1 − φ2n                 1 − φ4n
                    b̄n+1,h   = −ΦQ
                                  gh,1                δ1,g,1 − ΦQ
                                                                gh,2         δ1,g,2 −  ΦQ
                                                                                        gh,3         δ1,g,3
                                               1−φ                   1 − φ2                  1 − φ4
                                                   2
                                                                                 2
                                        1 (1 − φn ) 2        2       1 1 − φ2n
                                      +              δ     Σ      +                 δ 2 Σ2
                                        2 (1 − φ)2 1,g,1 1,g,11 2 (1 − φ2 )2 1,g,2 1,g,22

                                  0          1         2      4
Collect terms related to (φn ) , (φn ) , (φn ) , (φn )

                                                                                                                       !
                                                                                    2                 2
                             δ1,g,1                  δ1,g,2           δ1,g,3   1 δ1,g,1           1 δ1,g,2
    b̄n+1,h   =       −ΦQ               −   ΦQ              − Φ Q
                                                                             +           Σ 2
                                                                                                +            Σ2
                        gh,1
                                1−φ          gh,2
                                                    1 − φ2      gh,3
                                                                     1 − φ4    2 (1 − φ)2 1,g,11 2 (1 − φ2 )2 1,g,22
                                                              !
                                          2
                                δ1,g,1   δ1,g,1
                    + ΦQ               −        Σ2                φn
                       gh,1
                                1 − φ (1 − φ)2 1,g,11
                                                                                       !
                                           2                   2
                             δ1,g,2   1 δ1,g,1                δ1,g,2
                    +   ΦQ          +            Σ2
                                                         −           Σ2                    φ2n
                         gh,2
                            1 − φ2    2 (1 − φ)2 1,g,11 (1 − φ2 )2 1,g,22
                                                          !
                                            2
                       Q     δ1,g,3   1 δ1,g,2
                    + Φgh,3         +             Σ2        φ4n
                            1 − φ4    2 (1 − φ2 )2 1,g,22

                                                                                           0     1    2         4
The restrictions on ΦQ                                                n      n      n      n
                     gh guarantee that the coefficients in front of (φ ) , (φ ) , (φ ) , (φ ) are all zero.

Therefore, b̄n+1,h = 0. 




                                                                  58
Appendix H                     EM algorithm

Appendix H.1                 Intermediate quantity
Given the identifying restriction µh = 0, we drop this parameter for convenience. The two components of
                                                                     
the intermediate quantity Q θ|θ(i) = Q1 θm,b , θc |θ(i) + Q2 θm,h |θ(i) are

                                                                       T
                                                   T −1           1X
        Q1 θm,b , θc |θ(i)                                                tr Ω−1 ηt ηt0
                                                                                        
                             = − (T − 1) log |B1 | −      log |Ω| −
                                                       2            2 t=2
                                        T                            T
                                     1X                        1X        h               −1 i          
                                 −         E log Σg,t−1 Σ0g,t−1 −       tr E Σg,t−1 Σ0g,t−1       εgt ε0gt
                                     2 t=2                        2 t=2

and

                                              T
                                                X −1 X
                                                     H                       T
                                                                             X −1 X
                                                                                  H
   Q2 θm,h |θ(i)      = −(T − 1) log|Σh | −               e0i Σ−1
                                                               h E [ht ] −             e0i Σ−1
                                                                                            h Φh E [ht−1 ]
                                                t=1 i=1                      t=1 i=1
                             T −1 X
                                  H                                     T −1 X
                                                                             H
                             X     (νh,i − 1)                          X  (νh,i − 1) 
                                             E log e0i Σ−1                            E log e0i Σ−1
                                                                                                         
                         +                              h ht     −                               h Φh ht−1
                           t=1 i=1
                                        2                          t=1 i=1
                                                                                2
                           T
                           X −1 X
                                H                q                               
                                   E log Iνh,i −1 2 e0i Σ−1         0 Σ−1 Φ h
                                                                                 
                         +                                 h h t   ei h    h t−1
                             t=1 i=1

                                                                                                            
Maximizing Q1 θm,b , θc |θ(i) is similar to estimation of a Gaussian ATSM. When maximizing Q1 θm,b , θc |θ(i) ,
the analytical gradient of the intermediate quantity can be derived from the gradients in Appendix E.
                                                             
    There are several options for maximizing Q2 θm,h |θ(i) , all of which lead to different types of EM
algorithms. Each EM algorithm leads to the same maximum but they converge at different rates.
                                                                   
      • Option #1: Maximize the intermediate quantity Q2 θm,h |θ(i) numerically over θm,h as above.

      • Option #2: From the definition of ht+1 in (2)-(4), there is also the variable zt . When calculating
                     
        Q2 θm,h |θ(i) , take the expectations of zt and ht . By introducing zt , the maximization of Φh is
        analytical.
                                                           
      • Option #3: Instead of optimizing over Q2 θm,h |θ(i) at each iteration, a valid EM algorithm can
        optimize the log-likelihood over θm,h . When H = 1, we can use the particle filter of Malik and
                                                               
                                                          (1)
        Pitt(2011) to maximize the log-likelihood log p Y1:T ; θ over θm,h .

For the results in the paper, we used the third option.




                                                           59
Appendix H.2                     Particle filter
                                                                                          
                                                                        (m)
We implement a basic particle filter for the E-step in (a.). Let q ht |ht−1 , gt+1 , gt , θ be an importance
density whose tails are heavier than the target distribution.


For t = 1, . . . , T , run:
                                                                                                               
                                                                             (m)             (m)
     • For m = 1, . . . , M , draw from a proposal distribution: ht                 ∼ q ht |ht−1 , gt+1 , gt , θ .
                                                                                                                                
                                                                                                               (m)     (m)     (m)
                                                                          (m)                 (m) p gt+1 |gt ,ht ,θ p ht |ht−1 ,θ
     • For m = 1, . . . , M , calculate the importance weight:           wt         ∝       ŵt−1       
                                                                                                           (m)   (m)
                                                                                                                               
                                                                                                       q ht |ht−1 ,gt+1 ,gt ,θ

                                                                          (m)
                                                            (m)         w
     • For m = 1, . . . , M , normalize the weights: ŵt          =   PM t      (m)     .
                                                                       m=1     wt

     • Calculate the effective sample size: ESSt =                 1
                                                                       (m) 2
                                                           PM             
                                                             m=1     ŵt

                              n     oM                                 n      oM
                                (m)                                       (m)
     • If ESSt < 0.5M resample ht                    with probabilities ŵt                         and set ŵt = 1/M .
                                               m=1                                            m=1

At time t = 1, q (h1 ; θ) does not depend on any previous particles. Simple proposal distributions are to draw
from the transition density p (ht+1 |ht ; θ) of the model (2)-(4).
                                                     
    To calculate the expectations within Q θ|θ(i) , we use the algorithm of Godsill, Doucet, and West(2004)
                                                   n           oM
                                                       (m) (m)
that draws samples from the posterior. Store ŵt , ht              for t = 1, . . . , T during the particle filter.
                                                                          m=1
                                            (m)                          (m)
On a backwards pass, sample h̃T = hT              with probability ŵT      and then for t = T − 1, . . . , 1
                                                                                              
                                                                   (m)        (m)         (m)
     • For m = 1, . . . , M , calculate backwards weights wt+1|t          ∝ wt p h̃t+1 |ht ; θ .
                                                                             (m)
                                                            (m)         wt+1|t
     • For m = 1, . . . , M , normalize the weights: ŵt+1|t =        PM     (m) .
                                                                       m=1 wt+1|t

                          (m)                       (m)
     • Sample h̃t = ht          with probability ŵt+1|t
                                      
To calculate the expectations Q θ|θ(i) , we repeat this backwards pass a large number of times.
     For the final climb after the EM algorithm, we optimize over all θ using the algorithm from Malik and
Pitt(2011). To implement this particle filter, we resample at every time period and use the resampling
algorithm described in their appendix.




                                                             60
