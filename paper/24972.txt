                                NBER WORKING PAPER SERIES




          ASSET PRICING WITH ENDOGENOUSLY UNINSURABLE TAIL RISK

                                             Hengjie Ai
                                           Anmol Bhandari

                                        Working Paper 24972
                                http://www.nber.org/papers/w24972


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     August 2018




The authors would like to thank V.V. Chari, YiLi Chien, David Evans, Barney Hatman-Glaser, Urban
Jermann, Hanno Lustig, Tom Sargent, Lukas Schmid, Stijn Van Nieuwerburgh, Jessica Wachter, and
seminar participants at the 2016 NBER AP meetings, the Minnesota Macro Workshop, the 2017 Minnesota
Macro Asset Pricing Conference, the 2017 SITE Workshop, Stanford University, the UBC winter
finance conference, Booth Finance Workshop at the University of Chicago, the Money and Banking
Workshop at University of Chicago, the University of North Carolina, the University of Rochester,
the 2017 WFA Annual Meetings, the Wharton International Finance Workshop, and the Utah Winter
Finance Conference for their helpful comments. The authors would also like to thank Jincheng Tong,
Yuki Yao, and Chao Ying for their assistance and comments on the paper. We thank Joan Gieseke
and James Holt for excellent editorial assistance. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2018 by Hengjie Ai and Anmol Bhandari. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Asset Pricing with Endogenously Uninsurable Tail Risk
Hengjie Ai and Anmol Bhandari
NBER Working Paper No. 24972
August 2018, Revised April 2020
JEL No. E24,G12,J3

                                             ABSTRACT

This paper studies asset pricing and labor market dynamics in a setting in which idiosyncratic risk
in human capital is not fully insurable. Firms use long-term contracts to provide insurance to workers,
but neither side can fully commit; furthermore, owing to costly and unobservable retention effort,
worker-firm relationships have endogenous durations. Uninsured tail risk in labor earnings arises as
a part of an optimal risk-sharing scheme. In equilibrium, exposure to the tail risk generates higher
aggregate risk premia and higher return volatility. Consistent with data, firm-level labor share predicts
both future returns and pass-throughs of firm-level shocks to labor compensation.


Hengjie Ai
Department of Finance
Carlson School of Management
University of Minnesota
321-19th Ave South
Minneapolis, MN 55455
hengjie@umn.edu

Anmol Bhandari
Department of Economics
University of Minnesota
1925 Fourth Street South
Minneapolis, MN 55455
and NBER
bhandari@umn.edu
1    Introduction

A key challenge for macro asset pricing theories is to account for the large magnitude
of equity premia and their substantial variations over time and across firms.           In this
paper, we provide an incomplete–markets–based asset pricing model that uses limited
commitment and moral hazard as microfoundations to address these patterns in risk premia.
Uninsured tail or downside risk in labor earnings arises as an outcome of optimal risk-
sharing arrangements. Time variation in that tail risk drives aggregate equity premium
and the volatility of stock market returns. The model is also consistent with firm-level
labor share predicting both future returns and pass-throughs of firm-level shocks to labor
compensation. Overall, the paper provides a unified view of labor market risk and asset
prices within a general equilibrium optimal contracting framework.
    The setup consists of two types of agents: firm owners and workers. Firm owners are
well diversified and use long-term compensation contracts to provide insurance to workers
in order to guard against idiosyncratic shocks to their human capital. Two agency frictions
distinguish our paper from a standard representative agent asset pricing model. First,
neither firm owners nor workers can commit to contracts that yield continuation values
lower than their outside options. Second, owing to costly and unobservable retention effort,
worker-firm relationships have endogenous durations. We embed these contracting frictions
in a general equilibrium setting with aggregate shocks to study their labor market and asset
pricing implications.
    Downside risk in labor earnings, a key feature of the data, is driven by firm-side
limited commitment and further amplified by the presence of moral hazard. Compensation
contracts providing perfect risk sharing would insure workers against idiosyncratic labor
productivity shocks. But when firms cannot commit to negative net present value projects,
large drops in labor productivity are accompanied by reductions in worker earnings. In
addition, because retention effort is not observable, firms have a lower incentive to keep
workers when the firm-worker match is less profitable. Thus, separation risk is elevated
after adverse productivity shocks.
    In the general equilibrium, exposure to downside risk drives several of our asset pricing
results. First, it generates a stochastic discount factor that is more volatile than that in
an otherwise identical economy without agency frictions. A necessary condition is recursive
utility with preference for early resolution of uncertainty and persistent and countercyclical
idiosyncratic risk to human capital. During recessions, the anticipation of lack of risk sharing
in the future raises workers’ current marginal utilities. The optimal risk-sharing scheme
compensates by allocating a higher share of aggregate output from firm owners to workers.


                                               2
Therefore, the labor share moves inversely with aggregate output. The countercyclicality of
labor share translates into a procyclical consumption share of all unconstrained investors,
including firm owners. This amplifies risk prices. In our quantitative analysis, owing to
agency frictions, we find that Sharpe ratios are more than doubled.
   The high volatility of the stochastic discount factor is further amplified by the moral
hazard in firms’ choice of retention effort.       Higher expected returns during recessions
lower valuation and weaken firms’ incentive to retain workers, resulting in countercyclical
separations. This feature of our model supplements a large macro labor literature that
argues that discount rate variations are central in driving unemployment fluctuations. In
our model, higher separations exacerbate tail risk and therefore the need for firm owners to
provide insurance against aggregate shocks. This further raises equilibrium discount rates
and amplifies risk prices.
   Second, without relying on heteroskedastic aggregate shocks, our model produces
substantial predictable variations in the risk premium, especially over long horizons. The
dynamics of the pricing kernel depend on the fraction of firms that are likely to hit their
limited commitment constraint. This introduces persistent variations in the volatility of
the stochastic discount factor and makes returns predictable. In our model, regressions of
returns for a claim to aggregate consumption on price-dividend ratios gives R-squares that
are significant and increasing in horizon. Time variation in discount rates also amplifies the
response of asset prices to aggregate shocks and further elevates the market equity premium.
   Lastly, the above economic mechanism also results in a significant heterogeneity in
the cross section of expected equity returns and pass-through of firm-level shocks to labor
compensation. Under the optimal contract, payments to workers insures them against
aggregate productivity shocks and is countercyclical, making the residual capital income
procyclical and thus more exposed to aggregate shocks. This delivers a form of operating
leverage at the firm level. In particular, firms that have experienced adverse idiosyncratic
shocks have a higher fraction of their value promised to workers and are therefore more
sensitive to aggregate shocks. As a result, they have lower valuation ratios and higher
expected returns. Furthermore, firms with larger obligations to workers are more likely
to hit the firm-side limited commitment constraint and are more likely to lower wage
payments in response to an adverse idiosyncratic shock. We test these implications using
CRSP/Compustat panel data and show that firm-level measures of labor share predict both
future returns and pass-throughs of firm-level shocks to labor compensation.


Related literature      This paper builds on the literature on limited commitment. Kehoe
and Levine (1993) and Alvarez and Jermann (2000) develop a theory of incomplete markets,


                                               3
based on one-sided limited commitment. Alvarez and Jermann (2001) and Chien and Lustig
(2010) study the asset pricing implications of such environments. Most of the above theory
builds on the Kehoe and Levine (1993) framework and implies that agents who experience
large positive income shocks have an incentive to default because they have better outside
options. As a result, positive income shocks cannot be insured, while downside risk in labor
income is perfectly insured. Our paper develops a model of two-sided lack of commitment
as in Thomas and Worrall (1988) and augments it with moral hazard. We add aggregate
shocks and focus on the general equilibrium effects of the firm-side limited commitment and
moral hazard that have not been studied before.1
    Our paper is related to asset pricing models with exogenously incomplete markets.
Krueger and Lustig (2010) provide theoretical conditions under which the presence
of idiosyncratic risk is irrelevant for the market price of aggregate risks.                    Mankiw
(1986) and Constantinides and Duffie (1996) demonstrate how countercyclical volatility
in incomes amplifies aggregate risk premia in the general equilibrium. Schmidt (2015)
and Constantinides and Ghosh (2014) calibrate such incomplete markets models to recent
administrative data on earnings and show that higher moments of labor income shocks
require a significant risk compensation. For tractability, the Constantinides and Duffie
(1996) framework requires an assumption of independently distributed shocks to income
growth, which rules out any trading of financial assets in equilibrium. Heaton and Lucas
(1996) and Storesletten et al. (2007) are among the few papers that depart from the no-
trade equilibria to study risk premia in quantitative incomplete markets models. In contrast
to the above papers, we take an optimal contracting approach to microfound incomplete
markets and use empirical evidence on labor earnings dynamics to restrict the choice of the
parameters governing agency frictions. Our model allows investors access to a rich set of
state-contingent payoffs. We explicitly characterize history dependence in labor earnings
risk and exposure to aggregate shocks.
    Theoretical predictions of our model are also consistent with a recent literature that
emphasizes the importance of labor-share dynamics in understanding the equity market.
Our operating leverage results connect to insights in Danthine and Donaldson (2002) and
Berk and Walden (2013). More recently, Favilukis and Lin (2016b) use models with sticky
wages to demonstrate how countercyclical movements in labor shares help explain equity
and credit risk premia in production economies. Our model’s implication that variations
in labor shares can account for a large fraction of aggregate stock market variations is
    1
      The firm-side limited commitment problem in our model has a similar structure to those studied in
Bolton et al. (2014) and Ai and Li (2015). Recently, several papers such as Tsuyuhara (2016), Abraham
et al. (2017), and Lamadon (2016) study versions of long-term wage contracts with moral hazard. Lamadon
(2016) allows for richer features such as worker and firm complementarities, on-the-job search, and search
frictions. However, none of these papers allow for aggregate risks or study asset pricing.


                                                    4
consistent with the evidence in Greenwald et al. (2014) and Lettau et al. (2014).
    Our computational method builds on Krusell and Smith (1998). Using techniques
contributed by the dynamic contracting literature, such as Atkeson and Lucas (1992), we
represent equilibrium allocations recursively by using a distribution of promised values as a
state variable. However, in contrast to those papers, our environment has aggregate shocks,
and the distribution of promised values responds to such shocks, even in an ergodic steady
state. As in Krusell and Smith (1998), we approximate the forecasting problem facing
agents.
    The paper is organized as follows. In section 2, we describe the physical as well as the
contracting environment, and formalize a recursive competitive equilibrium with long-term
contracts. In section 3, we discuss the optimal contract. In section 4, we derive the asset
pricing implications that arise from agency frictions and general equilibrium considerations.
Finally, in sections 5 and 6, we present quantitative implications after calibrating to several
aggregate and cross-sectional facts. Section 7 concludes.


2     Model

We start with the physical and contracting environment.


2.1   Setup

Demographics       We consider a discrete time economy with t = 0, 1, . . .. There are two
groups of agents: a unit measure of firm owners and a unit measure of workers. Members
of both groups have Epstein-Zin preferences with a common risk aversion γ and a common
intertemporal elasticity of substitution (IES) ψ.
    In each period, workers die with probability 1 − κ, and a similar measure of new workers
are born. This specification guarantees that the total measure of workers equals one at all
times. Upon birth, a worker is endowed with one unit of human capital.


Production and human capital Production is organized within N firms. We assume
that N is large so that firms are perfectly competitive. In any period, a worker is either
unemployed or matched to a firm. A worker produces output only in the firm in which he
is employed. If employed in period t, worker i with human capital hi,t produces output

                                         yi,t = Yt hi,t ,



                                                5
where Yt is the aggregate productivity. We assume Y0 = 1, and for t ≥ 1,

                                       ln Yt+1 = ln Yt + gt ,

where gt is a finite state Markov process with a one-step transition matrix {π (g 0 |g)}g,g0 .
   The evolution of worker human capital in the next period depends on whether the
worker is employed or unemployed. The law of motion for the human capital of worker i
who remains employed with firm j in period t + 1 is

                                    hi,t+1 = hi,t eηj,t+1 +εi,t+1 ,                                   (1)

where conditioning on the aggregate Markov state gt , the firm component ηj,t is i.i.d.
across firms but common to all workers in a firm; the worker-specific shock εi,t is i.i.d.
across workers; and ηj,t and εi,t are mutually independent.                   We use f (η, ε|g) for the
conditional density of (η, ε) and normalize so that        E [eεi,t |gt ]   = 1 and E [eηj,t |gt ] = 1. We
use zi,j,t = (ηj,t , εi,t ) for match-specific shocks for the worker-firm pair (i, j) at time t. The
human capital of a worker not matched with a firm—that is, a worker who becomes (or
remains) unemployed in period t + 1—depreciates deterministically according to

                                          hi,t+1 = λhi,t ,                                            (2)

where the parameter λ < 1 describes human capital obsolescence.                          In each period,
unemployed workers receive unemployment benefit bYt hi,t , where b is a constant.


Matching and separation           A match between a worker and a firm can end in two ways:
stochastically upon the arrival of a separation shock, or voluntarily by the firm or the
worker. Firms can influence the probability of separation by exerting costly effort. We
interpret such effort as a proxy for investments in organization capital that allow firms to
retain workers and help them accumulate human capital on the job. We denote the effort
for keeping a worker at time t by θt and assume that the cost of effort per unit of output is
specified by a function A (θ) with the first three derivatives strictly positive all θ ∈ (0, 1).
It is without loss of generality to denominate effort in probability units because the cost
of effort is captured by the functional form of A (θ). In period t + 1, conditioning on the
survival of the match, both firms and workers can unilaterally initiate a separation. We
denote such a voluntary separation decision by an indicator function δt+1 , with δt+1 = 0 for
separation.
   Upon separation, a worker enters into unemployment. In each period, an unemployed



                                                  6
worker receives an employment opportunity with probability χ ∈ (0, 1). An employment
opportunity enables a worker to access a labor market where firms offer long-term contracts.
In addition to unemployed workers, newborn workers also have an employment opportunity.
A worker with an employment opportunity can choose to establish a match with the firm
that offers the most favorable contract. We assume that there is no cost for posting vacancies
and all firms can compete for new workers.


Contracts       Let τ denote the beginning of an employment relationship between a firm and
a worker. A employment contract offered by a firm to a newly employed worker at time τ
specifies: (i) net transfers or compensation from the firm to the worker {Ct }∞
                                                                              t=τ , (ii) firm’s
effort for keeping the match {θt }∞                                                ∞
                                  t=τ , and (iii) match termination decisions {δt }t=τ for the
duration of the match. Formally, an employment contract offered in period τ by firm j
to worker i with human capital hi,τ specifies {Ct , θt , δt }∞
                                                             t=τ as functions of aggregate and
match-specific histories:

                                 τ →t t                   τ →t t                   τ →t t      ∞
         Ci,j,τ ≡ Ci,j,t hi,τ , zi,j
                                                                                       
                                     , g , θi,j,t hi,τ , zi,j , g , δi,j,t hi,τ , zi,j ,g      t=τ
                                                                                                     .

We use the convention that superscript t denotes the history of shocks up to time t:
g t = {g1 , g2 , · · · , gt }, and superscript τ → t denotes the history of shocks from time τ
       τ →t = {z                                                τ →τ = Ø representing the trivial history.
to t: zi,j       i,j,τ +1 , zi,j,τ +2 , . . . , zi,j,t }, with zi,j

    We have made two simplifying assumptions in the choice of the contract space. First,
we restrict our attention to employment contracts and do not allow payments from firms to
workers who are not matched with the firm. In appendix A, we show that because of two-
sided limited commitment—an agency friction that we introduce below—firms are unable
to insure unemployed workers or workers employed by other firms, even if they are allowed
to offer insurance contracts to these workers.
    Second, we assume that the terms of a new employment contract depend on worker-
specific history only through the human capital at the time of employment. This is true as
long as workers with an employment opportunity have no pre-existing obligations or claims
and can extract full surplus from a new match. In our setup, limited commitment means
that any pre-existing contracts can be costlessly reneged, while perfect competition among
firms implies that the best contract indeed gives workers all the surplus. Therefore, it is
without loss of generality to index new contracts with the human capital of the worker at
the time when the match is formed. To simplify notion and exposition, we impose both of
the above restrictions at the outset.




                                                      7
                   Let Λt g t          denote the stochastic process for state prices; that is, Λt g t is
                                                                                                    
Firm value                         t
the price at history g t of one unit of consumption  goods measured in period-0 consumption
                                       τ →t  t
numeraire. For t ≥ τ , let Vt hi,τ , zi,j , g |Ci,j,τ be the time-t present value of the cash-flow
stream generated by a worker i currently matched
                                                to firm junder the employment contract
Ci,j,τ . Dropping the explicit dependence on hi,τ , zi,j
                                                     τ →t , g t , the value of the employment

contract Ci,j,τ to a firm in period t ≥ τ can be recursively constructed using
                                                                                                         
                                                                       Λt+1
            Vt (Ci,j,τ ) = yi,t [1 − A (θi,j,t )] − Ci,j,t + κEt            θi,j,t δi,j,t+1 Vt+1 (Ci,j,τ ) .
                                                                        Λt

In the above equation, the flow profit for the firm equals the output of the worker net of
compensation and retention cost. In the next period, the match continues with probability
κθi,j,t , and δi,j,t+1 is the indicator function for the decision to voluntarily terminate. The
future cash flows are discounted using state prices {Λt }.


                        Let U ∗ h, g t be the highest utility a worker with human capital h can
                                      
Worker utility
achieve after receiving an opportunity to match with a firm at aggregate history g t . The
utility for an unemployed worker i with human capital hi,t at time t, denoted by U hi,t , g t ,
                                                                                             

is recursively constructed using

                                  h                1− 1               1− 1 i 1−1 1
                     U hi,t , g t = (1 − β) (byi,t ) ψ + βM hi,t , g t     ψ      ψ ,                          (3)

where byi,t is the flow consumption from unemployment benefits provided by the
government.2 The term M hi,t , g t is the certainty equivalent of the next-period utility:
                                  

with probability 1 − χ, unemployed workers stay unemployed with continuation utility
U hi,t+1 , g t+1 , and with probability χ, they are matched with a new firm and receive
                

utility U ∗ hi,t+1 , g t+1 . Combining both of these possibilities,
                          

                                                                                         1
                          h                        1−γ                       1−γ i 1−γ
          M hi,t , g t = κEt (1 − χ)U hi,t+1 , g t+1      + χU ∗ hi,t+1 , g t+1             .

                                                    
                                  τ →t , g t |C
       For t ≥ τ , let Ut hi,τ , zi,j                  be the utility of a matched worker i at time t
                                               i,j,τ
under the employment contract Ci,j,τ . It satisfies the recursion

                                                                             i 11
                                                      1− 1              1− 1
                                    h
                      Ut (Ci,j,τ ) = (1 − β) (Ci,j,t ) ψ + βMt (Ci,j,τ ) ψ 1− ψ ,                              (4)
   2
    See appendix A for a discussion of why an unemployed worker cannot obtain any insurance, from either
the previous employer or any other firm and, as a result, consumes only the value of unemployment benefits.




                                                        8
where
                 h                                                                                     1
                                                                                               1−γ i 1−γ
Mt (Ci,j,τ ) = κEt θi,j,t δi,j,t+1 Ut+1 (Ci,j,τ )1−γ + (1 − θi,j,t δi,j,t+1 ) U hi,t+1 , g t+1             .

The computation of the certainty equivalent Mt (Ci,j,τ ) accounts for the fact that the match
between work i and firm j can be terminated exogenously with probability 1 − θi,j,t or
endogenously by setting δi,j,t+1 = 0.


Agency frictions           We impose two types of agency frictions. First, neither firms nor
workers can commit. At the beginning of each period t, before production takes place,
firms and workers have an opportunity to terminate their match by setting δi,j,t = 0. Once
a match is dissolved, the worker is unemployed, and the firm has the option of keeping open
the vacancy or hiring a new worker. Second, firms’ choices of effort θi,j,t , which determine
the probability that the match will continue to the next period, are observable neither to
workers nor to any other firms. We show later that our specification of the moral hazard
problem provides a tractable way to generate equilibrium separations and non-trivial labor
market dynamics.3
      The presence of agency frictions imposes incentive compatibility constraints on the
feasibility of a contract Ci,j,τ . Perfect competition on the labor market and no cost for
keeping or posting vacancies imply that the value of a firm’s option of terminating a match
is zero. Thus, incentive compatibility with respect to the firm-side limited commitment
requires that the present value of any employment contract must be non-negative      at all
                                                                        τ →t t
times. That is, for all match specific histories, either Vt hi,τ , zi,j , g |Ci,j,τ ≥ 0, or
                              
            τ →t , g t |C
Vt hi,τ , zi,j                   < 0 and the firm voluntarily terminates the match by setting
                         i,j,τ
                                                      
               τ →t , g t = 0. Thus, for all z τ →t , g t ,
δi,j,t hi,τ , zi,j                             i,j


                                            δi,j,t Vt (Ci,j,τ ) ≥ 0.                                     (5)

Similarly, a worker always has the option of terminating a match and becoming unemployed
to obtain utility U t hi,t , g t . Therefore, the worker-side limited commitment implies that
                                
                               τ →t , either the worker continues the employment relationship
at any match-specific history zi,j
and obtains a utility that is higher
                                     than
                                          his outside option, or he unilaterally terminates
                                 τ →t  t
the match. Therefore, for all zi,j , g ,

                                   δi,j,t Ut (Ci,j,τ ) − U hi,t , g t ≥ 0.
                                                                    
                                                                                                         (6)
  3
      For a similar specification of the moral hazard problem between firms and workers, see Lamadon (2016).




                                                       9
Finally, the fact that retention effort is not observable implies that the choice of θ must be
incentive compatible
                    from the firm’s perspective. This requires that for any match-specific
            τ →t t
history zi,j , g ,
                                                                                      
                                  h      i                   Λt+1
               Vt (Ci,j,τ ) ≥ yi,t 1 − A θ̃ − Ci,j,t + κθ̃Et        δt+1 Vt+1 (Ci,j,τ )             (7)
                                                                Λt

for all θ̃.4


Feasibility and efficiency      We now define feasible and privately efficient contracts. These
definitions take as given a stochastic process for state prices Λt g t t and values of newly
                                                                      

employed workers U ∗ ·, g t t .
                            

Definition 1. A contract Ci,j,τ offered by a firm to a newly employed worker with
human capital hi,τ in period τ is feasible given Λt g t , U ∗ ·, g t t , if it satisfies limited
                                                                  

commitment constraints (5) and (6) and incentive compatibility constraints (7).

Definition 2. A contract Ci,j,τ offered by a firm to a newly employed worker with human
capital hi,τ in period τ is privately efficient given Λt g t , U ∗ ·, g t t , if it is feasible,
                                                                       
                                                                                           
and there does not exist an alternative feasible contract Cˆ such that Vτ h, O,    / g τ |Cˆ >
                                       
                               / g τ |Cˆ ≥ Uτ h, O,
       / g τ |Ci,j,τ and Uτ h, O,                 / g τ |Ci,j,τ .
                                                              
Vτ h, O,

   A competitive equilibrium with long-term contracts needs to specify values of newly
employed workers U ∗ ·, g t t , and equilibrium state prices Λt g t t . The value of a
                                                                

newly matched worker U ∗ ·, g t is determined by workers’ optimal choice of contract on
                               

the competitive labor market. Given the process Λt g t t , at any aggregate history g τ ,
                                                      

the function U ∗ (·, g τ ) solves

  U ∗ (h, g τ ) = max Uτ h, O,
                            / g τ |C : C is privately efficient given Λt g t , U ∗ ·, g t
                                                                                      
                                                                                                t
                                                                                                    .
                  C
                                                                                                    (8)
Because firms can always choose to keep open a vacancy, any contract offered must satisfy
the condition Vτ (Ci,j,τ ) ≥ 0. Among all firms that offer employment contracts, a worker
chooses to match with the firm that offers the most favorable terms. An implication of
equation (8) is that at the beginning of each match, competitive labor markets drive firm
value to zero.
   Finally, firm owners’ optimal consumption and investment decisions impose a restriction
on the a relationship between state prices Λt g t t and firm owners’ equilibrium
                                                     

   4
   We rely on the standard result in dynamic mechanism design: there is no profitable deviation in the
dynamic environment if and only if one-step deviations are not profitable.


                                                  10
consumption. Because the firm owners hold the equity of all firms, they are well diversified
and their consumption and investment choices depend only on aggregate quantities. Given
a stochastic process for firm-owner consumption Xt g t t , the utility of firm owners is
                                                     

given recursively by
                                  n              1− 1            1− 1 o 1−1 1
                      Wt g t = max (1 − β) X g t       + βNt g t
                            
                                                     ψ                ψ      ψ ,




where the certainty equivalent
                                                                  1
                                                        1−γ  1−γ
                                   Nt g t = Et Wt+1 g t+1            .

As is standard in asset pricing models with recursive utility, the optimality condition for
firm owner’s consumption and investment choice implies that the stochastic discount factor
must satisfy
                                        "              #− ψ1 "              # 1 −γ
                       Λt+1 g t+1         Xt+1 g t+1            Wt+1 g t+1 ψ
                                   
                                     =β                                              .    (9)
                         Λt (g t )          Xt (g t )             Nt (g t )

      It is important to note that our formulation does not assume any form of exogenously
incomplete market. From equation (9), firm owners have access to complete markets, and
their intertemporal rate of substitution is a valid stochastic discount factor. Because long-
term contracts can replicate aggregate and idiosyncratic state-contingent payoffs between
firm owners and workers, the same condition holds true for workers unless an incentive
compatibility constraint is binding.5 In the absence of those agency frictions, all workers in
our setup have access to a complete set of state-contingent payoffs via insurance contracts,
and our setup becomes isomorphic to a standard representative agent complete markets
model.
      Equilibrium state prices, workers’ outside valuations, and optimal contracts for each
worker-firm pair depend on past histories of aggregate as well as firm- and worker-level
idiosyncratic shocks. In general, this means that one needs to keep track of the distribution
of worker characteristics such as human capital and terms of contracts within firms and
across firms in the economy. This can quickly become unmanageable. However, thanks to
the functional form choices on preferences and technology, we can define a competitive
equilibrium with long-term contracts that is recursive in an appropriately constructed
parsimonious set of state variables.
  5
      This is formally shown later in proposition 2.




                                                       11
2.2       Recursive Competitive Equilibrium

To define a recursive competitive equilibrium, we follow the dynamic contracting literature
(for instance, Thomas and Worrall 1988 or Atkeson and Lucas 1992) and express the
contracting problem using promised utility as a state variable. We show that in our model,
the homotheticity properties of preferences and technology and the random walk assumption
of exogenous shocks imply that an individual worker’s history can be summarized by a one-
dimensional state variable u, which equals the current-period continuation utility divided by
the current-period worker output. The aggregate history can be summarized by a vector of
aggregate state variable S ≡ (g, φ, B). Here, g is the growth rate of aggregate productivity,
φ is a one-dimensional measure that summarizes agent types, and B is the fraction of
total output consumed by unemployed workers. That we ultimately need to keep track of
only a one-dimensional distribution as a state variable is a key computational step for our
quantitative analysis.


Normalized variables             Before stating the normalized version of the optimal contracting
problem,
            we define
                      firms’ value function V (y, U, S) to be the maximum value of
Vt hi,τ , zi,j , g |C that can be achieved by any contract C such that it is feasible and
           τ →t   t
                                                                              
                                                                  τ →t , g t |C ≥ U . Homogeneity
provides the worker a utility of at least U ; that is, Ut hi,τ , zi,j
of preferences and technology implies that the value function V (y, U, S) satisfies
                                                                  
                                                               U
                                         V (y, U, S) = v         ,S y                            (10)
                                                               y

for some normalized value function v. This motivates the concept of normalized promised
                 U
utility u ≡       y . In addition, the highest utility      a worker can achieve from a new match
U ∗ (h, g τ )   = u∗ (S) y and the worker’s utility in       unemployment U (h, g t ) = u (S) y, where
u∗ (S) and u (S) are functions of aggregate states. It is possible to prove that the value
function v (u, S) must be strictly decreasing in u.6 Therefore, equation (8) implies that
u∗ (S) has to satisfy
                                     u∗ (S) = max {u : v(u, S) ≥ 0} .                            (11)

In addition, (3) requires the following relationship between u (S) and u∗ (S):

                                                                i 11
                                               1− 1        1− 1
                                     h
                              u (S) = (1 − β) b ψ + βλm (S) ψ 1− ψ ,                             (12)

             P             h       0
                                      n                                 oi 1
with m (S) ≡ κ g0 π (g 0 |g) e(1−γ)g (1 − χ)u (S 0 )1−γ + χu∗ (S 0 )1−γ
                                                                           1−γ
                                                                               .
   6
       See appendix B.1 for details on existence and monotonicity of the function v.


                                                      12
Recursive optimal contracting Let Γφ (g 0 , S) and ΓB (g 0 , S) be the laws of motion for
the endogenous aggregate states φ and B so that S 0 ≡ (g 0 , φ0 , B 0 ) = (g 0 , Γφ (g 0 , S), ΓB (g 0 , S)).
Let {Λ (S 0 , S)}g0 be the set of one-period-ahead Arrow security prices, and let ζ 0 = (g 0 , η 0 , ε0 )
be the vector of next period aggregate and match-specific shocks. The Markov transition
matrix {π (g 0 |g)}g,g0 together with the conditional density f (η, ε|g) define a probability
distribution for ζ 0 conditional on g, which we denote as Ω(dζ 0 |g).
    The normalized firm value v (u, S) satisfies the following Bellman equation:

                                                                               1 − c − A (θ) +
     v (u, S) =             max                                           0  0  0                                              (13)
                  c,θ,{u0 (ζ 0 ),δ 0 (ζ 0 )}   ζ0   κθ       Λ (S 0 , S) eg +η +ε δ 0 (ζ 0 ) v (u0 (ζ 0 ) , S 0 ) Ω(dζ 0 |g),

subject to
                                                                  i 11
                                                  1− 1       1− 1
                                        h
                                   u = (1 − β) c ψ + βm ψ 1− ψ ,                                                                (14)

                                δ 0 ζ 0 v u0 ζ 0 , S 0 ≥ 0, f or all ζ 0 ,
                                                    
                                                                                                                                (15)
                            δ 0 ζ 0 u0 (ζ 0 ) − λu S 0 ≥ 0, f or all ζ 0 ,
                                                      
                                                                                                                                (16)
                               
                                            0 0 0
                   A0 (θ) = κ Λ S 0 , S eg +η +ε δ 0 ζ 0 v u0 ζ 0 , S 0 Ω(dζ 0 |g),
                                                                         
                                                                                                                                (17)

where
                                                                             1
                             h                                    i           1−γ
        (1−γ)(g 0 +η 0 +ε0 )     0 0
                                      0 0 1−γ         0 0
                                                              0 1−γ     0
  m= κ e                       θδ ζ u ζ         + 1 − θδ ζ λu S       Ω(dζ |g)     .


    Equation (14) is the promise-keeping constraint ensuring that the current compensation
and effort choices, together with the choices for future continuation values, deliver the utility
u that is promised to the worker. Inequalities (15) and (16) are the recursive counterparts of
the limited commitment constraints (5) and (6). Equation (17) is the first-order necessary
condition for firms’ choice of retention effort. Because the cost function A (θ) is strictly
convex in θ, first-order conditions (17) are equivalent to (7) and therefore, as we prove
in appendix B, necessary and sufficient for incentive compatibility. We label the above
maximization problem as P1.

                                                    Xt (g t )
                    Let xt g t =
                              
Aggregation                                         Yt (g t )   be the normalized consumption of the firm owners.
Given a consumption function x (S), firm owners’ normalized utility, which we denote as
w (S), can be constructed from

                                                                     i 11
                                                     1− 1       1− 1
                                       h
                                w (S) = (1 − β) x (S) ψ + βn (S) ψ 1− ψ ,                                                       (18)


                                                                        13
                                                     nP                                                   o     1
                                                                                            0
                                                                    π (g 0 |g) e(1−γ)g w (S 0 )1−γ
                                                                                                               1−γ
with the certainty equivalent n (S) =                          g0                                                    .   Using the
normalized notation, the stochastic discount factor (SDF)                         Λ (S 0 , S)         is given by
                                              "            0
                                                               #− 1 "                   0
                                                                                            # 1 −γ
                                           x (S 0 ) eg               ψ
                                                                          w (S 0 ) eg           ψ

                               Λ S0, S = β
                                        
                                                                                                     .                         (19)
                                             x (S)                          n (S)


        Finally, we describe the construction of the aggregate state variable φ, which we will
refer to as the “summary measure.” Let Φj (du, dh) denote the joint distribution of (u, h)
for workers in firm j and Φ0 (dh) the distribution of human capital of unemployed workers.
In general, {Φj }N
                 j=0 is a state variable in the construction of a recursive equilibrium because
the resource constraint,
                        N  
                         X                                                                                N  
                                                                                                          X
Y        bhΦ0 (dh)+Y                 [c (u, S) + A(θ, S)] hΦj (du, dh)+Y x(S) = Y                                        hΦj (du, dh) ,
                         j=1                                                                              j=1
                                                                                                                               (20)
depends on        {Φj }N
                       j=0 .

        Let c (u, S) be the policy function for worker compensation in the problem P1. The
total compensation to all workers

                N  
                X                                                         N 
                                                                           X                               
            Y             c (u, S) hΦj (du, dh) = Y             c (u, S)                    hΦj ( dh| u) Φj (du) ,
                 j=1                                                        j=1


where we decompose the joint distributions into a marginal distribution and a conditional
distribution: Φj (du, dh) = Φj ( dh| u) Φj (du). We define the summary measure by
           PN                                                   PN
φ (du) ≡     j=1 hΦj ( dh| u) for all u. For a given h, the term  j=1 Φj (du, dh) is the
joint distribution of (u, h) across all firms, and thus φ(du) is the average human capital of
employed workers of type u. We define the total compensation to all unemployed workers
                                                           
normalized by aggregate productivity as B =                         bhΦ0 (dh). Using the fact that total output
             
equals Y         φ (du), the resource constraint can be written as
                                                                                               
                        B+         [c (u, S) + A(θ(u, S))] φ (du) + x (S) =                         φ (du) .                   (21)


The above procedure reduces the N + 1 two-dimensional distributions {Φj }N
                                                                         j=0 into a one-
dimensional measure φ and a scalar B. This greatly simplifies our analysis.


Recursive competitive equilibrium                    Equilibrium can be constructed in two steps. In
the first, we obtain policy functions c (u, S), θ (u, S), {u0 (u, S, ζ 0 ) , δ 0 (u, S, ζ 0 )}ζ 0 by solving


                                                       14
problem P1. In the second, we use the policy functions to construct the laws of motion for
the endogenous state variables Γφ and ΓB .
    The summary measure φ has a continuous density on [λu (S) , u∗ (S)] which describes
the human capital of all currently employed workers and a mass point on u∗ (S) for newly
employed workers. The law of motion φ0 = Γφ (g 0 , S) specifies the summary measure in the
next period for each possible realization of g 0 as a function of current state S. The density
of the continuous part of φ0 is
                                                                                                                
            0                               η 0 +ε0         0    0   0       0                             0   0
                                                                                
          φ (de
              u) = κ       θ (u, S)        e          f η , ε |g δ ζ I{u0 (u,S,ζ 0 )∈dũ} dη dε φ (du)                             (22)


∀ũ ∈ [λu (S 0 ) , u∗ (S 0 )], where I is the indicator function. The mass point of φ0 at u∗ (S 0 ) is
given by
                                                                                         B
                                  φ0       u∗ S 0
                                                      
                                                            = (1 − κ) + κχλ                .                                       (23)
                                                                                         b
In the above expression, 1 − κ is the total amount of human capital of newborn workers, a
measure 1 − κ of whom arrive in each period with one unit of human capital. The second
term is the amount of human capital of workers who will move to employment from the
current unemployed pool. The term B is total unemployment benefit in the current period
      B
and   b   is the total human capital of all unemployed workers. A fraction κ of them survive
to the next period, their human capital decpreciates at rate 1 − λ, and a fraction χ exit the
unemployment pool.
    The law of motion ΓB (g 0 , S) maps (g 0 , S) to B 0 , which is the total unemployment benefit
in the next period in state g 0 and is given by
                                                                                                                            
                0                                                            0           0     0   0                   0   0
                                                                                                     
           B = κλ B(1 − χ) + b                    1 − θ (u, S) δ ζ                    f η , ε |g φ (du) dη dε ,                    (24)


where the first term B(1 − χ) accounts for all unemployed workers in the current period
who will stay unemployed in the next period, and the second term accounts for workers
who transit from the currently employed pool to unemployment in the next period.

Definition 3. A recursive competitive equilibrium consists of stochastic discount factor
{Λ (S 0 , S)}, workers’ value from unemployment
                                             u(S), the value from a new match u (S),
                                                                                                  ∗
                                                                                                       
firm values v (u, S) and policy functions c (u, S) , θ (u, S) , {u0 (u, S, ζ 0 ) , δ 0 (u, S, ζ 0 )}ζ 0 ,
consumption share of firm owners x (S), and laws of motion Γφ and ΓB such that (i) the
stochastic discount factor satisfies (19); (ii) the firm value function and the policy functions
solve problem P1; (iii) the laws of motion for aggregate states φ and B satisfy (22), (23),
and (24); (iv) values for new and unemployed workers satisfy (11) and (12); and (v) the
resource constraint (21) holds.

                                                                15
3        The Optimal Contract

In this section, we provide a characterization of the optimal contract by discussing the
properties of policy functions to problem P1. The policy functions of firm retention effort
θ(u, S) and the termination decision δ 0 (u, S, ζ 0 ) determine the labor market dynamics in our
model, while the choices of consumption c(u, S) and the next-period continuation utility
u0 (u, S, ζ 0 ) are responsible for the model’s implications on risk sharing. We start with the
labor–market related policy functions.
        First, there are no voluntary terminations under the optimal contract. In the absence
of complementarity between firm and worker productivities, an adverse shock to human
capital makes the worker equally unproductive in all firms and proportionally lowers his
eligible unemployment benefit. Separations, which lead to human capital losses, therefore
lower worker utility without benefiting firms. The optimal contract avoids such inefficient
separations by setting δ (u, S, ζ 0 ) = 1 for all ζ 0 . In our setup, although the possibility of
separation serves as a punishment device and sustains some risk sharing between firms and
their employees, it is never specified as an equilibrium outcome under the optimal contract.
        Next, firms’ retention policy function θ (u, S) is decreasing in u. Incentive compatibility
constraint (17) requires that the marginal cost A0 (θ) of retaining the worker equal its
marginal benefit, the present value of the cash flow that the worker brings to the firm,
                  0   0   0
κ Λ (S 0 , S) eg +η +ε v (u0 (u, S, ζ 0 ) , S 0 ) Ω(dζ 0 |g). Because firm value is a decreasing function
of the utility promised to workers, these marginal benefits are also decreasing in u. Thus,
it is harder to induce a higher retention effort when the promised utility to worker is high.
The following lemma summarizes the above discussion of δ (u, S, ζ 0 ) and θ (u, S).

Proposition 1. In any equilibrium in which the stochastic discount factor and the law of
motion for aggregate state variables satisfy condition (6) in appendix B, for all (u, S, ζ 0 ),
δ 0 (u, S, ζ 0 ) = 1, and the policy function for retention effort, θ(u, S) is decreasing in u for
all S.

Proof. See appendix B.

        More generally, the above proposition implies that separation rates are higher when the
value of a worker to the firm is low. This may be due to either a lower future surplus from
the worker (that is, lower levels of v (u0 (u, S, ζ 0 ) , S 0 )) or a higher discount rate (that is,
lower values of Λ). Therefore, the specification of the moral hazard problem—in particular,
the incentive compatibility constraint (17)—generates countercyclical unemployment. Also,
the implication that δ 0 (u, S, ζ 0 ) = 1 is useful for the tractability of the model. It allows us


                                                   16
to replace the firm- and work-side limited commitment constraints in equations (15) and
(16) by
                                           v u0 ζ 0 , S 0 ≥ 0,
                                                         
                                                                                                  (25)

                                            u0 (ζ 0 ) ≥ λu S 0 .
                                                              
                                                                                                  (26)

    We now turn to the implications of the optimal contract for risk sharing. With full
commitment, firms can perfectly insure workers against idiosyncratic shocks. Therefore,
                                       0    0
workers’ continuation utilities yeε +η u0 (u, S, ζ 0 ) do not respond to these shocks and are
equalized across all possible realizations of (η 0 , ε0 ). When 0 is a possible realization of η 0
and ε0 , this optimal risk-sharing condition can be written as

                                              0  0
                           u0 u, S, ζ 0 = e−(ε +η ) u0 u, S, g 0 , 0, 0 , ∀ζ 0 .
                                                                      
                                                                                                  (27)

Thus, under perfect risk sharing, the elasticity of normalized utility with respect to
idiosyncratic shocks is −1.
    Under limited commitment, equation (27) cannot hold for all values of (η 0 , ε0 ). Because
a worker can always separate voluntarily, the promised utility under the optimal contract
cannot be lower than what he receives upon a voluntary termination, λu (S 0 ). Clearly, for
large and positive realizations of ε0 + η 0 , the full risk sharing policy in (27) would imply that
    0   0
e−(ε +η ) u0 (u, S, g 0 , 0, 0) < λu (S 0 ) and violate the worker-side limited commitment (26). As
a result, given the current state (u, S), there is a threshold level ε(u, S, g 0 ) for every g 0 , such
that for all ε0 + η 0 ≥ ε(u, S, g 0 ), the worker-side limited commitment constraint binds and

                                       u0 u, S, ζ 0 = λu S 0 .
                                                           
                                                                                                  (28)


    Conversely, the firm-side limited commitment imposes an upper bound on u0 (u, S, ζ 0 ).
Because u∗ (S 0 ) is the highest utility a worker can achieve and v (u∗ (S 0 ) , S 0 ) = 0, any
promised utility higher than u∗ (S 0 ) results in a negative firm value. Large and negative
realizations of ε0 + η 0 therefore imply that the full risk sharing policy (27) would lead
        0   0
to e−(ε +η ) u0 (u, S, g 0 , 0, 0) > u∗ (S 0 ) and thus violate the firm-side limited commitment
(25). Under the optimal contract, there is a threshold function ε(u, S, g 0 ), such that for all
ε0 + η 0 < ε(u, S, g 0 ), the firm-side limited commitment constraint has to bind, and

                                       u0 u, S, ζ 0 = u∗ S 0 .
                                                           
                                                                                                  (29)


    In the interior, ε(u, S, g 0 ) < ε0 + η 0 < ε(u, S, g 0 ), none of the above constraints bind,
and the intertemporal marginal rate of substitution of all agents has to equalize. In the


                                                    17
following proposition, we summarize the properties of consumption and continuation utility
policies.

Proposition 2. In any equilibrium in which the stochastic discount factor and the law
of motion for aggregate state variables satisfy condition (6) in appendix B, there exist
threshold levels ε(u, S, g 0 ) and ε(u, S, g 0 ) with ε(u, S, g 0 ) < ε(u, S, g 0 ), such that for all
ε0 + η 0 > ε(u, S, g 0 ), u0 (u, S, ζ 0 ) is given by (28), and for all ε0 + η 0 < ε(u, S, g 0 ), u0 (u, S, ζ 0 )
satisfies (29). For all ε0 + η 0 ∈ [ε(u, S, g 0 ), ε(u, S, g 0 )], u0 (u, S, ζ 0 ) is strictly decreasing in
ε0 + η 0 and satisfies
                                     − 1     1 
                          x (S 0 )     w (S 0 ) ψ −γ
                                                                     
                                       ψ                     ι (u, S)
                                                       1+
                          x (S)         n (S)                θ (u, S)
                                                             − 1  0             1
                                            0        0    0         u (u, S, ζ 0 ) ψ −γ
                                      
                          −γ(η 0 +ε0 ) c (u (u, S, ζ ) , S )
                                                                ψ
                       =e                                                               ,                  (30)
                                              c (u, S)                m (u, S)

where ι (u, S) > 0 is given in Appendix B.

Proof. See appendix B.

      The above proposition has several implications. First, large and positive realizations of
ε0   and η 0 imply that u0 (u, S, ζ 0 ) must be set to a constant and cannot respond to further
                                                                                       0    0
increases in η 0 + ε0 . As a result, the level of continuation utility, yeε +η u0 (u, S, ζ 0 ), must
increase with positive productivity shocks. High promised values are met with higher future
compensation. This feature of our setting is similar to that in Harris and Holmstrom (1982),
Kehoe and Levine (1993), and Alvarez and Jermann (2000).
      Second, in contrast to these papers in which workers are perfectly insured against
downside risk, the limited commitment constraint on the firm side implies that sufficiently
negative realizations of η 0 + ε0 also cannot be hedged. A sequence of negative worker- or
firm-specific productivity shocks lowers worker output. Keeping an extremely unproductive
worker is a negative net present value undertaking for the firm, since the cash flow produced
by the worker is not enough to pay for his promised compensation. In addition to lower
retention effort as mentioned above, lack of commitment from the firm side requires
reductions in future worker compensation in order to provide incentives for the firm to
continue the match. As we will demonstrate in subsequent sections, this feature is key for
our model to generate volatile asset prices along with tail risk in labor earnings.
      Third, equation (30) in proposition 2 implies that the intertemporal marginal rate of
substitution has to be equal for all agents in the economy unless the limited commitment
constraints are binding. This includes firm owners as well as a subset of workers. Equation


                                                       18
(30) also highlights the difficulty in generating a high volatility of stochastic discount factor
without directly assuming exogenous market segmentation. Given preference parameters,
the volatility of the SDF is determined entirely by the risk exposure of the consumption
of marginal investors. If a heterogeneous agent-based model such as ours generates a
stochastic discount factor that is more volatile than a representative agent model, then it
must also provide an explanation for why the additional risk exposure in marginal investors’
consumption is not insured away through conditions like equation (30). In the next section,
we demonstrate conditions under which agency frictions generates downside risk in labor
earnings and amplify the volatility of the stochastic discount factor in equilibrium.


4     Agency Frictions and Asset Pricing

In this section, we highlight how agency frictions affect aggregate and cross-sectional asset
returns. General equilibrium linkages between tail risk in labor earnings and the pricing
kernel are key for agency frictions to amplify risk premia. We start with an “irrelevance”
result in the spirit of Krueger and Lustig (2010) that provides conditions under which agency
frictions are irrelevant for both the price of aggregate risk and aggregate labor market
dynamics. We then analyze a special case of our model to isolate the mechanism that
amplifies the volatility of the stochastic discount factor and distinguish it from alternatives
in the literature. We also derive a set of testable predictions of our model mechanism, which
are later confronted with the data.


4.1   An Irrelevance Result

Krueger and Lustig (2010) show that if the aggregate endowment growth is i.i.d. and the
distribution of idiosyncratic shocks f ( η, ε| g) is independent of the aggregate states, then
uninsurable idiosyncratic risk does not affect the price of aggregate shocks in a wide set
of incomplete markets models. To formalize a version of their result in our setting with
contracting frictions, we start with the following definition.

Definition 4. Given the economy described in section 2.2, an equivalent deterministic
economy with a modified discount rate is an otherwise identical economy except that
the aggregate growth rate is set to zero and the time discount factor β is modified to
                      1
   h         0
                i 1− ψ
       (1−γ)g      1−γ
β E e                   .
    In the following proposition, we provide conditions under which a recursive competitive
equilibrium in the stochastic economy can be constructed from the equilibrium of an


                                               19
equivalent deterministic economy with a modified discount rate.

Proposition 3. (Krueger and Lustig) Suppose that gt is i.i.d. over time and f ( η, ε| g)
does not depend on g. If there exists an equilibrium in the equivalent deterministic economy
with a modified discount rate, then there exists an equilibrium of the stochastic economy
described in section 2.2 with the stochastic discount factor
                                                                  0
                                      0
                                                  1   e−γg
                                 Λ S ,S =                    0 ,
                                                                                                   (31)
                                          R̂ (φ, B) E e(1−γ)g

where R̂ (φ, B) is the risk-free interest rate in the equivalent deterministic economy with a
modified discount rate.

Proof. See appendix B.

       With i.i.d aggregate growth rates, the stochastic discount factor in the section 2.2
                                                                                0
economy with full commitment and no moral hazard equals βe−γg .7 This is also the
stochastic discount factor for a representative agent economy in which the growth rate
of aggregate consumption is gt . Equation (31) states that the stochastic discount factor
in the economy with agency frictions differs only by a multiplicative constant. Therefore,
agency frictions affect the risk-free interest rate but are irrelevant for the pricing aggregate
risks. Proposition 3 imposes no other restriction on the distribution of idiosyncratic risk
and, in particular, allows f ( η, ε| g) to contain a fat tail as long as it is the same across
all realizations of g. We show in appendix B that the optimal contract in the equivalent
deterministic economy with a modified discount rate can be used to construct the optimal
contract in the stochastic economy by simply adjusting for aggregate growth and that the
consumption share of firm owners in the stochastic economy equals that in the equivalent
deterministic economy.


4.2      Aggregate Implications

Proposition 3 tells us that for agency frictions to have an impact on aggregate risk premia,
we must deviate from its assumptions of i.i.d. growth and a time-invariant distribution of
idiosyncratic shocks. In the rest of this section, we use a special case of our model to analyze
such a departure. The special case highlights the interaction between agency frictions, risk
in labor earnings, and the market price of aggregate risk.
   7
    In absence of agency frictions, the consumption share of firm owners x (S) is constant, and equations
                                             0
(18) and (19) simplify to Λ (S 0 , S) = βe−γg .




                                                   20
      We proceed by making several simplifying assumptions. Many of these assumptions
are designed to isolate features and implications that are novel to our setting and to help
us obtain closed-form solutions for equilibrium returns. We relax these assumptions later
in the quantitative section, where we use numerical methods to solve the general model
described in section 2.2.

Assumption 1. Aggregate shocks gt ∈ {gL , gH } with gL < gH . From period one on, the
transition probability from state g to state g 0 satisfies π ( g 0 | g) = 1 if g 0 = g. Each firm
has a single worker and η = 0. Let the distribution f (ε|g = gH ) be degenerate, and the
distribution f (ε|g = gL ) be a negative exponential with parameter ξ.8

      This assumption includes the main departures from proposition 3. To capture the
persistence of aggregate shocks, we assume that booms (gt = gH ) and recessions (gt = gL )
are permanent. To parsimoniously model countercyclical idiosyncratic shocks, we impose no
idiosyncratic shocks in booms and negatively exponentially distributed shocks in recessions.
The assumption that firm-level shocks η = 0 is without loss of generality, since proposition
2 shows that the optimal contract depends only on ε + η. In what follows, we interpret ε
as both a firm- and a worker-level shock.

Assumption 2. Preferences satisfy γ ≥ ψ = 1.

      The crucial part here is that γ ≥ ψ. The assumption of unit elasticity of intertemporal
substitution is merely for tractability.

Assumption 3. Workers can fully commit.

      As shown in proposition 2, uninsurable risk in the left tail of labor earnings comes from
the firm-side limited commitment and separations. In section 6.1, we show the that worker-
side limited commitment has little quantitative impact on the equity premium but matters
for accounting for patterns in earning dynamics. Hence, here we abstract from the lack of
commitment on the worker side.
                                                                          h          i
                                                                               1
Assumption 4. Effort is costly only in period one, in which case A (θ) = a ln 1−θ   −θ
for some a > 0.

      The parameter a in function A(θ) measures the severity of the moral hazard problem,
with a = 0 corresponding to the case in which effort is costless and moral hazard is irrelevant.

Assumption 5. For t = 2, 3, . . ., both employed and unemployed workers produce output
and consume α fraction of their output: Ct = αyt .
  8
      The form of the negative exponential distribution is described in equation (77) in appendix C.


                                                     21
    From period 2 on, workers consume a fixed fraction of their output. This assumption
captures that because of lack of full risk sharing, workers’ consumption exposed to
idiosyncratic shocks in future recessions. We assume that unemployed workers lose 1 − λ
fraction of their human capital but keep producing output. They are otherwise subject to
the same law of motion of human capital as employed workers.
    In figure 1, we plot an event tree for the simple economy.                    Let the firm owners’
consumption share in period 0 be x0 , and let workers’ initial promised utility be u0 . We
assume all workers have the same promised utility u0 ; therefore, there is a unique u∗0 that
is consistent with the aggregate resource constraint. In comparative static exercises, we
study optimal contracting with an arbitrary u0 , even though in equilibrium the measure of
agents at u0 might be zero unless u0 = u∗0 . We let xH ≡ x (gH ) and xL ≡ x (gL ) denote the
firm owners’ consumption share at nodes H and L, respectively. For an arbitrary initial
promised utility u0 , we use θH (u0 ) ≡ θ (u0 (u0 , gH ) , gH ) and θL (u0 , ε) ≡ θ (u0 (u0 , gL , ε) , gL )
to denote the effort choice; cH (u0 ) ≡ c (u0 (u0 , gH ) , gH ) and cL (u0 , ε) ≡ c (u0 (u0 , gL , ε) , gL )
to denote the compensation policy; and vH (u0 ) ≡ v (u0 (u0 , gH ) , gH ) and vL (u0 , ε) ≡
v (u0 (u0 , gL , ε) , gL ) to denote firms’ value function at nodes H and L, respectively. The
policy functions for compensation, firm effort, and the value functions at node H do not
depend on ε since there is no idiosyncratic shock at node H. The following proposition
provides conditions under which agency frictions amplify the equity premium and generate
countercyclical unemployment.
Proposition 4. (Aggregate Implications) Under assumptions 1–5, for expected utility
preferences, i.e., γ = 1, firm owners’ consumption share is countercyclical; that is, xH < xL .
For general recursive utility, there exists a γ̂ ∈ [1, 1 + ξ) such that if γ > γ̂, then (i) firm
owners’ consumption share is procyclical; that is, xH > xL and (ii) separation rates are
countercyclical; that is, θH (u0 ) > θL (u0 , ε) for all (u0 , ε).

    Because the consumption Euler equation must hold for the unconstrained firm owners,
amplification in the market price of risk relative to a representative agent model is equivalent
to firm owner’s consumption share being procyclical. The first part of proposition 4 implies
that countercylical idiosyncratic risk by itself is not sufficient for amplifying the volatility of
the equilibrium stochastic discount factor. Independent of the risk aversion γ, the optimal
contract generates uninsurable tail risk (proposition 2). However, under expected utility,
the pricing kernel is less volatile than the pricing kernel in an otherwise identical economy
with full commitment.
    Countercyclical idiosyncratic risk means that relative to booms, a larger fraction of
worker-firm pairs are constrained in recessions. Because constrained firms cut compensation,
in the aggregate, there is a higher fraction of resources available for firm owners during a

                                                    22
recession. Since goods markets need to clear, these resources are allocated between the
firm owners and the unconstrained workers by equating their intertemporal marginal rates
of substitution. With expected utility, this amounts to equalizing the growth rates of
                                                                                                             1
consumption of the firm owners and the unconstrained workers. Therefore, for γ = 1 =                         ψ,
the consumption share for firm owners increases in a recession, resulting in xL > xH . This
makes aggregate asset prices less volatile.
       The second implication of proposition 4 is that keeping the intertemporal elasticity of
substitution fixed, a large enough risk aversion results in a procyclical consumption share
for firm owners. Why does the cyclicality of x flip signs when risk aversion becomes larger
relative to inverse of the intertemporal elasticity of substitution? Persistent recessions that
are associated with a lack of risk sharing in the future imply lower continuation values
for all workers. As risk aversion exceeds the inverse of the intertemporal elasticity of
substitution, contemporaneous marginal utilities are decreasing functions of continuation
utility.9    Optimal risk sharing, which requires equating marginal rates of substitution
between firm owners and unconstrained workers, is now achieved by transferring resources
away from the firm owners in recessions. Proposition 4 says that for sufficiently high risk
aversion, this incentive is strong enough to dominate the effect of market clearing and
delivers procylical consumption shares for firm owners.
       The last part of proposition 4 says that separation rates are higher in recessions relative
to booms. In our model, labor income has two sources of tail risk. First, the distribution of
productivity shock ε has a left tail. As shown in proposition 2, under firm-side limited
commitment, this tail risk cannot be fully insured within optimal labor compensation
contracts. Second, workers become unemployed with probability θ and lose a fraction 1 − λ
of human capital in each period until they are matched with a new firm.
       The countercyclicality of unemployment risk asserted in part (ii) of proposition 4
is a direct consequence of incentive compatibility under moral hazard. Without moral
hazard, to efficiently deliver promised utility to workers, firms will typically choose a lower
separation rate in recessions, when human capital depreciation and consumption reduction
are more costly for workers. With moral hazard, such arrangements are no longer incentive
compatible, and firms equalize the marginal cost of retention effort to the present value of
profits that a worker can create without considering the cost of separation to workers. Since
valuation ratios in recessions are lower relative to booms, firms exert less effort to retain
workers, leading to countercyclical separation rates.
   9
    Ai and Bansal (2018) define the class of preferences under which marginal utility decreases with
continuation utility as generalized risk-sensitive preferences. Generalized risk sensitivity is the key property
of preferences captured by the assumption γ > ψ1 that is responsible for the procyclical consumption share
in our model.



                                                      23
   The effects of limited commitment and those of moral hazard reinforce each other to
amplify the volatility of the stochastic discount factor. Limited commitment amplifies risk
prices because optimal contracts insure workers against adverse aggregate shocks which
makes firm owners’ consumption more risky. Higher separations in recessions magnify the
downside risk in labor earnings and hence the need for insurance. Thus, higher separation
risk leads to more procyclical consumption for marginal agents, and the resulting higher
discounting in turn leads to lower worker valuations, lower retention effort from firms, and
more separations.


Contrasting the mechanism to alternatives proposed in the literature
Proposition 4 contrasts our setup with several exogenously incomplete market models—for
example, Constantinides and Duffie (1996), Constantinides and Ghosh (2014), and Schmidt
(2015), as well as setups that impose exogenous market segmentation such as Basak and
Cuoco (1998) or Guvenen (2009). In these papers, agents are not allowed to offer any
insurance contracts to one another. In our model, agents are allowed access to a rich set of
state-contingent payoffs, the only restriction being incentive compatibility constraints. In
the Constantinides and Duffie (1996)–style models, all agents are marginal investors in risky
assets, and hence countercyclical uninsurable risk in consumption automatically translates
into a more volatile pricing kernel. In our simple example, because market incompleteness
is determined by agency frictions, agents with adverse idiosyncratic shocks are constrained
and therefore are not marginal. Hence, higher idiosyncratic volatility by itself does not
increase the market price of risk.
   Alvarez and Jermann (2001) and Chien and Lustig (2010) derive asset pricing
implications in a setting with one-sided limited commitment.         This corresponds to a
version of our model where firms can fully commit but workers cannot. Such environments
produce high equity premia when more workers are constrained in adverse aggregate states.
The worker-side limited commitment constraint binds for worker-firm pairs that receive
large positive idiosyncratic productivity shocks. Because constrained workers need to be
compensated with higher current consumption, by market clearing, the consumption for
unconstrained agents drops, raising their marginal utilities. To amplify the risk premium,
such a model would necessarily require more positive skewness in labor earnings in recessions
relative to booms; an implication that is inconsistent with the key feature of labor market
risk that we highlight in the introduction. In addition, quantitatively, uninsurable tail risk
on the downside are much more powerful than on the upside in amplifying the volatility
of the stochastic discount factor. The workings of the simple example explain how a
combination of firm-side limited commitment with recursive utility jointly deliver downside
risk in labor earnings and higher risk premia.

                                             24
       Proposition 4 also distinguishes our model from Danthine and Donaldson (2002),
Favilukis and Lin (2016b), and other papers that use sticky wages to explain the high
equity premium. In these models, markets are complete and labor compensation contracts
do not affect the pricing kernel. These models produce higher equity premia through an
“operating leverage” channel: labor compensation is less sensitive to aggregate shocks, and
this amplifies the risk exposure of capital income. Since operating leverage affects only the
volatility of cash flows, these models need to assume a high level of risk aversion to match
aggregate Sharpe ratios.
       In contrast to models with exogenous wage rigidity, in our setup, risk premia are
amplified primarily through the effect of agency frictions on the volatility of the stochastic
discount factor and not because of a higher volatility of dividends.10 We return to this
implication in our quantitative analysis in section 6.1.


4.3      Cross-Sectional Implications

In addition to the implications for aggregate risk prices and aggregate unemployment
dynamics, our model has predictions for the cross section of returns and labor earnings.
We outline these implications here, and in section 6.3 we formally test them using panel
data on firm-level returns and firm-level labor shares.
       In our model, heterogeneity in firms is summarized by a single state variable u. High-u
firms promise a larger fraction of current and future cash flow to workers than low-u firms.
Thus, u can be interpreted as “labor leverage.” For a firm with labor share u0 , define the
elasticity of wage payments with respect to idiosyncratic shocks as

                                                ∂ ln [eε cL (u0 , ε)]
                                                                     
                                    Υ (u0 ) = E                         .
                                                         ∂ε

The term eε cL (u0 , ε) is the level of compensation to a worker with initial promised utility
u0 at node L. Next, define the valuation risk exposure or beta of a firm indexed by u0 as
                                                                          
                                                          vH (u0 )
                                      B (u0 ) =                                .
                                                      E [eε vL (u0 , ε)]

Below, we provide two comparative static results with respect to u0 .
                                                                                                ∂
Proposition 5. (Cross-Sectional Implications) Under assumptions 1–5, (i)                       ∂u0 Υ (u0 )   >0
  10
      In our model, the claim on aggregate dividends also has a higher price-to-dividend ratio in booms relative
to recessions. In appendix C, we show that under assumptions 1–5, ∃ γ̂ ∈ [1, 1 + ξ) such that γ > γ̂ implies
    vH (u∗0)
E [eε vL (u∗
                  > 1.
           0 ,ε)]




                                                        25
and (ii) there exists a γ̂ ∈ [1, 1 + ξ) such that ∀γ > γ̂, ∃û, where û is defined by
ε(û, gL ) = ln 1+ξ
                 ξ , such that ∀u0 < û,
                                                 ∂
                                                ∂u0 B (u0 )   > 0.

       Part (i) of the proposition says that the average elasticity of compensation with respect
to idiosyncratic shock ε is increasing in promised utility u0 .        Firms that promised a
higher fraction of cash flows to workers are more likely to be constrained. Whenever the
limited commitment constraint binds, perfect risk sharing is no longer possible, and worker
compensation responds to idiosyncratic productivity shocks. Thus, labor shares predict
firm-level wage pass-throughs. In section 6.3, we show that consistent with the above
implication of our model, payments to workers in firms with higher labor leverage are more
sensitive to firm-level idiosyncratic shocks.
       Part (ii) of the proposition summarizes our model’s implications for the cross section
of equity returns. Compensation contracts insure workers against aggregate shocks, which
makes the residual dividends more risky. In our model, firms with high u0 have low market-
to-book ratios and high labor leverage. In the cross section, the operating leverage effect
is stronger for high u0 firms. These firms promise a large fraction of their cash flow to
workers, bear more aggregate risk, and compensate investors by delivering higher expected
returns. In section 6.2, we use panel data on firm-level measures of labor obligations and
equity prices to show that low market-to-book ratio and high labor leverage firms indeed
have higher expected returns.
       From a worker’s perspective, proposition 5 implies that the exposure of their
consumption is increasing in promised utility, which is a measure of their wealth.
This implication further contrasts our setup with those with only worker-side limited
commitment. In these settings, (rich) agents who have experienced a history of positive
shocks are more likely to be constrained, and (poor) agents who have experienced a history
of negative shocks are typically not constrained. For these models to generate an amplified
equity premium, the marginal rate of substitution of the unconstrained agents necessarily
needs to be more volatile than that of an average agent. Therefore, they imply that the
unconstrained poor agents’ risk exposure to the stock market must be higher than that
of the constrained wealthy agents, an implication that is inconsistent with the empirical
evidence on stockholding patterns by wealth and income.11
  11
       See for instance Malloy et al. (2009).




                                                       26
5         Quantitative Analysis

5.1         Numerical Algorithm

Policy functions and state prices depend on the infinite-dimensional state variable φ.
The distribution φ shows up directly in the market clearing condition and indirectly as
an argument in the stochastic discount factor when we describe the optimal contracting
problem P1. We use a numerical procedure similar to that in Krusell and Smith (1998)
and replace the distribution φ with suitable summary statistics. We assume that agents
compute future state prices by projecting the stochastic discount factor on the space spanned
by {gt , xt } and use xt+1 = Γx (xt , gt , gt+1 ) as a forecasting rule for xt . Our choice of the
forecasting rule is numerically efficient because given a law of motion for x, the stochastic
discount factor is completely pinned down.12
         Using the forecasting function Γx , we compute the stochastic discount factor Λ (g 0 , x, g).
With Γx (x, g, x0 ) and Λ (g 0 , x, g), we solve the Bellman equation for the optimal contracting
problem using an endogenous grid method and value function iteration.                         In appendix
D, we describe a procedure that uses a grid on                ε (u, S, g 0 ),   which is the threshold for
the idiosyncratic shock such that the firm-side limited commitment constraint binds, to
tractably solve the contracting problem P1. After approximating the policy functions, we
simulate a panel of agents and use the simulated data to update the law of motion Γx .
We repeat this procedure until the the function Γx converges. Appendix D describes the
detailed steps and related diagnostics.


5.2         Calibration

Model parameters are divided into two sets: (i) parameters governing the stochastic process
for aggregate shocks and (ii) parameters governing labor market flows and the distribution
of idiosyncratic shocks to workers’ human capital.


Aggregate shocks            A period is a quarter. We time aggregate outcomes and report annual
moments. We assume that the aggregate productivity process {gt }t is a sum of a two-state
    12
    The market clearing condition equation (21) implies that x is linear in a c(u, S) weighted average of the
distribution φ. It summarizes information in φ by assigning relatively more weight to values of u that have
a larger effect on aggregate resources. This choice contrasts our algorithm to that in Krusell and Smith
(1998), who use the first moment of the distribution of wealth as a summary statistic.




                                                     27
Markov chain and a homoskedastic i.i.d. Gaussian component:13

                                    ln Yt+1 − ln Yt = gt+1 + σE Et .

The state space for the Markov chain is {gH , gL }. We refer to states with g = gH as “booms”
and states with g = gL as “recessions.” The aggregate shock process {gt , Et }t is calibrated as
in Ai and Kiku (2013). They jointly estimate the values for {gH , gL }, the Markov transition
matrix, and the volatility parameter σE from post-war aggregate consumption data. Our
calibration implies an average duration of 12 years for booms and four years for recessions.
The parameters for aggregate shocks are listed in the top part of table 1.


Labor market flows and evolution of human capital We calibrate the parameters
that govern labor market flows and the evolution of human capital using transition rates
between employment status, estimates of earning losses after separation, cross-sectional
moments of labor earnings distributions, and other aggregate moments such as the mean
and volatility of total labor compensation relative to aggregate consumption. Below, we
specify our functional form choices and discuss the identification of key parameters by
pairing them with the most relevant moments.
    We set κ = 1% to obtain an average working life of 25 years. To better match the
observed aggregate unemployment dynamics, we use a richer specification for the cost of
retention function A (θ, g) = ea0 [θ−a1,g ] . The scale of the cost function is normalized such
that overall the costs are negligible relative to the total output. We interpret a separation
in the model as a transition to the state of long-term unemployment (12 months and
beyond). The parameters for A(·), and {χ, λ, b} are pinned down by the transition rates
from employment to long-term unemployment in booms and recessions, the duration of long-
term unemployment, the average earnings losses upon separation, and the estimate of the
flow value of unemployment. To compute the flows in and out of long-term unemployment,
we use data from the Current Population Survey summarized in table 1 of Shibata (2015).
For earnings losses on separation, we use information from Davis and von Wachter (2011),
who estimate the present value of earning losses due to job separations. We target the
consumption equivalent of the flow value of unemployment to be 65% of pre-separation
wage earnings.14 The parameters and moments related to labor flows are listed in the
  13
     To better fit the autocorrelation of aggregate consumption growth, we use a more flexible process than
the one listed section 2.1. Equilibrium prices and the optimal contract satisfy a homogeneity property, and
the presence of i.i.d E shocks does not increase the state space for the value and policy functions.
  14
     The empirical labor literature has a wide range of values for the flow value of unemployment. Shimer
(2008) uses the unemployment insurance replacement rate of 40%, Rudanko (2011), and Mulligan (2012) add
the value of home production and leisure and target a higher number of 85%, and Hagedorn and Manovskii
(2008) use an even higher estimate of about 95%.


                                                    28
middle panel of table 1.
    Workers’ human capital is affected by worker- and firm-level idiosyncratic shocks ε + η.
We assume ε = αεW and η = (1 − α) εF , where εW and εF are i.i.d. according to a
continuous density f (·|g). To capture the feature that the (negative) skewness of labor
earnings is cyclical, we model the distribution f (·|g) to be a Gaussian distribution in booms
and a mixture distribution of a Gaussian and a fat-tailed distribution with a negative
exponential form in recessions. We assume that both the Gaussian distributions as well as
the negative exponential distribution satisfy a normalization such that the exponential of
the draw has a unit mean. These restrictions imply f (·|g) is paramterized by the following:
the standard deviation of the Gaussian distribution for booms σH ; the standard deviation
of the Gaussian distribution for recessions σL ; the intensity parameter for the negative
exponential distribution ξ; and the mixture weight ρ ∈ (0, 1), which is the probability of
drawing from the negative exponential distribution in recessions.
    We set the parameter α to match the within- and across-firm variations in labor earnings
as reported in Song et al. (2015) and calibrate the parameters {σH , σL , ρ, ξ} to match
the cyclical properties of the moments of labor earnings calculated using the Panel Study
of Income Dynamics (PSID).15 We restrict the sample to households where the “head of
household” is a male whose working age is between 15 and 64 and who reports at least 500
hours of work in two consecutive years. Our measure of earnings is the regression residual
of post-tax labor earnings on observable characteristics: age of the head, the age square,
family size, and education level of the head. To obtain our target moments, we compute the
cross-sectional standard deviation and Kelly skewness for log earnings growth, which are
then averaged separately for “boom years” and “recession years.”16 In the bottom part of
table 1, we report the parameter values and moments related to the earnings distribution.
    Our model closely matches the standard deviations of the earnings growth in booms
and recessions. We obtain a Kelly skewness of -3% in booms and -10% in recessions, as
compared with -3.2% and -9%, respectively, in the PSID.17
    All parameters affect the aggregate labor share. In our model, the employed workers’
  15
     The PSID is a longitudinal household survey of U.S. households with a nationally representative sample
of over 18,000 individuals. Information on these individuals and their descendants has been collected
continually, including data covering employment, income, wealth, expenditures, health, education, and
numerous other topics. The PSID data were collected annually during the period 1968–97 and biennially
after 1997.
  16
     We treat 1980–82, 1991–92, 2000–01, and 2007–09 as recession years and the remaining ones as boom
years.
  17
     In a previous version, we also reported results for an alternative calibration that targeted moments from
Guvenen et al. (2014) and produced similar asset pricing results. Compared to the Guvenen et al. (2014)
data, the PSID allows us to control for transfers from the government and lifecycle earning patterns that we
abstract from in our setup.



                                                     29
consumption as a fraction of aggregate consumption is countercyclical. It has a mean of
70%, a standard deviation of 3%, and an autocorrelation of 0.58. These moments are
consistent with the data of aggregate labor compensation. We use national income and
product accounts (NIPA) to compute the ratio of aggregate labor compensation to aggregate
consumption and then detrend the series. For the sample 1947–2015, the mean labor share
in consumption is 75%, the standard deviation is 2.94%, and the autocorrelation is 0.88.


6         Results

We discuss the implications for asset pricing and labor market dynamics.


6.1         Aggregate Asset Prices

In table 2, we summarize aggregate asset pricing moments. The baseline calibration is
under the column labeled “Model-Baseline,” and the column labeled “Model-No Frictions”
is the version without limited commitment and moral hazard. We report the properties
                                                                      
of returns on both a claim to aggregate consumption Yt                    φt (du) and a claim to aggregate
corporate dividends xt Yt . Our model generates a high equity premium and a low risk-free
interest rate with a risk aversion γ = 5 and an IES ψ = 2. Without assuming any financial
leverage, the equity premium on the claim to corporate dividends is about 3.67% per year in
the baseline model. The average debt-to-equity ratio for publicly traded U.S. firms is about
50%.18 Accounting for financial leverage, our model implies a market equity premium of
5.5%, which is close to the historical average excess return of 6.06% on the U.S. aggregate
stock market index. In contrast, the equity premium on the unlevered corporate dividends
is 0.62% per year in the first-best economy without limited commitment and moral hazard.
         The premium on a risky asset is proportional to the covariance between the stochastic
discount factor and its return. Our model generates a high equity premium for two reasons.
First, agency frictions amplify the unconditional volatility of the stochastic discount factor.
As explained in proposition 4, the insurance motives against persistent countercyclical tail
risk in labor earnings imply a procyclical consumption share of the marginal investors. A
more volatile stochastic discount factor is reflected in higher Sharpe ratios. Using the mean
and the standard deviation of excess returns from table 2, the Sharpe ratio on the claim to
aggregate dividends in the baseline is 48.5%, which is more than twice as large as that in
the case with no frictions.
         The second reason for the high equity premium is the large volatility of stock returns.
    18
         See Graham et al. (2015) for details on measurement of corporate leverage.


                                                        30
In our model, stock returns are volatile because agency frictions generate fluctuations
in the volatility of the stochastic discount factor over time.      The general equilibrium
implications of the agency problem introduce a new channel that raises the volatility of the
stochastic discount factor in recessions relative to booms. The reason is the presence of the
distributional state variable φ, whose slow-moving dynamics are summarized in persistent
changes in the firm owners’ share of aggregate consumption xt . Prolonged recessions are
associated with increasingly lower levels of the firm owner’s consumption share. This
                                                                       xt+1 gt+1
implies that small changes in xt translate into large variations in     xt e     ,   which is the
consumption growth rate of the firm owners. In equilibrium, the amplified volatility of the
firm owner’s consumption is compensated by a higher risk premium. The second effect
of low xt in recessions is a higher discounting of the future match surplus. This lowers
firms’ incentives to retain workers and exacerbates the moral hazard problem. Agents
anticipate more separations and a higher downside earnings risk, which feeds back into a
higher risk premia. On the other hand, in booms, the level of xt is high, and the volatility
and discounting effects are diminished.
   This asymmetry results in countercyclical risk prices, high return volatility, and
predictability of market returns by valuation ratios. The model delivers a 7.40% standard
deviation of the return on the unlevered claim to corporate dividends, which is about three
times higher than its counterpart in the economy with full commitment and no moral
hazard. Given a low volatility of aggregate consumption and an only moderately volatile
risk-free rate, most of the increase in the volatility of the market return is accounted for by
the time-varying equity premium.
   Time variation in the risk premium also generates the predictability of future excess
returns by price-to-dividend ratios, an empirical regularity documented by several papers
including Campbell and Shiller (1988), Fama and French (1988), and Hodrick (1992). In
table 3, we report the results of predictability regressions in our model and those in the
data. We regress excess stock market returns measured at one-to-twelve quarter horizons
on the log price-to-dividend ratio at the start of the measuring period. The “Data” column
reports coefficients and R2 of these regressions using the SP500 returns over the period
1947–2015, where the data construction follows Beeler and Campbell (2012). We report
the same regression results using model-simulated data in the “Model-Baseline” column.
Overall, the model produces regression coefficients and R2 that are consistent with those in
the data. We also match the pattern that predictability is higher for longer-horizon returns.
As a comparison, the first-best case in the column “Model-No Frictions” has a very low R2 .
   Our calibration does not explicitly target moments in return predictability regressions.
In fact, compared with the data, our model has a higher R2 in predictability regressions.


                                              31
Leading asset pricing models, such as the habit model of Campbell and Cochrane
(1999) and the long-run risk model of Bansal and Yaron (2004), typically assume that
dividend growth contains an extra stochastic component that is orthogonal to shocks in
aggregate consumption, which implies that a significant component stock price movements
is unpredictable. For parsimony, our model does not make this assumption and therefore
generates a higher predictability relative to the data.
   The moments of risk-free interest rate in our model are fairly in line with standard
asset pricing models. The volatility of the risk-free rate in our baseline model is 2.86% per
annum. There is a wide range of estimates for this moment in the literature depending on
estimation details and sample choices. The volatility of risk-free interest rate in our model
is slightly higher than standard asset pricing models such as Campbell and Cochrane (1999)
and Bansal and Yaron (2004). However, it is consistent with recent papers that construct
“ex ante” measures of the risk-free rate; see, for example, Schorfheide et al. (2018) and
Beeler and Campbell (2012).


Model benchmarking          In this section, we compare our results to nested cases that
capture important benchmarks in the literature. The comparisons highlight why our model
generates risk premia that are high and countercylical relative to setups such as those with
one-sided limited commitment or exogenous wage rigidity when we require consistency with
the aggregate and distributional data on labor earnings across models. Table 4 summarizes
the findings.
   Assume that firms can fully commit. This version of our model is similar to Alvarez
and Jermann (2001) or Chien and Lustig (2010), who study the asset pricing implications
of worker-side limited commitment. We keep all other features of the model unchanged,
including the assumption that workers obtain all the surplus from new matches and the
specification of the moral hazard problem. The results are under the column labeled “Only-
Worker-Side Limited Commitment” in table 4.
   The risk premium on the aggregate endowment claim and the volatility of returns are
lower in the model with only-worker-side limited commitment. The intuition for this result
can be explained as follows. First, the tightness of the worker-side limited commitment
constraint does not significantly change over time. In the model, the worker-side limited
commitment constraint binds for workers that receive sufficiently positive idiosyncratic
shocks. However, the right tail of the distribution of idiosyncratic shocks is similar in booms
and recessions. This is because our calibration is disciplined by the feature of the data that
the standard deviation and the right skewness of labor earnings are almost acyclical. Second,
worker-side limited commitment generates uninsurable upside risk in labor earnings. Even


                                              32
with recursive utility, this does not produce quantitatively significant effects on marginal
utilities.
    In terms of the labor market moments, we find that the model with only-worker-side
limited commitment misses the large negative Kelly skewness of labor earnings in recessions
and other measures of tail risk, which in our baseline model is generated by the firm-side
limited commitment constraint. In addition, the lack of time variation in discount rates
mitigates the cyclicality of separation rates through the moral hazard channel.
    Next we compare our model to a version of Favilukis and Lin (2016b). Their model
features a complete-markets stochastic discount factor and exogenous wage rigidity that
generates countercyclical labor shares. We capture the Favilukis and Lin (2016b) mechanism
in our setup by assuming that the aggregate dividend process follows x̃(gt )Yt , where
x̃(gH ) > x̃(gL ). We keep all other parameters of the model unchanged and discipline the
choice of x̃(gH ) and x̃(gL ) by calibrating them to match the mean and standard deviation
of labor shares of 67% and 2%, respectively, as in Favilukis and Lin (2016b). We then
price the resulting x̃(g)Y claim using a stochastic discount factor that is derived from a
representative agent economy version of our model.
    The “Exogenous Wage Rigidity” version of the model delivers a low equity premium
of 0.681% and a small volatility of excess returns of 3.09%. These values are only slightly
higher than those in our first-best case reported in table 2 under the column labeled “No
Frictions.” The volatility of aggregate labor share in the data is small and this limits the
ability of models relying exclusively on operating leverage to generate high risk prices.
    In contrast, our baseline generates a significantly higher premium. Agency frictions in
our model amplify the volatility of the stochastic discount factor as well as the risk exposure
of the aggregate dividend claim. For example, in table 2 under the column labeled “Model-
Baseline,” we see that while the risk premium on the aggregate consumption claim is 3.59%,
the premium on the claim to corporate dividends is 3.67%. The small difference in these
risk premia highlights that the amplification is primarily due to a more volatile stochastic
discount factor and the role of the cash flow volatility channel is small.
    Modeling the mixture distribution is necessary to match the extent and cyclicality of tail
risk observed in labor earnings and, at the same time, deliver an approximately acyclical
standard deviation of earnings growth as observed in the PSID. To highlight its importance,
in table 4 under the column labeled “No Mixture,” we report two calibrations without
assuming a mixture distribution: (i) σH = σL and (ii) σH < σL .
    In the case where the distribution of idiosyncratic risk is independent of the aggregate
state—that is, σH = σL = 8.3%—we find that the asset pricing implications are almost


                                              33
similar to the first-best case, consistent with the Krueger and Lustig (2010) intuition
outlined in section 4.1. In the case σL > σH , it is possible to make σL sufficiently higher than
σH so that the implied volatility of the stochastic discount factor is similar to the baseline
calibration. With σL = 10.3% and σH = 8%, we are able to get an equity premium on the
unlevered aggregate consumption claim of 3.2%. However, we find that the earnings growth
distribution has (counterfactually) countercylical standard deviation, 38% in recessions and
30% in booms, and almost no cyclicality in Kelly skewness.
       Discount rates in general equilibrium models can be constructed from the marginal
rate of substitution of marginal investors. Although all agents who do not face a binding
limited commitment constraint are marginal investors in our model, it is more convenient
to construct the SDF from firm owners’ consumption, because they are never constrained.19
To further illustrate the mechanism for the high volatility of SDF in our model, we report
the volatility of firm owner’s consumption in all four versions of the model in table 4.
       First, the standard deviation of consumption growth for firm owners is 10% per year.
In the data, it is difficult to reliably measure the consumption of wealthy stockholders.
Using the sample from Consumer Expenditure Survey (CEX), Wachter and Yogo (2007)
report that the median standard deviation of consumption growth for the bottom 50% of
stock-holding households is 7.26% and that of the top 25% is about 11.38% per year. Firm
owners’ consumption is more procyclical than aggregate consumption. As we explain in
section 4, this extra risk exposure in not insured away in equilibrium, because workers’
marginal utility is high in recessions owning to uninsurable idiosyncratic risk, and it is
optimal for firm owners to bear more aggregate risks than workers.
       Second, the pattern of the volatility of consumption growth for firm owners echoes the
pattern of the volatility of stochastic discount factor across models. The inability for other
versions of the model to generate a high volatility of SDF can be attributed to the lack of risk
exposure of firm owners’ equilibrium consumption. The version of our model with counter-
cyclical second moment (σL > σH ) also generates a high volatility of consumption growth
for firm owners and a high volatility of SDF, but at the expense of excessive countercyclical
standard deviation in labor earnings growth.


6.2      Cross Section of Expected Returns

Value premium           Stocks with low valuation ratios (value stocks) earn higher average
returns than stocks with high valuation ratios (growth stocks). The difference in the mean
  19
    Firm owners are not the only investors whose marginal rate of substitution is a valid stochastic discount
factor. This is true for all unconstrained workers. In our baseline calibration, less than 5% of workers are
constrained in any given quarter.


                                                     34
returns of value and growth stocks is robust to various ways of constructing the valuation
ratio—for example, as the ratio of the market value of the firm to its book value or as the
ratio of the market price of the stock to earnings per share; see Fama and French (1992)
and Fama and French (1993).
       Our model generates a value premium. The price-to-earnings ratio and expected returns
are functions of the state variable ut , which summarizes the fraction of future cash flows
that is promised to workers. Firms with high-u workers have a high operating leverage and
a low valuation ratio. Proposition 5 states that such firms should have a higher expected
return. To compare our model implications with data, we sort stocks into three portfolios
ranked by earnings-to-price ratios.20 The mean high-minus-low return is 6.27% per year,
with a t-statistic of 5.01. The same portfolio-sorting procedure in the data simulated from
the model generates a value premium of 4.66% per year.
       In our model, firms with a history of negative idiosyncratic shocks have higher expected
return. A similar effect is documented by Bondt and Thaler (1985) as “long-term reversal.”
In our model, long-term reversal and value premium are due to the same economic
mechanism, and hence they are highly correlated. Consistent with this implication of our
theory, Fama and French (1996) show that the returns on value-growth portfolios and long-
term reversal sorted portfolios are highly correlated.


Labor leverage and the cross section of expected returns                     A more direct test of the
model mechanism is the connection between the value premium and firm-level obligations
to workers. We use the merged CRSP/Compustat panel to test this implication.
       We focus on publicly traded firms in the Compustat database and regress excess returns
on a firm’s equity, which are defined as the difference between equity returns and the three-
month T-bill rate, on firm-level labor shares and time fixed effects.

                      Excess Returnf,t+1 = αr + βr ×LaborSharef,t + λrt .                            (32)

Following Donangelo et al. (2016), labor share for firm f at period t is constructed using

                                                       XLRf t
                         LaborSharef,t =                                 ,                           (33)
                                            OP IDf,t + XLRf,t + ∆IN Vf,t

where XLR is the total wage bill, OPID is operating profit before interest and depreciation,
and INV is change in inventories. Whenever XLR is not available, we construct an extended
labor share (ELS) using the procedure described in Donangelo et al. (2016). In table 5,
  20
    The return series for these portfolios is obtained from Kenneth French’s website and covers the period
1956—2016.


                                                   35
we report our results both with labor share, under the column labeled “Using LS,” and
with extended labor share, under the column labeled “Using ELS.” Consistent with our
model, labor share predicts expected returns, and the point estimate for βr is positive
and significant.21 These findings are consistent with and complementary to other studies
such as Donangelo et al. (2016), who document returns on labor share–sorted portfolios
and estimate versions of (32), as well as Favilukis and Lin (2016a), who use wage rigidity
as a proxy for labor leverage at the industry level and show that labor leverage predicts
cross-industry expected returns.


6.3    Labor Market Implications

In this section, we focus on the implications for aggregate and cross-sectional labor market
dynamics.


Discount rates and unemployment risks                     The incentive compatibility condition (17)
links unemployment risk to worker valuations that are influenced by discount rate variations.
In our model, prolonged recessions are states with high expected returns and low present
values of cash flows from workers. Because firms’ retention effort is not observable, they have
a lower incentive to keep workers in times of low valuations. Several papers in the recent
literature emphasize the link between discount rates and unemployment; see, for example,
Hall (2017), Kehoe et al. (2019) and Borovicka and Borovickova (2018). In contrast to
these papers, the variation in discount rates in our setting is driven by general equilibrium
implications of contracting frictions, and our model is consistent with broad patterns in
aggregate and cross-sectional asset returns.
    In our model, average separation rates are countercyclical: 3% per year in recessions
and 2% per year in booms. In the presence of separations, part of the tail risk in labor
earnings is driven partly by the extensive margin when workers transition from employment
to long-term unemployment.            We decompose large earnings drops—that is, reductions
in individual earnings of more than 20%—into two categories: separations and within-
employment compensation cuts. In our calibration, 48.5% of large earnings drops are due
to separation and the remaining 51.5% are due to a binding firm-side limited commitment
constraint. This pattern is consistent with Guvenen et al. (2014), who document that
workers in the left tail of the income distribution are more likely to experience a large drop
in earnings, and claim that a nonnegligible fraction of the drop is due to unemployment
risk. The separation risk is also quantitatively important in accounting for the volatility of
  21
     The estimates are robust to including various control variables such as leverage and total assets in the
regression (32). See appendix E.


                                                     36
the stochastic discount factor. Shutting down separations—that is, under a calibration with
θ = 1—and keeping all other parameters unchanged lowers the annualized risk premium on
the aggregate consumption claim from 3.6% to 2.14%. We interpret this as both channels
being salient and paycut-driven tail risk accounting for about two-thirds of the equity
premium.


Exposures to idiosyncratic and aggregate shocks                   Propositions 4 and 5 have direct
implications for how idiosyncratic and aggregate shocks are insured in the presence of agency
frictions. Owing to to firm-side limited commitment, workers with adverse histories are more
exposed to idiosyncratic shocks in recessions. The optimal contract compensates this lack
of insurance by providing such workers an additional hedge against aggregate shocks. Thus,
the consumption of workers with adverse histories would have a relatively higher exposure
to idiosyncratic shocks and a lower exposure to aggregate shocks.
    To test whether firms with larger obligations to workers provide less insurance against
idiosyncratic shocks, we measure the pass-through of firm-level shocks to their wage
payments and check whether these pass-throughs systematically vary with the firm-level
labor share. We estimate the regression

              ∆ log WageBillf,t+1 = αw + βw0 LaborSharef,t + βw1 ∆ log Salesf,t
                                     + γw ∆ log Salesf,t × LaborSharef,t + λwt ,                   (34)

where WageBillf,t+1 is the total wage bill of firm f in year t + 1 and LaborSharef,t is
as defined in equation (33). Our sample includes all firms in Compustat for the period
1959-2017.
    We report our regression results in table 6, where standard errors are in parentheses.
Consistent with our model’s implication of imperfect risk sharing, the point estimate of the
pass-through coefficient β1 is positive but less than one.22 Furthermore, the interaction
term γw > 0 and is statistically significant. This confirms the conclusion of proposition 5
that firms with higher labor leverage have a higher pass-through coefficient. In appendix E,
we estimate a version of (34) where we split the sales growth into a negative sales growth
part and positive sales growth part. We find that consistent with the model, the interaction
term is driven mainly by the negative part of sales growth.
 22
    Guiso et al. (2005) also estimate the extent of insurance within the firm using administrative-level
matched employer-employee data and similar regressions.




                                                  37
7    Conclusion

We present an asset pricing model where risk premia are amplified by agency frictions.
Under the optimal contract, sufficiently adverse shocks to worker productivity are uninsured.
In general equilibrium, exposure to downside tail risk results in a more volatile stochastic
discount factor and time variations in discount rates. These features of the pricing kernel
yield quantitatively large and volatile risk premia and generate a substantial cross-sectional
variation in returns across firms. Our model is also consistent with firm-level measures of
labor share that predict both future returns and pass-throughs of firm-level shocks to wage
payments.
    An interesting extension of our setup would be to allow for a storage technology, such
as physical capital, along with related agency frictions such as hidden savings for workers
or the ability of firm owners to additionally use capital as collateral. This will open up a
host of new predictions about aggregate business cycle fluctuations, firm-level and aggregate
asset prices as well as capital misallocation in the cross section of firms. A recent paper by
Tong and Ying (2019) builds on our setup and studies asset pricing implications of limited
commitment in production economies.




                                             38
References
Abraham, A., F. Alvarez-Parra, and S. Forstner (2017): “The Effects of Moral
  Hazard on Wage Inequality in a Frictional Labor Market,” Working Paper.

Ai, H. and R. Bansal (2018): “Risk Preferences and the Macroeconomic Announcement
  Premium,” Econometrica, 86, 1383–1430.

Ai, H. and D. Kiku (2013): “Growth to Value: Option Exercise and the Cross Section of
  Equity Returns,” Journal of Financial Economics, 107, 325–349.

Ai, H. and R. Li (2015):         “Investment and CEO Compensation under Limited
  Commitment,” Journal of Financial Economics., 116, 452–472.

Alvarez, F. and U. J. Jermann (2000): “Efficiency, Equilibrium, and Asset Pricing with
  Risk of Default,” Econometrica, 68, 775–797.

——— (2001):       “Quantitative Asset Pricing Implications of Endogenous Solvency
  Constraints,” Review of Financial Studies, 14, 1117–1151.

Atkeson, A. and R. E. Lucas, Jr. (1992): “On Efficient Distribution with Private
  Information,” Review of Economic Studies, 59, 427–453.

Bansal, R. and A. Yaron (2004): “Risks for the Long Run: A Potential Resolution of
  Asset Pricing Puzzles,” Journal of Finance, 59, 1481–1509.

Basak, S. and D. Cuoco (1998): “An Equilibrium Model with Restricted Stock Market
  Participation,” The Review of Financial Studies, 11, 309–341.

Beeler, J. and J. Y. Campbell (2012): “The Long-Run Risks Model and Aggregate
  Asset Prices: An Empirical Assessment,” Critical Finance Review, 1, 141–182.

Berk, J. B. and J. Walden (2013): “Limited Capital Market Participation and Human
  Capital Risk,” Review of Asset Pricing Studies, 3, 1–37.

Bolton, P., N. Wang, and J. Yang (2014): “Liquidity and Risk Management:
  Coordinating Investment and Compensation Policies,” Working Paper, Columbia
  University.

Bondt, W. F. M. D. and R. Thaler (1985): “Does the Stock Market Overreact?” The
  Journal of Finance, 40, 793–805.

Borovicka, J. and K. Borovickova (2018):              “Risk Premia and Unemployment
  Fluctuations,” Working Paper, New York University.

                                           39
Campbell, J. Y. and J. H. Cochrane (1999): “By Force of Habit: A Consumption-
  based Explanation of Aggregate Stock Market Behavior,” Journal of Political Economy,
  107, 205–251.

Campbell, J. Y. and R. J. Shiller (1988): “The Dividend-price Ratio and Expectations
  of Future Dividends and Discount Factors,” Review of financial studies, 1, 195–228.

Carroll, C. D. (2006): “The Method of Endogenous Gridpoints for Solving Dynamic
  Stochastic Optimization Problems,” Economics Letters, 91, 312–320.

Chien, Y. and H. Lustig (2010): “The Market Price of Aggregate Risk and the Wealth
  Distribution,” Review of Financial Studies, 23, 1596–1650.

Constantinides, G. M. and D. Duffie (1996): “Asset Pricing with Heterogenous
  Consumers,” Journal of Political Economy, 104, 219–240.

Constantinides, G. M. and A. Ghosh (2014): “Asset Pricing with Countercyclical
  Household Consumption Risk,” Working Paper, University of Chicago Booth School of
  Business.

Danthine, J.-P. and J. B. Donaldson (2002): “Labour Relations and Asset Returns,”
  Review of Economic Studies, 69, 41–64.

Davis, S. J. and T. von Wachter (2011): “Recessions and the Costs of Job Loss,”
  Brookings Papers on Economic Activity, 2, 1–72.

Donangelo, A., F. Gourio, M. Kehrig, and M. Palacios (2016): “The Cross-
  Section of Labor Leverage and Equity Returns,” Working Paper, Federal Reserve Bank
  of Chicago, unpublished Paper.

Fama, E. and K. French (1996): “Multifactor Explanations of Asset Pricing Anomalies,”
  The Journal of Finance, 51, 55–84.

Fama, E. F. and K. R. French (1988): “Dividend Yields and Expected Stock Returns,”
  Journal of Financial Economics, 22, 3–25.

——— (1992): “The Cross-Section of Expected Stock Returns,” The Journal of Finance,
  47, 427–465.

——— (1993): “Common Risk Factors in the Returns on Stocks and Bonds,” Journal of
  Financial Economics, 33, 3–56.

Favilukis, J. and X. Lin (2016a): “Does Wage Rigidity Make Firms Riskier? Evidence
  from Long-horizon Return Predictability,” Journal of Monetary Economics, 78, 80–95.

                                           40
——— (2016b): “Wage Rigidity: A Quantitative Solution to Several Asset Pricing Puzzles,”
  Review of Financial Studies, 29, 148–192.

Graham, J. R., M. T. Leary, and M. R. Roberts (2015): “A Century of Capital
  Structure: The Leveraging of Corporate America,” Journal of Financial Economics, 118,
  658–683, nBER Symposium on New perspectives on corporate capital structures.

Greenwald, D. L., M. Lettau, and S. C. Ludvigson (2014): “The Origins of Stock
  Market Fluctuations,” NBER Working Paper.

Guiso, L., L. Pistaferri, and F. Schivardi (2005): “Insurance within the Firm,”
  Journal of Political Economy, 113, 1054–1087.

Guvenen, F. (2009):       “A Parsimonious Macroeconomic Model for Asset Pricing,”
  Econometrica, 77, 1711–1750.

Guvenen, F., S. Ozkan, and J. Song (2014): “The Nature of Countercyclical Income
  Risk,” Journal of Political Economy, 122, 621–660.

Hagedorn, M. and I. Manovskii (2008): “The Cyclical Behavior of Equilibrium
  Unemployment and Vacancies Revisited,” American Economic Review, 98, 1692–1706.

Hall, R. E. (2017): “High Discounts and High Unemployment,” American Economic
  Review, 107, 305–330.

Harris, M. and B. Holmstrom (1982): “A Theory of Wage Dynamics,” Review of
  Economic Studies, 49, 315–333.

Heaton, J. and D. J. Lucas (1996): “Evaluating the Effects of Incomplete Markets on
  Risk Sharing and Asset Pricing,” Journal of Political Economy, 104, 443–487.

Hodrick, R. J. (1992): “Dividend Yields and Expected Stock Returns: Alternative
  Procedures for Inference and Measurement,” Review of Financial Studies, 5, 357–386.

Kehoe, P. J., E. Pastorino, and V. Midrigan (2019): “Debt Constraints and
  Employment,” Journal of Political Economy, 127, 1926–1991.

Kehoe, T. J. and D. K. Levine (1993): “Debt-Constrained Asset Markets,” Review of
  Economic Studies, 60, 865–888.

Krueger, D. and H. Lustig (2010): “When Is Market Incompleteness Irrelevant for the
  Price of Aggregate Risk (and When Is It Not)?” Journal of Economic Theory, 145, 1–41.



                                              41
Krusell, P. and A. Smith, Jr. (1998): “Income and Wealth Heterogenity in the
  Macroeconomy,” Journal of Political Economy, 106, 867–896.

Lamadon, T. (2016):       “Productivity Shocks, Long-term Contracts and Earnings
  Dynamics,” Working Paper.

Lettau, M., S. C. Ludvigson, and S. Ma (2014): “Capital Share Risk in U.S. Asset
  Pricing,” NBER Working Paper.

Lustig, H. and A. Verdelhan (2012): “Business Cycle Variation in the Risk-Return
  Trade-Off,” Journal of Monetary Economics, 59, S35 – S49.

Malloy, C. J., T. J. Moskowitz, and A. Vissing-Jorgensen (2009): “Long-Run
  Stockholder Consumption Risk and Asset Returns,” The Journal of Finance, 64, 2427–
  2479.

Mankiw, N. G. (1986): “The Equity Premium and The Concentration of Aggregate
  Shocks,” Journal of Financial Economics, 17, 211–219.

Mulligan, C. B. (2012): “Do Welfare Policies Matter for Labor Market Aggregates?
  Quantifying Safety Net Work Incentives Since 2007,” NBER Working Paper.

Rudanko, L. (2011): “Aggregate and Idiosyncratic Risk in a Frictional Labor Market,”
  American Economic Review, 101, 2823–2843.

Schmidt, L. (2015): “Climbing and Falling off the Ladder : Asset Pricing Implications of
  Labor Market Event Risk,” Working Paper.

Schorfheide, F., D. Song, and A. Yaron (2018): “Identifying Long-Run Risks: A
  Bayesian Mixed-Frequency Approach,” Econometrica, 86, 617–654.

Shibata, I. (2015): “Labor Market Dynamics: A Hidden Markov Approach,” Working
  Paper.

Shimer, R. (2008): “The Probability of Finding a Job,” 98, 268–273.

Song, J., D. Price J, F. Guvenen, N. Bloom, and T. von Wachter (2015): “Firming
  up Inequality,” NBER Working Paper.

Stokey, N. L., R. E. Lucas, Jr., and E. C. Prescott (1989): Recursive Methods in
  Economic Dynamics, Harvard University Press.

Storesletten, K., C. I. Telmer, and A. Yaron (2007):               “Asset Pricing with
  Idiosyncratic Risk and Overlapping Generations,” Review of Economic Dynamics, 10,
  519–548.

                                          42
Thomas, J. and T. Worrall (1988): “Self-Enforcing Wage Contracts,” Review of
  Economic Studies, 55, 541–553.

Tong, J. and C. Ying (2019): “A Dynamic-Agency Based Asset Pricing Theory with
  Production,” Unpublished Paper.

Tsuyuhara, K. (2016): “Dynamic Contracts with Worker Mobility via Directed On-the-
  Job Search,” International Economic Review, 57, 1405–1424.

Wachter, J. A. and M. Yogo (2007): “Why Do Household Portfolio Shares Rise in
  Wealth?” Working Paper.




                                         43
      Online Appendix for Asset Pricing with Endogenously
                                 Uninsurable Tail Risk

A      Additional details for restrictions on the space of contracts


In this section, we show that given the equilibrium we construct in the main text, there
are no incentives for firms to offer any insurance to workers that are not currently matched
with the firm. We build the argument in several steps. We first show that firms do not have
incentives to offer any unemployment insurance to workers after separation. Then we show
that the restricted employment contract that we construct in the main text of the paper is
in fact optimal in a larger contracting space where all firms are allowed to offer insurance
to all workers.


A.1         Insurance provision to unemployed workers
                                                                                      n      o∞
First, consider an optimal contracting problem of a firm that offers payments          Cet+s
                                                                                               s=0
to an unemployed worker subject to two-sided limited commitment. Let Ve (U, y, S) be the
value of the insurance contract to a firm as a function of worker output y, promised utility
U for a given aggregate state S. Following the steps in the main text, the above contracting
problem can be expressed as
                                                                                               
                                         X                                                   
                                             π g 0 |g Λ S 0 , S (1 − χ) Ve Ue 0 g 0 , λy, S 0
                                                                                 
 Ve (U, y, S) = maxC, e 0 (g 0 )}
                   e {U              −C
                                      e+κ
                                 g0 
                                           0
                                                                                                
                                              g


subject to
                                                                             1− 1  1−1 1
                                                                                   ψ

       h       i1− 1        X           h            1−γ                i 1
                                                                     1−γ 1−γ        ψ
                    ψ               0             0 0           ∗ 0
                                       
 (1 − β) by + C
              e       + β κ     π g |g (1 − χ) U
                                                e g        + χ u S λy                       ≥ U,
                              0
                                                                                     
                            g                                                       

                                                                                              (35)
 e 0 g ≥ ū S λy, f or all g 0 ,
      0          0
                  
U                                                                                             (36)
                      
      e 0 g 0 , λy, S 0 ≥ 0, f or all g 0 .
             
Ve U                                                                                          (37)

where functions u∗ (S) and ū (S) are defined in equations (12) and equation (11) respectively.



                                                  44
    The optimal contractnchoosesothe current period payment to the worker C  e and a menu
                          e 0 (g 0 )
of continuation utilities U            to maximize the net present value of the contract to
                                   g 0

the firm. The human capital of an unemployed worker depreciates deterministically at rate
1 − λ; therefore, in the absence of idiosyncratic shocks, the continuation utility is only a
function of aggregate shock g 0 . To understand the expression for the continuation payoff,
note that in the next period, with probability χ, the worker stay unemployed, in which
                                     e 0 (g 0 ) , λy, S 0 . With probability 1 − χ, the worker
case the value of the contract is Ve U
receives an opportunity to match with a firm, which can be a different firm or the same
firm who is providing the insurance. In either case, because of competition, the value of the
continuation contract after the worker finds an employment opportunity give the worker a
continuation value of u∗ (S) λy and a value of zero to the firm.
   Inequality (35) is the promise keeping constraint.    The worker receives by as
unemployment benefit and a transfer of C from the insurance firm. In the next period,
                                       e
                                                                                  e 0 (g 0 ).
with probability 1 − χ, the worker stays unemployed and receives promised utility U
With probability χ, the worker has an opportunity to match with another firm and receives
u∗ (S 0 ) λy. Inequality (36) is the limited commitment constraint for workers: promised
utility under the insurance contract has to be higher than the utility associated with
consuming unemployment benefit as workers always have an option to default on the
contract offered by the insurance firm and to consume the unemployment benefit thereafter.
Because workers’ human capital depreciate at rate 1 − λ, the utility associated with
consuming unemployment benefit is ū (S 0 ) λy in the next period. Finally, inequality (36) is
the limited commitment constraint for the firm which requires the net present value of the
insurance contract to be non-negative for the firm.
   The lemma below provides a sufficient condition for the absence of unemployment
insurance offered by firms.

Lemma 1. Suppose λ is small enough, in particular, for all S and S 0 ,
                                                              ψγ−1
                                   x (S 0 )        w (S 0 )
                                             
                                λ≤                                    .                  (38)
                                   x (S)           n (S)

Then, at U = ū (S) y, we must have C                e 0 (U, y, S, g 0 ) = ū (S 0 ) λy, and
                                    e (U, y, S) = 0, U
Ve (U, y, S) = 0.

Proof. As in the main text, the optimal contracting problem can be normalized.
Homogeneity of the problem implies Ve (U, y, S) = ve (u, S) y for some ve, where u = U .   y
Using normalized value and policy functions, we can write the optimal contracting problem



                                              45
in the normalized form. Define the T operator as
                                                                                                       
                                                           X                        0
                                                                                                        
                                                               π g 0 |g Λ S 0 , S χeg ve u0 g 0 , S 0
                                                                                                   
       T ve (u, S) = maxc,{u0 (g0 )}g0                 −e
                                                        c+κ                                                                                (39)
                                                            0
                                                                                                        
                                                                       g
                                          o 1
                        1− 1          1− 1 1−1/ψ
        n
    s.t. (1 − β) [b + e
                      c] ψ + β (λm) ψ               ≥u                                                                                     (40)
                                                                      
             X                h                                  i 1 
                                               1−γ             1−γ 1−γ
                     π g 0 |g (1 − χ) u0 g 0       + χu∗ S 0
                                                           
        m= κ                                                                                                                               (41)
                  0
                                                                       
                           g
         0       0
              ≥ ū S 0 , f or all g 0
                       
       u g                                                                                                                                 (42)
       ve u0 g 0 , S 0 ≥ 0, f or all g 0 .
                     
                                                                                                                                           (43)

Under standard discounting assumptions, T is a contraction on the set of bounded
continuous functions and ve (u, S) is the unique fixed point of the T operator. The conclusion
of the above lemma is therefore equivalent to the following property of the normalized
optimal contracting problem, that is, for u = ū (S),

                     c (u, S) = 0; u0 u, S, g 0 = ū S 0 g 0 f or all g 0 ; and ve (u, S) = 0.
                                                           
                     e                                                                                                                     (44)


   Consider the constrained maximization problem (39). Let µ be the Lagrangian multiplier
for the constraint (40). The first order conditions are:
                                                                                 c − 1
                                                                                         ψ
                                                         1 = µ (1 − β)                       ,
                                                                                 u
                                                                                − 1                  −γ
                                                                                           u0 (g 0 )
                                                                   
              d
             0                            0                                λm        ψ
                 ve u0 g 0 , S 0 + µβe−γg                                                                    ≥ 0, f or all g 0
                               
      Λ S ,S                                                                                                                               (45)
              du                                                            u                m
and “=” holds if ve (u0 (g 0 ) |S 0 ) > 0.                        The envelope condition implies                              d
                                                                                                                             du v
                                                                                                                                e (u, S)   = µ.
Combining the above conditions, and using the expression for the stochastic discount factor
in (19), the optimality condition (45) can be written as
                                − 1                1 −γ                                             − 1                 1 −γ
                     x (S 0 )            w (S 0 )                            c (ū (g 0 ) , S 0 )               u0 (g 0 )
                                                                      
                                  ψ                  ψ             1
                                                                  −ψ       b+e                           ψ                   ψ
                                                             ≤λ                                                                      ,     (46)
                     x (S)               n (S)                              b+e c (u, S)                          m

and “=” holds if ve (u0 (g 0 ) |S 0 ) > 0. Because (43) is a standard convex programming problem,
(46) is both necessary and sufficient for optimality.
   To prove (44), note that set of functions that are concave in its first argument and
satisfy ve (ū (S) , S) = 0 is a closed subset in the set of bounded continuous functions. To
prove that the unique fixed of T satisfies ve (ū (S) , S) = 0, we start by assuming ve (u, S) is

                                                                       46
concave in the first argument and satisfies ve (ū (S) , S) = 0, and we need to show that T ve
satisfies the same properties.
   Because ve (u, S) is concave in its first argument, condition (46) together with the promise
keeping constraint (40) are sufficient for optimality. Under assumption (38), the proposed
policy functions in (44) satisfy the first order condition (46). In addition, the promise
keeping constraint is satisfied by the definition of ū (S) in (12). Therefore, the policy
functions (44) are optimal. Clearly, under the proposed policy functions, T ve (ū (S) , S) = 0.
The fact that T ve (ū (S) , S) must be concave follows from standard argument (see, for
example, Ai and Li (2015)).

   The above lemma has two implications. First, under condition (38), in equilibrium,
a firm cannot earn a positive profit by offering a non-trivial insurance contract to any
unemployed worker. To see this, note that the value function Ve (U, y, S) must be strictly
decreasing in U . Because the utility provided by the unemployment benefit is the lower
bound of the utility that an unemployed worker can achieve, we must have U ≥ ū (s) y
under any non-trivial insurance contract. Therefore, Ve (U, y, S) ≤ 0, i.e. no firm can make
a positive profit by deviating from the trivial insurance contract.
   Second, employer firms cannot offer any severance pay to a worker upon unemployment.
To see this, consider an augmented contract space C ∪ Ce with Ce specifying payments to
worker after separation. From the history at which the worker is unemployed, the firm’s
value under any contract with non-trivial payment to the worker cannot exceed Ve (U, y, S)
defined in (37). An augmented contract with non-trivial severance pay will give unemployed
workers a value higher than the autarky value of consuming the unemployment benefits
ū (S 0 ) y 0 . Thus by the same argument as in the previous paragraph, any such arrangement
will imply Ve (U, y, S) < 0, which violates the firm-side limited commitment.
   Intuitively, it is the joint assumption of two-sided limited commitment and perfect
competition on firm side that rule out unemployment insurance in equilibrium. The income
of unemployed workers are front loaded. In our model, as human capital depreciates, so
does the unemployment benefit. To provide any non-trivial intertemporal consumption
smoothing to unemployed workers, a firm would need to backload its payment. The limited
                         v (ū (S) , S) ≥ 0) implies that firms cannot commit to backloaded
commitment on firm side (e
payments unless they can expect some profit in the future. However, there is no profit to be
made in an insurance contract with an unemployed worker: the worker will need continued
payment as long as he is unemployed; once the worker is employed, limited commitment
on worker side and perfect competition between firms mean that the worker will extract
all surplus in the new match and cannot commit to pay back the unemployment insurance


                                              47
provider. The fact that workers extract all surplus in a new employment contract is the key
feature of our model that rules out equilibrium private unemployment insurance.
       Finally, from a quantitative point of view, condition (38) is a fairly weak assumption
on λ. In an economy without aggregate risk, it is equivalent to λ ≤ 1. In our calibration,
λ = 0.96 at the quarterly level, and (38) is certainty satisfied.


A.2       Insurance provision to other workers

Here we show that the employment contract that we construct in the main text of the paper
is in fact optimal in a larger contracting space where all firms are allowed to offer insurance
to all workers. To do so, we follow several steps. In step 1, we describe a dynamic game in
which firms compete for workers by offering long-term contracts where all firms are allowed
to pay all workers subject to incentive compatibility. In step 2, we describe an equilibrium
strategy in the above game where contracts only involve non-trivial payments from firms
to their employees. In step 3, we show that the proposed contract is optimal in a Subgame
Perfect Nash Equilibrium (SPNE) of the game.
       Step 1: Here, we describe a game where all firms are allowed to offer contracts to all
workers. We first introduce some terminologies and notations. We define {ιi,t }∞
                                                                               t=0 to be
the stochastic process that records the birth, death, and unemployment shocks experienced
by worker i.23 In addition, upon receiving an opportunity to match, a worker randomizes
among all firms that offer the most favorable contract. We use υi,t to denote the outcome
of the randomization device, with υi,t = j if firm j is chosen by worker i in period t.
We use ζi,j (t) = (gt ,ηj,t , εi,t , ιi,t , υi,t ) to denote time t shocks for a firm-worker pair and
ζi,j = g t , ηjt , εti , ιti , υit = {gs , ηj,s , εi,s , ιi,s , υi,s }ts=0 to denote the history of shocks of a firm-
 t

worker pair up to time t.24 Because all workers are endowed with one unit of human capital
                                        t , we can recover h and y for all t using equations
at birth, given the history of shocks, ζi,j                 i,t   i,t

  23
      To keep the convention that {ιi,t }∞  t=0 are exogenous shocks not influenced by agents’ actions, we can
assume that they are i.i.d. random variables uniformly distributed on [0, 1]. If worker i is employed in period
t, the outcome of the match with the employer firm is decribed by I{ιi,t+1 ≤θi,j,t } , where I is the indicator
function. That is, I{ιi,t+1 ≤θi,j,t } = 0 if the worker separates from the current firm and become unemployed
in period t + 1 and I{ιi,t+1 ≤θi,j,t } = 1 if the worker continues the match with his current employer in period
t + 1. Consistent with the setup of our model, the probability of the survival of the match is θi,j,t . Similarly,
for worker i who is unemployed in period t, I{ιi,t+1 ≤1−χ} = 0 if the worker continue to stay unemployed in
period t + 1,and I{ιi,t+1 ≤1−χ} = 1 if the worker receives an employment opportunity to match with a firm
in period t + 1.
   24
      The usage of ζ is consistent with the main text in the sense that it is a vector of aggregate and
idiosyncratic shocks in period t. However, unlike in the main text of the paper, here, worker i and firm j do
not necessarily have an employment relationship. In addition, the shock structure in this more general setup
is richer — for example, it contains unemployment shocks, ιi,t — in order to allow for a larger contracting
space.


                                                         48
                                     t ).
(1) and (2), which we denote as ht (ζi,j
   A contract offered by firm j to worker i nspecifies  the  net  transfers
                                                                          o∞ from the firm to
the worker and the retention effort , Ci,j ≡ Ci,j,t ζi,j , θi,j,t ζi,j
                                                           t            t        , as functions of
                                                                           t=0
the history of shocks.25 Clearly, our setup implies that θi,j,t ζi,j t    = 0 unless worker i is
matched with firm j at history ζi,j . We use C = hCi,j ii,j as the collection of contracts offered
                                t

by all firms to all workers. We suppress the decision for keeping the firm-worker match δi,j,t
and assume from the outset that a firm-worker match is never voluntarily separated. As we
have shown in proposition 1 in the main text of the paper, this is without loss of generality.
      We consider a repeated game in which in each period t, all firms offer longer term
contracts to all workers and denote a contract offered by firm j as hCi,j ii . After all firms
make offers, workers make decisions on which contract(s) to accept. A worker is free to
default on previous contracts at any history. Default on the contract offered by the employer
firm results in a separation of the match and termination of all future cash transfers. Default
on a contract offered by an unrelated firm results in termination of all future cash flows
and nothing else. In addition, a worker who has an employment opportunity can choose
the firm that offers the most attractive employment contract to match. If indifferent, he
randomizes. Finally, firms are free to default on their contract at any point in time. A
default on the firm side results in a separation of the match (if this is a contract with an
employee) and termination of all future cash transfers.
      In a typical period t, given the action of all firms, C , a firm’s payoff is calculated as the
present value of all cash flows generated by contracts with all workers. A worker’s payoff
is the present value of utility that the worker receives under all accepted contracts with all
firms.
      Step 2: Here we construct a SPNE of the game specified above using the optimal
employment contract that we describe in the main text of the paper.                         To decribe an
equilibrium contract, we can without loss of generality focus on contracts that will be
accepted at all times and all histories, because if part of the contract is not accepted at
some history in equilibrium, we can simply rename the contract so that it prescribes zero
transfer between the firm and the worker after that history. As a result, even though firms
are allowed to offer a different contract in every period, in the construction of the SPNE of
the game, we can focus on the case where the same contract (that will be accepted at all
future histories and all times) is offered in every period.
      In every period, firms offer contracts to three different types of workers: workers
employed by them, workers employed by other firms, and unemployed workers. To decribe
 25
      Here, we use the same notation Ci,j as in the main text to denote contracts in a larger space.



                                                      49
an SPNE strategy, we first specify the contract offered to an employee based on the optimal
employment contract we describe in the paper. Given the pricing kernel Λ (S 0 , S) and the
equilibrium value of workers with a job opportunity, yu∗ (S), firms’ value function defined
in (10) is the unique fixed point of the following T operator:
                                                                                                             
                                                               0
                                                                     0 0         g 0 +η 0 +ε0    0
                                                                                                      
                                                                                                           0
                                                                                                             
    T V (U, y, S) = maxC,θ,{U 0 (ζ 0 )} (y − C) + κθ Λ S , S V U ζ , ye                          , S Ω dζ |g
    (                                                                       i1−γ                 1 )
                   1
                                                           h          0  0   0                         1−γ
                1− ψ                          1−γ
                                   θU 0 ζ 0       + (1 − θ) ū S 0 yeg +η +ε          Ω(dζ 0 |g)
                                                                 
s.t. (1 − β) C       +β κ                                                                                  ≥U
                       0   0  0
   U 0 ζ 0 ≥ u S 0 yeg +η +ε
                 
                                                                                                    (47)
                 0  0   0
                              
   V U 0 ζ 0 , yeg +η +ε , S 0 ≥ 0.
            
                                                                                                    (48)

We denote the policy functions associated with the above dynamic programming program
as C (U, y, S) and {U 0 (U, y, S, ζ 0 )}ζ 0 .
    As is standard in the dynamic contracting literature, in any period t, given a
vector of initial state variables, (U, y, S), the continuation contract from period t that
specifies payment to employed workers in all future dates and states can be constructed
recursively from the policy functions of the above dynamic contracting problem.                      We
denote an employment contract with initial condition (U, y, S) as C (U, y, S). To specify
the continuation contract from any history ζi,j    t , we only need a procedure to construct the
                                                   
                              t
initial state variables Ui,t ζi,j           t
                                    , yi,t ζi,j , St g t at that history. The construction of the
                                
                                  t      and St g t are straightforward and are described in the
                                                    
exogenous state variables yi,t ζi,j
main text of the paper. We use the following procedure to construct the promised uitility at
         t . Let ζ τ < ζ t be the closest history that preceeds ζ t such that at ζ τ , the worker
history ζi,j      i,j   i,j                                      i,j            i,j       
has an employment opportunity to match with a firm. Set Ui,τ ζi,j       τ   = u∗ (Sτ ) yτ ζi,j
                                                                                             τ .

                                                τ , we use the history of shocks between ζ τ
Given this initial promised utility at history ζi,j
                                                                                            i,j 
     t                                                                           t           t
and ζi,j and the policy function from (48) to construct the promised utility at ζi,j , Ui,t ζi,j   .
Below is our proposed SPNE strategy.
                                                   
   • Offer the contract C Ui,t ζi,j
                                t           t
                                    , yi,t ζi,j , St g t to worker i if worker i is currently
       an employee.
                                                     
    • Promise to offer C Ui,τ ζi,j
                               τ           τ
                                   , yi,τ ζi,j , Sτ (g τ ) at any future history ζi,j
                                                                                   τ where
                                                                                
      the worker has an employment opportunity, where Ui,τ ζi,j τ   = u∗ (Sτ ) yτ ζi,j
                                                                                    τ .


    • Offer a trivial contract, that is, a contract with zero transfers between the firm and
       the worker at all future contingencies, if worker i is not currently anemployee. Here
       the worker can either be unemployed or employed by another firm.

                                                   50
With a slight abuse of terminology, we will call the above contracts employment contracts.26
       Step 3: Here we provide a formal proof that the above described employment contracts
constitute an SPNE in the game we describe in Step 1. We first summarize our results in
the following lemma.

Lemma. The employment contracts described above is an SPNE.

                               t , a worker can either be employed by a firm, or unemployed
Proof. Because at any history ζi,j
but have an employment opportunity to match with a firm, or unemployed and do not
have an employment opportuntiy in the current period, to establish that the employment
contract is an SPNE, we need to show that given all other firms’ strategy, none of the
following deviations can yield a higher profit for the firm without violating any of the
incentive compatibility constraints:
       1. a different contract to an employed worker,
       2. a different contract to a worker who is employed by another firm,
       3. a different contract to a worker who is previously unemployed but has an employment
opportunity in the current period,
       4. a different contract to an unemployed worker who remains unemployed in the current
period.
       5. a combination of the above.

       First, because the employment contact solves the optimal contracting problem (48),
firms cannot obtain a higher profit by offering a different contract to an employee. Second,
no firm can obtain a higher profit by offering a non-trivial insurance contract to a workers
who is currently working for another firm. We prove this claim by contradiction. Suppose at
 t , a firm has a profitable deviation by offering a nontrivial insurance contract to a worker
ζi,j
who is currently employed by another firm, the policy functions and the associated value
  26
    The notion of employment contract here is the same as the one defined in the main text of the paper but
extended to a larger contracting space that allows the specification of payment between firms and unrelated
workers.




                                                    51
functions for the insurance contract must solve the following optimal contracting problem:
                                                                                          
                                                              0
                                                                    0 0 0 0 0    0
                                                                                          
           Ve (U, y, S) = maxC,
                             e {U
                                e 0 (ζ 0 )}         −C + κ Λ S , S V U ζ , y ζ |S Ω dζ |S
                                                     e             e e
                                              z0
                                                                 1
                 h             i1− 1    h                1 1− ψ
                                    ψ        0  0
                                                  1−γ i 1−γ
subject to (1 − β) C (U, y) + C
                              e       +β E Ue ζ       |S           ≥ U,                            (49)

            e 0 ζ 0 ≥ U 0 U, y, ζ 0 , S 0 ,
                                        
           U                                                                                       (50)
                                  
                 e 0 ζ 0 , y 0 ζ 0 |S 0 ≥ 0.
                        
           Ve U                                                                                    (51)

where C (U, y) and {U 0 (U, y, ζ 0 , S 0 )} are the policy functions of the optimal contracting
problem in (48).    In the objective function of the optimal contracting problem,
(51), C is the net payment from the firm to the unrelated worker. Inequality (49)
      e
is the promise keep constraint.     If the worker accept       the contract, his utility is
                h            i1− 1      h               i 1
                                  ψ                         1−γ
given by (1 − β) C (U, y) + C
                            e        +β E U e 0 (ζ 0 ) |S        , where the current period
consumption includes the payment from the current employer, C (U, y) as well as the tranfer
from the unrelated firm, C.
                         e Equation (50) is the limited commitment constraint for the
worker. Because the worker can always default on the contract offered by the unrelated firm
and obtain the utility under the employment contract U 0 (U, y, ζ 0 , S 0 ), in order to prevent
the worker from default, the promised utility for the next period, U  e 0 (ζ 0 ), must be at least
as high as what the worker can obtain under the employment contract, U 0 (U, y, ζ 0 , S 0 ).
Inequality (51) in the firm-side limited commitment constraint.
    Because the insurance contract is a profitable deviation, we must have Ve (U, y, S) >
0. To arrive at a contradiction, we define       n    C̆ (U, y, S)
                                                                h = C (U, y,io     S) + C
                                                                                        e (U, y, S) and
Ŭ (U, y, S, ζ 0 ) = U
                     e (U, y, S, ζ 0 ). Note that C̆ (U, y, S) , Ŭ (U, y, S, ζ 0 ) is a feasible policy
for (48) with V̆ (U, y, S) = V (U, y, S) + Ve (U, y, S) as the value function. However,
V̆ (U, y, S) > V (U, y, S), which contracts V (U, y, S) being the optimal solution to (48).
    Third, given that all firms offer the optimal contract that provides the highest utility to
workers when worker obtains an employment opportunity, no firm can make a higher profit
by deviating from this strategy.
    Fourth, as we show in lemma 1, firms cannot make a positive profit by offering a non-
trivial insurance contract to unemployed workers.
    Finally, combining all of the above arguments, it is clear that a combinations of
deviations will not be profitable either.




                                                       52
B       Proof for propositions 1, 2, and 3

B.1     Characterization of equilibrium

In this section, to prepare for the proofs for propositions 1, 2, and 3, we provide a set
of necessary and sufficient conditions that characterize the equilibrium. We first state a
lemma that establishes that the equality constraint (17) can be replaced by an inequality
constraint so that the optimal contracting problem P1 is a standard convex programming
problem.
Lemma 2. Suppose A0 (θ), A00 (θ), and A000 (θ) > 0 for all θ ∈ (0, 1). The policy functions
for the optimal contracting problem P1 in the main text can be constructed from the solution
to the a convex programming problem described below
                                              (                                                                )
                                                                    1 − c − A (θ) +
 v (u, S) =             max                                    0   0   0                                          (52)
                                          Λ (S 0 , S) eg +η +ε [δ 0 (ζ 0 ) v (u0 (ζ 0 ) , S 0 )] Ω(dζ 0 |g),
              c,θ,{u0 (ζ 0 ),δ 0 (ζ 0 )}ζ 0       κθ
                                          h                1             1
                                                                           i 11
                                                       1− ψ         1− ψ     1−
                              s.t : u ≤ (1 − β) c            + βm               ψ ,                                (53)

                                δ 0 ζ 0 v u0 ζ 0 , S 0 ≥ 0, f or all ζ 0 ,
                                                     
                                                                                                                   (54)
                             δ 0 ζ 0 u0 (ζ 0 ) − λu S 0 ≥ 0, f or all ζ 0 ,
                                                       
                                                                                                                   (55)
                               
                                             0 0 0
                     A (θ) ≤ κ Λ S 0 , S eg +η +ε δ 0 ζ 0 v u0 ζ 0 , S 0 Ω(dζ 0 |g),
                      0
                                                                                
                                                                                                                   (56)

where
                                                                             1
                             h                                    i           1−γ
        (1−γ)(g 0 +η 0 +ε0 )     0 0
                                      0 0 1−γ         0 0
                                                              0 1−γ     0
  m= κ e                       θδ ζ u ζ         + 1 − θδ ζ λu S       Ω(dζ |g)     .
                                                                                                                   (57)

Proof. We label the above-stated maximization problem as P2. The assumption that A0 (θ)
is strictly convex means that (53)–(56) describe a convex set with a nonempty interior and
the objective function (52) is concave. Thus, problem P2 is a convex programming problem.
Suppose the stochastic discount factor and the law of motion of the aggregate state variables
jointly satisfy the following condition:

Assumption 6. For some  > 0, and for all (S),
                                              X                      0
                                                   π g 0 g Λ S 0 , S eg < 1 − .
                                                          
                                                                                                                   (58)


    Given assumption 6, standard arguments from Stokey et. al (1989) imply that there is
a unique v in the space of bounded continuous functions that satisfies (52). In addition,

                                                              53
v is continuous, strictly decreasing, strictly concave and differentiable in the interior. We
denote the optimal policy functions for P2 by
                       n                                                            o
                        c (u, S) , θ (u, S) , δ 0 u, S, ζ 0 , u0 u, S, ζ 0
                                                                         
                                                                               ζ0
                                                                                        .          (59)

We first show that policy function for separations satisfies δ 0 (u, S, ζ 0 ) = 1 for all ζ 0 .
                                                                                           
  Suppose there exists some (u, S) such that with strictly positive probability, δ 0 ζ̃ 0 = 0.
Consider an alternative set of policy functions denoted by hats:

                                          ĉ (u, S) = c(u, S)

                                             θ̂ (u, S) = θ(u, S)

                                      δ̂ 0 u, S, ζ 0 = 1 f or all ζ 0
                                                    


          û0 u, S, ζ 0 = I{δ0 (u,S,ζ 0 )=1} × u u, S, ζ 0 + I{δ0 (u,S,ζ 0 )=0} × λu S 0 + 
                                                                                          


for some  > 0 such that
                                       λu S 0 +  < u∗ S 0
                                                          


where u∗ (S)
           issuch that v (u
                               ∗
                               (S) , S) = 0. Because the value function is strictly decreasing,
we have v û0 u, S, ζ̃ 0 , S 0 > 0 for ζ̃ 0 where δ 0 ζ̃ 0 = 0 Then it is easy to verify that see
that the hat policy functions satisfy (53)–(56) and achieve a higher value for the objective
in equation (52) and therefore cannot be optimal. Thus,

                                    δ 0 u, S, ζ 0 = 1 f or all ζ 0
                                                 
                                                                                                   (60)


   We next show that optimal choices for P2 are feasible for problem P1. Optimal policies
for P2 satisfy a set of first-order necessary conditions. In particular, let ι ≥ 0 be the
Lagrange multiplier of the constraint (56), first-order conditions with respect to θ after
imposing (60) implies
                                      
                 β   1
                        γ− 1  1                   0  0
                                                       n       1−γ           1−γ o
   ιA00 (θ) =       cψ m ψ                e(1−γ)(η +ε ) u0 ζ 0      − λū S 0        Ω(dζ 0 |g).   (61)
                1−β          1−γ

The limited commitment constraint on worker side, equation (55) along with (60) implies
that right-hand side of (61) must be strictly positive. Therefore, ι > 0 and (56) must holds
with equality at the optimum.
   Let ιu be the Lagrange multiplier of the promise keeping constraint (53), the first-order




                                                   54
condition with respect to c implies

                                                     1  c  ψ1
                                             ιu =               > 0.                                                             (62)
                                                    1−β u

Thus, inequality (53) must also hold with equality at the optimum. As a result, the optimal
policy for P2 satisfy all of the constraints for P1 and as the constraint set for P2 larger,
the optimal policies to P2 also attain the maximum for P1.

   The first-order necessary conditions for P2 imply that the above policy functions must
satisfy

   1. ∀η 0 + ε0 ∈ [ε(u, S, g 0 ), ε̄(u, S, g 0 )], u0 (u, S, ζ 0 ) satisfy
                                                                    1                1
                          βe−γ(g +η +ε ) c (u0 (u, S, ζ 0 ) , S 0 ) − ψ u0 (u, S, ζ 0 ) ψ −γ
                                0   0  0 
                       0
                            
                 Λ S ,S =                                                                    .                                   (63)
                            1 + ι(u,S)   θ(u,S)
                                                c (u, S)                 m (u, S)


   2. ∀η 0 + ε0 ≥ ε̄ (u, S, g 0 ),
                                               u0 u, S, ζ 0 = λū S 0 ;
                                                                    
                                                                                                                                 (64)

      and ∀η 0 + ε0 ≤ ε (u, S, g 0 ),
                                                  u0 u, S, ζ 0 = u∗ S 0 ,
                                                                      
                                                                                                                                 (65)

      where u∗ (S 0 ) satisfies that v (u∗ (S) , S) = 0 for all S.

   3. The Lagrange multiplier ι(u, S) satisfies

                                         1         β                          1
                     ι(u, S) = 00                      c (u, S) m (u, S) ×
                                 A (θ (u, S)) 1 − β                        1−γ
                                             n                                        
                               (1−γ)(η 0 +ε0 )   0        0 1−γ
                                                                         o
                                                                        0 1−γ       0
                                                                                      
                      ×      e                  u u, S, ζ       − λū S         Ω dζ g .                                         (66)

      The policy functions must satisfy the equality constraints of the problem P1
                                              
                            0
                                                              0 0 0
                                                    Λ S 0 , S eg +η +ε v u0 s0 , S 0 Ω ζ 0 ,
                                                                                        
                           A (θ (u, S)) = κ                                                                                      (67)

                                                                                          1
                                                          1                     1
                                         h                                          i
                                                       1− ψ                  1− ψ       1− 1
                                     u = (1 − β) c            + βm (u, S)                   ψ   ,                                (68)

      where
                     (                        "                                                    #                  )    1

                          (1−γ)(g 0 +η 0 +ε0 )             θ (u, S) u0 (u, S, ζ 0 )1−γ                                     1−γ

                                                                                                        Ω dζ 0 g
                                                                                                                   
           m (u, S) = κ e                                                                                                        .
                                                         +(1 − θ (u, S))λu (S 0 )1−γ

                                                         55
      The following lemma states that conditions (63) - (68) are both necessary and sufficient
      for optimality.

Lemma 3. Suppose there exist an SDF Λ (S 0 , S), a worker’s value from unemployment,
ū (S), and a law motion for aggregate state variables that satisfy assumption 6. Suppose
that given Λ (S 0 , S), ū (S), and the law of motion for state variables, policy functions for
problem P2 satisfy (60), the optimality conditions (63)-(66), and the equality constraints
                              c(u,S)
(67)-(68). In addition,         u      is nondecreasing in u for all S. Let v (u, S) be the unique
fixed point of the operator T :

                                               1 − c (u, S) − A(θ (u, S))+
           T v (u, S) =                                0   0   0                                                    (69)
                            κθ (u, S) Λ (S 0 , S) eg +η +ε v (u0 (u, S, ζ 0 ) , S 0 ) Ω ( dζ 0 | g) .

Then, the policy functions together with the value function v (u, S) solve the problem P2.

Proof. Suppose there exists a set of policy functions that satisfy conditions (63)-(68). Given
condition (6), the operator defined in (69) is a contraction, and we can construct the value
function v (u, S) from the policy functions as the unique fixed point of (69). The first-order
conditions (63)-(65) imply that the value function constructed above must satisfy
                                                                              1
                                  ∂                1                c (u, S)    ψ
                                     v (u, S) = −                                   .                                (70)
                                  ∂u              1−β                  u

          c(u,S)                              ∂
Because     u      is nondecreasing in u,     ∂u v (u, S)   must be nonincreasing, that is, v (u, S) is a
concave function of u. As a result, given v (u, S), the first-order conditions, (63)-(68) can
be shown to be equivalent to the set of first-order conditions for the programming problem
P2, which is necessary and sufficient for optimality. Therefore, the above constructed
value functions and policy functions must solve the optimal contracting problem P2, as
needed.

Given the above discussion, it is straightforward to provide a characterization for the
equilibrium price and quantities using optimality conditions.                               We summarize these
conditions in the following lemma. The proof is omitted as it follows directly from lemma
2 and lemma 3.

Lemma 4. The equilibrium prices and quantities can be summarized as:

i) a set of policy functions,

      x (S) , c (u, S) , θ (u, S) , ι(u, S), ε̄(u, S, g 0 ), ε(u, S, g 0 )          , δ u, S, ζ 0 , u0 u, S, ζ 0
                                                                                                              
                                                                               g0                                    ζ0
                                                                                                                          ,


                                                       56
ii) worker’ outside option ū (S) and initial utility at employment u∗ (S),

iii) a law of motion of φ and B,

iv) a SDF and a firm value function v (u, S), such that

  1. the SDF is consistent with capital owner’s consumption, that is, Λ (S 0 , S) and x (S)
        satisfy equation (19), where the capital owner’s utility, w (S) is constructed from x (S)
        using equation (18),

  2. the value function and policy functions satisfy (60), and the optimality conditions
        (63)-(68),

  3. the outside option ū (S) satisfies (12), u∗ (S) satisfies v (u∗ (S) , S) = 0 for all S, and

  4. the law of motion of the aggregate state variables satisfy (22) and (24).

   We now prove proposition 1 and 2.


B.2      Proofs of propositions 1 2

In lemma 2, we have already proved that δ (u, S, ζ 0 ) = 1 for all ζ 0 is optimal for problem P2
and lemma (4) asserts that the same policy rule is optimal for problem P1 too.
   We next provide the characterization for the policy functions u0 (u, S, ζ 0 ) and then
θ (u, S). Given assumption 6 and lemma 2, standard arguments from Stokey et. al (1989)
imply that the value function v for the optimal contracting problem (13) is continuous,
strictly decreasing, strictly concave and differentiable in the interior. Because the value
function is strictly decreasing, the limited commitment constraint (15) can be written as
u0 (s0 ) ≤ u∗ (S 0 ) for all s0 , where u∗ (S) is defined by equation (11). Therefore, the first-
order condition with respect to continuation utility and the envenlope condition for the
programming problem (52) together imply that one of the following three cases have to
true:

  1. In the interior, equation (30) holds.

  2. The worker-side limited commitment constraint binds, u0 (u, S, ζ 0 ) = λū (S 0 ), and,
                                         − 1    1 −γ 
                              x (S 0 )            w (S 0 )
                                                                        
                                           ψ       ψ            ι (u, S)
                                                           1+
                              x (S)               n (S)         θ (u, S)
                                          0         0    0
                                                                  1              1
                                                              0 − ψ u0 (u, S, ζ 0 ) ψ −γ
                          −γ(η 0 +ε0 ) c (u (u, S, ζ ) , φ , B )
                      ≥ e                                                                ,   (71)
                                              c (u, S)                   m (u, S)

                                                             57
     3. The firm-side limited commitment costraint binds, u0 (s0 ) = u∗ (S 0 ),
                                                      − 1  1 −γ 
                                           x (S 0 )            w (S 0 )
                                                                                   
                                                          ψ   ψ            ι (u, S)
                                                                      1+
                                           x (S)               n (S)       θ (u, S)
                                                     0         0    0
                                                                             1              1
                                                                         0 − ψ u0 (u, S, ζ 0 ) ψ −γ
                                     −γ(η 0 +ε0 ) c (u (u, S, ζ ) , φ , B )
                                 ≤ e                                                                .                      (72)
                                                         c (u, S)                   m (u, S)

Define E = {η 0 + ε0 : equation (30) holds}. Also, let

                                           ε u, S, g 0 = inf E, ε u, S, g 0 = sup E.
                                                                          
                                                                                                                           (73)

Let lu (u, S) be the Lagrange multiplier for the promise-keeping constraint of the programing
problem (52), then
                                                                                                      1
                                      ∂                          1                          c (u, S)    ψ
                                         v (u, S) = lu (u, S) =                                             ,              (74)
                                      ∂u                        1−β                            u

where the first equality is the envelope theorem, and the second equality is the first-
order condition, (62). Because v is concave, the above condition implies that c (u, S)
must be strictly increasing in u. Thereore, the optimality condition (30) implies that on
E, u0 (u, S, ζ 0 ) must be strictly decreasing in η 0 + ε0 . Clearly, the strict monotonicity of
u0 (u, S, ζ 0 ) implies that u0 (u, S, ζ 0 ) = λū (S 0 ) if η 0 + ε0 = ε (u, S, g 0 ) and u0 (u, S, ζ 0 ) = u∗ (S 0 )
if η 0 + ε0 = ε (u, S, g 0 ).
     First, ∀η 0 + ε0 > ε (u, S, g 0 ), we must have u0 (u, S, ζ 0 ) = λū (S 0 ). Otherwise, none of
the equations, (30), (71), or (72) can hold. Similarly, ∀η 0 + ε0 < ε (u, S, g 0 ), we must have
u0 (u, S, ζ 0 ) = u∗ (S 0 ).
     Second, to complete the proof of part 1 and 2 of proposition 2, we need to show
that ∀η 0 + ε0 ∈ (ε (u, S, g 0 ) , ε (u, S, g 0 )), condition (30) must hold.                                   It is enough to
show      u0 (u, S, ζ 0 )    ∈    (λū (S 0 ) ,       u∗ (S 0 )).     This can be proved by contradiction. Suppose
η0   +   ε0   ∈   (ε (u, S, g 0 ) ,   ε (u, S, g 0 ))      and      u0 (u, S, ζ 0 )   = λū (S 0 ), then the fact that equation
(30) holds at ε (u, S, g 0 ) implies that (note that η 0 + ε0 < ε (u, S, g 0 ))
                                                      − 1   1 −γ 
                                           x (S 0 )            w (S 0 )
                                                                                  
                                                          ψ    ψ          ι (u, S)
                                                                      1+
                                           x (S)               n (S)      θ (u, S)
                                                                          1            1
                                                           0     0   0 −ψ     λū (S 0 ) ψ −γ
                                                                       
                                     −γ(η 0 +ε0 ) c (λū (S ) , φ , B )
                                 < e                                                          ,
                                                        c (u, S)              m (u, S)

which is a contradiction to condition (71). Similarly, one can show that u0 (u, S, ζ 0 ) = u∗ (S 0 )
cannot be true either.


                                                                          58
   To prove the second part of proposition 1, note that because the value function is
strictly concave in u, the Lagrange multiplier ιu (u, S) must be strictly increasing in u.
The first-order condition with respect to u0 (u, S, ζ 0 ) in the programming problem (52) then
implies that u0 (u, S, ζ 0 ) must be strictly increasing in u as well. Given constraint (17),
the monotonicity of θ (u, S) with respect to u then follows directly from the u0 (u, S, ζ 0 ) is
increasing with respect to u and the fact that v (u0 , S 0 ) is strictly decreasing in u0 .


B.3    Proof of proposition 3

Proposition 3 follows directly from the lemma below, which provides the details for the
construction of the equilibrium in the stochastic economy from a given equilibrium of the
deterministic economy with a modified discount rate.

Lemma 5. Suppose gt is i.i.d. over time and f ( ·| g) does not depend on g. Suppose there
exists an equilibrium in the equivalent deterministic economy with modified discount rate.
An equilibrium of the stochastic economy can be constructed as follows.

i) The SDF is given by equation (31) in proposition 3.

ii) Workers’ value from unemployment and the value of a new job are given by:

                                         b̄ (φ, B) , u∗ (S) = u
                                ū (S) = u                    b∗ (φ, B) ,

      respectively, where u             b∗ (φ, B) are the corresponding equilibrium quantities
                          b̄ (φ, B) and u
      in the equivalent deterministic economy with a modified discount rate.

iii) The consumption share of capital owners is

                                            x (S) = x̂ (φ, B) ,

      where x̂ (φ, B) is the capital owner’s consumption share in the equivalent deterministic
      economy with a modified discount rate.

iv) The value function and policy functions of the optimal contracting problem are given by

                       v (u, S) = v̂ (u, φ, B) , c (u, S) = ĉ (u, φ, B) ,
                       θ (u, S) = θ̂ (u, φ, B) , u0 u, S, g 0 , ε0 = û0 u, φ, B, ε0 .
                                                                                   


v) The law of motion for aggregate state variables (φ, B) is the same as that in the equivalent
      deterministic economy with a modified discount rate.


                                                 59
Proof. To prove that the proposed allocations and prices constitutes an equilibrium, we use
lemma 4 to verify the equilibrium conditions. First, we show that the proposed stochastic
discount factor is consistent with capital owners’ consumption and utility process. Given
capital owner’s consumption and utility in the stochastic economy, using equation (19),
                                                                                                         1 −γ
                                                           1                                                ψ
                                            x̂ (φ0 , B 0 ) − ψ                  w (φ0 , B 0 )
                                        
               0                −γg 0
                    
          Λ S , S = βe                                           
                                                                                                   1
                                                                                                         
                                            x̂ (φ, B)                 E e(1−γ)g0 ŵ1−γ (φ0 , B 0 ) 1−γ
                                                                       


The utility w (φ0 , B 0 ) is deterministic and the above can be written as
                                                                         1
                           
                               x̂ (φ0 , B 0 )
                                                − 1  h
                                                   ψ               i γ− ψ                      1
                                                                                  x̂ (φ0 , B 0 ) − ψ    e−γg
                                                                                                             0
                   −γg 0                                         0
   Λ S 0 , S = βe
                                                         (1−γ)g      1−γ
                                                      E e                  = β̂                                 .
                                                                                                     E e(1−γ)g0
                                                                                                      
                                x̂ (φ, B)                                          x̂ (φ, B)
                                                                                                                 (75)
Given the consumption policy in the deterministic economy, the SDF in the deterministic
economy reduces to a risk-free discount rate R (φ, B) with
                                                                           1
                                                             x (φ0 , B 0 ) − ψ
                                                           
                                                1
                                                      = β̂                     .                                  (76)
                                             R (φ, B)        x (φ, B)

Combing equations (75) and (76), it is clear that the SDF defined in (31) is consistent with
capital owners’ consumption in the stochastic economy.
   Next, we show that the proposed value function and policy functions also solve the
optimal contracting problem in the stochastic economy. It is enough to show that the
value function of the deterministic economy is also a fixed point of the Bellman operator
implied by the optimal contracting problem P1. Given that the two economies have the
                                                                       1
                                                     h        0
                                                                 i 1− ψ
                                                                    1−γ
same workers’ outside options ū (S) and that β̂ = β E e(1−γ)g           , it is easy to see that
constraints (14), (15), and (16) are identical in both economies. Given v (u, φ, B) the term
                               
                                              0 0 0
                                    Λ S 0 , S eg +η +ε v u0 s0 , S 0 Ω dζ 0 g
                                                                            


can be written as
                                          0
             1     X
                          0          e−γg          0  0   0
                                                eg +ε +η v u0 ε0 , η 0 , φ0 , B 0 f ε0 + η 0 dε0 dη 0
                                                                                          
                      π g                   0
          R (φ, B)             E e(1−γ)g
                    E e(1−γ)g0
                        h        i
             1                        0  0
                                  eε +η v u0 ε0 , η 0 , φ0 , B 0 f ε0 + η 0 dε0 dη 0
                                                                             
      =                       0
          R (φ, B)   E e(1−γ)g
                   
             1         0  0
                     eε +η v u0 ε0 , η 0 , φ0 , B 0 f ε0 + η 0 dε0 dη 0 ,
                                                             
      =
          R (φ, B)


                                                                 60
which is identical to that in the deterministic economy. Therefore, v (u, S) = v̂ (u, φ, B) is
also the value function of the optimal contracting problem in the stochastic economy.
    Finally, conditions 3 and 4 in lemma 4 also hold, because these requirements are identical
in the deterministic economy and the stochastic economy. This completes the proof.


C      Proofs of propositions 4 and 5

C.1     Equilibrium in the simple economy

In this section, we start with deriving explicit expressions for several equilibrium objects to
prepare for the proofs of propositions 4 and 5. We first introduce some notation.


Notation       In the simple model in Section 4, we assume that the worker-specific shock
follows a negative exponential distribution.                  The density of a negative exponential
distribution with parameter ξ takes the following form:

                                                        0          ε > εM AX
                                 f ( ε| gL ) =                                                           (77)
                                                   ξeξ(ε−εM AX )   ε ≤ εM AX .

For later reference, we note that the moments of f ( ε| gL ) can be easily computed as
                      ε
                                                   ξ −ξεM AX +(θ+ξ)ε
                           eθt f ( t| gL ) dt =       e              f or ξ + θ > 0.                     (78)
                     −∞                           ξ+θ

Equation (78) shows that the assumption E [eε ] = 1 amounts to a parameter restriction
that εM AX = ln 1+ξ
                 ξ .

    In the simple economy illustrated in figure 1, we let xH ≡ x (gH ) and xL ≡ x (gL )
denote capital owners’ consumption share and wH ≡ w (gH ) and wL ≡ w (gL ) denote their
normalized utility at node H and L, respectively.
    In solving the optimal contracting problem, it is more convenient to represent policy
functions and value functions as functions of the period-0 promised utility u0 . For an
arbitrary u0 , we use uH (u0 ) ≡ u0 (u0 , gH ), and uL (u0 , ε0 ) ≡ u0 (u0 , gL , ε0 ) to denote the
normalized promised utility for a worker with initial promised utility u0 at nodes H and L,
respectively. We use c0 (u0 ), cH (u0 ) ≡ c (uH (u0 ) , gH ), and cL (u0 , ε0 ) = c (uL (u0 , ε0 ) , gL )
for workers’ consumption policy at nodes 0, H, and L, respectively. Similarly, vH (u0 ) ≡
v (uH (u0 ) , gH ), vL (u0 , ε0 ) ≡ v (uL (u0 , ε0 ) , gL ), θH (u0 ) ≡ θ (uH (u0 ) , gH ) and θL (u0 , ε0 ) ≡
θ (uL (u0 , ε0 ) , gL ) are value functions and policy functions at note H and L, respectively.


                                                         61
We also denote εL (u0 ) ≡ ε (u0 , gL ) as the lowest level of realization of the ε0 shock such
that the limited commitment constraint does not bind at node L.
   In addition, let uFHB and uFL B denote the utility-to-consumption ratio of an agent who
consumes the aggregate consumption in state gH and gL , respectively. That is, they are the
normalized utility associated with full risk sharing. The first best levels, uFHB and uFL B are
determined by
                                                β                            β
                             uFHB = egH uFHB           uFL B = egL uFL B           .

Also, we use uCD
              L  to denote the normalized utility of an agent in an economy without risk
sharing. That is, it is utility-consumption ratio of an agent who consumes yt every period:
                                   h                    i1−γ                β
                                            0                                 1−γ
                       uCD
                        L     =          e{ε +gL } uCD
                                                    L
                                                                    0
                                                                 f (ε |gL )dε     .                           (79)


It is straightforward to show that as γ → 1 + ξ, uCD
                                                  L → 0. We solve the general equilibrium
in the simple economy by backward induction. We first solve the value functions and
policy functions at nodes H and L in period 1. In the second step, we analyze the optimal
contracting problem in period 0 for an arbitrary promised utility u0 . Finally, we impose
market clearing to solve for the equilibrium stochastic discount factor.


Value functions at nodes H and L                     The following lemma characterizes the value
functions at nodes H and L in period 1.

Lemma 6. (Value function in period 1)
   The firm’s value function at nodes H and L are give by
                                                                       
                                            β                    βxH
             v (u, gH ) = 1 − c (u, gH ) +     xH − a ln 1 +               , and                              (80)
                                           1−β                a (1 − β)
                                                                      
                                            β                   βxL
            vL (u, gL ) = 1 − c (u, gL ) +     xL − a ln 1 +             ,                                    (81)
                                           1−β               a (1 − β)

respectively, where the consumption policies are given by
                                       β
                                   − 1−β       1                                              β
                                                                                           − 1−β      1
          c (u, gH ) = αegH uFHB            u 1−β , c (u, gL ) = αΥegL uCD                          u 1−β ,

and the effort choices are

                                            a                                a
                        θH = 1 −            β
                                                     , θL = 1 −               β
                                                                                       .                      (82)
                                    a+     1−β xH                       a+   1−β xL

Proof. Here, we only provide details for the deviation of the value function at node H.

                                                     62
The value function at node L can be computed in the same way. At node H, the optimal
contracting problem is written as
                                                                           
                                                         1 gH
                                                           e v2,H u0
                                                                     
                    v (u, gH ) = max0 1 − c − A (θ) + θ                                      (83)
                                 c,θ,u                  RH
                                                             β
                                subject to : u = c1−β
                                                      egH u0
                                          u0 = αuFHB
                                         v2,H u0 ≥ 0
                                                

                                             1 gH
                                  A0 (θ) =     e v2,H u0
                                                         
                                            RH

where we use v2,H (u0 ) for the value function in period 2. Because there is no aggregate
uncertainty in period 2, we replace the stochastic discount factor by a risk-free discount rate,
 1
RH .   The absence of idiosyncratic shocks and the fact that workers consume α fraction of
their output imply that workers’ utility is α times the utility of a representative consumer,
that is u0 = αuFHB . Note also, because the firm always receive 1 − α fraction of yt after
period 2, the limited commitment constraint v2,H (u0 ) ≥ 0 does not bind.
     To derive a close-form solution for vH (u), we first note that v2,H (u0 ) =     1−α
                                                                                     1−β .   From
period 2 and on, capital owner’s consumption and firms’ cash flow are both proportional
to aggregate output. Under the assumption of unit elasticity, the price-to-dividend ratio of
                          1
the firm’s cash flow is 1−β . Because    the firm receive 1 − α fraction of yt , the ratio of firm
value normalized by   yt is 1−α
                            1−β .

    Second, because capital owner’s consumption share is xH in period 1 and 1 − α in period
                                 h         i−1
2, the discount factor is R1H = β 1−α
                                   xH e gH     . Therefore, the value function can be written
as
                                                           β
                             vH (u) = 1 − c − A (θ) + θ       xH .                           (84)
                                                          1−β
The consumption policy can be backed out from the promise-keeping constraint u =
c1−β (egH u0 )β . In addition, given then functional form of A (θ), the optimal effort θ can
                                                       β
be solved from the incentive constraint, A0 (θ) =     1−β xH ,   which gives (82). Replacing θ in
(84) with the optimal policy, we obtain the representation of the value function in (80).




                                                63
    The optimal contracting problem at node L has a similar structure:
                                                          ∞                                              
                                                     1              0
                                                              egL +ε v2,L u0 ε0 f ε0 gL dε0
                                                                                     
           v (u, gL ) = max       1 − c − A (θ) + θ
                            0  0
                       c,θ,u (ε )                   RL −∞
                                            ∞ h                                  β
                                       1−β           gL +ε0 0  0
                                                                 i1−γ     0
                                                                                0 1−γ
                    subject to : u = c             e       u ε         f ε gL dε
                                                             −∞
                                                              0 0
                                                u ε = αuCD
                                                                  
                                                             L
                                                     0  0
                                                          
                                               v2,L u ε ≥ 0
                                                
                                   0       1 gL ∞
                                                    v2,L u0 ε0 f ε0 gL dε0 .
                                                                    
                                  A (θ) =    e
                                          RL     −∞


The above problem can be greatly simplified by noting that v2,L (u0 (ε0 )) =                               1−α
                                                                                                           1−β   and
u0 (ε0 )   =   αuCD
                 L      do not depend on             ε0 .   Also, we define

                                                      ∞                                        1
                                                                                                 1−γ
                                                                 (1−γ)ε0         0       0
                                                                                     
                                            Υ=               e             f ε gL dε                   ,         (85)
                                                      −∞

                                                                        1
                   ∞ h
                                   i1−γ                           
                            0                                          1−γ
so that            −∞     eε u0 (ε0 )        f   ( ε0 | gL ) dε0             = αuCD
                                                                                 L Υ. The rest of the proof can be

completed by following the same steps in the solution of (83).

    At node L, limited commitment on firm side requires that vL (u) ≥ 0. Therefore, by
equation (81), the maximum amount of consumption that the firm can promise to deliver
                                           β
to a worker at node L is 1 − A (θL ) + θL 1−β xL , which we will denote as cM
                                                                            L
                                                                              AX . Recall that

for a worker with initial promised utility u0 , εL (u0 ) is the lowest level of realization of the
ε0 shock such that the limited commmitment constraint does not bind at node L. We must
have, for all u0 ,
                                                                                             
                                                                   β                   βxL
                             cL (u0 , εL (u0 )) = 1 +                 xL − a ln 1 +             .                (86)
                                                                  1−β               a (1 − β)

We now turn to the optimal contracting problem as node 0.


Optimal contracting at node 0 We first prove the following lemma that uses the
optimal risk sharing condition (30) to relate the marginal rate of substitution of a marginal
worker whose limited commitment constraint is just about to bind to that of the capital
owners.

Lemma 7. (FOC for the marginal agent)
    Given the consumption share of the capital owners, xH and xL , for all u0 , the normalized

                                                                        64
consumption of the marginal worker with ε1 =εL (u0 ) must satisfy:
                                                              FB         τ
                                          cH (u0 )            uL k (θH )       xH
                               (1+τ )ε  (u )                    CD
                                                                             =    ,                            (87)
                              e        L 0 cL (u0 , ε (u0 ))
                                                     L        ΥuL k (θL )      xL

where we denote
                                                                  1
                                         k (θ) = θ + (1 − θ) λ1−γ 1−γ ,
                                                
                                                                                                               (88)
        β(γ−1)
τ=   1+(1−β)(γ−1) ,       and Υ is defined in (85).

Proof. By proposition 2, the optimal risk sharing condition (30) must hold with equality
for the marginal worker with the realization of εL (u0 ) at node L. Comparing the optimal
risk-sharing conditions for consumption at node H and at L, we have
                                     −1                               1−γ         −1         1−γ
                 cH (u0 )                             uH (u0 )                    xH           wH
          ε (u )                               ε (u )
                                                                                =                          .   (89)
         e L 0 cL (u0 , εL (u0 ))             e L 0 uL (u0 , εL (u0 ))            xL           wL

We can use the promise-keeping constraint to represent continuation utilities as functions
of consumption. For capital owners,

                              wH    = x1−β β                      gH F B
                                       H nH , where nH = (1 − α) e uH ,

                              wL = x1−β β                      gL F B
                                    L nL , where nL = (1 − α) e uL ,                                           (90)

where the computation of continuation utility nH and nL uses the fact that capital owners
are not exposed to idiosyncratic risks and that together they consume 1 − α fraction
of aggregate output. Because workers are not exposed to idiosyncratic risks at node H
and consume α fraction of aggregate output, their continuation utility at node H can be
computed using

                        uH (u0 ) = [cH (u0 )]1−β mβH , where mH = αuFHB egH k (θH ) ,                          (91)

where k (θ) is defined in (88). At node L, workers consume αyt for t = 2, 3, . . .. In period 2,
following node L, a worker stays employed with probability θL , in which case his output is
                0
y2 = y1 egL +ε . With probability 1 − θL , a worker loses 1 − λ fraction of human capital and
                                     0
his output is y2 = λy1 egL +ε . Therefore, the certainty equivalent for a worker at node L is
                            ∞                                                      1
                                   h 0 0
                                      g +ε      CD               CD
                                                                    i1−γ    0
                                                                                 0 1−γ
           mL =                     e      θL αuL + (1 − θL ) λαuL        f ε gL dε
                           −∞
                    =    αΥuCD gL
                            L e k (θL ) ,                                                                      (92)

where we define Υ ∈ (0, 1) as in (85). Therefore, the normalized utility of the marginal

                                                          65
agent at node L can be written as

     uL (u0 , εL (u0 )) = [cL (u0 , εL (u0 ))]1−β mβL , where mL = αΥuCD gL
                                                                      L e k (θL ) .                         (93)


   Now we use expressions in (90) and (93) to replace the continuation utilities in (89) and
simplify to get
                                                     −Ω                       −β(1−γ)          −Ω
                                                              ΥuCD
                                                                                           
                                 cH (u0 )                       L k (θL )                    xH
                                                                                           =            ,   (94)
                    e[1+τ ]εL (u0 ) c (u , ε (u ))
                                     L  0   L  0              uL B k (θH )
                                                               F                             xL

where to simplify notation, we denote

                                                                                   β (γ − 1)
                              Ω ≡ 1 + (1 − β) (γ − 1) > 0, and τ ≡                           .              (95)
                                                                                       Ω

We can therefore obtain (87) by raising both sides of equation (89) to their − Ω1 th power.

   Next, we provide a lemma that links the consumption of a marginal worker to the
expected consumption of an average worker at node L.

Lemma 8. (Expected worker consumption at node L)
   Given the consumption share of the capital owners, xH and xL , the expected consumption
of a worker with promised utility u0 at node L is given by:
                           h 0           i
                          E eε cL u0 , ε0 = e(1+τ )εL (u0 ) cL (u0 , εL (u0 )) Φ (εL (u0 )) ,               (96)

for all u0 , where the function Φ (ε) is defined as

                                      ξ                 ξ (1 + τ )
                           Φ (ε) =       e−τ εM AX −                  e−ξεM AX +(ξ−τ )ε .                   (97)
                                     ξ−τ             (1 + ξ) (ξ − τ )

Proof. Note that ∀ε0 ≤ εL (u0 ), the limited commitment constraint binds, and cL (u0 , ε0 ) =
cL (u0 , εL (u0 )). Therefore, the expected consumption of a worker with promised utility u0
at node L can be computed as
        εL (u0 )                                                    εM AX
                     ε0                         0        0                      0
                                                                              eε cL u0 , ε0 f ε0 gL dε0 .
                                                                                                 
                    e cL (u0 , εL (u0 )) f ε gL dε +                                                        (98)
      −∞                                                          εL (u0 )


To compute cL (u0 , ε0 ), note that the first order condition (30) implies that for all




                                                             66
ε0 ≥ εL (u0 ),
                  −1            1−γ
 e−γε0 cL u0 , ε0       uL u0 , ε0       = e−γεL (u0 ) [cL (u0 , εL (u0 ))]−1 [uL (u0 , εL (u0 ))]1−γ .
      

                                                                                                                       (99)
We can compute uL (u0              , ε0 )   as:

                                              uL u0 , ε0 = c1−β u0 , ε0 mβL ,
                                                                      
                                                            L                                                      (100)

where the expression of mL is given in equation (92). Equations (99) and (100) together
imply

                0          −1+(1−γ)(1−β)
            e−γε cL u0 , ε0                 = e−γεL (u0 ) [cL (u0 , εL (u0 ))]−1+(1−γ)(1−β) .


      Raising both sides of the above equation to the − Ω1 th power and using the definition of
Ω and τ in (95), we have, for all ε ≥ εL (u0 ),

                                 0                  0
                               eε cL u0 , ε0 = e−τ ε e(1+τ )εL (u0 ) cL (u0 , εL (u0 )) .
                                            
                                                                                                                   (101)

Now, we compute the first term in the integral in (98) as:
     εL (u0 )                                                                            εL (u0 )
                  ε0                              0       0                                             0
                                                                                                      eε f ε0 gL dε0
                                                                                                               
                 e cL (u0 , εL (u0 )) f ε gL dε               = cL (u0 , εL (u0 ))
   −∞                                                                                   −∞
                                                                        ξ −ξεM AX +(1+ξ)εL (u0 )
                                                              =            e                     cL (u0 , εL (u0(102)
                                                                                                                )) ,
                                                                       1+ξ

and the second term as
                          εM AX
                                     0
                                   eε cL u0 , ε0 f ε0 gL dε0
                                                       
                        εL (u0 )
                                                                 εM AX
                                                                               0
                       (1+τ )εL (u0 )
                                                                          e−τ ε f ε0 gL dε
                                                                                       
                  = e                   cL (u0 , εL (u0 ))
                                                               εL (u0 )
                                                               ξ h −τ εM AX                            i
                  = e(1+τ )εL (u0 ) cL (u0 , εL (u0 ))            e         − e−ξεM AX +(ξ−τ )εL (u0 )             (103)
                                                              ξ−τ

We obtain equation (96) by summing up (102) and (103).

      lemma 7 is the optimal risk sharing condition that equalizes the marginal rate of
substitution of workers and capital owners across the two states in period 1. The next
lemma provides another first-order condition that links the marginal rate of substitution of
capital owners and workers across time. Together lemma 7 and lemma 9 below completely
characterize optimal risk sharing conditions.


                                                                  67
Lemma 9. (Optimal risk sharing)
   Optimal risk sharing requires that for all u0 ,
                                       1+(1−β)(γ−1)                                                 γ−1
                               xH                                 x0                    n̄0 (xH , xL )
                                                              =                                                       ,                       (104)
                             cH (u0 )                           c0 (u0 )                   m̄0 (u0 )

where
                                                                             1
                    (1+β)gH (1−β)
                                      1−γ
                                   FB β
                                                     
                                                       (1−γ)gL (1−β)
                                                                         1−γ 1−γ
                                                                      FB β
n̄0 (xH , xL ) = π e       xH     uH        + (1 − π) e       xL     uL            ,

and
                                                                                                                                                           1
                                                                                        β 1−γ                                                     
                                                                                                                                                          1−γ
                                                  π       e(1+β)gH c1−β
                                                                    H         uFHB k (θH )        +
m̄0 (u0 ) =                                                                        (1−β)(1−γ)  1                                                            ,
                                                                                                       β(1−γ)
                        π) e(1−γ)gL          e(1+τ )εL (u0 ) cL (u0 ,
                                         
                 (1 −                                                      εL (u0 ))              α mL        Ψ (εL (u0 ))
                                                                                                                                              (105)
where Ψ (ε) is given by:
                                                                                            
                               ξ    −τ εM AX      ξ (1 − γ + τ )     −ξεM AX +(ξ−τ )εL (u0 )
              Ψ (ε) =             e          −                      e                          .                                              (106)
                              ξ−τ              (ξ − τ ) (ξ + 1 − γ)

Proof. The optimal risk sharing condition implies that
                                           −1                  1−γ                 −1           1−γ
                                 cH (u0 )           uH (u0 )                 xH                 wH
                                                                           =                                      .                           (107)
                                   c0                 m0                     x0                 n0

Using equation (90),
                                              β                                 β
                      = x1−β  (1 − α) egH uFHB , wL = x1−β      (1 − α) egL uFL B , and
                                                             
              wH          H                               L
                        h                                     i 1
                      = π (egH wH )1−γ + (1 − π) (egL wL )1−γ
                                                               1−γ
               n0                                                   .                                                                         (108)

To calculate workers’ utility, use (91) to obtain
                                                                             β
                                   uH (u0 ) = [cH (u0 )]1−β αuFHB egH k (θH ) .
                                                           
                                                                                                                                              (109)

Using equations (108) and (109) to replace the relevant terms in (107), we obtain equation
(104). It remains to calculate workers’ certainty equivalent,
                                                            ∞                                                                       1
                 gH               1−γ
                                                                  h
                                                                      gL +ε0               0
                                                                                               i1−γ          0
                                                                                                                             0
                                                                                                                                      1−γ
  m0 =       π [e     uH (u0 )]         + (1 − π)                     e        uL u0 , ε               f ε gL dε                            . (110)
                                                           −∞




                                                                      68
   Note that for ε0 ≥ εL (u0 ), using equation (99), we can write
h 0            i1−γ
 eε uL u0 , ε0                           eε0 cL u0 , ε0        e−γεL (u0 ) [cL (u0 , εL (u0 ))]−1 [uL (u0 , εL (u0 ))]1−γ
                                                         
                                 =
                                                                                                                 β(1−γ)
                                         eε0 cL u0 , ε0        e−γεL (u0 ) [cL (u0 , εL (u0 ))]−1+(1−β)(1−γ) mL
                                                         
                                 =                                                                                        ,

where the second equality uses (93) to compute uL (u0 , εL (u0 )) as a function of
consumption. Therefore,
          εM AX     h 0            i1−γ
                      eε uL u0 , ε0       f ε0 gL dε0
                                                 
          εL (u0 )
          εM AX
                                                                                                β(1−γ)
                      e cL u0 , ε0 f ε0 gL dε0 × e−γεL (u0 ) [cL (u0 , εL (u0 ))]−1+(1−β)(1−γ) mL
                      ε0               
  =
          εL (u0 )
       ξ         h                                       i
                                                                                                              β(1−γ)
  =                  e−τ εM AX − e−ξεM AX +(ξ−τ )εL (u0 ) × e(1−γ+τ )εL (u0 ) [cL (u0 , εL (u0 ))](1−β)(1−γ) mL
      ξ−τ
       ξ         h                                                   ih                                  i(1−β)(1−γ)
                                                                                                                      β(1−γ)
  =                  e−τ εM AX − e−ξεM AX +(ξ−τ )εL (u0 )              e(1+τ )εL (u0 ) cL (u0 , εL (u0 ))            mL    (111)
                                                                                                                             ,
      ξ−τ

where the second equality uses the same calculation as in (103) and the last equality uses
the definition of τ to simplify. For ε0 < εL (u0 ), the firm-side limited commitment constraint
binds, and
                 h 0            i1−γ                            0
                  eε uL u0 , ε0                 = e(1−γ)ε [uL (u0 , εL (u0 ))]1−γ
                                                                 0                                  β(1−γ)
                                                = e(1−γ)ε [cL (u0 , εL (u0 ))](1−β)(1−γ) mL                  ,

where the second equality applies equation (93). Therefore,
               εL (u0 ) h
                             0              i1−γ
                           eε uL u0 , ε0            f ε0 gL dε0
                                                           
              −∞
              εL (u0 )
                                 0                                              β(1−γ)
                          e(1−γ)ε f ε0 gL dε0 × [cL (u0 , εL (u0 ))](1−β)(1−γ) mL
                                         
      =
              −∞
              ξ                                                                   β(1−γ)
      =           e−ξεM AX +(1−γ+ξ)εL (u0 ) × [cL (u0 , εL (u0 ))](1−β)(1−γ) mL
            ξ+1−γ
              ξ                             h                                  i(1−β)(1−γ)
                                                                                            β(1−γ)
      =           e−ξεM AX +(ξ−τ )εL (u0 ) × e(1+τ )εL (u0 ) cL (u0 , εL (u0 ))            mL (112),
            ξ+1−γ

where the last equality uses the definition of τ to simplify. Combining (111) and (112), we




                                                                     69
have
                           ∞   h 0            i1−γ
                                 eε uL u0 , ε0       f ε0 gL dε0
                                                            
                           −∞
                       h                                     i(1−β)(1−γ)
                                                                          β(1−γ)
                 =         e(1+τ )εL (u0 ) cL (u0 , εL (u0 ))            mL      Ψ (εL (u0 )) ,              (113)

where εL (u0 ) is defined in (106). We obtain the expression (105) by combing (110) and
(113).


General Equilibrium              Unit measure of a single type of workers and market clearing at
node 0, node H, and node L implies u∗0 solves
                                                           h 0            i
            c0 (u∗0 ) = 1 − x0 , cH (u∗0 ) = 1 − xH , and E eε cL u∗0 , ε0 = 1 − xL ,

respectively. Note that equation (86) implies
                                                                            
                                                  β                   βxL
                      cL (u∗0 , εL (u∗0 ))   =1+     xL − a ln 1 +             .                             (114)
                                                 1−β               a (1 − β)

Using market clearing at node L and lemma 8,

                                                    ∗
                            1 − xL = e(1+τ )εL (u0 ) cL (u0 , εL (u∗0 )) Φ (εL (u∗0 )) .                     (115)

Combining (114) and (115), we have:

                                   ∗                                   1 − xL
                     e(1+τ )εL (u0 ) Φ (εL (u∗0 )) =                         h               i.              (116)
                                                              β                      βxL
                                                        1+   1−β xL    − a ln 1 +   a(1−β)


Equations (114) and (116) together define cL (u0 , εL (u∗0 )) and εL (u∗0 ) as functions of xL .
With a bit abuse of notation, we denote these functions as cL (xL ) and ε(xL ).
    Focusing on type-u∗0 agents, using lemma 8, we                                  can      replace   the   term
            ∗
e(1+τ )εL (u0 ) cL (u∗0 , εL (u∗0 )) in equation (87) by the following

                                       ∗
                        e(1+τ )εL (u0 ) cL (u∗0 , εL (u∗0 )) = (1 − xL ) Φ (ε (xL ))−1 .                     (117)

Therefore, the first order condition (87) can be written as
                                                              τ
                                            uFL B k (θH )
                                              
                                                                       xH 1 − xL
                                Φ (ε (xL ))                        =             .                           (118)
                                            ΥuCD
                                               L k (θL )               xL 1 − xH




                                                        70
    Also, using the marketing clearing condition to replace cH by 1 − xH , and use (117) to
                    ∗
replace e(1+τ )εL (u0 ) c (u∗ , ε (u∗ )), we define workers’ certainty equivalent as a function of
                         L    0   L   0
xH , xL , and ε using (105)
                                                                                                              1
                                      h
                                                                (1−β)           β i1−γ                     1−γ
                         
                                  π       e(1+β)gH
                                                (1 − xH )          uFHB k (θH )                            
                                                                                                           
   m̄0 (xH , xL , ε) =                           h       i(1−β)                β 1−γ
                                                                                                                  ,
                                         (1+β)g     1−xL              CD
                          + (1
                                 − π) e        L
                                                     Φ(ε)         ΥuL k (θL )                     Ψ (ε) 
                                                                                                        
                                                                                                                (119)
and the first order condition (104) can be written as
                            1+(1−β)(γ−1)                  −1                              1−γ
                     xH                           x0                     n̄0 (xH , xL )
                                              =                                                       .         (120)
                   1 − xH                       1 − x0               m̄0 (xH , xL , ε (xL ))

Give an inital condition of x0 , equations (118) and (120) can be jointed solved for xH and
xL . Other equilibrium quantities can then be constructed analogously.


C.2    Proof of proposition 4

   1. From the definition of uCD
                              L  in (79), it is clear that as γ → 1 + ξ, uCD
                                                                          L → 0. Consider
      equation (118). It is straightforward to verify that Φ (ε) is strictly positive and
      bounded (see equation (97)). Also, both k (θH ) and k (θL ) are bounded. Therefore,
                                                                                                      xH
      as γ → 1 + ξ the left hand side converges to ∞, and we must have                                xL   → ∞. By
                                                                     xH
      continuity, there exists γ̂ ∈ (1, 1 + ξ) such that             xL    > 1 if and only if γ > γ̂, as needed.
      In addition, if γ = 1, then τ = 0. Using the definition of Φ (ε),

                                                         1
                                      Φ (ε) = 1 −             e−ξ(εM AX −ε) < 1.
                                                      (1 + ξ)
                                       xH
      Therefore, we must have          xL    < 1.

   2. The economy without moral hazard is a special case in which the parameter for
      cost of effort, a = 0. We use θH (a) and θL (a) to denote policy functions with the
      understanding that they are policy functions of the moral hazard economy if a > 0, and
      they stand for policy functions in the economy without moral hazard if a = 0. Using
                                                                      xH
      our result from Part 1 of the proof, as γ → 1+ξ,                xL   → ∞. Because both xH and xL are
      bounded between [0, 1], we must have xL → 0. Therefore, θL (a) → 0 by equation (82).
      Also, equation (120) implies that as γ → 1 + ξ, m̄0 (xH (a) , xL (a) , ε (xL (a))) → 0;
                                                                                                               a
      therefore, xH (a) → 0 as well. Therefore, as γ → 1 + ξ, θH (a) → 1 −                                     β      .
                                                                                                           a+ 1−β x∗H




                                                        71
     Consider equation (118), for an arbitrary a,
                                           τ                                                τ
                                                  θH (a) + (1 − θH (a)) λ1−γ
                                                                                         1−γ
                              k (θH (a))
                                                =                                                 .
                              k (θL (a))          θL (a) + (1 − θL (a)) λ1−γ

     Suppose a > 0, then as γ → 1 + ξ, there exist  > 0 such that

                                                                                                                           βξ
                                                                                                                     − 1ξ 1+ξ(1−β)
                                            τ
                                                  1 −
                                                                     a
                                                                                + 1−              a
                                                                                                               λ−ξ
         θH (a) + (1 − θH (a)) λ1−γ                                β
                                                                      x∗H (a)                 β
                                                                                                 x∗H (a)
                                         1−γ
                                                               a+ 1−β                     a+ 1−β                     
                                                 →                                                                                  > 1+.
         θL (a) + (1 − θL (a)) λ1−γ                                                λ−ξ                              



     In addition, equation (116) implies that as γ → 1 + ξ, xL → 0, and therefore,
                                                                                ∗
     εL (a) → ε∗ for all a, where ε∗ is such that e(1+τ )ε Φ (ε∗ ) = 1. Therefore, with
     a > 0, for γ close enough to 1 + ξ, we must have
                                                                τ                              τ
                                   uFL B k (θH (a))                                uFL B
                                                                                    
                        Φ (εL (a))                                   > Φ (εL (0))                     .
                                   ΥuCD
                                      L k (θL (a))                                ΥuCDL

                                                                                xH        xH
     Equation (118) implies that for γ close enough to 1+ξ,                     xL   >    xL   because as γ → 1+ξ,
     xL → 0 and xH → x∗H has a limit.

  3. By Part 1 of the proposition, for γ large enough, xH > xL . The fact that θH > θL
     follows from equation (82).


Proof for the claim that Price-dividend ratio is procyclical                                      Here we provide a
proof for claim in footnote 13. Consider first firm value at node H, (80). Because there is
no idiosyncratic shock at node H, there is only one type of firm, and u = uH . Using the
market clearing condition at node H, 1 − cH = xH . Therefore, in equilibrium,
                                                                          
                                               β                     βxH
                 vH (u∗0 )    = 1−       cH (u∗0 )
                                          +       xH − a ln 1 +
                                             1−β                 a (1 − β)
                                                                  
                                       β                    βxH
                              = xH +      xH − a ln 1 +
                                     1−β                 a (1 − β)
                                                            
                                  1                   βxH
                              =      xH − a ln 1 +             .
                                1−β                a (1 − β)

   At node L, firm value is given by eε vL (u∗0 , ε). Using equation (81),
                                                                                     
                                                           β                   βxL
                 vL (u∗0 , ε) = 1 − cL (u∗0 , ε) +            xL − a ln 1 +             .
                                                          1−β               a (1 − β)



                                                          72
Note that
                                                E [eε cL (u∗0 , ε)] = 1 − xL

by market clearing. Therefore,
                                                                                        
                                                             β                    βxL
         E [e    ε
                     vL (u∗0 , ε)]   = 1 − E [e     ε
                                                        cL (u∗0 , ε)]
                                                        +        xL − a ln 1 +
                                                           1−β                 a (1 − β)
                                                                   
                                         1                   βxL
                                     =      xL − a ln 1 +             .
                                       1−β                a (1 − β)
                                                                        xH
Using our previous arguement, as γ → 1 + ξ,                             xL   → ∞. Therefore, for γ large enough, we
             vH (u∗ )
must have E eε v u0∗ ,ε > 1, as needed.
            [ L ( 0 )]

C.3    Proof of proposition 5

Firm risk pass through                  Fixing u0 , equation (101) implies that ∀ε0 ≥ε(u0 ),

                                                 d ln [eε cL (u0 , ε)]
                                                                       = −τ.
                                                          dε

For ε0 <ε(u0 ), the limited commitment constraint binds, and eε cL (u0 , ε) = eε cL (u0 , ε (u0 )).
Therefore,
                                                  d ln [eε cL (u0 , ε)]
                                                                        =1
                                                           dε
Combining the above two equations, we have
                                                       εL (u0 )                            εM AX
            ∂ ln [eε cL (u0 , ε)]
                                       
                                                                         0         0
                                                                                                     f ε0 gL dε0
                                                                                                           
          E                                 =                      f ε gL dε τ +
                     ∂ε                              −∞                     L              ε (u0 )
                                                                      h                        i
                                               −ξ(εM AX −εL (u0 ))
                                            = e                    − τ 1 − e−ξ(εM AX −εL (u0 )) .

Clearly, the average elasticity is increasing in εL (u0 ). Using the optimal risk sharing
conditions (89) and (104), we can show that εL (u0 ) is an increasing function of u0 .

                                                                                                                  vH (u0 )
Cross section of expected returns To characterize the dependence of                                            E[eε vL (u0 ,ε)] ,   note
that in general,
                                                                   τ
                                                ξuCD
                                            
                                    xH            L k (θL )
                                                                        e(1+τ )εL (u0 ) cL u0 , εL (u0 )
                                                                                                           
                         cH (u0 ) =
                                    xL           uL B k (θL )
                                                  F




                                                                   73
by lemma 7 and

                       E [eε cL (u0 , ε)] = e(1+τ )εL (u0 ) cL (u0 , εL (u0 )) Φ (εL (u0 ))

by lemma 8. Because at ε = εL (u0 ), thehlimited commitment
                                                        i         constraint, vL (u0 , ε) = 0
                                 β                  βxL
binds, cL (u0 , εL (u0 )) = 1 + 1−β xL − a ln 1 + a(1−β) by (86). To simplify notation, we
                                   h          i                           h             i
                      β                 βxH                   β                  βxL
denote ΓH = 1 + 1−β      xH − a ln 1 + a(1−β)   and ΓL = 1 + 1−β xL − a ln 1 + a(1−β)     . We
                vH (u0 )
then write   E[eε vL (u0 ,ε)]   as

                               vH (u0 )              ΓH − φe(1+τ )εL (u0 )
                                              =                                    ,
                           E [eε vL (u0 , ε)]
                                                  
                                                ΓL 1 − e(1+τ )εL (u0 ) Φ (ε (u0 ))
                                                iτ
                                     ξuCD
                                 h
                            xH         L k(θL )
where we denote φ =         xL        uF B           ΓL to simplify notation. By proposition 2, ε (u0 ) is a
                                       L k(θL )
strictly increasing function of u0 . Therefore, to prove proposition 5, it enough to show

                                            ∂ ΓH − φe(1+τ )ε
                                                                 > 0,
                                            ∂ε 1 − e(1+τ )ε Φ (ε)

which is given by the following lemma.
Lemma 10. There exists γ̃ ∈ (1, 1 + ξ) such that γ > γ̃ implies that for all ε ∈
(−∞, εM AX ),                                "                   #
                                           ∂   ΓH − φe(1+τ )ε
                                                                   > 0.                               (121)
                                           ∂ε 1 − e(1+τ )ε Φ (ε)

Proof. We can compute (121) as :
        "                   #
      ∂    ΓH − φe(1+τ )ε
      ∂ε 1 − e(1+τ )ε Φ (ε)
      −φe(1+τ )ε (1 + τ ) 1 − e(1+τ )ε Φ (ε) + ΓH − φe(1+τ )ε e(1+τ )ε [(1 + τ ) Φ (ε) + Φ0 (ε)]
                                                              
  =                                                          2                                 .
                                            1 − e(1+τ )ε Φ (ε)

We focus on the numerator and simplify:
                       h                  i h                i
    −φe(1+τ )ε (1 + τ ) 1 − e(1+τ )ε Φ (ε) + ΓH − φe(1+τ )ε e(1+τ )ε (1 + τ ) Φ (ε) + Φ0 (ε)
                                                                                            
                                      h                     i
  = ΓH (1 + τ ) Φ (ε) + Φ0 (ε) − φ (1 + τ ) + e(1+τ )ε Φ (ε)
                              


   It is therefore enough to show
                                                  h                         i
                    ΓH (1 + τ ) Φ (ε) + Φ0 (ε) − φ (1 + τ ) + e(1+τ )ε Φ (ε) > 0
                                             
                                                                                                      (122)

                                                           74
Using the expression of Φ (ε), we can compute

                                               ξ h −τ εM AX                        i
      (1 + τ ) Φ (ε) + Φ0 (ε) = (1 + τ )             e         − e−λεM AX +(ξ−τ )ε
                                             ξ−τ
                                               ξ             h                          i
                                  = (1 + τ )      e−τ εM AX 1 − e−(ξ−τ )εM AX +(ξ−τ )ε
                                             ξ−τ
                                               ξ −τ εM AX 1 + ξ h                              i
                                  = (1 + τ )      e                 1 − e−(ξ−τ )εM AX +(ξ−τ )ε
                                             1+ξ             ξ−τ
                                                           1 + ξh                       i
                                  = (1 + τ ) e−(1+τ )εM AX        1 − e−(ξ−τ )(εM AX −ε) > 0,
                                                           ξ−τ

where the last line uses the fact εM AX = ln 1+ξ
                                              ξ . Also, the second term in equation (122)
can be written as
                                                                                
                              (1+τ )ε    0                     ξ −λεM AX +(1+ξ)ε
               (1 + τ ) + e             Φ (ε) = (1 + τ ) 1 −      e
                                                             1+ξ
                                                        h                     i
                                              = (1 + τ ) 1 − e−(1+ξ)(εM AX −ε) .

Therefore, to prove (122), it is enough to show that for all ε,

                            1+ξ h                       i   h                     i
         ΓH e−(1+τ )εM AX         1 − e−(ξ−τ )(εM AX −ε) − φ 1 − e−(1+ξ)(εM AX −ε) > 0.
                            ξ−τ

Because φ → 0 as γ → 1 + ξ, we have ΓH e−(1+τ )εM AX > φ for γ close enough to 1 + ξ. We
complete the proof by making the following observation
    Define

                                             1+ξ h                        i
                               f (ε) =             1 − e−(ξ−τ )(εM AX −ε)
                                             ξ−τ
                               g (ε) = 1 − e−(1+ξ)(εM AX −ε) ,

then f (ε) > g (ε) for all ε < εM AX . To see this, note that f (εM AX ) = g (εM AX ) = 0. Also,
f 0 (ε) < g 0 (ε) for all ε < εM AX , because

                                f 0 (ε) = − (1 + ξ) e−(ξ−τ )(εM AX −ε)
                                 g 0 (ε) = − (1 + ξ) e−(1+ξ)(εM AX −ε) .




                                                     75
D      Computational Algorithm

We describe our computation algorithm. The algorithm consists of an “outer loop”, in
which we iterate over the law of motion for aggregate states and an associated stochastic
discount factor, and an “inner loop”, in which we solve for the optimal contract.
    From the theoretical perspective, the summary measure φ as well as B are state variables
that summarize the history of aggregate shocks. Computationally, we use firm owner’s
consumption share, x as a proxy to summarize the information in (φ, B). This is an
efficient choice for two reasons. First, given the dynamics of x, the pricing kernel is complete
determined. Second, even through we only keep track of x as the state variable, we compute
the summary measure (φ, B) in each step to update the law of motion of x. In what follows,
we replace the state variables (φ, B) by x. Below are the steps of our numerical procedure.

    1. Initialize the law of motion of x, Γx (g, x, g 0 ). We use a log-linear functional form:

                                             log x0 = a(g, g 0 ) + b(g, g 0 ) log x.                                (123)

       Given the law of motion of x, the SDF Λ (x, g, g 0 ) is calculated using
                                                "                  0
                                                                       #− 1 "                      0
                                                                                                       # 1 −γ
                                    0
                                              x0 (g 0 |g, x) eg         ψ
                                                                                w (x0 , g 0 ) eg        ψ

                        Λ x, g, g           =β                                                                  ,
                                                        x                         n(g, x)

       where w(g, x) and n(g, x) are given by

                                                                    i 11
                                                 1− 1          1− 1
                                       h
                             w (g, x) = (1 − β) x ψ + βn (g, x) ψ 1− ψ ,

                                                                          1
                                                                            1−γ
                               X         (1−γ)g0 1−γ 0                
                                      0                               0
                    n (g, x) = κ   π g |g e       w    g , Γx g, x, g           .
                                0
                                                                          
                                            g


    2. The inner loop consists of using Γx (g, x, g 0 ) and Λ (x, g, g 0 ), to solve the value function
       v (u, g, x), the worker-outside value u (g, x) and value of a new job u∗ (g, x) along
       with the policy functions c (u, g, x), θ (u, g, x) and u0 (u, g, x, ζ 0 ) that solve the optimal
       contracting problem P1. We solve Bellman equation by a modified value function
       iteration as appplying a standard value function iteration is complicated by the
       presence of the occasionally binding constraints (15) and (16). Our procedure borrows
       elements from endogenous grid method of Carroll (2006). We describe it below

        (a) Guess v (u, g, x) and c (u, g, x). These imply functions u∗ (g, x) and u(g, x) using


                                                           76
    equations
                                        v (u∗ (g, x) , g, x) = 0,
                                                                    i 11
                                            1− 1               1− 1
                                  h
                       ū (g, x) = (1 − β) b ψ + β [λm̄ (g, x)] ψ 1− ψ ,

    with
                h          n                                                                 1
                          0                          1−γ                             o i 1−γ
    m̄ (g, x) = κE e(1−γ)g (1 − χ)ū1−γ g 0 , x(g 0 )     + χu∗1−γ g 0 , Γx g, x, g 0    g       .

    We denote c(u∗ (g, x)|g, x) and c(λu(g, x), g, x) by c∗ (g, x) and c(g, x).
(b) Let {ε(u, S, g 0 ), ε(u, S, g 0 )}g0 be the thresholds for η 0 + ε0 such that constraint
    (15) and (16) bind for a worker with state u, aggregate states (S) and
    next period for aggregate shock g 0 = gL .                 Define a grid E L × X ≡
                                                 
     (εL,0 , x0 ), εL,1 , x0 , . . . , εL,nE , xnX   with the understanding that εL (j) and
    x(j) are the entries in the j th element of the grid E L × X with j ∈
    {1, 2, . . . , nE × nX } .
                                                      
(c) For all j ∈ {1, 2, . . . , nE × nX }, we solve for εg0 (j), εg0 (j)     g0
                                                                                 that are consistent
    with εL (j) and the guess for functions v and c in step (a) using the following
    equations that need to hold for all g 0
                                                                     1                              1
    Λ (x(j), g, g 0 )  e−γ (εg0 (j)) c∗ (g 0 , Γx (x(j), g, g 0 )) − ψ u∗ (g 0 , Γx (x(j), g, g 0 )) ψ −γ
                                     
                    =
                                       c∗ (gL , Γx (x(j), g, g 0 ))      u∗ (gL , Γx (x(j), g, g 0 ))
                                  
    Λ gL , g, x(j)       −γ εg (j)
                       e      L


    and
                                                                  1                             1
    Λ (x(j), g, g 0 )  e−γ (εg0 (j)) c (g 0 , Γx (x(j), g, g 0 )) − ψ u (g 0 , Γx (x(j), g, g 0 )) ψ −γ
                                    
                    =                                        0
                                                                                                        .
    Λ gL , g, x(j)     e−γ (εgL (j)) c (gL , Γx (x(j), g, g ))        u (gL , Γx (x(j), g, g 0 ))

(d) Now we construct the policy function u0 (ζ 0 , j) using :

                  u0 (η 0 + ε0 |j) = u∗ g 0 , Γx x(j), g, g 0        ∀η 0 + ε0 < εg0 (j)
                                                                


                u0 (η 0 + ε0 |j) = λu g 0 , Γx x(j), g, g 0          ∀η 0 + ε0 < εg0 (j)
                                                                


    and for η 0 + ε0 ∈ εg0 (j), εg0 (j) use
                                       

                                                       1                              1
           e−γ (εg0 (j)) c∗ (g 0 , Γx (x(j), g, g 0 )) − ψ u∗ (g 0 , Γx (x(j), g, g 0 )) ψ −γ
                        
                                                                                              =1
           e−γ(η0 +ε0 )             c (u0 )                             u0

    to solve out for u0 .



                                             77
   (e) We compute c(j), θ(j) and ι(j) using
                                                                        − 1  ∗ 0                      1
                                                                              u (g , Γx (x(j), g, g 0 )) ψ −γ
                                             ∗ 0                 0
                       0ι (j)
                                 −γ (εg0 (j)) c (g , Γx (x(j), g, g ))
                                                                           ψ
       Λ x(j), g, g  1+         =e                                                                            ,
                        θ (j)                           c (j)                         m (j)
                                                               0 0 0
                                 A0 (θj ) = κEg Λ x(j), g, g 0 eg +η +ε v u0 ζ 0 , j ,
                                                                                    


                 
            1−β
                      ι(j)A00 (θj )
             β
                                                    
                1                 1
                               γ− ψ             1                 0  0
                                                                       h          1−γ                           1−γ i
        = c(j) m(j)
                ψ                     Eg                  e(1−γ)(ε +η ) u ζ 0 , j      − u g 0 , Γx x(j), g, g 0          ,
                                               1−γ

       where        certainty          equivalent          m(j)     only    depends      on    {u0 (s0 , g)}s0   and
       {u (g 0 , Γx (x(j), g, g 0 ))}g0 .
    (f) Finally, we use the promise keeping constraint (14) to back out u(j) that is
       consistent with c(j) and {u0 (s0 , g)}s0 and we use the objective function of the
       firm, the right hand side of (13) to obtain vj :

                                                                         i 11
                                                          1− 1      1− 1
                                             h
                                       u(j) = (1 − β) c(j) ψ + βm(j) ψ 1− ψ

                                                       0 0 0
       v(j) = 1 − c(j) − A(θ(j)) + κθ(j)Eg Λ g 0 |g, x eg +η +ε v u0 ζ 0 , j |g 0 , Γx x, g, g 0
                                                                                                


   (g) The guess for v (u, g, x) and c (u, g, x) are updated by interpolating values {uj , vj }
       and {uj , cj } . We then iterate until the value function and consumption functions
       both converge with a tolerance of 1e − 7 under a sup norm.

3. To check the accuracy in computing the optimal contract, we plot a version of Euler
  equation errors in Figure 2. Fixing u, x, g and the aggregate state next period g 0 ,
  we draw 1000 idiosyncratic shocks ε0 + η 0 such that both agent and firm-side limited
  commitment constraints are not binding. We then use the maximum absolute log10
  ratio of worker’s MRS to owners’ MRS across these shocks as our measure of Euler
  Equation Error. We repeat this procedure for different (u, x, g) and g 0 combinations
  with values of (u, x) that are not on the grid points where the value function is solved.
  The Euler equation errors computed this way has the magnitude of -4, which suggests
  that our approximation is reasonable.

4. We now describe the outer loop where we use optimal policies to simulate the model
  and update Γx . The details of the simulation procedure are given below:

   (a) Let φ (t) denote the summary measure at time t. In simulations, we approximate


                                                            78
    the continuous distribution φ (t) by a finite-state distribution as follows. We
             (t)   (t)        (t)                (t)                           (t)
    choose u1 , u2 , · · · , uN +1 , where u1 = λu (gt , xt ) and uN +1 = u∗ (gt , xt ). A
    density φ is characterized by a set of grid points {û [n] (t)}N +3
                                                                   n=1 and corresponding
    weights {φ [n] (t)}N +3
                       n=1 such that

      • û [1] and û [N + 1] are the boundaries where the limited commitment
        constraint binds: û [1] = λu (gt , xt ) and û [N + 1] = u∗ (gt , xt ); û [N + 2] =
        u∗ (gt , xt ) is the restarting utility.
      • {û [n]}n=2,3,···N are the interior points: û [j] ∈ (uj−1 , uj ), for j = 2, 3 · · · N,
        are chosen appropriately to minimize the approximation error.
      • φ [1] and φ [N + 1] are the total amount of human capital owned by
        agents with a binding limited commitment constraint at û [1] and û [N + 1],
        respectively.
      • {φ [n]}n=2,3,···N are the human capital owned by agents in the interior.
      • The mass on φ [N + 2] is the human capital of agents who (re)start at
        u∗ (g, x), this include both the newly employed and the new born.
      • The mass φ [N + 3], which is the total human capital owned by workers in
        the the unemployed pool.
(b) Start with an initial distribution of u, denoted {φ0 (u)}.
(c) Having solved x0 , use the law of motion of u0 (u, g, x, ζ 0 ) to compute φ1 . Here we
    describe a general procedure to solve for {φ [n] (t + 1) ; û [n] (t + 1) ; xt+1 }N +3
                                                                                      n=1
    and Bt+1 given {φ [n] (t) ; û [n] (t) ; xt }N +3
                                                 n=1 and Bt . Note that the assumed law
    of motion gives a natural candidate for xt+1 . We denote xt+1 = Γ (xt , gt , gt+1 ).
      i. First, we approximate the distribution s ∼ f ( ε + η| g) by a finite
                                            PK                PK s
         dimensional distribution such that  k fg [j] = 1 and  k e fg [j] = 1,
                                                                   k


        for g = gH , gL .
     ii. Given {φ [n] (t) , û [n] (t)}N +3
                                       n=1 for period t, conditioning on the realization
        of aggregate state gt+1 , for each n = 1, 2, · · · , N + 2, we compute
        {φt+1 [n, k]}n,k . The interpretation is that φt+1 [n, k] is the total measure
        of income share that comes from agents with û [n] (t) and with realization of
        εk , which is given by:

             φt+1 [n, k] = κθ (û [n] (t) , gt , xt ) fgt+1 [k] φt [n] esk ,         k = 1, 2 . . . , K.

        The continuation utility of these agents is u0 (û [n] (t) , gt , xt , gt+1 , sk ), a fact
        that we will use below.
    iii. We now compute {φt+1 [m]}m=1,2,...N +3 for the next period. First, compute

                                            79
   the measure on the grid points:

                         N
                         X +2 X
                              K
          φt+1 [1] =                 φt+1 [n, j] I{u0 (û[n](t),gt ,xt ,gt+1 ,sk )≤λu(gt+1 ,xt+1 )} ,
                        n=1 k=1
                       N
                       X +2 X
                            K
         φt+1 [2] =                φt+1 [n, k] Inu0 (û[n](t),g                          
                                                                                           (t+1) (t+1)
                                                                                                       o ,
                                                                   t ,xt ,gt+1 ,sk )∈     u1    ,u2
                        n=1 k=1
                N
                X +2 X
                     K
   φt+1 [m] =               φt+1 [n, k] Inu0 (û[n](t),g                         h
                                                                                      (t+1)   (t+1)
                                                                                                      o ,   m = 3, . . . N
                                                            t ,xt ,gt+1 ,sk )∈       um−1 ,um
                n=1 k=1
                             N
                             X +2 X
                                  K
       φt+1 [N + 1] =                    φt+1 [n, k] I{u0 (û[n](t),gt ,xt ,gt+1 ,sk )≥u∗ (gt+1 ,xt+1 )} ,
                             n=1 k=1

   Second, we compute the measure of all restarting agents, which include the
   newly employed and the new born:

                             φt+1 [N + 2] = 1 − κ + κλχφt [N + 3]

   Finally, we compute the measure of the unemployed pool:
                             (N +2                                                                                  )
                              X
    φt+1 [N + 3] = κλ                 [1 − θ (û [n] (t) , gt , xt )] φt [n] + [1 − χ] φt [N + 3]
                                n=1

iv. The interpretation is again that φ [1] and φ [N + 1] are the human capital
   owned by agents with a binding limited commitment constraint at û [1] and
   û [N + 1], respectively, and {φ [n]}n=2,3,···N are the amount of human capital
   owned by agents in the interior. φ [N + 2] is the human capital of agents
   who enter the employment pool (which include newly employed and the
   new born), and φt+1 [N + 3] is the total human capital of workers in the
   unemployed pool.
v. We need to update the vector normalized utilities {û [n] (t + 1)}N              +2
                                                                                  n=1 .
   Clearly, we should have û [1] (t + 1) = λu (gt+1 , xt+1 ), û [N + 1] (t + 1) =
   u∗ (gt+1 , xt+1 ) and û [N +h2] (t + 1) = u∗ (gt+1 , xt+1 ). For m = 2, . . . , N ,
                                   (t+1) (t+1)
   we choose û [m] (t + 1) ∈ um−1 , um          such that the resource constraint
                           h              
                              (t+1) (t+1)
   holds exactly for u ∈ um−1 , um          . That is, we pick û [m] (t + 1) to be the
   solution (denoted û) to
         N
         X +2 X
              K
                    φt+1 [n, k] c (u0 (û [n] (t) , gt , xt , gt+1 , εj ) , gt+1 , xt+1 ) Inu0 (û[n](t),g                           h
                                                                                                                                       (t+1) (t+1)
                                                                                                                                                   o
                                                                                                                t ,xt ,gt+1 ,εk )∈    um−1 ,um
          n=1 k=1
     = c(û, gt+1 , xt+1 )φt+1 [m] .


                                            80
            vi. Finally, the total unemployment benefit consumed by all unemployed workers
                isBt+1 = bφt+1 [N + 3].
       (d) Up to now, we have described a procedure to simulate forward the economy.
                                                         C ∞
           This allows us to compute the market clearing xM
                                                          t+1 t=0 as follows:

                          N
                          X +2                N
                                              X +2
               xM C
                t+1   =          φt+1 [m] −          c( û [m] (t + 1)| gt+1 , xt+1 )φt+1 [m] − Bt+1 .   (124)
                          m=1                 m=1


           Given the sequence of {gt }Tt=1 , we simulate the economy forward for T periods
                     C T
           to obtain xMt   t=0
                               . We divide the sample into four cases: gH → gH , gH → gL ,
           gL → gH , gL → gL and use regression to update the law of motion of x. We
           go back to step 1 to iterate. Note the under the above procedure, given the
           sequence of {gt }Tt=1 , the sequence of xt+1 that is used for computing decision
           rules is complete determined by (124). In the simulation, we assume that xt+1
           follows the perceived law of motion, based on which agent make their decisions.
           We use the market clearing condition to update the actual law of motion of x
           and iterate.
       (e) We divide the sample into four cases: gH → gH , gH → gL , gL → gH , gL → gL
           and use regressions (123) to update the law of motion of x. We go back to step
           1 to iterate until the unconditional R2 approaches 99.9%.


E     More details on wage-pass-through and returns in the
      cross section

In this section, we provide corroborating evidence for the empirical results in sections 6.2
and 6.3. As a robustness for specification (34), we estimate

                                                 +
 ∆ log WageBillf,t+1 = αw + βw0 LaborSharef,t + βw1 max{∆ log Salesf,t , 0}
                       −                             +
                      βw1 min{∆ log Salesf,t , 0} + γw ∆ max{log Salesf,t , 0} × LaborSharef,t
                         −
                      + γw min{∆ log Salesf,t , 0} × LaborSharef,t + λwt .                               (125)


    The firm-side limited commitment binds with adverse firm-level shocks. This would
            − or the coefficient on the negative part of sales growth should be positive and
imply that γw
statistically significant. In table 7, we verify this.
    Next we estimate a version of (32) with total assets and book leverage as further controls.
In table 8, we verify that the coefficient on labor leverage remains positive and statistically

                                                        81
significant.




               82
Figure 1: Timing of the simple model

                            xH ; wH

                 gH         c H ; uH
   x0

   c0
                            xL ; wL
                gL
                          cL (); uL ()




                83
                                              Euler Equation Errors




               −3.6

               −3.62
log10 errors




               −3.64

               −3.66

               −3.68
                                                                                                0.21
               −3.7
                 0.2                                                                  0.2
                              0.23                                                          u
                                               0.26                            0.19
                                         x                      0.29

                       Figure 2: Euler equation errors for g = gL and g 0 = gL .




                                                  84
                                      Table 1: PARAMETERS

    Parameters           Values             Targeted moments                               Values

    Aggregate Risk
    gH , gL              0.35%,             Mean, std of consumption growth                1.94%, 2.14%
                         -0.15%
    π(gH |gH )           0.99               Duration of booms                              12 yrs
    π(gL |gL )           0.95               Duration of recessions                         4 yrs
    σE                   1.2%               Autocorr of consumption growth                 0.44

    Labor Market
    a1,H , a1,L          .995,.9925         Annualized separations rate in                 2%, 3%
                                            booms, and recessions
    χ                    8%                 Long-term unemployment duration                3 years
    λ                    96%                PV of earning losses on separation             30%
    b                    1                  Flow value of unemployment                     40-95%
    κ                    0.99               Duration of working life                       25 years

    Idiosyncratic Risk
    α                 82%                   Across firm wage variation                     40%
    σL , σH           7.0%, 8.0%            Std. of labor earnings change in               32%, 31%
                                            booms and recessions
    τ, ρ                 4.155, 2%          Kelly skewness of labor earnings               -3.2%, -8.9%
                                            change in booms and recession

    Other parameters
    β,ψ,γ           0.989, 2, 5             Discount factor, IES, risk aversion

Notes: All reported moments are annualized. The NIPA sample for aggregate consumption is 1930-2007.
We follow the estimation procedure in Ai and Kiku (2013). The CPS transition rates are computed using the
monthly average of workers’ transitions over 12-month intervals between January 1976 and July 2014. Davis
and von Wachter (2011) use longitudinal Social Security records from 1974 to 2008. The earnings losses are
computed using job displacements defined as in long-tenure men, 50 years or younger, in mass-layoff events
at firms with at least 50 employees. The earnings losses are accumulated for 20 years at a discount rate of
5% and are expressed as a percentage of displaced workers’ average annual predisplacement earnings. The
flow value of unemployment is relative to wages and in the range of estimates in Shimer (2008), Rudanko
(2011), and Hagedorn and Manovskii (2008). The within- and between- firm wage variation is taken from
table 6 in Song et al. (2015). We use the PSID for periods 1968-2014. The sample selection is explained in
the text.




                                                    85
                 Table 2: AGGREGATE ASSET PRICING IMPLICATIONS

       Moments                                           Model                           Data
                                              Baseline        No Frictions

    Excess return on consumption
      mean                                     3.59%          0.62%                        -
      std.                                     7.40%          2.86%                        -

    Excess return on dividends
      mean                                     3.67%          0.62%                     6.06%
      std.                                     7.61%          2.86%                     19.8%

    Std of log SDF
      booms                                   19.15%          17.83%                   38.00%
      recessions                              35.70%          27.80%                   66.00%

    Risk free rate
      mean                                     2.81%          5%                        0.56%
      std.                                     2.86%          0.85%                     2.89%

                                                                                           
Notes: All moments are annualized. In the “Model” column, the claim to consumption is Yt       φt (du). The
the claim to dividends is xt Yt and assumes zero financial leverage. The column labeled “No Frictions”
is the first best economy, i.e., without limited commitment and moral hazard with same parameters for
preferences and technology as the baseline. The column labeled “Data” column computes market return as
value-weighted returns from CRSP stock index and adjusted for CPI inflation. Estimates of debt-to-equity
for publicly traded U.S. firms range from 40%-50%. The risk-free rates are computed as in the appendix of
Beeler and Campbell (2012). The estimates for Sharpe ratios on the market return in booms and recessions
are from Lustig and Verdelhan (2012).




                                                   86
                    Table 3: AGGREGATE RETURN PREDICTABILITY

            Horizon                             Model                                  Data
            (quarters)            Baseline               No Frictions
                                β         R2             β         R2              β          R2

            2                 -0.356      0.157       -0.381         0.001      -0.062       0.042
            4                 -0.580      0.251       -0.739         0.001      -0.113       0.075
            8                 -0.788      0.329       -1.409         0.002      -0.190       0.119
            12                -0.860      0.345       -2.029         0.003      -0.236       0.142
            16                -0.871      0.328       -2.600         0.003      -0.277       0.166

                                                    PJ
Notes: The coefficients and R2 of the regressions     j=1 (rt+j   − rf,t+j ) = α + β(pdt ) + t+j . The column
labeled “Model-Baseline” uses data simulated by the baseline calibration. The column labeled “Model-No
Frictions” is the first best economy, i.e., without limited commitment and moral hazard with same parameters
for preferences and technology as the baseline. The column labeled “Data” follows the construction in Beeler
and Campbell (2012).




                                                    87
                     Table 4: COMPARISON TO OTHER BENCHMARKS

    Moments                                       Baseline        Only-            Exogenous          No Mixture
                                                                  Worker-          Wage
                                                                  Side             Rigidity
                                                                  Limited
                                                                  Commit-
                                                                  ment
                                                                                                      σH = σL     σH < σ L


 Excess return on consumption
   mean                                             3.59%         1.16%            0.62%              1.03%       3.20%
   std.                                             7.40%         2.43%            2.86%              3.16%       6.75%

 Excess return on dividends
   mean                                             3.67%         0.91%            0.68%              1.04%       3.27%
   std.                                             7.61%         2.52%            3.09%              3.36%       6.94%

 Std of log SDF
   booms                                           19.34%         13.75%           17.83%             9.43%       18.95%
   recessions                                      35.7%          23.00%           27.80%             21.22%      36.26%

 Consumption growth of firm owners
   std.                                              10%          4.54%            3.84%              3.82%       7.72%

 Risk free rate
   mean                                             2.81%         5.07%            4.73%              4.33%       3.21%
   std.                                             2.86%         1.44%            0.39%              0.77%       2.28%

                                                                                               
Notes: All moments are annualized. In the “Model” column, the claim to consumption is Yt           φt (du). The
the claim to dividends is xt Yt and assumes zero financial leverage. For all cases, technology and preferences
parameters are the same as the baseline. The column labeled “Only-Worker-Side Limited Commitment”
relaxes constraint v (u, S) ≥ 0. The column labeled “Exogenous Wage Rigidity” uses the first-best stochastic
discount factor, in the row “Excess returns on xt Yt ” we price an unlevered claim to corporate dividends.
The cash flow from this claim is modeled as x̃(g)Y where x̃(g) has a mean of 33% and a standard deviation
of 2%, as in Favilukis and Lin (2016b). In the column labeled “No Mixture”, we set the mixture probability
of drawing from the negative exponential ρ to zero. For subcolumn labeled “σH = σL ” the value for std. in
booms and recessions is set to 8.3% and for the subcolum labeled of “σH < σL ”, the value for σL = 10.3%
and the value of σH = 8.3%.




                                                     88
                   Table 5: FIRM-LEVEL RETURNS AND LABOR SHARES

                           Coefficients         Using LS           Using ELS


                           Labor share             1.38                1.25
                                                  (0.41)              (0.19)

                           Time fixed              Yes                 Yes
                           effects

                           no. of obs.            15170               83611
                           no. of entities         1645                9591
Notes: The sample consist of firm-year observations from CRSP/Compustat merged files for the years 1968-
2016. In the column labeled “Using LS” we use labor share computed using (33), and in the column labeled
“Using ELS” we use the procedure described in Donangelo et al. (2016) and construct “extended labor
share.” In both specifications, labor shares are standardized and twice lagged, and standard errors are
clustered at firm level.




                                                  89
        Table 6: FIRM-LEVEL WAGE PASS-THROUGHS AND LABOR SHARES

                          Coefficients            Using LS            Using ELS

                          LogSales                  0.4159               0.3187
                                                   (0.0422)             (0.0276)

                          LaborShare               -0.0726               -0.1648
                                                   (0.007)              (0.0061)

                          LaborShare ×              0.3871               0.3538
                          LogSales
                                                   (0.0776)             (0.0517)

                          Time fixed                 Yes                   Yes
                          effects

                          no. of obs                40289                117128
                          no. of entities            4028                 12806
Notes: The sample consist of firm-year observations from Compustat for the years 1959-2016. We follow
Donangelo et al. (2016) in the construction of firm labor share, the results of which are reported in the
column labeled “Using LS”, and the construction of extended labor share, the results of which are reported
in the column labeled “Using ELS.” In both specifications, labor shares are twice lagged, and standard errors
are clustered at the firm level.




                                                     90
        Table 7: FIRM-LEVEL WAGE PASS-THROUGHS AND LABOR SHARES

            Coefficients                                        Using LS            Using ELS

            LogSales plus                                          0.69                 0.55
                                                                  (0.05)               (0.04)
            LogSales minus                                         0.13                 0.12
                                                                  (0.06)               (0.04)
            Labor share                                            -0.02                -0.12
                                                                  (0.01)               (0.01)
            Labor share × LogSales plus                            0.00                  0.1
                                                                  (0.12)               (0.06)
            Labor share × LogSales minus                           0.76                 0.55
                                                                  (0.12)               (0.08)

            Time Fixed Effects                                     Yes                  Yes

Notes: The sample consist of firm-year observations from COMPUSTAT/CRSP merged files for the years
1959-2016. In the column labeled “Using LS” we use labor share computed using (33), and in the column
labeled “Using ELS” we use the procedure described in Donangelo et al. (2016) and construct “extended
labor share.” In both specifications, labor shares are standardized and twice lagged, and standard errors are
clustered at firm level.




                                                     91
                  Table 8: FIRM-LEVEL RETURNS AND LABOR SHARES

                          Coefficients              Using LS            Using ELS


                          Labor share                   1.24                 0.85
                                                      (0.43)               (0.20)
                          Leverage                     0.63                 1.17
                                                      (0.91)               (0.35)
                          log Assets                   -1.06                -2.22
                                                      (0.43)               (0.21)
                          Time Fixed                    Yes                  Yes
                          Effects

Notes: The sample consist of firm-year observations from COMPUSTAT for the years 1959-2016. We follow
Donangelo et al. (2016) in the construction of firm labor share, the results of which are reported in the
column labeled “Using LS”, and the construction of extended labor share, the results of which are reported
in the column labeled “Using ELS.” In both specifications, labor shares are twice lagged, and standard errors
are clustered at the firm level. Log Assets is the logarithm of book value of assets and Leverage is defined
as the ratio of long-term debt plus debt in current liabilities divided by total assets.




                                                      92
