                               NBER WORKING PAPER SERIES




      NONPARAMETRIC COUNTERFACTUAL PREDICTIONS IN NEOCLASSICAL
                  MODELS OF INTERNATIONAL TRADE

                                          Rodrigo Adao
                                         Arnaud Costinot
                                         Dave Donaldson

                                       Working Paper 21401
                               http://www.nber.org/papers/w21401


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2015




For useful comments we thank Ariel Burstein, Penny Goldberg, Andres Rodriguez-Clare, Bob Staiger,
Jon Vogel, and Ivan Werning as well as seminar participants at Brown University, the New York Federal
Reserve, Northwestern, Princeton, UC Berkeley, University of Oregon, and Yale. We are grateful
to Joe Shapiro for helping us to access data on freight costs. The views expressed herein are those
of the authors and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2015 by Rodrigo Adao, Arnaud Costinot, and Dave Donaldson. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Nonparametric Counterfactual Predictions in Neoclassical Models of International Trade
Rodrigo Adao, Arnaud Costinot, and Dave Donaldson
NBER Working Paper No. 21401
July 2015
JEL No. F10,F11,F14,F15,F17

                                               ABSTRACT

We develop a methodology to construct nonparametric counterfactual predictions, free of functional-form
restrictions on preferences and technology, in neoclassical models of international trade. First, we
establish the equivalence between such models and reduced exchange models in which countries directly
exchange factor services. This equivalence implies that, for an arbitrary change in trade costs, counterfactual
changes in the factor content of trade, factor prices, and welfare only depend on the shape of a reduced
factor demand system. Second, we provide sufficient conditions under which estimates of this system
can be recovered nonparametrically. Together, these results offer a strict generalization of the parametric
approach used in so-called gravity models. Finally, we use China's recent integration into the world
economy to illustrate the feasibility and potential benefits of our approach.


Rodrigo Adao                                           Dave Donaldson
Department of Economics, MIT                           Department of Economics
77 Massachusetts Avenue                                Stanford University
Cambridge, MA, 02139                                   579 Serra Mall
rradao@mit.edu                                         Stanford, CA 94305
                                                       and NBER
Arnaud Costinot                                        ddonald@stanford.edu
Department of Economics, E17-232
MIT
77 Massachusetts Avenue
Cambridge MA 02139
and NBER
costinot@mit.edu
1 Introduction
Many interesting questions in international economics are counterfactual ones. Consider
China’s recent export boom. In the last two decades, its share of world exports has in-
creased from 3% in 1995 to 11% in 2011. What if it had not? What would have happened
to other countries around the world?
    Given the challenges inherent in isolating quasi-experimental variation in general
equilibrium settings, the standard approach to answering such questions has been to pro-
ceed in three steps. First, fully specify a parametric model of preferences, technology and
trade costs around the world. Second, estimate the model’s supply- and demand-side pa-
rameters. And finally, armed with this complete knowledge of the world economy, pre-
dict what would happen if some of the model’s parameters were to change. Such Com-
putational General Equilibrium (CGE) models have long been used to answer a stream
of essential counterfactual questions; see e.g. Hertel (2013) for a survey of the influential
GTAP model. Over the last ten years or so, this tradition has been enhanced by an explo-
sion of quantitative work based on gravity models, triggered in large part by the seminal
work of Eaton and Kortum (2002).
   A key difference between old CGE models, like GTAP, and new CGE models, like
Eaton and Kortum (2002), is parsimony. The latest version of the GTAP model described
in Hertel, McDougall, Narayanan and Aguiar (2012) has more than 13,000 structural pa-
rameters. Counterfactual analysis in the Eaton and Kortum (2002) model can be con-
ducted using knowledge of only one: the trade elasticity. Parsimony is valuable. But it
hinges on strong functional form assumptions that may hinder the credibility of coun-
terfactual predictions. The goal of this paper is to explore the extent to which one may
maintain parsimony, but dispense with functional-form assumptions. In a nutshell, can
we relax Eaton and Kortum’s (2002) strong functional-form assumptions without circling
back to GTAP’s 13,000 parameters?
   Our starting point is the equivalence between neoclassical economies and reduced ex-
change economies in which countries simply trade factor services. Formally, we consider
a world economy comprising a representative agent in each country, constant returns to
scale in production, and perfect competition in all markets. In this general environment
we show that for any competitive equilibrium there is an equilibrium in a reduced ex-
change economy that is equivalent in terms of welfare, factor prices and the factor content
of trade—and further, that the converse is also true.
    This equivalence is important for its simplifying power: a reduced exchange economy
in which countries act as if they trade factor services can be characterized fully by an


                                             1
analysis of the reduced factor demand system that summarizes all agents’ preferences over
factor services. Thus for a number of counterfactual questions, like the effects of uni-
form changes in trade costs, one does not need the complete knowledge of demand and
production functions across countries and industries. For instance, one does not need
to know the cross-price elasticity between French compact cars and Italian cotton shirts
or between Korean flat screen TVs and Spanish heirloom tomatoes. Similarly, one does
not need to know productivity in these various economic activities around the world.
All one needs to know is the cross-price elasticity between factors from different coun-
tries. This basic observation encapsulates how we propose to reduce the dimensionality
of what needs to be estimated for counterfactual analysis—the reduced factor demand
system—without imposing strong functional-form assumptions.1
   Our second theoretical result establishes that, as long as the reduced factor demand
system is invertible, knowledge of this demand system as well as measures of the factor
content of trade and factor payments in some initial equilibrium are sufficient to construct
counterfactual predictions about the effect of changes in trade costs and factor endow-
ments. This result provides a nonparametric generalization of the methodology popular-
ized by Dekle, Eaton and Kortum (2008). Their analysis focuses on a Ricardian economy
in which the reduced labor demand system takes the Constant Elasticity of Substitution
(CES) form. This functional form assumption, however, is not a critical condition for the
previous approach to succeed; only the invertibility of the reduced factor demand is.
   The procedure that we propose to make counterfactual predictions relies on knowl-
edge of the reduced factor demand system. In gravity models, such systems are implicitly
assumed to be CES. Hence, a single trade elasticity can be estimated by regressing the log
of bilateral flows on an exogenous shifter of the log of bilateral trade costs, like tariffs or
freight costs. Our final set of theoretical results demonstrates that this approach can be
pushed further than previously recognized. Namely, we provide sufficient conditions un-
der which, given measures of the factor content of trade and observable shifters of trade
costs, reduced factor demand systems can be nonparametrically identified using the same
exclusion restrictions. As with our counterfactual results, the invertibility of the reduced
factor demand remains the critical assumption; strong functional form assumptions can
be dispensed with.

   1 It is worth emphasizing that this approach to dimensionality-reduction does not hinge on any assump-
tion about the number of goods and factors in the world. Regardless of whether there are more goods than
factors, the point is that one can estimate a single reduced demand system for factors rather than estimate
multiple production functions—that determine how factors are demanded by producers of goods—and
utility functions—that determine how goods are demanded by consumers. Of course, the fewer factors
there are, the easier the estimation of the reduced factor demand system is.

                                                    2
    We conclude our paper by applying our general results to one particular counter-
factual question: What would have happened to other countries if China had remained
closed? In practice, data limitations are severe—Leamer’s (2010) elusive land of “Asymp-
topia” is far away—and estimation of a reduced factor demand system must, ultimately,
proceed parametrically. So the final issue that needs to be tackled is how to parametrize
and estimate a reduced factor demand system without taking a stance on particular micro-
foundations. We offer the following rules of thumb: (i ) be as flexible as possible given
data constraints; (ii ) allow flexibility along the dimensions that are more likely to be rel-
evant for counterfactual question of interest; and (iii ) use the source of variation in the
data under which demand is nonparametrically identified.2
   Towards this goal in the present context, we introduce a strict generalization of CES,
which we refer to as mixed CES, inspired by the work of Berry (1994) and Berry, Levinsohn
and Pakes (1995) in industrial organization. Like in a standard gravity model, we assume
the existence of a composite factor in each country so that the factor content of trade be-
tween any pair of countries is equal to their bilateral trade flow. Compared to a standard
gravity model, however, our demand system features two new structural parameters that
measure the extent to which exporters that are closer in terms of either market shares or
some observable characteristic, which we take to be GDP per capita, tend to be closer
substitutes. Under CES, when China gains market share, Indian and French exports must
be affected equally. By contrast, the mixed CES demand system allows data to speak to
whether this “independence of irrelevant alternatives” embodied in CES holds empiri-
cally or not.
    After estimating our mixed CES demand system for 37 large exporters using data on
bilateral trade flows and freight costs from 1995 to 2011, we conclude that rich countries
tend to gain relatively more than poor countries from China’s integration with the rest of
the world—that is, rich countries would have been relatively worse off if Chinese trade
costs had counterfactually remained at their 1995 value from 1995 to 2011. Under the
restriction that demand is CES, no such pattern emerges.
   Up to this point, we have emphasized the feasibility and potential benefits of our new
approach to counterfactual and welfare analysis. It should be clear that our approach
also has important limitations. We discuss these further below but four deserve emphasis
here. First, the equivalence result on which we build heavily relies on the efficiency of
perfectly competitive markets. This does not mean that our approach will necessarily

   2 In  their original paper on the CES function, Arrow, Chenery, Minhas and Solow (1961) note that one
of its attractive features is that it is “the most general function which can be computed on a suitable slide
rule.” Computing power has since improved.

                                                     3
fail if one were to relax the assumption of perfect competition or introduce distortions—
indeed, Arkolakis et al. (2012a) and Arkolakis et al. (2012b) offer examples in this vein that
cover a number of influential modeling approaches—but it is fair to say that it is much less
likely to be useful in such circumstances. Second, the scope of the counterfactual exercises
that we consider is limited by the restriction that the shape of the reduced demand system
remains stable. Uniform changes in iceberg trade costs satisfy this condition, but many
interesting shocks do not, a point we come back to in Section 4.3. Third, the restriction that
the demand system is invertible implicitly excludes zeros in bilateral factor trade. So our
nonparametric approach does not solve the “zeros issue” in standard gravity models.3
Fourth, the estimation of a reduced factor demand system requires that the factor content
of trade be measured accurately. Since the seminal work of Leontief (1953), multiple
generations of trade economists have combined input-output matrices with trade data to
do so, but the high-level of aggregation of such matrices leaves open the possibility of
mis-measurement, a point emphasized more recently by Burstein and Vogel (2010).4
   The rest of our paper is organized as follows. Section 2 discusses the related literature.
Section 3 establishes our main equivalence result. Section 4 uses this result to conduct
counterfactual and welfare analysis. Section 5 provides sufficient conditions for nonpara-
metric identification. Section 6 estimates factor demand. Section 7 uses these estimates to
study the consequences of China’s integration with the rest of the world. Section 8 offers
some concluding remarks.




    3 This is a version of the “new goods problem” that is common in many demand settings (Bresnahan
and Gordon, 2008). Just as in those settings, one can typically place a lower bound on the welfare effects of a
counterfactual by requiring that zeros cannot become positive. For our purposes, the more specific question
is whether the challenge posed by zeros in the data is alleviated or worsened by the study of reduced factor
demand relative to standard gravity approaches. The answer depends on the assumptions that one makes
about the number of goods and factors. If one assumes the existence of a composite factor in each country,
as we do in our empirical analysis, then focusing on factor demand reduces the prevalence of zeros relative
to any analysis that would focus on trade in goods.
    4 In particular, national input-output matrices do not disaggregate factor payments by destination

within each producing country-times-industry cell. The implicit assumption used to measure the factor
content of trade in the empirical literature therefore is that factor intensity is constant across destinations.
Since micro-level evidence, e.g. Bernard and Jensen (1999), suggests systematic variation in factor intensity
between firms that serve domestic and foreign markets, one could potentially improve on the measurement
of the factor content of trade by combining aggregate data from the national accounts and micro-level data
in a consistent way. We do not attempt to do so in this paper, but we note that, according to our theoretical
results, any researcher interested in our counterfactual exercises would also be affected by this issue, albeit
perhaps less explicitly.

                                                       4
2 Related Literature
This paper combines old ideas from general equilibrium theory with recent methods from
industrial organization and international trade to develop a new way of constructing
counterfactual predictions in an open economy.
   From the general equilibrium literature, we borrow the idea that, for many purposes,
production economies may be reduced to exchange economies; see e.g. Taylor (1938),
Rader (1972), and Mas-Colell (1991). Early applications of this idea to international trade
can be found in Meade (1952), Helpman (1976), Woodland (1980), Wilson (1980), and
Neary and Schweinberger (1986). Among those, Helpman (1976), Wilson (1980), and
Neary and Schweinberger (1986) are most closely related. Helpman (1976) shows how to
reduce computation time necessary to solve for trade equilibria by focusing on the excess
demand for factors, whereas Neary and Schweinberger (1986) introduce the concept of
direct and indirect factor trade utility functions and use revealed-preference arguments
to generalize the Heckscher-Ohlin Theorem. Finally, Wilson (1980) demonstrates that the
analysis of the Ricardian model can be reduced to the analysis of an exchange model in
which each country trades its own labor for the labor of other countries.
   One can think of the starting point of our paper as a generalization of Wilson’s (1980)
equivalence result to any neoclassical trade model. Compared to the aforementioned
papers, our main contribution is to show how the equivalence between neoclassical trade
models and exchange models can be used as a tool for counterfactual and welfare analysis
using commonly available data on trade flows, factor payments, and trade costs. Here,
reduced exchange models are a first step towards measurement and estimation, not an
analytical device for studying the theoretical properties of competitive equilibria.
   We view our paper as a bridge between the recent gravity literature, reviewed in
Costinot and Rodríguez-Clare (2013) and Head and Mayer (2013), and the older neo-
classical trade literature, synthesized in Dixit and Norman (1980).5 With the former, we
share an interest in combining theory and data to shed light on counterfactual questions.
With the latter, we share an interest in robust predictions, free of strong functional form
assumptions. Since data is limited, there is a tension between these two goals. To make
progress on the first, without giving up on the second, we therefore propose to use factor
demand as a sufficient, albeit potentially high dimensional, statistic. This strategy can
be thought of as a nonparametric generalization of Arkolakis, Costinot and Rodríguez-
Clare’s (2012a) approach to counterfactual and welfare analysis. Ultimately, there is noth-

   5 Further results about the theoretical properties of gravity models, including sufficient conditions for
existence and uniqueness of equilibria, can be found in Allen, Arkolakis and Takahashi (2014).

                                                     5
ing special about gravity models. They are factor demand systems, like any other neo-
classical trade model. And like any demand system, factor demand systems can be esti-
mated using data on quantities, prices, and some instrumental variables. Once this basic
econometric issue is recognized, it becomes natural to turn to the recent results on the
nonparametric identification of demand in differentiated markets; see e.g. Berry, Gandhi
and Haile (2013) and Berry and Haile (2014).
   Our analysis is also related to the large empirical literature on the determinants of
the factor content of trade. A long and distinguished tradition—e.g. Bowen, Leamer and
Sveikauskas (1987), Trefler (1993), Trefler (1995), and Davis and Weinstein (2001)—aims to
test the Heckscher-Ohlin-Vanek model by comparing the factor content of trade measured
in the data to the one predicted by the model under various assumptions about technol-
ogy, preferences, and trade costs (or lack thereof). Our goal is instead to estimate a factor
demand system and use these estimates to conduct counterfactual and welfare analysis.
In order to test or assess the fit of the Heckscher-Ohlin-Vanek model in some observed
equilibrium, one does not need to know the cross-price elasticities between factors from
different countries. Indeed, such tests are often conducted under the assumption that
factor price equalization holds, up to some factor-augmenting productivity differences,
so that factors from different countries are assumed to be perfect substitutes. For our
purposes, knowledge of cross-price elasticities is critical.
   Finally, our work has implications for the debate about the extent to which the factor
content of trade observed in one equilibrium can be used (or not) for measuring the conse-
quences of international trade on inequality; see e.g. Deardorff and Staiger (1988), Krug-
man (2000) and Leamer (2000). Such a discussion implicitly boils down to the question
of what shape factor demand systems take and whether factors from different countries
are perfect substitutes (or not). Our analysis points towards estimating these systems as
a way to settle such debates.


3 Neoclassic Trade Models as Exchange Models

3.1 Neoclassical Trade Model
Consider a world economy comprising i = 1, ..., I countries, k = 1, ..., K goods, and n =
1, ..., N primary factors of production. Factor supply is inelastic. νi ≡ {νin } denotes the
vector of factor endowments in country i.




                                             6
Preferences. In each country i, there is a representative agent with utility,

                                                 ui = ui ( q i ),

where qi ≡ {qkji } is the vector of quantities consumed in country i and ui is strictly in-
creasing, quasiconcave, and differentiable. The previous notation allows, but does not
require, ui to depend only on {∑ j qkji }. Hence, we explicitly allow, but do not require,
goods produced in different countries to be imperfect substitutes. Compared to recent
quantitative work in the field, we impose no functional-form assumptions on u, though
the assumption of a representative agent is by no means trivial.
Technology. Production is subject to constant returns to scale. Output of good k in coun-
try i that is available for consumption in country j is given by

                                                qijk = f ijk (l ijk ),

where l ijk ≡ {lijnk } is the vector of factors used to produce good k in country i for country
j, and f ijk is strictly increasing, concave, differentiable, and homogeneous of degree one.
    Compared to recent quantitative work in the field, we again impose no functional-
form assumptions on f ijk . For instance, it is standard in the existing literature to assume
that the difference between production functions across different destinations derive from
iceberg trade costs. This special case corresponds to the existence of Hicks-neutral pro-
ductivity shifters, τijk , such that

                                          f ijk (l ijk ) ≡ f ik (l ijk )/τijk .

In an Arrow-Debreu sense, a good in our economy formally corresponds to a triplet
(i, j, k), whereas a factor formally corresponds to a pair (i, n), with the usual wide in-
terpretation. Though we impose constant returns to scale, decreasing returns in produc-
tion can be accommodated in the usual way by introducing additional primary factors
of production. Endogenous labor supply can be dealt with by treating leisure as another
nontradable good. Multinational production, as in Ramondo and Rodríguez-Clare (2013),
can also be accommodated by expanding the set of goods and using a different index k for
goods whose “technologies” originate in different countries. Finally, the assumption of
no joint production can be relaxed substantially. The key requirement for our equivalence
result is that there is no component of production that is joint across destination markets,
as would be the case in the presence of fixed costs of production.6 Besides the absence of
   6 This   implies that our theoretical framework can accomodate economies in which there are multiple

                                                           7
increasing returns in each sector, the only substantial restriction imposed on technology is
the absence of intermediate goods. We discuss how to incorporate such goods in Section
4.3.

Competitive equilibrium. Goods markets and factor markets are perfectly competitive.
We let pijk denote the price of good k from country i in country j and win denote the price
of factor n in country i. Letting q ≡ {qi }, l ≡ {l ijk }, p ≡ { pijk }, and w ≡ {win }, we can
then define a competitive equilibrium as follows.

Definition 1. A competitive equilibrium corresponds to (q, l, p, w ) such that:

   i. consumers maximize their utility:

                                        qi ∈ argmaxq̃ ui (q̃i )                                      (1)
                                                                  i

                                             ∑ pkji q̃kji ≤ ∑ win νin for all i;                     (2)
                                              j,k                     n


   ii. firms maximize their profits:

                                                          k
                          l ijk ∈ argmax k pijk f ijk (l̃ ij ) − ∑ win l˜ijnk for all i, j, and k;   (3)
                                           l̃ ij
                                                                          n


  iii. goods markets clear:
                                         qijk = f ijk (l ijk ) for all i, j, and k;                  (4)

  iv. factors markets clear:
                                                    fk
                                             ∑ lij       = νin for all i and n.                      (5)
                                              j,k


3.2 Reduced Exchange Model
An old idea in general equilibrium theory is that it is often simpler to analyze the compet-
itive equilibrium of a neoclassical model with production by studying instead a fictitious
endowment economy in which consumers directly exchange factor services; see e.g. Tay-
lor (1938), Rader (1972), and Mas-Colell (1991). Although this idea is often associated in
the trade literature with the Heckscher-Ohlin model, it applies equally well to the Ricar-
dian model of trade; see e.g. Wilson (1980). We now offer a formal proof of the equiva-
lence between a general neoclassical trade model and an exchange economy, in terms of


regions within a country and firms in each region jointly produce goods and amenities.

                                                              8
the factor content of trade, factor prices, and welfare. This equivalence result will be the
backbone of our approach to counterfactual and welfare analysis in Section 4.
   Starting from the neoclassical trade model of Section 3.1, we can define the reduced
utility function over primary factors of production in country i as

                                         Ui ( Li ) ≡ maxq̃ ,l̃ i ui (q̃i )                                                       (6)
                                                                i
                                                                    k
                                                   q̃kji ≤ f jik (l̃ ji ) for all j and k,                                       (7)

                                                    ∑ l˜nk    n
                                                        ji ≤ L ji for all j and n,                                               (8)
                                                     k

where Li ≡ { Lnji } denotes the vector of total factor demands from country i. It describes
the maximum utility that a consumer in country i would be able to achieve if she were
endowed with Li and had access to the technologies of all firms around the world.7 One
can check that Ui (·) is strictly increasing and quasiconcave, though not necessarily strictly
quasiconcave, even if ui (·) is.8 In particular, Ui (·) is likely to be linear whenever produc-
tion functions are identical around the world. While this situation is obviously knife-
edge, this is the special case on which the Heckscher-Ohlin model of trade focuses. We
therefore explicitly allow for such situations below.
   Letting L ≡ { Li }, we can define a competitive equilibrium of the reduced exchange
model or, in short, a reduced equilibrium.
Definition 2. A reduced equilibrium corresponds to ( L, w ) such that:

    i. consumers maximize their reduced utility:

                                                Li ∈ argmax L̃i Ui ( L̃i )                                                       (9)

                                                    ∑ wnj L̃nji ≤ ∑ win vin for all i;
                                                    j,n                 n

    7 The  above definition is closely related to, but distinct from, the notion of the “direct factor trade utility
function” introduced in Neary and Schweinberger (1986). The distinction comes from the fact that Neary
and Schweinberger’s (1986) factor trade utility function measures the maximum utility attainable if all con-
sumption must be produced using the techniques of the home country. In our definition, each country is
assumed to have access to the techniques in all other countries, inclusive of trade costs. This distinction
is important. As we will show in a moment, the factor content of trade derived from solving (6) coincides
with the factor content of trade in the competitive equilibrium. This would no longer be true if one were to
maximize Neary and Schweinberger’s (1986) factor trade utility function.
    8 The fact U is strictly increasing in L is trivial. To see that U is quasi-concave, take two vectors of
                  i                            i                              i
factor demand, Li and L̃ i , and α ∈ [0, 1]. Let (q, l ) and (q̃, l̃ ) be the solution of (6) associated with L i
and L̃i , respectively. Now consider (q̄, l̄ ) ≡ α(q, l ) + (1 − α)(q̃, l̃ ). By construction, l¯ trivially satisfies (8).
                                                                               k             k
Since f jik is concave, we also have q̄kji ≤ α f jik (l kji ) + (1 − α) f jik (l̃ jn ) ≤ f jik (l̄ jn ) for all j and k. This implies
Ui (αLi + (1 − α) L̃i ) ≥ ui (q̄) ≥ min{ui (q), ui (q̃)} = min{Ui ( Li ), Ui ( L̃i )} where the second inequality
follows from the quasiconcavity of ui .

                                                                    9
   ii. factor markets clear:
                                          ∑ Lijn = νin for all i and n.                                (10)
                                           j

Our main equivalence result can be stated as follows.

Proposition 1. For any competitive equilibrium, (q, l, p, w ), there exists a reduced equilibrium,
( L, w), with: (i ) the same factor prices, w; (ii ) the same factor content of trade, Lijn = ∑k lijnk
for all i, j, and n; and (iii ) the same welfare levels, Ui ( L i ) = ui (qi ) for all i. Conversely, for
any reduced equilibrium, ( L, w ), there exists a competitive equilibrium, (q, l, p, w ), such that
conditions (i )-(iii ) hold.

   The formal proof of Proposition 1 can be found in Appendix A.1. The basic argu-
ments are similar to those used in proofs of the First and Second Welfare Theorems.
This should be intuitive. In the reduced equilibrium, each representative agent solves
a country-specific planning problem, as described in (6). Thus, showing that any compet-
itive equilibrium is associated with an equivalent reduced equilibrium implicitly relies
on the efficiency of the original competitive equilibrium, which the First Welfare The-
orem establishes. Similarly, showing that any reduced equilibrium is associated with
an equivalent competitive equilibrium implicitly relies on the ability to decentralize ef-
ficient allocations, which the Second Welfare Theorem establishes. The key distinction
between Proposition 1 and standard Welfare Theorems is that the reduced equilibrium is
not a global planner’s problem; it remains a decentralized equilibrium in which countries
fictitiously trade factor services and budgets are balanced country by country. Broadly
speaking, we do not go all the way from the decentralized equilibrium to the global
planner’s problem, but instead stop at a hybrid reduced equilibrium, which combines
country-specific planner’s problems with perfect competition in factor markets.9
   According to Proposition 1, if one is interested in the factor content of trade, factor
prices, or welfare, then one can always study a reduced equilibrium—whose primitives
are the reduced utility functions, {Ui }, and the endowments, {νi }—rather than a com-
petitive equilibrium—whose primitives are the utility functions, {ui }, the endowments,
{νi }, and the production functions, { f ijk }. In order to do counterfactual and welfare anal-
ysis, one does not need to have direct knowledge of both the utility functions, {ui }, and
the production functions, { f ijk }. Instead, one merely needs to know how they indirectly
   9 This implies, in particular, that the convexity of preferences and technology, which is central in the
proof of the Second Welfare Theorem, plays no role in the proof of Proposition 1. In the Second Welfare
Theorem, convexity is invoked for Lagrange multipliers, and in turn, competitive prices to exist. Here,
competitive prices for goods can be directly constructed from factor prices in the reduced equilibrium using
zero-profit conditions.

                                                    10
shape, {Ui }, and in turn global factor demand—that is, the solution of the reduced utility
maximization problem (9).10


4 Counterfactual and Welfare Analysis
We start by considering counterfactual shocks to preferences and factor endowments in
a reduced exchange model. In this context, we show how to extend the exact algebra
popularized by Dekle, Eaton and Kortum (2008) in the context of a CES demand system
to general, non-CES environments. Perhaps surprisingly, the critical assumption required
for the previous approach to succeed is not strong functional form assumptions on the
structure of factor demand, it is merely its invertibility. Using the equivalence result from
Section 3, we then show how the previous counterfactual predictions can be used to study
the effect of changes in endowments and technology in a general neoclassical model of
trade.


4.1 Reduced Counterfactuals
Consider a reduced exchange model in which the reduced utility function over primary
factors can be expressed as
                                        Ui ( Li ) ≡ Ūi ({ Lnji /τjin }),                                 (11)

where Ūi is a strictly increasing and quasi-concave utility function and τjin > 0 are ex-
ogenous preference shocks. The counterfactual question that we are interested in here is:
What are the effects of a change from (τ, ν) ≡ {τjin , vin } to (τ ′ , ν′ ) ≡ {(τjin )′ , (vin )′ } on trade
flows, factor prices, and welfare?


4.1.1 Trade Flows and Factor Prices

For each country i, let Li (w, yi |τ ) denote the set of solutions to the utility maximization
problem (9) as a function of factor prices, w, income, yi ≡ ∑n win νin , and preference param-
eters, τ. This corresponds to the Marshallian demand for factor services in the reduced




   10 This istrue regardless of whether the competitive and reduced equilibria are unique. Formally, Propo-
sition 1 establishes that the set of factor prices, factor content of trade, and welfare levels that can be ob-
served in a competitive equilibrium is the same as the set of factor prices, factor content of trade, and
welfare levels that can be observed in a reduced equilibrium. Whether the previous sets are singletons is
irrelevant for our equivalence result.

                                                      11
equilibrium. The associated vectors of factor expenditure shares are then given by

                χi (w, yi |τ ) ≡ {{ x nji }| x nji = wnj Lnji /yi for some Li ∈ Li (w, yi |τ )}.

Since preference shocks are multiplicative, expenditure shares must depend only on the
“effective” factor prices, ωi ≡ {wnj τjin }. We can therefore write, with a slight abuse of nota-
tion and without risk of confusion, χi (w, yi |τ ) ≡ χi (ωi , yi ). Using the previous notation,
the equilibrium conditions (9) and (10) can then be expressed compactly as

                                               xi ∈ χi (ωi , yi ) for all i,                             (12)
                                      ∑    xijn y j   =   yin ,   for all i and n,                       (13)
                                       j


where xi ≡ { x nji } denotes the vector of factor expenditure shares in country i and yin ≡
win νin denotes payments to factor n.
    A standard gravity model, such as the one developed by Anderson and Van Wincoop
(2003) and Eaton and Kortum (2002), corresponds to the special case in which there is
only one factor of production in each country and factor demand is CES. Omitting the
index for factors, n, such models require

                                                       (ω ji )ǫ
                                χ ji (ωi , yi ) =                , for all j and i,                      (14)
                                                      ∑l (ωli )ǫ

for some trade elasticity ǫ > 1; see Arkolakis, Costinot and Rodríguez-Clare (2012a) and
Costinot and Rodríguez-Clare (2013) for further discussion.11 We now proceed under the
assumption that χi is known, but dispense with any functional-form restriction.
   In what follows we refer to χi as the factor demand system in country i. The only
assumption that we impose on the factor demand system is its invertibility.
A1 [Invertibility]. In any country i, for any vector of expenditure shares, x > 0, and any
income level, y > 0, there exists a unique vector of factor prices (up to a normalization) such that
x ∈ χi (ω, y), which we denote χi−1 ( x, y).
    In line with A1, we restrict ourselves from now on to equilibria such that xi > 0 for
all i.12 Let xi′ ≡ {( x nji )′ } and w′ denote the counterfactual expenditure shares and fac-
tor prices in the counterfactual equilibrium with preference parameters and endowments
   11 Inthis case, total income, y i , has no effect on factor expenditure shares because of homotheticity.
   12 By xi > 0, we formally mean x nji > 0 for all j and n. Zero expenditure shares create two issues. First,
factor prices can no longer be inferred from expenditure shares. Typically, they can only be bounded from
below. Second, proportional changes between the initial and counterfactual equilibrium, on which our
analysis focuses, are no longer well-defined. Empirically, zeros are irrelevant for the sample of countries

                                                              12
given by (τ ′ , ν′ ). The basic idea behind the exact hat algebra of Dekle, Eaton and Kor-
tum (2008) is twofold: (i ) focus on the proportional changes in expenditure shares and
factor prices, x̂i ≡ {( x nji )′ /x nji } and ŵ ≡ {(wnj )′ /wnj }, caused by proportional changes in
preferences and endowments, τ̂ ≡ {(τijn )′ /τijn } and ν̂ ≡ {(νin )′ /νin }; and (ii ) use data on
expenditure shares, xijn , as well as factor payments, yin , in the initial equilibrium to extract
information about the underlying structural parameters of the model. There is nothing in
this general strategy that hinges on the demand system being CES. Invertibility of factor
demand is the critical assumption.
   Let us start by rewriting the equilibrium conditions (12) and (13) at the counterfactual
values of the preference and endowment parameters, (τ ′ , ν′ ):

                                                          xi′ ∈ χi (ωi′ , yi′ ) for all i,
                                             ∑(xijn )′ y′j = (yin )′ , for all i and n.
                                              j


These two conditions, in turn, can be expressed in terms of proportional changes,

                                             { x̂ nji x nji } ∈ χi ({ŵnj τ̂jin ω nji }, ∑ ŵin ν̂in yin ) for all i,
                                                                                           n

                    ∑    x̂ijn xijn (   ∑   ŵnj ν̂jn ynj )   =   ŵin ν̂in yin ,   for all i and n,
                     j                  n


where we have used the fact that total income in the counterfactual equilibrium is equal to
the sum of total factor income, yi′ = ∑n (yin )′ . Finally, using A1, we can eliminate the effec-
tive factor prices in country i, ω nji , from the previous expression using initial expenditure
shares, xi , and income levels, yi . This leads to the following proposition.

Proposition 2. Suppose that A1 holds and the reduced utility function satisfies (11). Then
the proportional changes in expenditure shares and factor prices, x̂i ≡ {( xijn )′ /xijn } and ŵ ≡
{(wnj )′ /wnj }, caused by the proportional changes in preferences and endowments, τ̂ ≡ {(τijn )′ /τijn }
and ν̂ ≡ {(νin )′ /νin }, solve

                                  { x̂ nji x nji } ∈ χi ({ŵnj τ̂jin (χnji )−1 ( xi , yi )}, ∑ ŵin ν̂in yin ) for all i,   (15)
                                                                                                 n

             ∑ x̂ijn xijn (∑ ŵnj ν̂jn ynj ) = ŵin ν̂in yin , for all i and n.                                             (16)
              j             n


    Once proportional changes in expenditure shares and factor prices have been solved
for, the value of imports of factor n from country i in country j in the counterfactual
and the level of aggregation at which we will conduct our estimation and counterfactual simulation.

                                                                          13
equilibrium, (Xijn )′ , can be simply computed as

                         (Xijn )′ = x̂ijn xijn (∑ ŵnj ν̂jn ynj ) for all i, j, and n.
                                              n

To sum up, if we know the factor demand system in all countries, {χi }, and have access
to data on expenditure shares and factor payments, { xijn } and {ynj }, then one can com-
pute counterfactual changes in factor trade and factor prices. Using standard arguments
from consumer theory, we establish next that the knowledge of χi is also sufficient for
computing welfare changes in country i.


4.1.2 Welfare

Consider an arbitrary country i. We are interested in computing the equivalent variation,
∆Wi , associated with a shock from (τ, ν) to (τ ′ , ν′ ). When expressed as a fraction of
country i’s initial income, this is given by

                                    ∆Wi = (ei (ωi , Ui′ ) − yi )/yi .                         (17)

where Ui′ denotes the utility level of country i in the counterfactual equilibrium and
ei (·, Ui′ ) denotes the expenditure function,

                         ei (ωi , Ui′ ) ≡ min L̃i {∑ ω nji L̃nji |Ūi ( L̃i ) ≥ Ui′ }.
                                                     n,j


By construction, ∆Wi measures the percentage change in income that the representative
agent in country i would be indifferent about accepting in lieu of the counterfactual
change from (τ, ν) to (τ ′ , ν′ ). Note that when preference shocks occur in country i—
i.e. when there is a change from τjin for some j and n—the expenditure function implicitly
measures the amount of income necessary to reach Ui′ given the original preferences, i.e.
given utility Ūi ({ Lnji /τjin }), taking into account that after the shock, the consumer maxi-
mizes Ūi ({ Lnji /(τjin )′ }). Since preference shocks are multiplicative, this is equivalent to a
change in effective factor prices from ωi ≡ {wnj τjin } to ωi′ ≡ {(wnj )′ (τjin )′ }.
    To compute ∆Wi , we can solve a system of Ordinary Differential Equations (ODEs),
as in Hausman (1981) and Hausman and Newey (1995). Since the expenditure function
ei (·, Ui′ ) is concave in the effective factor prices, it must be differentiable almost every-
where. The Envelope Theorem (e.g. Milgrom and Segal (2002), Theorem 1) therefore




                                                     14
implies

             dei (ω, Ui′ )/dω nj = Lnji (ω, ei (ω, Ui′ )) for all j and n and almost all ω,

with { Lnji (ω, ei (ω, Ui′ ))} that solves (9) at the effective factor prices, ω. Given our focus on
expenditure shares, it is convenient to rearrange the previous expression in logs. For any
selection { x nji (ω, y)} ∈ χi (ω, y), we must have

          d ln ei (ω, Ui′ )/d ln ω nj = x nji (ω, ei (ω, Ui′ )) for all j and n and almost all ω.   (18)

By budget balance in the counterfactual equilibrium, we also know that

                                             ei (ωi′ , Ui′ ) = yi′ ,                                (19)

where ωi′ is the vector of effective factor prices in the counterfactual equilibrium.
   The expenditure function ei (·, Ui′ ) must be equal to the unique solution of (18) satis-
fying (19). This solution can be computed given knowledge of any selection { x nji (·, ·)} ∈
χi (·, ·), country i’s income level in the counterfactual equilibrium, yi′ = ∑n ŵin ν̂in yin , and
the effective factor prices in the counterfactual equilibrium, ωi′ = {ŵnj τ̂jin (χnji )−1 ( xi , yi )},
with ŵ given by (15) and (16). Once ei (·, Ui′ ) has been solved for, we can again use the
invertibility of demand to substitute for the initial effective factor prices in equation (17).
This leads to our next proposition.

Proposition 3. Suppose that A1 holds and the reduced utility function satisfies (11). Then the
equivalent variation associated with a change from (τ, ν ) to (τ ′ , ν′ ), expressed as a fraction of
country i’s initial income, is

                             ∆Wi = (e({(χnji )−1 ( xi , yi )}, Ui′ ) − yi )/yi ,                    (20)

where e(·, Ui′ ) is the unique solution of (18) and (19).


4.2 Application to Neoclassical Trade Models
Our goal now is to find structural shocks in a neoclassical trade model that are isomorphic
to preference and endowment shocks in a reduced exchange model. By Propositions 1-
3, counterfactual predictions about factor content of trade, factor prices, and welfare in
neoclassical model can then be computed using equations (15)-(20).



                                                      15
    Consider a neoclassical trade model in which technology can be expressed as

                              f ijk (l ijk ) ≡ f¯ijk ({lijnk /τijn }), for all i, j, and k,            (21)

where τijn denotes factor-augmenting productivity shocks, that are common to all goods
for a given exporter-importer pair. Since these productivity shocks are bilateral in nature,
we simply refer to them as trade cost shocks from now on.13
   Given equation (21), the reduced utility function over primary factors of production
associated with the present neoclassical trade model can be written as

                             Ui ( L i ) ≡ maxq̃ ,l̃ i ui (q̃i )
                                                      i

                                       q̃kji   ≤ f¯jik ({l˜nk    n
                                                           ji /τ ji }) for all j and k,

                                        ∑ l˜nk    n
                                            ji ≤ L ji for all j and n.
                                         k

A simple change of variable then implies

                                          Ui ( Li ) ≡ Ūi ({ Lnji /τjin }),

with

                                   Ūi ( Li ) ≡ maxq̃ ,l̃ i ui (q̃i )
                                                           i
                                                                k
                                               qkji ≤ f¯jik (l̃ ji ) for all j and k,

                                                ∑ l˜nk    n
                                                    ji ≤ L ji for all j and n.
                                                 k

Thus, if technology satisfies (21), Ui (·) satisfies (11). Not surprisingly, trade cost shocks in
a neoclassical trade model are equivalent to preference shocks in the associated reduced
exchange model. Since endowment shocks are identical in neoclassical trade models and
reduced exchange models, we arrive at the following corollary of Propositions 1-3.

Corollary 1. Suppose that A1 holds and that technology satisfies (21). Then the proportional

  13 Formally,  a change in iceberg trade costs between countries i and j corresponds to the special case in
which productivity shocks are Hicks-neutral for a given exporter-importer pair, i.e., τijn = τij . Note that
while the productivity shocks considered in equation (21) may not vary across goods, equation (21) does
allow for a very rich set of heterogeneous trading frictions in the initial equilibrium: f¯ijk may vary with
both i and j for all k. Thus, some goods may be more costly to trade than others. Similarly, goods that are
exported may have different factor intensity than goods that are sold domestically, as in Matsuyama (2007).
Note also that the productivity shocks considered in equation (21) may vary across factors n. Hence, our
model can accommodate economies in which only a subset of individuals get access to foreign markets.

                                                           16
changes in the factor content of trade, factor prices, and welfare caused by trade cost shocks and
endowment shocks in a neoclassical trade models, τ̂ ≡ {(τijn )′ /τijn } and ν̂ ≡ {(νin )′ /νin }, are
given by (15)-(20).

   To sum up, equations (15)-(20) provide a system of equations that can be used for
counterfactual and welfare analysis. It generalizes the exact hat algebra of Dekle, Eaton
and Kortum (2008) developed in the case of Constant Elasticity of Substitution (CES) fac-
tor demands to any invertible factor demand system. Namely, given data on expenditure
shares and factor payments, { x nji } and {yin }, if one knows the factor demand system, χi ,
then one can compute counterfactual changes in factor prices, aggregate trade flows, and
welfare.14 Sections 5 and 6 discuss identification and estimation, respectively, of the factor
demand system, χi . Before doing so, we briefly discuss some extensions of the previous
results.


4.3 Extensions
4.3.1 Sector-specific trade cost shocks

Our approach emphasizes that in any neoclassical trade model, it is as if countries were
directly trading factor services. As we have shown in the previous subsection, this ap-
proach is well-suited to study factor-augmenting productivity shocks, in general, and
uniform changes in iceberg trade costs, in particular. While such shocks are of indepen-
dent interest, they are restrictive. For instance, one may want to study trade cost shocks
that only affect a subset of sectors in the economy. Here, we demonstrate how our analy-
sis can be extended to cover such cases.
    Consider the same neoclassical economy as in Section 4.2 with technology satisfying
(21). For expositional purposes, consider a counterfactual shock that only affects produc-
tivity, τijnk , of one factor, n, for one country pair, i and j, in a single sector, k. To study such
a counterfactual scenario, we only need to add one factor and one non-arbitrage condi-
tion to our previous analysis. Namely, instead of only having “factor n in country i,” we
can define “factor n from country i that is used to produce good k for country j” and “fac-
tor n from country i that is not.” The price of both factors in a competitive equilibrium,
of course, should be the same. Given this new set of factors, all shocks remain uniform
across goods. Thus, the results of Section 4.2 still apply.


   14 LikeProposition 1, the above corollary holds whether or not a competitive equilibrium is unique. If
there are multiple equilibria, then there is a set of proportional changes in the factor content of trade, factor
prices, and welfare caused by τ̂ and ν̂, but this set remains characterized by (15)-(20).

                                                       17
   Of course, as trade cost shocks become more and more heterogeneous across sectors,
our emphasis on the factor content of trade becomes less and less useful. In the extreme
case where all goods are subject to a different shock, it is no simpler to study a reduced
exchange model with K × N factors in each country than the complete neoclassical trade
model with K goods and N factors. The flip-side of this observation is that, away from this
extreme case, our approach is always useful in the sense that it reduces the dimensionality
of what needs to be estimated, i.e., the factor demand system.


4.3.2 Tariffs

Historically, an important application of CGE models has been the analysis of regional
trade agreements, such as NAFTA and the European Union, in which the counterfactual
shocks of interest were not productivity shocks but rather changes in trade policy; see
e.g. Baldwin and Venables (1995) for a survey. We now discuss how our analysis can be
extended to analyze the effects of changes in ad-valorem trade taxes. For pedagogical
purposes, it is useful to start from a reduced exchange model, as in Section 4.1, but one in
which a factor n being traded between country i and country j is subject to an ad-valorem
import tax or subsidy, tijn . Once this case has been dealt with, the empirically relevant case
in which tariffs vary across sectors, not factors, can be dealt with by redefining factors
appropriately, as in Section 4.3.1.15
   The key difference between the reduced equilibrium with and without trade taxes is
that taxes raise revenue. This needs to be added to factor income in equations (15) and
(16) when computing changes in factor prices and the factor content of trade. Formally,
consider a change in trade taxes from t ≡ {tijn } to t ′ ≡ {(tijn )′ }. The counterparts of
equations (15) and (16) in this situation become

                            { x̂ nji x nji } ∈ χi ({ŵnj (1 +ˆ tnji )(χnji )−1 ( xi , yi )}, ŷi yi ) for all i,

                    ∑ x̂ijn xijn ŷ j y j = ŵin ν̂in win νin , for all i and n,
                      j


with total income, inclusive of tax revenues, such that

                          yi =   ∑ yin /(1 − ∑ ∑ tnji xnji /(1 + tnji )) for all i,
                                  n                j    n

                    ŷi yi =     ∑ ŵin ν̂in yin /(1 − ∑ ∑(tnji )′ x̂nji xnji /(1 + tnji )′ ) for all i.
                                  n                         j   n



  15 Wilson   (1980) discusses this issue in the context of the Ricardian model.

                                                                18
Equations (18)-(20) are unchanged. So, given information on tariffs, t and t’, changes in
the factor content of trade, factor prices, and welfare can still be computed using only:
(i ) data on initial expenditure shares and factor payments, { xijn } and {ynj }, and (ii ) an
estimate of the factor demand system, χi , in each country.


4.3.3 Intermediate Goods

The neoclassical trade model of Section 3 rules out intermediate goods. We conclude
by discussing how our theoretical analysis can be extended to environments with input-
output linkages. Consider an economy in which gross output of good k produced in
country i that is available in country j—either as a final good for consumers or an inter-
mediate good for firms—is given by

                                                qijk = f ijk (l ijk , mijk ),

                                                                                       gk
where l ijk ≡ {lijnk } still denotes the vector of factor demands and mijk ≡ {moij } is the vector
                             gk
of input demands, with moij being the amount of good g from the origin country o that
is used as an intermediate good in country i to produce good k and deliver it to country
j. In a competitive equilibrium, gross output must then be equal to the total demand by
consumers and firms,
                            cijk + ∑ mijd
                                      kl
                                          = qijk for all i, j, and k,
                                         l,d

where ci ≡ {ckji } denotes the vector of final demand in country i. All other assumptions
are the same as in Section 3.1.
   In this more general environment, we can still define a reduced utility function over
primary factors of production,

                         Ui ( Li ) ≡ maxq̃,m̃,c̃,l̃ ui (c̃i )
                                                      k
                                  q̃kjd ≤ f jd
                                            k
                                               (l̃ jd , m̃kjd ) for all d, j, and k,

                                  ∑ l˜nk    n
                                      jd ≤ L ji for all j and n,
                                   d,k
                                                      kg
                                  c̃kjd + ∑ m̃ jdr ≤ q̃kjd for all d, j, and k,
                                               g,r

                             kg
with q̃ ≡ {q̃kjd }, m̃ ≡ {m̃ jdr }, c̃ ≡ {c̃kjd }, and l̃ ≡ {l˜nk
                                                               jd }. Compared to the definition
of Section 3.2, the control variables now include gross output, intermediate goods, final
demands, and primary factors for all destination countries, d, not just country i. This


                                                            19
reflects the potential existence of global supply chains in which factors from country j
may be used to produce intermediate goods for country d, which are then used to produce
final goods for country i.16
    One can show that Proposition 1 still holds in this economy, with the factor content
of trade being computed as in Johnson and Noguera (2012). The only technicality is that
the proof now requires the Nonsubstitution Theorem to construct good prices in a com-
petitive equilibrium from factor prices in a reduced equilibrium. Conditional on the new
definition of the reduced utility function, Propositions 2 and 3 are unchanged. They can
be applied directly to study endowment shocks in a neoclassical model. When inter-
mediate goods are not traded or traded but their factor content is not re-exported, as in
Grossman and Rossi-Hansberg (2008), Propositions 2 and 3 can also be applied directly
to the analysis of changes in trade costs. When the factor content of intermediate goods
is re-exported, as in Yi (2003), Propositions 2 and 3 can still be used, but they require the
space of factors to be augmented, as in Section 4.3.1. Specifically, one needs to treat fac-
tors that are imported directly and indirectly differently since they are subject to different
(vectors of) iceberg trade costs.


5 Identification

5.1 Assumptions
In order to go from the economic model of Section 3.1 to an econometric model that can be
estimated, we need to make additional assumptions on which variables are unobservable
and which ones are not as well as the origins of the exogenous shocks generating the
observable variables.

Exogenous shocks. Consider a dataset generated by the model of Section 3.1 at different
dates indexed by t. At each point in time, we assume that preferences and technology in
the original neoclassical trade model satisfy

                             ui (qi,t ) = ū({qkji,t /θ ji }), for all i,                              (22)
                                      k
                              k
                            f ij,t (l ij,t ) = f¯ik ({lij,t
                                                       nk     n
                                                            /τij,t }), for all i, j, and k.            (23)

Factor endowments, {νi,tn }, and trade costs, {τ n }, are allowed to vary over time, but
                                                  ij,t
                                               ¯k
utility and production functions, {ui } and { f }, are assumed to be fixed. Differences
                                                              i
  16 Obviously,  a solution to the previous maximization problem must always feature ckjd = 0 for all d 6= i
since country i cannot benefit from final consumption in other countries.

                                                         20
in preferences across countries take the form of exporter-importer taste shifters, {θ ji },
that are common across all goods.17 In line with the analysis of Section 4, equations (22)
and (23) lead to the following restriction on the heterogeneity in factor demands across
countries.
A2. [Price heterogeneity] In any country i and at any date t, there exists a vector of effective
factor prices, ωi,t ≡ {wnj,t θ ji τji,t
                                   n }, such that factor demand can be expressed as χ̄ (ω , y ).
                                                                                         i,t i,t

   Under A2, reduced utility functions over primary factors of production in the reduced
exchange model are allowed to vary across countries and over time—either because of
primitive differences in preferences or technology—but this heterogeneity can be reduced
to differences in effective factor prices, i.e., factor prices adjusted by the relevant prefer-
ence and trade cost shocks. This implies that in order to identify the shape of factor
demand around the world, we only need to identify the shape of χ̄.
   An obvious benefit of A2 is that it reduces the dimensionality of the demand system
that we want to estimate by a factor I, equal to the number of countries in the world
economy. A more subtle, but crucial benefit of A2 is that the global factor demand,χ̄, can
be estimated using both time series and cross-sectional variation. This will allow us to
control for variations in endogenous factor prices, wnj,t , by including exporter-factor-year
dummies when estimating χ̄. Finally, note that A2 holds trivially in a gravity model, as
can be seen directly from (14).

Observables and unobservables. For any country i and for any date t, we assume that
effective factor prices, ωi,t ≡ {ω nji,t }, are unobservable and normalized so that:

                                             1
                                         ln ω1i,t = 0, for all i and t,                                     (24)
                                      E[ln ω nji,t ] = 0, for all j and n.                                  (25)

The first normalization amounts to expressing effective factor prices relative to factor 1
from country 1 in all markets (i, t). The second normalization is necessary to identify
separately effective factor prices from factor-specific taste shifters.18 The only observables
   17 Forexpositional purposes, we ignore time-varying preference shocks, θ ji,t . They could be dealt with in
the exact same way as we dealt with preference shocks in the reduced exchange model of Section 4.1. Note
also that the absence of sector-specific productivity shocks is sufficient, but not necessary. What is crucial
for the analysis below is that sector-specific productivity shocks do not affect the shape of factor demand.
For example, if all goods enter symmetrically in the utility function, then a weaker sufficient condition is
that the distribution of productivity across sectors is stable over time, though productivity in particular
sectors may go up or down at particular points in time. Hanson, Lind and Muendler (2014) offer empirical
evidence consistent with that weaker condition.
   18 One can always start from χ̄ ( ω , y ) and define χ̃ ( ω̃ , y ) ≡ χ̄({ω̃ n /α n }, y ) with ω̃ n = α n ω n
                                      i,t i,t                  i,t i,t         ji,t j     i,t        ji,t  j ji,t
for some αnj > 0. By construction, χ̄ and χ̃ must generate the exact same observables. However, ωi,t and

                                                       21
are: (i ) factor expenditure shares, xi,t ≡ { x nji,t }; (ii ) factor payments, yi,t ≡ {yi,t
                                                                                         n }; and (iii )

trade cost shifters, zi,t ≡ {znji,t }.19 We assume that trade cost shocks in the model, τji,t   n , are

related to trade cost shifters in the data through

                                        n
                                    ln τji,t = ln znji,t + ϕ̃nji + ξ̃ nj,t + εnji,t ,

where ϕ̃nji and ξ̃ nj,t are exporter-importer-factor and exporter-factor-year fixed-effects, re-
spectively, and εi,t ≡ {εnji,t } are idiosyncratic shocks. In Section 6, we will use data on bi-
lateral freight costs as trade cost shifters for (all) factors from a given destination. Combin-
ing the previous equation with the definition of effective factor prices, ω nji,t ≡ wnj,t θ ji τji,t
                                                                                                n ,

we then obtain

                       lnω nji,t = ln znji,t + ϕnji + ξ nj,t + εnji,t , for all i, j, n, and t,              (26)

with ϕnji ≡ ϕ̃nji + ln θ ji and ξ nj,t ≡ ξ̃ nj,t + ln wnj,t . The first set of fixed-effects, { ϕnji }, captures—
among other things—any source of trading frictions between country i and j that is stable
over time. This includes common proxies for trade costs like bilateral distance, whether
i and j share a common language, or whether they have colonial ties; see e.g. Anderson
and Van Wincoop (2003). Crucially, the second set of fixed effects, {ξ nj,t }, captures the
variations in factor prices, {wnj,t }, which are the key endogenous variables in our model.
    Throughout our analysis, we impose the following exogeneity restriction on the vector
of idiosyncratic shocks.
A3. [Exogeneity] E[εi,t | ln zi,t , di,t ] = 0, where di,t is a full vector of importer-exporter-factor
and exporter-factor-year dummies, with i as the importer and t as the year for all dummies.
   Because of equation (26), A3 is stronger than assuming that trade cost shifters, zi,t , can
be used as instruments for effective factor prices, ωi,t , after controlling for all factors that
are either exporter-importer-factor or exporter-factor-year specific. If we think of equa-
tion (26) as a first-stage, it implies that reduced-form and IV estimates should coincide.
Hence, we can infer the impact on factor demand of effective factor prices, which are not
observable, by tracing out the impact of trade cost shifters, which are observable. This
ω̃i,t cannot both satisfy (25).
    19 In principle, data on factor expenditure shares, x ≡ { x n }, and factor payments, y ≡ {y n }, can be
                                                         i,t     ji,t                           i,t    i,t
obtained from sources such as the World Input-Output Database. As already discussed in the Introduction,
a practical limitation of such datasets is that they implicitly assume that factor intensity is constant across
destinations within the same industry. For the empirical application of Section 6, such considerations will
be irrelevant since we will assume the existence of a composite factor in each country. Note also that for
the purposes of identifying the shape of factor demand, we will only need information on total income,
yi,t = ∑n yni,t , in each country. Data on factor payments, yi,t ≡ {yni,t }, are only necessary for counterfactual
analysis, as shown in Section 4.

                                                          22
is the same strategy used for the estimation of (constant) trade elasticities in the gravity
literature; see Head and Mayer (2013).20
    Following Newey and Powell (2003), we conclude by imposing the following com-
pleteness condition.
A4. [Completeness] For any g( xi,t , di,t , yi,t ) with finite expectation, E[ g( x i,t , di,t , yi,t )| ln zi,t , di,t ] =
0 implies g( xi,t , di,t , yi,t ) = 0.

A4 is the equivalent of a rank condition in the estimation of parametric models.21


5.2 Identifying Factor Prices and Factor Demand
We are now ready to establish that factor prices and factor demand are identified. The ar-
gument follows the same steps as in Berry and Haile (2014). Because our demand system
is invertible, we can express each effective factor price as a function of the vector market
share plus some error term. Once the estimating equations have been transformed in this
way, the completeness condition of Newey and Powell (2003) provides non-parametric
identification.
   By A1, we can invert our factor demand system to express effective factor prices, ωi,t
faced by country i at date t as a function of expenditure shares, xi,t , and total income, yi,t ,

                                            ω nji,t = (χnji )−1 ( xi,t , yi,t ),                                (27)

with the level of effective factor prices in country i and year t pinned down by (24). Taking
logs and using equation (26), we then have

                             εnji,t = ln(χnji )−1 ( xi,t , yi,t ) − ln znji,t − ϕnji − ξ nj,t .

   20 A   common finding in the international macro literature is that exporters’ costs shocks tend to be in-
completely passed through into consumer prices; see e.g. Burstein and Gopinath (2013). This observation
does not by itself invalidate the previous strategy. Within the context of a neoclassical model, such findings
can be rationalized by assuming that foreign goods need to be distributed, which requires local factors of
production, as in Burstein, Neves and Rebelo (2003). In such a model, there is incomplete pass-through into
consumer prices, as observed in the data, yet complete pass-through into effective factor prices, as assumed
in equation (26).
     21 Going from a finite to an infinite dimensional space of parameters leads to non-trivial issues. Newey

(2013) notes that “In fully nonparametric models (that are infinite dimensional), completeness is not
testable, as pointed out by Canay, Santos and Shaikh (2013). In these models the reduced form is like
an infinite dimensional matrix with eigenvalues that have a limit point at zero. Nonidentification occurs
when at least one of the eigenvalues equals zero. The problem with testing this hypothesis is that one can-
not distinguish empirically a model with a zero eigenvalue from one where the eigenvalues have a limit
point of zero. However, completeness is generic, in the sense that it holds for “most” if it holds for one
[...]. This is like the discrete, finite support case where most matrices have full column rank if the order
condition is satisfied.” We have little to add to this discussion.

                                                            23
By A2, the inverse demand is the same for all importer i and period t,

                                 εnji,t = ln(χ̄nj )−1 ( xi,t , yi,t ) − ln znji,t − ϕnji − ξ nj,t ,

where (χ̄nj )−1 (·) is the inverse demand for factor n from country j. Combining this ex-
pression with A3, we obtain the following moment condition

                            E[ln(χ̄nj )−1 ( xi,t , yi,t ) − ϕnji − ξ njt | ln zi,t , di,t ] = ln znji,t .                      (28)

By A4, there is at most one function gnj that satisfies E[ gnj ( xi,t , yi,t , di,t )| ln zi,t , di,t ] = ln znji,t .22
Thus if two inverse demand functions, (χ̄nj )−1 and (χ̃nj )−1 , satisfy (28) for some ( ϕnji , ξ njt )
and ( ϕ̃nji , ξ̃ njt ), then we must have

                               ln(χ̄nj )−1 ( xi,t , yi,t ) = gnj ( xi,t , yi,t , di,t ) + ϕnji + ξ njt ,
                               ln(χ̃nj )−1 ( xi,t , yi,t ) = gnj ( xi,t , yi,t , di,t ) + ϕ̃nji + ξ̃ njt .

Taking the difference between these two equations, we obtain

                     ln(χ̄nj )−1 ( xi,t , yi,t ) − ln(χ̃nj )−1 ( xi,t , yi,t ) = ϕnji + ξ njt − ϕ̃nji − ξ̃ njt .

Holding xi,t and yi,t fixed, the left-hand side does not vary with i or t. So, ϕnji + ξ njt − ϕ̃nji −
ξ̃ njt cannot vary with i or t either. This establishes that ln(χ̄nj )−1 is identified up to some
constant, which equation (25) and (27) pin down for all j and n. Finally, note that once the
inverse factor demand is known, then both factor demand and effective factor prices are
known as well, with prices being uniquely pinned down by equation (27).
   We summarize the previous discussion in the next proposition.

Proposition 4. Suppose that A1-A4 hold. Then effective factor prices and factor demand are
identified, up to the two normalizations (24) and (25).


5.3 Ricardian Example
The invertibility of demand plays a key role throughout our analysis. We use it to conduct
counterfactual and welfare analysis in Section 4 and we use it again to establish Propo-
sition 4. We now provide sufficient conditions on the primitives of a neoclassical trade
model such that A1 holds. We also show that under the same conditions, a competitive
   22 Tosee this, suppose that gnj ( xi,t , yi,t , di,t ) and g̃nj ( x i,t , yi,t , di,t ) satisfy equation (28). Then they must also
satisfy E[ gnj ( xi,t , yi,t , di,t ) − g̃nj ( xi,t , yi,t , di,t )| ln zi,t , di,t ] = 0, which requires gnj = g̃nj by A4.

                                                                  24
equilibrium is unique. Hence, counterfactual changes in factor prices and welfare are
also nonparametrically identified in this environment. We will come back to the same
environment for our empirical application in Sections 6 and 7.
    Consider an economy in which utility and productions functions satisfy

                                ui (qi ) = ū({∑ qkji }), for all i,                                      (29)
                                                    j

                               f ijk (l ijk ) = αik f¯i (l ijk )/τij , for all i, j, and k,               (30)

where ū is a homothetic utility function that satisfies standard Inada conditions; αijk is total
factor productivity in country i and sector k when selling to country j; f¯i is a production
function, common to all sectors and destinations; and τij is a bilateral iceberg trade cost.
Given equation (29), the Inada conditions are imposed to rule out zero expenditure shares
on all goods.23 The crucial restriction is imposed in equation (30). It states that all goods
from country i use factors with the same intensity. Hence, everything is as if there was
only one factor per country with price ci ≡ minl̃ {∑ win l˜in | f¯i (l̃ ) = 1} and endowment
f¯i (νi ).
   In light of the previous discussion, we refer to an economy that satisfies (29) and (30)
as a Ricardian economy. In such an environment, homotheticity and no differences in
factor intensity imply that we can write the demand for factors in country i as χ̄(ωi ),
with ωi ≡ {τji c j } the vector of effective prices for the composite factors.
    As discussed in Berry, Gandhi and Haile (2013), a sufficient condition for a demand
function to be invertible over its support is that it satisfies the connected substitute prop-
erty.24 This property has a long tradition in general equilibrium theory where it is used
to establish the uniqueness of competitive equilibrium prices, through the injectivity of
the excess demand function; see Arrow and Hahn (1971), p. 227. For the purposes of this
paper, we need a slightly more general version of this property that applies to demand
   23 By   itself, the assumption that goods from different exporting countries are perfect substitutes, as de-
scribed in equation (29), is without loss of generality. To see this, note that by assuming that each good k
can only be produced in one country, the present model still nests the Armington model. We only impose
equation (29) to weaken the Inada conditions. Namely, we require all countries to consume all goods, not
all goods from all origins.
    24 If we were able to observe the quantities of factor services demanded by each country directly, rather

than factor expenditure shares, invertibility would be a straightforward issue in the context of this paper.
From Proposition 1, we know that there must be a representative agent whose factor demand solves (9).
Whenever the reduced utility function is differentiable at the optimum, the first-order conditions of the util-
ity maximization problem (9) immediately imply that factor prices are determined (up to a normalization)
by the gradient of the reduced utility function, evaluated at the optimal quantities of factor demanded.
The case of Cobb-Douglas utility is an extreme example that shows that the previous argument does not
carry over to expenditure shares. In that case, there is is uniqueness of prices conditional on quantities
demanded, but not conditional on expenditure shares.

                                                          25
correspondences, not just functions. We focus on the following generalization adapted
from Howitt (1980).
Definition 3 [Connected Substitutes]. A correspondence χ̄ : R m        m
                                                              ++ → P(R ++ ) satisfies the
connected substitute property if for any ω and ω′ ∈ R m                              ′        ′
                                                        ++ , any x ∈ χ̄(ω ), any x ∈ χ̄ (ω ), and
any non-trivial partition { M1 , M2 } of M ≡ {1, ..., m}, ω ′j > ω j for all j ∈ M1 and ω ′j = ω j for
all j ∈ M2 imply ∑ j∈ M2 x ′j > ∑ j∈ M2 x j .

    Our first lemma provides sufficient conditions under which the factor demand system
of a Ricardian economy is invertible over its support.

Lemma 1. Consider a Ricardian economy. If good expenditure shares satisfy the connected sub-
stitute property, then for any vector of factor expenditure shares, x > 0, there is at most one vector
(up to a normalization) of effective factor prices, ω, such that x ∈ χ̄(ω ).

    The formal proof can be found in Appendix A.2. The general strategy is similar to the
one used by Scarf and Wilson (2005) to establish the uniqueness of competitive equilibria
in a Ricardian model. The key idea is to show that if expenditure shares on goods sat-
isfy the connected property, then the expenditure shares on factors must satisfy the same
property. At that point, the invertibility of the factor demand system follows from stan-
dard arguments; see e.g. Proposition 17.F.3 in Mas-Colell, Whinston and Green (1995).
The only minor technicality is that the demand function may be a correspondence, which
Definition 3 is designed to address.
   In light of the above discussion, it should not be surprising that the same sufficient
conditions lead to the uniqueness of the competitive equilibrium.

Lemma 2. Consider a Ricardian economy. If good expenditure shares satisfy the connected sub-
stitute property, then the vector of equilibrium factor prices, (c1 , ..., c I ), is unique (up to a normal-
ization).

  Let us take stock. Proposition 4 and Lemma 1 imply that factor demand is nonpara-
metrically identified in a Ricardian economy if A2-A4 hold and good expenditure shares
satisfy the connected substitute property. Since all the assumptions of Section 4 are satis-
fied, Proposition 2, Proposition 3, and Lemma 2 further imply that proportional changes
in factor prices and welfare are uniquely determined given data on initial expenditure
shares and factor payments, { xijn } and {ynj }, and an estimate of factor demand, χ̄.25 This
leads to our final observation.

   25 Proportional changes in the factor content   of trade are also unique if factor demand, χ̄, is single-valued
at the initial and counterfactual equilibria.

                                                        26
Corollary 2. Consider a Ricardian economy. If A2-A4 hold and good expenditure shares satisfy
the connected substitute property, then proportional changes in factor prices and welfare caused
by trade cost shocks and endowment shocks are nonparametrically identified.


6 Estimation
The above results highlight two important features of neoclassical trade models. First,
counterfactual changes in trade costs and factor endowments can be studied with only
the knowledge of a reduced factor demand system. Second, this reduced demand system
can be nonparametrically identified from standard data sources on international trade in
goods and standard exclusion restrictions. Armed with these theoretical results we now
turn to a strategy for estimating the reduced demand system, in practice.


6.1 From Asymptopia to Mixed CES
Nonparametric identification results, like those presented in Section 5, are asymptotic
in nature. They answer the question of whether one could point identify each of the
potentially infinite-dimensional parameters of a model with a dataset whose sample size
tends to infinity—formally, whether there exists a unique mapping from population data
to model parameters. As noted by Chiappori and Ekeland (2009), such results are useful
because they can help select the most adequate moment conditions; that is, the source of
variation in the data directly related to the economic relation of interest.
     Of course, datasets in the real world often feature a small number of observations and
little exogenous variation. So estimation must inevitably proceed parametrically. Our
goal here is to do so in a flexible manner, drawing on recent advances in the area of ap-
plied demand estimation; see e.g. Nevo (2011). In the spirit of dimensionality-reduction,
we start by making three assumptions. Like in Section 5.3, we assume that: (i ) prefer-
ences are homothetic, so that we can ignore the effect of income on expenditure shares;
(ii ) all goods have the same factor intensity in each country, so that we can focus on a
single composite factor per country; and (iii ) cross-country differences in factor demand
can be reduced to differences in effective factor prices, so that we can focus on estimating
a unique global factor demand. All three assumptions are restrictive, but standard in the
existing gravity literature.26
  26 Fajgelbaum  and Khandelwal (2014) is a recent exception that introduces non-homothetic preferences
to study how gains from trade vary across income groups. As discussed below, our dataset only includes
two importing countries: the United States and Australia. So, there is very little variation that we can use
to estimate non-homotheticies. Similarly, introducing differences in factor intensity across sectors would

                                                    27
   Since there is one composite factor in each country, we drop superscripts n from now
on. Hence, ω ji,t stands for the effective price of the composite factor from country j in
country i in year t, with ωi,t ≡ {ω ji,t } being the associated vector of effective prices.
Taking inspiration from Berry (1994) and Berry, Levinsohn and Pakes (1995), we posit
that the expenditure share that country i devotes to the factor from country j in year t can
be expressed as
                                                                                σǫ )
                                                   (κ j )σα α (ω ji,t )−(ǭ·ǫ
                                            ˆ
                           χ̄ j (ωi,t ) =                                                     dF (α, ǫ)       (31)
                                                ∑lN=1 (κl )σα α (ωli,t )−(ǭ·ǫ
                                                                                       σǫ )



where κ ≡ {κ j } is a vector of observable country characteristics and {ǭ, σα , σǫ } are struc-
tural parameters. The random draws (α, ǫ) can be interpreted as unobserved heterogene-
ity across goods in the elasticities with respect to effective factor prices, ω ji,t , and exporter
characteristic, κ j . We come back to this point below when discussing the relationship
between mixed and nested CES.
   In our baseline analysis, we assume that κ j is the per-capita GDP of country j relative
to the per-capita GDP of the United States ( j = 1) in the pre-sample period.27 We also
assume that the joint distribution F (α, ǫ) is such that α and ln ǫ have a joint standard
normal distribution with an identity covariance matrix.28 As a function of effective factor
prices, the demand system is completely characterized by three structural parameters: ǭ,
σα and σǫ .
  This particular functional form is attractive for two reasons. First, it nests the case of
CES demand. That is, in the special case of σα = σǫ = 0, we recover a standard gravity
model with trade elasticity ǭ, as in Eaton and Kortum (2002) or Anderson and Van Win-
coop (2003). When σα 6= 0 or σǫ 6= 0, the demand system in equation (31) becomes a
random coefficients version of CES demand, in the same way that the mixed logit de-
mand system in Berry, Levinsohn and Pakes (1995) is a random coefficients version of
logit demand. For this reason, we refer to our demand system as “mixed CES.”
   Second, the demand system in equation (31) captures flexibly and parsimoniously a
then require estimates of the extent to which multiple factors are substitutable for one another within each
country. While in principle this can be achieved with supply-side shifters of relative factor prices, finding
such shifters in practice has proven difficult; see, e.g., Oberfield and Raval (2014) for a recent discussion of
the capital-labor case.
     27 More generally, one could incorporate a multivariate set of time-varying characteristics by setting

κ j,t ≡ γ · u j,t where u j,t is a vector of characteristics for exporter j at year t and γ is the parameter vec-
tor that intermediates the effect of these characteristics on market shares. An alternative modeling strategy
would be to organize countries into groups, based on some observed characteristic, and then estimate a
nested CES system. This is much like the nested logit approach in Goldberg (1995).
     28 We incorporate the heterogeneity in ǫ with a positive multiplicative shifter to guarantee no sign varia-

tion in the trade elasticity. In other words, the sign of the trade elasticity is entirely determined by ǭ but its
magnitude is affected the multiplicative shifter, ǫσǫ , whose distribution is log-normal with mean zero and
variance σǫ .

                                                            28
number of natural features of demand substitution patterns through the structural param-
eters σα and σǫ . To see this, define the share of the factor from country j in expenditures
of country i conditional on (α, ǫ):
                                                                                                σǫ )
                                                                   (κ j )σα α (ω ji,t )−(ǭ·ǫ
                                              x ji,t (α, ǫ) ≡                                                 .                      (32)
                                                                ∑lN=1 (κl )σα α (ωli,t )−(ǭ·ǫ
                                                                                                       σǫ )



Now take three exporter countries j, l and r competing in the same importing market i in
year t. Consider how the demand for the factor from country j relative to the factor from
the reference country r depends on the effective price of factor from country l relative to
that of country r. This elasticity of relative demand shares to relative prices is given by
                     χ̄ (ω                                                                           !
                       j      i,t )
             ∂ ln  χ̄ (ω )
                                              ˆ
                                                                 x ji,t (α, ǫ) xri,t (α, ǫ)
                   r i,t
                      ω
                                          =       (ǭ · ǫσǫ )                 −                               xli,t (α, ǫ)dF(α, ǫ)   (33)
               ∂ ln ωli,t                                              χ̄ j         χ̄r
                        rit


    This expression highlights key features of the demand system in equation (31). As
expected, setting σα = σǫ = 0 recovers the well-know property of independence of irrel-
evant alternatives (IIA) embedded in the CES demand system: the cross-price elasticity
is zero.29 Departures from this special case yield richer patterns of substitution. The
cross-price elasticity is relatively larger when x ji,t (α, ǫ) and x li,t (α, ǫ) co-move more than
xri,t (α, ǫ) and x li,t (α, ǫ) in the (α, ǫ) space. From equation (32), we can see that such a pat-
tern is generated by two channels. Whenever σα 6= 0 and σǫ = 0, this is the case if coun-
tries j and l are more similar in terms of their characteristics, κ, than countries r and l are
(i.e., |κ j − κl | < |κr − κl |). Alternatively, whenever σα = 0 and σǫ 6= 0, this pattern occurs
if countries j and l are more similar in terms of their effective factor price than countries r
and l are—this is then intrinsically related to market shares (i.e., |χ̄ j − χ̄l | < |χ̄r − χ̄l |).
    One particular set of micro-foundations that would lead to the factor demand system
in equation (31) is that stemming from: (i ) a Cobb-Douglas utility with equal weights
over a continuum of sectors, with a lower-level CES nest over a continuum of varieties
in each sector and (ii ) country-and-sector-specific Fréchet distributions of productivity
across varieties. Under this interpretation, each sector is fully characterized by its corre-
sponding pair (α, ǫ) with F(α, ǫ) representing the distribution of sector attributes. In this
sense, the factor demand system in equation (31) is closely related to the nested CES de-
mand implied by standard multi-sector models in the field; see e.g. Costinot, Donaldson
and Komunjer (2012) and Caliendo and Parro (2015).
   29 Thisfollows immediately form the observation that x ji,t (α, ǫ) = χ̄ j for all j if σα = σǫ = 0. Also, it is
straightforward to verify that, in this case, the own-price elasticity is constant and equal to −ǭ.

                                                                       29
   The crucial distinction here concerns the source of variation used for estimation. The
results in Section 5 demonstrate that the aggregate factor demand system—which, as we
have argued, is all that is required to study the counterfactual scenarios we consider
here—is nonparametrically identified from aggregate data on factor spending shares.
This is the variation that we will use next. Multi-sector level models, in contrast, are
estimated using within-sector variation. And while sector-level factor demand relations
are identified with sector-level data, the aggregate factor demand function, along with its
essential aggregate cross-price elasticities, is not.30
   Summarizing the above discussion, the “mixed CES” demand in equation (31) not
only nests commonly used functional forms in the literature but also captures in a par-
simonious manner the natural feature that factors similar in the κ-space are closer sub-
stitutes.31 Given the essential role played by these cross-price elasticities of substitution
in many counterfactual scenarios of interest, we consider of paramount importance the
ability of an estimator to let the data speak directly to these phenomena.


6.2 Estimation Procedure
We now turn to the estimation of the structural parameters {ǭ, σα , σǫ } in equation (31).
Building on the identification result of Section 5, the estimator is based on the existence of
an observed and exogenous component of effective factor prices. Later, we take this cost
shifter, z ji,t , to be the reported freight charges between trading partners.
    In order to use the estimation procedure developed by Berry, Levinsohn and Pakes
(1995) in the mixed logit case, it is convenient to focus on the following log-transformation
of effective factor prices, δji,t ≡ −ǭln(ω ji,t /ω1i,t ), where ω1i,t is the effective price of U.S.
factor in country i at year t. Expressed in terms of δi,t ≡ {δji,t }, the demand system in

  30 To  see why this distinction may matter in practice, suppose that the true factor demand system is
CES. In that case, the researcher using sector-level data and positing a nested-CES utility function with
an upper-level Cobb-Douglas aggregator would uncover the true lower-level elasticity of substitution, but
would wrongly assume that the upper-level elasticity is equal to one. In contrast, the researcher assuming
mixed CES would rightly conclude that factor demand is CES. Of course, one could relax the assumption
that the aggregator is Cobb-Douglas and attempt to estimate it as well; see e.g. Costinot, Donaldson and
Smith (2015). But at that point, given the dimensionality of the demand system across goods that needs to
be estimated, it is not clear what the benefit is compared to estimating the factor demand system directly.
   31 The translog demand system—as used in the Armington context by Novy (2013)—is an important

exception not covered by the demand system in (31). One way to nest both CES and translog would be to
use the CES-Translog demand system introduced by Pollak, Sickles and Wales (1984). While it is attractive
to consider a demand system that nests both CES and translog, the main difficulty with using such a system
is designing moment conditions that directly relate to the non-linear parameters of this extended CES-
Translog system. One advantage of the “mixed CES” system is the clear connection between parameters
and the structure of cross-price elasticities. As discussed below, this provides guidance for the choice of
moment conditions.

                                                    30
equation (31) becomes

                                                    exp(ασα ln κ j + ǫσǫ δji,t )
                                        ˆ
                   χ̄ j (δi,t |θ2 ) =                                                 dF (α, ǫ) ,   (34)
                                             1 + ∑lN=2 exp(ασα ln κl + ǫσǫ δli,t )

where θ2 ≡ (σα , σǫ ) is the sub-vector of “non-linear” parameters of the model, by which
we mean those that will enter non-linearly in the estimation procedure below.
    Conditional on the vector θ2 , Berry, Levinsohn and Pakes (1995) establish the existence
of a unique vector δi,t that rationalizes expenditure shares in country i and year t, i.e.,

                                             χ̄ j (δi,t |θ2 ) = x ji,t , for all j.

In line with the notation of the previous sections, let χ̄ −1 ( xi,t |θ2 ) ≡ {χ̄− 1
                                                                                j ( xi,t | θ2 )} denote
the solution of this system. By definition, χ̄− 1
                                              j ( xi,t | θ2 ) = − ǭln(ω ji,t /ω1i,t ). Thus, we can
use equation (26) to write

                         χ̄− 1
                           j ( xi,t | θ2 ) = − ǭ ln(z ji,t /z1i,t ) + φ ji + ς jt + e ji,t ,


with φ ji ≡ −ǭ( ϕ ji − ϕ1i ), ς jt ≡ −ǭ(ξ jt − ξ 1t ), and e ji,t ≡ −ǭ(ε ji,t − ε 1i,t ), or more com-
pactly,
                                        χ̄− 1                 1
                                          j ( xi,t | θ2 ) = Z ji,t · θ1 + e ji,t ,

where θ1 ≡ (−ǭ, {φ ji }, {ς jt }) denotes the sub-vector of “linear” parameters of the model
and Z 1ji,t ≡ [ln(z ji,t /z1i,t ), di,t ] with di,t denoting a full vector of exporter-importer dum-
mies and exporter-year dummies, with i as the importer and t as the year for all dummies.
   Given a vector of instruments Z ji,t that is mean-independent from the structural error
term, E[e ji,t | Z ji,t ] = 0, one can then obtain a consistent GMM estimator of θ ≡ [θ1 | θ2 ] by
constructing the structural error term e ji,t (θ) ≡ χ̄−    1                 1
                                                          j ( xi,t | θ2 ) − Z ji,t · θ1 and solving for


                                            θ̂ = arg min e(θ)′ ZΦZ′ e(θ),                           (35)
                                                         θ

where Φ is a matrix of moment weights. The details of the estimation procedure (as well
as our procedure for computing standard errors for θ̂2 ) can be found in Appendix B.
    To build instruments for the estimation of θ, we rely on the exogeneity restrictions
described in Assumption A3. First, the structural error e ji,t is uncorrelated with the ex-
porter’s own freight cost ln z ji,t and the dummy vector di,t , making Z 1ji,t a natural vector
of instruments. This is the usual set of regressors included in the estimation of CES de-
mand. Second, Assumption A3 also entails that e ji,t is uncorrelated with the freight cost


                                                              31
of all other competitors in the market, {ln zli,t }l 6= j . Following the intuition for the IIA vio-
lation implied by (σα , σǫ ), we propose additional instruments for exporter j that are based
on the interaction between freight cost of competitors, ln zli,t , and their per-capita GDP
difference, |κ j − κl |. Specifically, define the instrument vector Z2ji,t ≡ {|κ j − κl | ln zli,t }l 6= j .
Intuitively, this choice of instruments is designed to explore the extent to which distance
in the characteristic space, |κ j − κl |, affects cross-price elasticities. The final instrument
vector combines these two components: Z ji,t ≡ [Z1ji,t | Z2ji,t ].


6.3 Data
As described above, our estimation procedure draws on four types of data: (i ) data on
the total value of bilateral trade in goods, which can then be converted into expenditure
shares, denoted by x ji,t ; (ii ) data on bilateral freight costs, denoted by z ji,t ; (iii ) data on
total income by country, denoted by y j,t ; and (iv) data on per-capita GDP, denoted by κ j .
    We obtain data on x ji,t and y j,t from the World Input-Output Database for all years
between 1995 and 2011. Following Shapiro (2012), data on z ji,t are available from the
publicly available import data for two importers i, Australia and the United States, in
all years t from 1990 to 2010.32 To avoid the possibility of zero trade flows, we focus
on the 36 largest exporters to Australia and the United States, and aggregate all other
countries up to a single “Rest-of-the-World” unit. In the estimation of θ, we use all years
with available information on trade flows and freight costs, 1995-2010. Finally, we obtain
the information on per-capita GDP necessary to construct κ j from the Penn World Table,
version 8.0.33 The list of exporters along with their per-capita GDP values is presented on
Table A1 in Appendix C


6.4 Estimation Results
6.4.1 Reduced-Form Evidence

Before turning to our estimates of the structural parameters, we begin with a simpler ap-
proach that builds directly on the standard gravity model. Our goal is twofold. First, we
illustrate that the deviations from IIA motivated in Section 6.1 are a systematic feature
   32 We are grateful to Joe Shapiro for making these data easily accessible to us. For each exporter and

year, we compute the freight cost by dividing reported values of total exports CIF by total exports FOB.
For domestic sales, we input a freight cost of zero — this is equivalent to assuming a constant (over time)
transport cost of domestic sales in the presence of exporter-importer fixed effects.
   33 For each exporter, we compute per-capita GDP by dividing the expenditure-side real GDP at current

PPP (USD 2005) by the total population. We then construct κ j as the average per-capita GDP between 1992
and 1995.

                                                    32
Table 1: Reduced-Form estimates and violation of IIA in gravity estimation

Dependent variable: log(exports)                              (1)            (2)               (3)          (4)
 log(freight cost)                                      -6.103**         -6.347**           -1.301**      -1.277**
                                                         (1.046)          (1.259)            (0.392)       (0.381)
 test for joint significance of interacted competitors’ freight costs: γl = 0 for all l
     F-stat                                                 42.60**                     209.24**
     p-value                                                 <0.001                      <0.001
Disaggregation level                                      exporter-importer                 exp.-imp.-industry
Observations                                                    1,184                             18,486

Notes: Sample of exports from 37 countries to Australia and USA between 1995 and 2010 (aggregate and
2-digit industry-level). All models include a full set of dummies for exporter-importer(-industry), importer-
year(-industry), and exporter-year(-industry). Standard errors clustered by exporter-importer. ** p<0.01.


of the data. Second, we document that these deviations are directly related to the simi-
larity of competitors in terms of per-capita GDP. To this end, we estimate the following
equation:

               ln( x ji,t ) = β ln z ji,t + ∑ γl (|κ j − κl | ln zli,t ) + φ ji + ζ jt + νit + ε ji,t .       (36)
                                           l 6= j


    In this specification, x ji,t is the share of country j exports in expenditures of country i
at year t and z ji,t is the bilateral freight cost from country j to country i at year t. The terms
φ ji , ζ jt and νit represent exporter-importer, exporter-year and importer-year fixed-effects,
respectively.
    The IIA property implies that competitors’ costs affect the spending share of exporter
j solely through the importer price index, being fully absorbed by the importer-year fixed
effect. In specification (36), the IIA property is equivalent to γl = 0 for all l. Alternatively,
IIA is violated if the demand for the factor from country j depends also on the price of the
factor from country l conditional on the importer-year fixed effect; that is, γl 6= 0 for some
exporter l. The interaction between ln zli,t and |κ j − κl | relate this third country effect to
the proximity of competitors in terms of per-capita GDP.
   Table 1 reports estimates of various versions of equation (36). Column (1) begins by re-
stricting attention to the standard CES case in which γl = 0 for all l. We obtain an estimate
of -6.1 for the trade elasticity in line with a vast literature that has estimated such a speci-
fication; see e.g. Head and Mayer (2013). Column (2) then includes the interaction terms
to estimate the set of coefficients γl . Because there are 37 such coefficients and we are
only interested in testing whether at least one of them is non-zero, we simply report the


                                                         33
value of the F-test for the hypothesis that γl = 0 for all l. This test is comfortably rejected
at the one percent level, while clustering standard errors at the exporter-importer level.
Columns (3)-(4) estimate the same specification using trade data disaggregated by 2-digit
industry. This exercise investigates whether the IIA violation is simply related to industry
aggregation. Accordingly, we allow all fixed effects to be industry-specific which implies
that parameters are estimated from within-industry variation. For exposition purposes,
we impose the same coefficients β and γl across sectors. The hypothesis that γl = 0 for
all l is again rejected.34
   To summarize, Table 1 supports the relevance of third-country effects as captured by
the interaction between competitor’s freight costs and distance between per-capita GDPs,
|κ j − κl | ln zli,t . In the structural estimation below, we rely on exactly this variation to
obtain estimates of the parameters controlling the cross-price elasticity, σα and σǫ .


6.4.2 Structural Estimation

We now turn to our estimates of θ obtained from the GMM procedure described in Section
6.2. These parameters are reported in Table 2 along with their accompanying standard
errors clustered by exporter-importer pair.35 In Panel A, we restrict σα = σǫ = 0 in which
case we estimate ǭ to be approximately -6. As expected, this value is very similar to the
estimate in column (1) of Table 1.36
   Panel B reports our estimates with unobserved heterogeneity only in α, whereas Panel
C focuses on our preferred specification with unobserved heterogeneity in both α and
ǫ. As can be seen from Panel C, we estimate a value of σǫ close to zero, indicating that
deviations from IIA based on market shares are not important. However, the estimate of
σα is statistically significant which suggests the importance of IIA deviations related to
per-capita GDP. To get more intuition about the economic implications of our structural
estimates, Figure 1 plots the cross price-elasticity in equation (33) with respect to a change
in Chinese trade costs. While this elasticity is identically equal to zero in the CES system of
Panel A, it does not have to be the case for the other specifications. In fact, the parameters
estimated in Panel C imply that the elasticity of relative demand to the relative price of
Chinese factor is decreasing in per-capita GDP, being statistically different from zero even
      34 We
         obtain the same conclusion if all coefficients are allowed to vary by industry: the hypothesis that
γlk= 0 for all l and k is rejected at the one percent level.
   35 As noted by Stock and Yogo (2002), research on tests for weak instruments in the non-linear GMM

case is still “quite incomplete.” In principle, one could calculate the nonlinear Anderson-Rubin statistic
proposed by these authors. Given the large number of fixed effects in equation (35), computing this statistic
has proven too computationally demanding in practice.
   36 The estimates are not identical because they are based on two consistent, but distinct estimators of the

same parameter.

                                                     34
Table 2: GMM estimates of mixed CES demand

                                                                  ǭ                σα                σǫ
 Panel A: CES
                                                              -5.955**
                                                               (0.671)
 Panel B: Mixed CES (restricted heterogeneity)
                                                              -6.115**           2.075**
                                                               (0.649)           (0.578)
 Panel C: Mixed CES (unrestricted heterogeneity)
                                                              -6.116**           2.063**            0.003
                                                               (0.671)           (0.647)           (0.175)

Notes: Sample of 1,152 exporter-importer-year triples between 1995 and 2010 (normalizing country is the
USA). Importers: Australia and USA. All models include a full set of dummies for importer-exporter and
exporter-year. Standard errors (consistent, one-step standard errors, following the procedure in Appendix
B) in parentheses clustered by 72 exporter-importer pairs are reported in parentheses. ** p<0.01.


for low-income countries like China.


7 Application: China’s Integration in the World Economy
We conclude by applying our methodology to study the consequences of one particular
counterfactual: China’s integration into the world economy. To shed light on this issue,
we proceed in two steps. First, we use the demand system estimated in Section 6 to infer
the trade costs faced by China, both as an exporter and an importer, at different points
in time. Given estimates of Chinese trade costs, we then ask: “For any country j, how
much higher (or lower) would welfare have been at a given year t ≥ 1995 if Chinese
trade costs were those of 1995 rather than those of year t?” The next subsection focuses
on the estimation of trade costs. Counterfactual predictions will be discussed in Section
7.2.37



  37 We  follow a two-step procedure because we are interested in quantifying the welfare consequences
of China’s observed integration—interpreted as changes in iceberg trade costs within our theoretical
framework—over the last two decades. Of course, one could dispense with the first step and directly study
the effects of arbitrarily chosen changes in trade costs, including those not featuring the normalizations
imposed in Section 7.1. This is the approach followed in most recent quantitative papers; see e.g. Costinot
and Rodríguez-Clare (2013). Note also that our exercise is related to, but distinct from, the simulations
in Hanson and Robertson (2010) and Hsieh and Ossa (2011), which evaluate the global consequences of
China’s sector-wise productivity growth using gravity models.

                                                    35
                                              2
                      to a change in Chinese trade costs
                                                                 IND




                        Elasticity of relative trade share

                                                      1.5
                                                                            RoW
                                                                            IDN
                                         1

                                                                                       ROU
                                                                                          BRA
                                                                                           BGR
                                                                                             LTU
                                                                                              BAL
                          .5




                                                                                               POL
                                                                                                  TUR
                                                                                                   MEX
                                                                                                      HUN
                                                                                                      SVK
                                                                                                         RUS
                                                                                                           PRT
                                                                                                           KOR
                                                                                                             GRC
                                                                                                             CZE
                                                                                                              SVN
                                                                                                                ESP
                                                                                                                 TWN
                                                                                                                 IRL
                                                                                                                   FIN
                                                                                                                     GBR
                                                                                                                      FRA
                                                                                                                       SWE
                                                                                                                       NLD
                                                                                                                        ITA
                                                                                                                         DNK
                                                                                                                         DEU
                                                                                                                          BLX
                                                                                                                          AUT
                                                                                                                          AUS
                                                                                                                           CAN
                                                                                                                            JPN
                                              0




                                                             7         8                      9                     10
                                                                           Log of per capita GDP



Figure 1: Elasticity of demand relative to the U.S. with respect to Chinese factor price.

Notes: Elasticity of U.S. demand for factors from any country relative to U.S. demand for U.S. factors with
respect to a change in the Chinese factor price. Elasticities are computed using the estimates of the Mixed
CES demand system in Panel C of Table 2. 95% confidence intervals shown are computed using the boot-
strap procedure described in Appendix D. Dashed blue line corresponds to the CES case.


7.1 Trade Costs
We measure trade costs as follows. For each importer i and each year t in our sample,
we start by inverting our demand system, χ̄, to go from the vector of expenditure shares,
xi,t , to the vector of effective factor prices, ωi,t = χ̄ −1 ( xi,t ), up to a normalization. We
then use the time series of effective factor prices, {ω ji,t = χ̄ j −1 ( xi,t )}, and the identity,
ω ji,t ≡ τji,t ci,t , to construct the time series of iceberg trade costs, {τji,t }, such that

  (τji,t /τii,t )/(τjj,t /τij,t ) = (χ̄ j −1 ( xi,t )/χ̄i−1 ( xi,t ))/(χ̄− 1           −1
                                                                         j ( x j,t )/χ̄i ( x j,t )), for all i, j, and t.
                                                                                                                      (37)
This (log-)difference-in-differences provides a nonparametric generalization of the Head
and Ries’s (2001) index used to measure trade costs in gravity models. Compared to the
case of a CES demand system, the only distinction is that one cannot directly read the
difference-in-differences in effective prices from the difference-in-differences in expendi-
ture shares. Inverting demand now requires a computer.
    In order to go from a difference-in-differences to the level of Chinese trade costs, we




                                                                                  36
follow the same approach as Head and Ries (2001) and further assume that

                             τii,t /τii,95 = 1 for all i and t,                                                         (38)
                             τij,t /τij,95 = τji,t /τji,95 for all t if i or j is China.                                (39)

The first condition rules out differential changes in domestic trade costs around the world,
whereas the second condition rules out asymmetric changes in Chinese trade costs.38
Given equations (37)-(39), we can then measure the proportional changes in Chinese trade
costs between 1995 and any period t as
                      v
                      u
                      u      (χ̄ j −1 ( xi,t )/χ̄i−1 ( xi,t ))/(χ̄− 1           −1
                                                                  j ( x j,t )/χ̄i ( x j,t ))
     τji,t /τji,95   =t                                                                         , if i or j is China.
                          (χ̄ j −1 ( xi,95 )/χ̄i−1 ( xi,95 ))/(χ̄− 1            −1
                                                                 j ( x j,95 )/χ̄i ( x j,95 ))


By construction, changes in exporting and importing costs from China are the same,
though they may vary across trading partners and over time.
   Figure 2 reports the arithmetic average of changes in Chinese trade costs across all
trading partners. The solid red line corresponds to our baseline estimates, obtained un-
der mixed CES (Table 2, Panel C). As can be seen, these are substantial changes in trade
costs. Between 1995 and 2007, we estimate that Chinese trade costs decreased by 20.2%
on average. If we were to restrict ourselves to a CES demand system (the dashed blue
line), the decrease in Chinese trade costs would be equal to 16.7% instead.


7.2 Counterfactual predictions
In any year t, we are interested in counterfactual changes in trade costs, τ̂ji,t , such that
Chinese trade costs are brought back to their 1995 levels:

                                      τ̂ji,t = τji,95 /τji,t , if i or j is China,                                      (40)
                                      τ̂ji,t = 1, otherwise.                                                            (41)

Given estimates of the factor demand system, obtained in Section 6, and estimates of trade
costs, obtained in Section 7.1, we can use Corollary 1 to compute the welfare changes
  38 Our focus on symmetric changes in Chinese trade costs is partly motivated by the desire stay as close
as possible to existing practices in the gravity literature. It should be clear, however, that while some
normalization is required to go from differences-in-differences to the levels of trade costs, equations (38)
and (39) provide only one of many possibilities. For example, an alternative would be to allow bilaterally
asymmetric changes in Chinese trade costs under the assumption that some reference country’s trade costs
are constant over time. This is akin to focusing on counterfactuals in which one asks what would have
happened if China had integrated with the rest of the world to the same extent as that reference country.

                                                            37
                             5
                             0
                    Percentage Change
                        −10  −15
                             −20−5




                                        1995     2000                   2005               2010

                                               CES (standard gravity)          Mixed CES



            Figure 2: Average trade cost changes since 1995: China, 1996-2011.

Notes: Arithmetic average across all trading partners in the percentage reduction in Chinese trade costs be-
tween 1995 and each year t = 1996, . . . , 2011. “CES (standard gravity)” and “Mixed CES” plot the estimates
of trade costs obtained using the factor demand system in Panels A and C, respectively, of Table 2.


associated with this counterfactual scenario.39
   Figure 3 reports the negative of the welfare changes in China for all years in our sam-
ple. A positive number in year t corresponds to the gains from economic integration for
China between 1995 and year t. Before the great trade collapse in 2007, we see that the
gains from economic integration for China are equal to 1.54%. In line with our estimates
of trade costs, we see that imposing CES would instead lead to gains from economic inte-
gration equal to 1.04%.
   What about China’s trading partners? Figure 4 reports the welfare change from bring-
ing Chinese trade costs back to their 1995 levels for all other countries in 2007. The boot-
strapped 95% confidence intervals corresponding to each of these estimates (as well as
those for China) can be found in Table A2 in Appendix D. Under our preferred estimates
(red circles), we see that rich countries tend to gain relatively more from China’s integra-
tion, with both Indonesia and Romania experiencing statistically significant losses. The
previous pattern gets muted if one forces factor demand to be CES instead (blue trian-
gles).
  39 Our counterfactual calculations allow for lump-sum transfers between countries to rationalize trade
imbalances in the initial equilibrium. We then hold these lump-sum transfers constant across the initial and
counterfactual equilibria. Details on the algorithm for the computation of the counterfactual exercise are
described in Appendix D.

                                                            38
                               2      1.5
                    Percentage Change
                    .5        10




                                            1995             2000                         2005                              2010

                                                         CES (standard gravity)                           Mixed CES



     Figure 3: Welfare gains from Chinese integration since 1995: China, 1996-2011.

Notes: Welfare gains in China from reduction in Chinese trade costs relative to 1995 in each year t =
1996, . . . , 2011. CES (standard gravity) and Mixed CES plot the estimates of welfare changes obtained using
the factor demand system in Panels A and C, respectively, of Table 2.
                               1




                                                                                                         TWN
                               .8




                                                                                                         TWN
                    Percentage Change
                         .4      .6




                                                                                                KOR


                                                             RoW                                KOR

                                                                                                                AUS
                               .2




                                                                                         HUN       CZE         DEUJPN
                                                                                                CZE IRLFIN      AUS
                                                   IND                              MEX SVK          IRL       DEU
                                                             RoW                    MEX     RUS    ESPFIN SWE   BLX
                                                                                                                AUT
                                                                                                                 CAN
                                                                                POL
                                                                               BAL                                JPN
                                                                           BRALTU
                                                                            BGR                    ESP      SWE
                                                                                                            NLD       USA
                                                                           BRA BAL            PRT          FRA
                                                                                                            NLD AUT
                                                                                                                BLX
                                                                                                                 CAN
                                                             IDN                POL                          ITA
                                                                                                           FRADNK     USA
                                                   IND                        LTU TUR            SVN
                                                                                                GRC
                                                                                                 SVN     GBR
                                                                                                         GBR  DNK
                                                                                                             ITA
                                                                                                GRC
                               0




                                                                        ROU BGR
                                                             IDN
                                                                        ROU

                                             7           8                     9                          10                       11
                                                                    Log of per capita GDP

                                                         CES (standard gravity)                Mixed CES



  Figure 4: Welfare gains from Chinese integration since 1995: other countries, 2007.

Notes: Welfare gains in other countries from reduction in Chinese trade costs relative to 1995 in year t =
2007. “CES (standard gravity)” and “Mixed CES” plot the estimates of welfare changes obtained using the
factor demand system in Panels A and C, respectively, of Table 2. The solid red line shows the line of best
fit through the Mixed CES points, and the dashed blue line the equivalent for the CES case. Bootstrapped
95% confidence intervals for these estimates are reported in Table A2.


                                                                          39
8 Concluding Remarks
This paper starts from a simple observation. If neoclassical trade models are like exchange
economies in which countries trade factor services, then the shape of these countries’
reduced factor demand must be sufficient for answering many counterfactual questions.
   Motivated by this observation, we have developed tools to conduct counterfactual and
welfare analysis given knowledge of any factor demand system. Then, we have provided
sufficient conditions under which estimates of this system can be recovered nonparamet-
rically. Lastly, we have applied our tools to study a particular counterfactual question:
What would have happened to other countries if China had remained closed? Since the
answer to this question hinges on how substitutable factors of production from around
the world are, we have introduced a parsimonious generalization of the CES demand
system that allows for rich patterns of substitution across factors from different countries.
The counterfactual results based on estimates of this system illustrate the feasibility and
potential benefits of allowing trade data to speak with added flexibility.
   Clearly, our emphasis on reduced factor demand also has costs. The demand system in
our empirical application remains high-dimensional—we consider a world economy with
37 exporters—but data are limited—freight costs for these 37 exporters are only available
for 16 years and 2 importers. So parametric restrictions need to be imposed. The typical
approach is to impose such restrictions on deeper primitives of the model, like preferences
and technology, and then to use various data sources to estimate or calibrate each of
those fundamentals.40 Here, we propose instead to impose restrictions directly on the
factor demand system, while building estimation on precisely the moment conditions
under which we have shown this system to be nonparametrically identified. Given data
constraints, we do not view our approach as a panacea. But we believe that the tight
connection between theory and data that it offers makes it worthy of further investigation.
   An important open question concerns the extent to which one could combine the ap-
proach in this paper with additional, more disaggregated data sources. The answer is
likely to depend on the additional assumptions that one is willing to impose, with costs
and benefits that will need to be weighed. Consider, for instance, the differences in pat-
terns of specialization across sectors and countries. Intuitively, there is a lot of information
to be gained from such sector-level data. But if one is interested in aggregate questions,
such data never come for free—disaggregated data will need to be aggregated ultimately.
One possibility would be to use sector-level data, say in the pre-sample period, to con-

  40 Bas,
        Mayer and Thoenig (2015) provides an interesting example of this approach in the context of
monopolistically competitive models of international trade.

                                                40
struct additional observed country characteristics in a factor demand system akin to the
one introduced in Section 6. Another possibility, closer to existing work, would be to
maintain strong functional forms on the way that sector-level factor demands are aggre-
gated, but allow for mixed CES demand systems to deal flexibly with the substantial un-
observed heterogeneity across goods within narrowly defined sectors; see Schott (2004).
   Regardless of the methodology that one chooses, we hope that our theoretical results
can make more transparent how CGE models map data into counterfactual predictions.
One cannot escape Manski’s (2003) “Law of Decreasing Credibility,” that “the credibility
of inference decreases with the strength of the assumptions maintained” (p. 1). But iden-
tifying the critical assumptions upon which counterfactual predictions rely in complex
general equilibrium environments can help evaluate their credibility. Once it is estab-
lished that assumptions about the shape of factor demand—and only the shape of factor
demand—determine counterfactual predictions, it becomes easier to ask whether the mo-
ments chosen for structural estimation are related to the economic relation of interest and
to explore whether functional form assumptions rather than data drive particular results.
    In terms of applications, two lines of research seem particularly promising. The first
concerns the distributional consequences of international trade. By assuming the same
factor intensity in all sectors, our empirical application assumes away distributional is-
sues. None of the theoretical results in Sections 3 and 4, however, rely on this assumption.
Hence the same nonparametric approach could be used to study the impact of globaliza-
tion on the skill premium or the relative return to capital. The second line of research
concerns the consequences of factor mobility, either migration or foreign direct invest-
ment. Although factor supply is inelastic in Section 3, it would be easy to incorporate
such considerations by introducing intermediate goods, as we did in Section 4.3.3. Then
either migration or foreign direct investment would be equivalent to trade in intermediate
goods, which may be subject to different frictions than trade in final goods.
   Finally, while we have emphasized counterfactual and welfare analysis in this paper,
the tools that we have developed could be applied more generally. Many questions con-
cerning international trade can be reduced to estimating and inverting a demand system.
But this system does not have to be CES. In Section 7.1, we have already mentioned the
measurement of trade costs, which is an important application of gravity models; see e.g.
Anderson and Van Wincoop (2004) and Jacks, Meissner and Novy (2011). Another natural
application is the measurement of comparative advantage; see e.g. Costinot, Donaldson
and Komunjer (2012) and Levchenko and Zhang (2011). Measures of revealed compar-
ative advantage (RCA) aim to uncover which countries can produce and sell goods rel-
atively more cheaply, and this boils down to a difference-in-differences of (log-)prices.


                                            41
Away from CES, this difference-in-differences will not be proportional to a difference-in-
differences of (log-)expenditures. But given estimates of any invertible demand system,
RCA remains an easy object to compute.




                                           42
References
Allen, Treb, Costas Arkolakis, and Yuta Takahashi, “Universal Gravity,” Northwestern
  working paper, 2014.

Alvarez, Fernando and Robert E. Lucas, “General Equilibrium Analysis of the Eaton-
  Kortum Model of International Trade,” Journal of Monetary Economics, 2007, 54 (6), 1726–
  1768.

Anderson, James E. and Eric Van Wincoop, “Gravity with Gravitas: A Solution to the
  Border Puzzle,” The American Economic Review, 2003, 93 (1), 170–192.

  and    , “Trade Costs,” Journal of Economic Literature, 2004, 42 (3), 691–751.

Arkolakis, Costas, Arnaud Costinot, and Andres Rodríguez-Clare, “New Trade Models,
  Same Old Gains?,” American Economic Review, 2012, 102 (1), 94–130.

  ,   , Dave Donaldson, and Andres Rodriguez-Clare, “The Elusive Pro-Competitive
  Effects of Trade,” mimeo, 2012.

Arrow, K.J. and F.H. Hahn, General competitive analysis, San Francisco: Holden-Day, 1971.

  , H.B. Chenery, B.S. Minhas, and R.M. Solow, “Capital-labor substitution and eco-
  nomic efficiency,” Review of Economics and Statistics, 1961, 3, 225–250.

Baldwin, Richard E. and Anthony J. Venables, “Regional economic integration,” in
  Gene M. Grossman and Kenneth Rogoff, eds., Handbook of International Economics, Vol. 3
  New York: Elsevier 1995.

Bas, Maria, Thierry Mayer, and Mathias Thoenig, “From Micro to Macro: Demand,
  Supply, and Heterogeneity in the Trade Elasticity,” mimeo, 2015.

Bernard, Andrew B. and J. Bradford Jensen, “Exceptional Exporter Performance: Cause,
  Effect, or Both,” Journal of International Economics, 1999, 47, 1–25.

Berry, Steven, “Estimating Discrete-Choice Models of Product Differentiation,” RAND
  Journal of Economics, 1994, 25 (2), 242–262.

  , James Levinsohn, and Ariel Pakes, “Automobile Prices in Market Equilibrium,”
  Econometrica, 1995, 63 (4), 841–890.

Berry, Steven T., Amit Gandhi, and Philip A. Haile, “Connected substitutes and invert-
  ibility of demand,” Econometrica, 2013, 81 (5), 2087–2111.

                                              43
   and Philip A. Haile, “Identification in differentiated products markets using market
  level data,” Econometrica, 2014, 82 (5), 1749–1797.

Bowen, Harry P., Edward E. Leamer, and Leo Sveikauskas, “Multicountry, Multifactor
  Tests of the Factor Abundance Theory,” American Economic Review, 1987, 77 (5), 791–809.

Bresnahan, Timothy F. and Robert J. Gordon, The economics of new goods, Chicago: Uni-
  versity of Chicago Press, 2008.

Burstein, Ariel and Gita Gopinath, “International prices and exchange rates,” in Gita
  Gopinath, Elhanan Helpman, and Kenneth Rogoff, eds., Handbook of International Eco-
  nomics, Vol. 4 New York: Elsevier 2013.

   and Jonathan Vogel, “Globalization, Technology, and the Skill Premium,” 2010.
  Manuscript, Columbia University and UCLA.

  , Joao C. Neves, and Sergio Rebelo, “Distribution costs and real exchange-rate dynam-
  ics during exchange-rate-based stabilizations,” Journal of Monetary Economics, 2003, 50
  (6), 1189–1214.

Caliendo, Lorenzo and Fernando Parro, “Estimates of the Trade and Welfare Effects of
  NAFTA,” Review of Economic Studies, 2015, 82 (1), 1–44.

Cameron, A. Colin and Douglas L. Miller, “Robust inference with clustered data,” 2010.
  UC Davis working paper.

Canay, Ivan A., Andres Santos, and Azeem M. Shaikh, “On the Testability of Identifi-
  cation in some Nonparametric Models with Endogeneity,” Econometrica, 2013, 81 (6),
  2535–2559.

Chiappori, P.A. and Ivar Ekeland, The Economics and Mathematics of Aggregation: Formal
 Models of Efficient Group Behavior, Boston: Now, 2009.

Costinot, Arnaud and Andres Rodríguez-Clare, “Trade Theory with Numbers: Quan-
 tifying the Consequences of Globalization,” in Gita Gopinath, Elhanan Helpman, and
  Kenneth Rogoff, eds., Handbook of International Economics, Vol. 4, New York: Elsevier,
  2013.

  , Dave Donaldson, and Cory Smith, “Evolving Comparative Advantage and the Im-
  pact of Climate Change in Agricultural Markets: Evidence from a 1.7 Million Fields
  Around the World,” Journal of Political Economy. In press, 2015.


                                            44
  , , and Ivana Komunjer, “What Goods Do Countries Trade? A Quantitative Explo-
  ration of Ricardo’s Ideas,” Review of Economic Studies, 2012, 79 (2), 581–608.

Davis, Donald R. and David Weinstein, “An Account of Global Factor Trade,” American
 Economic Review, 2001, 91 (5), 1423–1453.

Deardorff, Alan V. and Robert W. Staiger, “An Interpretation of the Factor Content of
  Trade,” Journal of International Economics, 1988, 24 (1), 93–107.

Dekle, Robert, Jonathan Eaton, and Samuel Kortum, “Global Rebalancing with Gravity:
  Measuring the Burden of Adjustment,” IMF Staff Papers, 2008, 55 (3), 511–540.

Dixit, Avinash K. and Victor Norman, Theory of International Trade, Cambridge University
 Press, 1980.

Eaton, Jonathan and Samuel Kortum, “Technology, Geography and Trade,” Econometrica,
  2002, 70 (5), 1741–1779.

Fajgelbaum, Pablo and Amit Khandelwal, “Measuring the Unequal Gains from Trade,”
  UCLA working paper, 2014.

Goldberg, Pinelopi K., “Product Differentiation and Oligopoly in International Markets:
  The Case of the U.S. Automobile Industry,” Econometrica, 1995, 63 (4), 891–951.

Grossman, Gene M. and Esteban Rossi-Hansberg, “Trading Tasks: A Simple Theory of
 Offshoring,” American Economic Review, 2008, 98 (5), 1978–1997.

H., Jonathan H. Wright Stock James and Motohiro Yogo, “A survey of weak instruments
  and weak identification in generalized method of moments,” Journal of Business and
  Economic Statistics, 2002, 20 (4).

Hanson, Gordon H. and Raymond Robertson, “China and the Manufacturing Exports
  of Other Developing Countries,” in Robert C. Feenstra and Shang-Jin Wei, eds., China’s
  Growing Role in World Trade, University of Chicago Press, 2010.

  , Nels Lind, and Marc-Andreas Muendler, “The Dynamics of Comparative Advan-
  tage,” mimeo UCSD, 2014.

Hausman, J., “Exact Consumer’s Surplus and Deadweight Loss,” American Economic Re-
  view, 1981, 71, 662–676.

  and W. Newey, “Nonparametric estimation of exact consumers surplus and dead-
  weight loss,” Econometrica, 1995, 63 (6), 1445–1476.

                                             45
Head, Keith and John Ries, “Increasing Returns versus National Product Differentiation
 as an Explanation for the Pattern of U.S.-Canada Trade,” American Economic Review,
 2001, 91 (4), 858–876.

   and Thierry Mayer, “Gravity Equations: Toolkit, Cookbook, Workhorse,” in Gita
  Gopinath, Elhanan Helpman, and Kenneth Rogoff, eds., Handbook of International Eco-
  nomics, Vol. 4, New York: Elsevier, 2013.

Helpman, Elhanan, “Solutions of General Equilibrium Problems for a Trading World,”
 Econometrica, 1976, 44 (3), 547–559.

Hertel, Thomas, “Global Applied General Equilibrium Analysis Using the Global Trade
 Analysis Project Framework,” in Peter B. Dixon and Dale W. Jorgenson, eds., Handbook
  of Computable General Equilibrium Modeling, Vol. 1, New York: Elsevier, 2013.

Hertel, Thomas W., Robert A. McDougall, Badri G. Narayanan, and Angel H. Aguiar,
 “Behavioral Parameters,” in Badri G. Narayanan, Angel H. Aguiar, and Robert A. Mc-
  Dougall, eds., Global Trade, Assistance, and Production: The GTAP 8 Data Base, Center for
  Global Trade Analysis, Purdue University, 2012.

Howitt, Peter, “Gross substitutability with multi-valued excess demand functions,”
 Econometrica, 1980, 48 (6), 1567–1573.

Hsieh, Chang-Tai and Ralph Ossa, “A Global View of Productivity Growth in China and
  India,” NBER Working Paper, 2011.

Jacks, David S., Christopher M. Meissner, and Dennis Novy, “Trade booms, trade busts,
  and trade costs,” Journal of International Economics, 2011, 83 (2), 185–201.

Johnson, Robert C. and Guillermo Noguera, “Accounting for Intermediates: Production
  Sharing and Trade in Value Added,” Journal of International Economics, 2012, 86 (2), 224–
  236.

Krugman, Paul, “Technology, trade and factor prices,” Journal of International Economics,
  2000, 50, 51–71.

Leamer, Edward E., “What’s the use of factor contents?,” Journal of International Economics,
  2000, 50, 17–49.

  , “Tantalus on the Road to Asymptopia,” Journal of Economic Perspectives, 2010, 24 (2),
  31–46.


                                              46
Leontief, Wassily, “Domestic production and foreign trade; the American capital position
  re-examined,” Proceedings of the American philosophical Society, 1953, pp. 332–349.

Levchenko, Andrei A. and Jing Zhang, “The Evolution of Comparative Advantage: Mea-
  surement and Welfare Implications,” 2011. Michigan working paper.

Manski, Charles F., Partial Identification of Probability Distributions, New York: Springer-
  Verlag, 2003.

Mas-Colell, Andreu, “On the uniqueness of equilibrium once again,” in W.A. Barnett,
 B. Cornet, C. d’Aspremont, J. Gabszewicz, and A. Mas-Colell, eds., Proceedings of the
  sixth international symposium in economic theory and econometrics, Cambridge: Cambridge
  University Press, 1991.

  , Michael D. Whinston, and Jerry R. Green, Microeconomic Theory, Oxford University
  Press, 1995.

Matsuyama, Kiminori, “Beyond Icebergs: Towards a Theory of Biased Globalization,”
  Review of Economic Studies, 2007, 74, 237–253.

Meade, J.E., A Geometry of International Trade, London: George Allen and Unwin, 1952.

Milgrom, Paul and Ilya Segal, “Envelope Theorems for Arbitrary Choice Sets,” Econo-
 metrica, 2002, 70 (2), 583–601.

Neary, Peter and Albert Schweinberger, “Factor Content Functions and the Theory of
  International Trade,” Review of Economic Studies, 1986, 53 (3), 421–432.

Nevo, Aviv, “A Practitioner’s Guide to Estimation of Random Coefficients Logit Models
  of Demand,” Journal of Economics and Management Strategy, 2000, 9 (4), 513–548.

  , “Empirical Models of Consumer Behavior,” Annual Review of Economics, 09 2011, 3 (1),
  51–75.

Newey, Whitney K., “Nonparametric Instrumental Variables Estimation,” MIT working
 paper, 2013.

Newey, W.K. and J.L. Powell, “Instrumental Variable Estimation in Nonparametric Mod-
 els,” Econometrica, 2003, 71 (5), 1565–1578.

Novy, Dennis, “International Trade Without CES: Estimating Translog Gravity,” Journal
 of International Economics, 2013, 89 (2), 271–282.

                                            47
Oberfield, Ezra and Devesh Raval, “Micro Data and Macro Technology,” 2014. Princeton
 working paper.

Pollak, Robert A., Robin C. Sickles, and Terence J. Wales, “The CES-Translog: Specifi-
  cation and estimation of a new cost function,” Review of Economics and Statistics, 1984,
  66 (4), 602–607.

Rader, Trout, Theory of General Economic Equilibrium, Academic Press, 1972.

Ramondo, Natalia and Andres Rodríguez-Clare, “Trade, Multinational Production, and
  the Gains from Openness,” Journal of Political Economy, 2013, 121 (2), 273–322.

Scarf, Herbert E. and Charles A. Wilson, “Uniqueness of Equilibrium in the Multi-
  Country Ricardo Model,” in Timothy J. Kehoe, T. N. Srinivasan, and John Whalley,
  eds., Frontiers in Applied General Equilibrium Modeling, Cambridge: Cambridge Univer-
  sity PressCambridge University Press, 2005.

Schott, Peter K., “Across-Product versus Within-Product Specialization in International
  Trade,” Quarterly Journal of Economics, 2004, 119 (2), 647–678.

Shapiro, Joseph, “Trade, CO2, and the Environment,” Yale working paper, 2012.

Taylor, F.M., The guidance of production in a socialist state, Minneapolis: University of Min-
  nesota Press, 1938.

Trefler, Daniel, “International Factor Price Differences: Leontief Was Right!,” Journal of
  Political Economy, 1993, 101 (6), 961–987.

  , “The Case of the Missing Trade and Other Mysteries,” American Economic Review, 1995,
  85 (5), 1029–46.

Wilson, Charles A., “On the General Structure of Ricardian Models with a Continuum
  of Goods: Applications to Growth, Tariff Theory, and Technical Change,” Econometrica,
  1980, 48 (7), 1675–1702.

Woodland, A.D., “Direct and Indirect Trade Utility Functions,” Review of Economic Studies,
  1980, 47, 907–926.

Yi, Kei-Mu, “Can Vertical Specialization Explain the Growth of World Trade?,” Journal of
  Political Economy, 2003, 111 (1), 52–102.




                                               48
A Proofs (for online publication)
A.1 Proposition 1
Proof of Proposition 1. (⇒) Suppose that (q, l, p, w) is a competitive equilibrium. For any country
i, let us construct Li ≡ { Lnji } such that

                                        Lnji =        ∑ ljink for all i, j, and n.
                                                       k

Together with the factors market clearing condition (5), the previous expression immediately im-
plies
                                          ∑ Lnij = vni for all i and n.
                                            j

In order to show that ( L, w) is a reduced equilibrium, we therefore only need to show

                                       Li ∈ argmax L̃i Ui ( L̃i )                                          (42)

                                           ∑ wnj L̃nji ≤ ∑ wni vni for all i.
                                           j,n                         n


We proceed by contradiction. Suppose that there exists a country i such that condition (42) does
not hold. Since profits are zero in a competitive equilibrium with constant returns to scale, we
must have ∑ j,k pkji qkji = ∑ j,n wnj Lnji . The budget constraint of the representative agent in the com-
petitive equilibrium, in turn, implies ∑ j,n wnj Lnji = ∑n wni vni . Accordingly, if condition (42) does
not hold, there must be L′i such that Ui ( L′i ) > Ui ( Li ) and ∑ j,n wnj ( Lnji )′ ≤ ∑n wni vni . Now consider
(q′i , l ′i ) such that

                                   (q ′i , l ′i )∈ argmaxq̃ ,l̃ i ui (q̃ i )
                                                                       i


                                                ∑     l̃ jink   ≤ ( Lnji )′ for all j and f ,
                                                 k
                                                                   k
                                             q̃kji ≤ f jik (l̃ ji ) for all j and k.

We must have
                                    ui (q′i ) = Ui ( L′i ) > Ui ( Li ) ≥ ui (qi ),

where the last inequality derives from the fact that, by construction, Li is sufficient to produce qi .
Utility maximization in the competitive equilibrium therefore implies


                                                ∑ pkji (qkji )′ > ∑ wni vni .
                                                j,k                        n




                                                                    49
Combining this inequality with ∑ j,n wnj ( Lnji )′ ≤ ∑n wni vni , we obtain

                                                  ∑ pkji (qkji )′ > ∑ wnj ( Lnji )′ .
                                                  j,k                         j,n


Hence, firms could make strictly positive profits by using L′i , to produce q′i , which cannot be
true in a competitive equilibrium. This establishes that ( L, w) is a reduced equilibrium with the
same factor prices and the same factor content of trade as the competitive equilibrium. The fact
that Ui ( Li ) = ui (qi ) can be established in a similar manner. If there were q′i such that ui (q′i ) =
Ui ( Li ) > ui (qi ), then utility maximization would imply


                                          ∑ pkji (qkji )′ > ∑ wni vni = ∑ wnj Lnji ,
                                          j,k                        n               j,n


which would in turn violate profit maximization in the competitive equilibrium.
(⇐) Suppose that ( L, w) is a reduced equilibrium. For any positive of vector of output delivered
in country i, qi ≡ {qkji }, let Ci (w, qi ) denote the minimum cost of producing qi ,

                                        Ci (w, qi ) ≡ minl̃               ∑ wnj l˜jink                     (43)
                                                                         j,k,n
                                                                           k
                                                        qkji ≤ f jik (l̃ ji ) for all j and k.             (44)

The first step of our proof characterizes basic properties of Ci . The last two steps use these proper-
ties to construct a competitive equilibrium that replicates the factor content of trade and the utility
levels in the reduced equilibrium.
Step 1. For any country i, there exists pi ≡ { pkji } positive such that the two following conditions hold:(i )

                                          Ci (w, qi ) =        ∑ pkji qkji , for all qi > 0,               (45)
                                                               j,k


and (ii ) if l i solves (43), then l i solves

                                                         k
                                      maxl̃ k pkji f jik (l̃ ji ) − ∑ wnj l˜jink for all j and k.          (46)
                                             ji
                                                                     n



For any i, j, and k, let us construct pkji such that

                                                                                         k
                                          pkji = minl̃ k {∑ wnj l̃ jink | f jik (l̃ ji ) ≥ 1}.             (47)
                                                          ji
                                                                n


Take l kji (1) that solves the previous unit cost minimization problem. Since f jik is homogeneous of
degree one, we must have f jik (qkji l kji (1)) ≥ qkji . By definition of Ci , we must also have Ci (w, qi ) ≤
∑ j,k,n qkji wnj l jink (1) = ∑ j,k pkji qkji . To show that equation (45) holds, we therefore only need to show

                                                                         50
that Ci (w, qi ) ≥ ∑ j,k pkji qkji . We proceed by contradiction. Suppose that Ci (w, qi ) < ∑ j,k pkji qkji . Then
there must be qkji > 0 such that
                                                   ∑ wnj ljink < qkji ∑ wnj ljink (1),
                                                    n                                     n

where l kji is part of the solution of (43). Since f jik is homogeneous of degree one, l kji /qkji would then
lead to strictly lower unit cost then l kji (1), which cannot be. This establishes condition (i ).
    To establish condition (ii ), we proceed again by contradiction. Suppose that there exists (l kji )′
such that
                                                                                  ′
                               pkji f jik ((l kji )′ ) − ∑ wnj (l jink ) > pkji f jik (l kji ) − ∑ wnj l jink .       (48)
                                                          n                                                n

Take the vector of output qi such that qkji = f jik (l kji ) and zero otherwise. Condition (i ) applied to
that vector immediately implies
                                                         pkji f jik (l kji ) =            ∑ wnj ljink .
                                                                                           n
                                                                                                                  ′
Combining this observation with inequality (48), we get pkji > ∑n wnj (l jink ) / f jik ((l kij )′ ), which con-
tradicts the fact that pkji is the minimum unit cost.

Step 2. Suppose that (qi , l i ) solves

                                               maxq̃ ,l̃ i ui (q̃i )                                                  (49)
                                                          i
                                                                                  k
                                                          q̃kji ≤ f jik (l̃ ji ) for all j and k,

                                             ∑ wnj l˜jink ≤ ∑ wni vni .
                                              k                         n


Then qi solves

                                                                maxq̃i ui (q̃i )                                      (50)

                                                          ∑      pkji q̃kji   ≤∑               wni vni ,
                                                          j,k                             n


and l i solves
                                                                k
                                      maxl̃ k pkji f jik (l̃ ji ) − ∑ wnj l˜jink for all j and k.                     (51)
                                              ji
                                                                              n

If (qi , l i ) solves (49), then

                                                        qi ∈ argmaxq̃ ui (q̃i )
                                                                                      i

                                                          Ci (w, q̃i ) ≤                   ∑ wni vni .
                                                                                               n


Combining this observation with Step 1 condition (i ), we obtain that qi solves (50). Likewise, if




                                                                              51
(qi , l i ) solves (49), then

                                            l i ∈ argminl̃           ∑ wnj l˜jink ,
                                                                     j,k,n
                                                                  k
                                               qkji ≤   f jik (l̃ ji )   for all j and k.

Combining this observation with Step 1 condition (ii ), we obtain that l i solves (51).

Step 3. For all i, take (qi , l i ) that solves

                                           maxq̃ ,l̃ i ui (q̃i )                                                    (52)
                                                   i
                                                                         k
                                                   q̃kji ≤ f jik (l̃ ji ) for all j and k,

                                             ∑ l˜jink ≤ Lnji for all j and n,
                                              k


and set q = ∑i qi and l = ∑i l i . Then (q, l, p, w) is a competitive equilibrium with the same factor prices,
w; (ii ) the same factor content of trade, Lnji = ∑k l jink for all i, j, and n; and (iii ) the same welfare levels,
Ui ( Li ) = ui (qi ) for all i.

    Since ( L, w) is a reduced equilibrium, if (qi , li ) solves (52), then (qi , li ) solves (49). By Step
2, qi and l i must therefore solve (50) and (51), respectively. Hence, the utility maximization and
                                                                                                                k
profit maximization conditions (1) and (3) are satisfied. Since the constraint q̃kji ≤ f jik (l̃ ji ) must
be binding for all j and k in any country i, the good market clearing condition (4) is satisfied as
well. The factor market clearing condition directly derives from the fact that ( L, w) is a reduced
equilibrium and the constraint, ∑k l˜nk ≤ Ln , must be binding for all j and n in any country i. By
                                              ji         ji
construction, conditions (i )-(iii ) necessarily hold.


A.2 Lemma 1
Proof of Lemma 1. We proceed in two steps.

Step 1. In a Ricardian economy, if good expenditure shares satisfy the connected substitute property, then
factor expenditure shares satisfy the connected substitute property.

    Our goal is to establish that factor demand, χ̄, satisfies the connected substitute property—
expressed in terms of the effective prices of the composite factors, ω j ≡ {τij ci }—if good demand,
σ̄, satisfies the connected substitute property, with

                σ̄ ( p j ) ≡ {{skj }|skj = pkj qkj /y j for some q j ∈ argmaxq̃ {ū(q̃)| ∑ pkj q̃kj ≤ y j }}.
                                                                                             k

Note that since ū is homothetic, σ̄ does not depend on income in country j. For notational conve-
nience, we omit the importer’s index, j, in the rest of this proof.


                                                                    52
    Consider a change in effective factor prices from ω to ω′ and a partition of countries { M1 , M2 }
such that ω ′i > ωi for all i ∈ M1 and ω ′i = ωi for all i ∈ M2 . Now take x, x′ > 0 such that x ∈ χ̄(ω )
and x′ ∈ χ̄(ω ′ ). For each exporting country i, we can decompose total expenditure shares into the
sum of expenditure shares across all sectors k,

                                                     xi =   ∑ sk xik ,
                                                             k


where sk denotes the share of expenditure on good k at the initial prices,

                                             {sk } ∈ σ̄({ pk (ω)}),
                                           pk (ω) = min{ωi /αki }.
                                                             i

For any good k, there are two possible cases. If no country i ∈ M2 has the minimum cost for good
k at the initial factor prices, ω, then


                                                ∑       xik = 0,                                    (53)
                                               i ∈ M2

                                                pk ( ω ) < pk ( ω ′ ).                              (54)

Let us call this set of good K1 . If at least one country i ∈ M2 has the minimum cost for good k, then

                                              ∑ ( xik )′ = 1,                                       (55)
                                             i ∈ M2

                                                  pk ( ω ) = pk ( ω ′ ).                            (56)

Let us call this second set of good K2 . Since x, x′ > 0, we know that both K1 and K2 are non-empty.
    Now consider the total expenditure on factors from countries i ∈ M2 when factor prices are
equal to ω′ . It must satisfy

                          ∑ ( xi )′ ≥ ∑ ∑ (sk )′ ( xik )′ = ∑ (sk )′ [ ∑ ( xik )′ ].
                         i ∈ M2       i ∈ M2 k ∈ K 2                       k ∈ K2   i ∈ M2


Combining the previous inequality with (55), we obtain

                                             ∑ ( xi ) ′ ≥ ∑ ( sk ) ′ .
                                            i ∈ M2               k ∈ K2


By the Inada conditions, all goods are consumed. Thus, we can invoke the connected substitute
property for goods in K1 and K2 . Conditions (54) and (56) imply


                                               ∑ ( sk ) ′ > ∑              sk .
                                              k ∈ K2              k ∈ K2




                                                            53
Since ∑i∈ M2 xik ≤ 1, the two previous inequalities further imply

                                     ∑ ( xi ) ′ > ∑          sk [    ∑       xik ] =         ∑ ∑          sk xik .
                                 i ∈ M2             k ∈ K2          i ∈ M2               i ∈ M2 k ∈ K 2


Finally, using (53) and the fact that {K1 , K2 } is a partition, we get


                             ∑ ( xi ) ′ > ∑ ∑                 sk xik +         ∑ ∑             sk xik =       ∑      xi .
                            i ∈ M2          i ∈ M2 k ∈ K 1                    i ∈ M2 k ∈ K 2                i ∈ M2


This establishes that χ̄ satisfies the connected substitute property.

Step 2. If factor demand χ̄ satisfies the connected substitute property, then for any vector of factor expendi-
ture shares, x > 0, there is at most one vector (up to a normalization) of effective factor prices, ω, such that
x ∈ χ̄(ω).

    We proceed by contradiction. Suppose that there exist ω, ω′ , and x0 > 0 such that x0 ∈ χ̄(ω),
x0 ∈ χ̄(ω′ ), and ω and ω ′ are not collinear. Since χ̄ is homogeneous of degree zero in all factor
prices, we can assume without loss of generality that ωi ≥ ωi′ for all i, with at least one strict
inequality and one equality. Now let us partition all countries into two groups, M1 and M2 , such
that

                                                    ωi′ > ωi if i ∈ M1 ,                                                    (57)
                                                    ωi′ = ωi if i ∈ M2 .                                                    (58)

Since χ̄ satisfies the connected substitute property, conditions (57) and (58) imply that for any
x, x′ > 0 such that x ∈ χ̄(ω ) and x′ ∈ χ̄(ω ′ ), we must have


                                                       ∑       x′i >          ∑       xi ,
                                                      i ∈ M2                 i ∈ M2


which contradicts the existence of x0 ∈ χ̄(ω ) ∩ χ̄(ω ′ ). Lemma 1 follows from Steps 1 and 2.


A.3 Lemma 2
Proof of Lemma 2. We proceed by contradiction. Suppose that there exist two equilibrium vectors
of factor prices, c ≡ (c1 , ..., c I ) and c′ ≡ (c1′ , ..., c′I ), that are not collinear. By Proposition 1, we know
that c and c′ must be equilibrium vectors of the reduced exchange model. So they must satisfy

                                              ∑ Lij =               f¯i (νi ), for all i,                                   (59)
                                                j

                                              ∑ L′ij =              f¯i (νi ), for all i,                                   (60)
                                                j




                                                                      54
where { Lij } and { L′ij } are the optimal factor demands in the two equilibria,

                                                 { Lij } ∈ L̄(ω j ), for all j,
                                                 { L′ij } ∈ L̄(ω′j ), for all j,

where ω j ≡ {τij ci } and ω ′j ≡ {τij c′i } are the associated vectors of effective factor prices.
    We can follow the same strategy as in Step 2 of the proof of Lemma A.3. Without loss of
generality, let us assume that c′i ≥ ci for all i, with at least one strict inequality and one equality.
We can again partition all countries into two groups, M1 and M2 , such that

                                                        c′i > ci if i ∈ M1 ,                                  (61)
                                                        c′i = ci if i ∈ M2 .                                  (62)

The same argument then implies that in any country j,


                                                        ∑       x′ij >    ∑       xij ,
                                                       i ∈ M2            i ∈ M2


where { xij } and { xij′ } are the expenditure shares associated with { Lij } and { L′ij }, respectively. By
definition of the factor expenditure shares, the previous inequality can can be rearranged as


                                 ∑       c′i L′ij /(c′j f¯j (ν j )) >     ∑       ci Lij /(c j f¯j (ν j )).
                                i ∈ M2                                   i ∈ M2


Since ci ≥ c′i for all i, this implies
                                                      ∑     c′i L′ij >    ∑       ci Lij .
                                                   i ∈ M2                i ∈ M2

Summing across all importers j, we therefore have


                                               ∑       c′i ∑ L′ij >       ∑       ci ∑ Lij .
                                             i ∈ M2         j            i ∈ M2           j


By equations (59) and (60), this further implies


                                               ∑       c′i f¯i (νi ) >    ∑       ci f¯i (νi ),
                                              i ∈ M2                     i ∈ M2


which contradicts (62).



B Estimation (for online publication)
In this section we discuss further details of the estimation procedure outlined in Section 6.2.



                                                                   55
B.1 GMM Estimator
As in Section 6.2, define the stacked matrix of instruments, Z ≡ [Z1 | Z2 ], and the stacked vector
of errors, e(θ) ≡ χ̄−1 ( x|θ2 ) − Z 1 · θ1 . The GMM estimator is

                                      θ = arg min e(θ)′ ZΦZ′ e(θ).
                                      b
                                                θ

where Φ is the GMM weight. We confine attention to the consistent one-step procedure by setting
Φ = (Z′ Z)−1 .41


B.2 Standard Errors
In our baseline specification, we acknowledge the possibility of autocorrelation in the error term.
In particular, we assume that observations are independent across exporter-importer pairs, but
there is arbitrary autocorrelation across periods for the same pair. Following Cameron and Miller
(2010), we have that
                       √             h          −1 ′            −1 i
                           M bθ − θ → N 0, B′ ΦB      B ΦΛΦB B′ ΦB

           h             i
             ′ ∇ e ( θ) and Λ ≡ E [( Z ′ e )( Z ′ e ) ′ ], with Z = [ Z ] T
where B ≡ E Zji,t                                                                                   T
                  θ ji,t               ji ji    ji ji            ji    ji,t t=1 and e ji ≡ [e ji,t ]t=1
being matrices of stacked periods for exporter-importer pair ( j, i ).
    The covariance matrix can be consistently estimated using
                                                    −1                                −1
                              [ (b
                              Avar θ) ≡ B̂′ Φ B̂          B̂′ ΦΛ̂Φ B̂       B̂′ Φ B̂                  (63)
                                                                                    h             i
where B̂ ≡ Z′ ∇θ e(b
                   θ) , ∇θ e(b
                             θ) ≡ Dθ2 χ̄−1 ( x|θ2 ) | − Z1 , and Λ̂ ≡ Γ′ Γ such that Γ ≡ e ji (b
                                                                                               θ)′ Zji .
                                                                                                         ji
This analysis ignored the fact that we take draws of (αs , ǫs ) to compute simulated moment con-
ditions in the algorithm described below. Although this simulation step affects standard errors,
the asymptotic distribution of the estimator is the same as the number of simulated draws goes to
infinite. Thus, we compute the covariance matrix according to expression (63) which is assumed
to be an appropriate approximation for the large number of simulations (discussed below) used
in the empirical implementation.


B.3 Estimation Algorithm
The simulated GMM procedure is implemented with the following steps.
Step 0. Draw S simulated pairs (αs , ln ǫs ) ∼ N (0, I ). We set S = 4, 000 and use the same draws for
all markets.

  41 This is the efficient estimator under homoskedasticity, however this weight matrix leads to an innefi-
cient estimator under a more general covariance structure of errors.

                                                      56
Step 1. Conditional on θ2 , compute the vector χ̄−1 ( xi,t |θ2 ) ≡ {δji,t } N
                                                                            j=2 that solves the following
system:


                                              {χ̄ j (δ i,t |θ2 )} N                N
                                                                  j=2 = { x ji,t } j=2

where x ji,t is the expenditure share of importer i on exports of j at year t and

                                              1    S        exp[αs σα ln κ j + (ǫs )σǫ δji,t ]
                         χ̄ j (δi,t |θ2 ) =
                                              S   ∑ 1 + ∑N                        ln κl + (ǫs )σǫ δli,t ]
                                                                                                            .
                                                  s =1        l =2 exp [ α s σα

Uniqueness and existence of the solution is guaranteed by the fixed point argument in Berry,
Levinsohn and Pakes (1995). To solve the system, consider the fixed point of the following func-
tion:
                                                                                     N
                               G (δ i,t ) = δji,t + λ ln x ji,t − ln χ̄ j (δi,t |θ2 ) j=2

where λ is a parameter controlling the adjustment speed. This fixed point is obtained as the limit of
                n +1
                              
the sequence: δi,t   = G δni,t . Numerically, we compute the sequence until max j ln x ji,t − ln χ̄ j (δi,t |θ2 ) <
tol, where tol is some small number that we discuss further below.
                                                                   0 in the initial iteration is set to
    This step is implemented as follows. First, the initial guess δij,t
be the logit solution δ0ji,t = ln x ji,t − ln x1i,t . In subsequent iterations, we use the following rule.
If θ2 is close to the parameter vector of the previous iteration, we use the system solution in the
last iteration. Otherwise, we use the vector that solved the system for the same importer in the
previous year (if it is the first year, we use the logit solution). Second, the speed of adjustment is
initially set to λ = 3. If distance increases in iteration n, then we reduce λ by 5% and compute
 n +1
δi,t  again until distance decreases in the step and use the new value of λ until the solution is
found. If λ falls below a minimum (λ = .001), then we assume no solution for the system and set
the objective function to a high value. Lastly, we set tol = 10−8 and, every 20,000 iterations, we
increase tolerance by a factor of two. This guarantees that the algorithm does not waste time on
convergence for parameter values far away from the real ones.42

Step 2. Conditional on θ2 , solve analytically for linear parameters directly from the minimization
                    ′            −1 ′
problem: b
         θ1 (θ2 ) = Z1 ZΦZ′ Z1       Z1 ZΦZ′ χ̄−1 ( x|θ2 ).

Step 3. Conditional on θ2 , compute the vector of structural errors: e(θ2 ) = χ̄−1 ( x|θ2 ) − Z1 · b
                                                                                                   θ1 (θ2 )

Step 4. Numerically minimize the objective function to obtain estimates of θ2 :

                                   θ̂2 ≡ arg min H (θ2 ) ≡ e(θ2 )′ ZΦZ′ e(θ2 ).
                                                       θ2


The numerical minimization is implemented using the “trust-region-reflective" algorithm that re-

  42 This   adjustment procedure follows closely the suggestions in Nevo (2000).

                                                                57
quires an analytical gradient of the objective function (described below). This algorithm is in-
tended to be more efficient in finding the local minimum within a particular attraction region.
First, we solve the minimization problem using a grid of ten initial conditions randomly drawn
from a uniform distribution in the parameter space. Second, we solve a final minimization prob-
lem using as initial condition the minimum solution obtained from the first-round minimization.
Here, we impose a stricter convergence criteria and we reduce the tolerance level of the system
solution in Step 1 to tol = 10−12 .

Objective Function
          h          Gradient.
                             i      The Jacobian of H (θ2 ) is ∇ H (θ2 ) = 2 · De(θ2 )′ ZΦZ′ e(θ2 ) where
            ∂e ji,t  ∂e ji,t
De(θ2 ) = ∂θ21 . . . ∂θ2L      is the stacked matrix of Jacobian vectors of the structural error from
                              ijt
Step 5. By the envelope theorem, the Jacobian is De(θ2 ) = Dδ(θ2 ) because b
                                                                           θ1 (θ2 ) is obtained
from the analytical minimization of the inner problem restricted to a particular level of θ2 . For
each importer-year, the implicit function theorem implies that

                           ∂δ2i,t                   ∂δ2i,t
                                                                             ∂χ̄2              ∂χ̄2
                                                                                                          −1    ∂χ̄2           ∂χ̄2
                                                                                                                                         
                            ∂θ21          ...        ∂θ2L                     ∂δ2i,t    ...     ∂δNi,t            ∂θ21    ...    ∂θ2L
                             ..          ..           ..                     ..      ..        ..              ..    ..       ..    
         Dδi,t (θ2 ) = 
                              .             .          .      = −
                                                                               .         .       .     
                                                                                                         
                                                                                                             
                                                                                                                    .       .      .    
                                                                                                                                         
                            ∂δNi,t                   ∂δNi,t                   ∂χ̄ N              ∂χ̄ N            ∂χ̄ N          ∂χ̄ N
                             ∂θ21         ...        ∂θ2L                     ∂δ2i,t    ...     ∂δNi,t            ∂θ21    ...    ∂θ2L


where                         (
                  ∂χ̄ j                   − S1 ∑Ss=1 (ǫs )σǫ · x ji,t (αs , ǫs ) xli,t (αs , ǫs )       if l 6= j
                         =              1   S          σǫ
                                                                                                      
                  ∂δli,t                S ∑ s =1 ( ǫs ) · x ji,t ( α s , ǫs ) 1 − x ji,t ( α s , ǫs )   if l = j
                                                                              "                                   #
                  ∂χ̄ j             S                                                             N
                          1
                  ∂σǫ
                        =
                          S        ∑ (ln ǫs )(ǫs )σ           ǫ
                                                                  · x ji,t (αs , ǫs ) · δji,t − ∑ xli,t (αs , ǫs ) · δli,t
                                   s =1                                                          l =2
                                                                                "                                 #
                           ∂χ̄ j                 S                                        N
                                   1
                           ∂σα
                                 =
                                   S         ∑ αs · x ji,t (αs , ǫs ) ·             κi − ∑ xli,t (αs , ǫs ) · κl .
                                            s =1                                         l =2




                                                                           58
C Sample of Countries (for online publication)

Table A1: List of exporting countries

                                         log(p.c. GDP)
Abbreviation     Exporter                  [USA=0]
AUS              Australia                   -0.246
AUT              Austria                     -0.249
BLX              Belgium-Luxembourg          -0.261
BRA              Brazil                      -1.666
BGR              Bulgaria                    -1.603
CAN              Canada                      -0.211
CHN              China                       -2.536
CZE              Czech Republic              -0.733
DNK              Denmark                     -0.303
BAL              Estonia-Latvia              -1.475
FIN              Finland                     -0.522
FRA              France                      -0.398
DEU              Germany                     -0.290
GRC              Greece                      -0.760
HUN              Hungary                     -1.121
IND              India                       -3.214
IDN              Indonesia                   -2.284
IRL              Ireland                     -0.574
ITA              Italy                       -0.332
JPN              Japan                       -0.183
LTU              Lithuania                   -1.526
MEX              Mexico                      -1.263
NLD              Netherlands                 -0.352
POL              Poland                      -1.428
PRT              Portugal                    -0.830
KOR              Republic of Korea           -0.823
RoW              Rest of the World           -2.286
ROU              Romania                     -1.816
RUS              Russia                      -0.954
SVK              Slovak Republic             -1.102
SVN              Slovenia                    -0.728
ESP              Spain                       -0.644
SWE              Sweden                      -0.367
TWN              Taiwan                      -0.584
TUR              Turkey                      -1.305
GBR              United Kingdom              -0.436
USA              United States               0.000


                                        59
D       Counterfactual Analysis (for online publication)
D.1 Preliminaries
In the counterfactual analysis of Section 7, we use the complete trade matrix for the 37 exporters
listed in Table A1. In order to reconcile theory and data, we incorporate trade imbalances as
follows. For each country, we define ρ j,t as the difference between aggregate gross expenditure
and aggregate gross production. We proceed under the assumption that trade imbalances remain
constant at their observed level in terms of the factor price of the reference country. Here, the
reference country is the United States (j = 1) such that its factor price is normalized to one, ŵ1 = 1.
In particular, the market clearing condition in (16) becomes

                                 N
                                ∑ x̂ji,t xji,t ((ŵi v̂i )yi,t + ρi,t ) = (ŵ j v̂j )yj,t ,          for j = 2, ..., N         (64)
                                i=1

where
                                                                                                            
                                      S  exp   [ α   σ  ln κ   + ( ǫ   ) σǫ χ̄ −1 ( x |θ ) − ǭ ln ( ŵ τ̂ ) ]
                              1                    s  α      j       s         j     i,t 2             j  ji
            x̂ ji,t x ji,t   = ∑                       h                                                          i .        (65)
                              S s=1 1 + ∑ exp α σ ln κ + (ǫ )σǫ χ̄−1 ( x |θ ) − ǭ ln(ŵ τ̂ )
                                          N
                                          l =2            s α      l        s        l     i,t 2              l li


Notice that, by construction, ∑iN=1 ρi,t = 0. Thus, the solution of the system of N − 1 equations
above implies that the market clearing condition for the reference country is automatically satis-
fied.


D.2 Algorithm
To compute the vector ŵ = {ŵ j } N
                                   j=2 that solves system (64), we use the same algorithm as in
Alvarez and Lucas (2007).

Step 0. Initial guess: ŵk = [1, ..., 1] if k = 0.

Step 1. Conditional on ŵk , compute x̂ ji,t x ji,t according to (65).

Step 2. Compute the excess labor demand as
                                                          "                                                                #
                                                   1                            N
                                          k
                               Fj ŵ              ≡         −(ŵ j v̂ j )y j,t + ∑ x̂ ji,t x ji,t ((ŵi v̂i )yi,t + ρi,t )
                                                    y j,t                        i=1


where we divide by y j,t to scale excess demand by country size.
                      
Step 3. If max j | Fj ŵk | < tol, then stop the algorithm. (In practice we set tol = 10−8 here.)




                                                                              60
Otherwise, return to Step 1 with new factor prices computed as
                                                                           
                                                      ŵkj +1 = ŵkj + µFj ŵk

where µ is a positive constant. Intuitively, this updating rule increases the price of those factors
with a positive excess demand.


D.3 Welfare
By Proposition 3, we can compute welfare changes in any country i by solving for e(·, Ui′ ). To do
so, we guess that for all ω ≡ {ωl },

                                                        1              N           σα α ( ω ) −( ǭǫ σǫ ) ]dF α, ǫ
                                                  ´
                                              exp( −(ǭǫ   σǫ ) ln [ ∑ l =1 (κ l )          l                ( ))
                  e(ω, Ui′ )   =   (y′i )           1               N                                    σ
                                                                                                                      .   (66)
                                                                              σα α (( ω ) ′ ) −( ǭǫ ǫ ) ]dF ( α, ǫ))
                                                ´
                                            exp( −(ǭǫ σǫ ) ln[ ∑ l =1 (κ l )             li,t


We then check that our guess satisfies (18) and (19) if χ̄ satisfies (31). By equations (20) and (66),
welfare changes must therefore satisfy
                                                                                        σǫ
                       (y′i )/ exp( −(ǭǫ1 σǫ ) ln[∑lN=1 (κl )σα α ((ωli,t )′ )−(ǭǫ ) ]dF (α, ǫ))
                                   ´
                 ∆Wi =                                                                                     − 1.
                                     1             N          σα α ( χ̄ −1 ( x )) −( ǭǫ σǫ ) ]dF ( α, ǫ))
                                 ´
                       yi / exp( −(ǭǫ σǫ ) ln[ ∑ l =1 (κ l )           l     i,t


Using the fact that (yi )′ /yi = ŵi and (ωli,t )′ = ŵl τ̂li χ̄− 1
                                                                l ( xi,t ), this finally leads to

                                       1            N            σα α ( χ̄ −1 ( x )) −( ǭǫ σǫ ) ]dF α, ǫ
                                ´
                            exp( −(ǭǫ   σǫ ) ln[ ∑ l =1 (κ l )            l     i,t                ( ))
             ∆Wi = (ŵi )                                                                                    − 1,
                                  1              N           σα α ( ŵ τ̂ χ̄ −1 ( x )) −( ǭǫ ) ]dF ( α, ǫ))
                                                                                                 σǫ
                              ´
                          exp( −(ǭǫ σǫ ) ln [ ∑ l =1 (κ l )          l li l         i,t


with {ŵl } obtained from the algorithm in Section D.2.


D.4 Confidence Intervals
The confidence intervals for the counterfactual analysis are computed with the following boot-
strap procedure. First,
                   draw parameter
                                     values from the asymptotic distribution of the GMM es-
                        [ (θ̂) . Second, compute χ̄−1 ( xi,t |θ2 (b)) using the algorithm described
timator: θ(b) ∼ N θ̂, AVar
in Step 1 of Section B.3. Third, compute the counterfactual exercise with θ(b) and χ̄−1 ( xi,t |θ2 (b))
using the algorithm described in Section D.2. Lastly, repeat these three steps for b = 1, ..., 200.
The bootstrap confidence interval corresponds to [ EV (.025) , EV (.975) ] where EV (α) denotes the α-th
quantile value of the equivalent variation obtained across the set of 200 parameter draws.




                                                                    61
D.5 Additional Results

Table A2: Welfare gains from Chinese integration since 1995: all countries, 2007

                                   CES (standard gravity)                             Mixed CES
Exporter                  Welfare Gains   95% Confidence Interval     Welfare Gains     95% Confidence Interval
Australia                      0.144            (0.120, 0.176)            0.225              (0.163, 0.384)
Austria                        0.058            (0.048, 0.071)            0.102              (0.069, 0.187)
Belgium-Luxembourg             0.056            (0.046, 0.069)            0.108              (0.064, 0.195)
Brazil                         0.071            (0.059, 0.087)            0.058              (0.051, 0.104)
Bulgaria                       0.061            (0.050, 0.075)           -0.005              (-0.050, 0.040)
Canada                         0.053            (0.043, 0.065)            0.098              (0.059, 0.176)
China                          1.039            (0.866, 1.268)            1.544              (1.195, 2.812)
Czech Republic                 0.151            (0.124, 0.186)            0.209              (0.163, 0.374)
Denmark                        0.014            (0.012, 0.018)            0.034              (0.014, 0.076)
Estonia-Latvia                 0.081            (0.067, 0.100)            0.043              (0.029, 0.085)
Finland                        0.100            (0.083, 0.123)            0.154              (0.109, 0.279)
France                         0.030            (0.025, 0.037)            0.057              (0.037, 0.125)
Germany                        0.122            (0.101, 0.150)            0.201              (0.144, 0.347)
Greece                         0.004            (0.003, 0.004)            0.018              (0.004, 0.061)
Hungary                        0.214            (0.177, 0.264)            0.208              (0.178, 0.352)
India                          0.126            (0.104, 0.155)            0.022              (-0.064, 0.101)
Indonesia                      0.026            (0.022, 0.033)           -0.061             (-0.222, -0.004)
Ireland                        0.135            (0.112, 0.167)            0.150              (0.128, 0.241)
Italy                          0.008            (0.007, 0.010)            0.035              (0.012, 0.089)
Japan                          0.095            (0.079, 0.117)            0.186              (0.120, 0.368)
Lithuania                      0.065            (0.054, 0.079)            0.022              (-0.001, 0.052)
Mexico                         0.121            (0.100, 0.150)            0.099              (0.086, 0.204)
Netherlands                    0.043            (0.035, 0.053)            0.068              (0.042, 0.116)
Poland                         0.086            (0.071, 0.107)            0.040              (0.026, 0.096)
Portugal                       0.050            (0.042, 0.060)            0.055              (0.047, 0.093)
Republic of Korea              0.298            (0.248, 0.364)            0.399              (0.311, 0.654)
Rest of the World              0.293            (0.244, 0.358)            0.105              (-0.039, 0.246)
Romania                       -0.005           (-0.006, -0.004)          -0.077             (-0.215, -0.029)
Russia                         0.105            (0.087, 0.129)            0.103              (0.089, 0.157)
Slovak Republic                0.116            (0.096, 0.143)            0.120              (0.101, 0.207)
Slovenia                       0.012            (0.009, 0.015)            0.020              (0.010, 0.045)
Spain                          0.075            (0.062, 0.092)            0.112              (0.085, 0.213)
Sweden                         0.076            (0.063, 0.094)            0.113              (0.085, 0.205)
Taiwan                         0.695            (0.582, 0.843)            0.946              (0.743, 1.520)
Turkey                         0.024            (0.020, 0.030)            0.019              (0.016, 0.042)
United Kingdom                 0.014            (0.011, 0.017)            0.022              (0.013, 0.049)
United States                  0.034            (0.028, 0.043)            0.071              (0.046, 0.136)

Notes: Estimates of welfare changes (computed as the minus of the equivalent variation) from replacing
China’s trade costs to all other countries in 2007 at their 1995 levels. “CES (standard gravity)” and “Mixed
CES” report these welfare changes obtained using the factor demand system in Panels A and C, respectively,
of Table 2. 95% confidence intervals computed using the bootstrap procedure documented in Appendix D.




                                                      62
