                                 NBER WORKING PAPER SERIES




           OPTIMAL TAXATION WITH ENDOGENOUS INSURANCE MARKETS

                                            Mikhail Golosov
                                            Aleh Tsyvinski

                                         Working Paper 11185
                                 http://www.nber.org/papers/w11185


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      March 2005




Golosov acknowledges support of the University of Minnesota Doctoral Dissertation Fellowship. This work
grew out of numerous discussions with V.V. Chari and would not be possible without his support and
encouragement. We thank George-Marios Angeletos, Andy Atkeson, Marco Bassetto, Amy Finkelstein,
Larry Jones, Narayana Kocherlakota, Patrick Kehoe, Robert Lucas, Jr., Lee Ohanian, Chris Phelan, Alice
Schoonbroodt, Nancy Stokey for their comments. The views expressed herein are those of the author(s) and
do not necessarily reflect the views of the National Bureau of Economic Research.

 © 2005 by Mikhail Golosov and Aleh Tsyvinski. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is
given to the source.
Optimal Taxation with Endogenous Insurance Markets
Mikhail Golosov and Aleh Tsyvinski
NBER Working Paper No. 11185
March 2005
JEL No. E62, H21, H23, H53

                                           ABSTRACT

We study optimal tax policy in a dynamic private information economy with endogenous private

markets. We characterize efficient allocations and competitive equilibria. A standard assumption in

the literature is that trades are observable by all agents. We show that in such an environment the

competitive equilibrium is efficient. The only effect of government interventions is crowding out of

private insurance. We then relax the assumption of observability of consumption and consider an

environment with unobservable trades in competitive markets. We show that efficient allocations

have the property that the marginal product of capital is different from the market interest rate

associated with unobservable trades. In any competitive equilibrium without taxation, the marginal

product of capital and the market interest rate are equated, so that competitive equilibria are not

efficient. Taxation of capital income can be welfare-improving because such taxation introduces a

wedge between market interest rates and the marginal product of capital and allows agents to obtain

better insurance in private markets. Finally, we use plausibly calibrated numerical examples to

compute optimal taxes and welfare gains and compare results to an economy with a restricted set of

tax instruments, and to an economy with observable trades.

Mikhail Golosov                                      Aleh Tsyvinski
MIT                                                  Department of Economics
Department of Economics                              Harvard University
E52-243G                                             Littauer Center
50 Memorial Drive                                    Cambridge, MA 02138-3001
Cambridge, MA 02142-1347                             and NBER
golosov@mit.edu                                      aleh@econ.ucla.edu
1       Introduction
The main question this paper addresses is how optimal tax and social insurance policy should
be designed when insurance can be provided by competitive markets. The presence of private
insurance markets can significantly change optimal policy prescriptions. In particular, we show
that, under assumptions common to the literature, the only eﬀect of government policy is crowd-
ing out of private insurance without improvement in welfare. We then identify circumstances
under which government policy can lead to better allocations than those that can be achieved
by competitive markets alone. Finally, we determine specific tax instruments that can bring
such a welfare improvement.
    We answer the question of design of optimal policy in a dynamic economy in which workers
receive unobservable skill shocks and can privately trade assets. We study two polar extremes: In
one extreme, individual asset trades and, therefore, agents’ consumption are publicly observable.
We show that the amount of insurance provided by private markets is eﬃcient1 , and gives agents
correct incentives to supply labor. The only eﬀect of government insurance provision is crowding
out of private insurance that leaves allocations and welfare unchanged. At the other extreme,
asset trades are private information. We show that, in this case, private insurance does not
lead to eﬃcient allocation of resources. Although each firm takes into account the eﬀects of
hidden asset trades of its policy holders, it does not internalize the eﬀect of these trades on the
incentives to supply labor by agents insured by other firms. Because of this externality, we show
that competitive equilibrium allocations can be improved by the government using distortionary
taxation.
    Our paper builds on the literature of government policy in private information economies
stemming from the seminal paper of Mirrlees (1971). Mirrlees (1971) showed that distorting
taxes are optimal when the society wishes to redistribute income across agents with unobservable
skills. More closely related to our work are papers by Green (1987), Atkeson and Lucas (1992),
and Golosov, Kocherlakota, and Tsyvinski (2003) who studied eﬃcient allocations in dynamic,
private information economies2 . These papers, with the exception of Atkeson and Lucas (1992),
assumed that the government is the sole provider of insurance. We show that, when one relaxes
exogenous restrictions on the existence of private markets, there is no role for government policy.
In particular, if all trades are observable and agents can sign binding contracts with private
insurers ex ante, the only eﬀect of public provision of social insurance is crowding out of private
    1
    By eﬃciency we mean constrained Pareto eﬃciency.
    2
    See also Hopenhayn and Nicolini (1997), Werning (2002), Albanesi and Sleet (2003), Golosov and Tsyvinski
(2003), Kocherlakota (2003b).



                                                     2
insurance. Therefore, the welfare gain from introducing public insurance is equal to zero in this
setting. The intuition for our result is that private insurers have the same incentives as the
government to insure agents. Therefore, the equilibrium allocation is eﬃcient. This result is
reminiscent of that in Prescott and Townsend (1984) who show that the First Welfare Theorem
holds in a large class of economies with private information.
    We then identify a class of models in which there may be role for government policy. When
asset trades are not observable, we show that private insurance is not suﬃcient for attaining
eﬃciency. We prove that eﬃciency requires that the interest rate at which agents can trade assets
diﬀers from the marginal rate of transformation. The intuition is that such an interest rate aﬀects
deviating agents to a larger extent than truth-telling agents thus improving incentives. We show
that, in a competitive equilibrium, competition and arbitrage among diﬀerent insurers implies
that interest rates at which agents trade are equated to the marginal rates of transformation.
We conclude that privately provided insurance is ineﬃcient in this environment. A government
can introduce a wedge between the interest rate and the marginal rate of transformation by
using distorting taxes, an avenue not available to private insurers. We show that such policies
are welfare improving.
    It is worth noting that, even in the environment with unobservable trades, government in-
surance can crowd out private insurance by changing nature of private insurance contracts. We
show that numerical estimates of the size of welfare gains from changes in public policy that do
not take into account private market responses can give very misleading results. Typically, such
welfare eﬀects are smaller when private markets are endogenous. We study an application of our
theory to a quantitative model of optimal disability insurance similar to Golosov and Tsyvinski
(2004) to provide an illustration of the magnitude of the crowding out eﬀect. Our benchmark
is eﬃcient allocations with hidden trades. We consider the eﬀect of complete elimination of
the optimally-provided public insurance in two environments. In the first environment, private
markets are exogenously restricted such that the only form of insurance available to agents is
provided by trading risk-free bonds. In the second environment, we impose no restrictions on
private markets. We find that the welfare losses from elimination of public insurance are signifi-
cantly smaller in the economy where private markets are endogenous. We conclude that private
markets can provide most of the insurance even in the absence of government interventions.
    The papers most closely related to our analysis are those of Arnott and Stiglitz (1986,
1990) and Greenwald and Stiglitz (1986). They showed that in hidden action or moral hazard
economies unobservable insurance purchases cause the competitive equilibria to be constrained
ineﬃcient. None of these papers consider hidden information environments, such as those with


                                                3
unobservable skills. More importantly, we concentrate on the eﬀect of asset trading on the
dynamic incentives, an aspect that was not considered in these papers3 . Our paper is also related
to the literature on mechanism design with unobservable savings (see, for example, Diamond and
Mirrlees (1995), Cole and Kocherlakota (2001), Werning (2002), Abraham and Pavoni (2002),
and Kocherlakota (2003a)). In these papers, the authors assume that private insurance markets
do not exist and the rate of return on savings is given. We show that, if private markets are
unrestricted, competitive equilibria are eﬃcient in these environments with hidden savings. In
contrast, we study an economy in which market interest rates are endogenously determined by
trading in markets.
    Our results are also related to Diamond and Dybvig’s (1983) analysis of bank deposits as
means of risk sharing. Jacklin (1987) pointed out that in their model risk sharing breaks down
if agents are able to trade among themselves unobservably. One can show that, similarly to our
model, competitive equilibrium is not eﬃcient in that set up because a contract oﬀered by any
bank aﬀects incentives for the agents insured with other banks.
    The rest of the paper is organized as follows. Section 2 describes the environment. Section
3 considers the environment with observable trades and establishes the eﬃciency result. Section
4 analyzes the economy with unobservable trades. We propose a concept of eﬃciency in such
an environment and provide a partial characterization of the eﬃcient allocations. We show that
competitive equilibrium is not eﬃcient and that positive taxes on capital income are welfare
improving. Section 5 presents numerical results. We conclude in Section 6.


2        Environment
We consider an economy that lasts T (T ≤ ∞) periods, denoted by t = 1, ..., T . In period 1, the
economy is endowed with K1 units of capital. The economy has a continuum of agents with a
unit measure. Each agent’s preferences are described by a time separable utility function over
consumption of a private good ct , labor lt , and consumption of a public good Gt as follows

                                            T
                                            X
                                                  β t (u(ct , lt ) + ug (Gt )).
                                            t=1

   In the above specification, β is a discount factor, and β ∈ (0, 1). The utility function is
continuous, strictly increasing, strictly concave in consumption of both private and public goods,
and decreasing in labor, u0 (0) = ∞, and u(0) = −∞.
    3
        See also Bisin and Guaitoli (2004) and Bisin and Rampini (2003).


                                                             4
     Agents are heterogenous and in each period they have idiosyncratic skills θ that belong to
a finite distribution Θ = {θ(1), ..., θ(N )} where θ(1) < θ(2) < ... < θ(N ). These skills evolve
stochastically over time. Formally, in period one each agent gets an iid draw of a vector of skills
for T periods from the distribution ΘT with a common probability π(θT ). The t-th component
of θT is agent’s skill in period t. The probability π(θT ) is known but the specific realization of
it is not. Each agent learns about his realization of θT over time. In period t, he knows only his
skill realization for the first t periods θt = (θ1 , ..., θ t ). Skills are private information. We assume
that the law of large numbers holds, and in each period there are exactly π(θt ) agents with the
history of shocks θt . Our structure implies that there is no aggregate uncertainty.
     An agent who supplies l units of labor and has a skill level θ produces y = θl units of eﬀective
labor. The supply of labor is not observable. In the paper we use a common interpretation that,
although it is possible to observe how many hours an agent spends at his workplace, it is
impossible to determine if he works or consumes leisure there. This interpretation implies that
in checking incentive constraints we only need to consider the possibility that agents underreport
their skill level.
     Eﬀective labor is observable and is a factor of production. Production in this economy is
described by a function F (K, Y ), where K is the stock of capital, and Y is the aggregate level
                          P
of eﬀective labor Y = θ π(θ)y(θ). We assume that F is continuous, increasing in K and Y ,
and exhibits constant returns to scale. The output can be divided into consumption of private
and public goods, and investment.
     An allocation is a vector {ct , yt , Gt , Kt }Tt=1 where ct : Θt → R+ ; yt : Θt → R+ ; Kt , Gt ∈ R+ .
Here, c(θt ) is private consumption of an agent with history θt ; y(θt ) is the amount of eﬀective
units that such a person supplies, and Gt and Kt are the level of public good and capital in
period t. An allocation is feasible if, in every period t, it satisfies the feasibility constraint given
by
                         X                                            X
                             π(θt )c(θt ) + Kt+1 + Gt ≤ F (Kt ,           π(θt )y(θt )).                (1)
                         θt                                       θt

   We say that a history θj contains θi for j ≥ i if the first i realizations of θj are θi and
we denote it θi ∈ θj . We also use notation ct (θT ) which is equivalent to c(θt ) for θt ∈ θT . The
probability of history θt+1 conditional of the realization of the history θt is denoted by π(θt+1 |θt ).




                                                    5
3     Observable consumption
We first consider an environment with dynamically evolving private information in which con-
sumption of each agent is publicly observable. We define an eﬃcient allocation and a competitive
equilibrium. We then prove that, in this environment, private markets can provide optimal in-
surance. Therefore, there is no need for government interventions such as distortionary taxation.
Moreover, any provision of insurance by the government reduces the amount of insurance pro-
vided by private markets by the equivalent amount — we observe full "crowding out".

3.1    Eﬃcient allocations
Under our notion of eﬃcient allocations, a social planner oﬀers each agent a contract {c(θt ), y(θt )}Tt=1 ,
where c(θt ) and y(θt ) are the functions of the agent’s reported type. Each agent chooses a re-
porting strategy σ, which is a mapping σ : ΘT → ΘT . We denote the set of all such reporting
strategies by Σ. An agent who chooses to report σ(θt ) after history θt provides y(σ(θt )) units
of eﬀective labor and receives c(σ(θt )) units of consumption from the planner.
    This setup has two interpretations. One interpretation is that the planner controls the
consumption of an agent directly, and an agent consumes goods that the planner allocates to
him. Under the other interpretation, an agent is able to enter observable contractual agreements
with other agents and trade various assets with them. The consumption allocations that the
social planner allocates can be conditioned on these trades. Since we impose no restrictions on
the allocations, the social planner can make any additional contractual agreements unappealing
to the agent such that he consumes c(σ(θt )) after each history θt .
    The expected utility of an agent who is oﬀered a contract {ct , yt }Tt=1 and chooses a strategy
σ is denoted by W (c, y)(σ) and given by

                                      T
                                      X          X
                      W (c, y)(σ) =         βt        π(θt )u(ct (σ(θt )), yt (σ(θt ))/θt ).
                                      t=1        θt

     The strategy σ ∗ is truth-telling if an agent reveals his type truthfully after any history:
σ ∗ (θt ) = θt for all t. The allocation is called incentive compatible if the truth telling strategy
yields a higher utility than any other strategy

                              W (c, y)(σ ∗ ) ≥ W (c, y)(σ) for any σ ∈ Σ.

    An allocation {ct , yt , Kt , Gt }Tt=1 is eﬃcient if it solves the planner’s problem that follows:


                                                         6
                                    T X
                                    X
                           max               π(θt )β t {u(c(θt ), y(θt )/θt ) + ug (Gt )}
                          c,y,K,G
                                    t=1 θt

s.t
                             W (c, y)(σ ∗ ) ≥ W (c, y)(σ) for any σ ∈ Σ,                                  (2)
                    X                                      X
                      π(θt )c(θt ) + Kt+1 + Gt ≤ F (Kt ,      π(θt )y(θt )) for all t.
                     θt                                            θt

    The above program states that the planner maximizes the expected utility of an agent subject
to the incentive compatibility constraint and to the feasibility constraint. We denote the solution
to this social planner’s problem as {csp    sp   sp   sp T
                                       t , yt , Kt , Gt }t=1 .


3.2    Competitive equilibrium
In this subsection, we define a competitive equilibrium for the economy with observable con-
sumption described above when Gt = 0 for all t. Consider an economy populated by ex-ante
identical agents each of whom is endowed with the same initial capital k1 , so that the aggregate
capital stock is K1 . There is a continuum of firms with the identical production technology
F (K, Y ). We assume throughout the paper that all activities at a firm level are observable. All
firms are owned equally by all agents. In the beginning of period 1, before any realization of
uncertainty, each firm signs a contract {ct , yt }Tt=1 with a continuum of workers and purchases the
initial capital stock k1 from them. We interpret ct as the actual consumption of the agent. Such
a contract is feasible since consumption and all transactions of agents are observable. The price
paid for the initial capital is included in the contract4 . The contracts are oﬀered competitively,
and workers sign a contract with the firm that promises the highest ex-ante expected utility.
We denote the equilibrium utility by U.
    After the contract is signed the worker chooses a reporting strategy σ, supplies y(σ(θt ))
eﬀective labor and receives c(σ(θt )) units of consumption when his history is θt . The agents do
not participate in any markets.
    Each firm accumulates capital kt for t > 1, pays dividends dt to its owners, and trades
bonds with other firms. We denote by qt the price of a bond bt in period t that pays 1 unit of
consumption good in period t + 1. All firms take these prices as given. We consider equilibria
where all firms are identical, and we study a problem of a representative firm.
   4
     Alternatively, we could assume that firms rent capital from workers. Then the contract would also specify
the amount of savings of each agent. Our results are the same in this case.




                                                         7
    The maximization problem of the firm that faces intertemporal prices qt and the reservation
utility U for workers is
                                                      TY
                                                       −1
                               max d1 + q1 d2 + ... +     qi dT
                                       c,k,d,y
                                                                   i=1

s.t.
                    X                                                    X
                          π(θt )c(θt ) + kt+1 + dt + qt bt+1 ≤ F (kt ,        π(θt )y(θt )) + bt ,
                     θt                                                  θt

                                    W (c, y)(σ ∗ ) ≥ W (c, y)(σ) for any σ,                          (3)

                                                 W (c, y)(σ ∗ ) ≥ U .

       In equilibrium, competition among firms forces them to have zero profits.
       We now define a competitive equilibrium.

Definition 1 A competitive equilibrium is a set of allocations {ct , yt , kt }, prices qt , dividends
dt , bond trades bt and utility U such that
     (i) Firms choose {ct , yt , dt , kt , bt }Tt=1 to solve firm’s problem taking {qt }, U as given;
     (ii) Consumers choose the contract that oﬀers them the highest ex-ante utility;
     (iii) Firms make zero profits;
     (iv) The aggregate feasibility constraint (1) holds.

       It is easy to show that in equilibrium the prices are 1/qt = Fk (kt+1 , Yt+1 ) and dt = 0 for all
t.
    This construction closely follows Atkeson and Lucas (1992). One can easily see that in
equilibrium the representative firm’s problem is dual to the social planner’s problem and hence
gives the same allocations. This result allows us to prove that competitive equilibrium is eﬃcient
in the absence of public goods.

Theorem 1 (Equilibrium without retrading is eﬃcient) Suppose that Gt = 0 for all t. In
an economy with no trades among agents (observable consumption), the competitive equilibrium
is eﬃcient.

Proof. Suppose the competitive equilibrium is not eﬃcient. Consider an optimal allocation
{csp    sp   sp T                       ∗
   t , yt , Kt }t=1 with utility level U . Such an allocation is feasible for the firm, satisfies incen-
tive compatibility and delivers workers a utility U ∗ which is strictly higher than the equilibrium
utility U . This allocation also delivers zero profit for the firm, as in the candidate competitive
equilibrium allocations. It is possible for the firm to oﬀer another contract Ũ , U ∗ > Ũ >U with

                                                          8
strictly less resources by reducing consumption of the agent with the lowest skill realization in
the first period by ε. This deviation preserves the incentive compatibility, delivers the utility Ũ,
and firms have strictly positive profits ε. We arrive at a contradiction.
    This theorem shows that ex-ante insurance can be provided privately in competitive settings.
We conclude that there is no need for public intervention. This result is in contrast with
substantial literature5 that analyses how the government can provide insurance optimally in
dynamic environments. Our analysis suggests that the only result of such provision is crowding
out of the private insurance. Suppose, for example, that the government introduces a lump
                                                                     P
sum redistribution between agents T (θt ) where in each period θt π(θt )T (θt ) = 0. Such taxes
leave the after tax allocations unchanged. Firms adjust their contracts optimally so that the
new payments to the workers {ĉt }Tt=1 reflect the taxes: ĉ(θt ) = c(θt ) + T (θt ). The higher level
of insurance provided by the government is exactly oﬀset by less insurance available through
private markets.
    Since utility functions of agents are strictly concave, eﬃcient allocations involve redistrib-
ution of resources from agents with high productivity to agents with low productivity. This
redistribution introduces wedges, or inequalities, between the marginal utilities of consump-
tion and leisure, and between the marginal utility of consumption and the marginal product
of labor. Mirrlees (1971, 1976) used the result that, in the optimum, it is typically true that
uc (c, l) 6= ul (c, l)/w to provide a justification for the government’s use of distorting labor taxes
to achieve eﬃcient allocations in the competitive equilibrium settings.6 Golosov, Kocherlakota
and Tsyvinski (2003) showed that, in dynamic settings, there is also an intertemporal wedge
since the optimal allocations satisfy (assuming separable utility) for all t, θt

                                      uc (c(θt ))
                                                       < Fk (Kt+1 , Yt+1 ).
                                    βEθt uc (c(θt+1 ))

Golosov and Tsyvinski (2003), Albanesi and Sleet (2003), and Kocherlakota (2003b) used this
result to study optimal implementation via taxes. The need for such taxes or wedges arises since
one of the objectives of the planner is to provide insurance to the agents against idiosyncratic
uncertainty. The implicit assumption in these papers is that the government is the only provider
of such insurance available to the agents.
    In our setup, in the absence of governmental policy, firms and agents can write contracts that
   5
     See, for example, Green (1987), Werning (2001), Golosov and Tsyvinski (2003), Albanesi and Sleet (2003),
and Kocherlakota (2003b).
   6
     See also Diamond (2003) for an application of these ideas to the analysis of the design of the social security
system.



                                                        9
provide agents with insurance. The availability of such contracts implies that the arrangement
in which firms pay the worker the marginal product of his labor in each period may not be
chosen by agents. Since the agents are risk averse, they have incentives to enter into contracts
with firms before the realization of uncertainty that provides them with some insurance against
low skill shocks. In our economy, markets for insurance arise endogenously to supplement or
substitute government insurance. We conclude that, even in the presence of private information,
markets can provide optimal insurance if consumption is observable.

3.3    Provision of public goods
In this subsection we consider an economy in which public goods have to be provided. The
competitive equilibrium is no longer eﬃcient if there is a need to finance government expenditures
such as positive consumption of a public good G. However, these public expenditures can be
financed in non-distorting ways. Suppose {Gsp     T
                                               t }t=1 is the optimal amount of public good. One
can easily see that competitive equilibrium with lump sum taxes Tt = Gsp      t is eﬃcient. Indeed,
suppose each agent is required to pay some lump sum tax Tt . The incentive constraint in the
firm’s problem (3) becomes

                            W (c − T, y)(σ ∗ ) ≥ W (c − T, y)(σ) for any σ.

     The firm’s allocation of consumption {cf (θt )}Tt=1 reflects the lump sum taxes that con-
sumers pay. One can see that the allocation {cf (θt ), yf (θt )}Tt=1 , where cf (θt ) = csp (θt ) + T (θt ),
y f (θt ) = y sp (θt ) is feasible and allows to finance the public good Gt . Therefore, the competitive
equilibrium with lump sum taxes Tt is eﬃcient.

Proposition 1 In an economy with no trades among agents (observable consumption) it is
optimal to finance a public good Gt with lump sum taxes Tt = Gt for all t.

    The presence of private information is often cited as an explanation why non-distorting
taxes are not feasible. In this economy they are not only feasible but also optimal. Equilibrium
insurance oﬀered by the firms takes into account the taxes that agents have to pay, and this
insurance is provided optimally.
    This analysis suggests that optimal allocations can be achieved without distorting govern-
ment interventions. It abstracts from many possible sources of ineﬃciencies. For example, by
allowing agents to sign insurance contracts before any realization of uncertainty we abstract from
issues arising because of adverse selection. We also assume that the contracts are binding and


                                                    10
neither the employer nor the agent can renege on them. However, the analysis above suggests
that the existence of private information about individual’s skills does not justify distorting
taxes by the government.


4     Unobservable trades
In the previous section we showed that competitive equilibria are eﬃcient if all trades are observ-
able. In such an environment, each firm has the power to be the sole insurer for any agent and
can preclude agents from trading with other firms and agents. This power to exclude requires
that the firm possesses full information about agents’ consumption and assets. In this section,
we relax the assumption of full observability of trades. We still maintain the assumption that
an agent’s eﬀective labor y is publicly observable. The agent can, however, trade assets and
consume unobservably. We show that the competitive equilibrium is not eﬃcient. Finally, we
show how distortionary taxes can improve on competitive market allocation.

4.1   Retrading market
Consider an environment in which all agents have access to a market in which they can trade
assets unobservably. We call this market a retrading market. In this market agents trade risk
free bonds. A purchase of the bond entitles the holder to one unit of consumption in the period
that follows. In the appendix, we show that in a large class of environments risk free bonds are
the only security traded in equilibrium.
    All trades at period t occur at prices Qt . The prices are such that the market for bonds clears
each period. We assume that all trades are enforceable so that agents cannot default on their
liabilities. This assumption precludes agents from borrowing more than they can ever repay in
the future.
    A social planner oﬀers a contract {c(θt ), y(θt )}Tt=1 to all agents, where yt is the amount of
eﬀective labor that an agent provides, and ct is the endowment of consumption goods that agent
receives. Unlike the environment described in the previous section, the amount of consumption
goods allocated by the planner is not necessarily equal to the actual consumption of an agent,
since the planner has no possibility to preclude an agent from borrowing and lending on the
retrading market.
    An agent takes the contract oﬀered by the planner and the equilibrium prices {Qt }Tt=1 as
given and chooses his optimal reporting strategy σ together with holdings (possibly negative)
of a risk free security st : Θt → R+ . Total resources available to the agent are the endowment of


                                                11
consumption good c(σ(θt )) he receives from the planner and his asset holding from the previous
period. The actual consumption after retrading is xt : Θt → R+ .
   The agent maximizes his ex-ante utility:
   Agent’s Problem

                                     T
                                     X          X
                             max           βt        π(θt )u(x(σ(θt )), y(σ(θt ))/θt )
                             σ,x,s
                                     t=1        θt

s.t. for all θt , t
                           x(σ(θt )) + Qt s(σ(θt )) = c(σ(θt )) + s(σ(θt−1 )),

                                                       s(θ0 ) = 0,

where s(θ0 ) are the initial asset holdings of the agent before realizations of the shocks.
   We denote the value of this problem at the optimum by V ({c, y}, {Q}). Sometimes we will
need to compute a value for an arbitrary reporting strategy σ, and we denote ex ante utility
from following this strategy by V ({c, y}, {Q})(σ).
   Equilibrium in the retrading market requires that in each period the total endowment of
consumption goods should be equal to the total after trade consumption:
                                X                               X
                                      π(θt )x(σ(θt )) =              π(θt )c(σ(θt )).                   (4)
                                 θt                             θt

    We can define equilibrium in the retrading market.

Definition 2 An equilibrium in the retrading market given the contract
{c(θt ), y(θt )}Tt=1 consists of prices Qt , strategies σ, and allocations {x(θt ), s(θt )}Tt=1 such that
   (i) Consumers solve Agent’s Problem taking {c(θt ), y(θt ), Qt }Tt=1 as given;
   (ii) Feasibility constraint on the retrading market (4) is satisfied.

    We assume that for any contract {ct , yt }Tt=1 that the social planner oﬀers there exists a
unique equilibrium in the retrading market. The ex-ante utility of an agent in the equilibrium
is denoted V̂ ({c, y}).

4.2     Eﬃciency with unobservable trades
The social planner chooses the allocations {ct , yt , Kt , Gt }Tt=1 that maximize the ex ante utility of
agents. Using the revelation principle it is easy to show that the social planner oﬀers a contract


                                                           12
{ct , yt }Tt=1 so that all agents choose to report their type truthfully to the planner and do not
trade on the retrading market.7

Definition 3 An eﬃcient allocation {csp     sp   sp     sp T
                                     t , yt , Gt , Kt }t=1 is the solution to the Social Plan-
ner’s problem:
                          XT X
                    max           π(θt )β t {u(c(θt ), y(θt )/θt ) + ug (Gt )}
                           c,y,G,K
                                     t=1 θt

s.t. for all t, θt
                          X                                             X
                                π(θt )c(θt ) + Kt+1 + Gt ≤ F (Kt ,            π(θt )y(θt )),
                           θt                                            θt

                                T X
                                X
                                         π(θt )β t u(c(θt ), y(θt )/θt ) ≥ V̂ ({c, y}).                      (5)
                                t=1 θt

    The market for hidden trades imposes a stricter constraint (5) than the incentive constraint
with observable asset trades (2). We show this by first showing that any allocation that satisfies
(5) also satisfies (2). Consider an allocation {c(θt ), y(θt )}Tt=1 that satisfies (5). Suppose there
exists some reporting strategy σ for which the incentive constraint (2) is violated. Consider
the same strategy σ on the market with hidden trades. The allocation {c(σ(θt )), y(σ(θt ))}Tt=1
is feasible for the agent, and he can further improve upon it by trading bonds. Therefore, the
strategy σ also violates the constraint imposed by the market for hidden trades (5). We arrive
at a contradiction.
    The reverse relationship does not hold in general - it is typically not true that an allocation
that satisfies (2) also satisfies (5). First, it is known that agents’ marginal rates of substitution
(MRS) defined by
                                            uc (c(θt ), y(θt )/θt )
                                P
                             β θt+1 π(θt+1 |θt )uc (c(θt+1 ), y(θt+1 )/θt+1 )
diﬀer for diﬀerent histories θt under eﬃcient allocations with observable trades8 . To the contrary,
in the environment with hidden trades, agents’ MRS are necessarily equated. For any reporting
strategy σ, the allocations {x(σ(θt )), s(σ(θt ))}Tt=1 that an agent chooses on the retrading market
   7
     The retrading market is a constraint on the social planner’s problem. The idea is similar to that in Hammond
(1987) who studied a static environment with multiple goods and side markets where agents can trade unobserv-
ably. He showed that for any incentive compatible allocation, side markets must be in a Walrasian equilibrium.
Guesnerie (1998) used that set up to study optimal taxation.
   8
     See, for example, Golosov, Kocherlakota, and Tsyvinski (2003).




                                                         13
must satisfy the following conditions for all θt

                                  x(σ(θt )) + Qt s(σ(θt )) = c(σ(θt )) + s(σ(θt−1 )),                         (6)
                                                            X
                               Qt u0 (x(σ(θt ))) = β                  π(θt+1 |θt )u0 (x(σ(θt+1 )),            (7)
                                                                t+1
                                                            θ

                                                           s(θT ) = 0.                                        (8)

Condition (7) implies that agents equalize their MRS in each period for all histories θt .
    Another diﬀerence between the two environments is a possibility for agents to use a double
deviation - agents choose not only a deviating reporting strategy but also hidden asset trades
that maximize the utility of the deviation. The possibility of such deviations implies that even
if agents’ MRS were equalized for an allocation that satisfies (2), such an allocation would not
necessarily satisfy (5).
    To illustrate this point we rewrite social planner’s problem.

Lemma 1 An eﬃcient allocation {csp        sp   sp    sp T
                                     t , yt , Gt , Kt }t=1 together with the corresponding equi-
librium prices on the retrading market {Qt }Tt=1 is a solution to the problem

                                        T X
                                        X
                              max                π(θt )β t {u(c(θt ), y(θt )/θt ) + ug (Gt )}
                            c,y,G,K,Q
                                        t=1 θt


s.t. for all t, θt
                            X                                                     X
                                   π(θt )c(θt ) + Kt+1 + Gt ≤ F (Kt ,                   π(θt )y(θt )),
                             θt                                                    θt

                T X
                X
                           π(θt )β t u(c(θt ), y(θt )/θt ) ≥ V ({c, y}, {Q})(σ) for any σ 6= σ ∗ ,            (9)
                t=1 θt
                                                      X
                     Qt uc (c(θt ), y(θt )/θt ) = β             π(θt+1 |θt )uc (c(θt+1 ), y(θt+1 )/θt+1 ).   (10)
                                                          t+1
                                                      θ

Proof. In appendix.
    In this problem the social planner chooses the prices Q on the retrading market directly.
Although the planner does not control transactions on that market, he has enough power to
determine these prices. By the revelation principle, a social planner chooses allocations such that
each agent reveals his type truthfully and never re-trades from the allocations he receives. The
truth telling agent does not retrade if his marginal rate of substitution for consumption between

                                                                  14
periods t and t + 1 is exactly equal to the interest rate. In other words, these intertemporal rates
of substitution determine the prices of risk free bonds. The incentive constraint should ensure
that a deviating agent cannot achieve a higher utility by retrading at those prices.
     The possibility of trading assets and using double deviations implies that constraint (9) is
stricter than the incentive constraint (2). For any strategy σ the allocation {c(σ(θt )), y(σ(θt ))}Tt=1
is feasible, but the agent can further improve upon it using hidden trades.
     Although the economy with unobservable retrading typically has lower welfare than the
economy with observable trades, we can identify one situation in which the allocations and
welfare in both economies are the same. It is the economy analyzed extensively in Werning
(2001) where all the uncertainty about skill shocks is realized after the first period.

Proposition 2 Suppose that all uncertainty is realized after the first period, so that in each
period t for each history θt there exists some history θt+1 such that π(θt+1 |θt ) = 1. Suppose that
the utility function is separable between consumption and leisure. Then the eﬃcient allocations
in the economy with and without observable trades are the same.

Proof. In appendix.
     When all uncertainty is realized in the first period, there is no longer any gain from hidden
trades. Any asset trading occurs after agents have revealed their type to the planner. The possi-
bility of hidden trade does not improve the value of any deviation, and the incentive constraints
in the two economies become identical. In the rest of the paper we assume that there is need to
provide incentives in each period, so that hidden trades play a non-trivial role.
     Our economy diﬀers from standard problems with unobservable savings such as Diamond
and Mirrlees (1995), Werning (2002), Doepke and Townsend (2003), and Abraham and Pavoni
(2003) where the rate of return on hidden trades is assumed to be exogenous. Moreover, there are
no private markets in these papers, and the interest rate is fixed. In our environment, the social
planner can choose the rate of return on private hidden trade markets by choosing allocations
{ct , yt }Tt=1 . This additional instrument is important for the planner because it allows to aﬀect the
return from deviations. We show below that since competitive environments typically lack this
instrument, competitive equilibria are not eﬃcient. This result is diﬀerent from the environments
with the exogenous rate of return in which competitive equilibria are eﬃcient.

4.3    Competitive equilibrium
In this subsection, we consider a decentralized version of this private information economy with
unobservable trades. As in the section on the economy with observable trades, we assume that,

                                                  15
before any uncertainty is realized, an agent signs a long term contract with a firm which is
binding for both parties. The environment is identical to the one described in Section 3, but
now firms need to take into account that agents are able to retrade their allocations on the
hidden trades market.
     The retrading market is identical to the one in the social planner’s problem. Every agent who
has a contract {ct , yt }Tt=1 with a firm chooses his reporting strategy and asset trades optimally,
taking prices Qt for the risk free bond on the retrading market as given. For the retrading
market to be identical to that in the social planner’s problem, we do not allow agents to trade
with other firms directly.
     The contracts oﬀered by firms take into account the possibility that agents may retrade.
Firms may choose to provide such allocations that agents retrade from them along the truth
telling path. The incentive constraint for the firm has the form V ({c, y}, {Q})(σ ∗ ) ≥ V ({c, y}, {Q})(σ)
for any σ ∈ Σ.
     The problem of the representative firm is similar to the problem described in Section 3.1.
Each firm is a price taker, it chooses a contract oﬀered to workers {ct , yt }Tt=1 , investments kt ,
dividends dt , and bond trades bt to maximize profits.
     Firm’s Problem 1
                                                            TY
                                                             −1
                                     max d1 + q1 d2 + ... +     qi dT
                                    c,k,d,y
                                                              i=1

s.t. for all t
                 X                                                    X
                       π(θt )c(θt ) + kt+1 + dt + qt bt+1 ≤ F (kt ,        π(θt )y(θt )) + bt ,
                  θt                                                  θt

                         V ({c, y}, {Q})(σ ∗ ) ≥ V ({c, y}, {Q})(σ) for any σ,                    (11)

                                        V ({c, y}, {Q})(σ ∗ ) ≥ U .

   The first constraint in the firm’s problem is feasibility. The second is the incentive com-
patibility. The last constraint states that the firm cannot oﬀer a contract which delivers a
lower expected utility than the equilibrium utility U from contracts oﬀered by other firms. In
equilibrium, all firms act identically and make zero profits.
   The firm’s problem in this economy is very similar to the firm’s problem in the economy
with observable trades. The only diﬀerence comes from the fact that the incentive constraint
(11) now has to take into account side trades that are not observable. The definition of the
competitive equilibrium is parallel to that in the economy with observable trades.

Definition 4 A competitive equilibrium is a set of allocations {ct , yt , kt }, prices qt , dividends

                                                     16
dt , bond trades bt , utility U and prices Qt such that
     (i) Firms choose {ct , yt , dt , kt }Tt=1 to solve Firm’s problem taking qt , U as given;
     (ii) Consumers choose the contract that oﬀers them the highest ex-ante utility;
     (iii) For any {ct , yt , Qt }Tt=1 agents choose their reporting strategy and asset trades optimally
as described in Agent’s Problem;
     (iv) The aggregate feasibility constraint (1) holds;
     (v) The retrading market for the contract {ct , yt }Tt=1 is in equilibrium, and Qt are the equi-
librium prices.

    It is easy to see that the interest rates in the economy must be equal to the marginal product
of capital, so that 1/qt−1 = Fk (Kt , Yt ) for all t. The prices that firms and agents face are also
equalized, qt = Qt for all t. Suppose it were not true, so that for example 1/Q1 < Fk (K2 , Y2 ).
It is optimal for all firms to postpone any payments of the first period wages until the second
period. Workers are able to borrow at the interest rates Q1 and repay from the wages they make
in the second. But since all the firms are identical, they all choose to pay no wages in the first
period, and then Q1 can not be the equilibrium interest rate. In other words, if qt 6= Qt firms
can use agent’s ability to borrow and lend at rate Qt to create arbitrage opportunities. We can
summarize this result in the following proposition.

Proposition 3 In the competitive equilibrium 1/Qt = Fk (Kt+1 , Yt+1 ) for all t.

    This result suggests that competitive equilibria typically are not eﬃcient when asset trades
are unobservable. From the maximization problem described in lemma 1, the social planner has
the power to choose the interest rates on the retrading market 1/Q and usually these interest
rates are diﬀerent from Fk (K, Y ). It is diﬃcult to characterize eﬃcient allocations in this general
set up, and we consider two special cases in the sections that follow.
    Although the competitive equilibrium may not be eﬃcient it is generally not true that no
insurance is provided by firms. In the numerical section that follows, we show that this privately
provided insurance can be very significant. This finding stands in contrast with the environments
where agent’s endowment is not observable such as environments studied in Allen (1985). There,
no insurance is possible when agents can borrow and lend at the rate equal to Fk . In our model of
unobservable skills θ and observable income y, insurance can be provided despite the possibilities
of hidden trades.




                                                  17
4.4   Eﬃcient allocations with iid shocks and separable utility
To simplify the analysis we assume that the utility function is separable between consumption
and leisure: u(c, l) = u(c) + v(l). In addition we assume that the skill shocks follow an iid
process: π(θt ) = π(θt ) = π(θ) for θ = θt for all θt . We consider only pure strategies and assume
that T is finite.
    We showed that any equilibrium allocation in the retrading market satisfies conditions (6),
(7) and (8). When θ is iid, the Euler equation (10) becomes
                                                    X
                            Qt u0 (c(σ(θt ))) = β        π(θ)u0 (c(σ(θt ), θ)),               (12)
                                                    θ


where c(σ(θt ), θ) denotes the allocation to the agent who sent report σ(θt ) in period t and
revealed his realization of the shock in period t + 1 truthfully.
   We also assume that consumption allocations are monotonic so that agents who report
higher types receive weakly higher consumption. This assumption holds in all the numerical
experiments we conducted.
   Assumption (monotonicity). For any θt , and any θ0 , θ00 such that θ00 > θ0 it is optimal for
the planner to choose consumption allocations such that c(θt , θ00 ) ≥ c(θt , θ0 ).
   We first show that an agent who deviates from the allocation prescribed by the planner
chooses positive savings.

Proposition 4 The only binding incentive constraints in the Social planner problem are those
where s(σ(θt )) ≥ 0 for some θt . Moreover, there are some θt in every t for which this inequality
is strict.

Proof. In appendix.
    We now can prove that in the eﬃcient allocations the interest rates on the retrading market
are lower than Fk , which formally stated in the following proposition.

Proposition 5 In the eﬃcient allocations, Fk (Kt , Yt ) > 1/Qt−1 for at least one t.

Proof. In appendix.
    Although the proof is lengthy, its intuition is quite straightforward. We showed that a
deviating agent chooses positive savings. Then we show that changing the interest rate on
the retrading market negatively aﬀects the return to deviations by a larger amount than the
truth-telling agents are aﬀected. This leads to a higher amount of insurance being provided.


                                                    18
Theorem 2 If hidden trades (consumption) are not observable, the competitive equilibrium is
not eﬃcient.

Proof. Follows from propositions 3 and 5
    Intuitively, the competitive equilibrium is not eﬃcient because a contract oﬀered by one
company to its workers aﬀects the return on trades and thus incentives to reveal information
truthfully for agents insured by other companies. Individual firms can not internalize this eﬀect.
Competition between diﬀerent insurers implies that interest rates at which agents trade are
equated with the marginal rates of transformation. The planner, however, is able to choose the
interest rates optimally. Thus, privately provided insurance does not lead to eﬃcient allocations
in this setting. The technical reason for the failure of the First Welfare Theorem is that prices
enter the production set of the firms as can be seen in the firm’s problem 19 . In the next section,
we will explore how distortionary taxes can introduce the wedge between the equilibrium interest
rates on the retrading market and the marginal product of capital.
    We can also easily show that in the environments with hidden savings such as Werning (2001)
and Abraham and Pavoni (2003) competitive equilibrium is eﬃcient. There, the planner does
not have the ability to aﬀect the rate of return on hidden technology as agents do not interact
via markets but hiddenly save using a backyard technology.

4.4.1    Tax policy with iid shocks

We showed in the previous section that eﬃciency requires that the interest rates on the retrading
market are lower than the marginal product of capital. In the competitive equilibrium without
government interventions, interest rates are equated to the marginal product of capital, and the
equilibrium allocations are not eﬃcient. We now identify what forms of government interventions
in a form of distortionary taxes on capital can reintroduce this wedge in competitive equilibrium.
In this section we show that such policy improves welfare.
    We proceed as follows. First, we re-write the firm’s problem in its dual form. The dual
form is convenient to use since it maximizes total utility of agents similar to the social planner’s
problem. Second, we show that positive linear taxes on capital income improve the welfare when
agent’s optimal deviations involve oversaving.
    Consider a dual version of the Firm’s problem. Since all the firms are making zero profit in
equilibrium, their problem can be rewritten in the following form.
   9
    See also Greenwald and Stiglitz (1986) for a discussion how economies with private information are similar to
the economies with externalities. Arnott and Stigliz (1990) discuss how unobservable insurance purchases create
externality-like eﬀect in static moral hazard models.


                                                       19
       Firm’s Problem 2

                                               T X
                                               X
                                       max              π(θt )β t u(c(θt ), y(θt )/θt )
                                       c,y,k
                                               t=1 θt

s.t. for all t
                      T X
                      X
                               π(θt )β t u(c(θt ), y(θt )/θt ) ≥ V ({c, y}, {Q})(σ) for any σ,
                      t=1 θt
                                 X                                      X
                                       π(θt )c(θt ) + kt+1 ≤ F (kt ,          π(θt )y(θt )).
                                  θt                                     θt

Claim 1 In a competitive equilibrium, the solution to Firm’s Problem 1 coincides with the
solution to Firm’s Problem 2.

Proof. In appendix.
    This result allows to directly compare the Firm’s problem and the Social planner’s problem.
These two problems are very similar. The planner, however, has an additional choice variable
— prices on the retrading market Q. The social planner choosing eﬃcient allocations takes
into account how these allocations aﬀect the interest rates in the economy. The competition
among firms makes the interest rates on the retrading market equal to the marginal rate of
transformation.
    Unlike the economy with observable asset trades, distorting taxes are welfare improving
in this environment. Consider a simple linear tax τ imposed on capital income Rk, where
R ≡ Fk (K, Y ). The revenues from this tax are distributed equally among all agents. As argued
in proposition 1, such a lump sum distribution has the same eﬀect as returning lump sum
rebates directly to firms. In the following proposition we show that such a tax system is welfare
improving10 .

Proposition 6 There exists a positive tax τ on capital income and a lump sum rebate T that
improves the welfare in the competitive equilibrium.

Proof. >From proposition 4, the only binding incentive constraints in the firm’s problem must
be those constraints that involve only savings. Let t be a time period for which there exists a
                                                                                               t
binding strategy σ and a history θt such that s(σ(θt )) > 0. We know that for all other σ̂, θ̂
                                 t
savings are non-negative: s(σ̂(θ̂ )) ≥ 0.
  10
       Also see da Costa (2004) for a similar result in a two period model with two types of agents.



                                                              20
    Consider a linear tax τ on the return on capital Rk in period t + 1. The tax revenues are
rebated in the lump sum amount T to the firms. Let k(τ , T ) denote firm’s investment in period
t as a function of (τ , T ). The feasibility constraint for the government is τ Rk(τ , T ) = T. Using
the implicit function theorem we obtain

                                              Rk(τ , T ) − τ Rkτ (τ , T )
                                 T 0 (τ ) =                               .
                                                 1 − τ RkT (τ , T )

Let W (τ , T ) be the value of the objective function in the Firm’s problem 2 when the firm faces
taxes T and τ . It coincides with the ex-ante utility of agents and represents welfare in the
economy. Consider the derivative dW of this function at zero capital taxes

                   dW (τ , T (τ ))|0 = Wτ (0, 0) + WT (0, 0)T 0 (0) = Wτ + WT Rk.

All the variables on the right hand side are evaluated at zero taxes.
    Let γ ic (σ) be the Lagrangian multiplier on the incentive constraint for a strategy σ, and γ t
be the multiplier on the feasibility constraint in period t in Firm’s Problem 2. From the envelope
theorem
                                             WT = γ t+1 ,
                                                     X                        ∂Qt
                             Wτ = −γ t+1 Rk −                γ ic (σ)VQ (σ)       .
                                                         σ
                                                                              ∂τ

In equilibrium, 1/Qt = τ Rt+1 , therefore, ∂Qt /∂τ = −Rt+1 /τ 2 < 0. By proposition 4, any
deviation involves savings. Therefore, higher interest rates increase return on savings, and
VQ (σ) ≤ 0 with at least one σ for which this inequality is strict. Combining these eﬀects we see
that capital taxes are welfare improving:
                                                   X                      ∂Qt
                           dW (τ , T (τ ))|0 = −         γ ic (σ)VQ (σ)       > 0.
                                                     σ
                                                                          ∂τ


    Similarly to the economy with observable trades, lump sum taxes have no eﬀect on insurance
that agents receive. Taxes on capital income have two eﬀects. On one hand, they distort
investment decisions of firms and create a deadweight loss. On the other hand, they also lower
the return on savings in the retrading market. This improves the incentives of agents to reveal
their private information truthfully, and firms are able to provide better insurance — private
markets change endogenously in response to government policy. At least for small capital taxes


                                                     21
the second eﬀect dominates the first one, and welfare improves. The losses from distorting taxes
are second-order while improvement in the insurance via worsening deviations is first-order.
    The capital taxes alone are not suﬃcient to achieve the eﬃcient outcome in the competitive
settings. To see this, suppose taxes were set in such a way that the after-tax return on capital
were equal to the interest rates on the retrading market under the eﬃcient allocations, 1/Qsp .
Then the firm would have the same incentive constraint (11) as the social planner. The feasibility
constraint would be diﬀerent, however. While the planner’s decisions are undistorted, firms’
savings are aﬀected by distorting taxes. In general the government has to impose additional
non-linear taxes on labor income to achieve the eﬃcient allocations. Alternatively, this version
of the model can be interpreted as a model of dynamic optimal taxation in which capital taxes
are arbitrage-proof while income taxes are nonlinear.

4.5    Extension to the infinite period economy
In this section we outline the extension of our results to the infinite period economy that is
similar to Aiyagari (1994, 1995).
    The problem of the agent who is oﬀered a menu {ct , yt }∞t=1 is similar to the one in the finite
case. However, we need to impose an additional upper bound B on the asset holdings to prevent
Ponzi schemes. This bound is arbitrarily large but finite. In the economy with any finite number
of agents such a bound can be enforced since agents observe their individual asset trades with
any other agent. The suﬃcient condition in such an economy to rule out a Ponzi scheme is that
each agent bounds the amount of asset trades he does with any other agent. This condition is
more diﬃcult to ensure when there is a continuum of agents, since each agent is of measure zero.
However, we assume that there exists mechanisms that rule out Ponzi type asset holdings.
    Agent’s problem in the infinite period economy
                                   ∞
                                   X          X
                           max           βt       π(θt )u(x(σ(θt )), y(σ(θt ))/θt )
                           σ,x,s
                                   t=1        θ
              t
s.t. for all θ , t
                         x(σ(θt )) + Qt s(σ(θt )) = c(σ(θt )) + s(σ(θt−1 )),

                                                  s(σ(θt )) ≥ −B,

                                                    s(θ0 ) = 0.

    As before, the prices Qt are such that asset markets clear in each period. The definition of



                                                        22
the eﬃcient allocations and equilibrium in the retrading market remains unchanged.
    It is generally not known when eﬃcient allocations converge to a stationary distribution in
a limit. Green (1987), Thomas and Worrall (1990), Atkeson and Lucas (1992) showed that
in the economies with no asset trades there is typically no stationary distribution - expected
utility for each agent converges to zero with probability one. The economy converges to a steady
state if an additional lower bound on promised utility is imposed on the planner’s problem as in
Atkeson and Lucas (1995). There are no similar results for the economies with asset trades in
this context. However, we can show that if a stationary distribution exists in which the aggregate
interest rates Qt , aggregate capital Kt and eﬀective labor Yt converge to constant values, the
interest rates are lower than the marginal rate of transformation Fk (K, Y ).11 The proofs of the
next two lemmas follow closely Aiyagari (1995) and Ljungqvist and Sargent (2000).

Lemma 2 In a stationary equilibrium Fk (K, Y ) = β −1 .

Proof. The FOCs for Gt and Kt imply that ug0 (Gt ) = βFk (Kt+1 , Yt+1 )ug0 (Gt+1 ). Since in a
stationary equilibrium Gt , Kt , Yt are all constant, we immediately get that Fk (K, Y ) = β −1

Lemma 3 In a stationary equilibrium Q > β if var(c(θ)) > 0.

Proof. Any allocation in stationary equilibrium should satisfy Qu0 (ct ) ≥ βEt u0 (ct+1 ). If we de-
fine Mt = (1/Q)t β t u0 (ct ) this equation can be re-written as Et (Mt+1 −Mt ) ≤ 0. Supermartingale
convergence theorem implies that Mt → M a.s. Chamberlain and Wilson (1984) showed that
for β/Q ≥ 1 that would imply that u0 (ct ) → 0 or ct → ∞. This is possible only if kt → ∞, but
this implies that Fk = 0 in the stationary equilibrium. But it can not be true by the previous
lemma. Therefore the only possibility is Q > β.
    In the infinite horizon economy the competitive equilibrium is not eﬃcient since it necessarily
has 1/Q = Fk (K, Y ).
    The consumption-saving decisions of agents in our environment are similar to those in Bewley
(1986) and Aiyagari (1995). In Bewley’s model, labor income of agents follows an exogenous
stochastic process. In our economy the endowments of the agents are determined by the planner.
This has important consequences for determining the optimal tax policy. Taking informational
constraints into account allows us to find the optimal policy without imposing restrictions on
the tax instruments as done in Aiyagari (1995). Although the result that savings should be
distorted in the steady state is the same in both models, these models produce very diﬀerent
 11
    Similar assumption are made in the steady state analysis in Ramsey problems. See Chamley (1986) and
Aiyagari (1995).


                                                  23
qualitative and quantitative tax policy recommendations along the transition path. We return
to this point in the next section where we discuss optimal taxation in numerical examples.


5    Numerical example
In this section, we compute optimal allocations and tax policy in economies with observable
and unobservable asset trades. As a benchmark, we will use a disability insurance environment
analyzed in Golosov and Tsyvinski (2003). We consider three types of experiments. First,
we compute the eﬃcient allocations in an economy where private trades are observable. In
particular, we study the pattern and the size of intertemporal wedges. Second, we compute the
optimal allocations for the economy in which agents are allowed to trade unobservably. We find
that the intertemporal wedge in this economy is smaller than in the economy with observable
trades. We then compare the welfare losses from the unobservability of trades. Third, we
compute the competitive equilibrium in the economy with unobservable trades. We compare
welfare in the competitive equilibrium to welfare of the optimal allocation with unobservable
trades and with a version of Bewley’s economy where the only form of insurance available to
agents is trading of a risk free bond. We find that, even in the environment with unobservable
trades, private markets can achieve allocations that are nearly optimal. This result indicates
that the large welfare gains from introducing government insurance found in the literature on
optimal dynamic contracting may be misleading as they treat private markets exogenously. To
a large extent, public provision of insurance crowds out private insurance12 .
    We consider an economy that lasts ten periods. In each period agent’s skill is drawn from
a two point distribution Θ = {0, 1}. The state θ = 0 is absorbing. Any agent who receives
a zero productivity shock in any period, has zero productivity in all the subsequent periods.
The production function is F (K, Y ) = rK + wY. We assume that there is no utility from the
consumption of the public good G.
    In the numerical exercises described below each period is assumed to be five years. We
choose the following parameter values: β = 0.8, r = β −1 , w = 1.21. Each agent is endowed with
k1 = 0.69 units of initial capital. The parametrization is described in Golosov and Tsyvinski
(2003). We adjust those parameters to represent a five year time period. The stochastic process
for skills is shown in figure 1. It matches disability shocks among the US population for 20-65
year old. The utility function is u(c, l) = ln(c) + 1.5 ln(1 − l).
 12
    Crowding out of private markets by government policies also occurs in Attanasio and Rios-Rull (2000) and
Krueger and Perri (2001) who study economies with limited commitment.



                                                    24
5.1     Observable trades
In this subsection, we compute optimal allocations and intertemporal wedges for an economy
where trades are observable.
    It is well known that in the economy with private information without hidden retrading,
savings decisions of each agent are distorted. In particular, optimal allocations satisfy for all θt
the following inequality:
                                                 X
                              u0 (c(θt )) ≤ βr          π(θt+1 |θt )u0 (c(θt+1 )).
                                                 θt+1


     This inequality is strict if var(c(θt+1 )) > 0. We define the wedge τ (θt ) that each agent faces
as                                         ∙                                    ¸
                                        1            u0 (c(θt ))
                      τ (θt ) = 1 −          P                               − 1  .              (13)
                                      r − 1 β θt+1 π(θt+1 |θt )u0 (c(θt+1 ))
   The wedge is defined to be consistent with a wedge from a linear tax imposed on the net
capital income (r − 1)k. The standard Euler equation with linear taxes on capital income is

                              u0 (ct ) = β [(1 − τ )(r − 1) + 1] Et u0 (ct+1 ),

and we use this expression to define the savings wedge τ .
   This wedge is history specific: agents who had a diﬀerent history of shocks θt face diﬀerent
wedges. The wedge is equal to zero for the agent whose current skill is zero (since it is an
absorbing state) and is strictly positive for the other agents. In the computed example the
wedge of the agent who has positive productivity increases over the lifetime and reaches 8%.
(See figure 2.)

5.2     Unobservable trades
In this subsection, we compute optimal allocation for the economy where trades are unobservable.
We compare the welfare for this economy to that of the economy without private information
and to the economy with private information but observable trades. When agents can trade
assets unobservably, eﬃciency requires that equilibrium interest rates on the retrading markets
are lower than r. Although the stochastic process for skills is not iid, it is straightforward to
modify the proof of proposition 4 to show that for any binding deviating strategy σ, savings are
always non negative: s(σ(θt )) ≥ 0 with a strict inequality for some θt . It implies that proposition
5 holds in this economy.


                                                        25
    We define the wedge in the same way as we defined it in (13) for the economy with observable
trades. Figure 3 shows the computed wedge in this example. Note that it is strictly positive in
each period but smaller than the wedge in the economy with observable trades. It never exceeds
two percent.
    The ex ante utility of agents is lower in the economy with unobservable trades than in the
economy with observable trades. When trades are not observable the set of incentive compatible
allocations is smaller, and the provision of insurance to agents is more diﬃcult.
    We use the following measure to compare welfare in the two economies. Let {cno              no T
                                                                                           t , yt }t=1 be
the allocations that solve the social planner’s problem with non-observable consumption. The
                                      P        P
ax-ante utility of such allocations is Tt=1 β t θt π(θt )u(cno (θt ), y no (θt )/θ). If ex-ante utility in
the economy with observable trades is U o , we find such a number κ, that increasing consumption
of each agent by κ% would make the ex-ante utility of the agent equal to U o , i.e.

                          T
                          X          X
                                βt        π(θt )u((1 + κ)cno (θt ), yno (θt )/θ) = U o .
                          t=1        θt

    We find the welfare losses from unobservable retrading, i.e., the diﬀerence between the utility
of optimal allocations in which trades are observable and the utility of optimal allocation in which
trades are not observable to be 0.2 percent. The welfare loss of the optimal allocation in which
trades are unobservable compared to the first best outcomes - the economy with no private
information - is 1.1 percent.

5.3    Crowding out
In this subsection we address the question as to what extend private markets are able to provide
insurance in such an environment. We find that most optimal provision can be done privately
with very small gains from public interventions. This contrasts with a large body of litera-
ture that studies social insurance when private markets are absent or exogenously restricted.
For example, Hansen and Imrohoroglu (1992), Wang and Williamson (1996), Hopenhayan and
Nicolini (1997), and Alvarez and Veraciero (1998) and many others found large welfare eﬀects of
public policy when markets are exogenously incomplete. In this section, we show that this pri-
vate provision of insurance, though not eﬃcient, is a significant improvement over the autarkic
allocations with self-insurance.
    Consider an economy where there is no private provision of insurance. In the absence of
taxes each agent is able to borrow and lend at the interest rate r, and, if he has a positive



                                                         26
productivity, supplies labor at the wage rate w. This setup is equivalent to that in Aiyagari
(1994). The agent’s problem is

                                   T X
                                   X
                          max               π(θt )β t {u(c(θt )) + v(y(θt )/θt )}
                           c,y,k
                                   t=1 θt


s.t. for all θt
                                   c(θt ) + s(θt ) = wy(θt ) + rs(θt−1 ),

                                                s(θ0 ) = k1 .

where we use a convention that if θ = 0 then v(y(θt )/θt ) = v(0).
    Thus, similarly to Bewley (1986), Huggett (1993) and Ayiagari (1994), the only insurance
available is a self-insurance with a risk-free bond.
    We find that competitive equilibrium allocations provide welfare which is 1.08 percent higher
than welfare in the economy where a risk-free bond is the only form of insurance available to
agents. Welfare under eﬃcient allocations is 1.11 percent higher than in the economy with
only risk free bonds. These findings show that competitive equilibrium without government
interventions provides about 97 percent of the optimal insurance in our numerical example.
    This example suggests that it is important to consider responses of private markets to changes
in the government policy. Consider the environment we described where the optimal insurance
is provided by the government. Since there are no gains from additional insurance, all private
insurance markets are absent. To an outside observer such an economy appears to be identical to
Aiyagari’s economy where the only private asset available is a risk free bond. Taking exogenous
such a structure of private markets would suggest that the removal of public insurance decreases
welfare by 1.11 percent. This argument, however, does not take into account that private markets
may emerge, and the actual welfare losses would be much smaller.
    The analysis above assumes that private markets function perfectly. In such circumstances
most of the optimal insurance can be provided with no government interventions. One may
argue that legal restrictions or market imperfections decrease the amount of insurance available
privately, and public insurance is needed in such circumstances. The size of crowding out depends
on the particular form of the assumed imperfections, and additional work would be needed to
compute it. In general, unless such imperfections are assumed to be very severe, the welfare
eﬀects of the optimal public policy may be small.




                                                     27
6    Conclusion
This paper studies dynamic optimal taxation in an economy with informational frictions and
endogenous insurance markets. Existence of private information is commonly used to justify
government interventions via taxes to achieve optimal redistribution or insurance. We derive
two sets of results. First, we show that, if private trades are observable, as commonly assumed in
the existing literature, there is no role for government intervention. Competitive markets provide
the optimal amount of insurance. The only eﬀect of government policy is crowding out of private
insurance without improvement in welfare. Second, we relax the assumption of observable trades
and study environments where trades are unobservable. We show that competitive equilibria
are not optimal. A government, even the one that has the same information as private parties,
can improve upon any allocations that can be achieved by markets. A linear tax levied on
firm’s capital income aﬀects the rate of return in hidden asset markets and improves insurance
provided to agents by insurance firms.
    The main economic message of our paper is twofold. First, understanding the interaction of
private insurance markets and public tax policy may have very important implications for the
design of optimal taxation and social insurance. Second, we find a specific tax instrument that
can aﬀect the insurance provided through private markets and lead to the welfare improvement
over any allocation achieved by private markets alone.




                                               28
References
 [1] Abraham, A. and Pavoni, N., 2003, Eﬃcient Allocations with Moral Hazard and Hidden
     Borrowing and Lending. Mimeo. UCL

 [2] Aiyagari, S. R., 1994, Uninsured Idiosyncratic Risk and Aggregate Saving, Quarterly Jour-
     nal of Economics 109, 659-684

 [3] Aiyagari, S. R., 1995, Optimal Capital Income Taxation with Incomplete Markets, Borrow-
     ing Constraints, and Constant Discounting, Journal of Political Economy 103, 1158-1175

 [4] Albanesi, S. and Sleet, C., 2003, Dynamic Optimal Taxation with Private Information.
     Federal Reserve Bank of Minneapolis Discussion Paper #140.

 [5] Allen, F., 1985, Repeated Principal-Agent Relationships with Lending and Borrowing, Eco-
     nomic Letters, 17, 27-31

 [6] Alvarez, F. and Veracierto, M., 1998, Search, Self-Insurance and Job-Security Provisions,
     Federal Reserve Bank of Chicago. Working Paper 98-2

 [7] Arnott, R. and Stiglitz, J.E., 1986, Moral Hazard and Optimal Commodity Taxation, Jour-
     nal of Public Economics 29, 1-24

 [8] Arnott, R. and Stiglitz, J.E., 1990, The Welfare Economics of Moral Hazard. In H. Louberge
     ed. ed., Information and Insurance: Essays in Memory of Karl H. Borch, Norwell, MA:
     Kluwer, 91-121

 [9] Atkeson, A., and Lucas, R. E., Jr., 1992, On eﬃcient distribution with private information,
     Review of Economic Studies, 59, 427-53.

[10] Atkeson, A., and Lucas, R. E., Jr., 1995, Eﬃciency and equality in a simple model of
     eﬃcient unemployment insurance, Journal of Economic Theory 66, 64-88.

[11] Attanasio, O. and Rios-Rull, J., 2000, Consumption Smoothing in Island Economies: Can
     Public Insurance Reduce Welfare?, European Economic Review 44, 1225-1258.

[12] Bewley, T.F., 1986, Stationary Monetary Equilibria with a Continuum of Independently
     Fluctuating Consumers. In Werner Hildenbrand and Andreu Mas-Colell (eds.), Contribu-
     tions to Mathematical Economics in Honor of Gerard Debreu. Amsterdam: North-Holland,
     79-102

                                              29
[13] Bisin, A. and Gottardi, P., 1999, Competitive Equilibria with Asymmetric Information,
     Journal of Economic Theory, 87, 1-48

[14] Bisin, A. and Guaitoli, D., 2004, Moral Hazard and Non-exclusive Contracts, Rand Journal
     of Economics, forthcoming

[15] Bisin, A. and Rampini, A., 2003, Exclusivity and the Institution of Bankruptcy, Mimeo,
     NYU

[16] Chamberlain, G. and Wilson, C., 1984, Optimal Intertemproral Consumption Under Un-
     certainty. Mimeo. Social Systems Research Institute Working Paper 8422, University of
     Wisconsin.

[17] Chamley, C., 1986, Optimal Taxation of Capital Income in General Equilibrium with Infi-
     nite Lives, Econometrica, 54, 607-622

[18] Cole, H. and Kocherlakota, N., 2001, Eﬃcient Allocations with Hidden Income and Hidden
     Storage, Review of Economic Studies, 68, 523-542

[19] da Costa, C., 2004, Yet Another Reason to Tax Goods, mimeo.

[20] Diamond, D.W., and Dybvig, P.H., 1983, Bank Runs, Deposit Insurance, and Liquidity,
     Journal of Political Economy 91, 401-419

[21] Diamond, P., 2003, Taxation, Incomplete Markets, and Social Security. MIT Press

[22] Diamond, P. and Mirrlees, J., 1978, A Model of Social Insurance with Variable Retirement,
     Journal of Public Economics 10: 295-336

[23] Diamond, P. and Mirrlees, J., 1995, Social Insurance with Variable Retirement and Private
     Saving. Mimeo. MIT

[24] Doepke, M. and Townsend, R. M., 2003, Dynamic Mechanism Design with Hidden Income
     and Hidden Actions, Mimeo. UCLA

[25] Golosov, M., Kocherlakota, N. and Tsyvinski, A., 2003. Optimal Indirect and Capital
     Taxation. Review of Economic Studies 70, 569-587

[26] Golosov, M and Tsyvinski, A. 2003. Designing Optimal Disability Insurance. Federal Re-
     serve Bank of Minneapolis. Working Paper #628


                                             30
[27] Green, E., 1987, Lending and the smoothing of uninsurable income, in Contractual Arrange-
     ments for Intertemporal Trade, ed. E. Prescott and N. Wallace, Minneapolis: University of
     Minnesota Press, 3-25.

[28] Greenwald, B.C. and Stiglitz, J.E., 1986, Externalities in Economies with Imperfect Infor-
     mation and Incomplete Markets, Quarterly Journal of Economics, 101, 229-264

[29] Guesnerie, R., 1998, A Contribution to the Pure Theory of Taxation. Cambridge University
     Press

[30] Jacklin, C.J., E., 1987, Demand Deposits, Trading Restrictions, and Risk Sharing, in Con-
     tractual Arrangements for Intertemporal Trade, ed. E. Prescott and N. Wallace, Minneapo-
     lis: University of Minnesota Press, 26-47

[31] Hammond, P.J., 1987, Markets as Constraints: Multilateral Incentive Compatibility in
     Continuum Economies. Review of Economic Studies, 54, 399-412

[32] Hansen, G.D. and Imrohoroglu, A., 1992, The Role of Unemployment Insurance in an
     Economy with Liquidity Constraints and Moral Hazard, Journal of Political Economy, 100,
     118-142

[33] Hopenhayn, H. A. and Nicolini, J. P., 1997, Optimal Unemployment Insurance, Journal of
     Political Economy, 105, 412-438

[34] Hugget, M., 1993, The Risk Free Rate in Heterogenous-Agent, Incomplete Insurance
     Economies. Journal of Economic Dynamics and Control, 17, 953-969

[35] Kocherlakota, N., 2003a, Simplifying Optimal Unemployment Insurance: The Impact of
     Hidden Savings. Mimeo. Stanford University

[36] Kocherlakota, N., 2003b, Zero Expected Wealth Taxes: A Mirrlees Approach to Dynamic
     Optimal Taxation. Mimeo. Stanford University

[37] Krueger, D., and Perri, F., 2001, Risk Sharing: Private Insurance Markets or Redistributive
     Taxes? Mimeo. University of Pennsylvania

[38] Ljungqvist, L. and Sargent, T.J., 2000, Recursive Macroeconomic Theory. MIT Press

[39] Mirrlees, J., 1971, An exploration in the theory of optimum income taxation, Review of
     Economic Studies 38, 175-208.


                                              31
[40] Mirrlees, J., 1976, Optimal tax theory: A synthesis, Journal of Public Economics 6, 327-58.

[41] Phelan, C., 1994, Incentives and aggregate shocks, Review of Economic Studies 61, 681-700.

[42] Prescott, E. C., and Townsend, R., 1984, Pareto optima and competitive equilibria with
     adverse selection and moral hazard, Econometrica 52, 21-45.

[43] Thomas, J., and Worrall, T., 1990, Income fluctuation and asymmetric information: An
     example of a repeated principal-agent problem, Journal of Economic Theory 51, 367-90.

[44] Wang, C. and Williamson, S., 1996, Unemployment Insurance with Moral Hazard and a
     Dynamic Economy. Carnegie-Rochester Conference Series on Public Policy, 44, 1-41

[45] Werning, I., 2001, Optimal Dynamic Taxation. Mimeo. University of Chicago.

[46] Werning, I., 2002, Optimal Unemployment Insurance with Unobservable Savings. Mimeo.
     University of Chicago.


7     Appendix
7.1   Absence of shock-specific securities
The assumption that agents can trade only a risk free bond is not restrictive. In many envi-
ronments, risk free bonds emerge as the only asset traded in equilibrium. Consider a market
structure described in Section 4.1. Suppose each agent observes the identity of the agent with
whom he transacts, but not private characteristics of that agent. In these settings, no Arrow-type
securities, for which the payment depends on the reports of the agents, are traded in equilibrium.
The structure of securities markets is similar to the one studied in Bisin and Gottardi (1999).
Let ai (θ) be a security that pays one unit of consumption good if an agent i reports θ to the
planner in the next period, and zero otherwise. For simplicity we assume that the lowest skill,
θ(1), is strictly positive, so that no agent incurs infinite disutility from reporting any other type.

Claim 2 There is no equilibrium where securities ai (θ) are traded. Only a risk free bond is
traded in equilibrium.

Proof. We will show that, for any price q i (θ) of a security ai (θ), either an agent i can make an
infinite return or has a higher return on a risk free security. Since, in the bilateral trades, agents
can see each other’s type, the price for each security may be diﬀerent depending on whether the
agent, who controls the outcome of it, buys or sells the security.

                                                 32
      Case 1. An agent wants to buy a security that pays one unit of consumption good if he
sends report θ in the next period.
      We show that a price for such a security will be q i (θ) ≥ Q. Suppose, to the contrary, that
q i (θ) < Q. Under such prices the agent could buy infinitely many securities that pay in state
θ and sell a risk-free debt for this amount. Then, in the next period, he claims the state θ.
Since an agent incurs only finite disutility from providing y(θ) units of labor if his type is θ̂,
this strategy yields an infinite utility for the agent. The seller of the security incurs losses, so it
cannot be the equilibrium price.
      If q i (θ) ≥ Q an agent prefers not to sell such a security since it pays 1 unit of consumption in
only one state θ, while risk-free bond pays one unit of consumption in all states and is cheaper.
      Case 2. An agent wants to sell a security that pays one unit of consumption good if he sends
a report θ in the next period.
      The price of such a security is zero. Suppose not. Then the agent can sell infinitely many
of such securities and in the next period claim any state other than θ. The agent makes infinite
profits and utility. Thus, this case is also not possible.
      The intuition for the proof is simple. An agent can choose which skill to report in the next
period. As long as there are gains from reporting any state θ, he will report it with probability
one. But that makes such a security ai (θ) equivalent to a risk free bond, hence no type-specific
securities are traded in equilibrium.

7.2    Proof of Lemma 1
We show that any allocation satisfying (5) also satisfies (9) and (10), and vice versa.
    Suppose {ct , yt }Tt=1 satisfies (5) and the equilibrium prices on the retrading market are
{Qt }Tt=1 . Then the Euler equation (10) is satisfied. Otherwise, the truth telling agent can
improve his utility along some history, and (5) would not hold. Similarly (9) is also satisfied.
Otherwise, if it did not hold for some strategy σ 0 6= σ ∗ , this strategy σ 0 would also be optimal
on the retrading market and the original allocation would not be incentive compatible.
    Suppose {ct , yt , Qt }Tt=1 satisfies (9) and (10). We need to show that on the retrading market
in equilibrium agents choose to reveal their types truthfully, do not trade and consume their
consumption allocations c(σ ∗ ) and the equilibrium interest rates are equal to Q. An agent who
faces prices Q chooses the truthful revelation because of (9). The Euler equation (10) guarantees
that the agent optimally chooses not to buy bonds along this truth telling path. That implies
that the feasibility condition on the retrading market (4) is satisfied and Qt are indeed the
equilibrium prices.


                                                  33
7.3    Proof of Proposition 2
Let θ be the skill shock in the first period. Since all uncertainty is realized after the first period, it
determines the future path of skills. It is a well known result from Werning (2001) and Golosov,
Kocherlakota and Tsyvinski (2003) that when trades are observable, the optimal allocations
satisfy for all θ, t
                               u0 (ct (θ)) = Fk (Kt+1 , Yt+1 )βu0 (ct+1 (θ)).

     We show now that these allocations are also feasible in the economy with unobservable
retrading. Suppose prices on the retrading market are Qt = 1/Fk (Kt+1 , Yt+1 ). Consider an
agent who sends an arbitrary report σ(θ) about his first period skill. Since all uncertainty is
realized after the first period, in all the following periods the agent receives the allocations
{ct (σ(θ)), yt (σ(θ))}Tt=1 that depend only in his report in the first period. Since allocations re-
ceived from planner satisfy the Euler equation, it is optimal for the agent to consume these
allocations without any additional trades: xt (σ(θ)) = ct (σ(θ)) for all t. Therefore, eﬃcient allo-
cations in the economy with observable trades are still incentive compatible if there are hidden
retrading markets. It remains to verify that the constructed Qt ’s are indeed the equilibrium
prices. Since with such prices for all t, θ the following equality holds

                                               xt (θ) = ct (θ),

the feasibility constraint (4) is satisfied.

7.4    Proof of Proposition 5
To prove this result we first present a sequence of lemmas and propositions. We show that any
deviating strategy σ 6= σ ∗ involves positive saving after some history, and never borrowing. This
result implies that the planner would want to decrease the return on deviations by lowering the
interest rates on the retrading market.
    Consider the optimal asset trades and consumption on the retrading market {x(σ(θt )), s(σ(θt ))}Tt=1
for a given strategy σ. They must satisfy (6), (7) and (8).

Lemma 4 For any strategy σ consider the allocation {xt , st }Tt=1 that satisfies (6), (7) and (8).
This allocation must satisfy
                          P                                P
                             θ   π(θ)u0 (x(σ(θt , θ)))      θ   π(θ)u0 (c(σ(θt , θ)))
                                                       ≤                                             (14)
                                  u0 (x(σ(θt )))                 u0 (c(σ(θt )))


                                                     34
for all θt .

Proof. By the monotonicity assumption and the assumption that the only possible deviations
are those in which an agent reports a lower type, it must be true that c(σ(θt ), θ) ≥ c(σ(θt , θ))
for all θt , θ, σ. Here we use a notation σ(θt , θ) to denote a report of the agent after history (θt , θ)
who uses strategy σ.
    Equation (12) implies then that for any θt
                                                         X
                                 Qt u0 (c(σ(θt ))) ≤ β        π(θ)u0 (c(σ(θt , θ))).
                                                         θ

    Combining this inequality with (7) we obtain the lemma.
    The intuition for this result is simple. The marginal rate of substitution of a truth telling
agent is equal to the price of a risk free bond. When an agent reports a lower type, he gets lower
consumption allocations. When shocks are iid that implies that consuming these allocations
without any additional asset trading increases agent’s MRS above the bond price Q, since fewer
resources are available in the next period. However it is optimal for the agent to retrade his
consumption allocations to equalize his MRS with bond prices. This implies inequality (14).
    Since future deviations imply fewer resources, it is optimal for the agent to save in the
anticipation of those deviations, and borrowing is always suboptimal. The following lemmas
formalize this intuition.

Lemma 5 For any strategy σ consider the allocation {xt , st }Tt=1 that satisfies (6), (7) and (8).
Suppose s(σ(θt )) < 0 for some θt . Then x(σ(θt )) < c(σ(θt )) and s(σ(θt−1 )) < 0 for θt−1 ∈ θt .

Proof. Suppose that x(σ(θt )) ≥ c(σ(θt )). This implies that
                          P                                   P
                             θ   π(θ)u0 (x(σ(θt , θ)))            θ   π(θ)u0 (x(σ(θt , θ)))
                                                       ≤                                    .
                                  u0 (c(σ(θt )))                       u0 (x(σ(θt )))

    Combining this with (14) we obtain
                          X                                   X
                                 π(θ)u0 (x(σ(θt , θ))) ≤              π(θ)u0 (c(σ(θt , θ))).
                            θ                                 θ


   This inequality implies that there must be at least one θ such that x(σ(θt , θ)) ≥ c(σ(θt , θ)).
Then from (6) it follows that s(σ(θt , θ)) < 0. Using the previous argument since x(σ(θt , θ)) ≥
c(σ(θt , θ)) it must be true that there exists some node θ0 such that x(σ(θt , θ, θ0 )) ≥ c(σ(θt , θ, θ0 ))


                                                         35
and s(σ(θt , θ, θ0 )) < 0. Continuing this induction there exists a node θT such that x(σ(θT )) ≥
c(σ(θT )) and s(σ(θT )) < 0. But this is impossible since in the last period it must be true that
s(σ(θT )) = 0 for all θT . A contradiction.
    Negative assets in the previous period s(σ(θt−1 )) < 0 for θt−1 ∈ θt follow from the budget
constraint (6) and x(σ(θt )) − c(σ(θt )) < 0.
    It is easiest to understand the intuition for this result in the case when consumption alloca-
tions that an agent receives along his deviation strategy σ satisfy the Euler equation, i.e. (14)
holds with equality, since inequality further strengthen this intuition. Agent’s actual consump-
tion x also satisfies the Euler equation. This implies that an agent chooses to have a higher
consumption x(θt ) than his endowment c(θt ) only if his consumption is also higher in the future.
This is possible only if an agent starts with a positive amount of assets and saves some resources
for the next period.
    The previous results imply that it is optimal for an agent to borrow only if he borrowed in
the previous period. But then borrowing can never be optimal since each agent has a zero initial
asset position. The next proposition formalizes this intuition.

Proposition 7 Consider any strategy σ together with trades and after-trade consumption on
the retrading market {xt , st }Tt=1 . If s(σ(θt )) < 0 then there exists another pair {x̂t , ŝt }Tt=1 that is
feasible and gives a higher utility.

Proof. Consider any reporting strategy σ. The optimal consumption/saving pair {xt , st }Tt=1
should satisfy (6), (7) and (8). The previous lemma showed that if s(σ(θt )) < 0 for some θt
than s(σ(θt−1 )) < 0. Continuing this backward induction we obtain that it must be true that
s(θ0 ) < 0 which violates the initial condition s(θ0 ) = 0. Therefore there is no node in which it
is optimal to borrow.
    In the solution to the social planner’s problem in lemma 1, the incentive constraint (9) binds
for some strategies σ. The next proposition shows that such strategies imply savings in some
states and never borrowing.
    Proof of Proposition 4.
Proof. Consider any deviating strategy σ together with consumption/saving pair {xt , st }Tt=1
that binds in the social planners problem. We established before that for such allocations it
must be true that s(σ(θt )) ≥ 0 for all θt . We show that the inequality is strict for some θt .
The allocations along the truth telling strategy σ ∗ are such that the optimal saving behavior is
                                                                         t              t               t
s(σ ∗ (θt )) = 0 for all θt . For any other strategy there exists some θ̂ so that c(σ(θ̂ )) 6= c(σ ∗ (θ̂ )).
Since we assumed that incentive problem is non-trivial in each period, there must be at least one


                                                     36
       t
such θ̂ in each t, and those constraints bind. But then (6) and (7) can not hold simultaneously
with zero savings in each node, therefore there must be some θt such that s(σ(θt )) > 0.
    The previous propositions showed that if an agent decides to deviate, he always optimally
chooses to have positive savings. A decrease in the interest rates reduces returns on savings and
lowers the utility from deviations. The next proposition shows that the social planner chooses
interest rates to be lower than the return on capital.

  We are finally ready to prove Proposition 5.
Proof. The social planner’s problem is as follows:

                                        T X
                                        X
                              max                π(θt )β t {u(c(θt ), y(θt )/θt ) + ug (Gt )}
                            c,y,G,K,Q
                                        t=1 θt


s.t. for all t, θt
                            X                                                X
                                  π(θt )c(θt ) + Kt+1 + Gt ≤ F (Kt ,               π(θt )y(θt )),
                             θt                                               θt

                T X
                X
                           π(θt )β t u(c(θt ), y(θt )/θt ) ≥ V ({c, y}, {Q})(σ) for any σ 6= σ ∗ ,        (15)
                t=1 θt
                                                       X
                     Qt uc (c(θt ), y(θt )/θt ) = β          π(θt+1 |θt )uc (c(θt+1 ), y(θt+1 )/θt+1 ).   (16)
                                                      θt+1

Suppose Qt ≤ 1/Fk (t + 1) for all t. The first order conditions with respect to Q1 imply that

                                      X          ∂V (σ) X
                                  −       µ(σ)         +   η(θ1 )u0 (c(θ1 )) = 0.
                                      σ
                                                  ∂Q1    1
                                                                θ

                         ∂V (σ)
    From proposition 4          < 0, which implies that η(θ1 ) < 0 for some θ1 .
                          ∂Q1
    Take the first order conditions for c(θt ):

                                                   X                          X            ∂V (σ)
                                  π(θt )β t (1 +       µ(σ))u0 (c(θt )) −           µ(σ)                  (17)
                                                   σ                           σ
                                                                                           ∂c(θt )
                                  +η(θt )Qt u00 (c(θt )) − η(θt−1 )βπ(θt |θt−1 )u00 (c(θt ))
                             = λt π(θt ).

    Take the first order conditions with respect to c(θt+1 ) for all θt+1 that follow θt and sum



                                                               37
them:
                    X                                   X                                 XX               ∂V (σ)
                           π(θt+1 )β t+1 (1 +                µ(σ))u0 (c(θt+1 )) −                  µ(σ)
                                                        σ
                                                                                                          ∂c(θt+1 )
                    θt+1                                                                  θt+1 σ
                                X                                               X
                            t                t+1    t       00    t+1
                    −η(θ )             π(θ         |θ )βu (c(θ          )) +           η(θt+1 )Qt+1 u00 (c(θt+1 ))
                                θt+1                                            θt+1
                            X
               = λt+1             π(θt+1 ).
                           θt+1

    Consider an arbitrary deviating strategy σ. For such a strategy the first order condition on
savings hold
                                               X
                                   Qt ξ(θt ) =      ξ(θt+1 ),
                                                                 θt+1 >θt

where ξ(θt ) is the Lagrangian multiplier associated with constraint (6).
                                                 P                t
   From the envelope theorem ∂V (σ)/∂c(θt ) = θ̃t :σ(θ̃t )=θt ξ(θ̃ ). This implies that

                                                    ∂V (σ) X ∂V (σ)
                                              Qt            =               .
                                                    ∂c(θt )   t+1
                                                                  ∂c(θt+1 )
                                                                   θ

   Premultiply (17) by Qt and use the fact that Qt λt ≤ (1/Fk (t + 1))λt = λt+1 to get

                                    X                                       X            ∂V (σ)
               Qt π(θt )β t (1 +           µ(σ))u0 (c(θt )) − Qt                 µ(σ)               t  2 00    t
                                                                                             t + η(θ )Qt u (c(θ ))
                                       σ                                    σ
                                                                                         ∂c(θ )
             −η(θt−1 )βQt π(θt |θt−1 )u00 (c(θt ))
             X                        X                       XX              ∂V (σ)
           ≤      π(θt+1 )β t+1 (1 +     µ(σ))u0 (c(θt+1 )) −         µ(σ)
                                       σ
                                                                             ∂c(θt+1 )
             θt+1                                             θt+1 σ
                     X                                  X
             −η(θt )      π(θt+1 |θt )βu00 (c(θt+1 )) +    η(θt+1 )Qt+1 u00 (c(θt+1 )).
                       θt+1                                             θt+1

   Expressions containing ∂V (σ)/∂c cancel so we get



                 η(θt )Q2t u00 (c(θt )) − η(θt−1 )βQt π(θt |θt−1 )u00 (c(θt ))
                          X                                   X
               ≤ −η(θt )        π(θt+1 |θt )βu00 (c(θt+1 )) +     η(θt+1 )Qt+1 u00 (c(θt+1 )).
                                θt+1                                            θt+1




                                                                  38
After rearrangement
                                  ⎡                                                               ⎤
                                                             X
                           η(θt ) ⎣Q2t u00 (c(θt )) + β                π(θt+1 |θt )u00 (c(θt+1 ))⎦                    (18)
                                                                 t+1
                                                             θ
                                                                                      X
                                  t−1           t     t−1
                           −η(θ         )βQt π(θ |θ         )u00 (c(θt )) − Qt+1             η(θt+1 )u00 (c(θt+1 ))
                                                                                      θt+1
                    ≤ 0,

with the boundary conditions
                                                η(θT ) = 0, η(θ0 ) = 0.

       We know from optimality, there exists θ1 such that13 :
                                                             ¡ ¢
                                                            η θ1 < 0,
                                            ¡ ¢                ¡      ¢
                                           η θ1 Q1 − η (θ0 ) βπ θ1 |θ0 < 0.

       Assume inductively that there exists θt such that:
                                                             ¡ ¢
                                                            η θt < 0,
                                          ¡ ¢       ¡    ¢  ¡        ¢
                                         η θt Qt − η θt−1 βπ θt |θt−1 < 0.

       We want to prove that these inequalities also hold for (t + 1). Equation (18) implies that:
                          X £ ¡         ¢         ¡ ¢ ¡              ¢¤ ¡     ¡          ¢¢
                             η θt , θt+1 Qt+1 − βη θt π θt , θt+1 |θt u00 ct+1 θt , θt+1
                     θt+1 ≥θt
                     £ t         ¡    ¢  ¡        ¢¤     ¡ ¡ ¢¢
                ≥     η(θ )Qt − η θt−1 βπ θt |θt−1 Qt u00 ct θt .

       And from the inductive assumption:
                X £ ¡         ¢         ¡ ¢ ¡              ¢¤ ¡     ¡         ¢¢
                   η θt , θt+1 Qt+1 − βη θt π θt , θt+1 |θt u00 ct+1 θt , θt+1 > 0,
               θt+1 ≥θt

  13
    We thank Narayana Kocherlakota for suggesting a very elegant following inductive argument that simplified
our original proof.




                                                                       39
which implies that there exists θt+1 such that:
                          £ ¡ t      ¢         ¡ ¢ ¡              ¢¤
                           η θ , θt+1 Qt+1 − βη θt π θt , θt+1 |θt < 0,

and
                                              ¡    ¢
                                             η θt+1 < 0.

   The induction argument implies that there exists θT such that
                           £ ¡ T¢        ¡     ¢ ¡         ¢¤
                            η θ Qt+1 − βη θT −1 π θT |θT −1 < 0,
                                               ¡ ¢
                                              η θT < 0.

which violates
                                               ¡ ¢
                                              η θT = 0.




7.5   Proof of Claim 1
First we show that without loss of generality we can use utility of the consumer

                                  T X
                                  X
                                           π(θt )β t u(c(θt ), y(θt )/θt )
                                  t=1 θt


instead of the indirect utility function V ({c, y}, R)(σ ∗ ). Consider any solution to Firm’s Problem
1 {ct , yt }Tt=1 and the resulting equilibrium allocations of consumption {xt }Tt=1 . For each history
θT the present value of firms’ payment and agent’s consumption must be the same
                                                            YT −1
                             x1 (θT ) + Q1 x2 (θT ) + ... +       Qi xT (θT )
                                                              i=1
                                                            YT −1
                           = c1 (θT ) + Q1 c2 (θT ) + ... +       Qi cT (θT ).
                                                                  i=1

     From proposition 3, 1/Qt−1 = Fk (t) for all t, which implies that the cost of providing {xt }Tt=1
directly to agents must be exactly the same as the cost of providing {ct }Tt=1 . Therefore without
loss of generality we can assume that firms provide each agent with x directly so that the truth
telling agent does not retrade.
     Finally, since in equilibrium firm’s profits are zero, dt = 0 for all t, and firm’s problem 1 can
be re-written in its dual form as in problem 2.

                                                    40
                 20


                 18


                 16


                 14


                 12
       Percent




                 10


                  8


                  6


                  4


                  2


                  0
                   20   25   30    35       40         45   50      55       60      65
                                                 Age




Figure 1: Probability of receiving 0 shock conditional on having a positive productivity 5 years
before.




                                                 41
          8



          7



          6



          5
Percent




          4



          3



          2



          1



          0
           20   25     30      35      40         45   50      55        60   65
                                            Age



                Figure 2: Savings wedge when consumption is observable




                                            42
          1.8



          1.6



          1.4



          1.2



           1
Percent




          0.8



          0.6



          0.4



          0.2



           0
            20   25      30       35      40         45   50       55       60   65
                                               Age



                 Figure 3: Savings wedge when consumption is unobservable




                                           43
