                                 NBER WORKING PAPER SERIES




               CRISES AND LIQUIDITY IN OVER-THE-COUNTER MARKETS

                                             Ricardo Lagos
                                          Guillaume Rocheteau
                                          Pierre-Olivier Weill

                                          Working Paper 15414
                                  http://www.nber.org/papers/w15414


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      October 2009




This paper is a substantial revision of an earlier draft that was circulated in 2007 under the title “Crashes
and Recoveries in Illiquid Markets.” We thank Tobias Adrian, Gara Afonso, Jonathan Chiu, Joe Haubrich,
Antoine Martin, Thomas Sargent, Ruilin Zhou for comments and Monica Crabtree-Reusser for editorial
assistance. We also thank seminar participants at Mannheim University, National University of Singapore,
Singapore Management University, University of Southern California, University of Toulouse, the
2006 Workshop on Money, Banking and Payments at the Federal Reserve Bank of Cleveland, the
2007 Midwest Macro Conference, the 2007 Conference on Microfoundations of Markets with Frictions
in Montreal, the 2007 SED meetings, the Fuqua School of Business, the UCSB-LAEF Conference
on Trading Frictions in Asset Markets, the Universidad Torcuato di Tella, the 2009 Minnesota Workshop
in Macroeconomic Theory, the 2009 Bank of Canada Workshop on Payment Systems and Central
Banking, and the Federal Reserve Bank of New York. The views expressed herein are those of the
authors and not necessarily those of the Federal Reserve Bank of Cleveland, the Federal Reserve System,
or the National Bureau of Economic Research. Lagos thanks the C. V. Starr Center for Applied Economics
at NYU for financial support.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2009 by Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Crises and Liquidity in Over-the-Counter Markets
Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill
NBER Working Paper No. 15414
October 2009
JEL No. C78,D83,E44,G01

                                               ABSTRACT

We study the efficiency of dealers’ liquidity provision and the desirability of policy intervention in
over-the-counter (OTC) markets during crises. Our theory emphasizes two key frictions in OTC markets:
finding counterparties takes time, and trade is bilateral, with quantities and prices determined by bargaining.
We model a crisis as a negative shock to investors’ asset demands that lasts until a random recovery
time. In this context, dealers can provide liquidity to outside investors by acting as counterparties in
trades and by accumulating asset inventories. We find that, when frictions are severe, even well capitalized
dealers may not find it optimal to accumulate inventories, given that investors choose asset positions
that require small reallocations. In such circumstances, the market allocative efficiency can increase
if the government steps in, purchases private assets on its own account, and resells them when the
economy recovers.


Ricardo Lagos                                          Pierre-Olivier Weill
Department of Economics                                Department of Economics
New York University                                    University of California, Los Angeles
19 W. 4th Street, 6th Floor                            Bunche Hall 8283
New York, NY 10012                                     Los Angeles, CA 90095
ricardo.lagos@nyu.edu                                  and NBER
                                                       poweill@econ.ucla.edu
Guillaume Rocheteau
Department of Economics
University of California at Irvine
3151 Social Science Plaza
Irvine, California 9269
ecsrg@nus.edu.sg
1        Introduction

Many of the financial instruments at the core of the recent financial crisis — mortgage-backed
securities, collateralized debt obligations, credit default swaps— are traded in over-the-counter
markets (OTC), outside of organized exchanges. Liquidity in these markets is provided on a
voluntary basis by broker-dealers such as large investment banks, who match buyers and sellers
and, in the event of large selling pressures, typically buy assets on their own account. While
dealers’ liquidity provision seems inconspicuous in normal times, it has proved inadequate
during the crisis (see, e.g., Brunnermeier, 2009, and Bank for International Settlements, 2009).
The ensuing liquidity disruptions prompted the Federal Reserve to undertake unprecedented
policy actions: it offered primary dealers the opportunity to borrow capital cheaply through
various lending facilities and, in some markets, it purchased assets on its own account.1
        We study the efficiency of dealers liquidity provision and the desirability of policy in-
tervention in over-the-counter (OTC) markets during times of crisis. We focus on the role
played by two characteristic trading frictions of OTC markets, search and bargaining, and
abstract from credit-market frictions that may limit dealers’ access to capital.2 There is lit-
tle doubt that credit frictions are important for explaining why the Federal Reserve wants
to ease dealers’ access to capital during crises. However, they don’t easily explain why the
Federal Reserve should also buy assets on its own account, let alone advocate changing the
structure of OTC markets (Bernanke, 2009b). Our analysis shows that, when trading fric-
tions are large, well-capitalized dealers may be unwilling to provide liquidity, and even under
circumstances when it would be socially efficient for them to do so. Since the inefficiencies
are due to trading frictions, supplying more capital to dealers would be ineffective: dealers
would hoard the injected capital instead of providing liquidity. By contrast, we find that the
market allocative efficiency can increase if the government acts as a “liquidity provider of last
resort” by purchasing assets on its own account in order to resell them when the economy
recovers. In the long-run, policies that reduce dealers’ market power may also improve the
market allocative efficiency.
        Our work builds on the search-theoretic models of Duffie, Gârleanu, and Pedersen (2005),
    1
      In March 2008 the Federal Reserve introduced the Term Securities Lending Facility, an auction facility that
allows primary dealers (investment banks, broker-dealers) to borrow Treasury securities for long periods against
less liquid collateral. The Federal Reserve also introduced the Primary Dealer Credit Facility, an overnight
loan facility that provides funding to primary dealers (see Fleming, Hrung, and Keane, 2009). Lastly, on March
2009, it announced it would purchase up to $1.25 trillion in Mortgage Based Securities (see Bernanke, 2009a).
    2
      Credit market imperfections have been analyzed in earlier work, for instance, Gromb and Vayanos (2002),
Weill (2007), and Brunnermeier and Pedersen (2009).


                                                       2
Weill (2007), and Lagos and Rocheteau (2007, 2009). Outside investors cannot trade contin-
uously in a Walrasian market. Instead, they receive infrequent and random trading opportu-
nities with dealers, who are able to trade continuously with each other. This search friction
provides a natural description of bilateral trades in OTC markets, and it also captures a wide
range of impediments that make it more difficult to trade financial assets during crises, such
as disruptions in communication systems, or outright dealer failures, such as that of Lehman
Brothers in September 2008. To create a crisis, we hit our theoretical OTC market with
an aggregate negative shock that reduces investors’ willingness to hold the asset. The crisis
state persists until some random time at which investors receive the opposite shock and the
economy recovers.
   We determine the conditions under which well-capitalized, profit-maximizing dealers pro-
vide liquidity to outside investors, accumulating assets in their inventory during the crisis and
unloading these assets when the economy recovers. We find that the amount of liquidity pro-
vided by dealers varies nonmonotonically with the magnitude of the trading frictions. More
precisely, consider a spectrum of OTC markets ranging from those with very small frictions,
for instance markets for Treasury securities or wholesale foreign exchange, to those with large
trading frictions, such as some markets for subprime mortgage-backed securities. We find
that dealers provide no liquidity in markets at either end of the spectrum and some liquidity
in markets lying in the the middle of the spectrum. In particular, when trading frictions are
very large, investors become reluctant to hold extreme asset positions because they anticipate
that these positions will be very difficult to unwind. All investors end up with a similar “av-
erage” asset position and therefore do not demand much liquidity from dealers. Because of
this accommodation in liquidity demand, dealers do not provide any liquidity in equilibrium.
   In markets where dealers have a large degree of bargaining power, the lack of liquidity
provision is socially inefficient, given the search frictions. This finding has three main policy
implications. First, since dealers in our analysis have unrestricted access to capital, it im-
mediately implies that injecting capital is ineffective: dealers would hoard it instead of using
it to purchase assets. Second, we show that if the government acts as a “liquidity-provider-
of-last-resort,” i.e., if it purchases assets during the crisis in order to resell them when the
economy recovers, the market allocative efficiency can increase. The third implication is that
policies reducing dealers’ market power can improve the allocative efficiency of the market.




                                               3
Related literature

Our work belongs to the recent literature that studies search and bargaining frictions in asset
markets, and pursues the inventory-theoretic approach to dealership markets that goes back
to Stoll (1978), Ho and Stoll (1983) and Amihud and Mendelson (1980), as well as the recent
work of Hendershott and Menkveld (2009). We go beyond previous studies by working out
the out-of-steady-state dynamics induced by aggregate shocks while allowing both dealers and
investors to hold unrestricted asset positions. Lagos and Rocheteau (2007, 2009) relax Duffie,
Gârleanu, and Pedersen’s (2005) restriction that investors can hold 0 or 1 unit of the asset but
maintain the assumption that dealers cannot hold asset inventories, so their model remains
silent about the desirability of liquidity provision by dealers in the face of temporary selling
pressures. Weill (2007) allows dealers to hold unrestricted inventories but maintains the 0-1
restrictions on investors’ asset holdings. In this paper we relax the holding restrictions of
both dealers and investors, and show that the endogenous response of investors’ holdings to
trading frictions is a key determinant of dealers’ equilibrium liquidity provision. For instance,
in contrast with Weill (2007), we show that dealers may not find it in their interest to provide
liquidity during the crisis when it would be socially optimal for them to do so. Weill (2007)
also assumed that, after the initial shock, the recovery path was deterministic. Instead, we
consider a more realistic setup in which the recovery is a random event, which generates
the new implication that rational dealers find it optimal to buy assets while the market price
continues to decline, and re-sell them while the market price continues to go up (the associated
price divergence is similar to that of Kondor, 2009, except that it is based entirely on search
frictions instead of capital market frictions). Lastly, our model can provide a rationale for
purchases of assets by the government in OTC markets during crisis. In independent work,
Chiu and Koeppl (2009) analyze welfare-improving purchases of “lemons” by the government,
in a search model with adverse selection.
   There is a related literature on liquidity provision by dealers, e.g., the seminal model of
Grossman and Miller (1988), where competitive dealers provide liquidity in order to share
risk with investors. Recent work in that tradition includes Gromb and Vayanos (2002) and
Brunnermeier and Pedersen (2009), who study the impact of borrowing constraints on the
supply of liquidity, and Huang and Wang (2009), who endogenize the supply and demand
of liquidity via participation costs. In contrast to this line of work, our dealers are not
competitive and do not share risk with investors. Instead, they have market power and, as



                                               4
Demsetz (1968) emphasized, they provide immediacy: they speed up the allocation of assets
to their final holders. Bernardo and Welch (2004) study how dealers provide liquidity during
a financial-market run, in a model in the tradition of Diamond and Dybvig (1983). Lastly,
our study of government liquidity provision is related to some results in the payment-system
literature, most notably Freeman (1996, 1999), who shows that a temporary government
purchase of private IOUs may improve welfare in the presence of settlement frictions.


2        The environment

Time is continuous, runs forever, and is indexed by t ≥ 0. There is one asset and one
perishable good, which we use as a numéraire. The asset is durable, perfectly divisible, and
in fixed supply, A > 0. The numéraire is produced and consumed by all agents. The economy
is composed of two types of infinitely-lived agents who discount the future at the same rate,
r > 0, a unit measure of investors, and a unit measure of dealers.
        The instantaneous utility function of an investor is ζ(t)ui (a) + c, where a ≥ 0 represents
the investor’s asset holdings, c is the net consumption of the numéraire good (c < 0 if the
investor produces more than he consumes), i ∈ {1, ..., I} indexes an idiosyncratic preference
shock, and ζ(t) represents an aggregate preference shock. The utility function ui (a) is strictly
increasing, concave, continuously differentiable, and satisfies u′i (0) = ∞. We also assume
that u(a) is either bounded below or above. Investors receive idiosyncratic preference shocks
that occur at Poisson arrival times with intensity δ > 0. When the preference shock hits,
the investor draws preference type i with probability π i . These preference shocks capture
the notion that investors value the services provided by the asset differently over time, and
they generate a need for them to periodically change their asset holdings.3 At time zero the
distribution of investors across the preference types {1, ..., I} is at its steady state, {π i }Ii=1 .
        We trigger a financial crisis with an aggregate preference shock. As illustrated in Figure
1, we assume that ζ(t) = θ < 1 for all t ∈ [0, Tρ ), and ζ(t) = 1 for all t ≥ Tρ , where Tρ is an
exponentially distributed random variable with mean 1/ρ, independent from everything else.4
    3
     As in Duffie, Gârleanu, and Pedersen (2005), our preference specification associates a certain utility to the
investor as a function of his asset holdings. The utility the investor gets from holding a given asset position could
be simply the value from enjoying the asset itself, as would be the case for real assets such as houses or durables.
In the context of financial markets, one should view ui (a) as a reduced-form utility function that stands in for
the various reasons why investors may want to hold different quantities of the asset: differences in liquidity
needs, financing or financial-distress costs, correlation of asset returns with endowments (hedging needs),
or relative tax disadvantages. By now, several papers have formalized the “hedging needs”interpretation.
Examples include Duffie, Gârleanu, and Pedersen (2007), Vayanos and Weill (2008), and Gârleanu (2009).
   4
     Although we follow the spirit of Grossman and Miller (1988), we depart from their model in two ways.


                                                         5
                                     ζ(t)


           ζ(t) = 1



                        ζ(t) = θ < 1
                                                                                                   time
                                                     random recovery time, Tρ


                                Figure 1: The aggregate preference shock


A small θ indicates that the crisis is severe, and a small ρ that it is expected to be long-lived.
Although assuming a preference shock is admittedly a reduced-form model of a crisis, it is in
the spirit of the aggregate endowment shocks that are commonly used in the literature (see,
e.g., Grossman and Miller, 1988). It also admits several reasonable interpretations: a shock to
the riskiness (or “toxicity”) of the asset, a “flight to liquidity” (Longstaff, 2004), or a sudden
need for cash (Diamond and Dybvig, 1983).
    To capture the intuitive notion that dealers are not the final holders of the asset, we assume
that their instantaneous utility is c, i.e., that they derive no direct utility from holding the
asset. We assume that dealers can continuously buy and sell the asset in an interdealer
market, at price p(t). Investors, on the other hand, can only trade periodically and through
a dealer. Specifically, we assume that investors contact a randomly chosen dealer at Poisson
arrival times with intensity α > 0. Once the investor and the dealer have made contact, they
negotiate the quantity of assets that the dealer will acquire (or sell) in the interdealer market
on behalf of the investor and the intermediation fee that the investor will pay the dealer for
his services. After completing the transaction, the dealer and the investor part ways. The
trading arrangement is illustrated in Figure 2.
First, in our model, the length of the crisis is stochastic, so dealers’ uncertainty about the recovery will influence
their incentive to provide liquidity. Second, in Grossman and Miller, dealers provide liquidity in order to share
risk with outside investors, while in the present model, dealers have no such direct utility motive for holding
assets. Dealers indirectly derive value from holding the asset because they are continuously present in the
market, so they can “time the market” better than outside investors. This leads them to hold inventories and,
in the aggregate, speeds up the allocation of assets to their final holders.




                                                          6
               Investors




                                                                                              Investors
                                                                                  α




                                        Dealers
                              α                   Interdealer




                                                                     Dealers
                                                   Market




                                     Figure 2: Trading arrangement


3       Equilibrium

We characterize an equilibrium in two steps: we first solve for the equilibrium after the
recovery time, for every possible Tρ . Then, we solve for the equilibrium during the crisis,
before Tρ has been realized.

3.1     The path to recovery

In this section we describe the path of the economy following Tρ . The aggregate preference
shock is ζ(t) = 1 for all t ≥ Tρ . We take as given two initial conditions: the realization of
Tρ , and the dealers’ inventories at the time where the economy recovers, Ad (Tρ ). To simplify
notations in what follows, we suppress the explicit dependence of endogenous variables on
these two initial conditions.

3.1.1    The terms of trades in bilateral meetings

Consider a meeting at time t ≥ Tρ between a dealer who is holding inventory ad and an
investor of type i who is holding inventory a. Let a′ denote the investor’s post-trade asset
holding and φ be the intermediation fee.5 The pair (a′ , φ) is taken to be the Nash solution of
a bargaining problem in which the dealer has bargaining power η ∈ [0, 1]. Let Vi (a, t) denote
the value (maximum attainable expected discounted utility) of an investor with preference
type i who is holding a quantity of asset a at time t ≥ Tρ . The investor’s gain from trade is


                                  Vi (a′ , t) − Vi (a, t) − p (t) (a′ − a) − φ.
    5
    In our formulation we assume that the investor pays the dealer a fee. However, the bargaining problem
can be readily reinterpreted as one in which the dealer pays the investor a bid price that is lower than the
market price if the investor wants to sell, and charges an ask price that is higher than the market price if the
investor wants to buy. See Lagos and Rocheteau (2009) for details.


                                                       7
Analogously, let W (ad , t) denote the value of a dealer who is holding inventory ad at time
t ≥ Tρ . Then, the utility of the dealer is W (ad , t) + φ if an agreement (a′ , φ) is reached and
W (ad , t) in case of disagreement, so the dealer’s gain from trade is equal to the fee, φ.6 The
outcome of the bargaining is given by


              [ai (t), φi (a, t)] = arg max [Vi (a′ , t) − Vi (a, t) − p (t) (a′ − a) − φ]1−η φη .
                                       (a′ ,φ)


Hence, the investor’s new asset holding solves


                                                     Vi (a′ , t) − p(t)a′ ,
                                                                        
                                   ai (t) = arg max
                                                 ′
                                                                                                              (1)
                                                      a


and the intermediation fee is


                        φi (a, t) = η {Vi [ai (t) , t] − Vi (a, t) − p(t) [ai (t) − a]} .                     (2)


According to (1), the investor’s post-trade asset holding is the one he would have chosen if
he were trading in the asset market himself, rather than through a dealer. According to (2),
the intermediation fee is set so as to give the dealer a share η of the gains associated with
readjusting the investor’s asset holdings.7

3.1.2    The dealer’s problem

The value function of a representative dealer who is holding asset position a at time t ≥ Tρ
solves                                  Z            ∞                       
                                                          −r(s−t)
                         W (a, t) = max −                 e         p(s)q(s)ds + Φ (t) ,                      (3)
                                       q(s)       t

subject to the law of motion, ȧd (s) = q (s), the short-selling constraint ad (s) ≥ 0, and the
initial condition, ad (t) = a. Here, ad (s) represents the stock of assets that the dealer is hold-
ing and q (s) is the quantity that he trades for his own account at time s. The dealer gets
utility −p (s) q (s) from changing his inventory. The function Φ (t) is the expected present
discounted value of future intermediation fees from time t onward which, by (2), is indepen-
   6
     The outcome of the bilateral trade does not affect the dealer’s continuation payoff, W (ad , t), because he
has continuous access to the asset market and his trades are executed instantaneously. The dealer may fill an
investor’s order partially or in full by trading out of, or for his own inventory of the asset. A dealer following
an optimal plan must be indifferent, when executing a trade, between using his inventories or not because he
has continuous access to the asset market and all the transactions he is involved in are instantaneous.
   7
     Our choice of notation for the bargaining solution in (1) and (2) emphasizes the fact that the terms of
trade depend on the investor’s preference type but are independent of the dealer’s inventories. In addition, the
investor’s post-trade asset holding is independent of his pretrade holding, while the intermediation fee is not.




                                                              8
dent of the dealer’s asset holdings. This formulation makes it clear that dealers trade assets
in two ways: continuously, in the competitive market, or sporadically at random times, in
bilateral negotiations with investors. Since dealers have linear preferences and they can trade
instantaneously and continuously in the competitive interdealer market, their optimal choice
of asset holdings is independent of what happens in bilateral negotiations with investors. The
following lemma describes the solution to the dealer’s inventory accumulation problem:

Lemma 1. Suppose that the price path, p(s), is differentiable and satisfies the no-bubble
condition, lims→∞ e−rs p(s) = 0. Then, a bounded inventory path, ad (s), with initial condition
ad (t) = a solves the dealer’s problem, (3), if and only if for all s > t:


                      ṗ (s) − rp (s) ≤ 0,         with equality if ad (s) > 0.                            (4)


   Several comments are in order. First, the assumption of differentiability and the no-
bubble condition are only made to simplify the exposition: in Lagos, Rocheteau, and Weill
(2007) we show that these two conditions must, in fact, hold in any equilibrium. Second,
the lemma restricts attention to bounded inventory paths because this property must also
hold in equilibrium. Indeed, a group of agents can hold an unbounded positive position only
if some other group holds the opposite negative one, which is ruled out by the short-selling
constraint. Then, the “only if” part of the lemma provides restrictions on the equilibrium
price path, given any bounded solution ad (t) of the dealer’s problem. The “if” part of the
Lemma is a standard sufficient condition for “speculator” optimality: a dealer holds positive
inventory if the flow cost of buying the asset, rp (s), is equal the the capital gain, ṗ (s), and
he holds no inventory if it is smaller.

3.1.3   The investor’s problem

We now proceed with an analysis of the investor’s problem. The value function corresponding
to an investor with preference type i who is holding a assets at time t ≥ Tρ , Vi (a, t), satisfies
                          Z   T
        Vi (a, t) = Ei             e−r(s−t) uk(s) (a)ds +
                           t
                                                                                                      
                       −r(T −t)
                      e            {Vk(T ) [ak(T ) (T ), T ] − p(T )[ak(T ) (T ) − a] − φk(T ) (a,T )} ,   (5)


where T denotes the next time the investor meets a dealer, and k(s) ∈ {1, ..., I} denotes the
investor’s preference type at time s. The expectations operator, Ei [ · ], is taken with respect


                                                       9
to the random variables T and k(s) and is indexed by i to indicate that the expectation is
conditional on k(t) = i. Over the interval of time [t, T ] the investor holds a units of the asset
and enjoys the discounted sum of the utility flows associated with this holding of a (the first
term on the right side of (5)). The length of this time interval, T − t, is an exponentially
distributed random variable with mean 1/α. The flow utility is indexed by the preference
type of the investor, k(s), which follows a compound Poisson process. At time T the investor
contacts a random dealer and readjusts his holdings from a to ak(T ) (T ). In this event the
dealer purchases a quantity ak(T ) (T ) − a of the asset in the market (or sells if this quantity
is negative) at price p(T ) on behalf of the investor, and the investor pays the dealer an
intermediation fee, φk(T ) (a, T ). Both the fee and the asset price are expressed in terms of the
numéraire good.
   Substituting the terms of trade (1) and (2) into (5), it is apparent that, from the investor’s
standpoint, the stochastic trading process and the bargaining solution are payoff-equivalent
to an alternative trading mechanism in which the investor has all the bargaining power in
bilateral negotiations with dealers, but he only gets to meet dealers according to a Poisson
process with arrival rate κ ≡ α(1 − η). Consequently, we can rewrite (5) as
                   Z   T̃                                                                                                 
                                                 −r(s−t)         −r(T̃ −t)                            ′              ′
  Vi (a, t) = Ei             uk(s) (a) e                   ds + e            {p(T̃ )a + max
                                                                                         ′
                                                                                            [Vk(T̃ ) (a , T̃ ) − p(T̃ )a ]} , (6)
                    t                                                                     a


where the expectations operator, Ei , is now taken with respect to the random variables T̃ and
k(s), where T̃ − t is exponentially distributed with mean 1/κ.
   After subtracting p(t)a from (6) and ignoring all the terms that do not depend on the
asset holding a, we find that the problem of an investor with preference shock i, who gains
access to the market at time t, consists of choosing a ≥ 0 in order to maximize
                                   "Z                                                                 #
                                            T̃                                                     
                                                             −r(s−t)                −r(T̃ −t)
                              Ei                 uk(s) (a)e            ds − p(t) − e          p(T̃ ) a .                     (7)
                                        t


Intuitively, the investor chooses his asset holdings in order to maximize the present value of
his utility flow net of the cost of purchasing the asset at time t and reselling it at the next time
T̃ when he can readjust his holdings. The next lemma offers a simpler, equivalent formulation
of the investor’s problem.




                                                                       10
Lemma 2. Let
                                                       PI
                                  (r + κ) ui (a) + δ        j=1 π j uj (a)
                       Ui (a) =                                                                 (8)
                                       r + κZ+∞δ                     
                                                    −(r+κ)s
                        ξ(t) = (r + κ) p(t) −     κe        p(t + s)ds ,                        (9)
                                                       0

assume that p(t)e−rt is decreasing and satisfies the no-bubble condition. Then, a bounded
process a(t) solves the investor’s problem if and only if, when the investor contacts the market
with current type i,
                                  a(t) = ai (t) where Ui′ [ai (t)] = ξ(t).                     (10)

The assumption that p(t)e−rt is decreasing is without loss of generality, because it will be true
in an equilibrium: otherwise if there were two times t1 < t2 such that p(t1 ) < e−r(t2 −t1 ) p(t2 ),
then a dealer could make unbounded profit by purchasing at t1 and reselling at t2 .
   Intuitively, Ui (a) is the expected flow of utility that the investor enjoys from holding
a units of the asset until his next opportunity to rebalance his holdings, and ξ (t) is an
investor’s effective cost of holding the asset during the intercontact time period: the purchasing
price minus the expected discounted resale value of the asset, all expressed in flow terms.
Differentiating (9), we can expresse the relationship between ξ(t) and p (t) as

                                                           ξ̇ (t)
                                     ṗ (t) − rp (t) =            − ξ(t).                      (11)
                                                           r+κ

From (11), the dealer’s first-order condition, (4), can be rewritten as


                 ξ̇ (t) − (r + κ)ξ (t) ≤ 0,      with an equality if ad (t) > 0.               (12)


Equations (10) and (12) illustrate the main differences between dealers and investors in our
setup. Relative to investors, dealers enjoy no direct utility from holding the asset, but they
get an extra return captured by ξ̇ (t) / (r + κ). This reflects a dealer’s ability to make capital
gains by exploiting his continuous access to the asset market.

3.1.4   The equilibrium path during the recovery

Given the solutions to the investors’ and dealers’ problems, we are now ready to study the
determination of the asset price. Since each investor faces the same probability of accessing
the market irrespective of his asset holdings, and since these probabilities are independent
across investors, we appeal to the law of large numbers to assert that the flow supply of assets


                                                    11
by investors is α [A − Ad (t)], where Ad (t) is the aggregate stock of assets held by dealers. The
measure of investors with preference shock i who are trading in the market at time t is απ i ,
where π i is the ergodic measure of investors with preference type i. Therefore, the investors’
aggregate demand for the asset is α Ii=1 π i ai (t), and the net supply of assets by investors
                                       P

is α[A − Ad (t) − Ii=1 π i ai (t)]. The net demand from dealers is Ȧd (t), the change in their
                   P

inventories. Therefore, market clearing requires
                                   n                                   o
                        Ȧd (t) = α A − Ad (t) − Ii=1 π i Ui′−1 [ξ (t)] ,
                                                P
                                                                                             (13)


after substituting the investor’s first-order condition (10). This market-clearing condition
determines the inventory path given some ξ(t). Aggregating (12) across all dealers, we find
the condition:


                    ξ̇ (t) − (r + κ)ξ (t) ≤ 0 with an equality if Ad (t) > 0.                (14)


An equilibrium following the recovery time Tρ is a solution {Ad (t), ξ(t); t ≥ Tρ } to the system
of differential equations (13) and (14), with the given initial condition Ad (Tρ ). While we do
not include p(t) in the definition of an equilibrium, it can be recovered from (11), which, using
the no-bubble condition, limt→∞ e−rt p(t), implies
                                                           "             #
                                            ∞
                                                                   ξ̇(s)
                                        Z
                               p(t) =           e−r(s−t)    ξ(s) −         ds.
                                        t                          r+κ

    In a steady state, ξ(t) = ξ̄ and ξ̇(t) = 0 so that (14) holds with a strict inequality, and
Ad (t) must be equal to zero. If we set Ad (t) = 0 into equation (13), we find that the steady
state ξ̄ is the unique solution of
                                            I
                                            X
                                                  π i Ui′−1 (ξ̄) = A.
                                            i=1

    In addition, with equation (11) we find that the steady-state price solves r p̄ = ξ̄. The
following proposition summarizes the equilibrium path towards the steady state.

Proposition 1 (The equilibrium path to recovery). There is a unique equilibrium path
{ξ (t) , Ad (t) : t ≥ Tρ } and it is such that:




                                                       12
 (a) For all t ∈ (Tρ , T ],


                 ξ(t) = ξ̄e−(r+κ)(T −t)                                                                   (15)
                                                                          I
                                                                   "                             #
                                                  Z    t                  X
               Ad (t) = e−α(t−Tρ ) Ad (Tρ ) + α            e−α(t−s) A −            π i Ui′−1 [ξ(s)] ds,   (16)
                                                      Tρ                     i=1

      where T < ∞ is the unique solution to Ad (T ) = 0.

 (b) For all t ≥ T , {ξ(t), Ad (t)} = (ξ̄, 0).

   According to (15), the investor’s effective cost of holding the asset, ξ(t), increases at
rate r + κ while dealers hold inventories; meanwhile, according to (16), the stock of assets
held by dealers decreases monotonically until it is fully depleted at time T . The condition
Ad (T ) = 0 provides a relationship between the effective cost of holding the asset at the
recovery time, ξ(Tρ ) = ξ̄e−(r+κ)(T −Tρ ) , and dealers’ initial inventories, Ad (Tρ ). We represent
this relationship by the function ψ(A) such that ξ(Tρ ) = ψ [Ad (Tρ )]. Notice that ψ ′ (A) < 0,
so ξ(Tρ ) is decreasing in Ad (Tρ ), and ψ(0) = ξ̄. Intuitively, the larger the stock of inventories
that dealers are holding at the time of the recovery, the longer it will take dealers to unwind
their inventories once the recovery has occurred. But the only way dealers are willing to hold
assets longer is if they make a larger capital gain, that is, if the effective cost of holding the
asset at the recovery time, ξ(Tρ ), is lower.

                                   ξ
                                                               Ȧd (t) = 0




                              ξ̄




                                                                          Ad
                                                              Ad (Tρ )


                  Figure 3: Phase diagram for the equilibrium recovery path


                                                 13
   Figure 3 shows the phase diagram of the dynamic system {Ad (t), ξ(t)} following the re-
covery. From (13) we see that the Ad -isocline is upward-sloping and intersects the vertical
axis at the steady-state point. The sign of the derivatives Ȧd (t) and ξ̇(t) in various regions
of the plane are indicated by horizontal and vertical arrows. The equilibrium trajectory
of the economy is indicated in the figure by double arrows along the saddle-path, namely,
ξ(t) = ψ [Ad (t)]. The initial condition Ad (Tρ ) determines the starting point on the saddle
path. The trajectories marked with dotted lines that do not follow the saddle path are solu-
tions to the differential equations (13) and (14), but they either fail to satisfy the no-bubble
condition or the requirement that the equilibrium path, ξ(t), be continuous.

3.2     The crisis

In this section, we analyze the economy during the initial crisis period, t < Tρ . The value
functions and the asset price following the recovery, characterized in Section 3.1, are a func-
tion of time t, of the recovery time, Tρ , and of the starting aggregate inventory of dealers. To
simplify notations, we denote these functions by Vi (a, t | Tρ ), W (ad , t | Tρ ), and p(t | Tρ ), re-
spectively. For all value functions and prices during the crisis, t < Tρ , we add the superscript
“C.”

3.2.1    Dealer’s and Investor’s problems

At any time t, before the recovery has occurred, the dealer solves
                       Z   Tρ                                                                 
                                 −e−r(s−t) pC (s)q C (s)ds + e−r(Tρ −t) W aC
                                                                                            
             max E                                                         d (Tρ ) , Tρ | Tρ     ,   (17)
             q C (s)    t


subject to ȧC        C      C                                                   C
             d (s) = q (s), ad (s) ≥ 0 for all s ≥ t, and the initial condition ad (t) = a. The

following lemma describes the optimality conditions.

Lemma 3. Suppose that the price path, pC (s), during the crisis is differentiable and satisfies
the no-bubble condition. Then, a bounded inventory path, aC                              C
                                                          d (s), with initial condition ad (t) =

a, solves the dealer’s problem if and only if for all s > t:


          ṗC (s) + ρ p(s | s) − pC (s) − rpC (s) ≤ 0,             with equality if aC
                                       
                                                                                     d (s) > 0.      (18)


From Lemma 3 we see that the flow dealers’ profit during the crisis has three components: the
capital gain while the economy remains in the crisis state, ṗC (s), the expected capital gain,



                                                        14
ρ(p(s | s) − pC (s)), if the economy recovers with Poisson intensity ρ, and the opportunity cost
of holding the asset, rpC (s).
   Following the same steps as in the previous section, it can be shown that an investor who
gains access to the market at time t < Tρ with preference type i, chooses aC
                                                                           i ≥ 0 in order to

maximize
                "Z                                                                                                #
                         T̃                                                                                  
                                                                 −r(s−t)                      −r(T̃ −t)
                                          θ)I{s≥Tρ } uk(s) (aC                                                  C
                                                    
           Ei                  θ + (1 −                      i )e                ds − p(t) − e          p(T̃ ) ai .
                     t


where
                                       p(T̃ ) = I{T̃ <Tρ } pC (T̃ ) + I{T̃ ≥Tρ } p(T̃ | Tρ ).

There are only two differences between this equation and equation (7) in the previous section:
first, the period utility for the asset is scaled down by θ whenever s ≤ Tρ , and, second, an
investor expects that the economy may have recovered by the time T̃ , when he is able to resell
the asset. The following lemma provides a simpler formulation of the investor’s problem.

                                       r+κ                    ρ
Lemma 4. Let uC
              i (a) ≡                 r+κ+ρ θui (a)     +   r+κ+ρ Ui (a)     and

                                                        PI
                              (r + κ + ρ) uC
                                           i (t) + δ
                                                                     C
                                                            j=1 π j uj (a)
    UiC (a)     =                                                                                (19)
                          r+κ+ρ+δ
                               Z ∞                 
     ξ C (t) = (r + κ) pC (t) −     κe−(r+κ)(τ κ −t) e−ρ(τ κ −t) pC (τ κ )
                                 t
                                                    Z τκ                                     
                                                            −ρ(τ ρ −t)
                                                 +       ρe            p(τ κ | τ ρ ) dτ ρ dτ κ . (20)
                                                                             0


Assume that Et p(s)e−r(s−t) is decreasing in s and that p(s) satisfies the no-bubble condition.
                          

Then a bounded process aC (t) solves the investor’s problem if and only if, when the investor
contacts the market with current type i,

                                                              C′
                                       aC (t) = aC
                                                                  C 
                                                 i (t) where Ui   ai (t) = ξ C (t).                                   (21)


   This is the natural counterpart of Lemma 2. As before, Et p(s)e−r(s−t) has to be de-
                                                                        

creasing in an equilibrium, otherwise the dealer’s problem would not have a bounded solution.
Note that the formula for UiC (a) is similar to the one for Ui (a), except that the period utility
ui (a) is replaced by
                                             r+κ              ρ
                                                  θui (a) +       Ui (a).
                                            r+κ+ρ           r+κ+ρ
Intuitively, the investors rescale his period utility by θ while keeping in mind that, before the


                                                                 15
next contact time, the recovery may arrive with Poisson intensity ρ, in which case the flow
continuation utility becomes Ui (a). The formula for ξ C (t) takes into account the expected
capital gain that will be realized the next time the investor gains access to the market, which
may be before or after the economy recovers. As before, the last two terms on the right-hand
side of (20) represent the expected resale price of the asset.

3.2.2     The equilibrium path during the crisis

After differentiating condition (20), we find that

                                                            C
                                                          ξ̇ (t) + ρ ξ(t | t) − ξ C (t)
                                                                                      
               C       C                        C  C
                                             
          −rp (t) + ṗ (t) + ρ p(t, t) − p (t) = −ξ (t) +                                ,          (22)
                                                                     r+κ

where
                                    ξ (t | Tρ ) = ψ [Ad (Tρ )] e(r+κ)(t−Tρ ) .

Plugging (22) back into the dealer’s first-order condition (17) and aggregating, we obtain

         C
   n                                            o
       ξ̇ (t) + ρψ[AC
                    d (t)] − (r + κ + ρ) ξ C
                                             (t)  AC                              C
                                                   d (t) ≤ 0 with an equality if Ad (t) > 0.        (23)


The market clearing condition is

                                                            I
                                        (                                            )
                                                            X
                            ȦC              C
                              d (t) = α A − Ad (t) −              π i UiC ′−1 [ξ C (t)] ,           (24)
                                                            i=1


which is the same as before except for the fact that Ui′ (a) is replaced by UiC ′ (a). We can now
define an equilibrium during the crisis to be a pair ξ C (t), AC
                                                     
                                                                 d (t) , satisfying (23) and (24).
                                                                                                C
   One can easily show that the system (23) and (24) has a unique steady state (ξ̄ , ĀC
                                                                                       d)

characterized by

                            C   ρ
                       ξ̄       ≥   ψ(ĀC                           C
                                          d ) with an equality if Ād > 0
                            r+κ+ρ
                                  I
                                                   C
                                  X
                        A = ĀC
                              d +   π i UiC ′−1 (ξ̄ ).
                                          i=1

Analyzing the system (23) and (24) of ODEs yields:

Proposition 2 (The equilibrium path during the crisis). Assume that ĀC
                                                                      d > 0 and suppose
                                                                      C                     C
AC
 d (0) = 0. Then, the equilibrium crisis path is unique, starts with ξ (0) > ξ̄ , and converges
                                            C
monotonically to the steady state, {ξ̄ , ĀC
                                           d }.



                                                       16
                                   ξC
                                        Ȧd (t) = 0         ȦC
                                                              d (t) = 0




                          ξ̄


                        ξ C (0)


                               C
                          ξ̄
                                                                           C
                                                                          ξ̇ (t) = 0

                                                                          AC
                                                                           d

                                                      ĀC
                                                        d



                        Figure 4: Phase diagram for the crisis path.


   These properties can be intuitively derived using the phase diagram of Figure 4. The
isocline ȦC
           d = 0 during the crisis is represented by the upward plain curve. It is located to

the right of the recovery isocline Ȧd = 0, represented by the upward dashed curve. This is
because, for any given ξ, investors’ demand for the asset is lower during the crisis, and hence
                                                                                   C
dealers’ demand must be higher for the market to clear. The isocline ξ̇                = 0 is represented
by the downward-sloping plain curve. Proposition 2 shows that, given the initial condition
ACd (0) = 0, there is a unique saddle-path during the crisis, represented in the figure by the
                                                                         
                                                                        C
plain curve with double arrows, leading to the steady state, ĀC d , ξ̄    .

3.3   Putting the crisis and the recovery together

Taken together, Propositions 1 and 2 show that the equilibrium unfolds as follows. The econ-
                                                          C
omy starts at AC
               d (0) = 0, and at the time of the crisis, ξ (t) jumps down to the saddle-path
                 C
leading to (ĀC
              d , ξ̄ ). The economy then evolves along the crisis saddle-path until the random-

recovery shock occurs. If ĀC
                            d > 0, then along the crisis saddle-path, dealers’ inventories

increase and ξ C (t) decreases. At the random recovery time, the system jumps to the recovery
                             
saddle-path leading to 0, ξ̄ . This is the saddle path of Proposition 1, indicated in Figure 3
by the dashed curve with double arrows. At the time the recovery shock occurs, the cost ξ(t)
of holding the asset jumps up, and dealers begin selling their inventories gradually until they
are completely depleted. We summarize these findings in the following corollaries:


                                                17
Corollary 1 (Crisis and recovery dynamics when dealers provide liquidity). Suppose ĀC
                                                                                     d > 0.

At the time of the crisis, t = 0, the price p(t) jumps down. Then, as the crisis unfolds, for
t ∈ (0, Tρ ), dealers’ inventories increase towards ĀC
                                                      d while the price continues to decrease. At

the time of the recovery, t = Tρ , the price jumps up. During the recovery, t ∈ [Tρ , ∞), dealers’
inventories decrease towards zero, and the price continues to increase towards ξ̄/r.

    The corollary is illustrated in the left panel of Figure 5. While the analysis in the first
paragraph of this section showed that the effective cost ξ C (t) is decreasing during the crisis,
Corollary 1 shows that this is also true for the price, pC (t). Note that our profit maximizing
and atomistic dealers find it optimal to buy in a down market (see Ross and Sofianos, 1998,
for evidence of such behavior). They do not prefer to wait and buy at a lower price, since by
waiting they may “miss” the capital gain at the recovery time, Tρ .
    There is a simple intuition for why the price has to fall during the crisis, even without the
arrival of further bad news. Dealers anticipate that, as they accumulate inventories, they will
take longer to unwind their asset positions. Thus, they have to be compensated by a larger
capital gain, implying that the price has to fall by more before the recovery time. Therefore,
search frictions create a price divergence similar to that of Kondor (2009), without putting
any limit on dealers’ capital.
    As will become clear in the next section, for some parameters ĀC
                                                                    d = 0, meaning that

dealers do not accumulate any inventories during the crisis. In such cases, we obtain the
dynamics illustrated in the right-panel of Figure 5.

Corollary 2 (Crisis and recovery dynamics when dealers do not provide liquidity). Suppose
ĀC
  d = 0. Then, dealers do not hold inventories during the crisis. At the time of the crisis,

t = 0, the price, p(t), jumps down and remains constant during the crisis. At the recovery
time, t = Tρ , the price jumps up to its steady-state level, ξ̄/r.



4    Implications

We first study how dealers’ incentives to provide liquidity are influenced by the two key OTC
market frictions: i) the fact that locating counterparties for trade is time-consuming, ii) and
prices are determined through bargaining. These frictions are captured by α and η. In some
instances, e.g., the frictionless case α = ∞, it is clear that dealers’ liquidity provision does
not improve welfare and dealers do not provide liquidity in equilibrium. However, our model


                                                18
                       When ĀC
                              d >0                                                  When ĀC
                                                                                           d =0



             p(t)                                                        p(t)




                                                       t                                                  t


             Ad (t)                                                      Ad (t)




       0                                               t        0                                         t
                      random recovery, Tρ                                           random recovery, Tρ




Figure 5: The price and inventory paths when dealers provide liquidity (left panel) and when
they don’t (right panel).


shows that, in other cases, dealers may fail to provide liquidity when it would be socially
optimal for them to do so. In Section 4.3, we discuss various policy interventions that may be
put in place to mitigate a socially inefficient failure of dealers to provide liquidity to investors.

4.1        Dealers’ incentives to provide liquidity

We will assume from now on that investors have an isoelastic utility function u (a) = a1−σ /(1−
σ) with σ > 0, and that the idiosyncratic preference shock is multiplicative, i.e., ui (a) = εi u (a)
with εi ∈ {ε1 , ..., εI }.8 In that case, we know from Lemma 2 that, after the recovery, investors’
equivalent utility flow is Ui (a) = ε̄i a1−σ /(1 − σ), where
                                                                    PI
                                                    (r + κ)εi + δ    j=1 εj
                                            ε̄i =                               .                             (25)
                                                           r+κ+δ
   8
    In Lagos, Rocheteau, and Weill (2007) we generalize some results (e.g., the condition under which dealers
accumulate asset inventories) for arbitrary utility functions.




                                                           19
Similarly, Lemma 4 shows that, during the crisis, UiC (a) = ε̄C  1−σ /(1 − σ), where:
                                                              i a

                                              PI
                         (r + κ + ρ)εC
                                     i +δ
                                                           C
                                                  j=1 π j εj                                       (r + κ)θεi + ρε̄i
               ε̄C
                 i   =                                               and           εC
                                                                                    i =                              .     (26)
                                  r+κ+ρ+δ                                                             r+κ+ρ

This functional form allows us to derive a simple condition on exogenous parameters under
which dealers provide no liquidity.

4.1.1    A simple condition for no liquidity provision

From Lemma 3, dealers find it strictly optimal to provide no liquidity if and only if:

                                                                            C
               ρ p(t | t) − pC (t) + ṗC (t)       ρ ξ(t | t) − ξ C (t) + ξ̇ (t)
                                                                    
                                             < r ⇔                               < r + κ.                                  (27)
                           pC (t)                              ξ C (t)

In words, the condition specifies that the expected return of purchasing the asset at time t
and re-selling it at time t + dt (the left side of (27)) must be less than the rate at which dealers
can borrow funds (the right side of (27)).
    Note that, if (27) holds, then dealers’ aggregate inventory position is equal to zero during
                                                                         C
the crisis, AC         C
             d (t) = Ȧd (t) = 0. Together with (24), this implies that ξ (t) is constant and
           C
equal to ξ̄ 0 , solving

                     I                                                                     I
                                                                                                                  !σ
                     X                 
                                          C                          C
                                                                                           X                σ1
                           π i UiC ′−1 ξ̄ 0 = A     ⇐⇒            ξ̄ 0   = A−σ                     π i ε̄C
                                                                                                         i             ,   (28)
                     i=1                                                                   i=1


given our functional form UiC (a) = ε̄C  1−σ /(1 − σ). At time of the random-recovery shock,
                                      i a

the economy jumps to its long-run steady state, which under our functional form is:

                                                           I
                                                                                  !σ
                                                           X                  1
                                                  −σ
                                          ξ̄ = A                 π i (ε̄i )   σ        .                                   (29)
                                                           i=1

Taken together, (27), (28) and (29) imply

Proposition 3. Assume ui (a) = εi a1−σ /(1 − σ). Then, dealers find it strictly optimal to
provide no liquidity during the crisis if and only if
                                     PI           C σ
                                                     1                                1
                                       i=1 π i ε̄i
                                                                 
                                                                       ρ                   σ

                                                       1   >                                   .                           (30)
                                      PI                             r+κ+ρ
                                        i=1 π i (ε̄i )
                                                       σ



Sufficient conditions for (30) to hold are: i) α approaches infinity; ii) r + κ = r + α(1 − η)
approaches zero.


                                                            20
   Condition (30), under which dealers choose not to provide liquidity, depends on investors’
preferences, the characteristics of the crisis, and the structure of the market. Focusing on
the key OTC trading frictions, the main insight of Proposition 3 is that dealers’ incentives to
accumulate asset inventories vary in a non-monotonic fashion with the extent of the trading
frictions: if κ = α(1 − η) is very large or very low, then dealers do not intervene to mitigate
the selling pressures.
   To see why this should be so, consider first the case where α goes to infinity (which implies
that κ goes to infinity as long as η < 1) and the economy approaches the frictionless Walrasian
benchmark. In this case, both dealers and investors are able to trade the asset continuously
over time, but dealers get no direct (marginal) utility from holding the asset, while investors
do. As a consequence, there are no private or social gains from having dealers hold asset
inventories. It is not surprising, then, that dealers provide no liquidity when trading frictions
are small.
   Consider next the case where α approaches zero, implying that it takes a long time for
investors to locate counterparties. Dealers, in contrast, can trade continuously. One might
conjecture that this market timing advantage over investors would give dealers a strong in-
centive to provide liquidity: they could accumulate assets during the market crash and resell
them very quickly to the most eager asset holders when the economy recovers. This would
allow them to reap the intertemporal gains from trade implied by variations in asset demands
before and after the crisis. Our analysis reveals that this intuition is misleading because the
gains from these intertemporal trades vanish when trading frictions are large. Indeed, when α
is very low, investors who have the opportunity to readjust their asset holdings anticipate that
they will be holding their assets for a long period of time (since the average holding period of
the asset is 1/α). As a consequence, investors choose asset positions based on their average
marginal utility for the asset instead of their current marginal utility. Formally, investors’
effective preference shocks, ε̄C
                               i and ε̄i , both converge towards ε̄ as r + κ goes to zero. Since

all investors enjoy approximately the same expected marginal utility from holding the asset
between two consecutive contacts with dealers, they find it optimal to hold approximately the
same position. Clearly, this implies that there are very small gains to be had from reallocating
the asset between two investors before and after the crisis, and dealers cannot reap many ben-
efits from their ability to reallocate the asset faster than investors over time. Put differently,
in markets with very severe trading frictions, investors do not demand much liquidity from
dealers, thereby reducing dealers’ incentive to provide liquidity.

                                               21
4.1.2   A numerical example

So far, we have shown that if we consider a spectrum of asset markets going from very liquid to
very illiquid markets, dealers do not provide liquidity at either end of the spectrum. We now
show, by way of a numerical example, that there are parameterizations for which condition
(30) is not satisfied for intermediate values of α. That is, in OTC markets where trading
frictions are neither too mild nor too severe, dealers find it optimal to provide liquidity. The
green shaded regions in Figure 6 represent parameter values for which dealers find it optimal
to provide liquidity in times of crisis. In each panel, we let the two parameters in the axes
vary and keep the rest fixed at some benchmark values. All panels have the extent of the
search friction, α, on the horizontal axis.

                   0.03                                       1

               0.025                                         0.8
                   0.02
                                                             0.6
           θ   0.015                                     ρ
                                                             0.4
                   0.01

               0.005                                         0.2

                     0                                        0
                          0.5     1     1.5         2                    0.5     1     1.5   2
                                 α                                               α

                     1

                    0.8

                    0.6
               η
                    0.4

                    0.2

                     0
                          0.2   0.4   0.6     0.8        1         1.2     1.4   1.6   1.8   2
                                                         α


Figure 6: Parameterizations for which dealers provide liquidity. The benchmark parametriza-
tion is: σ = 0.5, r = 0.05, π 1 = π 2 = 0.5, α = 0.5, δ = 1, ρ = 0.3, θ = 0.02, η = 0, and
A = 1.

   The first and second panels of Figure 6 relate liquidity provision to the characteristics of the
crisis, θ and ρ. They show that dealers are more likely to accumulate asset inventories when
the market crash is severe (θ is low) and expected to be short-lived (ρ is large). Intuitively, if
the crash is very sharp, then there are large gains from reallocating the asset from investors
during the crisis to the investors once the recovery has occurred. Moreover, if the crisis is

                                                    22
expected to be short-lived, then the opportunity cost from having dealers holding the asset
instead of investors is small.
       In order to interpret the lower panel of Figure 6, it is useful to remember that the condition
in Proposition 3 depends on κ = α(1 − η), the effective degree of frictions in the economy, but
not on α and η individually. So an increase in dealers’ bargaining power produces the same
effects in terms of liquidity provision as a reduction in α. In particular, if α is very large,
then κ varies from 0 to a large number as η varies from 1 to 0. From Proposition 3, if agents
are sufficiently patient, it then follows that dealers will not provide liquidity if either dealers
have very little argaining power (η is close to zero) or if they have a great deal of bargaining
power (η is close to one).

4.2       Liquidity provision and welfare

Next, we turn to the normative implications of the model. We seek to identify circumstances
under which dealers do not provide liquidity even though, from a benevolent planner’s view-
point, there would be social gains from having them hold inventories.
       With no loss of generality we can measure social welfare as the sum of the utilities of
investors and dealers.9 Also, we can omit the utility of investors before their first contact
with the market. The welfare criterion takes then the simple form

                                     I                                     I
                       "Z                                                                              #
                                Tρ             ˆε̄C u(aC                  ∞X        ˆε̄i u(ai (t)) −rt
                                                       i (t)) −rt
                                     X                                Z
             WC = E                        απ i i            e dt +            απ i               e dt ,
                            0                       r+α               Tρ i=1             r+α
                                     i=1

where Tρ is the random time at which the economy recovers, α is the flow of investors in
contact with dealers at time t, and π i is the fraction of investors of type i among all these
investors. The preference shocks ˆε̄i and ˆε̄C
                                             i are obtained by setting η = 0 in the expressions

(25) and (26) for ε̄i and ε̄C
                            i .

       In the planner’s objective, the utilities ˆε̄C    C                  ˆ
                                                    i u(ai (t))/(r + α) and ε̄i u(ai (t))/(r + α) represent

the “true” expected discounted utilities of an investor at time t until his next contact with the
market, before and after the recovery, respectively. Crucially, these differ from the utilities
that an individual investor uses to calculate his optimal asset holding. Indeed, an investor
anticipates that he always loses a fraction of the gains from trading with dealers. The planner,
on the other hand, takes into account that the gains from trade lost by the investors are, in
   9
     Because agents have quasilinear utility, maximizing this criterion subject to search frictions will charac-
terize all constrained-optimal Pareto asset allocations, i.e., all feasible asset allocations that cannot be Pareto
improved by choosing another feasible allocation and making time-zero transfers of the numéraire good.



                                                            23
fact, enjoyed by dealers.
   The planner maximizes the above objective by choosing the asset holdings {ai (t)}Ii=1 of
those investors contacting the market at time t and the asset holdings Ad (t) of dealers. The
allocation chosen by the planner must be, of course, feasible given the search frictions. One
easily shows that this constraint leads to the ODE:
                                                                            
                                                            I
                                                             X               
                            Ȧd (t) = α       A − Ad (t) −         π j aj (t) ,
                                                                            
                                                             j=1


which is, unsurprisingly, the same as the ODE governing market clearing in the equilibrium.
Analyzing the planner’s control problem we obtain the following result.

Proposition 4. The equilibrium is socially efficient if and only if η = 0. It is strictly socially
optimal that dealers provide no liquidity if and only if
                               PI                1             1
                                i=1 π i
                                           ˆε̄C   σ
                                                     
                                               i          ρ      σ

                               PI                1 ≥ r + κ + ρ    .                         (31)
                                 i=1 π i
                                             ˆε̄i σ

   The proposition shows that, in markets where dealers have the ability to extract some rent
from their trades with investors, the choice of asset holdings is distorted: investors choose
asset positions that reduce the transaction fees they will have to pay in the future when they
will have to readjust their asset holdings.
   Next, we provide a condition where the lack of liquidity provision is socially inefficient for
limiting economies in which agents are infinitely patient (r → 0).

Corollary 5. Consider an economy such that (31) does not hold as r → 0. Then there is
some η̄ < 1 such that for all η > η̄, dealers do not hold any inventories even though the
planner’s allocation would require them to do so.

   The corollary starts from an economy with r = 0, where it is socially optimal to have
dealers provide liquidity. Then, as η approaches one, the effective trading rate, κ, approaches
zero. It then immediately follows from Proposition 3 that, if η is sufficiently high, then in
equilibrium dealers won’t provide any liquidity. While Proposition 5 assumes r → 0, the
lower panel of Figure 6 shows numerical examples of economies with r > 0 where dealers
underprovide liquidity.




                                                   24
4.3     Policy implications

What are the policy responses to insufficient liquidity provision?

4.3.1    Capital injections

By assumption, our dealers have “deep pockets,” i.e., they have enough capital to buy any
quantity of assets. It follows from this assumption that supplying more capital to dealers
will prove ineffective: in the model, if a policy-maker makes a lump-sum transfer of the
numéraire good to dealers, they will hoard it instead of using it to purchase assets from
outside investors. Such a capital injection is ineffective because, as revealed by Corollary 5,
the root of the problem is not a credit market imperfection, but the very structure of OTC
markets: the fact that dealers are able to extract some rents from their trades with investors.
    This is not to say that credit market imperfections do not matter. We have seen in Figure
6 that there are parameter values for which dealers will provide liquidity to investors (the
green region). If dealers face a capital constraint, and if η is close to 0, then capital injections
would be welfare improving for such parameter values. Our main insight is that this policy
response is ineffective if the lack of liquidity provision comes from OTC market frictions rather
than from capital constraints.

4.3.2    Market structure

Our model suggests that market reforms that facilitate trades (increase α) and erode dealers’
market power (reduce η) would increase the market allocative efficiency. For instance, Eu-
ronext reduced dealers’ market power by requiring its Designated Market Markers to commit
to a minimum spread (see Menkveld and Wang, 2009).
    In practice, the trading frictions can be reduced in several ways. The regulator can promote
standardization of the assets traded in OTC markets, disclosure of information regarding the
assets’ characteristics, and the development of electronic trading platforms that facilitate and
speed up trades. The regulator can also maintain market liquidity by offering safer and more
recognizable collateral, which may reduce counterparty risk,10 and by preventing the failure
of large dealers-brokers.
  10
     The adverse selection problems induced by unobserved counterparty risk may worsen search frictions: for
instance, Hopenhayn and Werner (1996) show how information problems in bilateral meetings may reduce the
probability of a trade.




                                                    25
4.3.3      Government asset purchases in OTC markets

OTC markets may be organized in a decentralized fashion for efficiency reasons. For instance,
in credit derivative markets, the search friction may be the unavoidable consequence of in-
vestors’ desire to enter into finely customized contracts. Similarly, the bargaining power of
dealers may be required to cover ex-ante entry costs in the market.11
       In what follows we propose a policy exercise that does not require taking a stand on
these questions. We take the point of view of a government at the beginning of a severe crisis,
which takes the OTC market structure as given. Since capital injections are ineffective, we ask
whether there is room for the government to step into the interdealer market and accumulate
assets on its own account, effectively acting as a “liquidity provider of last resort.” Note that,
even though Proposition 4 showed that the socially optimal allocation prescribes that dealers
hold inventories, it is a priori not obvious that the provision of liquidity by the government
would be welfare-improving. Indeed, while the planner is only constrained by the search
frictions, as measured by α, the government is also constrained by η, i.e., it takes as given the
fact that, in an equilibrium, investors’ asset positions will remain distorted by the positive
bargaining power of dealers.
       We carry out the policy experiment in an economy where dealers find it strictly optimal
to provide no liquidity. We ask whether a benevolent government would find it worthwhile
to conduct the following small asset purchase in the interdealer market. During the crisis,
t ∈ [0, Tρ ), the government purchases asset inventories AC               −αt for some small
                                                                             
                                                          g (t) = ωA 1 − e

ω. At the time of the recovery, the government sells its assets so that the market price grows
at rate r. The purchases are financed via lump-sum taxes. As will become clear, we can pick
ω small enough so that, in an equilibrium where the government follows this trading strategy,
dealers still find it optimal to provide no liquidity.
       Notice first that, during the crisis:


                                          αAC         C
                                            g (t) + Ȧg (t) = αωA


remains constant. It follows from the market-clearing condition (24) that during the crisis,
  11
     See, e.g., Duffie, Gârleanu, and Pedersen (2005) for a model where dealers choose their search intensity,
Lagos and Rocheteau (2009) for a model where the contact rate between dealers and investors is endogeneized
by free entry of dealers, and Mı́nguez Afonso (2008) for where it is endogenized by the free entry of investors.
It is difficult to study dealers’ liquidity provision in these models, because it requires analyzing their out-of-
steady-state dynamics. Out of the steady state, entry depends on the entire distribution of investors’ states
(preference types and asset holdings), which determines their expected profits, and investors’ asset holdings
depend on the expected entry of dealers over time.


                                                       26
the effective cost of holding the asset, ξ C , that clears the market is also constant and solves

                   I                     − σ1
                                   ξC
                               
                                                                                               C
                   X
                          πi                     = A(1 − ω)          ⇐⇒     ξ C = (1 − ω)−σ ξ̄ 0 ,
                    i=1
                                   ε̄C
                                     i

        C
where ξ̄ 0 is the effective cost of holding the asset in the absence of government intervention.
Consider next what happens at the onset of the recovery. The government sells its asset at a
speed that guarantees that the price grows at the discount rate, r. Or, equivalently:


                                                 ξ(t | Tρ ) = e−(r+κ)(T −t) ξ̄,


where T is the time at which the government’s asset inventories are depleted. The corre-
sponding government inventories, Ag (t | Tρ ), follows directly after plugging ξ(t | Tρ ) into the
market clearing condition, holding dealers’ inventories equal to zero. Note that an equivalent
strategy would be for the government to sell all its inventories to dealers at time Tρ , and let
dealers trade afterwards. Our main result is:

Proposition 6 (Welfare impact of a direct asset purchase). Consider an economy such that
condition (30) holds, and let ∆W(ω) denote the change in social welfare induced by a direct
asset purchase of size ω. Then,

                                       ∆W(ω)
                                   lim       = −(r + α)µC + ρ(µ − µC ),                                           (32)
                                   ω→0  ω

where µC =           ˆC ′ C C                                   π iˆε̄i u′ (ai )ai , while aC
             P                                           P
                i π i ε̄i u (ai )ai ,       and µ =         i                               i and ai are the investor’s

asset holdings without government intervention, during the crisis and during the recovery.

   The proposition shows that, in order to evaluate the welfare impact of its outright purchase,
the government uses the “true” undistorted preference shocks, ˆε̄i and ˆε̄C
                                                                          i , instead of the

distorted ones, ε̄i and ε̄C
                          i , used by investors. The proposition also reveals the manner in

which the government is constrained by the market structure: welfare is evaluated at the
margins implied by the distorted asset holdings, aC
                                                  i and ai , chosen by investors when they

bargain with dealers.
   The two terms in (32) show the tradeoff faced by the government. The first term captures
the foregone utility from having the government hold assets instead of investors. The second
term represents the welfare gain from reallocating the assets from investors during the crash
to investors during the recovery. Numerical calculations, shown in Figure 7, suggest that, for


                                                                27
some parameters, we can have:
                                                        
                                         C             C
                              −(r + κ)ξ̄ 0 + ρ ξ̄ − ξ̄ 0   < 0,

                              −(r + α)µC + ρ µ − µC > 0.
                                                         


That is, it can be the case that the government finds it optimal to hold inventories, notwith-
standing investors’ distorted asset positions, and at the same time dealers do not – which
implies that the government makes negative expected profit from this trade. So our model
predicts that direct purchases of assets by the government can raise society’s welfare when
there is insufficient liquidity provision. Moreover, in our model, these government purchases
do not substitute for capital injections to dealers. Direct purchases are socially beneficial
because of the trading frictions distorting dealers’ incentives to provide liquidity in OTC
markets.
    This policy experiment shows that, in some circumstances, there exists a welfare-improving
policy intervention with the following features: it is small, it does not stimulate dealers’
inventory accumulation, and the government makes negative expected profit. But one should
bear in mind that an optimal policy intervention would not necessarily share these features.
Characterizing the optimal policy would require setting up and solving the Ramsey problem,
a question that we leave open for future work.


5    Conclusion

We have developed a model where several of the policy discussions surrounding the recent
financial crisis can be analyzed. For instance, our model suggests circumstances in which the
provision of funds to OTC market dealers might prove ineffective. This could help explain
why most of the auctions from the Term Securities Lending Facility–a facility introduced
by the Federal Reserve to allow primary dealers to borrow Treasury securities against less
liquid collateral–were undersubscribed (e.g. Cecchetti, 2008). Our model also shows that
direct purchases of assets by the government can improve the market allocative efficiency.
The Federal Reserve’s decision to purchase up to $1.25 trillion of mortgage-backed securities,
starting in March 2009, is an example of a policy in this spirit. Lastly, our analysis of market
structure bears on the recommendations of the Group of Thirty in their 2009 Framework
for Financial Stability, and Bernanke (2009b), to strengthen the financial infrastructure that
supports OTC derivatives markets.


                                              28
             0.03                                       1

                                                       0.8
             0.02
                                                       0.6
     θ                                            ρ
                                                       0.4
             0.01
                                                       0.2

               0                                        0
                    0.5    1      1.5         2                    0.5    1     1.5   2
                           α                                              α

               1

              0.8

              0.6
         η
              0.4

              0.2

               0
                    0.2   0.4   0.6     0.8        1         1.2    1.4   1.6   1.8   2
                                                   α



Figure 7: Parameterizations for which the government find it strictly optimal to provide
liquidity but dealers don’t. The benchmark parametrization is: σ = 0.5, r = 0.05, π 1 = π 2 =
0.5, α = 0.5, δ = 1, ρ = 0.3, θ = 0.02, η = 0.5, and A = 1.




                                                  29
A         Proofs
A.1           Proof of Lemma 1
First, we substitute the constraint ȧd (s) = q(s) into the dealers objective and integrate by part:
      Z       T                                                          Z       T
                  e−r(s−t) p(s)ȧd (s) ds = ad (t)p(t) +                             e−r(s−t) [ṗ(s) − rp(s)] ad (s) ds − ad (T )p(T )e−r(T −t).
          t                                                                  t

Keeping in mind that ad (t) = a, letting T → ∞ and using the no-bubble condition, we find that the value of
the inventory path ad (s) is:
                                         Z ∞
                              p(t)a(t) +     e−r(s−t) [ṗ(s) − rp(s)] ad (s) ds.
                                                                    t

Clearly, the condition of the Lemma is sufficient. For necessity, note that if there was some time s > 0 such
that ṗ(s) − rp(s) > 0, then a dealer could improve her utility by accumulating more inventory around s, and
the dealer’s problem would not have any bounded solution.


A.2           Proof of Lemma 2 and Lemma 4
A.2.1              Preliminary Results
We let the random flow utility of an investor at time t be u(a, t), where we use the time argument “t ” as a
short-hand for the investor’s current idiosyncratic and aggregate preference shock. To simplify notations, we
measure time from the point of a given contact with a dealer. We let 0 = T0 < T1 < T2 < . . . be the sequence
of the investor’s contact times with dealers, Nt be the number of contact times during [0, t], and θt be the last
contact time before t. Then, for any asset plan, a, we calculate the inter-temporal utility over [0, t]:
                                            Z       t                                      Nt
                                                                                           X
                                V0t (a) ≡               u[a(s), s]e−rs ds −                      p(Tn )e−rTn [a(Tn ) − a(Tn−1 )] ,
                                                0                                          n=1

along a realization of the contact time and type processes. This utility can be decomposed as

                                        V0t = U0t − B0t + p(T1 )e−rT1 a(0) − p(θt )a(θt )e−rθt ,

where
                                                            Z       t
                                     U0t (a)            =               u [a(s), s] e−rs ds,
                                                                0
                                                            N
                                                            Xt −1              h                             i
                                     B0t (a)            =                a(Tn ) p(Tn )e−rTn − p(Tn+1 )e−rTn+1 .
                                                             n=1


We consider portfolio plans a that are bounded, and such that the intertemporal utility E [V0∞ (a)] is well
defined. We first establish:


Lemma 5. As t → ∞, E U0t (a) and E B0t (a) converge to finite limits, and E p(θt )e−rθt a(θt ) converges to
                                                                                         
zero.

    Because of the no-bubble condition limt→∞ p(t)e−rt = 0 and the fact that a(t) is bounded,       we have that
limt→∞ p(t)a(t)e−rt = 0. Since θt goes to infinity almost surely, it follows that limt→ E p(θt )e−rθt a(θt ) = 0
                                                                                           
as well.
    Let’s turn to with E U0t (a) . When the investor’s utility is bounded below, then the result follows from
                               
the assumption that the portfolio plan, a, is bounded. When the investor’s utility is unbounded below and
bounded above, we can assume without loss of generality that it is negative. Then E[U0t ] is decreasing and
thus converges either to some finite or some infinite limit. The limit, in turn, must be finite because

                         E[U0t ] = E[V0t ] + E[B0t ] − E[p(T1 )e−rT1 a(0)] ≥ E[V0t ] − E[p(T1 )e−rT1 a(0)],

where the inequality follows because p(t)e−rt is decreasing and B0t is therefore positive. Because E[V0∞ ] is well
defined, the right-hand side of the inequality is bounded below, implying that E[U0t ] has a finite limit. It then


                                                                                           30
immediately follows that

                        E B0t = −E V0t + E U0t + E[p(T1 )e−rT1 a(0)] − p(θt )e−rθt a(θt ).
                                       

also converges to some finite limit.

Lemma 6. An investor’s intertemporal utility is
                                         "∞                                         #
                        ∞           −1
                                           X −rT
                                                  n
                   E [V0 ] = (r + κ) E          e   {U [a(Tn ), Tn ] − ξ(Tn )a(Tn )} .                                                           (33)
                                                                  n=1

where
                                                                                 Tn+1
                                                                            Z                                               
                         U [a(Tn ), Tn ]                 =     (r + κ)E                 u [a(s), s] e−r(s−Tn ) ds Tn
                                                                                 Tn
                                                                             h                     i
                                      ξ(Tn )             =     p(Tn ) − E p(Tn+1 )e−r(Tn+1 −Tn ) Tn .

    To show that result, write
                                                     "   ∞                                                                  #
                                                         X
                        E [B0∞ ]          =      E             a(Tn )E p(Tn )e        −rTn
                                                                                              − p(Tn+1 )e    −rTn+1
                                                                                                                       Tn
                                                         n=1
                                                                       ∞
                                                                   "                               #
                                                                       X
                                          =      (r + κ)−1 E                 a(Tn )ξ(Tn )e−rTn ,
                                                                       n=1


by definition of ξ(Tn ). In addition note that, when u is bounded below, we can without loss of generality
assume that it is positive, and we have

                                 u[a(s), s]e−rs I{s≤θt } ≤ u[a(s), s]e−rs I{s≤t} ≤ u[a(s), s],

and u[a(s), s]I{s≤θ t } ր u[a(s), s] as t goes to infinity. The same reasoning go through with opposite inequalities
when u is negative. Therefore, an application of the dominated convergence theorem implies that
                                                                                                "N −1 Z                                      #
                                           Z       θt                                          Xt         Tn+1
             E [U0∞ ]   =        lim E                   u(a(s), s)e   −rs
                                                                             ds = lim E                            u(a(s), s)e    −rs
                                                                                                                                        ds
                                t→∞             0                                      t→∞                  Tn
                                                                                                  n=1
                                                         ∞
                                                     "                                    #
                                                         X
                        =       (r + κ)−1 E                    e−rTn U (a(Tn ), Tn ) ,
                                                         n=1

where the last equality follows by taking expectations of each term in the sum with respect to Tn .


A.2.2     Necessary and sufficient condition
For the “only if” part of the two Lemma, it is clear from (33) that an optimal portfolio strategy should
maximize each term U [a(Tn ), Tn ] − ξ(Tn )a(Tn ), implying the investor’s first-order condition. For the “if” part,
we consider a plan a that satisfies the first-order conditions and compare it to some other plan a′ . We find

                        E[V0∞ (a) − V0∞ (a′ )]
                          "∞                                                                          #
                           X −rT                            ′                               ′      
                                    n
                   =    E      e      U (a(Tn ), Tn ) − U (a (Tn ), Tn ) − ξ(Tn ) a(Tn ) − a (Tn )
                                n=1
                                ∞
                            "                                                                                 #
                                X         −rTn                                                          ′
                   ≥    E             e              Ua (a(Tn ), Tn ) − ξ(Tn )               a(Tn ) − a (Tn )         ≥ 0,
                                n=1

where the first inequality follows because of concavity, and the second inequality follows because of the first-
order condition in the two Lemma.




                                                                                 31
A.2.3      The expression for Ui (a) and ξ(t) along the recovery path
The flow inter-contact time utility is (r + κ)−1 U [a(Tn ), Tn ] = (r + κ)−1 Ui(Tn ) [a(Tn )], where Ui (a) is defined
in equation (8) of the lemma. To see why, let
                                             "Z                                 #
                                                                         T̃
                                      Ṽi (a, t) = Ei                         e−rs uk(t+s) (a′ ) ds k(t) = i .
                                                                     0


By the Markovian nature of the process k(t), Ṽi (a, t) only depends on t through the condition k(t) = i
which is already captured by the subscript i. Therefore, hereafter we will slightly abuse notation and write
Ṽi (a) for Ṽi (a, t). Denote T̂ the length of the period of time before the investor receives a preference shock.
By definition, T̂ is exponentially distributed with mean 1/δ. The value of an investor can then be written
recursively as follows,                   "Z                                         #
                                                       T̃ ∧T̂
                                Ṽi (a) = E                      e−rs ui (a)ds + I{T̂ <T̃ } e−rT̂ Ṽk(T̂ ) (a) ,               (34)
                                                   0

where k(T̂ ) indicates the new realization of the preference shock at time T̂ . Using the fact that T̃ and T̂ are
independent random variables, one can rewrite the first term on the right-hand side of (34) as
          "Z                         #
               T̃ ∧T̂                      Z ∞                                     Z ∞ h            i
                        −rs
       E              e     ui (a)ds   = E      I{s≤T̃ ∧T̂ } e−rs ui (a) ds = ui (a)    E I{s≤T̃ ∧T̂ } e−rs ds
             0                                           0                                                   0
                                                             Z       ∞
                                                                                          ui (a)
                                         =       ui (a)                  e−(r+κ+δ)s ds =         .                             (35)
                                                                 0                       r+κ+δ

The second equality follows because ui (a) is constant over the interval of integration, and by interchanging
the integral and expectation sign. The third equality follows because T̃ and T̂ are independent exponential
random variables with respective parameter κ and δ: thus T̃ ∧ T̂ is exponential as well with parameter κ + δ.
    Turning to the second term in (34), we first note that the realizations of the preference shocks are in-
dependent and identically distributed according to πi . Thus, the distribution of k(T̂ ) is given by {π i }Ii=1 .
Therefore,
                                                                                  I                           I
              h                              i                h                 iX                     δ     X
             E I{T̂ <T̃ } e−rT̂ Ṽk(T̂ ) (a)      =          E I{T̂ <T̃ } e−rT̂      π k Ṽk (a) =               πk Ṽk (a).   (36)
                                                                                 k=1
                                                                                                   δ + r + κ k=1

Adding (35)and (36), one finds

                                                                             I
                                                         ui (a)       δ     X
                                         Ṽi (a) =              +               π k Ṽk (a),                                   (37)
                                                        r+κ+δ     r + κ + δ k=1

for all i ∈ {1, . . . , I}. One then easily verifies that this system of equation is solved by

                                                                                       Ui (a)
                                                                     Ṽi (a) =                ,                                (38)
                                                                                       r+κ

where Ui (a) is as in (8).
    To derive expression (9), just note that the expected discounted price at the time the investor regains
direct access to the asset market is:
                                                         Z ∞
                                 E[e−rT̃ p(t + T̃ )] = κ     e−(r+κ)s p(t + s)ds.                      (39)
                                                                                   0




                                                                                  32
A.2.4       The expression for Ui (a) and ξ(t) during the crisis
We let
                             "Z                                                                    #
                                      T̃
      ṼiC (a)                             e−rs θ + (1 − θ)I{s≥Tρ } ui (a) ds
                                                                   
                 =       E
                                  0
                             "Z                                         #
                                      T̃ ∧T̂ ∧Tρ                           h                                  i   h                              i
                                                       −rs
                 =       E                         e         θui (a) ds + E I{T̂ <T̃ ∧Tρ } e−rT̂ Ṽk(
                                                                                                    C
                                                                                                      T̂ ) (a) + E I{Tρ <T̃ ∧T̂ } e
                                                                                                                                    −rTρ
                                                                                                                                         Ṽi (a)
                                  0

                                                    I
                           θui (a)         δ       X                ρ
                 =                 +                  Ṽ C (a) +         Ṽi (a)
                         r+κ+δ+ρ     r + κ + δ + ρ j=1 j         r+κ+δ+ρ
                                                             I
                         θui (a) + ρṼi (a)         δ       X
                 =                          +                   ṼjC (a).
                          r+κ+δ+ρ             r + κ + δ + ρ j=1

where the second last equality follows from the exact same calculation as for Ṽi (a) in the previous paragraph.
One sees that this is exactly the same equation as (37), except that ui (a) is replaced by θui (a) + ρṼi (a) and κ
is replaced by κ + ρ. Thus the result of the last section applies and we have that:
                                                                                             
                                     (r + κ + ρ) θui (a) + ρṼi (a) + δ Ij=1 θuj (a) + ρṼj (a)
                                                                       P
                              C
                (r + κ + ρ)Ṽi (a) =
                                                            r+κ+ρ+δ

Letting UiC (a) = (r + κ)ṼiC (a), we have

                           r+κ
       UiC (a)   =              (r + κ + ρ)ṼiC (a)
                          r+κ+ρ
                                                                       PI                       
                           r+κ  (r + κ + ρ)   θu i (a) + ρṼ i (a)   + δ  j=1 θuj (a) + ρ Ṽ j (a)
                 =
                          r+κ+ρ                                                           r+κ+ρ+δ
                                                   h                                          i             h                                               i
                                                        r+κ                   ρ
                                                                                                + δ Ij=1 π j r+κ+ρ
                                                                                                              r+κ                                ρ
                                                                                                   P
                          (r + κ + ρ)                  r+κ+ρ
                                                             θui (a)    +        U (a)
                                                                            r+κ+ρ i
                                                                                                                   θuj (a) +                        U (a)
                                                                                                                                               r+κ+ρ j
                 =                                                                                                                                              ,
                                                                                               r+κ+ρ+δ

keeping in mind that UiC (a) = (r + κ)Ṽi (a). This is the formula stated in the Lemma.
    To derive the expected value of the re-sale price, we use the fact that T̃ − t and Tρ − t are two independent
exponentially distributed random variables:
                                    h            h                                            ii
                                  E e−r(T̃ −t) I{T̃ <Tρ } pC (T̃ ) + I(T̃ ≥Tρ ) p(T̃ | Tρ ) =
           Z ∞Z ∞                 h                                                 i
                     e−r(τ κ −t) I{τ κ <τ ρ } pC (τ κ ) + I{τ κ ≥τ ρ } p(τ κ | τ ρ ) κe−κ(τ κ −t) ρe−ρ(τ ρ −t) dτ ρ dτ κ
             t    t
                 Z ∞                                      Z τκ                               
                       −r(τ κ −t)     −ρ(τ κ −t) C                    −ρ(τ ρ −t)
               =     e              e           p (τ κ ) +       ρe              p(τ κ | τ ρ ) κe−κ(τ κ −t) dτ ρ dτ κ .
                     t                                                                    t


A.3       Proof of Proposition 1
Suppose Ad (t) > 0 for some t ≥ Tρ . Let T = inf{s ≥ t : Ad (s) = 0}. Since Ad (s) is continuous, we have
Ad (T ) = 0 and so T > t. Now for s ∈ [t, T ), Ad (s) > 0 so Ad (s) and ξ(s) solve the system of ODEs given by
(13) and

                                                                      ξ̇(s)       =            (r + κ)ξ(s).

Integrating the second ODE gives ξ(s) = ξ(t)e(r+κ)(s−t) . Plugging this back into the first ODE, (13), gives:

                                                                                                                 I
                                                                                                        "                              #
                                                                              Z       s                          X
                                                   −α(s−t)                                    −α(s−u)
                              Ad (s) = e                        Ad (t) + α                e                 A−         πi Ui′−1   [ξ(u)] du.                        (40)
                                                                                  t                              i=1

Equipped with this equation, we first prove:

Lemma 7. If, for some t ≥ Tρ , Ad (t) > 0, then ξ(t) < ξ̄ and Ȧd (t) < 0.


                                                                                              33
    Suppose to the contrary that there were some t ≥ Tρ such that Ad (t) > 0 and ξ(t) ≥ ξ̄. Then, the above
calculation show that ξ(u) ≥ ξ̄ for all u ∈ [t, T ), and therefore:

                                      I
                                      X                                        I
                                                                               X
                                            πi Ui′−1 [ξ(u)] ≥ A −                    πi Ui′−1 ξ̄ = 0.
                                                                                              
                                 A−
                                      i=1                                      i=1


It thus follow that Ad (s) > e−α(s−t) Ad (t). Since Ad (T ) = 0 we must have that T = ∞. But this means that
ξ̇(s) = (r + κ)ξ(s) for all s ≥ t and, because of equation (11), that rp(s) = ṗ(s) for all s ≥ t. But then the
only way the no-bubble condition holds is if p(t) = ξ(t) = 0, which is impossible given that ξ(t) ≥ ξ̄. That
Ȧd (t) < 0 follows from substituting ξ(t) < ξ̄ in ODE (13).
      We are now ready to solve for an equilibrium path. We start at Tρ with some positive inventory Ad (Tρ ) > 0.
Let T be the first time greater than Tρ such that Ad (T ) = 0. If T = ∞, then as before the no-bubble condition
would be violated. So T < ∞. Since Ad (t) > 0 for all t < T , it follows by Lemma 7 and the continuity of ξ(t)
that ξ(T ) ≤ ξ̄. But if ξ(T ) < ξ̄ then ODE (13) implies that Ȧd (T ) < 0. Moreover, since ξ(s) is continuous, it
follows from ODE (13) that Ad (t) is continuously differentiable. Thus, we must have that Ȧd (s) < 0 for some
s > T , which would violate the short-selling constraint. Therefore, ξ(T ) = ξ̄. Next, we show that Ad (s) = 0 for
all s ≥ T . Suppose to the contrary that there is some s > T such that Ad (s) > 0. Since Ad (t) is continuously
differentiable, we can apply Taylor Theorem and find some s′ ∈ [T, s] such that

                                                                Ad (s) − Ad (T )
                                            Ȧd (s′ ) =                          > 0.
                                                                     s−T

The contrapositive of Lemma 7 then implies that Ad (s′ ) = 0. Now, since Ad (s′ ) is continuously differentiable,
there must be some u > s′ such that Ad (u) > 0 and Ȧd (u) > 0, which contradicts Lemma 7. Thus Ad (s) = 0
for all s ≥ T . Plugging this back into equation (13), it follows that ξ(s) = ξ̄ for all s ≥ T .
     To solve for T , we plug ξ(t) = ξ̄e−(r+κ)(T −t) back into equation (40) and solve for the unique solution of
Ad (T ) = 0, given the initial condition Ad (Tρ ). That is, one has to solve the equation:
                                                                   Z    T            h                        i
                            0 = e−α(T −Tρ ) Ad (Tρ ) + α                    e−α(T −u) A − D(ξ̄e−(r+κ)(T −u) )
                                                                       Tρ
                                                Z       T              h                        i
                       ⇔    0 = Ad (Tρ ) + α                 e−α(Tρ −u) A − D(ξ̄e−(r+κ)(T −u) )
                                                    Tρ
                                                Z       ∆T       h                        i
                       ⇔    0 = Ad (Tρ ) + α                  eαs A − D(ξ̄e−(r+κ)(∆T −s) ) ,                      (41)
                                                    0

where
                                                                I
                                                                X
                                                D(ξ) ≡                 πi Ui′−1 [ξ(u)] ,                          (42)
                                                                 i=1

where the first equivalence follows from multiplying through by eα(T −Tρ ) , and the second one from the change
of variable ∆T ≡ T − Tρ and s = u − Tρ . Since the function D(ξ) is decreasing and since D(ξ̄e−(r+κ)(∆T −s) ) >
D(ξ̄) = A for all s < ∆T , it follows that the right-hand side of (41) is a strictly increasing function of Ad (Tρ )
and a strictly decreasing function of ∆T . Since Ad (Tρ ) > 0, it is clearly strictly positive at ∆T = 0. Moreover,
since D(ξ) is strictly decreasing and since A − D(ξ̄e−(r+κ)(∆T −s) is negative, we have
                                                Z       ∆T      h                         i
                                            α                eαs A − D(ξ̄e−(r+κ)(∆T −s) )
                                                    0
                                                Z       ∆T >ε
                                                           h                  i
                                      ≤     α          eαs A − D(ξ̄e−(r+κ)ε )
                                                0
                                                       h                   i
                                              α(∆T −ε)
                                      =     e            A − D(ξ̄e−(r+κ)ε ) → −∞,

as ∆T goes to infinity. Thus, equation (41) has a unique solution ∆T > 0 and an application of the implicit
function theorem shows that it strictly increasing in Ad (Tρ ) and twice continuously differentiable. Moreover,
it goes to infinity as Ad (Tρ ) goes to infinity. Indeed since it is a monotonic function, it must have a limit. This
limit can’t be finite: otherwise, the second term on the right-hand-side of (41) would go to some finite limit,
which is impossible since the first term goes to infinity and the two terms must sum to zero. From ∆T we
obtain the function ψ(Ad ) = ξ̄e−(r+κ)∆T . Therefore:




                                                                       34
Lemma 8. The function ψ(Ad ) is strictly decreasing, twice continuously differentiable, and goes to zero as Ad
goes to infinity.


A.4     Proof of Lemma 3
We proceed as in the Proof of Lemma 1, but for the integration by part we break the interval of integration in
two: [0, Tρ ∧ T ] and [Tρ ∧ T, T ]. After using the no-bubble condition, we find that the value of the inventory
path is:
                                               Z Tρ                               
                                ad (t)pC (t) +       e−r(s−t) ṗC (s) − rpC (s) aC     d (s) ds
                                               t                   
                                +e−r(Tρ −t) p(Tρ | Tρ ) − pC (t) aC    d (Tρ )
                                  Z ∞                                        
                                          −r(s−t)   ∂p
                                +       e              (t | Tρ ) − rp(t | Tρ ) ad (t |, Tρ ) ds.
                                    Tρ              ∂t

Taking expectations, ignoring the initial condition ad (t)pC (t) and the last term that only depends on the
inventory plan ad (Tρ , t) along the recovery path, we find that before Tρ the dealer chooses aC
                                                                                               d (s) in order to
maximize:
                                     Z ∞                                              
                                  Et      I{s≤Tρ } e−r(s−t) ṗC (s) − rpC (s) aCd (s) ds
                                       t
                                      h                                      i
                                  +Et e−r(Tρ −t) p(Tρ | Tρ ) − pC (t) aCd (Tρ ) .


Note that, in the first expectation, the only random variable is I{t≤Tρ } and its expectation is eρ(s−t) for each
s. Next, write the second expectation as an integral against the exponential density ρeρ(s−t) . After collecting
terms, we find that the dealer’s objective is:
                    Z ∞              h                                         i
                         e−(r+ρ)(s−t) ṗC (s) − rpC (s) + ρ p(Tρ , Tρ ) − pC (t) aCd (s) ds,
                    t

and we can apply the same argument as in Lemma 1.


A.5     Proof of Proposition 2
The system of ODE we seek to solve is:
                                     C
                                    ξ̇ (t)   =    (r + ρ + κ)ξ C (t) − ρψ(AC
                                                                           d (t))                            (43)
                                                    h                         i
                                   ȦC
                                     d (t)   =             C          C  C
                                                  α A − Ad (t) − D (ξ (t))                                   (44)

where DC (ξ) is defined as in equation (42) but based on UiC (a). Given Lemma 8 and under our maintained
regularity assumptions on the utility functions, we can apply standard existence and uniqueness Theorems for
ODEs (see, for example, Theorem 6.2.3 in Hubbard and West, 1995) given the initial condition AC        d (0) = 0
and ξ C (0) > 0. As it is standard with forward-looking rational expectations dynamics, the initial condition
ξ C (0) is found by arguing that the economy has to evolve along a saddle path of the dynamic system (43)-(44).
Precisely, we establish two results: in Section A.5.1, we show that there exists a unique saddle path extending
                          C                                                  C
from the steady state (ξ̄ , ĀC                              C
                              d ) to some initial condition Ad (0) = 0 and ξ̄ (0) > 0. Second, in Section A.5.2,
we argue that other paths can’t be the basis of an equilibrium.


A.5.1     The unique saddle path
We already established in the text that there is a unique steady state. Next, we verify that it has the local
                                                                                       C
saddle-point property: the Jacobian of the system of differential equation at (ĀC
                                                                                 d , ξ̄ ) has two real eigenvalues
which have opposite sign. The Jacobian is
                                                                    !
                                          (r + ρ + κ) −ρψ ′ (ĀC  d)
                                                    C                 .
                                          −αDC ′ (ξ̄ )      −α




                                                           35
Clearly, the determinant of the Jacobian is strictly negative which for a 2-by-2 matrix means that the matrix
has two real eigenvalues with opposite signs. We can then apply Theorem 8.3.2 in Hubbard and West (1995)
                                                                        C
to assert that there is a unique trajectory that tends to (ĀC    d , ξ̄ ) from the left. This saddle path is indicated
by the plain curve with double arrow in Figure 8.
      Next, we need to show that this saddle path can be extended back to the y-axis, delivering the initial
condition ξ C (0). We proceed in two steps. First we argue that, as long as AC               d (t) ≥ 0, the saddle path has
to remain trapped into the area denoted by K and shaded in the figure, i.e. the area delimited by the y-axis
                            C
to the west, the isocline ξ̇ (t) = 0 to the north, and the isocline ȦC      d (t) = 0 to the south. We know that the
saddle path must eventually lie in K. Let t1 be the last time when the saddle path enters K from outside.
                                                                                            C
After t1 , the saddle path stays in K and converges to the steady state (ĀC          d , ξ̄ ). When the saddle path is in
                                                                                                        C
K, Ad (t) increases and ξ (t) decreases. Therefore, we have Ad (t1 ) < Ād and ξ C (t1 ) > ξ̄ . Suppose that, at
       C                   C                                           C            C
                                                                            C
t1 , the saddle path enters K from the north, crossing the isocline ξ̇ (t1 ) = 0 from above. Differentiating ODE
(43) yields:
                    C                   C
                  ξ̈ (t) = (r + ρ + κ)ξ̇ (t1 ) − ρψ ′ (AC         C               ′    C         C
                                                        d (t1 ))Ȧd (t1 ) = −ρψ (Ad (t1 ))Ȧd (t1 ) > 0.

since ψ ′ (A) < 0 and ȦC                      C           C                                C
                          d (t1 ) > 0 because Ad (t1 ) < Ād and lies above the isocline Ȧd (t) = 0. Thus, just after
       C
t1 , ξ̇ (t) is strictly positive. But this is a contradiction: since the saddle path enters K from the north, at
           C
time t1 ξ̇ (t) must move from being zero to being strictly negative. Alternatively the saddle path cannot enter
K from the south, because i) at that time ξ(t) would have a value less than the steady state and ii) once the
saddle path enters K for the last time, ξ(t) is decreasing.
       Now let us start the system on the saddle path with an initial condition to the left of the steady state, say
                C
ÃC
  d (t0 ) and ξ̃ (t0 ), and let us run the system backward in time, for t0 − s ≤ t0 (formally, this means making
the change of variable u = t0 − s in the system of ODEs (43) and (44)). Graphically, think of moving along
the saddle path towards the northwest of Figure 8. Since the saddle path stays in K, we know that ÃC           d (t0 − s)
                                             C              C
is decreasing in s. Moreover, note that ξ̃ (t0 − s) > ξ̃ (t0 ) and that ÃC d (t 0 − s) < Ã C
                                                                                             d (t 0 ). Plugging this back
into ODE (44), we find that

                   dÃC
                      d (t0 − s)
                                         −Ã˙ C
                                                                                           C
                                                                                                
                                                                        C             C
                                    =         d (t0 − s) = −α A − Ãd (t0 − s) − D (ξ̃ (t0 − s))
                        ds
                                                                     C            ˙C
                                                                           
                                    ≤    −α A − ÃC    d (t0 ) − D(ξ̃ (t0 )) = −αÃd (t0 ) < 0.


So the derivative of ÃC                                                                      C
                         d (t0 − s) is negative and bounded away from zero, implying that Ãd (t0 − s) reaches
zero in finite time, say at s0 . This proves that the saddle path extends to the y-axis, and delivers the initial
                      C
condition ξ C (0) = ξ̃ (t0 − s0 ).


A.5.2      Ruling out other solutions
Next, we need to show that other solutions of the system (43)-(44) can’t be the basis of an equilibrium.

Preliminary remarks. Let J be the region of the positive quadrant below both isoclines and such
that AC          C
        d < Ād . Similarly, let L be the region of the positive quadrant above both isocline. The argument
that allowed us to conclude that the saddle path stays trapped in region K also shows that a solution of the
system can only move from region K to region L, and not vice versa. Thus, once a solution leaves K to L, it
never comes back to K. One easily shows (using the same argument) that a solution can never leave region L.
Similarly, one can show that a solution can only move from region K to region J, and not vice versa.
     Now consider alternative initial conditions for ξ C (0). We let ξ 1 (ξ 2 ) denote the intersection of the ȦC
                                                                                                                 d (t) = 0
   C
(ξ̇ (t) = 0) isocline with the y-axis. The condition for the existence of a steady state with ĀC         d  >  0  implies
that ξ 1 ≤ ξ 2 .

An initial condition ξ C (0) < ξ 1 . This can’t be the basis of an equilibrium because ȦCd (0) < 0: given
that AC
      d (0) = 0, this would violate the dealers’ short-selling constraint.


An initial condition ξ C (0) ∈ [ξ 1 , ξ 2 ]. Suppose there is a candidate equilibrium path with an initial
condition in [ξ 1 , ξ 2 ] that is different from that of the saddle path. Because solutions of ODEs never cross, this
candidate equilibrium path remains different from the saddle path at all subsequent times. Then we claim
that the equilibrium path would eventually leave region K. Suppose that it stayed in K: then AC          d (t) would
be increasing and bounded above and ξ C (t) would be is decreasing, so this candidate equilibrium path would
have a limit in K as t → ∞. But the limit must be equal to the unique steady state of the model which is


                                                           36
impossible because this candidate equilibrium path is different from the saddle path. Thus, this we have two
possibilities.
     If the equilibrium leaves region K for region J at some time t, then it is clear from the figure that
ACd (t) < Ād . We also know from the previous paragraph that it never re-enters region K. Given that
ȦC                                                                   C               C
  d (t) < 0 in J, and given the equilibrium restrictions that Ad (t) ≥ 0 and ξ (t) ≥ 0, we obtain that the
equilibrium path must stay trapped in region J forever, with Ad (s) ≤ Ad (t) < ĀC
                                                                    C          C
                                                                                        d for all s ≥ t. Using the fact
that AC             C
        d (t) and ξ (t) are decreasing in J and bounded below by zero, we obtain that the candidate equilibrium
                                                                                                      C
path has a finite limit as t → ∞, with AC              C                                           C
                                             d (∞) < Ād . But this is impossible given that (Ād , ξ̄ ) is the unique
steady state of the system.
     If the equilibrium leaves region K for region L then we know it remains in L forever after. Starting from
some time t when the candidate equilibrium is away from the boundary of L, we can solve ODE (43) given the
path for AC  d (t):
                                                             Z s
                          C           C      (r+ρ+κ)(s−t)
                         ξ (s) = ξ (t)e                   −      ρψ(ACd (u))e
                                                                              −(r+ρ+κ)(u−s)
                                                                                              du
                                                              t
                                                                         Z s
                                 ≥ ξ C (t)e(r+ρ+κ)(s−t) − ρψ(AC   d (t))     e−(r+ρ+κ)(u−s) du
                                                                          t
                                                 ρψ(AC                           ρψ(AC
                                                            
                                                      d (t))                         d (t))
                                 =     ξ C (t) −               e(r+ρ+κ)(s−t) +              .
                                                  r+ρ+κ                           r+ρ+κ

where the second inequality follows because AC d (t) is increasing since the equilibrium stays in L, and the third
                                                                                        C
equality from integrating. Because we start away from the boundary we have that ξ̇ (t) = (r + ρ + κ)ξ C (t) −
     C                                                        C
ρψ(Ad (t)) > 0, so it follows from the above formula that ξ (s) grows towards infinity at rate r + ρ + κ. But
                                                             h           i
                            pC (s)e−rs ≥ pC (s)e−rs − Es p(T̃ )e−rT̃ = ξ C (s)e−rs .

So pC (s)e−rs goes to infinity given that ξ C (s) grows at a rate r + ρ + κ > r. Thus the no-bubble condition is
violated, and this rule out this candidate equilibrium path.

An initial condition ξ C (0) > ξ 2 . Then the equilibrium path starts in region L so the reasoning of
the previous paragraph implies that the no-bubble condition is violated.

                                                  ξC
                                                                          ȦC
                                                                            d (t) = 0
                                         ξ2
                                                            L


                                        ξ C (0)        K
                                              C
                                         ξ̄
                                                                                   C
                                                                                 ξ̇ (t) = 0
                                        ξ1                      J
                                                                                  AC
                                                                                   d
                                                                    ĀC
                                                                      d

                                              Figure 8: Phase diagram




                                                           37
A.6        Proof of Proposition ??
The price goes up during the recovery because it solves the ODE ṗ(t) = rp(t) so it is equal to p(t) =
p(Tρ )er(t−Tρ ) , which is an increasing function of time. Before the recovery, the price solves the ODE:

                                                ṗC (t) = (r + ρ)pC (t) − ρp(t | t).                          (45)

Note that p(t | t) = e−r(T −t) ξ̄/r, where T denotes the time at which dealers have unwound their inventories
and the price has reached its steady-state value. By definition of T and ψ(Ad (t)C ), we have

                                                  ψ(Ad (t)C ) = e−(r+κ)(T −t) ξ̄,

implying that:
                                                         h            i r      κ
                                               p(t | t) = ψ(Ad (t)C )
                                                                       r+κ
                                                                           ξ̄ r+κ .

Since ACd (t) is increasing and ψ(A) is decreasing, it follows that p(t, t) is decreasing. Now integrating (45) and
using the no-bubble condition, it follows that:
                                          Z ∞
                                                                           ρp(t | t)
                                 pC (t) =      e−(r+ρ)(s−t) ρp(s | s) ds <           ,
                                           t                                 r+ρ

because p(s | s) < p(t | t). Note that this implies in particular that pC (t) < p(t | t): at the recovery time, the
price jumps up. Rearranging this inequality gives (r + ρ)pC (t) − p(t | t) < 0 and comparing with (45) yields
ṗC (t) < 0.


A.7        Proof of Proposition 3
Consider first the case when κ → ∞. Then, one sees that ε̄i → εi while ε̄C    i → θεi . Thus, the left-hand side
of condition (30) converges to θ1/σ . The right-hand side, on the other hand, converges to zero. Therefore, the
condition is satisfied and dealers accumulate no inventories.
     Let us turn to the case r + κ → 0. Then, one sees easily that both sides of (30) go to 1. Therefore, in order
to figure out the direction of the inequality, we need a first-order Taylor
                                                                        P expansion of both sides as r + κ → 0.
To simplify the algebra, let us define γ ≡ r + κ and let us normalize Ij=1 π j εj = 1. Then, we have:

                                    γεi + δ      γ                γ
                           ε̄i =            =1+     (εi − 1) = 1 + (εi − 1) + o (γ) ,
                                     δ+γ        δ+γ               δ

where o(γ) is a function such that o(γ)/γ → 0 as γ → 0. It follows that:
                                                   1            γ
                                                 ε̄iσ = 1 +       (εi − 1) + o(γ)
                                                               δσ
                        PI
Keeping in mind that      j=1   π j εj = 1, we obtain:

                                                    I
                                                    X            1
                                                          πj (ε̄j ) σ = 1 + o(γ).                             (46)
                                                    j=1


Next, we have:

                γθεi + ρε̄i             h                                ργ                 i
      εC
       i    =               = (γ + ρ)−1 γθ(εi − 1) + γ(θ − 1) + γ + ρ +     (εi − 1) + o(γ)
                  γ+ρ                                                     δ
                                                                              
                      γ h       ρ                          i          θ   1               γ
            =   1+           θ+     (εi − 1) + (θ − 1) + o(1) = 1 + γ     +      (εi − 1) + (θ − 1) + o(γ)
                    γ+ρ          δ                                      ρ    δ              ρ

Therefore:
                          PI
           (γ + ρ)εC
                   i +δ            π j εj
                                                                                                                    
                             j=1                                           γ                     θ   1
ε̄C
  i   =                                     = (γ + ρ + δ)−1 (γ + ρ + δ) 1 + (θ − 1) + (γ + ρ)γ     +     (εi − 1) + o(γ)
                 γ+ρ+δ                                                     ρ                     ρ   δ
              γ          γ θδ + ρ
      =    1 + (θ − 1) +          (εi − 1) + o(γ).
              ρ          δ δ+ρ


                                                                 38
Now this implies that:
                                           1               γ            γ θδ + ρ
                                      ε̄C
                                             σ
                                        i        =1+           (θ − 1) +           + o(γ).
                                                            ρσ           δσ δ + ρ
                                       PI
As before, keeping in mind that             j=1   π j εj = 1, this gives:

                                             I      1
                                             X                 γ
                                                 πj ε̄C
                                                        σ
                                                      j   =1+    (θ − 1) + o(γ)                                           (47)
                                             j=1
                                                              ρσ

Taken together, equations (46) and (47) show that the left-hand side of (30) is equal to:
                                                                 γ
                                                           1+      (θ − 1) + o(γ)
                                                                ρσ

The right-hand side of (30) is, on the other hand:
                                                               1
                                                         ρ        σ                γ
                                                                      =1−            + o(γ).
                                                        ρ+γ                       ρσ

Comparing the left-hand side with the right-hand side, it is clear, then, that condition (30) is satisfied for γ
close enough to zero.


A.8     Proof of Proposition 4
The planner’s problem can be described recursively as follows. Following the recovery, the maximum attainable
welfare for society is
                                                                                      ∞
                                                                                          PI
                                                                                                 πiˆ
                                                                                                   ε̄i u(ai (t)) −rt
                                                                              Z
                                                                                           i=1
                            W(Ad )           =              max           α                                     e    dt
                                                    {ai (t)}I
                                                            i=1 ,Ad (t)           0              r+α
                                                                               I
                                                        (                                        )
                                                                               X
                         s.t. Ȧd (t)        =      α A − Ad (t) −                     πi ai (t)
                                                                               i=1
                              Ad (0)         =      Ad .

Let λ(t) be the current-valued costate variable associated with Ad (t). From the Maximum Principle, the
necessary conditions for an optimum are

                                   ˆε̄i u′ (ai (t))
                                                    − λ(t)        ≤       0,          “ = ” if ai (t) > 0,
                                        r+α
                                  λ̇(t) − (r + α)λ(t)             ≤       0,          “ = ” if Ad (t) > 0.

The Mangasarian sufficient condition is limt→∞ e−rt λ(t)Ad (t) = 0. These conditions coincide with the equi-
librium conditions if and only if η = 0.
     Before the recovery, and using the fact that Tρ is exponentially distributed with parameter ρ, the planner’s
problem is
                                                                                           !
                                                     α Ii=1 π i ˆε̄C    C
                                     Z ∞                P
                        C   C               −(r+ρ)t                i u(ai (t))       C
                     W (Ad ) =            e                                    + ρW(Ad (t)) dt.
                                      0                        r+α
                                                         I
                                       (                              )
                          C                     C
                                                        X       C
                   s.t. Ȧd (t) = α A − Ad (t) −           π i ai (t)
                                                                      i=1

                         AC
                          d (0)       =      AC
                                              d.


Let λC (t) be the current-valued costate variable associated with AC
                                                                   d (t). From the Maximum Principle, and




                                                                      39
using that W ′ (AC              C
                 d (t)) = λ(0; Ad (t)), the necessary conditions for an optimum are

                                            ˆε̄C  ′
                                               i u (ai (t))
                                                            − λC (t)                                     ≤   0,         “ = ” if aC
                                                                                                                                  i (t) > 0,
                                                 r+α
                  C
                          h                      i
                λ̇ (t) + ρ λ(0; AC         C
                                 d (t)) − λ (t) − (r + α)λ (t)
                                                               C
                                                                                                         ≤   0,         “ = ” if AC
                                                                                                                                  d (t) > 0.


The Mangasarian sufficient condition is limt→∞ e−(r+ρ)t λC (t)AC
                                                               d (t) = 0. These conditions coincide with the
equilibrium conditions if and only if η = 0.
    The second part of the Proposition is a consequence of Proposition 3.


A.9      Proof of Proposition 6
The welfare criterion is that of equation (4.2).

Welfare during the crisis. We first evaluate the first integral in the expectation. First, recall that
during the crisis the government intervention amounts to scale down the available supply in the market by a
factor 1 − ω. Because of iso-elastic utilities, all investors’ holdings are scaled down by that same factor. Thus,
if we let aC
           i be an investor’s holding during the crisis in the absence of government intervention, we find that
welfare during the crisis with government intervention is equal to:
                            Tρ                        1−σ                                             1−σ
              α                                    aC                           α 1 − e−rTρ X C aC
                    Z
                                               C
                                 X
                                         πi ˆε̄i    i
                                                          (1 − ω)1−σ e−rt dt =                πˆε̄i i     (1 − ω)1−σ .
             r+α        0            i
                                                   1−σ                         r+α    r     i
                                                                                                    1−σ

Now recall that, when ω is close to zero, we have that (1 − ω)1−σ = 1 − (1 − σ)ω + o(ω). Plugging this back
in the expression above, we find that the change in welfare during the crisis is equal to:

                                                         α 1 − e−rTρ X C C 1−σ
                                                   −ω                  πˆ
                                                                        ε̄i ai + o(ω).                                                                        (48)
                                                        r+α    r     i


Welfare during the recovery. Suppose the recovery starts are time Tρ , with government holdings
equal to Ag (Tρ ) = ω(1 − e−αTρ ). Then, from time Tρ to some time T , the government re-sells his inventories.
After time T , the economy is back in steady state. We will need the following Lemma:

Lemma 9 (The time to unload inventories). Let ∆T ≡ T − Tρ . Then, as ω goes to zero:

                                                                         2
                                                            ∆T 2 =           (1 − e−αTρ )ω + o(ω),                                                            (49)
                                                                       α r+κ
                                                                          σ

where o(ω) is a function such that o(ω)/ω goes to zero as ω goes to zero, uniformly in Tρ .

    We prove the Lemma in Section A.9.1. After the recovery, the government unloads its inventories at a
speed guaranteeing that the price grows at rate r or, equivalently, that ξ grows at rate r + κ. That is, we
have ξ(t) = ξ̄e−(r+κ)(T −t) . Because of iso-elastic utilities, this immediately implies that investors scale up their
                            r+κ
                                (T2 −t)
holdings by a factor e       σ          .          Thus, the change in welfare induced by the intervention is equal to:
                        T
                                               a1−σ             (1−σ)(r+κ)
                                                                                      
             α
                   Z        X                                              (T −t)
                                     πi ˆε̄i    i
                                                            e       σ               − 1 e−rt dt
            r+α        Tρ        i
                                               1−σ
                                                                                    "       
                                                                                                     (1−σ)(r+κ)
                                                                                                                                   #                     !
             α −rT2 X        a1−σ                                       1                       r+
                                                                                                         σ
                                                                                                                      (T −Tρ )        1 h r(T −Tρ )   i
       =        e     πi ˆε̄i i                                      (1−σ)(r+κ)
                                                                                        e                                        −1 −    e          −1
            r+α     i
                             1−σ                                r+                                                                    r
                                                                         σ

             α −r(Tρ +∆T ) X           a1−σ (1 − σ)(r + κ)
                                    ε̄i i
                                  πiˆ                        ∆T 2 + o(∆T 2 )
                                                                             
       =        e                                                                                                                                             (50)
            r+α               i
                                       1 − σ      2σ
             α −rTρ X                 r+κ
                        πi ˆε̄i a1−σ         ∆T 2 + o(∆T 2 ) .
                                                            
       =        e                i                                                                                                                            (51)
            r+α       i
                                       2σ

To go from the second to the third line, we used the Taylor expansion:

                                                        1  B∆          B
                                                           e   − 1 = ∆T + ∆T 2 + o(∆2 ),
                                                        B                2

                                                                                  40
keeping in mind that, from Lemma 9, ∆T → 0 as ω → 0, uniformly in Tρ – i.e. it will take very little time for
the government to re-sell very little inventories. To go from the third to the fourth line, we canceled out the
1 − σ and noted that T = Tρ + ∆T = Tρ + o(1). Now plugging the Taylor approximation (49) into (51), we
find that the change in welfare is, then,

                                      1 X                           
                                 ω           ε̄i a1−σ
                                           πiˆ    i   e−rTρ 1 − e−αTρ + o(ω).                                   (52)
                                     r+α i

Putting the two together. The next thing to do is to take expectations with respect to the random
recovery time, Tρ , in (48) and (52), and add up the two terms. This shows that the total expected change in
welfare is equal to:
                                     X                                                X
                    α 1            ρ               C    1−σ     1      ρ            ρ
             −ω             1−                 πˆε̄i aC
                                                      i     +ω               −              πi ˆε̄i a1−σ
                                                                                                     i   + o(ω)
                 r+αr            r+ρ         i
                                                               r+α r+ρ          r+ρ+α     i
                   r + α X C C 1−σ               r+α        ρα  X
         ⇔ −ωα               πˆε̄i ai       +ω                      ε̄i a1−σ
                                                                  πiˆ    i    + o(ω)
                   r+ρ i                         r+ρ r+ρ+α i
                             "                                                 #
                    ωα             X        C C 1−σ          ρ   X         1−σ
         ⇔                     −      πi ˆε̄i ai      +            πiˆ
                                                                     ε̄i ai      + o(ω),
              (r + ρ)(r + α)        i
                                                         r+ρ+α i

which is the formula of the proposition.

Verifying that dealers hold no inventories. During the recovery, dealers find it weakly optimal
to hold no inventories because, by construction, the price grows at rate r. During the crisis, we need to verify
that:
                                                   C
                                                                             
                               −(r + κ)ξ C (t) + ξ̇ (t) + ρ ξ(t | t) − ξ C (t) < 0.                        (53)
                                                                                                       C
Recall that, by construction of the government intervention, ξ C = (1 − ω)−σ ξ̄ 0 is constant over time. The
price at the recovery time is, on the other hand:

                                                   ξ(t, t) = ξ̄e−(r+κ)∆T .

So (53) becomes                                                                  
                                               C                                C
                          −(r + κ)(1 − ω)−σ ξ̄ 0 + ρ ξ̄e−(r+κ)∆T − (1 − ω)−σ ξ̄ 0 < 0.

Next, note that ξ(t | t) is decreasing. Indeed if the crisis lasts longer, the government holds more inventories,
and ∆T will be larger, meaning that it will take longer to unwind these inventories after the recovery. Thus,
in order for (53) to hold at all times during the crisis, it is necessary and sufficient that it holds at time zero,
i.e.                                                                          
                                                     C                       C
                                −(r + κ)(1 − ω)−σ ξ̄ 0 + ρ ξ̄ − (1 − ω)−σ ξ̄ 0 < 0.
But we restrict attention to economies such that this condition holds with strict inequality when ω = 0.
Therefore, by continuity, it also holds with strict inequality if ω is close enough to zero.


A.9.1 Proof of Lemma 9
The time to unload inventories, ∆T . We start by deriving a simple equation for ∆T . Using
equation (16), we know that T solves:

                                                                         I
                                                                "                              #
                                              Z    T                     X
                                                           αs
                               Ag (Tρ ) + α            e            A−         πi Ui′−1   [ξ(s)] ds = 0.
                                                  Tρ                     i=1


With the functional form ui (a) = εi a1−σ /(1 − σ) we have Ui′−1 [ξ(s)] = [ε̄i /ξ(s)]1/σ and ξ(s) = ξ̄e−(r+κ)(T −s) .
Hence,
                                      Z T      "     I      1                 #
                                            αs
                                                    X       ε̄i σ ( r+κ )(T −s)
                        Ag (Tρ ) + α      e      A−     πi       e   σ            ds = 0.
                                       Tρ           i=1
                                                             ξ̄
                                                                             PI                 1/σ
   Notice steady-state market clearing after the recovery implies that          i=1 π i ε̄i /ξ̄      = A. Thus, after




                                                                     41
                                     r+κ
some calculations, and letting γ ≡    σ
                                         ,   we arrive at

           Ag (Tρ ) − A    γ           α                              γeα∆T − αeγ∆T
                        +     eα∆T −       eγ∆T = 0 ⇔ −1 + ω 1 − e−αTρ +              =0
                A         γ−α        γ−α                                    γ−α

which can be written F ω 1 − e−αTρ , ∆T 2 = 0, where
                                        

                                                                 √          √
                                                             γeα     u
                                                                    − αeγ       u
                                    F (z, u) ≡ −1 + z +                             .
                                                                   γ−α

It is then straightforward to show that, for each z ≥ 0, F (z, u) = 0 has a unique solution.

The Taylor expansion. Clearly, F (0, 0) = 0, i.e. when there are no inventories at time Tρ (z = 0) it
takes not time to unload them (u = 0). Next, we would like to know how u varies with ω. To do so, we need
to apply the implicit function theorem (IFT). Clearly, F (z, u) is continuously differentiable for all z ≥ 0 and
u > 0. We need to show that this property is also true when u = 0. First, we show that F (z, u) is differentiable
by calculating:
                                    "     √        √        #
          F (z, u) − F (z, 0)     1 γeα u − αeγ u
                              =                        −1
                   u              u       (γ − α)
                                            √      α2
                                                                               √     γ2
                                                                                                       
                                  1  γ  1 + α  u +   2
                                                         u  + o(u)   − α   1 + γ   u +  2
                                                                                          u + o(u)
                              =                                                                      − 1
                                  u                               γ−α
                                              αγ
                                  1 γ − α − 2 (γ − α)u + o(u)
                                                                       
                              =                                      −1
                                  u             γ−α
                                    αγ
                                  − 2 u + o(u)       αγ
                              =                 →−        ,
                                        u              2
as u → 0. Thus, F (z, u) is differentiable at (z, 0), for all z, with ∂F/∂u(0, 0) = −(αγ)/2. Next we show that
∂F/∂u is continuous at (z, 0). To see this note that

   ∂F            αγ      √     √       αγ         √         √      √      αγ
         =           √ eα u − eγ u =         √ 1 + α u − 1 − γ u + o( u) = −    (1 + o(1)) ,
   ∂u        2(γ − α) u              2(γ − α) u                               2

so that ∂F/∂u → −(αγ)/2 as u → 0.
    Now let U (z) denote the solution of F (z, u) = 0. An application of the IFT shows that for z small, we
have:
                                                          2
                                               U (z) =      z + k(z).
                                                         αγ

where k(z) is such that k(z)/z goes to zero as z goes to zero. In the case at hand, we are looking at some
recovery occurring a time Tρ , when the government’s inventory position is Ag (Tρ ) = ω(1 − e−αT1 ). The above
calculations show that
                                              2                             
                       ∆T 2 = U (Ag (Tρ )) =    ω 1 − e−αTρ + k ω 1 − e−αTρ         .
                                             αγ

The last thing we need to argue is that k ω 1 − e−αTρ is o(ω), uniformly in Tρ . To do so, we recall that
                                                         
for all ε > 0, there is some η > 0 such that |z| < η implies that |k(z)/z| < ε. But |ω| < η implies that
|ω 1 − e−αTρ | < η as well and therefore that:

                                k ω 1 − e−αTρ               k ω 1 − e−αTρ
                                                                            
                                                       ≤                                ≤ ε.
                                      ω                       ω (1 − eαTρ )

Thus k ω 1 − e−αTρ
                     
                          /ω converges to zero uniformly in Tρ , and we are done.




                                                            42
References

Yakov Amihud and Haim Mendelson. Dealership market: Marketmaking with inventory.
  Journal of Financial Economics, 8:31–53, 1980.

Bank for International Settlements. OTC derivatives market activity in the second half of
  2008. Monetary and Economics Department, May 2009.

Ben S. Bernanke. The federal reserve’s balance sheet. Speech at the Federal Reserve Bank of
  Richmond 2009 Credit Markets Symposium, April 2009a.

Ben S. Bernanke. Financial reform to address systemic risk. Speech at the Council on Foreign
  Relations, March 2009b.

Antonio Bernardo and Ivo Welch. Liquidity and financial market runs. Quarterly Journal of
  Economics, 119:135–158, 2004.

Markus Brunnermeier. Deciphering the liquidity and credit crunch 2007–2008. Journal of
  Economic Perspectives, 23:77–100, 2009.

Markus K. Brunnermeier and Lasse H. Pedersen. Funding liquidity and market liquidity.
  Review of Financial Studies, 22:2201–2238, 2009.

Stephen G. Cecchetti. Crisis and responses: the federal reserve and the financial crisis of
  2007-2008. NBER Working Paper No. 14134, 2008.

Jonathan Chiu and Thorsten V. Koeppl. Market making of last resort: Optimal intervention
  when financial markets are frozen. Working Paper, Bank of Canada and Queen’s University,
  2009.

Harold Demsetz. The cost of transacting. The Quarterly Journal of Economics, 82:33–53,
  1968.

Douglas W. Diamond and Philip H. Dybvig. Bank runs, deposit insurance, and liquidity.
  Journal of Political Economy, 91:401–417, 1983.

Darrell Duffie, Nicolae Gârleanu, and Lasse H. Pedersen. Over-the-counter markets. Econo-
  metrica, 73:1815–1847, 2005.




                                            43
Darrell Duffie, Nicolae Gârleanu, and Lasse H. Pedersen. Valuation in over-the-counter mar-
  kets. Review of Financial Studies, 20:1865–1900, 2007.

Michael J. Fleming, Warren B. Hrung, and Frank M. Keane. The term securities lending
  facility: Origin, design, and effects. Federal Reserve Bank of New York Current Issues in
  Economics and Finance, 2:1–11, 2009.

Scott Freeman. The payment system, liquidity, and rediscounting. American Economic Re-
  view, 86:1126–1138, 1996.

Scott Freeman. Rediscounting under aggregate uncertainty. Journal Monetary Economics,
  43:197–216, 1999.

Nicolae Gârleanu. Portfolio choice and pricing in illiquid markets. Journal of Economic
  Theory, 144:532–564, 2009.

Denis Gromb and Dimitri Vayanos. Equilibrium and welfare in markets with financially
  constraint arbitrageurs. Journal of Financial Economics, 66:361–407, 2002.

Sanford J. Grossman and Merton H. Miller. Liquidity and market structure. Journal of
  Finance, 43:617–637, 1988.

Group of Thirty. Financial Reform: A Framework for Financial Stability. Washington D.C.,
  January 2009.

Terrence Hendershott and Albert J. Menkveld. Price pressures. Working Paper, UC Berkeley
  and VU University Amsterdam, 2009.

Thomas Ho and Hans R. Stoll. The dynamics of dealer markets under competition. Journal
  of Finance, 38:1053–1074, 1983.

Hugo A. Hopenhayn and Ingrid M. Werner. Information, liquidity, and asset trading in a
  random matching game. Journal of Economic Theory, 68:349–379, 1996.

Jennifer Huang and Jiang Wang. Market liquidity, asset prices, and welfare. Journal of
  Financial Economics, 2009. Forthcoming.

John H. Hubbard and Beverly H. West. Differential Equations: A Dynamical Systems Ap-
  proach. Part II: Higher Dimensional Systems. Springer-Verlag, New-York, 1995.


                                            44
Péter Kondor. Risk in dynamic arbitrage: Price effects of convergence trading. Journal of
  Finance, 64:638–658, 2009.

Ricardo Lagos and Guillaume Rocheteau. Search in assets markets: Market structure, liquid-
  ity and welfare. American Economic Review Papers and Proceedings, 97:198–202, 2007.

Ricardo Lagos and Guillaume Rocheteau. Liquidity in asset markets with search frictions.
  Econometrica, 77:403–426, 2009.

Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill. Crashes and recoveries in
  illiquid markets. Working paper, NYU, UCI, and UCLA, 2007.

Francis Longstaff. The flight to liquidity premium in U.S. treasury bond prices. Journal of
  Business, 77:511–526, 2004.

Albert J. Menkveld and Ting Wang. How do designated market makers create value for
  small-caps? Working paper, Tinbergen Institute, VU University Amsterdam, 2009.

Gara Mı́nguez Afonso. Liquidity and congestion. Working paper, LSE, 2008.

Katharine Ross and George Sofianos. An analysis of prive volatility October 27 and 28, 1997.
  New-York Stock Exchange Working Paper., 1998.

Hans R. Stoll. The supply of dealer services in securities markets. Journal of Finance, 33:
  1133–1151, 1978.

Dimitri Vayanos and Pierre-Olivier Weill. A search-based theory of the on-the-run phe-
  nomenon. Journal of Finance, 63:1361–1398, 2008.

Pierre-Olivier Weill. Leaning against the wind. Review of Economic Studies, 74:1329–1354,
  2007.




                                            45
