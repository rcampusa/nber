                              NBER WORKING PAPER SERIES




                        QUANTIFYING MARKET POWER AND
                   BUSINESS DYNAMISM IN THE MACROECONOMY

                                        Jan De Loecker
                                         Jan Eeckhout
                                        Simon Mongey

                                      Working Paper 28761
                              http://www.nber.org/papers/w28761


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2021




We thank Ufuk Akcigit, Steve Berry, Ariel Burstein, Emmanuel Farhi, John Haltiwanger, Tom
Holmes, Virgiliu Midrigan, Chad Syverson, John Sutton, John Van Reenen for many useful
comments and insightful discussions as well as seminar audiences. De Loecker gratefully
acknowledges support from the ERC, Consolidator grant 816638, and Eeckhout from the ERC,
Advanced grant 882499, and from ECO2015-67655-P. We have benefited from excellent
research assistance by Wei Hua, Shubhdeep Deb, Hyejin Park and Renjie Bao. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Jan De Loecker, Jan Eeckhout, and Simon Mongey. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that
full credit, including © notice, is given to the source.
Quantifying Market Power and Business Dynamism in the Macroeconomy
Jan De Loecker, Jan Eeckhout, and Simon Mongey
NBER Working Paper No. 28761
May 2021
JEL No. E0,L1

                                         ABSTRACT

We propose a general equilibrium economy with oligopolistic output markets in which two
channels can cause a change in market power: (i) technology, via changes to productivity shocks
and the cost of entry, (ii) market structure, via changes to the number of potential competitors.
First, we disentangle these narratives by matching time-series on markups, labor reallocation and
costs between 1980 and 2016, finding that both channels are necessary to account for the data.
Second, we show that changes in technology and market structure over this period yielded
positive welfare effects from reallocation and selection, but off-setting negative effects from
deadweight loss and overhead. Overall, welfare is 9 percent lower in 2016 than in 1980. Third,
the changes we identify replicate cross-sectional patterns in declining business dynamism,
declining equilibrium wages and labor force participation, and sales reallocation toward larger,
more productive firms.

Jan De Loecker                                  Simon Mongey
Economics Department                            Kenneth C. Griffin Department of Economics
KU Leuven                                       University of Chicago
Naamsestraat 68                                 1126 E. 59th Street
3000 Leuven                                     Chicago, IL 60637
Belgium                                         and NBER
and CEPR                                        mongey@uchicago.edu
and also NBER
jan.deloecker@kuleuven.be

Jan Eeckhout
Department of Economics
Universitat Pompeu Fabra
Trias Fargas 25
Barcelona
08005
Spain
and CEPR
jan.eeckhout@upf.edu
1   Introduction

There is an ongoing debate about the state of competition in the US economy over the last four decades,
and the potential implications of increased market power. A wide range of measures, including price-cost
margins, profitability and concentration, suggest a rise in overall market power. Over the same period, a
number of significant secular trends have been documented. Real wages have stagnated and have not kept
track with productivity growth, leading to a much discussed wage-productivity decoupling. Both product
and labor market dynamism, as measured by net-entry rates and labor reallocation, has decreased, as has
the labor share and labor force participation. In this paper, we link these important secular trends in the
macroeconomy to the presence of market power in the product market. In particular we use trends in
labor market dynamism and the cost structure of firms to disentangle causes behind the increase in market
power, and then assess the additional consequences of these changes for welfare, employment and output.
    To achieve this we introduce a quantitative framework designed to account for both the causes and
consequences of market power while taking stock of key facts in the micro data. We develop a general equi-
librium model of oligopolistic output markets populated with heterogeneous producers facing competitive
input markets and that are subject to a fixed cost when operating. We quantify the model on data from 1980
to 2016, estimating primitives annually, and find that a change in technology as well as a change in market
structure caused a rise in market power, which in turn can account for the aforementioned secular trends
in the labor market.
    Our framework distinguishes two channels as sources of market power. The first is technological
change. In particular, we think of two determinants of technological change: the implicit cost of entry,
and the latent productivity distribution across firms in a given market. Technological change can have
a positive effect on consumers through reductions in the cost of production, and therefore lower prices.
At the same time, it has the potential to have a negative effect on welfare because a firm that is consid-
erably more efficient than its competitors can use its dominance to grab market share and extract rents.
The significantly higher efficiency of a dominant firm means they can produce/deliver at low cost, but
whether these cost savings are passed onto consumers depends on the overall competition in the market.
Incomplete passthrough is a central determinant in our model. The second channel is a change in the
market structure itself. If there are fewer competitors, under oligopoly, firms set higher markups, leading
to the well-known deadweight loss from market power. A change in the effective number of firms can
come about from a variety of processes, such as the consolidation of ownership, exit as a consequence of
technological change (further magnifying the first channel), or a reduction in entry through entry barriers.
Of course, these processes are invariably dynamic and interact with the technology channel, turning the
market structure into an endogenous object as described by the work of Sutton (2001).


                                                     1
   Which of these are the root causes of the increase in market power in the US economy are important for
assessing its welfare consequences. At face value, and through the lens of our model, the welfare impact
is ambiguous. Welfare increases if higher margins reflect increasing market power due to some firms
becoming more productive and reallocation of resources to these firms. Welfare decreases if higher margins
reflect deadweight losses associated with changes in market structure. And welfare effects are ambiguous
if higher margins reflect increasing fixed costs of production: tougher entry requirements improves the
selection of firms, but more resources are tied up in overhead. We show that, when filtered through our
model, additional data on two other significant trends in the economy over the past four decades can be
used in conjunction with increasing markups to discipline these narratives: the declining employment
reallocation rate (i.e. reduced business dynamism), and changes in the cost-structure of firms. Matching
time-series data on these two moments as well as markups, allows us to isolate these different causes.
   We make three contributions. First, we solve a general equilibrium (GE) model with micro-level detail
from which we recover the underlying market structure without imposing a particular market definition.
More precisely, given preferences and firm conduct (i.e., entry and pricing decisions), we recover the effec-
tive number of potential competitors by matching the model predictions to data moments without using
information on the number of competitors or market shares. This approach combines several insights from
the industrial organization (IO) literature. Bresnahan (1982, 1989) and Berry, Levinsohn, and Pakes (1995)
introduce the notion that a model of market-level conduct paired with a demand system delivers markups
and marginal costs in equilibrium. Berry and Reiss (2007) and Berry (1992) model entry decisions to recover
fixed costs. And De Loecker and Warzynski (2012) relies on cost minimization to measure markups using
information on technology parameters and data on revenue and variable input expenditures. We blend
these three aspects, but depart in a few important ways. Instead of estimating fixed costs, we discipline the
ratio of fixed costs in revenue by moments in the data, in a model-consistent fashion. Instead of estimating
demand parameters for all product markets in the US economy, we build on Atkeson and Burstein (2008)
and assume a macroeconomic model with many markets where heterogenous firms compete strategically
in their own, small market. We then calibrate the preference parameters of the macroeconomic model re-
lying on moments of markups. The advantage of our approach is that we do not have to take a stance on
what constitutes a market, and which firms engage in strategic interaction. We therefore forego having
to assume a particular market structure and how it evolves over time. Defining a market is particularly
challenging in a macroeconomic setting like ours covering all industries over a long period of time (for a
discussion, see Benkard et al. (2021), Syverson (2019) and Berry et al. (2019)).
   Second, in an extensive validation exercise we show that our micro-founded model of firm behav-
ior accounts for non-targeted secular trends in the macroeconomy. Our model is fitted to an increase in



                                                      2
markups and declining employment reallocation. First, in the aggregate time-series, the model simultane-
ously quantifies the decline in aggregate wages, labor share, firm entry, and the secular shift in job creation
and destruction toward incumbents. Second, in the cross-sectional time-series, the model matches (i) a
decomposition of the increase in markups into within- and between- firm components, capturing the re-
allocation of sales to high productivity, high markup firms, (ii) under-studied facts on the cross-sectional
decline in business dynamism: small firms' reallocation rates declined more than large firms. The over-
arching mechanism that generates the latter is the incomplete passthrough of technology shocks into em-
ployment at firms that exert market power. Aggregate and cross-sectional employment reallocation rate
data suggests that this change in passthrough connects product and labor market outcomes, and that this
relationship has changed over time. Incorporating information on employment reallocation into the esti-
mation of the model provides a route to disentangling changes in the economy.
   Third, our main results come from identifying and quantifying these changes between 1980 and 2016
and their effects on welfare. First, we show that matching time-series of increasing markups, declining
employment reallocation and a higher fixed cost share identifies changes in primitives reflecting both tech-
nology and market structure. We find that fixed costs have increased, so has the dispersion of productivity,
while competition has weakened. Second, we find that the decline in welfare due to the rise of market
power associated with these changes is 9 percent (with a 10 percent decline in output). The magnitude
of this welfare impact is consistent with Baqaee and Farhi (2017). Third, the model allows us to decom-
pose this decline in welfare and output. We find substantial output gains of 5 percent due to technological
change (prices are lower, reflecting dominant firms' superior efficiency) but these gains are outweighed
by a 15 percent output loss as these firms set higher markups. Due to technological change, firms are
substantially more productive, but they do not pass on their efficiency gains to the customer. Fourth,
we use the general equilibrium structure of the economy to provide an accounting of how our identified
changes in primitive parameters shape five welfare-relevant aggregate `wedges': productivity, selection,
overhead, markups, misallocation. We find that the overhead, selection and markup wedges dominate in
shaping output, employment and welfare. Fifth, we study how changes in primitives (market structure
and technology) determine these wedges. We find that jointly understanding changes in market structure
and technology is key for understanding the mechanism and the welfare implications. For example, the
decline in business dynamism documented by Decker, Haltiwanger, Jarmin, and Miranda (2017) consists
of an overall net effect of these two forces, where changes in market structure decrease dynamism and
technological change increases it.


Related Literature.   Our paper builds on a large literature on market power in the macroeconomy. Our
market-level model of endogenous, variable markups builds on Atkeson and Burstein (2008) and is aug-

                                                      3
mented with an entry stage in the style of Berry (1992). The varying markups in our model are driven by
the market structure (how many competitors) and the distribution of firm productivities. Because firms
compete in small markets, the distribution from which productivities are drawn in conjunction with the
number of competitors has aggregate implications. In that sense, our results build on the literature on the
granular origins that studies the aggregate implications of the distribution of firm productivities: Gabaix
(2011), Grassi (2017), Baqaee and Farhi (2017), Acemoglu, Carvalho, Ozdaglar, and Tahbaz-Salehi (2012),
Carvalho and Tahbaz-Salehi (2019), Carvalho and Grassi (2015), and Burstein, Carvalho, and Grassi (2019).
    One of the main insights of our welfare analysis is that a rise in markups driven by technological
change creates a tradeoff between efficiency and deadweight loss. Customers benefit from firms that are
more productive as they sell at lower prices. We see that there is a large welfare enhancing effect from
reallocation of market share towards those high productivity firms. This is consistent with the superstar
effect of Autor et al. (2017). However, the dispersion in productivities also generates a dominant position of
those high productivity firms that allows them to exert market power and extract rents from the customer.
The heterogeneity in markups is key to this tradeoff between efficiency from reallocation and deadweight
loss from market power and leads to large welfare effects that are negative on balance.
    Our paper is most closely related to Edmond, Midrigan, and Xu (2019), Baqaee and Farhi (2017) and
Akcigit and Ates (2021). Relative to Edmond, Midrigan, and Xu (2019), we seek to identify changes in the
economy over time using the structure of our model and data on employment reallocation, markups and
fixed costs. Instead, Edmond, Midrigan, and Xu (2019) carefully characterizes, quantifies and decomposes
counterfactual transitions between an imperfectly competitive economy and an efficient benchmark. Our
models also substantially differ. A similar exercise is the key feature of Baqaee and Farhi (2017), but in a
model with sectoral network linkages and exogenous markups. Baqaee and Farhi (2017) construct aggre-
gate `wedges' (e.g. markups and misallocation) by aggregating microdata and then compute welfare gains
from setting each wedge to its efficient level. Our exercise is different: we take a model with endogenous
markups, fix preferences parameters, and then estimate time-series of primitive technology and market
structure parameters required to match data on markups, business dynamism and costs. This structural
approach treats parameters as primitives, rather than the joint distribution of markups and sales shares,
which in our framework are endogenous. Our structural model then generates a rich correlation structure
of reduced form aggregate wedges.1 Finally, Akcigit and Ates (2021) develop a theory that link a number
of stylized facts in the labor market to those on market power. They propose a Schumpeterian growth

    1 Our approach shows the difficulty in treating reduced form wedges as independent, since changes in primitives lead to a

rich correlation structure between these wedges. In an analogy to the structural VAR literature, Baqaee and Farhi (2017) can be
understood as using a model to measure reduced form shocks, and then feeding these one by one through a model. Our exercise
can be understood as using a model to estimate the structural shocks, which lead to a rich correlation structure of the reduced form
shocks. With the structural shocks in hand, we can then study counterfactuals.


                                                                 4
model and derive a number of model properties that are consistent with those stylized facts. Our approach
differs in that instead of an endogenous growth model, we propose a framework with many oligopolistic
markets in a large economy, with firm entry, and rich heterogeneity. But most importantly, our main focus
is the quantitative exercise that identifies the parameters of technological change and market structure.
This permits us to measure the welfare impact, as well as decompose its origins.
    One important aspect that is absent from our analysis is the role of market power in the input mar-
ket, i.e., monopsony or oligopsony. A recent burgeoning empirical literature (Azar, Berry, and Marinescu
(2019), Azar, Marinescu, and Steinbaum (2017), and Hershbein, Macaluso, and Yeh (2020)) highlights the
effect of monopsony power on wages, both the level and the distribution. Berger, Herkenhoff, and Mongey
(2019) estimates a structural model of oligopsony which is used to decompose welfare.
    We cannot, unfortunately, solve for a fully dynamic model in the context of a rich general equilibrium
model with heterogeneous firms.2 This precludes the study of the role of endogenous upfront investment
that leads to higher productivity, as proposed by Sutton (1991) and Sutton (2001). This same logic is also
confirmed in the case studies of the roll out of the distribution network of large companies such as Walmart
(Holmes (2011)) and Amazon (Houde et al. (2017)). This research finds that these large firms geographically
locate their costly distribution network strategically taking into account the decline in marginal costs as
well as the role of competitors.
    Our approach is closely related to the literature on firm dynamics, pioneered by Jovanovic (1982) and
Hopenhayn and Rogerson (1993). In the standard firm-dynamics model, business dynamism on the in-
tensive margin of employment reallocation could decline due to increases in adjustment costs. We offer a
complementary explanation, which is sketched out contemporaneously by Decker et al. (2017). Dynamism
declines because passthrough declines in unison with the increase in markups. Our results caution against
concluding that an increase in adjustment costs is the only component of any explanation for these facts.
In particular, with rising adjustment costs in a competitive model, profits should not rise. Instead, profits
have risen over the same period, providing support for the passthrough mechanism that we highlight.



2    Model

We set up and solve a parsimonious model of imperfect competition in a large economy. For expositional
purposes, we present a model in which labor is the only input to production.3 We consider the steady-state
of the economy for a fixed set of parameters.

    2 Even  in the context of partial equilibrium models, this already proves challenging. The only exception of a fully dynamic
game with variable markups and firm-level productivity shocks that we know of is in a two-firm setting by Mongey (2017).
    3 In Section 3.1, we expand the model to include capital and intermediates and provide a mapping of the extended model to

the data.


                                                               5
2.1      Setup
Environment. Time is discrete.4 There are two types of agents: households and firms. Households are
identical, consume goods, supply labor, and trade shares in a representative portfolio of all firms in the
economy which pays dividends. The measure of households is normalized to one. Firms are organized in
a continuum of markets indexed j  [0, 1]. Each market contains M potential entrant firms. Of all potential
entrants, M j  M firms choose to enter the market and produce. The entering firms are indexed i 
{1, . . . , M j }.5 Goods are differentiated along two dimensions, first across markets j, then within markets i.
A single firm produces a single good indexed ij.

Households.        As in Atkeson and Burstein (2008) the utility of consumption of the differentiated final
goods is the double Constant Elasticity of Substitution (CES) aggregator of consumption utility from goods
within markets and across the continuum of markets. The cross-market elasticity of demand is denoted
 > 1. The within-sector elasticity of demand is denoted  > 1. These elasticities are ranked  > 
indicating that the household is more willing to substitute goods within a market (Pepsi vs. Coke vs. Dr.
Pepper) than across sectors (Soft drinks vs. Laundry detergent vs. Cars).
      Households discount the future at rate , have time-separable utility, and derive period utility from
consumption adjusted for the disutility of work. The household chooses sequences of consumption of
each good cijt , and labor supply Nt to maximize:
                                                                                                                               -1
                                  1+ 1
                                         
                                                                       1
                                                                                                           M jt          -1    
                             1   Nt                                          -1       -1                          -1

           t U Ct -                                                                                         Mjt
                            -                                                                                            
                                    1
                                               where     Ct =              c jt dj
                                                                             
                                                                                            and c jt =                 cijt         ,
          t =0                   1+                                0                                       i =1


Preferences U (C, N ) are GHH, which removes wealth effects on labor supply as a force in our comparative
statics exercise.6 Utility from consumption of market j goods is normalized by the size of the market M jt
in order to neutralize love of variety effects. The household's expenditures are on goods, which are priced
pijt , shares Xt in the portfolio of firms at price Qt . Income is from labor supply at wage Wt and returns on
shares due to their sale and dividends t , giving the budget constraint:7

                                      1 M jt
                                          pijt cijt dj + Qt Xt+1  Wt Nt +
                                     0 i =1
                                                                                           Q t +  t Xt .


      4 Fornotational simplicity we suppress the time subscript t whenever there is no ambiguity.
      5 The number of potential entrants M is the same in all sectors j. We have also considered a distribution of potential entrants
M ( j) that is market specific. This is in the spirit of Edmond et al. (2015) and Berger et al. (2019) who consider a stochastic number
of firms in each sector. The former assumes that the number of firms follows a geometric distribution, while the latter draw from
a combination of Pareto distributions. In those papers there is no endogenous entry and hence no potential entrants.
     6 In our main comparative static exercises reduced output--which the household experiences as lower dividends and wages--

would lead to wealth effects on labor supply. We discuss the implications of this in Section 5. It would be straight-forward to add
this to the model and quantify its effects, especially given the block recursive structure of the model which we describe below.
     7 In the full model, the household also owns the capital stock which it rents out to firms at rate R and which depreciates each
                                                                                                           t
period at rate . This yields an Euler equation that pins down the equilibrium rental rate of capital: Rt = 1/  - (1 - ).


                                                                  6
Firms. Firms are heterogeneous in productivity, with Total Factor Productivity (TFP) denoted by zijt . The
production technology is linear in labor where the quantity of output yijt = zijt nijt .8 In this Section there is
no capital as an input in production, but firms must employ  units of fixed or overhead labor, also at wage
Wt , in order to produce. Firms face no adjustments costs over time, as we discussed in the introduction.
Such adjustment costs would imply state-variables, and doing so with more than two firms is currently
computationally intractable.
    Individual firms are heterogeneous in productivity zijt , which evolves stochastically. We assume that
the firm-specific technology follows an AR(1) process
                                                                                     1 2
                              log zijt+1 =  log zijt +     ijt   ,    ijt   N    -       , 2 .                                 (1)
                                                                                     21+

The adjustment to the mean of  ijt ensures that the cross-sectional mean of zijt (in levels) is one.9
    Because there are no adjustment cost, the state vector of market j is z jt = (z1 jt , . . . , z Mjt ). Granularity
within each sector causes "market-specific" shocks to emerge from the idiosyncratic shocks faced by firms
(Carvalho and Grassi, 2015). However with a continuum of sectors, these sectoral shocks wash out in the
aggregate: i.e. the distribution across markets z j  G (z) is constant.10 We further assume no aggregate
shocks. These features mean we can drop time subscripts and references to an aggregate state.
    Even though firm production decisions are static, the AR(1) process for productivity means we can
analyze firm dynamics. Productivity shocks lead some firms that were in the market in one period to exit
in the next, and vice versa. This allows us to measure business dynamism and entry/exit behavior. In
the quantitative exercise, we measure business dynamism between two adjacent periods with identical
parameters but different realizations of the shocks. We then investigate how such measures change over
time from steady-state to steady-state as parameters vary.

Timing.       At the beginning of each period, productivity shocks for the M potential firms in each sector are
realized, which determines z jt . Given the realization of the shocks, firms decide to enter the market and
produce which requires hiring the overhead fixed labor  or stay out and pay zero. Firms that enter the
market then make their production choices.

Market Competition and Equilibrium.                 The equilibrium concept within each market is a Nash equilib-
rium. Dropping time subscripts, we first describe the production stage once M j firms have entered the
market. With a finite number of firms in each market, firms exert market power. We model firms' conduct
by means of Cournot quantity competition.11 Indirectly, firms compete with all firms in the economy, in-

    8 We have also analyzed the case with decreasing returns to scale yijt = zijt nijt , 0 <  < 1 which yields comparable results.
    9 Since the mean of z (in logs) is -(1/2)2 /(1 - 2 ).
   10 By way of comparison, note that in the `micro-to-macro' shocks literature, idiosyncratic shocks do not wash out in the aggre-

gate. See for example Gabaix (2011), Gaubert and Itskhoki (2016), and Carvalho and Grassi (2015).
   11 Our results also hold under Bertrand competition, with imperfectly substitutable goods. See Appendix A.3



                                                                 7
cluding firms in other markets - j, but with a continuum of other markets there are no strategic interactions
between firms in market j and j . Each firm is therefore infinitesimally small relative to all firms in other
markets and take the price indices of all other markets p- j as fixed.
      Within a market j, there is strategic interaction. Firm i chooses its quantity yij , taking as given the
quantities y-ij of its M j - 1 competitors. Then, given market demand, the firm produces up to its demand
curve, delivering the profit function
                                                                                                     W
                                max  (yij , y-ij ) = max p(yij , y-ij , P, Y )yij -                              yij ,                         (2)
                                 yij                        yij                                      zij
subject to the inverse demand curve p(yij , y-ij , P, Y ) from household optimality and constant marginal cost
W /zij due to the linear production technology: yij = zij nij . Firms solve for the Cournot-Nash equilibrium
in their market. This delivers variable labor demand from each firm nij z j , W , P, Y .
      The general equilibrium solution in addition requires feasibility and market clearing. Aggregating firm
level labor demand due to variable and fixed inputs delivers the aggregate labor demand curve:
                                                          Mj                                                 1
                           N d (W , P , Y ) =
                                                      R+
                                                       M
                                                          nij       z j , W , P, Y dG z j +
                                                                                                         0
                                                                                                                 M j  dj.                      (3)
                                                         i =1


      During the entry stage, prior to production, the number of competitors M j is determined in equilibrium.
Firms observe their own productivity, as well as those of all competitors z j , and have rational expectations
with respect to (W , P, Y ). It is well known that due to the strategic interaction in the production stage, mul-
tiple equilibria with entry of different firms may arise when entry is simultaneous. We use an equilibrium
selection device following Berry (1992), which we discuss below.

2.2     Solution
Household solution. The solution to the household problem consists of demand functions for each firm's
output, and a labor supply condition. Demand for the goods of firm ij is given by12
                                                                              -                            -
                                                                 pij                p j ( pij , p-ij )
                          c( pij , p-ij , P, C ) =                                                                   C,                        (4)
                                                         p j ( pij , p-ij )                 P
                                                                                   1
                                                                    Mj            1-                                                  1
                                                           1                                                     1                   1- 

                                                                   
                                                                           1-                                             1- 
                     where     p j ( pij , p-ij ) =                       pij            ,    P=                     pj         dj         .
                                                           Mj      i =1                                      0


Aggregate real consumption is C. The allocation of C to market j depends on the level of the sectoral price
p j relative to the aggregate price P. The allocation of expenditure to firm i is then determined by the level of
firm i's price pij relative to p j . The aggregate price index is the number P such that PC is equal to aggregate
expenditure:                                                       1 Mj
                                                       PC =           pij cij dj.
                                                                  0 i =1
                                                                                                                                               (5)

  12 The   complete derivation is standard, and can be found in Appendix A.


                                                                     8
    The household's labor supply curve is obtained by taking first order conditions of (1) with respect to N ,
and C: N S (W ) = W  . GHH preferences imply that labor supply depends only on W . The labor supply
curve with constant Frisch elasticity can be interpreted as representing either the intensive margin labor
supply of the continuum of workers in the household (hours worked for each worker) or can similarly
be derived as the extensive labor supply among the workers (number of members working fixed hours).13
When we compare the implications of our model to the data we will take the extensive margin labor supply
interpretation and look at aggregate employment.

Firm solution. We solve the firm entry and production decisions backwards. Given a continuum of mar-
kets, firms take as given their beliefs about aggregate outcomes (W , P, Y ). In the last stage, for a given
number of entrants M j , firms choose their output yij taking into account the strategic interaction with the
other firms y-ij in market j. The first order condition of the profit maximization problem (2) are standard:
                                           pij (yij )yij              nij                         1           W
                          pij (yij ) 1 +                      =W                 pij (yij ) 1 +         =                                    (6)
                                               pij (yij )             yij                          ij         zij
where  ij is the residual demand elasticity, and yij /nij = zij follows from the linear production technol-
                                                              pij - mcij     1               W
ogy. Equation (6) automatically leads to the Lerner formula:             = - where mcij = .
                                                                  pij        ij               zij
Market equilibrium. In Appendix A we derive the standard result that under CES preferences, the
unique Cournot-Nash equilibrium allocation among M j entrants satisfies:
                                 W                              ij
                pij   =    µij             ,     µij =                                                                                       (7)
                                 zij                         ij + 1
                                                                            -1                                                     1- 
                              log yij                1          1                                   pij yij             1    pij
      where      ij := -                        = sij + 1 - sij                   ,    sij :=     Mj
                                                                                                                    =                    .   (8)
                              log pij                                                           i=1 pij yij             Mj   pj
                                        y-ij



The optimality conditions are represented via the markup µij , defined as price over marginal cost, and sij is
firm i's share of market j revenue. The firm faces a residual demand curve that is iso-elastic with elasticity
 ij , which is itself determined by the revenue share of the firm sij .               14


    The residual demand elasticity in equation (8) determines the markup and is directly related to the
firm's market share. Firms with a higher market share sij have steeper residual demand and set higher
markups. Those firms with a market share close to one have a residual demand elasticity equal to  , while
firms with a market share close to zero have a residual demand elasticity approximately equal to  . The
former effectively behave like monopolists within the market, and only take into account the substitution
of goods outside of market j. Those goods are not close substitutes since  <  . Instead firms that have a

  13 Formally, if each member of the household supplied either 1 or zero units of labor, and drew a Generalized Extreme Value

(GEV) distributed utility cost of working with tail parameter 1/ , the aggregate labor supply curve would be identical to that
which we derive here. See Berger et al. (2019).
  14 The Bertrand-Nash equilibrium is identical in the entire system of equations except for the residual demand elasticity. Under

Bertrand instead, we have  ij = sij  + 1 - sij  .


                                                                       9
small revenue share, face fierce competition from firms within market j. Their residual demand curve is flat
as the goods within the market are close substitutes, and markups are consequently lower.
    The only determinant of market shares and markups is the market j vector of entrant firm productivi-
ties: zj = ( z1 , . . . , z Mj ). Firms that are more productive (high zij ) can sell at lower prices and therefore take

a higher market share. Yet, relative to cost, their prices are high, that is, their markups are high: due to
their productive efficiency advantage, they also exert more market power and have a high market share.
Using the above equations we can explicitly express a firm's market share as a function of its productivity
and the market shares of its competitors as follows:
                                          -1
                                                    1-                                                                             -1
                                                                                                                                                 1- 
                         1            1
                     sij  + 1 - sij             1
                                                                                Mj           skj 1   + 1 - skj                1
                                                                                                                                              1 
                                                                            
                                                                                                                              
         sij =                                                                                                                                         .    (9)
                                                                                     
                                        -1     z
                                                                                                                                  -1         zkj
                                                                                                                                                 
                                                 ij
                  sij 1
                        +  1 - s ij
                                    1
                                           + 1                              k =1         skj 1
                                                                                                 + 1 - skj                1
                                                                                                                                       +1
This delivers M j equations in M j unknowns, representing the Nash equilibrium of the market. Importantly,
homotheticicity of preferences implies that this system of equations is block recursive in that it is indepen-
dent of all aggregate variables, implying that markups can be recovered independently of aggregates.15

Aggregation. Aggregate variables determine prices and quantities as follows. Here it is useful to first
define a sectoral markup µ j and aggregate markup µ, as those numbers that satisfy:
                                                       W                            W                      W
                                           pij = µij           ,     pj = µj             ,    P=µ                                                          (10)
                                                       zij                          zj                     Z
where the measures of productivity are defined as the weighted averages:
                                                                      1
                                                       Mj             -1                                         1
                                                                                                                 -1

                                                       
                                                                -1
                                   z j :=     M-
                                               j
                                                 1
                                                              zij               ,    Z :=            zj
                                                                                                        -1
                                                                                                                      .                                    (11)
                                                       i =1

A first result is that combining these and the definitions of the price indexes we can show that the sectoral
and aggregate markups are productivity weighted harmonic means:
                                                                      1                                                                 1
                                      Mj               -1            1-                                         -1                     1- 
                                              zij                                                     zj
                              j 
                                                              1- 
                       µ j = M- 1
                                                             µij            ,        µ=                               µ1
                                                                                                                       j
                                                                                                                         -
                                                                                                                           dj                .             (12)
                                     i =1
                                              zj                                                      Z
                                                 ij                                                        j

Here the terms  ij and  j , which we use again below, are well-defined weights (between zero and one, and
sum to one). Since markups are determined independently of aggregates, then so are µ and Z.

Wages.     Given productivities in market j, z j , solving (9) delivers equilibrium market shares, indepen-
dently of any aggregates, which in turn deliver markups (7). The relative price of final output to variable
labor is then determined by the goods market clearing condition, which is simply the price index under pij




   15 Throughout we abstract from wealth effects on labor supply. This result implies that wealth effects on labor supply will have

no effect on markups.


                                                                       10
given by (7). This can be inverted to obtain the relative price of labor:
                                                              W               W   Z
                                                      P=µ                       =
                                                              Z               P   µ
These objects have intuitive interpretations. If all firms had markups µij = 1, which would be implied by
an efficient allocation in which shadow prices of goods are equated to marginal revenue products, then
under the normalization P = 1 the wage would be W = Z. This is not equal to one despite E zij = 1, due
to productivity dispersion and imperfect substitutability of goods. If all firms had the same productivity
zij = 1, and markups µij = µ, then the wage would be W = 1/µ. A higher markup increases the relative
price of goods, which with the normalization P = 1, decreases the wage, and can occur either due to higher
markups µij , or higher productivity at high markup firms, increasing the weights  ij on high markup firms.
Labor demand.      We can write the demand for labor N d (W , ·) in a way that similarly makes clear the
wedges introduced by markups. Labor demand is the sum of the demand for labor as a variable input and
the demand for labor as fixed cost, which can be written as follows, where  :=                                  M j dj
                                                                                                     
                                                                                                                           -
                                                                                                                               
                                                                    -                        -          Mj
            W                             Y                  W /P                       µj                       µij
       Nd     , Y , µ, , Z ,     =             ×         µ                    ×    j              ×    ij                       dj +
            P                             Z                   Z                         µ               i =1
                                                                                                                 µj
                                     µij = 1       Uniform markups: µij = µ       Wedge  due to markup heterogeneity: µij


First, if Y / Z is higher, then more labor is required in production. Second, higher wages (W / P) relative
to productivity Z increases firms' marginal cost. Under constant markups, this would increase prices
with a unit elasticity, reducing quantity demanded with elasticity  , which with constant returns to scale
in production reduces labor demand one-for-one. If all markups increase through µ, keeping marginal
costs fixed, this has the same effect. Prices increase, which chokes off demand by households and reduces
the quantity of inputs demanded by firms. If markups are efficient, then µ = 1, and the second term
disappears, as P = W / Z. Third, the wedge  shifts labor demand and is due to, and increasing in, the
correlation between productivity and markups. If markups are equal, then the ratios of markups in  are
equal to one, and since the productivity ratios  ij and  j are weights, then this term disappears.

Equilibrium formation.          Combined, we have three general equilibrium conditions. The labor supply
curve, labor demand and the goods market clearing condition which determined { N , W , Y }:
                                                                                                   -
            W            W                           W                                     W /P          Y                 W   Z
       Ns         =                   ,       Nd       , Y , µ, , Z ,         =        µ                   +           ,     =
            P            P                           P                                      Z            Z                 P   µ
                                                                                                                 Y   Z
                                                       Combined, give labor productivity of production labor:      =
                                                                                                                N-   

   Normalizing P = 1 and setting Z = 1, Figure 1 plots shows how this equilibrium in the labor market
is formed and the economics behind comparative statics. Panel A describes how the wage is first pinned
down by goods market clearing, and then output adjusts to clear the labor market. In Panel B we consider


                                                                    11
            A. Baseline equilibrium                                    B. Higher markup: µ1 > µ0                                   C. Misallocation: 1 > 0

     W                                  N s (W )                 W                                     N s (W )              W                                N s (W )
                                                                                   < Y
                                                                                 Y1                                                         < Y
                                                                                                                                          Y1
                                                                                       0                                                        0
                                                                                   < N
                                                                                 N1                                                         = N
                                                                                                                                          N1
                                                                                        0                                                        0
                                                                                  
                                                                                 W1 < W0                                                   
                                                                                                                                          W1 = W0 



    W                                   W (µ)                    
                                                                W0                                     W ( µ0 )               
                                                                                                                             W0                               W (µ)
                                                                 
                                                                W1                                     W ( µ1 )


                                                                                                                                                                     P , Y0 , µ0 , 
                                                                                                                                                             Nd      W    
                                      N d (W , Y , µ ,  ,  )                                                    , µ , ,  )
                                                                                                     N d (W , Y0   0
                                                                                                                                                             =   Nd          , µ,  , 
                                                                                                                                                                       W , Y1
                                                                                               , µ , ,  )
                                                                                    N d (W , Y1                                                                                   1
                                                                                                  1

                      N                  N                                                              N                                                        N


                                                                     Figure 1: General equilibrium
Notes: In all cases we have normalized P = 1, and to save on notation set Z = 1. A decrease in Z would have the same affect as an
increase in µ (panel B): the wage would decrease, aggregate labor supply would move along the supply curve and output would
decrease such that labor demand and supply are equated. An increase in  would have the same affect as a decrease in  (panel
C): fixed costs do not enter firms' marginal conditions which pin down their price relative to the wage, and hence the equilibrium
wage would remain constant. Labor supply is unchanged, to equilibrium total employment remains constant and instead labor is
reallocated from production to overhead, causing output to fall.

an increase in µ. A higher markup, causes the relative price of goods to increase, which with P = 1
                            < W  . As labor supply falls along its supply curve, the economy produces
leads the wage to fall to W1   0

less goods, with production contracting until the labor market clears. If we allowed for wealth effects,
then the drop in output would slightly shift out the labor supply curve, reducing some of the decline in
employment, and leading to a larger decline in the wage. In Panel C, we consider a pure increase in 
due to higher correlation of productivity and markups, keeping µ fixed. Ceteris parabus this expands labor
demand, but does not affect the aggregate wage which depends only on Z and µ. This leaves equilibrium
                                                                            < Y  . Not shown here, we
labor unchanged. As such, output must be lower to clear the labor market: Y1   0

can reason through the effect of higher fixed costs . A higher  increases labor demand, but has no affect
on the wage, which is priced in terms of variable factors. With no change in the wage, equilibrium total
employment is unchanged, and labor is simply reallocated from production to labor. This accommodates
the required drop in output. The observed shift in the equilibrium would therefore look like Panel C.

Entry. The above delivers the general equilibrium of an economy with a given number of firms in each
market { M j }1
              j=0 . We now consider how the equilibrium set of firms is determined. For a given set of can-

didate entrants in all markets, the above equilibrium delivers a wage W and output Y , which are necessary
to compute firm profits. A firm will operate if:
                                                                           W
                                             ij = µij - 1                      × y pij , p-ij , Y -                      W          0.                                                  (13)
                                                                           zij
                                                               Per unit profit                 Units                 Fixed costs

We use an equilibrium refinement device first introduced by Berry (1992). An equilibrium is selected as
follows. We start with all firms in every market ( M j = M for all j), which gives aggregate productivity Z,
and solve the market equilibrium for markups {µij }ij which gives the aggregate markup µ and wedge .



                                                                                            12
We then solve the general equilibrium for W and Y . This allows us to compute profits net of fixed costs
(13). Of the firms with negative profits, the firm with the lowest profits exits first. Calculating profits again
with one fewer firm, profits will have weakly increased.16 Continuing this way we obtain a set of firms
such that, under general equilibrium prices and quantities implied by { Z, µ, }, no firm that chooses to
stay out of the market would have positive profits.17 Note that the algorithm delivers a refinement of the
Nash equilibrium of a simultaneous entry game, which is not the same as the subgame perfect equilibrium of a
sequential entry game, in which case one would have to consider limit pricing strategies.
      An alternative algorithm starts with the highest productivity firm operating and considers expanding
the set of entering firms down the productivity distribution until the additional entrant earns negative
profits. We find that both algorithms reach the same set of firms operating in equilibrium.


2.3     Comparative statics

We are interested in how primitives of the model that relate to market structure and technology affect
equilibrium aggregates and moments implied by the model. To this extent we describe the economics
behind the effects of changing the parameters that we estimate annually in our quantitative exercise below.
Market structure changes with the number of potential firms M, and technology changes with the size of
productivity shocks , and the size of fixed costs . We study two classes of outcomes. The first are the three
moments that we will use to estimate these parameters in Section 3: markups, employment reallocation
rate, and the composition of costs. The second are equilibrium aggregate outcomes of the model: measured
labor productivity Y / N , wage W , output Y and welfare U (C, N ).
      Our key result is that depending on the source of the change, higher markups can be accompanied
by increasing or decreasing business dynamism, increasing or decreasing cost structures, increasing or
decreasing or flat welfare. This provides arguments for identification and sets up the counterfactual de-
compositions of moments and aggregates.

Business dynamism.            To understand how changes in the parameters of the economy can affect business
dynamism, we consider the employment reallocation rate. In empirical work this is often defined as total job
creation and job destruction minus net job creation as a fraction of average employment over two periods
(see Davis et al., 1998). In our stationary model, net job creation is zero, and aggregate employment is


   16 In the computational exercise, there is a large but finite set of markets
                                                                             J so a large but finite set of potential entrants. Therefore
a single firm exits. In the theory, with a continuum of firms, a small but positive measure of firms exits.
    17 A subtle point regarding entry is the absence of limit pricing. Limit pricing occurs in the subgame perfect equilibrium of a

sequential move games, where a leader chooses their quantity first. This may be chosen such that a follower best-responds to this
quantity by not operating. Since our game features a Nash equilibrium of a simultaneous moves, this requires all firms' quantity
decisions to be a best response to the quantity decisions of their competitors. Firms best respond to the positive quantities of their
operative competitors, and the zero quantities of their inoperative competitors, and do not reason to a next step.


                                                                   13
constant, giving the following which admits a simple decomposition:18,19

                        JC + JD              JC Inc + JD Inc                   JC Ent + JD Exit        N Prod
              RER =             =                                      × 1+       Inc      Inc
                                                                                                ×                  .              (14)
                           N                      N Prod                       JC + JD            N Prod + N Fixed
                                          A. Incumbent production       B. Composition of JC and JD          C. Fixed labor

The first term relates to productive labor at incumbent firms ( Inc) and depends on pass-through of changes
in marginal cost to prices and the residual elasticity of demand faced by a firm. To see this, note that
JC ( JD ) decreases if firms' positive (negative) employment response to a positive (negative) productivity
shock becomes smaller in magnitude. With linear production, employment is nijt = yijt /zijt . A first order
approximation of the employment response to productivity shocks is therefore:
                               d log nijt   d log yijt d log pijt
                                          =                       - 1 =  sijt                  sijt         -1.                   (15)
                               d log zijt   d log pijt d log zijt
                                                                                  Elasticity Pass-through

We can therefore discuss the reallocation rate of incumbents in terms of these objects which are endogenous
in our model. We return to this expression in the validation Section 4 where we show that these features
rationalize changing reallocation rates among small and large firms.
    Reallocation also occurs on the extensive margin due to job creation by entering firms ( Ent) and job
destruction by exiting firms ( Exit), which gives the second term. The second term shows that if entering
and exiting firms are larger then reallocation rates will also be higher. This will be the case if (i) the cut-off
productivity for entry is higher, or (ii) firms receive large shocks that lead them to exit while being far from
the cut-off in the period prior to exit.20
    The third term reflects the simple fact that if more of labor is overhead, then reallocation rates will be
lower, since overhead labor does not fluctuate.

Markups and composition of costs.                     Throughout we consider the sales-weighted average of markups in the
economy as in De Loecker et al. (2020), which we denote µ. We also consider the sales-weighted average
of firm level fixed costs to total costs, which we denote :
                                    Mj                                             Mj
                                            pij yij                                      pij yij        W
                          µ :=               PY
                                                        µij dj ,   ,     :=               PY          W  + Wnij
                                                                                                                .                 (16)
                                   i =1                                           i =1

Changes in average markups can therefore be due to reallocation effects -- more sales accruing to higher
markup firms -- or within firm changes in markups, as firms increase their markups keeping the distribu-
tion of sales fixed. In Section 4 we study this decomposition in detail comparing model and data. Note,

   18 To  be precise, JCt := j i j max{nijt - nijt-1 ), 0}dj and JDt := j i j max{nijt-1 - nijt , 0}dj.
   19 An   alternative moment used in the literature to capture business dynamism is the dispersion of firm growth rates:
Std ( log nit ). This, however, is closely related to the reallocation rate -- which is the integral under both sides of the employment
change distribution. The reallocation rate can also be cleanly decomposed which we use later on.
   20 Equivalently, if shocks take firms from below the entry threshold to far above the entry threshold, then job creation by entry,

JC Ent , will be larger.


                                                                        14
      Figure 2: Equilibrium comparative static effects of changes in market structure and technology
Notes: The vertical black dashed line gives the halfway point between the minimum and maximum estimates of the relevant
parameter over 1980 and 2016 from out estimates in Section 3 (see Figure 4). In each case we move only one parameter at a time,
and recompute the general equilibrium of the model and the associated moments. In column 2, the additional dark red dashed
line in panels 2{A,B,C} corresponds to the case where  is increased or decreased and  is, respectively, decreased or increased in
order to keep the unconditional standard deviation of log zij constant.

however, that a reallocation of sales to larger firms would lead to lower , as the firm-level ratio is decreasing
in size.

Comparative Statics Results. All comparative static results are given in Figure 2. The first column plots
comparative statics with respect to M, the second with respect to , and the third with respect to . To
provide context, we consider deviations of the parameter around the half way point between the minimum
and maximum estimated values over 1980 to 2016 in Section 3. This value is marked by a vertical black
dashed line. We order the x-axes by considering comparative statics that increase markups, which are given



                                                               15
in the first row of plots.

Market structure - M. We first consider the effect of a change in market structure that leads to an increase
in markups: a decline in M. With fewer potential firms, holding technology fixed, the number of operating
firms declines. This leads to higher markups at each firm as market shares increase, and reallocation of
sales to higher markup firms, both contribute to higher µ. It also leads to a decline in business dynamism
as measured by the reallocation rate. As market shares increase, the residual demand elasticity (sij ) faced
by operating firms decreases, making quantities less responsive to changes in prices.
   Prices themselves are also less responsive to productivity as pass-through (sij ) is declining in mar-
ket shares over the region of market shares that are obtained in equilibrium. In fact (sij ) is U -shaped.
With a market share around zero, markups are constant at µ =  /( - 1), and as a result pass-through
 log p/ log z = 1. With a market share of one, markups are constant at µ =  /( - 1), and the same ob-
tains. With interior market shares, an increase in productivity leads to an increase in market share, and an
increase in the markup which yields  log p/ log z < 1. Over the relevant range of market shares obtained
in the equilibrium of the estimated model, (sij ) is declining in sij , i.e. the left side of the U -shape. This
comparative static qualitatively suggests a link between market power and business dynamism. Quanti-
tatively, however, note that (i) the 25 ppt decline in the reallocation rate is quantitatively large, and more
than the 10 ppt decline we will see in the data (Figure 3B, below), while (ii) the 4 ppt increase in markups is
quantitatively small, and less than the 33 ppt increase we will see in the data (Figure 3A, below). To match
the data we will need larger increases in markups, and smaller declines in reallocation rates.
   Moreover, an increase in M leads the composition of costs to move in the opposite direction to the data.
Fewer firms are now larger on the intensive margin of production employment, reducing the level of fixed
costs in total costs. We will also need a force that increases fixed costs in production.
   Turning to aggregates measures of economic activity, we consider two measures of labor productiv-
ity: that which comes only from production labor (red, dashed line), and overall labor productivity for
the economy as a whole (blue, solid line). As market power increases, production labor productivity de-
clines. Higher markups generate an aggregate efficiency cost in the economy. To illustrate this, abstracting
from over-head labor, we can start with N =                        i
                                                                       (yi /zi )di, and use the markup pi = µi mci under exoge-
nous markups µi , marginal cost mci = W /( Zzi ), and the demand curve of a monopolistically competitive
economy yi = ( pi / P)- Y to compute aggregate production labor demand:
                                                                                                   -1
                                                                                                 
                                                                                              1 
                                                             1               -1               -1 
                                                                                                 
                                                                                                            -
                                   
                                             -1
                                                             -1            zi         -
                                                                                                        W
                        N Prod =      Z    zi   di                           -1
                                                                                     µi di                      Y          (17)
                                                                           zi   di                      P
                                                                                               
                                                   = 1 for all i
                                    TFP if µ                                                   
                                               i                              i


The term in {·} gives aggregate productivity. The first term is aggregate productivity under zi = µi = 1,


                                                                         16
the second term accounts for productivity heterogeneity with µi = 1, and the third term accounts for
markups. Markups constrain factor demand for a given Z, lowering labor productivity. Qualitatively, this
can occur both directly, as higher markups µi decrease demand, and if the correlation between produc-
tivity zi and markups µi increases (i.e. more `weight'  i on higher markup firms). Later on, we evaluate
this decomposition quantitatively. A decrease in M has both such effects. The decline in overall labor pro-
ductivity is muted as the fixed component of labor demand is unaffected by markups. Lower aggregate
productivity translates into lower wages, output and welfare (panel D).
   In summary, if markups increase due only to changes in market structure, business dynamism declines,
while the composition of costs moves counterfacutally, and measures of aggregate economic activity de-
cline. We now consider technology in two parts, the effect of changes in the dispersion of shocks to variable
factor productivity  and changes to the productivity of fixed factors.

Variable cost - . Increasing the dispersion of productivity shocks faced by firms increases the cross-
                                                                           1 
sectional dispersion of latent, or unselected, productivity: log zijt  N - 2     , 
                                                                             1- 2 1- 2
                                                                                       . This leads to an
increase in markups. As more productive firms become more productive, and less productive firms become
less productive, the market shares of highly productive firms increase, increasing their markups. Also,
with higher productivity, a greater share of sales is allocated to them. Both of these forces lead the sales-
weighted markup to increase. Consider a market with two firms. Then a mean-preserving spread leads to
a higher market share of the more productive firm as well as higher markups. Eventually, as that firm's
market share approaches one, it behaves as a monopolist, despite there being two competitors.
   In terms of the other two moments, the increase in volatility increases business dynamism and reduces
the ratio of fixed to total costs. First, with more volatility in productivity, the reallocation rate increases,
counteracting any decrease in pass-through and lower demand elasticities of larger firms. Second, more
dispersion in productivity leads the fraction of costs that are fixed to decline. Larger firms become larger
on the intensive margin of production labor, causing the share of fixed costs in total costs to fall.
   Contrary to the implications of higher markups via changes in market structure, an increase in markups
due to changes in variable productivity leads to higher labor productivity. This is due to two forces, se-
lection and reallocation. In terms of selection, an increase in dispersion of productivity with endogenous
entry leads to asymmetric productivity effects. Firms which otherwise were not entering have lower pro-
ductivity, while firms that otherwise were entering now have higher productivity. At the margin, firms
that were previously operating now exit as their more productive competitors cut their prices, reducing
the profits of marginal firms. This leads to greater selection and higher aggregate labor productivity. In
terms of reallocation, even if markups were constant and the measure of firms constant, (17) shows that
TFP would be higher, as the second term in {·} is convex in productivity. Again, the effect is muted for



                                                      17
total labor productivity since the increase in dispersion in variable factor productivity does not directly
affect fixed labor productivity.
   In terms of aggregates, the increase in aggregate productivity leads to higher wages, higher output
and higher welfare. The effect on wages is somewhat decoupled from output and welfare due to higher
markups acting as a force that dampens the increase in labor demand.

Fixed cost - . Finally we consider an change in fixed costs . Increasing fixed costs have a similar affect
as a decrease in M on markups. With higher fixed costs, less firms operate, loosening competition and
increasing the market shares and markups of the most productive firms. Similar to an increase in , the
reallocation rate increases. This may seem puzzling, given that with fewer firms demand elasticities are
lower and pass-through rates are lower. The off-setting force here is job creation and job destruction by
entrants, the second term in (14). With higher fixed costs, the firms that are entering and exiting are now
higher productivity and larger when operating. As opposed to shedding a few workers when hit with a
negative productivity shock, these firms now exit leading to large amounts of job reallocation. Figure C5,
which we reference again later, shows these comparative statics.
   The effects of higher fixed costs on labor productivity now diverge across our two measures. With
higher fixed costs, operating firms are more positively selected on productivity. This leads labor produc-
tivity measured in terms of production labor to increase. Despite this, overall labor productivity falls, as
more labor goes into overhead and less into the production of goods. On net, the efficiency gains through
higher selection are eroded by higher fixed costs.
   The net effect on aggregates is therefore hump-shaped. The efficiency gains from selection lead output
wages and welfare to increase. The efficiency losses due to higher overhead lead output wages and welfare
to decrease. The end result is hump-shaped profiles that are flat relative to our previous two comparative
static exercises.

           A. Comparative static                    B. Moments                         C. Aggregates
                                                                 Fixed costs
                                         Markup   Reallocation                 Y/ N       Y    W       U
                                                                 Total costs
           I. Market structure   M          +           -             -            -       -    -       -
                                            +          +             -             +      +     +       +
           II. Technology
                                            +          +             +             -     +/-   +/-     +/-

                                 Table 1: Summary of comparative static results.

Summary. These comparative statics deliver three key results which we summarize in Table 1. First, the
source of increasing markups matters for welfare. Declining M reduces welfare, increasing  increases
welfare, while the off-setting selection and overhead effects of an increase in  have an ambiguous ef-
fect. Second, there is no clear mapping between markups and business dynamism. A decline in M leads


                                                       18
both markups to increase and reallocation rates to fall. Meanwhile higher markups through either of our
technology channels lead reallocation rates to increase.
      Finally, the joint movements of the moments we are studying puts discipline on the parameters that we
seek to estimate. This is reflected in the shading of the panels in Figure 2: green for a positive effect and red
for a negative effect. Each parameter moves the moments we study in a unique pattern, which we have
described in detail. We now use the data on these moments to quantify the model and understand which
of these forces has been operative in the US from 1980 to 2016.


3     Quantification
We estimate the model using a combination of Compustat and Census Business Dynamics Statistics (BDS)
data from 1980 to 2016. From the BDS we compute the annual labor reallocation rate. In order to take
the model to Compustat data, we extend the model to include capital and intermediate inputs. We first
describe how we extend the model, then we discuss the model and data counterparts of the moments
used in the estimation. We then estimate the model annually. Throughout we normalize the productivity
process to have mean 1, so we abstract from average productivity growth. The moments that we target are
not affected by this normalization.

3.1     Extended model and moments

We extend the labor-only model of Section 2 so that we can map cost and markup measures from the data
into the model. We treat model and data annually. This implies that the previous comparative static results
apply, and the extended model only affects the mapping of the model to the data. In Appendix B we
present a detailed discussion of how we extend our model to include capital and intermediates, and how
we then map that model to Compustat data.

Moments.       We are interested in the following moments: the markup, the ratio of fixed costs to total costs
and the reallocation rate.

    1. Markup. The measure of markups in terms of the data (as discussed in Appendix B) is given by: µit =
        COGS /(COGSit /Salesit ), where optimality implies that the output elasticity COGS can be measured
        from the share of costs of goods sold in total variable costs:
                                                           COGSit
                                           COGS =                           .
                                                    COGSit + CapitalCostsit
        The expression from the model is equation (B5).
    2. Fixed costs. For our measure of fixed to total costs we use the data to compute the ratio of total SGAit
        to TotalCostsit , which in the model is:
                                               SGAit               
                                                          =       COGS
                                                                         .
                                             TotalCostsit   nit /      +
                                                        19
   3. Reallocation rate. The reallocation rate is constructed using changes in total employment (nit + ),
        which gives                                            +                   -
                                               i (nit+1 - nit ) + i (nit - nit+1 )
                                      RERt =       1
                                                                                     .
                                                   2 ( i nit + i nit+1 ) + Mt 
In our underlying model discussed in detail in Appendix B, labor and intermediates are perfect substitutes
in production and overhead, which leads to parameters COGS and SGA that we can choose to pin down
their shares. Note that COGS and SGA do not enter into any of the above moments so in our estimation
they could take on any value. For simplicity, we make the following assumption. Since we only observe
total labor payments, let  := COGS = SGA . We can then measure  from the ratio of total labor costs to
COGS and SGA:
                                                   TotalLaborCostsit
                                               =                     .
                                                   COGSit + SGAit
Aggregation. When computing aggregate counterparts to the first two of these moments, we weigh by
firm sales shares (the reallocation rate is already at the economy level). Note that this maintains the inde-
pendence of the moments from COGS and SGA . From the markup expression, Salesit = µit COGSit /COGS ,
which is independent of these parameters.

3.2     Approach
Our approach is to estimate the model every year from 1980 to 2016. Holding parameters fixed, the model
has no aggregate dynamics. With the exception of the reallocation rate, all other moments can be computed
using data from a single year in the model. The reallocation rate requires two periods. In our approach, we
maximally exploit the static solution to the oligopolistic-firm problem in many markets in a large economy,
simply because we cannot solve a fully dynamic problem with strategic interaction. The labor dynamism
that we analyze stems from labor force adjustments and entry and exit of firm between periods, each of
which is the static (yet strategic) solution to the firm problem.
      We keep the following parameters of preferences and technology constant across years:
      - Preferences. Aggregate labor supply elasticity ( ), elasticities of substitution within and across sec-
        tors: ( ,  ), discount rate ( ).
      - Technology. Production function factor demand elasticities (COGS ), labor input share of labor and
        intermediates (), depreciation rate (), persistence of productivity ().
The parameters we allow to vary annually were covered in our earlier comparative statics: (i) the number
of potential firms in each sector Mt , (ii) size of innovations to firm productivity t , (iii) fixed labor costs t .
      This leaves the parameters  and  , which we determine as follows. Along with  and  , we have
3 parameters to estimate for each of 36 years: { Mt , t , t }2016
                                                             t=1980 , giving 36 × 3 + 2 = 110 parameters. For

these we use time-series of our 3 moments over 36 years. This leaves us short two moments for  and  . We
drop the parameters from the mid-point year 1995 from the estimation, setting them equal to their values


                                                         20
   Parameter                                                                           Value    Source
   Labor Supply Elasticity                                                               0.25   Chetty et al. (2011)
   Discount rate                                                                         0.96   Real interest rate 4% p.a.
   Depreciation rate                                                                     0.12   De Loecker et al. (2020)
   Productivity persistence                                                              0.90   Decker et al. (2017)
   Factor share: Labor plus intermediates in variable cost         COGS = 1 - k          0.88   Compustat data
   Factor share: Labor in labor plus intermediates                 = COGS = SGA          0.33   Compustat data

                                               Table 2: Fixed parameters.

in 1994. However we still include the 1995 moments in the estimation. This gives us (36 - 1) × 3 + 2 = 107
parameters to estimate using 36 × 3 = 108 moments. The parameters  and  are important for pinning
down the average level of markups over the period, while movements in other parameters determine their
path. To obtain our data for 1980 to 2016 we use data from 1978 to 2018 and apply a five year centered
moving average to each of the moments.


3.3     Parameters
Externally chosen. Table 2 summarizes externally chosen parameters. We set the discount factor  = 0.96
such that the real interest rate is 4 percent, and the depreciation rate  = 0.12. This gives a rental rate
of capital R = (1/ ) +   1.16. The above expressions deliver COGS and  in a given year, we take
the median value within each year across firms, and then take the average across years to get a share of
intermediates and labor in variable costs of COGS = 0.88, and a share of labor in labor and intermediates
of  = 0.33. The labor supply elasticity is 0.25, consistent with micro-estimates (Chetty et al., 2011).
      We set  to 0.90. Given a process for TFP, the model generates a process for revenue TFP -- or TFPR --
at the firm level, which is less persistent. This lower persistence is due to the fact that TFPRi is proportional
to the markup µi , and increases in productivity lead to higher markups. Decker et al. (2017) estimate a
persistence of TFPR of 0.65. A value of  of 0.90 delivers this on average over 1980 to 2016.21 Decker et al.
(2017) also estimate parameters of TFP processes in two different ways, however using these would not be
appropriate in our context. In both cases TFPi is obtained by deflating revenue at firm i by a common price
index for sector j. This would be an incorrect procedure in our model, since firms' prices differ substantially
within a sector, and in a way that is relates to firm TFP. Nonetheless, their estimates point to TFP being
more persistent -- with an auto-correlation of around 0.80 -- than TFPR. We see the fact that the model
endogenously generates less persistence in TFPR (0.65) than TFP (0.90) as a realistic feature of the model.

Internally estimated.      Figure 3 shows the moments that are used in estimating the model and the model's
fit. The fit of the model is given by the red dashed lines, with the parameters that generate this fit given
in Figure 4. The two additional parameters estimated are  = 1.20 and  = 5.75, which are consistent
  21 The implied persistence of TFPR in the model is estimated by OLS of log TFPR on lagged log TFPR
                                                                                 it                  it-1 . In the model, the
implied value for 1980 is 0.62, and the implied value for 2016 is 0.72.


                                                             21
                                             Figure 3: Model fit - Moments
Notes: Moments are computed annually, we then apply a 5 year centered moving average, which is plotted here. We target these
smoothed moments in the estimation of the model, delivering the time-series of parameters which are plotted here.




                                             Figure 4: Parameter estimates
Notes: The actual number of firms in panel A is the unweighted average of M j across markets.

with alternative approaches in other papers that have studied markups and nested-CES preferences (see
Atkeson and Burstein (2008), Gaubert and Itskhoki (2016), and Burstein et al. (2019)).

3.4    Model fit
With only the three degrees of freedom available, the model is able to match the data very well. Our key
exercise in Section 6 will be to provide a quantitative decomposition of the changes in these moments into
components due to changes in each parameter. Here we provide a short description of the quantitative
identification of the model, referring the reader back to Figure 2 which provided a qualitative argument.
      To match the data both changes in technology and market structure are required: the number of po-
tential entrants declines, productivity shocks become larger and fixed costs increase. Since all parameters
move all moments, our argument is inherently illustrative. First, consistent with our comparative static ex-
ercises a decrease in M delivers both higher markups and lower reallocation rates, two key features of the
data. Second, as previously noted (Figure 2,1A-1B), a decline in M by itself this would lead to a decline in
reallocation rates that is quantitatively too large and an increase in markups that is quantitatively too small
relative to the data. To further increase markups and dampen the decline in reallocation rates, a higher
dispersion in productivity shocks is required. Third, both of these changes indirectly lead to a decline in


                                                              22
the average fixed cost due to their effect on intensive margin employment. This requires an off-setting
increase in , which increases average fixed costs.
      We consider an exercise that shows how the time-series for  is identified, in particular over the increase
and spike in its value post-2000. Appendix Figures C1 and C2 plot the three moments under a counter-
factual path for  that smoothly joins the 2000 and 2018 values, rather than the observed path Figure 4C.
Without the sharp increase in the size of productivity shocks the reallocation rate would have fallen much
more than in the data, and the markup would have undershot the data.
      We return to a more careful decomposition of the roles of technology and market power on these mo-
ments later in the paper, as well as assessing their impact on output, wages and welfare. First we show
that the model does an excellent job at accounting for changes in other, non-targeted moments over this
time period, in particular in terms of new cross-sectional facts regarding business dynamism, as well as
aggregates.


4     Validation - Aggregates, Business Dynamism, and Markups
We show that the model accounts well for key trends in the cross-section of firms since 1980: some that
have been documented in the literature, and some that are new. We study (i) the time-series implications
for aggregates; (ii) the time-series of the cross-section of small and large firm reallocation rates; and (iii)
the time-series of the decomposition of the average markup into reallocation and direct effects (De Loecker
et al., 2020). We view these as extended over-identifying tests of the model, as well as a novel contribution
in terms of documenting the empirical relevance of the model.

4.1     Aggregates
We compare the model's prediction for aggregate quantities to data on the labor share, real wage and
employment. These are plotted in Figure 5.

Labor share. We take data on the decline in the labor share from 1980 from Karabarbounis and Neiman
(2014), plotted in red dashed lines in Figure 5A. The labor share declined by around 3.5 percentage points
over this period. In the model, the aggregate labor share can be considered in two components. From the
expression of the markup in equation (7) and using the firm production technology yij = zij nij we obtain
an expression for the labor payment share of sales at the firm, which can then be aggregated:

                                                 Wnij + W          -1      W
                        Firm:   LaborShareij =                  = µij +                                     (18)
                                                   pij yij                 pij yij
                                                 ij Wnij + W                                  W
                   Aggregate:    LaborShare =
                                                    ij pij yij
                                                               =      sij µij
                                                                           -1
                                                                                      +
                                                                                              PY
                                                                                                            (19)
                                                                      ij

                                                                   Production labor       Overhead labor



                                                        23
                                                      Figure 5: Aggregates
Notes: In Panel A, data is the labor share taken from Karabarbounis and Neiman (2014), in percentage point differences from
1980. In Panel B, data is average hourly earnings of production and non-supervisory employees from CPS, normalized by TFP
from Penn World Tables, in level differences from 1980. In Panel C, the thin solid red-line plots the time series of the employment-
population ratio for prime-aged men multiplied by the population of prime-aged men in 1980, in log differences from 1980. The
red dashed line gives a quadratic fit to this data from the earliest data available (1977) through to the end of 2019, before the series
declines sharply due to the Pandemic Recession.


Higher markdowns imply lower shares of payments to labor, meanwhile higher fixed costs increase the
share of payments to labor. Aggregating we have a piece due to production labor that depends on markups,
and a piece that depends on overhead labor. Both of these, and the overall labor share are in Figure 5A.
    The model closely matches the data. Despite a large increase in the sales-weighted markup of 33 per-
centage points, the labor share--which depends on the sales-weighted inverse markup--decreases by only
4 percentage points. As pointed out by Edmond et al. (2019), the sales-weighted mean of inverse markups,
or equivalently the cost-weighted markup, is relevant for aggregate efficiency as measured by the wedge
 in the representative agent competitive factor demand condition: W =  MRPL =  ( PY )/ N . This is
exactly the labor share. To the extent that the model has a smaller decline in the labor share than implied
by the sales-weighted markup, it also has a smaller increase in the cost-weighted markup.
    In terms of the two components, the increase in overhead production costs has a smaller effect. Nonethe-
less, the increase is quantitatively relevant. Absent this increase, the labor share would have fallen by 4
instead of 3 percentage points.

Wages.      A key implication of our model is that as market power increases, wages decline. This occurs
even if the labor market is competitive and is due to the general equilibrium effect from the decline in labor
demand. Firms with market power sell less at higher prices, and therefore for a given an equilibrium wage
rate, they hire fewer workers. As a sizable fraction of firms in the economy have higher market power, this
leads to a decline in aggregate output and hence a decline in the aggregate demand for labor. This general
equilibrium effect in turn leads to a decline in the wage rate W , which drives a wedge between productivity
and wages. As discussed above, the divergence of wages and productivity is essentially another way of
thinking about the decline in the labor share, but nonetheless it is still worth describing, this time taking


                                                                  24
data on wages and productivity directly rather than taking data on the labor share as the starting point.22
and measure wages using production wages computed as average hourly earnings of production (goods
and services) and non-supervisory employees from the BLS. For the model, TFP is simply output divided
by employment, and we have the single wage measure W .
      As expected, given the labor share, the model and data measurements of Wt / TFPt align closely, with a
20 percentage point decline in wages relative to TFP. As firms with more market power restrict output, the
demand for labor falls, which moves the economy down along its labor supply curve. This is potentially a
striking insight: a decline in competitiveness in the output market causes a sharp decline in wages, even if
wages are determined in competitive labor markets.

Employment. In mapping the model to the data, we construct a measure of employment that abstracts
from population growth, and changes in female labor force participation over the period.23 The trend
decline in employment in the data is around 6 log points. The model generates about three quarters of
this decline. Note that not all of this decline is due to the decrease in the number of firms in the economy,
which happens early in our sample (Figure 4). Higher fixed costs and greater dispersion in productivity
shocks also lead to higher markups, thus contracting labor demand (recall Figure 2). We implement this
decomposition exactly in Section 5.

4.2     Decomposing changes in business dynamism
Declining business dynamism has been described in a number of empirical papers, and has various differ-
ent attributes (see in particular Decker et al., 2017, and cites therein). Our contribution is to link declining
business dynamism to the rise of market power. Here we focus on: a. entry and the composition of job cre-
ation and destruction; and b. labor reallocation rates in the cross-section. A number of papers have studied
one or the other of these trends. Here we study them jointly and account for cross-sectional patterns. In
each case we describe the moments in the data and the model, then the mechanism that leads the model to
match the data.




                                                      25
                      Figure 6: Entry and the composition of job creation and job destruction
Notes: Data are from the Census Business Dynamics Study. Series are first smoothed with a 7 year centered moving average and
then plotted in differences from 1980. The series for job creation and job destruction are the share of total job creation and job
destruction accounted for by firm exit and firm entry, respectively, at an annual frequency.

a. Entry and the composition of job creation and destruction

Data. A trend in the data that has attracted attention is the decline in the entry rate of firms. Figure 6
shows that in the Census BDS data this has declined by around 4 percentage points from 1980 to 2016. At
the same time, the composition of total job creation and job destruction has shifted. Less job creation is due
to firm entry, and less job destruction is due to firm exit, both having declined by about 4 percentage points
when measured as shares of total job creation and destruction, respectively.

Model. The model accounts for these changes over time, with similar declines over the period in the
entry rate of firms and shifts in the composition of job creation and job destruction. Moreover the profile
of these changes is also consistent with the data, with relatively shallower declines up to around 2000, and
faster declines since then.

Mechanism. Two effects in the model work in opposite directions when it comes to shaping extensive
margin reallocation of firms (firm entry rate) and employment (job destruction by exit and job creation by
entry). First, firms enter or exit following productivity shocks, and since in this granular economy markets
differ according to the productivity distribution of firms, then the productivity threshold for entry varies
from market to market. As the number of potential entrant firms decreases, the density of firms around any
point, including this threshold, decreases, reducing the likelihood of one firm exiting or another firm en-
tering. This shifts job creation and destruction in the direction of incumbents. Second, as fixed costs increase,
the productivity threshold for operating increases and the firms that are entering and exiting become larger,
   22 Comparing      the wage in the model and the data is difficult due trend changes in total factor productivity in the data. We can
think of TFP in the data as having a component due to growth from research and development and so on, and a component due
to the allocation of resources across firms. We cannot separate these in the data, while our model endogenously generates the
latter. We therefore treat model and data the same, dividing the wage in the data and in the model by total factor productivity.
This takes growth and misallocation out of the data and misallocation out of the model. For the data, we take TFP from the Penn
World Table, TFP data: https://fred.stlouisfed.org/series/RTFPNAUSA632NRUG
    23 We first fix the male `prime-age' 25 to 54 population at its level in 1980. We then apply to this the employment-population

ratio of the same demographic group from 1981 to 2018. So far we have abstracted from thinking about trends and cycles since
most of our data up to this point has been relatively acyclical. However there are obviously large cyclical fluctuations in employ-
ment. Therefore, we fit a quadratic trend to log employment from 1977-01 through to 2019-12. Figure 5C plots the log difference
in this trend relative to 1980, along with the underlying data.


                                                                  26
increasing the fraction of job destruction by exit and job creation by entry. The entry rate also increases.
Entry decisions are made based on average profits which are convex in productivity due to endogenous
markups. Hence, average profits are more sensitive to productivity at more productive firms, leading to
more entry and exit. Figure C3 plots this relationship, which becomes more convex as firms' market shares
increase over time.
   While qualitatively these forces push in opposite directions, Figure C4 shows that quantitatively the
effects due to decreasing M are significantly larger. Market structure is, through the lens of the model, key
for understanding declining entry rates and job creation and destruction by entry and exit.

Summary. As well as accounting quantitatively for time-series, cross-sectional and cross-sectional-time-
series patterns in markups and business dynamism, we have shown that the model accounts well for key
aggregate trends. This is a key step in benchmarking our main results which consist of using the model to
decompose these changes in the economy -- markups, business dynamism, output, wages, employment
-- into those parts due to changes in technology and those parts due to changes in market structure.

b. Labor reallocation
We contribute to the study of declining business dynamism by providing a model that matches both the
cross-section of reallocation rates by firm size, and their relative declines since 1980. To show this we
consider a simple decomposition of the decline in reallocation rates, that is to the best of our knowledge,
new.

Data. The aggregate employment reallocation rate Rt at date t can be decomposed into components due
to small (n < 1, 000) and large firms (n  1, 000), which we denote by groups g:
                                               G     Emp gt          JCgt + JDgt             G
                               JCt + JDt
                      Rt =
                                 Empt
                                         =           Empt              Emp gt
                                                                                       =     sn
                                                                                              gt R gt            (20)
                                              g =1                                          g =1


We then use this to decompose the cumulative change in the reallocation rate between 1980 (t = 1) and
2016 (t = T ) into share, shift, and covariance terms:
                           t    G                      t   G                            t     G
             R t - R0 =     R g ×             sn
                                               g +      s g ×                  R g +               sn
                                                                                                    g ×  R g     (21)
                           =1 g =1                     =1 g =1                          =1 g =1

                                     Sharet                        Shi f tt                        Covariancet

   Figure 7A shows that the employment share of large firms increased over this period. Over this pe-
riod average reallocation rates at large firms are around 10 ppt lower than at small firms. Qualitatively,
therefore, the compositional shift of employment to lower reallocation rate firms could explain the decline
in reallocation rates. Quantitatively, however, our decomposition shows that this accounts for barely any
of the decline. Figure 7B shows that declining reallocation rates within size classes (Shi f tt ) accounts for
almost the entirety of the decline in the overall reallocation rate. The red dashed lines in Figure 7C show

                                                              27
                                 Figure 7: Decomposing declining business dynamism
Notes: Panels A, B and C plot components of the decomposition of the reallocation rate using equations (20) and (21). Author's
computations using Census BDS data. Large firms are defined as firms with more than 1,000 workers.

that declining reallocation rates for small firms (crosses) account for most of the decline in Shi f tt . This may
come as a surprise if one thinks that either changes in behavior of large firms or their increasing share of
employment has been a main cause of the decline in business dynamism.

Model. The model, however, completely agrees with this decomposition. First, in levels, the model gen-
erates reallocation rates that are decreasing in firm size, consistent with the data. Second, in the time-series,
reallocation rates decline relatively more for small firms (Figure 7C), and decline by the same magnitudes
found in the data.24 To the best of our knowledge this is the first exercise that generates these same facts,
both qualitatively and quantitatively, consistent with the data.

Mechanism. Consider again the decomposition of employment changes into the demand elasticity and
pass-through term, which is similar to equation (15) but now written in terms of pass-through of marginal
cost:
                          log nijt     log yijt    log pijt
                                    =           ×            - 1 =  sijt ×  sijt                           -1.                   (22)
                          log mcijt    log pijt    log mcijt
                                                                               Elasticity   Pass-through
Repeating the formula from (8) for (sij ), we also have a first order approximation for pass-through, derived
as in Amiti et al. (2016)25
                                              -1
                      1          1                                           ( -  ) 1 - sij +  ( - 1)
             sij = sij + 1 - sij                     ,   (sij )                                                                  (23)
                                                                      ( -  ) 1 - sij 1 + ( - 1) sij +  ( - 1)
The black solid lines in Figure 8 describe each term as a function of the firms' market share.
    First, consider how the model accounts for a higher level of reallocation rates at smaller firms. Smaller
firms face both more elastic demand and pass more of any change in marginal cost through to prices,

   24 The  model has not been calibrated to the employment distribution of firms in the economy. In defining small and large firms
for this exercise we split firms by percentiles of the firm employment distribution consistent with Figure 7A. For example, in 2000
in the data, firms with over 1,000 employees account for around 65 percent of employment. We therefore compute a size cut-off
in the model that we deem to be `large' such that `large' firms account for 65 percent of employment.
    25 As this exercise is illustrative, here we have stated only the direct partial-equilibrium effect. The full expression includes

sales-share weighted  log p-kjt / log mcijt terms due to competitor's (k = i ) equilibrium best responses. This is also common
practice in the exchange rate pass-through literature. In practice, we find that these second order terms are small (see Berger et al.
(2019) for a closer discussion of these effects).


                                                                 28
             Figure 8: Elasticity of demand and pass-through by share in the model, 1980 and 2016

and hence quantities and employment. In a competitive firm dynamics model without variable markups
(e.g. papers following Hopenhayn, 1992; Hopenhayn and Rogerson, 1993) the pass-through is one, and
a researcher would match the average reallocation rate in the economy with a combination of decreasing
returns and adjustment costs. In such a model there is no reason that smaller firms would have higher
reallocation rates than large firms.
    Second, consider how the model accounts for a larger decline in reallocation rates at smaller firms.
Figure 8 shows that both the elasticity and pass-through terms are convex in the market share. Consider
the case of pass-through. Intuitively, and as is clear from (23), (0) = (1) = 1. These are the cases of a
monopolistically competitive firm and a single monopolist in the entire economy. In both cases firms have
constant markups and so, in logs, pass-through is 1.26 Pass-through (s) attains a minimum at some point
smin ( ,  ) and is convex. Since we have many firms in a market, most firms' revenue shares are less than
smin . Convexity implies that as competition declines, and revenue shares increase, both the elasticity of
demand and pass-through terms decline by more for smaller firms.27 To visualize this, Figure 8 overlays the
distribution of market shares from the model in 1980 and 2016. Small firms in the left of the distribution
have larger declines in  and  than firms in the right of the distribution. This neatly rationalizes the larger
decline in reallocation rates at smaller firms.

Summary. These exercises show that understanding changes in market power can be useful for under-
standing changes in business dynamism. On the intensive margin (reallocation rate), extensive margin
(entry rate), and in the cross-section (small vs. large) the model provides an intuitive and quantitatively
accurate interpretation of the data.



   26 That  is, in logs, pijt = µijt + mcijt , and µijt = µ is constant, therefore  p/mc = 1.
   27 Some   very large firms will have a share s > smin , as their share increases, pass-through increases and since (s) becomes
quite flat, their reallocation rates increase. This is fine. Increasing reallocation rates at this very small subset of firms cushion the
decline in reallocation rates of large firms when taken as a group.


                                                                   29
                           Figure 9: Decomposition of the change in markups over time

4.3   Decomposing changes in markups
Next we contribute to the study of the evolution of markups by showing that the model, which matches
average markups, also goes a considerable way to endogenously replicating the empirical decomposition
of markups into reallocation, within-firm markup growth and changes in composition due to entry/exit.

Data. Recall that the moment that we targeted in the estimation of the model was the sales share weighted
average markup µt = i mit µit , where as opposed to the share sijt of a firm within a sector, we use shares
of sales of the entire economy mit . Following De Loecker et al. (2020), we decompose µt into components
due to (i) changes in market shares ( Reallocation), (ii) changes in markups themselves ( Within), and
(iii) the effect of Net entry as follows:

 µt =                µi,t-1 mit +               µi,t mit +               m i ,t -1  µ i ,t +                µit mit -                µit-1 mit-1 .
         i It It-1                  i It It-1                i It It-1                         i It \It-1               i It-1 \It

              Market share               Cross term               (ii)  Within                                  (iii) Net entry
                         (i)  Reallocation
                                                                                                           (24)
Here µit = µit - µt-1 , and µit-1 = µit-1 - µt-1 , and It is the set of firms in period t. Figure 9A plots this
decomposition, and shows that only around one fifth of the increase is due to the within component. The
remainder is split with three fifths due to reallocation as higher markup firms capture a larger fraction of
sales and another fifth due to net-entry as entering firms, on net, have higher markups.

Model. Figure 9B constructs the same decomposition using data generated from the model. This exer-
cise should be contrasted with a similar exercise in Baqaee and Farhi (2017). There the authors take the
time-series distributions of markups from the data, treat these as exogenous wedges in a monopolistically
competitive model and use the model to compute endogenous sales shares. Here we move the parameters
{ Mt , t , t }2016
              t=1980 , which generates an endogenous joint distributions of markups and sales shares.

Mechanism. The model generates a very similar attribution of the increase in markups to the within
component, only around one fifth of the overall increase. The model then splits the remainder more evenly
between reallocation and net-entry. This under-states the importance of the reallocation rate with respect



                                                                30
to the data and overstates net entry. This is mainly due to the fact that our model is static. When a firm
draws a low productivity in a given period, it stays out of the market and this is counted as exit in our
model. In reality, firms' entry costs cover multiple years and they stay in the market even if they have low
productivity shocks. This then would be accounted for as reallocation instead of exit.
      This decomposition reflects the changes over time in M,  and . All three parameters increase the
average markups and they change the distribution. But what the decomposition shows is that the rise of
sales weighted markups is only partially driven by the increase in markups themselves, and much more
by the reshuffling of market shares towards high markup firms. In our model with oligopolistic compe-
tition, firms that are more productive obtain higher market shares as they can compete more effectively
against firms with lower productivity. The increase in market shares of high productive firms affects both
the reallocation towards incumbent firms as well as new entrants. This reallocation of economic activity
towards firms with high markups and high productivity has important efficiency implications and goes to
the heart of the welfare implications of the rise of market power. Production by high productivity firms
increases efficiency, but the variance in productivities between competing firms, exacerbated by fewer po-
tential entrants and higher fixed costs, leads to more rent extraction and higher markups. We return to the
welfare implications below.

Summary. As with the decline in business dynamism, the model provides a decomposition of the in-
crease in markups that is consistent with that documented in the data. In both cases, these decompositions
were not targets of our main empirical exercise. We view these consistencies between model and data as
positioning the model well for the quantitative analysis in Section 5.


5     Results
We now analyze the implications for output and welfare, and we ask which determinants of the model are
responsible. First, we transform the aggregate equilibrium conditions into a representative agent economy.
Next we decompose output and welfare, and show that the large net decline in both output and welfare
masks opposing positive and negative effects, which we represent in wedges. Third, we further decompose
those wedges by looking into the contribution of the primitives ­ technology ( and ) versus market
structure ( M) ­ to each wedge. Fourth, we use a variance-covariance decomposition and a second-order
approximation to better understand the distributional determinants.

5.1    Aggregate equilibrium conditions
To ground these exercises it is first useful to state the general equilibrium conditions of the model using
the objects that we specified in Section 2 now in the full model with capital. The three previous conditions
from the labor only model (2.2) can be written as follows with an additional set of equations that pin down


                                                     31
output and capital given goods market clearing and labor market clearing:28
                                                              1                       1- 
                                         W               Z            1-               
             Goods market clearing:             =                                                                                (25)
                                         P               µ             R
                                                                                                 Y
                 Total labor demand:        N   =     NProd +          ,          W=
                                                                                            µ   NProd
                                                                                                        ,    :=     Mj dj
                  Total labor supply:       N   =     W 
                                                           W /
                     Capital demand:        K   =                    NProd
                                                       R / (1 -  )
                       Capital supply:      1   =      [ R + (1 - )]

                                Output: Y       = ZK1- NProd
                                                        
                                                                              ,   Y : = Y


Given the objects {µ, Z }--which we can compute using only firm level productivity and markups fol-
lowing equations (11) and (12) from Section 2--the first three conditions can be solved for the wage W ,
employment N and a measure of undistorted output Y . This makes clear that the misallocation term 
does not impact W or N . The remaining conditions then determine output, capital and the price R. There
are numerous useful ways to express these equations. Rearranging, we can also obtain:
                                                        1-                 
                                        1        R                W                                                   1
         P = µ × MC       ,     MC =                                              ,     Y = ZK1- NProd
                                                                                                  
                                                                                                             ,   Y=         Y.   (26)
                                        Z       1-                                                                    
Aggregate price is a markup µ on the marginal cost that one would derive from an aggregate production
function with productivity Z, and only production labor as an input. This distorts output, as variable
factors are not priced competitively. We can also re-arrange these expressions and note that in the language
of wedges in efficiency conditions (Chari et al., 2007), then the markup appears as a labor wedge in the
efficiency condition for labor:                               1
                                            -1/  N                    ×  ZK1- NProd
                                                                                -1
                                                              µ
                                                MRS                                   MPL
Final output Y is then further distorted by the misallocation term. Recall that if all firms have identical
markups, then  = 1, while if markups and productivity are positively correlated--which is the case in
our model--then  > 1.

Representative agent.         This admits the following two interpretations through the lens of a representative
agent economy, both of which are useful for differentiating µ and . First, a continuum of identical monop-
olistically competitive producers with productivity Z produce an intermediate good Y that they sell at a
markup µ. A continuum of competitive final goods producers with productivity -1 operate a production
technology Y = -1 Y . Second, the same set of conditions can be obtained from a continuum of identical
                                                                                1- 
monopolistically competitive firms operating a production function Y = ( Z )K  NProd with TFP ( Z ),
but face a revenue tax  = ( - 1)/ that is increasing in , where the revenue tax funds government

  28 Given the Cobb-Douglas production function where K = 1 - COGS , in what follows we simplify the notation to  = COGS

and 1 -  = K .


                                                                  32
spending G that does not enter utility.

5.2    Output and Welfare Decomposition
Output. Using the above equilibrium expressions we can express output in terms of total factor usage
and measured total factor productivity:
                                                         1      1
                                               Y=                        SZ          K 1-  N  ,                                        (27)
                                                                
                                                    Total Factor Productivity: TFP
                                                                                                1
where                                                                                    -1     - 1
                                                                           M             -1
                                   N                                               -1                                 Z
                       :=
                                  N-
                                                ,    Z :=           M -1    zij                          ,   S :=
                                                                                                                      Z
                                                                                                                        .
                                                                           i =1

                       Fixed cost adjustment                        Productivity                                Selection
This expresses output in terms of total factors and wedges which are endogenous in our model. The
wedge , which is increasing in total overhead labor , reduces output through the use of total labor in
overhead activities. The misallocation wedge  distorts output and increases when less productive activity
is allocated to high productivity firms. Finally we write the terms that depend only on firm productivity
as a measure of unselected productivity Z  --which is based on all potential entrants M, even those that
do not enter in the market--amplified by a selection term S. Since entry selects higher productivity firms
to operate S > 1, and improvements in selection lead it to increase. As an example, a change in the
distribution of productivity via an increase in  will show up directly as an increase in Z  due to convexity
in zij , but also indirectly through higher equilibrium S as more dispersed productivity increases the sales
shares of more productive firms, reducing entry of less productive firms. Again in the language of wedges
in efficiency conditions, these combine to appear as an efficiency wedge.
      The decomposition in (27) does not involve markups. Higher markups reduce the demand for variable
factors and contribute to the decline in capital and labor which accounted for more than half of the decline
in output. Combined with the goods market clearing condition, labor supply and capital demand, we can
include the effect of markups and characterize employment and output in terms of only the five wedges
in the economy. For simplicity we now express terms from (25) in exact log changes, using notation xt =
 log Xt (which we abuse in the case of µt ):
                 1+                        1-+                       1                                                           
          yt =             zt + st    -                      µt -          t - t           ,      nt =             zt + st   -    µt   (28)
                                                                                                                                 
                   Productivity                Markups          Fixed costs Misalloc.                        Productivity    Markups

In addition to the direct effects of higher productivity                 (zt   + st ) through TFP keeping inputs fixed, higher
productivity in general equilibrium increases demand for labor, which drives up the wage with elasticity ,
increasing consumption and output. Markups have a similar, but oppositely signed effect: higher markups,
holding marginal costs fixed, choke off demand for output. These effects are amplified by  < 1. Since the
supply of capital by households is inelastic at R, the lower is  the larger the movements in the price of


                                                                    33
                                             Figure 10: Decomposing output
Notes: Panel A plots the cumulative decomposition of output according to equation (28). Panel B plots consumption equivalent
welfare losses relative to 1980 t , along with the decomposition of the first order approximation of these welfare losses from
equation (29).

labor that are required in general equilibrium.
    Figure 10A plots the decomposition of output equation (28). Our main result is that markups and fixed
costs, alone, would have lead to around a 15 percent decline in output: 8 percent from markups, and 7
percent from the rise in fixed costs. While misallocation effects are small, the 15 percent decline due to
markups and fixed costs is half offset by the combined increase in productivity due to innate changes in
the productivity distribution (due to higher variance in the shocks) and better selection conditional on this
distribution (the selection of firms that enter are of higher productivity).29
    This is a key insight from our analysis. Output declines by 10 percent, but underneath this net decline,
there is a much bigger decline that is partly offset by the increase in productivity. This shows that tech-
nological change plays a key role in the evolution of market power. Firms have become more productive
incurring higher fixed costs; this has lead to fewer firms entering who do not pass on all those produc-
tivity gains to the customer, resulting in higher deadweight loss. The net effect is negative where more
productive firms extract even more rents.
Welfare. We can apply a similar decomposition to welfare. We measure welfare in consumption equiv-
alent terms, and consider the change in consumption t that would be required to make the household
in 1980 indifferent with respect to the period t allocation: U (1 + t )C1980 , N1980                  = U Ct , Nt . Taking a
first order approximation around (C1980 , N1980 ) under  = 1 and writing xt = log Xt - log X1980 , the above
expressions for yt and nt gives equation (29) which conceptualizes the effects of markups and misallocation




   29 Appendix Figure C6 plots the time-series for each of { z , s ,  ,  , µ }; and Appendix Figure C7 plots the same decomposition
                                                              t t t     t t
for employment, the wage and total labor productivity Yt / Nt , which declines by 6 percent. Total labor productivity is not the
welfare relevant measure of productivity in the economy, but nonetheless is often used in empirical work. The decline in labor
productivity is mostly driven by the change in composition of employment, and partly by the increase in markups, again with
large off-setting effects through zt and st .


                                                                34
                            Figure 11: Decomposing output and total factor productivity

as races against off-setting productivity effects:
   Approx                        1 -  + (1 - ls1980 )                                             1                  W1980 N1980
 t          = yt - ls1980 nt =                                 zt - µt    + zt - t          -         t , ls1980 =               (29)
                                                                                                                       Y1980
                                        Productivity vs. Markups         Prod. vs. Misalloc. Fixed costs

where zt =      zt   + st . Figure 10B implements (29) and shows that welfare declines by 9 percent, about the
same amount as output, and also that the first order approximation tracks the exact expression closely.
While productivity effects more than offset the decline in welfare due to misallocation, the increase in
markups washes out these effects, leading to a decline in welfare. Similarly there are large welfare costs
associated with the change in the composition of employment. Again, underneath the 9 percent decline in
welfare, there are off-setting effects, with a large positive productivity effect on welfare.

Decomposing total factor productivity. We can also decompose output into the standard components.
Figure 11 plots output in terms of factors and total factor productivity and the components of TFP. Panel A
shows that the 10 percent decline in output from 1980 to 2016 is in nearly equal parts due to capital, labor
and TFP, with TFP somewhat larger.30
     Panel B shows again the rich off-setting forces shaping the 6 percent decline in aggregate TFP over this
period. The change in the composition of labor inputs away from variable and towards fixed factors alone
would have reduced TFP by more than 6 percent. There is also a modest 1 percent contribution due to
misallocation. Off-setting these are increases in productivity after 2000 through the two channels in (27),
both of which account for around a half of the increase in Z. Unselected productivity increases by over 3
percent, while there is also additional selection which further increases TFP by 2 percent. Underlying the
drop in aggregate TFP, there is a 5 percent increase in total productivity.



   30 Real output in the US economy grew by 2.63 percent annually over this time, while the model implies an annual growth

rate of minus 0.29 percent. This suggests an off-setting trend in aggregate productivity growth of  = 2.92 percent per year. In
the model we set E[zijt ] = 1. We could include this aggregate productivity growth at rate  by (i) setting E[zijt ] = (1 + )t , (ii)
incorporating balanced growth preferences, and (iii) scaling fixed costs t .


                                                                   35
Wealth effects.    As an aside, note that throughout we have assumed preferences that imply no income
effects on labor supply. This is most notable through equilibrium labor demand (28), which does not
depend on t . Since t reduces output one for one, an income effect would lead labor supply to shift
outward, with an elasticity equal to the coefficient of relative risk aversion in the CRRA case. Income
effects would also dampen the effects of productivity and markups on output as lower output shifts labor
supply outwards, adding a small term to the denominator of the constants. Quantitatively we have found
that our conclusions would be unchanged for reasonable values of risk aversion.

Warning.    Our discussion of Figure 10 is somewhat misleading. While our model and quantitative exer-
cise cleanly admits this decomposition, it is inappropriate to consider these effects as stand-alone objects.
To see this, note that if presented with sufficient data one could measure the wedges {zt , t , t , µt } as resid-
uals from a just-identified system of aggregate equations such as (25). One could then use those same set
of conditions to plot output, employment and welfare, changing one wedge at a time holding the others
fixed. Such an exercise would ignore the underlying correlation structure of the wedges due to the primi-
tive changes in the economy in terms of {t , Mt , t }. Estimating our model over time allows us to unpack
this correlation structure and account for wedges in terms of primitives, which we now turn to.

5.3   Decomposing the wedges
Now that we understand how the wedges {zt , st , µt , t , t } impact output and welfare, we can use the

model to understand the contribution of each of the primitives {t , Mt , t } to these wedges. The primitives
are the cause of changes in the economy. To do this we hold all parameters fixed at their 1980 values, and
then feed in one parameter at a time, plotting the implied wedges. Figure 12 plots the wedges in panels
A through E in the same order and color as Figure 10. Throughout this subsection Figure 13 provides a
schematic reference to how each wedge moves due to changes in each parameter.

Productivity (zt ). Innate productivity zt increases by around 3 percent, and is almost entirely driven

by the increase in dispersion of productivity from 2000 onwards. With higher dispersion in productivity,
          increases, due to the concavity in preferences. Recall from our discussion of Figures C1 and C2
overall Zt
that this was identified off of the joint path of markups and reallocation rates over this period.

Selection (st ).   This change to the productivity process also has positive effects through selection that
magnify this direct effect on potential productivity. If the productivity cut-off for entry in a market is
high enough, then increasing dispersion in productivity increases mean productivity conditional on entry.
Figure 4A showed that around half of potential firms enter in each period, this turns out to be sufficiently
into the right tail of the productivity distribution for increasing dispersion to increase mean productivity.
Higher fixed costs increase the threshold for firms to enter in each market, having a substantial effect



                                                       36
                              Figure 12: Effect of each parameter on the five wedges
Notes: This figure plots the effects of changing parameters independently for each wedge. For example, the orange dotted lines
with square markers give the time-series of wedges implied by feeding only the estimated time-series for { Mt }2016
                                                                                                               t=1980 into the
model, keeping t and t fixed at their estimated 1980 values.

on selection. Finally the decline in the number of firms, which by definition has no effect on potential
productivity zt , reduces productivity via selection. With fewer firms, the profits associated with being an

incumbent firm increase, so the marginal entrant has a lower productivity, reducing average productivity
via a negative selection effect.

Markup (µt ). The aggregate markup is driven by technology via increasing fixed costs, and market struc-
ture via a lower number of potential entrants, while the dispersion in productivity has quantitatively only
small effects. Higher fixed costs and lower competition both increase markups through a similar channel:
fewer incumbent firms operating. While the latter does not affect selection on productivity substantially,
the former does, leading to even larger increases in markups. Interestingly, when both are operating the
decrease in Mt serves to dampen the effect of the increase in t . Since each sector is granular, an increase
in fixed costs may not change the number of incumbent firms if the productivity of the last entrant is suf-
ficiently above the entry cutoff. As Mt declines, the density of firms near the entry cutoff declines, muting
the effect of the increase in t .

Fixed costs (t ).     Clearly the increase in fixed costs is driven by an increase in the parameter t , which
directly increases the fixed component of labor. The increase in the dispersion of productivity after 2000
reduces this wedge, as increased productivity for large firms increases their employment of variable labor,
reducing the economy's proportional use of overhead labor. Finally, a decline in Mt mechanically has a
large negative effect on the proportional use of fixed costs, since fewer firms operate (e.g. if the economy
had only one firm then  = ( N /( N - )) ). Again, these effects are dampened when the changes in
market structure and technology are combined.

Misallocation (t ). Finally, recall that the effects of misallocation on output and welfare were small. De-
spite this, if fixed costs alone had increased these effects would have been nearly an order of magnitude

                                                             37
                                      Figure 13: Parameter changes and wedges
Notes: This diagram shows how changes in each parameter, and combinations of parameters affect the 5 wedges that we have
shown are determinative of aggregates in the economy. A baseline sector with 6 firms is given in the first row, with the red
vertical dashed line denoting the market-specific, endogenous productivity threshold for entry. In Panel 1, we consider three
possible cases of a decrease in the number of potential firms. As an example, in the final row, the dispersion of productivity
increases. Productivity wedge z increases due to convexity, selection s increases as incumbent productivity increases relative to
non-incumbents, markup wedge µ increase due to more market power at the highest productivity firm, misallocation wedge 
increases as the highest productivity firms' markup increases, while fixed cost wedge  declines as firms expand on the intensive
margin.


larger. Higher fixed costs induce severe misallocation as they deliver more market power to more produc-
tive firms.

Summary. We have shown that not only is understanding changes in market structure and technology
important for understanding the set of wedges described in Figure 12 and in turn aggregates, but un-
derstanding them jointly is also important. Changes in market structure in technology alone, can lead to
severely different predictions for misallocation, markups and overall productivity net of selection. For
reference, Figure C8 replicates Figure 12, removing the effects of  and considering M and  combined.
    We ended the last section with a warning that it might be difficult to discuss changes in the wedges
in the economy independently. To emphasize this, Figure C9 in the Appendix rotates Figure 12 by plot-
ting each of {zt , st , t , t } against the markup wedge µt as we vary each parameter. As an example, the

corr (µt , t ) is positive across all three changes in parameters, such that it is difficult to discuss the two sep-
arately. Meanwhile a higher fixed cost parameter t leads to a positive correlation in the markup and fixed
cost wedges corr (µt , t ) > 0, while less competition Mt leads to a negative correlation corr (µt , t ) < 0.




                                                               38
                     Figure 14: Single-nest and second-order approximations of zt , µt and t
Notes: This figure takes the baseline wedges from the model (red, solid) for productivity, the markup and misallocation, and
compares them to (i) the single-nest approximating model under  = 4.40 (blue, dashed), and (ii) the second order approximation
of the single-nest approximating model (purple, dotted).

5.4    A variance-covariance decomposition
The endogenous wedges that determine aggregate quantities in our economy {zt , µt , t } depend on the
joint distribution of productivity and markups in a way that is not completely transparent. As a final exer-
cise in this section we show that, quantitatively, (i) the mapping from the joint distribution of productivity
and markups to aggregate wedges can be summarized well by five moments that capture means, vari-
ances and the covariance of markups and productivity, (ii) that these depend mostly on the mean terms,
(iii) account for how primitives determine these moments.
A single-nest approximation. Our approach is to take a second order approximation of each wedge
around a particular moment of the joint distribution of productivities and markups. While this is pos-
sible in the nested case, it leads to complicated formulas that contain within and between market variance
and covariance terms. For the purposes of this exercises it turns out that an excellent approximation can
be obtained by aggregating markups and productivities as if the economy had a single nest, with elasticity
of substitution . In this case we denote aggregates with a tilde:
                                     1                                                               1
                   M jt              -1                           M jt            -1                 -1           M jt           -1          -
          1                                              1                zijt                                           zijt         µijt
Zt = 
          M j dj
                            -1 
                          zijt dj         ,   µ-
                                               t
                                                 1
                                                     =
                                                         M j dj
                                                                          Zt
                                                                                         -1  -1 
                                                                                       (µijt ) dj         , t =          Zt
                                                                                                                                      µt
                                                                                                                                                 di.
                   i =1                                           i =1                                            i =1
                                                                                                                                         (30)
We can choose  in different ways, all of which deliver good approximations. We choose an approach that
does not use information on markups. We set  such that Z2016
                                                             = Z2016 , which delivers a value of  = 4.40.
As expected this is between  = 1.20 and  = 5.75.
      This approximation works well, closely matching the path for each wedge. Again using lower case to
denote objects in log changes from 1980, Figure 14 plots the baseline wedges from the model in red, and
the approximation using  = 4.40 in blue dashed lines.

Second-order approximation.                    The single-nest expressions (30) admit clean second order approximations.
We approximate log productivity terms around E log zijt and log markup terms around E log µijt . Do-



                                                                         39
   Figure 15: Decomposing wedges into moments of the joint distribution of markups and productivity




                              Figure 16: Effect of each parameter on the five wedges
Notes: This figure plots the effects of changing parameters independently on each of the five moments plotted in Figure 15.
For example, the orange dotted lines with square markers give the time-series of wedges implied by feeding only the estimated
time-series for { Mt }2016
                      t=1980 into the model, keeping t and t fixed at their estimated 1980 values.


ing so, to a second order, we obtain the following for the wedges in log changes, zt and µt :
                                          1
                zt  Et log zijt +           ( - 1) Vt log zijt                                                          (31)
                                          2
                                          1
                µt  Et log µijt          - ( - 1) Vt log µijt + ( - 1) Ct log zijt , log µijt .                         (32)
                                          2

While the aggregate productivity term is increasing in the variance of productivity, the aggregate markup
term is decreasing in the variance of markups. This can be understood as follows. Recall that in an efficient
allocation markups (µijt = 1) variable factor productivity is Zt . An increase in productivity dispersion
reallocates factors to higher productivity firms, increasing aggregate productivity Zt . The higher is  the
more aggressively these factors are reallocated, boosting aggregate productivity. Meanwhile, the covari-
ance between markups and productivity increases the aggregate markup wedge, as the contraction in fac-
tor demand relative to the efficient benchmark is more severe when the higher markups belong to higher
productivity firms. The model we study generates a positive covariance through Cournot competition.




                                                             40
   These can then be used to simplify the second order expansion of the misallocation term:
     1                      1
t      ( - 1)2 Vt log zijt + 2 Vt log µijt -  ( - 1) Ct log zijt , log µijt - ( - 1) zt - Et log zijt          +  µt - Et log µijt
     2                      2
This full expression shows how misallocation depends on the variance and covariance of markups and
productivity. However after substituting in the above expressions for zt and µt into the terms in · , we
find that t depends only on the variance of markups: t  2 Vt log µijt .

   The purple dotted line in Figure 14 show that the second order approximation does well in capturing
the aggregate wedges, in particular productivity and markup, which we have shown are quantitatively the
important wedges for understanding aggregate moments (Figure 10). To complete the picture, Appendix
Figure C10 combines the decomposition of output and welfare into wedges, with the decomposition of
the wedges into moments of the joint distribution of log productivity and log markups. As expected, the
mean terms dominate in terms of markups, with the increasing covariance contributing only one tenth of
the decline in output and welfare.

Results. Figure 15 plots the contribution of each of the five moments to the wedges in equations (31),
(32) and (33). Our main result is that while the level and variance of productivity are equally important
for understanding the aggregate productivity wedge, the markup can be well summarized by the mean
of markups while, by our above result, the misallocation term depends only on the variance of markups.
Quantitatively, the key result is that the covariance of markups and productivity, which increases over
time, contributes less than a quarter of the increase in the markup wedge, and is partially offset by the
increase in the variance.
   Figure 16 shows how each parameter contributes to the moments in Figure 15. First, and consistent
with our results from the previous section, the off-setting forces of the decline in competition and increase
in fixed costs leave the dispersion in productivity to shape the mean and variance of productivity. Sec-
ond, the time-series for the arithmetic mean log markup, which shapes µt , is determined by both market
structure and technology, with the decline in Mt leading to a dampening of the selection effects that would
occur under only an increase in t . Although quantitatively not important for the aggregate wedges that
determine output, employment and welfare, we note that the covariance of markups and productivity is
shaped by all three parameters. All three forces increase the market power of the most productive firms in
the economy, increasing this covariance.

Fixed cost. The aggregate overhead wedge t that enters aggregate TFP also depends on the distribution
of firms as well as the time-varying estimate of t . The fixed cost wedge t can be written
                                                  M jt                      1/                          
                                Nt                        nit,Prod                             nit
                   t :=
                             Nt - t
                                           =              Nt,Prod
                                                                       it
                                                                       
                                                                                 ,   it =
                                                                                            nit - t
                                                                                                           .                 (33)
                                                  i =1
                                                         Weight:  it




                                                              41
A second order approximation delivers t =  log t , where
                                       1           
                t  E log it +            V log it + V log  it + C log it , log  it .                      (34)
                                      2            2
Figure C11A shows that as with the previous approximations, this closely matches the true time-series for
the wedge. Figure C11B shows that, this is driven almost entirely by the change in the mean of firm level
log it . Consistent with our previous results, Figure C12 shows that if only M were to decline, then this
term would have declined, while in the presence of an increase in , the net effect is positive.


6   Markups and business dynamism
What accounts for changes in measures of the average markup and business dynamism is of independent
interest. In this last section we return to these moments, which we matched by construction, and show that
understanding the interaction between changes in market structure and technology is also important for
understanding how these moments of the economy have changed over time.
    Figure 17 panels B and C plots each of these moments and the change in the moment as we feed in
our estimated time-series for each parameter independently. In Panel A, for reference below, we plot the
average number of operating firms in a market. Above we referenced the fact that our estimates for the
time-series of Mt and t both implied similar changes in the number of operating firms, shown in Panel A.

Increasing sales-weighted markup.          Similar to the effects of each parameter on the markup wedge in
Figure 12, it is also important to understand the joint effects of technology and market structure on the
sales-weighted markup. As an aside, while we match the 35 percentage point increase in the sales weighted
markup (Figure 3), the aggregate markup wedge µt in the model increased by slightly more than half this
amount: 20 percentage points. As pointed out by Edmond et al. (2019), the increase in the sales-weighted
average of firm markups will tend to be larger than the increase in the welfare relevant weighted average
of firm markups. This is also true here.
    A decline in competition by itself, via a lower Mt , would raise the measured markup by about half of
what is observed in the data. On the other hand, an increase in fixed costs by itself would increase the
measured markup by twice what is found in the data. Together the two interact, with the decline in Mt
dampening the selection effect of t by reducing the density of firms around the exit threshold.
    This presents a useful back-of-the-envelope way of conceptualizing the evolution of the average markup.
First, note that the effect of increasing t is small, so can be ignored. Second, the number of operating firms
declines by the same amount due to both higher t and lower Mt . Combining these observations we can
consider half of the increase in the markup being accounted for by declining competition, and half due to
selection due to higher fixed costs t .




                                                       42
    Figure 17: Decomposing the increase in sales-weighted markups and decline in business dynamism
Notes: This figure plots the effects of changing parameters independently for each wedge. For example, the orange dotted lines
with square markers give the time-series of wedges implied by feeding only the estimated time-series for { Mt }2016
                                                                                                               t=1980 into the
model, keeping t and t fixed at their estimated 1980 values.

Declining business dynamism. The observed decline in business dynamism of around 10 percentage
points emerges as a balance of strongly off-setting forces. The direct decline in competition through Mt
increases firms' market shares, reducing their demand elasticities (s) and their pass-through (s), which
combine to reduce labor reallocation following productivity shocks. Alone this would have lead to a de-
cline in business dynamism more than twice what we observe in the data, around 22 percentage points.
    Off-setting this are two forces. First, larger productivity shocks have a relatively modest effect that
nonetheless offsets a quarter of the decline in dynamism due to Mt . Second, and more importantly, higher
fixed costs lead to significantly higher reallocation rates. Recalling our discussion of Figure 2(3B), higher
fixed costs lead to much higher job destruction and job creation by exiting and entering firms, respectively.
While the model matches the empirical decline in the proportion of job destruction due to exit and job
creation due to entry when all parameters are changing (recall Figure 6), an increase in t alone increases
these terms dramatically. The interaction of declining competition and changes in technology are again
necessary for understanding these facts.


7    Conclusion
Different measures suggest that market power has increased in recent decades, and this has potentially
far-reaching aggregate implications for consumers, workers and households. To assess the welfare impact
of this trend, we introduce a framework that features strategic interaction between oligopolistic firms in
small markets, embedded in a large economy. Entry of firms is endogenous, and both technology and
market structure affect equilibrium outcomes in the product and labor market. This framework not only
allows for a quantification of the underlying sources of market power ­ technology and market structure ­
but it also provides a laboratory through we which we can evaluate the distinct role market power plays in
shaping overall business dynamism in the economy. We find that both technology and market structure are



                                                             43
necessary ingredients to explain the evolution of the major secular trends in the US economy. Technological
change, predominantly through rising fixed costs, causes an increase in markups. Together with a change
in the market structure, through a reduction in the number of potential competitors, this leads to a decline
in business dynamism as measured by lower job creation and destruction rates. It is precisely the imperfect
competition in the product market that jointly determines how markups and labor demand react to changes
in technology (be it in productivity or in the shift towards high-fixed cost production technologies). The
decline in business dynamism is thus rooted in an incomplete passthrough of productivity shocks.
   The macroeconomic implications of the rise in market power are extensive and are quantitatively large.
Even though the labor market is competitive, wages drop due to the general equilibrium effect of an
economy-wide increase in market power. With upward-sloping aggregate labor supply, our model implies
a decline in labor force participation that is consistent with the data. The decline in wages and in labor
force participation can thus account for the decline in the labor share. Taking our quantitative general
equilibrium model with heterogeneous firms to the data underscores the importance of jointly allowing
for technological change and changes in market structure to explain the secular trends in the US economy.
   These profound changes result in big negative welfare effects of around 9 percent. However, the steep
decline in output and welfare masks important opposing forces. There is a substantial welfare increase due
to the reallocation of business towards more productive firms, but this positive effect is more than offset by
the fact that those efficient firms use their dominance to extract rents from the customers. Our model and
result thus unify what may seem like contradictory findings: decreasing prices yet increasing markups.
   Our analysis of welfare and the decomposition of output indicate that policy implications are much
more subtle than myopically reducing market power. Splitting up dominant firms may decrease rent ex-
traction, but it will also destroy efficiency gains. A simple attribution of rising market power to a weaker
antitrust policy is not supported by our findings of higher efficiency of dominant firms. Instead, analyzing
the impact of the dominant position of firms on product and labor market outcomes is first order.

References
A CEMOGLU , D., V. M. C ARVALHO , A. O ZDAGLAR , AND A. TAHBAZ -S ALEHI (2012): "The network origins of aggre-
  gate fluctuations," Econometrica, 80, 1977­2016.

A KCIGIT, U. AND S. T. ATES (2021): "Ten Facts on Declining Business Dynamism and Lessons from Endogenous
  Growth Theory," American Economic Journal: Macroeconomics, 13, 257­98.

A MITI , M., O. I TSKHOKI , AND J. K ONINGS (2016): "International shocks and domestic prices: how large are strategic
  complementarities?" NBER Working Paper 22119, National Bureau of Economic Research.

ATKESON , A. AND A. B URSTEIN (2008): "Pricing-to-Market, Trade Costs, and International Relative Prices," American
  Economic Review, 98, 1998­2031.

A UTOR , D., D. D ORN , L. F. K ATZ , C. PATTERSON , AND J. VAN R EENEN (2017): "The Fall of the Labor Share and the
  Rise of Superstar Firms," Tech. rep., Centre for Economic Performance, LSE.


                                                         44
A ZAR , J., S. B ERRY, AND I. E. M ARINESCU (2019): "Estimating Labor Market Power," Available at SSRN 3456277.

A ZAR , J., I. M ARINESCU ,   AND   M. I. S TEINBAUM (2017): "Labor market concentration," Tech. rep., National Bureau
  of Economic Research.

B AQAEE , D. R. AND E. FARHI (2017): "The Macroeconomic Impact of Microeconomic Shocks: Beyond Hulten's
   Theorem," Tech. rep., National Bureau of Economic Research.

B ENKARD , L., A. Y URUKOGLU , AND A. L. Z HANG (2021): "Concentration in Product Markets," Tech. rep., Stanford
   University.

B ERGER , D., K. H ERKENHOFF ,      AND    S. M ONGEY (2019): "Labor Market Power," Chicago mimeo.

B ERRY, S., M. G AYNOR , AND F. S COTT M ORTON (2019): "Do Increasing Markups Matter? Lessons from empirical
   industrial organization," Journal of Economic Perspectives, 33, 44­68.

B ERRY, S., J. L EVINSOHN ,   AND   A. PAKES (1995): "Automobile Prices in Market Equilibrium," Econometrica, 63, 841­
   890.

B ERRY, S. AND P. R EISS (2007): "Empirical models of entry and market structure," Handbook of industrial organization,
   3, 1845­1886.

B ERRY, S. T. (1992): "Estimation of a Model of Entry in the Airline Industry," Econometrica, 889­917.

B RESNAHAN , T. F. (1982): "The oligopoly solution concept is identified," Economics Letters, 10, 87­92.

------ (1989): "Empirical studies of industries with market power," Handbook of industrial organization, 2, 1011­1057.

B URSTEIN , A., V. C ARVALHO , AND B. G RASSI (2019): "Bottom-up markup fluctuations," in 2019 Meeting Papers,
   Society for Economic Dynamics, 505.

C ARVALHO , V. M. AND B. G RASSI (2015): "Large firm dynamics and the business cycle," Cambridge mimeo.

C ARVALHO , V. M.    AND   A. TAHBAZ -S ALEHI (2019): "Production networks: A primer," Annual Review of Economics,
  11, 635­663.

C HARI , V. V., P. J. K EHOE ,   AND   E. R. M C G RATTAN (2007): "Business Cycle Accounting," Econometrica, 75, 781­836.

C HETTY, R., A. G UREN , D. M ANOLI , AND A. W EBER (2011): "Are micro and macro labor supply elasticities consis-
  tent? A review of evidence on the intensive and extensive margins," American Economic Review, 101, 471­75.

D AVIS , S. J., J. C. H ALTIWANGER , S. S CHUH , ET AL . (1998): "Job creation and destruction," MIT Press Books, 1.

D E L OECKER , J., J. E ECKHOUT, AND G. U NGER (2020): "The Rise of Market Power and the Macroeconomic Implica-
   tions," Quarterly Journal of Economics, 135, 561­644.

D E L OECKER , J. AND F. M. P. WARZYNSKI (2012): "Markups and Firm-level Export Status," American Economic
   Review, 102, 2437­2471.

D ECKER , R. A., J. H ALTIWANGER , R. S. J ARMIN , AND J. M IRANDA (2017): "Changing Business Dynamism and
  Productivity: Shocks vs. Responsiveness," Mimeo, University of Maryland.

E DMOND , C., V. M IDRIGAN , AND D. Y. X U (2015): "Competition, Markups, and the Gains from International Trade,"
   American Economic Review, 105, 3183­3221.

------ (2019): "How costly are markups?" Tech. rep., National Bureau of Economic Research.

G ABAIX , X. (2011): "The granular origins of aggregate fluctuations," Econometrica, 79, 733­772.

G AUBERT, C. AND O. I TSKHOKI (2016): "Granular comparative advantage," Berkeley mimeo.

G RASSI , B. (2017): "IO in IO: Competition and volatility in input-output networks," Unpublished Manuscript, Bocconi
  University.

                                                              45
H ALTIWANGER , J. (1997): "Measuring and Analyzing Aggregate Fluctuations: The Impor- tance of Building from
  Microeconomic Evidence," Federal Reserve Bank St. Louis Review, 79, 868­897.

H ERSHBEIN , B., C. M ACALUSO , AND C. Y EH (2020): "Concentration in US local labor markets: evidence from
  vacancy and employment data," Tech. rep., Richmond Fed.

H OLMES , T. J. (2011): "The diffusion of Wal-Mart and economies of density," Econometrica, 79, 253­302.

H OPENHAYN , H. AND R. R OGERSON (1993): "Job Turnover and Policy Evaluation: A General Equilibrium Analysis,"
  Journal of Political Economy, 101, 915­938.

H OPENHAYN , H. A. (1992): "Entry, exit, and firm dynamics in long run equilibrium," Econometrica: Journal of the
  Econometric Society, 1127­1150.

H OUDE , J.-F., P. N EWBERRY, AND K. S EIM (2017): "Economies of density in e-commerce: A study of amazon's
  fulfillment center network," Tech. rep., National Bureau of Economic Research.

J OVANOVIC , B. (1982): "Selection and the Evolution of Industry," Econometrica, 649­670.

K ARABARBOUNIS , L.     AND   B. N EIMAN (2014): "The Global Decline of the Labor Share*." Quarterly Journal of Eco-
  nomics, 129.

M ONGEY, S. (2017): "Market Structure and Monetay Non-neutrality," .

S UTTON , J. (1991): Sunk costs and market structure: Price competition, advertising, and the evolution of concentration, MIT
   press.

------ (2001): Technology and market structure: theory and history, MIT press.

S YVERSON , C. (2019): "Macroeconomics and Market Power: Context, Implications, and Open Questions," Journal of
   Economic Perspectives, 33, 23­43.




                                                             46
                                                                       A PPENDIX
                                                             N OT FOR P UBLICATION



This Appendix is organized as follows. Section A provides additional mathematical details and deriva-
tions. Section B provides additional details on the mapping of the model to the data. Section C provides
additional Figures and Tables references in the main text.


A      Derivations
A.1         Household Demand.

In the economy with CES aggregation technology, total consumption within a household C can be written
               1                1
as (( j) =     J   and (i ) =   Mj   in our model):

                                                                                                                  
                                                                                                           -1     - 1
                                                               1                       1                 -1 
                                                                                               -1
                                                         1                     1       

                                                                                                                                       (A1)
                                                                                               
                                      Y=                                                    yij                 dj
                                                     j   J              i
                                                                               Mj

     To derive the demand function, we first solve a maximization problem such that C is maximized with
chosen cij subject to the budget constraint


                                                           pij yij dj  Z(= W L + )
                                                         j i
                                                                                                                                       (A2)

where Z is total amount of money spent. This optimization problem is equivalent to the lagarian (Maxi-
mizing the monotonic transformation of C is easier and gives the same results since C is strictly increasing
in cij ):                   
                                          1                        1
                                                                                       -1         
                                                                         -1          -1 
                                      1                  1         
                       L=                                                                    dj -                 pij yij dj - Z
                                                                         
                                                                       yij                                                         ,
                                 j    J          i
                                                         Mj                                                     j i
The first order condition is
                                                                                      -
                                                                             pij
                                                               yij =                        yi j ,  j                                  (A3)
                                                                             pi j
     Multiply both sides of (A3) by pij take the sum over i we can get

                                                          pij yij =  pij
                                                                                     1-  
                                                                                        pi j yi j ,  j
                                                         i                    i

                                                              Zj = pi j yi j  pij ,  j
                                                                                                  1- 

                                                                                        i
                                                                                                                                       (A4)
                                                                                               -
                                                                                        Zj pij
                                                                        yij =                  1- 
                                                                                                        , j
                                                                                       i pij
We want to derive p j as the expenditure to buy one unit of c j , which is Zj |c j =1 , and it naturally follows that
                                                        
                                                  - 1   -1
                                                                                                1
                                    1        -                              1
                                1   Zj pij  
                                                                                                -1
                                                                      1  -1
                  y j =                                                              pij
                                                                                         1- 
                                                           = Zj
                         
                                Mj           1-       
                                                                     Mj
                            i           i pij                                       i

                                                                                      1
                                                                                     1- 
                                                         1
                                               
                                                                          1- 
                         pj =                                         pij                      , j
                                               i
                                                         Mj

   From (A2) we know that i pij yij = Zj and Zj = p j y j from the definition of p j . We can write i pij yij =
p j y j . Thus we can do similar algebra to p j
                                                                            1
                                                                      1               -1
                                           L=                                   y j  dj              -               p j y j dj - Z ,
                                                             j        J                                          j

and the first order condition is
                                                                                                     -
                                                                                               pj
                                                                            yj =                          cj .                                                        (A5)
                                                                                               pj
   We have
                                                                                                     -
                                                                                           pj                                            -
                                        Z=             p j y j dj =             pj                       y j dj = pj yj               p1
                                                                                                                                       j   dj
                                                   j                        j              pj                                     j
                                                                                                                                                                      (A6)
                                                                     Zp-
                                                                       j
                                                                         
                                           yj =                         -
                                                                                    , j
                                                                 j
                                                                     p1
                                                                      j   dj

Similarly, we want to derive P as the expenditure to buy one unit of Y , which is Z |Y =1 , and it naturally
follows that
                                                                                                                             
                                                                                                Zp-
                               1                    -1                                1                                      -1                  1
                       1             -1                                         1     
                                                                                                  j                    -1                   1    -1              1
                                                                                                                                                             -   -1
          Y=                       yj
                                          dj             =                                 (                dj )                      =Z                  p1
                                                                                                                                                           j   dj
                   j   J                                               j        J                p1- dj
                                                                                                j j
                                                                                                                                            J         j
                                                            1
                                   1         -
                                                           1- 
               P=                         p1
                                           j   dj
                           j       J

   With yij in (A4), y j in (A6), and Z = p j y j = PY , we can get
                                                                                -
                                                                       Zpij                     1 1 -  - 
                                                         yij =                            =          p p P C,
                                                                         1- 
                                                                      i pij                     J M j ij j

A.2   Cournot Nash equilibrium

Demand within the sector is as follows
                                                                           -                                                -1/
                                                             pij                                                      yij
                                            yij =                               yj             = pij =                                 pj
                                                             pj                                                       yj

Demand across sectors is
                                                                           -                                                -1/
                                                                 pj                                                   yj
                                               yj =                             Y              = p j =                                P
                                                                 P                                                    Y
   Then the total inverse demand function of the firm is

                                                                                  -1      1
                                                                                              -1
                                                                pij = yij  y j                 
                                                                                                   X

Using the inverse demand function, the profit function under constant marginal cost cij :

                                                  ij = yij yij - cij yij
                                                                  -1          1
                                                                                  -1
                                                        = yij  y j                 
                                                                                        X yij - cij yij
                                                                    1     1
                                                                 1-           -1
                                                  ij = yij              y j    
                                                                                        X -cij yij
                                                                        rij


The first order condition is

                                        1         -1    1
                                                            -1                    1 1                  1- 1     1
                                                                                                                    -1
                                                                                                                      -1        y j
                        0=       1-           yij  y j       
                                                                 X+                -               yij        y j           X       - cij
                                                                                                                                yij

which can be written

                               1             -1   1
                                                      -1                      1 1                      -1      1
                                                                                                                   -1           y j yij
                   0=    1-             yij  y j       
                                                           X      +            -                   yij  y j         
                                                                                                                        X               - cij
                                                                                                                                yij y j

                                   y j yij
Using the familiar result that     yij y j   = sij under CES demand systems, and substituting back in the inverse
demand function

                                                            1                           1 1
                                        0=            1-           pij +                 -               pij sij - cij .
                                                                                         

Reearranging, we obtain

                                                      pij = µ(sij )ci j
                                                                                                               -1
                                                                        sij 1
                                                                             + (1 - sij ) 
                                                                                          1
                                             µ (sij ) =                                                   -1
                                                                  sij 1
                                                                       + (1 - sij ) 
                                                                                    1
                                                                                                               -1

A.3   Bertrand Nash equilibrium

Profits

                                                                   W
                                         ij =           pij -                     yij
                                                                   zij
                                                                                               -                    -
                                                                   W                    pij               pj
                                                  =     pij -                                                           Y
                                                                   Xij                  pj                P
                                                                              -  -
                                         ij = pij - cij pij p j                                X
Note that                                                        1
                                               Mj               1-  -1                     -
                                     pj                                              pij
                                               
                                                       1-                 -
                                         =            pij                pij =
                                     pij       j =1
                                                                                     pj

and revenue is

                                               rij = pij yij
                                                                   -  -
                                                      = pij pij p j           X
                                                          1-   - 
                                               rij = pij     pj X

which implies that revenue shares are
                                                             1-            1- 
                                         rij     pij       pij     p j pij
                                   sij =       =         =      =
                                         k rkj       1- 
                                                 k pkj
                                                            1- 
                                                           pj      pij p j

We have
                                                                1- 
                                                         pij               pij pij
                                             sij =                    =
                                                         pj                pj pj
The first order condition of the firm's problem is then (multiplied by -1)

               -  -                   -  -1  -                                        -   -  -1     pj
            - pij p j   +  pij - cij pij   pj         - ( -  ) pij - cij pij p j                        =0
                                                                                                   pij
                                                                                                p j pij
                                     - pij +  pij - cij - ( -  ) pij - cij                              =0
                                                                                                pij p j
                                                                                                                       pij
                                           - pij +  pij - cij - ( -  ) pij - cij sij = 0,                      µij =
                                                                                                                       cij

                                                                                                   pij = µij cij

where

                                                 ij
                                     µij =           ,          ij =  sij + 1 - sij 
                                              ij - 1
A.4   Derivation of Labor Demand, equation (3)

                     Mj
      Nd =
              j
                    nij          dj, +
                                              j
                                                   M j dj                                                                                                              (A7)
                     i
                     Mj
                          yij
          =
              j
                    zij           dj, +
                                               j
                                                   M j dj                                                                                                              (A8)
                     i
                     Mj                                     -                                           -
                          1            pij                            p j ( pij , p-ij )
          =
              j
                          zij   p j ( pij , p-ij )                            P
                                                                                                              Y dj, +
                                                                                                                                j
                                                                                                                                    M j dj                             (A9)
                     i
                                                                             -                                                            1    - 
                                                                                                         Mj      µij W      1-           1- 
               Mj
                  1
                                                    µij W
                                                     zij
                                                                                                i =1              zij                            
               
                                                                                                                                                 
          =                                                                                                                                     Y dj +       M j dj   (A10)
                                                                                                                                               
                                                                           1
            j  i zij                                                                                                  P
                                                                                              
                                        Mj          µij W       1-        1-                                                                             j
                                        i =1
                                                                                                                                                 
                                                     zij
                                                                       -
                            -            Mj                 1-        1-              Mj                       -
                     W                              µij                                1                µij
          =Y
                     P             j
                                                    zij                            zij                  zij
                                                                                                                       dj +
                                                                                                                                     j
                                                                                                                                         M j dj                       (A11)
                                        i =1                                      i =1

We normalize the price P to be 1, from which we can compute wage W as a function of TFP zij and µij .
                                                                                                                                     1
                                                                                                                           -1        - 1
                                                                                                                -1         -1
                                                                          1                   1         zij
                                                    W=
                                                                      j   J        Mj                   µij
                                                                                                                                dj                                    (A12)
                                                                                      i


This is because:
                                                                                                                                  1
                                                                                                          1
                                                                                                               1-                1- 
                                                                                                         1- 
                                                                1                         1                    
                                                                               Mj pij
                                                                                               1- 
                                           P=                                                                             dj                                          (A13)
                                                                                                                            
                                                            j   J             i
                                                                                                               
                                                                                                                                                 1
                                                                                                                           1
                                                                                                                                1-              1- 
                                                                                                               1-         1- 
                                                                1                         1             W                       
                                           P=                                  Mj                                                          dj                         (A14)
                                                                                                                                             
                                                                                                  µij
                                                            j   J             i
                                                                                                        zij                     
                                                                                                                                  1
                                                                                                                       -1         - 1
                                                                                                               -1      -1
                                          1                     1                 1           zij 1
                                          P
                                            =
                                                            j   J      Mj                     µij W
                                                                                                                            dj                                        (A15)
                                                                          i
                                                                                                                           1
                                                                                                                 -1        - 1
                                                                                                         -1      -1
                                         W                      1                 1           zij
                                         P
                                           =
                                                            j   J      Mj                     µij
                                                                                                                      dj             .                                (A16)
                                                                          i


A.5   Aggregation

This section explains how we write our economy in terms of aggregates in section 2. Defining the measure-
ment of productivity as equation 11, we start with the aggregate markups.
Markups. The definition of markups should be consistent with the nests of price indices. At the sector
level, we have:
                                                                      1
                                                                     1- 
                                                    1 1- 
                                pj =                   p
                                                    M j ij
                                            i
                                                                                 1
                                                                       1-       1- 
                                                    1     µij W
                                   =                Mj     zij
                                        i
                                                                                       1
                                                                            1-        1- 
                                                    1     µij   zj
                                   =                Mj    zij
                                                              ×
                                                                zj
                                                                                            W
                                        i
                                                                                 1
                                                                       1-       1- 
                                                    1         zj                      W
                                   =                Mj
                                                          µij
                                                              zij                     zj
                                        i
                                                                                                1
                                                                      -1               -1      1- 
                                                    1     zij                1                        W
                                   =                Mj    zj                 µij                      zj
                                        i

Noticing that W /z j is the term indicating sectoral marginal cost, we define the bracketed term as our
sector-level markups µ j :
                                                                                                   1
                                                                       -1               -1        1- 
                                                    1          zij              1
                                 µj =               Mj         zj               µij
                                                                                                        ,
                                                i

or, more intuitively,
                                                                                                   1
                                                                       -1                 -1       -1
                                 1                   1         zij              1
                                 µj
                                    =                Mj        zj               µij
                                                                                                        .
                                                i

Similarly, we can define the economy-level aggregate as:
                                                                                             1
                                                                  -1                -1      1- 
                                                          zj               1
                                    µ=                                                            .
                                                     j    Z                µj
Labor demand.       We can also write our labor demand function in terms of above aggregates. Defining the
total fixed cost as  :=       j
                                   M j dj, we have:

                    Mj
            Njd =    nij + Mj 
                    i =1
                     Mj
                             yij
                =            zij
                                        + Mj 
                    i =1
                     Mj
                              1           1                     1         pij - p j -
                =             J           Mj                    zij        pj      P
                                                                                         Y + Mj 
                    i =1
                                                                                  -       - 
                             Mj                                                W        W
                      1                   1                     1          µij       µj
                =            
                                                                           zij   z j  Y        + Mj 
                      J      i =1
                                          Mj                    zij        µj Wzj
                                                                                      P

                                   Mj                                       -                  -1                      1-             -
                      1                           1                 µij                zij               1        1               W
                =
                      J                           Mj                µj                 zj                µj       zj              P
                                                                                                                                          Y + Mj 
                                   i =1
                      Mj                                     -1                    -                               -
                               1                  zij                     µij                1             W /P        Y
                =              Mj                 zj                      µj                 J
                                                                                                      µj
                                                                                                            zj         zj
                                                                                                                          + M j .
                      i =1

                                                   j


Hence, at aggregate level, we have:

                             Nd =             Njd dj
                                          j
                                                                                             -
                                                            1            W /P                     Y
                                    =         j                       µj                             dj + 
                                          j                 J             zj                      zj
                                                                                                         -
                                                                1                                 W
                                    =             j                   µ-   -1
                                                                       j zj   dj                              Y+
                                              j                 J                                 P
                                                                                   -                -1                       -
                                                        1                  µj                zj                    W /P          Y
                                    =                           j                                        dj      µ                 + .
                                              j         J                  µ                 Z                      Z            Z
                                                                                

Note also that at equilibrium, we have µ WZ
                                          /P
                                             = 1 by the definition of the markup.
B     Extended model with multiple inputs
B.1     Mapping the model to the data

Accounting in the data.             In Compustat we can split total costs into three components: capital costs, costs
of good sold and overheard (sales and administrative expenses).31 Costs of goods sold include labor and
intermediate costs, and overhead costs also include labor and intermediates.

              Pro f itsit = Salesit - TotalCostsit                                                                             (B1)

       TotalCostsit = CapitalCostsit +

                                ProdLaborCostsit + ProdInterCostsit + FixedLaborCostsit + FixedInterCostsit . (B2)
                                         Costs of goods sold=COGSit                           Overheard or Fixed costs=SGAit

In the data we observe Salesit , CapitalCostsit , COGSit , SGAit . We only observe a measure of total labor
costs: ProdLaborCostsit + FixedLaborCostsit . Given these constraints, we describe how we map this to the
model.


Accounting in the model.               We make the following assumptions to make the model consistent with (B1)
and (B2): (i) the production function is constant returns to scale, (ii) labor and intermediates are perfect
substitutes, and (iii) capital is used in production:
                                                                COGS
                                     yit = zit nit + mit               kit
                                                                          k
                                                                                ,    COGS + k = 1                              (B3)

Given these inputs, we have the following expression for profits in the model, which we map to the data
as follows:
                                                COGS
                   it = pit zit nit + mit              kit -
                                                          k
                                                                  Rt k it       - Ptm mit + Wt nit - Ptm m + Wt  .             (B4)

                                      Salesit                  CapitalCostsit           COGSit                 SGAit

We have assumed that the firm faces the same prices for intermediates and labor regardless of whether
they are used in production or in overhead. In terms of the economics, we show that the model analyzed
so far with only labor remains appropriate, and how moments computed from the available data map into
the model.


Optimality.         Since they are perfect substitutes, the firm will be indifferent between labor and intermedi-
ates in production. We therefore assume that their shares are the same across firms, and define parameters
COGS and SGA :                                               nit                               
                                           COGS :=                          ,       SGA :=        .
                                                         nit + mit                            + m
    31 We   follow De Loecker et al. (2020) for the data construction.
The first order conditions of the variable cost minimization problem give expressions for the markup and
marginal cost, and deliver the result that COGS is also equal to the cost share of labor in COGSit :
                                                           COGS
           pit         COGS                   1      Wt            R t k                       Wt nit
   µit :=       =                   , mcit =                                , COGS =                       .
          mcit    COGSit pit yit             zit COGS              k                      Wt nit + Ptm mit
                                                         Aggregate marginal cost: MCt
Combining factor demands for intermediates and capital, we can write the production function and total
variable costs in terms of only labor:
                                   1              Wt                                                                  Wt
      yit = zit nit , zit = COGS COGS                       zit     ,    Rt k it + Wt nit + Ptm mit =              COGS
                                                                                                                                    ×nit
                                                  MCt                                                                   COGS
                                                                                   Total variable cost
                                                                                                                       :=Wt
Re-writing the firms' problem in terms of these objects gives the following expression for profits:

                                      it = pit zit nit - Wt nit - Wt COGS  .

This delivers the following optimal price, where marginal cost mcit = mcit is consistent with the above:
                                                                                                                           -1
                        pit                 Wt                        it                              1      1
               µit =           ,   mcit =         ,   µit =                    ,       it =             sit + (1 - sit )        .          (B5)
                        mcit                zit                    it + 1                                    

B.2   Aggregation

This section explains how we extend our aggregated notation from single-input economy into the multi-
input one with the following production function where the intermediates are already substituted:
                                                                    COGS                K
                                                        1                      k ij
                                       yij = zij                                              nij .
                                                      COGS                     nij

We will derive all the equilibrium conditions mentioned in equation 25.


Optimality.   By solving the cost minimization problem, we learn how would firms decide the optimal
combination of labor and capital:
                                              k ij    1             W /COGS
                                                   = COGS                                 .
                                              nij                    R/K
The solution also gives us the marginal cost for production:

                                                                        COGS                  K
                                               1            W                        R
                                        mcij =                                                    .
                                               zij      COGS                         K

Notice that this ratio is independent of firms' characters, which allows us to write this optimality condition
into aggregate level:
                                             K       1                  W /COGS
                                                  = COGS                                      .
                                            Nprod                        R/K
Production technology.       We first derive the production function in aggregate level. To do so, we add the
production labor up:
                                                  Mj
                                  d
                                 Nprod =           nij dj
                                               j i =1
                                                         -K                         COGS
                                                                                                   Mj
                                                k ij                                                        yij
                                         =
                                                nij
                                                                     COGS
                                                                                               j
                                                                                                            zij
                                                                                                                    dj
                                                                                                   i =1
                                                              -K                       COGS
                                                   K                                                    Y
                                         =                            COGS                         
                                                  Nprod                                                 Z

By rearranging, we get:

                                                                     COGS                               K
                                                          1                             K
                                         Y =                                    Z                           Nprod
                                                       COGS                            Nprod
                                                                     COGS
                                                          1                                K       COGS
                          Output: Y =                                           ZK  Nprod
                                                                                     
                                                                                          ,                     Y : = Y                (B6)
                                                       COGS

Goods market clearing.       We then investigate the goods market clearing condition given the normalized
aggregated price P:
                                                                        1
                                                              1-       1- 
                                     1                        1- 
                                              1
                                          Mj pij
                                                       1- 
                   1=P=                                             dj
                                 0       i
                                                                                             1
                                                                                1-          1- 
                                     1                                          1- 
                                              1                     1- 
                          =
                                 0
                                          Mj           µij mcij                       dj
                                         i
                                                                                                                                  1
                                                                                                                         1-      1- 
                                             COGS                 K             1                                 1-     1- 
                                  W                       R                                    1          µij
                          =
                                 COGS                     K
                                                                      
                                                                            0
                                                                                       Mj                 zij
                                                                                                                               dj
                                                                                       i

                                             COGS                 K
                                     W                    R           µ
                          =                                             ,
                                 COGS                     K           Z

which can be rewritten as:
                                                                                                       K                  1
                                                                            COGS               K      COGS         Z     COGS
                       Goods market clearing: W =                                                                               .      (B7)
                                                                                               R                   µ

Labor markets clearing.      We already have the labor supply function in the aggregate level:

                                             Total labor supply:                      N = W  .                                         (B8)
On the demand side, we can express the labor demand in terms of factor payment shares from the goods
market clearing condition:

                                                           COGS            K
                                               W                   R           µ
                                    P=
                                            COGS                   K           Z
                                                                  -COGS             -K
                                       P               W                       R
                                     1= Z
                                       µ           COGS                        K
                                                                                              
                                                                  -1                      K
                                          P     W                      W /COGS
                                     1=     Z                                                 
                                          µ    COGS                        R/K
                                                                       K
                                            COGS P           K
                               W Nprod =               Z                   Nprod
                                                   µ        Nprod

Notice that the production function is embedded in the RHS:

                                                        P   K COGS
                                          W Nprod = COGS ZK  Nprod
                                                        µ
                                                                                   COGS   P
                                          W Nprod = COGS COGS                               Y
                                                                                          µ
                                                                                   COGS    Y
                                             Nprod = COGS COGS
                                                                                          µW
                                                                                   COGS    Y
                        Total labor demand:        N = COGS COGS                             +         (B9)
                                                                                          µW

Capital markets clearing.    Moreover, we assume the supply of capital is inelastic, where the capital price
R is determined by:
                                   Capital supply:          1 = [ R + (1 - )].                        (B10)

On the other hand, the optimality in production makes sure that aggregate capital demand follows:

                                                              1        W /COGS
                             Capital demand:       K=                                     Nprod .     (B11)
                                                            COGS        R/K
B.3   Output and welfare decomposition

Output decomposition. The aggregation system enables us to express all the aggregates in terms of our
wedges { Z  , , S, µ, }, where Z = SZ  :
                                                 K                 1
                          COGS COGS      K      COGS     Z S      COGS
                  W=             
                                         R                µ
                                                     K
                                                                            
                                                K   COGS          Z S      COGS
                  N =  COGS COGS                           
                                                R                  µ
                                                         K
                                                               (1+  )
                                                    K   COGS                  1+         K + 
                                                                                         -     -  1
                   Y=         COGS COGS
                                                                        ( Z  S) COGS -1 µ COGS  COGS
                                                    R

Hence, we get:

                              1+                  K +                1
                          yt = COGS
                                    (zt - st ) -           log µt - COGS t - t                                   (B12)
                                                  COGS             
                                                  
                         nt = COGS (z t - st ) - COGS  log µt                                                    (B13)
                                                 

Welfare decomposition. We measure welfare in consumption equivalent terms, which makes the house-
hold in 1980 indifferent with respect to the period t allocation:

                   U ((1 + t ) C0 , N0 ) = U (Ct , Nt )

        U (C0 , N0 ) + Uc (C0 , N0 ) t C0  U (C0 , N0 ) + Uc (C0 , N0 ) (Ct - C0 ) + Un (C0 , N0 ) ( Nt - N0 )

                      Uc (C0 , N0 ) t C0 = Uc (C0 , N0 ) (Ct - C0 ) + Un (C0 , N0 ) ( Nt - N0 )

which gives us:

                                    Ct - C0       Un (C0 , N0 ) N0 Nt - N0
                           t =                  +
                                       C0         Uc (C0 , N0 ) C0     N0
                                    Ct - C0        W0 N0        Nt - N0
                           t =                  -
                                       C0          P0 C0           N0
                                                    Labor share

                           t =  log Ct - ls0 ·  log Nt
                                    K + (1 - ls0 )                            1
                           t =           COGS
                                                    (zt - µt ) + (zt - t ) - COGS t                              (B14)
                                                                            

B.4   Variance-covariance decomposition

We exploit the second-order Taylor approximation to decompose aggregates into the statistical moments
of its distribution. The process is complicated but not difficult. Here, we take the decomposition of pro-
ductivity Zt as an example, and all other decomposition can be carried out in the same approach.
   Start with the aggregate productivity defined in a single-nest approximation:
                                                                                      1
                                                                          N         v -1
                                                                     1
                                                       Zt =
                                                                     N    zit
                                                                           v -1
                                                                                            ,N=
                                                                                                  j
                                                                                                      Mj
                                                                         i =1
                                                        -1            N
                                                                 1
                                                Zt           =
                                                                 N    zit
                                                                       v -1

                                                                     i =1
                                                                       N
                                                                 1
                                           e(-1) log Zt =
                                                                 N    e(v-1) log z     it

                                                                     i =1

Expand the LHS at log zit :=           1
                                       N   iN
                                            =1 log zit , we get:


                            e(-1) log Zt  e(-1)log zit + ( - 1)e(-1)log zit log Zt - log zit

                                             = e(-1)log zit 1 + ( - 1) log Zt - log zit                     ,

while for the RHS, we have:
               Nj                                N                                                      N
           1                                1                                   1
           N          e( - 1)log zit   =
                                            N           e( - 1)log zit +
                                                                                N
                                                                                  ( - 1) e(-1)log zit  log zit - log zit
               i =1                             i =1                                                  i =1
                                                                           N
                                              1 1                                             2
                                              +     ( - 1)2 e(-1)log zij  log zit - log zit
                                              2N                         i =1
                                                                                                2
                                                                                                  
                                                                            N
                                                           1             i=1 log zit - log zit 
                                       = e( - 1)log zit 1 + ( - 1)2
                                                        
                                                           2                      N
                                                                                                  


   Equating them, we get:
                                                                                                                                    2
                                                                                                                                        
                                                                                     1                     iN
                                                                                                            =1 log zit - log zit
      e(-1)log zit 1 + ( - 1) log Zt - log zit                   = e( - 1)log zit 1 + ( - 1)2
                                                                                                                                        
                                                                                     2                                N
                                                                                                                                        


                                                             1       2
                                                                       iN
                                                                        =1 log zit - log zit
                                           log Zt - log zit = ( - 1)
                                                             2                 N
                                                                                                                                2
                                                                         iN                             iN
                                                                                                         =1 log zit - log zit
                                                                          =1 log zit        1
                                                        log Zt =                        +     (  - 1)
                                                                                N           2                     N
                                                                               1
                                                        log Zt = E [log zit ] + ( - 1) V [log zit ]                                     (B15)
                                                                               2

B.5    Markup Decomposition

This section documents the method we use to decompose markups. Following Haltiwanger (1997), we can
measure this reallocation of revenue by decomposing the change in the markup into a component that is
due to (i) changes in market shares ( Reallocation), (ii) changes in markups themselves ( Within), and
(iii) the effect of Net entry as follows:

    µt =    µij,t-1 mij,t +  µij,t mij,t +  mij,t-1 µij,t +                             µij,t mij,t -              µij,t-1 mij,t-1 ,   (B16)
            i, j                 i, j                 i, j                  i, jEntry                   i, jExit

               Market share              Cross term          (ii)  Within                      (iii) Net entry
                      (i)  Reallocation

where µij,t = µij,t - µt-1 , and µij,t-1 = µij,t-1 - µt-1 are deviations from the economy wide markup and
mij denotes the revenue share of any firm i in the entire economy.
   Since the estimated parameters of our economy are different in different years, but we assume a steady
state of the economy in each year, then we need to make some assumptions in order to proceed with this
decomposition. The assumption we make is to map firms together over time according to their subscript
ij. Let M = max{ Mt } be the largest number of potential entrants and let U = {uijt } be an array of uniform
random numbers for all firms i  {1, . . . , M } in all j sectors in all j periods. We start in 1980. Given the
                                                                                         
stationary distribution of productivity implied by productivity process and parameters , 1980 , the first set
of random numbers determine initial productivity by inverting the CDF of this distribution. We then use
the remaining random numbers and the sequence of productivity process parameters t for 1981 to 2016 to
evolve productivity forward for all M × J firms forward at random. This gives us an array Z = {zijt
                                                                                                 } of

latent productivities of the M × J over the T periods.
   To take care of changes in the number of potential entrants we then proceed as follows. In 1980 there
are M1980  M potential entrants. In each market, we draw at random the M1980 potential entrants from
the M firms, and in 1980 set the remaining firms' productivity to zero. In 1981, if M1981 < M1980 then we
randomly select M1980 - M1981 of the M1980 firms and set their actual productivities zijt = 0, while for the
                                   .
potential entrants we set zijt = zijt
   This then gives us a distribution of firm productivities Zt = {zijt } in all periods, of which these are
zero for firms that are not considered potential entrants. Given the parameter t we can then solve for the
steady state of the economy in each t, recording markups and sales for all firms. For firms that are not
potential entrants, these are obviously both zero. We then solve this economy in each year record markups
and sales shares and apply the above decomposition.
C     Additional figures and tables




                         Figure C1: Model fit - Moments with a counterfactual path for t
Notes: This replicates Figure 3, with the addition of the blue dashed line which corresponds to moments under the counterfactual
path for  in Figure C2, below.




                         Figure C2: Parameter estimates with a counterfactual path for t
Notes: This replicates Figure 4, with the addition of the blue dashed line in panel C which corresponds to moments a counterfac-
tual path for  which smoothly joins the estimated path for  between its 1998 and 2016 values.
                           Figure C3: Relationship between log productivity and profits

Notes: This figure plots average operating profits of firms against log productivity in the 2016 solution of the model. In each case
operating firms are split into 25 quantiles of log productivity, with average log productivity and average operating profits (sales
minus variable costs) computed within each bin. The vertical axis plots the level different with respect to the mean profits in the
lowest quantile.




        Figure C4: The effects of market structure and technology on entry rate and labor dynamism
                  Figure C5: Entry rate and the composition of job destruction due to M and 

Notes: The format of this plot follows from Figure 2. The vertical axis plots the variables of interest in level deviations from their
value when each parameter is set to its median value between 1980 and 2016, which is marked by the black dashed line. Each
parameter is then varied between its minimum and maximum value over 1980 to 2016.
                                              Figure C6: Wedges - time series

Notes: This figure plots the time-series of the wedges that appear in the set of general equilibrium conditions of the model.
         Figure C7: The effect of aggregate equilibrium wedges on aggregate quantities and prices

Notes: For context, Panel A replicates Figure 10 from the main text. Panels B, C, and D repeat the same exercise for employment
nt , the wage wt and total labor productivity which is defined as yt - nt
Figure C8: Effect of M,  and the two combined
                     Figure C9: Covariance structure of wedges due to different parameters

Notes: This figure plots the time-series of the wedges {zt , st , t , t } from the model against the time-series of the markup wedge
µt , that are induced by changes in each parameter separately. Each series is plotted in log deviations from the average over 1980
to 2016. For cross-reference, the colors here match Figure 12. The circle marker corresponds to the 1980 values of the parameters,
while the square corresponds to the 2016 value.




Figure C10: Decomposing output and welfare into variance and covariance of markups and productivity
Notes: This figure combines the second order approximation that decomposes wedges into moments of the joint distribution of
log productivity and log markups (equations (31) to (33)) and the expressions that decompose output (28) and welfare (29) into
wedges, to decompose output and welfare into the moments of the joint distribution of log productivity and log markups.
           Figure C11: Approximation and decomposition of overhead wedge t




Figure C12: The effects of parameters on statistical moments of the decomposition of overhead
