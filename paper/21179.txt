                                NBER WORKING PAPER SERIES




A TRACTABLE MODEL OF MONETARY EXCHANGE WITH EX-POST HETEROGENEITY

                                        Guillaume Rocheteau
                                        Pierre-Olivier Weill
                                          Tsz-Nga Wong

                                        Working Paper 21179
                                http://www.nber.org/papers/w21179


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      May 2015




We thank participants at the 2012 and 2014 Summer Workshop on Money, Banking, Payments, and
Finance at the Federal Reserve Bank of Chicago, at the Search-and-Matching Workshop at UC Riverside,
at the 2014 SED annual meeting, at the 2014 SAET annual meeting, at the 2015 Midwest Macro Meeting
and seminar participants at Academia Sinica (Taipei), the Federal Reserve Bank of Richmond, the
Hong Kong University of Science and Technology, the EIEF institute in Rome, the University of California
at Irvine, Indiana Univesity, Purdue University, and Singapore Management University for useful
discussions and comments. This paper does not reflect the views of the Bank of Canada or the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2015 by Guillaume Rocheteau, Pierre-Olivier Weill, and Tsz-Nga Wong. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
A Tractable Model of Monetary Exchange with Ex-post Heterogeneity
Guillaume Rocheteau, Pierre-Olivier Weill, and Tsz-Nga Wong
NBER Working Paper No. 21179
May 2015
JEL No. E0,E41,E52

                                              ABSTRACT

We construct a continuous-time, pure currency economy with the following three key features. First,
our modelled economy incorporates idiosyncratic uncertainty—households receive infrequent and
random opportunities of lumpy consumption—and displays an endogenous, non-degenerate distribution
of money holdings. Second, the model is tractable: properties of equilibria can be obtained analytically,
and equilibria can be solved in closed form in a variety of cases. Third, it admits as a special, limiting
case the quasi-linear economy of Lagos and Wright (2005) and Rocheteau and Wright (2005). We
use our modeled economy to obtain new insights into the effects of anticipated inflation on individual
spending behavior, the social benefits and output effects of inflationary transfer schemes, and transitional
dynamics following unanticipated monetary shocks.


Guillaume Rocheteau                                  Tsz-Nga Wong
Department of Economics                              Research Department
University of California at Irvine                   Bank of Canada
3151 Social Science Plaza                            234 Laurier Avenue West
Irvine, California 9269                              Ottawa, Ontario, Canada
grochete@uci.edu                                     K1A 0G9
                                                     purpleteeth@gmail.com
Pierre-Olivier Weill
Department of Economics
University of California, Los Angeles
Bunche Hall 8283
Los Angeles, CA 90095
and NBER
poweill@econ.ucla.edu
1       Introduction

We construct a continuous-time, pure-currency economy with the following three key features. First,
our economy incorporates idiosyncratic uncertainty and displays an endogenous, non-degenerate
distribution of money holdings, as in Bewley (1980, 1983). The nature of the idiosyncratic risk is
analogous to the one in random-matching monetary models (Shi, 1995; Trejos and Wright, 1995).1
Second, our model is tractable, by which we mean that properties of equilibria can be obtained
analytically, and equilibria (including value functions and distributions) can be solved in closed
form in a variety of cases. Third, our model admits as a special, limiting case the quasi-linear
economy of Lagos and Wright (2005) and Rocheteau and Wright (2005), LRW thereafter, that has
become the workhorse paradigm for monetary theory. We use our model to revisit classical, yet
topical, questions in monetary economics: the e¤ects of anticipated in‡ation on individual spending
behavior, the social bene…ts and output e¤ects of in‡ationary transfer schemes, and transitional
dynamics following unanticipated monetary shocks.
    Pure currency economies are environments in which contracts involving intertemporal oblig-
ations are unfeasible, due to lack of monitoring and enforcement, and in which currency is the
only durable object that can serve as means of payment. Despite being far-removed from actual
economies, they are critical constructions for our understanding of monetary exchange, and by
extension of monetary policy. Following Bewley (1980, 1983), pure currency economies typically
feature idiosyncratic uncertainty (in the recent literature, random matching shocks), which gener-
ates a precautionary demand for liquidity. Despite the presence of uninsurable idiosyncratic risk,
the most recent and widely used models (e.g., Shi, 1997; Lagos and Wright, 2005) deliver equilibria
with degenerate distributions of money holdings.2 These models are useful and appealing because
they can be solved in closed form and can easily be integrated with the standard representative-
agent model used in macroeconomics, which has led to a variety of insights into the role of money
and monetary policy.3 Yet, this gain in tractability comes at a cost: models with degenerate distri-
    1
      More precisely, households receive infrequent and random opportunities for lumpy consumption. In the Shi
(1995) and Trejos and Wright (1995) models random opportunities for lumpy consumption take place in pairwise
meetings and the terms of trade are determined via ex-post bargaining. Relative to Shi (1995) and Trejos and Wright
(1995), in this paper the distribution of money holdings is unharnessed by assuming that money is perfectly divisible
and by removing the unit upper bound on money holdings, and all markets are competitive, as in Bewley (1980,
1983) or Rocheteau and Wright (2005).
    2
      In Shi’s (1997) model households are composed of a large number of members who pool their money holdings
in order to insure themselves against the idiosyncratic risks associated with decentralized market activities. In the
Lagos and Wright (2005) model the pooling of money holdings is achieved through a competitive market that opens
periodically and quasi-linear preferences that eliminate wealth e¤ects.
    3
      Some of these insights are surveyed in Shi (2006), Williamson and Wright (2010a,b) and Nosal and Rocheteau


                                                         1
butions miss a fundamental trade-o¤ for policy between promoting self-insurance by enhancing the
rate of return of currency and providing risk sharing through transfers of money (Wallace, 2014).4
In the absence of ex-post heterogeneity, monetary policy is exclusively about enhancing the rate
of return of currency, thereby making the Friedman rule omnipotent. Some versions of the search
model that incorporate this trade-o¤ have been studied numerically (see the literature review),
but they are typically (not always) much harder to grasp due to the complex interactions between
ex-post bargaining and the endogenous distribution of asset holdings.
    In our model, ex-ante identical households, who enjoy consumption and leisure ‡ows, have
the possibility to trade continuously in competitive spot markets. We borrow from search models
(e.g., Shi, 1995; Trejos and Wright, 1995) the description of the idiosyncratic uncertainty: at some
random times households receive idiosyncratic preference shocks that generate utility for lumps of
consumption. These spending opportunities represent large shocks that cannot be paid for by a
contemporaneous income ‡ow, such as health shocks, large housing repairs, durable goods expendi-
tures, changes in family composition such as deaths, births, and marriages, and so on.5 By adopting
the same form of idiosyncratic risk as the one commonly used in search-theoretic environments, we
make our model readily comparable to existing frameworks in monetary theory. Following Kocher-
lakota (1998), lack of enforcement and anonymity prevent households from borrowing to …nance
these spending shocks, thereby creating a role for liquidity. Because the sequences of shocks are
independent across households, the model generates heterogeneous individual histories and hence,
possibly, heterogeneous holdings of money. Finally, the assumption of continuous time, while not
essential, has several advantages. First, the distribution of real balances obeys a smooth, in…nitesi-
mal law of motion known as a Kolmogorov forward equation. As a result, the distribution admits a
smooth density, without spikes, except maybe at one boundary. Second, continuous time provides a
sharp representation of the mismatch between ‡ow endowments and lumpy spending that generates
a role for liquidity. Third, under continuous time ex-post heterogeneity is generic even under the
commonly-used quasi-linear preferences. Last, our methodology can be used to write Lagos-Wright
economies in continuous time, which can be useful to integrate them with other continuous-time
models, such as models of unemployment, models of price distribution, or menu cost models.


(2011).
    4
      For some empirical evidence on the large redistributional e¤ect of in‡ation and monetary policy, see, e.g., Doepke
and Schneider (2006) and Coibion, Gorodnichenko, Kueng, and Silvia (2012).
    5
      As an example, Palumbo (1999) argues that uncertain medical expenses are important to explain precautionary
savings of elderly Americans during retirement.


                                                           2
   We provide a detailed characterization of the household’s consumption and saving problems
under a minimal set of assumptions on preferences. This characterization involves both stan-
dard dynamic programming techniques and less standard arguments from the viscosity theory of
Hamilton-Jacobi-Bellman equations. We show that in equilibrium agents have a target for their
real balances, which depends on their rate of time preference, the in‡ation rate, and the frequency
of consumption opportunities. They approach this target gradually over time by saving a de-
creasing fraction of their labor income ‡ow. When they are hit by a preference shock for lumpy
consumption, agents deplete their money holdings in full, if their wealth is below a threshold, or
partially otherwise. Given the household’s optimal consumption-saving behavior, we can charac-
terize the stationary distribution of real money holdings in the population, and we solve for the
value of money, thereby establishing the existence of an equilibrium. Moreover, under zero money
growth ("laissez-faire"), the steady-state monetary equilibrium is unique, and it is near-e¢ cient
when households are patient; i.e., households are better o¤ in a monetary equilibrium than under
the full-insurance allocation with slightly scaled-down labor endowments (for a de…nition, see Green
and Zhou, 2005).
   If the money growth rate is large enough, then households exhaust their money holdings peri-
odically, as in Shi (1997) or Lagos and Wright (2005), which keeps the model tractable since real
balances only depend on the timing of the most recent shock. In contrast to Shi (1997) and Lagos
and Wright (2005), however, households who accumulate money slowly through time hold di¤er-
ent real money balances at the time when they trade, which makes distributional considerations
relevant.
   We study in detail the special case where households have linear preferences over consump-
tion and labor ‡ows. This version of the model is worth investigating for at least two reasons.
First, it admits as a limit the New-Monetarist model of Lagos and Wright (2005) or Rocheteau
and Wright (2005), LRW thereafter, thereby allowing for a clear comparison with the literature.
Second, the LRW version is especially tractable to investigate the welfare implications of di¤erent
in‡ationary transfer schemes. It allows us to isolate a single parameter, the size of households’
labor endowments, h, that determines the speed at which households insure themselves against
preference shocks, and that parametrizes the trade-o¤ for policy between providing incentives for
self-insurance and improving risk sharing.
   If labor endowments are large, there is limited ex-post heterogeneity. Hence the societal bene…ts



                                                 3
of lump-sum transfers of money in terms of risk sharing are small relative to the distortions induced
by the in‡ation tax on the targeted real balances. As a result, in‡ation is detrimental to both
output and welfare. In contrast, when labor endowments are small, the …rst-best aggregate output
is implemented for positive in‡ation rates. Output is higher than the laissez-faire level because
in‡ation induces the richest households in the economy to keep working in order to mitigate the
erosion of their real balances. For in‡ation rates that are neither too low nor too high, aggregate
real balances are equal to the …rst-best consumption level so that the only ine¢ ciency a- icting
the economy is due to imperfect risk sharing. In that case moderate in‡ation raises welfare by
reallocating consumption from households with low marginal utilities to those with higher marginal
utilities. If preferences for lumpy consumption are linear with a satiation point, as in Green
and Zhou (2005), such positive in‡ation rates implement a …rst-best allocation that could not be
obtained under laissez-faire.
   We calibrate our model using targets from the distribution of balances of transaction accounts
in the 2013 Survey of Consumer Finance (SCF), and provide comparative statics and measures of
the welfare cost of in‡ation. We use this calibrated example to illustrate the negative relationship
between the optimal in‡ation rate and the size of the labor endowment, h. For small values of h
the optimal in‡ation rate is positive while for su¢ ciently large values the optimal in‡ation is 0;
negative in‡ation rates are not feasible in a pure currency economy with no enforcement.
   As conjectured by Wallace (2014) the restriction to lump-sum transfer schemes might not allow
the policy-maker to exploit e¤ectively the trade-o¤ between risk sharing and self-insurance. That
is, even if the optimal in‡ation rate is zero with lump sum transfers, the optimal in‡ation rate may
be positive if one allows for more general transfer schemes. We illustrate this point in our model by
constructing a three-tier incentive-compatible, in‡ationary transfer scheme that improves welfare
in economies with large labor endowments. This scheme assigns a lump-sum amount of money to
the poorest households, thereby improving risk sharing, and a quantity of money that increases
linearly with wealth to the richest households, thereby promoting self insurance. This transfer
scheme, which is designed to keep households’targeted real balances unchanged, raises aggregate
real balances, and it increases social welfare relative to the laissez-faire equilibrium.
   To conclude, we study two additional speci…cations of the model that are solvable in closed form
and provide insights on the e¤ects of money growth in the presence of ex-post heterogeneity. First,
we assume quadratic preferences and show that policy functions are linear in real balances, which



                                                   4
allows us to solve both steady states and transitional dynamics in closed form. A one-time increase
in the money supply leads to a one-time increase in the price level and no e¤ect on aggregate real
quantities despite a redistribution of wealth across households that a¤ects individual consumption
and labor supply decisions. The mean-preserving decrease in the distribution of real balances raises
society’s welfare.
    Second, we assume that the utility over lumpy consumption is linear and the marginal utility
from lumpy consumption is stochastic. In this case agents adopt an optimal stopping rule to spend
their real balances. As in‡ation increases, households spend their real balances more often on
goods that are less valuable to them. This is a manifestation of the so-called "hot potato" e¤ect of
in‡ation that has proven hard to capture in models with degenerate distributions (e.g., Lagos and
Rocheteau, 2005).6

Literature

The contribution of this paper is to develop a pure currency economy with three key features. (i)
Our economy is general in that it incorporates idiosyncratic risk, a well as non-trivial labor supply
decisions, and it generates an endogenous, non-degenerate distribution of money holdings. (ii) Our
model achieves a high level of analytical tractability. (iii) It admits the workhorse model of modern
monetary theory as a limiting case. As we explain below, the incomplete market literature based
on Bewley (1980, 1983) features (i) but neither (ii) nor (iii). The recent monetary literature based
on Shi (1997) and Lagos and Wright (2005) features (ii) but not (i).
    In incomplete market models, households self-insure against idiosyncratic income risk by accu-
mulating assets: …at money in Bewley (1980, 1983), physical capital in Aiyagari (1994), and private
IOUs in Huggett (1993).7 We contribute to this literature by analyzing a new and highly tractable
continuous-time model. We characterize equilibria analytically and we provide methods to study
them numerically. Moreover, in the tradition of monetary theory, market incompleteness arises
endogenously in our model from the absence of enforcement and monitoring technologies. One
implication from making these frictions explicit is that contraction of the money supply through
taxation is inconsistent with the lack of enforcement technology (Wallace, 2014). Hence, we consider
positive money growth rates throughout the paper.
    While incomplete markets are most often solved by way of numerical methods, a few papers
   6
      The "hot potato" e¤ect of in‡ation has also been studied in models with divisible money by Shi (1997), Ennis
(2009), Nosal (2011), and Liu, Wang, and Wright (2011).
    7
      See Ljungqvist and Sargent (2004, chapters 16-17) and Heathcote, Storesletten, and Violante (2009) for surveys.


                                                         5
have developed analytically tractable frameworks. In particular Scheinkman and Weiss (1986);
Algan, Challe, and Ragot (2011); and Lippi, Ragni, and Trachter (2014) study Bewley economies
with quasi-linear preferences, with a special attention to logarithmic preferences for consumption.
In contrast, we characterize our model under general concave preferences and consider quasi-linear
preferences only as a special case. Even for this special case, our model di¤ers in important
ways from the Scheinkman-Weiss model: risk is idiosyncratic and arises from lumpy consumption
opportunities, instead of an aggregate risk on agents’ ability to work, and we impose a bound,
h, on ‡ow labor supply that plays a key role for our normative analysis. Without such an upper
bound the distribution of real balances would be degenerate in our model, just like in the Lagos-
Wright model.8 Our model generates di¤erent trading patterns, provides simple characterization
of distributions, and admits the workhorse “new-monetarist" model as a special case. This allows
us to study the welfare and output e¤ects of in‡ation, the policy trade-o¤ between self-insurance
and risk sharing as parameterized by h, and to analyze the conjecture of Wallace (2014).
   Green and Zhou (2005) adopt mechanism design to investigate the e¢ ciency property of a
discrete-time Bewley monetary economy. They show that monetary spot trading is nearly e¢ cient
ex ante if agents are very patient. We show that this normative result also holds in our continuous-
time environment with preference shocks for lumpy consumption (see our Proposition 6). Moreover,
we generalize the example from Green and Zhou (2005, Section 6) and show that for economies
with low labor endowments the …rst-best level of output is implemented for positive in‡ation rates.
Amongst Bewley models who work with numerical methods, Imrohoroglu (1992) and Dressler
(2011) have studied the welfare cost of in‡ation. Similarly, we provide a calibration of our model
and an estimate for the cost of in‡ation even though our contribution is mainly methodological and
qualitative.
   Our work also contributes to a recent literature developing continuous time methods to analyze
general equilibrium models with incomplete markets. Recently, Achdou, Han, Lasry, Lions, and
Moll (2015) have proposed numerical tools based on mean-…eld-games techniques to study a wide
class of heterogeneous-agent models in continuous time, with Huggett (1993) as their baseline. The
description of the idiosyncratic risk in our model is di¤erent: it involves changes in individual
asset holdings in both ‡ows and lumps so that the steady-state equilibrium value function and
distribution can no longer be characterized by a system of partial di¤erential equations, but instead


   8
       For an example of such a model with lumpy consumption and unbounded h see Rocheteau and Rodriguez (2014).


                                                        6
obey a system of delay di¤erential equations. We develop a methodology tailored to this problem.
Qualitatively, it allows us to establish analytical properties, like smoothness, existence, uniqueness,
and comparative statics. Quantitatively, it translates into an e¢ cient computational method, which
facilitates the calibration of our model to distributional data, provides numerical comparative statics
with respect to key parameters, and allows us to compute optimal in‡ation rates over a wide range
of parameter values.
    Our idiosyncratic lumpy consumption opportunities are similar to the uncertain lumpy expendi-
tures in the Baumol-Tobin model of Alvarez and Lippi (2013). Relative to Baumol-Tobin, our model
has a single asset, …at money, and households are not subject to a cash-in-advance constraint— in
the absence of shocks they would not accumulate money and they would …nance their ‡ow con-
sumption with their labor only. Moreover, we do not take the consumption path (both in terms of
‡ows and jump sizes) as exogenous; neither do we assume that labor income is exogenous.
    Finally, our work is related to the search-theoretic literature. Our assumption of lumpy con-
sumption opportunities corresponds to the assumption of random trading opportunities in the
models of Shi (1995) and Trejos and Wright (1995), where prices are determined through bargain-
ing and money holdings are restricted to f0; 1g. Formulating tractable search-theoretic monetary
models without restrictions on money holdings, and with non-degenerate distributions, has been
considered challenging due to the interaction between bargaining and ex-post heterogeneity. Ex-
amples of such models include Camera and Corbae (1999), Zhu (2005), Molico (2006), and Chiu
and Molico (2010, 2011), all in discrete time. While our preference shocks for lumpy consump-
tion are reminiscent to random matching shocks in search models, we avoid the intricacies due
to bargaining by assuming competitive prices.9 Green and Zhou (1998, 2002), Zhou (1999), and
Menzio, Shi, and Sun (2013) assume price posting and a constant money supply. In Green and
Zhou (1998, 2002) and Zhou (1999) search is undirected and goods are indivisible, which leads to
a continuum of steady states. In contrast, our competitive pricing is non-strategic and the laissez-
faire monetary equilibrium is unique. Menzio, Shi, and Sun (2013) assume directed search which
makes the laissez-faire monetary steady state block-recursive in the sense that policy functions
and value functions are independent of the distribution of real balances. This block-recursivity
property, which holds in our model as well, breaks down under money growth implemented with

   9
     Rocheteau, Weill, and Wong (2015) study a discrete-time version of the model with search and bargaining and
alternating market structures. The model remains tractable and can be used to study transitional dynamics following
one-time money injections.


                                                        7
non-proportional transfers (Menzio, Shi, and Sun, 2013, Section 5). Despite this lack of recursivity,
we are still able to characterize the equilibrium analytically. This tractability allows us to study
the e¤ects of general transfer schemes on output and welfare and check Wallace’s (2014) conjecture
for our economy. Our techniques are also di¤erent. In Menzio-Shi-Sun agents’ problems are not
concave and existence of equilibrium requires the use of monotone comparative statics methods. In
contrast, all individual problems in our model are concave, and we establish general properties of
value and policy functions using viscosity theory of Hamilton-Jacobi-Bellman equations. Finally,
Sun (2012) extends the quasi-linear environment with competitive search of Rocheteau and Wright
(2005) by introducing idiosyncratic shocks on the linear disutility of labor. While the model gener-
ates ex-post heterogeneity, the distribution for real balances conditional on the marginal disutility
of labor is degenerate.


2        The environment

Time, t 2 R+ , is continuous and goes on forever. The economy is populated with a unit measure
of in…nitely-lived households who discount the future at rate r > 0. There is a single perishable
consumption good produced according to a linear technology that transforms h units of labor into
h units of output. Households have a …nite endowment of labor per unit of time, h < 1.
     Households value consumption, c, and leisure ‡ows, `, according to an increasing and concave
instantaneous utility function, u(c; `). We assume that both consumption and leisure are normal
goods, that u(c; `) is bounded above, i.e. supc          0 u(c; h)    kuk < 1, and bounded below so that
we can normalize u(0; 0) = 0. In addition to consuming and producing in ‡ows, households receive
preference shocks that generate lumps of utility for the consumption of discrete quantities of the
good.10 Lumpy consumption opportunities represent large shocks (e.g., replacement of durables,
health events and expenditures due to changes in family composition) that require immediate
spending.11 These shocks occur at Poisson arrival times, fTn g1
                                                              n=1 , with intensity                  . The utility
of consuming y units of goods at time Tn is given by the increasing, concave, and bounded utility


    10
      There are obviously many other sources of idiosyncratic uncertainty in real economies. For instance, one could
also consider idiosyncratic shocks on h in order to capture income/employment shocks. Recall, however, that the
objective here is to introduce a form of idiosyncratic risk that is analogous to the one commonly assumed in the
search-theoretic monetary literature since Shi (1995) and Trejos and Wright (1995) in order to bene…t from some of
the tractability of this framework and make comparisons more straightforward.
   11
      Following Shi (1995) and Trejos and Wright (1995) one could also interpret the preference shocks as random
consumption opportunities in a decentralized goods market with search-and-matching frictions. For such an inter-
pretation, see Rocheteau, Weill, and Wong (2015).


                                                         8
function, U (y), and we normalize U (0) = 0.12 Taken together, the lifetime expected utility of a
household can be written as:
                         "Z                                             1
                                                                                               #
                                     +1                                 X
                                              rt                                  rTn
                            E             e        u ct ; h   ht dt +         e         U (yTn ) ;             (1)
                                 0                                      n=1

given some adapted and left-continuous processes for ct , ht , and yt . We impose the following
additional regularity conditions on households’utility functions. First, U (y) is strictly increasing,
strictly concave, and twice continuously di¤erentiable; it also satis…es the Inada condition U 0 (0) =
+1. Second, u(c; `) can have either one of the following two speci…cations:


   1. Smooth-Inada (SI) preferences: u(c; `) is strictly concave, and twice continuously di¤er-
       entiable, and it satis…es Inada conditions with respect to both arguments, i.e., uc (0; `) = 1
       and uc (1; `) = 0 for all ` > 0, u` (c; 0) = 1 for all c > 0;

   2. Linear preferences: u(c; `) = minfc; cg + `, for some c                           0.


    The …rst speci…cation facilitates the analysis because it implies smooth policy functions for
households and strictly positive consumption and labor ‡ows. The second speci…cation corresponds
to the quasi-linear preferences commonly used in monetary theory since Lagos and Wright (2005)
to eliminate wealth e¤ects and obtain equilibria with degenerate distributions of money balances.13
In our model, distributions are non-degenerate even under quasi-linear preferences, because the
feasibility constraint on labor, h             h, can be binding for some agents in equilibrium. However,
these preferences will facilitate the comparison of our model to the literature— we will obtain the
model with competitive pricing from Rocheteau and Wright (2005) as a limiting case— and they will
also greatly simplify policy functions allowing us to derive closed-form solutions for all equilibrium
objects, including value functions and distributions.
    In order to make money essential we assume that households cannot commit and there is
no monitoring technology (Kocherlakota, 1998). As a result households cannot borrow to …nance
lumpy consumption since otherwise they would default on their debt. The only asset in the economy
is …at money: a perfectly recognizable, durable and intrinsically worthless object. The supply of
  12
      If we think of the shock as the replacement of durables, then U (y) = #(y)=(r + ) is the discounted sum of
the utility ‡ows, #(y), provided by a durable good, where is the Poisson arrival rate at which a particular durable
expires, and y is the quality of the durable.
   13
      Lagos and Wright (2005) assume quasi-linear preferences of the form u(c) + `. See also Scheinkman and Weiss
(1986) for similar preferences. The fully linear speci…cation comes from Lagos and Rocheteau (2005). Wong (2014)
shows in the context of a discrete-time model that the same results are maintained under a more general class of
preferences.


                                                               9
money, denoted Mt , grows at a constant rate,                            0, through lump-sum transfers to households.
(We consider alternative transfer schemes in Section 4.4.) Trades of money and goods take place
in spot competitive markets. The price of money in terms of goods is denoted                       t.


Full-insurance allocations

As a benchmark suppose that households pool together their labor endowments to insure themselves
against the idiosyncratic preference shocks for lumpy consumption. Their maximization problem
is:
                                            Z   +1
                                                         rt
                                max                  e        u ct ; h     ht + U (yt ) dt                        (2)
                               ct ;ht ;yt   0
                                                     s.t. ct + yt = ht ;                                          (3)

subject to ht         h. The paths for consumption and hours are chosen so as to maximize the
household’s ex-ante expected utility, (2), subject to the feasibility constraint, (3). This constraint
speci…es that the aggregate consumption ‡ows across all households, ct , plus the lumpy consumption
of the     households with a preference shock,                     yt , must equal aggregate output, ht . Under SI
preferences the solution to (2)-(3) is (ct ; ht ; yt ) = (cF I ; hF I ; y F I ) for all t, where the full-insurance
allocation solves
                            uc cF I ; h          hF I = u` cF I ; h          hF I = U 0 y F I :                   (4)

Households equalize the marginal utilities of ‡ow consumption, of leisure, and of lumpy consump-
tion, and they pay a constant insurance premium, y F I . Under linear preferences,

                                                hF I = y F I = minf y ? ; hg;                                     (5)

and cF I = 0, where y ? is the quantity that equalizes the marginal utility of lumpy consumption and
the marginal disutility of work, U 0 (y ? ) = 1. If labor endowments are su¢ ciently large, then the
…rst-best allocation is such that households consume y ? whenever they receive a preference shock
and they supply y ? of their labor endowment. If the endowments are small, h < y ? , then y ? is
not feasible, so households supply their whole labor endowment, h, and share the output equally
among the         households with a desire to consume.


3     Stationary monetary equilibrium

In this section we study stationary monetary equilibria featuring a constant rate of return of
money, _t =   t   =    , and a time-invariant distribution of real balances. We start by characterizing

                                                                 10
the consumption-saving problem of a representative household. Next, we study the stationary
distribution of real balances induced by the household’s optimal behavior. We then establish the
existence of a stationary equilibrium. The last subsection describes a particular class of monetary
equilibria for which households’policy functions and stationary distribution are easily characterized.

3.1     The household’s problem

We analyze the household’s problem in a stationary equilibrium in which the in‡ation rate is equal
to the growth rate of the money supply,                       0. Let W (z) denote the maximum attainable lifetime
utility of a household holding z units of real balances (money balances expressed in terms of the
consumption good) at the beginning of time. In a supplementary appendix we provide a Principle
of Optimality for our continuous-time environment and establish that W (z) is a solution to an
almost-standard Bellman equation.14 The Bellman equation for W (z) is:
                                  Z   1
                                               (r+ )t
                    W (z) = sup            e            u ct ; h     ht +     U (yt ) + W (zt   yt )   dt;        (6)
                                  0

with respect to left-continuous plans for fct ; ht ; yt g, a piecewise continuously di¤erentiable plan for
zt , and subject to:

                                                        z0 = z                                                    (7)

                                                        0   yt      zt                                            (8)

                                                        z_t = ht     ct     zt + :                                (9)

The e¤ective discount factor, e            (r+ )t ,   in the household’s objective, (6), is equal to the time discount
factor, e   rt ,   multiplied by the probability that no preference shock occurs during the time interval
[0; t), i.e., Pr (T1     t) = e       t.   It multiplies the household’s expected utility at time t, conditional
on T1       t. The …rst term of the period utility is the utility ‡ow of consumption and leisure,
u ct ; h    ht . The second term is the expected utility associated with a preference shock at time
t, an event occurring with Poisson intensity                       . This expected utility is the sum of U (yt ) from
consuming a lump of yt units of consumption good and the continuation utility W (zt                          yt ) from
keeping zt         yt real balances.

   14
      In our model it is not possible to construct an explicit solution by directly using the Hamilton-Jacobi-Bellman
(HJB). It turns out to be easier to study the Bellman equation of the household’s problem from the current period t
to the next time a preference shock occurs. We can then apply standard dynamic programming techniques to show
the existence and uniqueness of the value function, and viscosity theory techniques to show smoothness. These results
implies the HJB equation in our main theorem below.


                                                                   11
   Equation (7) is the initial condition for real balances, and (8) is a feasibility constraint stating
that real balances must remain positive before and after a preference shock. The fact that yt                    zt
follows from the absence of enforcement and monitoring technologies that prevent households from
issuing debt. Finally, (9) is the law of motion for real balances. The rate of change in real balances
is equal to the household’s output ‡ow net of consumption, ht                 ct , plus the negative ‡ow return
on currency,     z, and a ‡ow lump-sum transfer of real balances,               =     M        0.

Theorem 1 Equation (6) has a unique bounded solution, W (z). It is strictly increasing, strictly
concave and continuously di¤ erentiable over [0; 1). It is twice continuously di¤ erentiable over
(0; 1), except perhaps under linear preference, when this property may fail for at most two points.
Moreover,

                      r+       kuk   kU k
            W 0 (0)                +          ;     lim W 00 (z) =       1; and lim W 0 (z) = 0:
                       h        r     r             z!0                              z!1

Finally, W solves the Hamilton-Jacobi-Bellman (HJB) equation:

    rW (z) = max u(c; h       h) +   [U (y) + W (z        y)    W (z)] + W 0 (z) (h        c        z+   ) ;   (10)

with respect to (c; h; y) and subject to c   0, 0     h        h and 0    y     z.

   The …rst part of Theorem 1 follows from standard dynamic programming arguments according
to which the optimization problem, (6), de…nes a contraction mapping from the set of continuous,
increasing, concave, and bounded functions into itself. The fact that W 0 (1) = 0 follows from
concavity and boundedness. A perhaps surprising result is that W 0 (0) < 1 even though U 0 (0) = 1.
Intuitively, a household with depleted money balances, z = 0, has a …nite marginal utility for real
balances because it has some positive time to accumulate real balances before the next opportunity
for lumpy consumption, E [T1 ] = 1= > 0.
   The main technical challenge in Theorem 1 is to establish that W is su¢ ciently smooth, i.e., that
it admits continuous derivatives of su¢ ciently high order. Under SI preferences, twice continuous
di¤erentiability of W ensures the continuous di¤erentiability of the saving rate, and implies that
the ODE (9) has a unique solution. Having well-behaved policy functions also allows to apply
standard theorems in order to establish the existence of a unique stationary distribution of real
balances, and to show that the mean of the distribution, M , is continuous in                        =    M , which
facilitates the proof of existence of an equilibrium. We establish these smoothness properties by
adapting arguments from the theory of viscosity solutions (see, e.g., Bardi and Capuzzo-Dolcetta,

                                                     12
1997) in order to obtain a version of HJB that does not require continuous di¤erentiability. Based
on this weaker HJB equation, we can show that W must, in fact, be continuously di¤erentiable.
    The HJB equation, (10), has a standard interpretation as an asset-pricing condition. If we think
of W (z) as the price of an asset, the opportunity cost of holding that asset is rW (z). The asset
yields a utility ‡ow, u(c; `), and a capital gain, U (y) + W (z       y)   W (z), in the event of a preference
shock with Poisson arrival rate      . Finally, the value of the asset changes over time due to the
accumulation of real balances, represented by the last term on the right side of (10), W 0 (zt )z_t .


Optimal lumpy consumption.             From (10) a household chooses its optimal lumpy consumption
in order to solve:
                                   V (z) = max fU (y) + W (z           y)g :                              (11)
                                           0 y z

In words, a household chooses its level of consumption in order to maximize the sum of its current
utility, U (y), and its continuation utility with z        y real balances, W (z     y). Because U 0 (0) = 1
but W 0 (0) < 1, a household always …nds it optimal to choose strictly positive lumpy consumption,
y(z) > 0, for all z > 0. Hence, the …rst-order condition of (11) is

                                           U 0 (y)    W 0 (z    y);                                       (12)

with an equality if y < z. The following proposition provides a detailed characterization of the
solution to (12).

Proposition 1 (Optimal Lumpy Consumption) The unique solution to (12), y(z), admits the
following properties:

   1. y(z) is continuous and strictly positive for any z > 0.

   2. Both y(z) and z     y(z) are increasing and satisfy limz!1 y(z) = limz!1 z              y(z) = 1.

   3. y(z) = z if and only if z     z1 , where z1 > 0 solves U 0 (z1 ) = W 0 (0).

    Finally, V (z), is strictly increasing, strictly concave, and continuously di¤ erentiable with V 0 (z) =
U 0 [y(z)].

    The properties of the solution, y(z), follow directly from (12). The left side of (12) is decreasing
in y from U 0 (0) = 1 to U 0 (1) = 0 while the right side of (12) is increasing in y. Hence, y(z) is a
unique solution to (12). An increase in z reduces the marginal utility of real balances, W 0 (z            y),

                                                      13
leading the household to raise both its lumpy consumption, y(z), and its post-trade real balances
(after lumpy consumption), z        y(z). When real balances go to in…nity, z ! 1, y(z) must also go
to in…nity since otherwise W 0 (z    y) would go to zero and U 0 (y) would remain bounded away from
zero, thereby violating (12). A similar argument applies to the post-trade real balances, z               y(z).
    Finally, Proposition 1 shows that, as long as real balances are below some threshold z1 , the
household …nds it optimal to deplete its real balances in full upon receiving a preference shock.
This follows because the utility derived from spending a small amount of real balances, U 0 (0) = 1,
is larger than the bene…t from holding onto it, W 0 (0) < 1. This result— the fact that liquidity
constraints bind over a nonempty interval of the support of the wealth distribution— is in contrast
with the standard incomplete-market model in continuous time where liquidity constraints never
bind in the interior of the state space (Achdou, Han, Lasry, Lions, and Moll, 2015), and it will play
a key role for the tractability of our model.
    By induction we can construct a sequence of thresholds for real balances, fzn g+1
                                                                                   n=1 , such that:


                           z 2 [0; z1 ) =) z     y(z) = 0

                           z 2 [zn ; zn+1 ) =) z     y(z) 2 [zn   1 ; zn ) ,   8n   1:

If a household’s real balances belong to the interval [zn ; zn+1 ), the post-trade real balances of the
household following a preference shock, z       y(z), belong to the adjacent interval, [zn   1 ; zn ).   Hence,
the household is insured against n consecutive preference shocks, i.e., it would take n shocks to
deplete the real balances of the household. The properties of lumpy consumption, y(z), and post-
trade real balances, z       y(z), are illustrated in Figure 1. Finally, the properties of V (z) follow
directly from the concavity of the problem and an application of the envelope theorem.


Optimal saving.          Next, we characterize a household’s optimal saving behavior. We …rst de…ne
the saving rate correspondence:

                             s(z)       h   c      z+    : (h; c) solves (10) :                            (13)

Proposition 2 (Optimal Saving Rate) The saving-rate correspondence, s(z), is upper hemi-
continuous, convex-valued, decreasing, strictly positive near z = 0, and admits a unique z ? 2 (0; 1)
such that 0 2 s(z ? ).

   1. SI preferences. The saving-rate correspondence is singled-valued, strictly decreasing, and
      continuously di¤ erentiable over (0; 1).

                                                    14
             y(z)                                           z − y(z)




                 45o                                             45
                                                                    o




                                   z1                                   z1                  z2
                  Full depletion        Partial depletion


         Figure 1: Left panel: Lumpy consumption. Right panel: Post-trade real balances.



   2. Linear preferences. The saving rate is equal to:
                            8                                                                8
                            <        h     z+                                                < >
                     s(z) =   [ c    z + ;h        z+                        ]    if W 0 (z)   = 1:             (14)
                            :                                                                :
                                      c     z+                                                 <

    The …rst part of Proposition 2 highlights three general properties of households’saving behavior.
The …rst states that households save less when they hold larger real balances. This follows because
‡ow consumption and leisure are normal goods, hence h                            c decreases with z, and because the
in‡ation tax, z, increases with z. The second property of s(z) is that it is strictly positive near
zero. This result follows from Theorem 1 according to which W 0 (0) < 1. The only way the
marginal utility of wealth can remain bounded near z = 0 is if a household with depleted money
balances saves enough to keep its real balances bounded away from zero at its next preference
shock. The third property is that households have a target, z ? , for their real balances. For all
z < z ? , the saving rate is strictly positive and …nite whereas at z = z ? the saving rate is zero. We
prove that z ? < 1 by showing that s(z) is negative for a large enough z.15
    The second part of Proposition 2 provides a tighter characterization of s(z) under our two
preference speci…cations. Under SI preferences, the HJB equation, (10), de…nes a strictly concave
optimization problem leading to a smooth and strictly decreasing saving rate. Indeed, the …rst-order



  15
     When in‡ation is strictly positive, > 0, s(z) < 0 follows from the observation that h < 1 cannot o¤set the
in‡ation tax,    z, when z is large. When = = 0, the result comes from Theorem 1 according to which W 0 (z)
goes to zero as z becomes large. Indeed from (10) the household’s labor supply becomes zero, implying a negative
saving rate.


                                                               15
conditions for consumption and leisure are

                                         uc (c; `) = u` (c; `) = W 0 (z):                                    (15)

Given that ‡ow consumption and leisure are assumed to be normal goods, it follows that c and `
increase with z and so decrease with the marginal value of real balances. Under linear preferences
(10) de…nes a linear optimization problem delivering a bang-bang solution for the saving rate.
Households work maximally, h = h, and consume nothing, c = 0, when real balances are low
enough and W 0 (z) > 1. They stop working, h = 0, while consuming maximally, c = c, when real
balances are large enough and W 0 (z) < 1.
    Next, we study the time path of a household’s real balances conditional on not receiving a
preference shock, namely, the solution to the initial value problem

                                            z_t = s (zt ) with z0 = 0:                                       (16)

Under linear preferences this problem is well de…ned (s(z) is single-valued) for all z except when
W 0 (z) = 1, in which case there are multiple optimal saving rates. For such real balances we pick
the saving rate that is closest to zero. As a result, if z ? is such that W 0 (z ? ) = 1, this ensures that
real balances remain constant and equal to their stationary point.16 Given the unique solution to
(16), we can de…ne the time to reach z from z0 = 0:

                                    T (z)     inff t   0 : zt    zj z0 = 0g:                                 (17)


Proposition 3 (Optimal Path of Real Balances) The initial value problem (16) has a unique
solution. This solution is strictly increasing for all t 2 [0; T (z ? )), where zT (z ? ) = z ? , and it is
constant and equal to z ? for all t          T (z ? ). Under SI preferences, T (z ? ) = 1. Under linear
preferences, T (z ? ) < 1 if and only if 0 2 ( c          z? + ; h          z? +   ).


    Proposition 3 shows that a household accumulates real money balances until it reaches its target
z ? . Under SI preferences s(z) is continuously di¤erentiable to the left of z ? , which implies by a
standard approximation argument that real balances only reach their target asymptotically at an
exponential speed dictated by js0 (z ? )j. Under linear preferences the saving rate may fail to be
continuously di¤erentiable at z ? and, as a result, the target may be reached in …nite time. For
  16
    Under SI preferences a technical di¢ culty arises because s(z) is not continuously di¤erentiable at z = 0, and
hence the standard existence and uniqueness theorems for ODEs do not apply. One can nevertheless construct the
unique solution of (16) by starting the ODE at some z > 0 and "run it backward" until it reaches zero.


                                                       16
instance, in the laissez-faire economy where                    =          = 0, the saving rate jumps downward at the
target z ? , i.e., s(z) = h > 0 for all z < z ? , while s(z ? ) = 0. Clearly, this implies that the target
is reached in …nite time T (z ? ) = z ? =h < +1. In Figure 2 we illustrate the path for real balances
and the spending behavior of a household subject to random preference shocks.

                             zt

                            «




                                                                      )
                                                                    zt
                                                               s(
                                          y ( zT1 )




                                               T1         T2                         T3

                                      Figure 2: Optimal path of real balances



3.2    The stationary distribution of real balances

We now show that the household’s policy functions, y(z) and s(z), induce a unique stationary
distribution of real balances over the support [0; z ? ]. To this end, we de…ne the minimal time that
it takes for a household with z real balances at the time of a preference shock to accumulate strictly
more than z 0 real balances following that shock:

                                      (z; z 0 )               0
                                                      max T (z+ )           T [z   y(z)] ; 0 ;                             (18)

for z; z 0 2 [0; z ? ]. Notice that      (z; z ? ) = 1 since the household never accumulates more than the
target. Let F (z) denote the cumulative distribution function of a candidate stationary equilibrium.
It must solve the …xed-point equation:
                          Z 1       Z 1                                                  Z    1
                                                                                                      (z;z 0 )
             1 F (z 0 ) =      e u      Ifu                    (z;z 0 )g   dF (z) du =            e              dF (z);   (19)
                                  0                   0                                   0

where the second equality is obtained by changing the order of integration.17 The right side of (19)
calculates the measure of households with real balances strictly greater than z 0 . First, it partitions
  17
    The sequence of preference shocks, fTn g, provides a natural discrete-time formulation for both the Bellman
equation and the stochastic process for individual real balances. This allows us to apply standard results for the


                                                                17
the population into cohorts indexed by the date of their last preference shock. There is a density
measure,     e   u,   of households who had their last preference shocks u periods ago. Second, in
each cohort there is a fraction dF (z) of households who held z real balances immediately before
the shock. Those households consumed y(z), which left them with z                         y(z) real balances. If
u       (z; z 0 ), then su¢ cient time has elapsed since the preference shock for their current holdings
to be strictly greater than z 0 .
     The …xed-point problem in (19) can be reduced to …nding a stationary distribution of the
discrete-time Markov process with transition probability function:

                                                                     (z;z 0 )
                                         Q(z; [0; z 0 ])    1   e               :                               (20)

The function Q is the transition probability of the discrete-time Markov process that samples the
real balances of a given household at the arrival times fTn g1
                                                             n=1 of its preference shocks. It is

monotone in the sense of …rst-order stochastic dominance, i.e., a household who had higher real
balances at its last preference shock tends to have higher current real balances. One can also show
that Q satis…es the Feller property, as well as an appropriate mixing condition allowing us to apply
Theorem 12.12 and 12.13 in Stokey, Lucas, and Prescott (1989). We obtain:


Proposition 4 (Stationary Distribution of Real Balances) The …xed point problem, (19),
admits a unique solution, F (z). This solution is continuous in the lump-sum transfer parameter,
    , in the sense of weak-convergence.


     In addition to obtaining existence and uniqueness of a stationary distribution, Proposition
4 shows that F is continuous in            because all policy functions are appropriately continuous in
that parameter. This continuity property is helpful to establish the existence of a steady-state
equilibrium as it ensures that the market-clearing condition is continuous in the price of money, .
     It should be noticed that there is an alternative representation of the functional equation that
determines F (z). This second representation— a Kolmogorov forward equation (KFE)— will be
useful for numerical work. De…ne ' (z) as the real balances that a household must hold at the
time of a preference shock in order to have exactly z real balances following the payment for lumpy
consumption. It is the solution to '          y (') = z if z > 0 and ' (0) = z1 . From Proposition 1 the
existence and uniqueness of stationary distributions of discrete-time Markov processes. Moreover, we will see that
the distribution of real balances is easily characterized with T (z) in the case of equilibria with full depletion of
real balances (z ? < z1 ). Alternatively, we could work with Kolmogorov forward equations as described in our
supplementary numerical appendix.


                                                           18
solution to this equation exists and is unique since '               y (') is strictly increasing in ' > z1 , it
is equal to 0 when ' = 0, and lim'!1 '            y(') = 1. In a steady state, the ‡ow of agents who
become richer than z over an in…nitesimal time interval must be equal to the ‡ow of agents whose
real balances fall below z over that same time interval. Formally, this balanced-‡ow condition can
be written as:
                                  s (z) f (z) =       fF [' (z)]      F (z)g ;                             (21)

where f (z) denotes the density function associated with F (z). According to the left side of (21),
over a small time interval of length dt, there is a measure F (z            zdt)
                                                                            _    F (z) = f (z)zdt
                                                                                              _ of households
whose real balances increase above z. According to the right side of (21) there is a measure                 dt
of households who receive a preference shock, and among them there is a fraction F [' (z)]                F (z)
who were richer than z before the shock but are poorer after it.

3.3   The real value of money

By de…nition aggregate real balances solve:
                                           Z          1
                                     M=                   zdF (z j   M );                                  (22)
                                                  0

where the right side makes explicit that the stationary distribution depends on the lump-sum
transfer,   =     M , since the household’s path for real balances, zt , depends on               . From (22)
money is neutral as aggregate real balances are determined independently of M . As is standard,
however, a change in the money growth rate will have real e¤ects by a¤ecting the rate of return on
household savings. We are now in a position to de…ne an equilibrium.

De…nition 1 A stationary monetary equilibrium is composed of a value function, W (z), a distri-
bution of real balances, F (z), and a price,      > 0, solving (6), (19), and (22).

   In order to establish the existence of an equilibrium we study (22) at its boundaries. As M
approaches zero, the left side of (22) goes to zero, but the right side remains strictly positive.
Indeed, from Proposition 2 households accumulate strictly positive real balances even when they
receive no lump-sum transfer,      = 0. As        M tends to in…nity, the lump sum transfer becomes
so large that households only consume and stop working, which contradicts market clearing in the
goods market. Equivalently, in the money market, the left side of (22) becomes larger than the
right side. Finally, Proposition 4 established that the stationary distribution, F , is continuous in
  =     M . Hence, we can apply the intermediate value theorem and obtain:

                                                          19
Proposition 5 (Existence and Uniqueness) For all                  0 there exists a stationary monetary
equilibrium. Moreover, the laissez-faire equilibrium,     =    = 0, is unique.

   From Proposition 5 a monetary equilibrium exists for all in‡ation rates. Indeed, we show in
Proposition 2 that, as a result of the Inada condition on U (y), the saving rate, s(z), is always strictly
positive near z = 0. In the laissez-faire where      =     = 0 the equilibrium has a simple recursive
structure allowing uniqueness to be proved. From Theorem 1 the value and policy functions are
uniquely determined independently of F . From Proposition 4, F is uniquely determined given the
policy functions.
   We now establish that the laissez-faire monetary equilibrium,          = 0, is nearly e¢ cient when
households are patient. We adapt Green and Zhou’s (2005) de…nition of near e¢ ciency as follows.
An equilibrium allocation is said to be -e¢ cient, for     2 (0; 1], if it is weakly preferred ex-ante by
households to the full risk-sharing allocation of the environment in which the labor endowment, h,
is shrunken by a factor .

Proposition 6 (Near-E¢ ciency of the Laissez-Faire Monetary Equilibrium) For all                        2
(0; 1) there is a r > 0 such that for all r < r the laissez-faire monetary equilibrium is -e¢ cient.

   Proposition 6 is analogous to Proposition 2 in Green and Zhou (2005) and Theorem A in
Levine and Zame (2002). It states that patient households are as well o¤ or better o¤ in the laissez-
faire monetary equilibrium compared to the full-insurance allocation with a slightly scaled-down
labor endowment, h. The logic of the proof goes as follows. Suppose that households adopt the
following strategy. They consume a ‡ow consumption cF I , they supply a ‡ow labor h < hF I , and
they consume y(z) = y F I whenever z        y F I and y(z) = 0 otherwise. Households mimic the full-
insurance consumption behavior whenever it is possible given their real balances, and they supply
a ‡ow of labor no greater than the …rst-best level. Interestingly, this strategy is almost identical to
the inventory accumulation strategy in Diamond and Yellin (1985). One can show that on average
households spend a fraction (h       cF I )= y F I of their time with z    y F I . As h approaches hF I ,
households’real balances are almost always larger than y F I . Hence, provided that households are
very patient, the average household’s utility approaches the full-insurance one.

3.4   Equilibria with full depletion of real balances

In this section we study the class of equilibria with full depletion, in which households …nd it
optimal to spend all their money holdings whenever a preference shock occurs, i.e., y(z) = z for all

                                                   20
z 2 [0; z ? ]. In this case our model is very tractable and it lends itself to a tight characterization
of decision rules and distributions. We also show that full depletion occurs under appropriate
parameter restrictions.


The optimal path for real balances under full depletion. The ODE for the optimal path
of real balances, (9), can be rewritten as:

                                              z_t = h( t )         c( t )           zt + ;                                 (23)

where      t    W 0 (zt ) is the marginal value of real balances, while h( t ) and c( t ) are the solutions to

                                      max           u(c; h     h) + (h              c         z+      ) :                  (24)
                                    c 0;h h

To solve for       t   we apply the envelope condition to di¤erentiate the HJB (10) with respect to z
along the optimal path of money holdings. This leads to the ODE:

                                         r      t   =      U 0 (zt )        t            t   + _ t;                        (25)

where we use V 0 (zt ) = U 0 [y(zt )] = U 0 (zt ) from Proposition 1. According to the …rst term on the
right side of (25), a household enjoys a surplus U 0 (zt )                          t   from spending its marginal real balances
in the event of a preference shock with arrival rate . The second term corresponds to the in‡ation
tax that erodes the value of money at rate                       , and the third term is the change in the marginal
value of real balances as the household accumulates more money over time.
    The pair, (zt ;      t ),   solves a system of two ODEs, (23) and (25).18 The system is represented
in a phase diagram (Figure 3, below). We can show that the stationary point of this system is a
saddle point and the optimal solution to the household’s problem is the associated saddle path. In
the laissez-faire economy with              =           = 0, the z-isocline is horizontal and the dynamic system is
independent of the distribution of real balances.


The stationary distribution of real balances under full depletion. Under full depletion,
y(z) = z, the time it takes for a household to accumulate z 0 real balances following a preference
shock is       (z; z 0 ) = T (z+
                               0 ). Hence, from (20), the transition probability function,


                                                                                        0 )
                                                Q(z; [0; z 0 ]) = 1             e   T (z+
                                                                                              ;                            (26)
   18
     A similar system of ODEs holds under partial depletion, where U 0 (zt ) is replaced by U 0 [y(zt )]. Hence, in order
to solve for this system, one also needs to solve for the unknown function y(z). In Appendix B, we provide a numerical
solution to this problem.


                                                                       21
                                                                                           z&   0



                                            >
                                                >
                                                     >
                                      «
                                                                       >
                                                                              >
                                                                                  >

                                                                                                0

                                                                 «



           Figure 3: Phase diagram of an equilibrium with full depletion of real balances



does not depend on z. In words, the probability that a household holds less than z 0 is independent
of its real balances just before its last lumpy consumption opportunity, z. This result is intuitive
since households "re-start from zero" after a lumpy consumption opportunity. It follows that the
stationary probabilities coincide with the transition probabilities, i.e.,

                                                F (z 0 ) = Q z; [0; z 0 ] :                                                          (27)

Finally, the equilibrium equation for the price level, (22), simpli…es as well:
                      Z    1                     Z      1                                           Z   z?
                                                                                                                 T (z j   M)
               M=              zdF (z j   M) =              [1       F (z j       M )] dz =                  e                 dz;   (28)
                       0                            0                                               0

where our notation highlights that the time to accumulate real balances, T , is a function of the
real money transfer,           =     M.


Verifying full depletion. From the …rst-order condition, (12), households …nd it optimal to
deplete their money holdings in full when a lumpy consumption opportunity occurs; y(z) = z for
all z 2 [0; z ? ], if and only if
                                                U 0 (z ? )       W 0 (0) =            0.                                             (29)

According to (29) the marginal utility of consumption when y(z ? ) = z ? must be greater than
the marginal value of money at z = 0. In order to verify this condition one must solve for the
equilibrium price,        , and the associated real transfer,                          =        M . We turn to this task in the
following proposition.


                                                                 22
Proposition 7 (Su¢ cient Conditions for Full Depletion) Under either SI or linear prefer-
ences, there exists a threshold for the in‡ation rate,    F,   such that, for all     F,   all stationary
monetary equilibria feature full depletion.
    Under linear preferences, there exists a threshold for the labor endowment, hF , such that, for all
h     hF , there exists a unique stationary monetary equilibrium, and this equilibrium must feature
full depletion.


    Proposition 7 identi…es two conditions on exogenous parameters ensuring full depletion. If
in‡ation is large enough, then money holdings become "hot potatoes": they depreciate quickly so
that households always …nd it optimal to spend all their money when given the opportunity. Under
linear preferences, if the labor endowment is large enough, then households spend all of their money
holdings when a preference shock hits because they anticipate that they can rebuild their money
inventories quickly.


4     The quasi-linear economy

In this section we provide a detailed characterization of the model under linear preferences. We
describe …rst the laissez-faire equilibrium (    = 0) and we show that the model can be solved in
closed form for a broad set of parameter values. When labor endowments grow very large, h ! 1,
it converges to the LRW equilibrium with linear value functions and a degenerate distribution
of money holdings. Next, we study the e¤ects of in‡ationary transfer schemes on output and
welfare and show how they depend on h that parametrizes the policy trade-o¤ between promoting
self-insurance and providing risk-sharing. We pursue our investigation with a calibrated example,
targeting the distribution of the balances of transaction accounts in the 2013 Survey of Consumer
Finance (SCF).

4.1    Laissez-faire

We focus on equilibria with full depletion of real balances. From (24) households choose z_ = h        h
to maximize z_ (       1) where   solves the envelope condition (25). The solution is such that zt = ht
for all t   T (z ? ) = z ? =h, where t is the length of time since the last preference shock, and z ?
is the stationary solution to (25). The marginal value of money at the target is           = 1 because
a household who keeps its real balances constant must be indi¤erent between not working and
working at a disutility cost of one in order to accumulate one unit of real balances worth . From


                                                   23
(25):
                                                                               r
                                                         U 0 (z ? ) = 1 +          :                                                   (30)

The marginal utility of lumpy consumption is equal to the marginal disutility of labor augmented
by a wedge, r= , due to discounting. If households are more impatient, or if preference shocks are
less frequent, households reduce their targeted real balances.
    From (26)-(27) the steady-state distribution of real balances is a truncated exponential distri-
bution,
                                                               z
                                   F (z) = 1             e    h    Ifz<z ? g for all z 2 R+ :                                          (31)

Note that it has a mass point at the targeted real balances, 1 F (z ? ) = e                                   z ? =h ,   which is increasing
with h. From market clearing, (28), aggregate real balances are:

                                                               h               z?
                                                    M=               1     e   h       :                                               (32)

Aggregate real balances are smaller than the target,                           M < z ? , and they are increasing with the
household’s labor endowment. They do not depend on the nominal stock of money— money is
neutral in the long-run.19
    We now check the condition for full depletion of money balances, (29). Integrating (25) over
[t; T (z ? )] and using the change of variable z = ht, we obtain a closed-form expression for                                          as a
function of z,
                                              Z     z?      r+                 U 0 (x)         U 0 (z ? )
                             (z) = 1 +                   e ( h )(x        z)
                                                                                                            dx:                        (33)
                                                z                                          h
The marginal value of real balances is equal to the marginal disutility of labor, one, plus a discounted
sum of the di¤erences between the marginal utility of lumpy consumption on the path going from z
                                                                                                0
to z ? , U 0 (zt ), and at the target, U 0 (z ? ). It is easy to check that                         (z) < 0, i.e., the value function is
strictly concave, and as z approaches z ? the marginal value of real balances approaches one. From
(33) the condition for full depletion, (29), can be expressed as
                                       Z    T (z ? )
                               r                             (r+ )
                                                       e                 U 0 [z( )]        U 0 (z ? ) d :                              (34)
                                        0

The right side of (34) is monotone decreasing in h (since T (z ? ) = z ? =h) and it approaches 0 as h
tends to +1. So, we extend Proposition 7 by showing that the equilibrium features full depletion
if and only if h is above some threshold, h0F . Alternatively, (34) holds if households are su¢ ciently

  19
     In Rocheteau, Weill, and Wong (2015) we show in a discrete-time version of our model that one-time money
injections are not neutral in the short run.


                                                                     24
impatient because the cost of holding money outweighs the insurance bene…ts from hoarding real
balances. Finally, from (33) we are able to compute the value function in closed form:
                                                         Z    z?   h                                 i
                                                                                   (r+ )(u z)
                                    ?       ?
         W (z) = z + W (z )             z                              1       e       h                 U 0 (u)   U 0 (z ? ) du 8z < z ? (35)
                                                r+        z
                   (                                 Z                                                                       )
                                                           z?      h               (r+ )u
                                                                                            i
       W (z ? ) =           U (z ? )    z?                             1       e      h          U 0 (u)      U 0 (z ? ) du :                (36)
                       r                        r+        0

The …rst term on the right side of (35) is linear in wealth, which is reminiscent of the linear value
function in LRW. However, the last term is strictly concave: it measures the distance between the
marginal utility of consumption, U 0 (y), and its target, U 0 (z ? ) = 1, as households accumulate real
balances slowly through time.
   The following proposition establishes that as h tends to in…nity the equilibrium approaches an
equilibrium with degenerate distribution and linear value function, analogous to the one in LRW.20

Proposition 8 (Convergence to LRW) As h ! 1 the measure of households holding z ? tends
to one, the value of money approaches z ? =M , and W (z) converges to z                                            z? +    [U (z ? )   z ? ] =r.

   Not too surprisingly, when h = +1 households can replenish their real balances instantly
following a trade. As a result, the equilibrium features a degenerate distribution of money holding,
as in LRW. In a continuous-time environment, however, degeneracy of the distribution of wealth
only holds at the limit. Provided that labor endowments are …nite, h < +1, irrespective of how
large they are, the equilibrium will always feature some ex-post heterogeneity.

4.2      Output and welfare e¤ects of in‡ation

We now investigate the e¤ects of anticipated in‡ation implemented with lump-sum transfers on
output and welfare. We focus …rst on equilibria with full depletion, y(z ? ) = z ? . (In the next
subsection we numerically explore equilibria with partial depletion with a calibrated version of
our model). In the presence of money growth,                                   > 0, the target for real balances can take two
expressions depending on whether the feasibility constraint, h(z ? )                                          h, is slack or binding:

                                                     z?         min fzs ; zb g ;                                                             (37)

where
                                                1        r+                                              h
                               zs       U0          1+                     ;       and          zb           + M:                            (38)

  20
       The proof follows directly from (31), (32), and (35), and it is therefore omitted.


                                                                       25
The quantity zs is the target level of real balances in a slack-labor regime, h(z ? ) < h, that solves
(25) when    = 1 and _ = 0. It equalizes the marginal utility of lumpy consumption, U 0 (z), and the
cost of holding real balances, 1 + (r + )= , thereby generalizing (30) by replacing r with r + .
The quantity zs can be interpreted as the ideal target that households aim for, and is feasible to
reach only if h +           zs . The quantity zb de…ned by (38) is the target level of real balances in a
binding-labor regime, h(z ? ) = h. It is the highest level of real balances feasible to accumulate, given
households’ …nite labor endowment, h, the in‡ation tax on real balances,                             z, and the lump-sum
transfer,    =       M . In other words, it is the stationary solution to (23) with h( )                        c( ) = h.
Thus zb is a constrained target. From (37) the e¤ ective target, z ? , is the minimum between these
two quantities.
   From (23) the trajectory for individual real balances is zt = zb (1                    e   t ),   and the time to reach
real balances z is T (z j     M) =         log (1   z=zb ) = . Given that the time since the last preference
shock is exponentially distributed, the distribution of real balances is

                                                    zb        z
                                   F (z) = 1                          for all z < z ? ;                               (39)
                                                         zb

and F (z) = 1 for all z      z ? . If zb   zs then households reach z ? = minfzb ; zs g only asymptotically,
and the distribution of real balances has no mass point. In contrast, if zb > zs then households
reach z ? in …nite time and the distribution has a mass point at z = z ? . Substituting the closed-form
expressions for T (z j      M ) and zb into the market-clearing condition (28), we …nd after a few lines
of algebra that aggregate real balances solve:
                                        (                                                     +      )
                       M                                                     zs
                               =          1    1                   min 1;                                :            (40)
                   h= + M          +                                      h= + M

Clearly, the left side is strictly increasing in              and the right side is decreasing in . Hence, (40)
has a unique solution, and there is a unique candidate equilibrium with full depletion. Suppose
…rst that z ? = zb     zs . In this regime all households supply h. The solution to (40) is M = h= .
So both aggregate output, H = h, and aggregate real balances are independent of the in‡ation
rate. Substituting M = h=            into (38), we can express the condition zb                      zs as h= + h=     zs .
The second regime is such that z ? = zs                  zb , in which case (40) has another unique solution,
 M 2 (0; h= ]. Finally, the condition for full depletion of money balances is given by (34) where r
is replaced with r +      and T (z j       M) =     log (1         z=zb ) = .




                                                              26
    We now de…ne aggregate output and households’ex-ante welfare by:
                                           Z
                            H( ; h)            h(z; ; h)dF (z; ; h)
                                           Z
                            W( ; h)              h(z; ; h) + U (z) dF (z; ; h):

The pointwise limits for those quantities when individual labor endowments go to in…nity are
denoted by H1 ( )         limh!1 H( ; h) and W 1 ( )        limh!1 W( ; h). The following proposition
shows that the e¤ects of money growth on H and W are qualitatively di¤erent depending on the
size of h.

Proposition 9 (Output and welfare e¤ ects of in‡ation) In the quasi-linear economy:

   1. Large labor endowment. Both H1 ( ) and W 1 ( ) are decreasing with .

   2. Small labor endowment. If U (z)= [zU 0 (z)] is bounded above near zero, then there exists
       some minimum in‡ation rate,          , and a continuous function H : [ ; 1) ! R+ with limits
       lim    !0 H(   ) = lim   !1 H(   ) = 0, such that, for all          and h 2 0; H( ) , there exists
       an equilibrium with binding labor and full depletion. In this equilibrium H( ; h) attains its
       …rst-best level, h, and W( ; h) increases with .

   3. Large in‡ation. As          ! 1, H( ; h) ! 0 and W( ; h) ! 0.

    The size of the labor endowment, h, determines the speed at which households can reach their
targeted real balances, and the extent of ex-post heterogeneity across households that prevails in
equilibrium. As a result, h proves to be a key parameter to determine the extent to which lump-sum
transfers of money provide risk-sharing and deter self-insurance and, ultimately, how they a¤ect
households’ex-ante welfare.
    With large labor endowments, h ! 1, there is no role for risk-sharing as all households reach
their target almost instantly. However, money growth implemented with lump-sum transfers re-
duces the rate of return of money, which adversely a¤ects the incentives to self insure, as measured
by z ? . Hence, aggregate output, which is approximately            z ? , and social welfare, approximately,
  [U (z ? )   z ? ], are decreasing with the in‡ation rate. These are the standard comparative statics
in models with degenerate distributions (e.g., Lagos and Wright, 2005).
    With small labor endowments, risk-sharing considerations dominate because even though
reduces z ? it takes a long time for households to reach their target. Indeed, in the laissez-faire

                                                      27
equilibrium the time that it takes, in the absence of any shock, to reach the target, T (z ? ) = z ? =h,
can be arbitrarily large when h is small. Consider the regime where the equilibrium features both
full depletion, y(z ? ) = z ? , and binding labor, h(z ? ) = h. From Part 2 of Proposition 9 this regime
occurs when the in‡ation rate is not too low and the labor endowment not too high. Because
households cannot reach their ideal target, zs , they all supply h irrespective of their wealth, and
thus aggregate output is constant and equal to h. This output level is also the full-insurance
one, hF I = h. Indeed, the condition for the binding labor constraint is h= + h=                     zs < y ? ,
which implies h <     y ? , and from (5) hF I = h. In addition, aggregate real balances are equal to
the …rst-best level of consumption,       M = h= . Hence, risk-sharing is the only consideration for
policy as the only source of ine¢ ciency arises from the non-degenerate distribution of real balances.
Wealthy households who hold more real balances than the socially desirable level of consumption,
z > h= , pay a tax equal to (z       h= ) while poor households who hold fewer real balances than
the socially-desirable level of consumption, z < h= , receive a subsidy equal to (h=                z). Hence,
moderate in‡ation moves individual consumption levels toward the …rst best, thereby smoothing
consumption across households and raising their ex-ante welfare.
   Even though an equilibrium can attain the …rst-best level of output for intermediate in‡ation
rates when h is su¢ ciently small, it fails to implement the …rst-best allocation because there is ex-
post heterogeneity in terms of lumpy consumption across risk-averse households. Suppose, instead,
that the utility for lumpy consumption is linear with a satiation point, U (y) = A minfy; yg. In this
case, we can construct an equilibrium in which positive in‡ation leads households to work full time,
h = h, households’lumpy consumption levels are smaller than y, and marginal utilities of lumpy
consumption are equalized. Just as in Green and Zhou (2005, Section 6), this economy implements
the …rst best for positive in‡ation rates. To see this, we assume that h < y, which implies that
…rst-best allocations are such that all households supply h = h. Assuming that z ?                 y, the ODE
for the marginal value of real balances, (25), becomes

                            (r + )   t    = (A      t)   + _ t ; 8t 2 [0; T (z ? )] ;                     (41)

with _ T (z ? ) = 0. With Poisson arrival rate,     , the household spends all its real balances, which
generates a marginal surplus equal to A         . The solution is           =E e   (r+ )T1 A   = A=(r + + ),
                                                                        t

for all t 2 R+ . Moreover, A >        0   =    A=(r +       + ) holds so that full depletion is optimal.
The equilibrium features full employment, h = h, if the target for real balances is z ? = zb =
h(1= + 1= )      zs , where zs   y if A       1 + (r + )= . This leads to the following proposition.

                                                     28
Proposition 10 (Implementation of the …rst best) Assume U (y) = A minfy; yg. Su¢ cient
conditions for a monetary equilibrium to implement a …rst best are:

                                                 h
                                                                 (A   1)    r:                                      (42)
                                             y       h

     Provided that the rate of time preference is not too large and labor endowment is su¢ ciently
low, there is a range of in‡ation rates that implement a …rst-best allocation. The in‡ation rate
cannot be too low since otherwise some households …nd it optimal not to work. For instance, if
    = 0 households reach their target in a …nite amount of time, and hence a fraction of them do not
supply any labor. The in‡ation rate cannot too high or households will not …nd it optimal to self
insure by accumulating real balances.

4.3      Calibrated example

In the following we pursue our investigation with a calibrated example. In general, equilibria may
feature partial depletion of real balances, in which case they cannot be solved analytically. There-
fore, we resort to numerical methods to solve the system of delay di¤erential equations composed
of HJB and KFE, (10) and (21), respectively. (See Appendix B for details.) We normalize a unit of
time to a year and we set r = 4%. The in‡ation rate is                = 2%. We adopt a CRRA speci…cation for
the utility of lumpy consumption: U (y) = y 1            a =(1    a) over the relevant range y 2 [0; 1]. Provided
that h          the …rst-best level of lumpy consumption is 1. The remaining parameters, a, , and h,
are calibrated to the distribution of the balances of transaction accounts in the 2013 SCF.21
     We adopt the following three targets: the ratio of the balances of the 80th-percentile household
to the average balances, F        1 (:8) =   M ,22 the ratio of the average balances to the average income,
 M=H, and the semi-elasticity of money demand,                         @ log M=(100         @ ). In the 2013 SCF,
F    1 (:8) =   M = 1:23 and M=H = :39.23 Aruoba, Waller and Wright (2011) estimate that                               =
    :06. These calibration targets are matched with a = :31,                     = 3:21 and h = 6:26. So lumpy
consumption shocks occur every 3.6 months on average, and the annual labor endowment is more
than 6 times the …rst-best level of consumption in the event of a shock.
   21
      Transaction accounts in SCF include checking, savings, money market, and call accounts, but they do not
include currency. Hence, we interpret money holdings in the model as pre-loaded (no credit involved) payment
accounts mainly used for transactional purposes.
   22
      We pick the 80th percentile as the calibration target for the following reason. In the data the median to mean
ratio for transaction balances is 0.11. In contrast, the model with linear utility tends to generate a distribution skewed
to the right, with a high median.
   23
      In the 2013 SCF, 93.2% of all households have transaction accounts. Conditional on those having such accounts,
the average balances are $36.3k (in 2013 dollars). The average income is $87k. Thus, the average balances to the
average income ratio is 0:932 36:3=87 = 0:3889.


                                                           29
    The middle and right panels in the bottom row of Figure 4 plot the distribution of real balances
and the household’s lumpy-consumption rule for this parametrization. The threshold below which
there is full depletion, z1 , is about 0.54 while the target for real balances is about z ? = 1:6; i.e.,
the equilibrium features partial depletion. We increase the in‡ation rate from                = 2% to      = 10%.
From the bottom left panel, z1 increases to 0.56— households deplete their money holdings more
often— while z ? decreases to 1.2— households have lower incentives to self-insure. The bottom left
panel shows that y(z) increases for all z. So households target lower real balances and they spend
more given a level of wealth when a preference shock happens, in accordance with the ‘hot potato’
e¤ect. From the top panels aggregate output and aggregate real balances decrease with in‡ation.
The welfare cost of 10 percent in‡ation is about 1.27 % of total consumption, a smaller number
than the one obtained with the LRW model (see, e.g., Rocheteau and Wright, 2009).24




                                        Figure 4: Calibrated example



    In order to illustrate the non-monotone e¤ects of in‡ation on output and welfare, we keep the
same parametrization but we allow h and              to vary. In Figure 5 we distinguish four regimes: full
versus partial depletion of real balances (y(z ? ) = z ? versus y(z ? ) < z ? ) and slack versus binding

  24
      As is standard in the literature, our measure of the welfare cost of in‡ation is equal to the percentage of
households’consumption that a social planner would be willing to give up to have zero in‡ation instead of . This
measure does not take into account transitional dynamics. Our estimate of the welfare cost of in‡ation is consistent
with the ones in discrete-time models with alternating competitive markets and ex-ante heterogeneous buyers and
sellers. In the absence of distributional considerations Rocheteau and Wright (2009) found a welfare cost of 10
percent in‡ation, equal to 1.54% of GDP. Dressler (2011) departs from quasi-linear preferences in order to obtain a
non-degenerate distribution and …nds a cost of in‡ation equal to 1.23%. Imrohoroglu (1992) in a Bewley model with
income shocks, found a welfare cost of in‡ation equal to 1.07%.


                                                        30
labor constraint (h(z ? ) < h versus h(z ? ) = h). For su¢ ciently high        and su¢ ciently low h,
the equilibrium features full depletion and binding labor; this corresponds to the area marked
III in the …gure. The lower bond for in‡ation and the upper boundary of this area correspond
respectively to   and log H( ) in Proposition 9. As       is reduced below    the equilibrium features
partial depletion of real balances (areas I and II). Finally, provided that h is su¢ ciently large, the
equilibrium features both full depletion and slack labor (area IV). The equilibria we characterize
in closed form correspond to III and IV. Note that for all h           = 3:21 (i.e., log h   1:14) the
…rst-best level of output is hF I = h, achieved in areas II and III.




                                     Optimal
                                  inflation rate




Figure 5: Region I: Slack labor & Partial depletion; Region II: Binding labor & Partial depletion;
Region III: Binding labor & Full depletion; Region IV: Slack labor & Full depletion.



   Propositions 9 and 10 establish that for high h in‡ation is detrimental to society’s welfare
whereas for low h positive in‡ation implemented with lump-sum transfers raises welfare relative to
the laissez-faire. In Figure 5 we illustrate these results by plotting with a black, thick curve the
welfare-maximizing in‡ation rate as a function of the labor endowment. As h increases the optimal
in‡ation rate decreases, and for a su¢ ciently high value of h the laissez-faire equilibrium dominates
any equilibrium with positive in‡ation. Moreover, when equilibria with full depletion and binding
labor exist (area III) then the optimal in‡ation rate is the highest one that is consistent with such
an equilibrium. A higher in‡ation rate would relax the labor constraint (area IV) and would reduce
output below its e¢ cient level, h. For values of h that are large enough such that region III does
not exist, then the optimal in‡ation rate corresponds to an equilibrium with slack labor and partial
depletion (area I). In area IV with slack labor and full depletion a reduction of the in‡ation rate

                                                   31
is always welfare improving. We will revisit this result in the next section under a more general
transfer scheme.



                                                                                               h = 0 .1 5




                                                                                               h =1




Figure 6: Non-monotonic e¤ects of in‡ation on output and welfare. Top panels: h = 0:15. Bottom
panels: h = 1.



   In the top panels of Figure 6 we plot aggregate output, real balances, and the welfare cost of
in‡ation in the case where h = 0:15 (i.e., log(h) =       1:90). As shown in Figure 5, as in‡ation
increases the economy transitions between di¤erent regimes with di¤erent comparative statics. In
the …rst regime with slack labor, h(z ? ) < h, and partial depletion, y(z ? ) < z ? , an increase in
in‡ation leads to higher employment and output, lower aggregate real balances, and higher welfare
(a negative welfare cost). If in‡ation increases further, then the labor constraint, h(z ? )   h, binds
and aggregate output is independent of the in‡ation rate. In the third regime both aggregate
output and real balances are independent of the in‡ation rate, but welfare is still increasing with
in‡ation. For large in‡ation rates, aggregate output, real balances, and welfare all fall.
   In the bottom panels of Figure 6 we plot the same variables for a larger labor endowment,
h = 1. For low in‡ation rates the economy is in a regime with slack labor and partial depletion,
and it transitions to a regime with full depletion for larger in‡ation rates. Except for very low
in‡ation rates, in‡ation negatively a¤ects both output and aggregate real balances. The optimal
in‡ation rate is strictly positive, corresponding to an equilibrium featuring partial depletion of real
balances. These examples illustrate the key role played by h for the output and welfare e¤ects of
in‡ation.




                                                  32
4.4     Beyond lump-sum transfers

We show in Proposition 9 and Figure 5 that when h is su¢ ciently large, in‡ation implemented
through lump-sum transfers is welfare-worsening as the social cost of lowering z ? outweighs the risk-
sharing bene…ts associated with lump-sum transfers. In contrast, Wallace (2014) conjectures that
money creation is almost always optimal in pure-currency economies, but it might not necessarily
be produced by way of lump-sum transfers. In accordance with this conjecture, we establish in the
following that in‡ation is optimal once one allows for more general, incentive-compatible, transfer
schemes.25 Suppose new money, M_ = M , is injected through the following transfer scheme:
                                   8
                                   <     0           z z?
                                                        ? ?
                             (z) =   zz      1 if z 2 (z ; z0 ] ;                         (43)
                                   :
                                         z           z > z0?
where z ? solves U 0 (z ? ) = 1 + (r + )= . The real transfer, (z), is non-negative because in pure
currency economies with no enforcement taxation is not feasible (Wallace, 2014). The transfer is
non-decreasing so that households have no incentive to hide some of their money balances. Hence,

 0     0 and   z    0. Moreover, we assume that (z) is continuous,              z   = ( z0?            ?
                                                                                               0 ) = (z0   z ? ) and

 1   = ( z?          ?     ?
                         z ? ). From the government budget constraint, the sum of the transfers to
                0 ) z0 = (z0
                                                 R
households net of the in‡ation tax must be zero, [ (z)      z] dF (z) = 0, where the distribution
F is now indexed by the transfer scheme. Hence,              z    and    1    0. So the …rst tier is a lump-sum
transfer, the second is a linear regressive transfer, and the third tier is neutral.
     Our proposed scheme, illustrated in Figure 7, takes into account the trade-o¤ between self-
insurance and risk sharing in economies with non-degenerate distributions. It has a regressive
component that guarantees a positive rate of return on real balances above a threshold. As a
result of this component, households accumulate the same amount they would in the laissez-faire
equilibrium, z0? . It has a lump-sum component that improves risk sharing by transferring wealth
from the richest households to the poorest ones.
     In the following proposition we denote h0F the threshold for labor endowments above which the
laissez-faire equilibrium features full depletion; in other words (34) holds.

Proposition 11 (Socially bene…cial in‡ation) Suppose that h                         h0F . A transfer scheme, (z)
given by (43), with       > 0 raises society’s welfare relative to the laissez-faire.
   25
      This result is consistent with Wallace’s (2014) conjecture, according to which in pure-currency economies with
nondegenerate distribution of money, there are transfer schemes …nanced by money creation that improve ex ante
representative-agent welfare relative to what can be achieved holding the stock of money …xed. Andolfatto (2010)
shows that a regressive transfer scheme is optimal in the context of the Rocheteau and Wright (2005) model with a
degenerate distribution of money holdings.


                                                        33
                               (z)




                                                                1
                                                           τ
                                                           z−
                                                           z
                                                      τ
                          τ0


                                               z π*                 z 0*

                         Figure 7: A socially bene…cial in‡ationary scheme



   In order to prove that the transfer scheme is socially bene…cial we show that it not only re-
distributes wealth, but also raises aggregate real balances. In order to make the second claim we
establish that it takes longer to accumulate z0? under the transfer scheme, , than under laissez
faire. Relative to laissez faire, households accumulate real balances at a faster pace when they are
poor, because (z)      z > 0, and at a slower pace when they are rich, because (z)        z < 0. Even
though the sum of the net transfers across households is zero, only a fraction of the households
become su¢ ciently rich to be net contributors to the scheme before they are hit by a new prefer-
ence shock. As a result, the burden on the rich households outweighs the subsidies they received
while being poor, and hence they reach their desired real balances later relative to the laissez faire.
It follows that there is a larger fraction of households who are producing making aggregate real
balances larger under the in‡ationary scheme. In summary, the transfer scheme, , raises society’s
welfare by redistributing a higher stock of real balances from rich to poor households without giving
incentives to households to lower their targeted real balances.
   We now summarize the …ndings of this section. We showed in Propositions 9-10 that for
low values of h the …rst-best level of output can be implemented with an in‡ationary lump-sum
transfer scheme, in which case a household’s ex-ante welfare is locally increasing with anticipated
in‡ation. We provided a calibrated numerical example for which there is a negative relationship
between the optimal in‡ation rate and h. This example also suggested that for large values of h
in‡ation implemented via lump-sum transfers reduces welfare. However, Proposition 11 constructed



                                                      34
a generalized transfer scheme, with both a lump-sum and a regressive component, that raises ex-ante
welfare relative to the laissez-faire. These …ndings are consistent with Wallace’s (2014) conjecture
according to which in pure currency economies "there are transfer schemes …nanced by money
creation that improve ex ante representative-agent welfare relative to what can be achieved holding
the stock of money …xed."


5        Other applications

In the following we depart from the linear speci…cation for u(c; h                      h) adopted in Section 4 in
order to illustrate additional insights and other tractable cases of our model. We …rst provide
an example with quadratic preferences, allowing us to characterize in closed form the transitional
dynamics following a one-time money injection. Second, we assume general preferences over c and
h but linear and stochastic preferences over lumpy consumption, in order to discuss the e¤ects of
in‡ation on households’spending behavior.

5.1      Money in the short run

Suppose now that preferences are quadratic: U (y) = Ay                     y 2 =2 and u(c; h h) = "c c2 =2 h2 =2.26
From (15), and assuming interiority, the optimal choices of consumption and labor are ct = "                           t

and ht =       t.   Under full depletion of real balances the stationary solution to the system of ODEs,
                    ?
(23)-(25), is           = "=2 and z ? = A      (1 + r= ) "=2. We assume that A > (1 + r= ) "=2 to guarantee
z ? > 0. Along the saddle path trajectory

                                                  (z) =       (z   z?) +    ?
                                                                                ;                                   (44)
                                                          2
                             q
where      =        r+           (r + )2 + 8     =2 < 0. It follows that the household’s policy functions are:

                                                              "   (z       z?)
                                                c(z) =                                                              (45)
                                                                   2
                                                              " + (z       z?)
                                               h(z) =                               :                               (46)
                                                                   2

As households get richer their marginal value of wealth decreases, their consumption ‡ow increases,
                                                                                                                ?
and their supply of labor decreases. The condition for full depletion is A                  z? >     z ? =2 +       and
c(z) is interior for all z if c(0)       0. It can be shown that the set of parameter values for which these
restrictions hold is non-empty.
    26
    Notice that these preferences do not satisfy the Inada conditions imposed earlier. But previous results are not
needed as we are able to solve the equilibrium in closed form.


                                                              35
    The saddle path of (23)-(25) is such that zt = z ? 1                   e   t   where t is the length of the time
interval since the last preference shock. Given that t is exponentially distributed the distribution
of real balances is:
                                                        z? z
                                   F (z) = 1                          for all z      z?:                          (47)
                                                          z?
In contrast to the model of Section 4 the distribution of real balances has no mass point at z ? as
households reach their target asymptotically. Market clearing gives
                                               Z   z?
                                       M=               [1   F (z)] dz =           z?:                            (48)
                                               0

As before aggregate real balances depend on all preference parameters (r; ",A) but not on M : money
is neutral in the long run.
    We now turn to the transitional dynamics following a one-time increase in the money supply,
from M to M , where            > 1. We conjecture the existence of an equilibrium where the value of
money adjusts instantly to its new steady-state value, = . Along the equilibrium path aggregate
real balances, Z = M , are constant. To check that our proposed equilibrium is indeed an equilib-
rium we show that the goods market clears at any point in time. From (45) and (46) it is easy to
                                       R              R
check that aggregate consumption is C    c(z)dFt (z)+    zdFt (z) = ["   (Z z ? )] =2+ Z while
                         R
aggregate output is H = h(z)dFt (z) = [" + (Z z ? )] =2. From (48) it follows that C + Z = H,
i.e., the goods market clears. The predictions of the model for aggregate quantities are consis-
tent with the quantity theory: the price level moves in proportion to the money supply and real
quantities are una¤ected. So, from an aggregate viewpoint, money is neutral in the short run.27
    However, money a¤ects the distribution of real balances and consumption levels across house-
holds, which is relevant for welfare under strictly concave preferences. We compute society’s welfare
                                        R
at the time of the money injection as W (z)dF0 (z) where

                                           F0 (z) = F [ z         (    1)Z] :                                     (49)

According to (49) the measure of households who hold less than z real balances immediately after
the money injection is equal to the measure of households who were holding less than z                        (    1)Z
just before the shock: they received a lump-sum transfer of size (                         1)Z and their real wealth is

   27
      This result is certainly not general, but it is a useful benchmark suggesting that the e¤ects of a one-time money
injection on aggregate real quantities will crucially depend on preferences that determine the relationship between
labor supply decisions and wealth. In Rocheteau, Weill, and Wong (2015) we study transitional dynamic following one-
time money injections in a discrete-time version of our model with search and bargaining and quasi-linear preferences.
We show that the money injection a¤ects the rate of return of money, aggregate real balances, and output levels.


                                                             36
scaled down by a factor            1   due to the increase in the price level. The value function, W (z), being
strictly concave ( (z) is a decreasing function of z), the reduction in the spread of the distribution
leads to an increase in welfare.

5.2    In‡ation and velocity

Suppose now that U (y) = Ay where A is an i.i.d. draw from some distribution                               (A).28 We will
use this version of the model to capture the common wisdom according to which households spend
their real balances faster on less valuable commodities as in‡ation increases, thereby generating a
misallocation of resources.29
    We conjecture that W (z) is linear with slope . The HJB equation, (10), becomes:
                                                                 Z
                      rW (z) = max u(c; h                h) +        V (z) + (h         c      z+    )                  (50)
                                       c;h
                 R
where V (z)          V (z; A)d (A) with

                       V (z; A)         max fAy + W (z           y)g = max (A               ) y + W (z):                (51)
                                       0 y z                           0 y z


From (51) the household spends all his real balances whenever A > . Di¤erentiating (50) and
                     RA
using that V 0 (z) =    (A    )d (A), solves:
                               "Z                  #     Z
                                                A                              A
                        (r + )         =            (A     ) d (A) =               [1         (A)] dA:                  (52)


Equation (52) has the interpretation of an optimal stopping rule. According to the left side of
(52), by spending its real balances the household saves the opportunity cost of holding money, as
measured by r + . According to the middle term in (52), if the household does not spend its real
balances, then it must wait for the next preference shock with A                              . Such a shock occurs with
Poisson arrival rate        [1      ( )], in which case the expected surplus from spending one unit of
                                           RA
real balances is E [ A           jA    ]=     (A    ) d (A)= [1    ( )]. Finally, the right side of (52) is
                                                                                                               ?
obtained by integration by parts. It is straightforward to check that there is a unique,                           , solution
to (52), and this solution is independent of the household’s real balances as initially guessed. As
                        ?
in‡ation increases          decreases and, in accordance with the "hot potato" e¤ect, households spend

   28
      For a signi…cant extension of our model with linear utility for lumpy consumption, see Herrenbrueck (2014). The
model is extended to account for quantitative easing and the liquidity channel of monetary policy.
   29
      This wisdom has proved di¢ cult to formalize in models with degenerate distributions. See Shi (1997); Lagos and
Rocheteau (2005); Ennis (2009); Liu, Wang, and Wright (2011), and Nosal (2011) for several attempts to generate
the ‘hot potato’e¤ect in this class of models.


                                                                37
their money holdings on goods for which they have a lower marginal utility of consumption. Given
 ?
     (15) describes the ‡ow of consumption, c? , and hours, h? .
      The real balances of a household who depleted its money holdings t periods ago are zt =
(h?     c? +   M ) (1      e     t )=   . The probability that a household does not receive a preference
                   ?                                                                             ?
shock with A            over a time interval of length t is e                  [1        (           )]t .   Consequently,
                                                               [1       ( )]
                                 h?       c? + ( M z)                                                          h?   c? +     M
               F (z) = 1                                                           for all z                                     :      (53)
                                        h? c? + M

By market clearing, (22),
                                                            h?          c?
                                                 M=                            :                                                        (54)
                                                           [1           ( ? )]
Aggregate real balances fall with in‡ation: because households save less, h? c? is lower, and because
                                                                         ?
they spend their real balances more rapidly,          [1            (        )] increases. The velocity of money, denoted
V, is de…ned as nominal aggregate output divided by the stock of money. From (54),
                                                                                    ?
                                                  h?            [1             (        )]
                                             V       =                       c?              :                                          (55)
                                                  M               1          h?

The velocity of money increases with in‡ation for two reasons: households spend their real balances
                                                               ?
more often following preference shocks, 1                  (       ) increases, and the saving rate, (h?                             c? )=h? ,
decreases. A monetary equilibrium exists if h?                 c? > 0, which holds if the in‡ation rate is not too
large and the preference shocks are su¢ ciently frequent.
   Finally, if preferences over ‡ow consumption and leisure are also linear, then all households
                              RA
supply h provided that <       1 [1    (A)] dA r. So in‡ation has no e¤ect on aggregate output.
Welfare at a steady-state monetary equilibrium is
                                   Z Z                                             "R A                             #
                                                                                          Ad (A)
                                                                                             ?
                         W=                AzdF (z)d (A)            h=h                                             1 :
                                                                                        1   ( ?)
                           ?
It is increasing with          and hence decreasing with . As in‡ation increases output is consumed by
households with lower marginal utilities, which reduces social welfare.


6      Conclusion

We constructed a continuous-time, pure-currency economy in which households are subject to
idiosyncratic preference shocks for lumpy consumption. We o¤ered a complete characterization
of steady-state equilibria for general preferences and proved the existence and near-e¢ ciency of
equilibrium. We provided closed-form solutions for a class of equilibria where households fully

                                                           38
deplete their money holdings periodically and for special classes of preferences. We studied both
analytically and numerically a version of our economy with quasi-linear preferences resembling the
New-Monetarist framework of Lagos and Wright (2005) and Rocheteau and Wright (2005). In
the presence of …nite labor endowments the equilibrium of this economy features a non-degenerate
distribution of real balances and a trade-o¤ for policy between self-insurance and risk sharing
parameterized by the size of labor endowments. The model delivered a variety of new insights,
including non-monotonic e¤ects of in‡ation on output and welfare and the optimality of in‡ationary
transfer schemes in accordance with Wallace’s (2014) conjecture.




                                               39
References

 [1] Achdou, Yves, Jiequn Han, Jean-Michel Lasry, Pierre-Louis Lions, and Benjamin Moll (2015).
    "Heterogeneous agent models in continuous time," Working Paper, Princeton.

 [2] Aiyagari, Rao (1994). "Uninsured idiosyncratic risk and aggregate saving," Quarterly Journal
    of Economics 109, 659-684.

 [3] Algan, Yann, Edouard Challe, and Lionel Ragot (2011). "Incomplete markets and the output-
    in‡ation trade-o¤," Economic Theory 46, 55-84.

 [4] Alvarez, Fernando, and Francesco Lippi (2013). "The demand for liquid asset with uncertain
    lumpy expenditures,” Journal of Monetary Economics 60, 753-770.

 [5] Andolfatto, David (2010). "Essential interest-bearing money," Journal of Economic Theory
    145, 1495-1507.

 [6] Aruoba, S. Bora¼
                    gan, Christopher J. Waller, and Randall Wright (2011). "Money and capital,"
    Journal of Monetary Economics 58, 98-116.

 [7] Berentsen, Aleksander (2000) "Money Inventories in Search Equilibrium," Journal of Money,
    Credit, and Banking 32, 168-78.

 [8] Bardi, Martino, and Capuzzo-Dolcetta, Italo (1997). Optimal Control and Viscosity Solutions
    of Hamilton-Jacobi-Bellman Equations. Birkhäuser.

 [9] Bewley, Truman (1980). "The optimum quantity of money," in J. H. Kareken and N. Wallace
    (eds), Models of Monetary Economies, Federal Reserve Bank of Mineapolis, 169-210.

[10] Bewley, Truman (1983). "A di¢ culty with the optimum quantity of money," Econometrica 51,
    1485-1504.

[11] Carter, Michael, and Van Brunt, Bruce. (2000). "The Lebesgue-Stieltjes integral: an introduc-
    tion." Springer.

[12] Camera, Gabriele, and Dean Corbae (1999). "Money and price dispersion," International Eco-
    nomic Review 40, 985-1008.




                                               40
[13] Chiu, Jonathan, and Miguel Molico (2010). "Liquidity, redistribution, and the welfare cost of
    in‡ation," Journal of Monetary Economics 57, 428-438.

[14] Chiu, Jonathan, and Miguel Molico (2011). "Uncertainty, in‡ation, and welfare," Journal of
    Money, Credit, and Banking, 43, 487-512.

[15] Coibion, Olivier, Yuriy Gorodnichenko, Lorenz Kueng, and John Silvia (2012). “Innocent
    bystanders? Monetary policy and inequality in the U.S.,” NBER Working Paper 18170.

[16] Diamond, Peter and Joel Yellin (1985). "The distribution of inventory holdings in a pure
    exchange barter search economy," Econometrica 53, 409-432.

[17] Diamond, Peter and Joel Yellin (1990). "Inventories and money holdings in a search economy,"
    Econometrica 58, 929-950.

[18] Doepke, Matthias and Martin Schneider (2006). “In‡ation and the redistribution of nominal
    wealth,” Journal of Political Economy 114, 1069–1097.

[19] Dressler, Scott (2011). "Money holdings, in‡ation, and welfare in a competitive market,"
    International Economic Review 52, 407-23.

[20] Ennis, Huberto (2009). "Avoiding in‡ation tax", International Economic Review 50, 607-25.

[21] Green, Edward and Ruilin Zhou (1998). "A rudimentary random-matching model with divisible
    money and prices," Journal of Economic Theory 81, 252–271.

[22] Green, Edward and Ruilin Zhou (2002). "Dynamic monetary equilibrium in a random-
    matching economy," Econometrica, 70, 929-969.

[23] Green, Edward and Ruilin Zhou (2005). "Money as a mechanism in a Bewley economy,"
    International Economic Review 46, 351-371.

[24] Heathcote, Jonathan, Kjetil Storesletten, and Giovanni Violante (2009). "Quantitative macro-
    economics with heterogeneous households," Federal Reserve Bank of Minneapolis Research
    Department Sta¤ Report 420.

[25] Herrenbrueck, Lucas (2014). "Quantitative easing and the liquidity channel of monetary pol-
    icy," Simon Fraser Working Paper.


                                                41
[26] Huggett, Mark (1993). "The risk-free rate in heterogeneous-agent, incomplete-insurance
    economies," Journal of Economic Dynamics and Control 17, 953-969.

[27] Kocherlakota, Narayana (1998). "Money is memory," Journal of Economic Theory 81, 232–51.

[28] Lagos, Ricardo and Guillaume Rocheteau (2005). "In‡ation, output and welfare," International
    Economic Review 46, 495-522.

[29] Lagos, Ricardo and Randall Wright (2005). "A uni…ed framework for monetary theory and
    policy analysis," Journal of Political Economy 113, 463–484.

[30] Levine, David and William Zame (2002). "Does market incompleteness matter?”Econometrica
    70, 1805-1839.

[31] Lippi, Francesco and Ragni, Stefania and Trachter, Nicholas (2014). "State dependent mone-
    tary policy". Working paper, EEIF, University of Sassari, and Federal Reserve Bank of Rich-
    mond.

[32] Liu, Lucy Qian, Liang Wang, and Randall Wright (2011). "On the ‘hot potato’ e¤ect of
    in‡ation: Intensive versus extensive margins," Macroeconomic Dynamics 15, 191-216.

[33] Ljungqvist, Lars and Thomas Sargent (2004). Recursive Macroeconomic Theory, MIT Press.

[34] Menzio, Guido, Shouyong Shi, and Hongfei Sun (2013), "Monetary theory with non-degenerate
    distributions", Journal of Economic Theory 148, 2266-2312.

[35] Milgrom, Paul, and Segal, Ilya (2002), "Envelope Theorems for arbitrary choice sets", Econo-
    metrica 70, 583-601.

[36] Molico, Miguel (2006). "The distribution of money and prices in search equilibrium," Interna-
    tional Economic Review 47, 701-722

[37] Mulligan, Casey B., and Xavier Sala-i-Martin (1993), "Transitional dynamics in two-sector
    models of endogenous growth," The Quarterly Journal of Economics 108, 739-773.

[38] Nosal, Ed (2011). "Search, welfare, and the ‘hot potato’ e¤ect of in‡ation," Macroeconomic
    Dynamics 15, 313-326.

[39] Nosal, Ed, and Guillaume Rocheteau (2011). Money, Payments, and Liquidity. MIT Press.


                                               42
[40] Palumbo, Michael (1999). "Uncertain medical expenses and precautionary saving near the end
    of the life cycle," Review of Economic Studies 66, 395-421.

[41] Rocheteau, Guillaume, and Antonio Rodriguez (2014). "Liquidity provision, interest rates, and
    unemployment," Journal of Monetary Economics 65, 80-101.

[42] Rocheteau, Guillaume and Randall Wright (2005). "Money in search equilibrium, in competi-
    tive equilibrium, and in competitive search equilibrium," Econometrica 73, 175–202.

[43] Rocheteau, Guillaume and Randall Wright (2009). "In‡ation and welfare in models with trad-
    ing frictions," Monetary Policy in Low In‡ation Economies. Eds. Ed Nosal and Dave Altig.
    Cambridge University Press.

[44] Rocheteau, Guillaume, Pierre-Olivier Weill, and Tsz-Nga Wong (2015). "Long-run and short-
    run e¤ects of money injections," Working Paper, UCI, UCLA, and Bank of Canada.

[45] Scheinkman, Jose, and Laurence Weiss (1986). "Borrowing constraints and aggregate economic
    activity", Econometrica 54, 23-45

[46] Shi, Shouyong (1995). "Money and prices: A model of search and bargaining," Journal of
    Economic Theory 67, 467–496.

[47] Shi, Shouyong (1997). "A divisible search model of …at money," Econometrica 65, 75–102.

[48] Shi, Shouyong (2006). "Viewpoint: A microfoundation of monetary economics," Canadian
    Journal of Economics 39, 643-688.

[49] Stokey, Nancy, Robert Lucas, and Edward Prescott (1989). Recursive Methods in Economic
    Dynamics. Cambridge, Harvard University Press.

[50] Sun, Hongfei (2012). "Monetary and …scal policies in a heterogeneous-agent economy," Working
    Paper, Queen’s University.

[51] Trejos, Alberto and Randall Wright (1995). "Search, bargaining, money, and prices," Journal
    of Political Economy 103, 118–141.

[52] Wallace, Neil (2014). "Optimal money-creation in pure-currency economies: a conjecture,"
    Quarterly Journal of Economics 259-274.


                                               43
[53] Williamson, Stephen and Randall Wright (2010a). “New Monetarist Economics: Methods.”
    Federal Reserve Bank of St. Louis Review 92, 265-302.

[54] Williamson, Stephen and Randall Wright (2010b). “New monetarist economics: models,” In
    Benjamin Friedman and Michael Woodford (eds.), Handbook of Monetary Economics, Second
    Edition. Amsterdam: North-Holland.

[55] Wang, Neng (2007). "An equilibrium model of wealth distribution." Journal of Monetary
    Economics 54, 1882-1904.

[56] Wong, Tsz-Nga (2014). "A tractable monetary model under general preferences." Working
    Paper, Bank of Canada.

[57] Zhou, Ruilin (1999). "Individual and aggregate real balances in a random-matching model,"
    International Economic Review 40, 1009-1038.

[58] Zhu, Tao (2005). "Existence of a monetary steady state in a matching model: Divisible money",
    Journal of Economic Theory 123, 135-160.




                                               44
Appendix A: Proofs of Propositions


PROOF OF THEOREM 1.                   The Theorem summarizes a series of results from the Supple-
mentary Appendix. Lemma II.3 shows that the Bellman equation has a unique bounded solution,
and that this solution is concave, continuous, and increasing. Lemma II.5 shows that the value
function is strictly increasing. Lemma II.8 shows that the value function is a viscosity solution of
the HJB equation. Proposition II.11 uses this result to show that the value function is continuously
di¤erentiable, and that its derivative is strictly decreasing. This implies that the value function
is strictly concave, that it is twice continuously di¤erentiable almost everywhere, and that it is a
classical solution of the HJB equation, i.e., that it satis…es (10).
   Proposition II.14 shows that the value function is twice continuously di¤erentiable in a neighbor-
hood of any z > 0, except perhaps if saving rate is zero, and under linear preferences if W 0 (z) = 1.
Since there is a unique level of real balances such that the saving rate is zero (see Proposition
2), and since W 0 (z) is strictly decreasing, this means that the value function is twice continuously
di¤erentiable except for two levels of real balances. Under SI preferences, Proposition IV.4 shows
that the value function is twice continuously di¤erentiable even when the saving rate is zero. Under
linear preferences, Lemma VI.6 shows that, in equilibrium, the value function is twice continuously
di¤erentiable over the support of the distribution of real balances.
   To derive the bound on W 0 (0), consider some small " > 0. By working full time, ht = h and
consuming nothing, the household can reach " at time T" solving zT" = ", where z_t = h +                          zt .
Solving this ODE explicitly gives:

                                     1                                     "
                            T" =         log 1                "       =         + o("):
                                                     h+                   h+

Since utility ‡ows are bounded below by zero, we must have that W (0)                      e   (r+ )T" W ("),   which
implies in turn that:
                                                                      (r+ )T"
                             0     W (")    W (0)         1       e             W ("):

Dividing both side by " and taking the limit " ! 0, we obtain that:

                                                      r+
                                           W 0 (0)                W (0):
                                                      h+

By taking the sup norm on both sides of (6) we obtain that rkW k                      kuk + kU k, and the result
follows. Finally, the result that limz!1 W 0 (z) = 0 follows from the fact that W (z) is concave and


                                                      45
bounded (see Corollary II.4 in the Supplementary Appendix), and the result that limz!0 W 00 (z) =
1 is shown in Corollary II.17 of the Supplementary Appendix.
    PROOF OF PROPOSITION 1.                      The results follow directly because U (y) and W (z) are
both strictly concave and continuously di¤erentiable, because U 0 (0) = 1 while W 0 (0) < 1, and
because U 0 (1) = W 0 (1) = 0.
    PROOF OF PROPOSITION 2. Note that the saving rate correspondence can be written as
s(z) = h    c    z + , where (h; c) 2 X( ) and X( ) = arg max u(c; h                    h) + (h     c    z+    ) ,
with respect to c     0, 0   h     h. With linear preferences, X( ) = (c; 0) if              < 1, X( ) = [0; c]
[0; h] if   = 1 and X( ) = (0; h) if      > 1. With SI preferences, one can easily check that X( ) is
singled-valued and continuous, that the optimal consumption choice, c( ), is strictly decreasing, and
that the optimal labor choice, h( ), is increasing (see Lemma I.2 in the Supplementary Appendix
for details). Combined with the fact, established in Theorem 1, that W 0 (z) is strictly decreasing
and continuous, all the statements of the Lemma follow except for s(z) > 0.
    To establish that s(z) > 0 near zero, recall that the value function is twice di¤erentiable almost
everywhere. Consider any z > 0 such that W 00 (z) exists. Then, we can apply the envelope condition
to the right side of the HJB equation (see Theorem 1 in Milgrom and Segal, 2002). We obtain that:

                                 (r +   + )W 0 (z) = V 0 (z) + W 00 (z)s(z):                                  (56)

From Proposition 1 we have that V 0 (z) = U 0 [y(z)]. Since y(z)               z and limz!0 U 0 (z) = 1, it follows
that limz!0 V 0 (z) = 1. From W 0 (0) < 1 and (56), limz!0 W 00 (z)s(z) =                 1. Since W 00 (z)   0, it
then follows that s(z) > 0 for some z close enough to zero. Since s(z) is decreasing, it follows that
s(z) > 0 for all z close enough to zero.
    PROOF OF PROPOSITION 3.                      The proof is based on results from two sections of the
Supplementary Appendix: Section IV.3, which studies the initial value problem in the case of SI
preferences, and Section V.2, which explicitly solves for the solution to this problem in the case of
linear preferences.
    PROOF OF PROPOSITION 4. See Section VI.1 of the Supplementary Appendix for the
detailed application of Theorem 12.12 and 12.13 in Stokey, Lucas, and Prescott (1989).


Lemma 1 At the target level of real balances, z ? :

                                        W 0 (z ? ) =             V 0 (z ? ):
                                                       r+    +


                                                        46
   PROOF OF PROPOSITION 5.                           First, we note that the stationary distribution cannot
be concentrated at z = 0, since Q(z; f0g) = 0 for all z. Hence, when                          = 0, the left-hand side of
(22) is zero and so is less than the right-hand side, which is strictly positive. When                          ! 1, we
have from the upper bound of Theorem 1 that W 0 (z) ! 0 for all z 2 [0; 1). This implies that
labor supply is zero and consumption is strictly positive for all z 2 [0; z ? ], hence the saving rate
is s(z) <     z+     . Plugging s (z ? ) = 0, it follows that z                z? <     =     for all real balances z in
the support of the stationary distribution, [0; z ? ], implying that the right-hand side of (22 ) is less
than the left-hand side. Finally, note that (22) is continuous in                     because, by Proposition 4, the
stationary distribution is continuous in          in the sense of weak convergence. The result then follows
by an application of the intermediate value theorem.
   PROOF OF LEMMA 1.                     Note that, at z ? , there exists some optimal consumption and
labor choices, (c? ; h? ) such that h?      c?       z? +      = 0. Hence, from the HJB:

                 (r + )W (z)           u(c? ; h      h? ) + V (z) + W 0 (z) (h?          c?       z+    )

                 (r + )W (z ? ) = u(c? ; h           h? ) + V (z ? );

where the inequality in the …rst equation follows because we evaluate the right side of the HJB at
a point that may not achieve the maximum. Taking the di¤erence between these two equations,
and recalling that h(z ? )   c(z ? )      z? +       = 0, we obtain that:

                    (r + ) [W (z)        W (z ? )]       [V (z)    V (z ? )]     W 0 (z) (z       z?)

The result follows by dividing both sides by z              z ? , for z > z ? and then for z < z ? , and taking the
limit as z ! z ? , keeping in mind that V (z) is di¤erentiable at z ? and that W (z) is continuously
di¤erentiable.

Lemma 2 Under either SI or linear preferences, for z 2 [0; z ? ]:
                     Z z?
     0
   W (z) =                V 0 (x)dG(x j z); where G(x j z) 1                      e    (r+ + )[T (x+ ) T (z)]
           r+ +       z

   PROOF OF LEMMA 2.                      First, recall from Theorem 1 that the value function is twice
continuously di¤erentiable over (0; 1), except perhaps under linear preferences, when this property
may not hold for at most two points. Hence, we can take derivatives on the right side of the HJB
equation along the path of real balances zt , except perhaps at two points. Applying the envelope
condition, we obtain that:

                              (r +       + )W 0 (zt ) = V 0 (zt ) + W 00 (zt ) z_t ;

                                                          47
if zt < z ? , except perhaps at two points. At z = z ? , Lemma 1 shows that

                                                           (r +       + )W 0 (z ? ) = V 0 (z ? ):

In all cases we can integrate this formula forward over the time interval [t; T (z ? )] and we obtain
that:
                                 Z         T (z ? )
                  0                                                                            (r+ + )[T (z ? ) t]           V 0 (z ? )
             W (zt ) =                                 V 0 (zs )e    (r+ + )(s t)
                                                                                      ds + e                                            :            (57)
                                       t                                                                                    r+ +
Consider the integral on the right side of (57). The inverse of zt when restricted to the time interval
[0; T (z ? )] is the strictly increasing function T (x), the time to reach the real balances x starting
from time zero. Let M (x)                             1     e    (r+ + )[T (x) t]     and note that M                    z(s) = 1      e    (r+ + )(s t) .


With these notations, the …rst integral can be written:
                      Z     T (z ? )                                                                Z       T (z ? )
                                               0                (r+ + )(s t)
                                            V (zs ) e                          ds =                                    V 0 zs d [M     zs ]
                        t                                                             r+       +        t
                                             Z                                                     Z
             =                                                  V 0 (x) dM (x) =                                       V 0 (x) dG(x j z):
                       r+           +              x2[z;z ? ]                       r+     +        x2[z;z ? )

where the second equality follows by an application of the change of variable formula for Lebesgue-
Stieltjes integral (see Carter and van Brunt, 2000, Theorem 6.2.1), and the second line follows
because G(x j z) = M (x) for all x 2 [z; z ? ). The result follows by noting that the second integral
                       V 0 (z ? )
can be written:       r+ +                    G(z ? j z)           G(z ? j z) .
   PROOF OF PROPOSITION 6.
   Recall from (2)-(3) that the full-insurance allocation is determined by:

                                           (cF I ; y F I ; hF I ) 2 arg max u(c; h             h) + U (y)

                                                            s.t.      y + c = h and h              h:

We propose arbitrary strategies for households and evaluate these strategies in order to obtain a
lower bound for households’lifetime expected utility in a laissez-faire monetary equilibrium, W (z).
The strategy we are considering for the accumulation of real balances replicates the inventory-
accumulation strategy in Diamond and Yellin (1985). Households consume a constant y units
of lumpy consumption whenever their real balances allow them to do so, z                                                              y, and nothing
otherwise. Moreover, their ‡ow consumption is constant and equal to c, and their ‡ow labor supply
is constant and equal to h. Their ‡ow saving rate is z_ = s = h                                                c > 0. Denote u = u(c; h                h)
and U = U (y). Notice also that this strategy coincides with the one sustaining the full-insurance
allocation, provided that (c; h; y) is appropriately chosen, except when z < y.

                                                                               48
   The value of a household following that strategy starting with z real balances is:
                                Z +1               Z +1
                       ~
                       W (z) =       e  rt
                                           u+ U           p(z 0 ; t; z)dz 0 dt;                           (58)
                                   0                                 y

where p(z 0 ; t; z) is the probability that the households has z 0 real balances at time t starting from
z at t = 0. From (58) the household enjoys a constant utility ‡ow, u, and the utility of lumpy con-
sumption, U , with probability dt, if its real balances at time t are greater than y, with probability
R +1
 y   p(z 0 ; t; z)dz 0 . The household value function can be rewritten as:
                                                Z     +1             Z       +1
                          ~ (z) = u + U
                          W                                e    rt
                                                                                  p(z 0 ; t; z)dz 0 dt:   (59)
                                  r              0                       y

Except for the …rst term, this corresponds to (4.2) in Diamond and Yellin (1985). It is clear that
~ (z) is non-decreasing in z. So in the following we will focus on W
W                                                                  ~ (0) which will give us a lower

bound for W (z). For all z < y the value function satis…es the following HJB equation:

                                          ~ (z) = u + W
                                         rW           ~ 0 (z)s:                                           (60)

The household enjoys the utility ‡ow u but do not consume when preference shocks for lumpy
consumption occur (since the strategy speci…es y(z) = 0 for all z < y). Moreover, he accumulates
                                                                                   ~ 0 (z)s. Using the
real balances at rate s, which leads to an increase in its value function equal to W
integrating factor method the value of the household with depleted real balances is:

                                ~ (0) = e
                                W
                                                r
                                                s
                                                  y   ~ (y) + u 1
                                                      W                             e
                                                                                        r
                                                                                        s
                                                                                          y
                                                                                              :           (61)
                                                              r

The value of a household with depleted real balances is equal to its value with y real balances
discounted at rate r over a time interval of length y=s, the time that it takes to reach y; it is
augmented with the discounted sum of the utility ‡ow, u, over that period. De…ne:
                                     Z xZ 1
                             H(x) =            re rt p(z; t; y)dtdz:
                                            0         0

The quantity G(x) is the average probability that the household will hold less than x real balances
over its lifetime, if he starts with y, with weights decreasing at rate r over time. From (59) the
value of a household with y real balances is:

                                       ~ (y) = u +
                                       W
                                                               [1        H(y)] U
                                                                                        :                 (62)
                                                                     r

The …rst term on the right side of (62) is simply the discounted sum of utility ‡ows, u=r. The second
term on the right side is the discounted sum of the utilities from lumpy consumption, taking into

                                                           49
account that such opportunities occur on average at rate                             [1                            ~ (y) by its
                                                                                               G(y)]. Substituting W
expression into (61):
                                   ~ (0) = e       r
                                                     y    U                                  u
                                   W               s        [1            H(y)] +              :                           (63)
                                                          r                                  r
We obtain the term, 1     H(y), directly from Diamond and Yellin (1985, eq. (4.12)),
                                                                  r            r
                                                                      1+      s
                                         1     H(y) =                         r
                                                                                y
                                                                                     ;                                     (64)
                                                                  1       e   s



where    is the unique negative real root of:

                                                              y
                                          s =             e           1        r:                                          (65)

Note that when r = 0 (65) is the characteristic equation for the stationary distribution of real
balances. Moreover, from (64),
                                                                              s
                                             lim [1       H(y)] =                ;
                                             r!0                               y
which is the fraction of households with real balances larger than y in a steady state where all
households play the inventory-accumulation strategy of Diamond and Yellin (1985, eq. (3.9)).
Substituting 1    H(y) from (64) into (63):

                                   ~ (0) = e       r
                                                     y    U r 1+              s
                                                                               r
                                                                                             u
                                   W               s                          r
                                                                                y
                                                                                         +     :                           (66)
                                                          r 1 e               s              r

Now, we set (y; c; h) equal to their levels at the full-insurance allocation, (y F I ; cF I ; hF I ). So,
households follow a strategy that implements the full insurance allocation except when their real
balances are lower than y F I , in which case they do not consume if a preference shock occurs. The
saving rate is then s = y F I and the value of the household with depleted real balances is:

                                   ~ F I (0) = e      r   U r 1+               s
                                                                                r
                                                                                              u
                                   W                                            r        +      :                          (67)
                                                          r 1 e                               r

Multiplying by r both sides and taking the limit as r goes to 0:

                                  ~ F I (0) ! U (y F I ) + u(cF I ; h
                             lim rW                                                                hF I ):                 (68)
                             r!0


The right side of (68) is the ‡ow lifetime expected utility of a household at the full-insurance
allocation.
   The ex-ante expected utility of the household in the laissez-faire monetary equilibrium is mea-
        R
sured by rW (z)dF (z). Because households follow their optimal strategy, W (z) W     ~ (z) W  ~ (0)

for all z. Moreover, the ex-ante expected utility of a household in the laissez-faire monetary

                                                          50
                                                                                                            R
equilibrium is bounded above by the utility at the full-insurance allocation,                                   W (z)dF (z)
 u(cF I ; h    hF I ) + U (y F I ) =r. Hence:
                                          Z
                          ~ F I (0)
                         rW                   rW (z)dF (z)         u(cF I ; h     hF I ) + U (y F I ):                    (69)

From (68) it follows that:
                                    Z
                              lim        rW (z)dF (z) = u(cF I ; h           hF I ) + U (y F I ):                         (70)
                              r!0


    Let (hF I ; cF I ; y F I ) denote the full-insurance allocation corresponding to an environment where
labor endowments have been scaled down by a factor                           < 1. Since u(cF I ; h        hF I ) + U (y F I ) <
u(cF I ; h    hF I ) + U (y F I ) for all      < 1, and from (70), it follows that for all                 2 (0; 1) there is a
r > 0 such for all r < r ,
                               Z
                                    rW (z)dF (z) > u(cF I ; h             hF I ) + U (y F I ):

The ex-ante expected utility of the household is larger at the laissez-faire monetary equilibrium
than at the full-insurance allocation when labor endowments have been scaled down by a factor .


    PROOF OF PROPOSITION 7.                             To establish the …rst point of the Proposition, we note
that, at the target z ? , h?        c?        z? +
                                            = 0, where (c? ; h? ) are optimal consumption and labor
                                                    R z?
choices when z = z ? . Since, in equilibrium, =                        ?
                                                     0 zdF (z) < z , we obtain that h
                                                                                         ?  c? > 0.
This implies that the marginal value of real balances satis…es W 0 (z ? )                           > 0, where the constant
  is independent of the rate of in‡ation, . With linear preferences,                         = 1. With SI preferences,
solves h( )        c( ) = 0. Next, we use Lemma 1:

                                           (r +      + )W 0 (z ? ) = U 0 [y(z ? )] :

Since W 0 (z ? )       , this implies that lim          !1 y(z
                                                                   ?)   = 0. Finally, since we have established in
Theorem 1 that W 0 (0)          (r + )=h             (kuk + kU k)=r, we obtain that W 0 (0) < U 0 [y(z ? )] for
large enough. Therefore, the solution of the optimal lumpy consumption problem is y(z ? ) = z ? ,
i.e., there is full depletion. We conclude that lim                      ?                    ?)
                                                                 !1 z        = lim   !1 y(z        = 0.
    The second part of the Proposition, which deals with linear preference, requires some notations
and results from Section 4. The proof can be found at the beginning of the proof of Proposition 9,
in the paragraph "(i) Large labor endowments".


                                                              51
    PROOF OF PROPOSITION 9. Part (i): Large labor endowment. Fix some                                              0.
We …rst note that y(z ? )         z?      zs , hence equilibrium aggregate demand is bounded by                   zs
independently of h. Equilibrium aggregate supply can be written:

                                          F (z ? )h + 1       F (z ? ) h? :

To remain bounded as h ! 1, it must be the case that limh!1 F (z ? ) = 0. This also implies that,
for h large enough, there is an atom at z ? , so that W 0 (z ? ) = 1 and z ? = zs . Because F converges
to a Dirac distribution concentrated at z ? = zs , we have that limh!1 M = zs .
    Next we argue that, as h is large enough, y(z ? ) = y(zs ) = zs , i.e., all equilibria must feature
full depletion. For this we use the expression for W 0 (z) derived in Lemma 2:
                        Z z?                                    Z z?
   0                          0
W (0) =                      U [y(z)] dG(z j 0)                      maxfU 0 z); W 0 (0) dG(z j 0)
             r+ +                                 r +      +
                        "0         Z
                                                                 0
                                                                                                                   #
                                                                    dG(z j 0)
                         G(zs j 0)            max U 0 (z); W 0 (0)            + 1 G(zs j 0) maxfU 0 (zs ); W 0 (0)g ;
             r+ +                   z2[0;zs )                       G(zs j 0)

as long as h is large enough. To obtain the inequality of the …rst line, we have used that U 0 [y(z)] =
U 0 (z) if there is full depletion, while U 0 [y(z)] = W 0 [z         y(z)]    W 0 (0) if there is partial depletion.
To obtain the second line, we have used that z ? = zs as long as h is large enough. Substituting the
expression for T (z j      M ) into the de…nition of G(z j 0), we obtain that:
                                         8
                                         <              1+ r+
                                                     z
                              G(z j 0) =   1     1   zb           if z < zs
                                         : 1                      if z = zs :

Given that zb goes to in…nity as h goes to in…nity, one sees that G(z j 0) converges weakly to a
Dirac distribution concentrated at zs . We also have:
                                                              1+
                                                1        z                          r+        1
              G0 (z j 0)            r+          zb   1   zb                    1+                        1
                                                                                              zb
                           =   1+                                                                    !      ;
              G(zs j 0)                                       1+ 1+                          1+ 1+       zs
                                                         zs                             zs
                                            1        1   zb               1     1       zb

as h goes to in…nity (since it implies zb ! 1). Thus, the conditional probability distribution,
G(z j 0)=G(zs j 0), has a density that can be bounded uniformly in h. Finally, our bound for W 0 (0)
in Theorem 1 can be written, in the case of linear preferences, as
                                          r+         h+c   kU k
                                W 0 (0)                  +                    !1+       ;
                                           h          r     r                       r
as h ! 1. Taken together, these observations imply that:
          Z                                          Z      n               o
                          0      0    dG(z j 0)   1 zs
                     max U (z); W (0)                    max U 0 (z); 1 +     dz + "
           z2[0;zs )                  G(zs j 0)   zs 0                    r

                                                         52
for some " > 0 as long as h is large enough (note that the integral on the right side is well de…ned
              Rz
since U (z) = 0 U 0 (z) dx). Together with the fact that G(zs j 0) ! 0 as h ! 1, we obtain that:
                       Z
                                                       dG(z j 0)
             G(zs j 0)            max U 0 (z); W 0 (0)           ! 0 and 1 G(zs j 0) ! 1
                        z2[0;zs )                      G(zs j 0)

as h ! 1. Hence, for any " > 0, W 0 (0)                               r+ +        maxfU 0 (zs ); W 0 (0)g + " as long as h is large
                            r+
enough. Picking " <        r+ +       U 0 (zs ), we obtain that W 0 (0) < maxfW 0 (0); U 0 (zs )g, which implies that
W 0 (0) < U 0 (zs ), for h large enough, i.e., there is full depletion.
    Because H =           M under full depletion, and because the distribution of real balances converges
towards a Dirac distribution concentrated at zs , we obtain that limh!1 H = H 1 ( ) = zs , which
                                                             R
is decreasing in . Aggregate welfare can be written as         U (z) dF (z) H, the average utility
enjoyed from lumpy consumption net of the average disutility of supplying labor. As h ! 1, F
converges weakly to a Dirac distribution concentrated at zs , and H converges to                                               zs . It follows
that welfare converges to W 1 =                 [U (zs )            zs ], which is decreasing with .
    Part (ii): Small labor endowment. We have shown that there exists a unique candidate
equilibrium with full depletion. In this candidate equilibrium, the condition for binding labor is
that zs    zb or, using the de…nition of zs :

                                                                                  r+
                                                          U 0 (zb )      1+              :

                      h       h
Recall that zb =          +       is an increasing function of h. Since marginal utility is decreasing, the
condition for binding labor can be written:

                                                                                                1        r+
                          h 2 0; H( ) where H( ) =                                      U0          1+             :
                                                                                  +

One immediately sees that lim              !0 H(          ) = lim      !1 H(           ) = 0.
    Next, we turn to the su¢ cient condition for full depletion. Using Lemma 2 we have, in the
candidate equilibrium with full depletion:
                                            Z    zb                                                                1+ r+
                  0                                       0                                                   z
               W (0) =                                U (z)dG(z) where G(z) = 1                          1                 :
                              r+       +     0                                                                zb

Substituting the expression for G(z) in the integral, we obtain:
                                                  Z       zb
                                                                                        r+
                                  0          1                  0                 z                  U (zb )
                              W (0) =                          U (z) 1                       dz              ;
                                             zb       0                           zb                   zb
                                                                             r+
where the inequality follows by using (1                            z=zb )             1, integrating, and keeping in mind that
U (0) = 0. Full depletion obtains if W 0 (0)                          U 0 (zb ). Using the above upper bound for W 0 (0), we

                                                                        53
obtain that a su¢ cient condition for full depletion is:

                                                                   U (zb )
                                                                               :
                                                                  zb U 0 (zb )
                                 1
Note that zb            (U 0 )       (1), that the function z 7! [U (z)                   U (0)] = [zU 0 (z)] is continuous over
             1
(0; (U 0 )       (1)] and, by our maintained assumption in the Lemma, bounded near zero. Hence, it
                                                              1
is bounded over the closed interval [0; (U 0 )                    (1)]. Therefore, the condition for full depletion is
satis…ed if:
                                                                                       U (z)
                                                                         sup             0
                                                                                             :
                                                              z2[0;(U 0 )      1
                                                                                 (1)] zU (z)

   Output e¤ect of in‡ation. In the regime with binding labor, h(z) = h for all z 2supp(F ).
                  h     i
                      ^ and for all 2 [ ; ], H = h.
Hence, for all h 2 0; h
    Welfare e¤ect of in‡ation. From (40) in the regime with binding labor, M = h= . Hence,
an increase in the money growth rate through lump-sum transfers is a mean-preserving reduction
in the distribution of real balances. In this regime social welfare is measured by
                                      Z                                                   Z
                             W=           [ h(z) + U (z)] dF (z) =                 h+         U (z)dF (z):

Given the strict concavity of U (y) money growth leads to an increase in welfare.
    Part (iii): Large in‡ation. From (37), as                            ! 1, z ? ! 0, M ! 0, H ! 0, and W ! 0.



    PROOF OF PROPOSITION 11.
    The proof is structured as follows. Given a policy, ( ; ), we conjecture that households behave
as follows: y(z) = z for all z 2 [0; z0? ]; h(z) = h for all z < z0? , and h(z0? ) = 0. We also assume that
parameters are such that h + (z)                  z > 0 for all z 2 [0; z0? ). Given this conjecture we will show
that: (i) Aggregate real balances under                     are larger than under laissez faire (              0   =   1   =   z   = 0).
(ii) Welfare under          is larger than under laissez-faire. The second part of the proof will consist in
checking that: (iii) For             small enough, there is a transfer scheme, , of the form described in (43),
that balances the government budget; (iv) Households’conjectured behavior is optimal.
    Guessing that the equilibrium features full depletion, and keeping in mind that (z0? ) = z0? by
construction, the government budget constraint under the transfer scheme, , is:
                        Z                               Z   T (z0? ; )
                                                                                                     t
                            [ (z)         z] dF (z) =                    f [z(t)]        z(t)g e         dt = 0;                    (71)
                                                        0




                                                                   54
where T (z0? ; ) is the time to accumulate z0? under the transfer scheme                                                                       and z(t) is the solution to

                                                         z_ = h + (z)                                z for all z < z0? :                                                    (72)

                                                                = 0 if z = z0? :
                 R
We denote Z        [1 F (z)] dz the aggregate real balances under the transfer scheme, , and Z0
R
  [1 F0 (z)] dz the aggregate real balances under laissez faire. Moreover, denote T   T (z0? ; ) and
T0 = T (z0? ; 0) under laissez-faire.
    RESULT #1: T > T0 and Z > Z0 :
PROOF: By construction the transfer scheme in (43) is such that there is a level of real balances,
zt^, with t^ 2 (0; T ), below which the net transfer to the household is positive, since                                                                         0   > 0, and
above which the net transfer is negative, since from (71) the sum of those transfers must be 0:

                                                           (zt )        zt > 0 for all t 2 0; t^

                                                           (zt )        zt < 0 for all t 2 t^; T                                   :

Dividing the government budget constraint by e                                                         t^,   (71) becomes:
                        Z      t^                                        t              Z        T                                       t
                                                                    e                                                              e
                                    [ (zt )                 zt ]         ^
                                                                           dt +                        [ (zt )              zt ]              dt = 0:                       (73)
                                                                    e    t                                                         e     t^
                           0                                                                t^

Given t^, e    t=   e     t^   is decreasing in t, e                               t=       e          t^ >      1 for all t < t^ and e                 t=   e   t^ <   1 for all
t > t^. It follows that
                                        Z        t^                                t                         Z     t^
                                                                         e
                                                      [ (zt )       zt ]                dt >                            [ (zt )        zt ] dt                              (74)
                                                                         e         t^
                                             0                                                                0
                                Z            T                                     t                         Z     T
                                                                         e
                                                      [ (zt )       zt ]           ^
                                                                                     dt <                                [ (zt )        zt ] dt:                            (75)
                                                                         e         t
                                        t^                                                                    t^

From (73) and the two inequalities, (74)-(75),
                     Z T                                Z T
                                          e t
                          [ (zt )    zt ]      dt = 0 >     [ (zt )                                                                      zt ] dt:                           (76)
                      0                   e t^           0

From (72) and (76),
                               Z        T                                      Z        T
                                                 [ (zt )           zt ] dt =                     z_t         h dt = z0?                hT < 0;
                                    0                                              0

where we used that z0 = 0 and zT = z0? . So T > T0 = z0? =h. As a result the measure of households
holding their targeted real balances is

                                                                                                        z0? =h
                                                  1       F (z0? ) = e         T
                                                                                        <e                         =1         F0 (z0? ):

                                                                                        55
The law of motion for aggregate real balances is Z_ = F (z0? )h                                       Z . At a steady state, Z =
F (z0? )h= , which is larger than Z0 = F0 (z0? )h= under laissez faire.
   Social welfare is measured by the sum of utilities across households:
                                Z                                                Z
                       W =          [ h(z) + U (z)] dF (z) =                         [ z + U (z)] dF (z);                      (77)

                                                          R                  R
where the second equality is obtained by market clearing, h(z)dF (z) =         y(z)dF (z) =
 R                                Rz 0
   zdF (z). Using that U (z) z = 0 [U (x) 1] dx + U (0) (77) can be rewritten as
                                         Z Z
                           W =                    U 0 (x)       1 If0   x zg dxdF           (z) + U (0):                       (78)

Changing the order of integration,
               Z Z                                                      Z Z
                       0
                      U (x)     1 If0        x zg dxdF      (z) =                If0     x zg dF       (z) U 0 (x)     1 dx
                                                                        Z
                                                                  =         [1       F (z)] U 0 (x)          1 dx:             (79)

Plugging (79) into (78):
                                              Z
                                W =               [1     F (x)] U 0 (x)          1 dx + U (0):                                 (80)

   RESULT #2: Social welfare under                          is higher than welfare at the laissez-faire.
   PROOF: The welfare gain under                        relative to laissez faire is:
                                    Z                                                  Z
                                                            0
               W     W0 =               [1    F (x)] U (x)             1 dx                 [1       F0 (x)] U 0 (x)    1 dx
                                    Z
                           =            [F0 (x)        F (x)] U 0 (x)       1 dx:                                              (81)

Given our conjecture that the equilibrium features full depletion we have:

                                                                                             t
                                              F (z ;t ) = F0 (z0;t ) = 1             e           ;

where z   ;t   and z0;t denote the real balances of a household who received its last preference shock t
periods ago under the transfer scheme                    and under laissez-faire, respectively. Integrating the law
of motion of real balances, (72):

                              z0;t = ht for all t < z0? =h
                                          Z t
                              z ;t = ht +     [ (z ;x )    z                ;x ] dx        for all t      T :
                                                   0




                                                                  56
By de…nition of the transfer scheme,

                                                            (zt )             zt > 0 for all t 2 0; t^

                                                            (zt )             zt < 0 for all t 2 t^; T                               ;

                           RT
and, from (71),              0          [ (z   ;x )         z   ;x ] dx       < 0. It follows that there is a t~ 2 t^; T0 such that z0;t~ =
z   ;t~ =   zs . For all t 2 0; t~ , z0;t < z ;t . For all t 2 t~; T                                               and z0;t > z ;t . Equivalently, F (z) < F0 (z)
for all z < zs and F (z) > F0 (z) for all z > zs . From (81):
                 (Z                                       Z z?                                                                                                            )
                     zs                                       0
  W      W0 =           [F0 (x) F (x)] U 0 (x) 1 dx +           [F0 (x)                                                                   F (x)] U (x)  0
                                                                                                                                                                  1 dx : (82)
                                    0                                                                               z~


By the de…nition of zs and the fact that U 0 (z) is decreasing:

              [F0 (x)           F (x)] U 0 (x)                  1         > [F0 (x)                  F (x)] U 0 (~
                                                                                                                 x)                  1        for all x 2 (0; zs )

              [F0 (x)           F (x)] U 0 (x)                  1         > [F0 (x)                  F (x)] U 0 (~
                                                                                                                 x)                  1        for all x 2 (zs ; z0? ) :

Plugging these two inequalities into (82):
                                                                                                     Z       z0?
                                                                                   0
                                            W              W0                U (zs )            1                  [F0 (x)     F (x)] dx:                                      (83)
                                                                                                         0

We proved that
                                Z                          Z                                         Z                         Z
                                        zdF (z) =               [1         F (z)] dz                         zdF0 (z) =              [1        F0 (z)] dz:

             R z?
Hence,        0
                  0
                      [F0 (x)           F (x)] dx > 0. Moreover, U 0 (zs )                                         U 0 (z0? ) = 1 + r= . Hence, U 0 (^
                                                                                                                                                     z)                   1 > 0. It
follows from (83) that W > W0 .
        The transfer scheme, , is fully characterized by                                                       and       0   since        z   = ( z0?                 ?
                                                                                                                                                              0 ) = (z0    z ? ) and

    1   = ( z?                ?     ?
                         0 ) z0 = (z0            z ? ). We now establish that for a given in‡ation rate,                                                        , there exists a
lump-sum component,                         0,   that balances the government budget.
                                                                                                                                                  R
RESULT #3: For                            su¢ ciently small, there is a                                  0    2 (0; z ? ) such that                   [ (z)        z] dF (z) = 0
holds and z_t > 0 for all t 2 [0; T (z0? )).
PROOF: The government budget constraint, (71), can be re-expressed as
                                                                Z       T (z0? ;       0)
                                                  ( 0)                                      f [z(t)]               z(t)g e t dt = 0;
                                                                    0

        By direct integration of the ODE for real balances, (72), one obtains that both z(t) and T (z0? ;                                                                        0)

are continuous functions of                           0.   Since (z) is, by construction, continuous in z, we obtain that ( 0 )

                                                                                                57
is also continuous in                         0.   If  = 0, then from (43):
                                                            0
                                                             (
                                                                           z                                                  z z?
                                                   (z)   z=          z?                                              if                      :
                                                                  z ? z ? (z                                z0? )           z 2 (z ? ; z0? ]
                                                                                     0


Hence,             (zt )          zt < 0 for all t 2 (0; T (z0? )) and (0) < 0. If                                              0    = z ? , then from (43):

                                                                                            z?      z z?
                                                                         (z) =                 if
                                                                                            z     z 2 (z ? ; z0? ]

Consequently, [z(t)]                               z(t) > 0 for all t < T (z ? ) and                                      (zt )            zt = 0 for all t               T ? . Hence,
 ( z ? ) > 0. By the Intermediate Value Theorem there is                                                                         0   2 (0; z ? ) such that                 ( 0 ) = 0.
Finally, for the transfer scheme to be feasible, it must be that z_ > 0 for all z < z0? . This requires
h+           0         z ? > 0, since net transfers achieve their minimum at z = z ? . This condition will be
satis…ed for                 su¢ ciently small.
     Finally, we need to check that household’s conjectured behavior is optimal: households …nd it
optimal to supply h units of labor until they reach z0? and to deplete their money holdings in full
when a preference shock occurs. The ODE for the marginal value of money is:

                                                         (r + )           t   =          U 0 (zt )          t    +    t
                                                                                                                           0
                                                                                                                               (zt ) + _ t :                                         (84)

RESULT #4: For                                 and              0    su¢ ciently small the solution to (84) is such that:                                             t   > 1 for all
t<T ,              T    = 1, and              t         U 0 (z0? ) for all t 2 [0; T ].
PROOF: Integrating (84), we obtain that the marginal value of money solves:
                         Z     T (z ? )
                                              (r+ + )(s t)                                                                      (r+ + )[T (z ? ) t]
         t   =1+                          e                                   U 0 (zs )       U 0 (z ? ) ds + e                                            T (z ? )       1 ;        (85)
                           t

for all t              T ? , and
                                                    Z       T
                                                                         (r+ +            z )(s   t)                                            z
                                     t    =1+                        e                                 U 0 (zs )           U 0 (z0? ) +                   ds;                        (86)
                                                        t

                                                                                                                                       1
for all t               T (z ? ), where we used that                                 T      = 1 and T (z ? ) =                             ln 1         z ? =(h +     0)       . For all
t 2 (T ? ; T ), zt < z0? and hence U 0 (zt ) > U 0 (z0? ). Given that                                                                 z    >        it follows from (86) that

 t   > 1 for all t 2 (T ? ; T ). Similarly, for all t < T ? , zt < z ? and hence U 0 (zt ) > U 0 (z ? ). Given that

 T (z ? )        > 1, it follows from (85) that                                t   > 1 for all t                T (z ? ).
     For the second part of the Lemma we note that, when                                                                       =      0    = 0, we have that               t   < U 0 (z0? )
for all t 2 [0; T (z0? )]. Since                                    is continuous with respect to (t; ;                                    0)   and since T (z0? ) is …nite at
     =       = 0, we obtain by uniform continuity that                                                 t   < U 0 (z0? ) for ( ;              0)     su¢ ciently small.


                                                                                                  58
    Note that, by Result #3, the         0   balancing the government budget constraint is less than z ? ,
hence it goes to zero as      goes to zero. Hence, when                                  is su¢ ciently small, the solution to the
ODE (84) satis…es all the properties of Result #4. This allows us to construct a candidate value
function for all z 2 [0; z0? ]. Namely, we let (z)                    T (z) ,      where         t   is the solution to the ODE (84):
                                             Z   z
                     W (z)     W (0) +                (x) dx where rW (0)                            (0) h +   0   :
                                             0

Next, we construct a candidate value function for z                              z0? :
    RESULT #5: For            and    0   su¢ ciently small, there exists a continuously di¤ erentiable and
bounded function, W (z), and two absolutely continuous functions, V (z) and (z), such that: For
z   z0? , W (z), V (z) and   (z) are the functions constructed following Result #4 ; For z                                  z0? :
                                                                     Z   z
                                 W (z) = W (z0 ) +                                (x) dx                                             (87)
                                                                      z0
                                  V (z) =             max U (y) + W (z                      y)                                       (88)
                                                      y2[0;z]
                                                        0
                          (r + ) (z) = V (z)                      c 0 (z) almost everywhere                                          (89)

                                    (z) 2 [0; 1]:                                                                                    (90)



    Proof. We construct a solution to the problem (87)-(90) as follows. Suppose that we have
constructed a solution over some interval [z0? ; Z], where Z                               z0? . We …rst observe that:

                                                      r
                              U 0 (z0? ) = 1 +                  sup          (x) = sup                (x);                           (91)
                                                           x2[0;z0? ]                     x2[0;Z]

where the …rst equality and the …rst inequality follow from our construction of W (z) and (z) over
[0; z0? ], and the last equality follows because (z)                     1 for z 2 [z0? ; Z]. We now show how to extend
this solution over the interval [Z; Z + z0? ]. First, we let:

                                    V~ (z)             max U (y) + W (z                       y);                                    (92)
                                                     y2[z Z;z]


which is well de…ned for all z 2 [Z; Z + z0? ], given that we have constructed W (z) for all z                                      Z and
since z   y   Z by the choice of our constraint set. Note that, in principle, the function V~ (z) di¤ers
from V (z) because it imposes the constraint that y                          z       Z. Our goal is to show that, nevertheless,
V~ (z) = V (z). Precisely, if one extends (z) over [Z; Z + z0? ] using (89), and de…ne W (z) using (87),
then the household never …nds it optimal to choose y < z0? , implying that the additional constraint
we imposed to de…ne V~ (z) is not binding.

                                                                59
    We …rst establish that V~ (z) is absolutely continuous and V~ 0 (z)                               U 0 (z0? ). Consider …rst z 2
[Z; Z +z0? =2]. Given (91), it follows that the solution to (92) must be greater than z0? . By implication
since z     Z     z0? =2, the solution y to (92) must be greater than z                          Z + z0? =2. Given this observation
and after making the change of variable x = z                    y, we obtain that

                                          V~ (z)        max         U (z         x) + W (x):
                                                   x2[0;Z z0? =2]

The objective is continuously di¤erentiable with respect to z, and its partial derivative is U 0 (z x)
U 0 (z0? =2) given that z      Z +z0? =2 and x          Z z0? =2. Proceeding to the interval z 2 [Z +z0? =2; Z +z0? ],
we make the change of variable x = z y in (92) and obtain that V~ (z) = maxx2[0Z] U (z x)+W (x).
Again, the objective is continuously di¤erentiable with a partial derivative with respect to z equal to
U 0 (z    x)    U 0 (z0? =2), since z      Z + z0? =2 and x         Z. Hence, in both cases, given that the objective
has a bounded partial derivative with respect to z, we can apply Theorem 2 in Milgrom and Segal
(2002): V~ (z) is absolutely continuous and the envelope condition holds, i.e., V~ 0 (z) = U 0 [y(z)]
whenever this derivative exists. By condition (91), it follows that y(z)                                  z0? , hence V~ 0 (z)   U 0 (z0? ),
as claimed.
    Next, we construct a solution over [Z; Z + z0? ]. Given that the function V~ (z) constructed above
is absolutely continuous, we can integrate the ODE (89) with V~ 0 (z) and we obtain a candidate
solution:
                                                                        Z   z
                                                   r+                                       r+
                              ~ (z) = (Z)e          c
                                                        (z Z)
                                                                +               V~ 0 (x)e    c
                                                                                                  (z x)
                                                                                                          dx
                                                                    c   Z

Given that (Z)           1 and V~ 0 (x)        U 0 (z0? ) = 1 + r= , one sees after direct integration that ~ (z)
1    U 0 (z0? ) for all z 2 [Z; Z + z0? ]. Now let
                                                                        Z   z
                                               ~ (z) = W (Z) +
                                               W                                ~ (x) dx:
                                                                            Z

                                        ~ (z), (z) by ~ (z), and V (z) by V~ (z) over the interval
We now show that, if we extend W (z) by W
[Z; Z + z0? ], we obtain a solution of the problem (87)-(89) over [Z; Z + z0? ]: indeed, we have just
shown that ~ (z) = W
                   ~ 0 (z)              U 0 (z0? ) for all z 2 [Z; Z + z0? ], implying that the constraint y                      z      Z
we imposed in the de…nition of V~ (z) is not binding. That is:

                   V (z) = max U (y) + W (z               y) =       max          U (y) + W (z            y) = V~ (z):
                             y2[0;z]                             y2[z Z;Z]

Hence, we have extended the solution from [z0? ; Z] to [Z; Z + z0? ]. Notice that the argument does
not depend on Z: we can start with Z = z0? , and repeat this extension until we obtain a solution
de…ned over [z0? ; 1).

                                                                60
   Finally, we show that W (z) is bounded. By construction we have:
                                                                               Z   z
                                                r+                                                  r+
                                                        (z    z0? )                                      (x   z0? )
                          (z) =       (z0? )e    c                    +                V 0 (x)e      c                dx
                                                                           c     z0?
                                                    Z   z
                    W (z) = W (z0? ) +                        (y) dy:
                                                     z0?

Plugging the …rst equation into the second, keeping in mind that (z0? ) = 1, and changing the order
of integration we obtain:
                                                                                           Z   z          h                              i
                              c                      r+
                                                             (z z0? )                                                      r+
       W (z) = W (z0? ) +                1      e     c                    +                       V 0 (x) 1          e     c
                                                                                                                                (z x))
                                                                                                                                             dy
                             r+                                                  r+         z0?
                              c
                  W (z0? ) +           +                [V (z)          V (z0? )]
                             r+              r+
                       ?      c
                  W (z0 ) +            +                [W (z) + kU k                  W (z0? )] ;
                             r+              r+
                                                                      r+
                                                                               (z x)
where the …rst inequality follows because 1                     e      c                   1 for all x 2 [z0? ; z], and the second
inequality because W (z)      V (z)      W (z) + kU k. Rearranging and simplifying we obtain that

                                                                           c + kU k
                                        W (z)            W (z0 ) +                  ;
                                                                              r

establishing the claim.
RESULT #6: For            su¢ ciently small and                0    chosen, as in RESULT #3, to balance the govern-
ment budget constraint, the households conjectured behavior is optimal.
   Proof. Consider the candidate value function constructed in Result #4 and #5. By construc-
tion, W (z) is continuously di¤erentiable and it solves the HJB equation:

(r+ )W (z) =        max           minfc; cg + h                 h+             [U (y) + W (z             y)] + W 0 (z) [h           c + (z)       z] :
               c 0;0 h h;0 y z

Then, the optimality veri…cation argument of Section VII in the supplementary appendix establishes
that W (z) is equal to the maximum attainable utility of a households, and that the associated
decision rules are optimal.




                                                                   61
Appendix B: Numerical methods

Overview. In this section we provide a step-by-step numerical method to compute the stationary
equilibrium with standard packages, for example Matlab. A detailed discussion of the numerical
method is provided in the supplementary Appendix. To solve the system we need to start from
some initial values close to the solution. Step 1 suggests an e¢ cient method to compute initial
values of      0    and   : the solution to an economy with zero in‡ation and full depletion, which is close
to the equilibrium if the money growth rate is not very large but h is not very low. Given                                             0   and   ,
Step 2 (or 2’under linear preferences) computes the system of delay di¤erential equations (DDE),
which summarizes the household’s optimal actions. Step 3 and 4 (or 4’under linear preferences)
computes the Kolmogorov forward equation (KFE), which solves the stationary distribution. Step
5 solves     0     and    as …xed points.30
     Step 1a. Fix y (z) = z and           = 0. Solve the following values for initiation:

                                              ?                  ?
                                       h(         ) = c(             )
                                                                         1     r+
                                              z? =         U0                                        ?
                                                                                                             ;

                                              p =                    ?               ?       ;
                                                          h0 (           )    c0 (       )

where       is the negative eigenvalue of the Jacobian given by
                                     "                                                                                 #
                                                                                                                 1=2
                               r+           4 U 00 (z ? ) 0 ?
                          =             1                 h ( ) c0 (                                     ?
                                                                                                             )         1 :
                                 2           (r + )2

                                                    ?                    ?                       ?                            1   r+
Under linear preferences, we have h (                   ) = c(               ) = 0,                  = 1, z ? = (U 0 )                 and p =

r+   U 00 (z ? ).
     Step 1b. Use ode45 routine of Matlab to integrate the following ODE of                                                  (z) backward from
z = z ? to z = 0:
                                              0           (r + )                  U 0 (z)
                                                  (z) =                                   ;
                                                             h( )               c( )
                                                                 ?              0
where the initial values are given by              (z ? ) =          and            (z ? ) = p.
     Step 1c. Having obtained             (z), use ode45 routine to integrate the following ODE of f (z)


   30
      The common approach in the literature is to use an "upwind" …nite-di¤erences algorithm to iterate a system
of PDEs composed of HJB and KFE. Instead, the equilibrium of our model de…ned as a system of DDEs can be
solved e¢ ciently with built-in Matlab routines with good control of error. For example, a laptop equipped with Intel
i5 2.30GHz CPU and 8GM RAM takes 15 seconds to compute the calibrated model in Section 4.3, with an error
tolerance of 10 6 . A …nite-di¤erences algorithm takes 27 times longer to converge, with an error tolerance of 5 10 3 .


                                                                     62
forward from z = 0 to z = z ? :
                                                                           0
                                                                      +        (z) [h0 ( ) c0 ( )]
                                              f 0 (z) =                                            f (z)
                                                                               h( ) c( )
where the initial value is given by f (0) = 1. If s z ?                                                 > 0 (for example under the slack labor
equilibrium of LRW models) then we construct the probability mass 1                                                                    F z?               by the following
KFE boundary condition
                                                                                    s z? f z?
                                                       1     F z? =                                               :

It obtains f (z).
                                                                                                                                       R z?                     R z?
     Step 1d. The initial values of                 0   and              are set to            0    =       (0) and             =          0       zf (z) dz=    0     f (z) dz.
     Step 2a. Jump to Step 2’a if under linear preferences. Given                                                          0   and         (from Step 1 if it is the
…rst time to run the iteration), use ddesd routine to integrate the following DDE system of z ( )
and        ( )
                                                                 h( ) c( )           z+
                                                 z0 ( ) =                                 ;
                                                                   (r + + ) +         ( )
                                                   h                      i 1                                                                         1
                      0                                          1
                          ( ) = z 0 ( ) U 00            U0          [ ( )]    + I [ ( ) < 0] z0 [                                          ( )]           ;

where the initial values are given by z (                                 0)   = 0 and                  (         0)   = U 0 (0) (or some arbitrary large
value if U 0 (0) = 1). Stop integrating whenever h (                                                )       c(         )         z( ) +               = 0. Denote the
                              ?
stopping         and z as         (    0;     ) and z ? (        0;       ). It obtains z ( ) and                              ( ).
     Step 2b. De…ne
                                                                 1
                                  y (z)                U0                       z       1
                                                                                            (z) ;

                                        zd          z?       y (z ? ) ;
                                                                     1                              1
                                      s (z)         h        z           (z)        c          z        (z)             (z            ):

Jump to Step 3.
     Step 2’a. Given              0   and        (from Step 1 if it is the …rst time to run the iteration), use ddesd
routine to integrate the following DDE of y (z)
                     (
                        1 if z (U 0 ) 1 ( 0 ) ;
                 0
                y =     h                                                                               i     1
                          1 + U 00 (y) (r+ + h)U 0 (y)
                                                   (z                            y)+
                                                                                   U 0 [y(z y)]                    if z > (U 0 )           1
                                                                                                                                               (   0) ;

where the initial value is given by y (0) = 0. Stop integrating at either z = (h +                                                                   ) = or U 0 [y (z)] =
      r+
1+          . It obtains y (z). Denote the stopping z as z ? (                                      0;        ). De…ne

                                                                 zd                 z?        y (z ? ) ;

                                                            s (z)                   h          z+ :

                                                                                 63
    Step 2’b. Use ode45 routine to integrate the following ODE of                                               (z) forward from z = 0 to z ? :

                                                0           (r +      + ) (z)                U 0 [y (z)]
                                                    (z) =                                                ;
                                                                       h  (z                 )
                                                                                                   ?
with the initial condition                   (0) =    0.    It obtains        (z). De…ne               (   0;   )=        (z ? ).
    Step 3. De…ne ' (z) as the solution to '                              y (') = z. Consider the region [zd ; z ? ], where the
density function f (z) is simply an ODE solution of the following KFE:

                                                             + s0 (z)
                                        f 0 (z) =                     f (z) ; for all z 2 (zd ; z ? ) ;
                                                             s (z)

which has closed-form solution
                                                                          1
                                                            s (z)
                                              f (z) =                         ; for all z 2 (zd ; z ? )
                                                            s (zd )

under linear preferences (and we need to construct the probability mass 1                                                  F z?     by the same
KFE boundary condition in the Step 1c). Otherwise, use ode45 routine to solve f (t) forward from
z = zd to z = z ? with initial value f (zd ) = 1. It obtains f (z) for all z 2 [zd ; z ? ].
    Step 4. Jump to Step 4’ if under linear preferences. Construct the "history" of                                                     (t) for all
t 2 [ (z ?        zd ) ; 0], by setting             (t) = f (zd       t), where f (z) is given by Step 3. Use ddesd routine
to integrate the following DDE of                       (t) forward from t = 0 to t = zd :

             0                   s0 (zd t)                       s [' (zd t)]
                 (t) =                                (t)                     [zd                  ' (zd        t)] ; for all t 2 (0; zd )
                               s (zd t)                           s (zd t)2

where the initial value               (0) is given by

                                                                          s z?
                                                            (0) = 1               f z? :
                                                                          s (zd )

Having obtained               (t), set f (z) =          (zd     z) for all z 2 [0; zd ). Jump to Step 5.
    Step 4’. Under linear preferences, use ode45 routine to integrate the following DDE of                                                     (t)
forward from t = 0 to t = zd :

                                         +                                     s [' (zd t)]
                         0
                             (t) =                   (t)       s (zd )1                     ; for all t 2 [0; zd ] ;
                                     s (zd     t)                                 s (zd t)2

where the initial value               (0) is given by
                                                                          "              #
                                                                               s z?
                                                              (0) = 1                          :
                                                                               s (zd )

Having obtained               (t), set f (z) =          (zd     z) for all z 2 [0; zd ).


                                                                          64
     Step 5. De…ne a function                          (    0;    ) : R2+ ! R2 , where the …rst and second coordinates are
given by

                                            (1)
                                                  (  ) = (r + + ) ? + U 0 [y (z ? )] ;
                                                      0;
                                                           R z?
                                            (2)                    zf (z) dz
                                                ( 0; ) =    R0 z ?           ;
                                                              0 f (z) dz
                ?
where               , z ? , y and f are constructed given               0   and         from previous steps. Use fsolve routine to
            ?               ?                     ?        ?)
solve       0   and             such that    (    0;            = 0.
     Step 6. Finally, the stationary equilibrium is given by the marginal value function W 0 (z) =
    1 (z;       ?      ?)                                               ?        ? ).
z               0;          and the density function f (z;              0;              Agents accumulate real balances according
                         ?      ? ),                                                                 ?    ? ).
to z_ = s (z;            0;            and the lumpy consumption is given by y (z;                   0;          The above numerical
algorithm works whether the equilibrium features periodic full money depletion or periodic partial
money depletion.




                                                                            65
