                                  NBER WORKING PAPER SERIES




                A NEW FRAMEWORK FOR THE ANALYSIS OF INEQUALITY

                                              Flavio Cunha
                                             James Heckman

                                          Working Paper 12505
                                  http://www.nber.org/papers/w12505


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      August 2006




This research was supported by NIH R01-HD32058-3, NSF SES-024158, and a grant from the American Bar
Foundation. A website for supplementary material is available at http://jenni.uchicago.edu/frame-ineq. The
views expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.

©2006 by Flavio Cunha and James Heckman. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is given
to the source.
A New Framework for the Analysis of Inequality
Flavio Cunha and James Heckman
NBER Working Paper No. 12505
August 2006
JEL No. D80, I30

                                          ABSTRACT


This paper presents a new framework for analyzing inequality that moves beyond the anonymity
postulate. We estimate the determinants of sectoral choice and the joint distributions of outcomes
across sectors. We determine which components of realized earnings variability are due to
uncertainty and which components are due to components of human diversity that are forcastable
by agents. Using our tools, we can determine how policies shift persons across sectors and outcome
distributions across sectors.

Flavio Cunha
The University of Chicago
flavio@uchicago.edu

James J. Heckman
Department of Economics
The University of Chicago
1126 E. 59th Street
Chicago, IL 60637
and NBER
jjh@uchicago.edu
1         Introduction

Most studies of income inequality and social mobility are descriptive in nature. Studies of inequality
compare differences in the location in the overall distribution of income among groups at a point in time

and over time and the evolution of income distributions within groups over time. Studies of mobility
measure movements of income within lifetimes or across generations.1 These exercises present factual

summaries of income inequality and income mobility.
        For the purposes of policy analysis, and for interpreting facts within a scientific model, it is necessary to

move beyond factual description to construct counterfactuals. They can be used to determine what would
happen to mobility or inequality if different policies or interventions were tried than the policies historically
observed. They can also be used to decompose observed inequality and mobility into components due to

genuine uncertainty (“luck” as described by Jencks, Smith, Acland, Bane, Cohen, Gintis, Heyns, and
Michelson, 1972) and components of heterogeneity and individual differences that are predictable, at least

by a certain age or stage of the life cycle.
        This paper describes recent methodological advances that enable analysts to construct counterfactual
distributions and separate heterogeneity (predictable variability across persons) from uncertainty. 2 In gen-

eral, the welfare consequences of predictable heterogeneity and unpredictable uncertainty are not the same.
Using the tools reviewed here, analysts can determine how much inequality and mobility is forecastable at

a given age and how much is due to unforecastable luck.
        These methods allow analysts to move beyond aggregate summary measures of inequality that are

based on the anonymity postulate to determine which groups in an initial distribution are affected by a
policy change and how they are affected. The anonymity postulate treats two aggregate distributions as
equally good if, after income is redistributed among persons, the overall distribution is the same. With our

methods we can determine, for reforms that are contemplated but have never been implemented, which
groups in an initial position benefit or lose, how much they lose, how they would vote in advance of a

reform and how they would vote after it is implemented, once the ex ante uncertainty surrounding the
outcomes of the reform is resolved.
    1
   See Fields (2003) for a comparison of inequality and mobility measures.
    2
   We draw on results reported in Aakvik, Heckman, and Vytlacil (1999, 2005); Carneiro, Hansen, and Heckman (2003);
Cunha, Heckman, and Navarro (2005); Heckman (1992); Heckman, Smith, and Clements (1997), and Heckman, Lochner, and
Todd (2006).


                                                            1
    We can move beyond aggregate summary measures of policy outcomes to gauge the effects of a policy

on subgroups defined by unobserved potential outcomes within the overall population distribution. Thus
we can move beyond traditional inequality and social mobility analyses to consider how a policy shifts
persons from a position in one potential outcome distribution to another even though joint potential out-

come distributions cannot be directly measured, but must be derived from marginal outcome distributions
for program participants and nonparticipants. Conventional studies of inequality consider movements of

persons among observed (measured) states (see, e.g., Ravallion, 2003).
    The plan of the rest of the paper is as follows. In section 2, we present a choice-theoretic framework for

constructing counterfactuals and we consider limitations of our approach. Section 3 presents our method
for constructing distributions of counterfactuals based on factor models, extending methods developed by
Jöreskog and Goldberger (1975) and Jöreskog (1977) to consider the construction of counterfactuals. We

illustrate results on identification derived in a number of previous papers by focusing on a simple parametric
version of the model. Section 4 shows how we can use information about choices and subsequent realizations

to infer how much agents know about future earnings when making their choices about college. This section
reviews a method for estimating “luck” and separating it from predictable heterogeneity that is developed
in Carneiro, Hansen, and Heckman (2003) and Cunha, Heckman, and Navarro (2005). Section 6 concludes.



2     The Evaluation of Social Programs: Choices Within Policy

      States and Comparisons Across Policy States

Social programs such as job training and college tuition subsidies are central features of the modern welfare
state. Because different parties may gain or lose from such programs, there is a demand for knowledge about

the redistributive effects of government policies. The central problem in the literature on the evaluation
of social policies is the construction of counterfactuals.

    In the simplest form of the evaluation problem, there are two possible choices: agents may receive a
treatment or not. We denote by S = 1 the agents who receive the treatment and by S = 0 those who

don’t. To fix ideas, consider the case in which S = 0 denotes a worker who chooses to be a high school
graduate, and S = 1 a worker who chooses to be a college graduate. The treatment is college education.



                                                       2
   Associated with each level of education is a potential outcome. Let (Y0 , Y1 ) denote potential outcomes

in schooling level S = 0 and S = 1, respectively. The outcomes Y0 and Y1 can be expressed in monetary
or utility units, but in the discussion that follows we shall think of the rewards as earnings in each sector
expressed in dollars. Each person has a (Y0 , Y1 ) pair. The gain for an individual who moves from S = 0 to

S = 1 is ∆, where ∆ ≡ Y1 − Y0 .
   If Y1 and Y0 could be observed for each individual at the same time, the gain ∆ would be known for each

person. An evaluation problem arises because we do not observe the pair (Y0 , Y1 ) for anybody. This is a
missing data problem: in calculating the gains to attending college for a particular individual who chooses

to be a college graduate, we observe her college earnings (Y1 ), but not her high school earnings (Y0 ). We
can solve this missing data problem by constructing counterfactuals: how much a college graduate would
earn if she had chosen to be a high school graduate. To identify these counterfactuals, different approaches

in the literature of program evaluation make different assumptions about how the missing data are related
to the available data, and what data are available.

   One possible approach is to model the decision making of the individuals. The choices made by
agents depend on their perception of outcomes Y0 and Y1 . The choices may also be influenced by the costs
associated with schooling, C. These costs C may arise because of pecuniary (e.g., tuition), or nonpecuniary

reasons (e.g, heterogeneity in preferences for schooling), but if we assume that costs C can be expressed
in monetary units, it is straightforward to define the net utility I as:


                                              I = Y1 − Y0 − C                                             (1)


If agents maximize their utility index I, they attend college if, and only if, they gain from it. This is
represented by the following decision rule:


                                     S = 1 if I ≥ 0; S = 0 otherwise.                                     (2)


It is possible to consider alternative decision rules by embedding this model into a dynamic environment,

analyzing different credit market structures, uncertainty, risk aversion, and so on. (See e.g. Heckman and
Navarro, 2006). However, for expositional ease we focus on the simple decision rule generated by (1) and



                                                      3
(2) since it is sufficiently rich to serve our purposes.3

       Assume that (Y0 , Y1 ) have finite means and can be expressed in terms of explanatory variables X in
the following manner:
                                                    Y0 = Xβ0 + U0 ,                                                   (3)

                                                    Y1 = Xβ1 + U1 ,                                                   (4)

where E (Y0 | X) = µ0 (X), E (Y1 | X) = µ1 (X) and E (U0 | X) = E (U1 | X) = 0.
       Further, assume that costs C can be expressed in terms of explanatory variables Z and unobservables

UC :
                                                    C = Zγ + UC .                                                     (5)

       The model described by equations (1), (2), (3), (4), and (5) is the Generalized Roy model. If costs are

identically zero for all agents, so that C = µC (Z) = UC = 0, equations (1), (2), (3), and (4) describe the
simple Roy model as developed in Roy (1951).

       Traditionally, the literature on program evaluation has focused on estimating mean impacts of S and
not distributions. The most commonly studied parameter in the literature is the average treatment effect:


                                     ATE (X) = E (∆| X) = E ( Y1 − Y0 | X) .                                          (6)


Another popular parameter is the effect of treatment on the treated,


                            TT (X, Z) = E (∆ | X, S = 1) = E (Y1 − Y0 | X, S = 1) .                                   (7)


       The evaluation of policies has traditionally focused on such mean effects. Nevertheless, the gains ∆

are heterogenous across agents even after one controls for X. As a result, mean gains are not necessarily
the most interesting parameter to be estimated. Consider an example from the economics of education:

we want to evaluate a policy that reduces tuition by one thousand dollars. The marginal cost of such a
policy is, therefore, constant. If gains are heterogenous across people, we need to know (a) how many
   3
    See Heckman (2001) for a survey of this literature. These models for counterfactuals and potential outcomes are called
Roy (1951) or Generalized Roy models and have an ancient lineage in econometrics. The decision-maker may be a parent,
and the outcomes may be for a child.



                                                            4
entrants into education will be induced by the tuition policy, and (b) from where in the distribution of

gains to schooling (∆) the new entrants are coming. In this example, it would be optimal to keep offering
tuition reductions up to the point that the marginal gain is equal to the marginal cost. If we compute
(b), we can monitor the marginal gain as we vary the size of the policy. If we can compute (a) and (b),

we can calculate the aggregate gains from the tuition policy. Consequently, if the gains ∆ vary across
agents, no single number summarizes the distribution of gains for all purposes of policy evaluation. For

each specific policy question we want to address, we must carefully define the parameter of interest (see
Heckman and Vytlacil, 2005, 2007a,b). In general, the average gain of those who are in the program is

not the relevant parameter of interest. For other problems of distributional analysis, it is of interest to
determine where in an initial distribution beneficiaries come from and where they end up in the treatment
outcome distribution.

      If we want to recognize the fact the gains are heterogenous across people we raise an econometric
difficulty. Once we have defined the parameter of interest, say the gain to the marginal entrant, how

can we estimate it? If we wish to avoid special assumptions like statistical independence between Y 0 and
Y1 or perfect dependence, the solution is to recover the joint distribution of (Y 0 , Y1 ) . Once we know this
distribution, it is possible to calculate the distribution of (Y1 − Y0 ) for any group of people we are interested

in and obtain its median or any other quantile.
      In this paper, we report on recent research that solves the problem of constructing counterfactuals

by identifying the joint distribution of (Y1 , Y0 ) and the potential outcomes under some policy regime,
conditional on S (or I), using a factor structure model. These models generalize the LISREL models

of Jöreskog (1977) and the MIMIC model of Jöreskog and Goldberger (1975) to produce counterfactual
distributions.
      It is fruitful to distinguish between two kinds of policies: (a) those that affect potential outcomes

    Y0A , Y1A for outcomes and costs C A under policy regime A through price and quality effects and
¡            ¢                         ¡ ¢

(b) those that affect sectorial choices (through C A ), but do not affect potential outcomes. Tuition and

educational access policies that do not produce general equilibrium effects fall into the second category of
policy. It is the second kind of policy that receives the most attention in empirical work on the economics

of education, either when estimating gains to schooling under a policy regime Y0A , Y1A (see, e.g., Card,
                                                                                  ¡       ¢




                                                        5
1999) or evaluating schooling policies (e.g., Kane, 1994).4

   Consider two general policy environments denoted A and B. These policies might affect the costs of
schooling including access to it. In the general case, we could have Y0A , Y1A , C A and Y0B , Y1B , C B for
                                                                    ¡               ¢   ¡               ¢

each person. There might be general equilibrium policies or policies that operate in the presence of social

interactions that affect both costs and outcomes.5
      A special case of this policy produces two social states for outcomes that we wish to compare. However,

in this special case, interventions have no effect on potential outcomes and can be described as producing
two choice sets Y0 , Y1 , C A and Y0 , Y1 , C B for each person. They affect costs and the choice of outcomes,
                 ¡           ¢    ¡            ¢

but not the potential outcomes as a full-fledged general equilibrium or social interaction analysis would
do. We focus most of our attention on policies that keep potential schooling outcomes unchanged but that
vary C in selecting who takes schooling.

   This paper analyzes two sets of counterfactuals: (a) Y0A , Y1A within policy regime A and (Y0B , Y1B )
                                                       ¡         ¢

within policy regime B, and (b) aggregate income across policy regimes Y A , Y B where Y A = Y1A S A +
                                                                        ¡        ¢

Y0A (1 − S A ) is the observed income under regime A and Y B = Y1B S B + Y0B (1 − S B ) is the income under
regime B, where S A = 1 if a person chose S = 1 under regime A and S B is defined in an analogous fashion.
The tradition in the analysis of income inequality is to make comparisons across regimes i.e., to compare

the distribution of Y A = Y1A S A + Y0A (1 − S A ) with the distribution of Y B = Y1B S B + Y0B (1 − S B ). When
both A and B are observed, such comparisons are straightforward if there are panel data on incomes of

the same persons in both states.
      With our methods, we can construct counterfactual distributions of Y0A , Y1A and (Y0B , Y1B ) within
                                                                        ¡         ¢

each policy regime and can also construct comparisons across policy states based on Y1A S A + Y0A (1 − S A )
and Y1B S B + Y0B (1 − S B ). We can also compare movements from Y0A to Y1B as well as other comparisons
whether or not A and B are observed. This allows us to obtain a much richer understanding of the

inequality and social mobility consequences of policy change than are available from inequality measures
based on the anonymity axiom, and allows us to go more deeply than panel data analyses that compare

movements from the distribution of Y A to the distribution of Y B . We can use our analysis to generate
counterfactual states, never measured. We now present our methodology.
  4
     Heckman, Lochner, and Taber (1998b,c, 1999) develop general equilibrium policy analysis computing distributional
consequences of alternative policies. See also Bourguignon and da Silva (2003).
   5
     Thus a large scale expansion of the educational system may depress the returns to schooling.


                                                         6
3       Identifying counterfactual distributions using factor models

The Roy model (1951) postulates that individuals choose the option that gives them the highest outcome.
There are no costs associated with receipt or nonreceipt of treatment. The nonparametric identification of

the joint distribution of outcomes is established in Heckman and Honoré (1990). Consider, for example,
the case in which the error terms U0 , U1 are normally distributed. In this case sectoral outcomes are


                                             Ys = Xβs + Us ,         s = 0, 1.                             (8)


Under normality:
                          ¯                                             
                             ¯
                       Y0  ¯       Xβ0   V ar (U0 )      Cov (U0 , U1 ) 
                             ¯
                          ¯ X ∼ N       ,                               
                        Y1 ¯¯           Xβ1     Cov (U0 , U1 )  V ar (U1 )


We observe Y0 or Y1 for each person but not the pair (Y0 , Y1 ). The trick is to show that one can identify
Cov (Y0 , Y1 ). If we observe I in equation (1) where C = 0, then we could compute the Cov (Y1 , I) and,

consequently, identify Cov (Y0 , Y1 ) because from the definition of I and a property of covariances it follows
that:

                          Cov (Y1 , I) = Cov (Y1 , Y1 − Y0 ) = V ar (Y1 ) − Cov (Y1 , Y0 ) .               (9)

Obviously, we don’t observe I directly, but we do observe choices, and we know that S = 1 ⇔ I ≥ 0 and
have I up to scale σY1 −Y0 = [V ar (Y1 − Y0 )]1/2 . Thus we can obtain the left hand sides of

                                   ·                ¸
                                       Cov (Y1 , I)     V ar (Y1 ) Cov (Y1 , Y0 )
                                                      =           −
                                        σY1 −Y0          σY1 −Y0     σY1 −Y0

and
                                   ·                ¸
                                       Cov (Y0 , I)     V ar (Y0 ) Cov (Y1 , Y0 )
                                                      =           −               .
                                        σY1 −Y0          σY1 −Y0     σY1 −Y0

Since we can obtain V ar (Y1 ) and V ar (Y0 ), subtracting the second term from the first term we obtain

                                                        V ar (Y1 ) − V ar (Y0 )
                                          σY1 −Y0 = h           i h              i
                                                        Cov(Y1 ,I)    Cov(Y0 ,I)
                                                         σY1 −Y0
                                                                   − σY −Y
                                                                          1   0




                                                              7
                Cov(Y1 ,I)        Cov(Y0 ,I)
assuming that    σY1 −Y0
                             6=    σY1 −Y0
                                             .   Hence we can identify Cov (Y1 , Y0 ) and σy1 −y0 .

   The Roy model makes two strong assumptions. First, agents can choose sectors without incurring any
costs. In a schooling model it is natural to allow for both pecuniary costs (such as tuition) as well as
nonpecuniary costs (e.g., differences in preferences for education). Second, the model does not allow for

uncertainty in future rewards. In the schooling model example, agents are assumed to keep working in
the same sector for many periods. They are assumed to have full information on the future evolution of

demand and supply of skills at the time they are making their educational decisions. Below we will show
how we can extend the simple Roy model to allow for uncertainty and costs, and how we can generate

restrictions to test and identify the information set of the agent at the time he makes sectoral choices.


   The Generalized Roy model We introduce extensions of the Roy model one step at a time. We
start by introducing participation costs, but postpone our discussion of uncertainty to the next section.

Let C denote the cost of participation in sector “1”. We may not observe C directly, because it may
be partially determined by heterogeneity in agent preferences. This is the Generalized Roy model which
was developed by Heckman (1976) and used by Willis and Rosen (1979). Allowing for direct costs for

participation in sector “1” affects the identification of the joint distribution of rewards. As shown by
Heckman and Honoré (1990), given data on X, Z,S and Y = SY1 + (1 − S) Y0 , one cannot recover the joint

distribution F (Y0 , Y1 ) . The problem is that if costs are not observed, choices alone do not provide enough
information to identify the covariance between outcomes Y0 and Y1 . We can immediately see why if we

consider the case in which I is observed. In the generalized Roy model, I = Y1 − Y0 − C. Consequently:


                                   Cov (Y1 , Y0 ) + Cov (Y1 , C) = Cov (I, Y1 ) − V ar (Y1 )             (10)


We have two unknowns in one equation. If we use the information on Cov (I, Y0 ) it is still not enough to

identify the model because we pick up a new term: Cov (Y0 , C). The problem worsens when we account for
the fact that I is observed only up to scale. As a result, without further assumptions, the Generalized Roy
model is underidentified. Before presenting these assumptions, we embed the Roy model in an uncertain

environment.




                                                                   8
      The Generalized Roy model in an Uncertain Economy We now introduce uncertainty in the

generalized Roy model. We still assume a one-period economy in which agents are uncertain about the
rewards at the time they are making their choices. The timing in this economy is as follows: At the
beginning of the period, agents have an information set I, whose elements may be unobserved by the

analyst although they are known by the individual. Given this information set, agents make the decision
about working in sector “0” or “1”. After the decision is made, all uncertainty is revealed and agents

observe their earnings. In this economy with uncertainty we rewrite the index I as:


                                          I = E ( Y1 − Y0 − C| I) .


The decision rule becomes:

                                     S = 1 if I ≥ 0; S = 0 otherwise.                                    (11)

The decision rule (11) states the agents choose sector 1 if, and only if, the expected net gains are positive.
We are assuming linear utility, implying that agents are risk neutral. More general models with respect to

risk aversion can be identified (see the discussion in Cunha, Heckman, and Navarro, 2005 and the review in
Heckman, Lochner, and Todd, 2006), but we focus on the case of linear utility for the sake of simplicity. If

we assume that X, Z, UC ∈ I we can rewrite the index I in terms of explanatory and unobserved variables
as:

                               I = X (β1 − β0 ) − Zγ + E ( U1 − U0 − UC | I) .

For the uncertain economy, the mean earnings for those who work in sector “1” is:


           E [Y1 | X, Z,I ≥ 0] = Xβ1 + E [U1 | X,Z,E (U1 − U0 − UC | I) ≥ −X (β1 − β0 ) + Zγ] .          (12)


To proceed further we need to put more structure on the problem. In particular, we need to separate two

distinct unobservable components. The first is the unobserved component (from the point of view of the
analyst) that is known and acted on by the individual. This is the component captured by the expectation

term E ( U1 − U0 − UC | I) . If this term changes, it will change the utility index I and expected earnings
at the same time. The second term is unobserved by the analyst and unknown by the individual. It is



                                                      9
captured by Us − E (Us | I) for s = 0, 1. It does not affect schooling choices, but it affects realized earnings

because we can always rewrite equation (8) as


                                      Ys = Xβs + E (Us | I) + {Us − E ( Us | I)}


From equation (12), there is selection on E (Us | I) but not on Us −E (Us | I). We name the first component

“heterogeneity” and the second “uncertainty”. The recent work of Carneiro, Hansen, and Heckman (2003)
and Cunha, Heckman, and Navarro (2005) develop models in which it is possible to identify and separate
heterogeneity from uncertainty.

       The key idea underlying their work is to impose a factor structure on the error terms of outcome and
choice equations. We decompose the unobservable error terms as:


                              U0 = α0 θ + ε0 , U1 = α1 θ + ε1 , and UC = αC θ + εC .


To fix ideas assume that the terms ε0 , ε1 and εC are independent normal random variables:
                                                                             
                                   ε0      0               σε20    0      0 
                                                                              
                                   ε  ∼ N  0  ,  0                σε21    0   .
                                                                                     
                                   1        
                                                                              
                                    εC         0       0                 0     σε2C


The error terms in outcomes, ε0 , ε1 , are a source of uncertainty in future outcomes, so we impose ε0 , ε1 ∈
                                                                                                            / I.
Because agents must face the direct costs of choosing sector S = 1 at the time of their choice, it is natural

to assume that agents know the realization of cost shocks at the time of choice S, so that ε C ∈ I.
       All of the dependence among U0 , U1 , and UC is captured through the factor θ. The factor θ is independent

from ε0 , ε1 , εC , X and Z. For simplicity, we assume that θ ∼ N (0, σθ2 ) , but this assumption can be relaxed6 .
Because of the loadings α0 , α1 and αC , the factor θ can affect U0 , U1 , and UC differently, so by adopting

the factor structure we are not imposing the sign of the covariance between U0 , U1 and UC . For example,
it is possible that α0 > 0 while α1 ≤ 0.
   6
    In this paper we use the normality assumption because it is familiar, easily exposited, and easy to grasp the sources
of identification. Carneiro, Hansen, and Heckman (2003) and Cunha, Heckman, and Navarro (2005) establish that the
distributions of ε0 , ε1 , εC and the factor θ can be nonparametrically identified.



                                                           10
         We do not need to assume θ ∈ I. We can test whether θ ∈ I or θ ∈
                                                                        / I under conditions we specify in

this paper. That is, we can test whether the agent knows (and acts on) information contained in θ that is
not observed by the analyst. Using this test we can decompose the residuals of outcome equations between
heterogeneity and luck (or uncertainty).

         When the Generalized Roy model in the uncertain economy is analyzed using the factor structure
proposed by Carneiro, Hansen, and Heckman (2003), the joint distribution of the rewards Y 0 , Y1 conditional

on X is:                                                                                          
                                                           2 2        2
                                 Y0           Xβ0   α0 σθ + σε0     α0 α1 σθ2 
                                     | X ∼ N       ,
                                                                                      .
                                                                    2     2 2       2
                                  Y1              Xβ1      α 0 α 1 σθ   α 1 σ θ + σ ε1

Therefore, in this simple normal linear formulation of Carneiro, Hansen, and Heckman (2003), identification

of the joint distribution F (Y0 , Y1 | X) reduces to the identification of the parameters β0 , β1 , α0 , α1 , σε20 , σε21
and σθ2 . From the observed data and the factor structure it follows that:


                                E (Y1 | X, S = 1) = Xβ1 + α1 E [ θ| X, S = 1] + E [ ε1 | X, S = 1]                                          (13)


which is equivalent to7 :
                                                                                          ³                    ´
                                                                                              X(β1 −β0 )−Zγ
                                                              (α1 − α0 −   αC ) σθ2   φ             ση
                              E (Y1 | X, S = 1) = Xβ1 + α1                                ³                    ´.                           (14)
                                                                     ση               Φ       X(β1 −β0 )−Zγ
                                                                                                    ση



It is easy to derive a similar expression for mean observed earnings in sector “0”:
                                                                                          ³                    ´
                                                                                              X(β1 −β0 )−Zγ
                                                            (α1 − α0 − αC ) σθ2 φ                   ση
                            E ( Y0 | X, S = 0) = Xβ0 − α0                           ³              ´.                                       (15)
                                                                   ση          1 − Φ X(β1 −β0 )−Zγ      ση


                                                                                                                         (α1 −α0 −αc )σθ2
We can apply the two-step procedure proposed in Heckman (1976) to identify β0 , β1 , α0                                        ση2
                                                                                                                                            and
     (α1 −α0 −αc )σθ2                                                                                               α1
α1         ση2
                      .   Taking the ratio of the last two terms allow us to identify the ratio                     α0
                                                                                                                       .In   factor analysis
     7
    For the complete derivation               see   the   ”Derivation   Appendix”         on      the        website     for    this    paper:
http://jenni.uchicago.edu/frame-ineq




                                                                11
we always need a normalization in the factor loadings to set the scale, so we normalize α 0 = 1.8 This
                                                   (α0 +αC −α1 )σθ2
normalization sets α1 and the term                       ση2
                                                                    .   It is not helpful to look at the information from the
variance of observed earnings to identify ση2 , αC and σθ2 separately. To see why, consider the variance of
observed earnings in sector “1”:


                                           V ar (Y1 | X,S = 1) = α12 V ar (θ | S = 1) + σε21 .


From the variance we acquire a new term that identify: σε21 . Because of this fact, when it comes to
identifying the parameters related to the factors (such as σθ2 and α0 s), we have to restrict ourselves to

information from the covariances, and not from the variances.
          If there are variables W that are elements of X but not of Z we can identify more parameters. To see

why, write:
                                           X (β1 − β0 ) = W β1W − β0W + Z β1Z − β0Z .
                                                           ¡         ¢   ¡         ¢


From equations (14) and (15) we can identify β1W , β0W ,β1Z and β0Z . From the probit coefficients we identify
β1W       β0W β1Z β0Z         γ
ση
      ,      , ,
          ση ση ση
                        and   ση
                                 .   Consequently, we can obtain ση from the choice equation by comparing β1W (from
             β1W
14) to       ση
                   (from the choice equation). If we know ση we can recover (α0 + αC − α1 ) σθ2 from the coefficient

on the final term of the right hand side of (14) and (15). We cannot proceed any further because we know
neither αC nor σθ2 . Note that knowledge of σθ2 is crucial for identification of the joint distribution F (Y0 , Y1 ) .

The entire dependence between Y0 and Y1 is through the factor θ.
          As just demonstrated, adding uncertainty and imposing the factor structure is not enough to guarantee
identification of the joint distribution of rewards F (Y0 , Y1 ) . However, there is something we can say about

the pattern of dependence between Y0 and Y1 . The covariance of Y0 and Y1 is:


                                                                                 α1 2 2
                                                  Cov (Y0 , Y1 ) = α0 α1 σθ2 =     α σ .                                 (16)
                                                                                 α0 0 θ
      8
          It is easy to see why. Suppose that
                                      ·    ¸       µ·      ¸ · 2 2                                  ¸¶
                                        Y0            Xβ 0    α0 σθ + σε20            α0 α1 σθ2
                                              |X∼N          ,                                            .
                                        Y1            Xβ 1     α0 α1 σθ2             α1 σθ + σε21
                                                                                      2 2


Then, if we define α̃0 = kα0 , σ̃θ = σkθ and α̃1 = kα1 , for some k > 0, the parameters α̃0 , α̃1 and σ̃θ generate the same
covariance matrix as the parameters α0 , α1 and σθ .




                                                                        12
We cannot directly compute this covariance, because we never observe the pair (Y0 , Y1 ) at the same time.
                                                                                                          α1
However, the factor structure implies that this covariance is given by the product of three terms         α0
                                                                                                             ,   α02 ,
                                                                           α1
and σθ2 . The terms α02 , and σθ2 are always nonnegative, while the term   α0
                                                                                is identified from equations (14)
and (15). Consequently, we know at least the sign of the covariance, so we are able to say, for example,

whether agents who choose to work in sector “0” would tend to have earnings above or below the mean in
sector “1”, if they had chosen to work in sector “1”.

   There are two other advantages of using factor models as shown here. First, they provide a flexible
structure for adding information that can help to identify the joint distribution of rewards F (Y 0 , Y1 ) .

Second, if we have observations on outcomes for more than one period, or if we have observations on more
than one outcome in one period, the factor model provides a parsimonious way to capture the dependence
across outcomes and between outcomes and choices. We now show how supplementing the basic model

just presented aids in identification.


   Cross-section data with one measurement equation Sometimes the analyst observes proxies
for unobserved variables that affect both selection into states as well as outcomes in each sector. These are
part of the source of the correlation between choices and outcomes. Because this correlation is captured

by the factor, these proxies are potentially informative about the distribution of the factors. We introduce
these proxies to obtain identification of our model. In the schooling example, it is reasonable to assume that

unobserved ability affects the decision of how much education to obtain. It is also reasonable to assume
that higher ability individuals will have higher earnings (even after controlling for the final education level)

because higher ability makes an individual more productive. Suppose, that we have a set of test scores M
for each person. Suppose that the measurement M is made for all agents regardless of whether S = 1 or
S = 0, so that we do not have to worry about selection issues in the measurement. If we impose a linear

specification we obtain:
                                          M = X M βM + α M θ + ε M                                           (17)

where XM are observable explanatory variables orthogonal to the factor θ that help predict the measure-

ment. The variables XM need not be the same as the explanatory variables X which predict outcomes
Y0 and Y1 . The disturbance εM is assumed to be normally distributed with E (εM ) = 0, V ar (εM ) = σε2M ,

independent from θ and XM .

                                                      13
   The measurement M is observed for everyone regardless of the schooling choice. Because we do not

have to worry about selection problems in the measurement M, and because of the independence between
XM , θ, and εM , we can identify βM from a simple OLS regression of (17). Above, we have already shown
that by applying the Heckman two-step procedure to equations (14) and (15) , we can identify β 1 and β0 .

The availability of the measurement M yields the computation of five more covariance equations:


                                 Cov (Y0 − Xβ0 , M − XM βM ) = α0 αM σθ2 ,                             (18)


                                 Cov (Y1 − Xβ1 , M − XM βM ) = α1 αM σθ2 ,                             (19)

                    Cov (I − Xβ1 + Xβ0 + Zγ, M − XM βM ) = (α1 − α0 − αC ) αM σθ2                      (20)

                      Cov (I − Xβ1 + Xβ0 + Zγ, Y0 − Xβ0 ) = (α1 − α0 − αC ) α0 σθ2 ,                   (21)

and

                      Cov (I − Xβ1 + Xβ0 + Zγ, Y1 − Xβ1 ) = (α1 − α0 − αC ) α1 σθ2                     (22)

Assume now that we make one normalization: αM = 1 instead of normalizing α0 = 1. By taking the ratio
of (22) to (20), we can identify α1 . Because αM = 1, we can use (19) to solve for σθ2 , which we use in

(18) to identify α0 . The last term to be identified is αC which we can recover from (20). Note that given
the normalization αM = 1 we have four parameters (α0 , α1 , αC , and σθ2 ) and five equations to identify

them. We never used equation (21) in our calculations above. Consequently, we can use this source of
overidentification to generate a test that can reject whether agents know the factors or not at the time the
sectoral choice is made, which we describe in detail in the next section.

   Also, note that the covariance between Y0 and Y1 can be identified, because we know each of the
terms in the right-hand side of (16) . Consequently, from a single cross-section on outcomes, choices and

a measurement equation, we can recover the joint distribution of Y0 and Y1 and use such knowledge to
answer counterfactual questions. We now show how access to panel data allows us to identify the model

even in the absence of a measurement.


   The observation of outcomes for two different periods The availability of a measurement M

guarantees identification by providing more information, i.e., more covariance equations which we can

                                                    14
use to solve for the factor loadings and the parameters that characterize the distribution of the factor.

However, researchers may not observe candidate proxies that could be used as measurements, but they
may observe, for example, outcomes for more than one period. To fix ideas, suppose that we observe
earnings for at least two periods, Yt = (1 − S) Y0,t + SY1,t and Yt+k = (1 − S) Y0,t+k + SY1,t+k for some

k 6= 0. For τ = t, t + k, let
                                                 Y0,τ = Xβ0,τ + θα0,τ + ε0,τ

                                                 Y1,τ = Xβ1,τ + θα1,τ + ε1,τ .

We assume that εs,τ are independently normally distributed random variables for s = 0, 1 and τ = t, t+k.We
can allow X to vary over time as well, but this would only complicate the notation without adding any

insight to our discussion of identification, so we will abstract from time variation for X. Assuming that
the interest rate r is zero, so that there is no discounting, the utility index is defined as


                                      I = E (Y1,t+k + Y1,t − Y0,t+k − Y0,t − C| I) .


If we maintain the assumption that εs,τ ∈
                                        / I for s = 0, 1 and τ = t, t + k the net utility index I is defined
as:

             I = X (β1,t+k + β1,t − β0,t+k − β0,t ) − Zγ + (α1,t+k + α1,t − α0,t+k − α0,t − αC ) θ − εC .

It is easy to show that mean observed earnings for periods τ = t, t + k can be expressed as9 :
                                                                               ³               ´
                                                                                   µ̃I (X,Z)
                                                                           φ           σϕ
                                    E ( Y0,τ | S = 0) = Xβ0,τ − π0,τ                ³               ´
                                                                                        µ̃I (X,Z)
                                                                        1−Φ                 σϕ


                                                                               ³               ´
                                                                                   µ̃I (X,Z)
                                                                          φ            σϕ
                                      E ( Y1,τ | S = 1) = Xβ1,τ + π1,τ         ³               ´.
                                                                                   µ̃I (X,Z)
                                                                          Φ            σϕ

where:
                                                 (α1,t+k + α1,t − α0,t+k − α0,t − αC ) σθ2
                                   πs,τ = αs,τ                                             .
                                                                   σϕ
  9
      See the “Derivation Appendix” on the website for details. http://jenni.uchicago.edu/frame-ineq.




                                                               15
Again, for each time period τ we can apply Heckman (1976) two-step procedure and obtain consistent

estimators of βs,τ and πs,τ , s = 0, 1; τ = t, t + k. Assume we normalize α0,t = 1. If we compute the ratio
πs,τ
π0,t
        we can identify αs,τ for s = 0, 1 and τ = t, t + k.We can identify the factor variance σθ2 from the
covariance:

                                Cov (Y1,t+k − Xβ1,t+k , Y1,t − Xβ1,t ) = α1,t α1,t+k σθ2 .

       At this point, it remains to show identification of αC and σε2C . We have already discussed identification
of σε2C and concluded that we can recover it as long as we have variables W that are part of the vector X

but not part of the vector Z. If this is not the case, then we must normalize σε2C = 1. In either case, we
can then recover αC from π0,t since:

                                           (α1,t+k + α1,t − α0,t+k − α0,t − αC ) σθ2
                              π0,t =
                                       σ (α1,t+k + α1,t − α0,t+k − α0,t − αC )2 σθ2 + σε2C

and the only unknown in this equation is αC .
       It is interesting to remark that the covariance across counterfactuals:


                                             Cov (Y0,τ , Y1,τ 0 ) = α0,τ α1,τ 0 σθ2


can be computed since all of the elements on the right-hand side have been determined. Note that again

we have one more equation than unknown, and we can use the overidentification to test whether θ ∈ I or
not.


       Multiple Measurements and Panel data on outcomes Some lucky researchers may observe

many measurements and may have the availability of panel data on outcomes. In this case, it is possible
to identify models with more than one factor. Consider, for example, the empirical analysis of Carneiro,
Hansen, and Heckman (2003). In their study, they have a two-sector model (high school and college labor).

They observe a set of test scores M1 , ..., MK . They model test score k, k = 1, 2, ..., K as:


                                                        k        k
                                             Mk = X M β M + θ 1 αM + εkM .




                                                              16
                1
They normalize αM = 1. They model (log) earnings Ys,t as:


                                     Ys,t = Xβs,t + θ1 αs,t + θ2 δs,t + εs,t .


They normalize δ1,1 = 1. Recall that one normalization is needed to set the scale of the factor. Let C
denote the costs of choosing college. They model costs C as:


                                         C = Zγ + θ1 αC + θ2 δC + εC .


Agents choose college if, and only if:

                                           "   T
                                                                      ¯ #
                                               X (Y1,t − Y0,t )       ¯
                                    I=E                           − C ¯ I ≥ 0.
                                                                      ¯
                                               t=1
                                                     (1 + r)t         ¯


    Note that Carneiro, Hansen, and Heckman (2003) estimate a two-factor model. Because the test scores
only depend on the first factor, they can use the test scores to identify the distribution of θ 1 . They use the
earnings and choice equations to identify the distribution of factor θ2 . We increase the number of factors

that can be identified if the length of the panel increases, or if we have measurements associated with
other characteristics that affect both choices and earnings. For example, Cunha, Heckman, and Navarro

(2005) identify a model with three factors because they have a set of measurements and earnings for five
periods. For the general treatment about the limitation on the number of factors we refer the reader to

Carneiro, Hansen, and Heckman (2003). They also present an analysis of identification without imposing
distributional assumptions on the unobservables. Cunha, Heckman, and Schennach (2006) generalize their
analysis.



4     Distinguishing between Heterogeneity and Uncertainty

In the literature on earnings dynamics (e.g., Lillard and Willis, 1978), it is common to estimate an earnings

equation of the sort
                                               yt = Xβ + δS + vt ,                                         (23)




                                                        17
where yt , X, S, vt denote, respectively, log earnings, observable characteristics (which may vary over time),

educational attainment and unobservable characteristics of person i at time t. Often the error term v t is
decomposed into two or more components. For example,


                                                 vt = φ + ε t .                                            (24)


The term φ is a person-specific fixed effect. The error term εt is generally assumed to be serially correlated,
say εt = ρεt−1 + ηt where ηt is an independently and identically distributed innovation with mean zero.
It is widely accepted that components of X, φ, and εt all contribute to measured inequality. However,

the literature is silent about the difference between heterogeneity and uncertainty, the unforecastable
part of earnings—what Jencks, Smith, Acland, Bane, Cohen, Gintis, Heyns, and Michelson (1972) call

“luck”. On intuitive grounds, the predictable components of vt have a different effect on welfare than
the unpredictable components, especially if people are risk averse and cannot fully insure against the

uncertainty. Is uncertainty φ? Is it εt ? Is it φ + εt ? Or ηt ? Statistical decompositions such as (23) and
(24) tell us nothing about which components of (23) are unforecastable by agents.
   The methodology summarized in this chapter, and developed more fully in Cunha, Heckman, and

Navarro (2005), provides a framework within which it is possible to identify and separate components that
are forecastable from ones that are not. The essential idea of their method can be illustrated in the case

of educational choice. In order to choose between high school and college, say at age 17, agents forecast
future earnings (and other returns) at each schooling level. Using this information from educational choice

at age 17, together with the realization of earnings that are observed at later ages, it is possible to estimate
and test which part of future earnings are forecast by the agent at age 17.
   In this method, we use choice information to extract ex ante or forecast earnings to distinguish them

from ex post or realized earnings. The difference between forecast and realized earnings allows us to identify
the components of uncertainty facing agents at the time they make their schooling decisions. With this

method, we can distinguish predictable heterogeneity from uncertainty.
   We formalize the argument by considering the two-factor, two-period earnings model of Carneiro,

Hansen, and Heckman (2003), Let I denote the information set of the agent at the time the schooling




                                                      18
choice must be made. The population decision rule governing sectoral choice is
                                                     Ã   1
                                                                                        !
                                                         X
                                             I= E              (Y1,t − Y0,t ) − C | I       .
                                                         t=0


In this economy, the decision rule is quite simple: one attends school if the expected gains from schooling
are greater than or equal to the expected costs. Under the assumptions made the choice index I is written

as:
         Ã   1
                                                                                                                          ¯ !
             X                                                                                                            ¯
I=E                [X (β1,t − β0,t ) + θ1 (α1,t − α0,t ) + θ2 (δ1,t − δ0,t ) + ε1,t − ε0,t ] − (Zγ + θ1 αC + θ2 δC + εC ) ¯ I .
                                                                                                                          ¯
             t=0
                                                                                                                          ¯


The decision rule of agents is:

                                              S = 1 if I ≥ 0; S = 0 otherwise.

For the sake of simplicity, assume that X, Z and θ1 are in the information set of the agent, and that the
interest rate is zero (r = 0). By assumption, the error terms εs,t for s, t = 0, 1 are not in the information

set of the agent. We want to test whether θ2 is also in the information set of the agent at the time of the
schooling choice. If θ2 ∈ I, then it reflects heterogeneity across agents (since agents know and act on it).

If θ2 ∈
      / I, then it reflects either uncertainty or some information that agents know, but do not act on.
      Suppose that our null hypothesis is θ1 ∈ I, but θ2 ∈
                                                         / I. Under the null:


                                I = E ( Y1,1 + Y1,2 − Y0,1 − Y0,2 − C| I) = µI (X, Z) + αI θ1 .


Consequently, we have that:


                                       Cov (I − µI (X, Z), Y1,1 − Xβ1,t )) = αI α1,1 σθ21


Let ∆θ2 be such that:


                            Cov (I − µI (X, Z), Y1,1 − µ1 (X)) − αI α1,1 σθ21 − ∆θ2 αI δ1,1 σθ21 = 0.


Then, we reject the null, and conclude that agents know and act on the information contained in factor 2,


                                                                   19
θ2 , if we reject that ∆θ2 = 0.

       The idea of our test is thus very simple. The components of future earnings that are forecastable are
captured by the factors that are known by the agents when they make their educational choices. The
predictable factors are estimated with a nonzero loading in the choice equation. The uncertainty in the

decision regarding college is captured by the factors that the agent does not act on when making the
decision of whether to attend college or not. In this case, the loadings (coefficients on these factors) in

the choice equation would be zero. Carneiro, Hansen, and Heckman (2003) provide exact conditions for
identifying the factor loadings.10 Cunha, Heckman, and Navarro (2005) develop this analysis further.



5        Empirical Results

We now apply these models to data. In this section we report estimates of a model of schooling choice,

show how one can recover the distribution of θ, αC and αs,t , s = 0, 1, t = 0, . . . , T , and put our analysis
to use to estimate counterfactual distributions for different policies, to compute their consequences for
mobility and inequality and to measure the contributions of “luck” to post-schooling earnings. We answer

how much of the post-schooling earnings is predictable at the age schooling decisions are made.


5.1       The Data, Equations, and Estimation

In our empirical analysis, we use a sample of white males from the NLSY data. Following the preceding
theoretical analysis, we consider only two schooling choices: high school and college graduation. We
assume that credit markets are perfect. By this we mean that restrictions on borrowing against future

earnings are assumed not to be important. See Cameron and Taber (2004) and Carneiro and Heckman
(2002) for evidence supporting this assumption in the context of schooling choices. 11 Carneiro, Hansen,

and Heckman (2003) assume the absence of credit markets and obtain empirical results on the extent of
uncertainty similar to the ones presented here, so the issue of whether credit markets function or not does

not affect the main conclusions of our analysis.
  10
    Identification depends on the length of the panel, the number of measurement equations and the variation in Z and X.
  11
    We note, however, that a large literature in macroeconomics based on separable preferences claims to find evidence of
substantial departures from complete contingent claims markets using consumption data. See e.g. the survey in Browning,
Hansen, and Heckman (1999).



                                                           20
   To economize on space, we place many tables on our website for this paper: http://jenni.uchicago.edu/frame-

ineq. Web table W1a presents the list of variables used in our empirical analysis. They show that college
graduates have higher present value of earnings than high school graduates. College graduates also have
higher test scores and come from better family backgrounds. They are more likely to live in a location

where a college is present, and where college tuition is lower.
   To simplify the empirical analysis, we divide the lifetimes of individuals into two periods. The first

period covers ages 17 through 28 and the second goes from 29 through 65. We impute missing wages and
project earnings for the ages not observed in the NLSY data using the procedure described in Appendix

B of Carneiro, Hansen, and Heckman (2003). In Cunha, Heckman, and Navarro (2005), we consider
alternative ways to create full life cycle histories. Combination of data sets is required since the NLSY
does not contain information on the full life cycle of earnings. We augment the NLSY data with data

from the PSID to estimate the lifetime earnings of the NLSY sample members. For each schooling level s,
s ∈ {0, 1}, for each period t ∈ {1, 2} we calculate the present value of earnings at age 17, Y s,t . We assume

that the error term for Ys,t is generated by a two factor model,


                                    Ys,t = Xβs,t + θ1 αs,t,1 + θ2 αs,t,2 + εs,t .                         (25)

We omit the “i” subscripts to eliminate notational burden. This model is all that is required to fit our
data. Additional factors, when entered, do not contribute to the fit of the model. In web table W1b we

list the elements of X used in our empirical analysis. They are listed in the column “PV Earnings.” We
normalize α0,1,2 = 1.
   For the measurement system for cognitive ability we use five components of the ASVAB test battery:

arithmetic reasoning, word knowledge, paragraph composition, math knowledge and coding speed. We
link the first factor to this system of ability tests, and exclude the other factor from it. Thus, we adopt two

normalizations. First, the loading on the first factor on the arithmetic reasoning test is set to one. Second,
the loading on the second factor is set to zero in all test equations. Thus the test scores are devoted to

measuring ability. We include family background variables among the covariates X T in the ASVAB test
equations. Web table W1b lists the variables used in XT . They are listed in the column “Test System.”
Formally, let Tj denote the test score j :


                                                         21
                                        Tj = XT ωj + θ1 αtestj ,1 + εtestj .                             (26)

The cost function C is given by:


                                        C = Zγ + θ1 αC,1 + θ2 αC,2 + εC                                  (27)

where the Z are variables that affect the costs of going to college and include variables that do not affect
outcomes Ys,t (such as local tuition, and distance to college). Web table W1b shows the full set of covariates

used in Z under the column “Cost Function.”
      For the educational choice equation, we assume that agents know X, Z, εC and some, but not necessarily

all, components of θ. Let the components known to the agent be θ̄. The decision rule for attending college
is based on:

                              µ                                ¶
                                     Y1,2          Y0,2            ¡                 ¢
                        V = E Y1,1 +      − Y0,1 −      | X, θ̄ − E C | Z, X, θ̄, εC                     (28)
                                     1+r           1+r

where future earnings are discounted at interest rate r = .03. Individuals go to college if V > 0. We test
and do not reject the hypothesis that individuals, at the time they make their college decisions, know their

cost functions, the factors θ̄, and unobservables in cost εC . However, they do not know εs,t , s ∈ {0, 1},
t ∈ {1, 2} at the time they make their educational choices, and they may not know other components of
~ The factor loadings on the θ not in θ̄ are estimated to be zero in the choice equation. See Cunha,
θ.
Heckman, and Navarro (2005) for further discussion of this test and for extensions of the method.

      We assume that each factor k, k ∈ {1, 2} is generated by a mixture of Jk normal distributions:

                                                Jk
                                                X
                                         θk v         pk,j φ (fk | µk,j , τk,j )
                                                j=1

where φ (η | µj , τj ) is a normal density for η with mean µj and variance τj . As shown in Ferguson (1983),
mixtures of normals with a large number of components approximate any distribution of θ k arbitrarily

well.12 Even though the εs,t are nonparametrically identified, we assume in the empirical work reported
 12
      In the `1 norm.




                                                           22
here that they are normally distributed.13 We estimate the model using Markov Chain Monte Carlo

methods. In web tables W2a–W2c , available at our website, we present estimated coefficients and factor
loadings for the model.


5.2       Results

We now present the empirical results for our model.


5.2.1      How the Model Fits the Data

To assess the validity of our estimates, we perform a variety of checks of fit of predictions against the

data. We first compare the proportions of people who choose each schooling level. In the NLSY data,
55% choose high school and 45% choose college. The model predicts 56% and 44%, respectively. The
model replicates the observed proportions, and formal tests of equality of predicted and actual proportions

cannot be rejected.
       In web figure W1 we show the densities of the predicted and actual present value of earnings for the

overall sample of high school and college graduates. The fit is also good. Web figures W2 and W3, show
the same densities restricted to the sample of those who choose high school (W2) and college (W3). The

fit is good. When we also perform formal tests of equality of predicted and actual distributions, we cannot
reject the hypothesis of equality of the distributions for each schooling choice using a chi-square goodness
of fit test at a 5% significance level for all 3 cases (Table 1). We conclude that a two factor model is

enough to fit the data. From this analysis, we conclude that earnings innovations ε s,t relative to a two
factor model are not in the agents’ information sets at the time they are making schooling decisions. If

they were, additional factors would be required to capture the full covariance between educational choices
and future earnings, but when we enter additional factors, they do not improve the fit of the model to

data and have zero estimated factor loadings in the choice equation.
  13
    Models where the εs,t are allowed to be mixtures do not change the conclusions of this paper. However, they increase
the complexity of the simulation analysis. For this reason, we use the simple normal framework to estimate the uniquenesses.
We stress, however, that it is not a requirement, just a matter of convenience.




                                                            23
5.2.2   The Factors: Non-normality and Evidence on Selection

In order to fit the data, one must allow for non-normal factors, as one can see from the evidence summarized

in figure 1. To generate figure 1, we compute the variance of the distribution of factor 1, say σ θ1 . Since
the factors have mean zero, we can plot the estimated density of factor 1 against that of a normal random

variable with mean zero and variance σθ1 . We proceed in a similar fashion for factor 2. Neither factor
is normally distributed. A traditional assumption used in factor analysis (see, e.g., Jöreskog, 1977) is

violated. Our approach is more general and does not require normality.
   Web figure W4 plots the density of factor 1 conditional on educational choices. Since factor 1 is
associated with cognitive tests, we can interpret it as an index of “ability”. The agents who choose college

have, on average, higher ability. Selection on ability is important in explaining college attendance. A
similar analysis of factor 2 reveals that schooling decisions are not very much affected by it. However,

factor 2 is important for predicting future earnings, as we show below.


5.2.3   Estimating Joint Distributions of Counterfactuals: Returns, Costs and Ability as
        Determinants of Schooling

In estimating the distribution of earnings in counterfactual schooling states within a policy regime (e.g.,
the distributions of college earnings for people who actually choose to be high school graduates), the
usual approach is to assume that both distributions are the same except for an additive constant — the

coefficient of a schooling dummy in an earnings regression. More recently developed methods partially
relax this assumption by assuming preservation of ranks across potential outcome distributions, but do

not freely specify the two outcome distributions (see Chernozhukov and Hansen, 2005; Heckman, Smith,
and Clements, 1997; Vytlacil, 2002). Our approach relaxes this assumption by allowing for arbitrary

dependence across potential outcome distributions. Table 2 presents the conditional distribution of ex
post potential college earnings given ex post potential high school earnings decile by decile. The table
displays a strong positive dependence between the relative positions of individuals in the two distributions.

In particular, for all high school deciles more than 50% of the individuals located at any decile in the
high school earnings distribution will be within one decile of their original position in the college earnings

distribution. However, the dependence is far from perfect. For example, almost 10% of those who are at



                                                     24
the sixth decile of the high school distribution would be in the eighth decile of the college distribution.

Observe that this comparison is not being made in terms of positions in the overall distribution of earnings.
We can determine where individuals are located in the distribution of population potential high school
earnings and the distribution of potential college earnings although in the data we only observe them in

either one or the other state. The assumption of perfect dependence across components of counterfactual
distributions that is maintained in much of the recent literature (e.g., Juhn, Murphy, and Pierce, 1993) is,

however, too strong, at least in this application.
      Figures 2 and 3 present the marginal densities of predicted and counterfactual earnings for college

(figure 2) and high school participants (figure 3). When we compare the densities of the present value of
earnings in the college sector for persons who choose college against the counterfactual densities of high
school earnings for college graduates, the density of the present value of earnings for college graduates is

to the right of the counterfactual density of the present value of earnings of college graduates if they were
high school graduates. Figure 4 reveals that college graduate earnings are higher for high school graduates

than high school earnings. The surprising feature of both figures is that the overlap of the distributions is
substantial. Many high school graduates would have large earnings as college graduates.
      Figure 4 plots the density of returns to education for agents who are high school graduates (the solid

curve), and the density of returns to education for agents who are college graduates (the dashed curve).
College graduates have returns distributed somewhat “to the right” of high school graduates, so the

difference is not only a difference for the mean individual but is actually present over the entire distribution.
An economic interpretation of figure 4 is that agents who choose a college education are the ones who tend

to gain more from it.
      Web table W3 reports the fitted and counterfactual present value of earnings for agents who choose
high school. The typical high school student would earn $703.78 thousand dollars over the life cycle. She

would earn $1,021.97 thousand if she had chosen to be a college graduate.14 This implies a return of
46% to a college education over the whole life cycle (i.e., a monetary gain of 318.19 thousand dollars).

In web table W4, we note that the typical college graduate earns $1,122.69 thousand dollars (above the
counterfactual earnings of what a typical high school student would earn in college), and would make only

$756.13 thousand dollars over her lifetime if she chose to be a high school graduate instead. The returns to
 14
      These numbers may appear to be large but are a consequence of using a 3% discount rate.


                                                            25
college education for the typical college graduate (which in the literature on program evaluation is referred

to as the effect of Treatment on the Treated) is 50% above that of the return for a high school graduate. In
monetary terms we would say that a college graduate has a gain of going to college almost 50,000 dollars
higher over her lifetime than does the typical high school graduate.

    With our methodology we can also determine returns to the marginal student. Web table W5 reveals
that the average individual who is just indifferent between a college education and a high school diploma

earns $743.40 thousand dollars as a high school graduate or $1,089.97 thousand dollars as a college graduate.
This implies a return of 48%. The returns to people at the margin are above those of the typical high

school graduate, but below those for the typical college graduate. Since persons at the margin are more
likely to be affected by a policy that encourages college attendance, their returns are the ones that should
be used in order to compute the marginal benefit of policies that induce people into schooling.

    A major question that emerges from our analysis is, why, if high school graduates have positive returns
to attending college, don’t all people attend? People do not pick schooling levels based only on monetary

returns. Recall that their choice criterion (equation (28)) includes also the pecuniary and non-pecuniary
costs of actually attending college. Figure 5 shows the estimated density of the monetary value of this cost
both overall and by schooling level. While almost no high school graduate perceives a negative cost (i.e.,

a benefit) of attending college; around one third of college graduates actually perceive it as a benefit. Web
table W6 explores this point in more detail by presenting the mean total cost of attending college and the

mean cost that is due to ability. Costs on average are smaller for college graduates. College graduates
have higher ability. The average contribution of ability to costs is positive for high school graduates (a

true cost). It is negative for college graduates, so it is perceived as a benefit. This is the answer to our
puzzle: people do not only (or even mainly) make their schooling decisions by looking at their monetary
returns in terms of earnings. Psychic costs play a very important role. Differences in ability are one force

behind this result.15,16
  15
     Furthermore, we know that this result is not sensitive to the specification of the credit market. Carneiro, Hansen, and
Heckman (2003) obtain a similar conclusion in a model where people are not allowed to borrow or lend. In our model, on
the other hand, there are no constraints to borrowing or lending. Cunha, Heckman, and Navarro (2005) present additional
evidence on this issue.
  16
     “Psychic costs” can stand in for expectational errors and attitudes towards risk. We do not distinguish among these
explanations in this paper. The estimated costs are too large to be due to tuition alone. As noted below, given that returns
are strongly forecastable, important role for expectational errors seems unlikely. See the discussion in Cunha, Heckman, and
Navarro (2005).



                                                            26
5.2.4      Mobility and Heterogeneity versus Uncertainty

In figures 6 through 8 we separate the effect of heterogeneity from uncertainty in earnings. The information

set of the agent is I = {X, Z, XT , εC , Θ} where Θ contains some or all of the factors. Focusing on figure 6
we start by assuming that the agents do not know their factors; consequently, Θ = ∅. If we let the agent

learn about factor 1,17 so that, Θ = {θ1 } , then the reduction in the forecast variance is basically nil. This
exercise shows that while factor 1 is important for forecasting educational choices, it does not do a very

good job in forecasting earnings. Now, assume that the agent is given knowledge of factor 2, but not factor
1, so that Θ = {θ2 }. Then the agent is able to substantially reduce the forecast variance of earnings in
high school. Thus, while factor 2 does not greatly affect college choices, it greatly informs the agent about

his future earnings. When the agent is given knowledge of both factors 1 and 2, that is, Θ = {θ 1 , θ2 } ,
he can forecast earnings marginally better. Factor 1 provides information on ability, but almost none on

future earnings. Figure 7 reveals much the same story about college earnings.
      Table 3 presents the variance of potential earnings in each state, and returns under different information

sets available to the agent. We conduct this exercise for the forecast of period 1, period 2, and lifetime
earnings. We report baseline variances and covariances without conditioning and the remaining uncertainty
state as a fraction of the baseline no information state when different components are given to the agents.

Note that knowledge of factor 2 is fundamentally important in reducing forecast variance for period 2
earnings.

      This discussion sheds light on the issue of distinguishing predictable heterogeneity from uncertainty.
We have demonstrated that there is a large dispersion in the distribution of the present value of earnings.

This dispersion is largely due to heterogeneity, which is forecastable by the agents at the time they are
making their schooling choices. Recall that by our tests agents know θ1 and θ2 . The remaining dispersion
is due to luck, or uncertainty or unforecastable factors as of age 17. Its contribution is smaller.

      It is interesting to note that knowledge of the factors enables agents to make better forecasts. Figure 8
presents an exercise for returns to college (Y1 − Y0 ) similar to that presented in figures 6 and 7 regarding

information sets available to the agent. Knowledge of factor 2 also greatly improves the forecastability of
returns, 80% of the variability in returns is forecastable at age 17. The levels are even more predictable
 17
      As opposed to the econometrician who never gets to observe either θ1 or θ2 .




                                                              27
(94% for high school; 97% for college). Most variability across people is due to heterogeneity and not

uncertainty18 .


5.2.5      Ex Ante versus Ex Post

Once the distinction between heterogeneity and uncertainty is made, we can talk about the distinction
between ex ante and ex post decision making. From our analysis, we conclude that, at the time agents

pick their schooling, the ε’s in their earnings equations are unknown to them. These are the components
that correspond to luck as defined by Jencks, Smith, Acland, Bane, Cohen, Gintis, Heyns, and Michelson

(1972). It is clear that decision making would be different, at least for some individuals, if the agent knew
these chance components when choosing schooling levels since decision rule (1)–(2) would now be

                                                      Yc,2          Yh,2
                                     V   = Yc,1 +          − Yh,1 −      −C >0
                                                      1+r           1+r
                                     S = 1 if V > 0; S = 0 otherwise,


where no expectation is taken to calculate V since all terms on the right hand side of the top equation are

known with certainty by the agent.
       In our empirical model, if individuals could pick their schooling level using their ex post information

(i.e., after learning their luck components in earnings) 13.81% of high school graduates would rather be
college graduates and 17.15% of college graduates would have stopped their schooling at the high school

level.


5.2.6      Analyzing a Cohort Specific Cross-Subsidized Tuition Policy: Constructing Joint Dis-
           tributions of Counterfactuals Across Policy Regimes

As an example of the power of our method to evaluate the consequences of policy on income inequality, we

analyze a cross-subsidized tuition policy indexed by family income level. We construct joint distributions
of outcomes within policy regimes (treatment and no treatment or schooling and no schooling) and joint
  18
     The high predictability of future earnings and returns may be inflated by our imputation procedure. In recent unpublished
work Cunha and Heckman (2006) using pooled data and avoiding imputation show that we get even higher predictability
for returns to college (i.e., only 14.11% of the variance of unobservable in returns are uncertain to the agent), but higher
uncertainty for levels (19% for college and 32% for high school).




                                                             28
distributions of choices (Y = SY1 + (1 − S)Y0 ) across policy regimes. The policy analyzed is as follows. A

prospective student whose family income at age 17 is below the mean is allowed to attend college free of
charge. The policy is self financing within each schooling cohort. To pay for this policy, persons attending
college with family income above the mean pay a tuition charge equal to the amount required to cover the

costs of the students from lower income families as well as their own.
   Total tuition raised covers the cost K of educating each student. Thus if there are N P poor students

and NR rich students, total costs are (NP + NR ) K. In the proposed policy, the poor pay nothing. So
                                              ³        ´
each rich person is charged a tuition T = (K) 1 + N  P
                                                    NR
                                                         . To determine T , notice that NP = NP (T );

NR = NR (T ). We iterate to find the unique self financing T. Notice that NP (T ), the number of poor
people who attend college when tuition is zero, is the same for all values of T (N P (T ) = NP (0) for all T ).
NR is sensitive to the tuition level charged.

   Figure 9 shows that the marginal distributions of income in both the prepolicy state and the postpolicy
state are essentially identical. Under the anonymity postulate we would judge these two situations as

equally good using Lorenz measures or second order stochastic dominance. We move beyond anonymity
and analyze the effect that the policy has on what Fields (2003) calls “positional” mobility.
   Panel 1 of table 4 presents this analysis by describing how the 9.3% of the people who are affected by the

policy move between deciles of the distribution of income. These statistics describe movements from one
income distribution in the initial regime to another income distribution associated with the new regime.

The policy affects more people at the top deciles than at the lower deciles. Around half of the people
affected who start at the first decile remain at the first decile. People in the middle deciles are spread

both up and down and a large proportion of people in the upper deciles is moved into a lower position
(only sixteen percent of those starting on the top decile remain there after the policy is implemented).
Moving beyond the anonymity postulate (which instructs us to examine only marginal distributions), we

learn much more about the effects of the policy on different groups.
   Thus far, we have focused on constructing and interpreting the joint distribution of outcomes across

the two policy regimes. If outcomes under both regimes are observed, these comparisons can be made
using panel data. No use of counterfactuals is necessary. However, our methods will apply if either or both

policy regimes are unobserved but are proposed. Taking advantage of the fact that we can identify not only
joint distributions of earnings over policy regimes but also over counterfactual states within regimes we

                                                      29
can learn a great deal more about the effects of this policy, whether or not policy regimes are observed. 19

       Table 5 and panels 2 and 3 of table 4 reveal that not only 9.3% of the population is affected by the policy
but that actually about half of them moved from high school into college (4.5% of the population) and half
moved from college into high school (4.8% percent of the population). This translates into saying that, of

those affected by the policy, 92% of the high school graduates stay in high school in the post-policy regime
while only 89% of college graduates stay put. Thus the policy is slightly biased against college attendance.

We can form the joint distributions of lifetime earnings by initial schooling level. Figure 10 summarizes
some of the evidence presented in table 5. The panels 2 and 3 of table 4 show that the policy affects very

few high school graduates at the top end of the income distribution (only 1.7% of those affected come from
the 10th percentile) and a lot of college graduates in the same situation (19% of college graduates affected
come from the top decile). We can also see that the policy tends to move high school graduates up in

the income distribution and moves college graduates down. As another example of the generality of our
method and the new insight into income mobility induced by policy that it provides, we can determine

where people come from and where they end up at in the counterfactual distributions of earnings. Table
6 shows where in the prepolicy distribution of high school earnings persons induced to go to college come
from and where in the postpolicy distribution of college earnings they go to. Most people stay in their

decile or move closely to adjacent ones. Given that some people benefit from the policy while others lose, it
is not clear whether society as a whole values this policy positively or not. An advantage of our method is

that it allows us to calculate the effect that the policy has on welfare. An individual’s relative utility is not
only given by earnings but also by the monetary value of psychic costs. We can predict how people would

vote if the policy analyzed in this section were proposed. Table 7 shows the result of such an exercise. The
policy lowers the mean earnings for people affected by it. Most people not indifferent to the policy would
vote against it.


5.2.7      Robustness

In this section we discuss the robustness of the results with respect to many of the empirical and modelling
assumptions in our work. Carneiro, Hansen, and Heckman (2003) assume that markets are incomplete.
  19
   It is implausible that we would have panel data on policy regimes where under one regime a person goes to school and
under another he does not.



                                                          30
However, this assumption does not change the qualitative implication of a tuition policy. In particular,

they find that the agents at the top percentile of the distribution of high school earnings are more likely
to change their schooling status under a tuition reduction policy. What drives the result is the estimated
positive correlation between college and high school earnings. A reduction in cost tends to generate greater

gains for those individuals who have large income in the high school sector.
    Cunha and Heckman (2006) show that the aggregation of earnings into a few periods tends to over-

estimate the share of total variance that is known by individuals. They aggregate earnings in 16 and 24
periods and find that earnings predictability is around 60% for college and high school graduates, and

around 55% for returns. Cunha and Heckman (2006) also test the 3% discount rate that is used to cal-
culate the present value of earnings. They consider different values (2%,4%, and 5%). They show that as
discount rates increase, there is more predictability in lifetime earnings. Consequently, temporary shocks

tend to vanish as we aggregate earnings in fewer periods and use a higher discount rate to calculate present
value of earnings. However, the estimated correlation between college and high school earnings is always

positive regardless of the aggregation of life cycle earnings strategy we use or the discount rate we adopt to
calculate present value of earnings. Heckman, Lochner, and Todd (2006) present a comprehensive survey
of the literature.



6     Summary and Conclusion

This paper summarizes and applies a new body of research on counterfactual analyses of income inequality
and mobility. We construct counterfactuals within policy regimes and counterfactuals across policy regimes.
Using the methods presented here, it is possible to understand the sources of inequality, and the inequality

and mobility consequences of social policies much more deeply than is possible using traditional measures
based on the anonymity axiom.

    We show how to construct distributions of counterfactuals within policy regimes using factor models.
With these same tools, we show how to separate variability into two components: (a) those that are

predictable by a certain age (heterogeneity) and (b) those that are not (luck).
    We apply these methods to analyze the returns to college education. We find that by age 17, when
college decisions are made, prospective students can forecast roughly 80% of the lifetime variance in


                                                     31
their returns to schooling. Heterogeneity and not uncertainty drives the variance in earnings both cross-

sectionally and over time. Given the relatively small role for uncertainty, it is unlikely that expectational
errors about future earnings play a major role in explaining college choices.
   We also find that counterfactual outcomes both within and across policy regimes are highly correlated.

However there is a lot of slippage in ranks across potential outcomes within one policy regime and the
outcomes chosen across policy regimes. Ranks are by no means identical across these counterfactual

distributions. One justification for the use of the anonymity postulate in the analysis of data on income
distributions is that outcomes are independent across policies. That justification is strongly rejected in

our data, as is the polar assumption that ranks are perfectly dependent across policies.
   We show how our methods can reveal where in initial and final distributions persons induced to change
their education by a tuition subsidy policy will come from, and where they end up. Such analyses can be

made both in terms of initial and final outcome distributions and in distributions of potential outcomes
associated with each educational choice. We present a much richer analysis of the inequality and mo-

bility consequences of policies than are available from analyses based on panel data or data from social
experiments.
   This paper has ignored the analysis of general equilibrium effects operating through factor markets even

though such effects are empirically important for large scale programs. Substantial changes in educational
enrollments will affect the wages of college and high school students. The next step in our research program

is to graft the methods in this paper to the general equilibrium framework of Heckman, Lochner, and Taber
(1998a,b,c, 1999) to provide a more comprehensive analysis of the effects of policies on inequality.




                                                     32
References

Aakvik, A., J. J. Heckman, and E. J. Vytlacil (1999). Training effects on employment when the training
  effects are heterogeneous: An application to Norwegian vocational rehabilitation programs. University

  of Bergen Working Paper 0599; and University of Chicago.

Aakvik, A., J. J. Heckman, and E. J. Vytlacil (2005). Estimating treatment effects for discrete outcomes

  when responses to treatment vary: An application to Norwegian vocational rehabilitation programs.
  Journal of Econometrics 125 (1-2), 15–51.

Bourguignon, F. and L. A. P. da Silva (2003). The Impact of Economic Policies on Poverty and Income

  Distribution. Washington, D.C.: The World Bank.

Browning, M., L. P. Hansen, and J. J. Heckman (1999, December). Micro data and general equilibrium
  models. In J. B. Taylor and M. Woodford (Eds.), Handbook of Macroeconomics, Volume 1A, Chapter 8,

  pp. 543–633. Elsevier.

Cameron, S. V. and C. Taber (2004, February). Estimation of educational borrowing constraints using

  returns to schooling. Journal of Political Economy 112 (1), 132–182.

Card, D. (1999). The causal effect of education on earnings. In O. Ashenfelter and D. Card (Eds.),
  Handbook of Labor Economics, Volume 5, pp. 1801–1863. New York: North-Holland.

Carneiro, P., K. Hansen, and J. J. Heckman (2003, May). Estimating distributions of treatment effects
  with an application to the returns to schooling and measurement of the effects of uncertainty on college

  choice. International Economic Review 44 (2), 361–422. 2001 Lawrence R. Klein Lecture.

Carneiro, P. and J. J. Heckman (2002, October). The evidence on credit constraints in post-secondary
  schooling. Economic Journal 112 (482), 705–734.

Chernozhukov, V. and C. Hansen (2005, January). An iv model of quantile treatment effects. Economet-
  rica 73 (1), 245–261.

Cunha, F. and J. J. Heckman (2006). The evolution of earnings risk in the us economy. Presented at the

  9th World Congress of the Econometric Society, London.

                                                    33
Cunha, F., J. J. Heckman, and S. Navarro (2005, April). Separating uncertainty from heterogeneity in life

  cycle earnings, the 2004 hicks lecture. Oxford Economic Papers 57 (2), 191–261.

Cunha, F., J. J. Heckman, and S. M. Schennach (2006). Estimating the elasticity of substitution between
  early and late investments in the technology of cognitive and noncognitive skill formation. Unpublished

  manuscript, University of Chicago, Department of Economics. Presented at the Yale Conference on
  Macro and Labor Economics, May 5–7, 2006.

Ferguson, T. S. (1983). Bayesian density estimation by mixtures of normal distributions. In H. Chernoff,
  M. Rizvi, J. Rustagi, and D. Siegmund (Eds.), Recent Advances in Statistics: Papers in Honor of
  Herman Chernoff on his Sixtieth Birthday, pp. 287–302. New York: Academic Press.

Fields, G. S. (2003, March). Economic and social mobility really are multifaceted. Paper presented at the
  Conference on Frontiers in Social and Economic Mobility, Cornell University, Ithaca, New York.

Heckman, J. J. (1976, December). The common structure of statistical models of truncation, sample
  selection and limited dependent variables and a simple estimator for such models. Annals of Economic
  and Social Measurement 5 (4), 475–492.

Heckman, J. J. (1992). Randomization and social policy evaluation. In C. Manski and I. Garfinkel (Eds.),
  Evaluating Welfare and Training Programs, pp. 201–230. Cambridge, MA: Harvard University Press.

Heckman, J. J. (2001, August). Micro data, heterogeneity, and the evaluation of public policy: Nobel
  lecture. Journal of Political Economy 109 (4), 673–748.

Heckman, J. J. and B. E. Honoré (1990, September). The empirical content of the roy model. Economet-

  rica 58 (5), 1121–1149.

Heckman, J. J., L. J. Lochner, and C. Taber (1998a, January). Explaining rising wage inequality: Explo-

  rations with a dynamic general equilibrium model of labor earnings with heterogeneous agents. Review
  of Economic Dynamics 1 (1), 1–58.

Heckman, J. J., L. J. Lochner, and C. Taber (1998b, May). General-equilibrium treatment effects: A study
  of tuition policy. American Economic Review 88 (2), 381–386.


                                                   34
Heckman, J. J., L. J. Lochner, and C. Taber (1998c, May). Tax policy and human-capital formation.

  American Economic Review 88 (2), 293–297.

Heckman, J. J., L. J. Lochner, and C. Taber (1999). General-equilibrium cost-benefit analysis of education
  and tax policies. In G. Ranis and L. Raut (Eds.), Trade, Growth and Development: Essays in Honor of

  T.N. Srinivasan, Chapter 14, pp. 291–349. Elsevier Science B.V.

Heckman, J. J., L. J. Lochner, and P. E. Todd (2006). Earnings equations and rates of return: The Mincer
  equation and beyond. In E. A. Hanushek and F. Welch (Eds.), Handbook of the Economics of Education.

  Amsterdam: North-Holland. forthcoming.

Heckman, J. J. and S. Navarro (2006). Dynamic discrete choice and dynamic treatment effects. Journal

  of Econometrics, forthcoming.

Heckman, J. J., J. A. Smith, and N. Clements (1997, October). Making the most out of programme
  evaluations and social experiments: Accounting for heterogeneity in programme impacts. Review of

  Economic Studies 64 (221), 487–536.

Heckman, J. J. and E. J. Vytlacil (2005, May). Structural equations, treatment effects and econometric

  policy evaluation. Econometrica 73 (3), 669–738.

Heckman, J. J. and E. J. Vytlacil (2007a). Econometric evaluation of social programs, part I: Causal
  models, structural models and econometric policy evaluation. In J. Heckman and E. Leamer (Eds.),

  Handbook of Econometrics, Volume 6. Amsterdam: Elsevier. Forthcoming.

Heckman, J. J. and E. J. Vytlacil (2007b). Econometric evaluation of social programs, part II: Using
  the marginal treatment effect to organize alternative economic estimators to evaluate social programs

  and to forecast their effects in new environments. In J. Heckman and E. Leamer (Eds.), Handbook of
  Econometrics, Volume 6. Amsterdam: Elsevier. Forthcoming.

Jencks, C., M. Smith, H. Acland, M. J. Bane, D. K. Cohen, H. Gintis, B. Heyns, and S. Michelson (1972).
  Inequality: A Reassessment of the Effect of Family and Schooling in America. New York: Basic Books.

Jöreskog, K. G. (1977). Structural equations models in the social sciences: Specification, estimation and

  testing. In P. Krishnaiah (Ed.), Applications of Statistics, pp. 265–287. New York: North-Holland.

                                                     35
Jöreskog, K. G. and A. S. Goldberger (1975, September). Estimation of a model with multiple indicators

  and multiple causes of a single latent variable. Journal of the American Statistical Association 70 (351),
  631–639.

Juhn, C., K. M. Murphy, and B. Pierce (1993, June). Wage inequality and the rise in returns to skill.

  Journal of Political Economy 101 (3), 410–442.

Kane, T. J. (1994, October). College entry by blacks since 1970: The role of college costs, family back-

  ground, and the returns to education. Journal of Political Economy 102 (5), 878–911.

Lillard, L. A. and R. J. Willis (1978, September). Dynamic aspects of earning mobility. Econometrica 46 (5),
  985–1012.

Ravallion, M. (2003). Assessing the poverty impact of an assigned program. In F. Bourguignon and L. Silva
  (Eds.), The Impact of Economic Policies on Poverty and Income Distribution, pp. 103–122. Washington,

  D.C.: The World Bank.

Roy, A. (1951, June). Some thoughts on the distribution of earnings. Oxford Economic Papers 3 (2),
  135–146.

Vytlacil, E. J. (2002, January). Independence, monotonicity, and latent index models: An equivalence
  result. Econometrica 70 (1), 331–341.

Willis, R. J. and S. Rosen (1979, October). Education and self-selection. Journal of Political Economy 87 (5,
  Part 2), S7–S36.




                                                     36
                               Table 1
          Goodness of Fit Test for Lifetime Earnings

                           χ2 Statistic          Critical Value*
Overall                     48.9251                  53.1419
High School                 25.4820                  26.0566
College                     32.2506                  33.2562
*95% confidence, equiprobable bins with approximately 23 people per bin
                                                 Table 2
        Ex-post Conditional Distribution (College Earnings Conditional on High School Earnings)
                                    Pr(di <Yc <di + 1 |dj < Yh < dj+1)*
                                                        College
  High        1        2         3         4          5           6     7        8        9                            10
 School
   1       0.6980 0.2534 0.0444 0.0032 0.0011 0.0000 0.0000 0.0000 0.0000                                           0.0000
   2       0.2270 0.4150 0.2470 0.0890 0.0180 0.0040 0.0000 0.0000 0.0000                                           0.0000
   3       0.0450 0.2160 0.3420 0.2610 0.1070 0.0260 0.0030 0.0000 0.0000                                           0.0000
   4       0.0140 0.0950 0.2120 0.2930 0.2390 0.1090 0.0370 0.0010 0.0000                                           0.0000
   5       0.0000 0.0300 0.1130 0.2190 0.2940 0.2170 0.1100 0.0170 0.0000                                           0.0000
   6       0.0000 0.0040 0.0340 0.0980 0.2030 0.3080 0.2470 0.0990 0.0070                                           0.0000
   7       0.0000 0.0000 0.0100 0.0340 0.1130 0.2390 0.3190 0.2350 0.0500                                           0.0000
   8       0.0000 0.0000 0.0000 0.0030 0.0240 0.0910 0.2360 0.4010 0.2320                                           0.0130
   9       0.0000 0.0000 0.0000 0.0000 0.0010 0.0060 0.0470 0.2360 0.5400                                           0.1700
   10      0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0010 0.0110 0.1710                                           0.8170
*di is the ith decile of the College Lifetime Earnings Distribution and dj is the jth decile of the High School Lifetime
Earnings Distribution.
                                                            Table 3
                                   Agent's Forecast Variance of Present Value of Earnings
                                    Under Different Information Sets: I = { X,Z,XT ,εC ,Θ }
                               (as a fraction of the variance when no information is available)
                                                      Var(Yc)           Var(Yh)           Var(Yc - Yh)               Cov(Yc , Yh)
                                +
             For time period 1:
Variance when Θ = Ø                                   7167.20          5090.46              3073.94                    4591.86
Percentage of variance remaining after
controlling for the indicated factor:
                   Θ = {θ1}                           97.50%            98.34%              99.43%                      97.33%
                   Θ = {θ2}                           18.50%            32.83%              89.52%                      2.67%
                  Θ = {θ1,θ2}                         16.01%            31.17%              88.94%                      0.00%

             For time period 2:++
Variance when Θ = Ø                                   49690.64            167786.87             41137.80               88169.85
Percentage of variance remaining after
controlling for the indicated factor:
                   Θ = {θ1}                            97.18%               97.54%               98.25%                 97.28%
                   Θ = {θ2}                            7.39%                4.73%                16.55%                  2.72%
                  Θ = {θ1,θ2}                          4.57%                2.27%                14.80%                  0.00%

               For lifetime:+++
Variance when Θ = Ø                                   56857.84            172877.33             44211.74               92761.72
Percentage of variance remaining after
controlling for the indicated factor:
                   Θ = {θ1}                            97.22%               97.57%               98.33%                 97.28%
                   Θ = {θ2}                            8.79%                5.56%                21.62%                  2.72%
                  Θ = {θ1,θ2}                          6.01%                3.13%                19.95%                  0.00%
We use an interest rate of 3% to calculate the present value of earnings. In all cases, the information set of the agent is
I = { X,Z,XT,εC ,Θ } and we change the contents of Θ.
+
  Variance of the unpredictable component of earnings between age 17 and 28 as predicted at age 17.
++
   Variance of the unpredictable component of earnings between age 29 and 65 as predicted at age 17.
+++
    Variance of the unpredictable component of earnings between age 17 and 65 as predicted at age 17.
So we would say that the variance of the unpredictable component of period 1 college earnings when using factor 1 in the prediction is
97.5% of the variance when no information is available (i.e., 0.975*7167.2).
                                                         Table 4
                                 Mobility of People Affected by Cross Subsidizing Tuition
                      Overall: Fraction of Total Population who Switch Schooling Levels: 0.0932
                                Probability of Moving to a Different Decile of the Lifetime Earnings Distribution
Fraction      Deciles     1          2         3         4        5          6          7        8         9               10
by Decile       of
of Origin     Origin
0.0728          1      0.5565 0.2011 0.1220 0.0634 0.0283 0.0074 0.0012 0.0000 0.0000                                   0.0000
0.0867          2      0.2079 0.1712 0.1715 0.1690 0.1585 0.0870 0.0322 0.0025 0.0002                                   0.0000
0.0955          3      0.1148 0.1489 0.0935 0.1137 0.1573 0.1888 0.1387 0.0409 0.0034                                   0.0000
0.0998          4      0.0619 0.1557 0.0910 0.0534 0.0764 0.1615 0.2084 0.1557 0.0360                                   0.0000
0.1032          5      0.0296 0.1495 0.1387 0.0630 0.0304 0.0571 0.1411 0.2456 0.1396                                   0.0055
0.1050          6      0.0066 0.0959 0.1726 0.1471 0.0520 0.0142 0.0415 0.1671 0.2605                                   0.0425
0.1084          7      0.0006 0.0336 0.1411 0.1956 0.1269 0.0420 0.0082 0.0348 0.2346                                   0.1827
0.1089          8      0.0000 0.0046 0.0519 0.1765 0.2211 0.1495 0.0388 0.0034 0.0513                                   0.3029
0.1101          9      0.0000 0.0000 0.0055 0.0421 0.1570 0.2733 0.2302 0.0447 0.0014                                   0.2459
0.1069          10     0.0000 0.0000 0.0000 0.0002 0.0041 0.0517 0.2082 0.3242 0.2490                                   0.1626

       High school: Fraction of Total Population who Switch from High School to College due to the policy: 0.0450
0.1012            1         0.3954 0.2557 0.1775 0.0936 0.0417 0.0110 0.0018 0.0000 0.0000 0.0000
0.1279            2         0.0382 0.1220 0.2176 0.2325 0.2200 0.1210 0.0448 0.0035 0.0003 0.0000
0.1369            3         0.0023 0.0188 0.0692 0.1536 0.2244 0.2701 0.1984 0.0584 0.0049 0.0000
0.1367            4         0.0000 0.0016 0.0088 0.0368 0.1116 0.2417 0.3123 0.2332 0.0540 0.0000
0.1285            5         0.0000 0.0000 0.0007 0.0052 0.0277 0.0903 0.2324 0.4047 0.2300 0.0090
0.1122            6         0.0000 0.0000 0.0000 0.0004 0.0024 0.0151 0.0792 0.3209 0.5004 0.0816
0.1017            7         0.0000 0.0000 0.0000 0.0000 0.0000 0.0009 0.0101 0.0761 0.5133 0.3997
0.0797            8         0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0067 0.1440 0.8493
0.0557            9         0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0032 0.9968
0.0173            10        0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000
          College: Fraction of Total Population who Switch from College to High School due to the policy: 0.0473
0.0459            1         0.8941 0.0866 0.0055 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
0.0475            2         0.6423 0.2972 0.0534 0.0062 0.0009 0.0000 0.0000 0.0000 0.0000 0.0000
0.0560            3         0.3763 0.4510 0.1501 0.0211 0.0015 0.0000 0.0000 0.0000 0.0000 0.0000
0.0647            4         0.1860 0.4648 0.2559 0.0868 0.0059 0.0007 0.0000 0.0000 0.0000 0.0000
0.0791            5         0.0753 0.3801 0.3518 0.1522 0.0347 0.0059 0.0000 0.0000 0.0000 0.0000
0.0982            6         0.0138 0.2001 0.3602 0.3064 0.1059 0.0133 0.0004 0.0000 0.0000 0.0000
0.1148            7         0.0011 0.0618 0.2598 0.3603 0.2337 0.0766 0.0066 0.0000 0.0000 0.0000
0.1366            8         0.0000 0.0071 0.0807 0.2744 0.3436 0.2323 0.0603 0.0015 0.0000 0.0000
0.1618            9         0.0000 0.0000 0.0073 0.0559 0.2084 0.3628 0.3056 0.0593 0.0008 0.0000
0.1920            10        0.0000 0.0000 0.0000 0.0002 0.0044 0.0561 0.2260 0.3519 0.2702 0.0911
Note: Cross subsidy consists in making tuition zero for people with family income below average and making the budget
balance by raising tuition for college students with family income above the average. For example, we read from the first
panel row 1, column 1 that 7.28% of the people who switch schooling levels come from the lowest decile. Out of those,
55% are still in the first decile after the policy while 2.83% jump to the fifth decile. Panel 2 has the same interpretation but
it only looks at people who switch from high school to college while panel 3 looks at individuals who switch from college
to high school.
                                                    Table 5
                           Mobility of people affected by cross subsidizing tuition
                     Fraction of the total population who switch schooling levels: 0.0932
       Pre-policy Choice:                              Fraction of High School Graduates:
                                       Do not switch                     Become College graduates
          High School                       0.9197                                 0.0803
                                                          Fraction of College Graduates:
                                       Do not switch                   Become High School graduates
            College                         0.8923                                 0.1077

Note: Cross subsidy consists in making tuition zero for people with family income below average and making the budget balance by
raising tuition for college students with family income above the average.
                                                        Table 6
               Mobility of People Affected by Cross Subsidizing Tuition Across Counterfactual Distributions
             Highschool: Fraction of Total Population who from High School to College after the policy: 0.0450
  Fraction by
   Decile of
 Origin in the     Deciles
Prepolicy High       of          Probability of Moving to a Different Decile of the Post Policy College Lifetime Earnings
    School         Origin                                              Distribution
 Distribution
                                   1        2         3         4          5          6          7         8         9     10
     0.0667             1       0.8266 0.1227 0.0140 0.0020 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
     0.0811             2       0.4044 0.4110 0.1490 0.0296 0.0055 0.0000 0.0000 0.0000 0.0000 0.0000
     0.0908             3       0.1488 0.3544 0.3059 0.1419 0.0445 0.0039 0.0005 0.0000 0.0000 0.0000
     0.0998             4       0.0401 0.2343 0.3096 0.2490 0.1234 0.0379 0.0053 0.0004 0.0000 0.0000
     0.1047             5       0.0089 0.0713 0.2081 0.3053 0.2348 0.1282 0.0365 0.0068 0.0000 0.0000
     0.1058             6       0.0004 0.0202 0.0950 0.2155 0.2761 0.2416 0.1273 0.0239 0.0000 0.0000
     0.1062             7       0.0000 0.0033 0.0243 0.0896 0.1888 0.3026 0.2662 0.1155 0.0096 0.0000
     0.1116             8       0.0000 0.0004 0.0016 0.0159 0.0630 0.1690 0.3220 0.3228 0.1024 0.0028
     0.1138             9       0.0000 0.0000 0.0000 0.0016 0.0043 0.0293 0.1227 0.3271 0.4568 0.0582
     0.1173            10       0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0027 0.0333 0.2626 0.7014
           College: Fraction of Total Population who Switch from College to High School due to the policy: 0.0473
     0.1095             1       0.5473 0.2945 0.1135 0.0316 0.0062 0.0012 0.0000 0.0000 0.0000 0.0000
     0.1056             2       0.1076 0.3257 0.2937 0.1789 0.0716 0.0204 0.0016 0.0004 0.0000 0.0000
     0.1035             3       0.0180 0.1473 0.2776 0.2657 0.1833 0.0857 0.0200 0.0024 0.0000 0.0000
     0.1013             4       0.0004 0.0355 0.1535 0.2349 0.2866 0.1890 0.0847 0.0150 0.0004 0.0000
     0.1012             5       0.0000 0.0050 0.0467 0.1503 0.2654 0.2705 0.1903 0.0668 0.0050 0.0000
     0.0979             6       0.0000 0.0000 0.0091 0.0513 0.1678 0.2683 0.2972 0.1786 0.0276 0.0000
     0.0977             7       0.0000 0.0000 0.0000 0.0087 0.0463 0.1609 0.3071 0.3387 0.1362 0.0022
     0.0953             8       0.0000 0.0000 0.0000 0.0004 0.0044 0.0430 0.1560 0.4020 0.3617 0.0324
     0.0964             9       0.0000 0.0000 0.0000 0.0000 0.0000 0.0009 0.0127 0.1337 0.5355 0.3173
     0.0882            10       0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0034 0.0915 0.9051
Note: Cross subsidy consists in making tuition zero for people with family income below average and making the budget
balance by raising tuition for college students with family income above the average. For example, we read from the first
panel row 1, column 1 that 6.67% of the people who switch from high school to college come from the lowest decile of the
prepolicy high school distribution. Out of those, 82.66% are still in the first decile of the post policy college earnings
distribution after the policy is implemented while 1.40% "jump" to the third decile. Panel 2 has the same interpretation but it
only looks at people who switch from college to high school.
                                   Table 7
         Voting outcome of proposing cross subsidizing* tuition
 Fraction of the total population who switch schooling levels: 0.0932
Average pre-policy lifetime earnings**                                 920.55
Average post-policy lifetime earnings**                                905.96
Fraction of the population who votes
    Yes                                                                0.0716
    No                                                                 0.6152
    Indifferent                                                        0.3132
*Cross subsidy consists in making tuition zero for people with family income below
average and making the budget balance by raising tuition for college students with
family income above the average.
** In thousands of dollars.
                                         F igure 1
                      Dens ities of factors and their normal equivalents
1.4
                                                                        F actor1
                                                                        Normal vers ion of factor 1
                                                                        F actor2
1.2                                                                     Normal vers ion of factor 2




  1




0.8




0.6




0.4




0.2




 0
 2          1. 5     1       0. 5       0        0.5      1       1.5           2         2.5         3
                                               factor

      Let f(q1) denote the dens ity function of factor q1.
      We as s ume that f( q1) is a mixture of normals . As s ume m1 = E ( q1), s1 = V ar( q1).
      Let f (m1, s1) denote the dens ity of a normal random variable with mean m1 and variance s1.
      T he s olid curve is the estimated dens ity of factor q1, f( q1), while the das hed curve is the
      dens ity of a normal random variable with mean and variance of factor q1, f (m1, s1).
      We proceed s imilarly for factor 2, where the fitted density is plotted with dots and dashes
      and the normal version is plotted with dots.
                                                  F igure 2
                                  Dens ities of pres ent value of earnings
                                            in the college s ector
 0.1
                                                                                   HS (counterfactual)
                                                                                   C ol (fitted)
0.09


0.08


0.07


0.06


0.05


0.04


0.03


0.02


0.01


   0
       0               500             1000            1500            2000           2500               3000
                                               thous ands of dollars



           Let Y 1 denote pres ent value of earnings (dis counted at a 3% interes t rate) in the
           college s ector. Let f(y1) denote its dens ity function. T he das hed line plots the fitted
           Y 1 dens ity conditioned on choos ing college, that is , f(y1 | S = 1), while the s olid line
           s hows the estimated counterfactual dens ity function of Y 1 for thos e agents who are
           actually high s chool graduates , that is , f(y1 | S = 0).
                                               F igure 3
                                Dens ities of pres ent value of earnings
                                       in the high s chool s ector
0.16
                                                                                HS (fitted)
                                                                                C ol (counterfactual)

0.14



0.12



 0.1



0.08



0.06



0.04



0.02



   0
       0               500            1000            1500            2000          2500                3000
                                              thous ands of dollars
           Let Y 0 denote pres ent value of earnings (dis counted at a 3% interes t rate) in the
           high s chool s ector. Let f(y0) denote its dens ity function. T he s olid curve plots the
           fitted Y0 dens ity conditioned on choos ing high s chool, that is , f(y0 | S = 0), while the
           das hed line s hows the counterfactual dens ity function of Y0 for thos e agents who are
           actually college graduates , that is , f(y0 | S = 1).
                                     F igure 4
           Dens ities of ex pos t returns to college by s chooling level chos en
2.5
                                                                                              HS
                                                                                              C ol



 2




1.5




 1




0.5




 0
 1                0.5               0                0.5                1           1.5              2
                                         fraction of the bas e s tate


      Let Y 0, Y 1 denote the pres ent value of earnings in high s chool and college s ectors ,
      res pectively. Define ex pos t returns to college as the ratio R = (Y 1 - Y 0)/Y 0. Let f(r)
      denote the dens ity function of the random variable R . T he s olid line is the dens ity
      of ex pos t returns to college for high s chool graduates , that is , f(r | S =0). T he das hed
      line is the dens ity of ex pos t returns to college for college graduates , that is , f(r | S =1).
                                         F igure 5
                         Dens ity of monetary value of ps ychic cos t
                          both overall and by s chooling level
0.25
                                                                                      Overalll
                                                                                      HS
                                                                                      C ol


 0.2




0.15




 0.1




0.05




  0
 500                        0                    500                    1000                 1500
                                         thous ands of dollars
         In this figure we plot the monetary value of psychic costs. Let C denote the
       monetary value of psychic costs.
         The monetary value of psychic costs is given by:
                                    C = ZL + S 1 J C1 + S 2 J C2 + PC
            The contribution of ability to the costs of attending college, in monetary value is
       S 1 J C1 .
                                          Figure 6
          Densities of agent's forecast of the present value of high school earnings
                      under different information sets: I = { X,Z,XT,εC ,Θ }
0.7
                                                                          Θ = Ø*
                                                                          Θ = {θ1}**
                                                                          Θ = {θ2}***
0.6                                                                       Θ = {θ1, θ2}****



0.5




0.4




0.3




0.2




0.1




  0
      0              500            1000           1500            2000           2500          3000
                                            thousands of dollars


          Let Y0 denote the agent's forecast of present value of earnings in the high school
          sector . These are formed over the whole population, not just the subpopulation
          who go to high school. We assume that agents know all coefficients. Let I = { X,Z,XT,εC ,Θ}
          denote the agents information set. Let f(y0 |I) denote the density of the agent's forecast of
          present value of earnings in high school conditioned on the information set I. Then:
          *Plot of f(y0 |I ) under no element of θ in the information set, i.e., Θ = Ø.
          ** Plot of f(y0 |I ) when only factor 1 is in the information set, i.e., Θ = {θ1}.
          *** Plot of f(y0 |I ) when only factor 2 is in the information set, i.e., Θ = {θ2}.
          **** Plot of f(y0 |I ) when both factors are in the information set, i.e.,Θ = {θ1,θ2}.
                                          Figure 7
           Densities of agent's forecast of the present value of college earnings
                 under different information s ets: I = { X,Z,XT,εC ,Θ }
 0.4
                                                                          Θ = Ø*
                                                                          Θ = {θ1}**
                                                                          Θ = {θ2}***
0.35                                                                      Θ = {θ1, θ2}****


 0.3



0.25



 0.2



0.15



 0.1



0.05



   0
       0            500            1000           1500            2000            2500           3000
                                           thousands of dollars

       Let Y1 denote the agent's forecast of present value of earnings in the college
       sector . These are formed over the whole population, not just the subpopulation
       who go to college. We assume that agents know all coefficients. Let I = { X,Z,XT,εC ,Θ}
       denote the agents information set. Let f(y1 |I) denote the density of the agent's forecast of
       present value of earnings in college conditioned on the information set I. Then:
       *Plot of f(y1 |I ) under no element of θ in the information set, i.e., Θ = Ø.
       ** Plot of f(y1 |I ) when only factor 1 is in the information set, i.e.,Θ = {θ1}.
       *** Plot of f(y1 |I ) when only factor 2 is in the information set, i.e.,Θ = {θ2}.
       **** Plot of f(y1 |I ) when both factors are in the information set, i.e.,Θ = {θ1,θ2}.
                                              Figure 8
                Densities of agent's forecast gains in present value of earnings
                 (Y1 -Y0) under different information s ets: I = { X,Z,XT,εC ,Θ }
0.35
                                                                          Θ = Ø*
                                                                          Θ = {θ1}**
                                                                          Θ = {θ2}***
 0.3                                                                      Θ = {θ1, θ2}****



0.25




 0.2




0.15




 0.1




0.05




  0
 500                         0                       500                  1000                  1500
                                         gains in thousands of dollars
       Let Y0, Y1 denote the agent's forecast of present value of earnings in the high school
       and college sectors, respectively. We define the difference in present value of earnings as
       ∆ = Y1-Y0. We assume that agents know all coefficients. Let I = {X,Z,XT,εC ,Θ}, f(∆ |I)
       denote the agents information set and the density of the agent's forecast of gains in
       present value of earnings in choosing college conditioned on the information set I,
       respectively. These are defined over the entire population, then:
       *Plot of f(∆ |I ) under no element of θ in the information set, i.e., Θ = Ø.
       ** Plot of f(∆ |I ) when only factor 1 is in the information set, i.e., Θ = {θ1}.
       *** Plot of f(∆ |I ) when only factor 2 is in the information set, i.e., Θ = {θ2}.
       **** Plot of f(∆ |I ) when both factors are in the information set, i.e., Θ = {θ1,θ2}.
                                          Figure 9
                       Densities of present value of lifetime earnings
                     before and after implementing cross subsidy policy
0.12
                                                                                               Pre policy (A)
                                                                                               Post polic y (B)


 0.1




0.08




0.06




0.04




0.02




  0
       0              500              1000             1500              2000              2500             3000
                                                 thousands of dollars


       Let YA,YB denote the observed present value of earnings pre and post policy, respectively. Define
       f(yA), g(yB) as the marginal densities of present value of earnings pre and post policy. In this figure
       we plot f(yA), g(yB).
                                                                    Figure 10
                        Fraction of people who switch schooling levels when tuition is cross subsidized
                                    by decile of origin from the lifetime earnings distribution
 0.2500
                                                                                                                             Overall
                                                                                                                             High school to College
                                                                                                                             College to High School

 0.2000




 0.1500




 0.1000




 0.0500




 0.0000
                1             2             3             4             5              6             7             8             9             10
                                                                             Decile
*Cross subsidy consists in making tuition zero for people with family income below average and making the budget balance by raising tuition for college
students with family income above the average.
