                                NBER WORKING PAPER SERIES




      ALLOCATIVE EFFICIENCY, MARK-UPS, AND THE WELFARE GAINS FROM
                                TRADE

                                          Thomas J. Holmes
                                            Wen-Tai Hsu
                                            Sanghoon Lee

                                        Working Paper 19273
                                http://www.nber.org/papers/w19273


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      July 2013




This paper grew out of work initially circulated under the title, "Plants, Productivity, and Market Size,
with Head-to-Head Competition." We are very grateful for discussion comments from Donald Davis
and Marc Melitz on this earlier work. We have also benefited from discussions with various colleagues
and in particular thank Sam Kortum and Jim Schmitz. The views expressed herein are those of the
authors and not necessarily those of the Federal Reserve Bank of Minneapolis, the Federal Reserve
System, or the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Thomas J. Holmes, Wen-Tai Hsu, and Sanghoon Lee. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Allocative Efficiency, Mark-ups, and the Welfare Gains from Trade
Thomas J. Holmes, Wen-Tai Hsu, and Sanghoon Lee
NBER Working Paper No. 19273
July 2013
JEL No. D61,F10,L13

                                            ABSTRACT

This paper develops an index of allocative efficiency that depends upon the distribution of mark-ups
across goods. It determines how changes in trade frictions affect allocative efficiency in an oligopoly
model of international trade, decomposing the effect into the cost-change channel and the price-change
channel. Formulas are derived shedding light on the signs and magnitudes of the two channels. In
symmetric country models, trade tends to increase allocative efficiency through the cost-change channel,
yielding a welfare benefit beyond productive efficiency gains. In contrast, the price-change channel
has ambiguous effects on allocative efficiency.


Thomas J. Holmes                                           Sanghoon Lee
Department of Economics                                    Sauder School of Business
University of Minnesota                                    University of British Columbia
4-101 Hanson Hall                                          2053 Main Mall
1925 Fourth Street South                                   Vancouver, BC V6T1Z2
Minneapolis, MN 55455                                      Canada
and The Federal Reserve Bank of Minneapolis                Sanghoon.Lee@sauder.ubc.ca
and also NBER
holmes@umn.edu

Wen-Tai Hsu
School of Economics
Singapore Management University
90 Stamford Road
Singapore 178903
wentaihsu@smu.edu.sg
1       Introduction
When mark-ups are the same across all goods, first-best allocative eﬃciency is attained.
The condition that the price ratio equals the marginal cost ratio, for any pair of goods,
holds because the constant mark-ups in prices cancel out. In this paper, we develop an
index   of allocative eﬃciency that can be calculated when mark-ups diﬀer across goods,
and the first-best is not attained. We focus on how international trade influences   .
In particular, we distinguish eﬀects on allocative eﬃciency from standard Ricardian gains
from trade, which we account for through how trade aﬀects an index of productive eﬃciency
 Prod . Our key result is a decomposition of the eﬀect on allocative eﬃciency   into what
we define as the cost-change channel and the price-change channel. The decomposition
is useful because each channel has an intuitive formula that makes it possible to discuss
conditions determining sign and magnitude. In important limiting cases, both terms are
zero, and eﬀects of international trade on   can be safely ignored. In general, however, the
two terms are not zero, and the eﬀect on allocative eﬃciency can be a significant component
of the overall welfare analysis of trade.
    The analysis is conducted in an oligopoly model of international trade where firms com-
pete “head-to-head” in a Bertrand fashion. This approach follows Bernard, Eaton, Jensen,
and Kortum (2003) (hereafter BEJK), and Atkeson and Burstein (2008).1 Consider how
  changes when a friction  impeding trade between countries is reduced. To determine
the cost-change channel, we evaluate the eﬀect of lower  on mark-ups, when we take into
account eﬀects on costs, but leave prices fixed. Lower  aﬀects only the costs of imported
goods. Thus, holding prices fixed, lower  raises mark-ups on imported goods. To de-
termine how this change aﬀects allocative eﬃciency   , the formula for the cost-change
channel compares mark-ups for imported goods, with the average mark-up (foreign and do-
mestic goods combined). The formula is intuitive, and is straightforward to calculate in
empirical applications, if micro data on product-level mark-ups are available. Suppose, for
example, that mark-ups on foreign goods are initially less than average. If  is then lowered,
it will enable foreign firms to raise mark-ups closer to the average, attenuating the initial
distortion.
    In the limiting case where the friction is small and countries are symmetric, the cost-
change channel for the eﬀect on   goes to zero, because mark-ups on imports and domes-
tic goods are identical in the limit. The cost-change channel is also approximately zero in
another limiting case where competing firms draw their productivities from a Pareto distri-
    1
    Atkeson and Burstein (2008) focus on the Cournot version of their model, but also consider a Bertrand
variant. See also Devereux and Lee (2001) and Neary (2003) for related Cournot versions.



                                                   1
bution, as is commonly assumed in the trade literature.2 Holding fixed productivity draws,
foreign firms incur trade costs that domestic firms do not, and everything else the same, this
tends to lower mark-ups for foreign firms compared to domestic. However, foreign firms
face a tougher selection process over productivity (since foreign firms must surmount the
trade cost barrier), and everything else the same, higher productivity for the market leader
raises mark-ups. Under the Pareto, these two oﬀsetting forces cancel out, and mark-ups for
imports are the same as overall, zeroing out the cost-change channel. The outcome is a con-
sequence of the “fat-tailed” nature of the Pareto, which gives the selection eﬀect great force.
If instead we use a distribution with less of a fat tail, like the log-normal, the selection eﬀect
no longer “keeps up” as an oﬀsetting force. Everything else the same (e.g. a symmetric
setup where foreign firms draw from the same productivity distribution as domestic firms),
foreign firms tend to have lower mark-ups than domestic because of the friction, and the
cost-change channel for the eﬀect of a reduction in  on   is strictly positive.
    To understand the price-change channel, consider the eﬀect of lower  on allocative
eﬃciency   , when we take into account how prices change, but hold costs fixed. It
turns out that in the two limiting cases just mentioned, the case of symmetry and negligible
frictions, and the case where productivity draws are Pareto, the price-change channel is zero
like the cost-change channel, and the overall eﬀect of lower  on   is zero. More generally
the price-change channel is non-zero, and its sign and magnitude depend upon how mark-
ups on goods whose prices decrease, when  goes down, compare with mark-ups on goods
whose prices remain the same. In symmetric cases when demand tends to be inelastic,
the price-change channel tends to be positive, and thereby reinforces the positive eﬀect of
lower  that comes through the cost-change channel. In contrast, when demand is elastic,
the price-change channel tends to be negative, and in some cases can more than oﬀset the
positive eﬀect from the cost-change channel. In these cases, allocative eﬃciency actually
falls as trade frictions decline, as firms are less able to harmonize their mark-ups around the
simple monopoly mark-up.
    Our paper builds on long understood ideas about allocative eﬃciency. In particular,
Robinson (Ch 27, 1934) showed that if there is a constant mark-up across all goods, first-
best eﬃciency is achieved. The literature on the theory of the second best (e.g. Lipsey and
Lancaster (1956-1957)) made the point that making one sector more competitive potentially
reduces welfare if there already exists monopoly distortions elsewhere in the economy. Based
on the insights of this old literature, it is clear that while increased trade might have “pro-
competitive” eﬀects in reducing mark-ups, the eﬀect of trade on allocative eﬃciency will not
   2
     A similar limiting case is when firms draw productivities from a fat-tailed distribution and the number
of firms goes to infinity.



                                                     2
necessarily be positive.
    The related modern literature is extensive and we start with BEJK. Our model is the
same as BEJK, with BEJK making a particular functional form assumption for the produc-
tivity distribution. BEJK show in their setup that the mark-up distribution is the same
for imports as it is for domestic goods, and that changes in trade frictions do not aﬀect the
distribution of mark-ups. The BEJK productivity distribution has a fat-tailed shape, and
the cost-change and price-change channels are both zero, for how  aﬀects   , following
our discussion above. Atkeson and Burstein (2008) and de Blas and Russ (2012) start with
the BEJK model and show that with alternative assumptions on the distribution of produc-
tivity, foreign goods can have diﬀerent mark-ups than domestic goods, and changes in trade
frictions can aﬀect the overall distribution of mark-ups. Our work is diﬀerent from these
papers, in our focus on allocative eﬃciency.
    Recently, Edmond, Midrigan, and Xu (2012) consider a similar model and examine gains
from trade achieved through the “pro-competitive” eﬀect of how trade changes the distribu-
tion of mark-ups. The paper provides a quantitative analysis, with model parameters pinned
down with Taiwanese manufacturing data. The key diﬀerences in our paper include (i) our
approach in developing a formal measure of allocative eﬃciency, (ii) how we decompose the
eﬀects of trade on allocative eﬃciency into the cost-change and price-change components,
and (iii) how we use the decomposition to shed light on the potential signs and magnitudes
of the pro-competitive eﬀect.
    In a recent paper, Arkolakis, Costinot, and Rodriguez-Clare (2012), hereafter ACR, derive
a condition summarizing the welfare gains from trade that is applicable in a variety of models,
including BEJK. The condition depends upon the volume of observed trade. For example,
in the ACR framework, a necessary condition for trade to have welfare eﬀects is that there be
positive trade flows. By focusing on the fat-tailed productivity draws included in the BEJK
setup, for which the mark-up distribution is invariant to trade, the ACR approach shuts down
any possibility of welfare eﬀects through allocative eﬃciency. All welfare eﬀects go through a
productive eﬃciency index  Prod . If instead we consider productivity distributions without
a fat tail, then in general trade will aﬀect both productive eﬃciency  Prod and allocative
eﬃciency   . In the end, if observed trade volume is zero, the ACR formula will determine
that trade leads to no gains in  Prod . However, even if there are no observed trade flows,
the possibility of trade can aﬀect the mark-up distribution, and hence overall welfare through
  .3
    There are now several models of monopolistic competition where trade aﬀects mark-
   3
    There is empirical evidence that the threat of competition from imports can influence domestic outcomes,
even if in the end, imports don’t come in. See Salvo (2010) and Schmitz (2005).



                                                     3
ups, including Melitz and Ottaviano (2008) and Behrens and Murata (2012).4 Arkolakis,
Costinot, Donaldson, and Rodriguez-Clare (2012) is particularly relevant as it generalizes
the monopolistic competition version of the ACR framework to capture what they refer to as
“the elusive pro-competitive eﬀects of trade.” The economics of the pro-competitive eﬀect
is very diﬀerent in a monopolistic competition model than it is in the oligopoly model we
consider. In monopolistic competition, a change in the trade friction only aﬀects a domestic
firm through general equilibrium eﬀects that might shift or rotate the firm’s demand curve.
Depending on assumptions about the shape of the utility function, monopoly demand can
become more or less elastic, and domestic mark-ups can go down or up. In contrast, in
a Bertrand environment, the pro-competitive force of trade operates at the level of the
particular good, not through general equilibrium. If trade frictions are lowered, a domestic
firm limit pricing on a foreign rival will directly have to lower price (and mark-up) to meet
competition.
    The literature discussion above focuses specifically on trade. We note our paper is
also part of a broader literature on how allocative eﬃciency aﬀects aggregate productivity,
including Restuccia and Rogerson (2008), Hsieh and Klenow (2009), and Peters (2012).5


2       Model
There are a continuum of goods on the unit interval, each good indexed by . Let 
indicate a quantity of consumption good  and let q = { :  ∈ [0 1]} denote a particular
consumption bundle. Assume preferences are represented by a homothetic utility function
U(q) over a bundle q. For most results, we impose the CES form,
                                µZ     1         ¶ −1
                                                    
                                           −1
                   U(q) =               
                                                 for   0,  6= 1
                                   0
                                  µZ 1         ¶
                            = exp      ln   , for  = 1 (Cobb-Douglas).
                                           0


   For simplicity of exposition, assume there are two countries,  = 1 2. Each country has
a measure  workers. Labor is the only factor of production.
   The diﬀerent goods potentially vary in the number of firms capable of producing the
good and the productivity of the various firms. In particular, there are  diﬀerent firms
capable of producing good  at . The total number of firms for good  across the two
    4
    See also Ottaviano, Tabuchi, and Thisse (2002) for a treatment in a regional context.
    5
    Peters (2012) in particular uses an index of allocative eﬃciency to examine growth that coincides with
our measure for the case of Cobb-Douglas.



                                                         4
countries is  = 1 + 2 . Assume that  ≥ 2. Let  ∈ {1 2  } index a particular
firm located at  capable of producing good  at .
    Define  as labor requirement per unit produced of firm  located at  for good .
The inverse of  is the firm’s productivity  . Suppose we rank all  firms at  for
good  in terms of labor requirement, from lowest to highest. Let ∗ and ∗∗        be labor
requirements of the firms with the first and second lowest values. If there is only one firm
for good  at , then set ∗∗      = ∞. If there are no firms for good  at  (implying there
are two or more in the other country) then set ∗ = ∞ and ∗∗        = ∞. The third lowest
and beyond will not be relevant for pricing or production, following the standard logic of
Bertrand competition (Grossman and Helpman (1991)), which will apply here.
    We treat the labor requirements for a given good  as random draws from a joint dis-
tribution  (∗1  ∗∗   ∗ ∗∗
                     1  2  2 ) of the first and second lowest labor requirement at 1, and the
first and second lowest at 2. Our main results do not impose the restriction that labor
requirements be drawn independently across firms.
    In addition to the labor requirement, the cost of a firm at  to deliver to  will depend
upon the wage at  and the trade friction to deliver from  to . Let  denote the wage at .
Assume an iceberg trade friction  to ship from one location to the other, i.e., to deliver one
unit,  ≥ 1 units must be shipped. There is no shipping cost to deliver goods domestically.
The total costs to deliver to location 1, for the two lowest cost producers at 1, and the two
lowest cost producers at 2, are then
                               © ∗                                       ª
                                1 1  1 ∗∗
                                              1   2 ∗
                                                          2   2 ∗∗
                                                                      2 .


Let ∗1 and ∗∗
               1 be the lowest and second lowest elements of this set. Analogously, we can
define the lowest and second lowest costs ∗2 and ∗∗
                                                     2 to deliver to country 2.
    Firms compete in price in a Bertrand fashion, market by market. For a particular good
 at , we can derive a demand curve  () for  at  as a function of price , holding other
prices and income as fixed. Assume the underlying utility function is such that the demand
curve is continuously diﬀerentiable and strictly downward sloping. Suppose hypothetically
that the most eﬃcient producer of  at  were a monopolist. The monopoly price ̄ would
solve
                                             ¡         ¢
                              ̄ = arg max  − ∗  ()
                                                 
                                         
                                     =         ∗ 
                                        − 1 

i.e., the standard mark-up rule applies, where  is the elasticity of demand for  evaluated


                                                     5
at the monopoly price. (In the CES case, which is our main focus,  = .)
    In the equilibrium outcome of Bertrand competition, price will equal the minimum of the
monopoly price and the marginal cost ∗∗ of the second lowest cost firm to deliver to , i.e.,

                                              ¡           ¢
                                     = min ̄ ,∗∗
                                                        .


Define  to be the variable cost share of price for good  at ,

                                                         ∗
                                           =
                                                         

The inverse of  is the mark-up. It is notationally convenient here to focus on  rather
than its inverse, the mark-up, which is the typical focus in the literature.


3     Welfare
To define our welfare decomposition, we first introduce additional notation. Let p = { :  ∈ [0 1]}
denote a particular set of prices at . Having already assumed a homothetic utility func-
tion, without loss of generality we can further assume utility is homogeneous of degree one.
Define the price index  to be the minimum cost at  to construct a consumption bundle
delivering a unit level of utility, i.e.,
                                             Z   1
                                       ≡            ̃ ,
                                             0


where q̃ = {̃ :  ∈ [0 1]} is the expenditure-minimizing consumption bundle that solves
                                                      Z      1
                                  q̃ ≡ arg min                    ,
                                                 q       0

subject to
                                           U(q) = 1.

Let  be the share of spending at  on good ,

                                                      ̃
                                         =                  .
                                                       

    Next, let  be total revenue of firms located at  across all goods, including both domestic
sales and exports. This will equal the total income at , which is divided between labor and



                                                     6
profits,
                                               =   + Π .

   Define 
                to be the revenue-weighted mean share of variable cost in revenue across
goods with source at location . This equals
                               R                                 R
                            {: 1 ()=}
                                     ∗         1 1 1  +  {: ∗2 ()=} 2 2 2 
            
                    =       =    R                              R                               ,   (1)
                                  {: ∗1 ()=} 1 1  + {: ∗2 ()=} 2 2 

where ∗ () ∈ {1 2} denotes the source country for any particular good  at destination
. To understand (1), observe that for a good  sold at 1 with source at 1, 1 1 is the
spending at 1, by definition of 1 . Then 1 1 1 is the total variable cost for such goods,
by definition of 1 as the variable cost share. This accounts for the numerator of (1). The
denominator sums sales to 1 and 2, from source .
   Define buy
                 to be the revenue-weighted mean share of variable cost in revenue across
goods with destination at .                  Z            1
                                          buy
                                                 =              
                                                       0

    Finally, we introduce additional notation for what prices would be under marginal cost
pricing. Let the price of an individual good at marginal cost be denoted

                                                   = ∗ ,

and let  be the price index at  when all goods are priced at marginal cost. Assume
that productivity distributions are not too fat-tailed so that both price indices  and  are
finite.6
    We now present our welfare decomposition. We can write welfare at location  as


                                                1
                              =        =                                                      (2)
                                              
                                                      
                                                      1   buy
                                                                      
                                      =   ×         ×        ×
                                                       
                                                                    × buy
                                                                          

To get the first line, note that because utility is homogeneous of degree one, we can write
utility at  as income divided by the price index. To obtain the rest of the first line, we
  6
    For example, if we assume Fréchet structure of productivity draws as in BEJK, then, as in any Eaton-
Kortum models,    − 1 is required to guarantee finite price index (and hence equilibrium existence),
where  is the shape parameter of Fréchet. The larger the , the thinner the tail.



                                                        7
substitute in (1). The second line is a straightforward manipulation. We can write (2) as

                                                           buy
                                                             
                             =   × Prod ×            ×                      (3)
                                                           
                                                             

for the productive eﬃciency index Prod ,

                                                    1
                                         Prod ≡      ,
                                                    

and the allocative eﬃciency index  ,
                                                 R1          
                                                0
                                                      ̃ 
                              ≡         buy
                                               = R 1               .                        (4)
                                    ×        0
                                                      ̃ 

    The manipulation results in a decomposition (3) of welfare into four terms. Without
loss of generality we will focus on the welfare of country 1, and we will set the wage at 1 to
be the numeraire, 1 = 1. To save notation, we will then leave country subscript  implicit
(as  = 1 always). As the labor supply  will be fixed in the analysis, the first term in the
welfare decomposition is a constant that we will henceforth ignore.
    The productive eﬃciency index  Prod , the second term of (3), is what the welfare index
would be with no mark-up. It equals the inverse of  , which is the price index at marginal
cost prices. The index varies when there is technical change determining the underlying
levels of productivity. It also varies when trade cost declines, decreasing the cost of foreign
firms to deliver goods locally. Terms of trade eﬀects also show up in  Prod , because a lower
wage from a source country will raise the index.
    The third and fourth terms depend upon mark-ups, or equivalently, the inverse of the
mark-ups which are the cost shares. In ACR, and in the broader literature that it encom-
passes, trade has no eﬀect on the distribution of mark-ups, and so it has no eﬀect on the
third and fourth terms. Thus in ACR, the welfare eﬀects of trade operate entirely through
the eﬀects on the productive eﬃciency index  Prod .
    The third term is a “terms of trade” eﬀect on mark-ups. Holding fixed the other
components of welfare, total welfare is higher in country 1, if the cost share of price in
the goods that it purchases tends to be high relative to the cost share of price in the goods
that it sells. In a symmetric version of the model where the two countries are mirror images
of each other, the “buy” cost share will equal to the “sell” cost share, and the third term
will drop out.
    The fourth term is the allocative eﬃciency index   , the main focus of this paper. The
expression (4) presents two alternative ways to write   . The first way writes it as the ratio

                                               8
of the price indexes under marginal cost and actual pricing, divided by the mean variable
cost share of price.
    For the second way, consider two bundles, q̃ and q̃, that deliver one unit of utility.
Bundle q̃ minimizes expenditure at marginal cost pricing, while bundle q̃ minimizes ex-
penditure at actual prices. The second way of writing the allocative eﬃciency index is as
the ratio of expenditure on these two bundles, evaluated at marginal cost pricing. It is
immediate that   ≤ 1, since bundle q̃ minimizes expenditure at marginal cost pricing
by definition. Suppose in the actual price vector, the mark-up is constant across all goods
, i.e., that the ratio between any two actual prices is the same as what the ratio would be
with marginal cost pricing. Then q̃ = q̃ and   = 1. Otherwise    1.


4     Allocative Eﬃciency and Trade
When evaluating the eﬀect of a change in the trade friction, it is convenient to take logs and
conduct the analysis in elasticity terms,

                                   ln   
                        ≡                 = Prod + __ +  ,
                                      ln 

where  is the elasticity for component . (The first term 1 1 of (3) is a constant given
the normalization 1 = 1, so we ignore this term.) In particular, we define the allocative
eﬃciency elasticity   to be

                                                   ln  
                                            ≡            
                                                    ln 
   This section derives a formula for   that decomposes it into two components: the cost-
change channel and the price-change channel. Note in the introduction, we referred to a
decrease in  , in order to discuss gains from trade. However, for expositional simplicity
going forward, we refer to an increase in  , because if we did otherwise, we would have to
carry around an extra minus sign.


4.1    Decomposing   into the Cost-Change and Price-Change Chan-
       nels
We need to introduce additional notation to allow us to distinguish various cases. When
a good is being purchased from a domestic firm, there are three possibilities: the domestic
firm may be limit pricing on another domestic firm, limit pricing on a foreign firm, or setting
the unconstrained monopoly price. Analogously, there are three possibilities when a good

                                                  9
is purchased from a foreign firm. We index these six diﬀerent possibilities by the elements
of {11 12 1̄ 21 22 2̄}, where “11” means a firm at 1 is limit pricing on a firm at 1 (i.e.
domestic on domestic), “12” means a firm at 1 is limit pricing on a firm at 2, and 1̄ means
a firm at 1 is setting the monopoly price. Analogously, “21,” means a firm at 2 is limit
pricing on a firm at 1, and so on. Let Ω11 be the set of products with event “11”, Ω12 be
the products with event “12,” and so on.
    For tractability, we assume CES utility in this and the next sections. For allocative
eﬃciency   , only buy is involved, and hence we suppress superscript “buy” to save
notation. Let Ω be the expected (or mean) value of the sales-weighted cost share  ,
conditional on  ∈ Ω, for some subset of goods Ω. Analogously, let 1−         Ω   be the sales-
                                 1−
weighted expected value of          conditional on Ω.
    Let p and m denote the vector of prices and marginal costs of the lowest cost firms
supplying at 1, i.e., the element  is the price of the lowest cost firm and  is the marginal
cost, including any trade friction incurred (and again  =   ). Given p and m,
spending shares are determined by consumer choice, and we can calculate allocative eﬃciency
  through equation (4). To understand how a change in the friction  aﬀects   , we
need to first determine how a change in  aﬀects p and m, and then how   changes with
new values of p and m.
    In our decomposition, we separate out how a change in  aﬀects costs m (the cost
channel) and how it aﬀects prices p (the price channel). What an increase in  does to m is
straightforward: all foreign firms that are exporting to country 1 experience a proportionate
increase in costs. Next consider what an increase in  does to p. A domestic firm that is
limit pricing on a foreign firm’s cost (event “12”) will be able to increase price proportionately
as  increases. Analogously, a foreign firm limit pricing on another foreign firm (event “22”)
proportionately increases price. Finally, a foreign firm that is setting the monopoly price
(event “2̄”) proportionately increase price (as price is a constant mark-up  ( − 1) over
cost). Denote the three events where price rises proportionately with  as

                                     Ω↑ ≡ Ω12 ∪ Ω22 ∪ Ω2̄ .                                  (5)

    Denote the relative wage of country 2 to country 1 as . Let  denote the proportion
of increase of  , i.e., let   =  ◦ ◦ , where  ◦ and ◦ are the initial trade friction and
relative wage. A change in  aﬀects costs m such that

                                    () = ◦ ,  ∈ Ω2 ,                                   (6)
                                    () = ◦ ,  ∈
                                                     Ω2 ,


                                               10
where Ω2 is the set of goods at 1 that are imported from country 2. Similarly, a change in
 aﬀects prices p for the set Ω↑ such that

                                         () = ◦ ,  ∈ Ω↑ ,                                      (7)
                                                          Ω↑ .
                                         () = ◦ ,  ∈

     We now present our main result that decomposes the overall eﬀect of an increase in
 on allocative eﬃciency
                      ¯           into two components, a cost channel and a price channel. Let
         ln   (1) ¯
 cost ≡            ¯        denote the derivative of ln   () evaluated at  = 1 while keeping
                       p fixed                           ¯
                                            ln   (1) ¯
prices p fixed. Similarly,  price ≡                   ¯         is the derivative of ln   evaluated at
                                                           m fixed
 = 1 while keeping costs m fixed. We have

Proposition 1

                                              ln  
                                   ≡
                                               ln 
                                             ¡               ¢ 1  ( )
                                           =  cost +  
                                                        price             
                                                                 

where
                                                    µ         ¶
                                                  1−
                                                     2    2
                                   
                                    cost     = 2       −       ,                                      (8)
                                                  1−   
                                                     µ          ¶
                                                          Ω↑
                                  
                                   price     = −Ω↑ 1 −         ,                                    (9)
                                                           

and where the subset Ω↑ is defined by equation (5).

Proof. We sketch the proof for Cobb-Douglas ( = 1) and symmetric countries. The
appendix provides a formal proof for general  and general asymmetry. Under Cobb-
Douglas, we can write the log of allocative eﬃciency as
                         µ          ¶
                      
           ln  = ln                    = [ ln  −  ln ] − ln () =  ln  − ln () ,            (10)
                      × 

where we use the price index formula  = exp( ln ) that applies for the Cobb-Douglas
case. With symmetric countries, we can assume 1 = 2 = 1. We separate out the eﬀects
of changes in  on costs, from eﬀects through changes in prices. Following the notation of




                                                        11
(6) and keeping prices p fixed, we write
                                            (
                                                
                                                 
                                                               ∈ Ω2 ,
                                  () =       
                                                                                           (11)
                                                 
                                                              ∈
                                                                Ω2 .

Note that  ln  =  ln . On account of the proportionate cost change for imports, we have

                ln     ln  (1)                         (1)
                       =             = 1,                    =         =  ,  ∈ Ω2 ,
                ln                                 ln      
                ln     ln  (1)
                       =             = 0,                                     ∈
                                                                                Ω2 .
                ln         

Diﬀerentiating (10) yields
                                    ¯          Z            R           µ        ¶
                       ln   (1) ¯¯                           
                                                             Ω2             2
            
             cost   =               ¯        =     1 ·  −         = 2 1 −       .       (12)
                                   p fixed    Ω2                         

     Calculating the price channel price is analogous, but opposite in sign, since price is in
the denominator of the cost share of price. In the proof above, we have switched the order
of diﬀerentiation and integration. In the appendix, we show why this can be done. Note we
haven’t mentioned how a change in  aﬀects the sets Ω2 and Ω↑ , because the changes in
these sets have no first-order eﬀects.
     For Cobb-Douglas, the cost-change channel (8) boils down to the particularly intuitive
expression (12). An increase in  proportionately increases costs for all imported goods.
To understand the eﬀects on allocative eﬃciency, holding prices fixed, we only need to
compare the mean cost share 2 on imported goods, which all get a cost increase, with
the overall cost share . In particular, if 2 is greater than , the eﬀect of higher
 on allocative eﬃciency through this channel is strictly negative. In this case, higher 
increases the mark-up discrepancy between the imported and domestic goods, exacerbating
the distortion. Formula (12) also depends upon the spending share 2 on imports, and it
is intuitive that this should matter. Next note that for the general  case, formula (8) for
the cost-change channel is similar to what it is in the Cobb-Douglas case, with an additional
term that takes into account that spending shares across goods are not constant, outside of
the Cobb-Douglas case. Finally, the intuition for the price-change channel is similar to the
intuition for the cost-change channel.
     We make two comments about Proposition 1. The first is about the additional term
 1

   ( ) in the decomposition in Proposition 1 taking into account that  can aﬀect the
relative wage between countries. With symmetric countries, the relative wage  = 1, and
this adjustment drops out (i.e., it equals one as a multiplicative term). More generally, we

                                                  12
expect the sign of ( ) to be strictly positive, i.e. an increase in the friction increases
relative cost in the foreign country, even taking into account any potentially oﬀsetting eﬀect
on the relative wage. Hence, the sign of   is the same as                
                                                                    cost +  price . In what follows
we fill focus on the sign of         
                              cost +  price , and its decomposition into the cost-change channel
                                 
 cost and price-change channel  price .
    The second comment concerns how it might be possible to estimate the cost and price
channels in empirical applications. Suppose we have product-level data on mark-ups and
sales volumes, where imported and domestic products are separately classified. This is a
stringent data requirement, but one that is potentially attainable, as access to micro data
sets has expanded, and data sets from diﬀerent countries are combined. If we also have
knowledge of the  parameter (a common parameter needed in trade analyses), the cost-
change channel given by equation (8) can be directly calculated. (It uses two moments of
the data.) Calculating the price-change channel (9) is more daunting, because we need to
know which firms would raise price if the friction increases. Perhaps data on how prices
change after a tariﬀ change would be of help here. In lieu of obtaining a point estimate of
the price-change channel, in applications it may be possible to use the formula to bound
the price-chance channel. Combining this bound with a point estimate on the cost-change
channel will produce a bound on the overall eﬀect on allocative eﬃciency.


4.2       Signing the Cost-Change and Price-Change Channels
In this subsection we discuss the signs of the two components. We begin by examining two
limiting cases where we find that both the cost-change and price-change channels are zero.
We then discuss why in general the channels are nonzero away from the limiting cases.
    The first limiting case is the BEJK model which imposes a particular Fréchet structure
on the distribution of productivities across firms. In particular, BEJK assume that the
distribution of two top productivities each country  follows
                                       £      ¡         ¢¤ − −
            Pr [1 ≤ 1  2 ≤ 2 ] = 1 +  −   −
                                                2 − 1         2                   for 0 ≤ 2 ≤ 1 .   (13)

As de Blas and Russ (2012) show, in a Bertrand oligopoly model like the one here, the
distribution above is in fact the limiting distribution, when the number of firms goes to
infinity, and firms draw their productivities from a fat-tailed distribution, such as the Pareto
and Fréchet itself.7 We obtain the following result about the allocative eﬃciency elasticity
 and its components              
                          cost and  price for this case:

  7
      That is, a distribution that falls in the domain of attraction for Fréchet.



                                                        13
Proposition 2 If firms draw their productivities from a fat-tailed distribution, in the limit
where the number of firms goes to infinity, the overall   = 0, as well as the components,
              
 cost = 0 and  price = 0.


Proof. Under said conditions, (13) holds, and the limit model is BEJK. In BEJK, the
equilibrium share of variable cost in revenue is invariant to source country, and in particular,
is the same for imports as it is overall, i.e., 2 = . It is easily verified that 1− = 1−
                                                                                                2  ,
using similar proof to that in BEJK. By (8),       cost = 0. Furthermore, in BEJK, the overall
distribution of mark-ups is invariant to  , implying that   = 0. The decomposition in
Proposition 1, and   =                                         
                            cost = 0, immediately imply that  price = 0.
    A key result of BEJK is that the mark-up for foreign firms are the same as for domestic
firms. Foreign firms have to pay a trade friction that domestic firms avoid. Everything else
the same, this would drive up a foreign firm’s cost and lower the mark-up relative to domestic
firms. However, a second consideration is a selection process over productivity. On average,
foreign firms need to be more productive to overcome the trade friction disadvantage. In
the BEJK Fréchet structure, the two forces exactly counterbalance, implying that cost share
for imports 2 is identical to the overall share , which means           cost = 0. It turns out
                                          ↑
that mark-ups on the set of goods Ω where price increases in  are also the same as the
overall average, and so  
                          price = 0, as well.
    We next consider a second limiting case where countries are symmetric and the friction
is small.

Proposition 3 If countries are symmetric then at  = 1,

                                      =         
                                           cost =  price = 0,


while
                                             Prod  0.

Proof. With symmetry and  = 1, it is immediate that the distribution of the cost share of
price is the same regardless of whether a good originates at country 1 or country 2. This
implies 2 = , and 1−
                         2    = 1− , and thus  
                                                   cost = 0. Next observe that from symmetry
and  = 1, that 12 = 21 , and 12 = 21 . This implies Ω↑ = 2 and Ω↑ = 2 , and
thus  
       price = 0. Next,


                                          ln  Prod     ln 
                                 Prod ≡             =−
                                             ln        ln 
                                       = −2 ,

                                                14
where  2 is the import share of spending at marginal cost prices.        The first line above
follows from the definition of  Prod , and the second line is a straightforward application of
the envelope theorem. Note we use the fact that on account of symmetry,  = 1 and hence
                                                                        1
( ) = 1. The result that  Prod  0 then follows because   2 = 2 at the limit of  = 1,
on account of symmetry.
    Proposition 3 says that adding a small friction to trade between symmetric countries has
no first-order eﬀect on allocative eﬃciency. To see the intuition, observe that at the limit
with no trade frictions, foreign firms are just like domestic firms, and in particular, have the
same distribution of cost shares, implying that the cost-change term is zero. Analogously,
the price-change term is zero. While there is no first-order eﬀect on allocative eﬃciency,
there is a first-order eﬀect on productive eﬃciency at the limit. Thus, in this part of the
parameter space, the issue of allocative eﬃciency is negligible relative to the productivity
eﬀects of  .8 In other words, with symmetry and small frictions, to a first approximation is
it safe to abstract from the issue of how trade frictions aﬀect allocative eﬃciency.
    We turn now to more general environments away from these limiting cases. We begin with
a discussion of the price-change term. To focus the discussion, we consider an environment
in which there are no imports in equilibrium, in which case the cost-change term (8) is zero.
(This is because 2 = 0; we also note that  Prod = 0 for this case.) Specifically, assume there
are two sectors,  and . In sector  there is one firm for each good in each country,
and assume that productivity is identical for the two firms. The domestic firm will limit
price on the foreign firm, and the cost share in sector  equals  = 1 .9 For sector ,
we consider two possibilities. In the first case there are two firms in each country with
equal productivity. With Bertrand competition, price equals marginal cost, and  = 1.
In the second case there is a single firm in each country, and we assume the sector B good
is nontradable, so the single firm is a monopolist. Assuming elastic demand for this case,
  1, the cost share in sector  is  = ( − 1) . In either case, price increases with
 for the sector  goods, and doesn’t change for the sector  goods. It is convenient to
rewrite the price-change channel in equation (9) as
                                                         µ               ¶
                                                              − 
                                    
                                     price   = −                        .
                                                                

In the first case where sector B is competitive and  = 1, it follows that  
                                                                               price  0.

   8
      This point is contingent on  being a true resource friction as opposed to a tariﬀ for which welfare weight
is put on tariﬀ revenue collections. In this case, following the usual logic, the first-order eﬀect on  P rod
will be oﬀset by a change in tariﬀ revenue.
    9
      Assume    ( − 1). Otherwise domestic firms set the simple monopoly price and increases in  are
irrelevant.


                                                       15
Raising  allows the sector A firms to lower the cost share of price even further below the
competitive case (where it equals one), increasing distortions. In the second case where
sector B is monopoly, and    , it follows that   price  0. Raising  makes the sector
 firms more similar to the monopoly firms in sector B. As the mark-ups in the two sectors
get closer together, allocative eﬃciency increases. This discussion makes clear that while
the price-change component is zero in the limiting cases considered in Propositions 2 and 3,
in general the eﬀect can go either way, depending on how mark-ups for the goods getting
price increases compare with mark-ups for goods with unchanged prices.
    In terms of the previous literature, we can interpret the price-change channel as capturing
the “pro-competitive” eﬀect of trade, as changes in  yield changes in price, through Bertrand
competition. Our discussion then shows how the pro-competitive eﬀect of trade has an
ambiguous eﬀect on allocative eﬃciency.
    We next turn to the cost-change component. We focus on the symmetric country case.
In the literature it is standard to consider models where firms take i.i.d. productivity draws
from either a log-normal or Pareto distribution. We follow that approach here, and consider
both distributions. For the Pareto, the functional form is

                                      () = 1 − − ,  ≥ 1,

for productivity  = 1 equal to the inverse of the labor requirement . The parameter 
is the shape parameter, where the larger is , the more similar the draws. (There is also a
scaling parameter that we normalize to one.) For the log-normal, we assume that log() (for
  0) is distributed normal with unit mean and standard deviation 1 . For the numerical
example we set  = 5 for the Pareto and  = 387 for the log-normal, which holds the
coeﬃcient of variation constant across the two cases. (Our qualitative results are similar
for alternative values of the coeﬃcient of variation.)
     Table 1 presents numerical results for a variety of cases. In each example, the number of
firms per good is the same across all goods, and we consider the case of 2 firms per good, 4
firms per good, and 6 firms per good, with the firms equally divided across the two countries.
We consider various levels of . In the table, we have fixed  = 15 throughout. (We obtain
qualitatively similar results for other values of  , away from the limit of   1.) For each
parameter set, the table reports in the last three columns the allocative eﬃciency elasticity
  , and its decomposition into              
                                     cost and  price . For reference, the table also reports the
import share 2 and the productive eﬃciency elasticity  Prod .
     Table 1 provides another illustration of the point that   price can be negative or positive.
At high values of ,  
                       price tends to be positive. For intuition, consider that when  is high,
a relatively large fraction of firms set the interior monopoly price. In such cases, when 

                                                16
increases, those domestic firms limit pricing on foreign firms are able to raise mark-ups closer
to the monopoly mark-ups most other firms are setting, raising allocative eﬃciency. In the
opposite case when  is low, in particular  ≤ 1, all firms limit price, and             price is strictly
negative.
     Next note that   cost ≤ 0 in each of the cases illustrated in Table 1. For log-normal,  cost
                                                                                                         

is negative throughout all range of parameters. For Pareto,            cost is negative when there are
two firms for each good (thus one in each country) and 0 when there are more than two
firms. We have used numerical analysis to verify this pattern holds more broadly in the
symmetric country model with each firm drawing from the Pareto or log-normal, and each
good having the same number of firms.10 Our numerical analysis has also looked at the
uniform distribution and found that it behaves similarly to log-normal in terms of              cost . The
key point is that in this class of models, the cost share of price tends to be higher for imported
goods. The direct eﬀect of the friction on a higher cost share for imports is not completely
oﬀset by the selection eﬀect of higher productivity, in contrast to BEJK, where these forces
exactly counterbalance. Thus 2  . Also, if   1, we can expect 1−                  2    ≤ 1− ,
                                                                                    1−
which together with formula (8) imply that           cost  0. If   1, the 2      1− term goes
the other way. However, in the numerical analysis, we find the net eﬀect remains negative,
cost ≤ 0.
     When                                                                       
             price is also negative, it reinforces the negative eﬀect of  cost , and the combined
eﬀect  =              
                price +  cost can be large in absolute value, and similar in magnitude to the
productivity eﬀect  Prod . When        price is positive, there are cases where it more than oﬀsets
the negative eﬀect of                                               
                            cost , resulting in combined eﬀect  that is positive. For example,
this is true with 2 firms, log-normal draws, and  = 4, where the overall allocative eﬃciency
elasticity is .035. In this case, a higher trade friction raises allocative eﬃciency.
     Our last point about Table 1 concerns the comparison between the log-normal and Pareto
cases. When there are two firms for each good (again one in each country), the log-normal
and Pareto cases are qualitatively the same. However, under the Pareto, when there two or
more firms per good in each country,                     
                                               cost and  price are both virtually zero. The log-normal
is very diﬀerent; while                
                             cost and  price do shrink in magnitude as we add more firms, they do
not collapse to zero. Recall from the above discussion that if we take the Pareto model with
 draws, and make  large, the model goes to the Fréchet structure of BEJK. Therefore,
with the Pareto in the limiting case of large , the eﬀects are zero (Proposition 3). It is
interesting to see that as far as allocative eﬃciency is concerned (and specifically how 
relates to it), the Pareto model begins to approximate the limiting case with as little as two
draws in each country.
  10
       The appendix provides details about our numerical analysis.


                                                      17
    The sharp diﬀerences in implications between the Pareto and log-normal, and the frequent
use of both distributions in the literature, motivate the next section where we explore this
issue further.


5      Allocative Eﬃciency with the Pareto and Log-normal
In this section we explore how allocative eﬃciency changes as the market becomes large and
previously separated economies become integrated. In particular, we consider changes from
 = ∞ where countries are in autarky, to  = 1, where diﬀerent countries are completely
integrated into one economy. Let there be 1 firms for each good in country 1, and 2 firms
for each good in country 2. In autarky, only 1 firms compete to sell in country 1. After
integration,  = 1 + 2 compete to sell in country 1. Hence, integration is equivalent to
an increase in the number of firms. In this section we ask: How does allocative eﬃciency
  vary as we increase the number of firms and integrate economies? And how does the
answer depend upon whether firms draw from Pareto or log-normal?
    For a given product , let ∗ and ∗∗
                                          be the first and second highest of  independent
                                  ∗∗   ∗
productivity draws. Let  ≡   be the ratio of the second highest to highest. It is
well known that under the Pareto, the distribution of the ratio  is invariant to the number
of draws.11 The Pareto maintains its relative shape, as we push out into the tail. For our
next result, we need a slightly diﬀerent statement of this property, where we condition on
the second highest level of productivity ∗∗ , as well as the number of draws . Formally, let
(| ∗∗ ) be the cumulative probability of this ratio conditional on  and ∗∗ . The Pareto
has the following property.

Lemma 1 Under the Pareto, (| ∗∗ ) =  ,  ∈ [0 1], that is, the distribution of the ratio
of second to first best does not depend upon the number of draws or what the second best is.

Proof. Observe that                                 R∞
                                                      ∗∗    (∗  ∗∗ ) ∗
                                          ∗∗
                                    (|  ) = R ∞   
                                                                                
                                                      ∗∗
                                                             (∗  ∗∗ ) 
where  denotes the joint density of top two order statistics from a Pareto distribution, and
the result is immediate by plugging in this density function.
                                                                ©      ª
   The cost share satisfies  =  , if  ≤ 1 and  = max   −1 
                                                                          for   1. Given
                                                                  ∗∗
Lemma 1, the distribution of mark-ups is independent of  and  and is a truncated Pareto,
analogous to BEJK. Using this fact we can show
  11
    Malika and Trudela (1982), for example, characterizes the distribution of the ratio of all order-statistics
of the Pareto. See also the discussion in de Blas and Russ (2012) .


                                                      18
Proposition 4 Under the Pareto, allocative eﬃciency is a constant    1 that does not
vary with the number of firms . Therefore, a trade opening that is equivalent to an increase
in the number of firms has no eﬀect on allocative eﬃciency.

Proof. See the appendix.
   The key step of the proof is that since the distribution of cost shares is invariant to , the
actual price index  and the price index  under marginal cost pricing decrease by the same
proportion, as  increases. >From formula (4) for   , it is immediate that   remains
constant. We note there is allocative ineﬃciency for any given value of , i.e.    1.
The point is that its level does not change as economies integrate and  increases.
   The outcome is quite diﬀerent for the log-normal.

Proposition 5 If the distribution of the ratio  = ∗∗ ∗ , given second best ∗∗ and the
number of firms , is degenerate at  = 1 in the limit as  → ∞, then

                                         lim   = 1.
                                         →∞


Under the log-normal, the above condition is satisfied. Thus, under the log-normal, while
   1 for any finite , allocative ineﬃciency is eliminated in the limit as the market
becomes large.

Proof. See the appendix.
    For intuition, consider a case where firms draw from a bounded productivity distribution.
When there are many draws, the highest and second highest will both tend to be close
to the upper bound, and the ratio will be close to one. Limit prices will be close to
the competitive level, with the cost shares of price close to one, where first-best allocative
eﬃciency is achieved. This notion of compression at the top, when markets are large and
there are many firms, is consistent with the discussion in Syverson (2004) and Combes et
al. (2012). Proposition 5 shows that even though the log-normal is unbounded, the right
tail is suﬃciently thin enough that the implication for allocative eﬃciency in the limit is
the same as for the bounded case. In contrast, the Pareto is very diﬀerent. The tail is
suﬃciently fat that even with many draws, there is no sense that the first and second highest
get compressed together. In fact, the relationship doesn’t change at all.


6     Conclusion
We examine how trade aﬀects a measure of allocative eﬃciency, deriving formulas for two
components of welfare change, the cost-change channel and the price-change channel. Both

                                               19
channels are negligible if (i) frictions are negligible and countries are symmetric or (ii) firms
draw productivity from Pareto-like distributions. More generally, trade aﬀects allocative eﬃ-
ciency. In symmetric models, the cost-change channel leads to gains in allocative eﬃciency,
that reinforce the standard production eﬃciency gains from trade. When demand tends
to be inelastic, the price-change channel leads to additional gains in allocative eﬃciency.
However, if demand is elastic, the price-change channel goes the other way.
    We also consider a limit economy where we increase the number of competitors for each
good, and find a sharp diﬀerence between what happens when firms draw from a Pareto-like
distribution compared to when the distribution has less of a fat tail, like the log-normal. In
the former case, distortions in allocative eﬃciency never go away, as the market gets big.
In the later, the economy converges to first-best allocative eﬃciency. The result highlights
the important role functional form assumptions can play, in quantitative models of the gains
from trade.


Appendix
Proof of Proposition 1
Observe that
                                          ¯             Ã                    !
                                ln   ¯¯                ln   1  ( )
                             ≡                        = ( ◦ ◦ )
                                   ln  ¯ = ◦ =◦               ◦ 
                                                             ◦ ◦           =1
                                                        ¯
                                        
                                 ln  (1) 1  ( ) ¯  ¯
                              =                                      
                                           ◦  ¯ = ◦ =◦

Note that for CES utility,

                                              1−
                                               
                                      =                                                                              (14)
                                               1−
                                              −
                                                                         −
                                                                           
                                     ̃    =       = ³R                            
                                                                                ´ −1                                   (15)
                                               −       1
                                                                  1− 
                                                                 0 


                                                                  ln   (1)
Using (4) and (15), we can express ln   and                         
                                                                                as
                                            Z   1                     Z   1                         Z      1
                              1                                                            
           ln            = −     ln                1−
                                                         − ln               −
                                                                                      +     ln              1−
                                                                                                                 
                              −1                                                          −1
                                        
                                            R01                   
                                                                      R01                       
                                                                                                    R 01
            
       ln  (1)      1                    0
                                               1−
                                                          0 
                                                                 1− 
                                                                        0
                                                                             −
                                                                                            
                 = −     R1         − R1           +       R1            
                   −1    1− 
                                         − 
                                             
                                                      − 1     1− 
                          0            0                    0 


                                                            20
We will later show that
                                      Z 1            Z 1
                                           1−                1−
                                            =                                                (16)
                                   0                       
                                       Z 1           Z0 1
                                                              1−
                                           1−  =                                            (17)
                                    0                      
                                    Z 1              Z0 1
                                                             
                                         −
                                               =              −
                                                                                                (18)
                                 0                  0      
               R1                                R1
Recall that     0
                    1−
                       = 
                              1−
                                  , and that       0
                                                       1−
                                                          = 
                                                                 1−
                                                                     . By the above, we obtain
                           R 1  1−          R1                           R 1  1−
   ln   (1)       1            
                            0  
                                                      − 
                                                0                        0  
                                                                                     
               = −          R1             − R1                 +             R1
                 −1          1−
                                                  −
                                                          
                                                                   −1             1− 
                              0                  0                              0 
                 (R                 R                 )    (  R                         R             )
                          1−                  −                          −                  1−
                                                              
                                                                                              
                    Ω
                                  − RΩ12                                            −  RΩ1 
                                                                 ↑                        ↑
               =   R 12                                  +  RΩ1
                          1−
                                            −
                                                                   −
                                                                                       1− 
                 ⎧ 0             ⎛R 0                        R
                                                                0
                                                                                      ⎞  ⎫0 

                 ⎨ R 1− 
                 ⎪                                                       1−
                                                                                     ⎪
                                                  1−
                                         1−                          
                                                                                         ⎬
                                                            Ω2          1−
                    Ω2           ⎜ Ω2  Ω    1−
                                                                       Ω2         ⎟
               =                  ⎝    R  1 1−            −      R  1                ⎠
                 ⎪
                 ⎩ 
                         1−
                                                                                ⎪
                                                                                         ⎭
                                         0                         0  
                   ⎧                 R                                              ⎫
                   ⎨ R 1−  Ω↑   1−                R
                                                    1−

                           ↑                  Ω↑                Ω↑ 
                                                                           ⎬
                                                                           1−
                 +  Ω 1−                R 1 1−           −  
                   ⎩                                                1−       ⎭
                                           0   1−
                 ½ µ 1−                ¶¾ ½               µ               ¶¾
                        Ω        Ω                            Ω↑
               =  2             −            + −Ω↑ 1 −                       
                        1−                                     

In each line above, the first large bracket is the cost channel and the second the price channel.
    We are left to show that (16) to (18) hold. For this purpose, we first recall the Lebesgue
dominated convergence theorem, which states that if { } is a sequence of Lebesgue-integrable
functions on an interval  which converges almost everywhere on  to a limit function , then
R               R
 
    = lim→∞  , provided that there exists a nonnegative, Lebesgue-integrable function
 such that, for all , | ()| ≤  () almost everywhere on .12
    We start with proving (16). Define

                                                         1−
                                             () ≡       
                                                        

Consider a sequence {  } such that lim→∞   = 1. Define a sequence of functions { }
 12
      Theorem 10.27, Apostol, T. M., Mathematical Analysis (second edition), page 270.




                                                       21
such that
                                                  1−       1−
                                                      − 
                                          () =                ,
                                                       − 1
where  is  associated with . Note that  ≡ 1 .
   Since
              Z 1                R 1 1−         R1             Z 1
                  1−            0
                                        − 0 1−
                                                     
                    = lim                              = lim      () 
            0            →∞               − 1         →∞ 0


and                    Z                     Z                         Z
                            1                    1                         1
                                  1−
                                    =             lim  ()  =            () ,
                        0                   0 →∞                   0

we complete the proof by showing that the Lebesgue dominated convergence theorem holds.
Note that  () is integrable by assumption that the price index under marginal cost pricing
 is finite. Also note that  () →  () by construction. Hence, we need to find an
nonnegative, integrable  such that | ()| ≤  () for all .
                     ©             ª
    Since  = min ∗1   ∗2 , when  changes from 1, the proportion of change in 
is less than or equal to . Specifically, when    1,    ≤    , and when    1,
   ≥    . Hence,
                                       ¯             ¯
                                       ¯ 1− − 1− ¯ ¯¯  1− − 1 ¯¯
                                       ¯        ¯ ¯            ¯ 1− 
                            | ()| = ¯             ¯≤¯                                          (19)
                                       ¯     − 1   ¯      − 1 ¯ 

By the mean value theorem, for each  there exists ̂  between 1 and   such that
                                                        ¯
                                (  )1− − 1    1− ¯¯
                                              =             = (1 − ) ̂ −
                                                                          
                                    − 1         ¯=̂ 

Thus, we obtain
                            | ()| ≤ |1 − | × sup ̂ −   1−
                                                         ×    ≡  () 
                                                       

That  () is integrable follows from the fact that  is finite.
    For the proof of (17), simply observe that for when    1,    ≤    , and when
   1,    ≥    , and thus the key inequality (19) holds with  replaced with . The
rest of the proof is the same with  replaced with  (and  replaced with  ).
                                                                        −          −
                                                                                  − 
    For the proof of (18), define  () =     ( −
                                                      ) and  () =           −1
                                                                                              . Because
                                                                                           




                                                       22
 ≤  ,
                   ¯       ³             ´ ¡              ¢ − ¯¯ µ¯
                   ¯       −
                                   − −
                                          +          −                      ¯        ¶
                   ¯                          ¯    ¯  − − 1 ¯
       | ()| = ¯¯                                            ¯≤ ¯
                                                                ¯  ¯
                                                                             ¯   + 1 1−
                                                                                          
                   ¯                    − 1                   ¯      − 1 ¯

The rest of the proof is similar.


Proof of Proposition 4
As the distribution of  is not degenerate,    1. We want to show that   is inde-
pendent of the number of firms . Given , denote the joint density of the first and second
highest productivities as  (∗  ∗∗ ), and the marginal density of the first and second high-
est productivity as 1 (∗ ) and 2 (∗∗ ), respectively. Let  () be an arbitrary continuous
function of  = ∗∗ ∗ . Then,
Z      µ         ¶                     µ µ ∗∗ ¶          ¶                    Z
           ∗∗
              (∗  ∗∗ ) ∗                
                           = ∗              |   =  ( () |  ) =  ()  (| ∗∗ ) ,
                                                    ∗∗                 ∗∗
 ∗        ∗ 2 (  ∗∗ )                    ∗
                                                                               
                                                                                          (20)
                             ∗∗
which is independent of  and  by Lemma 1.
                                              ©  ∗∗ ª
    For CES utility,  (∗  ∗∗ ) = 1∗∗ min −1  ∗
                                                       1 , and

                     Z           µ   ¶1− "Z µ    ½            ∗∗
                                                                    ¾¶1−       ∗    ∗∗
                                                                                             #
                                  1                                       (      )
      1−       =   2 (∗∗ )               min                 1                      ∗ ∗∗ (21)
                                 ∗∗                  − 1 ∗               2 (∗∗ )
                   "Z µ      ½             ¾¶1−                    #Z µ ¶
                                                                               1−
                                   ∗∗           (∗  ∗∗ ) ∗         1
                 =      min              1                                       2 (∗∗ ) ∗∗ ,(22)
                                 − 1 ∗          2 (∗∗ )             ∗∗

where the last equality follows from the fact that the bracket term is independent of ∗∗ ,
                                    © ∗∗      ª
as (20) explains. Note that  = max ∗  −1
                                           
                                               . Using the definition of , (14), (22), and
Lemma 1,

       
       R¡        ¢
              1 1−             Z      ½ ∗∗            ¾µ        ½             ¾¶1−
             ∗∗
                2 (∗∗ ) ∗∗           −1                        ∗∗            (∗  ∗∗ ) ∗
    =                             max                       min             1                    
               1−                       ∗                       − 1 ∗           2 (∗∗ )
      R    © ∗∗       ª¡      ©  ∗∗ ª¢1−  (∗ ∗∗ ) ∗
        max ∗  −1
                   
                         min −1   ∗
                                      1         2 (∗∗ )
                                                            
    =       R¡       ©  ∗∗ ª¢1−  (∗ ∗∗ )               
                min −1 ∗  1                    ∗
                                             ∗∗
                                       2 ( )

                                                         
which is independent of ∗∗ and . As   ≡             ×
                                                             ,   we are done if  is also independent



                                                      23
of . From (22),
 µ       ¶1−       R 1−                       R ¡ 1 ¢1−
                                              ∗
                                                            1 (∗ ) ∗
                  = R 1−  = hR ¡   ©  ∗∗ ª¢1−  (∗ ∗∗ )      iR ¡ ¢                   .
                            min −1 ∗  1                  ∗      1 1−       ∗∗
                                                                                2 ( ) ∗∗
                                                      2 (∗∗ )         ∗∗


As mentioned, the bracket term in the denominator is independent of ∗∗ and . By Lemma
1,

           R ¡ 1 ¢1−                          R hR ¡ ∗∗ ¢1−    (∗ ∗∗ )
                                                                                     i¡       ¢
                                                                                           1 1−
                                ∗
                         1 ( )  ∗
                                                       ∗         2 (∗∗ )
                                                                               ∗        ∗∗
                                                                                                   2 (∗∗ ) ∗∗
                ∗
          R¡       ¢                       =                     R¡       ¢
                1 1−                                                  1 1−
               ∗∗       2 (∗∗ ) ∗∗                              ∗∗   (∗∗ ) ∗∗
                                                                               2
                                               Z µ       ¶1−
                                                     ∗∗                  ∗
                                                               (   ) ∗ ∗∗
                                           =           ∗
                                                                           ,
                                                              2 (∗∗ )

which is independent of ∗∗ and . Thus,  is, indeed, independent of .


Proof of Proposition 5
We first show that if  (| ∗∗ ) is degenerate at  = 1 as  → ∞, that is, if  (| ∗∗ ) → 0
                                                                              ¡     ©        ª¢
for any   1 as  → ∞, then   → 1. Under the said condition,  =  max 1  −1       
                                                                                                →
                             
1 as  → ∞. As   ≡  ×      ,   → 1 if  → 1 when  → ∞.
    Use the same notation of  , 1 , 2 , and  as those in the proof of Proposition 4. Note
      R    ¡ ∗∗ ¢ (∗ ∗∗ ) ∗ R
that ∗  ∗ 2 (∗∗ )
                             =   ()  (| ∗∗ )  approaches  (1) when  → ∞. Hence,
using (21), we have
          µ       ¶1−                              R ¡ 1 ¢1−
                                                        ∗     1 (∗ ) ∗
                          = R ¡ ¢1−               hR ¡    ©  ∗∗ ª¢1−                                       i          (23)
                               1
                                        2 (∗∗ )      min −1      1                      (∗ ∗∗ )
                                                                                                          ∗       ∗∗
                               ∗∗                                ∗                         2 (∗∗ )
                             R ¡ 1 ¢1−
                                ∗
                                        1 (∗ ) ∗
                          → R ¡ ¢1−                     → 1,
                                1
                               ∗∗
                                        2 (∗∗ ) ∗∗

as  → 1 in distribution implies that distributions of ∗ and ∗∗ are arbitrarily close to each
other when  is arbitrarily large.13
  13
       To see this, note that the diﬀerence between two distributions is

                      Pr [ ∗∗  |] − Pr [ ∗  |] = Pr [ ∗  |] − Pr [ ∗  |] → 0

since  degenerates to 1 as  → ∞.




                                                            24
   Now, we turn to the log-normal case. With the log-normal density,

                                 ∗    ∗∗     ∗∗       ∗∗         −2     ∗∗
                                                                               £      ¡ ∗∗ ¢¤
                            Pr[    ≥           =      ]           (    )  1 − 
             (| ∗∗ ) =             
                                                            = −2 ∗∗                     
                                 Pr[ ∗∗ = ∗∗ ]                       ( ) [1 −  (∗∗ )]
                                   ¡ ∗∗ ¢    R ∞ 1 − [ln()−]2
                            1 −             ∗∗
                                                    
                                                           2 2    
                                                 
                          =               =  R ∞ 1 − [ln()−]    2    
                            1 −  (∗∗ )                   2 2    
                                                    ∗∗ 

Using L’Hopital’s rule and noting that ∗∗ → ∞ when  → ∞, for any   1, we have
                                                µ                                     ¶
                             ∗∗              [2 ln (∗∗ ) − 2 − ln ()] ln ()
               lim   (|  ) =   lim  exp                                              = 0
             ∗∗ →∞               ∗∗ →∞                    22

Numerical Analysis of sign of  
                                cost

We calculate    cost numerically for the following parameter values. For the distribution of a
productivity draw , we use log-normal, uniform, and the Pareto distributions. A log-normal
distribution is characterized by mean and standard deviation of ln . The mean does not
aﬀect cost , thus we normalize it to 1. For the standard deviation we use the following values:
0.25, 0.5, 0.75, 1, 1.5, 2, 3, 5, and 8. A uniform distribution is characterized by lower and
upper bound for . Rescaling  does not change          cost , thus we set the upper bound to 1
and vary the lower bound using the following values: 0 to 0.9 with 0.1 increment. A Pareto
distribution is characterized by scale parameter and shape parameter. The scale parameter
does not aﬀect     cost , thus we normalize it to 1. For the shape parameter, we use 0.25, 0.5,
0.75, 1, 1.5, 2, 3, 5, and 8. Beside the productivity draw distribution, we need to specify
the values for trade friction  , preference parameter , and the total number of firms (or
potential entrants) for each product. For  , we use 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2,
2.2, 2.4, 2.6, 2.8, 3, 3.5, and 4. For , we use 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.3,
2.6, 3, 3.5, 4, 5, 7, and 10. For the total number of firms (at both locations combined), we
use 2,4,6,8,10, 14, and 20. The parameter grid generates 19,278 combinations for log-normal
and for Pareto distributions and 21,420 combinations for uniform distribution.
    We use 6 million draws to approximate the continuum of products featured in the model.
The more number of products we use, the more precise the numerical approximation becomes.
In order to see the sign of numerical errors, we also report simulation outcomes with smaller
numbers of products: 10,000 to 3 million. As the number of products increases, the simulated
values converge toward true values.
    For Pareto, we distinguish the case of one firm at each location (two firms altogether)
from the case where there are two or more firms in one location. For the log-normal and
uniform distribution, we consider the entire range of firm counts. The numerical analysis

                                                    25
summarized in Table A1 shows that the basic pattern revealed in Table 1 of the paper for
a particular selection of model parameters holds throughout the wide range of parameters
considered in the analysis. In particular, for log-normal and uniform for general firms, and
the Pareto with one firm at one location, we have    cost ≤ 0. Note that in the simulations
                                                  
with finite draws we do get realizations where cost  0. However, as shown in the table,
the maximum realized value gets very close to zero as the number of draws increases. Also
when we fix a cutoﬀ value equal to .00001, we see that the fraction of deviations where the
realized value goes above this small cutoﬀ goes to zero as the number of draws increases.
    For Pareto with two or more firms at each location, the pattern is diﬀerent in Table 1.
Rather than take a negative value, we see that   cost is close to zero. Table A2 shows this
pattern holds throughout the parameter range considered in the numerical analysis.


References

Arkolakis, C., A. Costinot, and A. Rodriguez-Clare (2012), “New Trade Models, Same Old
   Gains?,” American Economic Review, 102(1): 94-130.
Arkolakis, C., A. Costinot, Dave Donaldson, and A. Rodriguez-Clare (2012), “The Elusive
   Pro-Competitive Eﬀects of Trade,” working paper, June 2012.
Atkeson, Andrew, and Ariel Burstein (2008), “Pricing to Market, Trade Costs, and Interna-
   tional Relative Prices,” American Economic Review, 98(5): 1998-2031.
Behrens, Kristian and Yasusada Murata, (2012) “Trade, Competition, and Eﬃciency,” Jour-
   nal of International Economics, 87(1): 1-17.
Bernard, A. B., J. Eaton, J. B. Jensen and S. Kortum (2003), “Plants and Productivity in
   International Trade,” American Economic Review, 93(4): 1268-1290.
Combes, Pierre-Philippe, Gilles Duranton, Laurent Gobillon, Diego Puga, and Sébastien
   Roux (2012), “The Productivity Advantages of Large Cities: Distinguishing Agglomera-
   tion from Firm Selection,” Econometrica, 80(6): 2543-2594.
de Blas, Beatriz , and Katheryn Russ (2012), “Understanding Markups in the Open Economy
   under Bertrand Competition,” working paper, July 2012.
Devereux, Michael B and Khang Min Lee (2001), “Dynamic Gains from International Trade
   with Imperfect Competition and Market Power,” Review of Development Economics,
   5(2): 239—255.
Edmond, Chris , Virgiliu Midrigan and Daniel Yi Xu (2012), “Competition, Markups, and
  the Gains from International Trade,” NBER working paper 18041.


                                             26
Grossman, Gene M. and Helpman, Elhanan (1991), "Quality Ladders in the Theory of
   Growth." Review of Economic Studies, 58(1): 43-61.
Hsieh, C.-T. and P. J. Klenow (2009), “Misallocation and Manufacturing TFP in China and
   India,” Quarterly Journal of Economics, 124(4): 1403-1448.
Lipsey, R. G. and Kelvin Lancaster (1956-1957), “The General Theory of Second Best,”
   Review of Economic Studies, 24(1): 11-32.
Malika, Henrick J. and Roger Trudela (1982), “Probability Density Function of Quotient of
  Order Statistics from the Pareto, Power and Weibull Distributions,” Communications in
  Statistics - Theory and Methods, 11(7): 801-814.
Melitz, Marc J. and G. Ottaviano (2008), “Market Size, Trade, and Productivity,” Review
   of Economic Studies, 75(1): 295-316.
Neary, J. Peter (2003), “Globalization and Market Structure,” Journal of the European
   Economic Association, 1: 245-271.
Ottaviano, G., T. Tabuchi and J.-F. Thisse (2002), “Agglomeration and Trade Revisited,"
   International Economic Review, 43(2): 409-435.
Peters, Michael (2012) “Heterogenous Mark-Ups and Endogenous Misallocation,” Yale Uni-
   versity manuscript.
Restuccia, D. and R. Rogerson (2008), “Policy Distortions and Aggregate Productivity with
   Heterogeneous Plants,” Review of Economic Dynamics, 11: 707—720.
Robinson, Joan (1934), The Economics of Imperfect Competition, Macmillan.
Salvo, Alberto (2010), “Inferring Market Power under the Threat of Entry: The Case of the
   Brazilian Cement Industry,” RAND Journal of Economics. 41(2): 326-350.
Schmitz, Jr. James A. (2005), “What Determines Productivity? Lessons from the Dramatic
   Recovery of the U.S. and Canadian Iron Ore Industries Following Their Early 1980s
   Crisis,” Journal of Political Economy, 113(3): 582-625.
Syverson, C. (2004), “Market Structure and Productivity: A Concrete Example,” Journal
   of Political Economy, 112(6): 1181-1222.




                                           27
                                                Table 1
      The Decomposition of the Allocative Efficiency Elasticity for Various Alternative Parameters

Panel A: LogNormal Distribution
             Number         σ            s2       ηProd       ηA       Decomposition
                 of      (elas.)      (import                          ηAcost  ηAprice
               Firms                   share)
                 2        0.50          0.12      -0.14     -0.036     -0.018     -0.018
                 2        1.00          0.13      -0.13     -0.072     -0.036     -0.036
                 2        1.50          0.14      -0.12     -0.088     -0.054     -0.034
                 2        2.00          0.15      -0.12     -0.015     -0.063      0.048
                 2        4.00          0.11      -0.08      0.035     -0.038      0.074

                   4        0.50       0.09       -0.09     -0.009     -0.005     -0.004
                   4        1.00       0.09       -0.09     -0.018     -0.010     -0.008
                   4        1.50       0.09       -0.08     -0.025     -0.014     -0.012
                   4        2.00       0.09       -0.08     -0.026     -0.018     -0.008
                   4        4.00       0.07       -0.06      0.005     -0.019      0.023

                   6        0.50       0.07       -0.07     -0.005     -0.003     -0.002
                   6        1.00       0.07       -0.07     -0.009     -0.005     -0.004
                   6        1.50       0.07       -0.07     -0.014     -0.008     -0.006
                   6        2.00       0.07       -0.06     -0.016     -0.010     -0.005
                   6        4.00       0.06       -0.05      0.000     -0.013      0.013
Panel B: Pareto
                   2        0.50       0.06       -0.06     -0.015     -0.008     -0.007
                   2        1.00       0.07       -0.07     -0.033     -0.017     -0.017
                   2        1.50       0.08       -0.07     -0.041     -0.026     -0.015
                   2        2.00       0.09       -0.07     -0.003     -0.035      0.032
                   2        4.00       0.11       -0.09      0.033     -0.025      0.058

                   4        0.50       0.08       -0.08     0.000      0.000      0.000
                   4        1.00       0.09       -0.09     0.000      0.000      0.000
                   4        1.50       0.09       -0.09     0.000      0.000      0.000
                   4        2.00       0.09       -0.09     0.000      0.000      0.000
                   4        4.00       0.10       -0.10     0.000      0.000      0.000

                   6        0.50       0.09       -0.09     0.000      0.000      0.000
                   6        1.00       0.09       -0.09     0.000      0.000      0.000
                   6        1.50       0.10       -0.10     0.000      0.000      0.000
                   6        2.00       0.10       -0.10     0.000      0.000      0.000
                   6        4.00       0.11       -0.11     0.000      0.000      0.000
The calculations set τ = 1.5 throughout and θ=5 for Pareto and θ=3.87 for the lognormal.
                                    Table A1. Numerical Analysis of



Panel A: LogNormal Distribution
                          Count of                                               Count of   Share of
          Number of
                         Parameter          Min          Mean           Max
           Products
                        Combinations
          6,000,000        19,278        -1.26E-01     -7.45E-03      8.30E-14      0       0.00%

          3,000,000        19,278        -1.27E-01     -7.72E-03      1.52E-08      0       0.00%

          1,000,000        19,278        -1.27E-01     -7.33E-03      1.13E-05      1       0.01%

           100,000         19,278        -1.26E-01     -7.22E-03      1.28E-03     71       0.37%

            10,000         19,278        -1.29E-01     -7.27E-03      1.37E-02     378      1.96%

Panel B: Uniform
          6,000,000        21,420        -2.63E-02     -1.53E-03      4.76E-11      0       0.00%

          3,000,000        21,420        -2.63E-02     -1.53E-03      1.51E-11      0       0.00%

          1,000,000        21,420        -2.62E-02     -1.52E-03      6.58E-12      0       0.00%

           100,000         21,420        -2.58E-02     -1.52E-03      7.56E-07      0       0.00%

            10,000         21,420        -2.61E-02     -1.52E-03      5.29E-06      0       0.00%

Panel C: Pareto, with one firm in each location
          6,000,000          2,754        -9.35E-02    -1.27E-02      1.64E-11      0       0.00%

          3,000,000         2,754        -1.29E-01     -2.42E-02      1.08E-11      0       0.00%

          1,000,000         2,754        -9.32E-02     -1.18E-02      4.19E-12      0       0.00%

           100,000          2,754        -9.45E-02     -1.09E-02      1.45E-03      5       0.18%

            10,000          2,754        -9.18E-02     -9.69E-03      1.08E-03     11       0.40%
                 Table A2. Numerical Analysis of
   Pareto distribution, with the number of firms at each location ≥ 2




               Count of
Number of
              Parameter           Min            Mean            Max
 Products
             Combinations
6,000,000       16,524        -6.93E-04       -9.41E-06       2.56E-04

3,000,000       16,524        -1.40E-03        1.67E-05       9.63E-04

1,000,000       16,524        -9.98E-04        6.36E-05       1.34E-03

100,000         16,524        -2.27E-03        2.01E-05       3.55E-03

 10,000         16,524        -8.40E-03       -1.97E-05       1.48E-02
