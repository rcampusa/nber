                              NBER WORKING PAPER SERIES




         AN INSTRUMENTAL VARIABLE APPROACH TO DYNAMIC MODELS

                                       Steven T. Berry
                                      Giovanni Compiani

                                      Working Paper 27756
                              http://www.nber.org/papers/w27756


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                   August 2020




We are grateful to Allan Collard-Wexler for generously providing the data, and to Xiaohong
Chen, Liran Einav, Phil Haile, Francesca Molinari, Jesse Shapiro, Paulo Somaini for helpful
comments and suggestions.We are also grateful to participants at numerous seminars, including
the NBER. Mengsi Gao provided excellent research assistance The views expressed herein are
those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Steven T. Berry and Giovanni Compiani. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
An Instrumental Variable Approach to Dynamic Models
Steven T. Berry and Giovanni Compiani
NBER Working Paper No. 27756
August 2020
JEL No. C26,C57,L1

                                         ABSTRACT

We present a new class of methods for identification and inference in dynamic models with
serially correlated unobservables, which typically imply that state variables are econometrically
endogenous. In the context of Industrial Organization, these state variables often reflect
econometrically endogenous market structure. We propose the use of Generalized Instrument
Variables methods to identify those dynamic policy functions that are consistent with
instrumental variable (IV) restrictions. Extending popular "two-step" methods, these policy
functions then identify a set of structural parameters that are consistent with the dynamic model,
the IV restrictions and the data. We provide computed illustrations to both single-agent and
oligopoly examples. We also present a simple empirical analysis that, among other things,
supports the counterfactual study of an environmental policy entailing an increase in sunk costs.


Steven T. Berry
Department of Economics
Yale University
Box 208264
37 Hillhouse Avenue
New Haven, CT 06520-8264
and NBER
steven.berry@yale.edu

Giovanni Compiani
University of Chicago
Booth School of Business
5807 S. Woodlawn Ave
Chicago, IL 60605
gio1compiani@gmail.com
An Instrumental Variable Approach to Dynamic Models
                          Steven T. Berry and Giovanni Compiani
                                           August 24, 2020



                                                Abstract

             We present a new class of methods for identification and inference in dynamic
         models with serially correlated unobservables, which typically imply that state variables
         are econometrically endogenous. In the context of Industrial Organization, these state
         variables often reflect econometrically endogenous market structure. We propose the
         use of Generalized Instrument Variables methods to identify those dynamic policy
         functions that are consistent with instrumental variable (IV) restrictions. Extending
         popular "two-step" methods, these policy functions then identify a set of structural
         parameters that are consistent with the dynamic model, the IV restrictions and the
         data. We provide computed illustrations to both single-agent and oligopoly examples.
         We also present a simple empirical analysis that, among other things, supports the
         counterfactual study of an environmental policy entailing an increase in sunk costs.



1        Introduction
We propose an instrumental variable (IV) approach to identification and inference in dynamic
models in the presence of serially correlated unobservables. Such serial correlation typically
leads to dynamic state variables that are econometrically endogenous, which creates problems
for identification and inference. As a result, much of the literature to date either assumes
away serial correlation in the unobservables or else deals with such correlation in particularly
simple fashions.
    
    We are grateful to Allan Collard-Wexler for generously providing the data, and to Xiaohong Chen, Liran
Einav, Phil Haile, Francesca Molinari, Jesse Shapiro, Paulo Somaini for helpful comments and suggestions.
We are also grateful to seminar participants at NAMES 2017, Northwestern, Harvard/MIT, Stanford, Duke,
2018 and 2019 Conference on Dynamic Models, Boston University, ASSA 2019. Mengsi Gao provided
excellent research assistance. All remaining errors are our own.
    
       Yale University, Cowles Foundation, Tobin Center and NBER. Email: steven.berry@yale.edu.
    
       University of Chicago, Booth School of Business. Email: Giovanni.Compiani@chicagobooth.edu.


                                                     1
    We mostly focus on applications to dynamic models of Industrial Organization (IO).
These models often feature state variables that measure various kinds of "market structure,"
such as the number of firms, the number of retail outlets, the vector of current productivity
levels of firms and so forth. As an example, consider a simple model of entry and exit where
profits depend on the number of firms in the market, N . Standard empirical approaches
assume that any variables aecting firms' profits and not captured by the data--e.g. un-
observed demand or supply shocks--are independent over time. This implies that "market
structure" N is independent of the contemporaneous unobservables and thus the eect of N
on, say, firm entry can be directly observed in the data. In contrast, when the unobservables
are persistent over time, markets with large N are likely to be more systematically profitable
in terms of unobservables. Thus, the observed entry probabilities reflect the correlation be-
tween unobservables and N and we cannot directly observe the "causal eect" of N on entry.
This is a classic endogeneity problem.
    A natural and economically meaningful solution to this familiar IO problem of endogenous
market structure is to use IV methods. More broadly, this paper is part of the research
agenda that relates the formal identification of IO models to classic IV intuition, as in
standard equilibrium models of supply and demand. The goal is to address a persistent
critique of IO models that claims they are typically not well-identified. Specific examples of
this agenda include Cournot-style models, as in Bresnahan (1989), dierentiated products
demand and supply market equilibrium, as in Berry and Haile (2014), cross-sectional market
structure ("static entry" models), as in Tamer (2003), and auction cost heterogeneity, as in
Somaini (2015).1


1.1     Idea of the Paper
Our paper builds on the intuition of classic two-step methods, following on Hotz and Miller
(1993) (henceforth, HM), that distinguish between the identification of [i] the structural
parameters of an underlying dynamic model and [ii] the policy function that results from the
solution of that dynamic model evaluated at the true value of the structural parameters. It
is this policy function that (according to the model) generates the data.
    The task of identification and inference is made much easier by the assumption that
unobservable shocks are distributed independently over time. This is made clear in Rust
(1987) and exploited in the HM "conditional choice probability" or "CCP" approach. In the
related IO literature, the shocks are then typically assumed to also be private information.2
   1
    In addition, as in much of the auction literature, there are many formal IO identification arguments that
do not so clearly involve instrumental variables.
   2
    See Pesendorfer and Schmidt-Dengler (2008), Bajari et al. (2007) and Pakes et al. (2007) for a discussion
of HM style methods, with pure i.i.d. private information shocks, extended to a dynamic oligopoly context
with possibly multiple equilibria. An early review of this approach is in Ackerberg et al. (2007).



                                                     2
Under these assumptions, the dynamic policy function is often point-identified "directly from
the data." For instance, in the case of dynamic discrete choice models, estimating the policy
boils down to estimation of conditional probabilities. The structural parameters are then
identified as those that are consistent with the observed policy function.
     However, the simplicity of these methods depends critically on the econometric exogeneity
of dynamic states. Once unobservables are allowed to be serially correlated, the dynamic
states become econometrically endogenous. This is because the dynamic states reflect past
values of the unobservables which, due to serial correlation, are typically not independent of
the current unobservable entering the policy function. The econometric endogeneity problem
here is classic in its form: the "right hand side" state variables in the dynamic policy function
are correlated with the unobservables that enter the same function.
     In order to tackle the endogeneity of the dynamic states, we rely on instrumental variables.
These instruments have the classic features that they [1] do not directly enter today's policy
decision, [2] are assumed to be exogenous (independent of the unobservables), and yet [3] are
correlated with the current state, likely because they eected past policy decisions that are
correlated with present states. In a dynamic entry model, an example would be past market
size or past regulatory environments that influenced past decisions to enter a market. In
the presence of sunk costs, these past decisions will continue to be correlated with current
market structure, even if current entry decisions are only driven by current market size and
current regulations. We discuss further examples of possible instrumental variables after we
have formally defined key features of the model.
     Traditional IV and panel data methods face a di cult problem in our context: the policy
function is derived from the "structural" dynamic model and this typically implies that the
policy function is not additively separable in the serially correlated unobservable(s). The
nonseparability of the policy function in unobservables creates di culties for both iden-
tification and inference. Luckily, there is a large recent literature on the nonparametric
identification of functions with nonseparable unobservables and econometrically endogenous
right-hand side variables, sometimes mixed with a classic panel data structure. In the eas-
iest possible examples for us, the dynamic policy function will be point-identified even in
the presence of serial correlation, but more general cases may lead only to set identification.
To consider more general cases, we leverage an existing large literature on identification and
inference in partially identified models, including Manski and Tamer (2002), Tamer (2003),
Manski (2003), Chernozhukov et al. (2007), Berry and Tamer (2007), Ciliberto and Tamer
(2009), Beresteanu et al. (2011), Galichon and Henry (2011), Chesher (2010) and Andrews
and Shi (2013).
     One paper that sums up and extends an IV style literature on this topic is Chesher and
Rosen (2017) (henceforth, CR), who discuss a class of "Generalized Instrumental Variable"
(henceforth, GIV) methods. In addition to emphasizing an appropriate IV framework for
the identification of a very broad class of dynamic policy functions, CR closely build on the

                                               3
work of Galichon and Henry (2011) and Beresteanu et al. (2011) to characterize the sharp
identified set. This characterization will help us build intuition about how instruments serve
to (set) identify policy functions.
    The identifying power of these instrumental variable methods is increased by the pres-
ence of multiple periods of data. In particular, we note that even in the absence of any
instrumental variables, nonseparable policy functions can be usefully restricted purely from
the presence of multiple periods of data, as in the nonseparable error, nonparametric panel
data papers of Altonji and Matzkin (2005) and Athey and Imbens (2006).3
    We illustrate our approach in a simple single-agent entry and exit model. This minimal
example allows us to build intuition about the sources of identification as well as to explore
how the number of time periods, the presence of exogenous covariates and the strength of
the instruments aect the identified set for the structural parameters. We then apply the
method to data from the US ready-mix concrete industry and consider a counterfactual
policy that increases the magnitude of the sunk costs of entry into the market. When we
compare our approach to three dierent methods that assume away serial correlation in the
unobservables, we find that the latter results are significantly dierent than ours. Moreover,
the sign of the bias varies across the three methods. Two approaches tend to over-predict
the responses to the policy in terms of both the number of firms and the fraction of new
entrants. This stems from the fact that, in the counterfactual, the unobservables exhibit too
much volatility over time when serial correlation is ruled out. On the other hand, a third
approach estimates a very large sunk cost (as a way to match the persistence in the data
without appealing to serially correlated unobservables) and thus predicts no response to the
policy change. The di culty in a priori signing the bias from standard, more restrictive
methods further motivates our contribution.


1.2     Some Related Papers
The literature on the identification and estimation of dynamic problems is immense and we
can only highlight a set of related literatures here.
    We are obviously not the first authors to consider the issue of serially correlated unob-
servables in dynamic models, including dynamic games. Outside of the two-step literature
following on CCP methods, there is an important set of papers emphasizing computational
approaches to estimation that allow for some form of persistent unobservables, sometimes
in the form of a limited number of "discrete types" of agents. A classic single-agent exam-
ple is Keane and Wolpin (1997). A classic oligopoly example is the full-solution approach
of Ericson and Pakes (1995) and Pakes and McGuire (2001), who emphasize that serially
correlated unobservables are an important feature of realistic dynamic models in IO. These
   3
    These papers do not explicitly consider the fully dynamic problems that we consider here, but instead
focus on nonparametric analogues of non-dynamic panel data-style arguments.


                                                   4
computationally oriented papers do not typically discuss formal identification.
    Work on the identification of mixture models, as in Kasahara and Shimotsu (2009) and Hu
and Shum (2012),4 provides some formal results on identification of discrete dynamic policy
functions with persistent unobservables. This work again emphasizes limited forms of discrete
heterogeneity. In Berry and Compiani (2020) we show that our framework includes the class
of models they consider as a special case. A key restriction in Kasahara and Shimotsu (2009)
is that the variation in unobservables is in some well-defined sense lower-dimensional than
the variation in the observed data. In particular, the degree of point-identified heterogeneity
is limited by the time-series dimension of the data. As a complementary result, our set-
identification approach is applicable to settings with as few as two time periods irrespective
of the dimension of the unobservable. Of course, if the data exhibits too little variation our
identified sets may be so large as to be of little use. In our empirical application, we obtain
informative results with fewer than 500 cross-sectional observations.
    On the estimation side, Arcidiacono and Miller (2011) provide maximum likelihood com-
putational methods for the structural parameters of dynamic models with discrete persistent
heterogeneity. Norets (2009) proposes a Bayesian estimation method for dynamic discrete
choice models with serially correlated unobservables. Additional full-solution approaches
allowing for serial correlation include Blevins (2016) and Reich (2018). Neither discusses
identification formally.
    Our paper is also related to the literature on dynamic panel data models that are not
derived from explicit dynamic optimization (e.g., Altonji and Matzkin (2005) and Athey and
Imbens (2006)) and to the large literature on distinguishing between state dependence and
unobserved heterogeneity (see, e.g., Heckman and Singer (1984), Israel (2005), Dub´     e et al.
(2010)). Similar to these papers, we face the challenge of disentangling the roles of past
actions and persistent unobservables in driving current outcomes. Our IV intuition is very
much in line with this literature on dynamic panels with state dependence. For example,
Israel (2005) argues for the usefulness of past exogenous shocks that shift the current state
but do not aect today's decision conditional on the current state. More recently, Heckman
et al. (2016) study identification and estimation of dynamic treatment eects allowing for
time-invariant unobserved heterogeneity. Honor´    e and Tamer (2006) discuss set identification
in a dynamic panel context.
    Even without serially correlated unobservables, there are typically no formal point-
identification results for models with continuous actions,5 which is one reason why Bajari
et al. (2007) ("BBL") relies on set-identified inequality methods to recover the structural
profit parameters, once given a "first-step" identified policy function. We propose much
   4
       See also Hu et al. (2015).
   5
    Identification in the case of no serial correlation and discrete actions is considered in Magnac and Thesmar
(2002) and related papers.



                                                       5
simpler second step methods, which aids in translating the policy functions (set) identified
in our GIV first step into second-step profit parameters.
    A recent paper by Kalouptsidi et al. (2020) shares our IV intuition and is in many ways
closest to our spirit. They show that in a class of dynamic discrete choice models with
serially correlated market-level unobservables, one can obtain Euler equations that point-
identify some firm-specific profit parameters. This approach leads to computationally light
linear IV estimators that are robust to endogeneity problems caused by the market-level
unobservables. However, it does not address identification of the joint distribution of the
unobservables over time and thus cannot be used to perform counterfactuals requiring that
distribution as an input. The paper provides some interesting examples of IV potential
applications with serially correlated market-level states, including durable goods demand,
land use and dynamic labor supply. They discuss possible instruments in these settings.
Their examples and instruments could be applicable to our methods as well. Blending our
method with theirs might be a fruitful direction for applied work.
    The rest of this paper is organized as follows. Section 2 introduces the general model
and identification framework for single-agent problems. Section 3 illustrates the approach
via a simple entry example. Section 4 extends the analysis to the oligopoly setting. Section
5 contains the empirical application and Section 6 concludes. Appendix A provides more
details on our leading single-agent example, whereas Appendix B presents an additional
computed oligopoly model. Finally, Appendix C discusses the second step of our empirical
application in more detail and Appendix D contains a proof omitted from the text.


2     Model and Identification
In this section, we present the formal model. After introducing variables and notation, we
focus on the single-agent case and illustrate the GIV approach through a simple monopolist
entry example. We then extend the analysis to settings with multiple agents in each market.


2.1     Variables and Notation
We consider a model that generates data on a large set of markets, with one or more agents6
per market, and a fixed (perhaps small) number of time periods denoted by t = 1, ..., T . We
may additionally have access to some subset of variables for prior periods, t < 1. In the
general oligopoly model, markets are indexed by i and firms within markets are indexed by
j . We do not model cross-market interactions. Our simpler examples will involve a single
firm per market.
   6
     Since many IO dynamic models involve firms making decisions over time, we use the words "firms" and
"agents" interchangeably throughout the paper.



                                                   6
    In each market in each time period, each firm takes an action (or actions) denoted aijt .
These actions contribute over time to the firm's observed current state(s), denoted xijt . The
set of feasible actions for a firm with state xijt is denoted A(xijt ). As one example, in an
entry model there might be a scalar action aijt , equal to one or zero, that indicates the
decision to operate in the market in period t + 1. A scalar state xijt might then be whether
firm j operates in market i in period t.
    There are also observed exogenous states, wijt , that evolve separately from the firms'
actions. Some or all of the exogenous states may be shared across firms. In some cases, we
may observe some partial information on exogenous variables from before the beginning of
our full panel dataset. We denote these variables, which will later prove useful as instruments,
as ri .
    In addition, there are unobserved (to us) state(s) uijt that also evolve exogenously from
the actions of firms. For example, in an entry model, uijt may represent the component of
fixed costs not captured by the data. Within market, the unobservables may be correlated
both across time and firms. The uijt are the only variables that the firms observe but we do
not. In the oligopoly context, we treat the serially correlated component of uijt as commonly
observed by all firms. In some cases, it is also useful to model an independent (over time
and firms) component that that is private information to the firm.7
    Suppose that there are a maximum of J firms within each market. We define

                                        ait  (ai1t , ai2t , . . . , aiJt )                               (1)

and we define the market-time vectors xit , wit and uit in a similar fashion. As further nota-
tion, we let across-time, within-market vectors of variables (and their respective supports)
be denoted ai = (ai1 , . . . , aiT ) 2 AT , xi = (xi1 , . . . , xiT ) 2 XT , wi = (wi1 , . . . , wiT ) 2 WT ,
and ui = (ui1 , . . . , uiT ) 2 UT .
    The probability that the vector ui of unobservables (across time and firms within market)
lies in the set S  U is denoted by
                                                ( S ; u ) ,                                               (2)

where the vector u parameterizes the distribution of the vector of market unobservables
across time and firms. The parameter u will often, inter alia, control the degree of serial
correlation in the unobservables. The single-period profit of firm j in market i in period t is
given by the function
                                   j (ait , xit , wit , uit ;  ) .                         (3)

The subscript j on the single-period profit function indicates the natural property that firm
j 's profits depend dierently on its own elements of (aijt , xijt , wijt , uijt ) as opposed to its

   7
   The distinction between the full information serially correlated unobservable and the private independent
unobservable is similar to the distinction between the variables  1 and  2 in Pakes et al. (2015).


                                                        7
rivals'. The unknown parameters of the single period profit function are  . The full vector
of structural parameters, , then includes the unknown parameters of the single-period profit
function and of the distribution of unobservables:  = ( , u ).8


2.2       Single Firm per Market
We begin with the single-agent case, returning to dynamic oligopoly in section 4. In this
special case, we treat each firm (agent) as operating in its own "market" and so we drop the
j firm subscripts in (aijt , xijt , wijt , uijt ), leaving (for example) ait as the action of the firm in
market i at time t. In the single-firm case, we will shorthand the phrase "firm in market i"
as "firm i."
    As is classic in much of the literature following on Rust (1987), we assume that the
observed endogenous states of the firm evolve according to the transition probability function

                                               (xit+1 |ait , xit , wit ),                            (4)

where gives the probability of each possible future state conditional on the firm's own action
and observable states. As a special case, this could describe deterministic state transitions,
where some state occurs with a conditional probability of one. For instance, in a dynamic
entry model, the current state (whether the firm is in or out of the market) is equal to
the action taken last period. Table 1 gives some examples of actions, states and transition
processes that might occur in the IO context.



                               Table 1: Some Single Agent IO Examples

                  State, xit     Action, ait      A(xit )      Transition

                  Capital       Investment          R+         xit+1   = ~ xit + ait
                  Out/In        Entry/Exit         {0 , 1 }    xit+1   = ait
                  Retail        # of Stores         I+         xit+1   = ait
                  Quality          R&D              R+         xit+1    f (xit , ait )




       Similarly, the observable exogenous states are first-order Markov, with conditional prob-
   8
    Following standard practice in the dynamics literature, we assume that the discount factor is known
throughout.




                                                          8
abilities given by9
                                                     H (wit+1 |wit ).                                            (5)

In our single-firm examples, we will focus on the special case where the firm-level unobserv-
able uit follows a first-order Markov process. Our leading example here will be a model of
first-order serial correlation where uit is a scalar that obeys
                                                                     p
                                            uit = uit     1   + it    1    2 .                                   (6)

In the simplest case, the period t vector it innovation might be assumed to have a simple
parameterized distribution. The parameter u then includes those parameters plus the serial
correlation parameter .10
    In this case, the firm's dynamic problem is given by the classic Bellman equation:

                                V (xit , wit , uit ) =
                                                                                                                 (7)
           max           (ait , xit , wit , uit ;  ) + Eu [V (xit+1 , wit+1 , uit+1 ) |ait , xit , wit , uit ]
         ait 2A(xit )


where denotes the discount factor and V the value function. Note that, since the function V
does not depend on time, we assume a stationary environment. The expected value function
in this expression is

                   Eu [V (xit+1 , wit+1 , uit+1 ) |ait , xit , wit , uit ] =
       Z Z Z                                                                                                     (8)
                   V (xit+1 , wit+1 , uit+1 ) d (xit+1 |ait , xit , wit )dH (wit+1 |wit )d ~ (uit+1 |uit ; u )


where ~ (uit+1 |uit ; u ) denotes the conditional distribution of ut+1 given ut . Note that this is
similar to Rust (1987), but we do not make Rust's full conditional independence assumption.
Specifically, in order to allow for serial correlation in the unobservables, we do not drop the
conditioning on the past unobservable in ~ (uit+1 |uit ; u ).
   In the single-agent case, there is a unique solution for the value function and we assume
standard conditions such that there is a unique policy function consistent with that value
   9
     Our framework also allows for the case where the transition processes for xit and wit in (4) and (5)
depend on uit (or components of it) provided that they can be identified from the data. Since we know of
no empirical models featuring this dependence, we focus on the case where the transitions do not depend on
uit throughout the paper.
  10
    Berry and Compiani (2020) consider cases where the unobservable consists of both a time-invariant
discrete component and a serially uncorrelated shock in the spirit of Heckman and Singer (1984), Keane and
Wolpin (1997), Kasahara and Shimotsu (2009), Arcidiacono and Miller (2011) and related literature.




                                                              9
function.11 We let         denote this policy function, so that

                                        ait =   (xit , wit , uit ) ,      2 F.                          (9)

In many cases, reasonable assumptions on the single-period return function and the transition
processes imply that the policy function must obey certain qualitative restrictions, such as
monotonicity. These restrictions can then be imposed on the set of possible policy functions
F.
   For the identification argument presented next, it will also be useful to define the dierent
(counterfactual) policy functions that would be generated by any other possible parameter
vectors  = ( , u ). In the single-firm case, these policy functions, generated by the model
and the unique solution to Bellman's equations, will be denoted by

                                            ait =       (xit , wit , uit ) .                           (10)


2.3        Identification of the Single-Agent Model
We first focus on identification in the single-agent case. For purposes of identification, we
assume that we observe the true distribution of the data, which we denote by

                                                P (ai , xi , wi , ri )

This is equivalent to seeing a T -period panel on a very large (in fact, infinite) cross-section of
firms or agents. We look to identify (possibly set-identify) the parameters . Nothing in our
general discussion of identification requires these to be finite dimensional, but in practice the
models we consider in the simulations and empirical application are all finite-dimensional.
Note that in the case where (ai , xi , wi ) are discrete, the single-period profit function may be
fully flexibly characterized by a finite number of parameters, one for each combination of
(ai , xi , wi ) values.
     The potential instruments in the model consist of the exogenous variables

                                                  z i = ( ri , w i )

The critical assumption that allows for our instrumental variable approach is independence
of the instrument and the unobservables:12

                                                     z i ? ui
  11
       For the technical conditions guaranteeing a unique policy function, see Stokey et al. (1989).
  12
    While we focus on this restriction throughout the paper, CR show that the GIV approach may also be
applied under weaker assumptions, such as mean or quantile independence.


                                                         10
Note that the assumption that wi be exogenous is standard in the existing literature. In
addition, we require excluded instruments ri to deal with the endogeneity of the dynamic
states xi . Table 2 gives some ideas of possible instruments ri in dierent contexts. As is
usual with discussions of potential instruments, the required independence assumption may
be more or less appropriate in dierent real-world cases.



                       Table 2: Examples of Possible Instruments ri

           State                Example Instruments

           Capital          Past investment cost
           Out/In of Market Past market population, past regulation
           # of Stores      Distance from headquarters, interacted with time
           Quality          Past R&D shocks, age of firm




    In studying identification of the model, we follow the classic "two-step" approach. First,
we discuss the (set-)identification of the policy function and serial correlation parameters,
using GIV techniques. Given the results of the first step, we then discuss the identification
of the structural parameters of the profit function using a broad generalization of existing
approaches.


2.4    First Step: Identification of the Policy
The broad idea is to (set-)identify the policy function from classic instrumental variables
conditions, extended to cases where the policy function is highly nonlinear in the states.
The GIV framework achieves this and it allows us to deal with the following complications
arising in many dynamic models of interest:
  1. the incompleteness of the model, i.e. the fact that the exogenous variables do not
     uniquely pin down the endogenous variables (Tamer (2003));

  2. the fact that, if the dynamic states and actions are discrete--as in entry/exit models--
     the policy function is known to be generally only partially identified in the absence of
     a model for the endogenous explanatory variables (Chesher (2010));

  3. lack of point-identification of the parameters, even in the absence of problems 1 and
     2, e.g. due instruments that are not strong enough.
In applications, we may have all or none of these problems. If the model and data generating
process in fact imply point-identification, then the sharply identified set will collapse to the

                                              11
true parameter value. In the single agent case, an incomplete model can follow from the
presence of unknown initial conditions, i.e. the fact that the joint distribution of (xi1 , ui1 )
is not known.13 Traditionally, solutions to the initial conditions problem include either [i]
parameterizing the initial joint distribution of states and unobservables or [ii] specifying some
process for the past history of the firm that uses the model parameters to construct that
same initial joint distribution.14 We argue that if the parameterization in method [i] is so
flexible as to not impact the resulting identified set, then we might just as well look for the
sharply identified set that does not restrict the initial distribution.
    As in Tamer (2003), any given action ait naturally leads to conditions on sets of unob-
servables. In particular, following CR and using similar notation, if the sequence (ai , xi , wi )
occurs, then ui must be in the inverse image set

                         U (ai , xi , wi , )  {ui : (xit , wit , uit ) = ait , 8t}                     (11)

The condition
                                          { u i 2 U ( ai , x i , w i , ) }                             (12)

is then a necessary condition for the observed event (ai , xi , wi ). If the model is incomplete,
however, that condition is not su cient for the event: when the exogenous variables (wi , ui )
do not uniquely pin down the endogenous variables (xi , ai ), it can happen that (12) is
satisfied but the event (ai , xi , wi ) does not occur. Then, Corollary 1 in CR gives the following
characterization of the identified set for the policy and parameters for the unobservables,
( , u ): a pair ( , u ) is in the identified set if and only if for all closed sets S  U and for
all z
                               Pr U (ai , xi , wi , )  S |z  (S ; u ).                         (13)

In this last equation, the left-hand side is the conditional probability of the outcomes yi =
(ai , xi ), which, according to , have {ui : ui 2 S} as a necessary condition. For a given
  and z , this probability is observed in the data. The right-hand side is the probability of
that necessary condition wrt the distribution of ui , which by assumption does not depend
on z . Further, given u , this term is known and can be computed in closed form or via
simulation.15
     In the case with discrete ait , xit , wit , CR shows that to obtain the sharp identified set for
  13
    See Anderson and Hsiao (1981), Arellano and Bond (1991) and Blundell and Bond (1998), among others.
Honor´e and Tamer (2006) emphasize how the initial conditions problem leads to partial identification in
nonlinear dynamic panel data models.
  14
    Collard-Wexler (2014) employs both solutions. While the results of his counterfactuals are robust, a few
parameter estimates vary substantially across the two methods, suggesting that the way in which the initial
conditions problem is addressed matters in general.
  15
   See Berry (1992) and Ciliberto and Tamer (2009) for other uses of simulation in models characterized
by moment conditions.


                                                        12
, one only needs to check sets S (labeled "core-determining") that belong to a collection
Q( , zi ). This collection includes the "elemental" sets, U (ai , xi , wi , ), associated with in-
dividual realizations of the observables, as well as unions of overlapping sets of that form,
excluding cases of strict subsets.
    The CR approach operates in the space of the unobservables and it builds on earlier results
that apply to the space of observables (Beresteanu et al. (2011), Galichon and Henry (2011)).
For us, the result is useful because it completely characterizes the inequality restrictions that
define the sharply identified set of policy functions. We illustrate this in the simple example
of Section 3. However, the number of these restrictions can grow quite large in realistic
problems. In these cases, one may not be able to list all the CR inequalities needed to
obtain the sharp identified set. However, the CR characterization is still helpful to build
intuition for selecting which inequalities to impose. We do this in the empirical application
of Section 5 and show that, while we do not get sharp identification, the results are still
informative.
    When the necessary conditions (13) are actually necessary and su cient for particular
(sets of) actions, then the associated inequalities become strict equalities. In a complete
model, all of the necessary conditions are equalities. However, as usual, this does not guar-
antee that the parameters are point-identified (since, e.g., the instruments might not be
strong enough) and so, in the absence of a proof of point-identification, we might still want
to consider set-identification.
    To formalize the argument above, we define the set of policy functions that are identified
exclusively by the IV conditions and the data, with no use of the dynamic model. In
particular, for a given u and a given data generating process, we define

               IV (u )  { : condition (13) holds 8S 2 Q( , z ) and 8z } \ F                  (14)

We emphasize that IV (u ) is a subset of the space of admissible policies F and, as such,
incorporates all the natural economic restrictions--e.g., monotonicity--that one may be
willing to impose on F . Definition (14) immediately gives the following characterization of
the sharp identified set for ( , u ).

Result 1. The sharp identified set for ( , u ) is given by ( , u ) :   2 IV (u ), IV (u ) 6= ; .


2.5    Second Step: Identification of the Profit Parameters
We now show how one can use the sharp identified set for ( , u ) from the first step to
characterize the identified set for the structural dynamic parameters entering the profit
function. These results can be viewed as a generalization of the approach in Hotz et al.
(1994) (HMSS). As noted, for any  = ( , u ), we can use the Bellman equation to compute



                                               13
the implied policy          ,   defined as follows:

                                                      (xit , wit , uit )    
                                                                                                                 
          argmax  (ait , xit , wit , uit ,  ) + Eu V (xit+1 , wit+1 , uit+1 )|ait , xit , wit , uit                 .
          ait 2A(xit )

The sharply identified set of parameters is then given by all ( , u ) pairs whose associated
policy function is not rejected by the GIV restrictions. We formalize this in the following
result.

Result 2. The identified set for the structural parameters ( , u ) is given by

                                ID  { = ( , u ) :                 (xit , wit , uit )   2 IV (u )}.                      (15)

    Note that Result 2 imposes both the dynamic model and the GIV restrictions. This is
the sharp identified set because any  in this set generates a policy function that cannot be
rejected by the data plus the sharp GIV conditions.
    A natural question that arises is how to recover the profit parameters  from any given
( , u ) pair. This question has been investigated extensively for models without serial corre-
lation in the unobservables. Here we extend some of those methods to the case with serial
correlation. In particular, we show that, under certain conditions, the parameter  can be
conveniently recovered by solving a system of linear equations. To this end, we define the
value of taking action a as follows:16

                                                                                          v (a, x, w, u; , ) =
                                           "   1
                                                                                                            #
                                               X                                                                        (16)
                                                      t
                (a, x, w, u;  ) + Eu                       ( (xt , wt , ut ), xt , wt , ut ;  ) a, x, w, u .
                                               t=1


Given that the true policy             is optimal, it must be the case that

                                      (x, w, u) = arg max v (a, x, w, u; , )                                            (17)
                                                             a


for every (x, w, u). Thus, if a value  is in the identified set, it must be that it solves (17) for
some u and some 2 IV (u ). Note that, given a pair ( , u ) from the first stage, verifying
this condition is a static optimization problem and is therefore much easier than solving the
associated Bellman equation.
    In order to illustrate how the condition in (17) can be used in practice, we extend an
argument made by HMSS for dynamic discrete choice models with i.i.d. unobservables. Our
  16
     We refer to v (a, x, w, u) as the action (or choice) specific value function, but much of the literature refers
to it as the "conditional" value function.


                                                                 14
approach applies to a wide class of models with discrete actions and continuous, possibly
serially-correlated unobservables.17 More specifically, we use indierence conditions implied
by (17) to write a system
                           of linear equations in the profit parameters.
                   ~
    Fix a pair ~ , u from the first step and let   ~ denote a value for the profit parameters
                               
that is consistent with ~ , ~u given the model. For now, we do not assume that such a       ~
is unique; later, we will provide conditions that ensure it is unique. If there is no such ~ ,
                                        
then the model rejects the pair ~ ,   ~u . Suppose that, given (x, w) and a pair of actions, a
and a0 , there exists a value of the unobservable, say u
                                                       ~(a, a0 , x, w), such that
                                                                                            
                    ~(a, a0 , x, w); ~ , 
         v a, x, w, u                    ~ , ~u  = v a0 , x, w, u
                                                                ~(a, a0 , x, w); ~ , ~ , ~u            (18)

                       ~(a, a0 , x, w) be uniquely defined by (18), only that it exist.
We do not require that u

Assumption 1. The variables (a, x, w) take discrete values and for each (a, x, w) there is an
action a0 6= a such that there is at least one u
                                               ~(a, a0 , x, w) satisfying the indierence condition
in (18).

   Assumption 1 is high-level assumption. In Berry and Compiani (2020), we show the
indierence conditions in (18) are a natural extension of equations employed in the HMSS
second-step for multinomial discrete choice with independent errors. Not all second-step
CCP methods generalize easily (or at all) to the case of serial correlation, but this one
does.18 The next assumption provides more primitive su cient conditions.

Assumption 2. (i) The variables (a, x, w) take discrete values; (ii) the support of u is
connected; (iii) the action-specific value function v is continuous in u; (iv) for each (x, w),
~ (x, w, ·) takes at least two distinct values.

    Assumption 2(ii ) is a standard support restriction; Assumption 2(iii ) is also standard
and can be verified using results in Stokey et al. (1989); Assumption 2(iv ) can be directly
verified by inspecting the ~ from the first step.

Lemma 1. Assumption 2 implies Assumption 1.
  17
    See also Pesendorfer and Schmidt-Dengler (2010). This working paper version of later published work
emphasizes an indierence condition interpretation of policy functions in the context of dynamic discrete
choice with independent errors.
  18
    HM and Arcidiacono and Miller (2011) employed related multi-period indierence conditions to simplify
a second-step in problems with "finite dependenc" and independent errors. These methods could be adapted
to our case as well if the underlying model featured additive independent errors in addition to any serially
correlated component. Kalouptsidi, Scott, and Souza-Rodrigues (2020) make use of related finite-dependence
indierence conditions in their special case IV method. Further exploration of finite dependence in our
context is an interesting future research agenda.




                                                    15
Proof. Fix any (x, w) 2 X  W. By Assumption 2(iv ) and the definition of v , there are two
actions, a0 , a00 , and two values of the unobservable, u0 , u00 , such that
                                                                                   
                      v a0 , x, w, u0 ; ~ ,  ~ , ~u  v a00 , x, w, u0 ; ~ , ~ , ~u
                                                                                   
                     v a00 , x, w, u00 ; ~ , ~ , ~u  v a0 , x, w, u00 ; ~ , ~ , ~u

Define
                                                                                     
                               0
                 d (u)  v a , x, w, u; ~ , ~ , ~u            00
                                                         v a , x, w, u; ~ , ~ , ~u

and note that d (u0 )    0     d (u00 ). Thus, by the Intermediate Value Theorem for general
metric spaces,19 there exists at least one u000 such that d (u000 ) = 0, which proves the claim.

    Next, we show that these assumptions ensure that a minimal necessary condition for
uniquely recovering  is satisfied, i.e. that there be at least as many equations as unknowns.
We consider the case in which profits are parameterized in an entirely flexible way with the
elements of  representing the (deterministic) single-period profits for each combination of
(a, x, w). Under more restrictive parameterization of profits, it may be possible to recover
 under weaker conditions.
                                                                                        
Lemma 2. Under Assumption 1, the parameters           ~ associated with the pair ~ ,  ~u from
the first step satisfy a system of equations with at least as many equations as the cardinality
of A  X  W.

Proof. The result follows immediately from the fact that, given Assumption 1, one can write
at least as many equation of the form (18) as the cardinality of A  X  W.

     We now show that, when the single-period profits are linear in  , the above yields a
system
         of linear equations. The coe cients of this system are known given a candidate
      ~
  ~ , u from the first step and can be computed via forward-simulation as in BBL.

Assumption 3. The single-period profit function is linear in  .
                            
Result 3. Fix a pair ~ ,  ~u from the first step. Under Assumptions 1 and 3, the parameters
                         
~ associated with ~ , 
                       ~u satisfy a system of linear equations, with at least as many equations
               of A  X  W. Further, the coe cients of the system are known given the
as the cardinality
        
model, ~ ,  ~u , and the transition functions in (4)-(5).

Proof. HMSS show that when then the single-period profit is linear in  , then the action-
specific value function v is also linear in  . This trivially extends to the case of serially
 19
      See, e.g., Theorem 4.22 in Rudin (1976).


                                                    16
correlated unobservables, so that we can write
                                  
                             ~  ~
           v a, x, w, u; ~ ,  , u   = h0 (a, x, w, u, ~ , ~u ) + h1 (a, x, w, u, ~ , ~u )~ ,

for some known functions h0 , h1 .
    For each (a, x, w), Assumption 1 then guarantees that we can write
             h                                                                                    i
                              ~(a, a0 , x, w), ~ , 
                 h1 (a, x, w, u                    ~u )   h1 (a0 , x, w, u
                                                                         ~(a, a0 , x, w), ~ , ~u )  ~ =
                                                                                                            (19)
                        h0 (a0 , x, w, u
                                       ~(a, a0 , x, w), ~ , ~u )                ~(a, a0 , x, w), ~ , 
                                                                   h0 (a, x, w, u                    ~u )

for some a0 6= a. This establishes the result.

    Given this linear system, we have two cases depending on whether a standard (and
directly verifiable) rank condition is satisfied. If the rank condition holds, we can solve for
the unique   ~ in closed form. Otherwise, we obtain multiple values of   ~ associated with the
first-step parameters.
    One might wonder whether the value(s) of  obtained in the second step are always
consistent with the Bellman equation. This, paired with sharpness of the identified set for
( , u ) from the first step, would imply that the identified set for  is also sharp. In the
next section, we address this for our illustrative entry/exit example and show that indeed
the two-step approach delivers sharp identification of the structural parameters.
    The results above focus on the case where the actions and states are discrete. However,
a similar logic applies to models with continuous actions as well. We illustrate this via the
following example.

Example 1 (Continuous-choice stochastic accumulation). Consider the "stochastic accumu-
lation problem" from Pakes (1994) and Doraszelski and Pakes (2007). In this model, firm i
chooses the level of investment ait , a continuous variable, based on its current e ciency or
quality xit (often taken to be discrete). The distribution of e ciency or quality at t + 1 is
assumed to be stochastically increasing in ait . Let
                                             "                                            #
                                               X
    v (a, x, w, u; ) =  (a, x, w, u,  ) + Eu      V (x0 = k, w0 , u0 ) (x0 = k |x, a) w, u , (20)
                                                           k


where both the single-period profit and the transition (x0 = k |x, a) are dierentiable in a.
   The optimal action then satisfies
                                    "                                         #
                                      X                       0
          @ (a, x, w, u,  )                  0       0  0 @ (x = k |x, a)
                            + E u        V (x = k, w , u )                w, u = 0.       (21)
                 @a                   k
                                                                @a




                                                           17
Given a candidate (~ , ~u ), then we can reject a candidate ~ unless

                                                @ (~ (x, w, u), x, w, u, ~ )
                                                                             +
                     "                                        @ a       #
                       X                      0                                            (22)
                             0      0   0 @ (x = k |x, ~ (x, w, u))
                 E~u     V (x = k, w , u )                          w, u = 0.
                       k
                                                    @a

As in the discrete case, linearity of the profit function is inherited by the value function and
forward simulation can be used to approximate the coe cients on         ~ . Thus, equation (22)
gives a continuum of linear equations that can be used to back out the profit parameters.

   We conclude this section by noting that our proposed second step does not require the
use of any inequality conditions. This is contrast to existing approaches, such as BBL, which
require considering perturbations of the policy function from the first stage and imposing
the implied inequalities even in absence of serially correlated unobservables.


2.6    Inference
So far, we have focused on identification of the model. We now briefly discuss how to obtain
confidence regions for the structural parameters. In doing so, we again follow the two steps
outlined above.
    The sharp identified set for the first-step parameters ( , u ) is characterized by the in-
equalities (13). Therefore, estimates of the identified set and confidence regions for ( , u )
can be obtained by applying methods from the by now large literature on moment inequal-
ities models (see, e.g., Chernozhukov et al. (2007), Andrews and Soares (2010), Beresteanu
et al. (2011), Galichon and Henry (2011), Andrews and Shi (2013), and Chernozhukov et al.
(2013)). As pointed out by CR, one issue that often arises is that the number of inequalities
characterizing the sharp identified set is large relative to the sample size, or even infinite.
For example, in our empirical application, we consider the entry and exit patterns from a
cross section of markets over twelve years. Since there can be zero, one or two firms in
the market at any given point in time, the number of inequalities associated with just the
"elemental" sets is 312 = 531, 441. Fortunately, recent results provide some guidance on how
to deal with the "many inequalities" case. References include Menzel (2014), Chernozkukov
et al. (2018), and Andrews and Shi (2017). In our application, we use one of the bootstrap
procedures proposed by Chernozhukov et al. (2018) to obtain valid confidence regions for
the parameters. Roughly speaking, their approach provides an econometrically disciplined
way of determining the subset of moment inequalities that are most informative about the
parameter values.
    The second step in our approach maps the first-step parameters into the primitive single-
period profit parameters. As shown in Result 3, this map only depends on the model and


                                              18
does not involve the data. In particular, all that is needed is knowledge of the action-specific
value functions given the first-step parameters. Standard forward-simulation methods can be
used for this purpose, as illustrated in Section 3.2. With a large number of simulation draws,
the error from the second stage will be negligible relative to sampling error. Alternatively,
one could adjust the standard errors to account for any noise from the second step.
    The two-step approach is not the only way to conduct inference. Another option is to
solve the model for each candidate value of the structural parameter  and verify whether
the implied policy function satisfies the GIV restrictions. This full-solution method may be
viable in some cases (e.g., when the states take a small number of values), but typically
would require one to parameterize the profit function. A third approach--often used in
the empirical literature--parameterizes both the policy function and the profit function.
This "double parameterization" has the undesirable feature that the functional form used
for the policy might be inconsistent with the profit parameterization in the sense that no
choice of the structural parameters leads--via the model--to the chosen functional form for
the policy. Thus, in the numerical illustration of Section 3.3, as well as in the empirical
application (Section 5), we focus on the first two approaches: the two-step procedure and
the full-solution method.


3    A Simple Example
In this section, we consider a minimal single-agent model that illustrates identification via
GIV restrictions. In the example, the state is whether a firm is "In" or "Out" of the market
in the prior period, xit 2 {0, 1}, and the action today is whether to be active in the market
today, ait 2 {0, 1}. Exit is reversible and there are no exogenous profit shifters w.
    A firm that is already in the market (xit = 1) and decides to stay in (ait = 1) earns a
single-period profit equal to  it , while a firm that is out of the market (xit = 0) and decides
to enter (ait = 1) earns the same single-period profit minus a sunk cost . Whenever a firm
decides to be inactive (ait = 0), it earns zero profits. We interpret it as a shock reflecting
variation in per-period fixed costs and assume that it follows a first-order autocorrelation
process,
                                                      p
                                it = i,t   1   + it    1     2 ,                           (23)

where it is distributed standard normal. The resulting model then has three structural
parameters:  , , and . The policy function that generates the data is

                                       ait = (xit , uit ),                                 (24)




                                                19
where uit  Unif(0, 1) can be normalized to be the quantile of it .20 We assume that the
dynamic model generates the natural monotonicity results that is weakly increasing in xit
and weakly decreasing in uit .


3.1     First step
The first step consists in characterizing the identified set for ( , ). If we focus on only
one period of data, the policy function in (24) is a nonparametric binary choice model with
endogeneity and monotonicity restrictions, similar to Chesher (2010). Given monotonicity
in uit , the policy function is fully described by two policy cutos,  (x), for x 2 {0, 1}, as
illustrated in Figure 1.



                         Figure 1: Policy Cutos in the One-Period Case


                                                                           uit
                                0           (0)             (1)        1




   As in Manski (1988) Chesher (2010), even one period of data will generate nontrivial
bounds on the policy function. As a simple example of GIV restrictions, Table 3 illustrates
the inverse image sets associated with the example (in column 2) as well as the inequalities
implied by the GIV restrictions (in the last columns of the table). Note that [1] there are



           Table 3: Inverse Image Sets & Inequalities for the One-Period Example


                 a   x    S = U (a, x, )       Pr U (ai , xi , )  S |z            ( S ; u )
                 1   1      (0,  (1))        Pr((1, 1)|z ) + Pr((1, 0)|z )         (1)
                 1   0      (0,  (0))                         Pr((1, 0)|z )        (0)
                 0   1      ( (1), 1)                         Pr((0, 1)|z )       1  (1)
                 0   0      ( (0), 1)        Pr((0, 0)|z ) + Pr((0, 1)|z )        1  (0)




nontrivial bounds even in the absence of IVs, but [2] instrumental variable variation is helpful

  20
    To see this, one can write ait =    xit , F 1 (F (it )) , where is a nonparametric function and F is the
cdf of it . Equation (24) then follows by defining uit = F (it ) and (xit , ·) =  xit , F 1 (·) .


                                                    20
to tighen those bounds. Note also that, by themselves, the restrictions in Table 3 place no
restrictions on u . It is not surprising that it is impossible, in the example, to learn anything
about serial correlation from restrictions on the single-period policy function. However, with
multiple periods of data, restrictions on the policy function may rule out some values of
serial correlation, even without reference to the structural model.
    We illustrate this by considering two periods of data. Now there are eight elemental
inverse image sets U (ai , xi , ), in the space of (ui1 , ui2 ), that depend on (xi1 , ai1 = xi2 , ai2 ).
These are illustrated in Figure 2. The left panel gives the four elemental sets associated with
the initial condition xi1 = 0, while the right panel gives the sets associated with xi1 = 1. For
a given initial condition, the model is complete (the sets do not overlap), but across initial
conditions the sets do overlap, reflecting incompleteness. For example, there are values of
(ui1 , ui2 ) that are consistent with both the sequence (1, 1, 1) and the sequence (0, 0, 0). If the
initial xi1 was exogenous, the model would be complete.



                   Figure 2: Elemental Inverse Image Sets Labeled as (xi1 , ai1 , ai2 )

               1                                                      1
                   (0, 1, 0)                                                  (1, 1, 0)
           (1)                 (0, 0, 0)                          (1)                     (1, 0, 0)
          u2                                                     u2
           (0) (0, 1, 1)                                          (0)         (1, 1, 1)
                               (0, 0, 1)                                                  (1, 0, 1)
               0                                                      0
                   0      (0) u1           1                              0          u1  (1)       1




    The sets in Figure 2 allow us to build some intuition about identification in this class
of models.21 Recall that the probability of the each of the eight events associated with
dierent (xi1 , ai1 , ai2 ) must be less than the probability weight placed by the distribution of
(ui1 , ui2 ) over the regions of the elemental sets. In Figure 2, the joint density of (ui1 , ui2 ),
which varies with the serial correlation parameter , places the relevant probability weight
over the various regions. Note that in this example, with two time periods, we can rule out
some values of  without any use of the dynamic model. For example, perfect correlation,
  21
    The core-determining collection of sets also includes unions of partially overlapping elemental sets, which
we show in Appendix A.


                                                      21
 = 1, collapses the joint density down to a straight line across the diagonal of each box.
If in large samples we observe the events (0, 1, 0) or (1, 0, 1) conditional on any value of the
instrument, then we can reject  = 1 since the associated GIV inequalities of the form (13)
have a positive left-hand side and the right-hand side equal to zero.
    As another piece of intuition, consider an instrument associated with a probability equal
to one for initial condition xi1 = 1. The event probabilities associated with the right-hand
side panel of Figure 2 then sum to one and all of the associated inequality restrictions
hold with equality. These equalities are exactly the same as those that would be implied
by maximum likelihood applied to the model with an exogenous initial condition xi1 = 1.
Thus, if MLE point-identifies the parameters ( (0),  (1), ), then GIV identifies the same
parameter values in this special case.


3.2     Second Step
Next, we apply Result 3 to recover the structural parameters ( , ) given a pair ( , ) from
the first step. For each value of x 2 {0, 1}, firms are indierent between being in and out of
the market when uit =  (x). This gives two indierence conditions involving action-specific
value functions of the form (18).22 Since the action-specific value functions do not have a
closed form expression, we show how to approximate them via forward-simulation. For any
a and x,
                                      v s (a, x,  (x), , ) =
                       S   ¯
                           T                 S   ¯
                                                 T                           ¯
                                                                           S X
                                                                             T
                    1 XX t s              1 XX t s                         X
                              at                    at 1 { x s
                                                             t = 0}
                                                                                     t s s
                                                                                       t at ,
                    S s=1 t=0             S s=1 t=0                        s=1 t=0

where: (i) s t is set to the  (x)-th quantile of it for t = 0 and for t      1 is drawn using (23)
and the correlation  from step 1, (ii) x0 and a0 are set to x and a, respectively, (iii) as
                                               s     s
                                                                                              t for
                                                                    ¯
t 1 is determined by the policy from step 1, and (iv) S, T are large numbers. The two
equalities v s (0, x,  (x), , ) = v s (1, x,  (x), , ) for x 2 {0, 1} then give a system of linear
equations in ( , ).
    As mentioned above, one might wonder whether the sharpness of the identified set for
( , ) from the first step is inherited by the identified for  from the second step. To address
this, we show that any value  obtained in the second step is consistent with the model's
Bellman equation. Thus, if the identified set for ( , ) from the first step is sharp, the
resulting identified set for  from the second step is also sharp.

Result 4. Let (~ , ~) be any pair from the first step with ~ weakly decreasing in u and ~                   0,

  22
    In order to fully map our entry example into Result 3, note that we implicitly have used the two
additional restrictions that single-period profits are zero when firms decide to be out. Thus, we have in total
four equations corresponding to the cardinality of A  X.



                                                      22
and let ~ be any value of  returned by the second step. Then,

                                ~ (x, u) = arg max v (a, x, u; ~ , ~, ~)                           (25)
                                               a


for all x, u, i.e. the policy ~ from the first stage solves the Bellman equation associated with
~ and   ~.

Proof. See Appendix D.


3.3     Numerical Illustration
We now compute the identified set for the structural parameters in an instance of the entry
model described above. We will pay special attention to how the identified set changes with
the number of time periods, the strength of the instruments, and the presence of exogenous
profit shifters. In order to abstract from sampling error and focus on the shape of the
identified set, we draw a large number of cross-sectional markets (50,000).
    We set the deterministic profit parameter  to 0.5, the sunk cost to 1.5, and the corre-
lation parameter  to 0.75, so that there is persistent unobserved heterogeneity. We generate
time-invariant excluded instruments z taking the values {0, 1} with equal probabilities and
set xi1 = zi for a fraction of markets in the data equal to 0.50 or 0.75. We call this frac-
tion "IV strength" and note that it is equal to the square root of the R2 coe cient in the
regression of the endogenous state xi1 on the IV (plus a constant).23 We compute the three-
dimensional identified set for ( , , ) and we plot its projections onto the space of profits
( ,       ) and the space of sunk cost and correlation parameters. Note that, since we are
treating both the policy and the deterministic profit function fully flexibly, the full-solution
method and the two-step approach give the same identified set.
    First, we consider how the identified set varies with the IV strength as well as the number
of time periods (T = 2 and T = 10). In the case with T = 2, we are able to list all of the GIV
restrictions implied by the model and thus obtain sharpness of the identified set, as outlined
in Section 3.1. On the other hand, with T = 10, the number of inequalities in the GIV core-
determining class becomes very large. So, instead of listing all the inequalities, we use those
corresponding to the sharp two-period GIV identified set as well as those associated with
several observable events over the ten time periods.24 We pick events that intuitively should
help us shrink the identified set. Specifically, we use the events "the firm enters at least
once," "the firm exits at least once," "the firm enters at least once and exits at least once,"
and "the number of firms in the market, xit , does not change for at least six consecutive
  23
  Specifically, IV strength = 0.50 corresponds to R2 = 0.25 and IV strength = 0.75 corresponds to
 2
R = 0.56.
  24
   Since it is hard to obtain a closed form for the model probabilities associated with these events, we
approximate the probabilities via simulation.


                                                   23
periods." To build some intuition, consider the latter event. We would expect this to help
rule out values of  close to zero, since it yields inequalities where the sample probabilities on
the left-hand side are large (the data exhibits a lot of persistence given that we set  = 0.75)
and the model necessary conditions on the right-hand side are relatively small (when  is
close to zero the model predicts little persistence in the observables). A similar argument
applies to the other events we include. Figure 3 show that, when IV strength is low and
T = 2, the identified set is quite large. On the other hand, as expected, the set shrinks
considerably as the number of time period grows or the IV becomes stronger (Figure 4).
    As a comparison, we report estimates obtained via two standard methods (MLE and
GMM) that assume away serial correlation in the unobservables, consistent with most of the
existing literature. In the MLE approach, we pool all observations along the cross-section
and time-series dimensions and maximize the resulting one-period likelihood. In contrast, in
the GMM approach, we use moments based on the two-period and three-period transitions
as well, while still restricting  to be zero. Both methods--and particularly GMM--tend
to overestimate the sunk cost. Intuitively, a model that assumes no serial correlation in the
unobservables will load all the persistence in the data onto the sunk cost, thus overestimating
its magnitude. In addition, Figures 7 and 8 in Appendix A.2 show that MLE and GMM
with  = 0 tend to underestimate the profit parameters.



                                  Figure 3: Low IV strength




                                               24
                                       Figure 4: High IV strength




   Next, we explore the impact of adding an exogenous covariate wit to the model. We
specify the firm per-period profit as follows:
                               8
                               >
                               <wit
                               >                it          if ait = 1, xit = 1
                        it =       wit               it     if ait = 1, xit = 0
                               >
                               >
                               :
                                   0                        if ait = 0

so that wit could be interpreted as a measure of market size such as population, wit rep-
resents variable profits, is fixed costs, and is again the sunk cost of entry. Further, we
                                                                    2
let it follow the AR(1) process in (23), with it distributed N (0,    ). Following Pakes et al.
(2007), we assume that the term wit         has already been estimated outside the dynamic
model and we focus instead on the parameters ,  and .25 When generating the data, we
set  = 1.5, = 1, = 1.5,  = 0.75, = 1, and we focus on the case where IV strength is
low. Regarding the distribution of the covariate, we let the initial wi0 for each market take
the values {0.15, 1.00, 1.65} with equal probabilities and evolve according to the transition

  25
    Note that, unlike the case without wit , here we are not allowed to normalize since the non-stochastic
part of the period-profits is modeled parametrically. Accordingly, for this design, we report the standardized
sunk cost to ensure comparability with the plots for the case without w.




                                                     25
matrix
                                           2                  3
                                             0. 6 0 . 2 0 . 2
                                           6                  7
                                           40. 2 0 . 6 0 . 25
                                             0. 2 0 . 2 0 . 6

Note that the parameter values are chosen in such a way that the single-period profit function
when wit = 1 is the same as in the model without wit .
    Because wit is exogenous, it can be used as an additional conditioning variable in the GIV
inequalities along with the excluded IV. Thus, adding wit to the model increases the number
of inequalities that each candidate parameter value must satisfy in order to be included in
the identified set. We would then expect the identified set to be smaller in the model with
the exogenous covariate.26 As shown in Figure 5, this is indeed the case.



                               Figure 5: Eect of exogenous covariate




     Finally, we illustrate how the identified sets translate into bounds on counterfactual quan-
tities. For brevity, we focus on the case with T = 2, strong IV and no exogenous covariate
wit . We consider three counterfactual scenarios: (i) an increase in the sunk cost of entry by

  26
     However, note that, because wit varies over time in the data, the policy function also changes relative
to the "no wit " case (even for the value of wit that makes the per-period profit identical to that in the "no
wit " model). Thus, it need not be the case that the identified set in this section is a subset of that in the
"no wit " model.


                                                      26
4.00--corresponding to 267% of its true value--which we call "the sunk cost counterfactual"
for brevity; (ii) an increase in the fixed cost by 0.50--corresponding to 50% of its true value--
and a simultaneous decrease in the sunk cost by 0.125--or 8% of its true value--which we
call "the fixed cost counterfactual"; (iii) a 1.25 subsidy to entry--corresponding to 83% of
the true value of the sunk cost--which we call "the subsidy counterfactual." The sunk cost
counterfactual is meant to simulate a policy, such as environmental regulation, that only
constrains new entrants. On the other hand, the fixed cost counterfactual corresponds to a
policy restricting both incumbents and entrants. We simultaneously decrease the sunk cost
in this counterfactual to reflect the fact that complying with the regulation may be easier
for new entrants than for incumbents (e.g., due to retrofitting costs). Finally, the subsidy
counterfactual mimics a policy encouraging entry of new firms that might be using cleaner
or otherwise better technology.
    The procedure we employ to assess the impact of these shocks is as follows. For each
market in the data, we draw many time series for the unobservables and look at how the
number of firms as well as the fraction of new firms--defined as firms that enter after the
policy change--evolve 10 years after each of the three counterfactual changes.27 We then
average across markets as well as realizations of the unobservables.
    Tables 4 and 5 show the results for the GIV approach as well as the MLE and GMM
models with  = 0. One can see that assuming away serial correlation in the unobservables
leads to bias in the estimated reaction to the policy changes, in terms of both the number
of firms and the fraction of new firms. The eects of the policies tend to be overstated,
in particular for the fixed cost and the subsidy counterfactuals. Intuitively, when  = 0
the unobservables drawn in the counterfactuals will exhibit much less persistence relative to
their true distribution. This, in turn, leads to an excessive amount of predicted entry and
exit.




  27
    This requires choosing an initial value for the unobservable. For each market, we compute the bounds
on u0 implied by (x0 , a0 ) and the model, and repeat the exercise twice setting u0 equal to the upper and
lower bounds, respectively. We then take the convex hull of the two resulting outcomes.


                                                   27
                                    Table 4: Number of firms

                                True           GIV              MLE           GMM
                                                               =0             =0
             Baseline           0.659     (0.612,   0.701)     0.817           0.763
             Sunk cost ( )      0.059     (0.017,   0.123)     0.012          -0.154
             Fixed cost ( )     -0.167   (-0.289,   -0.139)    -0.769         -0.700
             Subsidy ( )        -0.023   (-0.052,   -0.011)    -0.167         -0.140

Note: The first row shows the average number of firms in the market in the absence of policy
changes. Rows 2-4 show the change--relative to the first row--in the average number of firms in
the market 10 years after the policy change (an increase in the sunk cost, a simultaneous increase
in the fixed cost and decrease in the sunk cost, and a subsidy to entry, respectively). The dgp has
T = 2, strong IV and no wit covariate.




                                 Table 5: Fraction of new firms

                                True           GIV              MLE           GMM
                                                               =0             =0
             Baseline           0.591     (0.460,   0.781)     0.574          0.516
             Sunk cost ( )      -0.193   (-0.349,   -0.098)    -0.291         -0.270
             Fixed cost ( )     0.186     (0.102,   0.288)     0.429          0.426
             Subsidy ( )        0.124     (0.066,   0.209)     0.366          0.379

Note: The first row shows the average fraction of new firms in the market in the absence of policy
changes. Rows 2-4 show the change--relative to the first row--in the average fraction of new firms
in the market 10 years after the policy change (an increase in the sunk cost, a simultaneous increase
in the fixed cost and decrease in the sunk cost, and a subsidy to entry, respectively). The dgp has
T = 2, strong IV and no wit covariate.




                                                 28
4    Dynamic Oligopoly
We now extend the analysis to the setting where multiple firms interact in each market. In
the oligopoly case, each firm's equilibrium policy is its single-agent best reply to its rivals'
equilibrium strategies. The firm still solves a value function problem similar to (7), but its
expectations of the future evolution of endogenous market states depend on its action as
well as the equilibrium actions of its rivals.
   Throughout this section, we assume complete information for the serially correlated com-
ponents of unobservables. If the serially correlated unobservables are not common knowledge
across all players, standard equilibrium concepts such as perfect Bayesian equilibrium often
become intractable in that they imply that the entire history of play enters the current state.
Fershtman and Pakes (2012) propose a tractable framework to deal with persistent sources of
asymmetric information and our methods might be usefully merged with theirs. In Appendix
B, we illustrate a computed oligopoly problem that features both [i] serially correlated errors
that are observed by all the firms and [ii] private information shocks that are independent
over time. The combination of observed (by rivals) errors and private information errors is
reminiscent of the discussion in Pakes, Porter, Ho, and Ishii (2015).
   Since there are multiple firms per market, here we require our original notation of i for
the market and j for the firm. If the equilibrium policies of firm j 's rivals are given by the
function j , then the firm's expected equilibrium state transition probabilities are given by

                                      ~ j (xit+1 |aijt , xit , wit ,    j (xit , wit , uit )) .                                          (26)

This notation allows for a rich set of possible state transitions models, including oligopoly
variations on our earlier single-firm examples.
    Firm j 's equilibrium Bellman equation then depends on the equilibrium strategies of its
rivals:
                                     Vj (xit , wit , uit , j ) =                         (27)

       max           (j (ait , xit , wit , uit ;  ) + Eu [Vj (xit+1 , wit+1 , uit+1 ,                  j ) |ait , xit , wit , uit ]) .
    aijt 2A(xijt )

The expected Bellman's equation is

                                                                        E [Vj (x0 , w0 , u0 ) |a, x, w, u,               j]   =
          Z Z Z
                        Vj (x0 , w0 , u0 ,   j) d
                                                    ~ (x0 |aj , x, w,    j (x, w, u))dQ(w
                                                                                                  0
                                                                                                      | w ) d ~ ( u0 | u ; u ) .

Associated with this dynamic program is a best response strategy for firm j , which we assume




                                                                29
is unique,28 denoted by ¯j (       j ,  ).   The vector of best response strategies is then the J -vector

                                 ¯ ( , ) = (¯1 (          1 ,  ), . . . ,   ¯J (   J ,  )).


                                                   
Any vector of equilibrium strategies,                 , must satisfy the fixed point

                                                      
                                                         = ¯ (  ,  ).                                          (28)

We can then define the set of possible equilibrium policy function vectors as

                                                                  
                                       EQ () = {             :       = ¯ (  , )}.

We adopt the same approach as in earlier papers and assume that, even if the underlying
model admits multiple equilibria, the firms themselves always play the same policy function
when at the same state vectors.29 The true policy function that generates the data is then
an element of the set EQ (), where  is the true parameter that generates our data.
    The sharply identified set of parameters in the oligopoly case is the same as in the single
agent case, except with the further restriction that the policies associated with  are a vector
of equilibrium policies:

                                                                                              
           ID  { = ( , u ) : there exists                        2 EQ () such that               2 IV (u )}.   (29)

That is, a parameter vector  is in the identified set if there is a policy vector that both [i] is
not rejected by the IV restrictions and the data (given u ) and [ii] is a vector of equilibrium
strategies given .
      In practice, we may recover ID via a two-step procedure, just like in the single-agent
case. First, note that the argument for the first step from Section 2.4 immediately extends
to the oligopoly setting, since displays (11) to (14) continue to hold when the variables
ait , xit , wit , uit and the function are vector-valued. Thus, we can characterize the identified
set for the policy vector IV (u ) using the GIV restrictions. Second, one can easily extend
the dynamic best reply condition (17) to the oligopoly setting as follows:

                         j (x, w, u)   = arg max vj (aj ,            j   (x, w, u) , x, w, u; , )              (30)
                                              aj


where vj is the oligopoly analogue of (16) for firm j . Note that, in defining vj for the oligopoly
case, we treat the actions of rival firms as being generated by j (in addition to generating

  28
    Again, Stokey et al. (1989) provide standard conditions guaranteeing uniqueness of the best response
strategy. Note that we assume uniqueness of the best reply but not of the overall equilibrium strategy profile.
  29
    This approach was adopted approximately simultaneously in Bajari, Benkard, and Levin (2007), Pakes,
Ostrovsky, and Berry (2007) and Pesendorfer and Schmidt-Dengler (2008).


                                                             30
the future actions of firm j based on j ). As in the single-agent case, the best reply in (30) is
therefore a static optimization problem and does not require solving any Bellman equations.
Furthermore, it is a general condition that can be used to characterize the identified set in
any problem. Specifically, the identified set for  is characterized as the values of the profit
parameters that solve (30) for some u and some 2 IV (u ).
    As in the single-agent case, in many oligopoly cases we will be able to find simple in-
dierence conditions that are necessary for the best reply equation in (30) to hold. In that
case, the second-step search for the identified set of single-period profit function parameters
may once again be characterized as the set of solutions to a system of linear equations. In
the next section, we illustrate this via an oligopoly empirical application. The exact form
of the indierence conditions yielding the system of linear equations for our application is
given in Appendix C.
    It may be useful to compare our oligopoly procedure to other two-step procedures in the
literature. Our two-step procedure of the last paragraph is quite similar to Bajari, Benkard,
and Levin (2007), with two dierences. First, the policy functions are identified via GIV
conditions. Second, we obtain the sharply identified set via the static best-reply condition
(perhaps through the implied linear indierence conditions), whereas BBL suggest the use
of various inequality conditions that are motivated by the same best reply condition.
    We can also compare our approach to "full-solution" approaches that search across the
set of "structural" parameters ( , u ), at each point solving for a (one hopes) unique equi-
lirium. We believe that our set-identification approach clarifies identification issues in a way
that is often hard to do with full-solution approaches. There also a number of more practical
dierences. Full-solution methods become particularly hard in the case of possible multiple
equilibria.30 Once an equilibrium is calculated for a given parameter value, a full compu-
tational method must then compare the model's predictions to data. If the model features
a natural solution to the initial conditions problem, then the fit to data might be done via
maximum likelihood (as in, e.g., Rust (1987) and Igami (2018)) or else via a fit of data
moments to moments predicted from the model (Pakes and McGuire (2001). In contrast,
our method naturally accounts for unrestricted initial conditions and never requires a com-
puted solution to the equilibrium fixed-point problem, or even a solution to the single-agent
contraction mapping. In our method, the "fit to data" is provided by the GIV method. In
the absence of an initial conditions problem, the GIV approach often collapses into an MLE
or method of moments approach, reducing the dierence between the methods.
    The computational tradeo is that our method requires us to find a confidence region for
the identified set of policy functions. The nature of the tradeo here may vary with the fine
details of the problem and (in the absence of multiple equilibria issues) might favor either

  30
     See the online appendix of Doraszelski and Satterthwaite (2010) for examples of multiplicity. Further
examples are in Pesendorfer and Schmidt-Dengler (2010). Borkovsky et al. (2010) provides a homotopy
method for exploring a range of possible multiple equilibria.


                                                   31
method. Note that we could, if computationally advantageous, also employ a full solution
method. In this case, the "fit to data" for a computed equilibrium would involve testing
the GIV conditions for the policy function implied by the equilibrium behavior. In our
empirical example, we employ a full-solution GIV approach (assuming a unique equilibrium
and allowing for an initial conditions problem) as well as the two-step approach that we have
discussed in this section (which does not require a unique equilibrium).


5      Empirical Application to Environmental Policy Style
       Counterfactuals
In order to illustrate the approach, we apply it to the ready-mix concrete industry studied
by Collard-Wexler (2014) (henceforth, CW). CW quantifies the magnitude of the sunk cost
of entry in each of many isolated markets in the US and uses these estimates to assess how
persistent the eects of a horizontal merger are in this industry. More specifically, CW first
estimates the firms' policy functions based on data on the number of ready-mix concrete
plants and demand shifters. Given the policies, the paper then simulates the evolution of a
market following a merger to monopoly and evaluates how long it takes for a second firm
to enter.31 CW imposes an intuitively appealing parametric form for the policy functions,
rather than deriving them from an underlying dynamic model. One of our approaches below
will roughly mimic this approach.
    We use the same data and modeling framework as CW, but estimate all of the structural
parameters as opposed to just the policy functions and the serial correlation parameter.32
This allows us to address the counterfactual eects of policies that aect the "structural"
profit function. In particular, we consider the eects of policies--similar to the environmental
policies in the cement industry study of Ryan (2012)--that alter sunk costs. In addition,
since the GIV approach accommodates incomplete models, we are able to tackle the initial
conditions problem in a flexible way.33
    Note that our application is intentionally simplified to serve as an example within a longer
methodological paper. In particular, for this worked empirical example, we want to avoid the
large, growing and important literature on methods that solve the computational challenge
of methods that involve both (1) many parameters and (2) many inequality restrictions.

  31
    Lazarev et al. (2018) also consider counterfactual questions that only require knowledge of the dynamic
policy functions, but not the structural single-period profit parameters.
  32
    Collard-Wexler (2013) estimates a full model of industry dynamics using firm-level data under the
assumption that the dynamic states are econometrically exogenous. We use coarser market-level data, but
address the endogeneity of market structure.
  33
    CW addresses the initial conditions problem by simulating the probabilities of the initial states via a
modification of the GHK algorithm. This requires assuming that the industry has been following the same
set of policies for a long time.


                                                    32
Examples of this literature include Chen et al. (2018) and Kaido et al. (2019). To keep the
number of parameters small, we use an intentionally simplified state space and, even then, we
place further parametric restrictions. This gives us models with as few as five parameters so
that we can easily apply a multidimensional grid search to compute the required confidence
regions. Our restriction to problems amenable to a grid search is obviously strong given
the state of the literature, but it removes complex computational choices from the list of
problems we need to tackle.
    Table 6 summarizes the variables we use. The data on number of plants and construction
employment is the same as in CW and we refer the reader to that paper for more details.
Briefly, the number of plants variable measures how many firms are active in each isolated
town, while construction employment captures demand for ready-mix concrete. We follow
CW and treat construction employment as exogenous, while the number of concrete plants
is endogenous. In addition, we obtain data on past household income growth at the county
level from the US Census website. We assume that past income growth is excluded from the
current profits of concrete firms and that, conditional on current construction employment,
past income growth is independent of within sample unobserved shocks to profitability. Past
income growth therefore serves as an excluded instrument in our model.
    Table 7 shows results for a "quasi first-stage regression." This table presents an ordered
probit model with the number of firms as the dependent variable. We see that that the
coe cients on both exogenous variables are positive and precisely estimated. The result
suggests that our excluded instrument is "relevant," even when conditioning on current
demand. Of course, the true reduced form of the model is not an ordered probit and we
present this merely as a descriptive result.
    We conclude our brief descriptive analysis by reporting in Table 8 the transition probabil-
ities for the number of plants, which shows that the variable exhibits substantial persistence
over time.34
  34
    The results in Tables 7 and 8, as well as those from structural estimation, are based on a discretized
version of the original data. Specifically, since more than 90% of the original observations at the market-year
level have two or fewer plants, we censor the number of plants at two, which reduces the number of parameters
to estimate in the structural model. Similarly, we discretize construction employment and household income
growth. For each variable, we define a high and a low value depending on whether a given observation is
above or below the median. Because construction employment essentially has no over-time variation after
discretization, we take its value in the first year of the sample for each market and assume it is constant over
time (and that firms know it). This means that, when we condition on construction employment to compute
the moments implied by the model, the conditioning variable is scalar--as opposed to having dimension
equal to the number of time periods--which leads to much more precisely estimated moments.




                                                      33
                                  Table 6: Summary statistics

         Variable                                      Mean     St.Dev.    Min      Max
         Number of plants                               0.97      0.93     0.00     6.00
         Construction Employment                        519       819        3     17,772
         % Household Income Growth 1969-1989            0.15      0.11     -0.16    0.69
           Note: Fully balanced panel of 428 markets between 1994 and 2005.




                                 Table 7: Ordered probit results

                            Log Construction Employment          0.14
                            Income Growth 1969-1989              0.22
                            Likelihood-Ratio Test p-value        0.00

Note: Dependent variable is number of plants.      denotes significance at the 95% level.




                 Table 8: Transition probabilities conditional on instrument

                                                 xit+1
                                      xit     0    1    2
                                      0     0.92 0.07 0.01
                                      1     0.05 0.89 0.06
                                      2     0.01 0.10 0.89

Note: Each row displays the probabilities of dierent values of xit+1 conditional on a value of xit .




   We now turn to the structural analysis. As in CW, we estimate a version of the Last-In
First-Out model developed by Abbring and Campbell (2010). Again, we refer the reader to
CW for more details on what assumptions are imposed and why this is is a suitable oligopoly
model in the context of the ready-mix concrete industry. Importantly, in our simple model,
the Abbring-Campbell assumptions imply uniqueness of the equilibrium (see footnote 35)

                                                34
within the class of Last-In-First-Out equilibria. However, we also present results from a
two-step approach that allows for multiple equilibria.
   Some--but not all--of the results presented below rely on the following specification for
the single-period profit function:
                      8
                      >
                      <xit wi
                      >              + it           if was in at t     1, stays in at t
               it =       xit wi          + it      if was out at t     1, enters at t                  (31)
                      >
                      >
                      :
                          0                         if is out at t

where wi denotes construction employment (in thousands) in market i, xit is a coe cient
that depends on the number xit of active firms in market i at time t, represents the intercept
of the variable profit function as well as any fixed costs, is the sunk cost of entry, and it
denotes a potentially serially correlated unobservable shock to profitability. We assume that,
conditional on it 1 , it is equal to it 1 with probability  and is drawn uniformly from the
[ 1, 1] interval with probability 1 .35 Further, we impose the natural restriction 2        2
                                                                                             1
                                                                                               ,
i.e. that per-firm variable profits (weakly) decrease with the number of competitors.
     As mentioned above, because we have twelve years of data, the number of moment
conditions defining the sharp identified set is extremely large and it is not practical to use
all of them. However, the goal of obtaining a small confidence region for the identified set
suggests that we want to use a large number of them. This creates a potential problem,
as many methods for obtaining confidence regions will not perform well when the number
of moment inequalities is very large. A tension thus arises between the desire for a small
confidence region (on one hand) and the desire for accurate inference (on the other hand). To
resolve this tension, we report confidence sets for the structural parameters obtained via the
two-step multiplier bootstrap approach proposed by Chernozhukov et al. (2018) (henceforth,
CCK).36 The method is intended for cases where the number of moment inequalities is very
large, even larger than the dimension of the data.
     As in the Monte Carlo simulations from Section 3, we impose two sets of GIV moments:
(i) the full list of moments characterizing the sharp identified based on the first two time

  35
    This parametric specification for the joint distribution of the unobservables is used by Abbring and
Campbell (2010), who show that it satisfies their Assumption 3. This, along with other mild assumptions,
ensures existence and uniqueness of a Markov-perfect equilibrium in Last-In First Out strategies. Note that
we are able to map our model to that of Abbring and Campbell (2010), which features a scalar exogenous
state variable, since the covariate wi is time-invariant in our setting after the discretization described in
footnote 34. If wi also varied over time, then we would have two exogenous state variables--wit and it --
and uniqueness of the equilibrium might no longer hold. However, note that even in this case our two-step
approach would be able to (partially) identify the model parameters under the standard assumption that
the same equilibrium is played at a given state in the data.
  36
    For each candidate parameter value, we use as test statistic the maximum of the sample moments (at
that parameter value) divided by their standard deviations and scaled by the square root of the sample size.
We then compare the test statistic to the CCK critical value obtained with 250 bootstrap draws.


                                                     35
periods;37 and (ii) several inequalities corresponding to observable events over the entire
twelve years in the data.38 This second set is chosen to include events that are intuitively
likely to distinguish diering levels of serial correlation. For example, if the event "no entry
or exit occurs in the twelve-year period" is very common, this might indicate a high degree
of serial correlation. In addition to our list of intuitively information aggregated events, we
include the inequalities associated with the complement of each of these events and we make
sure that the left-hand side of each GIV inequality incorporates not only the observable event
associated with that inequality, but also all observable events whose necessary conditions (in
the space of unobservables) are subsets of the set whose probability is on the right hand side
of the inequality.
    Computationally, we follow CCK in generating a large number of draws to approximate
the integrals corresponding to these events and ignoring the corresponding simulation error.
Simple diagnostics suggest that the simulation variance is indeed negligible relative to the
sample variance. Since all our conditioning variables are discrete, we can easily turn the
conditional moment inequalities into unconditional ones. We obtain a total of with 614
inequalities.
    We estimate our GIV model in two ways. First, we use a traditional full-solution ap-
proach in which we solve the model for each candidate  and verify whether the implied
policy functions satisfy the GIV restrictions. This method requires a model with a unique
equilibrium. Our model satisfies the unique equilibrium conditions of Abbring and Campbell
if the exogenous shifters wit are fixed over time (see footnote 35). This is a strong restriction
that we maintain in our empirical specification. We also estimate a version of our two-step
method, which does not require uniqueness of the equilibrium. As in many more elaborate
two-step empirical exercises, to hold down the computation burden we impose a functional
form on the policy function. In particular, we use a five-parameter specification consisting
of four entry thresholds (corresponding to two values of xit and two values of wi ) plus a
shifter that, when added to the entry thresholds, gives the corresponding exit thresholds.
This choice of parameterization fairly closely matches the policies that are obtained via
the full-solution method. In addition, we impose the specification of single-period profits
  37
    We compute these moments by only using the first two years in the panel. In principle, one could obtain
more moments by taking all subsets of the data with two consecutive years. Because we already obtain
informative results when only using the first two years, we do not pursue this extension in the paper.
  38
     These events are: "some entry and some exit occur," "there are always zero firms," "there is always
one firm," "there are always two firms," "there is at least one period with zero firms," "there is at least one
period with one firm," "there is at least one period with two firms," "the number of firms goes from zero to
one," "the number of firms goes from one to two," "the number of firms goes from zero to two," "the number
of firms goes from two to zero," "the number of firms changes at least once," "the number of firms changes
exactly once," "the number of firms changes exactly twice," "the number of firms goes from one to zero,"
"the number of firms goes from two to one or zero," "the number of firms in the market is unchanged for at
least five consecutive periods," "the number of firms in the market is unchanged for at least nine consecutive
periods."


                                                      36
given in (31). This "double parameterization"--on both the policies and the single-period
profits--mimics the double parameterized specifications that are common in the CCP liter-
ature. We also estimated a more flexible two-step model in which the single-period profits
are unrestricted, i.e. each of the eight possible discrete values of  (x, w, a) is treated as a
separate parameter. Unsurprisingly given the limited sample size and variation in the data,
this more flexible model gives wide confidence intervals for the counterfactuals. However,
this might be a viable option when larger samples with more variation in the endogenous
states are available.
    In addition, we estimate three models that set  = 0 and thus assume away serial cor-
relation. Two are full-solution methods corresponding to the MLE and GMM approaches
used as benchmarks in the numerical illustration of Section 3.3. A third method mimics the
standard two-step approaches with exogenous states. In particular, we use the same double
parameterization as in the GIV two-step procedure described above, but we set  = 0 and
estimate the policy in the first step by MLE.
    Tables 9 and 10 display confidence intervals for the structural parameters in specification
(31) based on the full-solution and two-step approaches, respectively. First, both GIV ap-
proaches give estimates of  that are positive and significantly dierent than zero, indicating
substantial persistence in the unobservables over time. Second, the GMM approach with
 = 0 considerably over-estimates the sunk cost . Intuitively, like in the simulations of
Section 3.3, the GMM approach requires a very large sunk cost in order to rationalize the
observed persistence in the number of firms over time since, with  = 0, sunk costs are the
only source of stickiness in the model. On the other hand, the sunk cost is not over-estimated
by the MLE model with  = 0. To understand this, recall that the MLE model pools all
observations together and maximizes the single-period likelihood, thus eectively ignoring
the time dimension of the data, whereas the GMM model is designed to match the time
transitions of the states.


                          Table 9: Full-solution parameter estimates

                Full-solution GIV              MLE  = 0                  GMM  = 0
        1          (0.17,0.18)                (0.042,0.045)               (0.10,0.20)
        2         (0.010,0.011)                (0.01,0.02)              (-0.013,0.015)
                  (0.260,0.269)               (0.038,0.043)              (-0.04,-0.02)
                  (2.582,2.585)                (1.44, 1.46)              (6.40,10.56)
                   (0.65,0.76)                      --                        --

Note: The results impose the specification for single-period profits in (31), but do not restrict the
policy functions. The intervals have 95% confidence level.




                                                 37
                               Table 10: Two-step parameter estimates

                                   Two-step GIV                  Two-step  = 0
                        1            (0.10,0.40)                  (0.006,0.010)
                        2          (-0.0004,0.218)               (-0.005,-0.002)
                                     (0.14,0.54)                 (-0.036,-0.030)
                                   (-0.0001,1.766)                 (1.62,1.68)
                                     (0.74,0.87)                       --

Note: The results impose the parameterization of the single-period profits in (31) as well as the
five-parameter specification for the policy functions described in the text. The intervals have 95%
confidence level.



    In order to investigate whether allowing for endogeneity of market structure makes a
dierence for policy-relevant questions, we turn to counterfactual analysis. We consider
the impact of an increase in the sunk cost on the number and composition of firms in
the market.39 This can be thought of as arising from environmental regulation, such as a
mandate for new firms to invest in technology to reduce polluted water from running o
concrete operations.
    Tables 11 and 12 shows the counterfactual results. One can see that the approaches
assuming away serial correlation in the unobservables yield significantly dierent predictions
relative to the GIV methods. In particular, maximum likelihood with  = 0 tends to over-
estimate the response to the counterfactual policy in terms of both the change in the number
of firms and the decrease in the percentage of new firms (defined as firms that enter the
market after the policy change). Intuitively, the i.i.d. assumption forces the unobservables
to vary too much from one period to the next, which translates into excessive variation in
the implied market outcomes relative to the model with serial correlation. Table 12 shows
a similar pattern for the two-step methods. In contrast, the GMM approach with  = 0
predicts no change at all in the number or composition of firms. This is because GMM
estimates a very large sunk cost, relative to which the policy change is second-order. It is
also interesting to compare the two GIV methods. While the two-step approach delivers
wider confidence intervals than the full-solution method, the latter confidence intervals are
not contained in the former. This is because the two models are not nested: the two-step
procedure is more restrictive in that it places a parametric structure on the policy functions,
but on the other hand it is more flexible in that it allows for multiple equilibria.
    In sum, these policy counterfactual results show the large bias that may result from
models that artificially set the serial correlation parameter to zero, as is common in much
  39
    Specifically, we take the midpoint of the (projection of the) full-solution identified set for   and increase
the sunk cost by 10% of that value.


                                                       38
of the literature. Further, the relatively precise estimates from our full-solution procedure
show that dropping restrictive initial conditions assumptions need not lead to uninformative
results. In part, this stems from our use of new econometric techniques for moment inequali-
ties that allow us to employ very large number of moment inequalities in an econometrically
disciplined and correct way.



               Table 11: Counterfactual Outcomes: Full-solution approaches

                             Full-solution GIV            MLE  = 0                  GMM  = 0
 # of Firms
 Baseline                        (0.47,0.50)               (0.60,0.66)               (0.30,0.64)
 Increase in Sunk Cost         (-0.032,-0.031)            (-0.15,-0.11)                   0
 % of New Firms
 Baseline                         (7.7,9.7)                (27.6,32.0)                (0.7,0.9)
 Increase in Sunk Cost           (-2.3,-2.2)              (-15.4,-13.7)                   0

Note: For each outcome of interest (number of firms and percentage of new firms), the "baseline"
numbers refer to the average outcomes in the absence of policy changes, whereas the "increase in
sunk cost" numbers represent the change--relative to the baseline--in the counterfactual scenario
where the sunk cost is higher. All intervals have 95% confidence level.




                 Table 12: Counterfactual Outcomes: Two-step approaches

                                        Two-step GIV              Two-step  = 0
          # of Firms
          Baseline                       (0.74,1.314)               (0.89,1.02)
          Increase in Sunk Cost          (-0.18,-0.01)             (-0.22,-0.19)
          % of New Firms
          Baseline                        (15.2,38.9)               (22.1,27.9)
          Increase in Sunk Cost           (-0.9,-0.1)               (-8.6,-6.8)

Note: For each outcome of interest (number of firms and percentage of new firms), the "baseline"
numbers refer to the average outcomes in the absence of policy changes, whereas the "increase in
sunk cost" numbers represent the change--relative to the baseline--in the counterfactual scenario
where the sunk cost is higher. All intervals have 95% confidence level.




                                                 39
6    Conclusion
In this paper, we have proposed an approach to identification and inference in dynamic mod-
els with serially correlated unobservables. We tackle the resulting endogeneity of dynamic
states by relying on the type of instrumental variables intuition that is commonly used in
static models. In order to characterize the identified sets for quantities of interest and ob-
tain confidence regions, we leverage recent results in the econometrics literature on partially
identified models and the associated inference literature. Our empirical application extends
work by Collard-Wexler on dynamic entry models with serially correlated unobservables to
consider policy counterfactuals that are motivated by classic questions in environmental eco-
nomics. We find that approaches ignoring serial correlation can significantly misstate the
eects of policies that aect the underlying profitability of an industry, such as an environ-
mental regulation that aects the sunk cost of entry.
    This paper opens several avenues for future research. Most importantly, it would be
interesting to apply the proposed approach to a wider class of empirical settings and see how
accounting for the endogeneity of market structure aects additional counterfactual policy
results.




                                              40
Appendix A: Additional Details on Single-Agent Exam-
            ple

A.1      Non-Elemental Sets
First, we present the non-elemental sets belonging to the collection of core determining sets for the example
considered in Section 3 with T = 2 time periods. These are the sets given by the overlapping unions of
elemental sets, excluding cases of strict subsets. Below each set we specify the events associated with the
elemental sets that we are taking the union of (top three sets) or the non-elemental sets that we taking the
union of (bottom two sets).




      (a) (0,0,0)+(1,1,0)             (b) (0,0,0)+(1,1,1)              (c) (1,1,1)+(0,0,1)




               (d) (a)+(b)                                 (e) (b)+(c)




A.2      Projection of Identified Sets on the Space of Profit Parame-
         ters
Next, we complement the results in Section 3.3 by showing the projections of the identified sets onto the
space of the profit parameters. We focus on the model without exogenous profit shifters wit . One can see
that the GMM and MLE models that assume away serial correlation tend to underestimate both profit
parameters.



                                                     41
Figure 7: Low IV strength




Figure 8: High IV strength




           42
Appendix B: Computed Example of Dynamic Oligopoly
In this section, we illustrate how our approach applies to the dynamic oligopoly setting by considering a
model with discrete persistent common knowledge unobservables and private information i.i.d. shocks.
    Consider the problem faced by two firms choosing how many stores to open in each of several markets
over time. We assume that the firms choose between having one or two stores open in each market at any
given point in time. Given the number of stores in a market, the two firms engage in Bertrand competition
and each of them charges the same price across its own stores. We let j index stores and k (j ) be the firm
owning store j . Consumers view the products as horizontally dierentiated across stores. Specifically, let

                                                     uijt =       pk(j )t + ijt

be the utility that consumer i gets from buying from store j at time t. Assuming that ijt is i.i.d. extreme
value across consumers and stores, the market share of firm k at time t is given by

                                                                 xkt exp pkt
                                                skt (pt ) =                      ,
                                                                  P
                                                                  2
                                                              1+     xrt exp prt
                                                                  r =1

where pt = (p1t , p2t ) and xkt denotes the number of stores that firm k has open at time t. The first order
condition for firm k 's static problem at time t is then

                                                                           skt (pt )
                                                     pkt = mckt            @
                                                                         @ pkt skt (p)


where mckt denotes the marginal cost of firm k at time t, which is assumed to be constant across firm k 0 s
stores. The system of first-order conditions implicitly determines the equilibrium prices in each market at
                                                                                    
any point in time and this in turn determines each firm's variable profits. Let k    (xt , wt ) be firm k 's variable
profit at time t as a function of the endogenous states xt = (x1t , x2t ) and of market size wt , which we assume
to be exogenous. Further, each firm incurs a fixed cost for each open store at time t and a sunk cost if it
decides to open a new store in the next period. The timing is such that at time t a firm chooses akt , i.e. the
number of stores at time t + 1, and incurs the associated sunk cost, if any, at time t. The final specification
for flow profits is as follows:

                                                  
              kt (akt , xt , wt ,   kt , kt )   = k ( xt , wt )     xkt     kt      (akt   xkt ) I {akt   xkt } · kt ,

where is the fixed cost, is the sunk cost and kt and kt are shocks that are unobserved to the econome-
trician. We assume that kt is common knowledge and possibly correlated over time and across players. This
is the structural shock that may be correlated with the state xt , thus leading to an endogeneity problem.
On the other hand, kt is assumed to be i.i.d. over time and across players and to be observed by player k
but not by the other firm. Adding this shock to the profit specification helps show existence of the dynamic
equilibrium and compute said equilibrium in practice.
     In the simulation, we set  = 0.5, = 2 on the demand side and mckt = 0.5, = 0.7, = 1 on the cost
side. Moreover, we assume kt can only take the two values 0.25 and 0.75, so that at any time t there are
four possible combinations of t = ( 1t , 2t ). The joint probability distribution for ( t , t+1 ) is given by the




                                                                  43
following matrix                       2                               3
                                         0.175   0.025   0.025   0.025
                                       60.025    0.175   0.025   0.0257
                                       6                               7
                                       6                               7
                                       40.025    0.025   0.175   0.0255
                                         0.025   0.025   0.025   0.175
In other words, the t process is fairly persistent over time. Further note that the matrix above is charac-
terized by just one parameter, which is convenient computationally. In particular, this correlation structure
implies that, given any value of t , t+1 will be equal to t with probability  = 0.7 and will switch to any
of the other three values with 0.1 probability each. Moreover, the shock kt takes one of the two values 0.5
and 1 with equal probability and is i.i.d. over time and across players. The exogenous state w is either 0.8 or
2 and, for simplicity, is taken to be constant over the time span from t = 1 to t = T , where T is the number
of observed time periods. In the simulation, we let T = 2.40
     Finally, we use past values of w as instruments. For each firm, the instrument has a correlation of 0.81
and 0.56 with x from period 1 and 2, respectively.
     The structural parameters are the fixed cost , the sunk cost and the correlation parameter  for the
 t process. To characterize the identified for  = ( , , ), we proceed in two steps. First, we find all the
policies that satisfy the CR conditions. Note that, in this simple example, there are only 64 possible states
and therefore a policy is a vector of length 64 with elements taking two possible values (corresponding to
choosing one or two stores). This makes it possible to enumerate all possible (monotonic) policies and check
the GIV conditions for each of them. Only 5,335 policies survive at the end. This is the sharp GIV identified
set for the policy.
     In the second step, we go from the identified set for the policy to the identified set for the structural
parameters. Specifically, for each candidate value  in a grid, we check whether there exists a policy in the
GIV identified set such that when the opponent plays according to that policy, it is optimal for a firm to play
the same policy. Here we exploit the fact that the two firms face the same problem and thus there has to be
a symmetric equilibrium. Further, note that this procedure does not rely on uniqueness of the equilibrium
and thus can be applied without any changes even if a given value of  is associated with multiple equilibria.
     Figures 9 and 10 show projections of the identified set for the structural parameters.

  40
    In order to focus on identification of the parameters and abstract from inference issues, we draw a very
large sample of markets (50,000).




                                                      44
Figure 9: Projection of identified set for ,




                     45
                              Figure 10: Projection of identified set for 




Appendix C: The Second Step in the Empirical Appli-
            cation
In this appendix, we write out the system of equations that we use to perform the second step of our
procedure in the empirical application. In our sample, each market can have 0, 1 or 2 firms. We denote
by 1 the first firm to enter the market and by 2 the second firm to enter. Abbring and Campbell (2010)
show that in equilibrium firm 1 will also be the last to exit. Each market is characterized by the level of
construction employment (w), which we discretize into "high" and "low," respectively labeled w, w. Denote
by j,In (w) the entry threshold for firm j when construction employment is set at w. This is the value
of the unobservable that makes firm j indierent between staying out and entering the market. Similarly,
let j,Out (w) be firm j 's exit threshold. By the properties of the Last-In-First-Out equilibrium and since
profits are increasing in both w and the unobservable, we have (i) j,In (w) j,Out (w), for all j and w; (ii)
1,In (w)  2,In (w), 1,Out (w)  2,Out (w) for all w; and (iii) j,In (w)  j,In (w), j,Out (w)  j,Out (w) for
all j .
     The single-period profit parameters to be recovered are  (x, w)--the deterministic part of variable profits
as a function of x, the number of firms in the market and w--and (x, w)--the sunk cost of entry as a function
of x and w. In total, there are four  and four parameters. Since we will have eight equations, we will
be able to recover all of the eight parameters. However, it seems reasonable to assume that sunk costs are
invariant to x and w and so the results in the paper impose that restriction.
     We let   ( , ). Given a candidate profile of strategies ~ and a candidate serial correlation parameter
~ from the first stage, the goal is to recover . Let vj (aj , w, , ~ , ) be firm j 's value function associated with


                                                        46
the action aj at states (w, ) when all firms follow the strategy profile ~ and the profit are parameterized by
. Now we evaluate vj at aj = 1 (firm j chooses to be in the market) and  = j,In (w) for each firm j and
each value of w. At that value of the unobservable, j is indierent between staying out of the market and
entering. Thus, the value function is equal to zero, the value of staying out. The value of entering can be
expressed as a linear function of the profit parameters via simulation as follows

                                                                        S   ¯
                                                                            T
                                     X          X                    1 XX
    v s (1, w, j,In (w), ~ , ) =                            (~
                                                             x, w
                                                                ~)                t
                                                                                      1 xs
                                                                                         t =x
                                                                                                 s
                                                                                            ~ , wt   ~ as
                                                                                                   = w, jr = 1 8r  t
                                                                     S s=1 t=0
                                   ~ 2 { 1 ,2 } w
                                   x            ~ 2{w,w}
                                                                                                                                (32)
                                                                                              ¯
                                                                                            S X
                                                                                              T
                                                                                            X
                                                                                                       t s
                                                                                 (j, w) +               t 1   as
                                                                                                               jr = 1 8r  t ,
                                                                                            s=1 t=0

where (i) as                   s                                                                            s
              jt --and thus xt --are determined by the candidate profile of strategies ~ ; (ii) x0 = j for all s,
since if firm 1 is indierent between entering and staying out then firm 2 will stay out and, conversely, if
                                                                                                s
firm 2 is indierent between entering and staying out then firm 1 will be in; (iii) wt             is set to w for t = 0 and
after that is drawn based on the law of motion for the exogenous covariates recovered outside the dynamic
model; and (iv) s    t is set to j,In (w ) for t = 0 and after that is drawn from the distribution with candidate
serial correlation parameter      ~ from the first stage. Note that, since exit is irreversible, the sunk cost is
paid only at t = 0. Equating (32) to zero gives one linear equation in  for each firm and each value of w,
i.e. four equations in total.
     Similarly, we can evaluate vj at aj = 1 and  = j,Out (w) for each firm j and each value of w. At that
value of the unobservable, j is indierent between staying in the market and exiting. The simulated version
of the value function is
                                                               2                                                   3
                                                                    S X ¯
                                                                        T
                                   X             X               1 X
   v s (1, w, j,Out (w), ~ , ) =                            ~) 4
                                                         x, w
                                                        (~                 t
                                                                             1 xs  ~ , wt
                                                                                t =x
                                                                                         s
                                                                                           = w,~ asjr = 1 8r  t
                                                                                                                   5
                                                                 S s=1 t=0
                                 ~ 2 { 1 ,2 } w
                                 x            ~ 2{w,w}
                                                                                                                       (33)
                                                                                  S X T¯
                                                                                  X
                                                                                           t s
                                                                               +             t 1 as jr = 1 8r  t .
                                                                                             s=1 t=0


Relative to (32), now s 0 is set to j,Out (w ). Further, the  parameters do not show up in (33) since firm j is
already in at the initial time. Since in the model exit is irreversible, the value of exiting the market is zero.
Thus, equating (33) to zero gives another set of four equations. In total, we have a system of eight linear
equations which characterize the set of values of  consistent with the first-stage candidates (~ ,   ~) and the
model.



Appendix D: Proofs Omitted from the Text

Proof of Result 4
First, note that the restrictions imposed in the second step imply that (25) is satisfied at x = x  ¯, u =  (¯
                                                                                                             x)
    ¯ 2 {0, 1}. Thus, if we could show that the policy solving (25) is weakly decreasing in u, then we
for x
could conclude that that policy is the same as ~ at all values of x and u, completing the proof. The
policy solving (25) is weakly decreasing in u if and only if  (1, x, u) + E [V (1, u0 ) V (0, u0 )|u] is weakly
decreasing in u, where  (1, x, u) denotes the single-period profit from choosing a = 1. The specification of
the single-period profit function implies that  (1, x, u) is (strictly) decreasing in u, so it su ces to show



                                                                      47
that E [V (1, u0 )V (0, u0 )|u] weakly decreases
                                               h in u. To this end, we  i use Corollary 1 in Stokey et al. (1989).
                                                 ~     0     ~     0
Based on the corollary, if we can show that E V (1, u ) V (0, u )|u weakly decreasing in u implies that the
value function returned by the Bellman equation, B (V    ~ ), satisfies the same property, then we have shown
that the fixed point of the Bellman equation, V , satisfies the property, yielding the desired result. Note that

                    ~ ) (1, u)
                 B (V                ~ ) (0, u) =
                                  B (V                max { (1, 1, u) + E [V (1, u0 )|u] , E [V (0, u0 )|u]}
                                                      max { (1, 0, u) + E [V (1, u0 )|u] , E [V (0, u0 )|u]}

Since  (1, 1, u)        (1, 0, u) =         0, we have
                                 8                       h                           i
                                 >
                                 >  if  (1, 0, u) + E V    ~ (1, u0 ) V ~ (0, u0 )|u   0
                                 >
                                 <               h                           i                      h                           i
    ~ ) (1, u)
 B (V                ~ ) (0, u) =  (1, 1, u) + E V
                  B (V                             ~ (1, u0 ) V ~ (0, u0 )|u    if 0   (1, 1, u) + E V~ (1, u0 )    ~ (0, u0 )|u 
                                                                                                                    V
                                 >
                                 >                       h                          i
                                 >
                                 :0 if  (1, 1, u) + E V    ~ (1, u0 ) V ~ (0, u0 )|u  0

                                                                               h                                               i
By inspecting this function, one can see that it is weakly decreasing in u if E V~ (1, u0 )                        ~ (0, u0 )|u weakly
                                                                                                                   V
                                                      0
decreases
  h        in u. Since  ~     0, the
                                   i distribution of u is stochastically increasing in u. It then follows that
E B (V~ ) (1, u ) B (V
               0     ~ ) (0, u ) |u weakly decreases in u.
                              0




                                                                  48
References
Abbring, J. H. and J. R. Campbell (2010): "Last-In First-Out Oligopoly Dynamics,"
 Econometrica, 78, 1491­1527.

Ackerberg, D., L. Benkard, S. Berry, and A. Pakes (2007): "Econometric Tools
 for Analyzing Market Outcomes," in Handbook of Econometrics, ed. by J. J. Heckman and
 E. Leamer, North-Holland, vol. 6A, chap. 63.

Altonji, J. and R. L. Matzkin (2005): "Cross-Section and Panel Data Estimators for
 Nonseparable Models with Endogenous Regressors," Econometrica, 73, 1053­1102.

Anderson, T. and C. Hsiao (1981): "Estimation of Dynamic Models with Error Com-
 ponents," Journal of the American Statistical Association, 76, 598­606.

Andrews, D. W. and X. Shi (2013): "Inference based on conditional moment inequali-
 ties," Econometrica, 81, 609­666.

------ (2017): "Inference Based on Many Conditional Moment Inequalities," Journal of
  Econometrics, 196, 275­287.

Andrews, D. W. and G. Soares (2010): "Inference for Parameters Defined by Moment
 Inequalities Using Generalized Moment Selection," Econometrica, 78, 119­157.

Arcidiacono, P. and R. Miller (2011): "Conditional Choice Probability Estimation
 of Dynamic Discrete Choice Models with Unobserved Heterogeneity," Econometrica, 7,
 1823­1868.

Arellano, M. and S. Bond (1991): "Some Tests of Specification for Panel Data: Monte
 Carlo Evidence and an Application to Employment Equations," Review of Economic Stud-
 ies, 58, 277­297.

Athey, S. and G. Imbens (2006): "Identification and inference in nonlinear dierence-in-
 dierence models," Econometrica, 74, 431­497.

Bajari, P., C. L. Benkard, and J. Levin (2007): "Estimating Dynamic Models of
 Imperfect Competition," Econometrica, 75, 1331­1370.

Beresteanu, A., F. Molinari, and I. Molchanov (2011): "Sharp Identification Re-
 gions in Models with Convex Moment Predictions," Econometrica, 79, 1785­1821.

Berry, S. and G. Compiani (2020): "Empirical Models of Industry Dynamics with En-
 dogenous Market Structure," Tech. rep., Yale, in preparation for the Annual Review of
 Economics.

                                          49
Berry, S. and E. Tamer (2007): "Identification in Models of Oligopoly Entry," in Ad-
 vances in Economics and Econometrics: Theory and Applications, Ninth World Congress,
 ed. by W. N. R. Blundell and T. Persson, Cambridge University Press, vol. 2.

Berry, S. T. (1992): "Estimation of a Model of Entry in the Airline Industry," Economet-
 rica, 60, 889­917.

Berry, S. T. and P. A. Haile (2014): "Identification in Dierentiated Products Markets
 Using Market Level Data," Econometrica, 82, 1749­1797.

Blevins, J. (2016): "Sequential Monte Carlo Methods for Estimating Dynamic Microeco-
 nomic Models," Journal of Applied Econometrics, 31, 773­804.

Blundell, R. and S. Bond (1998): "Initial conditions and moment restrictions in dy-
 namic panel data models," Journal of Econometrics, 87, 115­143.

Borkovsky, R. N., U. Doraszelski, and Y. Kryukov (2010): "A User's Guide to
 Solving Dynamic Stochastic Games Using the Homotopy Method," Operations Research,
 58, 1116­1132.

Bresnahan, T. (1989): "Empirical Studies of Industries with Market Power," in The
 Handbook of Industrial Organization, ed. by R. Schamlensee and R. Willig, North-Holland,
 no. 10 in Handbooks in Economics.

Chen, X., T. M. Christensen, and E. Tamer (2018): "Monte Carlo Confidence Sets
 for Identified Sets," Econometrica, 86, 1965­2018.

Chernozhukov, V., D. Chetverikov, and K. Kato (2018): "Inference on Causal
 and Structural Parameters using Many Moment Inequalities," The Review of Economic
 Studies, 86, 1867­1900.

Chernozhukov, V., H. Hong, and E. Tamer (2007): "Estimation and Confidence
 Regions for Parameter Sets in Econometric Models1," Econometrica, 75, 1243­1284.

Chernozhukov, V., S. Lee, and A. Rosen (2013): "Intersection Bounds: Estimation
 and Inference," Econometrica, 81, 667­737.

Chernozkukov, V., D. Chetverikov, and K. Kato (2018): "Inference on Causal and
 Structural Parameters Using Many Moment Inequalities," Review of Economic Studies,
 forthcoming.

Chesher, A. (2010): "Instrumental Variables Models for Discrete Outcomes," Economet-
 rica, 78, 575­601.



                                           50
Chesher, A. and A. Rosen (2017): "Generalized Instrumental Variable Models," Econo-
 metrica, 83, 959­989.

Ciliberto, F. and E. Tamer (2009): "Market Structure and Multiple Equilibria in Airline
  Markets," Econometrica, 77, 1791­1828.

Collard-Wexler, A. (2013): "Demand Fluctuations in the Ready-Mix Concrete Indus-
 try," Econometrica, 81, 1003­1037.

------ (2014): "Mergers and Sunk Costs: An Application to the Ready-Mix Concrete In-
  dustry," American Economic Journal: Microeconomics, 6, 407­447.

Doraszelski, U. and A. Pakes (2007): "A Framework for Applied Dynamic Analysis in
 I.O." in Handbook of Industrial Organization.

Doraszelski, U. and M. Satterthwaite (2010): "Computable Markov-perfect industry
 dynamics," The RAND Journal of Economics, 41, 215­243.

Dube´, J., G. Hitsch, and P. Rossi (2010): "State dependence and alternative explana-
 tions for consumer inertia," RAND Journal of Economics, 41, 417­445.

Ericson, R. and A. Pakes (1995): "Markov Perfect Industry Dynamics: A Framework
 for Empirical Work," Review of Economic Studies, 62, 53­82.

Fershtman, C. and A. Pakes (2012): "Dynamic Games with Asymmetric Information:
 A Framework for Empirical Work," The Quarterly Journal of Economics, 127, 1611­1661.

Galichon, A. and M. Henry (2011): "Set identification in models with multiple equilib-
 ria," Review of Economic Studies, 78, 1264­1298.

Heckman, J. and B. Singer (1984): "A Method for Minimizing the Impact of Dis-
 tributional Assumptions in Econometric Models for Duration Data," Econometrica, 52,
 271­320.

Heckman, J. J., J. E. Humphries, and G. Veramendi (2016): "Dynamic treatment
 eects," Journal of Econometrics, 191, 276­292.

Honore´, B. and E. Tamer (2006): "Bounds on parameters in panel dynamic discrete
 choice models," Econometrica, 3, 611­629.

Hotz, J. and R. A. Miller (1993): "Conditional Choice Probabilites and the Estimation
 of Dynamic Models," Review of Economic Studies, 60, 497­529.




                                          51
Hotz, V. J., R. A. Miller, S. Sanders, and J. Smith (1994): "A Simulation Estimator
 for Dynamic Models of Discrete Choice," The Review of Economic Studies, 61, pp. 265­
 289.

Hu, Y. and M. Shum (2012): "Nonparametric identification of dynamic models with
 unobserved state variables," Journal of Econometrics, 171, 32­44.

Hu, Y., M. Shum, W. Tan, and R. Xiao (2015): "A Simple Estimator for Dynamic
 Models with Serially Correlated Unobservables," Tech. rep., Cal Tech, working Paper.

Igami, M. (2018): "Industry Dynamics of Oshoring: The Case of Hard Disk Drives,"
  American Economic Journal: Microeconomics, 10, 67­101.

Israel, M. (2005): "Tenure dependence in consumer-firm relationships: an empirical anal-
  ysis of consumer departures from automobile insurance firms," RAND Journal of Eco-
  nomics, 36, 165­192.

Kaido, H., F. Molinari, and J. Stoye (2019): "Confidence Intervals for Projections of
 Partially Identified Parameters," Econometrica, 87, 1397­1432.

Kalouptsidi, M., P. Scott, and E. Souza-Rodrigues (2020): "Linear IV Regression
 Estimators for Structural Dynamic Discrete Choice Models," Journal of Econometrics,
 forthcoming.

Kasahara, H. and K. Shimotsu (2009): "Nonparametric Identification of Finite Mixture
 Models of Dynamic Discrete Choices," Econometrica, 77, pp. 135­175.

Keane, M. P. and K. I. Wolpin (1997): "The Career Decisions of Young Men," Journal
 of Political Economy, 105, 473­522.

Lazarev, J., L. Benkard, and A. Bodoh-Creed (2018): "Simulating the Dynamic
 Eects of Horizontal Mergers: U.S. Airlines," Working paper, NYU.

Magnac, T. and D. Thesmar (2002): "Identifying Dynamic Discrete Decision Processes,"
 Econometrica, 70, 801­816.

Manski, C. F. (1988): "Identification of Binary Response Models," Journal of the American
 Statistical Association, 83, 729­738.

------ (2003): Partial Identification of Probability Distributions, New York: Springer.

Manski, C. F. and E. Tamer (2002): "Inference on Regressions with Interval Data on a
 Regressor or Outcome," Econometrica, 70, 519­546.



                                            52
Menzel, K. (2014): "Consistent Estimation With Many Moment Inequalities," Journal of
 Econometrics, 182, 329­350.

Norets, A. (2009): "Inference in Dynamic Discrete Choice Models with Serially Correlated
 Unobserved State Variables," Econometrica, 77, 1665­1682.

Pakes, A. (1994): "Dynamic Structural Models, Problems and Prospects: Mixed Contin-
  uous Discrete Controls and Market Interactions," in Advances in Econometrics, ed. by
  C. Sims, Cambridge: Cambridge Univeristy, chap. 5, 171­260.

Pakes, A. and P. McGuire (2001): "Stochastic Approximation for Dynamic Analysis:
  Markov Perfect Equilibrium and the `Curse' of Dimensionality," Econometrica.

Pakes, A., M. Ostrovsky, and S. Berry (2007): "Simple Estimators for the Parameters
  of Dynamic Games, with Entry/Exit Examples," RAND Journal of Economics, 38, 373­
  399.

Pakes, A., J. Porter, K. Ho, and J. Ishii (2015): "Moment Inequalities and Their
  Application," Econometrica, 83, 315­334.

Pesendorfer, M. and P. Schmidt-Dengler (2008): "Asymptotic Least Squares Esti-
 mators for Dynamic Games," Review of Economic Studies, 75, 901­928.

------ (2010): "Sequential Estimation of Dynamic Discrete Games: A Comment," Econo-
  metrica, 78, 833­842.

Reich, G. (2018): "Divide and Conquer: Recursive Likelihood Function Integration for
 Hidden Markov Models with Continuous Latent Variables," Operations Research, 66,
 1457­1470.

Rudin, W. (1976): Principles of Mathematical Analysis, McGraw-Hill Education, 3rd ed.

Rust, J. (1987): "Optimal Replacement of GMC Bus Engines: An Empirical Model of
 Harold Zurcher," Econometrica, 55, 999­1033.

Ryan, S. P. (2012): "The Costs of Environmental Regulation in a Concentrated Industry,"
 Econometrica, 80, 1019­1061.

Somaini, P. (2015): "Identification in Auction Models with Interdependent Costs," Tech.
  rep., Stanford.

Stokey, N. L., R. E. Lucas, and E. C. Prescott (1989): Recursive Methods in
  Economic Dynamics, Cambridge MA: Harvard Univ.

Tamer, E. (2003): "Incomplete Simultaneous Discrete Response Model with Multiple Equi-
 libria," The Review of Economic Studies, 70, pp. 147­165.

                                          53
