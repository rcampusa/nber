                                NBER WORKING PAPER SERIES




          A VARIATIONAL APPROACH TO THE ANALYSIS OF TAX SYSTEMS

                                          Mikhail Golosov
                                          Aleh Tsyvinski
                                          Nicolas Werquin

                                        Working Paper 20780
                                http://www.nber.org/papers/w20780


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2014




Golosov and Tsyvinski thank NSF for financial support. We thank audiences at Princeton, Yale, Society
for Economics Dynamics annual meeting, NBER Summer Institute, NBER Public Economics Program
meeting, Taxation Theory Conference (Cologne). The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this research.
Further information is available online at http://www.nber.org/papers/w20780.ack

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Mikhail Golosov, Aleh Tsyvinski, and Nicolas Werquin. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
A Variational Approach to the Analysis of Tax Systems
Mikhail Golosov, Aleh Tsyvinski, and Nicolas Werquin
NBER Working Paper No. 20780
December 2014
JEL No. H21,H23

                                               ABSTRACT

We develop a general method to study the effects of non-linear taxation in dynamic settings using
variational arguments. We first derive general theoretical formulas that characterize the welfare effects
of local tax reforms and, in particular, the optimal tax system, potentially restricted within certain classes
(e.g., age-independent, linear, separable). These formulas are expressed in terms of intuitive parameters,
such as the labor and capital income elasticities and the hazard rates of the income distributions. Second,
we apply these formulas to various specific settings. In particular, we decompose the gains arising
from each element of tax reform, starting from a simple baseline system, as the available tax instruments
becomes more sophisticated. We further show that the design of tax systems obeys a common general
principle, namely that more sophisticated tax instruments (e.g., age-dependent, non-linear, non-separable)
allow the government to fine-tune the tax rates by targeting higher distortions to the segments of the
population whose behavior responds relatively little to those taxes.


Mikhail Golosov                                       Nicolas Werquin
Department of Economics                               Department of Economics
Princeton University                                  Yale University
111 Fisher Hall                                       28 Hillhouse Avenue
Princeton, NJ 08544                                   New Haven, CT 06511
and NBER                                              nicolas.werquin@yale.edu
golosov@princeton.edu

Aleh Tsyvinski
Department of Economics
Yale University
Box 208268
New Haven, CT 06520-8268
and NBER
a.tsyvinski@yale.edu
1       Introduction
Many counties use a complex system of taxes and transfers. Welfare and social insurance
payments depend on individual earnings, which creates a complex nonlinear schedule of effective
marginal labor and capital income tax rates. Figure 1 illustrates such patterns using the federal
tax programs in the U.S.1 Moreover, both the eligibility and the amount of payment often
depends on the past history of labor earnings, assets, marital status, age and the number of
children.
    It is challenging to develop a theory of taxation that both allows for sufficiently rich tax
functions and provides transparent, intuitive insights about the effect of taxes. The literature
so far have mainly persued either of the following two approaches. The first approach imposes
specific parametric functional form assumptions, and characterizes the optimal taxes in terms
of intuitive measures of elasticities. This approach goes back to Ramsey (1927) and the modern
application of this technique was introduced by Diamond and Mirrlees (1971), who restrict at-
tention to linear taxes. The second approach imposes explicit informational restrictions on the
government and characterizes the constrained optimum (e.g. Mirrlees 1971, Golosov, Kocher-
lakota, and Tsyvinski 2003). Both approaches have limitations. As far as the Ramsey approach
is concerned, the vast majority of the literature restricts attention to linear taxes. A few pa-
pers that consider more general taxes typically choose specific functional forms that are easy
to parameterize (e.g. power functions) and obtain analytical results only in special cases. The
mechanism design approach is often sensitive to the assumptions on government’s information
set. The tax systems that emerge from it are often very complex, and the intuition for the
economic forces that determine the size and the shape of the optimal taxes is not transparent.
    In this paper we develop an alternative approach to the analysis of the effects of taxation
that both preserves the transparency of the Ramsey approach and allows us to handle more
complicated, nonlinear tax systems. Our approach is based on studying perturbations of a given
non-linear tax system directly. We show that as long as the baseline tax system is sufficiently
well behaved, the effect of perturbing the tax system can be expressed in terms of elasticities
and hazard rates of income distributions that can be estimated in the data. Our method
is sufficiently flexible to both allow us to restrict attention a priori to a given class of tax
functions (e.g., non-linear taxes that do not depend on an individual’s age and are separable
between various incomes) and to study the sources and the magnitude of welfare gains that arise
from using more sophisticated taxes (e.g., from introducing age- or history-dependent taxation).
    We study a dynamic model, in which individuals’ characteristics evolve over their lifetime.2
The tax system consists of a sequence of tax functions which can be arbitrarily non-linear and
joint in the entire history of labor and capital incomes. The generality of the tax functions
    1
    This becomes even more complicated once state-level programs are taken into account, see Maag et al. (2012).
    2
    In most of the paper we focus on a deterministic economy to make our approach transparent. In the last
Section and in our working paper (Golosov, Tsyvinski, and Werquin 2014) we develop an extension to stochastic
environments.




                                                       2
allows us to study the age-dependence and history dependence of taxes, non-linear taxation of
capital income, and joint conditioning of taxes on labor and capital incomes. The first main
contribution of the paper is to provide a general formula for the welfare effects of tax reforms in a
compact and easily interpretable form. Our result is based on deriving the Gateaux differential
of individual demands, government tax revenue, and social welfare. The complexity of the
problem arises from the fact that an individual chooses his income as a function of the local
characteristics of the tax system; but these tax rates themselves depend on the income that he
chooses. Therefore, a local perturbation of the tax function faced by an individual leads him to
adjust his income, which in turn induces a shift in the tax rates if the baseline tax system is non-
linear, triggering further income adjustment. We provide a sufficient condition on the individual
demand (namely, local Lipschitz continuity), which allows us to solve this circularity issue, and
express the effects of general tax reforms only in terms of the local income and substitution
effects at the individual level, and of the curvature of the baseline tax function. Importantly,
these formulas are written only as a function of empirically observable and easily interpretable
sufficient statistics.
    We then show several applications of these results. First, we apply it to optimal taxation
problems and show how it recovers the hallmark results on optimal linear commodity taxation
of Diamond (1975) and non-linear labor taxation of static model of Mirrlees (1971), both of
which are special cases of our general environment. Our formulas emphasize the insight that the
same general principle underlies the two models, namely that more sophisticated (in this case,
non-linear) tax instruments allow the government to better target the distortions associated
with higher tax rates toward the segments of the populations that have either relatively small
behavioral responses, or where relatively few individuals are affected. We then show that this
fundamental principle can be generalized and applies to broader classes of environments. In
particular, we derive several novel predictions such as the optimality conditions for the optimal
non-linear capital income tax, or for the optimal labor tax on joint income of couples.
    We next turn to the analysis of tax reforms, and refine our discussion of the close connec-
tion that exists between the effects of the various tax instruments (age-dependent, non-linear,
joint taxes). We sequentially decompose the welfare gains of reforming existing, not necessarily
optimal, tax systems as the tax instruments become more sophisticated. We show the effects
of taking into account individuals’ intertemporal optimization decisions, of allowing for age-
and history-dependence, and of joint conditioning of labor and capital income. This sequential
decomposition of increasingly sophisticated tax systems shows that the welfare effects of general
tax reforms depend on aggregate measures of three key elements: the marginal social welfare
weights, which summarize the government’s redistributive objective; the labor and capital in-
come elasticities and income effect parameters with respect to the marginal income tax rates,
which capture the behavioral effects of taxes; and the properties of the labor and capital income
distributions, namely the hazard rates of the marginal and joint distributions.
    Finally, we show how one can use available empirical moments of income distributions and



                                                 3
elasticities to quantify the welfare effects of small tax reforms. Unlike the traditional approach
to measuring welfare gains, which requires solving often difficult maximization problems to find
the optimum, our method is very transparent and can be done almost “by hand”. It does not
allow, however, to compute the gains from reforms that introduce large changes in the existing
tax system.
    Our approach is most closely related to and builds on the work of Piketty (1997) and Saez
(2001). They used heuristic arguments to extend the techniques of Ramsey (1927) and Diamond
and Mirrlees (1971) to non-linear taxation and obtain expressions for the optimal labor taxes
in a unidimensional static model in terms of the elasticities of labor supply and income hazard
rates. Our paper finds sufficient conditions for the more rigorous application of that approach
and extends it to more general dynamic settings. This allows us to analyze such questions as
non-linear capital taxation and joint taxation of incomes. We also show how this approach
can be used beyond optimal taxation, as we apply it to analyze tax reforms and welfare gains
from increased sophistication of tax systems. More broadly, our approach is also related to
the sufficient statistics tax literature (e.g., Chetty 2009; Piketty, Saez, and Stancheva 2013).
Similar to these papers, we express our tax formulas in terms of a small number of empirically
observable parameters, which fully characterize the effects of taxes for a large set of underlying
models, e.g., for very general utility functions, structures of heterogeneity, etc. Our application
to capital taxation also builds on several insights of Piketty and Saez (2013) and Straub and
Werning (2014).
    Our analysis of the evaluating increasingly sophisticated elements of the tax functions is
most closely related to the growing literature on taxation within parametrically restricted sets
of policies.3 Conesa and Krueger (2009) and Conesa, Kitao, and Krueger (2009) quantitatively
study optimal income tax within a Gouveia and Strauss (1994) class and a linear capital in-
come tax. Kitao (2010) further incorporates the labor-dependent capital taxes in these models.
Heathcote, Storesletten, and Violante (2014) characterize optimal taxes within a class where a
government can control the degree of progressivity in dynamic models with idiosyncratic shocks
and ex-ante heterogeneity in learning ability and disutility of work. A recent paper by Heath-
cote and Tsujima (2014) analyzes an environment in which groups of individuals can insure the
shocks among themselves in addition to available private insurance, solve for the constrained
optimum and explore whether parametric tax functions can come close to achieving those al-
locations. Huggett and Parra (2010) consider an optimal reform of the social security benefit
function which is chosen in the class of piecewise-linear functions of average past earnings.
    Our work is also related to the literature that studies tax reforms in dynamic settings.
Weinziel (2012) is the closest in its approach to our analysis of the partial reform that introduces
age-dependence.4 Blundell and Shephard (2014) characterize numerically the optimal tax system
   3
     For a more detailed review of the literature and of the relationship between our approach, the mechanism
design approach to optimal taxation and the restricted tax functions approach see Golosov and Tsyvinski (2014).
   4
     See also an early paper on this topic by Kremer (2002).




                                                      4
                    Figure 1: Effective Federal Tax Rates (source: CBO 2005)




in a complex dynamic environment. We complement their analysis of this issue by uncovering
the theoretical forces which determine the effects of partial reforms.
    A large recent “New Dynamic Public Finance” literature studies environments in which taxes
are restricted only by explicit restrictions on government’s information set. 5 Our approach is
complementary. If we restrict attention to the classes of taxes considered in those paper, we
obtain an alternative characterization of optimality conditions in terms of elasticities. More
generally, it is easy to use our approach to analyze the tax systems using restricted tax instru-
ments, e.g., non-linear but separable from labor income taxes, and quantify welfare gains from
switching to more sophisticated taxes, e.g. gains from introducing joint taxation of capital and
labor. More broadly, our paper relates to the literature on multidimensional screening problems,
e.g., Kleven, Kreiner and Saez (2009) and Rothschild and Scheuer (2014). While they are able
to solve this complex problem by collapsing their model to a one-dimensional problem, we use
the variational method to analyze the environment with multiple types of shocks.
    The rest of the paper is organized as follows. Section 2 describes our environment. Sections 3
and 4 derive the responses of individual income, tax revenue and social welfare to perturbations
of the baseline tax system. Section 5 considers the applications of this approach to optimal
taxation. Section 6 considers the applications to tax reforms and the decomposition of welfare
gains from increasing sophistication of the tax system. Section 7 presents a brief overview of
the extension of our analysis to the stochastic model.
  5
   See, e.g. Albanesi and Sleet (2006), Farhi and Werning (2013), Golosov, Troshkin and Tsyvinski (2014),
Albanesi (2011) and Shourideh (2012), Stantcheva (2014).




                                                   5
2       Environment
There is a measure one of agents in the economy. An agent lives for S ≤ ∞ periods, and
time is indexed by s = 1, . . . , S. At the beginning of period s = 1, there is a draw of an
exogenous vector of n characteristics θ ∈ Θ ⊂ Rn for each individual. These idiosyncratic
shocks can be, for instance, the individual’s initial level of capital stock k0 , his sequence of
productivities, tastes, interest rates (i.e., investment opportunities), etc. over his lifetime. The
environment is deterministic: individuals know at the beginning of period s = 1 their entire
vector of characteristics θ.6
    Given the draw of vector θ, the individual chooses in each period s ∈ {1, . . . , S} a level
of consumption cs , labor income ys , and savings or borrowings ks which yield capital income
zs+1 in period s + 1.7 The utility function U can be a general, not necessarily time-separable,
function of the vector of choices of consumption, labor income and capital income. We assume
that the utility function is increasing and concave in each period’s consumption (and capital
income if it enters explicitly the utility function), decreasing and convex in each period’s labor
income, and twice differentiable in all of its variables. An example of the utility function which
we use in several applications is U = Ss=1 β s−1 u (cs , ys /θs ). In this case, θs is a shock to the
                                            P

productivity of labor supply in period s.
    In each period s ∈ {1, . . . , S}, the government levies a tax Ts . The tax liability Ts (·) in period
s is a non-linear function of the individual’s entire history of labor incomes {ys0 }Ss0 =1 and capital
incomes {zs0 +1 }Ss0 =1 .8,9 The sequence of tax functions {Ts (·)}Ss=1 is known to an individual at
the beginning of period s = 1, and the government can commit to it. The initial tax system
T thus consists of a set of tax functions Ts : RS+ × RS → R for each period s ∈ {1, . . . , S},
where each function Ts (·) maps a choice of labor and capital           incomes x ∈ RS+ × RS to a
tax liability Ts (x) ∈ R. The tax function in period s, Ts {ys0 }Ss0 =1 , {zs0 +1 }Ss0 =1 , is assumed
twice continuously differentiable in all of its 2S variables, that is Ts ∈ C 2 RS+ × RS , R for all
                                                                                                  

s ∈ {1, . . . , S}.10
    6
     The deterministic environment allows us to show the main insights most transparently. We extend the analysis
to the stochastic environment Golosov, Tsyvinski and Werquin (2014), and present an overview in Section 7.
   7
     The capital income in period s + 1 can be written as zs+1 = rs+1 ks , where the interest rate rs+1 in each
period is exogenous. Our analysis allows the interest rate to be idiosyncratic, and thus the period-s savings ks to
yield any (deterministic) income zs+1 in the next period. The before-tax capital stock at the beginning of period
s + 1 is then ks + zs+1 .
   8
     In a given period s, the planner can tax incomes earned in the future periods s0 > s because the model is
deterministic. We assume here that initial capital k0 is not taxed, because it is supplied inelastically and hence
does not induce any behavioral effects. Our formulas can be trivially extended to the case where it can be taxed.
   9
     Throughout the paper we consider only capital income taxes and not wealth taxes. The same approach can
be used to analyze wealth taxation.
  10
     In the deterministic model, we could without loss of generality write only one tax function, for instance TS (·).
Instead, we choose to define one tax function per period s, at the expense of slightly more cumbersome notation,
to make it easier to discuss age-dependent taxes and capital taxes in Sections 5 and 6. This definition of taxes
also has the advantage of extending naturally to stochastic settings; see Section 7.




                                                          6
       The optimization problem of an individual with the vector of types θ is:
                                                                                          
       Uθ (T ) ≡            max               U {cs }1≤s≤S , {ys }1≤s≤S , {zs+1 }1≤s≤S , θ
                   {cs ,ys ,ks ,zs+1 }1≤s≤S
                                                                                                                (1)
                     s.t.     cs + ks = ys + (ks−1 + zs ) − Ts {y }1≤s0 ≤S , {z
                                                                         s0              s0 +1   }1≤s0 ≤S , ∀s.

We denote by xθ (T ) the argmax of this problem, i.e., the optimal choice of labor and capital
incomes of the individual θ as a function of the tax system T . That is, we define the individual
income functional as:

                      xθ (T ) = (yθ,1 (T ) , . . . , yθ,S (T ) , zθ,2 (T ) , . . . , zθ,S+1 (T ))0 .

The optimal choices of consumption {cθ,s }Ss=1 are then obtained from the budget constraints.
The budget constraint in period s imposes that the sum of consumption cs and savings ks is no
greater than the sum of labor income ys and capital income (ks−1 + zs ), net of the tax liability
Ts .
     We denote by Fθ (θ) the c.d.f. of vectors θ ∈ Θ, and fθ (θ) the corresponding density
function. We also denote by Fx (x) and fx (x) the c.d.f. and the p.d.f. of incomes x ∈ X ⊂
RS+ × RS , given the tax system T . For any choice of incomes (x1 , . . . , xs ) ∈ Rs with s < 2S, we
also let Fx1 ,...,xs (·) and fx1 ,...,xs (·) denote the marginal c.d.f. and the marginal p.d.f. of those
variables. We assume that the sets Θ and X of vectors of types θ and incomes x are compact
in Rn and RS+ × RS , respectively, and that the densities of types and incomes at the (piecewise
smooth) boundaries ∂X and ∂Θ of the sets X and Θ are equal to zero.11 We make the following
assumption about the income vectors chosen by individuals with different types θ:

Assumption 1. The map θ 7→ xθ (T ) between the vector of types θ and the vector of income
choices xθ (given the tax system T ) is injective. That is, if two individuals have a different
vector of types θ 6= θ 0 , they choose a different vector of incomes xθ (T ) 6= xθ0 (T ).

    This assumption mainly simplifies the exposition but is not required for most of our results.
We explain below how our main results are affected in the case where it does not hold, e.g., if
the space of degrees of heterogeneity has a higher dimension than the space of income choices.
    We define the present discounted value of tax revenue as a function of the tax system T , or
tax revenue functional, as
                                               ˆ "X
                                                  S
                                                                              #
                                  R (T ) =                β s−1 Ts (xθ (T )) dFθ (θ) ,                            (2)
                                                Θ   s=1

where β is the marginal rate of transformation of resources across periods for the government,
which we assume equal to the individual’s discount factor. Tax revenue is thus the sum over
  11
    In some applications of Sections 6 and 5, we let incomes evolve in the whole space RS    S
                                                                                        + × R . Our theory can
                                                                                   S    S
be generalized to this case by using an increasing sequence of compact sets X ⊂ R+ × R .



                                                             7
time s ∈ {1, . . . , S} and over individuals θ ∈ Θ of individual tax liabilities, taking into account
the agents’ optimizing behavior given the tax system T .
   We finally define the social welfare functional as a weighted average of the indirect utility
functions of individual agents and the tax revenue, as a function of the tax system T ,
                                                ˆ                                    
                              −1
                 W (T ) = λ            (1 − α)       G (Uθ (T )) dFθ (θ) + αV (R (T )) ,          (3)
                                                 Θ

for some α ∈ [0, 1], where λ ≡ αV 0 (R (T )) denotes the shadow value of public funds. Here
V (R (T )) is a measure of the value of public goods that the government can provide with tax
revenues R (T ). The function G : R → R is defined over lifetime utilities of the individuals,
and is assumed continuously differentiable, increasing, and concave. The function V : R → R is
continuously differentiable and increasing. Note that normalizing equation (3) by the marginal
value of public funds λ implies that social welfare is expressed in monetary units.
    The tax system T considered so far is very general and allows for a rich set of non-linearities
and non-separabilities in taxing different incomes at different dates. In practice, we are often
interested in more restrictive classes of tax systems. For example, the classic Ramsey analy-
sis restricts the tax functions to be separable and linear in each income (e.g., Ramsey 1927,
Diamond and Mirrlees 1971, Diamond 1975). Another strand of the literature focuses on the
analysis of separable but non-linear tax functions, (e.g., Mirrlees 1971, Diamond 1998, Saez
2001, Heathcote, Storesletten, and Violante 2014). More generally, the New Dynamic Public
Finance literature (e.g., Kocherlakota 2005, Farhi and Werning 2012, Golosov, Troshkin, and
Tsyvinski 2014) emphasizes the benefits of jointly taxing different incomes, namely labor and
capital incomes within periods, or labor incomes across periods (history-dependent taxation),
so that the tax rate on income i depends not only on its own level xi , but also on the levels xj
of other incomes j 6= i. When we impose such constraints on the tax system T , we say that T
is “restricted within a class” (e.g., of linear separable, non-linear separable, etc., tax functions).
    Our paper focuses on several conceptually distinct, but closely related questions. First, we
analyze the revenue or welfare gains and losses of small perturbations of any baseline tax system
T 0 . We refer to such changes as tax reforms. Suppose in particular that the tax system T 0
is restricted within a certain class. By deriving the effects of reforms that keep the perturbed
tax system within this class, we can shed light on the economic parameters that determine
whether the existing tax system is (constrained) optimal, and derive the potential welfare gains
obtained by reforming it. Moreover, we can analyze reforms that induce the tax system to
leave its restricted class. For instance, we can introduce (a small amount of) non-linearity,
age-dependence, history-dependence or joint taxation within a baseline linear, age-independent,
or separable tax system. This allows us to sequentially decompose the gains arising from each
additional element of reform as the tax code becomes more sophisticated. Second, we derive
characterizations of the optimal tax system, or the optimum within a certain class. These
two questions are closely related, because the characterization of the optimum is obtained by



                                                         8
imposing that the net welfare effect of any tax reform is non-positive if the baseline tax system
T 0 is optimal.


3    Behavioral Effects of Tax Reforms
In this section, we formally define the admissible perturbations of the initial tax system, i.e., our
tax reforms, and study their effect on individual behavior. We start with a baseline tax system
T 0 = Tp0 1≤p≤S , and consider another tax system H = {hp }1≤p≤S . The system H consists
        

of a set of tax functions hp : RS+ × RS → R for each period p ∈ {1, . . . , S}, as defined in Section
2. Our goal is to analyze the revenue and welfare effects of reforming the baseline tax system
T 0 “in the direction H ”. Formally, for µ ∈ R+ , we then define the perturbed tax system T˜ as
T˜ = T 0 + µH . That is, the perturbed tax function in any period p is given by T̃p = Tp0 + µhp .
We then derive the change in tax revenue or social welfare following this perturbation as µ → 0.
Hence, we compute the Gateaux differential of the tax revenue and social welfare functionals,
following the local perturbation of the baseline tax system T 0 in the direction H .
    We can decompose this general perturbation H of the tax system into its period-p com-
ponents hp : X → R, which only affect the period-p baseline tax function Tp : RS+ × RS → R.
The total effect of the perturbation H is then equal to the sum over periods p of the effects of
the elementary perturbations hp . Without loss of generality we can thus restrict the analysis to
perturbations of a given period-p tax function Tp (·), and keep the rest of the baseline tax system
T 0 unchanged. We therefore define an admissible perturbation of the baseline tax function Tp (·)
as a twice continuously differentiable function hp ∈ C 2 (X, R). For any µ > 0, we then define
a perturbed function in period p as T̃p = Tp + µhp , and study the effects of this tax reform as
µ → 0.
    We say that the perturbation hp is restricted within a class if it leaves the perturbed tax
system T˜ in the same class (e.g., of linear, separable, etc., tax systems) as the baseline tax
system T 0 . As a first step towards deriving the effects on social welfare and tax revenue of the
perturbation hp , we characterize in this section its effects on the optimal individual behavior.
That is, we compute the Gateaux differential of the individual income functional xθ T 0 in
                                                                                                   

the direction hp .
    We first characterize the solution to the problem (1) of individual θ, i.e., his choice of incomes
xθ ∈ X given a tax system T . Since we define perturbations of the tax function in each given
period, we denote the vector of optimal choices of individual θ under the baseline tax system
                               T 0 , and under the perturbed tax system as x (T + µh ) or as
                                  
either
      as x θ (Tp ) or as x θ                                                     θ   p       p
      ˜
xθ T . We denote by {xθ,j }             the components of the income vector xθ , that is the labor
                                1≤j≤2S
incomes ys and capital incomes zs in each period s ∈ {1, . . . , S}.
    The main result of this section is that as long as xθ is well-behaved (in a formal sense given in
Assumption 2), the directional derivatives of xθ are well-defined and can be expressed in terms
of income and price elasticities. Before we state this result, we need to define these elasticities


                                                  9
in settings where the consumers’ budget constraints are non-linear.

3.1   Elasticities
We build our definitions of elasticities on the classical consumer demand theory that uses lin-
ear budget constraints. We start by defining the individual income responses to tax changes
in an economy with linear budget constraints and then extend these definitions to non-linear
constraints.
    Let qj,s be the after-tax price of good xj (where xj = yj for 1 ≤ j ≤ S and xj = zj+1 for
S + 1 ≤ j ≤ 2S) in period s and Rs be the exogenous lump-sum income. Define

                                                   S
                                                   X                 S
                                                                     X
                            Hs (x) ≡ Rs −                qj,s yj −          qS+j,s zj+1 .
                                                   j=1                j=1


Hs (x) is a hyperplane defined by a vector that consists of 2S prices qj,s and the exogenous income
Rs . We use (q, R) to denote the 2S × S-matrix of prices {qj,s }1≤j≤2S and the 1 × S-vector of
                                                                                    1≤s≤S
exogenous incomes {Rs }1≤s≤S in all S periods, and we let H(q,R) denote the S hyperplanes
defined by (q, R). The budget constraint of the consumer can be written compactly as c =
H(q,R) (x), where c = {cs }1≤s≤S is the vector of consumption choices in the S periods. Let
x̂θ (q, R) be the (Marshallian) demand of the individual θ who faces a sequence of budget
constraints defined by H(q,R) , and let x̂θ,i denote the ith component of x̂θ . We define the
income and uncompensated price responses in the usual way. For example, the 2S × 2S-matrix
E u,θ
   s  of changes in uncompensated incomes xi with respect to the period-s prices qj,s , and the
2S × 1-vector I θs of changes in incomes xi with respect to the period-s virtual income Rs , are
given by
                             h      i      ∂ x̂θ,i     h i    ∂ x̂θ,i
                              E u,θ
                                s        =         and I θs =         ,                      (4)
                                     i,j   ∂qj,s            i ∂Rs
while the compensated (Hicksian) changes are defined through the Slutsky relationship
                                h           i      h      i          h i
                                    E c,θ
                                      s           = E u,θ
                                                      s             + I θs x̂θ,j.              (5)
                                            i,j               i,j            i

At this stage this is a straightforward generalization of standard consumer theory (see Mas-
Colell, Whinston and Green, 1995) when the purchase of good x ∈ {y, z} in period j requires
expenditures qj,s xj in all periods s at prices that depend on s. This general formulation is
helpful for our analysis of general tax systems and will allows us to capture the effects of, for
example, history-dependence, when taxes on choices made in a given period depend also on
other choices made in previous periods. Classical demand theory also imposes restrictions on
how the responses of demand x̂θ,i to changes in income Rs and prices qj,s in different periods s
are related to each other, but in principle we can allow those responses to be free parameters.
For our purposes it is important to note that all the parameters in the matrices E c , E u and I



                                                         10
depend on the pair (q, R) that defines the hyperplanes H(q,R) , and on the vector of types of
the consumer, θ.
   From standard consumer demand theory it is easy to infer the response      of
                                                                                demand x̂θ to any
perturbation of the hyperplane H (q , R) . To fix ideas, consider a pair q̃, R̃ with the property
that the column vectors q̃s ≡ {q̃ j,s }2S
                                       j=1 and thescalars R̃s are equal to zero for all but one s, and
                                                                     
consider the response of x̂θ to the perturbation q + µq̃, R + µR̃ . This experiment corresponds
to a perturbation of the linear budget constraint only in one period s. Standard arguments      imply
                                                                                                  
that response of demand x̂θ to such a perturbation around (q,R) in the direction q̃, R̃ for
                           
small µ, δx̂θ (q,R) ; q̃, R̃ , is given by
                                                           
                                    x̂θ q + µq̃, R + µR̃ − x̂θ (q, R)
        δx̂θ       (q,R) ; q̃, R̃ ≡ lim                                   = E u,θ       θ
                                                                              s q̃s + I s R̃s ,                (6)
                                    µ→0                 µ

so that for all i ∈ {1, . . . , 2S}, the ith component of the vector δx̂θ writes

                                                   2S
                                                   X  ∂ x̂θ,i               ∂ x̂θ,i
                                       δ x̂θ,i =                 q̃ j,s +           R̃s .
                                                         ∂qj,s              ∂Rs
                                                   j=1


    We can now extend these definitions to our environment with non-linear taxes. We define the
hyperplane Hθ that is tangent to the individual θ’s budget constraint evaluated at the optimal
income vector xθ . In particular let

                                     ∂Ts (xθ )
                        qj,s (xθ ) ≡                                          if xj ∈
                                                                                    / {ys , zs , zs+1 } ,
                                        ∂xj
                                                        
                                               ∂Ts (xθ )
                        qj,s (xθ ) ≡ − 1 −                                    if xj = ys ,
                                                 ∂xj
                                                             
                                          1         ∂Ts (xθ )                                                  (7)
                        qj,s (xθ ) ≡ −       +1−                              if xj = zs ,
                                          rs           ∂xj
                                       1     ∂Ts (xθ )
                        qj,s (xθ ) ≡      +                                   if xj = zs+1 ,
                                     rs+1       ∂xj
                         Rs (xθ ) ≡ h∇Ts (xθ ) , xθ i − Ts (xθ ) .

where rs is the (possibly idiosyncratic) interest rate, i.e. zs /ks−1 .12 The hyperplane Hθ defined
by (q (xθ ),R (xθ )) is tangent to the budget constraint defined by taxes T 0 at a point xθ . Since
utility is strictly concave, the optimal income choice xθ of individual θ given the baseline non-
linear tax function T 0 coincides with the income vector x̂θ that he would choose if he faced the
  12
     Note that some of these prices are negative, because they are those of (say) labor income rather than leisure.
This allows us to express the individual’s budget constraint as c = H(q,R) (x). The price on income xj is equal
to the marginal tax rate on good xj plus a constant, so that the derivatives of income w.r.t. those prices are
the same as the derivatives w.r.t. the marginal tax rates. Below we define the elasticities that we use in our
applications, which are w.r.t. the net-of-tax rates rather than the prices when these are negative.




                                                            11
linear budget constraint defined by Hθ . Assumption 1 ensures that for each x chosen under the
tax T 0 there is only one type θ for whom it is the optimal choice. We use this observation to
define for all s the behavioral responses at a vector x as

                 E cs (x) ≡ E c,θ   u         u,θ            θ
                              s , E s (x) ≡ E s , I s (x) ≡ I for θ such that x = x̂θ .


Responses are not defined for those x that are not chosen by any individual, but it turns out to
be irrelevant for our analysis. Note that behavioral responses generally depend on the demand
x at which they are evaluated.13
     We can finally define in the usual way the compensated and uncompensated price elasticities
 c,θ      u,θ                                      θ . In order to be consistent with the empirical literature
ζi,j,s , ζi,j,s and the income elasticities ηi,s
that estimates such elasticities, we define in the case of linear budget constraints the elasticities
of x̂θ,i with respect to the modified prices q̂j,s that are defined as the (constant) marginal tax
rates τxj ,s ≡ ∂T∂x  s (x̂θ )
                        j
                              if xj ∈
                                    / {ys , zs } and the net-of-tax rates 1 − τxj ,s otherwise. Note that the
behavioral responses to the modified prices are given by ∂ x̂θ,i /∂ q̂j,s = ∂ x̂θ,i /∂qj,s if xj ∈ / {ys , zs },
and ∂ x̂θ,i /∂ q̂j,s = −∂ x̂θ,i /∂qj,s otherwise. Similarly, we define the income elasticity ηi,s    θ as the

income response ∂ x̂θ,i /∂Rs weighted by the net-of-tax rate 1 − τxi ,s . Therefore, equation (6)
can be re-written as
                          2S                                     2S
                          X  ∂ x̂θ,i               ∂ x̂θ,i       X  x̂θ,i h u,θ i              1
              δ x̂θ,i =                 q̃ j,s +           R̃s =           ±ζi,j,s q̃ j,s +           η θ R̃s ,
                                ∂qj,s              ∂Rs              q̂j,s                   1 − τxi ,s i,s
                          j=1                                   j=1


where ± stands for + if xj ∈ / {ys , zs }, and − otherwise. The definitions of the income and price
elasticities in the case of the non-linear budget constraints are extended as described above.
We derive in the Appendix analytical expressions for all these elasticities and income effect
parameters.14

3.2    The effect of non-linear perturbations
We now analyze the change in an individual’s income vector xθ in response to an admissible
perturbation hp of the period-p tax function Tp . The main difficulty in analyzing the effects of
tax reforms is that the individual’s demand xθ depends on the characteristics (normal vector
and intercept) of the tangent hyperplane Hθ that he faces, which in turn are determined by
the vector of incomes xθ that the individual optimally chooses. Therefore a perturbation of
the individual’s hyperplane has a direct effect on his demand, which in turn induces a shift
in his hyperplane if the baseline tax function is non-linear. The key intermediate step of our
analysis is to provide a sufficient condition on the individual demand which allows us to solve
  13
     Our definitions are straightforward to generalize when Assumption 1 does not hold. In this case the definitions
above are replaced by the average response by all types θ who choose the vector x under the baseline tax schedule.
  14
     In the general model, these expressions are of course complicated. We show in Section 6 that they significantly
simplify if the utility function has no income effects on labor supply and the baseline tax system is separable.




                                                                 12
this circularity issue. This condition, which states that the demand is “well behaved” in a
formal sense, allows us to derive the change in income of each individual due to a perturbation
using only the local income and substitution effects at the individual level, and the curvature
of the baseline tax system. Specifically, we make the following assumption about the income
functional xθ , which formalizes the idea that individuals’ income choices do not change by a
discrete amount in response to infinitesimal admissible perturbations of the initial tax system
T 0 .15

Assumption 2. The income functional xθ (·) is locally Lipschitz continuous in every direction
hp at the initial tax system Tp . That is, for any admissible perturbation hp ∈ C 2 (X, R), there
exist µ̄ > 0 and M > 0 such that µ < µ̄ implies kxθ (Tp + µhp ) − xθ (Tp )k < M × µ.

    Using Assumption 2, we are now able to derive formally the change in individual behavior in
response to a perturbation hp of the baseline tax system, that is, the Gateaux differential of the
individual income function in the direction hp . In response to this perturbation, all the labor
and capital incomes chosen by the individual change simultaneously. We show that despite the
apparent complexity of the problem, we can derive, using the matrix notations introduced above,
a compact and transparent formula giving the change in individual’s behavior following any such
perturbation. We express these behavioral responses in terms of: (i ) the elasticities and income
effect parameters of the individual, and (ii ) the local characteristics (gradient and Hessian) of
the baseline tax function. We view the derivation of the formula in the next proposition and,
most importantly, its compact and transparent representation, as one of the main contributions
of this paper.

Proposition 1. Suppose that Assumption 2 is satisfied. Then the income functional xθ (·)
is Gateaux differentiable around the initial tax system. Its Gateaux differential at Tp in the
direction hp , δxθ (Tp , hp ) ∈ R2S , is given by:
                      "         S
                                                               #−1
                                X
                                      E cs (xθ ) D2 Ts (xθ )             E cp (xθ ) ∇hp (xθ ) − I p (xθ ) hp (xθ ) ,
                                                                     
       δxθ (Tp , hp ) = i2S −                                                                                          (8)
                                s=1


where i2S the 2S × 2S identity matrix, and D2 Ts (x) the Hessian of the tax function Ts (·).

Proof. See Appendix.

   We now sketch the main steps of the proof of Proposition 1. The individual’s behavior under
the baseline tax function Tp (resp., the perturbed tax function T̃p = Tp + µhp ) is described by
  15
    The same issue also arises in dual approach to optimal linear taxation developed by Diamond and Mirrlees
(1971). In particular, to be able to express the effect of tax changes in terms of elasticities one needs to assume that
consumer demand is differentiable in prices and lump-sum income at the optimal tax schedule. Differentiability of
demand in classical consumer demand theory generally does not follow from differentiability and strict concavity
of utility functions (Katzner 1968) and requires additional Lipschitzian assumptions on demand (Rader 1973,
1979). In our setting with non-linear taxes this assumption also rules out bunching (see, e.g., Rochet and Choné
1998).



                                                           13
the following system of first-order conditions

                                                S
                                                X
                     Uxj (Hθ (xθ ), xθ , θ) =         qj,s (xθ ) Ucs (Hθ (xθ ), xθ , θ) ,         (9)
                                                s=1

where qj,s (xθ ) are defined in (7). The first step is to write a Taylor expansion in the direction
hp of the perturbed set of equations, which yields the first-order (in µ) change in the income
vector, x̃θ − xθ . The local Lipschitz continuity of the income functional around the baseline
tax system, Assumption 2, is the key to address the circularity issue discussed above, as it
ensures that the change in income remains first-order in the size µ of the perturbation despite
the feedback effect on demand generated by the endogenous shift of the tangent hyperplane
along the baseline tax function. We obtain that the individual changes his income vector xθ in
response to the perturbation by an amount
                                                       " S                       #
            c                                          X
                                                           E cs (xθ ) D2 Ts (xθ ) × dxθ ,
                                                    
      dxθ = E p (xθ ) ∇hp (xθ ) − I p (xθ ) hp (xθ ) +                                           (10)
                                                              s=1

which leads to equation (8).
      The first bracket of (10) is the direct effect of the perturbation. The perturbation increases
marginal taxes at income level xθ by ∇hp (xθ ) and the individual’s response this induces is
captured by the matrix of compensated elasticities E cp . Moerover, the total tax liability at
income xθ is changed by hp (xθ ), and the income effect of such a tax change is summarized by
I p . The second bracket is the indirect effect due to the endogenous shift in the tax rates. Since
the baseline tax system is non-linear, the consumer, who adjusts his demand in response to the
original exogenous tax change, generally faces a different marginal tax rate after adjustment.
The shift of the taxpayer demand xθ along the non-linear tax function by dxθ produces an
additional change in the marginal rates in all periods s ∈ {1, . . . , S} equal to d (∇Ts ) (xθ ) =
 D2 Ts (xθ ) dxθ , and the behavioral responses from this change are captured by E cs .
              

      The important point to notice is that the consumer’s response depends only on taxes and
the perturbation evaluated at the consumer’s optimal choice in the baseline tax schedule, before
the perturbation. This allows us to express the response of any individual’s choice of labor
and capital incomes following any local perturbation of the baseline tax system, without having
to solve for the optimization problem (1), and describe this response in terms of empirically
observable and easily interpretable parameters. We can do so by substituting the values of the
specific perturbation function hp , i.e., its marginals ∇hp (xθ ) and its level hp (xθ ) at point xθ ,
into equation (8). Importantly, this characterization is valid in very general settings and holds
regardless of the specific dimensions of heterogeneity, utility functions, tax systems, etc., as long
as the individual’s first-order conditions and Assumption 2 are satisfied.
      We conclude this section by providing two examples of application of formula (8). First,
suppose that the baseline tax system is linear and separable, so that income xp is taxed at the



                                                      14
constant rate τp , for all p ∈ {1, . . . , 2S}. Consider the perturbation µhp (x) = µτ̃p xp for all x.
This perturbation hp corresponds to an increase in the marginal tax rate on good xp by µτ̃p , with
no change in lump-sum income. Let h ≡ 2S
                                               P
                                                 p=1 hp denote the sum of these perturbations. Since
the baseline tax system is linear, the second bracket in (10) is equal to zero and the behavioral
response of income vector x as µ → 0 is equal, using the Slutsky equation (5), to

                                                 2S
                                                 X
                                 δx (T , h) =          E up (x) · [0, . . . , τ̃ p , . . . , 0]T .
                                                 p=1


The typical element of the vector δx (T , h) can be written in elasticity form as

                                                          2S
                                                          X       τ̃p
                                     δxi (T , h) = −                  xi ζ u (x) ,
                                                                1 − τp xi ,q̂p
                                                          p=1

                       1−τ   ∂xi
where ζxui ,q̂p (x) ≡ xi p ∂(1−τ p)
                                    is uncompensated elasticity of demand for good i with respect to
a change in the net-of-tax rate (the “modified price” q̂p ) on good xp , evaluated at a vector x.16
This is just a standard expression that shows that individuals’ response to an increase in linear
tax rates is proportional to uncompensated behavioral responses.
    Second, consider the static Mirrlees model (S = 1) with a non-linear labor income tax
schedule T (y), and let hτ denote the perturbation of the baseline tax schedule defined by
hτ (y) = max {y − ŷ, 0}, for some fixed income level ŷ ∈ R. For a given µ > 0, the perturbed
tax schedule is therefore given by T̃ (y) = T (y) if y < ŷ, and T̃ (y) = T (y) + µ (y − ŷ) if y ≥ ŷ.
Intuitively, this perturbation increases the marginal tax rate T 0 (y) faced by individuals above
the income threshold ŷ by the same amount µ > 0. Note that this perturbation introduces a kink
in the tax system at ŷ, and hence strictly speaking it is not admissible. We smooth out the kink
by defining instead the admissible perturbation h̃τ as h̃τ (y) = hτ (y) for all y ∈
                                                                                  / [ŷ − u, ŷ + u] for
some small u > 0, and letting h̃τ be smooth and monotonic between ŷ − u and ŷ + u. Applying
formula (8), we obtain that an individual with income y > ŷ + u adjusts his behavior in response
to the perturbation h̃τ by the amount:
                                         y       c                                  1
                                     1−T 0 (y) ζy,w (y)                        1−T 0 (y) ηy (y)
            δy (T, hτ ) = −           y        c        00
                                                                  −             y       c        00
                                                                                                        (y − ŷ) ,
                               1+   1−T 0 (y) ζy,w (y) T (y)          1+     1−T 0 (y) ζy,w (y) T (y)
  16
     If the goods x represent the labor and capital incomes y, z, we have xp = yp for p ≤ S and xp = zp for
p ≥ S + 1. Suppose that yp and zp are taxed in period p at rate τy,p ≡ τp and τz,p ≡ τp+S−1 , respectively. Using
                                        u,θ                                                                             u,θ
the definitions of the elasticities ζi,j,s  introduced in the previous section, we obtain that ζxui ,q̂p is equal to ζi,p,p
                                                                              u,θ
if p ∈ {1, . . . , S} (so that xp = yp , which is taxed in period p), and to ζi,p,p−S+1 if p ∈ {S + 1, . . . , 2S} (so that
xp = zp−S+1 , which is taxed in period p − S + 1). The net-of-tax rates q̂p are equal to q̂p,p if p ∈ {1, . . . , S},
and to q̂p−S+1,p if p ∈ {S + 1, . . . , 2S}. For ease of notation, in the sequel, whenever labor and capital incomes
earned in period p are taxed only in period p, in our expressions for the elasticities we denote by wp ≡ q̂p the
modified price (net-of-tax rate) on period-p labor income yp , and by rp ≡ q̂p the modified price (net-of-tax rate)
on period-p capital income zp .




                                                             15
        c
where ζy,w  is the compensated elasticity of y with respect to the net-of-tax rate on labor income
(see footnote 16), and ηy is income effect of y with respect to the lump-sum income.17 Next,
consider the perturbation hR defined by hR (y) = 1, so that for a given µ > 0, the perturbed
tax schedule is therefore given by T̃ (y) = T (y) + µ. Intuitively, this perturbation increases the
total tax liability faced by individual y by the amount µ > 0. Applying formula (8), we obtain
that an individual with income y adjusts his behavior in response to the perturbation hR by the
amount:
                                                         1
                                                    1−T 0 (y) ηy (y)
                              δy (T, hR ) = −                               .
                                              1 + 1−Ty0 (y) ζy,w
                                                             c (y) T 00 (y)



4         Welfare Effects of Tax Reforms and Optimal Tax System
Having defined the perturbations and described the effects that they induce on individual be-
havior, we now derive the revenue and welfare effects of these tax reforms, and characterize
the optimal tax system. Specifically, we start from a baseline tax system, which can be sub-
optimal or optimal. We locally perturb this tax system with tax reform, as defined above.
Our first result (Proposition 2) describes the revenue and welfare effects of these local tax re-
forms. Formally, we compute these local effects as the Gateaux differentials of the revenue and
social welfare functionals. These give the sign and the magnitude of the potential gains that
arise from reforming the current, potentially suboptimal, tax code. If the perturbation yields
a strictly positive (revenue or welfare) effect, then the corresponding tax reform is (revenue
or welfare)-improving and should be implemented. The second result that our theory yields
(Proposition 3) is a characterization of the globally optimal tax function. Specifically, the base-
line tax system is optimal only if there is no local tax reform that yields a strict improvement.
Characterizations of the revenue-maximizing or welfare-maximizing tax systems are therefore
obtained by setting the Gateaux differentials of the corresponding functionals equal to zero for
any admissible perturbation. Note finally that a similar reasoning yields a characterization of
the optimum tax system within a restricted class (e.g., of linear, separable, etc., tax systems),
by restricting the analysis to the perturbations within the corresponding class.
    We start by defining the social marginal welfare weights gs (x) that the planner assigns to
agents with various income choices. These weights are defined such that the government is
indifferent between having gs (x) more dollars of public funds in period s and giving one more
dollar in period s to the taxpayers with choice vector x. The smaller gs (x) is, the less the
government values marginal consumption of individuals x. We formally define the period-s
social marginal welfare weight associated with an individual with the choice vector x (and type
    17                            θ                        θ
         Using the definition of ηi,s above, we have ηy ≡ η1,1 .




                                                              16
θ such that xθ = x) as18

                                           1 − α −(s−1) 0
                                gs (x) ≡        β      G (Uθ (T )) Ucs (θ) .                                     (11)
                                             λ
Intuitively, the envelope theorem implies that an additional dollar of revenue increases the indi-
vidual’s indirect utility by dU = Ucs , and social welfare increases by d [G (U )] = G 0 (U ) dU =
G 0 (U ) Uct . We express this welfare gain in terms of the value of public funds (that is, in
monetary units) by dividing this expression by the multiplier λ.
     We now characterize the revenue and welfare effects of local tax reforms. Formally, we fix a
period p and compute the Gateaux differential of the social welfare W (·) and the tax revenue
R (·) following a perturbation of the baseline tax function Tp in the direction hp ∈ C 2 (X, R).
We show:

Proposition 2. Suppose that Assumptions 1 and 2 are satisfied. The Gateaux differential of
social welfare at the baseline tax system Tp in the direction hp , is equal to
                               ˆ
                                      β p−1 (1 − gp (x)) − T 0 (x) D −1 (x) I p (x) fx (x) hp (x)
                                                                                 
             δW (Tp , hp ) =
                                X                                                                                (12)
                                                  + T 0 (x) D −1 (x) E cp (x) fx (x) ∇hp (x) dx,
                                                                            


where D (x) ≡ i2S − Ss=1 E cs (x) D2 Ts (x), and T 0 (x) ≡ Ss=1 β s−1 (∇Ts (x))T is the discounted
                     P                                      P

sum of the (transposed) gradients of the baseline tax functions Ts (·).19 This expression can be
equivalently written as
                             ˆ
                                      (1 − gp (x)) fx (x) − T 0 (x) D −1 (x) I p (x) fx (x)
                                 p−1
             δW (Tp , hp ) =     β
                              X                                                               (13)
                                            0       −1      c
                                                                         
                                   −∇ · T (x) D (x) E p (x) fx (x) hp (x) dx.

The perturbation increases (resp., decreases), social welfare if δW (Tp , hp ) ≥ 0 (resp., ≤ 0). The
Gateaux differential of the tax revenue functional, δR (Tp , hp ), is given by equations (12,13) in
which gp (x) is replaced with 0. The perturbation increases (resp., decreases), tax revenue if
δR (Tp , hp ) ≥ 0 (resp., ≤ 0).

Proof. See Appendix.

   Formulas (12) or (13) give the effects on social welfare of any local perturbation of the
baseline tax system in the direction hp . Equation (12) is obtained from the following formula,
  18
     If Assumption 1 is not satisfied, then the social marginal welfare weight gs (x) should be defined as the average
of the expression (11) over all individuals θ who choose the same vector x.
  19
     For instance the first component of the 2S-row vector T 0 (x) is the sum of the marginal tax rates on first-period
labor income y1 that the individual pays in every period of his life.




                                                          17
which follows from the definition (3) of social welfare and is formally derived in the Appendix:
                               ˆ
                          −1
                                  αV 0 (R) β p−1 − (1 − α) G 0 (Ux ) Ucp (x) hp (x) fx (x) dx
                                    
      δW (Tp , hp ) = λ
                                X
                                         ˆ                                                       (14)
                                   0           0
                                +αV (R)      T (x) δx (Tp , hp ) fx (x) dx ,
                                            X

where δx (Tp , h) denotes the Gateaux differential of the individual income functional derived in
(8). The change in social welfare following the perturbation hp comes from the effect on the
individuals’ utilities (the term that is multiplied by (1 − α) G 0 (Ux ) in (14)) and the effect on
the public goods through the change in tax revenue (the terms that are multiplied by αV 0 (R)
in (14)). Equation (13) is then obtained by integrating (13) by parts, using our assumption that
there is no mass of individuals at the boundary of the set X at the baseline tax system.
    Intuitively, the first integral of equation (14) is the mechanical effect, net of the welfare loss,
of the perturbation hp , and the second integral is the behavioral effect of the tax reform. The
mechanical effect captures the increase in government revenue due to the tax reform, assuming
that individuals do not change their behavior in response to the perturbation. An individual
with income x before the perturbation pays the additional tax liability hp (x) in period p after
the perturbation. By definition of the marginal social welfare weights (11), this induces a loss
in social welfare, expressed in units of tax revenue, equal to gp (x) hp (x). Summing over all
individuals x ∈ X using the density of incomes fx (x) yields the first integral in (14). Next,
the behavioral effect of the perturbation captures the change in government revenue due to
the behavioral response of individuals whose vector of labor and capital incomes x is affected
by changes in the marginal tax rates or the virtual incomes. We derived in Proposition 1 the
change dx = δx (Tp , hp ) in each individual’s income vector x induced by the perturbation hp .
This induces in turn a change in government’s revenue in every period s, given by d [Ts (x)] =
(∇Ts (x))T dx. The overall behavioral effect of the perturbation is thus equal to the second
integral in (14). Finally, the effect on government revenue is identical to the effect on social
welfare, except that we do not take into account the welfare loss of the perturbation described
above. We call the perturbation hp budget-neutral if δR (Tp , hp ) = 0.
    Formula (13) (or equivalently (14)) allows to compute in a wide variety of settings the effects
on social welfare of any local taxreform hp of the baseline tax system, by simply substituting
the values hp (x) of the corresponding perturbation in the integral of (13). We analyze several
examples of application of this result in Sections 5 and 6.
    We can also use formula (13) to characterize the optimal tax system, or the optimum within a
restricted class. Specifically, if the baseline tax system is optimal (possibly within a class) then
there is no tax reform (within the corresponding class) that yields a positive effect on social
welfare. Thus, by equating the Gateaux differential of social welfare for any such perturbation
to zero, we obtain the optimum tax system. We obtain the following proposition:

Proposition 3. Suppose that Assumptions 1 and 2 are satisfied. Then:


                                                    18
    - A necessary condition for the baseline tax function Tp to be optimal (resp., optimal within
a class) is that, for any perturbation hp ∈ C 2 (X, R) (resp., for any perturbation restricted within
this class), we have
                                          δW (Tp , hp ) = 0.                                     (15)

    - In particular, applying (15) to the class of separable linear perturbations,we obtain that the
optimum separable linear tax system is characterized by, for all p ∈ {1, . . . , 2S}:
               ˆ n                                                                o
                   β p−1 (1 − gp (x)) xp + T 0 (x) E cp (x) p − xp T 0 (x) I p (x) fx (x) dx
                                                          
           0=
               ˆX n                                                                                    (16)
                                                            o
                   β p−1 (1 − gp (x)) xp + T 0 (x) E up (x) p fx (x) dx,
                                                  
             =
                X

where E cp p is the pth column of the matrix E cp .
        

    - In particular, applying (15) to the class of all admissible perturbations, we obtain that
the baseline tax system is the full optimum if, for any compact volume V ⊂ X with closed and
piecewise smooth boundary S = ∂V, we have, for all p ∈ {1, . . . , 2S}:
                    ˆ                                         ˆ
                             p−1
                                                                  T 0 (x) D −1 (x) I p (x) fx (x) dx
                                                                                          
           0=            β         (1 − gp (x)) fx (x) dx −
                    ˆV                                        V
                                                                                                       (17)
                             T 0 (x) D −1 (x) E cp (x) · →
                                                         −    
                +                                        n (x) fx (x) dS (x) ,
                        ∂V

where →
      −
      n (x) is the inward-pointing unit normal vector of the closed surface S at point x.

Proof. See Appendix.

    Proposition 3 has three parts. First, equation (15) formalizes the intuition that the baseline
tax system is optimal (resp., optimal within a class) if no tax reform (resp., no tax reform that
leaves the tax system within the corresponding class) induces a non-zero welfare gain. It is a
standard first-order condition which should be satisfied by any perturbation (possibly within a
restricted class), and thus provides a general characterization of the optimality of any tax system.
The second and third parts of Proposition 3 show two examples of application. Equation (16)
characterizes the optimal separable linear tax system, that is the set {τxs }1≤s≤2S of constant
marginal tax rates on each income xs . Note that the optimal linear tax system is such that
the total mechanical (net of the welfare loss) and behavioral (elasticitiy and income) effects,
averaged over the whole population of individuals x ∈ X, must sum to zero. This is because
in a linear tax system, all the individuals face the same marginal tax rate, so that the feasible
tax reforms increase the tax rates by the same amount for every individual in order to leave
the perturbed tax system within this class. Moreover, the sum of the individual compensated
elasticity effect and income effect in the first line of (16) yields the uncompensated elasticity
term in the second line, from the Slutsky equation.
    Equation (17) characterizes the fully optimal (in particular, non-linear and non-separable)


                                                        19
tax system. We obtain this expression by imposing that every perturbation hp yields a zero
welfare effect, so that the integrand in equation (13) must be equal to zero pointwise. Integrating
the resulting equation over any volume V ⊂ X with closed boundary S = ∂V must therefore have
a zero effect. We then obtain formula (17) as a consequence of the divergence theorem, which
separates the total behavioral effect of the tax reform into its components in the interior and
on the surface of the volume V. To understand the intuition underlying this formula, suppose
that the government wants to raise revenue by increasing uniformly and in a lump-sum way the
tax liability of individuals with income in the region x ∈ V. This mechanically increases the
government’s revenue, since all the individuals in the region V now pay higher taxes; summing
the individual mechanical effects (net of the welfare losses) over the region V yields the first
integral in equation (17). Moreover, these individuals respond to the lump-sum increase in their
tax liability by adjusting their incomes, as captured by the vector of income effect parameters
I p ; summing these behavioral effects over all the individuals in the region V yields the second
integral in (17). Finally, the government can only raise the lump-sum tax liability in the region
V by increasing the marginal tax rates of the individuals located on the boundary of V, that is
those with income x on the surface S = ∂V. These individuals respond to this higher distortion
by adjusting their incomes, as captured by the matrix of compensated elasticities E cp ; summing
these behavioral effects over all the individuals on the boundary S = ∂V yields the third integral
in (17). Formula (17) thus shows that the optimal tax system is such that, for any region V
of the space X ⊂ RS+ × RS , the elasticity effect induced by the additional distortion on the
boundary ∂V exactly compensates the mechanical and the income effects due to the lump-sum
tax increase inside the region V.
      To show an example of application, consider the static Mirrlees model with a single income
dimension y ≥ 0, and apply formula (17) to the volume V = [ŷ, ∞), for some income level ŷ.20
The boundary of V is the singleton ∂V = {ŷ}; its inward pointing unit normal →                  −n (x) is the real
number 1. We obtain
          ˆ ∞                              ˆ ∞
                                                                          1              ηy (y)
      0=        (1 − g (y)) fy (y) dy −          T 0 (y)           y                               fy (y) dy
           ŷ                               ŷ            1 + 1−T 0 (y) ζy,w (y) T (y) 1 − T 0 (y)
                                                                          c       00
              "
                                                           c (ŷ)
                                                                            #                                 (18)
                 0                     1                ŷζy,w
          − T (ŷ)                                                   fy (ŷ) .
                                       c (ŷ) T 00 (ŷ) 1 − T 0 (ŷ)
                      1 + 1−Tŷ0 (ŷ) ζy,w

This equation is the analogue of (17) for the static model, derived in Saez (2001). In particular,
the third term of (18) (in the square brackets) is the analogue of the third term in (17), i.e.,
the integral over the boundary ∂V. Intuitively, in order to raise the lump-sum tax liability of
individuals with income y ∈ [ŷ, ∞) (the region V, which generates a mechanical effect and an
  20
     Rigorously, to apply formula (17), we need to work with a compact volume [ŷ, ŷ 0 ], with an additional boundary
{y = ŷ 0 }, on which the inward pointing normal is the real number −1, and let ŷ 0 → ∞, using limy→∞ fy (y) = 0.
The matrix D (x) is equal to the real number 1 + 1−Ty0 (y) ζy,w   c
                                                                      (ŷ) T 00 (y) in the static setting, the vector T 0 (x) is
T 0 (y), the matrix E cp is − 1−Ty0 (y) ζy,w
                                         c
                                             (y) and the vector I p is 1−T10 (y) ηy (y).




                                                              20
income effect given by the first two terms of (18)), the government must increase the marginal
tax rate at the income level y = ŷ (the surface ∂V, which generates an elasticity effect given
by the third term of formula (18)). We discuss the economic intuition further in more detail in
Section 5.3.
    Equations (16) and (17) highlight the source of the gains that arise from using more sophis-
ticated tax systems. In the case of the optimal separable linear tax system (16), the mechanical
and behavioral effects of any feasible perturbation must cancel out on average over the whole
population x ∈ X. On the other hand, in the case of the fully optimal tax system, these oppos-
ing forces must cancel out pointwise, that is over every region x ∈ V. Using more sophisticated
tax instruments allows the government to “fine-tune” optimally the distribution of distortions
within the population, whereas a linear tax system is constrained to imposing the same tax rate
on every individual, and hence to balance the increase in tax revenue against a measure of the
average distortion in the economy. The unrestricted government can thus choose appropriately
the volume V so that the distortions induced by the higher marginal tax rates on the boundary
∂V are small relative to the benefits of higher lump-sum taxes in the interior of V, because
either the fraction of individuals fx dS or the behavioral responses to distortions D −1 E cp on the
boundary ∂V are relatively small. Therefore, non-linear tax instruments allow the government
to disentangle the compensated elasticity from the income effect, and target these two compet-
ing forces to different segments of the population. On the other hand, we saw in the case of
the linear tax system that every individual must face both the elasticity and the income effect,
leading to the uncompensated elasticity term in the second line of equation (16). We discuss
this general principle in greater detail in Sections 5 and 6 below.
    Equating the integrand of (13) to zero at each point x yields a partial differential equation
system which, along with the individual’s first-order conditions (9) characterizes the optimal tax
system in terms of the endogenous distribution fx of incomes x ∈ X. We can change variables
to rewrite this PDE using the exogenous density fθ of types θ ∈ Θ instead.21 Assume that
individuals have 2S dimensions of characteristics, so that their vectors of types and incomes
have the same dimension. We show in the Appendix that the optimal tax system is the solution
to the partial differential equation:

                             fθ (θ)                       Jx (θ)  −1
                                         + T 0 (x (θ))
                                                                                     
       0 = (1 − gp (x (θ)))                                          JF (θ) JF (Tp ) fθ (θ)
                          det (Jx (θ))                 det (Jx (θ))
             2S 2S                                                                                           (19)
             XX    h        −1 i      ∂                   Jx (θ)  −1
                     Jx0 (θ)                T 0 (x (θ))
                                                                                      
           −                                                          JF (θ) JF (τ p ) fθ (θ) ,
                                  i,j ∂θi               det (Jx (θ))                           j
             j=1 i=1


where Jx (θ) = [∂xθ,i /∂θj ]1≤i,j≤2S is the Jacobian matrix of the income function x (θ), det (Jx (θ))
  21
    Changing variables from x to θ to characterize the fully optimal tax system is useful because the resulting
partial differential equation does not feature the deformation matrix D (x), so that we can solve directly for the
marginal tax rates T 0 (x (θ)). On the other hand, it is more useful to work with the distribution of incomes when
deriving the welfare effects of local tax reforms of suboptimal tax systems, because it is observed given the current
tax code.



                                                         21
                                                                                            
is its determinant, and JF (τ p ) , JF (Tp ) , JF (θ) are defined by JF (τ p ) = ∂Fi /∂τxj ,p i,j , JF (Tp ) =
[∂Fi /∂Tp ]i , and JF (θ) = [∂Fi /∂θj ]i,j , for the function F that represents the individual’s first-
order conditions as a non-linear system of 2S equations
                                                                       
                             F xθ , {∇Ts (xθ )}Ss=1 , {Ts (xθ )}Ss=1 , θ = 0.                           (20)

In order to calculate these latter three matrices, we need to work with a specific model of
heterogeneity, and write explicitly the system of first-order conditions in the form of (20). In
the Appendix, we do so for a dynamic model in which the 2S sources of heterogeneity (i.e., the
idiosyncratic vector θ) are the productivity of labor supply and the interest rate on the capital
stock in each period. In particular, in the static Mirrlees model, we can easily compute the
matrices JF−1 (θ), JF (τ p ), JF (Tp ) by differentiating the individual’s first order conditions, so
that we obtain the following formula:

                                                T 0 (yθ ) ẏθ    ηy (yθ )
                      0 = (1 − g (θ)) fθ (θ) −       0              u (y )
                                                                            θfθ (θ)
                                              1 − T (yθ ) yθ 1 + ζy,w     θ
                                                 c (y )                                                 (21)
                                  T 0 (yθ )     ζy,w
                                                                   
                             d                          θ
                           +                                θfθ (θ)   .
                             dθ 1 − T 0 (yθ ) 1 + ζy,w
                                                    u (y )
                                                          θ


Integrating this differential equation yields the characterization of the optimal marginal income
tax rates T 0 (yθ ) / (1 − T 0 (yθ )) derived by Mirrlees (1971). An advantage of writing the formula
for the optimal tax schedule in the form (21) rather than in the original form of Mirrlees (1971)
is that the explicit notation for the income and the substitution effects makes transparent the
underlying economic effects that determine the optimal marginal taxes.


5    Applications to Optimal Taxation
In this section we discuss applications of our general analysis to optimal taxation. We first show
how our results reproduce two canonical benchmarks in public finance: the optimal Ramsey
tax formula of Diamond (1975), and the optimal non-linear income tax formula in a static
economy due to Mirrlees (1971). We then apply our analysis to several environments to obtain
novel insights about non-linear labor income taxation and capital income taxation in dynamic
economies.
    In Sections 5.1 to 5.4, we focus on separable tax systems. The tax function in period s
depends on labor income ys and capital income zs as Ty,s (ys ) + Tz,s (zs ). To simplify the
notations, we let x̄s ≡ E [xs ] denote the average income xs ∈ {ys , zs } in period s in the economy.
In some applications we take expectations conditional on vector x lying in a set V, in which
case we denote x̄V         s ≡ E [xs |x ∈ V]. With the exception of the last part of Section 6, in all our
applications taxes on income earned in period s are assumed to be paid in period s. Hence we
use ζxcs ,q̂p , ζxus ,q̂p to denote compensated and uncompensated elasticitities of income xs to the



                                                     22
net-of-tax rate on income xp .22 Similarly, ηxs ,p denotes the effect of an increase in lump-sum
income in period p on income xs . Let ζ̄xcs ,q̂p , ζ̄xus ,q̂p , η̄xs ,p be the following weighted averages of
the compensated price elasticity, uncompensated price elasticity and income effect parameter
among all individuals, with additional superscript V notation if the elasticities are averages over
x ∈ V:                              ˆ
                          (V)             xi
                        ζ̄xi ,q̂p ≡          ζ
                                           V xi ,q̂p
                                                     (x) fx (x |x ∈ V ) dx,
                                         x̄
                                     x∈V p
                                    ˆ                                                                    (22)
                           (V)               q̂s
                         η̄xs ,p ≡                   ηxs ,p (x) fx (x |x ∈ V ) dx.
                                     x∈V 1 − τxs ,p

As explained in footnote 16, in the notations for the elasticities we use the subscript wp (resp,
rp ) for the net-of-tax rate q̂p on labor income yp (resp., capital income zp−S+1 ).

5.1    Optimal Commodity Taxation
As a first application of our theory, consider the analysis of Ramsey (1927) and Diamond (1975),
who restrict the tax system to be separable and linear in each income, so that in each period s
a consumer pays a proportional tax Ts (x) = τs xs + τS+s xS+s on the s-th and S + s-th argument
of vector x = [y1 , .., yS , z2 , ..., zS+1 ]. Applying formula (16), we obtain

                          2S                                     
                          X
                                    s−p     τs    u         xp
                                β               ζ̄ =1 − E       gp for p = {1, ..., 2S}.                        (23)
                                          1 − τp s,p        x̄p
                          s=1

Define the net social marginal utility of income for individual x as

                                                          2S
                                                          X               τs
                                      bp (x) ≡ gp (x) −         β s−p          ηs,p (x) ,
                                                                        1 − τs
                                                          s=1


and let b̄p ≡ E [bp (x)]. Using the Slutsky equations and rearranging the previous equation, we
obtain, for all p,

                    2S                                                        
                    X       τs                                       bp xp
                                ζ̄ c = 1 − b̄p − b̄p · cov              ,          for p = {1, ..., 2S}.
                          1 − τp s,p                                 b̄p x̄p
                    s=1

This is Ramsey’s formula with several consumers, first obtained by Diamond (1975).

5.2    Optimal Age-Independent Capital Income Tax Rates
In this section we study capital income taxes that are restricted to be linear and constant over
many periods. Such taxes arise naturally in several cases. First, many applications impose an a
  22
     As explained in footnote 16, using the notations of Section 3.1 q̂p denotes the modified price q̂p,p ≡ 1 − τyp ,p
if p ≤ S, and q̂p,p−S+1 ≡ 1 − τzp−S+1 ,p−S+1 if p ≥ S + 1. In equation (22), note that τxs ,p is equal to 0 unless
xs ∈ {yp , zp }.




                                                            23
priori assumption that capital taxes do not depend on the time period, e.g., Conesa, Kitao and
Krueger (2009). Second, the optimal asymptotic capital tax rate in infinite horizon economies,
analyzed by Chamley (1986) and Judd (1985), is equivalent to a tax that is constant across time
after the economy reaches the steady-state.
    For our analysis we abstract from income effects on labor supply and assume that preferences
are of the form
                                       S                
                                     X
                                          s−1             ys
                                 U=      β u cs − v             .                           (24)
                                                          θs
                                      s=1

When labor supply has no income effects, the form of labor income taxes (linear, separable
non-linear, or even history-dependent) is irrelevant for our main result.
    First, note that when capital taxes can be chosen freely in each period, the optimal tax rate
in period p satisfies Ramsey’s formula (23), where the cross-partial elasticities ζ̄yus ,rp between
labor income and the capital income tax rates are equal to zero. If instead we exogenously
restrict the tax rates to be constant across time, we can apply the general formulas (12) and
(15) to obtain the following characterization of the optimal age-independent capital income tax
rate τz :

Proposition 4. Suppose that the utility function has no income effects on labor supply as defined
in (24). The optimal age-independent capital income tax rate τz is then given by:
                                                        
                                        S             
                            τz          X        z p         1
                                 = 1 −   γp E       gp  PS          ,                        (25)
                          1 − τz                 zp                 u
                                                           p=2 γp ζ̊p
                                          p=2


where the weights γp and the compounded uncompensated elasticity ζ̊pu are equal to

                                                              S
                                β p−1 z p                     X
                         γp = PS             ,   and ζ̊pu =         β s−p ζ̄zus ,rp .
                                     s−1 z
                               s=2 β       s                  s=2

Proof. See Appendix.

    The weight γp is the ratio between the mechanical effect of a linear perturbation of the capital
income tax rate in period p only (the tax revenue generated in period p is proportional to the
average capital income z p in the economy in period p), and the total mechanical effect of the
age-independent perturbation (which raises revenue in every period s ≥ 2). The compounded
elasticity ζ̊pu measures the behavioral effect of the period-p capital income tax change on capital
income in all periods. This is a shorthand for all the cross-partial elasticities that appear on
the left hand side of (23). Since tax rates do not depend on age in this application, the relevant
behavioral elasticity is the sum of all ζ̊pu weighted by the fraction of the capital stock affected
by the perturbation in period p, γp .
    To illustrate the compounding effect arising from age-independent taxation, assume for sim-



                                                 24
plicity that the capital income distribution is age-independent, so that γp = β p−1 / Ss=2 β s−1
                                                                                        P

is simply equal to a (normalized) discount factor. We now compare this compounded elasticity
with the behavioral response of capital income to a one-period change in the tax rate, that is, a
perturbation of the capital income tax rate in only one period. We show that compounding the
elasticities over a longer horizon can either increase or lower the elasticity that is relevant for
the optimal tax rate, depending on the relative strenghts of the income and substitution effects.
First, observe that the compounded uncompensated elasticity can be written, using the Slutsky
equation, as the sum of the compounded compensated elasticity and the compounded income
effect parameter:

                       S X
                       X S                                  S X
                                                            X S               h                   i
                                   γp β s−p ζ̄zus ,rp   =             γp β s−p ζ̄zcs ,rp + η̄zs ,p .
                       p=2 s=2                              p=2 s=2


The compensated elasticies of capital income are always positive, while the income effect pa-
rameter η̄zs ,p is negative for s ≤ p and positive otherwise. The size of the compounded uncom-
pensated elasticity thus depends on whether the substitution effect dominates the net income
effect of a tax change. The analysis is the most stark if we follow Judd (1985) and assume that
capital is being held only by the agents who have no labor income, and whose utility is then
u(c) = c1−σ /(1 − σ). To simplify calculations, assume further that S = ∞. Computing directly
the compensated elasticities ζ̄zcs ,rp and the income effect parameters η̄zs ,p when after-tax interest
rates are equal to β −1 , we can compare the compounded elasticity to the elasticity of one-time
tax change in period two. For concreteness, we state the following proposition comparing the
effect of an age-independent tax change to a tax change in period two.

Proposition 5. Assume that all the assumptions of this section are satisfied. Then the elasticity
of capital income with respect to a change in the capital income tax rate in period two only,
satisfies


                 ∞ X
                 X ∞                              ∞
                                                  X
                           β s−1 ζ̄zus ,rp   ≥          β s−1 ζ̄zus ,r2 ,   if σ ≤ 1,
                 p=2 s=2                          s=2
                 X∞ X ∞                           X∞
                           β s−1 ζ̄zus ,rp   <          β s−1 ζ̄zus ,r2 ,   if σ is sufficiently large.   (26)
                 p=2 s=2                          s=2


Proof. See Appendix.

    Proposition 5 shows that compounding the elasticities may either increase or decrease the
effective behavioral effect of capital income depending on the value of the intertemporal elasticity
of substitution σ. Note that with our preferences, we have η̄zs ,p = −σ ζ̄zcs ,rp if s ≤ p. This result
builds on the insights developed by Straub and Werning (2014). One way to see the connection
with their work is to consider a perturbation in capital taxes after some period P and take the


                                                              25
limit as P → ∞. In this case the positive income effects become negligible and we obtain the
result of Proposition 6 in Straub and Werning (2014):
                                                                      
                                       ∞ X
                                         ∞                            ∞,
                                       X                                     if σ < 1,
                       lim β −(P −1)              β s−1 ζ̄zus ,rp   =                            (27)
                      P →∞                                            −∞,   if σ > 1.
                                       p=P s=2


Straub and Werning (2014) then use this insight to provide an intuition for their results that
the optimal capital tax rate converges to zero in the long run steady state only if σ < 1 and
that they remain positive and may even converge to infinity for σ ≥ 1. Proposition 5 shows that
the mechanisms they emphasize continue to operate for age-independent taxes even in the short
run.

5.3   Optimal Non-Linear Labor Income Taxation
As a third application of our theory, consider the static model of optimal income taxation
analyzed by Mirrlees (1971). Suppose that S = 1, there is no capital income and the individual
utility is given by u(c, y/θ). We derived in equation (18) the optimal non-linear labor income
tax schedule T (y). We can rewrite this formula as:

                                                            T 0 (y)
                                                                                   
                 0 =Ey≥ŷ [1 − g] − Ey≥ŷ                                      η (y)
                                                                 c (y) T 00 (y) y
                                                1 − T 0 (y) + yζy,w
                                                                                                 (28)
                                               T 0 (ŷ)              c          ŷf (ŷ)
                                  −      0           c        00
                                                                    ζy,w (ŷ)            ,
                                    1 − T (ŷ) + ŷζy,w (ŷ) T (ŷ)           1 − F (ŷ)

Equation (28) is the formula obtained by Saez (2001). It formalizes his heuristic arguments that
the optimal marginal tax rate on labor income ŷ is driven by three forces: (i ) the compensated
                             c                                   ŷf (ŷ)
elasticity of labor income ζy,w  and the hazard rate Hy (ŷ) ≡ 1−F    (ŷ) of the labor income distri-
bution, which measure the distortions induced by the marginal tax rate at the income level ŷ;
(ii ) the average income effect parameter ηy for incomes above ŷ, which measure the behavioral
effects of increased average taxes on those incomes; and (iii ) the value of redistributing income
away from individuals above ŷ, captured by Ey≥ŷ (1 − g).
     We now discuss the connection between the formula obtained by Diamond (1975) in the
Ramsey setting and that obtained by Saez (2001) in the Mirrlees setting. Formula (16) implies
that the optimal linear tax schedule in the static model satisfies
                                               
                                            y        τy
                            0 =Ey≥0 1 −        g −        ζ̄ u
                                            ȳ     1 − τy y,w
                                                                                               (29)
                                            y        τy           τy
                              =Ey≥0 1 −        g −        η̄y −       ζ̄ c ,
                                            ȳ     1 − τy       1 − τy y,w

where τy ≡ T 0 (y), and where the second line follows from the Slutsky equations ζy,wu (y) =

 c (y) + η (y) for all y ≥ 0. (Recall that ζ c (y) > 0 and η (y) < 0, so that the substitution
ζy,w      y                                 y,w             y




                                                       26
effect of taxes tends to decrease tax revenue, while the income effects tend to increase it.)
Formula (29) closely resembles the full optimum (28), with one key difference. The linear
optimum cannot do better than balancing the mechanical effect of the perturbation with an
average measure ζ̄y,wu   of uncompensated elasticities ζy,wu (y) over the entire population y ≥ 0,

while the non-linear optimum (28) is able to disentangle the competing income and substitution
components ζy,wc (y) , η (y) of the individual elasticity, and to allocate both effects to different
                         y
segments of the population (cf. the discussion in Section 4 following Proposition 3). Specifically,
a planner that can use non-linear tax instruments is able to better fine-tune the distortions in
the population, by imposing a higher marginal tax rate to the incomes y = ŷ where there is
either a small fraction of individuals relative to those who pay the additional lump-sum tax
(the hazard rate Hy (ŷ) is small), or where the behavioral response ζy,w c (ŷ) (resp., η (ŷ)) to the
                                                                                          y
increase in the marginal tax rate (resp., the total liability) is small (resp., large). We make this
general principle of taxation more precise in the context of tax reforms in Section 6, where we
show the tight connection between the linear and non-linear tax reforms when the baseline tax
system is linear.
    Equation (28) finally allows us to obtain asymptotic tax rates. Suppose that Ey≥ŷ g, ζy,w  c (ŷ),
                                                                c,(∞)  (∞)        (∞)
ηy (ŷ), and Hy (ŷ) converge to the respective limits g (∞) , ζy,w , ηy , and Hy as ŷ → ∞, and
suppose moreover that ŷT 00 (ŷ) → 0 as ŷ → ∞. We then obtain the top marginal tax rates as:

                                      T 0 (ŷ)          1 − g (∞)
                                lim              =                    .                           (30)
                               ŷ→∞ 1 − T 0 (ŷ)    c,(∞) (∞)
                                                   ζy,w Hy + ηy
                                                                  (∞)


This expression is derived formally by Saez (2001b).

5.4   Optimal Non-linear Labor and Capital Income Taxation
The previous sections showed that the benefit of increasing the sophistication of the tax instru-
ments in a static model come from the ability to spread the distortions within the population.
In this section we extend this insight to dynamic settings. Moreover, we use this example to
illustrate how our techniques can be applied to problems for which it is hard to obtain analytical
results using standard techniques.
    We consider a simplified version of the economy considered by Conesa, Kitao and Krueger
(2009). These authors study a tax system that is separable and non-linear in capital and labor
income. Analyzing such taxes is difficult with either the traditional Ramsey approach (due to
the non-linearity in labor taxes) or with the mechanism design techniques (due to the lack of
explicit informational microfoundations for this tax schedule). For this reason Conesa, Kitao
and Krueger (2009) additionally impose parametric restrictions on tax functions and numerically
optimize over those parameters in a sophisticated computational model. We show how this
problem can be handled using our approach.
    Suppose that S = 2 and the utility function has no income effects, as defined in (24). We



                                                  27
are interested in deriving properties of the optimal taxes that are separable, age-dependent, and
non-linear, so that the tax system consists of a non-linear labor income tax schedule Ty,1 (y1 )
in period one, and of separable non-linear labor and capital tax schedules Ty,2 (y2 ) + Tz,2 (z2 ) in
period two.
    We start by applying our general formulas (12) and (15) to the tax schedule on labor income
in period s ∈ {1, 2}, restricting the tax system to be separable between the various incomes. We
obtain that the optimal labor income tax rate in period s at the income level ŷs is given by
                                                         0 (ŷ )
                                                       Ty,s     s                                        ŷs f (ŷs )
            0 =Eys ≥ŷs [1 − gs ] −         0                c              00
                                                                                       ζ̄yc,(y s =ŷs )
                                                                                           s ,ws
                                      1 − Ty,s (ŷs ) − ŷs ζys ,ws (ŷs ) Ty,s (ŷs )                  1 − F (ŷs )
                                                     "
                                                                       0
                                                                                                         #                  (31)
                                        2−s
                                                                     Tz,2 (z)
                                    − β Eys ≥ŷs               0 (z) − zζ c            00         η̂z2 ,s ,
                                                       1 − Tz,2               z2 ,r2 Tz,2 (z)

                                                    0 (z) η
                                                         
where η̂z2 ,s = ηz2 ,2 if s = 2, and η̂z2 ,s = 1 − Tz,2     z2 ,1 if s = 1. Since we assume that there
are no income effects on labor supply, the first line of this expression is simply a dynamic version
of (28). Note that only the own-price elasticities of labor income play a role: the cross-price
elasticities of labor income and the compensated elasticities of capital income with respect to the
labor income tax rate are equal to zero because there are no income effects and the baseline tax
system is separable. However, the second line of (31) shows that in the dynamic environment,
additional considerations play a role in the determination of the optimal labor income tax rates
in either period. Higher labor taxes in period two increase incentives to save, captured by ηz2 ,2 ,
and hence affect revenue from capital income taxes. If the optimal marginal tax rate on capital
income is positive, this increases government revenue and creates a force to increase the labor
income taxes in period two, relative to the static model. The opposite effect holds for labor
income taxes in period one.
    Next, we apply formulas (12) and (15) to the tax schedule on capital income in period two.
We obtain that the optimal capital income tax rate at the income level ẑ is characterized by
                                    "                                                                                   #
                                              0 (ẑ)
                                            Tz,2                      c                    ẑfx (y1 , y2 , ẑ)
     0 =Ez≥ẑ [1 − g2 ] − Ez=ẑ        0 (ẑ) − ẑζ c        00 (ẑ) ζz2 ,r2 (y1 , y2 , ẑ) 1 − F (ẑ)
                                  1 − Tz,2                 T
                                                   z2 ,r2 z,2                                      z2
                                "                                           #                                               (32)
                                              0
                                            Tz,2 (z)
                        − Ez≥ẑ        0 (z) − zζ c          00      ηz2 ,2 .
                                  1 − Tz,2          z2 ,r2 Tz,2 (z)


The expectation operator in the second term of equation (32) appears because the elasticity
ζzc2 ,r2 may be different for agents with a given value of capital income z2 = ẑ, if they have
different labor incomes y1 and y2 . If the utility function is CARA, then the elasticities in the
integrals
        h do not idepend on labor income and (32) is then conceptually identical to (28), since
                                                                   ẑf (ẑ)
Ez=ẑ ẑf1−F
          x (y1 ,y2 ,ẑ)
              z2 (ẑ)
                         is equal to the hazard rate Hz2 (ẑ2 ) = 1−Fz2z (ẑ) ; the only differences are that
                                                                        2
the relevant elasticity and income distribution are those of capital income (there are no effects
on labor income because of the functional form of the utility function and the separability of


                                                             28
the tax system). Therefore, formula (32) illustrates that the same general mechanisms that
determine optimal labor income taxation also determine optimal capital income taxation. As
in the case of labor income taxes, the size and the shape of the capital income tax schedule
are determined by the hazard rates of the capital income distribution, and by the income and
substitution effects of capital income in response to changes in the capital income tax rates.
    The asymptotic marginal tax rate on capital income is given by the analogue of (30),
                                                0                                 (∞)
                                              T2,z (ẑ)                   1 − g2
                                     lim            0       =    c,(∞)      (∞)           (∞)
                                                                                                .
                                     ẑ→∞   1 − T2,z (ẑ)       ζz2 ,r2 Hz2        − ηz2 ,2

It can be futher shown (see Appendix) that if mobility at the top of the capital income distri-
bution converges to zero, the same formula continues to apply for the top marginal tax rates in
arbitrary S period economies. If, in addition, the capital income tax schedule Tz is restricted
to be age-independent, all the parameters are replaced with their compounded analogues along
the lines of the analysis in Section 5.2.

5.5     Optimal Joint Taxation
We now apply our theory to the analysis of the optimal non-separable, non-linear tax system.
We illustrate this approach in a simple static framework of optimal taxation of couples. We
assume that the household maximizes the total surplus, i.e., the total consumption minus the
sum of disutilities of labor. Both individuals choose their labor supply on the intensive margin.23
The couple’s preferences over consumption and labor income are given by
                                                                    1+1/ζ                                 1+1/ζ !
                                                1               y1                 1                    y2
                   max           u c1 + c2 −                                  −                                         ,
                c1 ,c2 ,y1 ,y2               1 + 1/ζ            θ1              1 + 1/ζ                 θ2

and its budget constraint is
                                           c1 + c2 = y1 + y2 − T (y1 , y2 ) .

In the Appendix, we show by applying formula (19) to this environment that the optimal tax
system is characterized by the following partial differential equation: for all θ = (θ1 , θ2 ) ∈ R2+ ,

                                    2 2
                                                                      (     τ1    ∂yθ,1        τ2 ∂yθ,2
                                                                                                                            )
                                 ζ X X ∂y−i ∂                             1−τi     ∂θi    +   1−τi ∂θi
       0 = (1 − g (θ)) fθ (θ) +                                           ∂yθ,1   ∂yθ,2       ∂yθ,1 ∂yθ,2
                                                                                                               θi fθ (θ) ,      (33)
                                1+ζ     ∂θ−j ∂θj                                          −
                                            i=1 j=1                        ∂θ1     ∂θ2         ∂θ2 ∂θ1

                                                                ∂y
where the components of the Jacobian matrix ∂θθ,i  j
                                                      evaluated at the type θ can be easily ex-
pressed explicitly as a function of the tax rates (see Appendix for details), so that (33) gives
a complete characterization of the optimal tax rates given the exogenous distribution of types
  23
    Saez, Kleven, and Kreiner (2009) characterize the optimal joint tax system in the case where the secondary
earner chooses labor supply on the participation margin only.




                                                            29
(θ1 , θ2 ). Formula (33) is useful because it allows us to reduce the problem of finding the optimal
joint tax system in the economy as the solution to a PDE which can be computed numerically,
without the need to solve for a complicated individual optimization problem. Note finally that
this PDE generalizes to the two-dimensional environment the differential equation obtained in
the static model of individual-based taxation of Mirrlees (1971), that is
                                                                               
                                                    d             τ   ζ
                           0 = (1 − g (θ)) fθ (θ) +                      θfθ (θ)
                                                    dθ           1−τ 1+ζ

which can be easily solved analytically to obtain the optimal tax rates of Diamond (1998).


6        Applications to Tax Reforms
In this section we use the tools developed in Section 4 to analyze the welfare gains of (small)
reforms of the existing tax system. Computing such welfare gains is considerably simpler than
solving for the optimal taxes as in Section 5. Finding the optimum requires either solving a
partial differential equation (19) using explicit assumptions on the form of the utility function or
applying equations derived in Proposition 3 with some assumptions on the values of the relevant
elasticities at the optimal system.24 On the other hand, the welfare effects of reforming the
existing system depend on the labor and capital income elasticties that can be readily estimated
empirically under the current tax system. Once these elasticities are known, the welfare gains
can be computed directly using Proposition 2 without solving differential equations.
     In this section we illustrate an application of this approach by considering a simple version of
a lifecycle model. We assume that individuals live for S periods and have Greenwood, Hercowitz
and Huffman (1988) preferences

                                    S                         
                                 1 X s−1          1      1+1/ζs 1−σ
                                      β   cs −         l            .
                                1−σ            1 + 1/ζs s
                                       s=1

Note that we allow the elasticity of labor supply ζs to depend on age. We assume that the
baseline tax system does not depend on the age of the individual and is separable between labor
and capital incomes within and across time periods. We assume that capital income is taxed at
a constant rate τz , while labor income y is taxed non-lineary with a tax function T (·):

                                Ts (x) = T (ys ) + τz zs , for all s = 1, ..., S.                             (34)

Individuals are heterogeneous in their initial capital stock k0 and face the same after-tax in-
terest rate equal to β −1 . The individuals are also heterogeneous in labor productivity θs (so
    24
    For example, the “sufficient statistics” literature (see, e.g. Chetty 2009) takes the latter approach and often
assumes that elasticities evaluated at the current tax system provide a good approximation to the elasticities at
the optimal tax schedule.




                                                        30
that labor income is ys = θs ls ) and this productivity may change over time. We choose this
specification both because it allows us to illustrate the main effects transparently, and because
these assumptions on preferences and taxes are often used in applied work on optimal taxation.
It is straightforward to extend our methods to other specifications of taxes and preferences.

6.1    Separable Income Taxation
Our baseline system is separable between capital and labor taxes and in this section we consider
only tax reforms that preserve this separability. We start with capital taxation. Recall from our
discussion in Section 5.1 that the Gateaux differential of social welfare δW (T , hL ) with respect
an age-independent linear perturbation of the capital tax rate, hL (z) ≡ z, can be written as

                                             S                                              
                                             X               zp             τz    c  τz
                   δW (T , hL ) =                  γp       E [1 − gp ] −       ζ̊ −      η̊p .
                                                             z̄p          1 − τz p 1 − τz
                                             p=1


This derivative represents the monetary value of the welfare gain (or loss, if it is negative) of
a small increase in the tax rate on capital. This formula can be used directly with empirical
estimates of the population-average elasticities ζ̊pc and η̊p to compute the gains from changes in
the tax rates.
    We can extend this analysis to quantify the gains of introducing non-linear capital taxes.25
Specifically we design perturbations that isolate the effect of increasing the capital income tax
rate only at the income level ẑ. We choose the numbers ẑ > 0, ẑ 0 > ẑ and define the period-
p perturbation hp as hp (z) = (z − ẑ) on [ẑ, ẑ 0 ], and hp (z) = (ẑ 0 − ẑ) on [ẑ 0 , ∞) for all p ∈
{1, . . . , S}. As described in Section 2 (details in the Appendix), we appropriately smooth out
the kinks that this perturbation generates at the points ẑ and ẑ 0 . We finally define a sequence
 hp n∈N of such perturbations, with (ẑ 0 − ẑ) → 0. At each point in the sequence, we compute
 n

the Gateaux differential of social welfare in that direction and focus on the limit as n → ∞ and
hence hnp → 0.
    This pertubation increases the marginal taxes on capital income in a small neighborhood of ẑ
and the average taxes on all capital incomes above ẑ. We evaluate the welfare gains normalized
by the fraction of agents affected by perturbation, which we define as:
                                                            −1
                                         limn→∞ Sp=1 hnp       δW T , hnp
                                                P                         
                                Γ (ẑ) =     PS                             .
                                                     p−1 (1 − F
                                               p=1 β           z,p (ẑ))


Applying our general formula (12) yields the following welfare effect:

                          S                                                                    
                                                                  τz     c ẑfzp (ẑ)   τz
                          X
               Γ (ẑ) =         γp,ẑ       Ezp ≥ẑ [1 − gp ] −       ζ̊              −      η̊p ,    (35)
                                                                1 − τz p 1 − Fzp (ẑ) 1 − τz
                          p=1
  25
    A number of authors proposed non-linear, often progressive taxation of capital, e.g., Farhi and Werning
(2010).



                                                                 31
where the weights, compounded compensated elasticity and compounded income effect are re-
spectively defined by:

                                                          S                                        S
                    β p−1 (1 − Fp,z (ẑ))             X           c,(z =ẑ)
                                                                                      X           (z ≥ẑ)
          γp,ẑ = PS                         , ζ̊pc =     β s−p ζ̄zs ,rpp , and η̊p =     β s−p η̄zsp,p .
                         s−1 (1 − Fz,s (ẑ))
                   s=1 β                              s=2                             s=2

       We make several observations about this expression. First, we show in the Appendix that
                                                              ˆ      ∞
                                           δW (T , hL ) =                Γ (ẑ) dẑ.                                 (36)
                                                                 0

This equation states that the sum of the welfare gains from increases in the marginal tax rates
at every given level of capital income ẑ is equal to the welfare gain from a linear increase in
marginal taxes on all incomes. As long as the function Γ is not constant with income, i.e.,
increasing tax rates at ẑ yields different gains than doing so at ẑ 0 , non-linear capital taxes lead
to higher welfare. Welfare gains are achieved by lowering tax rates at those levels of capital
income for which Γ (ẑ) is negative and increasing them at levels of capital incomme for which
Γ (ẑ) is positive. Bigger changes in tax rates are typically desirable for those ẑ that have the
largest values of |Γ (ẑ)|.
     We now explore which factors affect the variablility of Γ (·) in ẑ. There are three terms in the
expression for Γ that capture (i ) the welfare gains and losses from redistribution, Ezp ≥ẑ [1 − gp ];
                                                                                       ẑfz (ẑ)
(ii ) the behavioral effects due to higher marginal tax rates, ζ̊pc 1−Fpz (ẑ) ; and (iii ) the behavioral
                                                                          p
effects due to higher average tax rates, η̊p . The behavioral effects can be measured empirically
or deduced theoretically from the assumed functional form of the utility function. In general,
if the government is redistributive, Ezp ≥ẑ [1 − gp ] is increasing in ẑ. If at the top of the wealth
distribution individuals do not earn any labor income, then the elasticity ζ̊pc is constant and
equal to σ −1 ,26 and the functional form for the utility function implies that η̊p is independent
of ẑ. The last component in equation (35) that depends on ẑ is the hazard rate of the capital
                                                ẑfz (ẑ)
income (or wealth) distribution Hz,p (ẑ) ≡ 1−Fpz (ẑ) . If this hazard rate has a weakly decreasing
                                                     p
tail for all high enough ẑ, then we obtain that Γ is increasing in ẑ. In this case the same increase
in the marginal tax rate generates larger welfare benefits if applied to higher levels of income.
This suggests that progressive capital taxation is desirable for high levels of capital income.
     The conclusion about the desirability of progressive capital tax reform is sensitive to as-
sumptions about the hazard rate of the distribution of capital income Fz and the behavior of
  26
       More generally, with labor income we can show that the elasticity of capital depends on ẑ through:
                                                         "                    #
                                                                1+1/ζ
                                       c,(zp =ẑ )  1 −1       lp
                                     ζ̄zs ,rp      ∝ σ E cp −         |zp = ẑ .
                                                    ẑ        1 + 1/ζ

If labor income is equal to zero, then assuming that the average capital income in period (p + 1) among individuals
with period-p capital income ẑ is exactly ẑ, i.e., E [zp+1 |zp = ẑ ] = ẑ, it is easy to show (writing cp = Rkp−1 − kp )
       c,(zp =ẑ )
that ζ̄zs ,rp      is a constant independent of ẑ and ζ̊pc = σ −1 .




                                                            32
the elasticity of capital income ζ̊pc as a function of ẑ. For example, if we assume that Fz is
Pareto-log-normal rather than Pareto after a given finite threshold, then the hazard rate Hp,z
is increasing at the tail and for a wide range of parameters it is possible to show that ζ̊pc Hz,p (ẑ)
is increasing. In this case whether Γ increases or decreases in the right tail depends on the rela-
tive strenths of the redistributive versus behavioral effects. The behavioral effect, which favors
regressive reforms in this case, dominates if the government is very redistributive and assigns
low weights to individuals with a lot of wealth. For example, if the government is Rawlsian or,
more generally, assigns Pareto weights 0 to all agents above a certain wealth threshold, then
Ezp ≥ẑ [1 − gp ] = 1 for all ẑ sufficiently high. In this case Γ is a decreasing function in the right
tail.27 To illustrate the quantitative gains from higher marginal taxes for high income, assume
that initial capital distribution has a Pareto tail with coefficient 1.5 and that capital income
tax rates in the baseline system are 50%.28 Then in the limit as ẑ → ∞ the welfare gains from
increasing marginal rates are equal to 1 − 1.5σ −1 . Therefore they are positive if the elasticity of
the intertemporal substitution is less than 2/3.
     Analogous arguments apply to reforms of labor income taxation. Welfare gains from increas-
ing marginal taxes at income level ŷ are given by

           S                 S
                                                                           T 0 (ŷ) ζp
                                                                                                                       
           X                 X                                                                     ŷfyp (ŷ)   τz
Γ (ŷ) =         Γp (ŷ) ≡         γp,ŷ       Eyp ≥ŷ [1 − gp ] −                                            −      η̊p ,
                                                                   1 − T 0 (ŷ) + ŷζp T 00 (ŷ) 1 − Fyp (ŷ) 1 − τz
           p=1               p=1
                                                                                                           (37)
which shows the same three forces that we discussed in capital income taxation. As in the case
of capital taxation, variability of Γ in ŷ determines the welfare gains from non-linear tax reform.
A useful benchark to consider is the one in which the baseline labor income taxes are linear,
individual productivity is constant, and the government is highly redistributive, e.g. Ralwsian.
                               T 0 (ŷ)ζ
In this case, the terms 1−T 0 (ŷ)+ŷζpp T 00 (ŷ) and η̊p are constant and Eyp ≥ŷ [1 − gp ] is equal to 1 for
                                                                                                                   ŷf (ŷ)
almost all ŷ. In this case the shape of the gains Γ is determined by the shape of Hy (ŷ) ≡ 1−Fyy (ŷ) .
If the hazard rate of labor income is inversely U-shaped, as documented for example by Saez
(2001) for the U.S., then the benefits from increasing marginal tax rates are U-shaped.
    We can use equation (37) to illustrate the sources of gains from switching from age-independent
to age-dependent taxation. In particular, Γp (ŷ) measures the welfare gains from changing tax
rates only for individuals of age p who earn income ŷ. The total gain Γ (ŷ) is equal to the sum
of the age-dependent gains, Γp (ŷ). The more Γp varies in p, the larger the gain are from age-
dependent labor taxation. We can thus use expressioon (37) to illustrate some recent arguments
in favor of age-dependent taxation. Kremer (1999) argued for age-dependent labor taxation on
  27
     We are not aware of any empirical work that systematically documents empirical properties of the hazard rate
Hz,p (ẑ) of capital income. Saez (2001) used the IRS tax return data to study the hazard rate for wage income
and showed that that it exhibits an inverse U-shaped pattern.
  28
     The numbers are chosen to capture some stylized facts about distribution of income and tax rates in the U.S.
Nirei and Souma (2007) estimate the Pareto tail of wealth distribution in the U.S. to be 1.5, while Saez estimates
the Pareto tail of labor income (wages) to be 2 around 2. Prante and John (2013) argue that top effective marginal
tax rates in the U.S. for both labor and interest income are about 50%.



                                                                 33
the ground that the labor supply elasticity ζp varies systematically with age p, while Weinzierl
(2011) explored variation in the age-dependent distribution of income, that can be summarized
                ŷfy (ŷ)
by Hy,p (ŷ) ≡ 1−Fpy (ŷ) . The quantitative magnitude of this variation can be calculated directly
                     p
using (37). This formula also shows that, as long as the capital income tax rate is not zero,
the age-dependent income effect of savings η̊p introduces an additional source of variability in
welfare gains, as discussed in Section 5.4. In our economy it is easy to show that

                                                           βS
                                                                  
                               1                     1
                                    η̊p = βr            −       S−p .
                             1 − τz                1 − β 1 − βS

To give a sense of the magnitude of these numbers, we suppose that S = 40, β = 0.97, and
τz = 50% and calculate that the behavioral effects on savings from higher labor income taxes at
age p increase revenue by:
                                         
                                         
                                         
                                         −0.47 if p = 1 (age 21),
                               τz        
                           −        η̊p = 0.10     if p = 20 (age 40),
                             1 − τz      
                                         
                                         0.70
                                         
                                                   if p = 40 (age 60).

This indicates that, all else being equal, positive taxation of savings favors higher labor taxes
later in life. Note that these numbers are substantial, reaching an additional benefit of ¢73 per
dollar increase in the statutory tax liability.

6.2   Joint Income Taxation
The baseline tax system (34) is initially separable between incomes, both across periods (there is
no history-dependence) and within periods (labor and capital incomes are not jointly taxed). In
this section, we characterize the welfare gains from introducing joint taxation. That is, we allow
taxes on income xi to depend not only on the level of xi , but also on the levels of other incomes
xj . Such taxes arise in several different contexts. In the U.S., many social insurance programs
and the Social Security system condition their payments both on current labor earnings and
on the history of past earnings. Some programs are also often asset-tested, i.e., individuals are
eligible to participate if their labor earnings are low and their assets are below a certain treshold.
Finally, the individual tax bill depends jointly on income from labor and capital.
     The non-separable tax reforms that we consider consist of increasing the marginal tax rate
on income xi at the level x̂i (hence the average tax rates increase on xi ≥ x̂i ) conditional on
earning more than the threshold x̂j of income xj , i.e., xj ≥ x̂j . Since we consider perturbations
that leave the tax function continuous, this reform also raises marginal tax rates on income xj
at level x̂j , conditional on xi ≥ x̂i . This joint pertubation is shown in Figure 2, where the dark
(resp., light) surface represents the baseline (resp., perturbed) tax function.
     We showed in the previous sections that the welfare effects of separable perturbations are



                                                    34
                                        Figure 2: Joint Perturbations




determined by the fraction of individuals above the base of the perturbation relative to the
fraction at the base, summarized by the hazard rate Hxi of the distribution of income xi . The
generalization of the hazard rate to two dimensions of income (xi , xj ) is captured by
                                                       ´∞
                                                    x̂i x̂j fxi ,xj (x̂i , xj ) dxj
                           Hxi ,xj (x̂i |x̂j ) ≡ ´ ∞ ´ ∞                             .
                                                  x̂i x̂j fxi ,xj (xi , xj ) dxi dxj


The denominator is the fraction of agents who face an increase in their average tax liability. The
numerator is the fraction of agents who face an increase in their marginal tax rate on income
xi , scaled by the income threshold x̂i .
     We first consider introducing joint taxation of labor income across periods, i.e., history-
dependence. That is, we increase the marginal tax rate on labor income ŷp in period p conditional
on yp−1 ≥ ŷp−1 . The welfare gain of this tax reform is given by

                                                        τz
              Γŷp ,ŷp−1 =Eyp−1 ≥ŷp−1 [1 − gp ] −          η̊p
                              yp ≥ŷp                 1 − τz
                                     T 0 (ŷp ) ζp
                          −                                  Hy ,y (ŷp |ŷp−1 )                (38)
                            1 − T 0 (ŷp ) + ŷp ζT 00 (ŷp ) p−1 p
                                           T 0 (ŷp−1 ) ζp−1
                          −                                             Hy ,y (ŷp−1 |ŷp ) .
                            1 − T 0 (ŷp−1 ) + ŷp−1 βζp−1 T 00 (ŷp−1 ) p−1 p

The first three terms of expression (38) are the analogue of the period-p age-dependent pertur-
bation of the labor income tax rates discussed in Section 6.1, the main difference being that now
the region over which the individual effects of the perturbation are summed is further restricted
to the households earning more than ŷp−1 in period (p − 1). The last term is a novel term that
appears because this perturbation distorts the labor supply decisions around the ŷp−1 treshold



                                                       35
in period (p − 1).
    The benefits of the joint pertubation come from two sources. First, by conditioning redistri-
bution on past income, the government can better target its redistributive effort, as summarized
in the term Eyp−1 ≥ŷp−1 ,yp ≥ŷp [1 − gp ]. Conditional on a given level of earnings yp in period p,
society generally values differently the welfare of households who have a different history of
labor earnings in the previous periods. History-dependence in taxation allows the government
to tailor taxes to those social preferences. Second, conditioning taxes on past earnings allows
the government to raise more tax revenue with less distortions.
    To illustrate the latter effect, suppose that for all p, the marginal distribution of income yp
has a Pareto tail with coefficient ap , so that for high ŷp we have

                                               P (yp ≥ ŷp ) = cp · (ŷp )−ap .

Furthermore, assume that joint distribution of yp−1 and yp at the tails can be summarized by
the (survival) Clayton copula29
                                                                                            −ρ
                P (yp−1 ≥ ŷp−1 , yp ≥ ŷp ) = [P (yp−1 ≥ ŷp−1 )]−ρ + [P (yp ≥ ŷp )]−ρ − 1                    (39)

for ρ > 0. The limit as ρ → 0 represents the case where yp and yp−1 are comonotone (in
particular, perfectly correlated), that is, all the agents with a given income in period p − 1 also
earn the same income in period p. The limit as ρ → ∞ represents the case where labor earnings
in the two periods are drawn independently from each other. In this case the conditional hazard
rates are given by

                                                               ap [P (yp ≥ ŷp )]−1/ρ
                   Hyp−1 ,yp (ŷp |ŷp−1 ) =                                                        .
                                                [P (yp ≥ ŷp )]−1/ρ + [P (yp−1 ≥ ŷp−1 )]−1/ρ − 1

Suppose that the Pareto coefficient ap and the elasticity of labor supply ζp are independent
of age p, that there are no savings (or that τ = 0), and that the baseline labor income taxes
are chosen to maximize tax revenue collected from the agents with sufficiently high earnings.
Under these assumptions, using the analysis of Section 5, the marginal tax rates on high incomes
are constant and satisfy T 0 (y) / (1 − T 0 (y)) = (aζ)−1 . In this case the joint perturbation for
sufficiently high labor incomes in both periods yields a revenue effect equal to

                                                  [P (yp−1 ≥ ŷp−1 )]−1/ρ + [P (yp ≥ ŷp )]−1/ρ
                   Γŷp ,ŷp−1 = 1 − (aζ)−1                                                         .
                                                [P (yp−1 ≥ ŷp−1 )]−1/ρ + [P (yp ≥ ŷp )]−1/ρ − 1

This expression implies that Γŷp ,ŷp−1 < 0 for all ρ, which implies that the separable tax system is
not optimal. Specifically, a joint perturbation that decreases the marginal tax rates on incomes
ŷp−1 and ŷp , and hence reduces the average tax rates for individuals with incomes yp−1 ≥ ŷp−1
 29
      This joint distribution is a generalization of the bivariate Pareto distribution, obtained for ap = ap−1 = ρ.



                                                             36
in period p − 1 and yp ≥ ŷp in period p, jointly allows to raise additional revenue, starting from
the optimal separable tax schedule. Note also that Γŷp ,ŷp−1 → 0 and as ρ → 0, so that the gains
from history-dependence disappear if each agent’s income is the same in both periods.
    The arguments above can be generalized to other forms of joint taxation. For example, the
welfare effects of jointly taxing labor and capital incomes within period p at the joint income
threshold (ŷp , ẑp ) are given by

                                                      τ
                   Γŷp ,ẑp =Eyp ≥ŷp [1 − gp ] −       η̊p
                               zp ≥ẑp               1−τ
                                         T 0 (ŷp ) ζ
                             −                                  Hy ,y (ŷp |ẑp )                       (40)
                               1 − T 0 (ŷp ) + ŷp ζT 00 (ŷp ) p−1 p
                                       ( S                                  )
                                 τz       X
                                                  s−p c,(zp =ẑp ,yp ≥ŷp )
                             −                  β ζ̄zs ,rp                    Hyp−1 ,yp (ẑp |ŷp ) ,
                               1 − τz
                                            s=2

where ζzcs ,rp is the elasticity of period-s capital income with respect to the period-p net-of-
tax rateon capital income. Formula (40) is formally similar to equation (38), the relevant
conditional hazard rates in this case being those of the joint distribution of labor and capital
incomes, and the relevant elasticities being those of capital income with the usual compounding
effect discussed in Sections 5.2 and 6.1. Note that these elasticities are in general different for
individuals with different labor and capital incomes, and are therefore averaged over the region
where the capital income tax rate is perturbed. More generally, for different preferences or a
non-separable baseline income tax system, the elasticity parameters ζ̄ycs ,wp , ζ̄zcs ,rp , ηzs ,p would all
depend on the individuals’ earnings histories, implying an additional source of benefits from
using a non-separable tax system: the government can impose higher distortions in the regions
where these elasticities are smaller, with an additional degree of “fine-tuning” relative to the
separable case.


7    Overview of the Stochastic Model
In this section we briefly discuss the derivation of some of the results in the stochastic model.
We only give an outline of the derivation here, the details are collected in our companion paper
(Golosov, Tsyvinski, and Werquin 2014). For the clarity of the exposition, we consider the case
where the horizon is T = 2 periods, but our results generalize to the case T ≤ ∞. In period one,
an individual knows his first-period type, or productivity, θ1 ∈ [0, ∞), and his initial capital
stock k0 ∈ R. He then chooses his first-period consumption c1 ≥ 0, labor income y1 ≥ 0, and
savings or borrowings k1 ∈ R to carry over to period two (yielding capital income z2 ∈ R in
period two). For simplicity assume that the interest rate is the same for all individuals, so that
capital income z2 is known with certainty in period one given savings k1 . In period two, he draws
his second-period productivity θ2 ∈ [0, ∞). For all θ1 ∈ R+ , the second-period type θ2 is drawn
from an exogenous distribution Fθ2 |θ1 (·) whose density fθ2 |θ1 (·) is strictly positive on R+ . The


                                                         37
individual then chooses his second-period consumption c2 ≥ 0 and labor income y2 ≥ 0. Given
his initial draw (k0 , θ1 ), he thus chooses his first-period labor income and savings y1 (k0 , θ1 ),
k1 (k0 , θ1 ), and a set of second-period incomes contingent on the second-period productivity
{y2 (k0 , θ1 , θ2 ) : θ2 ∈ R+ } in order to maximize the expected discounted value of his utility. The
income vector x of an individual with initial capital and productivity (k0 , θ1 ) thus has a two
plus a continuum of rows, corresponding to the continuum of possible draws of θ2 in period two.
     In each period s = 1, 2, the government levies a tax Ts . The first-period tax function T1 is
a function of the individual’s first-period labor income y1 and capital k1 only. (The government
cannot tax second-period labor income y2 in period one, as y2 depends on the value of θ2 that the
individual will draw in period two, and hence is not known in period one.) The second-period
tax function T2 is a function of the individual’s entire history of labor incomes {y1 , y2 } and
capital income z2 . The assumptions about the tax functions are identical to those we made in
the deterministic model. Social welfare is then a weighted sum of individuals’ expected indirect
utilities U (k0 , θ1 ).
     It is important to note that there are many more marginal tax rates and virtual incomes
that are relevant for the individual than in the deterministic model. Since θ2 , and hence y2 and
T2 (·, ·, ·), are unknown when y1 and k1 are chosen, the two decision variables (y1 , k1 ) depend
on the set of all possible marginal tax rates and virtual incomes that the individual may end
up facing in period two, depending on his type θ2 . Thus, y1 and k1 depend on the whole set
   τ2 y1 , x22 , z2 , R2 y1 , x22 , z2 : x22 ∈ R+ , parametrized by the possible values x22 of second-
                                    

period incomes that the individual may end up choosing in period two. Moreover, even though
y2 is chosen after a value of θ2 has been drawn (say θ2∗ ), y2 (θ2∗ ) does not depend only on the
marginal tax rate and virtual income that he ends up actually facing (i.e., τ2 (y1 , y2 (θ2∗ ) , z2 )),
unless the utility function has no income effects. This is because y1 and k1 , which have been
chosen before the draw (taking into account the probabilities of all possible draws of θ2 ), are not
in general the optimal values given this particular draw θ2∗ , and this in turn affects the choice
of y2 (θ2∗ ). We thus obtain that for all θ2∗ ∈ R+ , y2 (θ2∗ ) depends on the entire set of marginal
tax rates and virtual incomes τ2 y1 , x22 , z2 , R2 y1 , x22 , z2 : x22 ∈ R+ . In particular, when
                                                                    

we perturb the tax function in the second period, T2 (·, ·, ·), at a given point x2 = y1 , x22 , z2 ,
                                                                                                        

all the choice variables, (y1 , {y2 (θ2 ) : θ2 ∈ R+ } , z2 ), adjust, even if the individual turns out not
to be affected at all by the perturbation (i.e., even if y2 (θ2∗ ) 6= x22 ). This is the main conceptual
difficulty that needs to be addressed in the stochastic model.
     We first define the elasticities of labor incomes y1 , {y2 (θ2 ) : θ2 ∈ R+ } and savings k1 with
respect to the marginal tax rates on y1 and k1 that the individual actually faces in period one:
τ1,y1 , τ1,k1 . We then define the elasticities of y1 , {y2 (θ2 ) : θ2 ∈ R+ } and k1 with respect to all
the marginal tax rates τ2,y1 x2 , τ2,y2 x2 , τ2,z2 x2 : x2 = y1 , x22 , z2 ∈ R2+ × R that the
                                                                                

individual can possibly face in period two, depending on the possible values x22 of second-period
incomes that the individual may end up choosing in period two. Similarly we first define the
income effect parameters of y1 , {y2 (θ2 ) : θ2 ∈ R+ } and k1 with respect to the individual’s virtual



                                                   38
income in period one, R1 . We then define the income effect parameters of y1 , {y2 (θ2 ) : θ2 ∈ R+ }
and k1 with respect to all the virtual incomes that the individual can possibly face in period
two, R2 x2 : x2 = y1 , x22 , z2 ∈ R2+ × R . We thus need to consider many more elasticities
                              

and income effect parameters than in the deterministic setting. These elasticities (e.g., of labor
income y2 with respect to the marginal tax rate at level y20 6= y2 ) are new to the literature
on taxation. We derive explicit analytical expressions for all these elasticities, as we did in
the deterministic setting. They resemble those in the deterministic setting, except that they
are weighted by the probabilities of earning the second-period income where the tax rate is
perturbed.
    We then go on to derive the behavioral responses to perturbations. The results are proved
in the same way as in the deterministic setting, but the added degree of complexity we just
described makes the derivations more involved both theoretically and conceptually. The formulas
we obtain are accordingly more complex. Remarkably, however, we show that we can define the
elasticity matrices, as well as the gradients and Hessians of the tax functions, in a way that
allows to write the formula in a similar compact way as (8) in the deterministic model (details
are in the Appendix). The proof and intuition of this formula follows the same steps as those
of (8). We show that the change dx in the income vector x following a general perturbation
 dτ1 , dR1 , dτ2 x2 dR2 x2 of the baseline tax system is given by:
                          

                                           ˆ   ∞                                           −1
                E cτ1        2
                                                    E cτ2 (x20 ) (x)   2   20
                                                                                     dx20
                                                                               
  dx =       i−         (x) D T1 (x1 ) −                D T2 x                         2
               h                        0                                                        (41)
                 c
                                            c                  2
                                                                                        2
                                                                                           i
             × E τ1 (x) dτ1 + I R1 (x) dR1 + E τ2 (x2 ) (x) dτ2 x + I R2 (x2 ) (x) dR2 x       .

    As an illustration of these results, we show how the revenue effects of reforming the baseline
tax system of Section 6 write in the stochastic model, when the utility function has no income
effects and is CRRA. A non-linear separable perturbation of the first-period labor income tax
schedule at point ŷ1 yields the following change in government revenue:

                                            T10 (ŷ1 )            ŷ1 fy1 (ŷ1 )      τz    (y ≥ŷ )
               Γ1,y (ŷ1 ) =1 −        0                00      ζ                −β       η̄ 1 1 .     (42)
                                  1 − T1 (ŷ1 ) + ŷ1 ζT1 (ŷ1 ) 1 − Fy1 (ŷ1 )     1 − τz z2 ,R1

Formula (42) shows that the revenue effect of perturbing the first-period labor income tax rate
in the stochastic model is formally similar to the effect in the deterministic model. However, we
show that uncertainty about second-period productivity implies that the income effect parameter
                                                  ∂k1         00 + βR2 E [u00 |θ ] −1 u00 , and hence is
                                                                                   
on savings in the stochastic model is equal to ∂R   1 S
                                                        =   u 1            2     1     1
                                              ∂k1                               −1
                                                      = 1 + β −1/σ R1−1/σ
                                                                              
smaller than in the deterministic model, ∂R     1 D
                                                                                   . This implies that
the gain from decreasing the labor income tax rate in period one is smaller in the stochastic
model than in the deterministic model; the latter thus provides an upper bound for the gains of
age-dependence.
    A non-linear separable perturbation of the second-period labor income tax schedule at point



                                                             39
ŷ2 yields the following change in government revenue:
                                       0 (ŷ )
                                     Ty,2   2                ŷ2 fy2 (ŷ2 ) τz
         Γ2,y (ŷ2 ) =1 −        0 (ŷ ) + ŷ ζT 00 (ŷ ) ζ 1 − F (ŷ ) − 1 − τ η̄z2 ,R2 (y2 ≥ŷ2 ) ,             (43)
                            1 − Ty,2  2      2  y,2 2              y2     2    z


where η̄z2 ,R2 (y2 ≥ŷ2 ) is the aggregate change in capital income in the economy when an additional
dollar is distributed lump-sum in period two, uniformly among all the individuals whose labor
income in period two is above ŷ2 , that is
                                            ˆ    ˆ   ∞ˆ
                                                                   (x1 )       fx1    (y1 , k1 )
                    η̄z2 ,R2 (y2 ≥ŷ2 ) ≡                         ηz         2                   dy1 dx22 dk1 .
                                                                    2 ,R 2( 2) 1 −
                                                                           x          Fy2 (ŷ2 )
                                            R+      ŷ2       R


Note that every individual (with choice vector x1 = (y1 , k1 ) in period one) reacts to this change
                                        (x1 )
by adjusting their savings, i.e. ηz ,R                2   6= 0, because they have positive probability of
                                         2    2 (x1 ,x2 )
earning more that ŷ2 in the second period. However, only those with second-period income ŷ2
under the baseline tax system change their second-period income. Formula (43) shows that the
revenue effect of perturbing the second-period labor income tax rate in the stochastic model is
formally similar to the effect in the deterministic model. However, we show that the savings
effect in the stochastic setting, η̄z2 ,R2 (y2 ≥ŷ2 ) , is strictly larger than in the deterministic setting,
  (y ≥ŷ )
η̄z22,R2 2 . Hence the revenue gains from increasing the labor income tax rates in period two are
smaller in the stochastic model than in the deterministic model.
      A non-linear separable perturbation of the capital income tax schedule at point ẑ2 yields the
following change in government revenue:

                                              τz              ẑ2 fz2 (ẑ2 )   τz   (z ≥ẑ )
                     Γ2,z (ẑ2 ) =1 −             ζ̄ c,(ẑ2 )                −    η̄ 2 2 ,                        (44)
                                            1 − τz z2 ,r2 1 − Fz2 (ẑ2 ) 1 − τz z2 ,R2

        (z ≥ẑ )
where η̄z22,R2 2 is the average income effect parameter of capital income with respect to a certain
increase in period-two virtual income, among individuals with capital income z2 ≥ ẑ2 , that is,
                                                ˆ         ˆ   ∞
                                (z ≥ẑ )                           (x )      fx1 (y1 , k1 )
                              η̄z22,R2 2 ≡                            1
                                                                  ηz2 ,R                    dy1 dk1 .
                                                 R+       ẑ2
                                                                         2   1 − Fz2 (ẑ2 )

Formula (43) shows that the revenue effect of perturbing the second-period labor income tax
rate in the stochastic model is formally similar to the effect in the deterministic model. However,
we show that the savings effect in the stochastic setting, η̄z2 ,R2 (y2 ≥ŷ2 ) , is strictly larger than in
                                 (y ≥ŷ )
the deterministic setting, η̄z22,R2 2 . Hence the revenue gains from increasing the labor income
tax rates in period two are smaller in the stochastic model than in the deterministic model.
However, we show that the average compensated capital income elasticity in the stochastic
         c,(ẑ )
model, ζ̄z2 ,r22 , is positive but smaller than its counterpart in the deterministic model. Similarly,
                                                                       (z )
the average income effect parameters in the stochastic model, η̄z22,R2 , are negative and smaller
than their counterparts in the deterministic model. Thus, on the one hand, the increase in the



                                                                    40
tax rate induces a smaller decrease in capital income (in the stochastic model) for individuals
with z2 = ẑ2 ; on the other hand, the increase in the lump-sum tax liability induces a larger
increase in capital income (in the stochastic model) for individuals with z2 ≥ ẑ2 . Therefore the
revenue gains from increasing the capital income tax rates in period two in the stochastic model
are larger than in the deterministic model.


8    Conclusion
We identify a condition on individual demand under which the effects of taxation on individual
behavior, tax revenue, and social welfare of can be expressed in terms of empirically observ-
able and easily interpretable parameters, namely the labor and capital income elasticities, the
multivariate hazard rates of the income distributions, and the marginal social welfare weights.
Applying these formulas to various settings, we show that optimal taxes and the effects of tax
reforms obey common general principles, and that the benefits of using sophisticated tax instru-
ments come from the ability to fine-tune the distortions to the segments of the population who
respond relatively little to taxes.
    We leave two important extensions for future research. First, our numerical applications were
meant to provide rough orders of magnitude of the forces at play in a few examples. It would
be valuable to do more extensive numerical welfare calculations, estimating the fundamental
parameters that enter our tax formulas using micro data. Second, we believe our approach
is useful to analyze problems which may be difficult to tackle directly, e.g., multidimensional
mechanism design models. However, an open question is to find a condition on the primitives
of the model such that our assumption on individual demand is satisfied.


References
 [1] Albanesi, Stefania, “Optimal Taxation of Entrepreneurial Capital with Private Informa-
     tion”, Working Paper, 2011

 [2] Blundell, Richard and Andrew Shephard, “Optimal Taxation in an Empirical Life-
     Cycle Model of Labor Supply”, Working Paper , 2014

 [3] Bonhomme, Stephane and Jean-Marc Robin, “Modeling Individual Earnings Tra-
     jectories using Copulas with an Application to the Study of Earnings Inequality: France,
     1990-2002”, Working Paper , 2003

 [4] Chamley, Christophe, “Optimal Taxation of Capital Income in General Equilibrium
     with Infinite Lives”, Econometrica, 1986

 [5] Chetty, Raj, “Sufficient Statistics for Welfare Analysis: A Bridge Between Structural and
     Reduced-Form Methods”, Annual Review of Economics, 2009


                                               41
 [6] Chetty, Raj, “Bounds on Elasticities with Optimization Frictions: A Synthesis of Micro
     and Macro Evidence on Labor Supply”, Econometrica, 2012

 [7] Chetty, Raj, “Time Trends in the Use of Administrative Data for Empirical Research”,
     Unpublished, 2012

 [8] Conesa, Juan Carlos, Sagiri Kitao, and Dirk Krueger, “Taxing Capital? Not a Bad
     Idea After All!”, American Economic Review, 2009

 [9] Congressional Budget Office, “Effective Marginal Tax Rates on Labor Income”, CBO
     paper, 2005

[10] Dearden, Lorraine, Emla Fitzsimons, Alissa Goodman and Greg Kaplan, “Esti-
     mating Lifetime Earnings Distributions Using Copulas”, Working Paper , 2006

[11] Diamond, Peter, “Optimal Income Taxation: An Example with a U-Shaped Pattern of
     Optimal Marginal Tax Rates”, American Economic Review , 1998

[12] Diamond, Peter, “A Many-Person Ramsey Tax Rule”, Journal of Public Economics,
     1975

[13] Diamond, Peter, and James Mirrlees, “Optimal Taxation and Public Production II:
     Tax Rules”, American Economic Review , 1971

[14] Farhi, Emmanuel and Ivan Werning, “Insurance and Taxation over the Life-Cycle”,
     Review of Economic Studies, 2012

[15] Farhi, Emmanuel and Ivan Werning, “Progressive Estate Taxation”, Quarterly Journal
     of Economics, 2010

[16] Golosov, Mikhail, Narayana Kocherlakota and Aleh Tsyvinski, “Optimal Indirect
     and Capital Taxation”, Review of Economic Studies, 2003

[17] Golosov, Mikhail, Maxim Troshkin and Aleh Tsyvinski, “Redistribution and Social
     Insurance”, Working Paper , 2013

[18] Golosov, Mikhail, Aleh Tsyvinski and Nicolas Werquin, “A Variational Approach
     to the Analysis of Tax Systems: The Stochastic Model”, Working Paper , 2014

[19] Greenwood, Jeremy, Zvi Hercowitz, and Gregory Huffman, “Investment, Capacity
     Utilization, and the Real Business Cycle”, American Economic Review,1988

[20] Gruber, Jonathan and Emmanuel Saez, “The Elasticity of Taxable Income: Evidence
     and Implications”, Journal of Public Economics, 2002




                                            42
[21] Guvenen, Fatih, Serdar Ozkan, Fatih Karahan, and Jae Song, “What Do Data on
     Millions of US Workers Say About Lifecycle Earnings Risk?”, Working Paper, 2014a

[22] Guvenen Fatih, Serdar Ozkan, and Jae Song, “The Nature of Countercyclical Income
     Risk”, Journal of Political Economy, 2014b

[23] Heathcote, Jonathan, Kjetil Storesletten, and Gianluca Violante, “Optimal Tax
     Progressivity: An Analytical Framework”, Working Paper, 2014

[24] Hendren, Nathaniel, “The Policy Elasticity”, Working Paper, 2013

[25] Judd, Ken, “Redistributive Taxation in a Simple Perfect Foresight Model”, Journal of
     Public Economics, 1985

[26] Keane, Michael, and Richard Rogerson, “Micro and Macro Labor Supply Elasticities:
     A Reassessment of Conventional Wisdom.” Journal of Economic Literature, 2012

[27] Kleven, Henrik Jacobsen, Claus Thustrup Kreiner, and Emmanuel Saez, “The
     Optimal Income Taxation of Couples”, Econometrica, 2009

[28] Kocherlakota, Narayana, “Zero Expected Wealth Taxes: A Mirrlees Approach to Dy-
     namic Optimal Taxation,” Econometrica, 2005

[29] Kremer, Michael, “Should Taxes Be Independent of Age?”, Unpublished Paper , 2002

[30] Maag, Elaine, C. Eugene Steuerle, Ritadhi Chakravarti, and Caleb Quakenbush,
     “How Marginal Tax Tates Affect Families at Different Levels of Poverty”, National Tax
     Journal, 2012

[31] Mirrlees, James, “An Exploration in the Theory of Optimal Income Taxation”, Review
     of Economic Studies, 1971

[32] Nirei, Makoto, and Wataru Souma, “A Two Factor Model of Income Distribution
     Dynamics”, Review of Income and Wealth, 2007

[33] Piketty, Thomas, “La Redistribution Fiscale Contre le Chômage”, Revue Française
     d’Economie, 1997

[34] Piketty, Thomas and Emmanuel Saez, “A Theory of Optimal Inheritance Taxation”,
     Econometrica, 2013

[35] Piketty, Thomas, Emmanuel Saez and Stefanie Stancheva, “Optimal taxation of
     Top Incomes: A Tale of Three Elasticities”, American Economic Journal: Economic Policy,
     2014




                                            43
[36] Prante, Gerald and Austin John, “Top Marginal Effective Tax Rates by State and by
     Source of Income, 2012 Tax Law vs. 2013 Tax Law (as enacted in ATRA)”, Working Paper,
     2013

[37] Ramsey, Frank, “A Contribution to the Theory of Taxation”, The Economic Journal,
     1927

[38] Rothschild, Casey and Florian Scheuer, “A Theory of Income Taxation under Multi-
     dimensional Skill Heterogeneity”, Working Paper, 2014

[39] Saez, Emmanuel, “Using Elasticities to Derive Optimal Income Tax Rates”, Review of
     Economic Studies, 2001

[40] Saez, Emmanuel, “Essays on the Economics of Income Taxation”, M.I.T. Manuscript,
     2001b

[41] Saez, Emmanuel, Joel Slemrod and Seth Giertz, “The Elasticity of Taxable Income
     with Respect to Marginal Tax Rates: A Critical Review”, Journal of Economic Literature,
     2012

[42] Shourideh, Ali, “Optimal Taxation of Wealthy Individuals”, Working Paper, 2012

[43] Straub, Ludwig, and Ivan Werning, “A Reappraisal of Chamley-Judd Zero Capital
     Taxation Results”, Working Paper, 2014

[44] Weinzierl, Matthew, The Surprising Power of Age-Dependent Taxes, Review of Eco-
     nomic Studies, 2011




                                            44
A     Proofs of Sections 3 and 4
In this section, we provide the proofs of the results of Sections 3 and 4 from the main text.
We first derive analytical expressions for all the elasticities and income effect parameters in the
general model, as well as under the assumptions of Section 6. We then prove the results of
Propositions 1, 2 and 3, and provide details for the derivation of various results in the text.

A.1    Elasticities and Income Effect Parameters
We start by providing analytical expressions for the elasticities and income effect parameters in
the general model of Sections 4 to 2. To derive these expressions, we differentiate the system of
first-order conditions (9) of the individual’s problem with respect to the marginal or net-of tax
       
rates q̂xj ,s 1≤s,j≤S and the virtual incomes {Rs }1≤s≤S . For a given individual, define rs+1 as
the exogenous interest rate that he faces on his capital ks , so that his capital income in period
s + 1 is equal to zs+1 = rs+1 ks . We can write the individual’s first-order conditions as
                   (                                                                                                  
                                  2S
                                                             )
                                  X
           U xj  −                       qxi ,t xθ,i + Rt             , {yθ,t }1≤t≤S , {zθ,t+1 }1≤t≤S , θ 
                                   i=1                         1≤t≤S
                                       (                                                                                              (45)
             S                                   2S
                                                                          )
             X                                   X
         =         qxj ,s Ucs  −                      qxi ,t xθ,i + Rt               , {yθ,t }1≤t≤S , {zθ,t+1 }1≤t≤S , θ  ,
             s=1                                 i=1                      1≤t≤S


We then use the Slutsky equations to obtain the compensated elasticities from the uncompen-
sated elasticities and the income effect parameters. Define the 2S × 2S matrix A by:

                                                  S X
                                                  X S                                 S
                                                                                      X                        S
                                                                                                               X
             [A]s,j ≡ −Uxs ,xj −                            qxs ,t qxj ,q Uct ,cq +         qxs ,t Uct ,xj +         qxj ,q Uxs ,cq .
                                                  t=1 q=1                             t=1                      q=1


Define also the 2S-vectors Bτp,xi , BRp , and Bτcp,x , for any 1 ≤ p ≤ S and 1 ≤ i ≤ 2S, by
                                                                              i


              h               i           S
                                          X
                  Bτup,x              ≡         qxs ,t Uct ,cp xi − Uxs ,cp xi − Ucp 1{i=s} ,         ∀s ∈ {1, . . . , 2S} ,
                        i         s
                                          t=1
                                            S
                                            X
                             
                      BRp     s
                                      =−          qxs ,t Uct ,cp + Uxs ,cp ,      ∀s ∈ {1, . . . , 2S} ,
                                            t=1
              h               i
                  Bτcp,x              ≡ −Ucp 1{i=s} ,         ∀s ∈ {1, . . . , 2S} .
                        i         s

We can then write the the uncompensated and compensated income elasticities and the income
effect parameters as

                                            q̂xt ,s h −1 u,c i
                  ζxu,c                                                   and ηxj ,Rs = q̂xj ,s A−1 × BRs j ,
                                                                                                        
                     j ,q̂x
                                      =±             A Bτs,xt ,                                                                         (46)
                            t ,s              xj              j




                                                                          45
where ± = + if xt ∈ {zs , rs ks−1 }, and ± = − otherwise. Note that the components of the elas-
ticity matrices and the income effect vectors (4) are the partial derivatives of the (compensated
or uncompensated) demands, and not directly the elasticities and income effect parameters we
just derived.
    For concreteness we show how to apply these formulas to the static model (S = 1). Differ-
entiating the first-order conditions

                      Uy ((1 − τ ) y + R, y, θ) = − (1 − τ ) Uc ((1 − τ ) y + R, y, θ)

implies the following expressions for the elasticities (46):

    u         Uy /y − (Uy /Uc )2 Ucc + (Uy /Uc ) Ucy                              − (Uy /Uc )2 Ucc + (Uy /Uc ) Ucy
   ζy,1−τ =                                                     , ηy,R =                                              .
              Uyy + (Uy /Uc )2 Ucc − 2 (Uy /Uc ) Ucy                         Uyy + (Uy /Uc )2 Ucc − 2 (Uy /Uc ) Ucy

In this case, the matrix A defined above is minus the denominator of these two expressions, and
the vectors Bτu , BR are respectively (1 − τ ) y and − (1 − τ )−1 times the numerators of these two
expressions.
    We now show how these expressions simplify under the assumptions of Section 6. That is,
we assume that the utility function is time-separable, has no income effects on labor supply,
and that the baseline tax system is separable and linear in capital income. In this case, the
                                       c,(x )
S × S upper-left submatrix of E s θ is diagonal, and its upper-right and lower-left submatrices
                                                                                      (x )
are zero. Moreover, the first S components of the income effect vector I s θ are equal to zero.
Thus, for every period p ∈ {1, . . . , S} where the tax system is perturbed, the only non-zero
compensated elasticities and income effect parameters are: (i ) the compensated elasticities of
labor incomes ys with respect to the labor income tax rates in the current period τys ,s , i.e., the
S parameters ζycs ,1−τys ,s ; (ii ) the compensated elasticities of capital incomes zs with respect to
all of the capital income tax rates τzt ,p , i.e., the S 2 parameters ζzcs ,1−τz ,p ; (iii ) the income effect
                                                                                t
parameters on capital incomes zs , i.e., the S parameters ηzs ,Rp . The formulas above show that
the labor income elasticities are given by:

                                                                  v 0 (ys /θs )
                                          ζycs ,1−τys ,s =                            .
                                                             (ys /θs ) v 00 (ys /θs )
Suppose either that the utility function is CRRA, i.e. u (x) = x1−σ / (1 − σ), and let α ≡
β −1/σ R1−1/σ , or that the utility function is CARA, i.e. u (x) = −γ −1 exp (−γx), and let α = R.
We obtain that the only non-zero compensated capital income elasticities are given by
                                                  P         P           
                                                     S−p i       p−1       i ,
           ∂zsc              −u0p       r2 Rs−p−2       α               α                      if s ≤ p,
                                   
                                                     i=0         i=p−s+1
                    =                                                                                               (47)
                             u00p
                                        PS−1 i PS−s  Pp−1 
       ∂ 1 − τzp ,p                        i=0 α
                                                           i          i                         if s ≥ p + 1,
                                                     i=0 α       i=1 α ,
                                                  




                                                               46
and the only non-zero income effect parameters are given by
                                      P            
                                     −   S−1      i
                      ∂zs      rRs−p−1    i=S−s+1 α ,                 if s ≤ p,
                          = PS−1                                                                    (48)
                      ∂Rp    i=0 α
                                   i  PS−s i
                                            α   ,                     if s ≥ p + 1.
                                        i=0


                                   −u0p
Note that in the CARA case,        u00    is simply equal to γ −1 .
                                    p



A.2    Proofs of Propositions 1 to 3
We first prove the existence of the Gateaux differential of the income functional and show
Proposition 1.

Proof of Proposition 1. We first show that the income functional xθ (·) is Gateaux differentiable
around the initial tax system Tp . Denote by xθ ≡ xθ (Tp ), resp. x̃θ ≡ xθ (Tp + µh), the income
vector chosen by an individual θ given the baseline tax system Tp , resp. the perturbed tax system
in the direction h, Tp + µh. The vectors xθ and x̃θ are the solution to the respective systems
of the first-order conditions (9), where the map F : R2S × R2S × R → R2S is continuously
differentiable. For any j ∈ {1, . . . , 2S}, let Fj denote the j th component of F . Writing the
first-oder conditions both at the baseline and the perturbed tax system yields, for all j,
                                                                                        !
                                               ∂h
                0 = Fj x̃θ , τxt ,p (x̃θ ) + µ     (x̃θ )         , Tp (x̃θ ) + µh (x̃θ )
                                               ∂xt         1≤t≤2S                                     (49)
                                                              
                     − Fj xθ , {τxt ,p (xθ )}1≤t≤2S , Tp (xθ ) , ∀j = 1, . . . , 2S.

Define the matrix M = (mj,s )1≤j,s≤2S as

                                            2S
                               ∂Fj    X ∂Fj ∂τx ,p (xθ ) ∂Fj ∂Tp (xθ )
                                                t
                     mj,s =         +                   +              ,
                              ∂xθ,s    ∂τxt ,p ∂xθ,s      ∂Tp ∂xθ,s
                                           t=1

                                                                            ∂Fj
the vectors Nxt = (nj,xt )1≤j≤2S for all t ∈ {1, . . . , 2S} as nj,xt =    ∂τxt ,p ,   and the vector NT =
                         ∂F
(nj,T )1≤j≤2S as nj,T = ∂Tpj . Assumption 2 implies that kx̃θ − xθ k = O (µ) as µ → 0. Moreover,
we have kµh (x̃θ ) − µh (xθ )k = o (µ) as µ → 0. A first-order Taylor expansion of (49) as µ → 0,
i.e., of the perturbed system of first-order conditions around the initial system, thus writes:

                              2S
           1                 X          ∂h (xθ )  −1
             (x̃θ − xθ ) = −    M −1 Nxt         − M NT h (xθ ) + oµ→0 (1) .
           µ                              ∂xt
                              t=1


This shows the existence of the Gateaux differential δxθ (Tp , h) ∈ R2S of the income functional
xθ (·) at Tp with increment h. We then express the Gateaux differential of the income functional
as a function of the elasticity matrices and vectors of income effect parameters. To do so, we



                                                      47
derive the change x̃θ − xθ in the individual’s choice vector by writing the first-order Taylor
approximation of the post-perturbation system of first order conditions (45) around the solution
xθ to the initial system. Using the explicit expressions for the elasticities and income effect
parameters derived in (46), we obtain
                     "         S
                                                                #−1
                                                                      n                                       o
                                                                                               (xθ )
                               X
                                     E c,(x θ)
                                                 D2 Ts (xθ )           E c,(x θ)
                                                            
        (x̃θ − xθ ) = i2S −            s                                 p       ∇h (x θ ) + I x,Rp  h (x θ )   .
                               s=1

This concludes the proof of Proposition 1.

   We then show Proposition 2, which gives expressions for the Gateaux differentials of the tax
revenue and social welfare functionals.

Proof of Proposition 2. Consider an admissible perturbation hp of the baseline tax function
Tp , so that the perturbed tax function is Tp + µhp . For any θ, letting xθ ≡ xθ (Tp ) and
x̃θ ≡ xθ (Tp + µhp ), a Taylor approximation yields

                           [Tp + µhp ] (x̃θ ) − Tp (xθ )
                         =µ h∇Tp (xθ ) , δxθ (Tp , hp )i + µhp (xθ (Tp )) + o (µ) .
Similarly, using the envelope theorem and the local Lipschitz continuity of the income function
(Assumption 2), we get
                                                                                
                                                           λ   p−1
         G (Uθ (Tp + µhp )) − G (Uθ (Tp )) = −                β gp (xθ ) hp (xθ ) µ + o (µ) .
                                                          1−α

Using the compactness of the set X and assuming that the integrand is twice continuously
differentiable, we thus obtain that the change in social welfare is equal to

     W (Tp + µhp ) − W (Tp )
        ˆ (                             * S
                                         X
                                                                        +)
              p−1                            s−1
    =µλ     β     (1 − gp (x)) hp (x) +     β ∇Ts (xθ ) , δx (Tp , hp )    fx (x) dx + o (µ) .
          X                                        s=1

                                           0
This proves formula (12). Letting T̃ (x) ≡ T 0 (x) D −1 (x) and using the fact that the density of
incomes is equal to zero on the boundary ∂X of the set X, we can integrate by parts the integral
involving ∇hp (x) in this expression to get
         ˆ h                                 ˆ
              0
                             i                    h 0                   i
                     c,(x)
            T̃ (x) E p fx (x) ∇hp (x) dx = −   ∇ · T̃ (x) E c,(x)
                                                            p     fx (x) hp (x) dx.
           X                                                  X

This proves formula (13).

   Next we prove Proposition 3.



                                                         48
Proof of Proposition 3. A necessary condition for the social welfare functional W (·) to have an
extremum at Tp is δW (Tp , h) = 0, for all h (see, e.g., Luenberger 1969). From equation (13),
this implies that the integrand must be equal to zero pointwise, that is for all x ∈ X,
                                                                                               
        β p−1 (1 − gp (x)) − T 0 (x) D −1 (x) I (x)
                                                p     fx (x) − ∇ · T 0 (x) D −1 (x) E c,(x)
                                                                                      p     fx (x) = 0.

Integrating this equation on the volume V with closed boundary S = ∂V and using the divergence
theorem, we obtain formula (17). Finally, we obtain formula (16) by using the separable linear
perturbations hp (x) = xp and equation (12).

    We finally prove the formulas which express the optimal tax system as a function of the
distribution of types θ.

Proof of formula (19). Differentiating the ith first-order condition (9) with respect to θj for
j ∈ {1, . . . , 2S} yields

                             2S
                             X             ∂xθ,s    ∂Fi
                                    mi,s         =−     ⇒ Jx (θ) = −M −1 JF (θ) ,
                                            ∂θj     ∂θj
                             s=1

where the matrix M is the same as in the proof of Proposition 1, and Jx (θ) , JF (θ) are the
matrices [∂xθ,i /∂θj ]1≤i,j≤2S and [∂Fi /∂θj ]1≤i,j≤2S respectively. Similarly, differentiating the
                                                          
first-order conditions (9) with respect to the variables τxj ,p 1≤j≤2S and Tp yields:

                         Jx (τ p ) = −M −1 JF (τ p ) , and Jx (Tp ) = −M −1 JF (Tp ) ,
                                                                                  
where Jx (τ p ) , JF (τ p ) are the matrices ∂xθ,i /∂τxj ,p 1≤i,j≤2S and ∂Fi /∂τxj ,p 1≤i,j≤2S respec-
                                                                                                         c,(x)
tively, and JF (Tp ) is the vector [∂Fi /∂Tp ]1≤i≤2S . But we have Jx (τ p ) = D −1 (x) E p                      and
                −1         (x)
Jx (Tp ) = D         (x) I p .
                          We use these expressions to write the deformation matrix D (x) as
a function of the Jacobian matrix Jx (θ), and JF (θ) , JF (τ p ) , JF (Tp ). Using the change of
variables formula fθ (θ) = det (Jx (θ)) fx (x (θ)) in the equation

                          0 =β p−1 (1 − gp (x)) fx (x) − T 0 (x) D −1 (x) I (x)
                                                                            p fx (x)
                                                                                                               (50)
                             − ∇x · T 0 (x) D −1 (x) E c,(x)
                                                         p    fx (x)

and the chain rule, we obtain (19).
   Now, consider the model with idiosyncratic productivities {θ1 , . . . , θS } and interest rates
{θS+1 , . . . , θ2S−1 }. Let lθ denote the vector of labor supplies yθ,s /θs and capital stocks kθ,s . We
can write the first-order conditions of the individual problem as
                                                                                                  
                                                             
                     xθ = θ ◦ l θ        θj τ̂yj ,s   1≤j≤2S , θS+j−1 τ̂zj ,s   2≤j≤S   , {Rs }1≤s≤S ,
                                                      1≤s≤S                     1≤s≤S




                                                                49
where τ̂xj ,s is the marginal tax rate on income xj (if xj ∈ {ys , zs }) or the next-of-tax rate
otherwise, and ◦ is the element-wise multiplication. Differentiating this system of equations
with respect to θj for 1 ≤ j ≤ 2S yields the Jacobian matrix

                                                                          S
                                                        "                                !#
                                              −1       x                  X      u,(x)
                               Jx (θ) =D           (x)   ◦       i2S +          ζx,q̂s        ,
                                                       θ
                                                                          s=1

                                                                  u,(x)
where (x/θ) denotes the matrix [xθ,i /θj ]1≤i,j≤2S , ζx,q̂s is the matrix of uncompensated elastic-
ities with respect to the marginal and net-of-tax rates, and ◦ is the element-wise multiplication
of matrices. Changing variables as before yields
                                                    "      S
                                                                     !#−1
                                               x          X    u,(x)
                          JF−1 (θ) JF (Tp )=−     ◦ i2S +     ζx,q̂s      I (θ)
                                                                            p ,
                                                θ
                                                          s=1
                                              "            S
                                                                     !#−1
                           −1                   x         X    u,(x)
                          JF (θ) JF (τ p ) =      ◦ i2S +     ζx,q̂s      E c,(θ)
                                                                             p    .
                                                θ
                                                                      s=1


In particular, in the static Mirrlees model, the first-order condition (9) writes F xθθ , θ (1 − T 0 (xθ )) , R (xθ ) ≡
                                                                                                                    

F [l, τ, R] = 0 with F [l, τ, R] = τ uc (τ l + R, l) + ul (τ l + R, l). It is then straightforward to com-
pute ∂F      ∂F       ∂F
        ∂l , ∂τ , and ∂R . Note moreover that Jx (θ) = det (Jx (θ)) = ẋ (θ). Differentiating the
first-order-condition with respect to θ then yields
                 1 ∂F
                         − 1        0       ∂F
      ẋθ        θ2 ∂l    xθ (1 − T (xθ )) ∂τ                                   1                                 1
          =   1 ∂F
                                                        ⇒ ẋ−1
                                                            θ             c                       =                         .
                         −θ ∂F   ∂F                                   xθ ζx,1−τ
                                                                                                          
      xθ                                  00                                                          xθ
              θ ∂l +        ∂τ + ∂R xθ T (xθ )                   1+                00                               u
                                                                                                               1 + ζx,1−τ
                                                                      1−T 0 (xθ ) T (xθ )              θ


This expression is identical to that in Lemma 1 in Saez (2001).


B     Proofs of Sections 5 and 6
B.1    Proofs of Section 5
We start by deriving the formulas for the known results in the literature: optimal commodity
taxes and non-linear labor income taxes.

Proofs of Sections 5.3 and 5.1. Formula (23) follows from using the Slutsky equation and re-
arranging the terms in equation (23). Formula (28) follows from (17) applied to the region
[ŷ, ∞), or directly from rearranging equation (18). Formula (30) follows from (28) under the
assumptions made in the text.

    We now characterize the optimum linear capital income tax schedule.

Proof of Propositions 4 and 5. Consider a separable linear perturbation hp (x) = zp of the



                                                            50
capital
     income tax rate in every period p ≥ 2. The welfare effect of these perturbations,
δW τz , {hp }p≥2 , is given by the sum (for p = 2, . . . , S) of the effects of each of the period-p
perturbations hp , δW (τz , hp ). Applying Proposition 2, we obtain that the welfare effect of this
perturbation is given by
                            
   δW       τz , {hp }p≥2
     S
           (ˆ                                                            ˆ            S
                                                                                                                                        )
     X                                                                                X
                             p−1                                                              s−1
 =                       β         (1 − gp (x)) zp fx (x) dx +                            β         τz [δx (τz , hp )]S+s−1 fx (x) dx
     p=2       RS
                + ×R
                     S                                                       RS   S
                                                                              + ×R s=2

     S
           (                                            ˆ            S
                                                                                                                    )
     X
               p−1                    zp               τz                X
                                                                                s−1
 =      β z̄p            1 − E gp (x)
                                  −              β           zs ζzu,(x) f (x) dx
                                                                   s ,rp x
                                      z̄p
                                      S   S
                                     R+ ×R s=2       1 −  τz
   p=2
      S         S                                             S
             !                    (                                          )
                    β p−1 z̄p
                                                
     X
         s−1
                X                            zp        τz X s−p u
 =      β z̄s ×   PS                1 − E gp       −              β ζ̄zs ,rp .
                   s=2 β
                         s−1 z̄
                                s            z̄p     1 − τz
      s=2                     p=2                                                              s=2


Equating this expression to zero leads the optimal capital income tax rate (25). (Note that it
would be straightforward to characterize the optimal affine tax schedule, by considering revenue-
neutral perturbations of the capital income tax rate τz and the virtual income R (uniform lump-
sum rebate of the tax revenue generated by the increase in the tax rate), and equating their
effect to zero.)
    Now consider the case where the perturbation is implemented in every period p = p1 , . . . , p2 .
Under the assumptions of Proposition 5, the expressions (47) and (48) imply:
                                                             
                                                             Rs−p−1 − R−p ,                  if s ≤ p,
                                   ζ̄zcs ,rp   =σ −1 (R − 1)
                                                             R−1 − R−p ,                     if s ≥ p + 1,
                                                             
                                                             R−p − Rs−p−1 ,                   if s ≤ p,
                                 η̄zs ,Rp      =     (R − 1)
                                                             R−p ,                            if s ≥ p + 1.

Hence, the compounded uncompensated elasticities are equal to:
                                                  ∞
                                                  X
                                                       β s−1 ζ̄zus ,r2 =σ −1 (1 − β) β + (2β − 1) β,
                                                  s=2
                                 ∞ X
                                   ∞
                                 X                β s−1
                                                P∞      p−1
                                                              ζ̄zus ,rp =σ −1 + β − 1.
                                 p=2 s=2          p=2 β


Result (26) follows. Moreover, we obtain
                                         ∞ X
                                           ∞
                                         X                               β
                         β −(P −1)                  β s−1 ζ̄zus ,rp =       σ −1 + σ −1 − 1 (P − 1) ,
                                                                                           
                                                                        1−β
                                         p=P s=2




                                                                        51
from which (27) follows. Finally, for S < ∞ (still assuming βR = 1), we have
                                           
                              ∂zs      r   RS+s−p−1 − RS−p ,                                if s ≤ p,
                                  =
                              ∂Rp   1 − RS Rs−p−1 − RS−p ,                                  if s ≥ p + 1,

                  PS        PS         s−1 ∂zs
which implies        p=1       s=1 β       ∂Rp     = 0.

   We now prove the results of Section 5.4, i.e., the optimal non-linear, age-dependent, separable
tax system in a two-period economy.

Proofs of formulas (31) and (32). Under the assumptions of this section, we have

                                                                                        c,(x )
                                                                             y
                                                                                                               
                                                                         − 1−τ 1       ζy1 ,wθ1 I{p=1}
                                                            T10 (y1 )
                                                                    y
                                                                               y1 ,1
                                                                              c,(x )                           
                                                              1+ 1−τ 1 ζy1 ,wθ1 T100 (y1 )                    
                                                                    y1 ,1                                     
                                                                      y         c,(x )
                                                                 − 1−τ 2 ζy2 ,wθ2 I{p=2}
                                                                                                              
                  T 0 (x) D −1 (x) E c,(x)               0 (y )
                                                                       y2 ,2
                                                                                                               
                                     p             = βTy,2 2         y         c,(x ) 00
                                                                                                               ,
                                                                1+ 1−τ 2 ζy2 ,wθ2 Ty,2    (y2 )
                                                                                                              
                                                                       y2 ,2
                                                                                                              
                                                                                c,(xθ )
                                                                     z2
                                                                                                               
                                                                − 1−τ        ζz2 ,r2 I{p=2}                   
                                                        0 (z )
                                                      βTz,2             z2 ,2                                  
                                                             2        z        c,(x )
                                                                         1+ 1−τ 2          ζz2 ,r2θ Tz,2
                                                                                                     00 (z )
                                                                                                          2
                                                                                   z2 ,2
                                                                                                                   (x )
                                                                                                                   θ
                       0         −1                   0                                 1                      ηz2 ,R
                    T (x) D            (x) I (x)
                                             p     =βTz,2 (z2 )                      c,(xθ ) 00
                                                                                                                      p
                                                                                                                          ,
                                                                   1+        z2                        1       − τz2 ,p
                                                                           1−τz2 ,2 ζz2 ,r2 Tz,2 (z2 )


and →−
     n (x) is the 3-vector whose only non-zero component is equal to 1 and is in the first
(resp., second, third) row if x̂ = ŷ1 (resp., ŷ2 , ẑ). Application of formula (17) to the region
V = [x̂, ∞) × R2 , for x̂ ∈ {ŷ1 , ŷ2 , ẑ2 } and p = 1, 2, 2 respectively, and dividing by 1 − Fxp (x̂),
yields formulas (31) and (32).

    Next, we derive the optimal asymptotic capital income tax rate in a non-linear tax system.

Optimal Asymptotic Capital Income Tax Rate. Assume that the baseline tax system is separa-
ble and age-independent, but non-linear in capital income. For simplicity, we also assume that
the distribution of capital income is stationary, and that it is Pareto distributed at the tail with
coefficient az . Here we let the utility function have income effects on labor supply, and assume
that the labor income tax rate τy is constant and age-independent. Next, we assume the conver-
                                                                                  z           (∞)
gence toward constants of the (average) marginal social welfare weights, Ezp ≥ẑ gp ẑp −−−→ ḡp ,
                                                                                                                              ẑ→∞
                           u,(z ≥ẑ)             u,(∞)           (z ≥ẑ)                   (∞)
of the elasticities, ζ̄zs ,rpp         −−−→ ζ̄zs ,rp and η̄zsp,Rp −−−→ η̄zs ,Rp , and of the marginal tax rates
                                       ẑ→∞                                 ẑ→∞
at the top of the capital income distribution, Tz0 (z) −−−→ τz∞ . Moreover, we assume that Tz00 (·)
                                                       z→∞
converges to zero fast enough, i.e., for all p ≥ 2,

                                              sup         zs ζzc,(x) T 00 (zp ) −−−→ 0.
                                                                s ,rp z
                                           {x:zp ≥ẑ}                              ẑ→∞




                                                                  52
Finally, we assume that there is “no mobility at the top”: as the threshold capital income level
ẑ → ∞, individuals with capital income zs ≥ ẑ in a given period s have capital income zp ≥ ẑ
in all periods p ≥ 2. Intuitively, individuals at the top of the capital income distribution in a
given period stay there forever. This ensures that as zp → ∞ for any p, all the components of
the matrix F z (x) (defined below) converge to zero, and that all the marginal tax rates Tz0 (zs )
converge to τz∞ .
    Consider a sequence, indexed by ẑ > 0, of separable perturbations of the capital income tax
rate in every period p ≥ 2, that are linear above the threshold ẑ. That is, for all p we define
hp (x) = max {zp − ẑ, 0}. The Gateaux differential of social welfare writes:

                                    S
                                      X                   ˆ        ∞                                      
      δW        T , {hp }p≥2 =                  β   p−1
                                                                        (1 − gp (x)) (zp − ẑ) fx (x) dx
                                      p=2                      ẑ
             (ˆ
           S              ∞ˆ
                                                                                                                        )
                                                                                      h                            i
                                               T 0z (x) [iS−1 + F z (x)]−1 E c,(x)
           X
                                                                                                (x)
                                                         
       +                                                                     p,zp − (zp − ẑ) I p   fx (x) dx
           p=2       ẑ    RS
                            + ×R
                                 S−2


           S ˆ           ∞ˆ
                                                                                                         
                                                    S                   c,(x)     (x)
           X                                        X              y  ζ
                                                                     s ys ,rp   η ys ,Rp
                                                                                                              
       +                                   τy            β s−1 −            −          (zp − ẑ) fx (x) dx ,
                    ẑ        RS
                                + ×R
                                     S−2                           1 − τzp ,p 1 − τys ,p                      
           p=2                                      s=2


where [T 0z (x)] is the (S − 1)-row vector with components β s−1 Tz0 (zs ) and [F z (x)] is the (S − 1)×
                                              ∂z c
(S − 1)-matrix with components Tz00 (zj ) ∂τj,zi for i, j ≥ 2. Thus, letting ẑ → ∞ and imposing
                                                                            j
    δW (T,{hp }p≥2 )
lim   (1−F (ẑ))ẑ= 0, we obtain the following characterization of the optimal asymptotic capital
income tax rate:
                                                                          
                                     az                  PS              (∞)
                    ∞
                   τz              az −1  −  1     1  −           γ   ḡ
                                                           p=2 p,z p,NL
                      ∞
                         =                         u,(∞)                       (∞)
                 1 − τz     a      P  S                      PS
                                      p,s=2 γp,z ζ̄zs ,rp −       p,s=2 γp,z η̄zs ,Rp
                             rk
                           ark −1
                                          az PS                  u,(∞)     PS                 (∞)
                                  τy     az −1     p,s=2 γp,z ζ̄ys ,rp −       p,s=2 γp,z η̄ys ,Rp
                           −                                                                       ,
                              1 − τz∞ az PS                      u,(∞)
                                                          γp,z ζ̄z ,r − S
                                                                           P
                                                                                      γp,z η̄
                                                                                              (∞)
                                                              az −1         p,s=2     s   p     p,s=2          zs ,Rp


where γp,z = β p−1 / Ss=2 β s−1 . Note that in the case where the utility function has no income
                    P

effects on labor supply, the second line of this expression is equal to zero.

   We now prove the result of Section 5.5, i.e., the joint taxation of couples.

Proof of formula (33). We follow the same steps as in the derivation of formula (19). Let-
           ∂T               2T
ting τi ≡ ∂y i
               and τij ≡ ∂y∂i ∂y j
                                   , the Gateaux differential of individual income in a direction h,




                                                                                53
δyθ (T, h), writes

                                                1
        δyθ (T, h) =                                                        2
                       (1 − τ1 + y1 ζτ11 ) (1 − τ2 + y2 ζτ22 ) − y1 y2 ζ 2 τ12
                                                                                           !       ∂h(yθ )
                                                                                                             !
                             − (1 − τ2 + y2 ζτ22 ) y1 ζ      (y1 ζτ12 ) y2 ζ                        ∂y1
                       ×                                                                           ∂h(yθ )       .
                                  (y2 ζτ12 ) y1 ζ       − (1 − τ1 + y1 ζτ11 ) y2 ζ                  ∂y2

Applying formula (50), we obtain that the revenue-maximizing tax function satisfies the following
PDE:
                                                                                                      
                      ∂      − (τ1 y1 ζ) (1 − τ2 + y2 ζτ22 ) + (τ12 y1 ζ) (τ2 y2 ζ)
   fy (y1 , y2 ) =                                                                       fy (y1 , y2 )
                     ∂y1 (1 − τ1 + y1 ζτ11 ) (1 − τ2 + y2 ζτ22 ) − (τ12 y1 ζ) (τ12 y2 ζ)
                                                                                                      
                      ∂       − (1 − τ1 + y1 ζτ11 ) (τ2 y2 ζ) + (τ1 y1 ζ) (τ12 y2 ζ)
                   +                                                                     fy (y1 , y2 ) .
                     ∂y2 (1 − τ1 + y1 ζτ11 ) (1 − τ2 + y2 ζτ22 ) − (τ12 y1 ζ) (τ12 y2 ζ)

To rewrite the PDE in terms of the distribution of types, first notice that in this model, the
incomes as functions of types are given by:

                                             y1 =θ11+ζ (1 − τ1 )ζ ,
                                                                                                                     (51)
                                             y2 =θ21+ζ (1 − τ2 )ζ .

and the Jacobian matrix Jy (θ) writes:
                   !
       ∂y1   ∂y1
       ∂θ1   ∂θ2                                    1
       ∂y2   ∂y2       =
       ∂θ1   ∂θ2
                    (1 − τ1 + ζy1 τ11 ) (1 − τ2 + ζy2 τ22 ) − (ζy1 τ12 ) (ζy2 τ12 )
                                                                                                             (52)
       (1 − τ1 ) 1 − τ2 + 1+ζ     y
                               θ1  1   (ζy2 τ22 )       −  (1 − τ2 ) (ζy1 τ12 )   1+ζ
                                                                                    θ2 y 2
    ×                               1+ζ
                                                                                                 ,
            − (1 − τ1 ) (ζy2 τ12 ) θ1 y1            (1 − τ2 ) 1 − τ1 + (ζy1 τ11 ) 1+ζ    θ2  y 2


Therefore, we have
                                                                          !      ∂h(yθ )
                                                                                           !
                                         θ1    ζ ∂y1       θ2    ζ ∂y1
                                      − 1−τ 1 1+ζ ∂θ1
                                                        − 1−τ 2 1+ζ ∂θ2           ∂y1
                   δyθ (T, h) =                                                  ∂h(yθ )       .
                                      − ∂y 2 θ1   ζ
                                        ∂θ1 1−τ1 1+ζ
                                                           θ2
                                                        − 1−τ    ζ ∂y2
                                                              2 1+ζ ∂θ2           ∂y2

The optimal tax system is thus characterized by:
                                         n                                        o          0
                                              τ1   ζ     ∂y1      τ2    ζ      ∂y2
                                           − 1−τ      θ
                                                  1+ζ 1 ∂θ1  −             θ
                                                                 1−τ1 1+ζ 1 ∂θ1 o y   f   (y)
          0 = (1 − g (y)) fy (y) − ∇y ·  n τ 1 ζ        ∂y1      τ2    ζ      ∂y2
                                                                                              
                                           − 1−τ2 1+ζ θ2 ∂θ2 − 1−τ
                                               1
                                                                     2 1+ζ
                                                                           θ 2 ∂θ2    fy  (y)
                                                                                                                     (53)
                                         2  2                 τ1   ∂y       τ2   ∂y
                                                          (                                    )
                                                                      1             2
                                    ζ X X ∂y−i ∂             1−τi ∂θi   +  1−τi ∂θi
            = (1 − g (θ)) fθ (θ) +                            ∂y1 ∂y2
                                                                                      θi fθ (θ) ,
                                   1+ζ         ∂θ−j ∂θj
                                              i=1 j=1                   − ∂y1 ∂y2
                                                                      ∂θ1 ∂θ2     ∂θ2 ∂θ1


where the second equality follows from the change of variables from y to θ. Equations (51),
(52), and (53) form a PDE system whose solution is the optimal tax system.


                                                        54
B.2    Proofs of Section 6
We now provide the proofs of the results of Sections 6.1 and 6.2. We first characterize the welfare
effects of reforming the labor income tax system.

Proofs of formulas (37) and (36). Consider first the effects of reforming the marginal labor in-
come tax rate at point ŷ in period p. The perturbation we consider is as follows. We choose the
numbers ŷ > 0, , and define for every p a perturbation h̃p ∈ C 2 (R+ ), with h̃p (y) = 0 on [0, ŷ],
h̃p (y) = (y − ŷ) on [ŷ, ŷ 0 ], and h̃p (y) = (ŷ 0 − ŷ) on [ŷ 0 , ∞). We obtain a smooth perturbation
hp from h̃p by letting hp = h̃p except on the intervals ŷ − u2 , ŷ + u2 and ŷ 0 − u2 , ŷ 0 + u2 , for
                                                                                                   

some small u > 0, where we take hp monotonic. We then consider a sequence hnp n∈N of such
                                                                                           

perturbations, with (ŷ 0 − ŷ) → 0, u → 0, and u = o (ŷ 0 − ŷ). Applying formula (8), we obtain
that the effect of this perturbation hp on the individual income choices is given by

                                                                  c,(x)
            (x)                                            yp ζyp ,wp                          h      u 0 ui
          δyθ,p Tp , hnp = −
                        
                                                              c,(x)
                                                                                , for all yp ∈   ŷ +   , ŷ −   ,
                                          1 − Ty0 (yp ) + yp ζyp ,wp Ty00 (yp )                       2        2
                                                            (x)
            (x)                               ηzs ,Rp
                                               0                                         u
                  Tp , hnp                               , for all s, for all yp ≥ ŷ 0 + .
                             
          δzθ,s                  = − ŷ − ŷ
                                              1 − τzs ,p                                 2

Applying formula (12) and taking the limit of the Gateaux differentials of social welfare as
(ŷ 0 − ŷ) , ∆τ → 0, we get

                          δW Tp , hnp
                                       
                   1
              1 − Fyp (ŷ) (ŷ 0 − ŷ)
                      ˆ ∞
                  p−1                                          fy,p (y)
          −−−→ β           (1 − gp (y))                                   dy
           n→∞                       ŷ                      1 − Fyp (ŷ)
                                 ˆ                                                       c,(ŷ,x     )
                                                                                      ŷζyp ,wp −p                 fx (ŷ, x−p )
                  −β     p−1
                                                     Ty0   (ŷ)                              c,(ŷ,x )
                                                                                                                                 dx−p
                                  RS−1
                                   +   ×RS−1                      1−      Ty0   (ŷ) +    ŷζyp ,wp −p Ty00 (ŷ)   1 − Fyp (ŷ)
                      S                   ˆ    ∞ˆ                               (x)
                                                                           ηzs ,Rp
                      X
                                 s−1                                                   fx (x)
                  −          β                                      τz                            dx.
                                          ŷ       RS−1 ×RS−1             1 − τzs ,p 1 − Fyp (ŷ)
                      s=2                           +


               c,(ŷ,x   )                          (x)
Noting that ζyp ,wp −p = ζ, that ηzs ,Rp is independent of x since the utility function is CRRA
and the baseline tax system is separable, and using the definition of η̄zs ,Rp , we obtain

                                                                                                                S
                       δW Tp , hnp
                                    
                1                                                                                          τz X s−1
                                      −−−→                         β p−1 (1 − Ey≥ŷ [gp ]) −                      β η̄zs ,Rp
           1 − Fyp (ŷ) (ŷ 0 − ŷ)   n→∞                                                                1 − τz
                                                                                                                     s=2
                                                                             Ty0 (ŷ) ζ          ŷfyp (ŷ)
                                                              − β p−1      0            00
                                                                                                            .
                                                                      1 − Ty (ŷ) + ŷζTy (ŷ) 1 − Fyp (ŷ)

                                                                                          p−1
                                                                           P                                   
Summing over periods p and normalizing by                                        p≥1 β             1 − Fyp (ŷ) yields (37). Finally, to



                                                                           55
obtain the gains of age-dependence assuming that the income distribution is stationary, define
                                   τz PS
the “savings effect” as Sp ≡ − 1−τ   z   s=2 β
                                               s−1 η̄
                                                      zs ,Rp . Since ∂zs /∂Rp < 0 for all s ≤ p and
∂zs /∂Rp > 0 for all s ≥ p + 1, we obtain that the sequence β −(p−1) Sp : p = 1, . . . , S is
                                                                        

increasing, with S1 < 0 and SS > 0. Hence there exists p∗ such that the revenue gains of the
period-p separable perturbation are strictly smaller (resp., larger) in the dynamic model than
in the static model for p ≤ p∗ (resp., p > p∗ ). Moreover, the revenue gains of the separable
perturbation that increases lump-sum the tax liability above ŷ by $1 in period p are smaller
                                                                                             0
than the gains from the perturbation that increases the tax liability above β by $β −(p −p) in
period p0 > p, yielding gains from age-dependent taxes.)
    Suppose that the baseline marginal labor income tax rate is constant, i.e., Ty0 (ŷ) = τy for all
ŷ. Then we obtain the following relationship between the linear and the non-linear tax reforms:
   ˆ    ∞
     δW (T , hŷ ) dŷ
    0
  ˆ ∞ X
     ( S                           ˆ                 ∞
           p−1
                                
=        β          1 − Fyp (ŷ) −                       gp (y) fyp (y) dy
    0       p=1                                 ŷ

                                              S
                                                                                !)
              τy                      τz     X
                                                  β s−1 ηzs ,Rp 1 − Fyp (ŷ)
                                                                              
          −        ζ ŷfyp (ŷ) −                                                 dŷ
            1 − τy                 1 − τp,zs
                                             s=2
   S        ˆ ∞                        ´∞                                                    S
                                                                                                            !
                                              ŷgp (ŷ) fy   (ŷ) dŷ     τy          τ
                                     1− 0 ´∞
                                                                                       z
  X                                                                                           X
        p−1                                                p                                       s−1
=     β           ŷfyp (ŷ) dŷ                                      −        ζ−                 β ηzs ,Rp
              0                               0 ŷfyp (ŷ) dŷ
                                                                        1 − τy     1 − τzs ,p
  p=1                                                                                         s=2

=δW (T , hL ) ,

which proves (36).

   We next characterize the welfare effects of reforming the capital income tax schedule.

Proof of formula (35). A reasoning identical to that leading to formula (37), noting that the
              c,(x)
elasticities ζys ,rp are all equal to zero, shows that the welfare effect of a non-linear perturbation
hp,ẑ implemented at point ẑ in period p is equal to
                                               ˆ     ∞
     1                                                                    fzp (z)
             δW (T , hp,ẑ ) =       β p−1               (1 − gp (z))                dz
1 − Fzp (ẑ)                                    ẑ                      1 − Fzp (ẑ)
                                     S               ˆ                                                             
                                     X
                                               s−1                     τz       c,(ẑ,x−(S+p−1) ) fx ẑ, x−(S+p−1)
                                 −         β                                zs ζzs ,rp                               dx−(S+p−1)
                                                         RS
                                                          + ×R
                                                               S−2   1 − τz                          1 − Fzp (ẑ)
                                     s=2
                                      S              ˆ        ∞ˆ
                                     X
                                               s−1                            τz       (x)      fx (x)
                                 −         β                                          ηzs ,Rp              dx.
                                                         ẑ    RS
                                                                + ×R
                                                                     S−2   1 − τzs ,p         1 − Fzp (ẑ)
                                     s=2

Formula (35) follows.

   We now characterize the welfare effects of joint tax reforms.



                                                                   56
Proof of formulas (40) and (38). Fix d ≥ 2 directions (x1 , . . . , xd ) of the space RS+ × RS and
the income threshold x̄d = (x̂1 , . . . , x̂d ). We define the d-multilinear perturbation hp of the
baseline tax function Tp as hp (x) = 0 if xj ≤ x̂j for all j ∈ {1, . . . , d}, hp (x) = (xi − x̂i ) dτ
if xi ∈ [x̂i , x̂i + dx̂] for some i ∈ {1, . . . , d} and xj ≥ x̂j + dx̂ for all j ∈ {1, . . . , d} \ {i}, and
hp (x) = dτ dx̂ if xj ≥ x̂j +dx̂ for all j ∈ {1, . . . , d}. We complete this definition on the remaining
regions of the space (hypercubes of size dx̂) by making hp continuous and multilinear on each of
these regions, e.g., for d = 2, hp (x1 , x2 ) is of the form c12 (x1 − x̂1 ) (x2 − x̂2 ). (More precisely,
we consider a smooth approximation of these perturbations, as in Section 6.1.) For simplicity,
we let d = 2 and consider a joint perturbation in period two in the directions (y1 , y2 ), at point
(ŷ1 , ŷ2 ). Note that
                                                             ζ
                                  ζy1 ,τ21 |τ21 =0 = −                 = −βζ.
                                                       1 + (1 − τz ) r
Let F̄y1 ,y2 (ŷ1 , ŷ2 ) denote the measure of individuals above (ŷ1 , ŷ2 ). Applying our general formula
yields:
                                        ˆ ∞ˆ ∞
        δW T , h2,(ŷ1 ,ŷ2 )
                                 
                                                                     fy ,y (y1 , y2 )
                                   =1 −                g2 (y1 , y2 ) 1 2                   dy1 dy2
         β F̄y1 ,y2 (ŷ1 , ŷ2 )          ŷ1    ŷ2                 F̄y1 ,y2 (ŷ1 , ŷ2 )
                                        S            ˆ ∞ˆ ∞
                                       X
                                               s−2                    ηzs ,R2 fy1 ,y2 (y1 , y2 )
                                    −        β                    τz                                  dy1 dy2
                                                      ŷ1    ŷ2     1 − τ2,zs F̄y1 ,y2 (ŷ1 , ŷ2 )
                                       s=2
                                       ˆ ∞
                                                                              ŷ1 βζ                 fy1 ,y2 (ŷ1 , y2 )
                                    −         β −1 T10 (ŷ1 )         0                     00                           dy2
                                        ŷ2                    1 − T1 (ŷ1 ) + ŷ1 βζT1 (ŷ1 ) F̄y1 ,y2 (ŷ1 , ŷ2 )
                                       ˆ ∞
                                                                        ŷ2 ζ                 fy1 ,y2 (y1 , ŷ2 )
                                    −         T20 (ŷ2 )         0                  00                            dy1 .
                                        ŷ1               1 − T2 (ŷ2 ) + ŷ2 ζT2 (ŷ2 ) F̄y1 ,y2 (ŷ1 , ŷ2 )

Using the definitions of the conditional hazard rates, we obtain formula (38). We similarly obtain
                   δW (T ,h       2 ,ẑ2 ) )
the expression for β F̄ 2,(ŷ                , i.e., formula (38), the only difference being the compounding
                       y2 ,z2 (ŷ2 ,ẑ2 )
of the capital income elasticities.

    We finally show some results about the Clayton copula, used in equation (39).

Generalized Clayton copula. The generalized Clayton copula with correlation parameters (d, ρ),
with d ≥ 1 and ρ ∈ (0, ∞), is defined as
                                       (                                                        )−ρ
                                                          d                    d 1/d
                        C (u, v) =           u−1/ρ − 1          + v −1/ρ − 1                +1         .




                                                                57
Kendall’s tau30 and the coefficients of lower and upper tail dependence are given by:

                     2                         C (q, q)                        C (1 − q, 1 − q) − 1
ρτ = 1 −               , λl = lim                     = 2−ρ/d , λu = 2 + lim                      = 2 − 21/d .
                 2 + ρ1 d       q→0               q                        q→0           q

                                                                       −aj
                                                                       x
If the marginal distributions are Pareto distributed, F̄xj (xj ) = αj cjj    , the log-survival
c.d.f. obtained from the generalized Clayton copula writes
                                                                                         
                                
                                     
                                             a1 /ρ    !d             a2 /ρ    !d 1/d 
                                        −1/ρ x1                   −1/ρ x2
                                                                                         
  ln F̄x1 ,x2 (x1 , x2 ) = −ρ ln 1 +  α1            − 1 + α2                  −1          .
                                
                                            c1                        c2                 
                                                                                          


In the case where d = 1, the ith component of multivariate hazard ratio vector (for i = 1, 2) is
equal to:
                                               ´∞                                                                  −1/ρ
                                         ŷi            fy1 ,y2 (ŷi , y−i ) dy−i
                                                                                                       
            ∂ ln F̄y1 ,y2 (ŷ1 , ŷ2 )         ŷ−i                                                  ai F̄yi (ŷi )
       −ŷi                            =                                             =             −1/ρ               −1/ρ    .
                     ∂yi                               F̄y1 ,y2 (ŷ1 , ŷ2 )            F̄y1 (ŷ1 )       + F̄y2 (ŷ2 )        −1




C         Notations for the Stochastic Model
In the stochastic model outlined in Section 7 (see Golosov, Tsyvinski, and Werquin 2014), we
define the marginal tax rates and virtual incomes in period one as

                                                       ∂T1 (y1 , k1 )
                                        τ1,xj ≡                       ,         ∀xj ∈ {y1 , k1 } ,
                                                          ∂xj
                                           R1 ≡τ1,y1 y1 + τ1,k1 k1 + k0 − T1 (y1 , k1 ) ,

and in period two as

                                                         ∂T2 y1 , x22 , z2
                                                                           
                                   y1 , x22 , z2
                                                   
                           τ2,xj                       ≡                     ,        ∀xj ∈ {y1 , y2 , z2 } ,
                                                             ∂xj
                             R2 y1 , x22 , z2 ≡τ2,y1 y1 + τ2,y2 x22 + τ2,z2 z2 − T2 y1 , x22 , z2 .
                                                                                                

  30
   Kendall’s tau is defined as follows. Consider two random variables x̃1 , x̃2 , independent of x1 , x2 , but with the
same joint distribution. Then ρτ (x1 , x2 ) ≡ E [sign ((x1 − x̃1 ) · (x2 − x̃2 ))].




                                                                           58
We define the choice vector x of an individual with type (k0 , θ1 ) in period one as:
                                                                                     
                                                                y1 (k0 , θ1 )
                                                              y2 (k0 , θ1 , θ2 )
                                                                                     
                                                                                     
                                                                     ..              
                                                                       .
                                                                                     
                                                                                     
                                                                                     
                                        x(k0 ,θ1 )   =
                                                       y2 (k0 , θ1 , θ2 )
                                                                                      .
                                                                                      
                                                               ..                    
                                                      
                                                                .                    
                                                                                      
                                                                         
                                                       y2 k0 , θ1 , θ̄2
                                                                                     
                                                                                      
                                                          k1 (k0 , θ1 )

Note that this vector has a continuum of interior rows, corresponding to all the possible values
                
for θ2 ∈ θ2 , θ̄2 . It will also be the case for the matrices that we define below. However, we
show that all the usual operations on vectors and matrices generalize naturally to this case.
    We define the vector of income effect parameters as
                                                                                                            
                                                                                      ∂y1 /∂R2 x2
                                                                                                   
                                ∂y1 /∂R1
                                                                                    ∂y2 (θ2 ) /∂R2 x2
                                                                                                           
                             ∂y2 (θ2 ) /∂R1                                                                 
                                     ..                                                        ..
                                                                                                            
                  (x)                                      (x)
                I R1     =                           , I R2 (x2 ) =                                         .
                                                                                                            
                                     .                                                       .              
                                                                                    ∂y2 θ̄2 /∂R2 x2
                                                                                                    
                          
                             ∂y2 θ̄2 /∂R1           
                                                     
                                                                      
                                                                      
                                                                                                               
                                                                                                               
                                                                                      ∂z2 /∂R2 x2
                                                                                                   
                                ∂z2 /∂R1

We define the matrix of compensated elasticities with respect to the first-period marginal tax
rates τ1,y1 , τ1,k1 as
                                                                                                          
                                     ∂y1 /∂τ1,y1                  0 ···         0   ∂y1 /∂τ1,k1
                                                                                                          
                                  ∂y2 (θ2 ) /∂τ1,y1              0 ···         0 ∂y2 (θ2 ) /∂τ1,k1        
                                           ..                     .. . .        ..        ..
                                                                                                          
                   E c,(x)   =                                                                            ,
                                                                                                          
                     τ1                     .                      .     .       .         .
                                                                                                        
                              
                                  ∂y2 θ̄2 /∂τ1,y1                0 ···         0 ∂y2 θ̄2 /∂τ1,k1          
                                                                                                           
                                     ∂z2 /∂τ1,y1                  0 ···         0   ∂z2 /∂τ1,k1

and the matrix of compensated elasticities with respect to the second-period marginal tax rates
τ2,y1 x2 , τ2,y2 x2 , τ2,z2 x2 , at point x2 = x21 , x22 , x23 = y1 , x22 , z2 , as
                                                                          

                                ∂y1                                  ∂y1                               ∂y1         
                              ∂τ2,y1 (x2 )
                                             0 ···           0     ∂τ2,y2 (x2 )
                                                                                     0 ···      0    ∂τ2,z2 (x2 )
                              ∂y2 (θ2 )                            ∂y2 (θ2 )                         ∂y2 (θ2 )   
                          
                             ∂τ2,y1 (x2 )
                                             0 ···           0     ∂τ2,y2 (x2 )
                                                                                     0 ···      0    ∂τ2,z2 (x2 )
                                                                                                                  
                                                                                                                  
              c,(x)               ..        .. . .          ..            ..        .. . .     ..        ..      
            E τ2 (x2 )   =
                                   .         .     .         .             .         .     .    .         .      ,
                                                                                                                  
                              ∂y2 (θ̄2 )                              ∂y2 (θ̄2 )                     ∂y2 (θ̄2 ) 
                          
                             ∂τ2,y1 (x2 )
                                             0 ···           0     ∂τ2,y2 (x2 )
                                                                                     0 ···      0                 
                                                                                                     ∂τ2,z2 (x2 ) 
                                 ∂z2                                  ∂z2                               ∂z2
                              ∂τ2,y1 (x2 )
                                             0 ···           0     ∂τ2,y2 (x2 )
                                                                                     0 ···      0    ∂τ2,z2 (x2 )




                                                                  59
                                                                      c,(x)
where the only non-zero interior column of E x,τ2 (x2 ) is the one indexed by θ2∗ , where θ2∗ is such
that y2 (k0 , θ1 , θ2∗ ) = x22 .
   Next, we define the gradient vectors of the tax functions as

                                                                                                                  ∂T2
                                                                                                                                y1 , x22 , z2
                                                                                                                                                 
                                                                                                                  ∂y1
                                                                                                                                  0
                                                                                                                                              
                                                                                                                                              
                             
                                      ∂T1
                                                                                                                                ..           
                                      ∂y1   (y1 , k1 )                                         
                                                                                                                                  .
                                                                                                                                               
                                                                                                                                               
                                                                                                                                            
                               
                                               0              
                                                               
                                                                                                                                 0            
                                                ..                                    2
                                                                                                                ∂T2                 2
                                                                                                                                              
              DT1 (y1 , k1 ) =                                 , DT2          y1 , x2 , z2 =                                 y1 , x2 , z2  ,
                                                                                                                                            
                                                .                                                              ∂y2                          
                               
                                            0                 
                                                               
                                                                                               
                                                                                                                                 0            
                                                                                                                                               
                                      ∂T1                                                                                         ..          
                                      ∂k1   (y1 , k1 )                                         
                                                                                                                                   .          
                                                                                                                                               
                                                                                                                                  0
                                                                                                                                              
                                                                                                                                              
                                                                                                                  ∂T2                 2
                                                                                                                                             
                                                                                                                  ∂z2           y1 , x2 , z2

where the only non-zero element in the (continuum of) interior rows of DT2 y1 , x22 , z2 is in the
                                                                                        

row indexed by θ2∗ , where θ2∗ is such that y2 (k0 , θ1 , θ2∗ ) = x22 .
   We finally define the Hessian matrices as

                                                      ∂ 2 T1                                                 ∂ 2 T1
                                                                                                                                       
                                                       ∂y12
                                                               (y1 , k1 )       0 ···                 0     ∂y1 ∂k1    (y1 , k1 )
                                                                                                                                       
                                                              0                0 ···                 0               0                 
                                                               ..               .. . .                ..              ..
                                                                                                                                       
                   D2 T1 (y1 , k1 ) =                                                                                                  ,
                                                                                                                                       
                                                                .                .     .               .               .
                                                                                                                                       
                                      
                                                              0          0 ···                       0                0                
                                                                                                                                        
                                                      ∂ 2 T1                                                 ∂ 2 T1
                                                     ∂y1 ∂k1   (y1 , k1 ) 0 · · ·                     0      ∂k12
                                                                                                                      (y1 , k1 )

and
                             ∂ 2 T2                                          ∂ 2 T2                                                 ∂ 2 T2
                                                                                                                                                      
                                           x2                                                x2                                                  x2
                                                                                                 
                              ∂y12
                                                       0 ···         0      ∂y1 ∂y2                        0 ···           0       ∂y1 ∂z2
                                                                                                                                                   
                      
                                     0                0 ···         0                  0                  0 ···           0                0       
                                                                                                                                                    
                                     ..               .. . .        ..                 ..                 .. . .          ..               ..      
                      
                                      .                .     .       .                  .                  .     .         .                .      
                                                                                                                                                    
                                      0                0 ···         0                  0                  0 ···           0              0
                                                                                                                                                   
                                                                                                                                                   
                             ∂ 2 T2                                            ∂ 2 T2                                                 2
                                                                                                                                    ∂ T2
          2       2                        x2                                                x2                                                 2
                                                                                                                                               
        D T2     x =      ∂y1 ∂y2                    0 ···         0          ∂y22
                                                                                                           0 ···           0       ∂y2 ∂z2 x
                                                                                                                                                    ,
                                                                                                                                                    
                                                       0 ···                                               0 ···
                                                                                                                                                   
                                     0                              0                  0                                  0              0         
                                      ..               .. . .        ..                 ..                 .. . .          ..             ..
                                                                                                                                                   
                                                              .                                                   .
                                                                                                                                                   
                      
                                      .                .             .                  .                  .               .              .        
                                                                                                                                                    
                      
                                     0                0 ···         0                  0                  0 ···           0              0         
                                                                                                                                                    
                             ∂ 2 T2                                          ∂ 2 T2                                                   2
                                                                                                                                    ∂ T2
                                           x2                                                x2                                                2
                                                                                                                                               
                            ∂y1 ∂z2                    0 ···         0      ∂y2 ∂z2                        0 ···           0         ∂z 2
                                                                                                                                             x
                                                                                                                                        2


where the only non-zero elements in the (continuum of) interior rows (resp., columns) of
D2 T2 x2 are in the row (resp., column) indexed by θ2∗ , where θ2∗ is such that y2 (k0 , θ1 , θ2∗ ) = x22 .
        

   The perturbations dτ1 , dτ2 x2 of the marginal tax rates faced by an individual y1 , x2 , k1
                                                                                                       



                                                                          60
that we condider in formula (41) are defined as the changes in the gradient vectors defined above,
that is                                                   0
                             dτ1 = dτ1,y1 0 . . . 0 dτ1,k1    ,
                                                                            0
                    dτ2 x2 = dτ2,y1 0 . . . 0 dτ2,y2 0 . . . 0 dτ2,z2
                               
                                                                                ,

where the only non-zero element of dτ2 x2 is indexed by θ2∗ , that is the second period type
                                                

such that z2 (k0 , θ1 , θ2∗ ) = x22 .




                                               61
