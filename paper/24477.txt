                              NBER WORKING PAPER SERIES




                 ON HECKITS, LATE, AND NUMERICAL EQUIVALENCE

                                      Patrick M. Kline
                                    Christopher R. Walters

                                      Working Paper 24477
                              http://www.nber.org/papers/w24477


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                                Cambridge, MA 02138
                          April 2018, Revised October 2018




We thank Josh Angrist, David Card, James Heckman, Magne Mogstad, Parag Pathak, Demian
Pouzo, Raffaele Saggio, and Andres Santos for helpful discussions. The views expressed herein
are those of the authors and do not necessarily reflect the views of the National Bureau of
Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Patrick M. Kline and Christopher R. Walters. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
On Heckits, LATE, and Numerical Equivalence
Patrick M. Kline and Christopher R. Walters
NBER Working Paper No. 24477
April 2018, Revised October 2018
JEL No. C01,C26,C31,C52

                                         ABSTRACT

Structural econometric methods are often criticized for being sensitive to functional form
assumptions. We study parametric estimators of the local average treatment effect (LATE)
derived from a widely used class of latent threshold crossing models and show they yield LATE
estimates algebraically equivalent to the instrumental variables (IV) estimator. Our leading
example is Heckman’s (1979) two-step (“Heckit”) control function estimator which, with two-
sided non-compliance, can be used to compute estimates of a variety of causal parameters.
Equivalence with IV is established for a semi-parametric family of control function estimators
and shown to hold at interior solutions for a class of maximum likelihood estimators. Our results
suggest differences between structural and IV estimates often stem from disagreements about the
target parameter rather than from functional form assumptions per se. In cases where equivalence
fails, reporting structural estimates of LATE alongside IV provides a simple means of assessing
the credibility of structural extrapolation exercises.


Patrick M. Kline
Department of Economics
University of California, Berkeley
530 Evans Hall #3880
Berkeley, CA 94720
and NBER
pkline@econ.berkeley.edu

Christopher R. Walters
Department of Economics
University of California, Berkeley
530 Evans Hall #3880
Berkeley, CA 94720-3880
and NBER
crwalters@econ.berkeley.edu
1     Introduction
In a seminal paper, Imbens and Angrist (1994) proposed an interpretation of the instrumental variables (IV)
estimand as a Local Average Treatment Effect (LATE) – an average effect for a subpopulation of “compliers”
compelled to change treatment status by an external instrument. The plausibility and transparency of the
conditions underlying this interpretation are often cited as an argument for preferring IV estimators to nonlinear
estimators based on parametric models (Angrist and Pischke, 2009, 2010). On the other hand, LATE itself has
been criticized as difficult to interpret, lacking in policy relevance, and problematic for generalization (Heckman,
1997; Deaton, 2009; Heckman and Urzua, 2010). Adherents of this view favor estimators motivated by joint
models of treatment choice and outcomes with structural parameters defined independently of the instrument
at hand.
    This note develops some connections between IV and structural estimators intended to clarify how the choice
of estimator affects the conclusions researchers obtain in practice. Our first result is that, in the familiar binary
instrument/binary treatment setting with imperfect compliance, a wide array of structural “control function”
estimators derived from parametric threshold-crossing models yield LATE estimates numerically identical to IV.
Notably, this equivalence applies to appropriately parameterized variants of Heckman’s (1976; 1979) classic two-
step (“Heckit”) estimator that are nominally predicated on bivariate normality. Differences between structural
and IV estimates therefore stem in canonical cases entirely from disagreements about the target parameter
rather than from functional form assumptions.
    After considering how this result extends to settings with instruments taking multiple values, we probe
its limits by examining some estimation strategies where equivalence fails. First, we revisit a control function
estimator considered by LaLonde (1986) and show that it produces results identical to IV only under a symmetry
condition on the estimated probability of treatment. Next, we study an estimator motivated by a selection
model that violates the monotonicity condition of Imbens and Angrist (1994) and establish that it yields a LATE
estimate different from IV, despite fitting the same sample moments. Standard methods of introducing observed
covariates also break the equivalence of control function and IV estimators, but we discuss a reweighting
approach that ensures equivalence is restored. We then consider full information maximum likelihood (FIML)
estimation of some generalizations of the textbook bivariate probit model and show that this yields LATE
estimates that coincide with IV at interior solutions. However, FIML diverges from IV when the likelihood is
maximized on the boundary of the structural parameter space, which serves as the basis of recent proposals for
testing instrument validity in just-identified settings (Huber and Mellace, 2015; Kitagawa, 2015). Finally, we
discuss why estimation of over-identified models generally yields LATE estimates different from IV.
    The equivalence results developed here provide a natural benchmark for assessing the credibility of structural
estimators, which typically employ a number of over-identifying restrictions in practice. As Angrist and Pischke
(2010) note: “A good structural model might tell us something about economic mechanisms as well as causal
effects. But if the information about mechanisms is to be worth anything, the structural estimates should line
up with those derived under weaker assumptions.” Comparing the model-based LATEs implied by structural




                                                         2
estimators with unrestricted IV estimates provides a transparent assessment of how conclusions regarding a
common set of behavioral parameters are influenced by the choice of estimator. A parsimonious structural
estimator that rationalizes a variety of IV estimates may reasonably be deemed to have survived a “trial by
fire,” lending some credibility to its predictions.



2     Two views of LATE
We begin with a review of the LATE concept and its link to IV estimation. Let Yi represent an outcome of
interest for individual i, with potential values Yi (1) and Yi (0) indexed against a binary treatment Di . Similarly,
let Di (1) and Di (0) denote potential values of the treatment indexed against a binary instrument Zi . Realized
treatments and outcomes are linked to their potential values by the relations Di = Zi Di (1) + (1 − Zi ) Di (0)
and Yi = Di Yi (1) + (1 − Di ) Yi (0). Imbens and Angrist (1994) consider instrumental variables estimation under
the following assumptions:

IA.1 Independence/Exclusion: (Yi (1), Yi (0), Di (1), Di (0)) ⊥⊥ Zi .

IA.2 First Stage: P r [Di = 1|Zi = 1] > P r [Di = 1|Zi = 0].

IA.3 Monotonicity: P r [Di (1) ≥ Di (0)] = 1.

Assumption IA.1 requires the instrument to be as good as randomly assigned and to influence outcomes only
through its effect on Di . Assumption IA.2 requires the instrument to increase the probability of treatment,
and assumption IA.3 requires the instrument to weakly increase treatment for all individuals.
    Imbens and Angrist (1994) define LATE as the average treatment effect for “compliers” induced into treat-
ment by the instrument (for whom Di (1) > Di (0)). Assumptions IA.1-IA.3 imply that the population Wald
(1940) ratio identifies LATE:

                   E [Yi |Zi = 1] − E [Yi |Zi = 0]
                                                   = E [Yi (1) − Yi (0)|Di (1) > Di (0)] ≡ LAT E.
                   E [Di |Zi = 1] − E [Di |Zi = 0]
                                                                                n
    Suppose we have access to an iid vector of sample realizations {Yi , Di , Zi }i=1 obeying the following condition:

                 P1                        1
                          P                         P
Condition 1.              i   Zi Di >   P
                                                        i (1   − Zi )Di .
                   i Zi                 i (1−Zi )



When IA.2 is satisfied the probability of Condition 1 being violated approaches zero at an exponential rate in
n. The analogy principle suggests estimating LATE
                                                P with:
                                         P1                  P 1
                                                                        P
                                  IV
                                           i Zi    i Zi Yi −  i (1−Zi )  i (1 − Zi )Yi
                           LAT
                            \E =
                                          1
                                                P                1
                                                                        P              .
                                                  i Zi Di −              i (1 − Zi )Di
                                        P                    P
                                            Zi      i           (1−Zi )     i


This IV estimator is well-defined under Condition 1, and is consistent for LAT E under assumptions IA.1-IA.3
and standard regularity conditions.




                                                                      3
Threshold-crossing representation

Vytlacil (2002) showed that the LATE model can be written as a joint model of potential outcomes and self-
selection in which treatment is determined by a latent index crossing a threshold. Suppose treatment status is
generated by the equation

                                              Di = 1 {ψ(Zi ) ≥ Vi },

where the latent variable Vi is independently and identically distributed according to some continuous distri-
bution with cumulative distribution function FV (.) : R → [0, 1], and ψ (.) : {0, 1} → R defines instrument-
dependent thresholds below which treatment ensues. Typically FV (.) is treated as a structural primitive
describing a stable distribution of latent costs and benefits influencing program participation that exists inde-
pendently of a particular instrument, as in the classic selection models of Roy (1951) and Heckman (1974). We
follow Heckman and Vytlacil (2005) and work with the equivalent transformed model


                                              Di = 1 {P (Zi ) ≥ Ui } ,                                            (1)

where Ui ≡ FV (Vi ) follows a uniform distribution and P (Zi ) ≡ FV (ψ(Zi )) is the propensity score. The
instrument Zi is presumed to increase the likelihood of treatment (P (1) > P (0)), and to be independent of Ui
and potential outcomes:
                                             (Yi (1), Yi (0), Ui ) ⊥⊥ Zi .                                        (2)

    The selection model defined by (1) and (2) is equivalent to the treatment effects model described by assump-
tions IA.1-IA.3. Equation (1) merely translates the behavioral responses that are permitted in the LATE model
into a partition of the unit interval. In the terminology of Angrist et al. (1996), assumption IA.3 implies that the
population consists of compliers with Di (1) > Di (0), “always takers” with Di (1) = Di (0) = 1, and “never takers”
with Di (1) = Di (0) = 0. The latent variable Ui is defined such that always takers have Ui ∈ [0, P (0)], compliers
have Ui ∈ (P (0), P (1)], and never takers have Ui ∈ (P (1), 1]. Condition (2) implies that potential outcomes and
treatment choices are independent of the instrument and imposes no further restrictions on the joint distribution
of these quantities. It follows that we can equivalently define LAT E = E [Yi (1) − Yi (0)|P (0) < Ui ≤ P (1)].
    Though Vytlacil’s (2002) results establish equivalence between a non-parametric latent index model and
the LATE model, the fully non-parametric model is typically not used for estimation. Rather, to motivate
alternatives to IV estimation, it is conventional to make additional assumptions regarding the joint distribution
of the latent cost Ui and the potential outcomes (Yi (1), Yi (0)). The goal of this note is to investigate the
consequences of such assumptions for empirical work.



3     Control function estimation
We begin by considering estimators predicated on the existence of a parametric “control function” capturing
the endogeneity in the relationship between outcomes and treatment (Heckman and Robb, 1985; Blundell and




                                                          4
Matzkin, 2014; Wooldridge, 2015). The workhorse models in this literature obey the following semi-parametric
restriction:
                       E [Yi (d)|Ui = u] = αd + γd × (J(u) − µJ ) , d ∈ {0, 1} , u ∈ (0, 1),                    (3)

where J(·) : (0, 1) → R is a strictly increasing continuous function and µJ ≡ E [J(Ui )]. Lee (1982) studied this
dependence structure in the context of classic “one-sided” selection problems where outcomes are only observed
when Di = 1. Setting J(·) equal to the inverse normal CDF yields the canonical Heckman (1976; 1979) sample
selection (“Heckit”) model, while choosing J(u) = u yields the linear selection model studied by Olsen (1980),
and choosing the inverse logistic CDF for J (.) yields the logit selection model considered by Mroz (1987).
   Subsequent work applies versions of (3) to policy evaluation by modeling program participation as a “two-
sided” sample selection problem with coefficients indexed by the treatment state d. For example, Bjorklund
and Moffitt (1987) build on the Heckit framework by assuming J(·) is the inverse normal CDF and allowing
α1 6= α0 , γ1 6= γ0 . Likewise, the linear estimator of Brinch et al. (2017) is a two-sided variant of Olsen’s
(1980) approach that imposes an identity J(·) function with coefficients indexed by d. Interestingly, Dubin
and McFadden’s (1984) classic multinomial selection model collapses in the binary treatment effects case to a
two-sided version of Mroz’s (1987) logit model.
   Assumption (3) nullifies Vytlacil’s (2002) equivalence result by imposing restrictions on the relationships
between mean potential outcomes of subgroups that respond differently to the instrument Zi . Let µdg denote
the mean of Yi (d) for group g ∈ {at, nt, c}, representing always takers, never takers and compliers. For any
strictly increasing J(·), equation (3) implies sgn(µdat − µdc ) = sgn(µdc − µdnt ) for d ∈ {0, 1}. In contrast, the
nonparametric model defined by assumptions IA.1-IA.3 is compatible with any arrangement of differences in
mean potential outcomes for the three subgroups. We next consider whether these additional restrictions are
consequential for estimation of LATE.


LATE

When non-compliance is “two-sided” so that 0 < P (0) < P (1) < 1, equation (3) implies that mean outcomes
conditional on treatment status are

                                      E [Yi |Zi , Di = d] = αd + γd λd (P (Zi )),

where λ1 (·) : (0, 1) → R and λ0 (·) : (0, 1) → R are control functions giving the means of (J (Ui ) − µJ ) when Ui
is truncated from above and below at p ∈ (0, 1):

                        λ1 (p) = E [J(Ui ) − µJ |Ui ≤ p] , λ0 (p) = E [J(Ui ) − µJ |Ui > p].

While attention in parametric selection models often focuses on the population average treatment effect
α1 − α0 (Garen, 1984; Heckman, 1990; Wooldridge, 2015), equation (3) can also be used to compute
treatment effects for other subgroups. The average effect on compliers can be written


                                  LAT E = α1 − α0 + (γ1 − γ0 ) Γ (P (0), P (1)) ,                               (4)




                                                          5
where Γ(p, p0 ) gives the mean of J(Ui ) − µJ when Ui lies between p and p0 > p:

                                                                                       p0 λ1 (p0 ) − pλ1 (p)
                                   Γ(p, p0 ) = E [J(Ui ) − µJ |p < Ui ≤ p0 ] =                               .
                                                                                              p0 − p

The last term in (4) adjusts the average treatment effect to account for non-random selection into compliance
with the instrument.


Estimation

To motivate control function estimation, suppose that the sample exhibits two-sided non-compliance as follows:
                          P                        P
Condition 2. 0 <             i   1{Di = d}Zi <         i   1 {Di = d} for d ∈ {0, 1}.


This condition requires at least one observation with every combination of Zi and Di . Condition 2 is satisfied
with probability approaching one at an exponential rate in n whenever 0 < P r[Zi = 1] < 1 and 0 < P (z) < 1
for z ∈ {0, 1}.

   Control function estimation typically proceeds in two steps, both for computational reasons and because of
the conceptual clarity of plug-in estimation strategies (Heckman, 1979; Smith and Blundell, 1986). Deferring
a discussion of one-step estimation approaches to later sections, we define the control function estimator as a
procedure which first fits the choice model in equation (1) by maximum likelihood, then builds estimates of
λ1 (·) and λ0 (·) to include in second-step ordinary least squares (OLS) regressions for each treatment category.
The first step estimates can be written

                                                             X                      X
                          P̂ (0), P̂ (1) = arg     max             Di log P (Zi ) +    (1 − Di ) log (1 − P (Zi )).                  (5)
                                                 P (0),P (1)
                                                               i                       i


The second step OLS estimates are

                                                   X              h                          i2
                      (α̂d , γ̂d ) = arg min            1 {Di = d} Yi − αd − γd λd (P̂ (Zi )) , d ∈ {0, 1}.                          (6)
                                          αd ,γd
                                                   i


The analogy principle then suggests the following plug-in estimator of LATE:

                                                 CF
                                        LAT
                                        \E             = (α̂1 − α̂0 ) + (γ̂1 − γ̂0 ) Γ(P̂ (0), P̂ (1)).

                                                                            P                        P
   Note that when non-compliance is “one-sided” so that                      i   Di (1−Zi ) = 0 or        i (1−Di )Zi   = 0, the maximum
likelihood estimates in (5) are not well-defined. Condition 2 ensures that P̂ (0) and P̂ (1) exist, and that α̂d and
γ̂d can be computed for each value of d. Condition 1 additionally ensures that P̂ (0) < P̂ (1), guaranteeing that
       CF
LAT
\E          exists.




                                                                        6
4     Equivalence results
                          IV               CF
Compared to LAT
            \E                 , LAT
                                 \E               would seem to be highly dependent upon the functional form assumed for
J(·) and the linearity of equation (3). Our first result shows that this is not the case.
                                                                                   CF                      IV
Theorem 1. If Conditions 1 and 2 hold then LAT
                                           \E                                           = LAT
                                                                                          \E                    .
                                                                                                                                                        P
                                                                                                                                                         i 1{Zi =z}Di
Proof: The maximum likelihood procedure in (5) yields the empirical treatment rates P̂ (z) =                                                             P
                                                                                                                                                           i 1{Zi =z}

for z ∈ {0, 1}. The second-step OLS regressions can be rewritten
                               P                h                   i    h                         i 2
         (α̂d , γ̂d ) = arg min i 1 {Di = d} Yi − αd + γd λd (P̂ (0)) − γd λd (P̂ (1)) − λd (P̂ (0)) Zi .
                               αd ,γd

This is a least squares fit of Yi on an intercept and the indicator Zi in the subsample with Di = d. Such
regressions can be estimated as long as there is two-sided non-compliance with the instrument Zi , which
                                                             P
                                                              i 1{Di =d}1{Zi =z}Yi
follows from Condition 2. Defining Ȳdz ≡                    P                     ,                we have
                                                                i 1{Di =d}1{Zi =z}

                                                                                h                         i
                                 Ȳd0 = α̂d + γ̂d λd (P̂ (0)), Ȳd1 − Ȳd0 = γ̂d λd (P̂ (1)) − λd (P̂ (0)) .

Under Condition 1, we have λd (P̂ (1)) 6= λd (P̂ (0)), and this pair of equations can be solved for γ̂d and α̂d as

                                                          Ȳd1 −Ȳd0                       λd (P̂ (1))Ȳd0 −λd (P̂ (0))Ȳd1
                                         γ̂d =    λd (P̂ (1))−λd (P̂ (0))
                                                                          ,       α̂d =       λd (P̂ (1))−λd (P̂ (0))
                                                                                                                            .

    We can therefore rewrite the control function estimate of LATE as

                                        CF        h
                                                       λ1 (P̂ (1))Ȳ10 −λ1 (P̂ (0))Ȳ11
                                                                                          i         h
                                                                                                        λ0 (P̂ (1))Ȳ00 −λ0 (P̂ (0))Ȳ01
                                                                                                                                           i
                               LAT
                               \E             =            λ1 (P̂ (1))−λ1 (P̂ (0))
                                                                                               −            λ0 (P̂ (1))−λ0 (P̂ (0))

                                       Ȳ11 −Ȳ10                            Ȳ01 −Ȳ00
                          h                             i       h                             i                                                 
                                                                                                             P̂ (1)λ1 (P̂ (1))−P̂ (0)λ1 (P̂ (0))
                      +        λ1 (P̂ (1))−λ1 (P̂ (0))
                                                             −       λ0 (P̂ (1))−λ0 (P̂ (0))
                                                                                                    ×                   P̂ (1)−P̂ (0)
                                                                                                                                                    .

Using the fact that λ0 (p) = −λ1 (p)p/(1 − p), this simplifies to
                                   h                              i h                               i
                                             1                  1              0                  0
                            CF      P̂ (1)Ȳ1  + (1 − P̂ (1))Ȳ0   −  P̂ (0)Ȳ1  + (1 − P̂ (0))Ȳ0
                     LAT
                     \E        =                                                                      ,
                                                            P̂ (1) − P̂ (0)
                 IV
which is LAT
         \E           . 
                                                                                                                CF
Remark 1. An immediate consequence of Theorem 1 is that LAT
                                                        \E                                                           is also equivalent to the coefficient on
Di associated with a least squares fit of Yi to Di and a first stage residual Di − P̂ (Zi ). Blundell and Matzkin
(2014) attribute the first proof of the equivalence between this estimator and IV to Telser (1964).

Remark 2. Theorem 1 extends the analysis of Brinch et al. (2017) who observe that linear control function
estimators produce LATE estimates numerically equivalent to IV. The above result implies that a wide class
of non-linear control function estimators share this property. With a binary treatment and instrument, an
instrumental variables estimate can always be viewed as the numerical output of a variety of parametric control
function estimators.




                                                                                    7
Potential outcome means

Corresponding equivalence results hold for estimators of other parameters identified in the LATE framework.
Imbens and Rubin (1997) and Abadie (2002) discuss identification and estimation of the treated outcome
distribution for always takers, the untreated distribution for never takers, and both marginal distributions for
compliers. Nonparametric estimators of the four identified marginal mean potential outcomes are given by

                                                               µ̂IV       0    IV       1
                                                                 1at = Ȳ1 , µ̂0nt = Ȳ0 ,

                                                   P̂ (1)Ȳ11 −P̂ (0)Ȳ10                   (1−P̂ (0))Ȳ00 −(1−P̂ (1))Ȳ01
                                       µ̂IV
                                         1c =          P̂ (1)−P̂ (0)
                                                                          ,    µ̂IV
                                                                                 0c =               P̂ (1)−P̂ (0)
                                                                                                                           .

   The corresponding control function estimators are:

                                        µ̂CF                             CF
                                          1at = α̂1 + γ̂1 λ1 (P̂ (0)), µ̂0nt = α̂0 + γ̂0 λ0 (P̂ (1)),


                                               µ̂CF
                                                 dc = α̂d + γ̂d Γ(P̂ (0), P̂ (1)), d ∈ {0, 1}.


The following proposition shows that these two estimation strategies produce algebraically identical results.

Proposition 1. If Conditions 1 and 2 hold then

                                       µ̂CF     IV
                                         dg = µ̂dg for (d, g) ∈ {(1, at), (0, nt), (1, c), (0, c)}.


Proof: Using the formulas from the proof of Theorem 1, the control function estimate of µ1at is

                                        λ1 (P̂ (1))Ȳ10 −λ1 (P̂ (0))Ȳ11                        Ȳ11 −Ȳ10
                                                                                                                
                        µ̂CF
                          1at =             λ1 (P̂ (1))−λ1 (P̂ (0))
                                                                                +       λ1 (P̂ (1))−λ1 (P̂ (0))
                                                                                                                       λ1 (P̂ (0)) = Ȳ10 ,

which is µ̂IV
           1at . Likewise,

                                       λ0 (P̂ (1))Ȳ00 −λ0 (P̂ (0))Ȳ11                         Ȳ01 −Ȳ00
                                                                                                               
                       µ̂CF
                         0nt =             λ0 (P̂ (1))−λ0 (P̂ (0))
                                                                                +       λ0 (P̂ (1))−λ0 (P̂ (0))
                                                                                                                       λ0 (P̂ (1)) = Ȳ01 ,

which is µ̂IV
           0nt . The treated complier mean estimate is

                            λ1 (P̂ (1))Ȳ10 −λ1 (P̂ (0))Ȳ11                       Ȳ11 −Ȳ10
                                                                                                                                                   
                                                                                                                  P̂ (1)λ1 (P̂ (1))−P̂ (0)λ1 (P̂ (0))
               µ̂CF
                 1c =           λ1 (P̂ (1))−λ1 (P̂ (0))
                                                                   +       λ1 (P̂ (1))−λ1 (P̂ (0))
                                                                                                          ×                  P̂ (1)−P̂ (0)

                            (λ1 (P̂ (1))−λ1 (P̂ (0)))P̂ (1)Ȳ11 −(λ1 (P̂ (1))−λ1 (P̂ (0)))P̂ (0)Ȳ10                     P̂ (1)Ȳ11 −P̂ (0)Ȳ10
                       =                                                                             =                                          ,
                                          (λ1 (P̂ (1))−λ1 (P̂ (0)))(P̂ (1)−P̂ (0))                                           P̂ (1)−P̂ (0)

                                              IV                                                 CF
which is µ̂IV
           1c . Noting that LAT E
                            \                       = µ̂IV     IV
                                                        1c − µ̂0c and LAT E
                                                                      \                               = µ̂CF     CF
                                                                                                          1c − µ̂0c , it then follows by Theorem 1

that µ̂CF     IV
       0c = µ̂0c . 




                                                                                    8
5      Equivalence and extrapolation
Proposition 1 establishes that all control function estimators based on equation (3) produce identical estimates of
the potential outcome means that are nonparametrically identified in the LATE framework. Different functional
form assumptions generate different estimates of quantities that are under-identified, however. For example,
the choice of J(·) in equation (3) determines the shapes of the curves that the model uses to extrapolate
from estimates of the four identified potential outcome means (µ1at , µ0nt , µ1c , µ0c ) to the two under-identified
potential outcome means (µ0at , µ1nt ).



                                                                       Figure 1: "Heckit" extrapolation


                                              5




                                                                                                                  N = (") = +$ [5. (1)|-. = "]
                                                                                                                  M


                  D$ (=)
                              ; <= (")
    8B= + :B= C                           6"                                                                                                               Implied effect for
              D$ (E)       #$(1) − #$ (0)                                                                                                                    never takers
                                                                                                          Ĝ =K


                               D$ (E)
                                        ;<= (")
           8B= + :B= C                          6"
                           E             #$ (0)                                                          A
                                                                                                        >?@+
                           =
                                                             Ĝ =LJ
                             ;<= (")
         8B E + :BE C                 6"
                                $
                     D$ (=) 1 − # (1)                                                                                                                       Ĝ EIJ
                                                             Implied effect for
                                                               always takers
                  D$ (=)
                               ; <= (")                                                                                N E (") = +$ [5. (0)|-. = "]
                                                                                                                       M
    8BE + :BE C                           6"
              D$ (E)       #$ (1) − #$(0)                                                                 Ĝ EK




                                                        #$ (0)                    #$ (0)       #$ (1) + #$(0)                  #$ (1)                 1 + #$ (1)                "
                                                                                                                                                                         1
                                                           2                                          2                                                  2


                                                     +$ [-. |01]                                 +$ [-. |3]                                           +$ [-. |41]


                                                                             “Heckit” model: +[5. (6)|-. ] = 89 + :9 ; <= (-. )




    Figures 1 and 2 illustrate this extrapolation in a hypothetical example. The horizontal axis plots val-
ues u of the unobserved treatment cost Ui , while the vertical axis plots mean potential outcomes md (u) =
E [Yi (d)|Ui = u] as functions of this cost. Estimates of these functions are denoted m̂d (u) = α̂d +γ̂d ×(J(u)−µJ )
and their difference m̂1 (u) − m̂0 (u) provides an estimate of the marginal treatment effect (Bjorklund and Mof-
fitt, 1987; Heckman and Vytlacil, 2005; Heckman et al., 2006) for an individual with latent cost u.
    Assumptions IA.1-IA3 ensure two averages of md (Ui ) are identified for each potential outcome: the treated




                                                                                           9
means for always takers and compliers, and the untreated means for never takers and compliers. The control
function estimator chooses α̂d and γ̂d so that averages of m̂d (Ui ) over the relevant ranges match the correspond-
ing nonparametric estimates for each compliance group. The coefficient γ̂1 parameterizes the difference in mean
treated outcomes between compliers and always takers, while γ̂0 measures the difference in mean untreated
outcomes between compliers and never takers. Several tests of endogeneous treatment assignment (see, e.g.,
Angrist, 2004; Battistin and Rettore, 2008; Bertanha and Imbens, 2014; and Kowalski, 2016) amount to testing
whether (γ̂0 , γ̂1 ) are significantly different from zero.


                                                                Figure 2: Linear extrapolation


                                       5




                                                                                                     M B (") = +$ [5. (1)|-. = "]
                                                                                                     L




                   #$ (1) + #$ (0) − 1
     8AB + :AB C                       D                                                                                                       Implied effect for
                            2                                                                F̂ BJ                                               never takers




                            #$ (0) − 1
              8AB + :AB C              D
                                 2               F̂ BKI                                       @
                                                                                             =>?+
                                #$ (1)
                    8AE + :AE C        D
                                   2                                                                                                           F̂ EHI
                                                 Implied effect for
                                                   always takers
                                                                                                                M E (") = +$ [5. (0)|-. = "]
                                                                                                                L
                 #$ (1) + #$ (0) − 1
     8A E + :AE C                    D
                          2                                                                  F̂ EJ




                                            #$ (0)                    #$ (0)        #$ (1) + #$(0)                  #$ (1)             1 + #$ (1)                   "
                                                                                                                                                               1
                                               2                                           2                                              2


                                           +$ [-. |01]                                +$ [-. |3]                                       +$ [-. |41]


                                                               Linear selection model: +[5. (6)|-. ] = 89 + :9 (-. − 1/2)




   Figure 1 depicts the results of parametric extrapolation based on the Heckit model, while Figure 2 shows
results for the linear control function model discussed by Brinch et al. (2017). Both models match the same four
estimated mean potential outcomes, thereby generating identical estimates of LATE. Note that by Jensen’s
inequality, the nonlinear m̂d (u) curves in Figure 1 do not pass directly through the group mean potential
outcomes. The two models yield different imputations for the missing potential outcomes of always takers and
never takers, and therefore also different estimates of the ATE, which averages over all three subpopulations.
This sensitivity to functional form is intuitive: treatment effects for always and never takers are fundamentally




                                                                               10
under-identified, an insight that has led to consideration of bounds on these quantities (Manski, 1990; Balke
and Pearl, 1997; Mogstad et al., 2016).



6     Multi-valued instruments
Consider an instrument Zi taking values in {0, 1, .., K}, and suppose that 0 < P̂ (z − 1) < P̂ (z) < 1 for
z ∈ {1, 2, ..., K}. Let Di (z) denote i’s treatment choice when Zi = z. If assumptions IA.1-IA.3 hold for
                                                                                      E[Yi |Zi =z]−E[Yi |Zi =z−1]
every pair of instrument values, Wald ratios of the form                              E[Di |Zi =z]−E[Di |Zi =z−1]   identify the average treat-
ment effect among compliers indexed by a unit increment in the instrument, which we denote LAT Ez ≡
E [Yi (1) − Yi (0)|Di (z) > Di (z − 1)]. Analog estimators of LAT Ez are given by the following pairwise IV esti-
mator:
                                            1                                               1
                                                       P                                              P
                     IV              P
                                          1{Zi =z}   i 1{Zi = z}Yi                −   P
                                                                                         1{Zi =z−1}     i   1{Zi = z − 1}Yi
                                       i                                                i
                 LAT
                 \E z          =           1
                                                   P                                        1
                                                                                                      P                       .
                                     P
                                                    i 1{Zi = z}Di                 −   P
                                                                                                        i   1{Zi = z − 1}Di
                                       i 1{Zi =z}                                      i 1{Zi =z−1}

                              IV
From Theorem 1, LAT
                \E z               is numerically equivalent to the corresponding pairwise control function estimator
of LAT Ez constructed from observations with Zi ∈ {z − 1, z}. However, to improve precision, it is common to
impose additional restrictions on the LAT Ez .
    Consider the following restriction on potential outcomes:

                                                                    L
                                                                    X                             `
                                   E [Yi (d)|Ui ] = αd +                  γd` × (J(Ui ) − µJ ) , d ∈ {0, 1}.                                (7)
                                                                    `=1


Polynomial models of this sort have been considered by, among others, Brinch et al. (2017) and Cornelissen
                                                                                                      
et al. (forthcoming). Letting λ1` (p) = E (J(Ui ) − µJ )` |Ui ≤ p and λ0` (p) = E (J(Ui ) − µJ )` |Ui > p , a
two-step control function estimator of the parameters of equation (7) is
                                                 P              h          PL                       i2
             (α̂d , γ̂d1 , ..., γ̂dL ) = arg min   i 1 {Di = d}  Yi − αd −  `=1 γ d` λ d` (P̂ (Zi ))   .
                                                 αd ,γd1 ,...,γdL

The resulting control function estimator of LAT Ez is then

                                                                  L
                                           CF                     X
                               LAT
                               \E z              = (α̂1 − α̂0 ) +   (γ̂1` − γ̂0` )Γ` (P̂ (z − 1), P̂ (z)),                                  (8)
                                                                          `=1


where Γ` (p, p0 ) = [p0 λ1` (p0 ) − pλ1` (p)]/[p0 − p]. The following proposition establishes that this estimator is
                    IV
identical to LAT
             \E z        when L = K.

Proposition 2. If Conditions 1 and 2 hold for every pair of instrument values and the polynomial order L
                         CF                 IV
equals K then LAT
              \E z            = LAT
                                \E z              ∀z ∈ {1, 2, ..., K}.

Proof: See the Appendix. 

Remark 3. Instrumenting Di with a scalar function g(Zi ) generates an IV estimate equal to a convex weighted
                         IV
average of the LAT
               \E z            (Imbens and Angrist, 1994). From Proposition 2, applying these weights to the




                                                                             11
       CF                                                                                                                           CF
LAT
\E z        when L = K will yield an identical result. By contrast, the set of LAT
                                                                               \E z                                                      that result from
                                                                                                 IV
imposing L < K need not correspond to weighted averages of the                               LAT
                                                                                             \E z           , but are likely to exhibit reduced
sampling variability.

Remark 4. When L < K − 1, the restriction in (7) can be used to motivate estimators of particular LATEs
that are convex combinations of IV estimators. In the case where K = 3 and L = 1, one can show that:

                                                                                                                         
                                Γ(P (1),P (2))−Γ(P (0),P (1))                            Γ(P (2),P (3))−Γ(P (1),P (2))
               LAT E2 =         Γ(P (2),P (3))−Γ(P (0),P (1))        LAT E3 +            Γ(P (2),P (3))−Γ(P (0),P (1))          LAT E1 .


This representation suggests combination estimators of the form
                                                                                                                                                      
                     IV                     Γ(P̂ (1),P̂ (2))−Γ(P̂ (0),P̂ (1))
                                                                                           IV      
                                                                                                        Γ(P̂ (2),P̂ (3))−Γ(P̂ (1),P̂ (2))
                                                                                                                                                  IV
\E ξ2 = ξ LAT
LAT       \E 2 + (1 − ξ)                                                            LAT
                                                                                    \E 3 +                                                      LAT
                                                                                                                                                \E 1        ,
                                            Γ(P̂ (2),P̂ (3))−Γ(P̂ (0),P̂ (1))                           Γ(P̂ (2),P̂ (3))−Γ(P̂ (0),P̂ (1))



for ξ ∈ (0, 1). To maximize precision, one can set ξ = [v̂2 − v̂12 ]/[v̂1 + v̂2 − 2v̂12 ] , where v̂1 and v̂2 are estimated
                     IV
variances of LAT
             \E 2          and the term in brackets, respectively, and v̂12 is their covariance. By construction,
                                                                                               IV                               ξ
\E ξ2
LAT                                                       \E 2 . Though LAT
         provides an estimate of LAT E2 more precise than LAT           \E 2 will tend to be less
                      CF                                                                                                ξ
precise than LAT
             \E 2          when restriction (7) is true, the probability limit of LAT
                                                                                  \E 2 retains an interpretation

as a weighted average of causal effects for complier subpopulations when (7) is violated, a robustness property
emphasized elsewhere by Angrist and Pischke (2009).



7     Equivalence failures
Though Theorem 1 establishes equivalence between IV and a wide class of control function estimates of LATE,
other control function estimators fail to match IV even with a single binary instrument. LaLonde (1986)
considered OLS estimation of the following model:

                                             −1
                                  h                                         −1             i
                  Yi = α + βDi + γ Di × − φ(Φ P̂ (Z
                                                 (P̂ (Zi )))
                                                      )
                                                               + (1 − Di ) ×  φ(Φ (P̂ (Zi )))
                                                                                 1−P̂ (Z )
                                                                                                 + i .                                                 (9)
                                                                     i                                              i




By imposing a common coefficient γ on the Mills ratio terms for the treatment and control groups, this
specification allows for selection on levels but rules out selection on treatment effects.
    The term in brackets in equation (9) simplifies to (Di − P̂ (Zi )) × {−φ(Φ−1 (P̂ (Zi )))/[P̂ (Zi )(1 − P̂ (Zi ))]}.
When P̂ (1) = 1 − P̂ (0) this term is proportional to the first stage residual and least squares estimation of (9)
yields an estimate of β numerically identical to IV. This is a finite sample analogue of Heckman and Vytlacil’s
(2000) observation (elaborated upon in Angrist, 2004) that LATE equals ATE when both the first stage and
the error distribution are symmetric. When P̂ (1) 6= 1 − P̂ (0), however, the control function in equation (9)
differs from the first stage residual and the estimate of β will not match IV.

Remark 5. When P̂ (1) = 1 − P̂ (0), the ATE estimate α̂1 − α̂0 from a control function estimator of the form
given in (6) coincides with IV whenever J(Ui ) is presumed to follow a symmetric distribution.




                                                                         12
Moments and monotonicity

Theorem 1 relied upon the fact that equation (3) includes enough free parameters to allow the control function
estimator to match the sample mean of Yi for every combination of Di and Zi . One might be tempted to
conclude that any structural estimator that fits these moments will produce a corresponding LATE estimate
equal to IV. We now show that this is not the case.
   Suppose that treatment status is generated by a heterogeneous threshold crossing model:


                                                 Di = 1 {κ + δi Zi ≥ Ui } ,                                            (10)


where Ui is uniformly distributed and the random coefficient δi is a mixture taking values in {−η, η} for some
known positive constant η. Define υ ≡ P r [δi = η], and suppose that δi is independent of (Yi (1), Yi (0), Ui , Zi ).
Note that this model does not admit a representation of the form of equation (1) as it allows Di (1) < Di (0).
   Model (10) has two unknown parameters, κ and υ, and can therefore rationalize the two observed choice
probabilities by choosing κ̂ = P̂ (0) and υ̂ = (η + P̂ (1) − P̂ (0))/2η. Equations (3) and (10) imply

                        E [Yi |Di = d, Zi ] = αd + γd × [υλd (κ + ηZi ) + (1 − υ)λd (κ − ηZi )].

As before, we can use κ̂ and υ̂ to construct control functions to include in a second-step regression, producing
estimates α̂d and γ̂d that exactly fit Ȳd1 and Ȳd0 .
   Though this estimator matches all choice probabilities and conditional mean outcomes, it produces an
estimate of LATE different from IV. The model’s implied LATE is

       E [Yi (1) − Yi (0)|Di (1) > Di (0)] = (α1 − α0 ) + (γ1 − γ0 ) × E [J(Ui ) − µJ |δi = η, κ < Ui ≤ κ + η].

The corresponding control function estimator of this quantity is

                                    ∗                               
                                                                        (κ̂+η)λ1 (κ̂+η)−κ̂λ1 (κ̂)
                                                                                                    
                             \E = (α̂1 − α̂0 ) + (γ̂1 − γ̂0 ) ×
                             LAT                                                                        .              (11)
                                                                                    η


                                             ∗                           IV
It is straightforward to verify that LAT
                                     \E is not equal to LAT
                                                        \E                    . Equivalence fails here because the selection
model implies the presence of “defiers” with Di (1) < Di (0). IV does not identify LATE when there are defiers;
hence, the model suggests using a different function of the data to estimate the LATE.


Covariates

It is common to condition on a vector of covariates Xi either to account for possible violations of the exclusion
restriction or to increase precision. Theorem 1 implies that IV and control function estimates of LATE coincide
if computed separately for each value of the covariates, but this may be impractical or impossible when Xi can
take on many values.
   A standard approach to introducing covariates is to enter them additively into the potential outcomes model
(see, e.g., Cornelissen et al., 2016; Kline and Walters, 2016; and Brinch et al., 2017). Suppose treatment choice




                                                            13
is given by Di = 1{P (Xi , Zi ) ≥ Ui } with Ui independent of (Xi , Zi ), and assume


                                  E [Yi (d)|Ui , Xi ] = αd + γd × (J(Ui ) − µJ ) + Xi0 τ, d ∈ {0, 1}.                                    (12)


Letting P̂ (Xi , Zi ) denote an estimate of P r[Di = 1|Xi , Zi ], the control function estimates for this model are

                                                                   X X                     h                                       i2
         (α̂1 , γ̂1 , α̂0 , γ̂0 , τ̂ ) = arg         min                         1 {Di = d} Yi − αd − γd λd (P̂ (Xi , Zi )) − Xi0 τ .    (13)
                                               α1 ,γ1 ,α0 ,γ0 ,τ
                                                                   i   d∈{0,1}


   To ease exposition, we will study the special case of a single binary covariate Xi ∈ {0, 1}. Define LAT E(x) ≡
E[Yi (1) − Yi (0)|P (x, 0) < Ui ≤ P (x, 1), Xi = x] as the average treatment effect for compliers with Xi = x,
and let α̂d (x) and γ̂d (x) denote estimates from unrestricted control function estimation among the observations
with Xi = x. The additive separability restriction in (12) suggests the following two estimators of LAT E(1):

                             CF
                   \E x (1) = (α̂1 (x) − α̂0 (x)) + (γ̂1 (x) − γ̂0 (x)) Γ(P̂ (1, 0), P̂ (1, 1)), x ∈ {0, 1}.
                   LAT

                             CF                                                                             CF
By Theorem 1 LAT
             \E 1 (1) is a Wald estimate for the Xi = 1 sample. LAT
                                                                \E 0 (1) gives an estimated effect

for compliers with Xi = 1 based upon control function estimates for observations with Xi = 0. The following
proposition describes the relationship between these two estimators and the restricted estimator of LAT E (1)
based upon (13).
                                                                                                                                    CF
Proposition 3. Suppose Conditions 1 and 2 hold for each value of Xi ∈ {0, 1} and let LAT
                                                                                     \E r (1) =

(α̂1 − α̂0 ) + (γ̂1 − γ̂0 )Γ(P̂ (1, 0), P̂ (1, 1)) denote an estimate of LAT E(1) based on (13). Then
                  CF                            CF                                CF
         LAT         \E 1 (1) + (1 − w)LAT
         \E r (1) = wLAT               \E 0 (1) + b1 (γ̂1 (1) − γ̂1 (0)) + b0 (γ̂0 (1) − γ̂0 (0)).

The coefficients w, b1 , and b0 depend only on the joint empirical distribution of Di , Xi , and P̂ (Xi , Zi ).
Proof: See the Appendix. 

Remark 6. Proposition 3 demonstrates that control function estimation under additive separability gives a
linear combination of covariate-specific estimates plus terms that equal zero when the separability restrictions
hold exactly in the sample. One can show that the coefficient w need not lie between 0 and 1. By contrast,
two-stage least squares estimation of a linear model with an additive binary covariate using all interactions of
Xi and Zi as instruments generates a weighted average of covariate-specific IV estimates (Angrist and Pischke,
2009).

Remark 7. Consider the following extension of equation (12):

E [Yi (d)|Ui , Xi ] = αd + γd × (J(Ui ) − µJ ) + Xi0 τdc + 1{Ui ≤ P (Xi , 0)}Xi0 τat + 1{Ui > P (Xi , 1)}Xi0 τnt , d ∈ {0, 1}.

This equation allows different coefficients on Xi for always takers, never takers, and compliers by interacting Xi
with indicators for thresholds of Ui , and also allows the complier coefficients to differ for treated and untreated
outcomes. When Xi includes a mutually exclusive and exhaustive set of indicator variables and P̂ (Xi , Zi ) equals




                                                                                 14
the sample mean of Di for each (Xi , Zi ), control function estimation of this model produces the same estimate of
E[Yi |Xi , Di , Di (1) > Di (0)] as the semi-parametric procedure of Abadie (2003). Otherwise the estimates may
differ even asymptotically as the control function estimator employs a different set of approximation weights
when the model is misspecified.

Remark 8. A convenient means of adjusting for covariates that maintains the numerical equivalence of IV
and control function estimates is to weight each observation by ωi = Zi /ê(Xi ) + (1 − Zi )/(1 − ê(Xi )) where
ê(x) ∈ (0, 1) is a first step estimate of P r [Zi = 1|Xi = x]. It is straightforward to show that the ωi −weighted
IV and control function estimates of the unconditional LATE will be identical, regardless of the propensity score
estimator ê(Xi ) employed. See Hull (2016) for a recent application of this approach to covariate adjustment of
a selection model.



8    Maximum likelihood
A fully parametric alternative to two-step control function estimation is to specify a joint distribution for
the model’s unobservables and estimate the parameters in one step via full information maximum likelihood
(FIML). Consider a model that combines (1) and (2) with the distributional assumption


                                                      Yi (d)|Ui ∼ FY |U (y|Ui ; θd ) ,                                                     (14)


where FY |U (y|u; θ) is a conditional CDF indexed by a finite dimensional parameter vector θ. For example, a fully
parametric version of the Heckit model is Yi (d)|Ui ∼ N αd + γd Φ−1 (Ui ), σd2 . Since the marginal distribution
                                                                               

of Ui is also known, this model provides a complete description of the joint distribution of (Yi (d), Ui ). FIML
exploits this distributional knowledge, estimating the model’s parameters as
                                                                                                                                       !
                                                                                 X       Z             P (Zi )
               P̂ (0)M L , P̂ (1)M L , θ̂0M L , θ̂1M L = arg              max       Di log                         fY |U (Yi |u; θ1 ) du
                                                               (P (0),P (1),θ0 ,θ1 )                 0
                                                                                       i
                                                                                                                              !            (15)
                                                                 X              Z            1
                                                               +  (1 − Di ) log                      fY |U (Yi |u; θ0 )du ,
                                                                      i                    P (Zi )


where fY |U (·|u; θd ) ≡ dFY |U (.|u; θd ) denotes the density (or probability mass function) of Yi (d) given Ui = u.
The corresponding FIML estimates of treated and untreated complier means are
                                                      R P̂ (1)M L R ∞
                                                       P̂ (0)M L     −∞
                                                                           yfY |U (y|u; θ̂dM L )dydu
                                         µ̂M
                                           dc
                                              L
                                                  =                                                      ,
                                                                   P̂ (1)M L − P̂ (0)M L
                                                       ML
and the FIML estimate of LATE is LAT
                                 \E                         = µ̂M L    ML
                                                                1c − µ̂0c .




                                                                          15
Binary outcomes

We illustrate the relationship between FIML and IV estimates of LATE with the special case of a binary Yi .
A parametric model for this setting is given by


                                             Yi (d) =1 {αd ≥ id } ,
                                                                                                                 (16)
                                               id |Ui ∼ F|U (|Ui ; ρd ) ,

where F|U (|u; ρ) is a conditional CDF characterized by the single parameter ρ. Equations (1) and (16)
include six parameters, which matches the number of observed linearly independent probabilities (two values
of P r [Di = 1|Zi ], and four values of P r [Yi = 1|Di , Zi ]). The model is therefore “saturated” in the sense that a
model with more parameters would be under-identified.
    The following result establishes the conditions under which maximum likelihood estimates of complier means
(and therefore LATE) coincide with IV.

Proposition 4. Consider the model defined by (1), (2) and (16). Suppose that Conditions 1 and 2 hold, and
that the maximum likelihood problem (15) has a unique solution. Then µ̂M L    IV
                                                                       dc = µ̂dc for d ∈ {0, 1} if and only

if µ̂IV
     dc ∈ [0, 1] for d ∈ {0, 1}.


Proof: See the Appendix. 

Remark 9. The intuition for Proposition 4 is that the maximum likelihood estimation problem can be rewritten
in terms of the six identified parameters of the LATE model: (µ1at , µ0nt , µ1c , µ0c , πat , πc ), where πg is the
population share of group g. Unlike the IV and control function estimators, the FIML estimator accounts for
the binary nature of Yi (d) by constraining all probabilities to lie in the unit interval. When these constraints
do not bind the FIML estimates coincide with nonparametric IV estimates, but the estimates differ when the
nonparametric approach produces complier mean potential outcomes outside the logically possible bounds.
Logical violations of this sort have been proposed elsewhere as a sign of failure of instrument validity (Balke
and Pearl, 1997; Imbens and Rubin, 1997; Huber and Mellace, 2015; Kitagawa, 2015).

Remark 10. A simple “limited information” approach to maximum likelihood estimation is to estimate P (0)
and P (1) in a first step and then maximize the plug-in conditional log-likelihood function
                         R                         X             R                            
                            P̂ (Z )                                   1
                  X
                   Di log 0 i fY |U (Yi |u; θ1 ) du + (1 − Di ) log P̂ (Zi ) fY |U (Yi |u; θ0 )du
                   i                                        i

with respect to (θ0 , θ1 ) in a second stage. One can show that applying this less efficient estimator to a saturated
model will produce an estimate of LATE equivalent to IV under Conditions 1 and 2. This broader domain of
equivalence results from some cross-equation parameter restrictions being ignored by the two-step procedure.
For example, the FIML estimator may choose an estimate of πc other than P̂ (1) − P̂ (0) in order to enforce the
constraint that (µ1c , µ0c ) ∈ [0, 1]2 .




                                                          16
Overidentified models

Equivalence of FIML and IV estimates at interior solutions in our binary example follows from the fact that
the model satisfies monotonicity and includes enough parameters to match all observed choice probabilities.
Similar arguments apply to FIML estimators of sufficiently flexible models for multi-valued outcomes. When
the model includes fewer parameters than observed choice probabilities, overidentification ensues. For example,
the standard bivariate probit model is a special case of (16) that uses a normal distribution for F|U (·) and
imposes i1 = i0 and therefore ρ1 = ρ0 (see Greene, 2007). Hence, only five parameters are available to
rationalize six linearly independent probabilities.
    Maximum likelihood estimation of this more parsimonious model may yield an estimate of LATE that differs
from IV even at interior solutions. This divergence stems from the model’s overidentifying restrictions which,
if correct, may yield efficiency gains but if wrong can compromise consistency. Though maximum likelihood
estimation of misspecified models yields a global best approximation to the choice probabilities (White, 1982),
there is no guarantee that it will deliver a particularly good approximation to the LATE.



9    Model evaluation
In practice researchers often estimate selection models that impose additive separability assumptions on exoge-
nous covariates, combine multiple instruments, and employ additional smoothness restrictions that break the
algebraic equivalence of structural LATE estimates with IV. The equivalence results developed above provide
a useful conceptual benchmark for assessing the performance of structural models in such applications. An
estimator derived from a properly specified model of treatment assignment and potential outcomes should come
close to matching a nonparametric IV estimate of the same parameter. Significant divergence between these
estimates would signal that the restrictions imposed by the structural model are violated.
    Figure 3 shows an example of this approach to model assessment from Kline and Walters’ (2016) reanalysis
of the Head Start Impact Study (HSIS) – a randomized experiment with two-sided non-compliance (Puma
et al., 2012). On the vertical axis are non-parametric IV estimates of the LATE associated with participating
in the Head Start program relative to a next best alternative for various subgroups in the HSIS defined by
experimental sites and baseline child and parent characteristics. On the horizontal axis are two-step control
function estimates of the same parameters derived from a heavily over-identified selection model involving
multiple endogenous variables, baseline covariates, and excluded instruments. Had this model been saturated,
all of the points would lie on the 45 degree line. In fact, a Wald test indicates these deviations from the 45 degree
line cannot be distinguished from noise at conventional significance levels, suggesting that the approximating
model is not too far from the truth.




                                                         17
                                      Figure 3: Model-based and IV estimates of LATE




                   .8
                   .6
                                  χ2(20) = 23.6
                                     p = 0.26
              IV estimate
                    .4
                   .2
                   0




                            -.2        0             .2            .4                  .6              .8
                                                    Model-predicted LATE

           Notes: This figure reproduces Figure A.III from Kline and Walters (2016). The figure is constructed by
           splitting the Head Start Impact Study sample into vingtiles of the predicted LATE based on the control
           function estimates reported in Section VIII of the paper. The horizontal axis displays the average
           predicted LATE in each group, and the vertical axis shows corresponding IV estimates. The dashed line
           is the 45-degree line. The chi-squared statistic and p -value come from a bootstrap Wald test of the
           hypothesis that the 45 degree line fits all points up to sampling error. See Appendix F of Kline and
           Walters (2016) for more details.


   Passing a specification test does not obviate the fundamental identification issues inherent in interpolation
and extrapolation exercises. As philosophers of science have long argued, however, models that survive empirical
scrutiny deserve greater consideration then those that do not (Popper, 1959; Lakatos, 1976). Demonstrating
that a tightly restricted model yields a good fit to IV estimates not only bolsters the credibility of the model’s
counterfactual predictions, but serves to clarify what the estimated structural parameters have to say about the
effects of a research design as implemented. Here the control function estimates reveal that Head Start had very
different effects on different sorts of complying households, a finding rationalized by estimated heterogeneity in
both patterns of selection into treatment and potential outcome distributions.



10     Conclusion
This paper shows that two-step control function estimators of LATE derived from a wide class of parametric
selection models coincide with the instrumental variables estimator. Control function and IV estimates of mean
potential outcomes for compliers, always takers, and never takers are also equivalent. While many parametric




                                                            18
estimators produce the same estimate of LATE, different parameterizations can produce dramatically different
estimates of population average treatment effects and other under-identified quantities. The sensitivity of
average treatment effect estimates to the choice of functional form may be the source of the folk wisdom that
structural estimators are less robust than instrumental variables estimators. Our results show that this view
confuses robustness for a given target parameter with the choice of target parameter.
   Structural estimators that impose overidentifying restrictions may generate LATE estimates different from
IV. Reporting the LATEs implied by such estimators facilitates comparisons with unrestricted IV estimates and
is analogous to the standard practice of reporting average marginal effects in binary choice models (Wooldridge,
2001). Such comparisons provide a convenient tool for assessing the behavioral restrictions imposed by struc-
tural models. Model-based estimators that cannot rationalize unrestricted IV estimates of LATE are unlikely
to fare much better at extrapolating to fundamentally under-identified quantities. On the other hand, a tightly
constrained structural estimator that fits a collection of disparate IV estimates enjoys some degree of validation
that bolsters the credibility of its counterfactual predictions.



References
Abadie, A. (2002): “Bootstrap tests for distributional treatment effects in instrumental variable models,”
  Journal of the American Statistical Association, 97, 284–292.

——— (2003): “Semiparametric instrumental variable estimation of treatment response models,” Journal of
  Econometrics, 113, 231–263.

Angrist, J. D. (2004): “Treatment effect heterogeneity in theory and practice,” The Economic Journal, 114,
  C52–C83.

Angrist, J. D., G. W. Imbens, and D. B. Rubin (1996): “Identification of causal effects using instrumental
  variables,” Journal of the American Statistical Association, 91, 444–455.

Angrist, J. D. and J.-S. Pischke (2009): Mostly Harmless Econometrics: An Empiricist’s Companion,
  Princeton University Press.

——— (2010): “The credibility revolution in empirical economics: how better research design is taking the con
  out of econometrics,” Journal of Economic Perspectives, 24, 3–30.

Balke, A. and J. Pearl (1997): “Bounds on treatment effects from studies with imperfect compliance,”
  Journal of the American Statistical Association, 92, 1171–1176.

Battistin, E. and E. Rettore (2008): “Ineligibles and eligible non-participants as a double comparison
  group in regression-discontinuity designs,” Journal of Econometrics, 142, 715–730.

Bertanha, M. and G. W. Imbens (2014): “External validity in fuzzy regression discontinuity designs,” NBER
  working paper no. 20773.




                                                        19
Bjorklund, A. and R. Moffitt (1987): “The estimation of wage gains and welfare gains in self-selection
  models,” Review of Economics and Statistics, 69, 42–49.

Blundell, R. and R. L. Matzkin (2014): “Control functions in nonseparable simultaneous equations mod-
  els,” Quantitative Economics, 5, 271–295.

Brinch, C. N., M. Mogstad, and M. Wiswall (2017): “Beyond LATE with a discrete instrument,” Journal
  of Political Economy, 125, 985–1039.

Cornelissen, T., C. Dustmann, A. Raute, and U. Schönberg (2016): “From LATE to MTE: alternative
  methods for the evaluation of policy interventions,” Labour Economics, 41, 47–60.

——— (forthcoming): “Who benefits from universal childcare? Estimating marginal returns to early childcare
  attendance,” Journal of Political Economy.

Deaton, A. S. (2009): “Instruments of development: randomization in the tropics, and the search for the
  elusive keys to economic development,” NBER working paper no. 14690.

Dubin, J. A. and D. L. McFadden (1984): “"An econometric analysis of residential electric appliance
  holdings and consumption,” Econometrica, 52, 345–362.

Garen, J. (1984): “The returns to schooling: a selectivity bias approach with a continuous choice variable,”
  Econometrica, 52, 1199–1218.

Greene, W. H. (2007): Econometric Analysis, Upper Saddle River, New Jersey: Prentice Hall, 7th ed.

Heckman, J. J. (1974): “Shadow prices, market wages, and labor supply,” Econometrica, 42, 679–694.

——— (1976): “The common structure of statistical models of truncation, sample selection and limited de-
  pendent variables and a simple estimator for such models,” Annals of Economic and Social Measurement, 5,
  475–492.

——— (1979): “Sample selection bias as a specification error,” Econometrica, 47, 153–161.

——— (1990): “Varieties of selection bias,” American Economic Review: Papers & Proceedings, 80, 313–318.

——— (1997): “Instrumental variables: a study of implicit behavioral assumptions used in making program
  evaluations,” Journal of Human Resources, 32, 441–462.

Heckman, J. J. and R. Robb (1985): “Alternative methods for evaluating the impact of interventions: an
  overview,” Journal of Applied Econometrics, 30, 239–267.

Heckman, J. J. and S. Urzua (2010): “Comparing IV with structural models: what simple IV can and
  cannot identify,” Journal of Econometrics, 156, 27–37.




                                                     20
Heckman, J. J., S. Urzua, and E. Vytlacil (2006): “Understanding instrumental variables estimates in
  models with essential heterogeneity,” Review of Economics and Statistics, 88, 389–432.

Heckman, J. J. and E. Vytlacil (2000): “Local instrumental variables,” NBER technical working paper
  no. 252.

——— (2005): “Structural equations, treatment effects, and econometric policy evaluation,” Econometrica, 73,
  669–738.

Huber, M. and G. Mellace (2015): “Testing instrument validity for LATE identification based on inequality
  moment constraints,” Review of Economics and Statistics, 97, 398–411.

Hull, P. D. (2016): “Estimating hospital quality with quasi-experimental data,” Working paper.

Imbens, G. W. and J. D. Angrist (1994): “Identification and estimation of local average treatment effects,”
  Econometrica, 62, 467–475.

Imbens, G. W. and D. B. Rubin (1997): “Estimating outcome distributions for compliers in instrumental
  variables models,” Review of Economic Studies, 64, 555–574.

Kitagawa, T. (2015): “A test for instrument validity,” Econometrica, 83, 2043–2063.

Kline, P. and C. R. Walters (2016): “Evaluating public programs with close substitutes: the case of Head
  Start,” Quarterly Journal of Economics, 131, 1795–1848.

Kowalski, A. (2016): “Doing more when you’re running LATE: applying marginal treatment effect methods
  to examine treatment effect heterogeneity in experiments,” NBER working paper no. 22363.

Lakatos, I. (1976): “Falsification and the methodology of scientific research programs,” in Can Theories Be
  Refuted?, ed. by S. G. Harding, Dordecht, Holland: D. Reidel Publishing Company.

LaLonde, R. J. (1986): “Evaluating the econometric evaluations of training programs with experimental
  data,” American Economic Review, 76, 604–620.

Lee, L.-F. (1982): “Some approaches to the correction of selectivity bias,” Review of Economic Studies, 49,
  355–372.

Manski, C. F. (1990): “Nonparametric bounds on treatment effects,” American Economic Review: Papers &
  Proceedings, 80, 319–323.

Mogstad, M., A. Santos, and A. Torgovitsky (2016): “Using instrumental variables for inference about
  policy relevant treatment parameters,” Working paper.

Mroz, T. A. (1987): “The sensitivity of an empirical model of married women’s hours of work to economic
  and statistical assumptions,” Econometrica, 55, 765–799.




                                                     21
Olsen, R. J. (1980): “A least squares correction for selectivity bias,” Econometrica, 48, 1815–1820.

Popper, K. (1959): The Logic of Scientific Discovery, London, UK: Hutchinson and Co.

Puma, M., S. Bell, R. Cook, and C. Heid (2012): “Head Start Impact Study: Final Report,” US Depart-
  ment of Health and Human Services, Administration for Children and Families.

Roy, A. (1951): “Some thoughts on the distribution of earnings,” Oxford Economic Papers, 3, 135–146.

Smith, R. J. and R. W. Blundell (1986): “An exogeneity test for a simultaneous equations Tobit model
  with an application to labor supply,” Econometrica, 54, 679–685.

Telser, L. G. (1964): “Advertising and competition,” Journal of Political Economy, 72, 537–562.

Vytlacil, E. (2002): “Independence, monotonicity, and latent index models: an equivalence result,” Econo-
  metrica, 70, 331–341.

Wald, A. (1940): “The fitting of straight lines if both variables are subject to error,” The Annals of Mathe-
  matical Statistics, 11, 284–300.

White, H. (1982): “Maximum likelihood estimation of misspecified models,” Econometrica, 50, 1–25.

Wooldridge, J. M. (2001): Econometric Analysis of Cross-Section and Panel Data, MIT Press.

——— (2015): “Control function methods in applied econometrics,” Journal of Human Resources, 50, 420–445.




                                                     22
Appendix

Proof of Proposition 2

We begin by rewriting the IV and control function estimates of LAT Ez in matrix form. The IV estimator is
given by
                                    h                                i h                                          i
                       IV               P̂ (z)Ȳ1z + (1 − P̂ (z))Ȳ0z − P̂ (z − 1)Ȳ1z−1 + (1 − P̂ (z − 1))Ȳ0z−1
                   LAT
                   \E z         =
                                                                             P̂ (z) − P̂ (z − 1)

                                                            = Ψz1 (P̂ )0 Ȳ1 − Ψz0 (P̂ )0 Ȳ0 ,

where Ȳd ≡ (Ȳd0 , Ȳd1 , ...., ȲdK )0 is the (K + 1) × 1 vector of sample average outcomes for each value of z
conditional on Di = d and P̂ is the vector of propensity score estimates. The (K + 1) × 1 vector Ψz1 (P̂ ) has
−P̂ (z − 1)/[P̂ (z) − P̂ (z − 1)] at entry z − 1, P̂ (z)/[P̂ (z) − P̂ (z − 1)] at entry z, and zeros elsewhere, and the
(K + 1) × 1 vector Ψz0 (P̂ ) has (1 − P̂ (z − 1))/[P̂ (z) − P̂ (z − 1)] at entry z − 1, −(1 − P̂ (z))/[P̂ (z) − P̂ (z − 1)]
at entry z, and zeros elsewhere:
                                                                                                        0
                                                                −P̂ (z−1)           P̂ (z)
                                        Ψz1 (P̂ ) = 0, ..0, P̂ (z)−          ,
                                                                     P̂ (z−1) P̂ (z)−P̂ (z−1)
                                                                                              , 0, ..., 0   ,
                                                                                                    0
                                        Ψz0 (P̂ ) = 0, ..0, P̂(1− P̂ (z−1))
                                                                            , −(1−P̂ (z)) , 0, ..., 0 .
                                                               (z)−P̂ (z−1) P̂ (z)−P̂ (z−1)


   The second-step control function estimates with L = K can be rewritten

                                                                 P               h           PK                           i2
           (α̂d , γ̂d1 , ..., γ̂dK ) = arg        min                i 1{Di = d}   Yi − αd −  `=1 1{Zi = z}γ  λ
                                                                                                            d` d` (P̂ (z))   .
                                             αd ,γd1 ,...,γdK


This is a saturated OLS regression of Yi on Zi for each treatment category. The coefficient estimates satisfy
                                          XK
                                 α̂d +                γ̂d` λd` (P̂ (z)) = Ȳdz , d ∈ {0, 1}, z ∈ {0, 1, ...K}.
                                                `=1

        ˆ d = (α̂d , γ̂d1 , ..., γ̂dK )0 denote the control function estimates for treatment value d, we can write this
Letting ∆
system in matrix form as

                                                                             ˆ d = Ȳd ,
                                                                     Λd (P̂ )∆

where the matrix Λd (P̂ ) has ones in its first column and λdj−1 (P̂ (k)) in row k and column j > 1:
                                                                                                         
                                                            1        λd1 (P̂ (1))   ···    λdK (P̂ (1))
                                                                                                         
                                                            1        λd1 (P̂ (2))   ···    λdK (P̂ (2))
                                                                                                         
                                                                                                         
                                          Λd (P̂ ) = 
                                                           ..             ..       ..          ..
                                                                                                          .
                                                                                                          
                                                            .              .          .         .        
                                                                                                         
                                                            1 λd1 (P̂ (K)) · · ·           λdK (P̂ (K))

The control function estimates are therefore given by

                                                                 ˆ d = Λd (P̂ )−1 Ȳd .
                                                                 ∆




                                                                              23
The values of λdk (P̂ (z)) are well-defined for all (k, z) whenever 0 < P̂ (z) < 1 ∀z, and Λd (P̂ ) is full rank if
P̂ (z) 6= P̂ (z 0 ) whenever z 6= z 0 . These requirements hold if Conditions 1 and 2 are true for every pair of
instrument values, so the matrix Λd (P̂ ) is invertible under the conditions of Proposition 2 and the control
                  ˆ d exists.
function estimate ∆
    In matrix form, the control function estimate of LAT Ez is given by
                                                              CF                      
                                                     LAT
                                                     \E z          = Υz (P̂ )0 ∆ˆ1 − ∆
                                                                                     ˆ0 ,

where the (K + 1) × 1 vector Υz (P̂ ) has first entry equal to unity and kth entry Γk−1 (P̂ (z − 1), P̂ (z)) for k > 1:
                                                                                                                              0
                  Υz (P̂ ) = 1, P̂ (z)λ11 (P̂ (z))−  P̂ (z−1)λ11 (P̂ (z−1))
                                               P̂ (z)−P̂ (z−1)
                                                                            , ..., P̂ (z)λ1K (P̂ (z))−  P̂ (z−1)λ1K (P̂ (z−1))
                                                                                                  P̂ (z)−P̂ (z−1)
                                                                                                                                  .

                             ˆ 1 and ∆
Plugging in the formulas for ∆       ˆ 0 yields

                                              CF
                                     LAT
                                     \E z            = Υz (P̂ )0 Λ1 (P̂ )−1 Ȳ1 − Υz (P̂ )0 Λ0 (P̂ )−1 Ȳ0 .

The IV and control functions are therefore identical if Ψzd (P̂ )0 = Υz (P̂ )0 Λd (P̂ )−1 for d ∈ {0, 1}, or equivalently,
if Λd (P̂ )0 Ψzd (P̂ ) = Υz (P̂ ) for d ∈ {0, 1}.
    For d = 1, we have
                                                                                                                                   0
              Λ1 (P̂ )0 Ψz1 (P̂ ) = 1, P̂ (z)λ11 (P̂ (z))−  P̂ (z−1)λ11 (P̂ (z−1))
                                                      P̂ (z)−P̂ (z−1)
                                                                                   , ..., P̂ (z)λ1K (P̂ (z))−P̂ (z−1)λ1K (P̂ (z−1))
                                                                                                         P̂ (z)−P̂ (z−1)


                                                                    = Υz (P̂ ).


For d = 0, we have
                                                                                                                                          0
     Λ0 (P̂ )0 Ψz0 (P̂ ) = 1, λ01 (P̂ (z−1))(1−P̂P̂(z)−
                                                    (z−1))−λ01 (P̂ (z))(1−P̂ (z))
                                                       P̂ (z−1)
                                                                                  , ..., λ01 (P̂ (z−1))(1−P̂ (z−1))−λ01 (P̂ (z))(1−P̂ (z))
                                                                                                          P̂ (z)−P̂ (z−1)
                                                                                                                       0
                       = 1, λ11 (P̂ (z))P̂P̂(z)−λ11 (P̂ (z−1))P̂ (z−1)
                                             (z)−P̂ (z−1)
                                                                       , ..., λ1K (P̂ (z))P̂ (z)−λ1K (P̂ (z−1))P̂ (z−1)
                                                                                            P̂ (z)−P̂ (z−1)


                                                                    = Υz (P̂ ),

where the second equality follows from the fact that p0 λ1` (p0 ) − pλ1` (p) = (1 − p)λ0` (p) − (1 − p0 )λ0` (p0 ) for any
                                                IV                  CF
p, p0 and `. This implies that LAT
                               \E z                   and LAT
                                                          \E z           are equal to the same linear combination of Ȳ1 and Ȳ0 ,
so these estimates are identical for any z.


Proof of Proposition 3

The unrestricted control function estimates come from the regression

                             Yi = α0 (0)(1 − Di )(1 − Xi ) + γ0 (0)(1 − Di )(1 − Xi )λ0 (P̂ (0, Zi ))

                                        +α0 (1)(1 − Di )Xi + γ0 (1)(1 − Di )Xi λ0 (P̂ (1, Zi ))

                                        +α1 (0)Di (1 − Xi ) + γ1 (0)Di (1 − Xi )λ1 (P̂ (0, Zi ))




                                                                         24
                                      +α1 (1)Di Xi + γ1 (1)Di Xi λ1 (P̂ (1, Zi )) + i .

We can write this equation in matrix form as

                                                             Y = W ∆ + ,

where W is the matrix of regressors and ∆ = (α0 (0), γ0 (0), α0 (1), γ0 (1), α1 (0), γ1 (0), α1 (1), γ1 (1))0 collects the
control function coefficients. Under the conditions of Proposition 3, W 0 W has full rank and the unrestricted
control function estimates are

                                                       ˆ u = (W 0 W )−1 W 0 Y .
                                                       ∆

   The estimator in equation (13) imposes three restrictions: α1 (1) − α1 (0) = α0 (1) − α0 (0), γ1 (1) = γ1 (0),
and γ0 (1) = γ0 (0). The resulting estimates can be written

                                    ˆ r , %̂) = arg min (Y − W ∆)0 (Y − W ∆) − %C∆,
                                   (∆
                                                       ∆,%

where
                                                                                           
                                                  −1      0     1    0   1   0    −1    0
                                                                                         
                                       C= 0                             0 −1
                                                                                         
                                                          0     0    0             0    1 
                                                                                         
                                           0             −1     0    1   0   0     0    0

and % is a Lagrange multiplier. Then

                                                  ˆr = ∆
                                                  ∆    ˆ u + (W 0 W )−1 C 0 %̂,

                                                                            ˆ u.
                                               %̂ = −(C(W 0 W )−1 C 0 )−1 C ∆

                    ˆ the corresponding estimate of LATE for compliers with Xi = 1 is Υ(P̂ )0 ∆,
   For any estimate ∆,                                                                        ˆ with

                         Υ(P̂ ) = (0, 0, −1, −Γ(P̂ (1, 0), P̂ (1, 1)), 0, 0, 1, Γ(P̂ (1, 0), P̂ (1, 1)))0 .


The restricted estimate of LAT E(1) is therefore
                                          CF                                     
                                      \E r (1) = Υ(P̂ )0 ∆
                                      LAT                 ˆ u + (W 0 W )−1 C 0 %̂

                                         CF                                                     −1
                               \E 1 (1) + Υ(P̂ )0 (W 0 W )−1 C 0 C(W 0 W )−1 C 0
                             = LAT                                                                    ζ,

             ˆ u is the constraint vector evaluated at the unrestricted estimates:
where ζ = −C ∆

                                                                                                              0
                       ζ = ([α̂0 (0) − α̂0 (1)] − [α̂1 (0) − α̂1 (1)], γ̂1 (0) − γ̂1 (1), γ̂0 (0) − γ̂0 (1)) .
                                                  −1
   Write Ω = (W 0 W )−1 C 0 C(W 0 W )−1 C 0             , and let νk denote the 3 × 1 vector equal to the transpose of the
kth row of Ω. Using the fact that a scalar is equal to its trace, we can then write the difference in restricted
and unrestricted LATE estimates as




                                                                    25
                                            CF         CF                  
                                                   \E 1 (1) = tr Υ(P̂ )0 Ωζ
                                        \E r (1) − LAT
                                        LAT
                                                                                 
                                                                   = tr ΩζΥ(P̂ )0

                                                                           = ϕ0 ζ,

where ϕ = ν7 − ν3 + Γ(P̂ (1, 0), P̂ (1, 1))(ν8 − ν4 ) ≡ (ϕ1 , ϕ2 , ϕ3 )0 . Then

        CF                 CF
\E r (1) − LAT
LAT        \E 1 (1) = ϕ1 ([α̂0 (0) − α̂0 (1)] − [α̂1 (0) − α̂1 (1)]) + ϕ2 (γ̂1 (0) − γ̂1 (1)) + ϕ3 (γ̂0 (0) − γ̂0 (1))
                                          
                    CF             CF                                                             
         = ϕ1 LAT E 1 (1) − LAT E 0 (1) + (γ̂1 (0) − γ̂1 (1)) ϕ2 + ϕ1 Γ(P̂ (1, 0), P̂ (1, 1))
               \            \

                                                                                          
                                       +(γ̂0 (0) − γ̂0 (1)) ϕ3 − ϕ1 Γ(P̂ (1, 0), P̂ (1, 1)) .

This implies

                  CF                    CF                                         CF
         LAT         \E 1 (1) + (1 − w)LAT
         \E r (1) = wLAT               \E 0 (1) + b1 (γ̂1 (1) − γ̂1 (0)) + b0 (γ̂0 (1) − γ̂0 (0)),


where w = 1 + ϕ1 , b1 = −(ϕ2 + ϕ1 Γ(P̂ (1, 0), P̂ (1, 1))), and b0 = ϕ1 Γ(P̂ (1, 0), P̂ (1, 1)) − ϕ3 . Furthermore, note
that the elements of ϕ only depend on sample moments of Di , Xi , and P̂ (Xi , Zi ), so the proposition follows.


Proof of Proposition 4

The log likelihood function for model (16) is
                                                                                                                                              !
                                               X                    Z    P (Zi )                                                          
  log L (P (0), P (1), α0 , α1 , ρ0 , ρ1 ) =         Di log                         Yi F|U (α1 |u; ρ1 ) + (1 − Yi )(1 − F|U (α1 |u; ρ1 )) du
                                                 i                   0

                                                                                                                    !
                    X              Z            1                                                               
                   + (1 − Di ) log                        Yi F|U (α0 |u; ρ0 ) + (1 − Yi )(1 − F|U (α0 |u; ρ0 )) du .
                       i                       P (Zi )


We first rewrite this likelihood in terms of the six identified parameters of the LATE model, which are given
by

                                                                        πat = P (0),

                                                               πc = P (1) − P (0),
                                                                   R P (0)
                                                                    0
                                                                             F|U (α1 |u; ρ1 )du
                                                     µ1at =                                      ,
                                                                                P (0)
                                                                   R1
                                                                    P (1)
                                                                            F|U (α0 |u; ρ0 ) du
                                                     µ0nt =                                        ,
                                                                              1 − P (1)
                                                         R P (1)
                                                          P (0)
                                                                   F|U (αd |u; ρd )du
                                          µdc =                                             , d ∈ {0, 1}.
                                                                  P (1) − P (0)




                                                                              26
Note that since F|U (·|u; ρ) is a CDF, we have µdg ∈ [0, 1] ∀(d, g). Substituting these parameters into the
likelihood function yields


                                            X
log L(πat , πc , µ1at , µ0nt , µ1c , µ0c ) =  Di Zi log (πat [Yi µ1at + (1 − Yi )(1 − µ1at )] + πc [Yi µ1c + (1 − Yi )(1 − µ1c )])
                                                             i
                                                X
                                               +  Di (1 − Zi ) log (πat [Yi µ1at + (1 − Yi )(1 − µ1at )])
                                                     i
                                 X
                                + (1 − Di )Zi log ((1 − πat − πc ) [Yi µ0nt + (1 − Yi )(1 − µ0nt )])
                                       i
      X
     + (1 − Di )(1 − Zi ) log ((1 − πat − πc ) [Yi µ0nt + (1 − Yi )(1 − µ0nt )] + πc [Yi µ0c + (1 − Yi )(1 − µ0c )]).
        i

    We first consider interior solutions. The first-order conditions are
                   X                         Di (2Yi −1)Zi πat                                                     Di (2Yi −1)(1−Zi )πat
                                                                                                                                                 
         [µ1at ] :      πat [Yi µ1at +(1−Yi )(1−µ1at )]+πc [Yi µ1c +(1−Yi )(1−µ1c )] +                         πat [Yi µ1at +(1−Yi )(1−µ1at )]       = 0,
                       i
             X       (1−Di )(2Yi −1)Zi (1−πat −πc )                                              (1−Di )(2Yi −1)(1−Zi )(1−πat −πc )
                                                                                                                                                            
 [µ0nt ] :         (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )]                    +   (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )]+πc [Yi µ0c +(1−Yi )(1−µ0c )]          = 0,
             i
                                                                                   Di Zi (2Yi −1)πc
                                                     X
                                  [µ1c ] :                   πat [Yi µ1at +(1−Yi )(1−µ1at )]+πc [Yi µ1c +(1−Yi )(1−µ1c )]     = 0,
                                                         i
                                                                          (1−Di )(1−Zi )(2Yi −1)πc
                                           X
                            [µ0c ] :                 (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )]+πc [Yi µ0c +(1−Yi )(1−µ0c )]        = 0,
                                               i
                                       X                          Di Zi [Yi µ1at +(1−Yi )(1−µ1at )]
                                                                                                                         XD
                                                                                                                                i (1−Zi )
                           [πat ] :                πat [Yi µ1at +(1−Yi )(1−µ1at )]+πc [Yi µ1c +(1−Yi )(1−µ1c )]      +           πat
                                           i                                                                              i
     X (1−D )Z [Y µ +(1−Y )(1−µ )]              X              (1−Di )(1−Zi )[Yi µ0nt +(1−Yi )(1−µ0nt )]
    − (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )] −
            i  i i 0nt         i      0nt
                                                  (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )]+πc [Yi µ0c +(1−Yi )(1−µ0c )] = 0,
        i                                                                 i
                   X                    Di Zi [Yi µ1c +(1−Yi )(1−µ1c )]
                                                                                                          X     (1−Di )Zi [Yi µ0nt +(1−Yi )(1−µ0nt )]
         [πc ] :       [πat [Yi µ1at +(1−Yi )(1−µ1at )]+πc [Yi µ1c +(1−Yi )(1−µ1c )]]                 −        (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )]
                   i                                                                                       i
                                                    (1−Di )(1−Zi )(2Yi −1)(µ0nt −µ0c )
                                 X
                                −  (1−πat −πc )[Yi µ0nt +(1−Yi )(1−µ0nt )]+πc [Yi µ0c +(1−Yi )(1−µ0c )] = 0.
                                       i


Under Conditions 1 and 2 we can compute µ̂IV      IV      IV         IV             IV
                                          1at , µ̂0nt , µ̂1c , and µ̂0c . Setting π̂c  = P̂ (1) − P̂ (0) and
  IV
π̂at = P̂ (0) and plugging the IV parameter estimates into the FIML first order conditions, we see that these
conditions are satisfied. Thus at interior solutions maximum likelihood and IV estimators of all parameters
are equal, and it follows that µ̂M L    IV
                                 dc = µ̂dc for d ∈ {0, 1}.

    Next, we consider corner solutions, which occur when at least one parameter lies outside [0,1] at the
                                                                bIV
unconstrained solution to the first order conditions. Note that µ      bIV
                                                                 1at , µ
                                                                                    IV
                                                                        0nt , and π̂at are sample means of binary

variables, so these estimates are always in the unit interval. π̂cIV is the difference in empirical treatment rates
between the two values of Zi ; without loss of generality we assume that Zi = 1 refers to the group with the
higher treatment rate, so π̂cIV ∈ (0, 1). Thus a constraint binds if and only if µ̂IV
                                                                                   dc is outside [0,1] for d = 0,

d = 1, or both. In these cases at least one of the maximum likelihood complier means fails to match the
corresponding IV estimate because the IV estimate is outside the FIML parameter space. This establishes that
the FIML and IV estimates match if and only if both µ̂IV       IV
                                                      1c and µ̂0c are in [0,1], which completes the proof.




                                                                                        27
