                                NBER WORKING PAPER SERIES




       WHAT GOODS DO COUNTRIES TRADE? NEW RICARDIAN PREDICTIONS

                                          Arnaud Costinot
                                          Ivana Komunjer

                                        Working Paper 13691
                                http://www.nber.org/papers/w13691


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2007




Acknowledgments: We thank Gene Grossman, Gordon Hanson, Giovanni Maggi, Jim Rauch, Frédéric
Robert-Nicoud, Bob Staiger and seminar participants at UC Davis, UC Irvine, Penn State, UC San
Diego, Princeton IES Summer Workshop, Michigan, Yale, Harvard, U of Toronto, and U of Texas
at Austin for very helpful comments. We also thank Don Davis and Sam Kortum for stimulating discussions
and precious advice at the Princeton IES Summer Workshop. Nadege Plesier provided excellent research
assistance. The views expressed herein are those of the author(s) and do not necessarily reflect the
views of the National Bureau of Economic Research.

© 2007 by Arnaud Costinot and Ivana Komunjer. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
What Goods Do Countries Trade? New Ricardian Predictions
Arnaud Costinot and Ivana Komunjer
NBER Working Paper No. 13691
December 2007
JEL No. F10

                                            ABSTRACT

Though one of the pillars of the theory of international trade, the extreme predictions of the Ricardian
model have made it unsuitable for empirical purposes. A seminal contribution of Eaton and Kortum
(2002) is to demonstrate that random productivity shocks are sufficient to make the Ricardian model
empirically relevant. While successful at explaining trade volumes, their model remains silent with
regards to one important question: What goods do countries trade? Our main contribution is to generalize
their approach and provide an empirically meaningful answer to this question.


Arnaud Costinot
Department of Economics
University of California, San Diego
9500 Gilman Drive
La Jolla, CA 92093-0508
and NBER
costinot@ucsd.edu

Ivana Komunjer
Department of Economics
University of California, San Diego
9500 Gilman Drive
La Jolla, CA 92093-0508
komunjer@ucsd.edu
2

                                            1. Introduction

    Though one of the pillars of the theory of international trade, the extreme predictions
of the Ricardian model have made it unsuitable for empirical purposes. As Leamer and
Levinsohn (1995) point out: “The Ricardian link between trade patterns and relative labor
costs is much too sharp to be found in any real data set.”
    A seminal contribution of Eaton and Kortum (2002) is to demonstrate that random pro-
ductivity shocks are su¢ cient to make the Ricardian model empirically relevant. When
drawn from an extreme value distribution, these shocks imply a gravity-like equation in a
Ricardian framework with a continuum of goods, transport costs, and more than two coun-
tries. While successful at explaining trade volumes, their model remains silent with regards
to one important question: What goods do countries trade? Our main contribution is to
generalize their approach and provide an empirically meaningful answer to this question.
    Section 2 describes the model. We consider an economy with one factor of production,
labor, and multiple goods, each available in many varieties. There are constant returns to
scale in the production of each variety. The key assumption of our model is that labor pro-
ductivity may be separated into: a deterministic component, which is country and industry
speci…c; and a stochastic component, randomly drawn across countries, industries, and va-
rieties. The former, to which we refer as “fundamental productivity”, captures factors such
as climate, infrastructure, and institutions that a¤ect the productivity of all producers in
a given country and industry.1 The latter, by contrast, re‡ects idiosyncratic di¤erences in
technological know-how across varieties.
    Section 3 derives our predictions on the pattern of trade. Because of random productivity
shocks, we can no longer predict trade ‡ows in each variety. Yet, by assuming that each
good comes in a large number of varieties, we generate sharp predictions at the industry
level. In particular, we show that, for any pair of exporters, the ranking by industry of
the ratios of their fundamental productivity levels determines the ranking of the ratios of



    1
        Acemoglu, Antras, and Helpman (2007), Costinot (2006), Cuñat and Melitz (2006), Levchenko (2007),
Matsuyama (2005), Nunn (2007), and Vogel (2007) explicitly model the impact of various institutional
features— e.g. labor market ‡exibility, the quality of contract enforcement, or credit market imperfections—
on labor productivity across countries and industries.
                                      NEW RICARDIAN PREDICTIONS                                             3

their exports towards any importing country. Compared to the standard Ricardian model—
see e.g. Dornbusch, Fischer, and Samuelson (1977)— our predictions hold under general
assumptions on transport costs, the number of industries, and the number of countries.2
Moreover, they do not imply the full specialization of countries in a given set of industries.
  Section 4 investigates how well our model squares with the empirical evidence. Our empir-
ical results are based on linear regressions tightly connected to the theory. They o¤er strong
support for our new Ricardian predictions: countries do tend to export relatively more—
towards any importing country— in industries where they are relatively more productive.
  Our paper contributes to the previous trade literature in two ways. First, it contributes to
the theory of comparative advantage. Our model generates clear predictions on the pattern
of trade in environments— with both multiple countries and industries— where the standard
Ricardian model loses most of its intuitive content; see e.g. Jones (1961) and Wilson (1980).
Our approach mirrors Deardor¤ (1980) who shows how the law of comparative advantage
may remain valid, under standard assumptions, when stated in terms of correlations be-
tween vectors of trade and autarky prices. In this paper, we weaken the standard Ricardian
assumptions— the “chain of comparative advantage” will only hold in terms of …rst-order
stochastic dominance— and derive a deterministic relationship between exports and labor
productivity across industries.
  Second, our paper contributes to the empirical literature on international specialization,
including previous “tests”of the Ricardian model; see e.g. MacDougall (1951), Stern (1962),
Balassa (1963), and more recently Golub and Hsieh (2000). While empirically successful,
these tests have long been criticized for their lack of theoretical foundations; see Bhagwati
(1964). Our model provides such foundations. Since it does not predict full international
specialization, we do not have to focus on ad-hoc measures of export performance. Instead,
we may use the theory to pin down explicitly what the dependent variable in cross-industry
regressions ought to be.
  As we discuss later in the paper, our model also provides an alternative theoretical un-
derpinning of cross-industry regressions when labor is not the only factor of production; see



  2
      Deardor¤ (2005) reviews the failures of simple models of comparative advantage at predicting the pattern
of trade in economies with more than two goods and two countries.
4                                  COSTINOT AND KOMUNJER

e.g. Baldwin (1971). The validity of these regressions usually depends on strong assump-
tions on either demand— see e.g. Petri (1980) and the voluminous gravity literature based
on Armington’s preferences— or the structure of transport costs— see e.g. Harrigan (1997),
Romalis (2004), and Morrow (2006). One of the main messages of our paper is that many
of these assumptions can be relaxed, as long as there are stochastic productivity di¤erences
within each industry.


                                         2. The Model

    We consider a world economy comprising i = 1; :::; I countries and one factor of production—
labor. There are k = 1; :::; K goods and constant returns to scale in the production of each
good. Labor is perfectly mobile across industries and immobile across countries. The wage
of workers in country i is denoted wi . Up to this point, this is a standard Ricardian model.
We generalize this model by introducing random productivity shocks. Following Eaton and
Kortum (2002), we assume that each good k may come in N k varieties ! = 1; :::; N k , and
denote aki (!) the constant unit labor requirements for the production of the !th variety of
good k in country i. Our …rst assumption is that:

A1. For all countries i, goods k, and their varieties !

(1)                                 ln aki (!) = ln aki + uki (!);

where aki > 0 and uki (!) is a random variable drawn independently for each triplet (i; k; !)
from a continuous distribution F ( ) such that: E[uki (!)] = 0.

    We interpret aki as a measure of the fundamental productivity of country i in industry
k and uki (!) as a random productivity shock. The former, which can be estimated using
aggregate data, captures cross-country and cross-industry heterogeneity. It re‡ects factors
such as climate, infrastructure, and institutions that a¤ect the productivity of all producers
in a given country and industry. Random productivity shocks, on the other hand, capture
intra-industry heterogeneity. They re‡ect idiosyncratic di¤erences in technological know-how
across varieties, which are assumed to be drawn independently from a unique distribution
F ( ). In our setup, cross-country and cross-industry variations in the distribution of produc-
tivity levels derive from variations in a single parameter: aki .
                                     NEW RICARDIAN PREDICTIONS                                    5

  Assumption A1 generalizes Eaton and Kortum’s (2002) approach along two dimensions.
First, it introduces the existence of exogenous productivity di¤erences across industries.
This will allow us to shift the indeterminacy in trade in individual goods to indeterminacy
in trade in varieties. Second, it does not impose any restriction on the distribution of random
productivity shocks.

  We assume that trade barriers take the form of “iceberg”transport costs:

A2. For every unit of commodity k shipped from country i to country j, only 1=dkij units
arrive, where:
                                   (
                                       dkij = dij dkj   1, if i 6= j,
(2)
                                       dkij = 1,             otherwise.


  The indices i and j refer to the exporting and importing countries, respectively. The …rst
parameter dij measures the trade barriers which are speci…c to countries i and j. It includes
factors such as: physical distance, existence of colonial ties, use of a common language, or
participation in a monetary union. The second parameter dkj measures the policy barriers
imposed by country j on good k, such as import tari¤s and standards. In line with “the
most-favored-nation” clause of the World Trade Organization, these impediments may not
vary by country of origin.
  We assume that markets are perfectly competitive.3 Together with constant returns to
scale in production, perfect competition implies:

A3. In any country j, the price pkj (!) paid by buyers of variety ! of good k is

(3)                                       pkj (!) = min ckij (!) ;
                                                   1 i I

where ckij (!) = dkij wi aki (!) is the cost of producing and delivering one unit of this variety
from country i to country j.

  For each variety ! of good k, buyers in country j are “shopping around the world”for the
best price available. Here, random productivity shocks lead to random costs of production
ckij (!) and in turn, to random prices pkj (!). In what follows, we let ckij = dkij wi aki > 0.

  3 The   case of Bertrand competition is discussed in details in Appendix B.
6                                             COSTINOT AND KOMUNJER

    On the demand side, we assume that consumers have a two-level utility function with CES
preferences across varieties. This implies:

A4(i). In any country j, the total spending on variety ! of good k is
                                                                                  1
(4)                                           xkj (!) = pkj (!)=pkj                           ekj ;
                                            PN k
where ekj > 0,         > 1 and pkj = [            ! 0 =1   pkj (! 0 )1    ]1=(1       )
                                                                                          .

    The above expenditure function is a standard feature of the “new trade”literature; see e.g.
Helpman and Krugman (1985). ekj is an endogenous variable that represents total spending
on good k in country j. It depends on the upper tier utility function in this country and the
equilibrium prices. pkj is the CES price index, and                               is the elasticity of substitution between
varieties. It is worth emphasizing that while the elasticity of substitution                                          is assumed to
be constant, total spending, and hence demand conditions, may vary across countries and
industries: ekj is a function of j and k.
    Finally, we assume that:

A4(ii). In any country j, the elasticity of substitution                                         between two varieties of good k is
such that E       pkj (!)1        < 1:

    Assumption A4(ii) is a technical assumption that guarantees the existence of a well de…ned
price index. Whether or not A4(ii) is satis…ed ultimately depends on the shape of the
distribution F ( ).4
    4 Suppose,   for example, that uki (!)’s are drawn from a (negative) exponential distribution with mean
zero: F (u) = exp[ u         1] for      1 < u             1= and          > 0. This corresponds to the case where labor
productivity zik (!)     1=aki (!) is drawn from a Pareto distribution: Gki (z) = 1                           (bki =z) for 0 < bki   z
and bki   (1=aki ) exp( 1= ), as assumed in various applications and extensions of Melitz’s (2003) model; see
e.g. Helpman, Melitz, and Yeaple (2004), Antras and Helpman (2004), Ghironi and Melitz (2005), Bernard,
Redding, and Schott (2006), and Chaney (2007). Then, our assumption A4(ii) holds if the elasticity of
substitution      < 1 + . Alternatively, suppose that uki (!)’s are distributed as a (negative) Gumbel random
variable with mean zero: F (u) = 1            exp[ exp( u                e)] for u 2 R and            > 0, where e is Euler’s constant
e ' 0:577. This corresponds to the case where labor productivity zik (!) is drawn from a Fréchet distribution:
Gki (z) = exp( bki z    ) for z       0 and bki      (1=aki ) exp( e), as assumed, for example, in Eaton and Kortum
(2002) and Bernard, Eaton, Jensen, and Kortum (2003). Then, like in the Pareto case, A4(ii) holds if
    <1+ .
                                       NEW RICARDIAN PREDICTIONS                                             7
                                                PN k
  In the rest of the paper, we let xkij =             !=1   xkij (!) denote the value of exports from country
i to country j in industry k, where total spending on each variety xkij (!) is given by:
                       8
                       < xkij (!) = xkj (!), if ckij (!) = min cki0 j (!),
(5)                                                       1 i0 I
                       : xk (!) = 0,         otherwise.
                            ij

                                       3. The Pattern of Trade

  We now describe the restrictions that Assumptions A1–A4 impose on the pattern of trade;
and how they relate to those of the standard Ricardian model.

3.1. The Wonderful World of Eaton and Kortum (2002). For expositional purposes,
we …rst derive predictions on the pattern of trade when the distribution of a random produc-
tivity shocks, F ( ), is a Gumbel with mean zero, as assumed in Eaton and Kortum (2002).
Hence, the only di¤erence between the present model and theirs is the existence of multiple
industries. This corresponds to the case where

(6)                                   F (u) = 1        exp[ exp( u            e)]

with u 2 R,      > 0, and e the Euler’s constant e ' 0:577.
  Our …rst result can be stated as follows:

Theorem 1. Suppose that Assumptions A1-A4 hold. In addition, assume that the number
of varieties N k of any good k is large, and that F ( ) satis…es Equation (6). Then, for any
exporter i, any importer j, and any good k,
                                                                k
(7)                                       ln xkij '    ij   +   j    ln aki

  The proof of Theorem 1 mainly is a matter of algebra. First, we relate total exports xkij
to the expected value of exports coming from country i, using the law of large numbers.5
Second, we compute the expected value explicitly using Equation (6); see Appendix A.
  The …rst term         ij        ln(dij wi ) is importer and exporter speci…c; it re‡ects wages wi
in the exporting country and trade barriers dij between countries i and j. The second term
  5 Alternatively,   we could have assumed the existence a continuum of varieties and argued, like many before
us, that total exports were equal to their expected value. By assuming that the number of varieties is large
but …nite, we avoid, however, the technical di¢ culties of invoking the law of large numbers with a continuum
of i.i.d. variables; see e.g. Al-Najjar (2004). Nothing substantial hinges on this particular modeling choice.
8                                                    COSTINOT AND KOMUNJER
                                 XI
    k
    j     ln ekj     ln dkj ln                 (cki0 j )      is importer and industry speci…c; it re‡ects the policy
                                       i0 =1
barriers      dkj   imposed by country j on good k and demand di¤erences ekj across countries and
industries. The main insight of Theorem 1 comes from the third term ln aki . Since                                              > 0,
ln xkij should be decreasing in ln aki : ceteris paribus, countries should export less in industries
where their …rms are, on average, less e¢ cient.
        It is worth emphasizing that Theorem 1 cannot be used for comparative static analysis. If
the fundamental productivity level goes up in a given country and industry, this will a¤ect
wages, demand, and, in turn, exports in other countries and industries through general
equilibrium e¤ects. In other words, changes in aki also lead to changes in the country and
                                                k
industry …xed e¤ects,            ij   and       j.   By contrast, Theorem 1 can be used to analyze the cross-
sectional variations of bilateral exports, as we shall further explore in Section 4.
                                                                                      k
        Finally, note that the two …xed-e¤ects,                         ij   and      j,   do not depend on the elasticity of
substitution . Thus, the predictions of Theorem 1 still hold if we relax Assumption A4(i),
                                                                                                                           k
so that the elasticity of substitution may vary across countries and industries,                                           j.    We
come back to this intriguing result when discussing the general case.

3.2. The General Case. We now relax the assumption that F ( ) is a Gumbel distribution.
In this situation, we can no longer obtain a closed form solution, but we can still derive
a log-linear relationship between total exports and the fundamental productivity level aki ,
using a …rst-order Taylor series development around a symmetric situation where costs are
identical across exporters, ck1j = ::: = ckIj .

Theorem 2. Suppose that Assumptions A1-A4 hold. In addition, assume that the number
of varieties N k of any good k is large, and that cost di¤erences across exporters are small:
ck1j ' ::: ' ckIj . Then, for any exporter i, any importer j 6= i, and any good k,

(8)                                                  ln xkij '     ij   +    k
                                                                             j        ln aki :

where         > 0.

                                                                                           k
        The proof as well as the exact expressions for                             ij ,    j,   and   are given in Appendix A.
Theorem 2 predicts that, like in the Gumbel case, total exports can be decomposed into
                                                                                                                 k
an importer-exporter speci…c term,                         ij ;   an importer-industry speci…c term,             j;   and a third
term,        ln aki , which captures the impact of productivity di¤erences. Since                                > 0, Theorem
                                    NEW RICARDIAN PREDICTIONS                                              9

2 also predicts that: ceteris paribus, countries should export less in industries where their
…rms are, on average, less e¢ cient.
  The predictive power of Theorem 2 crucially relies on the fact that                  is constant across
countries and industries. To understand this result, it is convenient to think about total
exports in terms of their extensive and intensive margins, that is how many and how much of
each variety are being exported, respectively. The unique distribution of random productivity
shocks F ( ) makes sure that marginal changes in the costs of production ckij have the same
impact on the extensive margin across countries and industries. Similarly, the constant
elasticity of substitution       guarantees that they have the same impact on the intensive
margin. This is the basic idea behind Theorem 2. The other assumptions simply allow us to
identify the e¤ect of labor productivity by bundling the impact of changes in wages, demand,
and transport costs into …xed e¤ects.
  Relaxing Eaton and Kortum’s (2002) distributional assumption in Theorem 2 comes at
the cost of two new restrictions. First, we must move from global predictions— which hold
for any ck1j ; :::; ckIj — to local predictions— which only hold if costs di¤erences across all
exporters are small.6 Second, we must assume that the elasticity of substitution is constant
across countries and industries. This assumption was not necessary in Theorem 1 because
of one key property of the Gumbel distribution: conditional on exporting a given variety to
country j, the expected value of exports was identical across countries. Hence, transport
costs, wages and fundamental productivity levels only a¤ected the extensive margin, not the
intensive margin. Unfortunately, this attractive property of the Gumbel does not generalize
to other standard distributions, as we show in Appendix C.
  In order to prepare the comparison between our results and those of the standard Ricardian
model, we conclude by o¤ering a Corollary to Theorems 1 and 2. Consider an arbitrary pair
of exporters, i1 and i2 , an importer j 6= i1 ; i2 , and an arbitrary pair of goods, k1 and k2 .

  6 Although   this requirement may seem unreasonably strong, the predictions of Theorem 2 hold more
generally if, for each industry and each importing country, exporters can be separated into two groups:
small exporters, whose costs are very large (formally, close to in…nity), and large exporters, whose costs of
production are small and of similar magnitude. Then, small exporters export with probability close to zero
and the results of Theorem 2 apply to the group of large exporters. In other words, Theorem 2 does not
require Gambia and Japan to have similar costs of producing and delivering cars in the United States. It
simply requires that Japan and Germany do.
10                                               COSTINOT AND KOMUNJER

Taking the di¤erences-in-di¤erences in Equation (7) we get

         (ln xki11j   ln xki12j )   (ln xki21j       ln xki22j ) '                    ln aki11            ln aki12   ln aki21   ln aki22

A similar manipulation of Equation (8) implies

         (ln xki11j   ln xki12j )   (ln xki21j      ln xki22j ) '                     ln aki11            ln aki12   ln aki21   ln aki22

Since     > 0 and        > 0, we obtain
                                                 aki11          aki12        xki11j          xki12j
(9)                                                      >               ,            <               ;
                                                 aki21          aki22        xki21j          xki22j
under the assumptions of Theorems 1 or 2. Still considering the pair of exporters i1 and i2
and generalizing the above reasoning to all K goods, we derive the following Corollary:

Corollary 3. Suppose that the assumptions of Theorem 1 or 2 hold. Then, the ranking of
relative unit labor requirements determines the ranking of relative exports:
                                              (                                  )
                                                   1              k          K
                a1i1         aki1      aK        x i1 j         x i j      x i j
                     > :::: > k > ::: > iK1 ,           < :::: < k1 < ::: < K1 :
                a1i2         ai2       ai2       x1i2 j         xi2 j      xi2 j

3.3. Relation to the Standard Ricardian Model. Note that we can always index the
K goods so that:
                                                 a1i1          aki1         aK
                                                                             i1
(10)                                                  > :::: >      > ::: >     :
                                                 a1i2          aki2         aK
                                                                             i2

Ranking (10) is at the heart of the standard Ricardian model; see e.g. Dornbusch, Fischer,
and Samuelson (1977). When there are no random productivity shocks, Ranking (10) merely
states that country i1 has a comparative advantage in (all varieties of) the high k goods. If
there only are two countries, the pattern of trade follows: i1 produces and exports the high k
goods, while i2 produces and exports the low k goods. If there are more than two countries,
however, the pattern of pairwise comparative advantage no longer determines the pattern of
trade. In this case, the standard Ricardian model loses most of its intuitive content; see e.g.
Jones (1961) and Wilson (1980).
     When there are stochastic productivity di¤erences within each industry, Assumption A1
and Ranking (10) further imply:
                                      a1i1 (!)                          aki1 (!)                  aK
                                                                                                   i1 (!)
(11)                                                     ::::                          :::                ;
                                      a1i2 (!)                          aki2 (!)                  aK
                                                                                                   i2 (!)
                                               NEW RICARDIAN PREDICTIONS                                                                11

where         denotes the …rst-order stochastic dominance order among distributions.7 In other
words, Ranking (11) is just a stochastic— hence weaker— version of the ordering of labor re-
quirements aki , which is at the heart of the Ricardian theory. Like its deterministic counter-
part in (10), Ranking (11) captures the idea that country i1 is relatively better at producing
the high k goods. But whatever k is, country i2 may still have lower labor requirements on
some of its varieties.
   According to Corollary 3, Ranking (11) does not imply that country i1 should only produce
and export the high k goods, but instead that it should produce and export relatively more
of these goods. This is true irrespective of the number of countries in the economy. Unlike
the standard Ricardian model, our stochastic theory of comparative advantage generates a
clear and intuitive correspondence between labor productivity and exports. In our model,
the pattern of comparative advantage for any pair of exporters fully determines their relative
export performance across industries.
   Another perspective on Corollary 3 is that, for any pair of exporters, the ranking of their
relative exports towards any importing country fully reveals their comparative advantage.
By observing exports across countries and industries, one can directly infer— according to our
model— the ranking of relative productivity levels. Thus, our results also provide theoretical
foundations to measures of revealed comparative advantage à la Balassa (1965).8 We explore
that idea in details in Appendix D.
   The previous discussion may seem paradoxical. As we have just mentioned, Ranking
(11) is a weaker version of the ordering at the heart of the standard theory. If so, how
does our stochastic theory lead to …ner predictions? The answer is simple: it does not.
While the standard Ricardian model is concerned with trade ‡ows in each variety of each
good, we only are concerned with the total trade ‡ows in each good. Unlike the standard
model, we recognize that random shocks— whose origins remain outside the scope of our
   7 To   see this, note that for any A 2 R+ we have Pr aki1 (!)=aki2 (!)                          A = Prfuki1 (!)    uki2 (!)   ln A
                                                                               0          0
ln aki1 +ln aki2 g                        0
                     . Since for any k < k ,   uki1 (!)    uki2 (!)   and   uki1 (!)   uki2 (!)   are drawn from the same distribution
by A1, Ranking (10) implies:
                         (                          )            (     0
                                                                                   )                      0
                                    aki1 (!)                         aki1 (!)              aki1 (!)    aki1 (!)
                               Pr                A        < Pr          0        A     ,                  0
                                    aki2 (!)                         aki2 (!)              aki2 (!)    aki2 (!)


   8 We   thank Kei-Mu Yi for bringing this to our attention.
12                                          COSTINOT AND KOMUNJER

                                          Table 1: Data Set Description
      Sources: OECD STAN Bilateral Trade Database; International Comparisons of Output and Productivity Industrial
      Database

      Years 1988-2001

      Exporters:            Austria, Belgium, Denmark, Finland, France, Germany, Greece, Ireland, Italy, Netherlands,
                            Portugal, Spain, Sweden, United Kingdom, United States
      Importers:            Exporters + Argentina, Australia, Brazil, Canada, Chile, China, Cyprus, Czech Republic,
                            Estonia, Hong Kong, Hungary, Iceland, India, Indonesia, Japan, Korea, Latvia, Lithuania,
                            Luxembourg, Malaysia, Malta, Mexico, New Zealand, Norway, Phillipines, Poland, Russian
                            Federation, Singapore, Slovak Republic, Slovenia, South Africa, Switzerland, Taipei,
                            Thailand, Turkey

      Product Classification System: The industrial breakdown presented for the STAN indicators database is based
      upon the International Standard Industrial Classification (ISIC) Revision 3.

      Industry:             STAN Description:                                                           ISIC Rev. 3

      Food                  Food products, beverages and tobacco                                        15-16
      Textile               Textiles, textile products, leather and footwear                            17-19
      Wood                  Wood and products of wood and cork                                          20
      Paper                 Pulp, paper, paper products, printing and publishing                        21-22
      Chemicals             Chemicals                                                                   24
      Plastic               Rubber and plastics products                                                25
      Minerals              Other non-metallic mineral products                                         26
      Basic metals          Basic Metals                                                                27
      Metal products        Fabricated metal products, except machinery and equipment                   28
      Machinery             Machinery and equipment, n.e.c.                                             29
      Office                Office, accounting and computing machinery                                  30
      Electrical            Electrical machinery and apparatus, n.e.c.                                  31
      Telecom               Radio, television and communication equipment                               32
      Medical               Medical, precision and optical instruments, watches and clocks              33
      Automobile            Motor vehicles, trailers and semi-trailers                                  34
      Shipbuilding          Building and repairing of ships and boats                                   351
      Aircraft              Aircraft and spacecraft                                                     353
      Transport             Railroad equipment and transport equipment n.e.c.                           352+359
      Other                 Manufacturing n.e.c.                                                        36-37


model— may a¤ect the costs of production of any variety. Yet, by assuming that these
shocks are identically distributed across a large number of varieties, we manage to generate
sharp predictions at the industry level.

                                           4. Empirical Evidence

     We now confront our theoretical predictions with the data.

4.1. Data Description. Table 1 describes our data set. It includes 15 exporters, 14 Eu-
ropean countries plus the United States; 50 importers, both OECD and large non-OECD
countries; and 19 manufacturing industries from 1988 to 2001. Sample selection was entirely
                                     NEW RICARDIAN PREDICTIONS                             13

dictated by the availability of both bilateral trade data and productivity data comparable
across countries and industries. Trade data are from the OECD Structural Analysis (STAN)
Bilateral Trade Database. The value of exports xkij by exporting country i, importing country
j, and industry k is directly available in thousands of US dollars, at current prices. Pro-
ductivity data are from the International Comparisons of Output and Productivity (ICOP)
Industrial Database developed by the University of Groningen.9 A key characteristic of the
ICOP is the use of relative producer prices, or “unit value ratios”, to convert output by in-
dustry to a common currency. Throughout this section, we use “total hours worked”divided
by “value added in 1997 $US at unit value ratios”as our measure of the unit labor require-
ment aki in country i and industry k. We come back to the formal relationship between this
proxy and our model in Section 4.4.


4.2. A First Look at the Pattern of Exports. Corollary 3 imposes a strong restriction
on the pattern of exports. For any pair of exporters, i1 and i2 , the ranking by industry of
their relative exports should be constant across importers. Formally, we should observe that
                                              !                 !
                              xki11j1 xki12j1   xki11j2 xki12j2
(12)                                                              >0
                              xki21j1 xki22j1   xki21j2 xki21j2

for all goods, k1 and k2 , and importers, j1 and j2 . Consider 2 exporters, the United States
and Germany, and 2 goods, aircrafts and cars. According to Property (12), if Germany
exports relatively more cars towards France than the United States, then it should also
export relatively more cars towards Mexico. The absolute levels of German and US exports
may vary between France and Mexico due to changes in demand and transport costs, but
the relative export performance of Germany and the United States in these two industries
may not.
  A raw look at the data su¢ ces to show that this restriction does not hold with certainty.
Among the 17; 955 groups of exporters and industries included in our 1997 sample, the prob-
ability that the two terms in Equation (12) have the same sign for two distinct importers is
equal to 69%. This fairly small number should not be too surprising. First, trade data are
notoriously plagued with measurement errors; see Anderson and Wincoop (2004). Second,

  9 See   http://www.ggdc.net/index-dseries.html for details
14                                                                COSTINOT AND KOMUNJER

there exist trade barriers violating Assumption A2 in practice. For example, bilateral dis-
tance may have a di¤erential impact on goods of di¤erent weights; see e.g. Harrigan (2005).
With this in mind, we turn to linear regressions that incorporate explicitly the existence of
measurement error in trade ‡ows and/or transport costs not accounted by Assumption A2.

4.3. Exports and Measured Productivity. In line with Theorems 1 and 2, we consider
the following linear regression model
                                                                                           k
(13)                                                      ln xkij =           ij   +       j   + ln aki + "kij ;
                          k
where         ij   and    j     are treated as importer–exporter and importer–industry …xed e¤ects, re-
spectively, and          "kij     is an error term. Whether "kij is interpreted as measurement error in trade
‡ows or unobserved transport costs, we shall assume that "kij is independent across countries
i and j as well as across industries k; that "kij is heteroskedastic conditional on i, j and k;
and that "kij is uncorrelated with ln aki .
     The previous orthogonality condition rules out situations where country j tends to discrim-
inate more against country i in industries where i is more productive. Were these situations
prevalent in practice, due to endogenous trade protection, our OLS estimates of                                                                         would be
biased towards zero.10 Similarly, our orthogonality condition rules out any potential errors
in the measurement of labor productivity at the industry level, which obviously is a strong
assumption. If this measurement error is uncorrelated with ln aki , this should further bias
our OLS estimates of                            towards zero.
     The main prediction of Theorems 1 and 2 is that the elasticity of exports with respect
to the average unit labor requirement should be negative and constant across importers,
     10 Suppose     that trade barriers, dkij , and exports, xkij , are simultaneously determined according to
                                         8
                                         < ln dk = ln d + ln dk + ln xk
                                                  ij      ij         j        ij
                                         : ln xk = e + e k + ln ak + ln dk
                                                                   ij         ij       j                i           ij

where      > 0 captures the fact that higher levels of import penetration lead to higher levels of protection.
The previous system can be rearranged as
                     8
                     < ln dk = (1                                       k
                            ij          ) 1 [ln dij + ln dkj + e ij + e j +                                                 ln aki ]
                     : ln xk =      + k + ln ak + "k
                                                 ij       ij        j              i           ij

                                                                                                    k
where    ij   = (1            )    1
                                       [ e ij +       ln dij ],    k
                                                                   j    = (1           )       1
                                                                                                   [ej +    ln dkj ], and "kij =       2
                                                                                                                                           (1   )   1
                                                                                                                                                        ln aki . This
                                       2                                  2
implies E[ln aki "kij ] =                  (1         )   1
                                                              E[ ln aki ] > 0, and in turn, the upward bias in the OLS estimate of .
                                                  NEW RICARDIAN PREDICTIONS                                                  15

                                                Table 2: Year-by-Year OLS Regressions
                                                        (Dependent Variable: lnx)

       Variable                 2001        2000        1999        1998        1997        1996        1995
       ln a                    -0.98       -0.73       -0.97       -1.08       -1.42       -1.39       -1.27
                            (-20.90)*** (-16.67)*** (-20.25)*** (-20.84)*** (-25.59)*** (-24.13)*** (-22.05)***
       Exporter-Importer FE     Yes         Yes         Yes         Yes         Yes         Yes         Yes
       Industry-Importer FE     Yes         Yes         Yes         Yes         Yes         Yes         Yes
       Observations            11858       11966       11967       11770       11748       11699       11638
         2
       R                        0.83        0.83        0.83        0.83        0.83        0.83        0.82

       Variable                1994        1993        1992        1991        1990        1989        1988
       ln a                    -1.31       -1.06       -1.20       -1.16       -0.99       -1.00      -0.74
                            (-20.56)*** (-18.79)*** (-17.87)*** (-17.25)*** (-15.01)*** (-15.16)*** (-9.83)***
       Exporter-Importer FE     Yes         Yes         Yes         Yes         Yes         Yes        Yes
       Industry-Importer FE     Yes         Yes         Yes         Yes         Yes         Yes        Yes
       Observations            9316        9223        8731        8003        7807        7752        6938
         2
       R                        0.83        0.83        0.84        0.83        0.83        0.83       0.83
       Note: Values of t-statistics in parentheses, calculated from heteroskedasticity-consistent (White) standard errors
       * Significant at 10% confidence level
       ** Significant at 5% confidence level
       *** Significant at 1% confidence level




exporters, and industries:

                                                   (@ ln xkij )= @ ln aki =              <0

with       =           or          under the assumptions of Theorem 1 or 2, respectively. The OLS
estimates of            are reported in Table 2 for each year 1988-2001. Overall, we view these
results as strongly supportive of our new Ricardian predictions. In line with Theorems 1
and 2— and in spite of the potential biases towards zero discussed above— we …nd that                                        is
negative and signi…cant at the 1% level for every year in the sample. The largest regression
estimate, in absolute value, is obtained in 1997, which is the year for which the ICOP’s
relative producer prices were collected.
  Is the impact of measured productivity on the pattern of international specialization eco-
nomically signi…cant as well? As mentioned in Section 3, we cannot use our estimate of
to predict the changes in levels of exports associated with a given change in labor produc-
tivity. However, we can follow a di¤erence-in-di¤erence approach to predict relative changes
in exports across countries and industries. Consider, for example, two exporters, i1 and i2 ,
and two industries, k1 and k2 , in 2001. If aki11 decreases by 10%, then our prediction is that:

                      ln xki11j        ln xki12j             ln xki21j        ln xki22j = b2001           ln aki11 ' 9:8%:
16                                        COSTINOT AND KOMUNJER

This is consistent with a scenario where country i1 ’s exports of good k1 go up by 7% and
(because of the associated wage increase in country i1 ) those of k2 go down by 2:8%, while
they remain unchanged in both industries in country i2 .
     To help understand the size of the e¤ects reported in Table 2, we can also use the standard
deviations of ln aki and ln xkij in 2001, 0:74 and 2:72, respectively. Our estimates suggest that,
ceteris paribus, a one standard deviation decrease in ln aki should increase the dependent
variable by 0:26 standard deviations.

4.4. Selection bias. There is one serious concern regarding the previous empirical results.
In practice, statistical agencies do not observe the entire “universe” of varieties. Instead,
they only observe the varieties that are actually produced in a given country and industry.
This selection bias may, in principle, lower our OLS estimates. If better productivity draws
are observed when aki is high, then di¤erences in measured productivity will be smaller than
di¤erences in fundamental productivity levels, which may arti…cially raise (in absolute value)
the elasticity of exports with respect to the average unit labor requirement.
     In Appendix E, we show how to control explicitly for selection bias under a mild restriction
on the structure of transport costs: di1 i3           di1 i2 di2 i3 for any three countries, i1 , i2 , and i3 .
More speci…cally, we show that if the assumptions of Theorem 1 are satis…ed, then
                                                                          1
(14)                  ln E aki (!) j! 2       k
                                              i      ln E aki (!) =           ln 1    mki

where    is the parameter of the Gumbel distribution; ki is the set of varieties of good k
                                          P            .P
                                                         I
actually produced by country i; and mki       0   x k
                                                     0
                                             i 6=i i i
                                                                k
                                                         i0 =1 xi0 i is the import penetration

ratio in country i and industry k. We derive a similar result under the assumptions of
Theorem 2.
     According to Equation (14), the import penetration ratio is a su¢ cient statistic for the
extent of the selection bias. As the import penetration ratio goes down, more varieties are
produced in country i, which decreases the measurement error associated with selection. In
the extreme case where mki = 0, country i is under autarky (in that particular industry),
and the selection bias disappears.
     Using Assumption A1 and Equation (14), we can rearrange Equation (13) as

                                              k                0
                         ln xkij =   ij   +   j        aki
                                                  + ln b           ln 1       mki + "kij
                                                 NEW RICARDIAN PREDICTIONS                                                   17

                                    Table 3: Year-by-Year OLS Regressions with Selection
                                                   (Dependent Variable: lnx)

         Variable                 2001        2000        1999        1998        1997        1996        1995
         ln a                    -0.94       -0.68       -0.84       -0.99       -1.39       -1.17       -1.18
                              (-20.05)*** (-12.09)*** (-15.29)*** (-17.31)*** (-22.59)*** (-19.84)*** (-19.07)***
         ln (1-m)                 0.33        0.39        0.43        0.31        0.17        0.30        0.21
                               (14.90)*** (11.62)*** (14.39)*** (11.73)*** (6.54)*** (9.81)*** (9.12)***
         Exporter-Importer FE     Yes         Yes         Yes         Yes         Yes         Yes         Yes
         Industry-Importer FE     Yes         Yes         Yes         Yes         Yes         Yes         Yes
         Observations            10067       10173       10226       10147       10232       10357       10479
           2
         R                        0.85        0.84        0.84        0.84        0.84        0.84        0.83

         Variable                1994        1993        1992        1991        1990       1989        1988
         ln a                    -1.09       -0.90       -1.08       -1.12      -0.63       -0.83      -0.60
                              (-15.42)*** (-14.71)*** (-15.23)*** (-16.20)*** (-9.52)*** (-11.74)*** (-7.12)***
         ln (1-m)                 0.14        0.41        0.27        0.09       0.91        0.31       0.25
                               (4.85)*** (7.67)*** (7.79)*** (2.93)*** (15.62)*** (8.73)*** (6.06)***
         Exporter-Importer FE     Yes         Yes         Yes         Yes        Yes         Yes        Yes
         Industry-Importer FE     Yes         Yes         Yes         Yes        Yes         Yes        Yes
         Observations            8768        8711        8296        7615        7143       7088        6270
           2
         R                        0.84        0.84        0.85        0.84       0.85        0.84       0.83
        Note: Values of t-statistics in parentheses, calculated from heteroskedasticity-consistent (White) standard errors
        * Significant at 10% confidence level
        ** Significant at 5% confidence level
        *** Significant at 1% confidence level


                                                                  0
        aki
with ln b            ln E aki (!) j! 2             k
                                                   i    and           =    = . Table 3 reports the OLS estimates of
when ln 1            mki is included on the right hand side.11 After controlling for selection, our
estimates of            increase slightly, but remain negative and statistically signi…cant. Similarly,
the impact of ln 1                mki has the right sign and is statistically signi…cant.
     From a quantitative standpoint, we need to acknowledge that our OLS estimates of and
 0
     appear to be too small. Under Eaton and Kortum’s (2002) distributional assumptions, b
should be equal to the parameter of the Gumbel , which they have estimated at 8:27, and
b0 should be equal to 1. This is not what we observe in the data. Interestingly, however,
                                0
the ratio of our estimates, b=b , is much more in line with Eaton and Kortum (2002). In
                                                                                 0
1997, the year for which relative producer prices have been collected, we get b=b = 8:21.
Taken together, these results are consistent with the idea that both productivity and import
penetration ratios are poorly measured in practice.12
     11 Import  penetration ratios are directly available in the OECD STAN database.
     12 In   STAN, potential sources of error in the measurement of import penetration ratios include: (i) the
existence of “transit trade”; (ii) the underreporting of secondary activities in industrial surveys; and (iii) the
misclassi…cations due to conversions from product-based trade statistics to activity-based industry statistics.
18                                        COSTINOT AND KOMUNJER

4.5. Relation to the previous empirical literature. As mentioned in the introduction,
previous Ricardian “tests” were remarkably successful. In light of this evidence, it is per-
haps not too surprising to uncover, as we just did, a positive association between measured
productivity and trade ‡ows in the data.13
     Nevertheless, we believe that the tight connection between the theory and the empirical
analysis that our paper o¤ers is a signi…cant step beyond the existing literature. First, we do
not have to rely on ad-hoc measures of export performance such as total exports towards the
rest of the world (MacDougall, 1951; Stern, 1962); total exports to third markets (Balassa,
1963); or bilateral net exports (Golub and Hsieh, 2000). The theory tells us exactly what the
dependent variable in the cross-industry regressions ought to be: ln(exports), disaggregated
by exporting and importing countries. Second, the careful introduction of country and
industry …xed e¤ects allows us to move away from the bilateral comparisons inspired by the
two-country model, and in turn, to take advantage of a much richer data set. Third, our
clear theoretical foundations make it possible to discuss the economic origins of the error
terms— measurement errors in trade ‡ows or unobserved trade barriers— and as a result, the
plausibility of our orthogonality conditions.
     Of course, one might argue that the model developed in this paper— Assumptions A1-A4—
is not the only way to bring the Ricardian model to the data. For example, we could also
obtain Equation (13) by directly imposing Armington’s preferences.14 While this is certainly
true, the attractiveness of our approach lies in the weakness of the assumptions under which
Equation (13) is derived. As long as there are stochastic productivity di¤erences within
each industry, our analysis demonstrates that many of the assumptions usually invoked to
rationalize cross-industry regressions— either on preferences or on transport costs— can be
relaxed. Put simply, our paper may not o¤er researchers brand new regressions to run, but
we hope it can make them more comfortable running them.

     13
          In terms of magnitude, our estimates lie between those of the early Ricardian “tests”— MacDougall
(1951), Stern (1962), and Balassa (1963)— and the more recent …ndings of Golub and Hsieh (2000). Using
US and UK data, MacDougall (1951), Stern (1962), and Balassa (1963) …nd elasticities of exports with
respect to average unit labor requirements around       1:6. By contrast, the highest elasticity estimated by
Golub and Hsieh (2000) is equal to 0:37; see Table 2 p228.
  14 Deardor¤ (2004) analyzes the impact of production and trade costs on the net direction of countries’

bilateral trade with a model developed along these lines.
                                NEW RICARDIAN PREDICTIONS                                   19

  In particular, we think that our theoretical approach may be fruitfully applied to more
general environments, where labor is not the only factor of production. The basic idea,
already suggested by Bhagwati (1964), is to reinterpret di¤erences in aki as di¤erences in
total factor productivity. With multiple factors of production, the volume of exports would
be a function of both technological di¤erences, captured by aki , and di¤erences in relative
factor prices. The rest of our analysis would remain unchanged; see Appendix F.


                                 5. Concluding Remarks

  The Ricardian model has long been perceived has a useful pedagogical tool with, ulti-
mately, little empirical content. Over the last twenty years, the Heckscher-Ohlin model,
which emphasizes the role of cross-country di¤erences in factor endowments, has generated
a considerable amount of empirical work ; see e.g. Bowen, Leamer, and Sveikauskas (1987),
Tre‡er (1993), Tre‡er (1995), Davis and Weinstein (2001), and Schott (2004). The Ricardian
model, which emphasizes productivity di¤erences, almost none.
  The main reason behind this lack of popularity is not the existence of strong beliefs
regarding the relative importance of factor endowments and technological considerations.
Previous empirical work on the Heckscher-Ohlin model unambiguously shows that technology
matters. It derives instead from the obvious mismatch between the real world and the
extreme predictions (and assumptions) of the standard Ricardian model. In the words of
Leamer and Levinsohn (1995), “[it] is just too simple.”
  Although the de…ciencies of the Ricardian model have not lead to the disappearance of
technological considerations from the empirical literature, they have had a strong in‡uence on
how the relationship between technology and trade has been studied. In the Heckscher-Ohlin-
Vanek literature— with or without technological di¤erences— the factor content of trade re-
mains the main variable of interest. Building on the seminal work of Eaton and Kortum
(2002), our paper develops a “robust” theoretical framework that puts back productivity
di¤erences at the forefront of the analysis.


                                        References

Acemoglu, D., P. Antras, and E. Helpman (2007): “Contracts and Technology Adop-
  tion,”forthcoming American Economic Review.
20                                 COSTINOT AND KOMUNJER

Al-Najjar, N. (2004): “Aggregation and the Law of Large Numbers in Large Economies,”
     Games and Economic Behavior, pp. 1–35.
Anderson, J. A., and E. V. Wincoop (2004): “Trade Costs,” Journal of Economic
     Literature, pp. 691–751.
Antras, P., and E. Helpman (2004): “Global Sourcing,” Journal of Political Economy,
     pp. 552–580.
Balassa, B. (1963): “An Empirical Demonstration of Comparative Cost Theory,” Review
     of Economics and Statistics, pp. 231–238.
             (1965):   “Trade Liberalization and Revealed Comparative Advantage,” The
     Manchester School of Economic and Social Studies, 33, 99–123.
Baldwin, R. E. (1971): “Determinants of the Commodity Structure of U.S. Trade,”Amer-
     ican Economic Review, 61(1), 126–46.
Bernard, A. B., J. Eaton, J. B. Jensen, and S. Kortum (2003): “Plants and Pro-
     ductivity in International Trade,”The American Economic Review, pp. 1268–1290.
Bernard, A. B., S. J. Redding, and P. K. Schott (2006): “Comparative Advantage
     and Heterogeneous Firms,”(forthcoming) The Review of Economic Studies.
Bhagwati, J. (1964): “The Pure Theory of International Trade: A Survey,”The Economic
     Journal, pp. 1–84.
Billingsley, P. (1995): Probability and Measure. John Wiley & Sons, Inc.
Bowen, H. P., E. E. Leamer, and L. Sveikauskas (1987): “Multicountry, Multifactor
     Tests of the Factor Abundance Theory,”The American Economic Review, pp. 791–809.
Chaney, T. (2007): “Distorted Gravity: The Intensive and Extensive Margins of Interna-
     tional Trade,”mimeo University of Chicago.
Chor, D. (2006): “Unpacking Sources of Comparative Advantage: A Quantitative Ap-
     proach,”mimeo Harvard University.
Costinot, A. (2005): “Three Essays on Institutions and Trade,” Ph.D. Dissertation,
     Princeton University.
           (2006): “On the Origins of Comparative Advantage,”mimeo University of Califor-
     nia, San Diego.
Cuñat, A., and M. Melitz (2006): “Labor Market Flexibility and Comparative Advan-
     tage,”mimeo Harvard University.
                               NEW RICARDIAN PREDICTIONS                              21

Davidson, J. (1994): Stochastic Limit Theory. Oxford University Press, Oxford.
Davis, D. R., and D. E. Weinstein (2001): “An Account of Global Factor Trade,” The
  American Economic Review, pp. 1423–1453.
Deardorff, A. V. (1980): “The General Validity of the Law of Comparative Advantage,”
  Journal of Political Economy, pp. 941–957.
           (2004): “Local Comparative Advantage: Trade Costs and the Pattern of Trade,”
  mimeo University of Michigan.
           (2005): “How Robust is Comparative Advantage,”mimeo University of Michigan.
Dornbusch, R., S. Fischer, and P. Samuelson (1977): “Comparative Advantage,
  Trade, and Payments in a Ricardian Model with a Continuum of Goods,”American Eco-
  nomic Review, 67, 823–839.
Eaton, J., and S. Kortum (2002): “Technology, Geography, and Trade,” Econometrica,
  70, 1741–1779.
Ghironi, F., and M. Melitz (2005): “International Trade and Macroeconomic Dynamics
  with Heterogeneous Firms,”Quarterly Journal of Economics, pp. 865–915.
Golub, S. S., and C.-T. Hsieh (2000): “Classical Ricardian Theory of Comparative
  Advantage Revisited,”Review of International Economics, pp. 221–234.
Harrigan, J. (1997): “Technology, Factor Supplies, and International Specialization: Es-
  timating the Neo-Classical Model,”The American Economic Review, pp. 475–494.
           (2005): “Airplanes and Comparative Advantage,”NBER working paper.
Helpman, E., and P. R. Krugman (1985): Market Structure and Foreign Trade. MIT
  Press.
Helpman, E., M. Melitz, and S. Yeaple (2004): “Export versus FDI with Heteroge-
  neous Firms,”The American Economic Review, pp. 300–316.
Jones, R. W. (1961): “Comparative Advantage and the Theory of Tari¤s: A Multi-Country,
  Multi-Commodity Model,”The Review of Economic Studies, 28(3), 161–175.
Leamer, E., and J. Levinsohn (1995): “International Trade Theory: The Evidence,”
  in Handbook of International Economics, ed. by G. Grossman, and K. Rogo¤, vol. 3, pp.
  1139–1194. Elsevier Science, New York.
Levchenko, A. (2007): “Institutional Quality and International Trade,” forthcoming Re-
  view of Economic Studies.
22                                COSTINOT AND KOMUNJER

MacDougall, G. (1951): “British and American Exports: A Study Suggested by the
     Theory of Comparative Costs, Part,”Economic Journal, pp. 697–724.
Matsuyama, K. (2005): “Credit Market Imperfections and Patterns of International Trade
     and Capital Flows,”Journal of the European Economic Association, pp. 714–723.
Melitz, M. (2003): “The Impact of Trade on Intra-Industry Reallocations and Aggregate
     Inudstry Productivity,”Econometrica, pp. 1695–1725.
Morrow, P. (2006): “East is East and West is West: A Ricardian-Heckscher-Ohlin Model
     of Comparative Advantage,”mimeo Michigan University.
Nunn, N. (2007): “Relationship Speci…city, Incomplete Contracts and the Pattern of
     Trade,”forthcoming Quarterly Journal of Economics.
Petri, P. A. (1980): “A Ricardian Model of Market Sharing,” Journal of International
     Economics, pp. 201–211.
Romalis, J. (2004): “Factor Proportions and the Structure of Commodity Trade,” The
     American Economic Review, pp. 67–97.
Schott, P. (2004): “Across-Product versus Within-Product Specialization in International
     Trade,”Quarterly Journal of Economics, pp. 647–678.
Stern, R. M. (1962): “British and American Productivity and Comparative Costs in
     International Trade,”Oxford Economic Papers, pp. 275–303.
Trefler, D. (1993): “International Factor Price Di¤erences: Leontief was Right!,”Journal
     of Political Economy, pp. 961–987.
            (1995): “The Case of the Missing Trade and Other Mysteries,” The American
     Economic Review, pp. 1029–1046.
Vogel, J. (2007): “Institutions and Moral Hazard in Open Economies,”forthcoming Jour-
     nal of International Economics.
Wilson, C. A. (1980): “On the General Structure of Ricardian Models with a Continuum
     of Goods: Applications to Growth, Tari¤ Theory, and Technical Change,”Econometrica,
     pp. 1675–1702.
                                               NEW RICARDIAN PREDICTIONS                                                                             23

                               Appendix A: Proofs of Theorems 1 and 2

Proof of Theorem 1. Fix i 6= j; by the de…nition of total exports xkij and Assumption A4(i),
we have
               k
             X
             N
   xkij =           xij (!) 1I ckij (!) = min1                  i0 I   cki0 j (!)
             !=1
                                k
                   ekj        X
                              N
        =         1                 pkj (!)1     1I ckij (!) = min1                 i0 I   cki0 j (!)
              pkj             !=1
               2                                3     1   2                                                                                   3
                                k                                      k
                 XN                                            X
                                                               N
           k4 1                                 5         4 1
        = ej          pk (! 0 )1                                  pk (!)1                   1I ckij (!) = min1               i0 I   cki0 j (!) 5 ;
             N k !0 =1 j                                   N k !=1 j

where the function 1If g is the standard indicator function, i.e. for any event A, we have
1IfAg = 1 if A true, and 1IfAg = 0 otherwise. By Assumption A1, uki (!) is independent and
identically distributed (i.i.d.) across varieties so same holds for ckij (!). In addition, uki (!) is
i.i.d. across countries so 1I ckij (!) = min1                     i0 I     cki0 j (!) is i.i.d. across varieties as well. This
implies that pkj (!)1           and pkj (!)1              1I ckij (!) = min1           i0 I    cki0 j (!) are i.i.d. across varieties.
Moreover, by Assumption A4(ii), E pkj (!)1                                  < 1 so we can use the strong law of large
numbers for i.i.d. random variables (e.g. Theorem 22.1 in Billingsley (1995)) to show that
                                                 k
                                         1 X k 0
                                             N
                                                                   1       a:s:
(15)                                              p (! )                   ! E pkj (!)1                 ;
                                        N k !0 =1 j

as N k ! 1. Note that aki > 0, dkij                               1 ensure that ckij > 0 whenever wi > 0; hence
E pkj (!)1    > 0. Similarly, Assumption A4(ii) implies that

                               E pkj (!)1            1I ckij (!) = min1             i0 I   cki0 j (!)       < 1;

so we can again use the strong law of large numbers for i.i.d. random variables (e.g. Theorem
22.1 in Billingsley (1995)) to show that
                                        k
                                1 X k 1
                                   N
(16)                                  p (!)                   1I ckij (!) = min1             i0 I   cki0 j (!)
                               N k !=1 j
                                       a:s:
                                       ! E pkj (!)1                1I ckij (!) = min1               i0 I    cki0 j (!)   ;

as N k ! 1. Combining Equations (16) and (15) together with the continuity of the inverse
                         1
function x 7! x              away from 0, yields by continuous mapping theorem (e.g. Theorem 18.10
24                                                   COSTINOT AND KOMUNJER

(i) in Davidson (1994))
                2                                3   1   2                                                                                            3
                             k                                         k
                     XN                                       X
                                                              N
(17)            4 1       pk (! 0 )1             5       4 1     pk (!)1                      1I ckij (!) = min1                     i0 I   cki0 j (!) 5
                 N k !0 =1 j                              N k !=1 j
                         a:s:                                1
                         ! E pkj (!)1                                E pkj (!)1              1I ckij (!) = min1                  i0 I   cki0 j (!)         ;

as N k ! 1. Note that the quantities in Equation (17) are positive; hence, applying again the
continuous mapping theorem (e.g. Theorem 18.10 (i) in Davidson (1994)) to their logarithm
we get, with probability one,

(18)       ln xkij ! ln ekj + ln E pkj (!)1                          1I ckij (!) = min1              i0 I      cki0 j (!)             ln E pkj (!)1            ;

as N k ! 1.
     Consider Hi (ck1j ; :::; ckIj )             E pkj (!)1                1I ckij (!) = min1                  i0 I   cki0 j (!) . Assumptions A1,
A3 and straightforward computations yield

                                                     Z+1                                           Y
                                               1
(19)        Hi (ck1j ; :::; ckIj )   =    ckij          exp [(1                    )u] f (u)              1         F (ln ckij          ln cknj + u) du:
                                                         1                                         n6=i


where we let f (u)                  F 0 (u).
     Using Equation (19) together with the expressions for the (negative) Gumbel distribution
and density, we then have

            E pkj (!)1               1I ckij (!) = min1              i0 I   cki0 j (!)
                                 Z+1        n                                        h         X                                 i                     o
             =   (ckij )1                exp ( + 1                   )u       e          1+                    (ckij =cki0 j )       exp ( u         e) du
                                                                                                      i0 6=i
                                 1

                                                     1                +1             h   X               i                            ( +1      )=
             = (ckij )1          exp         e                   (                  ) 1+   0
                                                                                             (c k
                                                                                                  =ck
                                                                                                     0
                                                                                                ij i j )
                                                                                                      i 6=i

                                         1           +1                                  (ckij )
(20)         = exp              e                (                    ) hX                          i(    +1       )=
                                                                                                                        ;
                                                                               I
                                                                                    (ck0 )
                                                                               i0 =1 i j

                                                             X
where the second equality uses the change of variable v   1+          (ckij =cki0 j ) exp( u e),
                                                               i0 6=i
                                                     R +1
and where ( ) denotes the Gamma function, (t) = 0 v t 1 exp( v)dv for any t > 0. Note
                                                NEW RICARDIAN PREDICTIONS                                                                                            25

that
                                           X
                                           I
                 E pkj (!)1            =             E pkj (!)1                1I ckij (!) = min1            i0 I   cki0 j (!)      ;
                                            i=1
so that by using Equation (20) we get
                                                                 1              +1                              1
              E pkj (!)1            = exp              e                   (                ) hX                         i(1        )=
                                                                                                                                             ;
                                                                                                       I
                                                                                                            (ck0 )
                                                                                                       i0 =1 i j

and hence
                                                                                     XI
(21)                            ln xkij ' ln ekj                 ln ckij        ln               (cki0 j )      :
                                                                                         i0 =1

for N k large. Combining the above with the de…nition of ckij = dkij wi aki and Assumption
A2, then gives
                                                                                k
                                                     ln xkij '       ij   +     j     ln aki ;
                                                                                                                                    XI
                                                                                        k
for N k large, where we have let                ij           ln(dij wi ) and            j         ln ekj       ln dkj ln                                 (cki0 j )        .
                                                                                                                                                 i0 =1
This completes the proof of Theorem 1.

Proof of Theorem 2. Since Assumption A1-A4 hold, the results of Theorem 1 apply. In
particular, we know that, with probability one

       ln xkij ! ln ekj + ln E pkj (!)1                    1I ckij (!) = min1           i0 I     cki0 j (!)           ln E pkj (!)1                         ;
                                  ~ i (ck1j ; :::; ck )
as N k ! 1. We now approximate ln H                                                               ln Hi (ck1j ; :::; ckIj )              (1                 ) ln ckij
                                                    Ij

obtained from Equation (19) by its …rst order Taylor series around the symmetric case
ln ck1j = ::: = ln ckIj = ln c. Without loss of generality, we choose units of account in each
industry k such that ln c = 0. We have
                                                          Z+1
(22)                ~ i (ck ; :::; ck )
                    H                                   =    exp [(1                 )u] f (u) [1            F (u)]I      1
                                                                                                                              du;
                          1j        Ij
                                           (0;:::;0)
                                                             1


            ~ i (ck1j ; :::; ck )                                   Z+1
           @H                 Ij
(23)                     k
                                                =       (I       1)    exp [(1              )u] f 2 (u) [1             F (u)]I           2
                                                                                                                                             du;
                @ ln cij
                                    (0;:::;0)                             1

and, for i0 6= i,
                   ~ i (ck ; :::; ck )                    Z+1
                  @H     1j        Ij
(24)                          k
                                                        =    exp [(1                 )u] f 2 (u) [1           F (u)]I         2
                                                                                                                                  du:
                       @ ln ci0 j
                                            (0;:::;0)        1
26                                                    COSTINOT AND KOMUNJER

Let
                                            Z+1
                                               exp [(1            )u] f (u) [1           F (u)]I        1
                                                                                                            du;
                                            1

and                                      2 +1                                                                        3
                                           Z
                                        14
                                             exp [(1                   )u] f 2 (u) [1        F (u)]I        2
                                                                                                                 du5 :
                                              1

Combining Equations (22), (23), and (24), we then get
                                                                                                            X
      ln Hi (ck1j ; :::; ckIj ) = ln + (1                   ) ln ckij       (I     1) ln ckij +                      ln cki0 j + o   ln ckj
                                                                                                            i0 6=i

                                                                                     X
                                                                                     I
(25)                              = ln            ( I+            1) ln ckij +               ln cki0 j + o           ln ckj    ;
                                                                                     i0 =1

                     2       PI                   2
where ln ckj             =    i0 =1   ln cki0 j        denotes the usual L2 -norm, and                                > 0 only depends on
f ( ), F ( ),        and I. Combining Equation (25) with the de…nition of ckij = dkij wi aki and
Assumption A2, then gives

(26)                                     ln Hi (ck1j ; :::; ckIj ) '        ij   + gjk          ln aki ;

where

                                       ij              ln      ( I+              1) ln(dij wi )
                                                                                             X
                                                                                             I
                                      gjk                 ( I+           1) ln dkj   +               ln cki0 j
                                                                                             i0 =1
                                                          I+       1

Note that       ij   does not depend on the good index k, gjk does not depend on the country index
i, and     > 0 is a positive constant which only depends on f ( ), F ( ),                                                  and I. Combining
Equations (18) and (26) then yields

                                                      ln xkij '   ij    +   k
                                                                            j        ln aki ;

for N k large, where we have let                      k
                                                      j     ln ekj + gjk         ln E pkj (!)1              . This completes the proof
of Theorem 2.
                                       NEW RICARDIAN PREDICTIONS                                           27

                             Appendix B: Bertrand Competition

  Instead of Assumption A3, we now consider:

A3’. In any country j, the price pkj (!) paid by buyers of variety ! of good k is


                                 pkj (!) = min min
                                               0
                                                   cki0 j (!) ; mcki j (!) ;
                                                 i 6=i


where cki j (!) = min1    i0 I   ckij (!) and m = =(          1) is the monopoly markup.

  This is in the spirit of Bernard, Eaton, Jensen, and Kortum (2003): the producer with the
minimum cost may either charge the cost of its closest competitor or the monopoly price.
We then have the following result:



Theorem 4. Suppose that Assumptions A1, A2, A3’, and A4 hold. In addition, assume that
the number of varieties N k of any good k is large, and that technological di¤erences across
exporters are small: ck1j ' ::: ' ckIj . Then, for any exporter i, any importer j 6= i, and any
good k,

(27)                                    ln xkij ' eij + ekj    e ln aki :

where e >     (     1)=(I        1).



  Under Bertrand competition, the qualitative insights of Theorem 2 remain valid, albeit
in a weaker form. We obtain new importer–exporter and importer–industry …xed e¤ects,
eij and ekj , and a new parameter e constant across countries and industries. However, the
restriction e >     (       1)=(I      1) is less stringent than in the case of perfect competition.
When      ! 1, that is when varieties become perfect substitutes, or when I ! +1, that is
when the number of exporters is very large, this collapses to: e                 0.


Proof of Theorem 4. Compared to the proof of Theorem 2, the only di¤erence comes from the
expression of Hi (ck1j ; :::; ckIj ) = E pkj (!)1        1I ckij (!) = min1   i0 I   cki0 j (!) . Assumptions
28                                                            COSTINOT AND KOMUNJER

A1, A3’and straightforward computations now yield

                                                              Z+1           Z+1
                                                    1
(28)         Hi (ck1j ; :::; ckIj )   =        ckij              f (u1 )du1    [min (exp u2 ; m exp u1 )]1
                                                               1                  u1
                                               (                                                                                              )
                                      X             Y
                                                               1     F (ln ckij        ln cki00 j + u2 ) f (ln ckij      ln cki0 j + u2 ) du2 :
                                      i0 6=i     i00 6=i;i0


     where we let f (u)                    F 0 (u).
                                      ~ i (ck ; :::; ck )
     As previously, we approximate ln H                                                       ln Hi (ck1j ; :::; ckIj ) (1        ) ln ckij , obtained
                                            1j        Ij

from Equation (28), by its …rst order Taylor series around the symmetric case ln ck1j = ::: =
ln ckIj = 0. We have

                                                                Z+1            Z+1
                     ~ i (ck1j ; :::; ckIj )
                     H                                        =    f (u1 ) du1    [min (exp u2 ; m exp u1 )]1
                                                 (0;:::;0)
                                                                    1                   u1

(29)                                                          (I     1) [1        F (u2 )]I    2
                                                                                                   f (u2 )du2 ;



          ~ i (ck ; :::; ck )                                          Z+1            Z+1
         @H     1j        Ij
                     k
                                                =        (I         1)    f (u1 ) du1    [min (exp u2 ; m exp u1 )]1
              @ ln cij
                                   (0;:::;0)                            1                     u1
                                                n                                                                                             o
(30)                                                  f 0 (u2 ) [1         F (u2 )]I    2
                                                                                             + (I      2) f 2 (u2 ) [1     F (u2 )]I      3
                                                                                                                                                  du2 ;


and, for i0 6= i,

                                                 Z+1            Z+1
     @Hi (ck1j ; :::; ckIj )
                                               =    f (u1 ) du1    [min (exp u2 ; m exp u1 )]1
         @ ln cki0 j
                               (0;:::;0)              1                      u1
                                                    n                                                                                             o
                                                               0                         I 2                      2                        I 3
(31)                                                          f (u2 ) [1      F (u2 )]         + (I       2) f (u2 ) [1       F (u2 )]                du2 :


     Let then

                                  Z+1            Z+1
(32)                 (I        1)    f (u1 ) du1    [min (exp u2 ; m exp u1 )]1                               [1      F (u2 )]I    2
                                                                                                                                       f (u2 )du2 ;
                                    1                          u1
                                                    NEW RICARDIAN PREDICTIONS                                                                                29

and

                                  Z+1            Z+1
                              1
                                     f (u1 ) du1    [min (exp u2 ; m exp u1 )]1
                                  1                          u1
                     n                                                                                                            o
                          0                                   I 2                       2                                   I 3
(33)                     f (u2 ) [1                 F (u2 )]          + (I        2) f (u2 ) [1              F (u2 )]                 du2 :

Combining Equations (29), (30), and (31), we get
                                                                                                                      X
      ln Hi (ck1j ; :::; ckIj ) = ln + (1                         ) ln ckij       (I       1) ln ckij +                        ln cki0 j + o    ln ckj
                                                                                                                      i0 6=i

                                                                                               X
                                                                                               I
                              = ln                    ( I+              1) ln ckij +                   ln cki0 j + o           ln ckj     ;
                                                                                               i0 =1

                 2       PI                          2
where ln ckj         =    i0 =1       ln cki0 j           as previously, and                   only depends on f ( ), F ( ),                             and I.
Let

                                                                  e       I+               1

It remains to be shown that e > (      1)=(I 1).
                        R +1
   For this, let I(u1 )  u1
                             [min (exp u2 ; m exp u1 )]1                                           f 0 (u2 ) [1             F (u2 )]I     2
                                                                                                                                              du2 . We can
rearrange I(u1 ) as

                           Z m
                         u1+ln

(34)          I(u1 ) =                [exp u2 ]1               f 0 (u2 ) [1       F (u2 )]I       2
                                                                                                       du2
                            u1

                                                           Z+1
                                               1
                     + [m exp u1 ]                                f 0 (u2 ) [1         F (u2 )]I        2
                                                                                                            du2
                                                     u1+ln m

                     =        [exp u1 ]1                 f (u1 ) [1     F (u1 )]I       2


                                            Z m
                                          u1+ln

                         (1           )                  [exp u2 ]1           f (u2 ) [1        F (u2 )]I         2
                                                                                                                      du2
                                               u1

                                      Z+1
                     + (I          2)    [min (exp u2 ; m exp u1 )]1                              f 2 (u2 ) [1            F (u2 )]I      3
                                                                                                                                              du2
                                          u1
30                                                        COSTINOT AND KOMUNJER

where the second equality uses a simple integration by parts. Combining Equations (33) and
(34), we then get
                                              Z+1           n
                                 =        1
                                                 f (u1 ) du1 [exp u1 ]1                f (u1 ) [1     F (u1 )]I      2

                                               1

                                                      Z m
                                                    u1+ln
                                                                                                                  o
(35)                                 (         1)           [exp u2 ]1       f (u2 ) [1       F (u2 )]I    2
                                                                                                               du2 :
                                                     u1

Using Equations (32) and (35), we then have

     (I        1) +        1
                           Z+1
     = (I        1)    1
                              [exp u1 ]1            f 2 (u1 ) [1       F (u1 )]I   2
                                                                                       du1
                           1

                                         Z+1                   Z m
                                                             u1+ln

          (I     1)(       1)        1
                                            f (u1 ) du1                 [exp u2 ]1       f (u2 ) [1     F (u2 )]I        2
                                                                                                                             du2
                                         1                    u1

                                         Z+1                 Z+1
     + (I        1)(       1)        1
                                              f (u1 ) du1          [min (exp u2 ; m exp u1 )]1             [1        F (u2 )]I     2
                                                                                                                                       f (u2 )du2
                                         1                  u1

                           Z+1
     = (I        1)    1
                                [exp u1 ]1          f 2 (u1 ) [1       F (u1 )]I   2
                                                                                       du1
                           1

                                         Z+1                     Z+1
     + (I        1)(       1)        1
                                            f (u1 ) du1                 [m exp u1 ]1         [1     F (u2 )]I    2
                                                                                                                     f (u2 )du2 ;
                                         1                  u1 +ln m

which is positive by inspection. Hence, writing e = I(I 1) 1 [(I 1) +                                                    1] (I 1) 1 (               1)
                                                                                                                     1
and using (I           1) +                   1 > 0 yields the desired result: e >                    (I        1) (           1).
                                            NEW RICARDIAN PREDICTIONS                                                                    31

                              Appendix C: The Gumbel Distribution
  In the main text, we showed that under Eaton and Kortum’s (2002) distributional assump-
tion, the elasticity of exports with respect to the average unit labor requirement is equal to
the shape parameter of the Gumbel . Hence, changes in the elasticity of substitution
across countries and industries do not a¤ect the predictions of Theorem 1.
  This result crucially relies on the following property of the Gumbel distribution:

(36)             Pr pkj (!)           p = Pr pkj (!)                   p ckij (!) = min1       i0 I   cki0 j (!) ;

for any p > 0 and any 1                i        I. Property (36) states that the distribution of the price
pkj (!) of a given variety ! of good k in country j is independent of the country of origin i;
see Eaton and Kortum (2002) p1748 for a detailed discussion. Unfortunately, this property
does not generalize to other standard distributions, as we show in the following Theorem.


Theorem 5. Suppose that Assumptions A1-A4 hold and that f (u)                                              F 0 (u) > 0 for any u
in R. Then, for any p > 0 and any 1                        i      I, we have:

Pr pkj (!)     p = Pr pkj (!)                 p ckij (!) = min1            i0 I   cki0 j (!) , F ( ) satis…es Equation (6)


  Put simply, the only distribution with full support satisfying Property (36) is the Gumbel.

Proof of Theorem 5. That Equation (6) is su¢ cient for Property (36) to hold is a matter of
simple algebra. We now show that it is also necessary: if Equation (36) is satis…ed, then
F ( ) is Gumbel. First, note that Property (36) is equivalent to
                 Pr pkj (!)           p; ckij (!) = min1            i0 I   cki0 j (!)
                                                                                         = Pr pkj (!)        p ;
                            Pr ckij (!) = min1             i0
                                                                   k
                                                                I ci0 j (!)

for all p > 0 and any 1          i         I, which in turn is equivalent to having
(37)
  Pr pkj (!)    p; cki1 j (!) = min1          i0 I   cki0 j (!)        Pr pkj (!)          p; cki2 j (!) = min1      i0 I   cki0 j (!)
                                                                   =                                                                     ;
       Pr cki1 j (!) = min1          i0 I   cki0 j (!)                            Pr cki2 j (!) = min1      i0 I   cki0 j (!)
for all p > 0 and any 1          i1 ; i2        I. Using Assumptions A1 and A3, we have
                                                                  Z+1      Y
(38)     Pr    cki1 j (!)   = min1     i0
                                                k
                                             I ci0 j (!)        =    f (u)   1              F (ln cki1 j    ln cki0 j + u) du
                                                                   1           i0 6=i1
32                                                             COSTINOT AND KOMUNJER

and

                                      Pr pkj (!)               p; cki1 j (!) = min1               i0 I   cki0 j (!)
                                            ln p ln cki
                                               Z         1j
                                                                      Y
(39)                                  =                       f (u)             1       F (ln cki1 j          ln cki0 j + u) du;
                                                1                     i0 6=i1

with similar expressions for i2 . So the condition in Equation (37) is equivalent to

     ln p ln cki            Y
         R     1j
                    f (u)             1      F (ln cki1 j          ln cki0 j + u) du
          1                 i0 6=i1
         R
         +1            Y
              f (u)             1         F (ln cki1 j         ln cki0 j + u) du
          1           i0 6=i1

                                                                                ln p ln cki              Y
                                                                                    R       2j
                                                                                                 f (u)             1      F (ln cki2 j         ln cki0 j + u) du
                                                                                     1                   i0 6=i2
                                                                         =                         Y                                                                ;
                                                                                    R
                                                                                    +1
                                                                                         f (u)                1        F (ln cki2 j      ln cki0 j   + u) du
                                                                                     1             i0 6=i2

for all p > 0 and any 1                         i1 ; i2         I. Di¤erentiating the above equality with respect to ln p
and using the fact that f (x) > 0 and hence F (x) < 1 for all x 2 R, this in turn implies
                                                                                     R
                                                                                     +1              Y
                                                                                            f (u)              1        F (ln cki1 j      ln cki0 j + u) du
       f (ln p        ln cki1 j )     1      F (ln p           ln cki2 j )              1           i0 6=i1
                                                                                =                    Y                                                          ;
       f (ln p        ln cki2 j )     1      F (ln p           ln cki1 j )           R
                                                                                     +1
                                                                                            f (u)              1        F (ln cki2 j      ln cki0 j   + u) du
                                                                                        1           i0 6=i2

for all p > 0 and any 1                        i1 ; i2         I. Since the right-hand side of the above equality does not
depend on p, we necessarily have that
                                                   hF (p=cki1 j )
(40)                                                              only depends on cki1 j ; cki2 j ;
                                                   hF (p=cki2 j )
where hF ( ) is a modi…ed hazard function of F ( ), i.e. hF (x)                                                          [1     F (ln x)] 1 f (ln x) for any
x > 0. We now make use of the following Lemma:


Lemma 6. If for any positive constants c1 and c2 , hF (x=c1 )=hF (x=c2 ) only depends on c1 ; c2 ,
then necessarily hF (x) is of the form hF (x) = x where                                                            > 0 and             real.
                                   NEW RICARDIAN PREDICTIONS                                        33

Proof of Lemma 6. Let U (t; x)          hF (tx)=hF (x) for any x > 0 and any t > 0. Consider
t1 ; t2 > 0: we have
                                               hF (t1 t2 x)
                                U (t1 t2 ; x) =
                                                 hF (x)
                                               hF (t1 t2 x) hF (t1 x)
                                             =
                                                hF (t1 x)     hF (x)
(41)                                         = U (t2 ; t1 x) U (t1 ; x):

If the assumption of Lemma (6) holds then U (t; x) only depends on its …rst argument t and
we can write it U (t). Hence the Equation (41) becomes

                                      U (t1 t2 ) = U (t2 ) U (t1 ):

So, U ( ) solves the Hamel equation on R+ and is of the form U (t) = t for some real . This
implies that

(42)                                     hF (xt) = x hF (t):

Consider t = 1 and let         hF (1) > 0; Equation (42) then gives

                                            hX (x) = x ;

which completes the proof of Lemma 6.

(Proof of Theorem 5 continued). The result of Lemma 6 allows us to characterize the class
of distribution functions F ( ) that satisfy Property (36). For any u 2 R, we have
                                        f (u)
(43)                                           =        exp( u):
                                       1 F (u)
Note that when u !          1 we have f (u); F (u) ! 0 so that necessarily          > 0. We can now
integrate Equation (43) to obtain for any u 2 R
                               h                i
(44)           F (u) = 1 exp      exp u + ln( )   with                  > 0 and    > 0;

which belongs to the (negative) Gumbel family. Noting the expected value of the (negative)
                                                             1
Gumbel distribution in Equation (44) equals                      (ln( = ) + e), where e is the Euler’s
constant, we necessarily have, by Assumptions A1 and A4(ii),

                F (u) = 1     exp [ exp ( u       e)] with       >      1 for any u 2 R;

which completes the proof of Theorem 5.
34                                                COSTINOT AND KOMUNJER

                           Appendix D: Revealed Comparative Advantage

     This Appendix illustrates how our theoretical framework may be used to reveal the pattern
of comparative advantage. The basic idea is to follow the three-term decomposition o¤ered
by Theorems 1 and 2 and consider a panel model of the form

                                                                        k       k
(45)                                              ln xkij =   ij   +    j   +   i   + "kij ;

                    k           k
where        ij ,   j,   and    i   are treated as importer–exporter, importer–industry, and exporter-
industry …xed e¤ects, respectively, and "kij is an error term.15 In the absence of "kij , there
would be, for any pair of exporters, a unique ranking of relative exports by industry, as
suggested in Corollary 3. Furthermore, this ranking would be entirely determined by the
                                                                                                                              k           k
                                                                                                k                            xi 1j       xi 2j
cross-industry and cross-country variation of the third term,                                   i.   If   "kij   = 0, then    k
                                                                                                                               1
                                                                                                                                     >    k
                                                                                                                                           1
                                                                                                                                                 if
                                                                                                                             xi 1j       xi 2j
                                                                                                                               2           2
                    k1     k1        k2    k2                                              k
and only if         i1     i2   >    i1    i2 .   Hence, the estimates of                  i   can be interpreted as a revealed
measure— up to a monotonic transformation— of the fundamental productivity levels, aki ,
that determine the Ricardian chain of of comparative advantage.
                                                                                           k          k
     Table 4 reports the ranking of the OLS estimates of                                   US         i     across industries for all
exporters i 6= U nited States in 1997, from the highest to the lowest value. According to our
estimates, “Aircraft” always is the …rst industry in the chain of comparative advantage of
the United States. Compared to any other country in our sample, the United States tend
to export more in the aircraft industry than in any other industry. The industries at the
bottom of the US chain of comparative advantage tend to be “Basic Metals”and “Textile”,
depending on the identity of the other exporter. A notable exception is Germany for which
“Automobile”is the bottom industry.
     Note that there is a close connection between Balassa (1965) and the present paper.
Like Balassa (1965), we o¤er a methodology that uses data on relative exports to infer the
pattern of comparative advantage across countries and industries. In his well-known paper,
the revealed comparative advantage of country i in industry k is de…ned as
                                                         !,                 PI                            !
                                                                                       k
                                        xkiW orld                             i0 =1 xi0 W orld
                                      PK      k0
                                                                       PI PK              k0
                                       k0 =1 xiW orld                   i0 =1      k0 =1 xi0 W orld



     15 We   thank Stephen Redding for suggesting that approach.
                                       NEW RICARDIAN PREDICTIONS                                             35


            Table 4: Ranking of Industries in the Chain of Comparative Advantage of the United States

 Industry                                           Other Exporting Country

                     AUT   BEL   DEU   DNK   ESP   FIN   FRA GBR GRC IRL      ITA   NLD PRT SWE Mean Balassa
 Aircraft              .     1     1     .     1    1      1  .    .   .        1     1  .    1   1     1
 Office                1     2     2     1     2    3      2  .    1  14        2     7  .    2   2     3
 Medical               4     4     6     7     3    7      3  .    4  10        5     5  .    6   3     4
 Telecom               3     6     4     3     4   15      6  .    2  11        4     4  .   16   4     2
 Shipbuilding          2     3     3     8     8   14      5  .    .   .        3     6  .    4   5    18
 Transport            11     5     9     2     5    2     10  .    .   2       12     3  .    5   6     8
 Wood                 10     7     7    12     7   17      4  1    5   3        8     2  7   17   7     9
 Other                 6    13     8    10    12    5      7  3   10   6       17     9  1    7   8    12
 Machinery             8     9    12    13     6   12      9  2    7   5       14     8  2   10   9     6
 Automobile           12    15    19     4    17    9     16  .    3   1       11    14  .   14  10     7
 Electrical            7    10    13    11    10   16     14  .    8   8        9    10  .   12  11     5
 Paper                14     8    10     5     9   19      8  5    9  15        7    11  3   18  12    10
 Food                  5    12     5    18    13    4     11  4   13 13         6    19  4    3  13    16
 Chemicals             9    18    11    17    11    6     15  .    6  16       10    17  .   15  14    15
 Plastic              13    14    14    14    14   10     13  6   12  9        13    13  5   11  15    13
 Metal products       16    11    17    16    15   13     12  .   11  7        15    15  .   13  16    11
 Minerals             15    16    15     6    19   11     19  7   14  4        18    12  6    9  17    17
 Textile              18    17    16    15    18    8     17  8   15 12        19    16  8    8  18    19
 Basic metals         17    19    18     9    16   18     18  .    .   .       16    18  .   19  19    14




where xkiW orld are the total exports of country i in industry k. The ranking of industries
in terms of their Balassa’s (1965) revealed comparative advantage for i = U nited States is
reported in the last column of Table 4.
     There are, however, two important di¤erences between Balassa’s (1965) approach and ours.
First, our empirical strategy is theoretically grounded. The ranking of the OLS estimates
       k      k
of     US     i   is the empirical counterpart to the ranking of ln aki                  ln akU S in our model.
Second, our approach fundamentally is about pairwise comparisons. Our …xed e¤ects aim
to uncover which of Portugal and England is the country relatively better at producing wine
than cloth. They do not try to …nd out whether Portugal is good at producing wine compared
to an intuitive but ad-hoc benchmark. Unlike Balassa (1965), we do not aggregate exports
across countries and industries, which— according to our model— allows us to separate the
impact of technological di¤erences from transport costs and demand di¤erences.
36                                       COSTINOT AND KOMUNJER

                                    Appendix E: Selection Bias
     The objective of this Appendix is to relate the latent right hand side variable, ln aki , to
                             aki , when selection is the only source of measurement error. By
its observed counterpart, ln b
Assumption A1, we know that

(46)                               ln aki = ln E aki (!)            ln E [exp(u)]

                  aki is such that
We assume that ln b

(47)                                       aki = ln E aki (!) ! 2
                                        ln b                                     k
                                                                                 i

           k
where      i     ! 9j = 1; :::; N , ckij (!) = min1        i0 I   cki0 j (!)          is the set of varieties of good k
                                               k
produced by country i. We denote               i   the measurement error associated with selection

                               k
(48)                           i   = ln E aki (!) ! 2           k
                                                                i         ln E aki (!)

We make use of the following lemma.

Lemma 7. Suppose that for any three countries, i1 , i2 , and i3 , we have di1 i3                            di1 i2 di2 i3 .
Then, for all countries i and goods k,

                                    k
(49)                                i   = ! ckii (!) = min1           i0 I   cki0 i (!)

Proof of Lemma 7. We proceed by contradiction. Fix an exporter i, and suppose there exists
a variety ! 0 of good k and a country j0 6= i such that:
                              (
                                 ckij0 (! 0 ) = min1 i0 I cki0 j0 (! 0 )
                                         ckii (! 0 ) 6= min1   i0 I   cki0 i (! 0 )

Then, there must be an exporter i0 6= i such that
                            (
                               dij0 aki (! 0 ) di0 j0 aki0 (! 0 )
                                         dii aki (! 0 ) > di0 i aki0 (! 0 )

Since dii = 1, the two previous inequalities imply

                                                di0 j0 > di0 i dij0

which contradicts di1 i3      di1 i2 di2 i3 for any three countries, i1 , i2 , and i3 .
                                            NEW RICARDIAN PREDICTIONS                                                                         37

  In the reminder of this Appendix, we assume that iceberg transport costs satisfy the
previous triangle inequality. Hence we can use Lemma 7 to compute the extent of selection
bias under the assumptions of Theorems 1 and 2. Let us denote mki the import penetration
ratio in country i and industry k
                                                                    P        k
                                                                     i0 6=i xi0 i
(50)                                                 mki            PI       k
                                                                     i0 =1 xi0 i

Our …rst result can be stated as follows.

Theorem 8. Under assumptions of Theorem 1, the measurement error equals
                                                     k          1
                                                     i   =          ln(1        mki )

where the constant          is the parameter of the Gumbel distribution.

Proof of Theorem 8. Without loss of generality, we focus on the case i = 1. By de…nition,
we know that ck11 (!) = ak1 (!) w1 dk11 . Using Lemma 7 then yields

(51) ln E ak1 (!) j! 2           k
                                 1    = ln E ck11 (!)1I ck11 (!) = min1                         i0 I   cki0 1 (!)          ln(dk11 w1 ) ln   k
                                                                                                                                             11

                        k
where we have let       11           Pr ck11 (!) = min1             i0 I   cki0 1 (!) . Now, consider

                    G1 (ck11 ; :::; ckI1 )      E ck11 (!)1I ck11 (!) = min1                           i0 I   cki0 1 (!)

The expressions for G1 (ck11 ; :::; ckI1 ) and             k
                                                           11   are readily available from the proof of Theorem
1 when the result in Equation (20) is evaluated at                                = 0 and                = 1, respectively. Hence,

                                     e               +1               1         X
                                                                                I
                       ak1 =
                    ln b                 + ln                              ln         (cki1 )           ln(dk11 w1 ):
                                                                                i=1

In addition, from assumption A1 and ck11 = ak11 dk11 w1 we know that

(52)                         ln E ak1 (!) = ln ck11                  ln(dk11 w1 ) + ln E[exp u]

so that
                                                                                                                            !
                    k        e                  +1                                       1              (ck11 )
(53)                1   =        + ln                        ln E[exp u] +                     ln      PI       k
                                                                                                        i=1 (ci1 )

Now, from Equation (21), we know that for every i,
                                                             (ck )
                                                xki1 = ek1 PI i1 k                         :
                                                            i0 =1 (ci0 1 )
38                                       COSTINOT AND KOMUNJER

Using Equation (50), we then get
                                                             P       k
                                                              i6=1 (ci1 )
(54)                                               mk1   =   PI      k
                                                              i=1 (ci1 )

In addition, under the Gumbel assumption, we have that
                                                                    e         +1
(55)                                   E[exp u] = exp

so combining Equations (53), (54), and (55) yields

                                                    k        1
                                                    1    =       ln(1    mk1 );




     We now derive a similar result in the general case.

Theorem 9. Under assumptions of Theorem 2, the measurement error equals:

                                               k
                                               1   '     +        ln 1      mk1 ;

with     being the constant from Theorem 2, and                         and       2 R.

Proof of Theorem 9. Without loss of generality, we again focus on the case i = 1. As in the
proof of Theorem 8, we have

(56) ln E ak1 (!) j! 2    k
                          1    = ln E ck11 (!)1I ck11 (!) = min1                    i0 I   cki0 1 (!)   ln(dk11 w1 ) ln   k
                                                                                                                          11

          k
where     11   Pr ck11 (!) = min1       i0 I   cki0 1 (!) , as before. As previously, we let G1 (ck11 ; :::; ckI1 )
E ck11 (!)1I ck11 (!) = min1    i0 I   cki0 1 (!) . Now, consider a …rst order Taylor development of
ln G1 (ck11 ; :::; ckI1 ) around ln ck11 = ::: = ln ckI1 = 0. The latter is readily available from the
proof of Theorem 2: we only need to set                      = 0 in Equations (22)-(24). By letting
                                         Z+1
                                            [exp u]f (u) [1               F (u)]I    1
                                                                                         du
                                          1

and                                     2 +1                                                    3
                                          Z
                                       14
                                            [exp u]f 2 (u) [1                 F (u)]I      2
                                                                                               du5
                                               1
                                                    NEW RICARDIAN PREDICTIONS                                                                                  39

we get
                                                                                                       X
                                                                                                       I
(57)            ln G1 (ck11 ; :::; ckI1 )      = ln             ( I      1)      ln ck11    +                  ln cki1 + o           ln ck1      ;
                                                                                                       i=1

where k k2 is the L2 -norm as previously. We can follow the same approach for ln                                                                       k
                                                                                                                                                       11 .    By
setting        = 1 in Equations (22)-(24), we get
                                                                                           X
                                                                                           I
                                 k
(58)                       ln    11   =        ln I             I     ln ck11   +                 ln cki1 + o            ln ck1      ;
                                                                                           i=1

where                                                   2 +1                                                   3
                                                          Z
                                                      I 4 f 2 (u) [1                      F (u)]I      2
                                                                                                           du5 :
                                                                1

Combining Equations (56) with (57)                                   (58), we then obtain
(59)
                                                                                                                               X
                                                                                                                               I
ln E    aki   (!) j! 2      k
                            i    = ln( I)+[(                     )I +1]     ln ck11        ln(dk11     w1 )+(              )         ln cki1 +o       ln ck1    :
                                                                                                                               i=1

Now, combining Assumption A1 with ck11 = ak11 dk11 w1 gives

(60)                                 ln E ak1 (!) = ln ck11                     ln(dk11 w1 ) + ln E[exp u]
                                                                                                                                                 k
Combining Equations (59)                        (60) yields the following expression for the bias                                                1   de…ned in
(48):
                                                                                          X
                                                                                          I
                                                                                                       cki1
                       k
(61)                   1   = ln( I)             ln E[exp u] + (                       )           ln                +o         ln ck1        :
                                                                                          i=1
                                                                                                       ck11

Now, …x any constant , and note that in the neighborhood of ln ck11 = ::: = ln ckI1 = 0 we
have:                                                 !
                             X
                             I
                                        cki1                                1X
                                                                                 I
                                                                                           cki1
                      ln                                  = ln I +                                            1+o           ln ck1       ;
                                i=1
                                        ck11                                I i=1          ck11
and, in addition, for any i,
                                             cki1                                cki1
                                                          =1             ln                  +o            ln ck1    :
                                             ck11                                ck11
Hence,                                                    "                                            !#
                       X
                       I
                                      cki1            I                         X
                                                                                I
                                                                                           cki1
                                ln              =             ln I     ln                                      +o          ln ck1        :
                       i=1
                                      ck11                                      i=1
                                                                                           ck11
40                                             COSTINOT AND KOMUNJER

From the proof of Theorem 2 and its Equation (25) recall that
                                                        "               #
                                X
                                I
                                        cki1           XI
                                                          xki1
(62)                                                 =                      1+o            ln ck1
                                i=1
                                        ck11              xk
                                                       i=1 11


where we let       be as de…ned in the proof of Theorem 2. From Equations (50), (61), and (62)
we then get

              k                                                    I
              1   = ln( I)      ln E[exp u] + (                )        ln I + ln 1            mk1    +o      ln ck1       ;


where mk1 is the import penetration ratio in country i and industry k de…ned in Equation
(50) above. Let then             (         )I, so
                   0 +1                                                                                                1
                     R          2                            I 2              R
                                                                              +1
                                                                                       2                   I 2
                   B [exp u]f (u) [1                  F (u)]           du            f (u) [1        F (u)]    du C
                   B 1                                                           1                                C
               = I B +1                                                                                           C
                   @ R                                                           R
                                                                                 +1                               A
                        [exp u]f (u) [1              F (u)]I       1
                                                                       du             f (u) [1             I 1
                                                                                                     F (u)] du
                        1                                                        1


                        1
and        ln( I) +         (         )I ln I       ln E[exp u], i.e.


                                          = ln( I) +           ln I         ln E[exp u]


Then,

                                                k
                                                1   '    +         ln 1      mk1 ;

as desired.



     Note that under the assumptions of Theorem 1, the parameter                                       equals          and we have
the following equalities:

                                                        = 1 and             =0

so the results of Theorem 9 reduce to those of Theorem 8.
                                         NEW RICARDIAN PREDICTIONS                                                41

                       Appendix F: Multiple Factors of Production

  In order to introduce multiple factors of production into the Eaton and Kortum’s (2002)
model, we follow Costinot’s (2005) chapter 3.16 Suppose that there are f = 1; :::; F factors
of production, which are perfectly mobile across industries and immobile across countries.
Further, assume that the production technology is Cobb-Douglas in all sectors and countries
so that the constant unit cost of variety ! of good k in country i equals


                                                                  YF             k
(63)                                          cki (!) = aki (!)            wiff ;
                                                                    f =1


                                                                            k
where wif is factor f ’s reward in country i; and 0 <                       f    < 1 is the intensity of factor f in
the production of good k. Compared to Section 2, aki (!) now is the inverse of total factor
productivity in the production of variety ! of good j in country i. Combining Assumption
A1 and Equation (63), we get

                                                         XF
                              ln cki (!) = ln aki +                 k
                                                                    f   ln wif + uki (!) :
                                                             f =1


Following the same reasoning as in Section 3, we may now generalize Theorems 1 and 2:

Theorem 10. Suppose that the assumptions of Theorem 1 or 2 hold. Then, for any importer
j, any exporter i 6= j, and any product k,

                                                                    X
                                                                    F
(64)                       ln xkij   '   ij   +    k
                                                   j     ln aki              k
                                                                             f   ln(wif =wi1 ):
                                                                    f =1


where    > 0.

 The interpretation of the two …xed e¤ects is the same as in Section 3. The additional term
 PF    k
  f =1 f ln wif captures the impact of cross-country di¤erences in relative factor prices—

and therefore, cross-country di¤erences in factor endowments— on the pattern of trade.

  16 Independently,   Chor (2006) also incorporates multiple factors of production— together with institutional
di¤erences— into the Eaton and Kortum’s (2002) model.
