                             NBER WORKING PAPER SERIES




            STRUCTURAL BREAKS IN AN ENDOGENOUS GROWTH MODEL

                                       Timothy Cogley
                                       Boyan Jovanovic

                                     Working Paper 28026
                             http://www.nber.org/papers/w28026


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                   October 2020




We thank the NSF and the C.V. Starr Center for support, F. Bianchi, R. Lucas, S. Ludvigson, V.
Midrigan, P. Rousseau, L. Veldkamp and G. Violante for comments, and Gaston Navarro, Sai
Ma, and Angelo Orane for assistance. The views expressed herein are those of the authors and do
not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Timothy Cogley and Boyan Jovanovic. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Structural Breaks in an Endogenous Growth Model
Timothy Cogley and Boyan Jovanovic
NBER Working Paper No. 28026
October 2020
JEL No. E1

                                          ABSTRACT

We study the effects of parameter uncertainty prompted by structural breaks. In our model, agents
respond differently to uncertainty prompted by regime shifts in shock processes than they react to
comparable perceived increases in shock volatility. The magnitude of the response to an increase
in uncertainty about TFP associated with a structural break is greater than that of a response to a
comparable perceived rise in volatility. This is because lifetime utility varies more when shocks
shift beliefs and perceived wealth.


Timothy Cogley
Department of Economics
New York University
19 West Fourth Street, Sixth Floor
New York, NY 10012
and NBER
tim.cogley@nyu.edu

Boyan Jovanovic
New York University
Department of Economics
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
Boyan.Jovanovic@nyu.edu
1         Introduction
         Are learning episodes similar to times when shock volatilities rise? We study this
question in a general-equilibrium model for an economy that is subject to recurrent
structural breaks, breaks that create parameter uncertainty. Our model is based on
an Ak growth model with two aggregate shocks, a neutral TFP shock in the ...nal-
goods sector and an investment-speci...c technology shock that a¤ects production of
capital goods. We deal only with aggregate shocks and abstract from idiosyncratic
risk.
    Structural breaks are introduced as occasional shifts in the parameters governing
technology shocks. A break alters medium- and long-run forecasts of the level of
technology and initiates a period of higher parameter uncertainty. We examine how
this uncertainty a¤ects savings, investment, and growth. Under uncertainty, beliefs
over the distributions of future shocks are an aggregate state that responds to current
shock realizations. Shocks thus have wealth e¤ects through the beliefs channel ­ a
channel that is absent in models where the change in the shock distributions is known,
and one that creates both a quantitative and a qualitative di¤erence between the two
classes of models.
        To motivate interest in structural breaks, ...gure 1 plots empirical counterparts of
the shock processes1 along with NBER recession dates, shown as vertically shaded
areas. Ten-year rolling standard deviations are depicted in the bottom row.
   TFP is shown in the upper left panel. As highlighted by Gordon (2016, pp.
545-548), productivity surges in the 1940s and never returns to its pre-war level.
Although TFP also varies procylically, the mid-century surge is the dominant source
of volatility and presumably also of uncertainty. For instance, the rolling 10-year
standard deviation is about 5 times higher around the years of the rise than at
`normal'times.2
    1
     In our model, T F P equals the ratio of real output to real capital. Appendix A describes our
data sources for y=k .
   Data for aggregate q come from Wright (2004). His "equity q" measure covers the period 1900-
2002, and we extend this through 2018 by ratio splicing the Federal Reserve Board'       s measure of
equity q (Financial Accounts of the United States - Z.1, table B.103, line 45).
   2
     The same pattern holds if multifactor TFP is used instead of the output-capital ratio: Fig. 16-5
of Gordon (2016) shows that the growth of TFP over the 1940-50 decade was about twice as high
as it was over the adjacent decades, and about four times as high as it was over the other decades
since 1900.
   Data in Piketty (2014) suggest that structural breaks in Y =K also occurred in Britain and France,
although perhaps at di¤erent times (compare Piketty'    s tables 3.1 and 3.2 for Britain and France


                                                 2
                          z = y/k                                                    q
                                                         2
 0.6

                                                        1.5
 0.4
                                                         1

 0.2
                                                        0.5


  0                                                      0
  1900     1920    1940     1960     1980    2000             1920      1940     1960      1980     2000


            Rolling standard deviation of ln z                       Rolling standard deviation of ln q
0.25
                                                        0.5
 0.2
                                                        0.4
0.15

                                                        0.3
 0.1

0.05                                                    0.2

  0                                                     0.1
  1900     1920    1940     1960     1980    2000             1920      1940     1960      1980     2000




Figure 1: TFP, z, and investment cost, q, over a century. Levels are
depicted in the top row, and 10 year rolling standard deviations are
shown in the bottom. Shaded areas mark the dates of nber recessions.

       The case for a structural break in the investment-speci...c technology shock ­shown
in the upper right panel ­is less obvious, but an argument could be made that the
run-up in the 1990s and early 2000s represented a shift in its mean. For instance, the
peak and trough after 1995 are two and three times higher, respectively, than those
of the previous 90 years, and the trough in 2002 is almost as high as the peaks in
the 1920s and 1960s. The volatility associated with this shift is comparable to that
experienced in earlier years, neither dominating nor being dominated by ordinary
cyclical variation.3
       Our goal is to understand how shifts such as these a¤ect savings, investment, and
growth in general equilibrium. Our analysis is based on three assumptions. The ...rst
is that if a structural break has occurred in the past, others are possible in the future.
Furthermore, agents are aware of this possibility and account for it when formulating
their plans. Structural shifts are not complete surprises and as Sims (1982) argued
with his table 4.6 for the US).
   3
     We acknowledge that this is not the only respectable interpretation of the data. Alas, because
statistical tests for structural breaks have low power, a decisive characterization is unlikely.



                                                    3
in a related context, regime shifts can be viewed as outcomes of a rule that agents
understand. This contrasts with anticipated-utility models in which agents update
beliefs after a structural break but fail to account for the possibility of future breaks
when formulating plans (e.g., Kreps 1998 or Evans and Honkapohja 2001).
   Second, history never repeats itself exactly. Regime realizations do not necessarily
cycle between a small number of possible states, as in the literature on Markov-
switching models. Entirely new regimes can and do emerge. The timing of the shift
follows a Poisson process and conditional on a structural break new parameter values
are drawn from a distribution conditioned on the previous parameter realizations; the
exact nature of regimes is ...rst-order Markov process on the space of shock-distribution
parameters.
   Third, because each realization is distinct, a structural break initiates a period
of uncertainty. The new regime is not suddenly revealed after a break. On the
contrary, agents must learn the new parameters governing the shocks. It follows that
a structural break also raises uncertainty. A structural break combines a persistent
change in the level of technology with a transitory increase in uncertainty. Both
a¤ect behavior and macroeconomic outcomes. Using our model, we can quantify and
disentangle them.
   The model has no heterogeneity among agents, and our study is therefore limited
to the e¤ects of macro uncertainty and macro risk. The model also has no ...nancial
sector and would be inappropriate for analyzing the great recession, and our sam-
ple ends in 2006. On the other hand, the model is solved in closed form, without
any linearization. Moreover the Ak structure allows a direct mapping between the
observables and the shocks, and the endogeneity of growth ampli...es the transitional
dynamics will be di¤erent ­precautionary savings will, for instance, have a stronger
e¤ect on future output.
   For plausible calibrations, we ...nd that uncertainty episodes entail lower consump-
tion and higher growth compared the economy that is identical except that agents
know the parameters of the distributions governing the shocks. Uncertainty prompts
precautionary savings that insures agents against an unfavorable change. Consump-
tion falls and the higher savings then raise growth above its no-uncertainty level. Each
type of learning, be it about TFP or about investment e¢ ciency, has an expansionary
e¤ect on growth, although the e¤ect is smaller in the second case. Uncertainty about
TFP leads to more saving because in our closed economy low-TFP realizations lead


                                           4
to consumption disasters whereas high-investment-cost realizations do not because
agents can reduce investment accordingly.4
       To isolate the e¤ects of a rise in uncertainty, however, we then ask whether these
e¤ects arise because agents live through episodes during which they are learning the
parameters of shock distributions, or whether they would occur even if agents simply
faced higher shock variances. The e¤ect on growth of a mean-preserving increase
in variance (MPS) that agents immediately understand can go in either direction.
An MPS activates two forces: higher investment as a consequence of precautionary
savings versus lower investment because of the option to wait (e.g., Dixit and Pindyck
1994). Shock persistence matters, however, because waiting is more attractive when
shocks are weakly persistent. Since Bayesian learning makes one of the state variables
a martingale (Doob 1948), a strongly persistent state is present in all our learning
models. The presence of a persistent state variable weakens incentives to wait and
brings the precautionary-savings motive to the fore.5
       The next step is to compare the magnitude of responses associated with subjective
and objective uncertainty. Toward that end, we equate the sequences of one-step-
ahead marginal distributions of shocks in the two cases. Under learning, subjective
uncertainty falls over time, and the no-learning economy is put on the same footing by
assuming a corresponding decline in the conditional variance of shocks. For plausibly
calibrated models, consumption and growth respond more strongly under learning:
after ten years, output is permanently higher by two percent. In contrast, a mean-
preserving increase in variance matching the pro...le of subjective uncertainty has very
little e¤ect on savings or growth.
   Models featuring TFP and investment-e¢ ciency shocks but without learning in-
clude Greenwood, Hercowitz, and Krusell (2000), Fisher (2006), Justiniano, Primiceri
and Tambalotti (2010) and Jovanovic and Rousseau (2014). Gilchrist and Williams
(2005) ...nd that a rise in dispersion of shocks over vintages of capital is expansionary
because labor reallocates to the more productive vintages, but their MPS is cross-
sectional. Bloom (2014) summarizes results on time-varying risk when shifts in the
   4
     Even a bad TFP realization would not cause a consumption disaster in an open economy because
agents can then borrow abroad. Baxter and Jermann (1997) note, however, that investors do not
diversify internationally to any signi...cant extent.
   5
     Collin-Dufresne, et al. (2016) also emphasize the importance of this martingale state. They
study implications for asset pricing in economies in which consumption growth is exogenous, whereas
we study production economies in which uncertainty in      uences consumption and investment.



                                                5
distributions of shocks are known.
   Endogenous growth models have studied how growth responds to volatility in
aggregate TFP shocks (Jones, Manuelli, Siu and Stacchetti 2005) and to policy shocks
(Hopenhayn and Muniagurria 1996). We ...nd that the qualitative e¤ects of shocks to
the e¢ ciency of investment are similar to those of investment taxes or subsidies.
   Among related models with learning, Hu¤man and Kiefer (1994) and Koulovan-
tianos, Mirman and Santugini (2009) studied learning the TFP process in the produc-
tion of ...nal goods, but not that of capital goods. Bernanke (1983) and Stokey (2015)
study partial equilibrium models with delayed information arrival about investment
pro...tability. As in our model, learning occurs exogenously, as a result of the passage
of time alone. It does not depend on actions that agents take ­on how much to in-
vest, for instance. This is in contrast to Chamley and Gale (1994), Veldkamp (2005),
and Pastor and Veronesi (2009) whose models imply, as ours does, that the e¤ects of
learning di¤er from a rise in shock volatility.
   Parameter learning also implies momentum e¤ects on stock prices ­serially cor-
related price changes caused by learning. As Lewellen and Schanken (2002) have
shown, parameter uncertainty drives a wedge between the distribution perceived by
investors and the distribution estimated by empirical tests. Following a regime shift,
an econometrician should expect to ...nd predictability of returns. As agents learn the
parameters stock prices in general start to reect this. For instance, if a regime shift
lowered the distribution of TFP, returns would initially be low, re  ecting the fall in
dividends and would then gradually rise as stock prices fall to reect the lower mean
of the dividend process.
    In our model momentum e¤ects arise for the risk-free rate, but not for stock
prices. If investment is positive, Tobin'
                                        s Q (the market value of capital relative to its
replacement cost) is unity. Only when investment hits zero can Q fall below unity.
As Sargent (1980, p. 111) puts it, roughly speaking, Q drops farther below unity as
the constraint that investment be irreversible becomes more binding.
   In that case parameter uncertainty also leads to a temporary rise in the volatility
of the stock market, and some regime changes may raise the possibility of disasters
as in Veronesi (2004), Gourio (2008) and Wachter (2013). Regime shifts also raise
uncertainty and if we had ambiguity-averse agents regime shifts would depress stock
prices and raise returns that would gradually decline as learning takes place, as in
Epstein and Schneider (2008).


                                           6
       The paper that is closest to ours is Bianchi and Melosi (2016). They study a
family of DSGE models with Markov switching and Bayesian learning about latent
states. Importantly, unlike anticipated-utility models of learning (Kreps 1998, Evans
and Honkapohja 2001), their agents take regime shifts and learning fully into account
when forming plans. For a real-business-cycle model in which TFP growth switches
between high or low values, Bianchi and Melosi demonstrate that the anticipated-
utility assumption is not innocuous because past mistakes about TFP growth are
built into the capital stock and thus have persistent e¤ects on output, consumption,
and investment.6 We extend their analysis by breaking free of the assumption that
there are ...nite number of potential states. In our model, there is a continuum of
possible future states, and entirely new regimes can emerge. Because there are no
best or worst possible states and period utility is unbounded, the potential inuence
                             7
of uncertainty is magni...ed.
       Last but not least, what we call "parameter uncertainty" di¤ers from Knightian
uncertainty because agents can still form predictive distributions over variables ­
they are Bayesians. Knight's de...nition would more appropriately apply to boundedly
rational agents. For example, Pintus and Suda (2018) feature adaptive learning and
...nd, as we do for Bayes learning, that the responses of output, investment, and other
aggregates under adaptive learning are signi...cantly larger than when the agents know
the parameters governing the shocks.8 One could also analyze the e¤ects of shifts
when agents have ambiguous beliefs (Hansen and Sargent 2001; Bianchi, Ilut, and
Schneider 2018).
       The paper is organized as follows. Section 2 describes an Ak growth model with
these features and characterizes decision rules and the equilibrium law of motion.
Section 3 presents a number of simple examples to build intuition. Section 4 solves
and simulates calibrated versions in order to assess the strength of various forces,
especially those governing uncertainty and precautionary behavior.
   6
     Bianchi and Melosi (2018) use similar methods to examine the role of policy uncertainty in a
new Keynesian model with recurrent shifts in the monetary-policy rule.
   7
     For endowment economies, Geweke (2001) and Cogley (2009) examine the consequences for
expected utility and the market price of risk, respectively.
   8
     However, their adaptive-learning framework shuts down precautionary e¤ects associated with
uncertainty.




                                               7
2          Model and Planner'
                            s Solution
Technology.-- The model has two sectors: a ...nal goods sector and a capital-goods
sector. The production function for the ...nal good is

                                                    Y = zk;                                       (1)

where Y is the output of ...nal goods, k the capital-good input, and z a shock to the
...nal goods technology. Capital depreciates at the rate ; the law of motion for capital
is
                                                                1
                                           k 0 = (1         )k + X;                               (2)
                                                                q
and the aggregate resource constraint is

                                                  Zk = C + X;                                     (3)

where X is ...nal goods devoted to the production of capital, and q is the shock to the
capital-goods technology.
         Preferences.-- A representative agent has recursive preferences as in Epstein and
Zin (1989) and Weil (1989),
                                                                                          1
                                                                            1         1
                           Ut = (1         )Ct1     +        Et [Ut1
                                                                   +1   ]   1
                                                                                              ;   (4)

where is the subjective discount factor, is the coe¢ cient of relative risk aversion,
and is the inverse of the elasticity of intertemporal substitution.9 Expectations are
taken with respect to subjective beliefs.
         Aggregate resource constraint.-- The Ak production structure in Eqs. (1) and (3)
along with the homothetic preferences in Eq. (4) allows us to drop k from the set of
states and scale variables by k as follows

                         c = C=k;       x = X=k ,       y = Y =k      and g = k 0 =k;             (5)

and write the law of motion for k in (2) as
                                                             1
                                              g=1           + x;                                  (6)
                                                             q
and the aggregate resource constraint in (3) as

                                                   z = c + x:                                     (7)
     9
         This simpli...es to time-separable isoelastic preferences when         = :

                                                        8
       Law of motion of the shocks.-- Let S = (q; z ) follow a Markov process with dis-
tribution     (S 0 j S; ) where          represents the parameters of the transition law. Some
components of         will be unknown. We will be interested in comparing the behavior
of an economy in which agents learn about                             over time to an economy in which              is
known.
       Updating of beliefs when there is no regime shift.-- A "regime" is denoted by .
Let      ( ) denote beliefs over : Each period the agents observe St and update                                  using
                                                       0
Bayes law. After observing the value S ,

                      0                        (S 0 j S; ) ( )
                      no shift   ( )= R                                       b ( j S 0 ; S; ) ;                   (8)
                                               (S 0 j S; ) d ( )
       Regime shifts.-- We assume that each period a regime shift occurs with probabil-
ity : We expect          to be close to zero given the above discussion of the probable
infrequency of regime shifts. The simplest treatment is to posit a transition law for
                                                                                                            0
regimes upon a shift. So we assume that the distribution of the new regime                                      condi-
tional on being in regime and conditional on there being a regime shift is                                      ( 0j )
with      2     and    a measure on             : In some examples we shall assume that                           is a
...nite set so that     follows a discrete-state Markov process as in Hamilton (1989),
Bianchi and Melosi (2016), and Foerster et al. (2016).
   Timing of a regime shift.-- When a shift occurs, it does so at the start of the
production period so that agents update by observing S and that                                    = 1:10
       Updating of beliefs after a regime shift.-- We shall assume that agents know the
law ( ) and whether a regime shift has just occurred, but that they know neither
(over which they hold beliefs ) nor 0 :In that case11
                                   Z
                               0
                       0
                       shift ( ) =    ( 0 j ) b ( j S 0 ; S; ) d :             (9)

I.e., S 0 is generated by the pre-regime-shift                        via the likelihood .
       General updating.-- Letting          = 1 denote a regime shift and                       = 0 denote no shift
                          0                                0                     0
                              ( ) = (1     I    =1 )       no shift   ( )+I   =1 shift   ( ):                     (10)
  10
      In Sec. 3.2 we compare to the case where the regime shift dates are not observed.
  11
      The assumption that break dates are known is for tractability. Some of our examples are simple
enough to handle unobserved regime shifts (e.g. the ...nite-state Markov model in section 3.2.2), but
others are not. For instance, in the models of section 4, time since the last break is a state variable.
If break dates were unobserved, the distribution over time since the last break would be a state
variable, and the resulting curse of dimensionality would make the calculations intractable. We are
still thinking about ways to address this issue.

                                                             9
       Plan for the analysis.-- Because the model features no monopoly power and has no
externalities, the (recursive) competitive equilibrium will coincide with the planner'
                                                                                     s
solution. Of course the planner too has to learn                            by observing st in the same way
as private agents do. We shall therefore solve the planner'    s problem ...rst, and then
discuss the markets for goods, for capital and for assets that decentralize the optimum.

2.1       Planner'
                 s solution
Let denote the planner'    s belief and S the current shock. Denote the augmented
                    12
state by s (S; ). The next period'      s state is s0 = (S 0 ; 0 ). The distribution of S 0
   R
is    (S 0 j S; )d ( ) and it is the same whether a regime occurs or not. The only
                                                           0
thing that a¤ected by a regime shift is                        . Therefore,
                                                F (S 0 ;          0
                                                                  shift j s)      if     0
                                                                                             =1
                         F (s0 j s;   0
                                          )=                                                                                      (11)
                                                F (S 0 ;         0
                                                                 no shift j s)    if    0
                                                                                             = 0:
so the planner'
              s predictive distribution is

                  F (s0 j s) = F (S 0 ;        0
                                               shift   j s) + (1           ) F (S 0 ;    0
                                                                                         no shift    j s);                        (12)

and it underlies the expectations operator in the next two equations and in Appendix
B. The planner'
              s state vector is (s; k ). He chooses C and X to maximize his value
function V
                              h                                                                      1       i11
            V (st ; kt ) = max (1          )Ct1        +           Et [V (st+1 ; kt+1 )      1
                                                                                                 ]   1
                                                                                                                     ;
                          Ct ;Xt

subject to (7), (2), (10) and (12):
       Because production has constant returns and preferences are homogeneous of de-
gree 1       , we can eliminate scale, k , from V and deal in terms of s alone. More
precisely, suppose there exists a function w(s) that satis...es the recursion
                         "                                                                                               #   1
                     1
                                                       h                           1
                                                                                                    i11      1               (1    )

w(s) =                       E (z 0 + q 0 (1       )) (1             )(1 + q 01        w(s0 ))                      js                 :
             1
                                                                                                                                  (13)

Proposition 1                  The value function takes the form

                                                  V (s; k ) = v (s)k;                                                             (14)
  12
    Since is i.i.d. and since beliefs update right after                   is observed, including                as a part of the
state means that drops out of the state vector.

                                                           10
      where                                          h                                                  i11
                                                                                          1
                        v (s) = (z + q (1          )) (1              )(1 + q 1               w(s))           :         (15)

      Consumption c takes the form
                                                       z + q (1                )
                                             c=               1   1                :                                    (16)
                                                    1+q               w(s)

      Growth g takes the form
                                                             1
                                                        zq       w(s)              (1         )
                                     g=1           +                           1                  :                     (17)
                                                             1 + q1                w(s)
    The proof is in Appendix B. The relative simplicity of the value in (15) and the
policy rules in (16) and (17) stems from the model'
                                                  s Ak structure. The proposition
helps because the right-hand side of (13) contains no max operator; only the level of
w and not its derivatives enter the solutions in (15), (16) and (17), and this will help
characterize them.


3     A special case
   This section specializes the model so as to focus on two speci...c questions. We
assume that
                                                              P
   (i) = so that utility is the time additive CRRA form E 1      0
                                                                      t 1 1
                                                                       1
                                                                          ct , and
    (ii) S is i.i.d. conditional on , i.e.,             (S 0 j S; ) is independent of S .
   We shall analyze parameter learning about the distribution of z separately from
that of parameter learning about the distribution of q . I.e., we shall analyze them
one at a time. When learning about the distribution of z we shall assume that
                                                          Az
                                          z = az +                    xz
                                                                           ;                                            (18)
                                                         1+e
                        2                                                          2
where xz      N ( z;    z ).    The parameters az ; Az and                         z   will be known, and         z   will be
unknown. And when learning about the distribution of q we shall assume that
                                                          Aq
                                          q = aq +                    xq
                                                                           ;                                            (19)
                                                         1+e
                        2                           2
where xq      N    q;   q      , where aq ; Aq ;    q    are known, and                           q   is unknown: We shall
henceforth drop the z and q subscripts from x and from the parameters (a; A; ). We
now ask two questions:

                                                        11
  1. How does a learning-about- episode compare to an episode in which is known
        but in which the variance of the shocks x temporarily rises? Sec. 3.1 will
        show that uncertainty induced by structural breaks has substantially larger
        and qualitatively di¤erent e¤ects than uncertainty triggered by volatility of the
        exogenous shocks. This is because uncertainty about the parameters of the data
        generating processes has larger e¤ects on agents'lifetime utility.

  2. Second, how does the case were the occurrences of regime shifts, , are observed
     di¤er from the case when they are not observed? Sec. 3.2 will show that the
        value of being informed about regime shifts is about twice as large for the case
        of z as it is for the case of q:

3.1       Parameter learning vs. higher shock volatility
   Suppose that a structural break has just occurred, and that agents know this.
They also know that thereafter there will be no more breaks, so that                      = 0. Following
the structural break the prior variance over                 rises implying a temporary rise in the
variance of the predictive distribution over s.
    To put the two cases on a comparable footing, we equate the one-step ahead
marginal distributions of the shocks at each t. We wish to compare mean preserving
spreads in the distributions of shocks to learning, while keeping the means the same
for the two cases. We shall make the comparison for a single learning episode that is
not interrupted by a new regime shift ( = 0):
      The learning economy.-- Agents (or the social planner) know the exact values of
the parameters f L ,      M ; H g, but they do not know the regime in place, they have to

learn that.    Let ht = (xs )t  1
                             s=0 denote the history of realizations of x;
                                                                          13
                                                                             and let L (ht j i )
denote the     likelihood of ht . Assuming that the prior over f L , M ; H g is 1/3,1/3,1/3,
Bayes rule yields the posterior probability that                    =       i   as

                                                    L (ht j i )
                                  i   ht = P                     t
                                                                                      ;
                                               j 2fL, M, H g L (h j              j)

 13
      Agents see zt or qt and can recover xt by inverting (18) or (19) to get

                                                      zt      a
                                        xt = ln                         :
                                                  A        zt + a




                                                  12
and the posterior mean and variance as
                                    X
                            ht =                              j       j;    and                                            (20)
                                    X                                                2
                          2
                            ( ) =                                 j         ht           j:


       Suppose that the draw following the regime shift is                               =    M,    although this will only
gradually become apparent to agents as they learn. We condition the distribution of
the history on        =       M;   so that xt =     M   + "t . The total variance of x is

                                                  2           2            2
                                                  x;t   =      ;t     +    ";                                              (21)

           2
where       ;t   is the expected variance conditional on                        M;

                                   Z                  p                                             !
                                                                                           2
                        2                2              t                        (u     M)
                         ;t   =            ( [t; u]) p exp                                              du:                (22)
                                                     " 2                           2 2
                                                                                     "t
                                                                                         1


    The no-learning economy.-- In this economy agents know that =                                               M , and    they
face a time-varying variance of " given by the RHS of Eq. (21), 2
                                                                ";t =
                                                                                                                2
                                                                                                                x;t : We   shall
use the symbol Ft to denote the resulting sequence of time-varying distributions. We
treat z learning and q learning one at a time. The treatment of the two is parallel,
and we illustrate the treatment of the varying risk value function for the case where
z is ...xed and only q varies and only q is subject to a possible regime shift. Since the
shock variances now depend on t, so does the value:

                                          C1            R                                                   1
                  Vt (q; k ) = max                +         Vt+1 (q 0 ; k 0 )dFt (q 0 )           = vt (q )kt
                                   C;X    1

where, using the aggregate resource constraint (7) and law of motion for capital (2),
               (                                                         )
                                               1
                 (z x)1                    1      R
vt (q ) = max               +    1       + x        vt+1 (q 0 )dFt (q 0 ) ;              (23)
            x      1                       q
               8                                                                            9
               >                             1                                        ! >
               < (z x)1          1        1
                                        + qx     R                       (q 0       2       =
                                                                                  M)
        = max               +            p         vt+1 (q 0 ) exp                     dq 0
                                                                                              :
            x >
               : 1                    ";t 2                                   2 2
                                                                                ";t         >
                                                                                            ;

For the known- case, ct and gt are computed directly from equations (13), (16), and
(17).14
  14
    The Proof Proposition 1 does not impose the constraint that g                             1         () x    0 (see Eq. (6))
but the inequality always holds in our simulations.

                                                            13
   Parameters are calibrated so that the time series means of (c; g ) in the learning
economy match c = C=K = 0:3 and g = 1:02 per annum. Results are shown in table
3.1. The same parameters are used for the known case at                          =   M.


                       Table 3.1: Parameters used for ...gure 2
                          q          z          A        a       L                              M       H
 Vary z   4     0:95 0:05 1          random 0:113 0:167         0:780                           0:428 0:213
 Vary q   4     0:95 0:05 random 0:340        0:932 1:355       0:523                           0:124 0:521


   The top row of ...gure 2 compares the two economies when the injected uncertainty
is over the distribution of z . After 10 years, cumulative growth is 18.49% in the
learning economy and 16.61% in the MPS case. Since the two economies have the
same C=K ratios after a decade and K is 1.88 percent higher in the learning economy,
it follows that consumption is permanently higher by 1.88 percent.

                     Consumption, Fix q, vary z                    Growth, Fix q, vary z
                                                        1.028
          0.305          Learning
                         MPS                            1.026
                                                        1.024
               0.3                                      1.022
                                                            1.02
                                                        1.018
          0.295
                                                        1.016
                     0              5             10         0               5             10
                          Simulation Time                            Simulation Time
                     Consumption, Fix z, vary q                    Growth, Fix z, vary q
              0.35                                      1.022

                                                        1.021

               0.3                                          1.02

                                                        1.019

              0.25                                      1.018
                     0              5             10         0               5             10
                           Simulation Time                           Simulation Time


Figure 2: Comparison of learning (RED) and MPS (BLUE) when the
shock distribution is unknown. top row, z . bottom row, q:

    The bottom row does the same thing for learning about the distribution of q .
In this case, the results go in the opposite direction. Cumulative 10-year growth is

                                                       14
22.22% for the MPS and 21.45% for the learning economy. The di¤erence amounts
to a permanent consumption dividend of 0.77 percent per annum for agents in the
MPS economy.
    Precautionary saving and investment versus the option to wait.-- The marginal
distributions of the shocks are equated so that 2";t =
                                                        2
                                                        x;t , but since beliefs are a
Martingale in the learning economy, there is a permanent component to shocks that
is absent in the MPS economy. Thus in the top two panels a shock to z has a longer
expected duration in the learning case, and to prepare for this agents save more than
in the MPS case. In the bottom two panels it is the shock to q that now has a longer
expected duration in the learning case, and in Sec. 4 we will ...nd that under learning,
precautionary savings dominates the option to wait, but by much less for learning
about q than it does for learning about z .15 In line with that ...nding, learning now
generates more consumption and less growth than does MPS.

3.2        Observed vs. unobserved                        t   when breaks recur
      We now assume breaks are recurrent ( > 0), and that there are only two regimes
  2 f L ; H g. Agents again know the parameters f L ,                   H g,   but they do not know the
regime in place.
       With just two possible values of , beliefs can be summarized by the real num-
ber       = Pr ( =        H)   or, equivalently, by the expectation E ( ) =              H   + (1   )    L.

Moreover, we assume L = 1 and H = 1; so that
  As in the previous subsection, we shall study regime shifts as shifts in the distri-
bution of one of the shocks alone, keeping the value of the other shock ...xed. In light
of (18) and (19) for z , the favorable state is               H   whereas for q , the favorable state is
 L.


3.2.1       Observed break dates

When a break occurs, each regime is equally likely; in other words,                      ( 0j )=    1
                                                                                                    2
                                                                                                        for
                0
all      and        : Following a regime shift, E ( ) = 0, and then E ( ) drifts towards the
realized       2 f 1; 1g unless the next regime shift occurs in which case E ( ) reverts
to zero.
    Fig. 3 portrays expected consumption and growth for various values of . On
  15
       Compare the top-left panel of ...gures 7 and 10.



                                                   15
the horizontal axis is E ( ). At higher                                             the belief       matters less because the regime
is more likely to soon change. As                                              rises, regime persistence falls and the curves
portrayed in the left-hand panels become atter. A higher                                                             lowers consumption and
raises growth in `
                 good'regimes and does the opposite in `
                                                       bad" regimes. For z , the
`good' state is H and consumption and savings (and growth) both rise as beliefs
shift towards the regime                      H.      For q the good state is                        L   and so the curves slope down,
but the consumption curve again attens out as                                                    rises.

                                   Expected Consumption                                              Expected Growth
                        0.16                                                              1.03
                                   =0
                                    = 0.1
                        0.15
                                    = 0.2                                                1.025
              z model




                        0.14
                                                                                          1.02
                        0.13


                        0.12                                                             1.015

                                   -0.5           0             0.5                              -0.5            0             0.5




                        0.22                                                             1.035

                                                                                          1.03
                     0.215
           q model




                                                                                         1.025

                                                                                          1.02
                        0.21
                                                                                         1.015

                     0.205                                                                1.01
                                   -0.5           0             0.5                              -0.5            0             0.5
                                          µ *  + (1- µ)*                                                 µ *  + (1- µ)* 
                                              H             L                                                H             L




                                                                                                                                         z
Figure 3: ; c and g when is observable. Top Row: only                                                                                        varies;
Bottom Row: only q does.


3.2.2   Unobserved break dates

   We now assume the Markov transition probabilities,
                                                                0                                                    0
                                                                z                                                    q
                                                  L                        H                             L                       H
                                                      z               z                                      q             q
                                          L           LL              LH                         L           LL            LH
                               z                      z               z         ;         q                  q             q         ;
                                          H           HL              HH                         H           HL            HH




                                                                                    16
                0  0
where           z; q    are mutually independent.16 We also allow the structural break indi-
cator       t   to be observed or unobserved. If the                                  t    are not observed, situations may
arise in which agents think that a break occurred, while in fact it did not.17 For this
example, we are mainly interested in building intuition about the consequences of
assuming that agents know when a break has occurred.
       Observability of                  adds nothing if                  2 f0; 1g : When                      = 0 the regime never
changes and when                     = 1 it changes every period. In these extreme cases, however,
there are de facto no regime shifts since even if = 1, is absorbed into an i.i.d.
component of the residual. We therefore derive the consequences for 2 (0; 1).
       If   t   is observable, we have
                                                      X
                             0
                             shift   ( 0) =                          0
                                                                     no shift   ( )        ;   0        when           = 1;
                                                    2f   L; Hg

                                            =        no shift   ( 0)           when            = 0:

De...ning                (   H ),    it follows that
                  0
                      = (1           )b(   H   j S 0 ; ) + (b (           L    j S 0; )            LH   + b(   H   j S 0; )    HH )    (24)

Then w (s; ) is de...ned via (8), (9), (12) and (13).
       On the other hand, if                    t   is unobserved, beliefs are updated as follows. Agents
start the period with a prior                        over        =        H:   An observation S leads to the posterior
belief
                                                          L (S j H )
                         (   H   j S; ) =                                                                          b (S; ) :
                                                L (S j H ) + L (S j                       L ) (1           )
Then next-period belief is
                         0
                             =       (   HH b (S;     )+        LH   [1        b (S; )]) + (1                  ) b (S; )               (25)

The joint distribution of ( 0 ; s0 ) in Eq. (11) now changes as follows. In F (s0 ;                                                     0
                                                                                                                                            j
                                                                                                   0
s; ),           is no longer a state so that s = S . Then                                              = b (S; ) is not random once
we condition on (S; ) because we no longer have 0shift and                                                         0
                                                                                                                   no shift   induced by an
observation of 0 , and in Eq. (13) F (s0 ; 0 j s; ) is replaced by

                                                           L (S 0 j        H)      w. prob. 0
                              F (S 0 j S; ) =                                                                           :
                                                           L (S 0 j           L)   w. prob. 1                      0

  16
     In Appendix C we study the alternating-regime case (in which LL = HH = 0) analogous to
that of Hopenhayn and Muniagurria (1996).
  17
     Bianchi and Melosi (2016) study such a scenario, but with a di¤erent learning mechanism.

                                                                       17
          0
where         is given in (25). The decision rules remain as in Eqs. (16) and (17). The
unconditional long-run expectation of                is
                            ^( )=             L,H                        H,L
                            E                              H   +                     L:                    (26)
                                        L,H   +     H,L            L,H   +     H,L

      Beliefs remain non-degenerate.-- Unless                  is forever ...xed and that agents know
that it is ...xed, beliefs will remain non-degenerate. When                          is unobserved the agents
never learn which of the two values of is operative: Beliefs remain a non-degenerate
stochastic process even if (unbenownst to the agents) remained forever ...xed at
 H,   say. If agents'beliefs placed all weight on                  H,   say, at t         1, they would become
non-degenerate at t; because of the positive probability                        H, L   that    will have shifted
due to a possible regime shift. In other words, although they know the set f L ;                            H g,

agents will typically not know which regime is in place.
      For example, suppose parameters are ...xed as in table 3.2.2. These parameters are
based on the following accounting: The NBER data indicate 215 expansions, of which
204 (94.88%) are followed by an expansion, and 11 (5.1%) are followed by a recession.
On the other hand, there are 41 recessions, of which 11 (26.8%) are followed by an
expansion, and 30 (73.1%) are followed by another recession. We use the notation
 L,H   and     H,L   for both cases ­learning about z and learning about q since here they
are obtained by the same accounting method.

                           Table 3.2.2: Parameters chosen for ...gure 4
                                    L         H      L,H        H,L
                                    1     1         0:27       0:05     0:29
                             ^ ( ) = 0:68, which is indicated by the vertical lines in
      With these parameters, E
...gure 4. Not observing        means that the planner acts on the basis of less information
than in the observable- case. This appears to imply more uncertainty over the
future realizations of (z; q ) ; and we expected to see a rise in precautionary savings
in response. For most values of ; this occurs when learning about shifts in q (see
the bottom row) but not for shifts in z (shown in the top row). The learning-about-z
model has the surprising outcome that for most values of , agents consume more
when regime switches are not observed.

3.2.3     The value of being able to observe

As noted above, the ability to observe t is of no value if 2 f0; 1g ; because then
one would know that the regime never changes (when = 0) or that it changes every

                                                      18
                       Expected Consumption                      Expected Growth
                0.16
                          Unobservable shift                      Unobservable shift
                                                          1.03
                          Observable shift                        Observable shift
                0.15

                                                          1.02
                0.14


                0.13                                      1.01


                0.12                                         1
                         -0.5        0         0.5               -0.5        0         0.5
                            *   H
                                    + (1- )*    L
                                                                    *   H
                                                                            + (1- )*    L
                       Expected Consumption                      Expected Growth
                                                      1.035
              0.2115                                                        Unobservable shift
                                                          1.03              Observable shift
               0.211
                                                      1.025
              0.2105
                                                          1.02
                0.21
                          Unobservable shift          1.015
              0.2095
                          Observable shift
                                                          1.01
                         -0.5        0         0.5               -0.5        0         0.5
                            *   H
                                    + (1- )*    L
                                                                    *   H
                                                                            + (1- )*    L



                                                                                                 z
Figure 4: ; c and g when is unobservable. Top Row: only                                              varies;
Bottom Row: only q does.

period (when       = 1). Thus we expected the value of information to be highest for
values of   around 1/2.
     Figure 5 shows, however, that the value of information is seemingly maximized at
values of well below 1/2, and closer to a value of 1/3 or even 1/4, depending on the
value . This is probably because, with E ^ ( ) = 0:68, beliefs about drift upwards
and the value of knowing about regime changes becomes less valuable. The rate of
the decline in the value of information over time is increasing in .
  Figure 5 portrays the relative value of information v I (s; ) =v U (S; ) as varies.
The experiment ...xes = 0:5 and sets z = 0:34 and q = 1: With > 0, v I (s; ) and
v U (s; ) are both negative. Then v I (s; ) > v U (s; ) =) v I (s; ) =v U (S; ) < 1.
At    = 0 and 1, the ratio is equal to 1. For intermediate values of ; being informed
about regime shifts raises v (s; ). Provided that                2 (0; 1) ; the value of information
rises with the degree of risk aversion.




                                                     19
                 Value of Information, Learn z                   Value of Information, Learn q
                  1                                               1

                                                            0.99
               0.95
                                                            0.98
                0.9
                                                            0.97
               0.85
                                             =2             0.96                                   =2
                                             =4                                                    =4
                0.8                                         0.95
                   0              0.5                  1        0                            0.5        1
                                                                                              

              Figure 5: Value of information about regime shifts

4       A model with non-recurrent structural breaks
        and autoregressive shocks
      Next we turn to examples in which shocks are autoregressive processes,

                                 ln zt =          zt   +    z   ln zt       1   +        z "zt ;                  (27)
                                 ln qt =          qt   +    q   ln qt       1   +        q "qt :


To keep things simple, we activate one at a time. The ...rst example features neutral
technology shocks with a constant level of q , while the second ...xes z and activates
investment shocks. Letting at represent the active shock, the autoregressive parameter
 a   and conditional standard deviation                a   are assumed to be known, and the intercept
 at   is unknown. Agents must learn about                       at .
      The intercept is subject to occasional structural breaks,

                             at     =        at 1          w= pr 1                   ;                            (28)
                                                                       2
                                    = mt               N (m;           m)       w= pr :

A Bernoulli random variable             t    governs whether a structural break occurs. With
probability 1   , no break occurs ( t = 0), and the intercept remains unchanged.
With probability , a break occurs ( t = 1), and a new intercept is drawn from a
normal distribution. The random variables "at ;                             t ; mt       are mutually independent, and
the parameters        = [ ; m;    m;    a;   a]   are known.

                                                           20
   Agents observe                     t   and at , but not    at   or mt : Because              t   is observable, agents know
when a break occurs, but they don'
                                 t know whether                                         at   has increased or decreased or
by how much. They update beliefs about                                  at   by applying Bayes theorem.
   To ...t this example into our general framework, let s = [a; ] represent the observ-
able states, and write the Markov transition equation as (st+1 ; t+1 jst ; t ; ): The
predictive density is
                                              ZZ
                                  t                                                                        t
              F (st+1 js ; ) =                      (st+1 ;   t+1 jst ;      t;   )p(   t+1 ;       t js       ; )d   t+1 d t ;   (29)

                              t
where p(      t+1 ;    t js       ; ) is the posterior for the unobserved intercept. Proposition 1
goes through with this specialization of notation. All that remains is to derive the
                                      t
posterior p( t+1 ;            t js        ; ) and solve the integral equation 13. Appendix D addresses
these problems.

4.1     Neutral technology shocks
   Table 4.1 calibrates parameters for an economy in which the neutral technology
shock z is active and q is constant. The discount factor is set a priori to a standard
RBC value for annual data, and the coe¢ cient of relative risk aversion is set to 4.
Consumers are myopic if                         = 1; and a higher value is needed for learning to matter.
However, Pratt-style thought experiments suggest that                                           should not be much higher
than 1. A value of 4 seems like a reasonable compromise.

                        Table 4.1: Calibration for structural breaks in TFP
                                        z        z                m         m    z   q
        4
 1:01         4       12:95 0:119 0:8867 0:0422 0:0091           0:0893 0:0234 0:464 1


   Parameters governing ln z are estimated by combining the data shown in ...gure
1 with informative priors over ( z ; z ; ; m; m ): In a nutshell, the process for ln z
can be expressed as a non-Gaussian state-space model whose log likelihood function
can be evaluated via a particle ...lter. Because structural breaks are infrequent,
and     m   are weakly identi...ed in a frequentist sense. We therefore add an informative
prior and maximize the log posterior. Details can be found in appendix E. Table 4.1
reports the posterior mode for ( z ; z ; ; m; m ); and z is the implied unconditional
geometric mean. Since no model for ln q is on the table at this point, q is set to 1.


                                                                   21
       Even with structural breaks, ln z is a stationary random process, although it would
be hard to distinguish from an integrated process in samples of 100 or 200 years. That
breaks are rare means that agents face long-run risks analogous to those of Bansal
and Yaron (2004). The left hand column of ...gure 6 illustrates the long-run risk
by comparing unconditional distributions for processes with and without structural
breaks.18 When structural breaks are absent (solid lines), ln z is unconditionally
                                                                                        2           2
normal with mean m=(1                            z)    and variance                     z =(1       z ).     With rare structural breaks
( = 0:0091; dashed lines), the distribution is still centered on m=(1         z ), but the
tails are fatter. In fact, in the tails, the log density for the rare-break process is 10
times greater than that of the no-break process.

                      Stationary distribution for z                                             Stationary distribution for q
                                              Structural break                0.05
                                              Stochas tic volatility
       0.15                                   Bas eline REE                   0.04

                                                                              0.03
        0.1
                                                                              0.02
       0.05
                                                                              0.01

         0                                                                         0
               0.25                   0.5                        1                     0.25       0.5             1      2             4
                                z = y/k                                                                        q
              Log density ratio relative to Baseline REE                                  Log density ratio relative to Baseline REE
        15
                                            Structural Break                       3
                                            Stochas tic Volatility
        10
                                                                                   2

         5
                                                                                   1


         0                                                                         0
               0.25                   0.5                        1                     0.25       0.5             1      2             4
                                 z = y/k                                                                          q



                                   Figure 6: Unconditional shock distributions

       The remaining parameters ­                                      and     ­ are calibrated by matching aspects of
                                                         19
the deterministic steady state.                                  When all shocks are deactivated (                                z    =   = 0),
steady-state growth and the consumption-income ratio are
                                                                                                        1=
                                                                         1=        z
                                                      gd =                           +1                       ;                             (30)
                                                                                   q
                                               C                                                    q
                                                               = 1 + (1                         gd ) :
                                               Y        d                                           z
  18
    The ln q calibration and stochastic volatility model are discussed below.
  19
    Results are similar if and are calibrated to the mean of a stochastic sequilibrium in which
shocks to ln z are active but structural breaks are not ( z 6= 0; = 0):

                                                                              22
The parameters        and    are chosen to match gd = 1:02 and (C=Y )d = 0:7:20 The
solution for     = 0:119 is close to the standard RBC calibration for annual data. The
solution for     = 12:95 implies that the elasticity of intertemporal substitution (EIS)
is 0.077 which is broadly consistent with estimates based on micro data (e.g., Hall
1988, Vissing-Jorgensen 2002, Yogo 2004, and Havranak 2015). For instance, in a
meta-analysis of 169 publications, Havranak (2015, p.1196) reports a `
                                                                     best practice'
estimate of 1= = 0:33 with a con...dence interval of (-0.2,0.8). It follows that our
consumers have a strong preference for smooth consumption streams.
   The EIS is lower than typical calibrations in the ...nance literature; e.g., Bansal
and Yaron (2004) assume a value of 1= = 1:5. As they emphasize, a model with
EZW preferences requires both long-run risk and an EIS greater than 1 to resolve
asset pricing puzzles. Structural breaks generate long run risk, but our model could
not hit the macro targets gd = 1:02 and (C=Y )d = 0:7 if the EIS were greater than
1. Furthermore, attempts to calibrate to the risk-free rate plus one of the macro
targets were unsuccessful, with moment conditions either failing to solve altogether
or resulting in implausible values for other parameters. We chose the calibration in
table 4.1 so that the model generates plausible macro outcomes, but we acknowledge
that the model will not match asset prices with an EIS close to zero.
       As a point of departure, we deactivate structural breaks and parameter uncer-
tainty and compute the REE for a conventional AK model. The black lines in the
top row of ...gure 7 depicts policy functions for C=Y and g when z is constant and
known with certainty. As expected, the consumption-output ratio is decreasing in
ln z , and growth is increasing. The former reects consumption smoothing, because
a low current value of ln z signals higher future productivity. The latter just reects
that an increase in the investment share raises growth in an AK model.
       The other curves in the top row portray slices of the policy functions when struc-
tural breaks and learning are active. This model has three state variables, ln z; the
posterior mean tjt ; and the posterior precision Ptjt : In the top row, the posterior
mean tjt is held constant at the true z ; and precision Ptjt is indexed by time since
the last break, with uncertainty being highest in year 1 and diminishing with t.
  20
     The target for the consumption-income ratio is based on US data for the period 1950-2015.
Consumption is measured by real expenditures on nondurable goods and services, and investment
is real gross private domestic investment plus expenditures on consumer durables. Because the
model has no government or net exports, output is measured by C + I: If government spending were
included and split between consumption and investment, the mean C=Y ratio would be around 0.75.



                                              23
 0.74                                                                1.05         Year 1
 0.72                                                                             Year 5
                                                                        1         Year 100
  0.7                                                                             REE
 0.68
                                                                     0.95
   0.25               0.3     0.35      0.4          0.45    0.5        0.25                 0.3           0.35      0.4          0.45    0.5


                                                                      1.1
  0.8
  0.7                                                                1.05

  0.6                                                                   1
  0.5
            -0.14    -0.12   -0.1    -0.08       -0.06      -0.04               -0.14    -0.12            -0.1    -0.08       -0.06      -0.04



 0.69                                                               1.026

0.685                                                               1.024

 0.68                                                               1.022
0.675                                                                1.02
        0           0.005     0.01           0.015          0.02            0           0.005              0.01           0.015          0.02




                    Figure 7: Policy functions, z active and q inactive.

Uncertainty promotes precautionary saving and shifts the policy function for C=Y
downward. Because capital is the only aggregate store of wealth, the additional
savings are channeled into investment, and g increases. As parameter uncertainty di-
minishes, precautionary savings decline, and the policy functions shift toward those
for the benchmark no-break model.
  Since the model has complete markets, a safe asset is implicit. One might wonder
why agents don'
              t park their precautionary savings there to await more information.
The answer is that the safe asset is in zero net supply and hence is not a store of
aggregate wealth. The risk-free rate and return on capital adjust so that agents do
not park precautionary savings in the safe asset. In principle, inventories or other
durable commodities could serve as an aggregate store of precautionary wealth, but
they are not riskless.
   The second row illustrates how variation in point estimates                                     tjt   inuence C=Y
and g with ln z held constant at its unconditional mean. We limit attention to
plausible ranges by plotting tjt over intervals of 3 posterior standard deviations


                                                            24
around the true value. Variation in           tjt   matters a lot, especially shortly after a break
when point estimates can bounce all over the place. Conditional on no future break,
 tjt    is a martingale under the subjective probability law (Doob 1948), so a revision
of the point estimate shifts the agent'
                                      s long run forecast for productivity. Hence,
consumption responds more strongly than to a transitory innovation "zt : Although
the estimates eventually settle down as t increases, this channel continues to amplify
volatility for a long time.
   The magnitude of precautionary e¤ects can be seen more clearly in the third
row. Here, C=Y and g are depicted as functions of the posterior standard deviation
       1=2
Ptjt         with the posterior mean   tjt   and technology shock ln z held constant at their
unconditional means. The peak e¤ect occurs in the year of a break (shown at the far
right of each panel). The consumption-income ratio is about 1 percentage point lower
than in the benchmark no-break model, and growth is about 40 basis points higher.
As uncertainty is resolved (moving from right to left), the investment share falls and
growth slows. It takes about 5 years to move halfway across the graph and 20 years to
move two-thirds of the way. Beyond that point, the policy functions become   atter,
and the e¤ects of parameter uncertainty diminish. Most of the precautionary e¤ects
occur in the ...rst two decades. The e¤ects of variation in                 tjt   persist beyond that
point, however.
   Further insight can be obtained by simulating the model. Figure 8 compares out-
comes for economics with identical sequences of (scaled) TFP shocks. The simulations
are initialized by setting ln z0 at its unconditional mean, drawing 10,000 sample paths
for ln zt , and then calculating outcomes for c; g by plugging the simulated shocks into
the policy functions. Blue lines in the top row portray the median and interquartile
range at each date for the structural-break model, while black lines depict those for
the baseline REE. The second row depicts di¤erences across sample paths on which
standardized realizations of "zt are held constant.
   In addition to conventional innovations in TFP ("zt ), the learning economy is also
subjected to a `pure uncertainty' shock at date zero. To create a pure uncertainty
shock, we posit a structural break in which the newly drawn value of                      z   happens to
coincide with the old value and the prior mean; i.e.,             t   = 1; mt =     t 1   = m: In other
words, a pure uncertainty shock is fake news: agents believe a structural break has
occurred when in fact it has not.



                                                     25
                                                                         1.035

             0.7
                                                                          1.03
            0.69
                                                                         1.025
            0.68
                                                                          1.02
            0.67                            Baseline REE
                                            Stochastic volatility
            0.66                                                         1.015
                                            Structural break

            0.65                                                          1.01
                   0   10   20         30           40              50           0           10    20    30    40      50



            0.02                                                         0.015

            0.01                                                          0.01

               0                                                         0.005

            -0.01                                                            0

            -0.02                Structural break minus REE              -0.005
                                 Stochastic volatility minus REE
            -0.03                                                         -0.01
                 0     10   20         30           40              50         0             10    20    30    40      50




Figure 8: Fan charts, z active and q inactive. In the first row, blue
lines portray the median and interquatile range for a pure uncer-
tainty shock, while black and red lines depict those for the baseline
ree and a ree with stochastic volatility, respectively. The second
row depicts differences between the learning and stochastic volatil-
ity models relative to the benchmark ree model, with solid lines
showing the mean and dashed lines the interquartile range.

       A structural break activates two belief states,                               tjt ;   and Ptjt : A fake news shock
creates uncertainty about             z;    raising the posterior variance Ptjt1 and increasing the
sensitivity of the conditional mean                      tjt   to incoming data. Their combined e¤ect is to
depress the average consumption share, raise average growth, and amplify consump-
tion volatility.
       The precautionary e¤ects can be seen most clearly in the second row. Solid lines
portray cross-sectional average di¤erences between the structural-break model and
the no-break economy. Because no actual break has occurred, averaging across sample
paths removes the e¤ects of tjt and isolates the in  uence of Ptjt :21 Furthermore,
because the posterior variance is a deterministic function of time since the last break,
it is the same on all sample paths. The cross-sectional average therefore illustrates
  21
    I.e., tjt averages to   zt   across sample paths. Since there are no actual breaks,                         zt   remains
constant at m:



                                                                    26
how higher uncertainty about               z   inuences C=Y and g with the mean of                 tjt   held
constant at the true        z:   The peak di¤erences occur in the ...rst 5 years, when the mean
consumption share is 0.8 to 1.1 percentage points lower and mean growth is 25 to 45
basis points higher. By the end of the second decade, the e¤ects of z uncertainty are
weaker, but the risk of a future break remains. Consequently, the mean consumption
share remains about 25 basis points lower than in the baseline REE, and mean growth
is about 5 basis points higher. These small growth e¤ects continue to add up, and
after 50 years the mean capital stock is 4.75 percent higher than in the REE.22
    The structural-break model also features greater consumption volatility, due largely
to variation in the conditional mean              tjt .   Because   tjt   evolves as a martingale (con-
ditional on no future break), it has a strong inuence on permanent income. Hence
variability in tjt strongly ampli...es consumption volatility. For a model like ours,
Jones, et al. (2005) report that consumption would be too smooth under REE for an
EIS as low as ours. This is also true in our model (the black fan chart in the upper
left panel is so narrow that it looks like a single line). When                   tjt   is active, however,
the model exhibits plenty of consumption volatility despite the low EIS (see the blue
fan chart in the upper left panel). Indeed, on many sample paths, the pure precau-
tionary e¤ect is swamped by movements in permanent income. In other words, while
average C=Y is lower in the learning model, there are many sample paths on which it
is higher than in the REE (compare the means and interquartile ranges in the second
row). Of course, variation in tjt is itself a consequence of the higher uncertainty
because      tjt   would be less sensitive to incoming data if Ptjt1 did not rise.
       Since a pure uncertainty shock is somewhat contrived in this environment, we also
look at the combined e¤ects a structural break along with the associated increase
in uncertainty. Figure 9 illustrates the di¤erences between a fake news shock and
breaks of magnitude          1    m:   As in the second row of ...gure 8, the solid lines represent
mean di¤erences across sample paths, with realizations of "zt held constant, while the
dashed lines represent the interquartile range.
   After a signal that t+1 = 1, the posterior variance rises by the same amount
for both shocks, and the precautionary e¤ects net roughly to zero when di¤erencing
  22
    A higher EIS would amplify the response of precautionary savings because consumers would be
more willing to trade lower present consumption for higher future consumption. For instance, for
1= = 0:33 (Havranak'   s point estimate), the mean consumption share would be 140 basis points
lower than in the REE at impact, mean growth would be 55 basis points higher, and the capital
stock would be 8 percent higher after 50 years.



                                                      27
                                                                                                10 -3
            0.05                                                                      10


            0.04

                                                                                       5
            0.03


            0.02
                                   Mean difference relative to fake news               0
                                   Interquartile range
            0.01


              0                                                                        -5
                   0   10     20           30             40               50               0                10          20          30          40    50



                                                                                                10 -3
              0                                                                        5

           -0.01

           -0.02                                                                       0

           -0.03

           -0.04                                                                       -5

           -0.05

           -0.06                                                                      -10
                   0   10     20           30             40               50               0                10          20          30          40    50




                       Figure 9: Fake news about                                zt   versus actual breaks

across sample paths. What remains are the e¤ects of                                                         tjt :   When         z    rises (top row),
agents attribute the increase in productivity partly to an increase in                                                                    z   and partly to
a positive innovation in "z : The former raises the consumption share, while the latter
depresses it. Relative to a fake news shock, more of the increase in ln zt is attributed
to   z:   As a consequence, the net impact e¤ect on the mean C=Y ratio is positive.
As agents gradually verify that                      z    is actually higher, both C=Y and g rise. After 50
years, the mean consumption share is 4 percentage points higher than for a fake news
shock, average growth is about 90 basis points higher, and the mean capital stock is
about 30 percent higher. The e¤ects of a downward shift in                                                               z    are similar but have
the opposite sign (bottom row).
   Last but not least, we contrast uncertainty about z with uncertainty about future
innovations "zt : We do this by introducing stochastic volatility in a model in which z
is constant and known with certainty. In the structural-break model, the prediction
error variance for ln zt is

                            var(ln zt+1 j ln z t ;                   t+1        = 1) =                  2
                                                                                                        z   +       2
                                                                                                                    m;                                (31)
                            var(ln zt+1 j ln z t ;                   t+1        = 0) =                  2
                                                                                                        z   + Ptjt1 ;



                                                                           28
where t indexes time since the last volatility break. To put a stochastic volatility
model on the same footing, we assume that the conditional variance for "zt jumps to
 2    2                                                                      2       1
 z+   m   with probability   and then declines with probability 1       to   z + Ptjt :   The
red lines in ...gure 8 portray outcomes for the stochastic volatility model.
   Adding stochastic volatility to the REE model matters slightly, but does not
change the big picture. This is especially clear in the second row, where red lines
depicts di¤erences across sample paths relative to the REE economy. When shown on
the same scale as sample-path di¤erences for the structural-break economy, those for
the stochastic-volatility model are too small to see. The reason why structural breaks
are more important is that they generate more persistent variation in the conditional
mean. As a consequence, they have a greater impact on permanent income.
    Furthermore, stochastic volatility creates less long-run risk. As shown in ...gure 6,
structural breaks fatten the tails of the unconditional distribution of lnz more. In-
deed, the long-run risk depicted there depends mainly on variation in the conditional
mean. Matching the conditional variance of "zt to the prediction-error variance of
the structural-break process fattens the tails on the unconditional distribution only
slightly.
   To summarize, structural breaks have big e¤ects in this model, as do movements
in the conditional mean      tjt :   Movements in the conditional variance Ptjt1 matter,
but their e¤ects are smaller in magnitude. Smaller still are the e¤ects of stochastic
volatility in "zt :

4.2    Investment-speci...c technology shocks
Results for a model in which q is active and z is inactive are qualitatively similar.
An uncertainty shock promotes savings and growth, and the responses are larger in
magnitude than those associated with a comparable increase in conditional variances.
   Parameters for this model are shown in table 4.2. The subjective discount factor
 ; coe¢ cient of relative risk aversion ; and steady-state value of z are the same as
in the previous section. The parameters governing ln qt are estimated by maximizing
the log posterior for the data shown in ...gure 1, with priors as described in appendix
E.3. Given these parameters, the inverse-EIS        and depreciation rate    are chosen so
that the deterministic steady states for C=Y and g are 0.7 and 2 percent per annum,
respectively. Once again, the implied EIS is close to zero.



                                              29
                                                                                                                                                       Year 1
              0.8                                                                               1.1                                                    Year 5
              0.7                                                                              1.05                                                    Year 100
              0.6                                                                                                                                      REE
                                                                                                  1
              0.5                                                                              0.95
                 -1         -0.5             0                0.5                1                 -1         -0.5            0                0.5                1


              0.8
              0.7                                                                               1.1
              0.6                                                                              1.05
                                                                                                  1
              0.5
                                                                                               0.95
                -0.15    -0.1      -0.05         0          0.05          0.1                      -0.15   -0.1      -0.05        0          0.05          0.1


             0.69                                                                             1.032
            0.685                                                                              1.03
                                                                                              1.028
             0.68
                                                                                              1.026
            0.675
                    0    0.01        0.02            0.03          0.04         0.05                  0    0.01        0.02           0.03          0.04         0.05




                    Figure 10: Policy functions, q active and z inactive.

                                                             Table 4.2: Calibration
                                                                   q                 q                             m       m    z     q
        4
 1:01          4        13:8045 0:129 0:81 0:198 0:0111                                                           0:013 0:048 0:464 0:934


   The black lines in the top row of ...gure 10 portray policy functions for a version
that abstracts from breaks and learning. As q increases, the capital-goods technol-
ogy becomes less e¢ cient, and each unit of investment is transformed into fewer
units of new capital. To compensate, agents feed more investment goods into the
capital-goods sector. Thus, the consumption share decreases with q . The rise in the
investment share only partly o¤sets the decline in the e¢ ciency of the capital-goods
technology, however, implying that the capital stock also grows more slowly as q
increases.
    The colored lines in the top row illustrate the e¤ects of uncertainty. In this panel,
the posterior mean                  tjt     is held constant at the true                                    q;    and precision Ptjt is indexed
by time since the last break, with uncertainty being highest immediately after a
structural break. The qualitative e¤ects are the same as for a neutral TFP shock:
uncertainty promotes precautionary saving, increases the investment share, and shifts
the policy function for g upward. As uncertainty is resolved, precautionary savings
decline, and the policy functions shift toward those for the no-break benchmark.


                                                                                         30
   The middle row illustrates how variation in             tjt   inuences C=Y and g with ln q
held constant at its unconditional mean. Attention is limited to plausible values by
plotting   tjt   over intervals of   2 posterior standard deviations around the true value.
Variation in tjt matters a lot, especially shortly after a break when point estimates
are most sensitive to realizations of ln qt . Recall once more that tjt is a martingale
conditional on no break, so the agents'
                                      s (conditional) long run forecast for ln qt reacts
strongly to this state variable. Hence, consumption and growth also respond strongly.
This e¤ect is nonlinear, being largest for high values of tjt :
   The third row isolates the in uence of Ptjt : Here C=Y and g are plotted as functions
                                              1=2
of the posterior standard deviation Ptjt            with ln q and     tjt   held constant at their
                                                    1=2
respective unconditional means. Because         Ptjt      declines deterministically with time
since the last break, time runs from right to left in this row. The points closest to the
origin illustrate the e¤ects of background uncertainty associated with conventional
shocks to lnq and potential future breaks. Since C=Y = 0:7 and g = 1:02 in the
deterministic steady state, background uncertainty reduces the consumption share
and raises growth by roughly 120 and 60 basis points, respectively. The points on the
on the far right depict the impact e¤ects of an uncertainty shock. In the year of a
structural break, the consumption share falls by another 90 basis points and growth
increases by a further 45 basis points. As uncertainty is resolved, the investment
share declines back toward its stochastic steady state, and growth declines.
   The next ...gure compares outcomes for economies with and without structural
breaks. There are two of the latter, one in which the conditional variance of "qt is
constant and another in which it is calibrated to match the prediction-error variance
of the structural-break model (cf. the discussion surrounding equation 31). To create
a pure uncertainty shock, we again imagine that agents believe a structural break
has occurred when in fact it has not. As before, the three simulations used the same
scaled "qt shocks, so shocks are held constant on all sample paths.
    In the top row, blue lines portray the median and interquartile range for the
structural-break model, while black and red lines depict those for the benchmark
REE and stochastic-volatility models. The fact that the black and red lines lie on top
of one another implies that stochastic volatility matters very little when              q   constant
and known with certainty. In contrast, in response to a pure uncertainty shock, the
median consumption share falls by about 100 basis points and then rises gradually
as uncertainty is resolved. The median growth rate rises by about 45 basis points at


                                               31
                                                                        1.05

          0.7                                                           1.04

                                                                        1.03

         0.65                                                           1.02
                                           Baseline REE
                                           Stochastic volatility        1.01
                                           Structural break
          0.6                                                             1
                0   10   20          30            40              50          0           10   20   30   40   50


                                                                                   10 -3
         0.01                                                            10


           0
                                                                          5

        -0.01

                                                                          0
        -0.02
                              Structural break minus REE
                              Stochastic volatility minus REE
        -0.03                                                             -5
                0   10   20          30            40              50          0           10   20   30   40   50




Figure 11: Fan charts, Q active and Z inactive. In the first row, blue
lines portray the median and interquatile range for a pure uncer-
tainty shock, while black and red lines depict those for the baseline
ree and a ree with stochastic volatility, respectively. The second
row depicts differences between the learning stochastic volatilty
models relative to the benchmark ree model, with solid lines show-
ing the mean and dashed lines the interquartile range.

impact, and declines slowly.
   The second row highlights di¤erences between the economies. Solid lines por-
tray cross-sectional average di¤erences relative to the REE and stochastic-volatility
economies, while dashed lines depict the interquartile range. As before, the cross
sectional average illustrates how higher uncertainty inuences C=Y and g with the
mean of tjt held constant at the true q : For the structural-break model, the biggest
di¤erences occur in the ...rst 5 years, when the mean consumption share is about 100
basis points percentage points lower and mean growth is 30 to 50 basis points higher.
By the end of the second decade, the e¤ects uncertainty are weaker, but the risk of a
future break remains. Consequently, the mean consumption share remains about 80
basis points lower than in the REE, and mean growth is about 25 basis points higher.
Although this might not seem like much, the cumulative e¤ect over 50 years is an 11
percent increase in the level of the capital stock.


                                                                   32
     As before, when breaks are absent, outcomes for a stochastic-volatility economy
are essentially the same as for the benchmark REE model with constant conditional
variances. Di¤erences across sample paths are too small to see when graphed on the
same scale as the structural-break economy. Structural breaks matter more because
they activate persistent variation in the conditional mean of ln q:
     Finally, ...gure 12 illustrates the di¤erences between structural breaks of magnitude
 1   m   and a fake news shock. Solid lines again represent mean di¤erences across
sample paths, with realizations of "qt held constant, while the dashed lines represent
the interquartile range.


             0                                                                         0
                                   Mean difference relative to fake news
                                   Interquartile range
          -0.02
                                                                                 -0.005

          -0.04

                                                                                  -0.01
          -0.06


          -0.08                                                                  -0.015
                  0           10   20          30           40             50              0   10   20     30   40   50



          0.06                                                                    0.015



          0.04                                                                     0.01



          0.02                                                                    0.005



             0                                                                         0
                  0           10   20          30           40             50              0   10   20     30   40   50




                         Figure 12: Structural breaks in                           q   versus. fake news

     Since the e¤ects of positive and negative structural breaks are approximately
symmetric, it su¢ ces to discuss the e¤ects of a structural break that increases                                          q
(top row). Recall that the posterior variance rises by the same amount for actual
breaks and fake news, implying that the precautionary e¤ects net roughly to zero
when di¤erencing across sample paths. Thus, the di¤erences primarily re  ect the
inuence of            tjt :   After both shocks, agents attribute the decrease in capital-goods
productivity partly to an increase in                                qt     and partly to a positive innovation in "qt ;
but more to qt when there is an actual break. After an actual break, as agents
gradually verify that qt is higher, the decline in C=Y is magni...ed. After 50 years,

                                                                           33
the mean consumption share for an actual break is 6 percentage points lower than
for a fake-news shock. The e¤ects on g are similar, but with some over-shooting in
the medium run.


5     Conclusion
This paper analyzed learning by agents of two aggregate-shock distributions. The
economy is competitive and has no external e¤ects. We solved the planner'
                                                                        s problem
and then explained how decentralization would e¤ect the same outcome.
    We contrasted the learning economy to the standard no-learning economy with two
shocks. Under no learning, a mean-preserving increase in the variance of TFP shocks
increases long-run growth by raising precautionary savings. By contrast, a mean-
preserving increase in the variance of investment shocks lowers growth because it
raises the option value of waiting to invest, thereby reducing savings. Such a contrast
does not arise in the learning economy: For the case of TFP shocks, the qualitative
e¤ects of learning work in the same direction as a permanent rise in variance. For
shocks to the e¢ ciency of investment, the qualitative e¤ects can go in the opposite
direction. in the learning economy growth rises whereas in the shock-variance-spreads
economy the growth rate falls.
   Endogeneity of growth reverses the implications for the risk-free rate: As in stan-
dard models, a rise in uncertainty raises precautionary savings, but because growth
is endogenous, the rise in the growth rate is accompanied by a rise in the real interest
rate, in contrast to what happens in an endowment economy.
   When we compare the learning economy to one in which shock variances increase
and equate the marginal distributions of the shocks at each date, the qualitative
e¤ects in the two cases do go the same way for TFP shocks, but quantitatively the
e¤ects are larger in the case of learning because expected lifetime utility varies more
as beliefs respond to the shocks.


References
 [1] Bansal, R. and A. Yaron, 2004. Risks for the Long Run: A Potential Reso-
     lution of Asset Pricing Puzzles. Journal of Finance 59, 1481-1509.




                                          34
 [2] Baxter, M., & Jermann, U. J. (1997). The International Diversi...cation
    Puzzle Is Worse Than You Think. The American Economic Review, 170-180.

 [3] Bernanke, B., 1983. Irreversibility, uncertainty, and cyclical investment. QJE
     98, 85-106.

 [4] Bianchi, F., C. Ilut, and M. Schneider. Uncertainty Shocks, Asset Supply
     and Pricing over the Business Cycle, Review of Economic Studies, 2018, 85(2),
    810-854.

 [5] Bianchi, F., and L. Melosi (2016). Modeling the Evolution of Expectations
     and Uncertainty in General Equilibrium. International Economic Review 57(2),
    717-756.

 [6] Bianchi, F., and L. Melosi (2018). Constrained Discretion and Central Bank
    Transparency. Review of Economics and Statistics 100(1), 187-202.

 [7] Bloom. N. Fluctuations in Uncertainty. J. Econ. Perspectives 2014

 [8] Chamley, C., & Gale, D. (1994). "Information revelation and strategic delay
    in a model of investment." Econometrica, 1065-1085.

 [9] Cogley, T. 2009. Is the Market Price of Risk In...nite? Economic Letters 102(1),
    13-16.

[10] Collin-Dufresne, P., M. Johannes, and L. Lochstoer. 2016. Parameter
    Learning in General Equilibrium: The Asset Pricing Implications. American
    Economic Review 106(3), 664-698.

[11] Dixit, A.K. and R.S Pindyck. 1994, Investment Under Uncertainty. Prince-
    ton University Press.

[12] Doob, J.L. Application of the Theory of Martingales. Colloques Internationaux
    du Centre National de la Recherché Scienti...que 36, 1948.

[13] Epstein, L., & Schneider, M. (2008). Ambiguity, Information Quality, and
    Asset Pricing. Journal of Finance, 63(1), 197-228.




                                         35
[14] Epstein, L.G. and S.E. Zin. (1989). Substitution, Risk Aversion, and the
    Temporal Behavior of Consumption and Asset Returns: A Theoretical Frame-
    work. Econometrica 57(4), 937-969.

[15] Evans, G.W. and S. Honkapohja. Learning and Expectations in Macroeco-
    nomics, Princeton University Press: Princeton, 2001.

[16] Fisher, J. D. (2006). The dynamic e¤ects of neutral and investment-speci...c
    technology shocks. Journal of Political Economy, 114(3), 413-451.

[17] Foerster, A., J. Rubio-Ramirez, D.F. Waggoner, and T. Zha. (2016)
     Perturbation Methods for Markov-Switching DSGE Models. Quantitative Eco-
    nomics 7, 637-669.

[18] Geweke, J. 2001. A Note on Some Limitations of CRRA utility, Economics
    Letters 71(3): 341-345.

[19] Gilchrist, S. and J. Williams. Investment, Capacity and Uncertainty: A
     Putty-Clay Approach, Review of Economic Dynamics, 2005.

[20] Gordon N.J., Salmond D.J. and Smith A.F.M. (1993). Novel approach
     to nonlinear/non-Gaussian Bayesian state estimation. IEE Proceedings F 140,
    107-113.

[21] Gordon, R.J. The Measurement of Durable Goods Prices. University of Chicago
     Press: Chicago, IL, 1990.

[22] Gordon, R.J. The Rise and Fall of American Growth. Princeton University
    Press, 2016.

[23] Gourio, F. (2008). Time-series predictability in the disaster model. Finance
    Research Letters, 5(4), 191-203.

[24] Greenwood, J., Hercowitz, Z., & Krusell, P. (2000). The role of
    investment-speci...c technological change in the business cycle. European Eco-
    nomic Review, 44(1), 91-115.

[25] Hall, R.E. (1988). Intertemporal Substitution in Consumption. Journal of Po-
    litical Economy 96(2), 339-57


                                         36
[26] Hamilton, J. D. "A new approach to the economic analysis of nonstationary
    time series and the business cycle." Econometrica (1989): 357-384.

[27] Hansen, L., & Sargent, T. J. (2001). Robust control and model uncertainty.
     American Economic Review, 91(2), 60-66.

[28] Havránek, T. (2015). Measuring Intertemporal Substitution: The Importantce
     of Method Choices and Selective Reporting. Journal of the European Economic
    Association 13(6), 1180-1204.

[29] Hopenhayn, H., M.E. Muniagurria. (1996). Policy variability and economic
     growth. Review of Economic Studies, 63 (4), 611-626.

[30] Huffman and N. Kiefer. "Optimal Learning in a One-Sector Model."August
    1994.

[31] Jones, L. E., R. Manuelli, H. Siu, and E. Stacchetti. "Fluctuations in
    convex models of endogenous growth, I: Growth e¤ects." Review of Economic
    Dynamics 8, no. 4 (2005): 780-804.

[32] Jovanovic, B. and P. L. Rousseau. (2005). "General Purpose Technologies."
    In P. Aghion and S.N. Durlauf, Handbook of Economic Growth, vol. 1B. Elsevier
    B.V., Amsterdam.

[33] Jovanovic, B. and P. L. Rousseau. "Extensive and Intensive Investment
     over the Business Cycle." Journal of Political Economy. 2014.

[34] Justiniano, A., Primiceri, G. E., & Tambalotti, A. (2010). Investment
    shocks and business cycles. Journal of Monetary Economics, 57(2), 132-145.

[35] Kendrick, J.W. Productivity Trends in the United States. National Bureau of
    Economic Research General Series no. 71. Princeton University Press, 1961.

[36] Koulovantianos, C., L. Mirman and M. Santugini. "Optimal growth and
    uncertainty: Learning." Journal of Economic Theory 144 (2009) 280­295.

[37] Kreps, D. Anticipated Utility and Dynamic Choice, 1997 Schwartz Lecture, in
    Frontiers of Research in Economic Theory, Edited by D.P. Jacobs, E. Kalai, and
    M. Kamien, Cambridge University Press, Cambridge, England, 1998.


                                       37
[38] Krussell, P., L.E. Ohanian, J.V. Rios-Rull, G.L. Violante (2000).
    "Capital-Skill Complementarity: A Macroeconomic Analysis."Econometrica 68,
    1029-1053.

[39] Lewellen, J., & Shanken, J. (2002). Learning, asset-pricing tests, and mar-
     ket e¢ ciency. Journal of ...nance, 57(3), 1113-1145.

[40] Pástor, L., & Veronesi, P. (2009). Technological Revolutions and Stock
    Prices. American Economic Review, 99(4), 1451.

[41] Piketty, T. Capital in the Twenty First Century, Harvard University Press:
    Cambridge, MA, 2014.

[42] Pintus, P & J. Suda. (2018). Learning Financial Shocks and the Great Reces-
    sion, Review of Economic Dynamics, forthcoming.

[43] Sargent, T. J. (1980). "Tobin'
                                  s q"and the rate of investment in general equi-
    librium. Carnegie-Rochester Conference Series on Public Policy 12, 107-154.

[44] Sims, C.A. 1982. Policy Analysis With Econometric Models, Brookings Papers
     on Economic Activity, 107-152.

[45] Stokey, N. "Wait-and-See: Investment Options under Policy Uncertainty."
    Review of Economic Dynamics (2015).

[46] Veldkamp, L. L. (2005). "Slow boom, sudden crash." Journal of Economic
     theory, 124(2), 230-257.

[47] Veronesi, P. (2004). The peso problem hypothesis and stock market returns.
    Journal of Economic Dynamics and Control, 28(4), 707-725.

[48] Vissing-Jørgensen, A. (2002). Limited Asset Market Participation and the
    Elasticity of Intertemporal Substitution. Journal of Political Economy 110(4),
    825-853.

[49] Wachter, J. A. (2013). Can time-varying risk of rare disasters explain aggre-
    gate stock market volatility?. The Journal of Finance, 68(3), 987-1035.

[50] Weil, P. (1989). Non-expected Utility in Macroeconomics. Quarterly Journal
     of Economics 105(1), 29-42.

                                        38
[51] Whelan, K. A Guide to US Chain Aggregated NIPA Data, Review of Income
              and Wealth 48, 2002, 217-233.

[52] Wright, S. "Measures Of Stock Market Value And Returns For The U.S.
     Non...nancial Corporate Sector, 1900-2002." Review of Income and Wealth 50,
              2004.

[53] Yogo, M. (2004). Estimating the Elasticity of Intertemporal Substitution When
              Instruments Are Weak. Review of Economics and Statistics 86(3), 797-810.


A                  Measuring the Output-Capital Ratio
           In our model, TFP is the ratio of real output to the real capital stock. The
left-hand column of ...gure 13 portrays raw data on real private-sector GDP and
capital (upper panel) along with their ratio (lower panel).23 As highlighted in the
introduction, there is a structural break in the capital-output ratio in the 1940s.

         Real Private Sector GDP and Capital (Billions Chained 2009 Dollars)                     Nominal Capital-Output Ratio and Relative Price
                                                                                     4
     4
10

                                                                                     3


                                                                                     2
     3
10
                                                                  GDP                1
                                                                                                                                    Nominal K/Y ratio
                                                                  Capital                                                           P /P
                                                                                                                                     K       Y
                                                                                     0
            1900       1920      1940       1960      1980       2000                     1900       1920      1940       1960      1980              2000



                              Real Capital-Output Ratio                                            Relative Prices of Equipment and Structures

3.5                                                                                 1.5

 3

2.5
                                                                                     1
 2

1.5
                                                                                    0.5
 1                                                                                                                                       P                /P
                                                                                                                                             equipment         Y
0.5                                                                                                                                      P            /P
                                                                                                                                             structures    Y

 0                                                                                   0
            1900       1920      1940       1960      1980       2000                     1900       1920      1940       1960      1980              2000




                              Figure 13: Output, Capital, and the Output-Capital Ratio
     23
           Data ...les and a program for calculating these measures are available on request.




                                                                               39
       The ratio of nominal capital to nominal output is shown in the upper right panel.
Unlike the real ratio, the nominal ratio appears to be stationary, uctuating around a
value of 3.0. Since the nominal ratio is equal to the real ratio divided by the relative
price of capital to output,
                                         Ynt     zt
                                             =           ;
                                         Knt   PKt =PY t
this would be a valid measure of TFP if PK =PY were always equal to 1. For instance,
this would be true in a one-sector Ak model in which output could be costlessly
transformed into capital and vice versa. Alas, the assumption that PK =PY = 1 is not
supported by the data. On the contrary, PK =PY trends upward (see the upper right
panel). The nominal ratio therefore confounds TFP with other shocks that move the
relative price of capital to output.
    Our measure of capital is constructed from data on equipment and structures.
The lower right panel drills down by portraying the relative price of each component
to output. Although the relative price of equipment to output declined sharply after
1980, the relative price of structures kept rising. Our measure of PK is a Fisher
ideal price index for the two components, and an upward trend emerges because
the steadily rising price of structures more than counterbalanced the rise and fall
in equipment prices. An upward trend in PK =PY does not contradict evidence of a
downward trend in PE =PY .24
  24
     Our relative-price data di¤er from those used in a number of in  uential papers in the literature.
For instance, Jovanovic and Rousseau (2005) report a downward trend in the relative price of
equipment for the entire period between 1885 and 1996. In contrast, our data show a rising relative
price from 1925 to 1960 and a decline thereafter.
  The di¤erence is mainly due to how equipment prices are measured. Building on work by
Krussell, et al. (2000), Jovanovic and Rousseau start with Gordon'  s (1990) data on quality-adjusted
equipment prices for 1947-83, then extend it forward and backward in time by appending VAR
forecasts and historical data (see Jovanovic and Rousseau 2005, footnote 9, p. 1196). We do not
use Gordon'  s (1990) data. Instead, we follow Gordon (2016) by using NIPA data on chain-weighted
price indices. These chain-weighted series incorporate many of Gordon'      s (1990) proposals, such
as adjusting for quality by comparing like units in adjacent years and aggregating by computing
superlative price indices. Coverage of equipment types is also broader; e.g. for 1967, Gordon (1990)
reports that categories amounting to 23 percent of private domestic equipment was missing from his
1990 series. The new BEA data also cover a longer time span, 1925-2015 vs. 1947-93 for Gordon
(1990), making forward and backward extensions unnecessary. Last but not least, Gordon (1990)
collected no data on structures. Since our sources report comparable chain-weighted price indices
for structures, we can construct a broader measure of aggregate capital.




                                                  40
A.1     Real private-sector GDP
   The data are annual and cover the period 1889-2015. Two sources are spliced
together at 1929. Data for the period 1889-1929 are taken from Kendrick (1961),
while those for the period after 1929 were downloaded from the Bureau of Economic
Analysis. Kendrick' s series were rescaled so that they coincide with BEA measures
at the splice date.

      1889-1929: Real gross private domestic product was taken from Kendrick (1961),
      Appendix A, Table A-III, column 8.

      1929-2015: Real GDP was taken from BEA Table 1.1.6, line 1. To adjust for
      government, nominal GDP and nominal government spending were downloaded
      from BEA Tables 1.1.5 (line 1) and 3.1 (line 26), respectively. The government
      share sgt was measured as the ratio of nominal government spending to nominal
      GDP. Then real private GDP was calculated as

                                    Yps;t = (1   sgt )Yt ;

      where Yt is total GDP and Yps;t is private-sector GDP.

A.2     Real Private-Sector Capital
   The capital stock is de...ned as private ...xed assets, structures plus equipment.
Intellectual property was excluded because it was not available before 1925. Data for
the period 1889-1925 come from Kendrick (1961), while those for the period 1925-
2015 are from the Bureau of Economic Analysis. The two series are spliced in 1925,
and Kendrick'
            s series was again rescaled so that it coincides with the BEA measure
at the splice date.

      1889-1929: Real Structures and Equipment were taken from Kendrick, Appen-
      dix A, Table A-XVI, columns 7 and 9.

      1925-2016: Index numbers for structures and equipment were downloaded from
      BEA Table 2.2, lines 2 and 41. The indices were converted to 2009 dollars by
      multiplying by nominal structures and equipment for that year. The latter can
      be found in BEA Table 2.1, lines 2 and 41, respectively. Following Whelan
      (2002), price and quantity indices for capital were computed by constructing
      Fisher ideal indices from the indices on equipment and structures.

                                         41
B         Proof of Proposition 1
Start with the planner'
                      s Bellman equation,
                                  h                                                                                           1         i11
                V (st ; kt ) = max (1                 )Ct1     +            Et [V (st+1 ; kt+1 )              1
                                                                                                                      ]       1
                                                                                                                                                  ;
                               Ct ;Xt


then substitute the conjectured value function V (s; k ) = v (s)k along with the identi-
ties C = ck and k 0 = gk :
                                     h                                                                                    1            i11
                                                          1                          0 1                  1
                 v (s)k = max (1                 )(ck )        +             E [v (s )          (gk )             ]       1
                                                                                                                                              ;       (32)
                             C;X
                                     h                                                                              1         i11
                                                          1                   1                     0 1
                          = max (1               )(ck )        + (gk )               E [v (s )                ]     1
                                                                                                                                         ;
                             C;X
                                     h                                                              1     i11
                                                      1             1                0 1
                          = max (1               )c       + g               E [v (s )           ]   1
                                                                                                                          k:
                             C;X


The aggregate resource constraint and law of motion for capital imply

                                                  ct = zt       qt (gt         1 + );                                                                 (33)

We use equation (33) to express the right-hand maximization problem in terms of
growth,
                      h                                                                                                           1     i11
                                                                        1            1                        0 1
        v (s)      max (1                )(z     q (g     1 + ))             + g                E [v (s )                 ]       1
                                                                                                                                                  :   (34)
                    g


The ...rst-order condition is
                                                                                                                                         1
          (1        )(1        )(z        q (g       1 + )) q = (1                         )g           E [v (s0 )1 ]                    1
                                                                                                                                              ;       (35)
                                                                                                                      1
                                                     (1       )qc       = g              E [v (s0 )1 ]                1
                                                                                                                                  :                   (36)

After substituting the conjectures for c(s) and g (s) in equations (17) and (16), we
...nd
                                         !                                     1
                                                                                                                  !
                  z + q (1           )                                  zq         w(s)         (1            )                                       1
(1        )q               1                     =        1         +                      1                                          E [v (s0 )1 ]   1
                                                                                                                                                          :
                  1 + q1       w(s)                                           1 + q1           w(s)
                                                                                                                                                      (37)




                                                                    42
                                                               1
Multiplying both sides by (1 + q 1                                 w(s)) ;
                                                      h                                 1                            1
                                                                                                                                                         i
                                                                                   1
  (1        )q (z + q (1       ))         =               (1           )(1 + q              w(s)) + zq                   w(s)            (1             )
                                                                           1
                                            E [v (s0 )1 ]                  1
                                                                                    ;
                                             h                             1                            1
                                                                                                                 i                                       1
                                          =    (1      )q 1                    w(s) + zq                    w(s)              E [v (s0 )1 ]              1
                                                                                                                                                                  ;
                                                       h                                     1               1
                                                                                                               i                                    1
                                          = w(s)        (1                         )q 1             + zq                 E [v (s0 )1 ]              1
                                                                                                                                                             ;
                                                                                                                                 1
                                          = w(s) q [z + (1                                      )q ]        E [v (s0 )1 ]        1
                                                                                                                                            :                    (38)

Multiplying both sides by w(s) and cancelling like terms implies
                                                  1
w(s)    =                E [v (s0 )1 ]            1
                                                           ;                                                                                                     (39)
               1
                               "                                                                                                                        #    1
                           1
                                                                          h                                      1
                                                                                                                                i11             1            (1       )
                                              0            0                                                01            0
w(s) =                             E (z + q (1                          )) (1                   )(1 + q              w(s ))                                               ;
                   1

This delivers a recursion for w(s) that satis...es the FOC.
   Now we need to verify that the conjectured solution satis...es the Bellman equation.
Notice that
                               "                                                                                     ! #11
                                                                                        z + q (1                 )
                   v (s) =         (1             )(z + q (1                  ))                        1                            ;
                                                                                        1 + q1              w(s)
                                                                                                1
                           =       (1             )(z + q (1               ))c              1
                                                                                                    :                                                            (40)

If our guess holds, then (14) and (15) imply

                                                      1
                                                                   h                                                                        1   i11
                                                                                    1                   1                 0 1
       (1         )(z + q (1        ))c           1
                                                               = (1            )c           + g                  E [v (s )          ]       1
                                                                                                                                                             ;
                                                                                                                                        1
             (1        )(z + q (1     ))c = (1                             )c1            + g1                E [v (s0 )1 ]             1


                             z + q (1    )                                g 1                                                   1
                                           =1+                                                              E [v (s0 )1 ]       1

                                   c                                      c                 1
                             z + q (1    )                                g 1
                                           =1+                                              w(s)                                                                 (41)
                                   c                                      c




                                                                         43
Plugging the conjecture for consumption in the left hand side yields
                                                   1                              g       1
                                    1 + q1             w(s) = 1 +                                 w(s)
                                                                                  c
                                                   1       g                  1
                                              q1       w(s) =                         w(s)
                                                           c
                                              1            g                  1
                                     q1         w(s) 1
                                                       =
                                                           c
                                                 1       g
                                               q w(s) =                                                                     (42)
                                                         c
Using the conjectured decision rules for c and g , the right-hand side can be written
as
                                                       !    1                                 1
                                                                                                                        !
                 g          z + q (1               )                                  zq          w(s)       (1     )
                   =                      1                      1            +                          1
                 c       1 + q1               w(s)                                            1 + q1         w(s)
                                                       1                          1
                       (1           )(1 + q 1           w(s)) + zq w(s)                             (1        )
                   =
                                                        z + q (1  )
                                1                           1
                       q1        (1     ) + zq
                   =                                            w(s)
                                z + q (1    )
                            1
                   =q           w(s)                                                                                        (43)

From (42) and (43), it is clear that the conjectured value function and decision rules
satisfy the Bellman equation.


C      Alternating regimes when                                                                2 f L;             Hg

   Next we investigate a model with alternating regimes analogous to that of Hopen-
hayn and Muniagurria (1996, henceforth HM). A break occurs with probability :
Conditional on a break, values of                          alternate with transition-probability matrix

                                                                          L           H
                                                        =        L        0       1 :                                       (44)
                                                                H         1       0
In other words, the timing of the shift is still random, but its character is deterministic.
                  q
In the case of        , this exercise is roughly that of HM, except that in their model
a higher q is caused higher taxation (accompanied by a lump-sum redistribution)
instead of higher investment cost.25 As in HM,                                                is an inverse measure of policy
  25
    HM study an Ak model that features policy shocks instead of investment-speci...c technology
shocks. In their model, an investment subsidy is periodically put in place for a random length of

                                                                     44
persistence. Higher variability then implies more frequent changes in consumption
and investment.
                                                          z                        q
       Let us illustrate for the case where                   is ...xed and            oscillates as in (44). When
                                                                  q           q
we write "H" we mean the regime in which   =                                  H.
                                                   Beliefs are degenerate at the
     z q
true ; , and so (14) and Proposition 1 simplify as follows. For I; J 2 fL, Hg ;
(here We also assume CRRA preferences ( = ), as in Sec. 3.

                           C1            R
       V I (s; k ) = max           +             V J (s0 ; k 0 ) + (1          ) V I dF I (s0 )          = v I (s)k 1 :
                    C;X    1
where
                                       (z + (1           )q )1                     1
                           v I (s) =                              (1 + q 1             wI (s))
                                             1
and where instead of (13), we have
             n R                                              1
                                                                                                               o1=
   I                 0             0 1              01                J   0                      I   0          I   0
 w (s) =           (z + (1       )q )      (1 + q                 w (s ) + (1                ) w (s ) ) dF (s )

The optimal policies are
                                                                                            1=
                    z + (1    )q                                                       zq     wI (s) (1     )
        cI (s) =       1   1  I
                                   ;         and          g I (s) = 1              +            1   1  I
                                                                                                              :
                   1+q       w (s)                                                          1+q       w (s)
Then using again the parameters values in Table 3.1, Figure 14 plots the three aver-
ages

   cL (smed. ) + cH (smed. )           g L (smed. ) + g H (smed. )                       wL (smed. ) + wH (smed. )
                             ;                                                 and
               2                                    2                                                2
as functions of , evaluated at the median value of s.
    When q varies with z ...xed, more frequent policy shifts raise consumption and
welfare because they allow agents to substitute investment from periods when in-
vestment is costly and into periods when it is cheap ­ see the bottom row of ...gure
14. This allows consumption to rise on average without an increase in its volatility.
Welfare therefore goes up even though growth declines. On the other hand, regime
                           z
changes that a¤ect             simply raise consumption volatility with no o¤setting bene...t
from intertemporal substitution of investment ­see the top row of ...gure 14.
   As rises and as one moves from left to right along the horizontal axis in Fig. 14,
future regimes become harder to predict as do future shock realizations. Although a
time. This raises the growth rate similarly to how a fall in q raises growth in our model. We proceed,
as HM do, under CRRA preferences ( = ), as in Sec. 3.

                                                           45
                                              z                                       z                                        z
                     Consumption, alternate                       Growth, alternate                       Welfare, alternate
          0.16                                         1.04                                    -500

          0.15                                         1.03
                                                                                              -1000
          0.14                                         1.02
                                                                                              -1500
          0.13                                         1.01

          0.12                                           1                                    -2000
                 0             0.5                1           0           0.5             1           0           0.5              1

                                              q                                       q                                        q
                     Consumption, alternate                       Growth, alternate                       Welfare, alternate
         0.225                                         1.03                                    -250

          0.22
                                                      1.025                                    -300
         0.215
                                                       1.02                                    -350
          0.21

         0.205                                        1.015                                    -400
                 0             0.5                1           0           0.5             1           0           0.5              1




                                                                                                            z
Figure 14: the effect of when alternates. Top Row: only                                                         alter-
nates, Bottom Row: only q does.

rise in does not represent an MPS in the distributions of future shocks, these results
are qualitatively similar to those in Sec. 3.1 that deal with MPSs for given and known
values of . In Figure 2 shocks become less forecastable as we move from right to
left on the horizontal axes in each of the four quadrants; consumption and growth
respond in qualitatively the same way as in Fig. 14. But if the marginal distributions
of the sequences of future shocks are the same for the two sets of cases, the agent is
better o¤ when regimes alternate because shocks are negatively autocorrelated and
thus are easier to forecast in the alternating regime case.


D      Solving the model with non-recurrent structural
       breaks and autoregressive shocks (section 4)
D.1     Agents use a pair of Kalman ...lters to learn about                                                       t

     The posterior p( t+1 ; t jst ; ) can be calculated recursively with a pair of Kalman
                                                                                           t
...lters. To simplify notation, de...ne xt      ln at    a ln at 1 : Because the history a



                                                          46
is observable and         a   is known, xt is observable. Conditional on                                   at ;   xt is normally
                                                                      2
distributed with mean            at    and variance                   a:
       Suppose a structural break occurs at date t:26 Knowing that a new intercept is
about to be drawn, agents adopt the unconditional distribution of mt as their prior,

                                                                                   2
                                               p( t j     t    = 1) = N (m;        m ):                                      (45)

       Next, agents observe xt and update beliefs about                               t.   According to Bayes theorem,

                       p( t jxt ;     t   = 1; ) / p(xt j t ;              t   = 1; )p( t j       t   = 1):                  (46)

Because       t   a¤ects xt only through                      t,   it carries no incremental information about xt
beyond that contained in                  t:   Hence the likelihood simpli...es to

                                       p(xt j t ;          t   = 1; ) = p(xt j t ; ):                                        (47)

Since the prior and likelihood are both Gaussian, this is a conjugate updating problem
whose solution can be found by applying the Kalman ...lter,

                                                                                m         m
                                     p( t jxt ;       t   = 1; ) = N (          tjt ; 1=Ptjt ):                              (48)

                                                                                                  m
A superscript m indicates that the mean and precision,                                            tjt   and Ptm
                                                                                                              jt ; update the
break-date prior (equation 45).
       The predictive density at date t serves as the prior for t + 1: To ...nd this predictive
density, we ...rst condition on                   t+1      and then marginalize with respect to it. With
probability ; another structural break will occur at t + 1; in which case                                            t+1   will be
distributed as
                                                                                      2
                                          p(    t+1 j t+1          = 1) = N (m;       m ):                                   (49)

The new draw mt+1 is independent of the histories xt or                                    t
                                                                                               ; making them irrelevant for
                                27
prediction or updating.               With probability 1                       , no break will occur, and              t+1   =   t:
For that scenario, the conditional predictive density is

                                                                                 k           k
                           p(   t+1 jxt ;        t;       t+1      = 0) = N (    t+1jt ; 1=Pt+1jt );                         (50)
  26
     The model is set up so that histories xt 1 ; t 1 are cleared when there is a structural break, so
this starting point involves no loss of generality.
  27
     This is why histories are cleared at break dates.




                                                                     47
where superscript k indicates that the predictions are based on the output of Kalman
updating at date t (equation 48). We marginalize with respect to                                                        t+1       by taking a
probability weighted mixture,

            p(     t+1 jxt )     =           p(   t+1 j t+1   = 1) + (1                   )p(     t+1 jxt ;     t;   t+1   = 0);            (51)
                                                      2                              k           k
                                 =           N (m;    m)   + (1            )N (      t+1jt ; 1=Pt+1jt ):


This serves as the prior for date t + 1.
   At t +1, agents observe realizations of xt+1 ;                                  t+1   and update beliefs. The likelihood
function is

                 p(xt+1 ;        t+1 j t+1 ;      ) = p(xt+1 j             t+1 ;         t+1 ;   ) p(      t+1 j t+1 ;       );             (52)
                                                      = p(xt+1 j           t+1 ;     ) p(         t+1 j   ):

In the second line,              t+1    drops out of the ...rst term because it conveys no incremental
information about xt+1 beyond that contained in t+1 : In addition, t+1 drops out
of the second term because t+1 is an exogenous Bernoulli random variable whose
success probability does not depend on the intercept.
     Multiplying the likelihood by the prior delivers the posterior kernel,

p(   t+1 jxt+1 ;    t+1 ; xt ;     t;    ) / p(xt+1 j            t+1 ;     ) p(          t+1 j   )                                          (53)
                                                        p(    t+1 j t+1        = 1) + (1                  )p(    t+1 jxt ;    t;    t+1   = 0) :

Since p( t+1 j ) does not depend on                           t+1 ;   this term can be absorbed into the normal-
izing constant, yielding

p(   t+1 jxt+1 ;    t+1 ; xt ;     t;    ) / p(xt+1 j            t+1 ;     )                                                                (54)
                                                        p(    t+1 j t+1        = 1) + (1                  )p(    t+1 jxt ;    t;    t+1   = 0) :

After substituting expressions for the priors, we ...nd

                                                                                                     2
  p(   t+1 jxt+1 ;     t+1 ; xt ;       t;   ) / p(xt+1 j             t+1 ;    )         N (m;       m)         if   t+1   = 1;             (55)
                                                                                                 k           k
                                                  / p(xt+1 j          t+1 ;    )         N(      t+1jt ; 1=Pt+1jt )          if    t+1    = 0:

Both components involve a Gaussian prior and likelihood, so piecewise conjugacy is
preserved. Hence the posterior is a mixture of normals, and each component can be
updated via a Kalman ...lter.

                                                                      48
     In the event of a break, the prior is re-initialized to (45) and updated as at date
t,
                                                                                     m             m
                                    p(   t+1 jxt+1 ;          t+1   = 1; ) = N (     t+1jt+1 ; 1=Pt+1jt+1 ):                    (56)
Absent a break, the posterior is found via a standard Kalman update,
                                               t+1                                       k             k
                                p(    t+1 jx         ;   t;    t+1   = 0; ) = N (        t+1jt+1 ; 1=Pt+1jt+1 );                (57)

where xt+1 represents the history going back to the last break date.
    The predictive density for t+2 has the same form as that for t+1. With probability
 ; another structural break will occur at t + 2; in which case t+2 will be distributed
as
                                                                                               2
                                                 p(      t+2 j t+2     = 1; ) = N (m;          m ):                             (58)
With probability 1      , no break will occur, and                                           t+2   =    t+1 :   In that case, the
conditional predictive density is

                               p(    t+2 j t+2   = 0; xt+1 ;           t+1
                                                                             ; ) = N(     k             k
                                                                                          t+2jt+1 ; 1=Pt+2jt+1 );               (59)

where xt+1 ; t+1 are histories going back to the last break date. The predictive density
is again a mixture of the two,
              t+1             t+1
p(   t+2 jx         ;               ; ) =        p(      t+2 j t+2     = 1; ) + (1           )p(   t+2 j t+2    = 0; xt+1 ;   t+1
                                                                                                                                    ; );
                                                                2                        k             k
                                         =       N (m;          m)    + (1        )N (   t+2jt+1 ; 1=Pt+2jt+1 ):                    (60)

This closes the loop. Updating and prediction at date t + 2 have the same form as
for t + 1:
   The updating densities are normal, and the predictive densities are mixtures of
normal. Since conjugacy is preserved for each component of the mixture, the Kalman
...lter can be used to update conditional means and variances. Care must be taken
about the prior being updated, but otherwise Kalman'
                                                   s logic goes through. When
a break occurs, histories of x; are cleared, and the prior is re-initialized using the
unconditional distribution. When no break occurs, histories of x going back to the
last break date are retained, and updating is done with a Kalman ...lter.

D.2       How the integral equation is approximated
     The state vector consists of the active shock ln a plus the posterior mean and
precision,              tjt   and Ptjt ; that emerge from the Kalman ...lter. Because Ptjt is a deter-
ministic function of time since the last break, it can be subsumed in a time index for

                                                                             49
w( ): We therefore look for a sequence of functions wt (ln at ;                  tjt )   for t = 0; :::; 1 that
satisfy equation 13 and are consistent with Bayes updating and the law of motion for
the shocks.
     To simplify notation, de...ne

                                     f (s; w(s))      v (s)1 ;

and write equation 13 as
                                             1
                                                                        1
                        w(s) =                   [Ef (s0 ; w(s0 )js)]   (1   )
                                                                                  :                       (61)
                                     1
For a model with recurrent structural breaks, the expectation term has two branches,
                                   Z    h                                 i
      0         0  0
 Ef (s ; wt+1 (s ; ))js) = (1     ) f s0 ; wt+1 (s0 ; ^  bnobreak (s0 ; )) pnobreak (s0 js)ds0
                               Z     h                        i
                           +     f s0 ; w0 (s0 ; ^
                                                 bbreak (s0 )) pbreak (s0 js)ds0 :        (62)

                           s value, and t indexes time since the last break. pbreak (s0 js)and
A prime denotes next period'
pnobreak (s0 js) represent the Bayesian predictive densities derived in the previous sub-
section, and ^  bbreak (s0 ) and ^
                                 bnobreak (s0 ; )) signify that beliefs are updated according to
Bayes rule. Substituting back into equation 13 yields
                                 1

        wt (s; ) =                                                                                        (63)
                         1
                             Z     h                                 i
                      f(1   ) f s0 ; wt+1 (s0 ; ^   bnobreak (s0 ; )) pnobreak (s0 js)ds0
                         Z   h                          i                    1
                      +    f s0 ; w0 (s0 ; ^
                                           bbreak (s0 )) pbreak (s0 js)ds0 g (1 )

If   were zero, the third line would vanish, and the ...rst two would de...ne a backward
recursion for wt ( ). When       > 0; the break date function w0 ( ) a¤ects the solution
for wt ( ) for all non-break dates. The main challenge in solving equation (63) is the
simultaneity between wt ( ) and w0 ( ):
   Our algorithm combines a backward recursion for the wt ( ) functions with a ...xed
point problem involving w0 ( ). To ...nd a good initial guess for the ...xed-point prob-
lem, we adopt a method of successive approximation. Imagine a sequence of models
indexed by i , i = 1; :::; n, starting from 1 = 0 and increasing until the desired value
  n is reached. We ...rst solve the      = 0 model, iterating backward until w0; 1 ( ) is

                                                 50
found. That solution is used to approximate wt ( ) for a model in which                                      2    0: We
gradually raise      to the desired value, approximating w0 ( ) with the solution from
the previous step. I.e., for i = 2; :::; n; we solve
                                         1

     wt; i (s; ) =                                                                                                    (64)
                           1
                               Z    h                                   i
                       f(1   i)   f s0 ; wt+1; i (s0 ; ^
                                                       bnobreak (s0 ; )) pnobreak (s0 js)ds0
                           Z    h                           i                   1
                                            0 ^
                       + i f s ; w0; i 1 (s ; bbreak (s )) pbreak (s0 js)ds0 g (1 )
                                  0                      0



This breaks the simultaneity between wt ( ) and w0 ( ) and delivers a straightforward
backward recursion for wt ( ): When the desired                          is reached, we iterate on
                                     1

  wt; n (s; ) =                                                                                                       (65)
                       1
                                      Z   h                                         i
                                              0              0 ^              0
                   f(1             n )  f   s   ; wt+1; n ( s ; b nobreak ( s   ; ))  pnobreak (s0 js)ds0 ds0
                               Z
                                                                                                                 1
                                                        1
                   +       n        [z 0 + (1      )q 0 ]        w0; n (s0 ; ^
                                                                             bbreak (s0 ))pbreak (s0 js)ds0 g    (1   )   :

until a ...xed point for w0 ( ) is found.

D.2.1    Solving the           = 0 model

With = 0; one component of the mixture is deactivated, updating and prediction
reduce to a conventional Kalman ...ltering problem, and equation (63) reduces to an
in...nite horizon backward recursion in wt ( ): We approximate its solution with that
of a long but ...nite horizon problem.
   The ...rst step is to approximate the terminal value wT (ln aT ; T jT ): Because the
  = 0 model involves decreasing gain learning, tjt will eventually converge in prob-
ability to the true value. Agents don'
                                     t know the true value, but they can calculate
a rational expectations solution for w( ) for any value of                             a   in the support of the
prior. Toward that end, we de...ne grids for ln at and a ; set T equal to 1000 years,
and shut down parameter uncertainty for year T and beyond by ...xing PT 1 = 0: For
points on the grid, a ...xed point for w(ln a;                    a)   is found by iterating on the rational
expectations version of the integral equation,
                                1   Z                                                           1
                                                                                                (1   )
            w(s; ) =                  f ([s0 ; w(s0 ; )]) p(s0 js; )ds0                                  :            (66)
                         1

                                                            51
Values at ordinates between the nodes are approximated by ...tting and interpolating
a Chebychev polynomial. This delivers a family of rational expectations solutions
indexed by    a   that approximates the terminal solution wT (ln aT ;                    T jT ).
   This approximation initializes a backward recursion. For periods before T; pa-
rameter uncertainty is restored by updating Ptjt via the Kalman ...lter, and wt ( ) is
calculated by iterating backward on equation 63. Notice that the integrand on the sec-
ond line involves wt+1 (ln at+1 ;   t+1jt+1 ):   Next period'
                                                            s estimate                  t+1jt+1    is calculated
using the Kalman ...lter, and wt+1 ( ) is evaluated from the Chebychev approximation
computed in the previous step of the backward recursion. The right-hand integral
is then computed via quadrature. Values at ordinates between the nodes are again
approximated by ...tting and interpolating a Chebychev polynomial. Continuing back
to date 0 delivers the desired sequence of wt ( ) functions.

D.2.2    Approximating equation (64)

Next we raise       slightly and substitute w0;        =0 (   ) into equation (64). Since w0;              =0 (   )
is held constant, this equation also de...nes a backward recursion for wt; 1 ( ); which is
solved in essentially the same way as the = 0 model. We run through the sequence
of models, gradually increasing ; until an initial guess for w0; n ( ); is obtained.

D.2.3    Solving the ...xed point problem

We substitute the initial guess for w0; n ( ) into the second line of equation (65), then
compute Chebychev approximations to wt; n ( ) by backward iteration, until a new
guess for w0; n ( ) is found. Then we substitute the new guess for w0; n ( ) into the
second line of equation (65) and re-solve the backward recursion, eventually ...nding
yet another guess for w0; n ( ): We continue until the maximum absolute di¤erence
between old and new guesses for w0; n ( ) is negligible.


E       Estimating parameters governing the shock processes
The shocks follows autoregressive processes with occasional shifts in the intercept,

                              ln xt =    t   +   x   ln xt    1   +   x "xt ;                              (67)

where xt = zt or qt . A Bernoulli random variable                      t   governs whether a structural
break occurs. With probability 1             , no break occurs (                t   = 0), and the intercept

                                                 52
remains unchanged. With probability , a break occurs (                          t    = 1), and a new intercept
is drawn from a normal distribution,

                               t   =     t 1      with pr 1             ;                                       (68)
                                                           2
                                   = mt        N (m;       m)      with pr :

The random variables "xt ; t ; mt are mutually independent.
  The parameters = [ ; m; m ; x ; x ] are estimated from data on ln xt : A pre-
liminary examination of the likelihood surface indicated that                              and      m     are weakly
identi...ed in the frequentist sense. This is not surprising, since the sample might
contain only a single structural break. Consequently, we add informative priors and
...nd point estimates by maximizing the log posterior.

E.1     The likelihood function
As usual, the likelihood function can be factored as
                                              YT
                    p(ln xT j ) = p(ln x1 j )    p(ln xt j ln xt 1 ; ):                                         (69)
                                                           t=2

Because the state-space representation is non-Gaussian, a particle ...lter is used to
evaluate the likelihood function. Our particle ...lter is a straightforward modi...cation
of the Gordon, et al. (1993) bootstrap ...lter. It consists of three steps: predicting
the state one period ahead, evaluating the period t component of the likelihood by
Monte Carlo integration, and updating the date-t posterior for the hidden state.

E.1.1     State prediction
                                                                               t 1
Suppose an evenly weighted sample from the p(                    t 1 j ln x          ; ) is available at the end
of period t     1: With probability 1            ; these particles will survive and move forward
to date t: With probability , they will be extinguished and replaced with a draw
                      2
 t= mt        N (m;   m ):   The predictive distribution p( t j ln z t 1 ; ) is a mixture of the
two:
              p( t j ln xt 1 ; ) = (1      )p(    t   =    t 1 j ln x
                                                                        t 1
                                                                              ; ) + p(     t    = mt ):         (70)
Because       could be close to zero, we oversample the break distribution. Oversam-
pling serves two purposes, injecting diversity into the particle cloud at each date and
improving the accuracy of the monte carlo integration in step 2. Let

              f ( t j ln xt 1 ; ) = (1    ~ )p(   t   =    t 1 j ln x
                                                                        t 1
                                                                              ; ) + ~ p(    t   = mt )          (71)

                                                      53
represent a proposal density for p( t j ln xt 1 ; ) with ~ > : Our implementation sets
~ = 1=2: Importance weights are adjusted below to compensate.

E.1.2     Evaluating the period t component of the likelihood

The period t component of the likelihood is
                       Z
                t 1
  p(ln xt j ln x ; ) =    p(ln xt j ln xt 1 ; ;                                  t )p( t j ln x
                                                                                                  t 1
                                                                                                            ; )d t ;                       (72)
                       Z
                                                                                      p( t j ln xt 1 ; )
                     =    p(ln xt j ln xt 1 ; ;                                  t)                       f ( t j ln xt 1 ; )d t :
                                                                                      f ( t j ln xt 1 ; )
Armed with a proposal sample for                          t   from step 1, this can be approximated by
                                                  XN                                                                         t 1
                                                                                                        p(       it j ln x         ; )
        p(ln xt j ln xt 1 ; )          N     1
                                                              p(ln xt j ln xt 1 ; ;              it )                                  :   (73)
                                                      i=1                                               f(       it   j ln xt 1 ;    )
where N is the number of particles,

                                      t 1                                          (ln xt             it          x    ln xt 1 )2
                  ln p(ln xt j ln x         ; ;   it )   =       ln      x                                   2
                                                                                                                                     ;
                                                                                                        2    x

and
                         t 1
        p(   it j ln x         ; )
                                   =                  for draws from the break component,                                                  (74)
        f(   it   j ln xt 1 ;    )   ~
                                     1
                                   =                          for draws from the no-break component.
                                     1            ~

Our implementation sets N = 2000.

E.1.3     Updating the posterior for                                 t

The loop is closed by updating p( t j ln xt ; ): This is also done via importance sam-
pling. The proposal density is the same as in step 1, and the target is the product of
                                               t 1
the conditional prior p(           it j ln x         ; ) and the conditional likelihood p(ln xt j ln xt 1 ; ;                                 it ).
Unnormalized importance weights are the ratio of the target to proposal,
                                                                                                      t 1
                                                              t 1            p(           it j ln x    ; )
                                ~it = p(ln xt j ln x
                                w                                   ; ; it )                        t 1; )
                                                                                                           :
                                                                             f(           it j ln x

Sum and renormalize so that the weights sum to 1,
                                                                w
                                                                ~it
                                                         wit = X       :
                                                                  w~it
                                                                             i

                                                                    54
Then resample the proposal sample with weights wit to get an evenly weighted sample
from the date-t posterior p( t j ln xt ; ):
       The particle ...lter then advances to period t + 1: Looping over t delivers a value
for p(ln xT j ):

E.2        Priors over TFP parameters
                                                Q
We assume prior independence, p( ) =                i   p( i ); and calibrate marginal priors for
each parameter.

         p( ) = beta(8:98; 791): A beta prior is adopted so that 2 (0; 1). The prior
         mode was determined by counting trend breaks in the GDP data in Cogley
         (1990).28 Casual inspection suggests roughly 1 trend break per 100 years in
         countries other than the US; hence the prior mode for               was set to 0:01. Upper
         and lower values for a 95 percent prior con...dence interval were set at values
         twice and half as large as the mode, respectively. A beta density with = 8:98
         and    = 791 delivers the desired mode and con...dence interval (see Gelman, et
         al., p. 476-77).

         p( z ) = beta(86:26; 13:74): A beta prior was also adopted to constrain                   z   to
         the unit interval. The mode was found by simulating a conventional RBC
         representation for quarterly data,

                                    ln zt = 0:95 ln zt     1   + 0:006"t :                         (75)

         Since the time period in our model is a year, we simulate a long quarterly series,
         transform into annual data by summing across quarters, and then estimate an
         AR(1) model for the annual data. The result implies a prior mode of                z   = 0:87:
         The prior 95 percent con...dence interval was then set to             z   2 [0:79; 0:925]. A
         beta density with       = 86:26 and            = 13:74 delivers the desired mode and
         con...dence interval.

         p( z ) = IG1 (25; 0:0387): The time aggregation in the last bullet point delivered
         an estimate of z = 0:0368 for time-aggregated annual data. We also target
         a prior 95 percent con...dence set of z 2 [0:03; 0:055]: An IG1 density with
         shape coe¢ cient 25 and scale parameter 0.0387 delivers the desired mode and
         approximates the con...dence set for     z.
  28
       A mean shift in TFP generates a trend break in an AK growth model.

                                               55
      p(m) = N ( 0:0901; 0:0033): Given the other prior parameters, p(m) was cali-
      brated so that the center of the unconditional distribution for structural breaks
      is near K=Y = 2.

      p(     m)   = IG1 (30; 0:0158): Similarly, the prior for       m   is calibrated so that the
      structural break distribution concentrates on K=Y 2 (1; 3) with high probabil-
      ity.


    The priors on (m; m ; z ) jointly imply the following structural break distribution
for the capital-output ratio. The prior allows both growth miracles and growth disas-
ters after a structural break. It is also asymmetric, skewed toward growth disasters.



                    0.2

                   0.18

                   0.16

                   0.14

                   0.12

                    0.1

                   0.08

                   0.06

                   0.04

                   0.02

                     0
                          0   1         2        3             4          5         6




      Figure 15: Implied prior for structural breaks in the capital-output ratio



E.3     Priors over investment shock parameters
                                                     Q
We again assume prior independence, p( ) =               i   p( i ) and calibrate marginal priors
for each parameter.

      Lacking better information, the prior for                 is the same as above, p( ) =
      beta(8:98; 791): This puts the mode at         = 0:01 with a 95 percent prior credible
      set of       2 (0:005; 0:02).



                                               56
      p( q ) = beta(5; 5): A beta prior constrains            q   to the unit interval. The hyper-
      parameters were chosen so that the mode is 0.5 and a prior 95 percent credible
      set is   q    2 (0:2; 0:8). This prior is weakly informative, and         q   is relatively well
      identi...ed by the data, so this component of the prior is less inuential than
      some of the others.

      p( q ) = IG1 (5; 0:24): This prior is also weakly informative, with a prior mode
      of 0.2 and a 95 percent credible set of q 2 (0:13; 0:5). Our main concern was
      to allow transient innovations to be highly volatile, reecting the high volatility
      of market valuations.

      p(m) = N (0; 0:025): Given the other prior parameters, p(m) was calibrated so
      that the center of the unconditional distribution for m is close to 0.

      p( m ) = IG1 (10; 0:0229): Last but not least, the prior for m is calibrated so
      that, after a structural break, the new anticipated-utility long-horizon forecast
      for q lies between 0.5 and 1.5 with probability 0.99.

   The priors on (m;         m;     q)   jointly imply the following structural break distribution
for conditional long-horizon forecasts of q .



                   0.2




               0.15




                   0.1




               0.05




                    0
                         0    0.5            1        1.5         2       2.5         3




         Figure 16: Implied prior on conditional long-horizon forecasts for q




                                                     57
