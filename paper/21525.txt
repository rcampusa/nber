                                NBER WORKING PAPER SERIES




         THE DISTRIBUTIONAL CONSEQUENCES OF PUBLIC SCHOOL CHOICE

                                          Christopher Avery
                                           Parag A. Pathak

                                        Working Paper 21525
                                http://www.nber.org/papers/w21525


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    September 2015




We are grateful to Arda Gitmez, Ed Glaeser, Richard Romano, and Tim van Zandt for superb comments.
Pathak thanks the National Science Foundation for financial support under award SES-1056325.
Avery thanks INSEAD for hospitality, as much of this paper was written while he was a visiting scholar
at INSEAD. The views expressed herein are those of the authors and do not necessarily reflect the
views of the National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this research.
Further information is available online at http://www.nber.org/papers/w21525.ack

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2015 by Christopher Avery and Parag A. Pathak. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
The Distributional Consequences of Public School Choice
Christopher Avery and Parag A. Pathak
NBER Working Paper No. 21525
September 2015
JEL No. H44,I20

                                             ABSTRACT

School choice systems aspire to delink residential location and school assignments by allowing children
to apply to schools outside of their neighborhood. However, the introduction of choice programs affect
incentives to live in certain neighborhoods, which may undermine the goals of choice programs. We
investigate this possibility by developing a model of public school and residential choice. We consider
two variants, one with an exogenous outside option and one endogenizing the outside option by considering
interactions between two adjacent towns. In both cases, school choice rules narrow the range between
the highest and lowest quality schools compared to neighborhood assignment rules, and these changes
in school quality are capitalized into equilibrium housing prices. This compressed distribution generates
incentives for both the highest and lowest types to move out of cities with school choice, typically
producing worse outcomes for low types than neighborhood assignment rules. Paradoxically, even
when choice results in improvement in the worst performing schools, the lowest type residents may
not benefit.


Christopher Avery
Harvard Kennedy School of Government
79 JFK Street
Cambridge, MA 02138
and NBER
christopher_avery@hks.harvard.edu

Parag A. Pathak
Department of Economics, E17-240
MIT
77 Massachusetts Avenue
Cambridge, MA 02139
and NBER
ppathak@mit.edu
1        Introduction

In 1974, Judge W. Arthur Garrity Jr. ruled that if a Boston school is more than 50% non-white,
then it would be subject to racial balancing. Garrity’s ruling ignited a fierce debate between
school choice proponents and neighborhood assignment advocates that continues more than forty
years later. Though Boston stands out, courts were involved with student assignment in numerous
districts, before many of these districts adopted some form of school choice. In choice plans,
pupils can apply to schools outside of their neighborhood, and the district uses this information for
centralized placement. Choice plan proponents argue that they would result in a more equitable
distribution of school access and lead to improvements in school productivity.1 Despite these
ambitious intentions, however, choice plans remain controversial, and there have been many recent
calls to return to neighborhood assignment across several districts.2
        The aim of this paper is to provide a simple model to explore how the link between school
assignment rules, house prices, and the residential choices of families affect the distributional con-
sequences of public school choice plans. Our model is motivated by empirical evidence showing how
the housing market and residential choices reflect school assignment rules (see, e.g., Black (1999),
Kane, Riegg, and Staiger (2006), Reback (2006), and Bayer, Ferreira, and McMillan (2007)). By
contrast to other recent work that emphasizes the connection between assignment rules and the
incentives for schools to improve their quality (see, e.g., Hoxby (2003), MacLeod and Urquiola
(2009), Barseghyan, Clark, and Coate (2015), and Hatfield, Kojima and Narita (2015)), we focus
on the effect of outside options in nearby towns on locational decisions of families living in a town
that adopts a school choice assignment rule.
        For simplicity, we assume that each family has one child and consider a world of (primarily)
one-dimensional types, which could be interpreted either as wealth or status (of the family) or
ability (of the child) or some combination of them. We assume that the quality level of a school is
determined by the average of the types of families/children who enroll in that school. With utility
    1
        The first US school choice plan was in Cambridge, Massachusetts, where the district decided in 1981 to introduce
a choice plan “to empower parents with choice, to include and treat fairly all students, to promote diversity, and to
promote school improvement through the competitive mechanism”’ (CPS 1981).
   2
     For instance, Theodore Landsmark, a well-known advocate of Boston’s busing plan in the 1970s, called for
a return to neighborhood assignment (Landsmark 2009). Former Boston Mayor Thomas Menino encouraged the
Boston school committee to adopt a plan that assigns pupils closer to home, and a plan restricting the amount of
choice outside of neighborhoods was adopted in 2014 (for more details, see Pathak and Shi 2014). Other districts
have also severely scaled back their choice plans such as Seattle (see Pathak and Sönmez (2013) for details).



                                                             2
functions that provide incentives for assortative matching, students segregate by type.                   When a
town with multiple school districts uses a neighborhood assignment rule, endogenous differentiation
of housing prices and school qualities emerge in self-confirming fashion in equilibrium.                    At one
extreme, a neighborhood known for highest quality schools will have the highest housing prices
and will attract only highest types, and thus will continue to have high quality schools.                      But
at the other extreme, lowest types will locate in neighborhoods with low quality schools.                     As a
consequence of these market forces, lowest types are relegated by self-selection and equilibrium
pricing to subpar schools, and thus, the educational system can be expected to widen rather than
narrow the inequality between initially high and low types.3
       Our primary question is whether a town can improve outcomes for low types by adopting a
school choice rule, whereby all families have equal access to all schools in that town. In practice,
school rosters still tend to be somewhat differentiated by neighborhood within a town that adopts
school choice for several reasons: some towns allow for residential preferences in school assignment
(Abdulkadiroğlu and Sönmez 2003; Dur, Kominers, Pathak, and Sönmez 2013; Calsimiglia and
Guell, 2014); families may have preferences for schools near them (Hastings, Kane, Staiger 2009;
Abdulkadiroğlu, Agarwal, and Pathak 2015); and wealthier families tend to use more sophisticated
strategies in school assignment lotteries (Pathak and Sönmez 2008). There is even some evidence
that the process of defining school boundaries can be captured by wealthy families - in the spirit of
gerrymandering - with the consequence that school choice rules can even reinforce the incentives for
school segregation by wealth within a particular town (Tannenbaum 2014). Even when a school
lottery is scrupulously designed to eliminate residential preferences and other features that may
favor wealthy families, segregated sorting may still result in an asymmetric equilibrium (Calsimiglia,
Martinez-Mora, and Miralles 2014), depending on the specific algorithm used for the assignment
rule.
       To make the strongest possible case for school choice, we abstract away from these practical
   3
       These ideas have their roots in Tiebout (1956) and Schelling (1971, 1978), and have been explored extensively
by (among many others) Benabou (1993, 1996), Durlauf (1996), and Loury (1977) in studies of intergenerational
mobility, by Fernandez and Rogerson (1996) and Nechyba (2003b) in studies of the effects of different tax regimes
for funding public schools, and by Epple and Romano (1998, 2003) and Nechyba (2000, 2003a) in studies of school
vouchers. Epple and Sieg (1999) empirically examine the relationship between locational equilibrium and community
income distribution, while Rothstein (2006) provides empirical evidence of the relationship between neighborhood
sorting and school quality. Epple and Romano (2015) analyze efficient allocations in a multi-community model with
peer effects.




                                                          3
details and assume that, in fact, all schools in a town that adopts school choice assignment rule have
exactly the same quality – equal to the average of types who locate in that town in equilibrium.
We then ask how the adoption of a school choice rule by a particular town affects the locational
choices of families in the resulting housing market equilibrium, with some families choosing to move
to that town and others choosing to leave it.
   The incentive for flight of high types from a town that adopts school choice has been discussed
in the literature on the residential consequences of school desegregation or busing. For instance,
Baum-Snow and Lutz (2011) attribute the decline in white public school enrollment in urban centers
to court-ordered desegregation decrees, finding that migration to other districts plays a larger role
than private school enrollment. In the context of our model, withholding the option of paying for
a high quality school will drive high types to other towns that offer that option. But this same
logic applies inexorably as well to predict flight of low types when a town adopts school choice.
In fact, any model that predicts that school choice results in a narrowing of the range between
highest quality and lowest quality schools in a town and allows for changes in school qualities to
be capitalized into housing prices will generate a prediction that the adoption of school choice will
produce incentives for types at both extremes to move. Yet to our knowledge, ours is the first paper
to model how narrowing the gap between highest and lowest quality schools provides equilibrium
incentives for flight of low types (in addition to high types) from the public schools in that town.
   Our approach is also inspired by past studies of the effects of private school vouchers, especially
Epple and Romano (1998) and Nechyba (2000). These papers develop ambitious models that
include multi dimensional student types, define school quality as a function of tax funding and
average peer quality, and allow for tax regimes, housing prices, and residential choices of families
to be determined endogenously in equilibrium, then typically use computational methods to assess
the welfare implications of different voucher plans. Subsequent papers by these authors, Epple and
Romano (2003) and Nechyba (2003a), consider the effects of public school choice in this framework.
Epple and Romano (2003) provide an example in their concluding remarks (p. 273-274) where a
public school choice rule induces exit by either low or high-income households, but do not conduct
a formal analysis along those lines as the framework of that example is quite distinct from the
models they analyze in the main section of the paper.
   While we make a conscious decision to exclude many features in this earlier literature, our model
is not a special case of any of these models for two important reasons. First, the models in the
voucher literature typically assume that each family must purchase a house in a given town, where



                                                  4
private schools provides the sole channel for flight from the public schools. Then private schools
only attract high types, as enrollment in a private school then effectively requires a family to pay
twice for schooling: first, paying for a public school in the form of housing costs and then paying a
separate tuition to switch to private school. Second, some of the models, particularly Epple and
Romano (2003), assume that there is a fixed price for houses attached to the lowest quality school
in a town. But this is not an innocuous assumption, as it implies that changes in the quality of
the worst school in the town are not capitalized into market prices, and thus improvements in the
quality of the worst school are necessarily beneficial to low types. In sum, although our model is
superficially simpler than these earlier models, it allows for important effects that are excluded by
the modeling choices in that literature.
    Our results are also related to the literature on gentrification and the displacement hypothesis,
which conjectures that neighborhood revitalization will result in higher prices that in turn cause low-
income and minority residents to move. The empirical evidence on the existence and magnitude
of displacement effects of gentrification is mixed (Vigdor, 2002; Atkinson, 2004; Freeman, 2005;
McKinnish, Walsh, and White, 2010; Autor, Palmer, and Pathak 2014), perhaps because there is
considerable endogenous selection in the location (Guerrieri, Hartley, and Hurst, 2013) and racial
composition of neighborhoods where gentrification occurs (Card, Mas, and Rothstein, 2008; Hwang
and Sampson, 2014).
    The paper is organized as follows.     Section 2 describes and analyzes the partial equilibrium
model of the effects of a school choice assignment rule in a single town when school qualities are
driven by peer effects and residential choices, while outside options in other towns are fixed exoge-
nously. Section 3 extends the model to a general equilibrium in two towns where the school qualities
and residential housing prices in each town (and thus outside options for all participants) are de-
termined endogenously in equilibrium. Section 4 discusses empirical implications and extensions of
the model. Section 5 concludes. Proofs not in the main text are in the appendix.


2     The One Town Model

2.1   Setup

We focus on the locational equilibrium associated with school assignment rules in a particular town
t. Each family i is assumed to have one child who will enroll in school as a student, where each
family/student has a two dimensional type. The first dimension is binary, identifying “partisans”



                                                  5
who have a particular interest in living in town t.                      The second dimension is “student type,”
which is independent and identically distributed according to distribution f (x) on [0, 1], where f
is continuous and differentiable and there is a positive constant ϕ such that f (x) > ϕ for each x.
We assume that there is a unitary actor for each household and refer interchangeably to families
and students as decision makers. To ease exposition, we frequently refer to the value of x as the
one-dimensional type of a student, neglecting partisanship.
       Each family has a separable utility function that takes as arguments the type, xi , the quality of
school j chosen by the family, yj , and the price of attending that school, pj . Since we study rules
for assigning students to public schools which are freely provided, pj is simply the cost of housing
associated with school j (and quality yj ). We write this utility function as

                                           u(xi , yj , pj ) = θij + v(xi , yj ) − pj ,

where θij = θ > 0 if family i is partisan to town t and school j is in town t, and θij = 0 otherwise.
The choice of a separable utility function of this form facilitates interpretation of “marginal utility”
and “marginal cost” of changes in school quality at equilibrium prices, while still producing results
that are qualitatively consistent with the prior literature.
       A critical assumption of the model involves properties of v, the value function for schooling.

Assumption 1 v is continuous, differentiable, strictly increasing in each argument, v(0, 0) = 0,
                                                                ∂2v
and there is a positive constant κ > 0 such that               ∂x∂y   ≥ κ for each (xi , yj ).

       Assumption 1 implies that v satisfies the property of strictly increasing differences in (xi , yj ).4
That is, if xH    L      H    L
             i > xi and yj > yj , then


                                 v(xH    H        H L           L H           L L
                                    i , yj ) − v(xi , yj ) > v(xi , yj ) − v(xi , yj ).


This assumption induces a motivation for assortative matching of students to schools, as “high
types” are willing to pay more for an increase in school quality than “low types.”5 The assumption
that v(0, 0) = 0 simply normalizes the boundary values for v.
   4
       See, for example, Van Zandt (2002).
   5
       If the one-dimensional type in the model is initial wealth, then it is natural to use a slightly different formulation
of utility, as is standard in the prior literature, namely u(xi , yj , pj ) = h(xi − pj , yj ) for some function h. Then, so
long as pj , the price for attending school j, is an increasing function of the quality of that school, h11 < 0 and h12 > 0
are jointly sufficient for u to exhibit strictly increasing differences in (x, y). Since hij refers to the second derivative
of h with respect to i and j, these sufficient conditions correspond to assumptions of decreasing marginal utility in
net wealth in combination with higher marginal utility for school quality as net wealth increases.



                                                               6
       We assume that measure mt of families are town-t partisans and that the measure of houses
available in town t is Mt ≥ mt , so that it is possible for all of these families to live in town t. We
also assume a competitive market for schools outside of town t such that schools of quality y are
available at competitive price p(y) for each y, which we identify below. Further, we assume a large
number of non-partisans of each type x who would be willing to locate in town t under sufficiently
favorable conditions.
       In a rational expectations equilibrium, the full set of prices p(y) induces enrollment choices by
each student so that a school of quality y has associated housing price p(y), and enrolls students
with average type y.          Then if schools of every quality level y are available in equilibrium, there
must be perfect assortative matching in equilibrium, with all students of type x enrolling at schools
with quality y = x.6
                                                             z=y
                                                             Z
                                                                   ∂v
Lemma 1 The competitive pricing rule p(y) =                           (z, z)dz induces a (non-partisan) student of
                                                                   ∂y
                                                           z=0
type x to choose a school of quality x.

       Lemma 1 identifies a unique pricing rule for self-sorting of all types into homogeneous schools.
In the One Town Model, we assume that schools of every quality level y are available outside
town t at associated (housing) price p(y). Thus, we denote the (outside option) value available in
equilibrium to a partisan of town t with type x as

                                                π(x) = v(x, x) − p(x).


2.2       Neighborhood Assignment

With these outside options in place for schools and housing outside of town t, we can now study the
effect of different school assignment rules on equilibrium outcomes in town t. For a neighborhood
assignment rule, the houses in town t are exogenously partitioned into separate districts 1, 2, ..., D,
   6
       The competitive market for public schools outside the given town is quite similar to the nature of private schools
in Nechyba (2000, 2003a), where in equilibrium, each private school enrolls students of a single “ability” level, much
as a school of quality y outside town t is chosen only by students of type y in our model. One important distinction
is that students who opt for an outside option in our model do not also have to pay for a house in town t, whereas
students who choose a private school in Nechyba (2003a) also have to reside in the original town and pay for a house
there. As a side note, Epple and Romano (1998, 2003) model private schools slightly differently than Nechyba by
allowing private schools to price discriminate when setting tuition levels. See Footnote 14 of Nechyba (2003a) for
further discussion of this point.




                                                             7
where each district has one school, housing prices vary by district, and all children living in district
d are assigned to the school in that district.


Definition 1 A neighborhood school equilibrium in town t consists of D districts with exoge-
nously specified enrollments M1 , M2 , ..., MD (where D
                                                     P
                                                      d=1 Md = 1), associated prices p1 , p2 , ..., pD

and sets of partisan types T1 , T2 , ..., TD enrolling in these districts with measures mT1 , mT2 , ..., mTD
and average abities y1 , y2 , ..., yD such that yd = E[x|x ∈ Td ] for each d and

 (1) v(x, yd ) + θ − pd ≥ π(x) for each d ∈ {1, 2, ..., D} and each x ∈ Td ,

 (2) v(x, yd ) + θ − pd ≤ π(x) for each d ∈ {1, 2, ..., D} and each x 6∈ Td ,

 (3) If x ∈ Td , then v(x, yd ) − pd ≥ v(x, yk ) − pk for each k ∈ {1, 2, ..., D},

 (4) mTd ≤ Md for each d where if mTd = Md , then pd ≥ p(yd ), while if mTd < Md , then
      pd = p(yd ).



   Condition (1) requires partisan types in Td to prefer district d in town t to their most preferred
options outside town t. Similarly, Condition (2) requires that partisan types who do not choose
any district in town t must prefer the outside option to each district in t.         Condition (3) requires
types in Td to prefer district d over each other district in town t.          Condition (4) requires that
partisan demand for housing in district d is no greater than the supply of housing in that district.
Further, if demand from partisans is less than the supply of housing in a particular district, then in
equilibrium, the housing price in that district must be equal to the competitive market price p(yd )
so that non-partisans of type x = yd will choose to inhabit the remaining houses in that district.
   The first two conditions of the definition are analogous to individual rationality constraints,
which ensure that partisan families choose to live in town t if and only if their best option in town
t yields higher utility than the best option outside of town t. The third condition is analogous to
an incentive compatibility constraint, ensuring that partisan families choose their most preferred
district if they choose to live in town t.
   To understand the properties of the model, it is useful to define the gain function for district
d in town t as follows:
                                G(x, yd , pd ) = v(x, yd ) − pd + θ − π(x).




                                                     8
This function is the net gain in utility when a partisan student of type x chooses district d in town t
with school quality yd and housing price pd rather than the best (competitive) outside option with
payoff π(x). Lemma 2 identifies properties of G, which we will exploit in describing equilibrium.

Lemma 2 For each d, we have

   i) G(x, yd , pd ) ≤ G(x, yd , p(yd )),

  ii) G(x, yd , pd ) ≤ θ, and

 iii) G(x, yd , pd ) is strictly increasing in x for x < yd and strictly decreasing in x for x > yd .


       Lemma 2 highlights the forces driving competitive pricing in this model. The marginal price
for a school of quality y is equal to the marginal benefit of school quality for a student of type
x = y at (x = y, y).          A student with type x < y who selects a school of quality y overpays on
the margin for school quality, whereas a student with type x > y who selects a school of quality y
values marginal school quality more than its cost at that point. The gain function G(x, yd , pd ) is
therefore decreasing as x moves away from yd . We emphasize that students of all types have an
ex ante preference for high quality schools. But since higher types are willing to pay more on the
margin for increases in quality, competitive pricing induces a preference for assortative matching
and thus a student of type x prefers a school of quality y = x over other choices at market prices.
       With limited options for schooling in town t, partisans of town t face a tradeoff between their
partisan interest of residing in town t and the opportunity to choose a school that is an exact
match (net of housing price) for their types. Lemma 2 implies that a school in town t will only
attract partisans with types close to the quality of that school, and in fact, in an interval of types
containing the school’s quality.
       Following this logic, a neighborhood school equilibrium must consist of ordered intervals, where
lower type students choose lower quality schools within town t.7 If all partisan students enroll in
town t, then the districts can be ordered according to enrollment {[x0 = 0, x1 ], (x1 , x2 ], ..., (xD −
1, xD = 1]}, where partisan students with types x ∈ (xd−1 , xd ] choose district d in town t. If there
is no gap between these intervals, then the equilibrium price difference between districts d and d + 1
   7
       See Epple and Romano (2003), especially Propositions 1, 2, and 6, for derivation of analogous results in a model
where school quality depends on expenditures and peer quality, and the residential choice problem is combined with
voting over the tax schedule.




                                                            9
is determined by the marginal benefit between school qualities yd and yd+1 for a partisan student
at the margin between these two districts, i.e. with x = xd . This incremental pricing condition

                                 ∆pd+1 = pd+1 − pd = v(xd , yd+1 ) − v(xd , yd ),

is necessary so that partisan students with type x just below xd will choose district d, while those
with x just above xd will choose district d + 1.8         The incremental pricing condition is analogous to
incentive compatibility conditions in mechanism design problems with a finite number of actions
as well as the pricing rules in Bulow and Levin (2006).               Taken together, the incremental pricing
rules yield a general formula for the prices of all D districts in a neighborhood school equilibrium:

                                                            d
                                                            X
                                                pd = p1 +         ∆pj .
                                                            j=2

       The formula leaves one degree of freedom, which is the price in district 1. There is a unique
choice of this price p1 to meet the equilibrium conditions that all prices must be at least equal to
competitive market prices for schools of given quality, pd ≥ p(yd ), and that at least one price is
exactly equal to the competitive market price to attract non-partisans to the remaining supply of
houses in town t after allowing for purchases of partisans in that town.               In sum, there is a unique
set of (potential) equilibrium prices for any partition of partisan types into intervals matched to
districts in town t. Further, given this set of equilibrium prices, it is straightforward to calculate
the minimum value of θ required to attract the anticipated set of partisans to town t, which is equal
to − minx (v(x, yd ) − v(x, x) − pd + p(x)). Proposition 1 formalizes these observations.


Proposition 1 In any neighborhood school equilibrium, for each d, the set of types TN d is an inter-
val [xNd , x̄Nd ]. Moreover, for any partition of (0, 1) into D intervals (0 = x0 , x1 ), (x1 , x2 ), ...(xD−1 , xD =
    ¯
1) where 0 < x1 < x2 < ... < xD−1 < 1, there is a cutoff θ∗ such that if θ ≥ θ∗ , there is a neigh-
borhood school equilibrium with D districts where types in interval d = (xd−1 , xd ) choose to live in
district d in town t.

Proof. We prove below that each district attracts an interval of partisan types in a neighborhood
school equilibrium. The second part of the Proposition follows directly from the discussion above.
       In a neighborhood school equilibrium, there must be an interval of types around yNd who prefer
district d in town t to every district outside town t, while all other types prefer a district outside
   8
       Epple and Romano (2003) describe this as a “boundary indifference” condition.




                                                         10
town t to district d in town t. But we must also consider the possibility that some types in this
interval might yet prefer a different district in town t to district d.
    For a student of type x, the difference in utility between districts d1 and d2 with school qualities
yd1 and yd2 in town t is

        ∆d1 ,d2 (x) = [v(x, yd1 ) − pd1 ] − [v(x, yd2 ) − pd2 ] = [v(x, yd1 ) − v(x, yd2 )] − [pd1 − pd2 ].

If yd1 > yd2 , then, by the property of increasing differences for v, then there exists a threshold value
x∗d1 ,d2 such that ∆d1 ,d2 (x) ≥ 0 for x > x∗d1 ,d2 and ∆d1 ,d2 (x) ≤ 0 for x ≤ x∗d1 ,d2 . That is, if yd1 > yd2 ,
then highest types prefer district d1 to district d2 and lower types have the opposite preference.
The full set of comparisons of district d to other districts in town t yields a single lower bound and
a single upper bound on the set of types who choose district d. These bounds may trim the top
and bottom of the interval of types who prefer district d to all outside option beyond town t, but
will still yield an interval of types for whom district d in town t is the optimal choice.

    The construction in Proposition 1 only guarantees a competitive market price in one district
in town t. To ease comparisons between neighborhood and school choice rules, we will focus on
a particular class of neighborhood equilibrium, where the equilibrium prices in each district are
in fact equal to the competitive market prices based on the equilibrium school qualities in each
district in town t.

Definition 2 A market pricing neighborhood school equilibrium with D districts, [x0 =
0, x1 ], [x1 , x2 ), ... [xD−1 , xD = 1), is a neighborhood school equilibrium where the price for district
d is the equal to the outside market price p(yd ) where yd = E[x|xd−1 ≤ x ≤ xd ].



Proposition 2 For each D, there is a cutoff θD such that there is a market pricing neighborhood
school equilibrium with D intervals for θ ≥ θD .

    We use the market pricing neighborhood school equilibrium for comparison to a school choice
equilibrium in much of the analysis in the remainder of this section.


2.3    School Choice

For a school choice rule, there is a lottery that assigns students to schools. We assume that there
are no informational or logistical frictions in the lottery, so that all families in the district apply


                                                        11
and submit identical rank order lists of schools in order of descending anticipated quality. Thus, in
a rational expectations equilibrium with a school choice rule in town t, all schools in town t must
have equal quality levels and all houses in town t have the same price.

Definition 3 A school choice equilibrium in town t consists of a price pSC and a set of partisan
types TSC with measure mSC and average type ySC = E[x|x ∈ TSC ] live in town t with

 (1) v(x, ySC ) + θ − pSC ≥ π(x) for each x ∈ TSC ,

 (2) v(x, ySC ) + θ − pSC ≤ π(x) for each x 6∈ TSC ,

 (3) pSC ≥ p(ySC ) with pSC = p(ySC ) if mSC < Mt .

       Condition (1) requires types in TSC to prefer town t to any outside district. Similarly, Condition
(2) requires that other types prefer an outside district over town t. If mSC = Mt , then partisans
fill all available housing in town t, and so in this case, Condition (3) requires pSC ≥ p(ySC ) to
discourage non-partisans from choosing to live in town t. But if mSC < Mt then partisan demand
is not sufficient to exhaust the supply of houses in town t, so the remaining houses in town t must
be filled by non-partisans of type x = ySC , which in turn implies the second version of Condition
(3): pSC = p(ySC ).9
       As with the neighborhood school equilibrium definition, the first two conditions of the school
choice equilibrium definition are individual rationality conditions. Condition (3) is a housing market
clearing condition requiring that the partisan demand for housing is no greater than the supply of
housing. Unlike the neighborhood school equilibrium definition, the school choice equilibrium does
not have a incentive compatibility-like condition because there is only one schooling option in town
t in this case.


Proposition 3 In any school choice equilibrium, the set of types TSC is an interval [xSC , x̄SC ].
                                                                                    ¯
Moreover, there is a school choice equilibrium for each θ > 0.

Proof. We prove the first part of the proposition here, leaving the second part for the appendix. In
a school choice equilibrium, partisan students of type x will choose town t if G(x,ySC , p(ySC )) ≥ 0.
   9
       Here, we assume that there is at least measure Mt of families of each type x who would be willing to move to
town t if they can achieve utility greater than π(x) by doing so. In equilibrium with mSC < Mt , these families of
type x = ySC must be exactly indifferent between choosing town t or another school district with quality y = ySC ,
with measure Mt − mSC choosing town t and the rest choosing the outside option.



                                                         12
By Lemma 2, G(x,ySC , p(ySC )) is strictly increasing in x for x < ySC and strictly decreasing in x
for x > ySC . Thus, if there is any type x < ySC such that x ∈ TSC , then the entire interval of
types [x, ySC ] must be in TSC , as G(x,ySC , p(ySC )) ≥ 0 for x < ySC implies G(x0 , ySC , p(ySC )) ≥ 0
for x < x0 < ySC . Similarly, if there is any type x > ySC such that x ∈ TSC , then the entire interval
of types [ySC , x] must be in TSC . Thus, TSC must be an interval.

       A school choice equilibrium is characterized by (xL , xH , θ), where given parameter θ, partisan
types in range [xL , xH ] choose to live in town t and all schools in town t have quality

                                      ySC (xL , xH ) ≡ E[x| xL < x < xH ].

Enrollment is limited under school choice by the willingness of lowest and highest partisan types,
in this case xL and xH , to choose town t rather than outside options at y = xL and y = xH ,
respectively.       For all partisans to enroll in town t under school choice, students of the lowest
possible type x = 0 and the highest possible type x = 1 must choose a town t school with y = E[x]
and price p(E[x]) over the outside option:

                                         v(0, E[x]) − p(E[x]) + θ ≥ π(0),

                                         v(1, E[x]) − p(E[x]) + θ ≥ π(1).

       Given these two conditions, there is a school choice equilibrium where all partisans enroll in
town t if
                        θ ≥ θSC ≡ p(E(x)) + max[π(0) − v(0, E[x]), π(1) − v(1, E[x])].

For lower values of θ, town t is not sufficiently attractive to partisans to induce all of them to enroll
under the school choice rule. By Proposition 3, there is still a school choice equilibrium for each
θ < θSC , where some but not all partisans enroll in town t. Intuitively, when θ < θSC , an increase
in θ increases the appeal of town t for partisans and will tend to expand the range of abilities of
partisan students who choose town t in a school choice equilibrium.


2.4       An Illustrative Example

We provide a detailed example to illustrate the nature of equilibria that result from these two
different assignment rules.

Example 1 Assume that v(x, y) = xy and the distribution of types is Uniform on (0, 1).10
  10
       This function does not meet the formal definition for v because ∂v/∂x = 0 when y = 0 and similarly ∂v/∂y = 0
when x = 0, but this does not affect the analysis.



                                                         13
       We focus on equilibria with an equal number of partisan residents in town t with types above
and below the center of the distribution at x = 1/2.                 Specifically, we compare a school choice
equilibrium where types in a range (1/2 − s, 1/2 + s) enroll in town t to a neighborhood school
equilibrium with two districts where district 1 includes partisans in the range (1/2 − b, 1/2) and
district 2 includes partisans in the range (1/2, 1/2 + b).               Given these enrollment choices and a
uniform distribution of types, ySC = 1/2, y1 = (1 − b)/2, and y2 = (1 + b)/2. Further, with
v(x, y) = xy, p(y) = y 2 /2, so pSC = 1/8, and assuming market pricing, p1 = (1 − b)2 /8 and
p2 = (1 + b)2 /8.
       First, we solve for a school choice equilibrium. In an interior school choice equilibrium with
s < 1/2 and price pSC (1/2) = 1/8 for living in town t, a partisan of type 1/2 − s achieves utility
(1/2 − s)(1/2) − 1/8 + θ in town t and utility (1/2 − s)2 /2 by choosing the outside option. Similarly,
a partisan of type 1/2 + s achieves utility (1/2 + s)1/2 − 1/8 + θ by enrolling in town t and utility
(1/2+s)2 /2 by choosing the outside option. This yields two indifference conditions that characterize
an interior equilibrium: (1/2 − s)(1/2) − 1/8 + θ = (1/2 − s)2 /2 and (1/2 + s)(1/2) − 1/8 + θ =
                                                             √
(1/2 + s)2 /2. These equations have identical solutions: s = 2θ, so for each θ < 1/8, there is an
                                                             √          √
interior equilibrium where partisan types in the range (1/2 − 2θ, 1/2 + 2θ) enroll in town t. If
θ ≥ 1/8, there is an equilibrium where all partisan types choose to live in town t.
       Next, we solve for a neighborhood school equilibrium. A partisan of type (1/2 − b) achieves
utility (1/2−b)(1−b)/2−(1−b)2 /8+θ by enrolling in district 1 in town t and utility (1/2−b)2 /2 by
taking the outside option. Similarly, a partisan of type (1/2+b) achieves utility (1/2+b)(1+b)/2−
(1 + b)2 /8 + θ by enrolling in district 2 in town t and utility (1/2 + b)2 /2 by taking the outside
option.      This yields two more indifference conditions that characterize an interior equilibrium:
(1/2−b)(1−b)/2−(1−b)2 /8+θ = (1/2−b)2 /2 and (1/2+b)(1+b)/2−(1+b)2 /8+θ = (1/2+b)2 /2.
                                            √
These equations have identical solutions b = 8θ.11
   For each θ ≤ 1/32, there is an interior neighborhood school equilibrium where partisan types in
                √                                                                  √
the range (1/2 − 8θ) enroll in one district and partisan types in the range (1/2 + 8θ) enroll in
the other district. If θ ≥ 1/32, there is no interior equilibrium, but there is an equilibrium where
all partisan types enroll in town t, with types from x = 0 to x = 1/2 in district 1 and from x = 1/2
to x = 1 in district 2. Figure 1 depicts the school assignments in this example.
  11
    There are also two indifference conditions for a partisan type at the boundary between these two districts, x = 1/2,
                                                          √
but these conditions also yield the same condition b = 8θ.




                                                          14
   School	  Choice	  
                                                                                                           Town	  t	  
                                        Outside	  Op*on	                                                                                                           Outside	  Op*on	  
                                                                                                           	  ysc=	  ½	  	  
                                                                                                                                                                                                                          Type	  x	  

                                                                     	  ½	  -­‐	  (2θ)½                                                   	  ½	  +	  (2θ)½
                          	  0	                                                                                                                                                                         	  1	  	  



   Neighborhood	  
                                      Outside	                        	  	  	  District	  1	                                         	  	  	  District	  2	                 Outside	  	  
   Assignment	                                                                                                                                                                        Op*on	  
                                      Op*on	                          y1	  =	  ½	  -­‐	  (2θ)½ 	                                     y2	  =	  ½	  +	  (2θ)½ 	  
                                                                                                                                                                                                                          Type	  x	  

                                             	  ½	  -­‐	  (8θ)½                                                                                               	  ½	  +	  (8θ)½
                          	  0	                                                                          	  	  	  	  	  	  	  ½                                                                 	  1	  	  

                                                                                                                                                                              1
                                      Figure 1. Assignments in Example 1 with θ ≤                                                                                            32 .



2.5    Formal Comparisons of Neighborhood Assignment and School Choice

The equilibria in Example 1 highlight the distinction between the school choice and neighborhood
assignment rules. Because the neighborhood assignment rule yields a richer set of schooling options
than the school choice rule in equilibrium, for each given θ < 1/8, a wider range of partisan types
enroll in town t under neighborhood assignment rule than the school choice rule. Proposition 4
formalizes this observation.


Proposition 4             i. The range of partisan types [a, b] enrolling in town t in a school choice equi-
      librium, b − a, tends to 0 as θ → 0.

  ii. For any θ > 0, there is a value D∗ (θ) such that for D > D∗ (θ), there is a neighborhood school
      equilibrium with D districts where partisan types ( d−1  d
                                                           D , D ] enroll in district d in town t.


   With a school choice rule, it is a challenge for town t to attract low-type and high-type partisans
simultaneously when all schools in town t are of the same uniform quality.                                                                                                                  If partisanship is of
considerable importance, then with θ > θSC , it is still possible to attract all partisans to town t
with a school choice rule. However, as θ declines, it becomes more difficult for town t to attract
partisans.     In the limit, as θ becomes vanishingly small, the set of partisans enrolling in town t
also diminishes to a single point, as town t can only attracts partisans with types extremely close
to its school quality ySC .


                                                                                                   15
       By contrast, with a neighborhood school rule, low-type and high-type partisans have the option
to choose differentiated schools in town t. To this end, Proposition 4 shows that for any value of
θ, the town can attract all partisans if it offers a neighborhood assignment rule and a sufficiently
large number of districts.12
       One complication is that an equilibrium with a neighborhood assignment rule introduces a
potentially binding constraint that is not present with a school choice rule. For example, with a
neighborhood assignment rule and two districts, then attracting types [0, x∗ ] to enroll in district
1 and types [x∗ , 1] to enroll in district 2 requires consideration of incentive conditions for types
x ∈ {0, x∗ , 1} whereas for a school choice rule to attract all types [0, 1] to enroll in town t requires
only incentive conditions for types x ∈ {0, 1}. Although it is easier to attract types x = 0 and x = 1
to town t with a neighborhood assignment rule than with a school choice rule, it is possible to create
examples with extremely bimodal distributions of types such that it is sufficiently difficult to attract
middle types to either the low-quality or high-quality school given a two-district neighborhood
assignment scheme that in fact a school choice rule attracts a wider set of partisans to enroll in
town t than does the neighborhood assignment rule for some values of θ. However, these examples
are quite delicate in construction and the result is overturned with a tightening of the distribution
of type or with the introduction of additional districts with the neighborhood assignment rule in
town t. (See Example 3 in Appendix B for details.)


2.6       Welfare Analysis for the One Town Model

The welfare effects of a change from multi-district neighborhood assignment to a school choice
rule can be identified directly from a comparison of the equilibrium menus of school quality given
those two different rules. To simplify exposition, we assume a market pricing equilibrium under
neighborhood assignment for most of the discussion that follows.

Proposition 5 Suppose that the equilibrium school quality levels in a market pricing D-district
neighborhood school equilibrium in town t are y1∗ < y2∗ < ... < yD
                                                                 ∗ and that the equilibrium school

                                                           ∗
quality level in a school choice equilibrium in town t is ySC and that y1∗ < ySC
                                                                              ∗ < y ∗ . Then there
                                                                                   D

exist values xL and xH such that partisan students with types in the interval (xL , xH ) strictly prefer
the school choice equilibrium to the neighborhood assignment equilibrium, but all other partisan types
  12
       Though outside of the model, the number of districts is presumably dictated by administrative costs and scale
economies. These issues are related to research on optimal choice of municipal boundaries (e.g. Alesina, Baqir and
Hoxby (2004) and Alesina and Spolaore (2003)).



                                                          16
of students (weakly) prefer the neighborhood assignment equilibrium to the school choice equilibrium.

Proof. Since y1∗ < ySC
                    ∗     ∗ , there exists d such that y ∗ ≤ y ∗
                       < yD                             d
                                                                    ∗
                                                              SC ≤ yd+1 . For a student of type
     ∗ , the difference in utility from district d in the neighborhood equilibrium and town t in the
x ≤ ySC
school choice equilibrium is:
                                                               Z      ∗
                                                                   z=ySC
                                           ∗         ∗                         ∂v          ∂v
             [v(x, yd ) − p(yd )] − [v(x, ySC ) − p(ySC )] =               [      (x, z) −    (z, z)]dz.         (1)
                                                               z=yd            ∂y          ∂y
                                                            ∗ , the integrand is always positive.
At x = yd , the integrand is always negative, while at x = ySC
                ∂v
Furthermore,    ∂y   is (continuous and) strictly increasing in x for x < z, so this difference is strictly
increasing in x. Thus, the integral is strictly increasing in x and there must be a single value
x̄L ∈ [xd , xSC ] such that equation (1) is zero.
    Types with x < x̄L prefer school quality yd to ySC while types with x > x̄L prefer school
quality ySC to yd at market prices. A similar argument shows that there exists another value
                                                                            ∗
x̄H ∈ [xSC , xd+1 ] so that types with x > x̄H prefer school quality yd to ySC while types with
                                     ∗ at market prices. By construction, types at either extreme:
x < x̄H prefer school quality yd to ySC
x < x̄L or x > x̄H gain higher utility in the neighborhood assignment equilibrium than in the school
choice equilibrium. Also by construction, students with types between xL and xH prefer ySC to
pd and pd+1 at market prices. Since yd < xL < xH < yd+1 , types with xL ≤ x ≤ xH prefer yd to
any school of lower quality and also prefer yd+1 to any school of higher quality at market prices.
Combining these observations, students with types between xL and xH gain higher utility in the
school choice equilibrium than in the neighborhood assignment equilibrium.

    Given the assumption of competitive outside options and market pricing for the school qualities
available in town t, the utility of attending a particular school is decreasing in the distance between
a student’s type and the quality level of that school. Intuitively, only those types closest to ySC do
better under school choice, while more extreme types do better with the neighborhood assignment
rule. Further, this qualitative result holds regardless of where ySC falls in relation to (y1∗ , y2∗ , ..., yD
                                                                                                             ∗)


or which of the two assignment rules attracts a wider range of partisan types to locate in town
t, though one caveat is that the lowest and highest types may choose the outside option under
both assignment rules (as in the equilibria depicted in Figure 1), in which case, they are indifferent
between these rules.
                                                                                      1
    Table 1 presents welfare comparisons for Example 1 with θ =                       18 ,   In this case, partisans
of types [0, 12 ] enroll in district 1, while partisans of types [ 12 , 1] enroll in district 2 in a two-
district neighborhood assignment equilibrium, while partisans of types [ 61 , 56 ] enroll in town t, while


                                                      17
                                 1             5
partisans of types x <           6   and x >   6   choose the outside option in a school choice equilibrium. Thus,
partisans are offered a menu of options {(y1 = 14 , p1 =                 1
                                                                         32 ), (y2   = 43 , p2 =   9
                                                                                                   32 )}   under a neighborhood
assignment rule in town t as opposed to (ySC = 12 , pSC = 18 ) Then, partisans of types [0, 12 ] and
[ 12 , 1] enroll in districts 1 and 2 with neighborhood assignment, while partisans of types [ 16 , 56 ] enroll
in town t (while other partisans choose the outside option) under school choice. As a result, types
               3            5                                                                                             3         5
with x <       8   or x >   8   strictly prefer the neighborhood equilibrium, whereas types with                          8   <x<   8

strictly prefer the school choice equilibrium.


                           NBHD Eqm.               SC Eqm.      NBHD Eqm.               SC Eqm.                 Student
            Type x              School              School          Utility              Utility                Prefers
              [0, 16 ]          y1 =   1
                                       4       Outside Opt.         x
                                                                    4    +    7
                                                                             288          x2 /2            Neighborhood
             [ 61 , 38 ]        y1 =   1
                                       4           ySC =   1
                                                           2
                                                                    x
                                                                    4    +    7
                                                                             288
                                                                                          x
                                                                                          2   −   5
                                                                                                  72       Neighborhood
             [ 38 , 12 ]        y1 =   1
                                       4           ySC =   1
                                                           2
                                                                    x
                                                                    4    +    7
                                                                             288
                                                                                          x
                                                                                          2   −   5
                                                                                                  72       School Choice
             [ 21 , 58 ]        y2 =   3
                                       4           ySC =   1
                                                           2
                                                                    3x
                                                                     4   −   65
                                                                             288
                                                                                          x
                                                                                          2   −   5
                                                                                                  72       School Choice
             [ 85 , 56 ]        y2 =   3
                                       4           ySC =   1
                                                           2
                                                                    3x
                                                                     4   −   65
                                                                             288
                                                                                          x
                                                                                          2   −   5
                                                                                                  72       Neighborhood
              [ 56 , 1]         y2 =   3
                                       4       Outside Opt.         3x
                                                                     4   −   65
                                                                             288          x2 /2            Neighborhood
                                                                                                           1
                            Table 1. Welfare Comparison for Example 1 when θ =                             18
                                     (NBHD means neighborhood and SC means school choice)




Corollary 1 If there is a neighborhood school equilibrium where all partisan types choose to live
in town t and an associated school choice equilibrium with y1∗ < ySC
                                                                  ∗ , then there is a range of types

          ∗
with x < ySC who attend a higher quality school in a school choice equilibrium, but who achieve
greater utility net of housing costs in a neighborhood assignment equilibrium.13


       Corollary 1 to Proposition 5 identifies an especially interesting group of student types, for whom
the effects of a switch from neighborhood to school choice are arguably ambiguous. Rather than
base welfare comparisons on realized utility values, advocates of school choice might still make a
paternalistic argument that it is always beneficial to reduce the difference between schools attended
by high and low types, and especially to increase the quality of schools attended by low types. For
  13
       The assumption that all partisan types choose town t in the neighborhood equilibrium rules out the possibilities
that types near x̄L (the value derived in the proof of Proposition 5) choose the outside option under both assignment
rules.




                                                               18
                                           1
instance, in Example 1 with θ =            18 ,   partisans with types between 1/6 and 3/8 achieve lower utility
                                                                                                   1
under the neighborhood school rule, but attend a higher quality school (ySC =                      2   instead of y1 = 14 )
under the school choice rule. However, this argument does not always apply to partisans with the
                                                      1                                 1
lowest types. In Example 1 with θ =                   18   , partisans with types x <   6   choose district 1 in town t
with neighborhood assignment, but switch to the outside option with school choice, so they both
achieve higher utility and attend a higher quality school under neighborhood assignment than with
school choice.


2.7       Aggregate Welfare

Given the assumption that v(x, y) satisfies increasing differences in (x, y), assortative matching
maximizes the average (realized) value of v(x, y). A change from neighborhood assignment to
school choice eliminates sorting of types into ordered intervals and thus represents a step away
from assortative matching. Combining these observations, if all partisans enroll in town t under
either assignment rule, neighborhood assignment should produce greater average values of v(x, y)
than a school choice rule. For instance, in Example 1, when all partisans enroll in town t under
neighborhood assignment with two districts, then district 1 includes types 0 < x < 21 , while district
                       1                          1
2 includes types       2   < x < 1, so y1 =       4   and y2 = 34 . In this case, the average value of v(x, y) is 1/16
in district 1 and 9/16 in district 2, for an overall average of 5/16. By contrast, with school choice,
           1
ySC =      2   and so the average value of v(x, y) is 1/2 ∗ 1/2 = 1/4.14
       The apparent advantage of neighborhood assignment over school choice (in terms of aggregate
utility) as a result of assortative matching can be overturned if not all partisans choose to live in
town t. Example 3 in the Technical Appendix illustrates a case where the existence of the outside
option makes high and low types effectively indifferent between the school choice and neighborhood
assignment rules. Since middle types prefer the school choice rule, aggregate utility is higher under
school choice than the neighborhood assignment rule.
  14
       One complication with this comparison is that the average housing price in town t may differ across the two
                                  1
assignment rules. With ySC =      2
                                      and v(x, y) = xy, the housing price in town t under school choice is 1/8. However,
with neighborhood assignment, y1 = 41 , and y2 = 34 , the housing prices are p1 = 1/32 and p2 = 9/32, for an average
price of 5/32. That is, both the average value of v(x, y) and the average housing price are greater with neighborhood
assignment than with school choice, but the net utility remains greater with neighborhood assignment than with
school choice.




                                                                 19
3     The Two Town Model

3.1     Setup

We now alter the analysis to consider a general equilibrium version of the model with two towns, A
and B, an equal number of partisans to attached each town, and a restriction that each family must
choose a house in either town A or town B, so that outside options are determined endogenously in
equilibrium. One primary goal of this extension is to verify that the results of the one town model
are not an artifact of our partial equilibrium assumptions in that model. As before, we assume
that the utility function for each family is given by

                                        u(xi , yj , pj ) = θij + v(xi , yj ) − pj ,

where θij = θ > 0 if family i is partisan to town t and school j is in town t, and θij = 0 if family i is
partisan to town t and school j is not in town t. We assume that there are m1 = m2 = m partisan
families for each town and that partisans of both types have identical distributions for student type
f (x) on [0, 1] and maintain all other properties assumed for f and v from the one town model.
    Each town has D districts, which we label as A1 , A2 , ..., AD for town A and B1 , B2 , ..., BD
for town B, where m(Ad ) = m(Bd ) = md > 0 for each d, and D
                                                                  P               PD
                                                                     d=1 m(Ad ) =  d=1 m(Bd ) =

m, where districts are ordered in ascending school quality: yt1 ≤ yt2 ≤ . . . ≤ ytD for each
town t.      We denote the sets of town-A and town-B partisans choosing district d in town t
as αtd and βtd respectively and denote an assignment of partisans of town A to districts by
α = {αA1 , αA2 , ..., αAD , αB1 , αB2 , ..., αBD } and an assignment of partisans of town B to districts
by β = {βA1 , βA2 , ..., βAD , βB1 , βB2 , ..., βBD }.

Definition 4 A two-town general equilibrium consists of an allocation of families to schools
α, β, associated average abilities in each district {yA1 , yA2 , ..., yAD , yB1 , yB2 , ..., yBD } and
prices (pA1 , pA2 , ..., pAD , pB1 , pB2 , ..., pBD ) where

    1) Each student maximizes utility u(xi , yd , pd ) with the choice of school district d,

    2) Each district d enrolls md students,

    3) If Town t uses a school choice rule, then yt1 = yt2 = ... = ytD = E[x| enroll in town t] for
       t ∈ {A, B}.

Definition 5 In a no mixing equilibrium, all partisans of town A live in town A and all parti-
sans of town B live in town B.


                                                              20
Proposition 6 If both towns use the same assignment rule, then there is a symmetric no mixing
equilibrium with cutoffs {x0 = 0, x1 , x2 , ..., xD−1 , xD = 1}, where students of type x ∈ [xd−1 , xd ]
enroll in district d of their partisan town.

       This is immediate whether both towns use neighborhood assignment or school choice. Either
way, the options and prices for schooling in two towns are identical, so clearly partisans of town
A will choose to live in town A and partisans of town B will choose to live in town B. With a
neighborhood schooling rule in both towns, (1) the type cutoffs are determined by the capacities in
each district and the implicit equation F (xd ) = dj=1 mj , (2) the school qualities are determined
                                                 P

by conditional expectation rules yAd = yBd = yd = E[x|xd−1 < x < xd ], and (3) price increments
between districts are determined by indifference conditions

                                       pd − pd−1 = v(xd , yd ) − v(xd , yd−1 )

for districts d = 2, ..., D in towns A and B. Then by construction, given the property of increasing
differences of v in x and y, any choice of price for district 1, pA1 = pB1 = p1 will induce the precise
sorting of students to districts as stated in the proposition. The resulting symmetric no mixing
equilibrium is stable for either assignment rule if θ is strictly greater than 0, in the sense that a
small change in locational choices will not provide sufficient incentive to induce any partisan to
switch towns at the cost of θ.15
       We use the no mixing equilibrium with neighborhood school assignment in each town as the
baseline outcome for comparisons to the results when one town adopts school choice primarily
because it is the unique symmetric equilibrium when both towns use neighborhood assignment
rules and all districts are the same size.16 Further, there is perfect sorting of partisans within each
town in this no mixing neighborhood school equilibrium, so the adoption of a school choice rule
necessarily reduces inequalities in school assignment if families are not allowed to move.
       Now suppose that town A uses the school choice rule and town B uses a neighborhood assignment
rule. To simplify notation, we denote the equilibrium school quality for each district in town A as
  15
       There may also be equilibria other than the no mixing outcome when both towns use the same school assignment
rule. For example, if both towns use a school choice rule, there could be an equilibrium where one town has higher
school quality than the other and town-A partisans and town-B partisans of highest types both choose the higher
quality school. One complication is that if town A has the higher quality school in this case, then partisans of town
B must forego θ to attend that school, while partisans of town A gain θ by choosing it, so any equilibrium other than
the no mixing equilibrium involves asymmetric decision rules for partisans of town A and partisans of town B.
  16
     When districts are heterogenous in size, then every ordering of district sizes from highest ability to lowest ability
will produce a different symmetric equilibrium.



                                                           21
yA and the equilibrium price for each district in town A as pA , since these qualities and prices must
be identical given a school choice assignment rule in A. We denote the equilibrium school qualities
and prices in town B by yd and pd for d ∈ {1, 2, ..., D}.
       We focus on equilibria where town A has neither the highest nor the lowest school quality:
y1 < yA < yD for several reasons.17 First, the explicit motivation for school choice is essentially
egalitarian - to offer residents of all types the opportunity to attend the same school - and thereby
suggests an equilibrium where yA is close to E[x]. Second, if we modeled a dynamic adjustment
process from a symmetric no mixing equilibrium where both towns use neighborhood assignment
rules to a new equilibrium where A offers school choice and B offers a neighborhood assignment
rule, that process would start with town A having middling school quality. Initially, then lowest
types partisans of town A would be attracted to district 1 in town B, highest type partisans of
town A would be attracted to district D in town B and middle type partisans of town B would be
attracted to town A. Thus, incremental movements of partisans in response to town A’s adoption of
school choice would cause y1 and yD to become more extreme, and so would maintain the original
ordering y1 < yA < yD . Third, for the purpose of welfare comparisons, it is natural to select a
mixing equilibrium that maintains average school quality in each town as much as possible from
the symmetric no mixing equilibrium when both towns use a neighborhood assignment rule.

Proposition 7 In any equilibrium where town A uses school choice and town B uses neighborhood
assignment, an interval [xL    H                                             L    H
                          A , xA ] for partisans of town A and an interval [xB , xB ] of partisans of

town B enroll in town A, where xL    L    H    H 18
                                A ≤ xB ≤ xB ≤ xA .


Proof. Suppose that a partisan of town B of type xh enrolls in district d in town B where yd > yA .
Then since this student prefers district d in town B to enrolling in town A,

                                       v(xh , yd ) + θ − pd ≥ v(xh , yA ) − pA ,
  17
       There may be multiple mixing equilibria for a given set of parameters when town A uses school choice and town
B uses a neighborhood assignment rule. For example, if each town has two equal-size districts, then there would
typically be three mixing equilibria, one where town A has lowest school quality (yA < y1 < y2 ), one where town
A has middle school quality (y1 < yA < y2 ) and one where town A has highest school quality (y1 < y2 < yA ).
Intuitively, a mixing equilibrium requires some coordination in the locational choices of families, thereby allowing for
multiplicity of equilibrium depending on (self-confirming) conjectures about the relative qualities of schools across
towns and districts.
  18
     In a no mixing equilibrium, since all town-A partisans and no town-B partisans enroll in town A, xL
                                                                                                       A = 0 and

xH                            L    H                                                   L    H
 A = 1. In this case, we set xB = xB = ySC and the result holds. It is natural to set xB = xB = ySC because the

first town-B partisans to enroll in town A will be those of types nearest to ySC .



                                                          22
or equivalently,
                                        θ ≥ pd − pA + v(xh , yd ) − v(xh , yA ).

By the property of increasing differences of v, the difference v(x, yd ) − v(x, yA ) is strictly increasing
in x given yd > yA , so any partisan of town B with x0 > xh strictly prefers district d in town B
to enrolling in town A and will not enroll in town A. By similar reasoning, if type xl enrolls in
a district in town B with school quality less than yA , then town-B partisans of type x00 < xl also
will not enroll in town A. Thus, the set of partisans of town B who enroll in town A must be an
interval of types [xL    H
                    B , xB ]. An essentially identical argument extends this result to show that the

set of partisans of town A who enroll in town A is an interval of types [xL    H
                                                                          A , xA ].

       Since partisans of town A receive a bonus for enrolling in town A, while partisans of town B
receive a bonus for enrolling in town B, if a town B partisan of type x enrolls in town A, then a
town A partisan of type x will also enroll in town A in equilibrium. This shows that xL     L
                                                                                      A ≤ x B ≤ yA ,

xH    H                                  L
 A ≥ xB . A town B partisan of type x < xA enrolls in a school in town B, so v(x, yd ) + θ − pd

≥ v(x, yA ) − pA for some district d in town B. We can rewrite this inequality as

                                          v(x, yd ) − v(x, yA ) ≥ pd − pA − θ.

But if yd ≥ yA , then this inequality would hold for all types greater than x (by the property of
increasing differences for v), and so none of them would enroll in town B.19                       Thus, partisans of
town B with types below xA
                         L enroll in districts in town B with qualities less than yA . By a similar

argument, partisans of town B with types above xL
                                                A enroll in districts in town B with qualities

greater than yA , with analogous properties holding for partisans of town A.

       Proposition 7 indicates that when town A adopts school choice, partisan enrollment takes the
form of intervals in each district. Further, the range of types of partisans of town A enrolling
in town A subsumes the range of types of partisans of town B who enroll in town A. Given our
restriction that y1 < yA < yD , Proposition 7 indicates that middle types enroll in town A while
types at both extremes, high and low, enroll in town B.

Proposition 8 Suppose there are two districts in each town, that A adopts school choice and B
uses a neighborhood assignment rule. Then there exists a value θN M such that there is a no mixing
equilibrium iff θ ≥ θN M and there is a mixing equilibrium for each θ < θN M .
  19
       We assume that partisans of town B enroll in town B in case of a tie in utility between the most preferred district
in town B and the most preferred district in town A.




                                                            23
   Our proof of Proposition 8 relies on a fixed point argument specific to the case of two districts
in town B. Intuitively, if θ < θN M , then there are incentives for highest and/or lowest type partisan
of town A to trade places with marginal type partisans of town B. But as trades of these sorts occur
in equilibrium, then the identities of marginal type families change and specifically the marginal
low-type partisan of town A increases, when the marginal low-type partisan of town B decreases.
Thus, for each θ with 0 < θ < θN M , there must be a critical point (with xL    L
                                                                           A < xB and associated

values for xH      H                                                L    L
            A and xB ) where the pair of values of marginal types (xA , xB ) yields exactly equal

utility gains (excluding prices) for each of these two marginal types to choose town A rather than
district 1 in town B, thereby producing a mixing equilibrium.

Corollary 2 In a mixing equilibrium where town A uses school choice and town B uses neighbor-
hood assignment and 0 < xL    H
                         A < xA < 1, lowest-type partisans of each town enroll in schools with

lower qualities and highest-type partisans of each town enroll in schools with higher qualities than
they would in a no mixing equilibrium.

   Corollary 2 follows from the observation that any type-x student will choose the same district
within town B whether that student is partisan to town A or to town B. When xL       H
                                                                             A > 0, xA <

1, highest and lowest type students (regardless of partisanship) enroll in Town B in a mixing
equilibrium.   Since partisans of each town with x close to 0 enroll in district 1 in town B while
partisans of each town with x close to 1 enroll in district D in town B, the quality of these districts
must be spread farther than in the no mixing equilibrium. Thus, if θ < θN M , the choice by town
A to adopt a school choice rule only increases inequality of educational opportunities (as measured
by the spread between the highest and lowest quality schools chosen by partisans of town A.)

Example 2 Suppose that the distribution of types is Uniform on (0, 1) for partisans of each town,
that the utility function is u(x, y) = xy, and that there are two districts of equal size in each town.

   In a no mixing equilibrium, town-B partisans are partitioned into districts with types [0, 1/2] in
district 1 and types [1/2, 1] in district 2 so that y1 = 1/4 and y2 = 3/4, while all town-A partisans
choose town A so that yA = 1/2. We work backwards from the equilibrium conditions to identify
equilibrium prices and subsequently restrictions on θ for a no mixing equilibrium. A marginal
town-B partisan at x = 1/2 must be indifferent between districts 1 and 2. Thus,

                                         1           1
                                           y1 − p 1 = y2 − p 2 ,
                                         2           2


                                                   24
or equivalently p2 − p1 = 1/4.
   Given p2 − p1 = 1/4, partisans of either town with x < 1/2 prefer district 1 to 2 in town B. The
incentive condition for partisans of town A with x < 1/2 to choose A is x/2 + θ − pA ≥ x/4 − p1 ,
or θ ≥ pA − p1 at x = 0 where the condition is most binding. Similarly, the incentive condition for
partisans of town B with x < 1/2 to choose 1 is x/4 + θ − p1 ≥ x/2 − pA , or θ ≥ 1/8 − pA + p1
at x = 1/2 where the condition is most binding. Thus, θ = θN M = 1/16 is the smallest value for
which both conditions hold jointly and they so when pA − p1 = 1/16. (A similar approach shows
that the incentive conditions for partisans with types x > 1/2 also hold simultaneously at θ = 1/16
when p2 − pA = 3/16).
   For values of θ < 1/16 = θN M , we simplify computations by looking for a mixing equilibrium
with symmetric cutoffs xL      H        L
                        A and xA = 1 − xA . Given the constraints that 1/4 of all students must
                                                                                                           1
enroll in each district in town B (and half of all students must enroll in town A), xL
                                                                                     B =                   2   − xL
                                                                                                                  A and
                  1
xH          H
 B = 3/2 − xA =   2   + xL                                    H        L
                         A . Thus, under the assumption that xA = 1 − xA , equilibrium assignments

can be described as a function of xL                                    L    L
                                   A alone. Further, by Proposition 7, xB ≥ xA , which implies that

xL
 A must be less than or equal to 1/4.




 No Mixing                                   District 1                          District 2
 Neighborhood                                y1 = 0.25                           y2 = 0.75
 Rule
                                                                                                                    Type x

                                                                 ½
                      0                                                                                         1


                          Town B                          Town A School Choice                Town B
 Mixing                   District 1                             yA = ½                       District 2
 Equilibrium              y1 = 0.13                                                           y2 = 0.87
 School Choice
                                                                                                                    Type x

                                       0.2                                             0.8
                      0                                                                                        1



               Figure 2. School Assignments for Town-A Partisans in Example 2

   We provide detailed computations in the Technical Appendix to show that there is a unique
equilibrium of this form for each value θ < θN M , and further that xL
                                                                     A is decreasing in θ, so that



                                                            25
fewer partisans of town A choose to live in town B as θ increases.                       For the particular value
θ = 37/2000, the equilibrium cutoffs are given by xL         H         L             H
                                                   A = 0.2, xA = 0.8, xB = 0.3, and xB = 0.7,

with corresponding school qualities y1 = 13/100, yA = 1/2, and y2 = 87/100.                         Thus, as shown
in Figure 2, partisans of each town with types x < 0.2 attend schools with quality y = 1/4 when
both towns use a neighborhood assignment rule and attend a school with quality y = 13/100 when
town A switches to school choice.            Similarly, partisans of each town with types x > 0.8 attend
schools with quality y = 3/4 when both towns use a neighborhood assignment rule and attend a
school with quality y = 87/100 when town A switches to school choice. Thus, consistent with the
Corollary above, lowest and highest type students move to schools with more extreme quality levels
as a result of town A’s adoption of school choice.

Proposition 9 As θ → 0, the intervals of types of partisans of each town who enroll in town A,
(xL    H                                 L    H                                           L    L
  A , xA ) for partisans of town A and (xB , xB ) for partisans of town B must converge: xB − xA → 0

and xH    H
     A − xB → 0.


       When θ → 0 in the One Town Model, partisan enrollment in town t is restricted to a small
range of types just above and below yA , and then almost all of the houses in town A are occupied
by non-partisans. By contrast, partisans of town A occupy at least half of the houses in town A in
every equilibrium in the Two Town Model; if a partisan of town B with type x chooses town A in
equilibrium, then a partisan of town A with that same type x will also choose to live in town A.
Proposition 9 shows that as θ → 0, essentially equal numbers of partisans of A and B live in town
B, so in this limit, students are sorted almost entirely by type x rather than partisanship.20


3.2       Welfare Analysis for the Two Town Model

Welfare analysis in the two town model is complicated by the fact that outside options are generated
endogenously rather than fixed exogenously.              In the one town model, when a student enrolls in
town t in equilibrium 1 but takes the outside option in equilibrium 2, then by revealed preference,
that student must prefer equilibrium 1 since the same outside option is available in both cases.
However, this is not the case in the two town model, for a change from neighborhood assignment
  20
       Epple and Romano sketch an example in the conclusion (p. 273-274) of their 2003 paper that can be interpreted
to be a version of our two-town model with θ = 0. Since families have no partisan connection to either town, any
stable equilibrium results in complete one-dimensional sorting, with lowest types attending the worst school in the
two towns. In this context, a switch from neighborhood assignment to school choice in one town can still affect the
size, and thus the quality of this worst school, and so can either increase or reduce the welfare of these lowest types.



                                                          26
to school choice in town A, likely improves outside options in town B for some town-A partisans
but degrades them for others. Further, there is an additional degree of freedom in pricing in each
equilibrium in the two town model than in the one town model since none of the prices have to
be pegged to the competitive benchmark. So, to facilitate comparisons in the analysis below, we
assume that prices are approximately equal to the competitive price function p(y) from the One
Town Model in the equilibria that we want to compare.
   For the highest values of θ, there is a no mixing equilibrium whether or not town A adopts
school choice.   Then lowest-type partisans of town A attend a school with higher quality under
school choice than with the neighborhood assignment rule, but achieve lower utility with school
choice because that school is farther away from their ideal point. As in the One Town Model, a
paternalist might argue that this is still a success for school choice because it eliminates educational
inequalities by ensuring that partisans of town A all attend a school of the same quality.
   For θ < θN M , there is a mixing equilibrium where only partisans of town A with types in
the interval (xA    A
               L , xH ) enroll in town A and the remaining partisans of town A choose to live in

town B. Assuming that there is mixing at both top and bottom of the type distribution (i.e.
xA       A
 L > 0, xH < 1), then town A’s adoption of school choice increases rather than reduces educational

inequalities: in the resulting equilibrium, highest-type partisans of town A attend yet higher quality
schools while lowest-types partisans of town A attend yet lower quality schools than in a no-mixing
neighborhood equilibrium. In this case, we can use revealed preference to provide a limited set of
welfare rankings for the two systems for partisans of town A.
   To illustrate this point, we assume that there are two districts in town B and that xL
                                                                                        A < yLN

(where yLN is the school quality in district 1 in a no-mixing equilibrium with the neighborhood
assignment rule) as shown in Figure 3(a). Since xL
                                                 A < yLN , this student attends a school with

quality above her type in a no mixing neighborhood equilibrium. Then, (absent unusual pricing
effects across the equilibria), this student prefers a school with quality yLN to a school with quality
y A > yLN , where a school of quality y A is her only option in town A in equilibrium after A adopts
school choice. By construction, since this student is at the margin between x = xL
                                                                                 A , she is indifferent

between town A and district 1 in town B after town A adopts school choice. Combining these
observations, this student strictly prefers her outcome in the no mixing neighborhood assignment
equilibrium to her outcome in the mixing equilibrium when A adopts school choice.
   Second, if xA
               L > yLN , as shown in Figure 3(b), the marginal low type partisan of town A attends a

school with quality below her type in a no mixing neighborhood equilibrium. But since Proposition



                                                  27
7 indicates that quality declines in the district with lowest quality school in town B once A adopts
school choice, then with competitive market prices, this student prefers her school assignment in
the no mixing neighborhood equilibrium to district 1 in town B in the mixing equilibrium when A
adopts school choice. But since she is at the enrollment margin between the two towns, she must be
indifferent between enrolling in town A and in district 1 in town B in the mixing equilibrium, and
so once again, this student strictly prefers her outcome in the no mixing neighborhood assignment
equilibrium to her outcome in the school choice mixing equilibrium
   That is, town-A partisan types near the lower cutoff for enrollment in town B after A adopts
school choice tend to prefer the no mixing outcome (when both towns use neighborhood assignment)
to the mixing outcome (when the towns use different assignment rules). On the other hand, town-
A partisan types close to the school quality that results in town-A in a mixing equilibrium when
A offers school choice tend to prefer the school choice rule, as it yields a school in town A that is
close to their most desired (price-adjusted) quality. However, these arguments only apply locally
in the two town case and do not necessarily extend beyond a small set of types, at least not without
further knowledge of the details of the utility function and type distribution.


 No Mixing                             District 1                                 District 2
 Neighborhood                             y=yLN                                     y=yHN
 Rule
                                                                                                                   Type x
                                              yLN
                                                                 x1
                   0                                                                                           1


                         Town B                               Town A                              Town B
 (A)                     District 1                        School Choice                          District 2


                                                                                                                   Type x

                                       x LA                                        x HA
                   0                                                                                           1

                          Town B
                                                              Town A                 Town B
 (B)                      District 1
                                                           School Choice             District 2
                                                                                                                    Type x


                   0                                x LA                   x HA                                1

    Figure 3. School Assignments and Welfare Comparisons for Two Town Model, θ < θN M


                                                            28
4     Discussion

4.1   Empirical Implications

A similar theme of the equilibrium results for the One and Two Town models is that it is difficult to
ensure by fiat that low-type students enroll at quality schools. Even though the adoption of a school
choice rule increases the quality of the worst school in town A, low-type partisans of town A do not
get to enjoy the benefits of that change because they typically leave the town (semi-voluntarily) in
the new equilibrium. One mechanical difference between the One Town and Two Town models is
that at least half of town-A partisans must enroll in town A in the Two Town model, whereas it is
possible for all partisans to choose the outside option in the One Town Model. With this caveat,
Propositions 4 and 9 produce results that are essentially identical in spirit: in either model, as the
value of partisanship, θ, becomes small, the minimal number of town-A partisans enroll in town A
in equilibrium.    Hence, the two models imply that simply that adopting school choice promotes
flight of both highest and lowest types enrolling in the town under neighborhood schools.          By
design (and by assumption in our model), school choice dramatically reduces the range of school
qualities available in a town in equilibrium. Since housing prices are a function of school quality
in both models, this produces a second empirical prediction, which is that the adoption of a school
choice rule reduces the variation in housing prices in a town.
    In the Two Town Model, the highest types of town-A partisans enroll in districts in town B in
a school choice equilibrium (with θ < θN M ). This increases the range of school qualities in town B
from a no mixing equilibrium as well as the range of housing prices in town B. That is, when town
A adopts school choice, the influx of highest and lowest type partisans of town A into the schools in
town B causes even greater segregation of highest and lowest types in town B, thereby improving
the highest quality schools while reducing the quality of the lowest quality schools in town B. So
these results yield another comparative static prediction, namely that both the highest and lowest
housing prices become more extreme in neighboring towns when one town adopts a school choice
assignment rule.


4.2   Extensions

One of our primary goals in this paper was to develop a tractable and transparent model that
links school assignment rules and residential sorting patterns. For this reason, we have excluded a
number of factors by design that would otherwise have been natural to include in the model. We


                                                 29
now discuss briefly the implications for several of these factors in the context of our simpler model.
   First, we assume that the only relevant characteristic of a house is the quality of the school
associated with that house. If, in addition, houses have additional inherent qualities that can be
ranked, then in equilibrium under either a neighborhood assignment rule, we would expect sorting
by type according to the underlying quality of the houses in each district with highest types locating
in the district with the nicest houses and lowest types in the district with the least attractive houses.
However, we would still expect to see a reduction in housing price dispersion after a switch from
neighborhood assignment to a school choice rule, which (depending partly on the nature of outside
options) would likely result in the same qualitative patterns of flight as in the existing model, with
both highest and lowest types moving to other towns under a school choice rule.
   Second, we assume that the school choice process necessarily equalizes the qualities of all schools
in the town. But differences in school quality could persist if there are frictions in the school choice
process, either in the form of residential priorities, transportation costs, or behavioral responses
by students in submitting their rankings to a school choice lottery. Alternately, if school quality
is determined (at least partly) by exogenously fixed factors and not just by peer effects, then
differences in school quality would result with or without frictions in the school choice process.
   With persistent differences in school quality under a school choice rule, some high types might
plan to enroll in town t if assigned to a top quality school, but to move (or choose private school) if
assigned to a less desirable school. Adoption of this strategy by high types would likely yield sys-
tematic demographic differences in enrollment across schools, undoing to some degree the purpose
of the school choice rule. Relatedly, Epple and Romano (2003) consider how a fixed transportation
cost associated with exercising choice affects school access. They show that with this friction, a
school choice rule can cause a decline in the quality of the worst school in town, as relatively high
income students in that neighborhood will exercise choice, but the transportation cost discourages
students from the lowest-income households from attending higher-quality choice schools.
   Third, if housing prices are sticky and/or low-type families are immobile in their residential
choices, then a school choice rule could, in fact, equalize the quality of schools in a town without
displacing those low types. For example, families in public housing would likely remain in place
and would (presumably) see no difference in their housing costs as a result of a change in school
assignment rules. Even in this case, however, low-type families not living in public housing could
still be displaced from the town by a school choice rule.
   In sum, these three extensions tend to reduce but not eliminate the predicted negative effects of



                                                   30
a switch from neighborhood assignment to school choice rules for lowest type students, sometimes by
suggesting that school choice outcomes will simply mimic neighborhood assignment. For example,
with large transportation costs, residential and school sorting could still emerge in equilibrium
under a school choice rule with low types ranking a nearby low quality school as their top choice
to avoid large logistical costs of attending a distant high quality school.
         On a separate point, it is also possible to question our foundational assumption that the function
v(x, y) exhibits increasing differences in (x, y) by distinguishing between parental and child utility
from education. If we assume that x simply indicates wealth, then increasing differences in v(x, y)
indicate that willingness to pay for high-quality education increases with wealth, which in turns
makes sense for parents whose buying power is limited by an exogenously fixed budget. However,
these microfoundations for the utility functions of parents to exhibit increasing differences in (x, y)
need not extend to their children - for example, perhaps children of all family types might benefit
equally from high-quality education.21 But since this logic suggests that parental utility functions
would still exhibit increasing differences in (x, y), it would only alter the interpretation of our
equilibrium results and not the equilibrium predictions themselves. Specifically, distinguishing
between parent and child utility functions could serve to justify the paternalistic view that it is
valuable to override the parents of preferences in order to improve the quality of schooling provided
to disadvantaged children. Yet, the equilbrium prediction of our model, as highlighted by Figures
1 and 2, is that the lowest types whose school assignments are affected by the adoption of school
choice enroll at lower quality schools when a given town adopts school choice than when it maintains
a neighborhood assignment system.


5         Conclusion

A common rationale for adopting school choice is to improve the quality of school options for
disadvantaged students. But, our analysis shows that market forces can undercut this approach,
for if a school choice plan succeeds in narrowing the quality range between the lowest and highest
quality schools, that change can be expected to compress the distribution of house prices in that
town, thereby providing incentives for the lowest and highest types to exit from the town’s public
schools.
         Our analysis contributes to a recent literature on school choice mechanisms, which has focused
    21
         We are grateful to Tim Van Zandt for suggesting this interpretation to us.




                                                             31
on the best way to assign pupils to schools given their residential location in a centralized assignment
scheme. In particular, some have argued that the goals of choice systems may not be undermined
by flight via fine-tuning of socioeconomic or income-based criteria and cities have now experimented
with complex school choice tie-breakers in an effort to achieve a stable balance (Kahlenberg 2003,
2014). By incorporating feedback between residential and school choices, our model suggests that
analysis of school assignments that does not account for the possibility of residential resorting may
lead to an incomplete understanding about the consequences of school choice.
   A broader implication of our model is that systemic changes beyond the details of the school
assignment system may be necessary to reduce inequalities in educational opportunities. One
such approach addresses the residential choice problem directly by transferring low-income families
to better neighborhoods. For instance, the US Department of Housing and Urban Development’s
Moving to Opportunity for Fair Housing Program offered housing vouches to low-income families to
enable them to move to low-poverty neighborhoods. The evidence on the effects of this experiment
on educational outcomes is mixed (Kling, Liebman, and Katz 2007), though a recent literature
suggests there may be some positive effects (Chetty, Hendren, and Katz 2015; Pinto 2014). A second
approach involves efforts to directly influence the quality of schools available to low-income families.
There is now growing evidence that some urban charter schools generate large achievement effects
and that children from more disadvantaged backgrounds benefit more from charter attendance
(Abdulkadiroğlu, et. al., 2011; Angrist, et. al., 2012; Walters 2014). Whether these particular
approaches ultimately prove to be successful in providing high-quality education to students from
low-income families, our model suggests that their general approach, attacking the roots of schooling
inequities, likely has more promise than efforts solely designed to change the rules by which students
are assigned to schools.




                                                  32
References

Abdulkadiroğlu, Atila, Nikhil Agarwal, and Parag Pathak (2015): “The Welfare Effects of Coordi-
nated Assignment: Evidence from the NYC HS Match.” NBER Working Paper 21046.

Abdulkadiroğlu, Atila, Joshua D. Angrist, Thomas J. Kane, and Parag Pathak (2011): “Account-
ability and Flexibility in Public Schools: Evidence from Boston’s Charters and Pilots.” Quarterly
Journal of Economics, 126(2): 699-748.

Abdulkadiroglu, Atila and Tayfun Sonmez (2003): “School Choice: A Mechanism Design Ap-
proach.” American Economic Review, 93(3): 729-747.

Angrist, Joshua D., Susan M. Dynarski, Thomas J. Kane, Parag A. Pathak, and Christopher R.
Walters (2012): “Who Benefits from KIPP?” Journal of Policy Analysis and Management, 31(4):
837-860.

Alesina, Alberto, Reza Baqir, and Caroline Hoxby (2004): “Political Jurisdictions in Hetereogenous
Communities.” Journal of Political Economy, 112(2): 348-396.

Alesina, Alberto and Enrico Spolaore (2003): The Size of Nations. MIT Press, Cambridge MA.

Autor, David, Christopher J. Palmer, and Parag A. Pathak (2014): “Housing Market Spillovers:
Evidence from the End of Rent Control in Cambridge, MA.” Journal of Political Economy, 122(3):
661-717.

Barseghyan, Levon, Damon Clark, and Stephen Coate (2015): “Public School Choice: An Economic
Analysis.” working paper.

Baum-Snow, Nathaniel and Byron Lutz (2011): “School Desegregation, School Choice and Changes
in Residential Location Patterns by Race.” American Economic Review, 101(7): 3019-3046.

Bayer, Patrick, Fernando Ferreira, and Rob McMillan (2007): “A Unified Framework for Measuring
Preferences for Schools and Neighborhoods.” Journal of Political Economy, 115(4): 588-638.

Black, Sandra (1999): “Do Better Schools Matter? Parental Valuation of Elementary Education.”
Quarterly Journal of Economics, 114(2): 577-599.

Bulow, Jeremy and Jonathan Levin (2006): “Matching and Price Competition.” American Eco-
nomic Review, 2006.

Benabou, Roland (1993): “Workings of a City: Location, Education, and Production.” Quarterly
Journal of Economics, 108, 619-652.


                                               33
Benabou, Roland (1996): “Equity and Efficiency in Human Capital Investment: The Local Con-
nection.” Review of Economic Studies, 62, 237-264.

Brunner, Eric J., Sung-Woo Cho, and Randall Reback (2010): “Mobility, Housing Markets, and
Schools: Estimating General Equilibrium Effects of Interdistrict Choice.” Barnard College, Jan-
uary.

Calsamiglia, Caterina, Francisco Martinez-Mora and Antonio Miralles (2014): “School Choice
Mechanisms, Peer Effects, and Sorting.” mimeo.

Calsamiglia, Caterina and Maia Guell (2014): “The Illusion of Choice: Evidence from Barcelona.”
mimeo

Card, David, Alexandre Mas, and Jesse Rothstein (2008): “Tipping and the Dynamics of Segrega-
tion.” Quarterly Journal of Economics, 123(1), 177-218.

Chetty, Raj, Nathan Hendren, and Lawrence F. Katz (2015): “The Effects of Exposure to Better
Neighborhoods on Children: New Evidence from the Moving to Opportunity Project.” NBER
Working Paper 21156.

CPS (1982): Memorandum of Cambridge Public Schools

Durlauf, Steven (1996): “A Theory of Persistent Income Inequality.” Journal of Economic Growth,
1, 75–94.

Dur, Umut, Scott Kominers, Parag Pathak, and Tayfun Sönmez (2013): “The Demise of Walk
Zones in Boston: Priorities vs. Precedence in School Choice.” NBER Working Paper 18981.

Epple, Dennis and Richard Romano (1998): “Competition Between Private and Public Schools,
Vouchers, and Peer Group Effects.” American Economic Review, 88(1), 33-62.

Epple, Dennis and Richard Romano (2003): “Neighborhood Schools, Choice and the Distribution
of Educational Benefits,” in The Economics of School Choice, Caroline Hoxby ed., University of
Chicago Press.

Epple, Dennis and Richard Romano (2015): “Equilibrium and Efficient Provision of Local Public
Goods with Peer Effects.” Research in Economics, forthcoming.

Epple, Dennis and Holger Sieg (1999): “Estimating Equilibrium Models of Local Jurisdictions.”
Journal of Political Economy, 107(4): 645-681.




                                                 34
Fernandez, Raquel and Richard Rogerson (1996): “Income Distribution, Communities and the
Quality of Public Education.” The Quarterly Journal of Economics, 111(1), 135-64.

Hastings, Justine, Thomas Kane, and Doug Staiger (2009): “Heterogenous Preferences and the
Efficacy of Public School Choice.” NBER Working Paper, 2145.

Hatfield, John William, Fuhito Kojima, and Yusuke Narita (2015): “Promoting School Competition
through School Choice: A Market Design Approach.” Working paper, Stanford University.

Hoxby, Caroline (2003): “School Choice and School Productivity (Or, Could School Choice be
a Rising Tide that Lifts All Boats?” in The Economics of School Choice, Caroline Hoxby ed.,
University of Chicago Press.

Kahlenberg, Richard (2003): “All Together Now: Creating Middle-Class Schools through Public
School Choice.” Brookings Institution Press.

Kahlenberg, Richard (2014): “Elite, Separate, Unequal: New York City’s Top Public Schools Need
Diversity.” New York Times, June 22.

Kane, Thomas J., Stephanie K. Riegg, and Douglas O. Staiger (2006): “School Quality, Neighbor-
hoods, and Housing Prices.” American Law and Economics Review, Oxford University Press, 8(2):
183-212.

Kling, Jeffrey R., Jeffrey B. Liebman, and Lawrence F. Katz (2007): “Experimental Analysis of
Neighborhood Effects.” Econometrica, 75(1): 83-119.

Landsmark, Ted (2009): “It’s time to end busing in Boston.” Boston Globe, Opinion-Editorial,
January 31, 2009.

Loury, Glenn (1977): “A Dynamic Theory of Racial Income Differences.” Chapter 8 of Women,
Minorities, and Employment Discrimination, Ed. P.A. Wallace and A. Le Mund, Lexington Books:
Lexington, Mass.

MacLeod, Bentley and Miguel Urquiola (2009): “Anti-lemons: Reputation and Educational Qual-
ity.” National Bureau of Economic Research Working Paper 15112.

Nechyba, Thomas (2003a): “Introducing School Choice into Multi-District Public School Systems,”
in The Economics of School Choice, Caroline Hoxby ed., University of Chicago Press.

Nechyba, Thomas (2003b): “School Finance, Spatial Income Segregation, and the Nature of Com-
munities.” Journal of Urban Economics, 54, 61-88.


                                               35
Nechyba, Thomas (2000): “Mobility, Targeting and Private-School Vouchers.” American Economic
Review 90(1), 130-46.

Pathak, Parag A. and Tayfun Sönmez (2008): “Leveling the Playing Field: Sincere and Sophisti-
cated Players in the Boston Mechanism.” American Economic Review, 98(4): 1636-1652.

Pathak, Parag A. and Tayfun Sönmez (2013): “School Admissions Reform in Chicago and England:
Comparing Mechanisms by their Vulnerability to Manipulation.” American Economic Review,
103(1): 80-106.

Pathak, Parag A. and Peng Shi (2014): “Demand Modeling, Forecasting, and Counterfactuals,
Part I.” NBER Working Paper 19859.

Pinto, Rodirgo (2015): “Selection Bias in a Controlled Experiment: The Case of Moving to Op-
portunity.” Working paper, University of Chicago.

Reback, Randall (2005): “House Prices and the Provision of Public Services: Capitalization under
School Choice Programs.” Journal of Urban Economics, 57(2): 275-301.

Rothstein, Jesse (2006): “Good principals or good peers? Parental Valuation of School Char-
acteristics, Tiebout Equilibrium, and the Incentive Effects of Competition among Jurisdictions.”
American Economic Review, 96(4):1333-1350.

Schelling, Thomas (1971): “Dynamic Models of Segregation.” Journal of Mathematical Sociology,
1(2), pp. 143–186.

Schelling, Thomas (1978): Micromotives and Macrobehavior, Norton.

Tannenbaum, Daniel (2013): “School Choice, Redistricting, and the Distributional Consequences
of Student Assignment Reform.” Working Paper, University of Chicago. Retrieved from
https://economics.uchicago.edu/workshops/Tannenbaum Daniel School Choice.pdf

Tiebout, Charles (1956): “A Pure Theory of Local Expenditures.” Journal of Political Economy,
64, 416-424.

Van Zandt, Timothy (2002): “An Introduction to Monotone Comparative Statics,” mimeo, IN-
SEAD.

Walters, Christopher R. (2004): “The Demand for Effective Charter Schools.” Working paper,
UC-Berkeley.




                                              36
Appendix A: Proofs

Proof of Lemma 1

Proof. In a perfectly competitive market, a non-partisan student of type x faces maximization
problem:
                                              max u(x, y) = v(x, y) − p(y).
                                                y

The first-order condition for maximization is          − p0 (y) = 0. For the first-order condition to
                                                           ∂v
                                                           ∂y (x, y)
                                                                  z=y
                                                                  Z
                                                                      ∂v
hold at x = y, we have p0 (y) = ∂y
                                ∂v
                                   (y, y), which requires p(y) =         (z, z)dz,22 while the second-
                                                                      ∂y
                                                                                    z=0
order condition for maximization follows from the fact that v satisfies increasing differences in x
and y. Given this pricing rule,

                                            ∂u(x, y)   ∂v          ∂v
                                                     =    (x, y) −    (y, y),
                                              ∂y       ∂y          ∂y

which is strictly positive for x > y and strictly negative for x < y by the property of increasing
differences for v. Thus, u(x, y) = v(x, y) − p(y) is strictly increasing in y for y < x and strictly
decreasing in y for y > x, which verifies that u(x, y) is maximized at y = x given this pricing rule.




Proof of Lemma 2

Proof. To establish the first statement, recall that condition (4) of the neighborhood school
equilibrium requires pd ≥ p(yd ). Therefore, house prices in district d are at least equal to the
competitive price corresponding to the quality of its schools, so that for each d,

                                             G(x, yd , pd ) ≤ G(x, yd , p(yd )).

       For the second statement, since v(x, y) − p(y) is strictly increasing in y for y < x and strictly
decreasing in y for y > x, by construction G(x, yd , p(yd )) takes maximum value θ at yd = x.
Therefore, G(x, yd , pd ) is bounded above by θ.
       The third statement follows directly from increasing differences and differentiation.                          Rewrite
G(x, yd , pd ) = θ + [v(x, yd ) − v(x, x)] + [p(x) − pd ] and then differentiate with respect to x.                         By
                                                                                    z=y
                                                                                    Z
  22                                                                                      ∂v
       Technically, this first-order condition would yield the result that p(y) =            (z, z)dz +C, where C is a constant,
                                                                                          ∂y
                                                                                    z=0
but since we assume that v(0, 0) = 0, it is natural to set this constant to 0.




                                                              37
construction, p0 (x) =        ∂v
                              ∂y (x, x),   so
           ∂G                 ∂v            ∂v          ∂v          ∂v          ∂v            ∂v
              (x, yd , pd ) =    (x, yd ) −    (x, x) −    (x, x) +    (x, x) =    (x, yd ) −    (x, x).
           ∂x                 ∂y            ∂x          ∂y          ∂y          ∂x            ∂x
                                                                                   ∂v                ∂v
Since v(x, y) satisfies strictly increasing differences in x and y,                ∂x (x, yd )   >   ∂x (x, x)   if x < yd , while
∂v                ∂v                                       ∂G                                            ∂G
∂x (x, yd )   <   ∂x (x, x)   if x > yd . Therefore,       ∂x (x, yd , pd )   > 0 if x < yd while        ∂x (x, yd , pd )   < 0 if
x > yd .      That is, G(x, yd ) is strictly increasing in x for x < yd and strictly decreasing in x for
x > yd .


Proof of Proposition 2

Proof. For each x > 0, consider the following algorithm to assign student types to districts under
the assumption of competitive market pricing. First, set x1 = x and assume that district 1 consists
of (partisan) students of types [0, x1 ), with associated school quality y1 = E(x|0 ≤ x < x1 ) and
competitive market price p1 = p(y1 ), where y1 > x1 by construction.
    Next, assign types [x1 , x2 ) to district 2 so that (if possible) a student with type x1 is indifferent
between districts 1 and 2. Thus, x2 is identified implicitly by equation

                                           v(x1 , y1 ) − p(y1 ) = v(x1 , y2 ) − p(y2 ),                                  (ALG2 )

where y2 is the school quality in district 2, y2 is strictly increasing in x2 , and y1 < x1 < y2 < x2
by construction.         The choice of x2 only affects equation (ALG2 ) through the dependence of the
right-hand side on y2 , and since x1 < y2 and y2 is strictly increasing in x2 , we know RHS(ALG2 )
is strictly decreasing in y2 .             We also know that RHS(ALG2 ) > LHS(ALG2 ) at x2 = y2 , so
there is at most one solution x2 to equation (ALG2 ).                         If there is no solution to (ALG2 ), then
v(x1 , y1 ) − p(y1 ) < v(x1 , y2 ) − p(y2 ) for each x2 > x1 . In this case, set x2 = 1 and stop the
algorithm, setting xd = 1 for all values d ≥ 2.
    If x2 < 1, then assign the remaining types x > x2 to districts 3, 4, ..., D following the same
process used to assign students to district 2.                  Suppose that (x1 , x2 , ..., xd ) have been chosen as
the cutoffs for the first d districts, where d ≥ 2 and 0 < x1 < x2 < ... < xd < 1.                                  We want to
choose xd+1 so that (if possible) a student with type xd is indifferent between districts d and d + 1
when (partisan) types with abilities from xd to xd+1 choose district d + 1. Thus, xd+1 is identified
implicitly by equation
                                     v(xd , yd ) − p(yd ) = v(xd , yd+1 ) − p(yd+1 ).                                 (ALGd+1 )

In each case, following the same reasoning described above in our analysis of equation (ALG2 )
there is either a unique solution to equation (ALGd+1 ) with xd+1 < 1, or v(xd , yd ) − p(yd ) <


                                                               38
v(xd , yd+1 ) − p(yd+1 ) for each xd+1 > xd , in which case we set xd+1 = 1. Repeat this step of the
algorithm until the first time that it sets a cutoff xd+1 = 1, in which case then set xk = 1 for all
values k > d + 1.
    With this as background, fix θ, and define xD (x1 ) to be equal to the upper limit for assignment
to district D identified by this algorithm given the assumption that partisan students of types (0, x1 )
will enroll in district 1. For x close to 0, the initial steps of this algorithm create very small intervals
and so xD (x) < 1 for D close to 0. For very large values of x, there is no solution to (ALG2 ), and
so xD (x1 ) = 1 for x1 close to 1. Since v and p are continuous and since there are no mass points in
the distribution of f , xD is a continuous function of x1 . Define x̂1,D = arg min(x1 |xD (x1 ) = 1). By
construction, a set of intervals with cutoffs (x̂1,D , x2 (x̂1,D ), ..., xD−1 (x̂1,D ), 1) satisfies the incentive
conditions for sorting partisan types into districts 1, 2, ..., D at competitive market prices for
these schools in town t. If θ is sufficiently large so that each marginal student (i.e. types from 0,
x̂1,D , x2 (x̂1,D ), ..., xD−1 (x̂1,D ), to 1) prefer town t to the outside option, then we have constructed
a neighborhood school equilibrium of the desired form. Define

θD = max{G[0, y1,D , p(y1,D )], G[x̂1,D , y2,D , p(y2,D )], ..., G[x̂D−1,D , yD,D , p(yD,D )], G[1, yD,D , p(yD,D )]}.

By construction, there is a neighborhood school equilibrium with D districts and competitive
market pricing for θ ≥ θD .


Proof of Proposition 3

Proof. First, consider the possibility that partisan students in a range of types [0, s0 ) enroll in town
t under school choice. We denote the average type of students in this interval by y0 (s0 ) = E[x| x <
s0 ]. In the discussion below, we (mostly) suppress the dependence of y0 on s0 to ease exposition.
For s0 < 1, there is a school choice equilibrium with enrollment of partisan students with x ∈ (0, s0 )
with school quality y0 and (competitive) price p(y0 ) if (1) v(0, y0 ) − p(y0 ) + θ ≥ π(0) or equivalently
v(0, y0 ) − p(y0 ) + θ ≥ 0 and (2) v(s0 , y0 ) − p(y0 ) + θ = π(s0 ) or θ = π(s0 ) − v(s0 , y0 ) + p(y0 )        In
words, in equilibrium of this form, a partisan student with x = 0 weakly prefers enrolling in town
t to the outside option while a partisan student with x = s0 is indifferent between enrolling in
town t and taking the outside option (so that a partisan student with x = s0 + ε strictly prefers
the outside option to enrollng in town t.)          Define the function s0 (θ) implicitly by the equation θ
= p(y0 ) − v(0, y0 ) (recalling that we’ve suppressed dependence of y0 on s0 ) and consider all pairs
of values (s0 , y0 (s0 )). Since y0 is a strictly increasing function of s0 , p(y0 ) − v(0, y0 ) is strictly


                                                        39
increasing in s0 and thus (1) holds for x < s0 (θ). We do not know if θ = π(s0 ) − v(s0 , y0 ) + p(y0 )
is monotonic in s0 , but it is continuous and equal to 0 at s0 = 0. Since (1) holds for x < s0 (θ),
there is an equilibrium with s0 ≤ s0 (θ) if (2) holds for any pair (s0 , y0 (s0 )) with x < s0 (θ). That
is, there is a school choice equilibrium where students in some range [0, x0 ) enroll in town t unless
π(0) − v(0, y0 ) + p(y0 ) < θ for each s0 ≤ s0 (θ).
    Next, consider the possibility that partisan students in a range of types [a, sa ) enroll in town t
under school choice with 0 < a < 1 so that schools in town t have quality ya (sa ) = E[x| a ≤ x ≤ sa ].
As above, we suppress the dependence of ya on sa in much of the discussion below. In such an
equilibrium, a partisan student with type a must be indifferent between enrolling in town t and
the outside option: v(a, ya ) − p(ya ) + θ = π(a). Here, v(a, ya ) − p(ya ) + θ is strictly decreasing in
ya for ya > a and equal to π(a) + θ at ya = a.               Since ya is strictly increasing in sa , this means
that v(a, ya ) − p(ya ) + θ is strictly decreasing in sa . So for each a, there is either a unique value
sa (θ) such that v(a, ya (sa (θ))) − p(ya (sa (θ))) + θ = π(a), or else v(a, ya ) − p(ya ) + θ > π(a) for
each sa , including sa = 1.      From above, if there is no school choice where students in some range
[0, x0 ) enroll in town t, then π(0) − v(0, y0 ) + p(y0 ) < θ, which means that s0 (θ) < 1 and so sa (θ) is
well defined for a close to 0. Here, there is a school choice equilibrium where students in a range
of abilities [a, sa ) enroll in town t if v(a, ya ) − p(ya ) + θ = π(a).       By assumption, the left-hand
side is less than the right-hand side of the equation at a = 0, and both sides of the equation are
continuous, so either there exists some a where they are equal or v(a∗ , ya∗ ) − p(ya∗ ) + θ < π(a∗ ) at
the first point a = a∗ such that sa = 1. This shows that there is either an interior equilibrium
for some [a, sa ] or that there is a range of abilities [a∗ , 1) such v(a∗ , y ∗ ) − p(y ∗ ) + θ = π(a∗ ) and
v(1, y ∗ ) − p(1) + θ ≥ π(1), where y ∗ = E(x|x > a∗ ), in which case there is an equilibrium where
partisan students with x ∈ [a∗ , 1). In either case, there is a school choice equilibrium for the given
value of θ.


Proof of Proposition 4

Proof. 1. Let x̄ab = E[x|a < x < b], and assume that 0 < a < b < 1. A similar argument applies
if a = 0 or b = 1. In a school choice equilibrium where partisans of types between a and b enroll in
town t, types a and b must each be indifferent between enrolling in town t and taking the outside
option: G(a, x̄ab , p(x̄ab )) = G(b, x̄ab , p(x̄ab )) = θ.    By Lemma 2, G(a, y, p(y)) = 0 at y = a and
G(a, y, p(y)) is strictly increasing in y for y > a. So for θ sufficiently small, there exists values
δa (θ), δb (θ) > 0 such that G(a, a + δa (θ), p(a + δa (θ))) = θ and G(b, b − δb (θ), p(a − δb (θ))) = θ.


                                                        40
In words, δa (θ) and δb (θ) represents the maximum deviations in school quality from assortative
matching (at competitive market prices) that partisans of types a and b are willing to accept to
achieve the partisan bonus θ for living in town t. As θ → 0, δa (θ), δb (θ) → 0, so there exists a value
θ∗ (a, b) such that δa (θ) <       b−a
                                    2 ,   δb (θ) <     b−a
                                                        2      for θ < θ∗ (a, b). That is, for any interval [a, b] where
0 < a < b < 1, if θ < θ∗ (a, b), there can only be a school choice equilibrium where partisans of types
[a, xa ] enroll in town t if xa < b and similarly, there can only be a school choice equilibrium where
partisans of types [xb , b] enroll in town t in town t if xb > a. Applying this argument with b = a + ε
and letting ε → 0, this shows that the range of partisan types in a school choice equilibrium tends
to 0 as θ tends to 0.
                                                                                  d        1
    2. First, we show that the values yd converge to                              D   −   2D .     Consider a more general situation
                                                                                                         1
where x ∈ [a, b], and we want to bound E[x|x ∈ [a, b]] where b − a =                                     D   and D grows large. Denote
                                                       a+b
the middle value of the interval by m =                 2 .      Taking a Taylor series expansion for f (x) around m,
we have f (x) = f (m) + (x − m)f 0 (m) + 12 (x − m)2 f 00 (m) + O( D13 ), where O( D13 ) indicates additional
                                                                                                                    Rb
                                                                                                                        xf (x)dx
terms of order    ( D13 ).   Recall that the conditional expectation E[x|x ∈ [a, b]] =                               Rab         .   We can
                                                                                                                       a f (x)dx
write the numerator as
              Z b            Z b
                                                            1
                  xf (x)dx =     [xf (m) + x(x − m)f 0 (m) + x(x − m)2 f 00 (m)]dx,
               a              a                             2
neglecting additional terms of order O( D13 ) in the integrand. After integrating and substituting
                   Rb            b2 −a2         (b−a)3 0      (b+a)(b−a)3 00
m = a+b
      2 , we have a xf (x)dx =      2 f (m) +     12 f (m) +      48     f (m). Similarly, we have
for the denominator,
                                          Z   b
                                                                                                 1
                                                  f (x)dx = (b − a)f (m) + O(                       ),
                                         a                                                       D2
                         a+b       (b−a)2 0              (b+a)(b−a)2 00                                                          d−1
so E[x|x ∈ [a, b]] =      2    +     12 f (m)        +       48     f (m).                    So for district d, with a =         D      and b
    d
=   D,   we have yd = E[x|x ∈ [ d−1  d
                                 D , D ]] =
                                                         a+b
                                                          2    + O( d12 ) =           d
                                                                                      D   −    1
                                                                                              2D   + O( d12 ), so that yd →     d
                                                                                                                                D    −    1
                                                                                                                                         2D   as
D becomes large.
                                                                                      d
    Second, consider the condition for a partisan of type                             D,      at the margin between districts d and
                                                                 d               d
d + 1, to be indifferent between those districts: pd+1 − pd = v( D , yd+1 ) − v( D , yd ). Rewriting the
                                                                                                                                              ∂v
equation for the price increment in integral form and using a Taylor series approximation for                                                 ∂y

near (z, z) gives
                                   yd+1                             yd+1
                                                                                                     ∂2v
                               Z                                Z
                                          ∂v d                                   ∂v           d                      1
    ∆d+1 = pd+1 − pd =                      ( , z)dz =                       [      (z, z) + ( − z)      (z, z) + O( 2 )]dz.
                                yd        ∂y D                   yd              ∂y           D     ∂x∂y            d
                                                ∂ v                  d   2
Using a second Taylor series approximation for ∂x∂y  (z, z) near z = D gives
                         Z yd+1
                                 ∂v         d        ∂2v d d            1
            pd+1 − pd =         [ (z, z) + ( − z)          ( , ) + O( 2 )]dz
                          yd     ∂y         D       ∂x∂y D D           d


                                                                    41
                                                                                yd+1
                                                    ∂2v d d
                                                                            Z
                                                                                           d             1
                             = p(yd+1 ) − p(yd ) +     ( , )                           (     − z)dz + O( 3 ),
                                                   ∂x∂y D D                 yd             D            d
                                                                            1
since the range of the integral from yd to yd+1 is of order                 D.    Further, since we know from above
                                 d        1
that for D large, yd+1 =         D   +   2D   + O( d12 ) and yd =   d
                                                                    D   −    1
                                                                            2D   + O( d12 ), and since the positive and
                              R d                          d    1                d      1
negative terms in the integral ( D − z)dz from lower limit D − 2D to upper limit D  + 2D  cancel
    R yd+1 d
out, yd ( D − z)dz = O( D13 ) as well. In sum, pd+1 − pd = p(yd+1 ) − p(yd ) + O( d12 ). Taking
sums of the price increments, these deviations from competitive price increments aggregate to at
most a term of order DD2 = O( D
                              1
                                ) and so tend to 0 as D grows large. That is, pd+1 converges to
    Pd
p1 + j=1 pj+1 − pj = p1 + p(yd ) − p(y1 ) as D grows large.
      Third, consider the restriction on equilibrium prices pd ≥ p(yd ), where p(yd ) is the market price
for a school of quality yd .         If we initially set p1 = p(y1 ), then since |∆pd+1 − [(p(yd+1 ) − p(yd )]|
= O( D12 ), pd ≥ p(yd ) − O( DD2 ) = O( D
                                        1
                                          ). So, the requirement that all prices pd are at least equal to
p(yd ) and at least one price pd is exactly equal to p(yd ) uniquely identifies a choice of p1 such that
                1                                1
p1 = p(y1 )+ O( D ) and thus |p(yd ) − pd | = O( D ).
                                                                    d−1                    d
      Combining these features, a partisan of type x with            D      ≤x≤            D   will choose district d in town t
        d                                                                            d                 d
if v(x, D ) − pd + θ ≥ v(x, x) − p(x), or equivalently, θ ≥ [v(x, x) − p(x)] − [v(x, D ) − pd ] = G(x, D , pd ).
                          1
Since |p(yd ) − pd | = O( D ), we can bound the loss function in terms of competitive market prices,

                                              d              d    d       1
                                      G(x,      , pd ) = G(x, , p( )) + O( ).
                                              D              D    D       D
                             d                                           d      d
For D sufficiently large,    D   becomes arbitrarily close to x, so G(x, D , p( D )) tends to 0 as D increases.
That is, for D sufficiently large, each partisan type will be willing to choose a neighborhood school
in town t rather than the outside option, thereby producing an equilibrium where partisans of types
d−1        d
 D    to   D   choose district d in town t.


Proof of Proposition 8

Proof. Suppose that there are two districts of equal size in each town, that there is measure 1
each of partisans of town A and of partisans of town B (so that each district has capacity equal
to measure 1/2), and that the distribution of types is identical for partisans of each town.                               By
Proposition 7, when town A uses a school choice rule and town B uses a neighborhood school
assignment rule, in any equilibrium, an interval of partisans of type A [xL    H
                                                                          A , xA ] and an interval of

partisans of town B [xL    H                            L    L    H    H
                      B , xB ] enroll in town A, where xA ≤ xB ≤ xB ≤ xA and these cutoffs are

determined endogenously in equilibrium.


                                                            42
    Given these enrollment constraints, the choice of xL                                      L
                                                       A implicitly determines the choice of xB

given the enrollment constraint F (xL         L
                                    A ) + F (xB ) = 1/2.          Then since xL    L    L
                                                                              A ≤ xB , xA takes possible

values on [0, x.25 ], where x.25 is defined by F (x.25 ) = 1/4.       Similarly, xH
                                                                                  A takes possible values

on [x.75 , 1] where F (x.75 ) = 3/4 and xH                             H
                                         B is an implicit function of xA according to the equation

(1 − F (xH               H                              H         H
         A )) + (1 − F (xB )) = 1/2 or equivalently F (xA ) + F (xB ) = 3/2.

    Define λL (xL    H         L             L               L             L                       L    H
                A , xA ) = [v(xB , yA ) − v(xA , yA )] − [v(xB , y1 ) − v(xA , y1 )] − 2θ and λH (xA , xA ) =

[v(xH             H               H             H
    A , y2 ) − v(xB , y2 )] − [v(xA , yA ) − v(xB , yA )] − 2θ.

    There is no mixing at the bottom if xL                                  H
                                         A = 0 and no mixing at the top if xA = 1. Given

school qualities y1 < yA < y2 and prices pA , p1 , p2 , there is no mixing at the bottom if v(xL
                                                                                               A =

0, yA )+θ−pA ≥ v(xL                  L                   L
                  A , y1 )−p1 and v(xB , yB1 )+θ−p1 ≥ v(xB , yA )−pA , so that marginal (boundary)

types of partisans of each town each prefer not to mix. Combining these two equations to eliminate
the prices gives the condition λL (xL       H
                                    A = 0, xA ) ≤ 0 as a necessary condition for an equilibrium with

no mixing at the bottom. If there is mixing at the bottom, then both incentive conditions must
hold with equality so that λL (xL       H
                                A = 0, xA ) = 0 is a necessary condition for an equilibrium with

xL                      L    H
 A > 0. Similarly, λH (xA , xA = 1) ≤ 0 is a necessary condition for equilibrium with no mixing at

the top and λH (xL    H
                 A , xA ) = 0 is necessary for an equilibrium with mixing at the top.

    Holding xL                                                                       H
             A fixed, increased mixing at the top, as represented by a reduction in xA , yields an

increase in y2 and a decline in yA . That is, yA is strictly increasing and y2 is strictly decreasing in
xH          L    L                           H
 A , while xA , xB , and y1 are constant in xA . By increasing differences of v in both arguments,

λL (xL    H                              H                                     H
     A , xA ) is strictly increasing in xA , so it takes its maximum value at xA = 1 for each value of

xL                   L                                  H              L    H
 A . Thus, for each xA , there is at most one value of xA such that v(xA , xA ) = 0. Further, when

xL                                            L    L                 H
 A = x.25 (its maximum possible value), then xA = xB and λH (x.25 , xA ) = −2θ for each value of

xH
 A . Since v is continuous and λL (x.25 , 1) < 0, then either (1) there exists some value x̄ < x.25 such

that λL (x̄, 1) = 0 and λL (xL               L                  L                   L
                             A , 1) < 0 for xA > x̄ or (2) λL (xA , 1) < 0 for all xA ≤ x.25 .

     In case (1), by construction, there exists a uniquely defined function ϕ(xL           L
                                                                               A ) for x≤ xA ≤ x̄

such that λL (xL      L
               A , ϕ(xA )) = 0.      From above, we know ϕ(x) = x.75 and ϕ(x) = 1            Further, since
λL (x̄, 1) = 0, then λL (x̄, x.75 ) < 0 since λL is strictly increasing in its second argument. Then since
v is continuous, there either (1A) exists a value x < x̄ such that λL (x, x.75 ) = 0 and λL (xL
                                                                                              A , x.75 ) < 0

for each xL                L                    L                        L
          A such that x < xA < x̄, or (1B) λL (xA , x.75 ) < 0 for each xA < x̄. When xAH = x.75

(its minimum possible value), then xH    H             L                                   L
                                    A = xB and so λH (xA , x.75 ) = −2θ for each value of xA . So,

in particular, in Case (1A), λH (x, x.75 ) = λH (x, ϕ(x)) = −2θ. Then, since v (and therefore λH ) is
continuous in each argument, there either exists xL                               L      L
                                                  A between x and x̄ so that λH (xA , ϕ(xA )) = 0,




                                                       43
in which case there is an equilibrium with mixing at top and bottom at [xL    H      L
                                                                         A , xA = ϕ(xA )] or

λH (x̄, ϕ(x̄) = 1) ≤ 0, in which case there is an equilibrium with mixing at the bottom and no
mixing at the top at [xL        H
                       A = x̄, xA = 1]. Similarly, in Case (1B), there exists a uniquely defined

function ϕ(xL             L                     L      L
            A ) for each xA ≤ x̄ such that λL (xA , ϕ(xA )) = 0. The distinction between Case (1A)

and Case (1B) is that since the range (0, x̄) of relevant values of xL
                                                                     A includes 0, it is now possible

to find an equilibrium with no mixing at the bottom. Since λH (0, x.75 ) = −2θ < 0, either there
exists a value xH                     L                        H
                A between x.75 and ϕ(xA = 0) such that λH (0, xA ) = 0, in which case there is an

equilibrium with mixing at the top and no mixing at the bottom at (0, xH
                                                                       A ) OR λH (0, ϕ(0)) < 0,

in which case the logic from (1A) implies that there exists an equilibrium.
       In case (2), λL (xL                   L                          L    H
                         A , 1) < 0 for all xA ≤ x.25 , so in fact λL (xA , xA ) < 0 in all cases. This rules

out the possibility of an equilibrium with mixing at the bottom, so assume that xL
                                                                                 A = 0 and look for

an equilibrium with no mixing at the bottom. Since λH (0, x.75 ) = −2θ < 0, either λH (0, 1) ≤ 0, in
which case there is an equilibrium with no mixing at top or bottom, or there exists some value xH
                                                                                                A

between x.75 and 1 such that λH (0, xH                                                     H
                                     A ) = 0 in which case there is an equilibrium at (0, xA ) with

mixing at the top and no mixing at the bottom.


Proof of Proposition 9

Proof. If θ < θN M , then in equilibrium, a positive measure of town-B partisans enroll in town A,
so xH    L                                                                        L
    B − xB ≥ δ for some fixed δ > 0. Then town-B partisans with types just below xB enroll in

some district in town B, while town-B partisans with types just above xH
                                                                       B enroll in some different

district in town B. Denote these districts as district m for those just below xL
                                                                               B and district m + 1

for those just above xH
                      B.
                        23 By construction, y        H           L
                                              m+1 > xB and ym < xB , so


                                          ym+1 − ym > xH    L
                                                       B − xB ≥ δ,
  23
       To justify a switch from town A to m + 1 at xH
                                                    B , it must be that ym+1 > ySC , which means that students of

types lower than xH
                  B strictly prefer town A to district m+1. Thus, when town B partisan types switch to town A at

x = xL    H                      L
     B < xB , those types below xB must choose a district in town B other than m + 1.




                                                        44
                             δ
so either ym+1 − yA ≥        2   or yA − ym+1 ≥ 2δ , or both conditions must hold.24 Assume without loss
of generality that ym+1 − yA ≥ 2δ . Since town-A partisans of type xH
                                                                    A enroll in town A,


                                   v(xH                      H
                                      A , yA ) + θ − pA ≥ v(xA , ym+1 ) − pm+1 ,


or
                                   pm+1 − pA ≥ v(xH               H
                                                  A , ym+1 ) − v(xA , yA ) − θ.

Since town-B partisans of type xH
                                B enroll in town A,


                                   v(xH                          H
                                      B , ym+1 ) + θ − pm+1 ≥ v(xB , yA ) − pA ,


or
                                   pm+1 − pA ≤ v(xH               H
                                                  B , ym+1 ) − v(xB , yA ) + θ.

       For the two inequalities for pm+1 − pA to hold simultaneously,

                         v(xH               H                 H               H
                            A , ym+1 ) − v(xA , yA ) − θ ≤ v(xB , ym+1 ) − v(xB , yA ) + θ


or
                         2θ ≥ [v(xH               H               H               H
                                  B , ym+1 ) − v(xB , yA )] − [v(xA , ym+1 ) − v(xA , yA )].

Writing this in integral form,
                                            Z   ym+1
                                                           ∂v H        ∂v H
                                     2θ ≥              [     (x , z) −   (x , z)]dz.
                                            ySC            ∂y B        ∂y A
                                                              ∂2v
From above, ym+1 − yA ≥ 2δ . Further, since                  ∂x∂y   ≥ κ, we know

                                      ∂v H        ∂v H
                                        (x , z) −   (x , z) ≥ κ(xH    H
                                                                 A − xB )
                                      ∂y B        ∂y A

for each z. Putting these inequalities together,
                       Z ym+1
                               ∂v             ∂v H             δκ H
                              [ (xH  B , z) −    (xA , z)]dz ≥   (x − xH
                                                                       A ).
                        ySC    ∂y             ∂y                2 B
                                                                       δκ H
Thus, we can rewrite the incentive condition as 2θ ≥                    2 (xA   − xH
                                                                                   B ). For this to hold as θ → 0, it

must be that (xH    H
               A − xB ) → 0 as θ → 0.
  24
       If school choice enrollment involves a boundary in types - for example if town-A partisans of types (0, a) and
town-B partisans of types (0, b) enroll in town A under school choice (while the rest enroll in town B given the
neighborhood rule), where b < a, then town B partisans of type a enroll in a district in town B with quality at
least equal to E(x|b ≤ x ≤ a) > xSC , since xSC is a weighted average of E[x|0 ≤ x ≤ a] from town A-partisans and
E[x|0 ≤ x ≤ b] from town B-partisans, each of which is less than E[x|b ≤ x ≤ a].



                                                                45
Appendix B: Additional Details of Examples 2, 3, and 4

Example 2. Suppose that partisans of type A enroll in district 1 of town B if x ∈ [0, xL
                                                                                       A ], enroll

in town A if x ∈ (xL        L                                                     L
                   A , 1 − xA ), and enroll in district 2 of town B if x in [1 − xA , 1]. Then, given

that each district enrolls an equal number of students and the types of partisans of both towns are
                                                                                                                   1
distributed according to U (0, 1), this means that the cutoffs for type B are given by xL
                                                                                        B =                        2   − xL
                                                                                                                          A
               1                                                                        1
and xH
     B =       2   + xL                                                                      L
                      A . That is, partisans of type B enroll in district B1 if x ∈ [0, 2 − xA ], enroll in town

A if x ∈ ( 21 − xL   1    L                                       1    L
                 A , 2 + xA ), and enroll in district B2 if x ∈ [ 2 + xA , 1].
                                                                                      xL                      1
     Given these choices, the average ability of partisans of type A is                A
                                                                                       2   in district B1 ,   2   in town
A and (1 − xL
            A /2) in district 2 in town B. Similarly, the average ability of partisans of type B is
1                                1                          xL
4   − xL
       A /2 in district 1,       2   in town A and ( 34 +    2 )
                                                             A
                                                                   in district 2. Taking weighted averages, we have



                               xL                xL
                                                      
                                    1     L 1             1                                             1
          y1       =        xL
                             A
                                A
                                 + ( − xA )( −    A
                                                    ) /                              =     2(xL  2   L
                                                                                              A ) − xA + ,
                              2     2       4     2       2                                             4
                                  L                         
                           L (1 − xA )    1   L 3       L     1                            3
          y2       =      xA           + ( − xA )( + xA ) /                          =       + xL      L 2
                                                                                                A − 2(xA ) .
                                 2        2       4           2                            4

In equilibrium,
(1) Partisans of town A with x = xL
                                  A get equal utility from A and district 1 in town B.

(2) Partisans of town B with x = xL
                                  B get equal utility from A and district 1 in town B.

(3) Partisans of town A with x = 1 − xL
                                      A get equal utility from A and district 2 in town B.

(4) Partisans of town B with x = 1 − xL
                                      B get equal utility from A and district 2 in town B.

     Given v(x, y) = xy, these conditions can be represented as

                                           xL
                                            A yA − p A + θ           = xL
                                                                        A y1 − p1                                       (2)

                                               xL            L
                                                B yA − pA = xB y1 − p1 + θ                                              (3)

                                           xH
                                            A yA − p A + θ           = xH
                                                                        A y2 − p 2                                      (4)

                                               xH            H
                                                B yA − pA = xB y2 − p2 + θ                                              (5)


     Solving for pA − p1 in (2) and (3) gives (xL    L
                                                A − xB )(yA − y1 ) + 2θ = 0, or equivalently 2θ =

( 21 − 2xL                                 L
         A )(yA − y1 ) after substituting xB =
                                                       1
                                                       2    − xL
                                                               A . Then substituting yA =
                                                                                               1
                                                                                               2   and y1 =   1
                                                                                                              4   − xL
                                                                                                                     A /2,
                            1                               1
we have yA − y1 =           4   + xL
                                   A /2, and thus 2θ =      8   − 3(xL  2     L 3
                                                                     A ) + 4(xA ) ). Solving (4) and (5) for θ as a

function of xL
             A yields the identical equation.




                                                                46
   Based on these computations, there is an equilibrium of the given form whenever 2θ = 1/8 −
3(xL  2     L 3                                   L 2      L 3        L                L    L
   A ) + 4(xA ) or equivalently θ = 1/16 − (3/2)(xA ) + 2(xA ) , and xA ≤ 1/4 so that xA ≥ xB .

This is a cubic equation for θ as a function of xL
                                                 A , so is not naturally conducive to an analytic

solution with xL                                                                         L
               A as a function of θ. However, we can identify some of the properties of xA (θ) by

studying comparative statics of this equation with θ as a function of xL
                                                                       A.

   Differentiating θ(xL                   L 2      L 3                  L            L      L 2
                      A ) = 1/16 − (3/2)(xA ) + 2(xA ) with respect to xA gives dθ/dxA = 6(xA ) −
                       1
3xL          L
  A < 0 for xA <       2.   So θ is declining as a function of xL
                                                                A over the relevant range of values of

xL                              L
 A from 0 to 1/4 and further θ(xA = 0) = 1/16, corresponding to the cutoff θN M = 1/16 for a

no mixing equilibrium, and θ(xL
                              A = 1/4) = 0, corresponding to a full mixing equilibrium where

partisans of both towns follow identical decision rules. That is, there is a one-to-one relationship
between θ and xL      L
               A for xA between 0 and 1/4, and therefore a unique equilibrium of this form for

each value θ < θN M . Substituting xL                                          L
                                    A = 0.2 into the equations above yields θ(xA = 0.2) = 37/2000,

y1 = 0.13 and y2 = 0.87 – the values used in the example in the text.



Example 3 Suppose that there are three types x = 0, 21 , and 1 with associated probabilities 41 , 12 ,
      1
and   4   that v(x, y) = xy, and that θ = 1/32.

   In a neighborhood school equilibrium with two equal sized districts, low types enroll in district
1, high types enroll in district 2 and middle types divide equally between the two districts. Then,
as in Example 1, y1 = 14 , y2 = 34 , p1 = 1/32 and p2 = 9/32. Further, the value of θ is exactly high
enough so that each type is indifferent between enrolling in town t and choosing the outside option.
(We assume that all types break ties by remaining in town t.)
   With a school choice rule, the value of θ is not high enough for all types to enroll in town t.
But there is an equilibrium where high and low types choose the outside option, while middle types
                                 1
enroll in town t with ySC =      2   and pSC = 1/8. Thus, high and low types are indifferent between
the two assignment rules, as they get utility equal to the value of the outside option in each case.
However, middle types strictly prefer the school choice equilibrium.


                                 √                               y 1.5                2y 1.5
Example 4 Assume that v(x, y) = x y, which yields p(y) =           3     and π(y) =     3 .    Assume further
that the distribution of types (x) is (primarily) discrete with P (x = 0) = P (x = 1) = 0.5 − ε − ε2 ,
P (x = 1/4) = 2ε, and a Uniform distribution with total probability 2ε2 for other values of x between
0 and 1.



                                                    47
   This is an extreme example in which any two district neighborhood school equilibrium that
separates low types at x = 0 from high types at x = 1 will necessarily have school qualities that
are as far apart as possible – y1 (m) = 0 and y2 (m) = 1 for any division point m between the
two districts such that 0 < m < 1. Assuming market pricing, then p2 = p(y2 = 1) = 1/3 and
p1 = p(y1 = 0) = 0.       In a market pricing equilibrium, the marginal type x = m is indifferent
between districts 1 and 2 when types in the range [0, m] enroll in district 1 and types in the range
                                    √           √                                       √      √
[m, 1] enroll in district 2 - i.e. m y1 − p1 = m y2 − p2 or equivalently p2 − p1 = m( y2 − y1 ).
So given y1 = 0, y2 = 1, p1 = 0, p2 = 1, this requires that the marginal type is m = 1/3.
   As in Example 1, the choice of θ must satisfy three rationality constraints to support a neigh-
borhood school equilibrium of this form: types x = 0, x = m = 1/3, and x = 1 must prefer
the equilibrium neighborhood school outcome to the most preferred outside option with respective
payoffs π(0), π(m), and π(1). Of these condition 2 is the strictest, with gain function G(1/3, 0)
               2
= π(1/3) =    32.5
                     = 0.1283. (Additional numerical analysis confirms that the cutoff θ(m) as a
function of the boundary value m between the two districts is minimized at m = 1/3).               By
contrast, a school choice equilibrium for all students in (0, 1) yields school quality 0.5 and cost
                                      √
functions G(0, 1/2) = p(1/2) = 1/(6 2) = 0.1179 and G(1, 0.5) = π(1) − v(1, 0.5) + p(0.5) =
      √
2/3 − 0.5 + 13 (0.5)1.5 = 0.0774. Thus, there is a school choice equilibrium with all students choos-
ing to live in town t for θ ≥ max(0.1179, .0774) = 0.1179. But then for 0.1179 < θ < 0.1283, there is
a school choice equilibrium where all students choose to live in town t, but there is no neighborhood
equilibrium with two districts where all students choose to live in town t. This runs counter to
the intuition suggested by Example 1 that the conditions for a neighborhood equilibrium with 2
(or more) districts should be weaker than the condition for a school choice equilibrium where all
students choose to live in town t. There is a clear, but unusual intuition for this feature in this
extreme example.      A neighborhood school rule typically has a relative advantage over a school
choice rule in attracting partisans because it creates differentiated schools, where some have partic-
ular appeal to high types and others have particular appeal to low types. But here with the point
masses near x = 0 and x = 1 in the distribution of types, the specialized schools are so extreme
that they tend to drive partisan middle types to choose the outside option, whereas a school choice
rule is always attractive to these types.
   At the same time, there is also a natural division of these types with a neighborhood school
assignment rules into three districts with school qualities y1 = 0, y2 = 1/4, and y3 = 1.       Then
there is a market pricing neighborhood school equilibrium with cutoffs x1 = 1/12 and x2 = 7/12.



                                                 48
With these choices, there is a neighborhood school equilibrium with these cutoffs whenever there is
a school choice equilibrium attracting all partisan types to town t That is, even with an extreme
distribution of types, a neighborhood assignment rule with a sufficient number of districts to produce
options relatively close to each type’s ideal point in school quality (at market prices) should still
attract a wider range of partisan types to enroll in town t than does a school choice rule. Alternately,
if we alter the distribution of types even slightly - for example, by moving the mass points in the
distribution of types from x = 0 and x = 1 to x = 0.05 and x = 0.95, then there is a two district
neighborhood school equilibrium where all partisan types enroll in town t whenever there is a school
choice equilibrium where all partisan types enroll in town t.




                                                  49
