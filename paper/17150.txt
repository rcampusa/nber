                                NBER WORKING PAPER SERIES




       PERFORMANCE EVALUATION OF ZERO NET-INVESTMENT STRATEGIES

                                            Òscar Jordà
                                           Alan M. Taylor

                                        Working Paper 17150
                                http://www.nber.org/papers/w17150


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      June 2011




Taylor has been supported by the Center for the Evolution of the Global Economy at UC Davis and
Jorda by DGCYT Grant (SEJ2007-63098-econ); part of this work was completed whilst Taylor was
a Houblon-Norman/George Fellow at the Bank of England, and later when he was a Senior Advisor
at Morgan Stanley; all of this research support is gratefully acknowledged. We thank Colin Cameron,
Miguel Delgado, Martin Evans, Pedro Gete, Gloria Gonz alez-Rivera, Guido Kuersteiner, Burkhard
Schipper, Enrique Sentana and seminar participants at the Federal Reserve Bank of San Francisco,
Georgetown University, Universidad Carlos III de Madrid, and University of California, Riverside
for comments and suggestions. Travis Berge and Yanping Chong provided superb research assistance.
All errors are ours. The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2011 by Òscar Jordà and Alan M. Taylor. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Performance Evaluation of Zero Net-Investment Strategies
Òscar Jordà and Alan M. Taylor
NBER Working Paper No. 17150
June 2011
JEL No. C14,C59,G14,G17

                                               ABSTRACT

This paper introduces new nonparametric statistical methods to evaluate zero-cost investment strategies.
We focus on directional trading strategies, risk-adjusted returns, and the investor’s decisions under
uncertainty as the core of our analysis. By relying on classification tools with a long tradition in the
sciences and biostatistics, we can provide a tighter connection between model-based risk characteristics
and the no-arbitrage conditions for market efficiency. Moreover, we extend the methods to multicategorical
settings, such as when the investor can sometimes take a neutral position. A variety of inferential procedures
are provided, many of which are illustrated with applications to excess equity returns and to currency
carry trades.


Òscar Jordà
Department of Economics
University of California, Davis
One Shields Ave.
Davis, CA 95616
ojorda@ucdavis.edu

Alan M. Taylor
Morgan Stanley
1585 Broadway, 38th Floor
New York NY 10036
and NBER
alan.taylor@morganstanley.com
When is an investment opportunity attractive? In the standard set-up with frictionless,
complete markets, asset pricing theory says that the representative investor’s attitude
toward risk, and the desire to insure against variation of consumption across diﬀerent states
of nature, determines the price of each asset. In this ideal world there is no opportunity to
arbitrage returns between any two assets (in risk-adjusted terms) if markets are eﬃcient.
    Reality is more complex. Investor’s preferences are unknown and possibly heteroge-
neous; markets are incomplete; trading frictions abound; and an asset’s risk and returns
can only be characterized with ﬁnite samples of data. This paper proposes nonparametric
statistical methods to evaluate zero-net investment strategies which build on the canoni-
cal notion of absence of arbitrage and allow returns to be risk-adjusted. These methods
turn out to have a natural connection to the concept of the gain-loss ratio introduced in
Bernardo and Ledoit (2000) in the context of asset pricing in incomplete markets, among
other features that we now brieﬂy discuss.
    Simple directional long-short designs are amongst the most basic trading strategies
and represent an important and widely used class of investment rules, the currency carry
trade being a classic example (see, e.g. Jordà and A. M. Taylor, 2009). At a theoretical
level, even if we cannot forecast returns as judged by the prediction’s mean squared error
(MSE), the ability to systematically sort the long-short direction might yield signiﬁcant
excess returns and would be suﬃcient to reject the risk-neutral eﬃcient markets hypothe-
sis. Moreover, when the statistical model is only an approximation, diﬀerent loss functions
result in diﬀerent models and parameter estimates, and therefore possibly diﬀerent con-
clusions about the usefulness of a particular model (see Hand and Vinciotti, 2001). The
methods we propose here do not eliminate this dependence on the unknown loss function
for the investor, but go a long way to minimize its inﬂuence to facilitate comparability.


1    Accuracy, Direction, and Arbitrage
The problem of evaluating the risk-adjusted excess returns of an investment can be cast
as a zero-net investment strategy with respect to the risk-free rate. Fundamental mod-
els of consumption-based asset pricing in frictionless environments with rational agents
endowed with continuously diﬀerentiable von Neumann-Morgensten utility indicate that
risk-adjusted excess returns should be zero, that is

                                      Et−1 (mt xt ) = 0,                                 (1)


                                              1
where mt denotes the stochastic discount factor given by the investor’s intertemporal
marginal rate of substitution, and xt denotes ex-post excess returns (Cochrane, 2001).
   An example of xt is a currency carry trade with xt = Δet + (i∗t−1 − it−1 ), and where et
denotes the logarithm of the (home) exchange rate and i∗t−1 − it−1 the one period interest
rate diﬀerential, ‘foreign’ minus ‘home.’ Another example of xt is an investment where
the trader arbitrages the expected returns of a risky asset with the risk-free rate by going
short/long in one and taking the opposite position in the other. For the moment, we
abstract from many well-known frictions, such as short-selling constraints, transactions
fees, and so on.
   Under such conditions, one may presume that it would be diﬃcult for an econometrician
to predict xt given information available up to time t − 1 and this seems to be generally
the case. For example, see Kilian and M. P. Taylor (2003) for a survey on currency trades,
or the seminal work of Meese and Rogoﬀ (1983); and see Goyal and Welch (2008) for a
survey on equities. However, the trader faces a simpler problem, that of determining what
to short and what to go long in. Thus, the realized returns of the trading strategy based
   t are:
on x
                                      t = sign(
                                      μ         xt )xt .                                 (2)

                 t may simultaneously be a poor forecast, as judged by mean squared
Notice then that x
error, yet consistently determine the proﬁtable direction of trade. This observation is one
more example of the interplay between forecasting and decision theory discussed in Granger
and Machina (2006) and references therein, that is, that the usefulness of a forecast depends
on the rewards associated with the actions taken by the agent as a result of the forecast.
   A simple example illustrates this observation further. Table 1 summarizes a hypo-
thetical investment problem, a one-period currency return, say, which has four discrete
outcomes: percentage returns of -2, -1, +1, and +2, and each outcome is equiprobable.
Two trading signals are available to the investor. Signal A is perfectly accurate in predict-
ing the ±1 outcomes but has an additive white noise N (0, 10) error on the ±2 outcomes.
Signal B is just the opposite, it provides accurate predictions of the ±2 outcomes but has
the same additive N (0, 10) error as signal A for the ±1 outcomes. Which signal will the
investor prefer?
   The statistical mean squared error criterion is completely uninformative: both signals
attain the same RMSE of 7.071. However, measuring the directional accuracy of each
signal may also be misleading since signal A predicts the correct direction of trade 78.96%


                                              2
              Table 1: Mixed Signals: RMSE versus Direction versus Proﬁtability
Signal type         Outcome y           Signal x          RMSE           Correct sign (%)          Proﬁt
A                   y = ±1              x=y               7.071                78.96               0.6585
                    y = ±2              x=y+
B                   y = ±1              x=y+             7.071                76.99               1.0398
                    y = ±2              x=y
Note:  ∼ N (0, 10) is an i.i.d error. RMSE denotes root mean squared error of the prediction.


of the time, whereas signal B predicts the correct direction of trade 76.99% of the time,
although the diﬀerence is small. Yet a risk-neutral investor motivated by returns would
clearly ﬁnd signal B (with a yield of 1.04) much more proﬁtable than signal A (with a yield
of 0.66).
    The purpose of this numerical example is simple. What matters to investors is not
predictive accuracy as usually measured by statisticians by RMSE type measures of ﬁt.
What matters is the ability to get direction right, especially when big proﬁts or losses are
at stake. If that is the right performance measure, we need to develop tools better suited
to the purpose of directional classiﬁcation, with allowance for variable payoﬀs.
    More generally, denote the ex post correct direction of trade as dt = sign(xt ) ∈ {−1, 1},
with −1 denoting a long-side loss (trader should go short), and +1 a long-side gain (trader
should go long). Let 
                     δ t denote a scoring classiﬁer for dt such that dt = sign(
                                                                                δ t − c) and
c ∈ (−∞, ∞) is a threshold parameter.                          t , or even m
                                      δ t can be set just to be x             tx
                                                                                t but more
broadly, it can denote a probability forecast from binary regression, a single-index from a
dimension reduction procedure, an ordinal variable generated from a discrete state-space
model, and so on. All that is required is for 
                                              δ t to be a scalar that takes values in (−∞, ∞).
    In what follows we focus on evaluating the classiﬁcation ability of 
                                                                        δ t ,. We concentrate
directly on the trader’s classiﬁcation problem ﬁrst, and then expand these methods to
introduce risk-weighted returns into the statistics that we present.1 We ﬁrst explain some
advantages of our approach.
    1
      We do not focus on the best method to generate    δ t itself, for which the literature oﬀers numerous
alternatives. For example, Elliott and Lieli (2007) provide a formal treatment of how the estimator can be
tailored to the agent’s speciﬁc utility function.




                                                     3
2        What’s New
In economics and ﬁnance, works by Henriksson and Merton (1981) and Merton (1981),
later formalized in Pesaran and Timmermann (1992), provide well known tests of direc-
tional accuracy. These tests were later extended to include raw returns by Anatolyev and
Gerko (2005). However, the problem of assessing classiﬁcation in binary-outcome decision
problems has a much longer tradition in statistics, and it is within this tradition that we
craft some new methods and seek to build a tighter nexus to the economics of the problem.
        This older tradition has its origin in the ﬁeld of signal detection theory (Peterson
and Birdsall, 1953) with the introduction of the receiver operating characteristic (ROC)
curve. ROC-based methods are used extensively to evaluate diagnostic tests from diﬀerent
biomarkers in medicine, as well as to rank radiological readings (see Pepe, 2003 for an
extensive monograph; and Zhou, Obuchowski and McClish, 2011 for a monograph on
diagnostic medicine). But these methods are also common in other ﬁelds of science, such
as in psychometrics (see Swets and Pickett, 1982), machine learning (see Spackman, 1989),
and atmospheric sciences, where ROC methods form part of the World Meteorological
Organization’s Standard Veriﬁcation System for assessing the quality of weather forecasts
(see Stanski, Wilson and Burrows, 1989; and World Meteorological Organization, 2000).
        The procedures that we examine are closely related to the theory of rank tests (see,
e.g. Hájek, Šidák, and Sen 1999) in that they essentially measure the distance between
two distributions, that is, the empirical distribution of the forecast signal for the long-short
direction versus the distribution for the short-long direction. There are many procedures
that measure the distance between two distributions, perhaps the best-known being the
Kolmogorov-Smirnov statistic.2 However, even in the simplest case, in which there are no
estimated parameters, no conditioning variables, and the data are i.i.d., the distribution
of the statistic is characterized by a function of a Brownian Bridge. The analysis of more
general cases requires an advanced toolkit from empirical process theory.3
    2
      See Kolmogorov (1933) and Smirnov (1939); a more modern reference is Shorack and Wellner (1986).
    3
      See Kosorok (2008) and Shorack and Wellner (1986). Some references are available in the economet-
rics literature. For example, Bai (1994) provides some weak convergence results for sequential empirical
processes of residuals in ARMA models; Andrews (1997) introduces conditional Kolmogorov-Smirnov tests
for parametric models with regressors; Bai (2003) uses the Khamladze transform (Khamaladze, 1981) to in-
troduce nonparametric tests for parametric conditional distributions of dynamic models. And if one thinks
of the problem in terms of stochastic dominance of the empirical distribution for the long-short direction
over the distribution for the short-long direction, one could apply Linton, Maasoumi and Whang’s (2005)
extended Kolmogorov-Smirnov resampling procedures, for example (see also references therein).



                                                    4
   Instead, the methods we propose build on the Mann-Whitney rank-sum statistic, whose
large-sample distribution has been shown to be Gaussian (Hsieh and Turnbull 1996). Thus,
                                                               √
if trading signals come from a conditional model with the usual T parametric rate of con-
vergence to normality, the large-sample distribution remains Gaussian. Furthermore, Bickel
and Freedman (1981) provide justiﬁcation for the bootstrap, and some of the inferential
procedures we discuss are based on the distribution-free permutation approach (see Mielke
and Berry, 2007). As a result, inference in our framework is fairly straightforward.
   Simplicity of implementation aside, we structure the statistical problem as an economic
decision under uncertainty and for this purpose we introduce a variant of the ROC curve
that we call the correct classiﬁcation (CC) frontier. The virtue of the CC frontier is that
it summarizes the space of all possible trade-oﬀs implied by a particular set of preferences
over an investment strategy. Thus, a strategy that is more successful in correctly pre-
dicting long-short positions may nevertheless be particularly vulnerable to extreme events,
whereas a less successful strategy may still produce positive returns, but with better pro-
tection against catastrophic losses. Traditional statistics for the evaluation of binary deci-
sion problems (such as log and quadratic probability scores, Brier scores, Kuipers scores,
misclassiﬁcation probabilities, and some of the tests we have discussed above) often lack
suﬃcient texture to frame the problem and are only appropriate as long as the implied loss
function coincides with that of the investor. Instead, our analysis of the CC frontier allows
one to visualize the regions in which these trade-oﬀs take place.
   Forcing the investor to continuously arbitrage the returns between two assets is some-
what restrictive, especially in more realistic situations where the expected returns to the
arbitrage are insuﬃcient to cover transactions costs. For this reason, we also investigate
more complex multicategorical investment strategies, the simplest of which allows the in-
vestor to remain in a neutral “cash” position in addition to taking a long/short position.
   This and many of the procedures that we discuss are illustrated with two empirical
applications. The ﬁrst application is based on Goyal and Welch’s (2008) state-of-the-art
investigation of signals that help forecast U.S. equity returns. Our aim is to examine
the value of these signals in constructing proﬁtable investment strategies where one bor-
rows/lends at the risk-free rate to purchase/sell U.S. equities. We ﬁnd out-of-sample ev-
idence that several of these signals generate consistently proﬁtable trades in contrast to
Goyal and Welch (2008), whose results are based on the conventional performance metric
of mean squared error loss (MSE), which may be relevant for statisticians, but not so much
for portfolio managers.

                                              5
    A second application focuses on currency carry trades in which a speculator borrows
in one currency to invest in another, thus arbitraging the interest rate diﬀerential while
bearing the risk of a possibly adverse exchange rate movement. Berge, Jordà and A. M.
Taylor (2011) discuss four basic carry trade strategies where an investor’s only choices are
which currency to go short and which to go long. In practice though, transactions costs
and other considerations may make some of the trades unproﬁtable when predicted returns
before costs are small. Thus, we examine long/cash/short strategies using these four carry
trade investments and ﬁnd that the more sophisticated methods rank the preferred strate-
gies somewhat diﬀerently compared to the case where only binary long/short strategies
were considered.


3    The Trader’s Classiﬁcation Problem
The following contingency table summarizes the four conditional probabilities associated
with the {prediction,outcome} pair {
                                    δ t , dt } :



                                          Prediction

                                         Negative/Short                   Positive/Long
                                                                                             
Outcome       Negative/Short      T N (c) = P δ t < c|dt = −1     F P (c) = P δ t > c|dt = −1
                                                                                            
              Positive/Long       F N (c) = P δ t < c|dt = +1     T P (c) = P δ t > c|dt = +1



Here T N (c) and T P (c) refer to the true classiﬁcation rates of negatives (dt = −1) and
positives (dt = 1); and F N (c) and F P (c) refer to the false classiﬁcation rates of negatives
and positives. Clearly, T N (c) + F P (c) = 1 and F N (c) + T P (c) = 1. In statistics, T P (c)
is sometimes also called sensitivity and T N (c), speciﬁcity.
    It may also be helpful to think of 
                                       δ t as the value of a test statistic and c as its critical
value. Then F P (c) would refer to the Type I error rate or size of the test, and T P (c) its
power, or T N (c) as the Type II error. The probability measure P (.) can be conceived more
broadly as reﬂecting the risk-neutral measure or even as reﬂecting risk-adjusted probabili-
ties, as we shall see.


                                                6
   The space of combinations of T P (c) and T N (c) for all possible values of c ∈ (−∞, ∞)
summarizes a sort of “production possibilities frontier” (to use the traditional microeco-
nomics nomenclature in a market for two goods) for the classiﬁer δ t , that is, the maximum
T P (c) achievable for a given value of T N (c). We will call the curve that summarizes all
possible combinations {T N (c), T P (c)} the correct classiﬁcation frontier or CC frontier.
   Of course, this is not the only way to summarize the performance of the classiﬁer. Note
that F P (c) = 1 − T N (c), so another curve that is widely used in statistics and that sum-
marizes all possible combinations {F P (c), T P (c)} is the receiver operating characteristic
(ROC) curve, as we discussed in the introduction. And combinations {F N (c), T N (c)} can
be collected in a plot that is called the ordinal dominance curve (ODC) as discussed in
Bamber (1975). Notice that the CC frontier and the ROC curve are the mirror image of
one another (if one were to place the mirror at the vertical axis).
   A stylized plot of a CC frontier is presented in Figure 1. Notice that as c → −∞
then T P (c) → 1 and T N (c) → 0, and the limits are reversed as c → ∞. For this reason,
it is easy to see that the CC frontier lives in the unit square [0, 1] × [0, 1]. A perfect
classiﬁer is one for which T P (c) = 1 for any T N (c) and this corresponds to the north
and east sides of the unit-square. An uninformative classiﬁer on the other hand, is one
where T P (c) = F P (c) = 1 − T N (c) ∀c and this corresponds to the north-west/south-
east “chance” diagonal. Using the language of the pioneering statistician Charles Sanders
Peirce (1884), the classiﬁers corresponding to these two extreme cases would be referred
to as the “infallible witness” and the “utterly ignorant person” (Baker and Kramer 2007,
343). Most CC frontiers in practice live in-between these two extremes.

3.1   The Trader’s Decision Problem
The interaction of the CC frontier with the investor’s utility over the two choices short/long
provides a convenient decision framework with a long tradition that perhaps dates as far
back as Peirce’s (1884) ‘utility of the method.’ In modern parlance, Peirce’s (1884) concept
is akin to expected utility maximization and can be formulated in terms of the optimal
threshold parameter c as follows:

                  U (c) = UpP T P (c)π + UnP (1 − T P (c))π +                             (3)
                             UpN (1 − T N (c))(1 − π) + UnN T N (c)(1 − π).




                                              7
                             Figure 1: The Correct Classiﬁcation Frontier


                      !

                                                         
                       


                      


           


                      "                  


                      !                                         



                       
                                                                                         


                                                   


                        
                                                  !       "                     !
                                                               




where π = P (d = 1), that is, the unconditional probability of a positive; and UaA for a ∈
{n, p} and A ∈ {N, P } is the utility associated with each of the possible four states deﬁned
by the {classiﬁer, outcome} pair. Notice that since T P (c) + F N (c) = 1 = T N (c) + F P (c),
everything can be expressed in terms of the true classiﬁcation rate alone.
   It is instructive to discuss a few special cases ﬁrst to gain further intuition. For a
risk-neutral investor, it would be natural to normalize his utility symmetrically such that
UpP = UnN = 1 and UnP = UpN = −1. Further, if returns are themselves symmetric as
well (i.e. π = 1/2), then the investor’s utility is maximized where the marginal rate of
substitution between true positives and true negatives is −1.
   It turns out that the vertical distance between this maximum point on the CC fron-
tier and the chance diagonal is the same distance that forms the basis of the well-known

                                                              8
Kolmogorov-Smirnov (KS) statistic:
                                                              
                                         T N (c) + T P (c)   1  
                            KS = max 2                    −    ,
                                  c               2           2 

that is, the maximum diﬀerence between the average correct classiﬁcation rate and the
average rate of an uninformative classiﬁer for which T P (c) = 1 − T N (c) ∀c, scaled by 2
so that KS ∈ [0, 1]. We make a brief detour to discuss some of the salient features of this
special case before we introduce the methods that we propose.
    Intuitively, the KS statistic measures the uniform distance between the empirical dis-
tribution of 
             δ when d = −1 and the empirical distribution of 
                                                             δ when d = 1. For this reason,
the KS statistic is useful in determining the stochastic dominance features of two invest-
ment strategies (see, e.g., Linton, Maasoumi and Whang, 2005 and references therein).
   In a sample with T observations, let TN and TP indicate the number of observations
for which d = −1, 1 respectively, using the mnemonics N for negative and P for positive.
For a given threshold c, the ﬁnite sample correct classiﬁcation rates can be calculated
nonparametrically as:
                                                                                    
                              TP                                     TN       
                              i=1 I     δi > c                        j=1 I     δj < c
                
                T P (c) =                          ;       T
                                                            N (c) =                        (4)
                                  TP                                      TN

where the indices i, j relabel the original t subscript to keep the notation simple, and run
over two sets of re-numbered observations, with each one mapping to a unique t such that
dt = 1(−1), respectively and I(.) ∈ {0, 1} is the indicator function that takes on the value
of 1 when the argument is true and 0 otherwise. When     δ is i.i.d. and is not generated by
a ﬁtted model with estimated parameters (such as the ‘momentum’ strategy in one of our
carry trade examples below), then:

                                        TN TP 
                                              KS → sup |B(t)|                              (5)
                                          T         t

where B(t) is a Brownian-bridge, that is, B(t) = W (t) − tW (1) where W (t) a Wiener
process (see e.g. Shorack and Wellner, 1986). Notice that KS ∈ [0, 1] and is equivalent to
the maximum of the Youden (1950) J index, which is deﬁned as

                                      J(c) = T P (c) − F P (c).                            (6)



                                                       9
                                                                           1
Under the symmetry assumption that P (d = −1) = P (d = 1) = π =            2,   a risk-neutral
investor will want to maximize the J index out of which one can identify the optimal
operating point as the threshold cKS where KS = J(cKS ).
   Several practicalities deserve comment. Investment strategies are often the result of
models with estimated parameters, in which case, the distribution of the KS statistic has
to be recalculated as shown by Rubin (1973). See also Andrews (1997) for conditional KS
asymptotic results which require the bootstrap. Linton, Maasoumi and Whang (2005) pro-
vide tests of stochastic dominance based on the KS statistic but these require resampling
procedures. Bai (2003) probably contains the most relevant results for tests of parametric
conditional distributions of dynamic models derived from empirical process theory using
the Khamaladze (1981) martingale transformation. However, the test’s critical values have
to be obtained by simulation in each case.
   If instead one uses utility weights of 1 for correct calls and 0 for incorrect calls, then
expression (3) is just the accuracy rate:

                              A(c) = T P (c)π − T N (c)(1 − π)

whereas exchanging these weights, we obtain the error rate:

                             E(c) = F N (c)π + F P (c)(1 − π).

But the accuracy and error rates sum to one, so these are inversely related and attain their
respective maximum and minimum for the same choice of c.
   We can now begin to see that the KS statistic is applicable only in a very special
case. If positive and negative outcomes are equiprobable and if the utility from correct
predictions (whether positive or negative) is normalized to be the same and equal to 1, and
conversely that the disutility from incorrect predictions (whether positive or negative) is
the same and equal to −1, expression (3) simpliﬁes in such a way that U (c) = J(c), and

                                   1 + J(c)                   1 − J(c)
                          A(c) =            ;        E(c) =            .
                                      2                          2

Thus, for this case only, all performance measures are monotonic in J(c), and on all per-
formance criteria, the same optimal c will be chosen.
   In the seminal work of Peirce (1884), the expression for J(c) was referred to as “the
science of the method” and the general expression for U (c) as “the utility of the method”

                                                10
(Baker and Kramer 2007). In Peirce’s example, the applied problem was forecasting tor-
nadoes, and his hypothetical utility weights corresponded to the net beneﬁts of lives saved
under true positives versus the costs of wasted resources or panic under false positives.
   But in general, as Peirce understood, the choice of c that maximizes U need not be
the one that maximizes J (or the accuracy rate discussed previously). In what follows we
explore methods that allow π and Uij to be generic. In ﬁnance problems, for realism, we
want to allow the Uij to be unrestricted since payoﬀs vary continuously, and we also want
                    1
to allow for π =   2   to admit the possibility of skewed payoﬀ distributions.
   Whether realized returns are systematically positive and signiﬁcantly diﬀerent from
zero is determined primarily by a classiﬁer’s properties. In general settings, the utility
derived from a given classiﬁer will depend on the investor’s attitude toward risk since
each investment strategy is characterized by diﬀerent combinations of returns, volatility
and extreme events. Thus, the maximum of the Youden J index obtained from the KS
statistic in expression (5) insuﬃciently characterizes an investor’s choices—in other words,
the simplifying assumptions used to derive expression (5) may not hold in practice.
   To sidestep this problem, the CC frontier allows us to make comparisons among classi-
ﬁers without speciﬁc assumptions about underlying preferences by considering all operating
points simultaneously. Given the CC frontier’s usefulness, it is helpful to develop some
further intuition about its shape and the properties of the optimal operating point.
   The CC frontier can be deﬁned in terms of two distributions. Let u denote values of 
                                                                                       δ
for which d = 1 and denote G its distribution and g its density so that T P (c) = 1 − G(c).
Similarly, let v denote values of 
                                  δ for which d = −1 and denote F its distribution function
and f its density so that T N (c) = F (c).
   We can now use the distributions F and G to deﬁne the CC frontier. Let us denote by
CC(r) the true positive rate corresponding to a true negative rate of r (since c uniquely
determines both rates, this mapping is one-to-one). Hence CC(r) = 1 − G(F −1 (r)) with
r ∈ [0, 1]. Notice then that the maximum utility from expression (3) is achieved when

                           dCC(r)   g(F −1 (r))    1 − π (UnN − UpN )
                                  ≡     −1
                                                =−                                       (7)
                             dr     f (F (r))        π (UpP − UnP )

so that it is easy to see that the slope of the CC frontier is the likelihood ratio between
the densities f and g. If this likelihood ratio is monotone, then the CC frontier is concave.
In practice, one can make parametric assumptions about f and g and hence construct
parametric models of the CC frontier. However, in the remainder of the paper we restrict

                                                 11
our attention to nonparametric estimators because returns distributions are often poorly
characterized by conventional Gaussian assumptions. The reader is referred to Pepe (2003)
for an overview of parametric ROC models, which can be applied to CC frontier estimation.
    The main point of the last equation is to show that, in general, the optimal operating
point is at a slope that is skewed away from −1 in a way that depends on the relative
probability of each outcome, and the utility weights. For example, in the last expression,
suppose P is the event “cancer of type X” and upon that signal surgery will occur. All
else equal, i.e., holding utility weights constant, if X gets very rare (π smaller, and the ﬁrst
fraction is larger), then a more conservative classiﬁer should be used, with CC frontier
steeper at the optimal point, typically nearer to (1,0) in Figure 1. On the other hand,
holding the probability π constant, if, say, X is a more dangerous type of cancer then the
costs of a false negative (UnP ) go up all else equal, then the second fraction gets smaller,
and a more aggressive classiﬁer should be used, with CC frontier ﬂatter at the optimal
point, typically nearer to (0,1) in Figure 1.
    These results are very intuitive indeed, although again we caution that the utility space
is limited to four discreet outcomes, a restriction we shall seek to relax in a moment as we
adapt these techniques for applications with variable payoﬀs in economics and ﬁnance.


4    Building Blocks: The Area under the CC Frontier
In this section we introduce an alternative statistic to the KS that will form the basis for
the procedures that we discuss below. Several advantages will become apparent throughout
the discussion, among them, more convenient asymptotic properties and a tighter link to
the investor’s decision problem.
    From Figure 1 it is clear that an arbitrage opportunity occurs for a perfect classiﬁer.
In that case the CC frontier in Figure 1 is given by the north-east edges of the unit-square
and the tangent to the investor’s utility takes place at the (1,1) corner so that the investor’s
speciﬁc preferences become irrelevant. The area under this CC frontier, which we denote
AU C for area under the curve, is the area in the unit-square and therefore AU C = 1.
Conversely, an uninformative classiﬁer given by the chance diagonal that bisects the unit-
square from (1,0) to (0,1) has AU C = 0.5.
    In practice, the AU C for most investment strategies will be between these two values.
Values below 0.5 are possible in small samples but reversing the predictions would generate
an AU C ≥ 0.5.

                                                12
   Formally, we have the deﬁnition
                                                            1
                                              AU C =            CC(r)dr.
                                                        0

   We note that the AU C deﬁned here has the same properties as the area under the ROC
curve and the area under the ordinal dominance curve (see Hsieh and Turnbull 1996).
   Given two investment strategies, A and B such that CCA (r) > CCB (r) ∀r then A
stochastically dominates B regardless of investor preferences and it will be the case that
KSA > KSB and AU CA > AU CB . However, the reverse is not a suﬃcient condition for
stochastic dominance since even if KSA > KSB and/or AU CA > AU CB , there could be
a crossing between the two CC frontiers and hence regions where CCA (r) < CCB (r). In
such a case, whether A is preferred to B or vice versa depends on what region are investor
preferences tangent to the CC frontier. We will discuss momentarily several inferential
procedures, including tests of the null: H0 : CCA (r) = CCB (r).
   Before then though, we discuss several properties of the AU C. Green and Swets (1966)
provide a nice interpretation of the AUC as AU C = P [v < u] where v and u where
deﬁned in the previous section as the 
                                      δ for which d = −1, +1 respectively. Thus, like the
KS statistic, the AU C measures the distance between the empirical distribution for v and
u, except that instead of a uniform norm, we use:


           1                            1                                        1
               [F (c) − G(c)]dr =           [F (F −1 (r)) − 1 + CC(r)]dr =           CC(r)dr = AU C.
       0                            0                                        0


Not surprisingly, the AU C is related to the Wilcoxon-Mann-Whitney U -statistic (see Bam-
ber 1975; Hanley and McNeil 1982), which is a rank-sum statistic. The AU C can be
estimated nonparametrically and in the simplest form can be obtained as

                                               TN T P                                  
                               1                                     1
                        AU C=                           I (vj < ui ) + I (ui = vj )                    (8)
                              TN TP                                   2
                                              j=1 i=1


where the last term is used to break ties. However, we should point out that there are
alternative estimators based on making parametric assumptions for f and g, and other
kernel-weighted nonparametric estimators all of which are discussed, e.g., in Pepe (2003).


                                                        13
Here we prefer to retain the simpler estimator presented in (8) for reasons that will become
clear momentarily.
       The empirical AU C turns out to have convenient statistical properties. If TP /TN →
λ > 0 as T → ∞; F and G have continuous densities f and g respectively; and the slope
of the CC frontier is bounded on any subinterval (a, b) of (−1, 0), with −1 < a < b < 0;
then Hsieh and Turnbull (1996) show that:

                               √                          
                                   
                                T AU C − P [v < u] → N 0, σ 2 ,                                        (9)

and in the special case that F = G (which is the null case in which there is no classiﬁcation
ability), then P [v < u] = 0.5 and:4

                                                               
                                         2  1          1    1
                                        σ =              +          .
                                            12        TN   TP

We make one ﬁnal comment on the eﬀect of estimated parameters on the large sample
results available for the AU C. The intuition is fairly straightforward to communicate: if
                                                                            √
the estimated parameters converge in distribution to a normal at the same T rate as the
AU C, the asymptotic result in expression (8) remains valid except that the variance of the
AU C would need to reﬂect parameter estimation uncertainty as well—an issue that can
be easily resolved in practice by using the bootstrap.5
   4
     The proof of this result can also be derived from the theory of empirical processes using lemma 12.3
and theorem 2.8 in Kosorok (2008), who also shows in theorem 12.1 that the delta method bootstrap is
applicable and can be used under more general hypotheses on F and G. The result hinges on CC(r) being
a Hadamard diﬀerentiable map, a convenient assumption which cannot be veriﬁed in practice.
   Hanley and McNeil (1982) and Obuchowski (1994) provide a convenient approximation for the variance
of AU C under general conditions using the Mann-Whitney interpretation of the AU C. However, DeLong,
DeLong and Clarke-Pearson (1988) provide a more general formula that is available in SAS and STATA
and allows for correlated AU Cs. Jackknife procedures are available in Hanley and Hajian-Tilaki (1997) and
Obuchowski and Lieber (1998) provide standard bootstrap results under a variety of assumptions, although
large sample approximations have been found to do well in relatively small samples (Pepe 2003).
   5
     Early proofs can be found in Darling (1955) and Durbin (1973), although Bai (2003) contains a more
modern treatment, and in particular, assumptions A1-A4 in theorem 1. Without repeating the assumptions
here, one needs the densities f and g and the score functions to be continuously diﬀerentiable with respect
                                                                                                       √
to the parameter vector. The parameter estimates are assumed to converge in distribution at rate T .
Bai’s fourth assumption ensures that, for dynamic models, past information becomes less relevant as time
progresses. For another treatment of the same problem the reader is referred to theorem 19.23 in van der
Vaart (1998).




                                                    14
5    Inferential Procedures with AUCs
This section discusses four inferential procedures: (1) tests of the null that an investment
strategy picks proﬁtable positions no better than random luck; (2) tests of he null that
two strategies have the same AU C (an overall comparison); (3) tests of the null that two
strategies have the same CC frontier at all operating points; and (4) conﬁdence intervals
for the CC frontier at speciﬁc operating points.
   To test against the random null, the large-sample results in the previous section provide
                             
the sampling distribution of AU C, which can be used to construct Wald tests for the null
                 1
that AU C =      2.   If the strategy is based on a model with estimated parameters, then
the bootstrap percentiles, bootstrap-z or the bootstrap bias-corrected accelerated method
discussed in Obuchowski and Lieber (1998) should be used.
    For comparing the value of two AU Cs, Hanley and McNeil (1983) suggest that a test
of H0 : AU CA = AU CB can be constructed using the z-ratio

                                 AU CA − AU CB
                             z=                        → N (0, 1),                        (10)
                                σ 2A + σ 2B − 2ρσ A σ B

where σ 2j for j ∈ {A, B} refers to the variance of the AU C for each investment strategy, and
ρ refers to the correlation between AU CA and AU CB . Hanley and McNeil (1983) propose
estimating ρ as the average of the correlation ρ(vA , vB ) for the short positions and the
correlation ρ(uA , uB ) for the long positions.
    However, as discussed in the previous section, which investment strategy an investor
will prefer cannot be assessed with this type of null, nor can one test whether a strategy
                            A (r) > CC
dominates another, unless CC          B (r) ∀r and H0 : AU CA = AU CB can be rejected.
A more appropriate hypothesis is H0 : CCA (r) = CCB (r) ∀r. Venkatraman and Begg
(1996) provide a test of this null using distribution-free permutation methods from which
p-values can be easily constructed by simulation, as follows.
                                                        A              B
   Let {SiA }Ti=1 and {SiB }Ti=1 denote the ranks of {
                                                      δ i }Ti=1 and {
                                                                     δ i }Ti=1 respectively (the
signals from each investment strategy). Let the index k = 1, ..., T − 1. Then deﬁne the
empirical error matrix by
                 ⎧
                 ⎨ 1 if (Si ≤ k, Si > k, di = −1) or (Si > k, Si ≤ k, di = 1),
                 ⎪          A        B                     A        B

         eik   =   −1 if (SiA > k, SiB ≤ k, di = −1) or (SiA ≤ k, SiB > k, di = 1),
                 ⎪
                 ⎩
                    0 otherwise,


                                                  15
and the associated statistic
                                                     
                                                T −1  T
                                                               
                                                               
                                                              
                                          E=              eik  .                                    (11)
                                                              
                                                k=1 i=1

It is easy to see that this statistic focuses on the diﬀerences in predictions at each k th oper-
ating point. To obtain the critical value for this statistic, one can obtain the percentile from
a large number of draws of the statistic (11) from randomly exchanging the ranks between
the two investment strategies and reranking them. To do this in practice, let (q1 , ..., qN )
denote randomly drawn sequences of 0’s and 1’s and generate resamples {SA , SB } using i    i


                     SiA = qi SiA + (1 − qi )SiB and SiB = qi SiB + (1 − qi )SiA

with a random coin-toss rule to break ties introduced by the permutation process.
       Finally, one may be interested in providing error bands for the CC frontier at a given
operating point (say the point that is tangent to the investor’s preferences). In principle,
such an interval can be constructed from the large sample results in Hsieh and Turnbull
(1996) as follows. For a given operating point r and a conﬁdence level 1 − α, then
                                  α     
                     
                S = CC(r) ± Φ−1 1 −    (r) ;
                                       σ                         P (CC(r) ∈ S) = 1 − α
                                    2

with:6                      −1         −1    −1  2
                         G  F  (r) 1 − G  F (r)   g F (r)    r(1 − r)
               σ 2 (r) =                        +     −1
                                                                      ,
                                    TP            f {F (r)}    TN

where one can substitute for all theoretical quantities with their empirical counterparts.
However, in more general situations than those contemplated in the assumptions in Hsieh
and Turnbull (1996) one would have to rely on straightforward bootstrap methods.
   6
     Pepe (2003) suggests that such intervals may be imprecise when r is close to 0 or 1 and proposes
instead a back-transformation of the interval generated by
                                                   α       σ
                                                               (r)
                                  
                           logit CC(r)    ± Φ−1 1 −                      .
                                                          
                                                      2 CC(r)       
                                                                1 − CC(r)

When there is reason to fear that the asymptotic approximation is inadequate, one can construct the usual
t-percentile bootstraps although Hall, Hyndman and Fan (2004) caution that the theoretical properties
of the bootstrap in this type of problem are quite complex because of the diﬀerent smoothing choices to
                         F, g, and f. The reader is referred to their paper to notice the oversmoothing
be made in calculating G,
bandwidths required to manage the coverage error rate to be o(T −2/3 ).



                                                    16
6        Adjusting for Returns and Risk
As we have stressed in our discussion so far, correct classiﬁcation alone is insuﬃcient to
assess the appeal of an investment strategy: correctly picking 99-in-100 penny trades while
missing the 1-in-100 dollar trade results in a loss although the strategy has almost perfect
directional accuracy.7 And when there are transactions costs, it is reasonable to expect
that a trader may choose to sit on the sidelines when the expected returns of a position
are insuﬃcient to cover transactions costs. In this section we show how such adjustments
can be made to the basic framework introduced in previous sections.

6.1       The Risk-and-Return-Adjusted CC Frontier: CC 
Risk-and-return-adjusted probability measures incorporate information about investor pref-
erences for consumption in diﬀerent states. It would be natural to characterize the relative
trade-oﬀs embodied in the CC frontier expressed in terms of risk-and-return-adjusted prob-
abilities. This can be done easily as follows. Deﬁne:

                                        B=          mt x t ,    C=          |mt xt |
                                              d=1                    d=−1

where mt is the pricing kernel derived for a benchmark risk-averse investor. Under risk
neutrality, mt = 1 and B then becomes the in-sample gains of all the long positions and
C the in-sample gains of all the short positions. Here we assume that the positions are
normalized to $1 for convenience and therefore, we do not take into account how the
benchmark investor’s endowment may or may not aﬀect his aversion to risk. B and C can
then be used to construct the following weights:

                       wi =    m i xi
                                B        if   δi > c and di = 1 for i = 1, ..., TP ,
                              |mj xj|
                      wj =      C        if δj < c and dj = −1 for j = 1, ..., TN ,

where, as before, it is understood that the indices i and j each map P and N outcomes
(respectively) to a unique observation t.
        Using these weights, the risk-and-return-adjusted equivalent to (4) can be calculated
    7
        For example, see Anatolyev and Gerko (2005), who build on Pesaran and Timmermann (1992).




                                                               17
as:
                                 TN                                  TP
                   T
                    N  (c) =         wj I(
                                           δ j < c),    T
                                                         P  (c) =         wi I(
                                                                                δ i > c),   (12)
                                j=1                                  i=1

so that the risk-and-return-adjusted CC∗ frontier, CC ∗ (r), is a map of all the combinations
{T N ∗ (c), T P ∗ (c)} for c ∈ (−∞, ∞). By construction, CC ∗ (r) still inhabits the unit-square,
with a CC∗ frontier hugging the north-east corner of the unit-square now representing
a perfect arbitrage opportunity and the ‘chance’ diagonal representing risk-and-return-
adjusted complete absence of arbitrage. Furthermore, now the slope of CC ∗ (r) represents
the likelihood ratio of the risk-and-return-adjusted densities f ∗ and g ∗ (the risk-and-return-
adjusted equivalents to f and g introduced earlier), weighted by returns.
      Notice that the expected gains, Γ(c), and losses, Λ(c), under the risk-and-return-
adjusted probabilities and for a given threshold parameter c are:

                      E ∗ (Γ(c)) = B.T P ∗ (c) + C.T N ∗ (c)                                (13)
                      E ∗ (Λ(c)) = B.(1 − T P ∗ (c)) + C.(1 − T N ∗ (c)),

where E ∗ denotes the expectation under the risk-and-return-measure. Hence, the investor’s
expected proﬁt ratio (that is, where we normalize expected proﬁts by the maximally at-
tainable proﬁts in the sample for cross comparability) can be expressed as:

                           E ∗ (Γ(c) − Λ(c))   B (2T P ∗ (c) − 1) + C(2T N ∗ (c) − 1))
            E ∗ (Π(c)) =                     =                                         .
                                 B+C                            B+C

In the special case where B = C, then it is easy to see that

                                        E ∗ (Π(c)) = 2 × J ∗ (c)

where J ∗ (c) is the risk-and-return-adjusted Youden (1950) index. Hence, proﬁt maximiza-
tion is achieved for c = c∗KS since

                      max 2 × J ∗ (c) = 2 × max |T P ∗ (c) + T N ∗ (c) − 1|,
                           c                       c

the latter being twice the KS ∗ statistic using risk-and-return-adjusted probabilities. In
this special case (B = C ), Bernardo and Ledoit’s (2000) gain-loss ratio can be simply




                                                   18
calculated as:
                                        maxc E ∗ (Γ(c))   1 + KS ∗
                                   α≡                   =          .
                                        maxc E ∗ (Λ(c))   1 − KS ∗
Note that the condition B = C is not saying that up and down moves are equally likely,
but that upside and downside cumulative returns are equal. This may be a very natural
assumption to make in some ﬁnancial markets, even if there are substantial deviations from
fair price or eﬃcient markets in the short run. For example, there is ample evidence that
long-run holding returns on diﬀerent currencies are identical, even if short-run carry trade
strategies seem to make proﬁts.8
      We pause our discussion momentarily to elaborate on this last equivalence to the
Bernardo and Ledoit (2000) gain-loss ratio and its implications for asset pricing. First
notice that, in the above equation, α → ∞ is an arbitrage opportunity: at least some gains
can be made without the possibility of any loss. This will happen when KS ∗ = 1, the
maximum value the KS ∗ can attain. Conversely, when KS ∗ = 0 (the minimum possible
value), then expected gains and losses (under the risk-and-return-adjusted measure) are
the same and α = 1. Values in-between these two extremes are approximate arbitrage op-
portunities. Figure 2 shows the value of α in {T P ∗ (c), T N ∗ (c)} to make the connection
with CC ∗ space.
      Moreover, theorem 1 in Bernardo and Ledoit (2000) provides an alternative charac-
terization of all pricing kernels that correctly price all portfolio pay-oﬀs and hence is an
alternative to, for example, the duality result in Hansen and Jaganathan (1991), which
show that a bound on the variance of the pricing kernel is equivalent to a bound on the
maximum Sharpe ratio. Bernardo and Ledoit (2000) argue that, unlike the Sharpe ratio,
α characterizes the set of arbitrage (α → ∞) and approximate arbitrage opportunities
(α > 1) and propose that for a given bound 1 < α < ∞, the benchmark model will be rea-
sonable if α ≤ α, but otherwise the model will be inconsistent with well functioning capital
markets. Therefore α controls the trade-oﬀ between the precision of a speciﬁc benchmark
pricing model and the robustness of no-arbitrage bounds. As an example, Bawa and Lin-
deberg (1977) showed that if returns are Gaussian, then there is a one-to-one mapping
with the Sharpe ratio under risk-neutrality so that, for example, a Sharpe ratio of 0.3 is
equivalent to α = 2. The reader is referred to Bernardo and Ledoit (2000) for more details.
      In practice, several features of the data can disturb this nice connection between KS ∗
and α, such as B = C, asymmetry of returns, and so on. And in reality, the investor’s
  8
      On the evidence for the long run, see Alexius (2001), Fujii and Chinn (2001), and Sinclair (2005).


                                                    19
                Figure 2: The Gain-Loss Ratio in {T P ∗ (c), T N ∗ (c)} Space

                                                                                                      
                                                                                                              
                                                                                                              
                                                                                                              
                                                                                                             
                                                                                                             
                                                                                                             
                                                                                                             
                                                                                                             
                                                                                                       
                                                                                                       
                                                                                                   
                                                                                             
                                                                                        
                                                                                                 
                                                                                    
                                                                             
                                                                           
                                                                    
                                                     



benchmark preferences are unknown. For these reasons and along the lines of the arguments
we used in previous sections, it is natural to compute an alternative to the KS ∗ in the
spirit of the AU C, namely,

                                     TN         TP                                       
                                                                            1
                    AU C        =         wj         wi        I(ui > vj ) + I(ui = vj ) .
                                                                             2
                                     j=1        i=1

   As long as the risk-and-return-adjusted probabilities conform with standard measura-
bility conditions, nothing has changed with respect to the statistical properties previously
               
discussed for AU  C : the weighting simply re-ranks the observations within each empirical
distribution, f ∗ or g ∗ , but no observations switch from one to the other as a result of the
weighting. Thus, the asymptotic results only require that the regularity conditions now
apply to f ∗ and g ∗ . As a result, we will now require that B/C → β > 0 as T → ∞ and
that the densities of the returns in long/short positions be continuous so that the resulting
convolution of f and g into f ∗ and g ∗ is also continuous. Under this scenario, the inferential
and bootstrap procedures discussed in previous sections can be easily modiﬁed. It is useful
to refer back to Figures 1 and 2 since the CC ∗ can now be seen as giving a map to α in
Figure 2, but under more general conditions.


                                                                20
6.2    Multicategorical Positions
The excess returns of a continuously traded zero-cost strategy oﬀer a natural benchmark
with which to assess the attractiveness of an investment opportunity. In reality, however,
investors face transactions costs or they may wish to place larger bets when risk-adjusted
returns are expected to be specially high in a given period. In the ﬁrst example, one
would expect investors to take a neutral position if expected returns are insuﬃcient to
cover transactions costs, thus expanding the decision space to long/neutral/short positions.
In the second example, an investor may consider doubling the bet when the expected
returns of a position are specially high and hence the decision space would expand to four
categories, say long(2)/long(1)/short(1)/short(2), or even ﬁve if one includes a neutral
category. In what follows we show how to extend the analysis of the previous sections using
the three category long/neutral/short example as our framework, although extensions to
more categories should be obvious from our discussion (see also Waegeman, De Baets and
Boullart, 2008).
   Suppose that whether an investor goes short/neutral/long, that is, d = −1, 0, 1, is
determined by
                                  dt = −1 if       xt < ψ 1 ,
                                  dt = 0     if    ψ 1 ≤ xt ≤ ψ 2 ,                       (14)
                                  dt = +1 if       xt > ψ 2 ,

where ψ = (ψ 1 , ψ 2 ) are pre-determined thresholds known in advance. For example, if xt
represents excess returns, then ψ 1 could represent the costs of a short position and ψ 2 the
costs of a long position so that if ψ 1 < xt < ψ 2 , the trader will choose to remain neutral.
    Next, assume there is a model that generates a continuous signal       δ t that determines
the investor’s positions according to:

                                   dt = −1 if 
                                               δ t < c1 ,
                                   dt = 0  if c1 ≤ δ t ≤ c2 ,
                                   dt = +1 if c2 < δt,

for c1 < c2 ; c1 , c2 ∈ (−∞, ∞) with c ≡ (c1 , c2 ).
   The contingency matrix associated with each of the three states d = −1, 0, +1 means
that the CC frontier is now a surface in the three-dimensional space of the per category




                                                  21
true positive rates:

                        1
            
            T P h (c) =                I(
                                         δ t+1 ≤ c1 ) + I(c1 < 
                                                               δ t+1 ≤ c2 ) + I(c2 < 
                                                                                     δ t+1 )
                        Th
                             dh =dh


where Th refers to the number of observations in the sample that belong to category
h ∈ {N, 0, P } with N standing for negatives, 0 standing for neutrals, and P standing for
positives. The CC surface belongs in the [0, 1] × [0, 1] × [0, 1] cube and as with the CC
frontier, perfect classiﬁcation implies a CC surface with unit volume, whereas the ‘chance’
simplex (rather than diagonal) bisects the cube at (1, 0, 0), (0, 1, 0), (0, 0, 1).
   The equivalent statistic to the AU C in three dimensions becomes the volume under
the CC surface or VUS (for volume under the surface). A perfect classiﬁer is one with
V U S = 1, but now a chance classiﬁer has V U S = 1/6 because the probability of randomly
classifying any two categories, while still 1/2, has to be considered for any three possible
pairs. In general, classiﬁcation problems with k categories result in a CC hypersurface in
k dimensions and a VUS for the chance classiﬁer of 1/k!.
   Although there is no comparable extension for the KS statistic, the VUS is a direct
generalization of the Wilcoxon-Mann-Whitney statistic (see Mossman, 1999). Let vj denote
the observations of 
                    δ for which d = 1; zk when d = 0; and ui when d = 1, then the empirical
estimate of P [v < z < u] is readily seen to be

                                                          TN   T0   TP
                                                 1
               U S = P[v < z < u] =
              V                                                         {I (vj < zk < ui ) , }   (15)
                                              TN T0 TP
                                                          j=1 k=1 i=1


where we omit the rule to randomly break ties in the interest of keeping the notation
concise.
    Dreiseitl, Ohno-Machado and Binder (2000) provide Gaussian large sample approxima-
tions for V
           U S and analytic formulas for the variance, as well as formulas for the covariance
between the V
             U S of two competing models. These can be used to craft inferential pro-
cedures along the lines described in the previous sections. More generally, concerns with
the small sample properties of asymptotic approximations and/or models with O(T 1/2 )
estimated parameters, are good reasons to rely on bootstrap procedures instead.
   Consider now V U S calculations using risk-and-return-adjusted probabilities. For this
derivation, notice that in the neutral position, xt = 0 and hence all observations within
this category receive equal weight of 1/T0 . Recall that we previously deﬁned:


                                                     22
                           B=             mt xt ; and C =                |mt xt |
                                    d=1                           d=−1

and hence we can deﬁne the following weights:

                  wi =   m i xi
                          B          if 
                                        δ > c2 and d = 1 for i = 1, ..., TP
                  wk =    1
                         T0          if c1 ≤ 
                                             δ ≤ c2 and d = 0 for k = 1, ..., T0
                         |mj xj |
                  wj =      C        if 
                                        δ < c1 and d = −1 for j = 1, ..., TN

where the indices i, j, k are a shorthand device to denote the observations t belonging to
each category.
   The empirical counterpart to the AU C ∗ for three categories now becomes:

                                      TP         T0         TN
                         V U S =           wi         wk         wj I(vj < zk < ui ).
                                      i=1        k=1        j=1


Notice now that expected gains, Γ(c), and losses, Λ(c), under the risk-and-return-adjusted
probabilities and for a given vector of thresholds c = (c1 , c2 ), c1 < c2 is similar to those
calculated in expression (13), namely:

                      E ∗ (Γ(c)) = B.T PP∗ (c) + C.T PN (c)
                     E ∗ (Λ(c)) = B(1 − T PP (c)) + C(1 − T PN (c))

since in our example the neutral position oﬀers no returns (xt = 0). Similarly, the investor’s
normalized expected proﬁts are:

                                B (2T PP∗ (c) − 1) + C (2T PN (c) − 1)
                 E ∗ (Π(c)) =                                          ; c 1 < c2 .
                                                B+C

In the special case B = C then E ∗ (Π(c)) = 2 × J ∗ (c) but where now J ∗ (c) is a version of
the Youden index constructed with T PP∗ (c) and T PN (c).
   However, because now there is a neutral position, choosing e.g., c1 → −∞ so that
T PN (c) → 0 does not now imply that T PP (c) → 1 since one could maintain c2 ﬁxed. In
fact, if c1 → −∞ and c2 → ∞, then T PN (c), T NP (c) → 0 and T P0 (c) → 1.
   Therefore the proﬁt maximization problem is a little diﬀerent and the maximum can




                                                        23
be calculated from the simpliﬁed problem

                               max 2 (T PN∗ (c1 , c2 ) + T PP∗ (c1 , c2 ) − 1)
                               c1 ,c2

                                               s.t. c1 < c2 .

In contrast to the binary case, there are three empirical distributions resulting from the
values of 
          δ assigned to d = −1, 0, 1, say f ∗ , h∗ , and g ∗ respectively. For proﬁt maximization
the key is to determine the distance between f ∗ and g ∗ as before, but now there is the
intervening distribution h∗ . Although the connection between Bernardo and Ledoit’s (2000)
gain-loss ratio α and the KS ∗ statistic breaks down, the intuition for the result does not:
                                                                                               ∗
the distance between f ∗ and g ∗ is still the critical element in calculating α, for which V
                                                                                            US
oﬀers a useful measure.


7        Empirical Application I: Risk-and-Return Adjusted Ex-
         cess Returns of Equities
For our ﬁrst application, we turn to one of the holy grails of ﬁnancial economics, the
problem of forecasting equity returns. In this section we will scrutinize the performance
of stock trading rules drawn from a veritable kitchen sink of signals, following the most
recent and state-of-the-art treatment by Goyal and Welch (2008).9 As these authors have
shown, at ﬁrst sight many signals may appear to be useful based on in-sample performance
(IS), only to fail when confronted with the “gold standard” of predictive tests—the ability
to provide an informative out-of-sample forecast (OOS).
        The strategy to be evaluated is based on a long-short trading strategy for U.S. equities
for 1927:1 to 2008:12. The monthly excess return is deﬁned as the return on the S&P 500
including dividends, minus the “risk-free rate” deﬁned as the 3-month treasury bill rate.
The investor’s long/short positions are then determined by any one of the following 15
indicators used individually:10 (1) the dividend price ratio, dp, computed as the diﬀerence
between the log of dividends and the log of prices; (2) the dividend yield ratio, dy, computed
as the diﬀerence between the log of dividends and the log of lagged prices; (3) the earnings
    9
     We use the new dataset of Goyal-Welch extended through 2008, available on Goyal’s website:
www.bus.emory.edu/AGoyal/Research.html. Their published paper uses data through 2005.
  10
     All data are taken from Goyal and Welch (2008) and the 2009 vintage updates on Goyal’s website:
www.bus.emory.edu/AGoyal/Research.html



                                                     24
price ratio, ep, computed as the diﬀerence between the log of earnings and the log of
prices; (4) the dividend payout ratio, de, computed as the diﬀerence between the log of
dividends and the log of earnings; (5) the stock variance, svar, computed as the sum of
squared daily returns on the S&P 500; (6) the cross-sectional beta premium, csp, which
measures the relative valuations of high- and low-beta stocks; (7) the book to market ratio,
bm; (8) the net equity expansion, ntis, which is one of two measures of corporate issuing
activity; (9) the long term yield, lty, on government bonds; (10) the long term return, ltr,
on government bonds; (11) the term spread, tms, computed as the diﬀerence between the
yield on long-term government bonds and the T-bill rate; (12) the default yield spread,
dfy, computed as the diﬀerence between BAA- and AAA-rated corporate bond yields; (13)
the default return spread, dfr, computed as the diﬀerence between returns on long-term
corporate bonds and returns on long-term government bonds; (14) the inﬂation rate, linﬂ,
based on the CPI and lagged one month to allow for publication lags; and (15) tbl the
short-term return on the 6-to-3 month T-Bill rate.
       These signals are used for IS prediction over the full period, and OOS prediction using a
long window from 1970:1 to 2008:1.11 The latter window is chosen to be roughly consistent
with the OOS windows used by Welch and Goyal (2008), who ﬁnd that the inclusion or
exclusion of the 1970s oil shock period can dramatically aﬀect the performance of prediction
strategies. We now report our results and compare our ﬁndings to those of Goyal and Welch
(2008). The key diﬀerence to remember is that we will be using directional and realized
proﬁt criteria to judge the presence of unexploited arbitrage opportunities, and not the
prevailing mean squared error (MSE) ﬁt-based criterion. Again, this turns out to be
signiﬁcant as some methods that have high accuracy, may have low proﬁt (and vice versa),
so we can draw attention to whether a particular strategy can “ﬁt where it matters”.
       Brieﬂy, at a monthly frequency Goyal and Welch (2008, section 5) found a handful of
strategies whose IS predictive power surmounted conventional signiﬁcance tests. Under
their MSPE criterion eight strategies were judged successful. However, once these eight
strategies were subjected to a further OOS prediction test, only one, the eqis signal, was
found to have superior IS and OOS performance relative to the null of using the historical
mean return. The term spread tms was found to have marginal IS signiﬁcance, but OOS
signiﬁcance. A few more signals were found to be promising when various truncations were
applied to the data.
  11
     The data for csp are only available from May 1937 to December 2002, so the sample sizes for this
variable are slightly smaller in what follows.


                                                 25
   In addition to IS and OOS statistical inference based on the MSPE criteria, Goyal and
Welch (2008) also consider the proﬁtability of the candidate strategies by constructing a
certainty-equivalent gain after postulating a utility function (Brennan and Xia 2005; Camp-
bell and Thompson 2008). They note that (p. 1488–89) “This allows a conditional model to
contribute to an investment strategy not just by increasing the mean trading performance,
but also by reducing the variance....” They found that “In order, among the IS reason-
ably signiﬁcant models, those providing positive CEV gains were tms (14 bps/month), eqis
(14 bps/month), tbl (10 bps/month), csp (6 bps/month), cay3 (6 bps/month), and ntis
(2 bps/month).” However, the authors also indicate the dearth of available tests geared
towards evaluating such improvements, since “we know of no better procedure to judge the
economic signiﬁcance of forecasting models,...” One of the goals of this paper is to provide
just such a procedure, and one that can not only measure the economic signiﬁcance of any
gains, but also their statistical signiﬁcance.
   With these preliminaries, we now turn to our results. Our IS predictions are shown
in Table 2 using the CC-based evaluation tools: the AUC and AU C  using a risk-neutral
returns adjustment only (in Table 4 below we examine stochastic discount factor adjust-
ments with coeﬃcients of risk aversion up to 80 for power utility). We also report the
KS and KS  as well as the Bernardo and Ledoit (2000) gain-loss ratio based on KS  and
under the assumption of symmetry. According to the directional AU C test, only two sig-
nals surmount the conventional 5% signiﬁcance level: csp and linﬂ, although tbl, lty, and
tms come very close (the lower bound of the 95% conﬁdence interval calculated with 1,000
bootstrap replications is just at the null value of 0.50). Of these only csp was found to be
signiﬁcant IS in the Goyal-Welch ﬁndings. However, when we turn to the AU C  test based
on proﬁts, the picture is a bit diﬀerent. First, the AU C  is noisier and this is reﬂected in
95% conﬁdence intervals that are slightly wider than with the raw AU C. Now only two
signals do well by this yardstick: ep and csp of which the ﬁrst was not signiﬁcant without
the adjustment. Only csp performs well in both cases.
   Yet, as we have noted, in-sample performance alone will not convince an appropriately
skeptical reader. We therefore repeat our exercise and compute the OOS performance of
the signals, as shown in Table 3. Using the directional AU C test four signals are signiﬁcant
at the 5% level, namely: tbl, lty, tms and csp. Note that only one of these was statistically
signiﬁcant in the IS tests using AU C, namely csp. Turning to the returns-based AU C 
test, only one signal is signiﬁcant at the 5% level: csp, which is the only signal to achieve
statistical signiﬁcance in all four of our tests.

                                                 26
Table 2: AU C, KS, and Gain-Loss Ratio, and Risk-Neutral AU C  , KS  , and Gain-Loss
Ratio for Equity Strategies. In-sample Predictions: 1927:1–2008:12
   Signal     Statistic   Value      95% Conf. Interval    Statistic    Value   95% Conf. Interval
     dp        AUC        0.51        0.48       0.55       AUC*                     
                KS        0.05        0.01       0.10        KS*                    
                 g/l       1.12       1.02       1.22        g/l*                   
      dy       AUC                               AUC*                     
                KS                             KS*                    
                 g/l                          g/l*                 
      ep       AUC                               AUC*                      
                KS                              KS*                   
                 g/l                           g/l*                  
      de       AUC                              AUC*                     
                KS                             KS*                    
                 g/l                           g/l*                   
    svar       AUC                              AUC*                     
                KS                            KS*                    
                 g/l                             g/l*                   
     bm        AUC                              AUC*                     
                KS                             KS*                    
                 g/l                             g/l*                 
     ntis      AUC                               AUC*                     
                KS                              KS*                   
                 g/l                            g/l*                   
     tbl       AUC                               AUC*                     
                KS                             KS*                   
                 g/l                             g/l*                  
     lty       AUC                               AUC*                     
                KS                             KS*                    
                 g/l                            g/l*                  
      ltr      AUC                              AUC*                     
                KS                             KS*                   
                 g/l                           g/l*                  
     tms       AUC                               AUC*                     
                KS                             KS*                   
                 g/l                            g/l*                  
     dfy       AUC                             AUC*                    
                KS                           KS*                  
                 g/l                             g/l*                   
     dfr       AUC                               AUC*                     
                KS                             KS*                    
                 g/l                            g/l*                 
     linfl     AUC                                AUC*                     
                KS                             KS*                  
                 g/l                            g/l*                   
     csp       AUC                            AUC*                    
                KS                             KS*                    
                 g/l                            g/l*                  
Notes: 95% conﬁdence interval calculated with 1,000 bootstrap replications.




                                                   27
Table 3: AU C, KS, and Gain-Loss Ratio, and Risk-Neutral AU C  , KS  , and Gain-Loss
Ratio for Equity Strategies. Out-of-sample Predictions: 1970:1–2008:12
   Signal     Statistic   Value     95% Conf. Interval    Statistic   Value     95% Conf. Interval
     dp        AUC        0.51       0.48       0.55       AUC*                      
                KS        0.05       0.01       0.10        KS*                     
                 g/l       1.12      1.02       1.22        g/l*                    
     dy        AUC                              AUC*                      
                KS                            KS*                     
                 g/l                         g/l*                  
     ep        AUC                              AUC*                       
                KS                             KS*                    
                 g/l                          g/l*                   
     de        AUC                             AUC*                      
                KS                            KS*                     
                 g/l                          g/l*                    
    svar       AUC                             AUC*                      
                KS                           KS*                     
                 g/l                            g/l*                    
     bm        AUC                             AUC*                      
                KS                            KS*                     
                 g/l                            g/l*                  
     ntis      AUC                              AUC*                      
                KS                             KS*                    
                 g/l                           g/l*                    
     tbl       AUC                              AUC*                      
                KS                            KS*                    
                 g/l                            g/l*                   
     lty       AUC                              AUC*                      
                KS                            KS*                     
                 g/l                           g/l*                   
     ltr       AUC                             AUC*                      
                KS                            KS*                    
                 g/l                          g/l*                   
     tms       AUC                              AUC*                      
                KS                            KS*                    
                 g/l                           g/l*                   
     dfy       AUC                            AUC*                     
                KS                          KS*                   
                 g/l                            g/l*                    
     dfr       AUC                              AUC*                      
                KS                            KS*                     
                 g/l                           g/l*                  
    linfl      AUC                               AUC*                      
                KS                            KS*                   
                 g/l                           g/l*                    
     csp       AUC                           AUC*                     
                KS                            KS*                     
                 g/l                           g/l*                   
Notes: 468 out-of-sample observations except for csp, which has 397. 95% conﬁdence interval calculated
with 1,000 bootstrap replications.



                                                 28
       Table 4 expands on these results by computing the risk-and-return-adjusted AU C 
using a power utility function and benchmark U.S. consumption time-series data. For
the purposes of illustration, we explore risk-adjustment using a standard, simple constant
relative risk aversion (CRRA) utility function u(c) = c1−γ /(1 − γ). We then weight each
period’s returns (x) using the empirical next-period relative marginal utility weight (to get
the stochastic discount factor m). We take the relevant consumption stream to be U.S. real
per capita consumption, with growth rate gt .12 Each period, we treat real consumption
“this period” as being normalized to 1 and then the random real consumption draw “next
period” is given by c = (1 + gt ), and for the case of CRRA utility the appropriate risk-
weight to be applied to each return observation is then m = u (c) = (1 + gt )−γ . That is,
investment returns that deliver high payoﬀs in low consumption states are weighted more
highly, as expected.
       We utilize a wide range of coeﬃcients of risk aversion, γ, from 1 (log utility) all the
way to 80. Strikingly, the main lesson from Table 3 endures: only csp appears to provide
consistently signiﬁcant risk-adjusted returns (conﬁdence intervals in Table 4 are omitted for
brevity). The gain-loss ratio is around 1.35 (as low as 1.27 and as high as 1.39 depending
on whether we look in-sample or out-of-sample with a coeﬃcient of risk aversion, γ = 80),
which roughly means that risk-adjusted expected gains are 35% larger than risk-adjusted
expected losses. Moreover, a cursory look at Table 4 reveals another interesting feature
worth highlighting: although we present a wide variation in risk aversion (including risk-
neutral behavior), the AU C  does not change very much at all. The main adjustment
appears to come from returns relative to the pure directional signal in AUC, but once
adjusted for returns, further adjustment for risk appear to make little diﬀerence. We will
leave for a diﬀerent paper a more detailed investigation of this attractive feature, but the
bottom line here is that no matter what the risk aversion parameter γ, the stochastic
discount factor is orthogonal to returns and consumption risk (with standard preferences)
does not appear to have any ability to price equity returns.
       To sum up, our CC-based tests provide a diﬀerent way of judging the performance of
equity trading signals, as compared to the more usual reliance on MSPE based criteria.
Comparing the results of our tests to the state-of-the-art methods in Goyal and Welch
  12
     We follow Burnside et al. (2011) and construct U.S. real consumption growth as the expenditure-
weighted sum of the real growth of nondurable goods and services consumption (SAAR series from BEA),
and we subtract the monthly population growth (series from BLS) to obtain a monthly per capita growth
rate g.



                                                 29
Table 4: Risk-Adjusted AU C  , KS  , and Gain-Loss Ratio for Equity Strategies: Various
Coeﬃcients of Risk Aversion and Power Utility. Out-of-sample Predictions: 1970:1–2008:12
                                                Coefficient of Risk Aversion
  Signal                                                               
  dp       AUC*      0.498    0.498    0.498    0.498      0.498      0.497     0.495    0.492    0.487
           KS*       0.092    0.092    0.092    0.092      0.092      0.093     0.094    0.095    0.099
           G/L       1.202    1.202    1.203    1.203      1.203      1.204     1.207    1.210    1.219
  dy       AUC*      0.505    0.505    0.505    0.505      0.505      0.504     0.502    0.499    0.493
           KS*       0.090    0.090    0.090    0.090      0.090      0.090     0.091    0.093    0.097
           G/L       1.197    1.197    1.197    1.197      1.198      1.198     1.201    1.205    1.214
  ep       AUC*      0.516    0.516    0.516    0.516      0.515      0.515     0.513    0.509    0.501
           KS*       0.103    0.103    0.103    0.103      0.102      0.102     0.100    0.097    0.088
           G/L       1.229    1.229    1.229    1.229      1.228      1.226     1.222    1.214    1.193
  de       AUC*      0.433    0.433    0.433    0.434      0.434      0.434     0.435    0.437    0.439
           KS*       0.017    0.017    0.017    0.017      0.017      0.017     0.018    0.020    0.024
           G/L       1.034    1.034    1.034    1.034      1.034      1.035     1.037    1.040    1.049
  svar     AUC*      0.501    0.502    0.502    0.502      0.502      0.502     0.504    0.506    0.509
           KS*       0.057    0.057    0.057    0.057      0.057      0.058     0.059    0.060    0.062
           G/L       1.121    1.121    1.121    1.121      1.122      1.122     1.124    1.128    1.132
  bm       AUC*      0.491    0.491    0.491    0.490      0.490      0.489     0.485    0.480    0.470
           KS*       0.073    0.073    0.073    0.073      0.072      0.071     0.069    0.065    0.059
           G/L       1.157    1.157    1.157    1.156      1.155      1.153     1.148    1.139    1.125
  ntis     AUC*      0.512    0.512    0.512    0.512      0.512      0.512     0.511    0.511    0.512
           KS*       0.074    0.074    0.074    0.075      0.075      0.075     0.076    0.078    0.083
           G/L       1.161    1.161    1.161    1.161      1.161      1.162     1.165    1.170    1.182
  tbl      AUC*      0.523    0.523    0.523    0.523      0.523      0.524     0.525    0.526    0.530
           KS*       0.109    0.109    0.109    0.109      0.109      0.109     0.110    0.112    0.117
           G/L       1.244    1.244    1.244    1.244      1.245      1.245     1.247    1.251    1.266
  lty      AUC*      0.528    0.528    0.528    0.528      0.528      0.528     0.529    0.531    0.534
           KS*       0.079    0.079    0.079    0.079      0.079      0.078     0.077    0.080    0.084
           G/L       1.171    1.171    1.171    1.171      1.170      1.169     1.167    1.173    1.184
  ltr      AUC*      0.564    0.564    0.564    0.564      0.564      0.564     0.564    0.563    0.564
           KS*       0.137    0.137    0.137    0.137      0.137      0.137     0.136    0.136    0.140
           G/L       1.317    1.317    1.317    1.316      1.316      1.316     1.315    1.314    1.325
  tms      AUC*      0.528    0.528    0.528    0.528      0.529      0.529     0.530    0.531    0.533
           KS*       0.086    0.086    0.086    0.086      0.087      0.087     0.089    0.091    0.096
           G/L       1.188    1.188    1.189    1.189      1.189      1.191     1.194    1.201    1.213
  dfy      AUC*      0.485    0.485    0.485    0.485      0.485      0.485     0.486    0.488    0.493
           KS*       0.087    0.087    0.087    0.087      0.087      0.087     0.086    0.086    0.085
           G/L       1.191    1.190    1.190    1.190      1.190      1.190     1.188    1.187    1.187
  dfr      AUC*      0.477    0.477    0.477    0.477      0.477      0.477     0.476    0.474    0.469
           KS*       0.082    0.082    0.082    0.083      0.083      0.083     0.083    0.083    0.082
           G/L       1.180    1.180    1.180    1.180      1.180      1.180     1.181    1.182    1.178
  linfl    AUC*      0.530    0.530    0.530    0.530      0.529      0.529     0.527    0.524    0.517
           KS*       0.105    0.105    0.105    0.105      0.104      0.103     0.100    0.094    0.081
           G/L       1.235    1.235    1.235    1.234      1.233      1.230     1.222    1.208    1.176
  csp      AUC*      0.576    0.577    0.577    0.577      0.577      0.577     0.577    0.578    0.579
           KS*       0.147    0.147    0.147    0.147      0.148      0.149     0.151    0.156    0.164
           G/L*      1.344    1.344    1.345    1.345      1.347      1.349     1.357    1.369    0.393
Notes: 468 observations except for csp strategy, with 397. csp is the only strategy with statistically
signiﬁcant AU C and KS (using the bootstrap), although standard errors not reported here for brevity. We
use boldface to highlight this ﬁnding.




                                                  30
(2008), we ﬁnd important diﬀerences in the relative merits of diﬀerent signals, which mostly
appear when we adjust for returns and to a lesser extent, risk.
    Among equity trading signals, even when we switch to a criterion like AU C  speciﬁcally
designed to make precise inferences on the relative proﬁtability of diﬀerent strategies, we
tend to ﬁnd no evidence of a robust and stable relationship across IS and OOS predic-
tions for most of the mainstream proposed trading signals. The single exception to this
generalization applies to our ﬁndings for the csp signal (the cross-section premium), which
we found to be highly statistically signiﬁcant in all of our CC-based tests, thus lending
support to the ﬁndings of Polk et al. (2006).
    However, this support is still subject to two caveats. The ﬁrst is conceptual, for as
Goyal and Welch (2008, p. 1494) note, “[w]hat we call OOS performance is not truly OOS,
because it still relies on the same data that was used to establish the models. (This is
especially applicable to eqis and csp, which were only recently proposed.)” The second
is qualitative, and based on the potential proﬁtability of a csp-based strategy. Suppose
a hypothetical investor went long when the OOS forecast was positive, short otherwise,
their excess return, assuming no transaction costs or margin costs, would have been 27
bps/month (s.d. = 460 bps); or, on annualized basis 3.3 percent per year with a Sharpe
Ratio of 0.20. So whilst there may have been predictable returns that could be judged
statistically signiﬁcant, not everyone would judge them economically signiﬁcant.


8    Empirical Application II: Currency Carry Trades with
     Long/Cash/Short Positions
Berge, Jordà and A. M. Taylor (2011) examine the returns from bilateral currency carry
trade strategies in which a trader borrows in one currency and lends in another while bear-
ing the risk of appreciation. Four benchmark trading signals are examined in that paper.
The ﬁrst three are based on simple strategies commonly found in a variety of exchange
traded funds (ETFs) and investible indices, such as the Deutsche Bank currency ETFs
and Goldman Sachs’ FX Currents. The fourth signal is based on a vector error correction
model (VECM). We provide a brief description below but encourage the interested reader
to refer to the original source for more details.
    The Carry Signal c is computed as the interest diﬀerential between the local currency
(LC) and the U.S. dollar (US). Under this strategy, the presumption is that high yield


                                              31
currencies will deliver proﬁts despite the risk of depreciation. In this case uncovered interest
parity either fails, or holds ex-ante but suﬀers ex-post from systematic and exploitable
expectational errors. Thus ct = iLC
                                 t  − iU S
                                       t , and the trader using this signal uses the model
t+1 = ct for each currency.
x
   The Momentum Signal m is computed as rate of appreciation of the local currency
exchange rate against the U.S. dollar E LC/U S in the previous month. Under this strategy,
the presumption is that appreciating currencies will have a tendency to keep appreciating
                                   U S/LC
on average. Thus mt = ΔlogEt                , and the trader using this signal uses the model
t+1 = mt for each currency.
x
   The Value Signal v is computed as the undervaluation of the country’s log CPI-
index-based real exchange rate level against the U.S. (IFS data) in the prior period q =
ln[ELC/U S PU S /PLC ], using deviation from average lagged levels q̄ computed using a trailing
window (to avert look-ahead bias). Under this strategy, the presumption is that currencies
will have a tendency to return to their historic PPP value in the long run. Thus v = q − q̄,
                                                t+1 = vt for each currency.
and the trader using this signal uses the model x
   Finally, the vecm signal is based on a panel VECM forecasting model for the holding
return for each currency, where the dynamic interactions between nominal exchange rates,
inﬂation and nominal interest rate deviations are its constituent elements.
   The data include the nine currencies EUR, GBP, JPY, CHF, AUS, CAD, NZD, NOK,
and SEK, with the USD as the base home currency (i.e., the “G-10” currencies), in a
sample from 1986 to 2008 observed at monthly frequency. Table 5 presents the out-of-
sample (OOS) AUC/AUC  , KS/KS  statistics and gain-loss ratios where we adjust for
returns and then risk-adjust as in the equity example by considering values of γ = 2, 4,
8, 20, 40 and 80, associated to each of these four strategies for the 648 currency-month
observations in our chosen OOS sample window from 2003:1 to 2008:12.
   The results reported in Table 5 (with country-clustered bootstrap standard errors)
highlight once more the diﬀerence between good classiﬁcation ability, proﬁtability and
risk-adjusted proﬁtability. For example, the value strategy does not classify direction
signiﬁcantly better than a coin-toss, but when trades are adjusted for return, clearly the
value strategy outperforms a coin-tosser. Measured by this metric, the vecm strategy has
the highest AU C  at 0.622, well above the 0.5 null and highly statistically signiﬁcant,
although momentum and value are both close with AU C  = 0.604 and 0.600 respectively.
And as was the case for the equity strategies, adjusting for risk (even with risk-aversion
jacked up to 80) does not alter this ranking signiﬁcantly. The evidence here shows that

                                                32
Table 5: Out-of-sample AU C, KS, and Gain-Loss: Raw, Risk-Neutral, and Risk-Adjusted
for Several Values of the Risk Aversion Coeﬃcient. Currency Strategies: 2003:1–2008:12
  Signal      Stat.      Raw        RN                                             
  Carry       AUC                                                           
                                                                                   
               KS                                              
                                                                                   
              G/L                                           
  Moment.     AUC                                                       
                                                                                   
               KS                                           
                                                                                   
              G/L                                                      
  Value       AUC                                                 
                                                                                   
               KS                                             
                                                                                    
              G/L       1.164      1.164                                     
  VECM        AUC                                           
                                                                                     
               KS      0.183**    0.241**                                 
                       (0.040)    (0.058)                                                       
               G/L      1.448      1.633                                            
Notes: 648 out-of-sample observations. Raw refers to the un-weighted versions of the statistics; RN refers
to the risk-neutral weighted version (i.e., weighted by returns); γ refers to the values of the coeﬃcient of
risk-aversion in a power utility function. Standard errors in parenthesis calculated with 1,000 clustered
bootstrap replications to allow for country-level correlation. Notice the distribution of the KS statistic
is not normal (see text). G/L refers to the gain-loss ratio calculated from the KS statistic under the
assumption of symmetry.


allowance for standard consumption risk is unable to help price the returns from carry
trades or other currency strategies.
    Indeed, the trading proﬁts delivered by the vecm strategy (returns-adjusted) are not
trivial. If a trader faced no transaction costs and could go long or short each currency at
will, then a portfolio based on the signs of the signals from the OOS vecm model would have
generated average returns of 24 bps per month on each position, with each trade having
a standard deviation of 315 bps. Thanks to diversiﬁcation, the returns on the portfolio
of 9 currencies had a standard deviation of 161 bps. Annualized, the strategy would have
delivered 2.9 percent per year compounded with a Annualized Sharpe Ratio of 0.46.
    Often times the signal generated by a strategy may be weak and the investor may prefer
staying in a cash position, especially if there are transactions costs associated with each
trade. In order to showcase how VUS/VUS  statistics can be used in such situations, we
redo the previous analysis but now allowing for long/cash/short positions. When the deci-

                                                       33
                           Figure 3: Sharpe Ratio as a Function of Threshold


             1.5
             1.4
        Sharpe ratio
            1.3
             1.2
             1.1




                       0             .05             .1             .15         .2
                                                Threshold (c)




sion space is binary, there is no ambiguity in determining the ex-post proﬁtable long/short
direction. However, by now adding a cash position, we need some criterion to determine
the ex-post correct choice of long/cash/short positions.
   Absent good data on transactions costs, we decided to calculate a minimum symmetric
return threshold φ beyond which a long/short perfect-foresight trade would be triggered,
but otherwise the trader would remain in the cash position. In order to ﬁnd such a
threshold, we used a grid-search of values of φ that would maximize the ex-post Sharpe ratio
for a $1 investment. This is reported in Figure 3 and shows that the ex-post Sharpe ratio is
maximized for φ = 1.91%. This results in a mean monthly return of 3.7% and an annualized
Sharpe ratio of 1.45. These numbers may appear wildly optimistic but we remind the
reader that they refer to the perfect foresight returns. With this choice of threshold, the
investor would stay in the cash position about 50% of the time, and the other 50% of the
time he would go long/short in equal proportion. Given this ex-post classiﬁcation of the
data, we can now ask how would the four benchmark carry trade strategies reported in
Table 5 fare if one allowed for a cash position and for this we calculated each strategy’s


                                                  34
Table 6: Out-of-sample V U S, and Risk-Adjusted V U S  for Several Values of the Risk
Aversion Coeﬃcient. Currency Strategies: 2003:1–2008:12

  Signal                   VUS                  VUS* - RN             VUS*:         VUS*:          VUS*:
                                                                                              
  Carry                                                                         
                        
                             
                                                
                                                      
                                                                                                    
  Momentum                                                                      
                        
                             
                                                
                                                      
                                                                                                    
  Value                                                                     
                        
                             
                                                 
                                                      
                                                                                                    
  VECM                                                                          
                        
                             
                                                 
                                                      
                                                                                                    
Notes: 648 out-of-sample observations. V U S refers to the un-weighted volume under the CC surface
statistic; V U S  - RN refers to the risk-neutral weighted version (i.e., weighted by returns); γ refers to the
values of the coeﬃcient of risk-aversion in a power utility function. 95% conﬁdence interval in brackets
calculated with 1,000 clustered bootstrap replications to allow for country-level correlation. The chance
value for the VUS statistic is 1/6 = 0.16667.


VUS/VUS  statistics, the results of which are reported in Table 6. (Recall that this is for
the risk-neutral case, so unlike our equity analysis, no consumption data are used for this
analysis.)
    Recall that the null of no classiﬁcation ability (the equivalent of the coin-toss null in
CC-space) is now V U S = 1/6            0.167. By this metric, all signals fail to beat this simple null
(95% conﬁdence intervals are calculated with the country-clusterered bootstrap) although
we remark that these are estimated somewhat imprecisely (the conﬁdence intervals are a
bit larger than their analytic large-sample counterparts). However, it is interesting to see
that when weighing by returns in V U S  , the momentum signal now appears to do better
than the vecm signal (the AUCs reported in Table 5 are indeed close) although not by a
statistically signiﬁcant amount (using bootstrapped conﬁdence 95% conﬁdence intervals).
One explanation for this result is that, while vecm may be more consistent at picking the
correct direction of a carry trade, it may be missing some of the high-proﬁt trades that
momentum is picking up. And in our VUS setup, the high proﬁt trades take on even
greater importance: remember that given our imposed thresholds, ex-post we remain in
the cash position about 50% of the time and only trade when we can beat a 2% monthly
return, which is rather conservative. Just as in the results for the AUCs reported in Table
5, adjusting for risk did not change these conclusions substantively.



                                                          35
9    Conclusions
The presence of excess returns in a zero net-investment strategy does not per se violate
the eﬃcient markets hypothesis. But Bernardo and Ledoit (2000) construct bounds to
these arbitrage opportunities, using the gain-loss ratio, that have implications for asset
pricing in incomplete markets that are robust yet with suﬃcient texture to be economically
compelling. Our paper is a compendium of statistical methods designed to investigate this
sort of problem from a variety of angles interesting to academic researchers and investors
alike.
    We design techniques that allow one to compare alternative predictive models on the
basis of proﬁtability in a manner that is robust to variation in investor preferences. But
our methods go beyond providing simple summary statistics, they also provide a complete
description of an investor’s choices. Formal inferential procedures are designed to test the
null of absence of arbitrage; to test the relative overall proﬁtability of competing investment
strategies; to test whether a strategy is stochastically dominated by another; and to provide
conﬁdence bounds on optimal operating points.
    In practice, specially (but not exclusively) when there are transaction costs, it is im-
portant to allow the investor to adopt a neutral position during those times when the
expected return from the risky position is low. Allowing for such an extension can greatly
enhance the overall proﬁtability of a zero net-investment strategy and change the perceived
opportunities to arbitrage. Hence we develop extensions for such a case and along the way
generalize our framework for more complex strategies involving multiple categories. We
also show how these more sophisticated strategies can be related to Bernardo and Ledoit’s
(2000) gain-loss ratio.
    We illustrate our methods with applications to the stock market and the carry trade.
On the former, we show how Welch and Goyal’s (2008) results based on the MSE yardstick
fare under our framework and show that there is perhaps one strategy with statistically
signiﬁcant returns. Our application to the carry trade is based on the data in Berge, Jordà
and A. M. Taylor (2011) and identiﬁes a strategy that generates a statistically signiﬁcant
departure from no arbitrage, that is later shown to be dominated by another strategy if
one allows the investor to adopt a neutral position.
    The framework that we propose is nonparametric but simple to implement and makes
explicit the connection between the statistical properties of the returns of investment po-
sitions, and the investor’s preferences over such positions. Moreover, we show how this


                                              36
framework connects with a well established benchmark of asset pricing in incomplete mar-
kets, the gain-loss ratio. For these reasons we think our methods represent a viable set of
standards to analyze an important class of problems in empirical ﬁnance.


References
Alexius, Annika. 2001. Uncovered Interest Parity Revisited. Review of International Economics
    9:505–517.
Anatolyev, Stanislav, and Alexander Gerko. 2005. A Trading Approach to Testing Predictability.
    Journal of Business and Economic Statistics, 23(4): 455–461.
Andrews, Donald W. K. 1997. A Conditional Kolmogorov Test. Econometrica, 65(5): 1097–1128.
Bai, Jushan. 1994. Weak Convergence of the Sequential Empirical Processes of Residuals in ARMA
    Models. The Annals of Statistics, 22(4): 2051–2061.
Bai, Jushan. 2003. Testing Parametric Conditional Distributions of Dynamic Models. The Review
    of Economics and Statistics, 85(3): 531–549.
Baker, Stuart G., and Barnett S. Kramer. 2007. Pierce, Youden, and Receiver Operating Charac-
    teristics Curves. The American Statistician, 61(4): 343–346.
Bamber, Donald. 1975. The Area Above the Ordinal Dominance Graph and the Area Below the
    Receiver Operating Characteristic Graph. Journal of Mathematical Psychology, 12: 387–415.
Berge, Travis J., Òscar Jordà, and Alan M. Taylor. 2011. Currency Carry Trades. In International
    Seminar on Macroeconomics, 2010, Richard H. Clarida, Jeﬀrey A. Frankel, and Francesco
    Giavazzi (eds.), NBER. Forthcoming.
Bernardo, Antonio E., and Olivier Ledoit. 2000. Gain, Loss and Asset Pricing. Journal of Political
    Economy 108(1): 144–72.
Bickel, Peter J., and David A. Freedman. 1981. Some Asymptotic Theory for the Bootstrap. The
    Annals of Statistics, 9(6): 1196–1217.
Brennan, Michael J., and Yihong Xia. 2005. Persistence, Predictability, and Portfolio Planning.
    Rodney L. White Center for Financial Research, Working Paper no. 25-05.
Burnside, Craig, Martin Eichenbaum, Isaac Kleshchelski, and Sergio Rebelo. 2011. Do Peso Prob-
    lems Explain the Returns to the Carry Trade? Review of Financial Studies 24(3): 853–89.
Campbell, John Y., and Samuel B. Thompson. 2008. Predicting the Excess Stock Returns Out
    of Sample: Can Anything Beat the Historical Average? Review of Financial Studies, 21(4):
    1509–1531.
Cheung, Yin-Wong, Menzie D. Chinn, and Antonio Garcia Pascual. 2005. Empirical Exchange
    Rate Models of the Nineties: Are Any Fit to Survive? Journal of International Money and
    Finance 24(7): 1150–75.
Cochrane, John H. 2001 Asset Pricing New Jersey: Princeton University Press.



                                               37
Darling, Donald A. 1955. The Cramér-Smirnov Test in the Parametric Case. The Annals of
    Mathematical Statistics, 26: 1–20.
DeLong, Elizabeth R., David M. DeLong, and Daniel L. Clarke-Pearson. 1988. Comparing the Ar-
    eas Under Two or More Correlated Receiver Operating Characteristic Curves: A Nonparametric
    Approach. Biometrics, 44:837–845.
Dreiseitl, Stephan, Lucila Ohno-Machado, and Michael Binder. 2000. Comparing Three-class
    Diagnostic Tests by Three-way ROC Analysis. Medical Decision Making, 20(3): 323–331.
Elliott, Graham, and Robert P. Lieli. 2009. Predicting Binary Outcomes. Department of Eco-
    nomics, University of California, San Diego. Photocopy.
Fujii, Eiji, and Menzie D. Chinn. 2001. Fin de Siècle Real Interest Parity. Journal of International
    Financial Markets, Institutions and Money 11(3–4): 289–308.
Goyal, Amit, and Ivo Welch. 2003. Predicting the Equity Premium with Dividend Ratios. Man-
    agement Science, 49(5):639–54.
Goyal, Amit, and Ivo Welch. 2008. A Comprehensive Look at the Empirical Performance of Equity
    Premium Prediction. Review of Financial Studies, 21(4): 1455–1508.
Granger, Clive W. J., and Mark J. Machina. 2006. Forecasting and Decision Theory. In Handbook
    of Economic Forecasting, Vol. I, Graham Elliott, Clive W. J. Granger, and Allan Timmermann
    (eds.). Amsterdam: Elsevier.
Green, David M., and John A. Swets. 1966. Signal Detection Theory and Psychophysics. Los
    Altos, Calif.: Peninsula Publishing.
Hájek, Jaroslav, Zbynĕk Šidák, and P. K. Sen. 1999. Theory of Rank Tests. San Diego, Calif.:
    Academic Press.
Hall, Peter, Rob J. Hyndman, and Yanan Fan. 2004. Nonparametric Conﬁdence Intervals for
    Receiver Operating Characteristic Curves. Biometrika, 91(3): 743–750.
Hand, David J. and Veronica Vinciotti. 2003. Local versus Global Models for Classiﬁcation Prob-
    lems: Fitting Models Where It Matters. The American Statistician, 57(2): 124–131.
Hanley, James A., and Karimollah Hajian-Tilaki. 1997. Sampling variability of Nonparametric
    estimates of the Areas Under receiver Operating Characteristic Curves: An Update. Academic
    Radiology, 4: 49–58.
Hanley, James A., and Barbara J. McNeil. 1982. The Meaning and use of the Area Under the
    Receiver Operating Characteristic (ROC) Curve. Radiology, 143: 29–36.
Hansen, Lars P. and Ravi Jaganathan. 1991. Implications of Security Market Data for Models of
    Dynamic Economies. Journal of Political Economy, 99: 225–262.
Henriksson, Roy D. and Robert C. Merton. 1981. On Market Timing and Investment Performance.
    II. Statistical Procedures for Evaluating Forecasting Skills. Journal of Business 54: 513–533.
Hsieh, Fushing and Bruce W. Turnbull. 1996. Nonparametric and Semiparametric Estimation of
    the Receiver Operating Characteristics Curve. Annals of Statistics, 24: 25–40.




                                                 38
Jordà, Òscar, and Alan M. Taylor. 2009. The Carry Trade and Fundamentals: Nothing to Fear
    but FEER itself. NBER Working Papers no. 15518.
Khamaladze, Estate V. 1981. Martingale Approach in the Theory of Goodness-of-Fit Tests. Theory
    of Probability and its Applications, 26, 240–257.
Kilian, Lutz, and Mark P. Taylor. 2003. Why is it so Diﬃcult to Beat the Random Walk Forecast
    of Exchange Rates? Journal of International Economics 60(1): 85–107.
Kosorok, Michael R. 2008. Introduction to Empirical Processes and Semiparametric Inference. New
    York: Springer-Verlag.
Linton, Oliver, Esfandiar Maasoumi, and Yoon-Jae Whang. 2005. Consistent Testing for Stochastic
    Dominance under General Sampling Schemes. The Review of Economic Studies, 72:735–765.
Meese, Richard A., and Kenneth Rogoﬀ. 1983. Empirical Exchange Rate Models of the Seventies.
    Journal of International Economics 14(1–2): 3–24.
Merton, Robert C. 1981. On Market Timing and Investment Performance. I. An Equilibrium
    theory of Value for Market Forecasts. Journal of Business, 54: 363–406.
Mielke, Jr., Paul W., and Kenneth J. Berry. 2007. Permutation Methods: A Distance Function
    Approach. New York: Springer-Verlag.
Mossman, Douglas. 1999. Three-way ROCs. Medical Decision Making, 19(1): 78–89.
Obuchowski, Nancy A. 1994. Computing Sample Size for Receiver Operating Characteristic Curve
    Studies. Investigative Radiology, 29(2): 238–243.
Obuchowski, Nancy A., and Michael L. Lieber. 1998. Conﬁdence Intervals for the Receiver Oper-
    ating Characteristic Area in Studies with Small Samples. Academic Radiology, 5(8): 561–571.
Peirce, Charles S. 1884. The Numerical Measure of the Success of Predictions. Science 4: 453–454.
Pepe, Margaret S. 2003. The Statistical Evaluation of Medical Tests for Classiﬁcation and Predic-
    tion. Oxford: Oxford University Press.
Pesaran, M. Hashem, and Allan Timmermann. 1992. A Simple Nonparametric Test of Predictive
    Performance. Journal of Business and Economic Statistics, 10(4): 461–465.
Pesaran, M. Hashem, and Allan Timmermann. 2009. Testing Dependence Among Serially Cor-
    related Multicategory Variables. Journal of the American Statistical Association, 104(485):
    325–337.
Peterson, W. Wesley, and Theodore G. Birdsall. 1953. The Theory of Signal Detectability: Part
    I. The General Theory. Electronic Defense Group, Technical Report 13, June 1953. Available
    from EECS Systems Oﬃce, University of Michigan.
Polk, Christopher, Samuel Thompson, and Tuomo Vuolteenaho. 2006. Cross-sectional Forecasts of
    the Equity Premium. Journal of Financial Economics, 81(1):101–41.
Rubin, James. 1973. Weak Convergence of the Sample Distribution Function When Parameters
    are Estimated. The Annals of Statistics, 1(2): 279–290.
Shorack, Galen R., and Jon A. Wellner. Empirical Processes with Applications to Statistics. Hobo-
    ken, N.J.: John Wiley & Sons.


                                               39
Sinclair, Peter J. N. 2005. How Policy Rates Aﬀect Output, Prices and Labour, Open Economy Is-
    sues, and Inﬂation and Disinﬂation. In How Monetary Policy Works, edited by Lavan Mahadeva
    and Peter Sinclair. London: Routledge.
Spackman, Kent A. 1989. Signal Detection Theory: Valuable Tools for Evaluating Inductive Learn-
    ing. In Proceedings of the Sixth International Workshop on Machine Learning. Morgan Kauf-
    man, San Mateo, Calif., 160–63.
Stanski, Henry R., Laurence J. Wilson, and William R. Burrows. 1989. Survey of Common
    Veriﬁcation Methods in Meteorology. Research Report No. 89-5, Atmospheric Environment
    Service, Forest Research Division, 4905 Duﬀerin Street, Downsview, Ontatio, Canada.
Swets, John A., and R. M. Pickett. 1982. Evaluation of Diagnostic Systems: Methods from Signal
    Detection Theory. New York: Academic Press.
van de Vaart, Aad W. 1998. Asymptotic Statistics. Cambridge: Cambridge University Press.
Venkatraman, E. S., and Colin B. Begg. 1996. A Distribution-Free Procedure for Comparing
    Receiver Operating Characteristic Curves from a Paired Experiment. Biometrika 83: 835–48.
Waegeman, Willem, Bernard de Baets and Luc Boullart. 2008. ROC Analysis in Ordinal Regression
    Learning. Pattern Recognition Letters, 29(1): 1–9.
World Meteorological Organization. 2000. Standard Veriﬁcation System for Long-Range Forecasts.
    Geneva: World Meteorological Organization.
Youden, W. J. 1950. Index for Rating Diagnostic Tests. Cancer 3, 32–35.
Zhou, Xia-Hua, Nancy A. Obuchowski, and Donna K. McClish. 2011. Statistical Methods in
    Diagnostic Medicine. Hoboken, N.J.: John Wiley & Sons.




                                              40
