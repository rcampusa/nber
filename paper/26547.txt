                               NBER WORKING PAPER SERIES




         FIRM AND WORKER DYNAMICS IN A FRICTIONAL LABOR MARKET

                                        Adrien G. Bilal
                                        Niklas Engbom
                                        Simon Mongey
                                      Giovanni L. Violante

                                       Working Paper 26547
                               http://www.nber.org/papers/w26547


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                   December 2019




The authors declare that they have no relevant or material financial interests that relate to the
research described in this paper. We thank our discussants Björn Brügemann, Nir Jaimovich and
Thibault Lamadon. We also thank Pierre Cahuc, V.V. Chari, Steven Davis, Nobu Kiyotaki, Per
Krusell, John Moore, Giuseppe Moscarini, and Jean-Marc Robin, and many other seminar
participants for their useful feedback. We thanks Hugo Lhuillier and Alex Weinberg for excellent
research assistance. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

At least one co-author has disclosed a financial relationship of potential relevance for this
research. Further information is available online at http://www.nber.org/papers/w26547.ack

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Adrien G. Bilal, Niklas Engbom, Simon Mongey, and Giovanni L. Violante. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Firm and Worker Dynamics in a Frictional Labor Market
Adrien G. Bilal, Niklas Engbom, Simon Mongey, and Giovanni L. Violante
NBER Working Paper No. 26547
December 2019
JEL No. E24,E32,J41,J63,J64

                                           ABSTRACT

This paper develops a random-matching model of a frictional labor market with firm and worker
dynamics. Multi-worker firms choose whether to shrink or expand their employment in response
to shocks to their decreasing returns to scale technology. Growing entails posting costly
vacancies, which are filled either by the unemployed or by employees poached from other firms.
Firms also choose when to enter and exit the market. Tractability is obtained by proving that,
under a parsimonious set of assumptions, all workers' and firm decisions are characterized by
their joint marginal surplus, which in turn only depends on the firm's productivity and size. As
frictions vanish, the model converges to a standard competitive model of firm dynamics which
allows a quantification of the misallocation cost of labor market frictions. An estimated version of
the model yields cross-sectional patterns of net poaching by firm characteristics (e.g., age and
size) that are in line with the micro data. The model also generates a drop in job-to-job transitions
as firm entry declines, offering an interpretation to U.S. labor market dynamics around the Great
Recession. All these outcomes are a reflection of the job ladder in marginal surplus that emerges
in equilibrium.

Adrien G. Bilal                                   Simon Mongey
Department of Economics                           Kenneth C. Griffin Department of Economics
Princeton University                              University of Chicago
Julis Romo Rabinowitz Building                    1126 E. 59th Street
Princeton, NJ 08544                               Chicago, IL 60637
abilal@princeton.edu                              and NBER
                                                  mongey@uchicago.edu
Niklas Engbom
Department of Economics                           Giovanni L. Violante
Stern School of Business                          Department of Economics
New York University                               Princeton University
44 West Fourth Street                             Julis Romo Rabinowitz Building
New York, NY 10012                                Princeton, NJ 08540
niklas.engbom@gmail.com                           and NBER
                                                  glv2@princeton.edu




An online appendix is available at http://www.nber.org/data-appendix/w26547
1    Introduction

Aggregate production in the economy is divided into millions of firms, each facing idiosyncratic fluc-
tuations in its productivity and demand. Understanding the process of labor reallocation across these
production units is important for several reasons. In the long run, reallocating labor away from unpro-
ductive firms toward more productive firms enhances aggregate productivity and growth. In the short
run, the propagation of sectoral and aggregate shocks depends on how quickly labor flows across firms
and between unemployment and employment. From a normative perspective, understanding the po-
tential welfare losses or gains due to reallocation is necessary for assessing the efficacy of policies that
subsidize jobless workers, protect employment, or advantage particular sectors/firms.
    The labor reallocation process has three key properties. First, it has distinct layers: the entry and exit
of firms, the creation and destruction of positions (i.e., jobs) at existing firms, and the turnover of workers
across jobs at existing firms. Second, it is intermediated by labor markets that are frictional, as revealed
by the coexistence of vacancies and job seekers. Third, around half of worker turnover occurs through
direct job-to-job transitions: most new hires come from another firm rather than from unemployment.
    Conceptually, therefore, addressing labor reallocation requires a framework with (i) a theory of the
firm (i.e., its boundaries) and of firm dynamics (entry, growth, separations, exit); and (ii) a theory of
worker flows intermediated by frictional labor markets that allows for on-the-job search and job-to-
job mobility (i.e., poaching). Quantitatively, such a framework should account for a new body of time
series and cross-sectional evidence--emerging from matched employer-employee data--that describes
the relationship between firm characteristics and the direction and composition of worker flows.1
    In this paper, we present a new model with these traits. A firm is a profit maximizing owner of a
technology with decreasing returns to scale and stochastic productivity, that chooses optimally whether
to enter and when to exit the market.2 Firms grow by posting costly vacancies that are randomly matched
to either unemployed or employed workers. Worker flows occur when matched workers determine that
the value of working at the matched firm exceeds their value of unemployment or employment in their
current firm. In general, with decreasing returns to scale in production, these values are a complicated
function of a high dimensional state vector that includes distributions of wages or worker values inside
the firm. This makes the problem intractable.
    The first contribution of our paper is to set out a parsimonious set of assumptions that are sufficient
     1 If we consider hires for a particular firm type (e.g., young, small and fast-growing), by composition we mean the split

between hires from unemployment and those from employment. Within hires from employment, direction refers to the charac-
teristics of the employers between which workers are reallocated.
     2 Or, equivalently, a monopolistic producer facing a downward sloping demand curve with a stochastic shifter. These two

interpretation are isomorphic in our model.


                                                              1
for tractability. Our assumptions place a minimal structure on bargaining and surplus sharing such that,
as a result, the state vector becomes manageable. Three assumptions are common to many single-worker
firm environments: (i) lack of commitment in firing and quit decisions; (ii) wage contract renegotiation
by mutual consent; (iii) Bertrand competition among employers for employed jobseekers. Two further
assumptions are required in our new multi-worker firm environment: (iv) internal wage renegotiations
between the firm and its incumbent workers are a zero-sum game, i.e. no surplus gets lost; and (v) pri-
vately efficient vacancy posting--for which we offer an explicit microfoundation. Under these assump-
tions firm and workers' decisions are privately efficient, as if the firm and incumbent workers maximize
their joint value. The state variables of the joint value function are only firm size (n) and productivity (z),
allowing us to cleanly study firm and worker dynamics in a frictional labor market.
    Two other ingredients are vital to achieve tractability. First, we work in continuous time. In a small
interval of time only one random event may occur. A firm, for example, only needs to deal with one of its
employee meeting another firm, not all combinations of its employees meeting other firms. Second, we
take the continuous limit of a discrete workforce. Worker flows are determined by comparing the change
in joint surplus that would arise if a worker either joins or leaves a firm. With a continuous measure of
workers, this marginal surplus can be conveniently expressed as a partial derivative of total surplus.
    We show that total and marginal surplus are sufficient for characterizing firm and worker dynamics.
Marginal surplus pins down hiring: facing a convex vacancy cost, firms post vacancies until the marginal
cost of a vacancy is equal to the expected marginal surplus of hiring. Marginal surplus also pins down
separations: facing a decreasing marginal product of labor, firms fire workers until the marginal surplus
of a worker equals the value of unemployment. When total surplus is less (more) than the firm's private
outside option the firm exits (enters). Finally, in equilibrium, marginal surpluses determine the direction
of worker flows. Workers climb a job ladder in marginal surplus, quitting when on-the-job search delivers
a match with a higher marginal surplus firm. An intuitive Bellman equation accounts for the evolution
of surplus, while a law of motion reflecting frictional labor reallocation accounts for the evolution of the
firm size and productivity distribution.3
    Our second contribution is to exploit the tractability of this simple representation to analytically
characterize equilibrium firm and worker reallocation. First, we characterize firm dynamics and job
turnover graphically in (n, z)-space by describing the regions in which a firm exits, fires and hires. Firms
that exit and fire always destroy jobs. Hiring firms may either grow on net (creating jobs) or shrink on net

    3 This representation uniquely pins down firm and worker dynamics, the subject of this paper, but is consistent with mul-

tiple wage determination mechanisms that determine how this joint value is split. Wages, therefore, are not allocative in that
the distribution of firms and flows of workers across firms is independent of wage dynamics. In order to study the model's
implication for wage dynamics, one has to make additional assumptions. We return on this point in Section 2.


                                                              2
(destroying jobs) because some of their workers quit to firms with a higher rank in the marginal surplus
ladder. Second, we decompose net growth of hiring firms into the different types of gross flows: hires
and separation from/to unemployment and from/to employment via poaching. This decomposition
varies systematically with the firm states (n, z) since they determine the firm marginal surplus. Third,
we study the limiting behaviors of our economy. As decreasing returns to scale vanish, the economy
converges to one in which single-worker firms operate in a frictional labor market (à la Postel-Vinay and
Robin, 2002). As frictions vanish, the economy converges to one in which multi-worker firms operate in
a competitive labor market (à la Hopenhayn, 1992). We show that this limit obtains only in the presence
of on-the-job search, which provides the key force toward equating marginal products across firms. As
opposed to an economy with constant returns to scale, our economy features a non-degenerate size
distribution in the limit.
   Our third contribution is to exploit the tractability of our framework to implement the model quanti-
tatively. We estimate the model by Simulated Method of Moments, targeting cross-sectional moments of
the size distribution of firms, firm dynamics, job flows and worker flows for the U.S. economy. We argue
that parameters are well-identified. We then validate the model, conducting a data-model comparison
of how firm-level hiring is split into inputs, i.e. between vacancy rates and vacancy yields (as in Davis,
Faberman, and Haltiwanger, 2013) and outputs, i.e. between hires from employment and from unem-
ployment (as in Bagger, Fontaine, Galenianos, and Trapeznikova, 2019). A firm experiencing a positive
productivity shock increases hiring by posting more vacancies, but more so by filling those vacancies
faster as a higher marginal surplus makes it more attractive to jobseekers. For the same reason, hires
from employment increase disproportionately more than hires from unemployment. These patterns are
quantitatively consistent with the data.
   Finally, we use the parameterized model to address three quantitative questions that require an envi-
ronment with decreasing returns to scale and on-the-job search. No other existing structural equilibrium
model can address them.
   We begin by quantifying the misallocation effects of labor market frictions. A doubling of match
efficiency, which approximately corresponds to a doubling of contact rates, raises output by 15 percent
relative to our estimated benchmark. Our key finding is that four fifths of the increase in output is caused
by lower labor misallocation due to faster job-to-job transitions rather than by higher scale of production
due to more employment.
   Next, we direct our attention to a new set of facts about job-to-job flows and net poaching. Job-to-
job flows and net poaching vary systematically by firm characteristics in the data (Haltiwanger, Hyatt,
Kahn, and McEntarfer, 2018). Young firms poach workers from older firms, but firm size is only weakly

                                                     3
correlated with net poaching. Our theory offers an interpretation of these facts. A young firm is far
from its optimal size, and since decreasing returns generates a high marginal surplus, this firm will be
near the top of the job ladder. However, a firm may be small because unproductive, or because young
even if productive. These two types of small firms will be on opposite ends of the job ladder. To guide
future measurement we show that labor productivity and firm growth are observables that are strongly
positively correlated with marginal surplus, so predictive of net poaching and job ladder rank.
   We conclude the quantitative analysis with an application to the U.S. Great Recession. Two distin-
guishing features were the sharp drop in firm entry and a decline in job-to-job reallocation of workers
that led to a `failure of the job ladder', i.e. a slow down of the process through which workers climb to-
ward better firms (Siemer, 2014; Moscarini and Postel-Vinay, 2016). Our model suggests that the former
accounts for the latter. A transitory shock to the discount rate (a commonly used shortcut for worsening
financial frictions) lowers the value of entry and shrinks the population of young, high marginal sur-
plus firms with high equilibrium net poaching rates. With fewer firms at the top of the job ladder and
less vacancy posting among these firms, labor reallocation up the ladder breaks down. The resulting
misallocation causes a persistent slump in output.
   Overall, these applications demonstrate that our new theoretical framework offers a useful platform
to jointly analyze the microeconomic dynamics of firms and workers in a frictional labor market and
how these relate to macroeconomic fluctuations.


Literature

Our paper connects two strands of literature. The common core between the two is the idea that dimin-
ishing returns in production and heterogeneity in productivity are the dominant forces that delivers a
non-degenerate firm-size distribution. This idea goes back at least to Lucas (1978) span of control model.
   The first strand is the large literature on equilibrium models of single-product firm dynamics with
competitive labor markets. Classic examples are Hopenhayn (1992), Hopenhayn and Rogerson (1993),
and Luttmer (2011).4 Recent examples, with applications to the Great Recession, are Arellano, Bai, and
Kehoe (2016), Clementi and Palazzo (2010) and Sedlácek (2014).
   Like these models, our framework features entry, exit, and non degenerate distributions of firm size
and age. Unlike these models, the employment adjustment costs that firms face are endogenous. They
depend on the firm's probability of poaching and the expected transfers required to hire a worker away
from a competing firm. Both are a function of the firm rank on the marginal surplus ladder, which itself


   4 For   a review of the literature see also Luttmer (2010).


                                                                 4
is an equilibrium object. The frictionless limit of our model, where these endogenous costs vanish, is a
version of Hopenhayn (1992).
    The second literature comprises a number of papers that model multi-worker firms in frictional labor
markets. Here, two parallel approaches have been taken: directed search and random search.
    The directed search models of Kaas and Kircher (2015) and Schaal (2017) generate firm employment
dynamics resembling those in the micro data.5 Building on Menzio and Shi (2011), the model developed
by Schaal (2017) also allows for on the job search, and thus is the closest counterpart of our framework
within the directed search approach. A drawback of directed search is that the probability that a firm
hires from another firm or from unemployment is not determined.6 As a result, this class of models
cannot speak to systematic variation in net poaching rates or the composition of hires across firm types
that have been documented in micro data. A model consistent with these facts is one of the objectives of
our analysis.
    In the random search strand, Elsby and Michaels (2013) and Acemoglu and Hawkins (2014) solve
models where firms face decreasing returns in production, linear vacancy costs, and wages determined
by Nash bargaining. Both generate employment relationships with a large average surplus and small
marginal surplus. Elsby and Michaels (2013) demonstrate that the latter property yields a volatile job-
finding rate over the cycle, while the former avoids an excessively high separation rate, thus resolving
the tension identified by Shimer (2005) in the Diamond-Mortensen-Pissarides framework. Gavazza,
Mongey, and Violante (2018) generalize this model by introducing a hiring effort decision and financial
constraints and show that it accounts for the sharp drop in aggregate recruiting intensity around the
Great Recession. All of these models abstract from search on-the-job.7
    Random search models with wage posting feature both on-the-job search and a firm-size distribution
despite constant returns to scale. These follow Burdett and Mortensen (1998) and its generalizations to
out of steady-state dynamics in Moscarini and Postel-Vinay (2013, 2016), Coles and Mortensen (2016),
Engbom (2017a), Gouin-Bonenfant (2018) and Audoly (2019). In these models the size distribution is non
degenerate only because of the existence of search frictions. As frictions disappear, all workers become


    5 It is worth remarking that these two papers had very different objectives to ours. Kaas and Kircher (2015) illustrate that a
key advantage of directed search, the efficiency and block-recursivity properties of equilibrium, extends to models with `large'
firms. Schaal (2017) proves this property is also robust to the addition of on-the-job-search and studies aggregate uncertainty
shocks in the context of the Great Recession.
     6 A key feature of the equilibrium is that net hiring costs are equated across firms through free entry, which implies that

firms are indifferent across the markets in which they search for workers. The probability that a separation from a firm is to
employment or unemployment, however, is determined.
     7 Fujita and Nakajima (2016) introduce on-the-job search and study the dynamics of job-job flows over the business cycle.

However, in their model all workers are always indifferent between searching/working and staying/moving because, to solve
for the equilibrium, they must assume that the worker outside option is always the value unemployment.


                                                                5
employed at the most productive firm.8 In our framework, instead, we can decompose how much of
size dispersion is due to technology and how much is due to frictions.
    Within the random search literature, we build on the set-up developed by Postel-Vinay and Robin
(2002), which pairs Bertrand competition for workers among employers with wage renegotiation under
mutual consent. This environment has become another workhorse of the literature due to its tractability
and empirically plausible wage dynamics.9 Kiyotaki and Lagos (2007) develop a version of this protocol
which is a step closer to us. Their firms have fixed capacity of exactly one position and thus feature
an extreme version of decreasing returns to scale. In their model, when a matched firm meets another
worker, it also engages in a negotiation with its current incumbent. Internal renegotiation is a prominent
feature of our model. Our contribution is to generalize this sequential auction protocol to multi-worker
firms, show how one can still solve the model's equilibrium through the notion of joint surplus, and in
doing so maintain a great deal of tractability. As opposed to the original Postel-Vinay and Robin (2002)
framework the probability of hiring is not a function of the exogenous distribution of firm productivity,
but is determined by the endogenous distribution of marginal surpluses, which itself depends on how the
equilibrium of the frictional labor market has allocated workers across heterogeneous firms.
    The final expression for joint surplus that features among our equilibrium conditions is reminiscent
of that in Lentz and Mortensen (2012), a version of Klette and Kortum (2004) with on-the-job search in
which a firm's demand for labor is limited by demand for its portfolio of products. While they assume
that all decisions are based on joint firm-workers values, we derive this result from primitives, provide
a characterization of the equilibrium and illustrate how to use the model for a quantitative analysis of
newly documented empirical patterns. Our central finding that a job ladder in marginal surplus arises
in equilibrium is closely related to contemporaneous work by Elsby and Gottfries (2019) who elegantly
characterize a special case of our environment with linear vacancy costs and no firm entry/exit. In
this setting a firm's values and its decisions are only a function of a single state variable reflecting the
marginal product of labor. In our model marginal surplus is related to the marginal product of labor,
but includes continuation values that depend on average surplus due to exit. In our calibrated model,
we find that the rank-correlation between marginal surplus and marginal product is high. To the extent
that marginal and average products of labor are strongly correlated, our result implies that the average
product of labor--which is easily measurable--is an informative proxy for the rank of a firm in the job
ladder, even in environments richer than Elsby and Gottfries (2019).

    8 Another implication of such environments is that large firms, which pay higher wages in the model, should poach from

small firms, while the data suggest otherwise.
    9 Recent examples are Postel-Vinay and Turon (2010); Jarosch (2015); Lindenlaub and Postel-Vinay (2016); Borovicková

(2016); Lise and Robin (2017).


                                                            6
Outline.      We first layout the model in a series of steps. In Section 2 we establish the environment and
our key assumptions on how firm and workers share value following various stochastic events, before
stating our joint value representation. To provide intuition on how these assumptions deliver tractability,
Section 3 applies these assumptions in a simplified, static framework. Section 4 returns to the fully
dynamic model and, after defining an equilibrium, characterizes firm dynamics and worker flows. In
Section 5 we estimate the model with US data, discuss identification and validate our parameterization.
Section 6 present our three quantitative exercises. Section 7 concludes. The Appendix contains all proofs
and details on the computation of the model's equilibrium and its simulation.



2     Model

In this section we describe the characteristics of the agents in the economy, how meetings take place
in the labor market, and the timing of events. We then lay out our key assumptions regarding the
contractual environment, i.e. on how the value generated by production is shared. Finally, we state our
main result: the joint value representation of the economy. Under this representation, all allocations are
privately efficient, meaning that they maximize the joint value of all the agents involved in the decision.


2.1    Physical environment

Time is continuous and there is no aggregate uncertainty. There are two types of agents. An exogenous
mass n of ex-ante identical, infinitely-lived workers that are risk neutral, discount the future at rate  and
are endowed with one unit of time each period which is inelastically supplied to production. An infinite
mass of homogeneous potential firms, of which an endogenous mass become operating firms.

Production technology.            There is a single homogeneous good. Workers may either be employed or
unemployed. Unemployed workers produce b units of the final good. Employed workers are orga-
nized into firms which are heterogeneous in their productivity z  Z. A firm employing n workers
produces y(z, n) units of the final good, where y(z, n) is strictly increasing in z and n and concave in n,
i.e. ynn (z, n)  0.10, 11

    10 In addition, we assume that for any z the Inada conditions hold with respect to n:(i) y(z, 0) = 0, (ii) limn0 yn (z, n) = +,
and (iii) limn+ yn (z, n) = 0.
   11 Key for firms' decisions is that this specification yields a decreasing returns to scale revenue function r ( z, n ) = Py ( z, n ),

with the normalization P = 1. An alternative foundation for a decreasing returns to scale revenue function is constant returns
to scale in production of a differentiated final good which would yield a decreasing marginal revenue as under monopolistic
competition. If firms' goods are imperfectly substitutable and household preferences are CES with elasticity  > 1, the firm
faces a demand curve p(z, n)  y(z, n)-1/ , such that the revenue function is r (z, n) = p(z, n) × y(z, n)  y(z, n)( -1)/ . Our
framework therefore accommodates imperfect substitutability in the goods market which is a key ingredient of trade models


                                                                   7
Firm demographics. A potential firm becomes an operating firm by paying a fixed cost c0 . Paying the
fixed cost c0 produces a draw of productivity z from the distribution 0 (z) and n0 workers, taken from
unemployment. If a potential firm enters and becomes an operating firm then its productivity z evolves
stochastically. At any point in time a firm may exit, at which point all of its workers become unemployed
and the firm produces  > 0 units of the final good which we refer to as its scrap value.12 Denote the
mass of entrants m0 and the mass of operating firms m.

Matching technology. Workers join firms from both employment and unemployment through a fric-
tional matching process. The total number of meetings between firms and workers is given by a CRS
aggregate matching technology m(s, v). Inputs to the matching technology are total vacancies v and
total units of search efficiency s = u +  (n - u), where the parameter  determines the relative search
efficiency of employed workers. Search is random in the following sense. A firm pays a cost c(v; z, n)
to post v vacancies, where c is increasing and convex in v and c(0; ·, ·) = 0. Each vacancy of the firm
is matched with a worker at rate q(s, v) = m(s, v)/v. With probability  = (u/s) the worker is un-
employed, with probability (1 - ) the worker is employed. A worker faces no cost of search. An
unemployed worker meets a firm at rate U (s, v) = m(s, v)/s. An employed worker meets a firm at
rate  E (s, v) = U (s, v). The rates q and U can be expressed in terms of market tightness  = (v/s)
If constituted, the match of a worker to a firm exogenously expires at rate , upon which the worker
becomes unemployed.

States.    Let x be the vector of state-variables for the firm. This vector includes all individual state vari-
ables of all workers at the firm. For now, we do not specify exactly what is in x and, along the way, define
a number of functions that map x at instant t into a new state vector at t + dt. The vector x is common
knowledge among all workers and the firm. Let i be an indicator function (possibly also a vector) that
selects the particular entries of x that identify the worker within a firm (i.e., i is the unique identity of a
worker in the firm x).13 Let H ( x ) be the measure of x across firms in the economy, v( x ) the number of
vacancies created by a firm with state x, and n( x ) employment at firm x. The total mass of vacancies and
employed workers in the economy are
                                     ¢                                         ¢
                                v=       v ( x ) dH ( x )   ,   n = n-u =          n ( x ) dH ( x ) .


and macroeconomic models with nominal rigidities.
    12 A positive scrap value plays the same role as a fixed operation cost in generating endogenous exit.
    13 For example, x is a complete description of IBM and of all its workers. It might contain IBM productivity z, its size n, and

all those features of the contracts of the current employees that are needed to forecast IBM's value and the value of each of its
workers. The state ( x, i ) should be read: here is IBM, characterized by x, and we are assessing the characteristics of the worker
named i within IBM.


                                                                8
Probability densities that will show up in firm and worker problems describe the vacancy-weighted and
employment weighted distributions of firms:

                                                   v( x )h( x )                    n( x )h( x )
                                      hv ( x ) =                  ,   hn ( x ) =                .
                                                        v                               n


Information.        Information in the economy is complete. Workers and firms know the relevant aggregate
variables, i.e. u, m, the measure H ( x ) and distributions Hv ( x ), Hn ( x ). The states x and x of firms
in competition for a worker are observable to both firms and to all incumbent workers of the two firms.
Similarly, unemployed workers know the vector x of the firm they meet when searching, and incumbents
of firm x know whether the firm has met with an unemployed worker.

Timing.       We separate the within-dt timing of events in the model into two parts.
      First, events up to the opening of the labor market are described in Figure 1. A firm's productivity z
is first realized. Next, incumbent workers are fired, choose whether to quit the firm, or their employment
contracts are renegotiated. Next, the firm decides whether to stay in operation or exit. An operating firm
produces y(z, n), pays wages according to contracts with its workers, and posts vacancies in the labor
market.
      Second, the mutually exclusive events that may occur to a worker or firm are described in Figure
2.14 The first branch in Figure 2 describes events that may occur to an unemployed worker. The second
and third branch distinguish between direct and indirect events that may affect the value of incumbent
worker i. Direct events involve worker i meeting with another firm, or the destruction of the worker's
job. Indirect events involve worker i's co-worker j meeting with another firm, or the destruction of a
co-worker's job. The final branch describes events that directly impact the firm. The firm may meet an
employed or unemployed worker, emerge either with a new hire or not and new allocation of values to
its workers, reflected in updates to the state x. Following any of these events, the state vector x changes,
potentially affecting the value of the match to worker i. Through the following assumptions, we put
structure on the states in which these events occur and how values evolve in each case.


2.2     Contractual Environment

In this section we state a set of assumptions on the contractual environment sufficient to derive our main
theoretical results. It is useful to begin from the definition of a wage contract. A contract between the
firm and one of its workers is a binding agreement which specifies a constant wage, i.e. a fixed payment

  14 The   mutual exclusivity property is a consequence of continuous time.


                                                                  9
                           Beginning of
                           period [t, t + dt]
                                                    Separation                              Operation
                          · State xt :                                                                             Productivity
                                                    · Workers quit                          · Produce              shocks
                          · Productivity zt                                   Stay/Exit
                                                    · Firms fire                            · Pay wages            Labor Market
                          · Workers nt                                                                             Opens
                                        nt          · Renegotiation                         · Post vacancies
                          · Wages {wit }i =1

                          · ...


                          Figure 1: Timing of events prior to the opening of the labor market


                                                                                                        t
                                                                                                Rejec          Unemployment
                                                    Meeting
                      Direct events to un-
                      employed worker                                  Take-leave offer
                                                                                               Accep           New firm
                                                                                                        t


                                                                                                 Stay          Possible wage gain for i
                                                       eti
                                                      en tan g
                                                            ct
                                                    M
                                                    Co                 Sequential auction
                      Direct events to em-
                                                                                               Switc           New firm for i
                      ployed worker i                                                                 h
                                                   Destro              Unemployment
                                                           yed

             Labor
             Market                                                                                            ­ Possible wage gain for j
             Opens                                                                               Stay
                                                                                                               ­ New state for i
                                                    M  eti
                                                      en tancg
                                                             t         Sequential auction
                                                    Co
                      Direct events to em-                                                     Swit            ­ New firm for j
                      ployed workers j = i                                                         ch
                                                                                                               ­ New state for i
                                                   Destr               Unemployment
                                                          oyed
                                                                        New state for i


                                                                                                 Hire
                                                             loyed                                             ­ Possible wage cut for incumbents
                                                        unemp
                                                Meets                  Take-leave offer                        ­ New state for all workers
                      Events to firm
                                                Meets                  Sequential auction                      ­ Possible wage cut for incumbents
                                                        emplo
                                                                 yed                                           ­ New state for all workers
                                                                                               Not hire



                Figure 2: Labor market: Set of mutually exclusive possible labor market events


   from the firm to the worker, in exchange for labor services. The contract satisfies five assumptions:

(A-LC) Limited commitment. All parties are subject to limited commitment. In particular,

          (a) Layoffs - Firms can fire workers at will.

         (b) Quits - Workers can always quit into unemployment or to another firm when they meet one.

          (c) Collective agreements - Workers cannot commit to any other worker inside the firm. De facto
             this assumption rules out transfers among workers.

(A-MC) Mutual consent. The wage (contract) can be renegotiated only by mutual consent, i.e. only if one
        party can credibly threaten to dissolve the match (the firm by firing, the worker by quitting). A


                                                                                10
         threat is credible when one of the two parties has an outside option that provides her with a value
         that is higher than the value under the current contract.

(A-EN) External negotiation. An external negotiation is a situation where, through search, the firm comes
         into contact with an external job seeker or an incumbent worker comes into contact with another
         firm. In external negotiations, all offers are take-it-or-leave-it.

            · In a meeting an unemployed worker, the firm makes a take-leave offer to the worker.

            · In a meeting with an employed worker, the two firms Bertrand compete through a sequential
               auction. First, the poaching firm makes the take-leave wage offer. Second, the target firm
               makes a take-leave counteroffer to the worker. Third, the worker decides.

(A-IN) Internal negotiation. An internal negotiation is any other situation where contracts between firm
         and any incumbent workers are modified (following (A-MC), an internal negotiation takes place
         when any party has a credible threat). The only parties involved in an internal negotiation are those
         that have a threat and those that are under that threat. We assume that--with respect to worker
         and firm values--the internal negotiation is a zero-sum game and that participation is individually
         rational for all parties.15 Apart from these assumptions we leave internal negotiation unrestricted.

(A-VP) Vacancy posting. The firm posts the privately efficient amount of vacancies, which is the one that
         maximizes the sum of the values of the firm and its workers. Below we propose one possible
         micro-foundation for (A-VP).


  Discussion.      First, our simple wage contracts are rooted in incomplete contract theory, in which a key
  tenet is that contracting is only allowed on features that are verifiable to a third party e.g. a court. In our
  context, the only verifiable and hence contractible features are the wage, whether the firm made the wage
  payment, and whether the worker provided labor services. As a result, more complex state contingent
  contracts are ruled out. In the context of such incomplete contracts, renegotiation under mutual consent
  is a natural assumption consistent with many existing legal frameworks (as argued by Malcomson, 1999),
  and in the terminology of MacLeod and Malcomson (1989) yields self-enforcing contracts.
      Second, (A-LC, a,b), (A-EN) and (A-MC) amount to the contractual environment in Postel-Vinay
  and Robin (2002). The authors show that they lead to a convenient joint value representation in the one-


     15 We adopt the standard definition of a zero-sum game: each individual's gain or loss is exactly offset by losses and gains of

  other participants. We also adopt the standard definition of individual rationality: after internal negotiation each player who
  remains employed at the firm receives at least the outside option that was present before internal negotiation.


                                                                 11
worker-one-firm model. We now discuss how (A-IN) and (A-VP) are sufficient to extend this convenient
representation to an environment with a diminishing marginal product of labor.
    Our zero-sum game assumption on internal negotiation (A-IN) allows for a large class of possible
micro-foundations for the internal renegotiation game. Each would imply different wage dynamics. The
central takeaway is that, no matter the details of such a game, if (A-IN) is satisfied then our following
representation of allocations as determined by joint value dynamics holds. Since this paper focuses on
the allocations that result from firm and worker dynamics in a frictional labor market, we leave for fu-
ture research a detailed theoretical and empirical investigation of the implications of different internal
renegotiation games.16
    Absent (A-VP), the firm would have strong incentives to over-post vacancies relative to the privately
efficient amount. The incentives to over post come in two forms: over-hiring and generating what we call
swapping threats. The firm may post vacancies in order to over-hire, lowering marginal product and so
credibly threaten some of its incumbents with wage cuts, as extensively discussed by Stole and Zwiebel
(1996) and Brügemann, Gautier, and Menzio (2018). The firm may also post vacancies with no intention
of hiring--which only occurs when marginal products are decreasing--hoping to use a match to threaten
to swap an incumbent worker with a job seeker, extracting a wage cut from the incumbent. Proceeding
under either would require the full distribution of wages as a state variable, ruling out tractability. As-
sumption (A-VP) resolves these issues.17
    The presence of these inefficiencies and the need for an assumption like (A-VP) is unique to an envi-
ronment with DRS, on-the-job search and endogenous vacancy posting. In a model with constant returns
and on-the-job search, over-hiring does not arise due to a constant marginal product of labor (Postel-
Vinay and Robin, 2002). Constant returns also implies that filling a vacancy with a matched job seeker is
always profitable, removing the swapping threat. In a model with extreme decreasing returns--a capac-
ity constraint of one worker--and on-the-job search but without endogenous vacancy posting there is
no inefficient vacancy posting to resolve (Kiyotaki and Lagos, 2007). In a multi-worker firm model with
decreasing returns and endogenous vacancies but without on-the-job search, incumbents are all hired
from unemployment and with the same outside option are paid the same wage (Elsby and Michaels,
2013; Acemoglu and Hawkins, 2014). Swapping is not a threat because the job seeker and incumbent are
    16 As a start, a companion note available on our websites, (Bilal, Engbom, Mongey, and Violante, 2019) shows how wages

would be pinned down under a particular internal renegotiation mechanism. We assume that workers make take-leave of-
fers to the firm in internal renegotiation. Since this satisfies (A-IN), then allocations are consistent with our general represen-
tation (1). In this setting we can compute wages without having to keep track of the entire within-firm wage distribution
under the assumption that exit is exogenous. We show that if, instead, the firm made take-leave offers to workers in internal
renegotiation--which also satisfies (A-IN), complex transfers would be needed to implement (A-VP) and compute wages.
    17 In a different environment that allows full commitment to paying a fixed wage, as in Hawkins (2015), wage cuts are

assumed away which eliminates privately inefficient vacancy posting.


                                                                12
   paid the same wage. An over-hiring inefficiency is present, but with a degenerate distribution of wages
   within the firm, accommodating this inefficiency does not impede tractability. On-the-job-search gener-
   ates a distribution of wages inside the firm due to the origin of hire and accumulated outside offers. If
   not addressed, the over-hiring inefficiency would render the model intractable.
         We propose one possible micro-foundation that implements assumption (A-VP). The idea is to re-
   move any gains to the firm from expected future wage cuts that would otherwise encourage excess
   vacancy posting. We assume that workers anticipate that firm's behavior and offer a preemptive wage
   cut that leaves the firm indifferent between the efficient vacancy policy and the firm's privately optimal
   policy.18 We formalize this assumption below.

(A-VPI) After the firm announces its proposed vacancies for dt, a randomly selected incumbent worker
           has the opportunity to make a take-leave counter-offer to the firm. The counter-offer specifies
           acceptable wages for all (or some) incumbents in exchange for an alternative spot vacancy policy.19

         Having described the economy's environment and the contract space, we now state our main result.


   2.3    Joint value representation

   In this section we describe the main theoretical result of the paper. For presentation purposes, the en-
   vironment is specialized in two ways. First, each firm employs a continuum of workers n. Second,
   productivity follows a diffusion dzt = µ(zt )dt + (zt )dWt .20


   Result.    All allocative decisions in the economy--entry, exit, vacancy posting and mobility of workers
   between firms--are determined by the joint value. The joint value (z, n) is the sum of the present dis-
   counted value of an operating firm's profits plus the present discounted value of lifetime utility of its
   workers, and satisfies the following, where U is lifetime utility of an unemployed worker:




      18 Alternative implementations could be based on the introduction of `social norms' that prevent firms from cutting the
   wage of a worker and swapping an incumbent worker with a new worker. Because they would involve deviations from lack
   of commitment (A-LC), we do not emphasize these alternative implementations in this paper.
       19 This assumption does not require commitment because it is a `spot contract' between the parties involved: a transfer in

   exchange for an immediate action.
       20 As shown in the Appendix, our results also hold with an integer-valued workforce and when the productivity process is

   a jump-diffusion.


                                                                13
             (z, n) = max            y ( z, n ) - c ( v; z, n )                                                            (1)
                            v 0

              EU destruction:        -  n  n z, n - U

                       UE hire:      +  q (  ) v  n z, n - U
                                                           ¢
                       EE hire:      + (1 -  ) q (  ) v           max n z, n - n z , n        , 0 dHn z , n

                                                                   ( z )2
                         Shock:      + µ ( z )  z z, n +                  zz z, n .
                                                                    2

Firms' operation requires (z, n) to be interior to an exit boundary. An additional boundary condition
determines when separations occur:21

             Exit boundary:         (z, n)   + nU ,                  ,     Layoff boundary:      n ( z, n )  U .           (2)

The first term in (1) is simply output net of vacancy costs. Next, the firm exogenously loses a worker at
rate n with a net loss of n - U to the initial coalition of firm and workers. The change in value has
two pieces: the change in value of the firm and its non-separating workers which is simply the marginal
value of the lost worker (-n ) and the value of unemployment attained by the separated worker (+U ).
The firm hires by posting vacancies which are matched to a worker at rate q( ), the probability that this
worker is unemployed is . The firm always hires unemployed workers, which increases the value of
the firm and incumbents by n but requires a pledge of U to the new worker.
    The firm also hires from and loses workers to other firms by poaching. Workers at other firms are
met according to the employment-weighted distribution of productivity and size, Hn . Upon meeting,
the net coalition value increases by n (z, n) - n (z , n ), so poaching is successful if the firm's marginal
value is largest. Note that n (z , n ) is the highest value the other firm will offer to its incumbent, and
hence it is the take-leave offer the poaching firm will make, as long as it is lower than n (z, n).22
    The firm's current workers may also quit to higher marginal value firms. The firm and non-poached
workers will lose n (z, n) and so are prepared to increase the poached worker's value by this amount to
retain them. Knowing this, the external firm offers the poached worker exactly n (z, n) in order to hire
them. The joint value--that of firm, non-poached workers and poached worker--is therefore unchanged
and reminiscent of Postel-Vinay and Robin (2002), no `EE Quit' term appears in (1).


   21 More formally, the Appendix states the full Hamilton-Jacobi-Bellman-Variational-Inequality formulation of the joint value

problem.
   22 This term of the Bellman equation reads as if the poaching coalition, which induces a breach of contract between the

worker and the losing coalition, compensates the latter exactly for its loss of value associated with the quit. This scheme is
reminiscent of the result in Diamond and Maskin (1979) (also present in Kiyotaki and Lagos, 2007) that compensatory damages
in breach of contracts restore efficiency.


                                                                   14
      Boundary conditions (2) describe firm exit and layoffs. Firms keep operating if the value of doing
so exceeds the total value of exit: the private scrap value  plus unemployment for all its workers. If
productivity falls, the marginal value of a worker will fall, but must remain above the opportunity cost
of employment. To ensure this, firms layoff workers to sustain n (z, n)  U .

Proof.     In the Appendix we prove that our assumptions imply the joint value representation, requiring
much additional notation. The economics of the argument are best seen in the case of a static economy.
Section 3 describes the logic behind the terms in (1) in this simple case. We then return to define an
equilibrium in the full model and characterize firm and worker dynamics in Section 4. First we describe
three appealing properties of the joint value representation.


2.4     Properties

(1) Parsimony.       Firm and worker policies are characterized by a low-dimensional state vector: produc-
tivity and size. Given decreasing returns to scale in production and on-the-job search, this simplification
is a contribution. With decreasing returns spillovers exist as bargaining moves from one worker to the
next. This problem has been addressed in the literature by following the approach of Stole and Zwiebel
(1996), recently revisited by Brügemann, Gautier, and Menzio (2018), which delivers tractability. How-
ever this approach fails when workers have heterogeneous outside options such as due to on-the-job
search. Previous frameworks have therefore restricted their analysis to the case of homogeneous outside
options which requires confining attention only to labor market transitions between employment and
unemployment, ignoring job-to-job flows and poaching altogether. In models with on-the-job search and
heterogeneous outside options these bargaining spillovers are assumed away either (i) by constant re-
turns to scale, which reduces decision making units to one-worker-one-firm pairs and impedes a proper
study of firm dynamics; or (ii) by the combination of full commitment to complex state-contingent con-
tracts and directed search. Our contribution is to prove that a plausible set of minimal assumptions on
the contractual environment (featuring limited commitment) is sufficient to micro-found a parsimonious
representation of allocations.

(2) Private efficiency.        All agents' decisions (entry, exit, separations, vacancies, and hires) maximize
their joint value. Put differently, in external and internal negotiations all privately attainable gains from
trade are exploited. For the parties involved, no transfer could yield a Pareto improvement. We have
therefore shown how the Coase theorem arises in our context without the need to assume full commit-
ment and complex state contingency in contracting.23
   23 We do not solve for the socially efficient allocations in this paper, but note that the decentralized and planner's allocations
will not coincide. Besides the standard congestion externality à la Hosios, an additional composition externality arises. As in


                                                                 15
(3) Job ladder. In one-worker-one-firm models, it is the firm's exogenous productivity that fully deter-
mines its position on the job ladder. Here the ladder is in endogenous marginal values of labor n (z, n).
These equilibrium objects are determined by the current marginal product of labor together with ex-
pectations of future productivity, worker mobility and exit. Hence life-cycle firm dynamics and worker
dynamics across firms determine their equilibrium distribution. In particular, the equilibrium allocation
is affected by a job ladder in marginal values that endogenously lowers the cost of hiring for firms at the
top of the ladder.



3    Static example

To convey the economics of how our assumptions lead to the joint value representation, we use a static
model to construct each term in (1). The approach is the same as in the dynamic model, but it requires
much less notation. We relegate the full proof to the Appendix.

Set up. For now consider a firm with decreasing returns to scale technology y(z, n) such that y(z, 0) =
0. Suppose the firm starts with productivity z and n = 1 worker. The current contract between the firm
and the incumbent specifies a wage w1  (b, y(z, 1)), where b = U is the value of unemployment. At this
point, the incumbent worker does not have a credible threat to quit into unemployment nor the firm has
a credible threat to fire the worker. Then, the labor market opens. For now we also assume that the firm
has sunk the cost of a vacancy c, later considering the explicit decision to post a vacancy.


3.1 UE hire

Assume the firm's vacancy meets an unemployed worker. Four different cases can arise from the com-
bination of hiring/not hiring and renegotiating/not renegotiating the wage with the incumbent. Our
assumption on external negotiation (A-EN) requires that in all cases the take-leave wage offer of the firm
to the outside worker is w2 = b. Our internal negotiation assumption (A-IN) requires that the joint value
                                                                                   be the incumbent
with and without renegotiation is the same and simply equals output y(z, n). Let w1
wage after the internal negotiation.
    If the firm hires the new worker, its profits are as follows:

                                                                                   
                                       y ( z , 2 ) - w1 - b    ,    y ( z , 2 ) - w1 -b,
                                       Without renegotiation         With renegotiation
Acemoglu (2001), low-productivity firms do not internalize that when posting vacancies on-the-job search will result in them
diverting workers away from high-productivity firms. These distorted vacancy decisions affect the equilibrium distributions
of workers across firms Hn which, in turn, influences the hiring opportunities of all other firms.


                                                               16
If the firm does not hire the new worker, its profits are

                                                                                              
                                              y ( z , 1 ) - w1         ,       y ( z , 1 ) - w1

                                           Without renegotiation              With renegotiation

We now describe which case occurs. This requires understanding when our mutual consent assumption
(A-MC) coupled with limited commitment on layoffs (A-LC) bind. In particular, the firm may obtain a
credible threat to trigger renegotiation of w1 . Since we are interested in allocations only, we focus first on
when a hire occurs.

Hire. A hire without renegotiation occurs when the following two conditions hold:

                       y ( z , 2 ) - w1 - b  y ( z , 1 ) - b       ,       y ( z , 2 ) - w1 - b  y ( z , 1 ) - w1         (3)

                                  No credible threat                           Optimal to hire w/o renegotiation

The first condition illustrates that the threat to fire the incumbent worker is not credible, which under (A-
MC) implies no renegotiation. Keeping the incumbent worker at w1 and employing the outside worker
at b delivers a higher value to the firm than the threat of "swapping": firing worker one and hiring
the unemployed worker in his place. Given no renegotiation, the second condition ensures hiring is
privately optimal for the firm.
    A hire with renegotiation occurs when the following two conditions hold:

                                                                                                                 
                       y ( z , 2 ) - w1 - b < y ( z , 1 ) - b    ,         y ( z , 2 ) - w1 - b > y ( z , 1 ) - w1 .      (4)

                                  Credible threat                              Optimal to hire w/ renegotiation

The firm has now a credible threat to fire the incumbent worker according to (A-LC). This is possible
only under decreasing returns to scale: even though w1 < y(z, 1), the first inequality in (4) implies
w1 > y(z, 2) - y(z, 1), i.e. the incumbent wage is above its own marginal product. Employing the
outside worker at b and keeping the incumbent worker at w1 delivers a lower value than `firing and
                                                                                                   
swapping'. The second condition is necessary for hiring to be optimal under the renegotiated wage w1
to the incumbent worker.
                                                                       only redistributes value
    Under the zero sum game assumption (A-IN), the renegotiated wage w1
between the incumbent worker and the firm and does not affect total value.24 In addition, it must be
                                 [ b, y ( z, 2) - y ( z, 1)]. Without further assumptions we cannot say
individually rational, and so w1
exactly what this wage is, but we can nonetheless pin down allocations.



   24 Tworelevant cases that would violate this condition are (i) if worker's effort enters the production function and effort
depends on the wage, and (ii) concave utility.


                                                                   17
      Rearranging the optimal hiring conditions, we observe that both are satisfied as long as

                                                           y ( z, 2) - y ( z, 1) > b.                                      (5)

Note that without internal renegotiation (A-IN), the hiring condition would differ in the two cases. If
wages could not be cut and the firm had a credible threat, the incumbent worker would be fired and
the firm would always hire the unemployed worker (y(z, 1) > b). As a result, to determine when a hire
occurs, one would need to know the incumbent's wage to distinguish between the two cases (thus, in
the general model with n workers, the whole wage distribution). Similarly, if a fraction of output were
to be lost because of the internal negotiation, a violation of (A-IN), the hiring conditions in (3) and (4)
would differ and, again one would need to know wages to determine whether a hire occurs.
      We can write inequality (5) in terms of joint value. Workers' values are simply equal to their wage wi
for i  {1, 2}. The firm's value is simply equal to its profits. The fact that wages are valued linearly by
both worker and firm implies that the joint value (z, n) is independent of wages:
                                                    n                         n
                          ( z, n ) = y ( z, n ) -  wi          +              wi             ,   for any (wi )in=1 .
                                                   i =1                      i =1
                                           Firm value              Sum of workers' values

Using the definition of joint value, equation (5) characterizes when the UE hire occurs:

                                                           ( z, 2) -  ( z, 1) > U .                                        (6)

Thus, the decision of hiring from unemployment does not depend on wages, but only on productivity,
size, and the value of unemployment U = b.

No hire.         For completeness, consider the cases where no hiring occurs. No hire with renegotiation
occurs when the following two conditions hold:

                                                                                                          
                              y ( z , 1 ) - b > y ( z , 1 ) - w1    ,    y ( z , 1 ) - w1  y ( z , 2 ) - w1 -b             (7)

                                       Credible threat                              Optimal to not hire

When incentive compatible for the firm to not expand its workforce, the firm always has a credible threat
                                                                              from the worker's
to swap out its incumbent worker since w1 > b. In this case we can pin down w1
                                        > b, then the firm would still have a credible threat to swap the
individual rationality constraint. If w1
                = b. Since this outcome represents a redistribution of value between firm and worker
worker, hence w1
then, consistent with (A-IN), the joint value remains (z, 1).25 Finally, the no-hiring condition in (7) can
be re-written as in (5) with the opposite inequality, (z, 2) - (z, 1)  U .

     25 The                                                                                                                   +
              value before renegotiation was  (z, 1) = z - w1 + w1 = z. The joint value after renegotiation is  (z, 1) = z - w1
 
w1   = z.


                                                                        18
Combined.         The firm hires from unemployment when its vacancy meets an unemployed worker and
the marginal value of the job seeker exceeds the value of unemployment:
                                                 ( z, 2) -  ( z, 1)
                                                                    > U.                                                  (8)
                                                       2-1
                                                                          (z,2)-(z,1)
In addition, the joint value of the firm and its workers rises by             2-1       - U when the hire occurs. This
is exactly the UE hire term in the HJB equation (1). In the case of a hire, incumbent wages may or may
not be renegotiated but this has no impact on whether hiring occurs, or how the joint value of the firm
and its workers changes. When this condition fails, the firm does not hire, wages are renegotiated, but
the joint value remains constant. All decisions require knowledge of (z, n) only, but not of incumbents'
wages.

Multiple incumbents          The appendix contains an extension of the proof to the case where the hiring
firm has n = 2 incumbents and both can be possibly under threat. The logic is the same, but that proof
also highlights why it is useful to rule out transfers across workers, assumption (A-LC-c).


3.2     EE hire

Now suppose that the worker matched with the firm's vacancy is currently employed at another firm
with productivity z and a single worker n = 1. The situation is not that different from UE hire, except
that the potential hire may have a better outside option in the form of the retention offer made to her by
her current employer under (A-EN). To see the similarity for now we fix this wage offer at w. The same
four cases can arise, except with w playing the role of b.26 We can therefore reason as before and jump to
the result that hiring will occur if and only if the following counterpart to (6) holds:

                                                  ( z, 2) -  ( z, 1) > w.

      We now determine the poached worker's outside option w. The poached firm's willingness to pay is
a wage w that makes it indifferent between retaining and releasing the worker: y(z , 1) - w = 0. Hence,
the contacted worker switches to the new employer as long as the poaching firm offers w  w = y(z , 1).
Bertrand competition between the two firms implies that the poaching firm offers w = y(z , 1), which is
exactly the marginal value of the worker at the poached firm. As in the case of UE hire, whether EE hire
occurs can be summarized by joint values:

                                       ( z, 2) -  ( z, 1)    ( z , 1) -  ( z , 0)
                                                          >                       .                                       (9)
                                             2-1                    1-0
   26 Renegotiationwill happen for different values of w1 in the no hire case. Indeed, to establish the presence of a credible
threat w1 must be compared to w instead of b, but this has no allocative implications for the hiring decisions.


                                                             19
The EE hire decision is entirely characterized by knowledge of the pair (z, n) for the two firms.27 The
value gain to the firm and its workers is the difference between the left-hand side and right-hand side of
equation (9). This comparison of marginal values is precisely the EE hire term in the HJB equation (1).
      Finally, this exercise explains the absence of a EE quit term in (1). The payment received by its
poached worker is equal to the poached coalition's willingness to pay, which is in turn exactly equal to
the worker's marginal value to the coalition. The joint value of the poached coalition therefore does not
change as it loses its worker. EE quit events play an important role in the dynamics of employment at
the firm--which we describe below--but no role in the dynamics of (z, n).


3.3     Vacancy posting

We now explain the private inefficiency in vacancy posting and why (A-VP) is crucial for tractability.
      Recall that in the hiring scenarios just analyzed, two cases arise when the firm can credibly force a
wage cut: (i) when it hires and the incumbent wage is above the post-hire new marginal product; (ii)
when hiring is not profitable, but the firm can credibly `fire and swap', i.e. as long as the reservation
wage of the external worker met through search is below the incumbent wage. The firm has therefore
incentives to spend resources on vacancy posting only to transfer value between agents, a privately
inefficient outcome. The amount spent would depend on the incumbent's wage, breaking the tractability
of our representation. Private efficiency reinstates tractability.
      We start with the firm's preferred vacancy policy. Without loss of generality, suppose firms only meet
unemployed workers (hence, upon a meeting, the `fire and swap' threat is always credible). Let v be the
number of vacancies posted, c(v) the associated cost, and qv the probability a single vacancy meets a
single worker. If no meeting occurs, then as per (A-MC), w1 does not change so the value of the firm
does not change. The firm maximizing the expected return from vacancy posting net of costs is:

               max       -c(v) + qv max y(z, 2) - w1 - b , y(z, 1) - b                    - y ( z , 1 ) - w1     ,
                 v
                                                   Hire (cases 1&2)    No hire (case 3)


Following a meeting, three cases may occur. In Case 1, the firm hires and there is no renegotiation,
w1 = w1 . This case arises when the wage of the incumbent worker is low enough. Then, adding a
second worker does not reduce the marginal product of labor down to the point where the firm has a
credible layoff threat. In Case 2, the firm hires but the wage of the incumbent is renegotiated down

   27 The case when the firm meets a worker at a firm with ( z , 2, w , w ) is similar. Suppose the firm meets worker 1. The
                                                                       1   2
poached firm has the additional option of cutting w2 , but this is inconsequential for the argument because it only redistributes
value within the poached-from firm.


                                                               20
          . In this case, diminishing marginal returns drive the marginal product of labor with two
to w1 = w1
workers below the incumbent's initial wage. In Case 3, the firm is better off not hiring, but under the
threat of swapping out the incumbent, renegotiates w1 down to b. The firm's preferred vacancy policy
v f then equates marginal cost to marginal expected return:

                      cv v f   = q max y(z, 2) - w1 - b , y(z, 1) - b - y(z, 1) - w1                   .                 (10)

The first-order condition (10) highlights that the firm's preferred vacancy policy depends on the incum-
bent's wage w1 because this wage determines the gains from forcing a renegotiation through vacancy
posting. This dependence is a source of intractability because, in the general model with n workers, (10)
would depend on the entire wage distribution inside the firm.
    Our assumption (A-VP) ensures that firms do not post v f , but instead post the privately efficient
amount of vacancies which does not depend on worker wages. We now show how our micro-foundation
(A-VPI) implements (A-VP).

Case 1 ­ Hire without renegotiation.           In this case the outcome is already privately efficient. The worker's
value does not decrease (w1 = w1 ), and by the fact that a hire occurs, the firm's value must increase.
We can also write the expected return as qv [(z, 2) - (z, 1) - U ]. Since the return is independent of
w1 , then the efficient vacancy policy is independent of w1 . The firm is choosing vacancies as if it were
maximizing the joint surplus without having to appeal to additional assumptions.
    In cases 2 and 3, the outcome is privately inefficient because the firm may profit from vacancies that, if
met by a job seeker, deliver a credible threat to cut the incumbent's wage to w1 < w1 .
    Our assumption (A-VPI) allows the worker to correct for this over-posting. The worker can then
concede a pay cut in all states in exchange for an alternative level of vacancies. Such a pay cut is not
covered under (A-MC) since when the vacancy policy is announced there is not yet a credible threat to
layoff workers.28 The firm will accept this wage cut and choose the worker's preferred vacancies if it
delivers at least the value obtained under the firm's preferred vacancies v f . We show that the worker's
preferred package satisfying incentive compatibility restores efficiency in vacancy posting.

Case 2 ­ Hire with renegotiation.           In this case, the incumbent's wage w1 is high enough that the firm
finds it profitable to raise the contact probability with an unemployed worker beyond what would be
efficient. Although the hiring outcome is efficient ex-post, too much resources are spent on vacancies
   28 A pay cut regardless of the outcome of the search for a new worker maps exactly into a transfer from worker to firm,
which is how we approach the proof in the Appendix. We could have allowed for state-contingent wage-cuts that depend on
who the firm meets or whether a meeting occurs. Even if these states were verifiable the result would only be for the worker
to offer a menu of wage-cuts across states. This would increase worker value but not change allocations, hence for consistency
with the rest of our assumptions, we assume a single wage cut.


                                                             21
               be the renegotiated wage after a meeting. The worker chooses a package of vacancies
ex-ante. Let w1
and a wage cut in all states (vw , x ) that solves:

                                   
                          max
                           w
                              qvw w1 - w1 - x                                                                  (11)
                          v ,x
        subject to

                          qvw        y ( z , 2 ) - ( w1 - x ) - b - y ( z , 1 ) - w1     - c(vw )
                                                    
                      qv f           y ( z , 2 ) - w1 -b           - y ( z , 1 ) - w1     - c(v f )   ( IC )

                                                                                 < w . Given this
The worker anticipates that after a meeting their wage will be renegotiated to w1   1

wage cut, the worker seeks to limit the probability of this event by cutting back on vacancies. Incentive
compatibility ( IC ) requires that as the worker cuts vacancies it also cuts its wage so that the firm accepts
the proposed policy vw over v f .
   The Pareto problem (11) yields the result that vacancy posting is independent of w1 . First, given the
linear objective function, ( IC ) holds with equality. Thus, we can substitute out x. Second, the zero-sum
                                      is a renegotiated wage that only redistributes value and hence
game assumption (A-IN) implies that w1
drops out. Third, all terms that do not depend on ( x, vw ) are irrelevant to the worker's decision. This
leaves the following objective function:

                                     max
                                      w
                                         qvw       ( z, 2) - U -  ( z, 1) - c ( v w ) .
                                     v

The decision can therefore be characterized by the privately efficient return, which is the change in joint
value net of the cost of the new hire, (z, 2) - (z, 1) - U .

Case 3 ­ No hire with renegotiation. In this case the `fire and swap' threat is credible. The incumbent's
wage w1 is high enough and the marginal product of an additional worker is below b. Replacing the
return to hiring by the wage cut for the incumbent worker, the previous logic delivers

                          max
                           w
                              qvw (z, 1) - (z, 1) - c (vw )                      =         vw = 0
                           v

Absent the transfer from worker to firm, the firm would post positive vacancies v f even if the return
from hiring is negative, i.e. (z, 2) - (z, 1) < U to induce a wage cut, and v f would depend on w1 .
Under (A-VPI), the worker takes a preemptive wage cut, and vacancies are zero, the efficient amount in
this case.

Combined.      Combining all three cases, privately efficient vacancies solve
                                                      ( z, 2) -  ( z, 1)
                               max qv        max                         - U, 0         - c ( v ).
                                 v                          2-1

                                                              22
      Note three properties of this solution. First, the firm always hires when it meets an unemployed
worker. Second, optimal vacancy posting equates the marginal gain in joint value to the marginal cost of
a vacancy, and it only depends on (z, n). Third, this condition is the flip-side of the separation frontier.
In (1) we said that if n (z, n) > U , then the firm will not separate with workers. The terms inside the
max expression say that if this is true, then the firm will post vacancies.29
      We conclude that under (A-VPI), the joint value is sufficient to characterize the vacancy decision.
The distribution of wages in the firm is immaterial.

Multiple incumbents.           When the firm employs more than one worker, the efficient transfer scheme
can be implemented by randomly selecting a worker under threat to offer a package of wage-cuts and
vacancies. In exchange, the firm posts the efficient number of vacancies. Under such a scheme, the
initiating worker is strictly better off while the firm and the other workers are indifferent. We establish
this case in detail in Appendix C.3.5.


3.4     Layoffs, quits, exit, entry

Having described most of the terms in the HJB (1), we conclude with the boundary conditions for exit,
layoffs and the free entry condition.

Layoffs.     Consider now a firm with n = 2 workers paid (w1 , w2 ), and assume that w1 < y(z, 1) such
that worker 1 is never under threat of layoff. The firm has a credible threat to fire worker 2 if

                                            y ( z , 1 ) - w1 > y ( z , 2 ) - w1 - w2 .

Such a situation may occur if, for example, productivity has just declined. The firm has a credible threat
                                    such that y ( z, 1) - w = y ( z, 2) - w - w and keep worker 2
to negotiate down to a wage level w2                       1               1   2
                                                                                          above b.
employed. From the worker's perspective, it is individually rational to accept any wage w2
Worker 2 is laid off if y(z, 1) - w1 > y(z, 2) - w1 - b. In terms of joint value, this can be written in exactly
the form of the layoff frontier (2):
                                                   ( z, 2) -  ( z, 1)
                                                                      < U.
                                                         2-1
The firm lays off workers until the marginal joint value of the worker is equal to the value of unem-
ployment.30 Note that this is the complement to the condition for posting vacancies. The special case

    29 It is possible to determine the optimal wage cut x that delivers the efficient policy, but throughout the paper we focus on

allocations only. See Bilal, Engbom, Mongey, and Violante (2019) for more details on wage determination.
    30 Note that, when both workers are under threat, the particular order in which values of workers are reduced is immaterial

to the condition  (z, 2) -  (z, 1) < U . One could for example lower the wages of both workers proportionally, increasing the
                                                            , b ) < J (z, 1, w , · ) for any w  b.
value of the firm, but a worker must be fired if J (z, 2, w1                  1               1


                                                               23
with n = 1 of this scenario also arises in the one worker-one firm model with productivity shocks of
Postel-Vinay and Turon (2010).

Quits to unemployment.            Since in this static model workers will accept a renegotiated wage down to
wi = b, they will only quit at the point where the firm has a credible threat to lower wages below b.
This is exactly the point at which the marginal value is equal to the value of unemployment. In this
sense layoffs as described above are indistinguishable from quits to unemployment, as in any model
with privately efficient separations. For ease of language all endogenous UE transitions are referred to as
layoffs, and we use quits to refer only to EE transitions.
      Finally, recall that in the dynamic model unemployed job seekers are promised a wage that imple-
ments a value U to them. If events occur in the firm that reduce the continuation value to that worker
below U (e.g., a negative productivity shock), the incumbent may have a credible threat to quit and
renegotiate her wage to restore its value at U , or above it, depending on the details of the internal ne-
gotiation. However, such renegotiation is, again, only a transfer of value within the firm. Separations
remain privately efficient even in the dynamic model.

Exit.    Now consider the exit decision of a firm with one worker. The private value of exit to the firm is
                                                                          < , where w is a possibly
the scrap value  > 0. The firm therefore exits if and only if y(z, 1) - w1           1

renegotiated wage contingent on the firm remaining in operation. If the profit from operating at the
                                    = b is greater than , then the firm will continue to operate.
lowest possible renegotiated wage w1
Hence, the firm exits if y(z, 1) - b < , and the renegotiated wage only affects the distribution of value.31
The exit condition can be written as (z, 1) - U < , and in the general case of n workers is exactly the
boundary condition in (1):  (z, n) - nU < .

Entry.       Upon entry the firm has n0 workers hired from unemployment. The private entry cost of the
                                  ¡
firm is c0 , so entry requires        y(z, n0 )d0 (z) - n0 b > c0 . Using (n, z) = y(z, n) and U = b, this requires
¡
     ( z, n0 ) d 0 ( z ) > c0 + n0 U .


3.5     From static to dynamic

This static example showcases how to obtain every component of (1) from our set of assumptions. Ap-
pendix C generalizes these insights to the dynamic case. Two insights assist us. First, the proof begins
with a discrete workforce. Here we are helped by continuous time, which removes complicated binomial

    31 The firm has no credible threat to reduce w1 if y(z, 1) - w1 > . The firm can credibly threaten exit if  
(y(z, 1) - w1 ), y(z, 1) - b), but in this case w1 can be reduced to a point where this threat is no longer credible.


                                                            24
probabilities of one, two, three, etc. incumbent workers meeting a competitor's vacancy. Second, we take
the continuous workforce limit of the discrete workforce HJB equation. This limit delivers the joint value
representation (1) in terms of the derivative of the joint value function rather than differences of values
which, when moving up or down by one worker, are symmetric due to continuous differentiability.



4     Equilibrium and characterization

Returning to the joint value representation (1) and (2), we define an equilibrium and characterize firm
behavior and allocations.


4.1   Surplus formulation

A convenient formulation of (1) is in terms of joint surplus, defined as S(z, n) = (z, n) - nU , such that

               Sn ( z, n ) =  n ( z, n ) - U    ,     Sz ( z, n ) =  z ( z, n )            ,   Szz (z, n) = zz (z, n).

The marginal (joint) surplus Sn (z , n ) at a competitor is sufficient to characterize how surplus changes
over an EE hire. We therefore directly compute the value of a vacancy using the employment-weighted
distribution of marginal surplus in the economy: Hn (Sn ). Recall that U = b. With these definitions (1)
becomes

    S (z, n) = max        y (z, n) - nb - nSn (z, n)                                                                                   (12)
                  v 0
                                                                         ¢   Sn ( z,n )
                         + q (  ) v  Sn ( z, n ) + (1 -  )                                Sn ( z, n ) - Sn    dHn Sn     - c v; z, n
                                                                         0

                                                          Return on a vacancy: R(z,n)= R(Sn (z,n))

                                                    2 ( z )
                         + µ ( z ) Sz ( z, n ) +              Szz (z, n)
                                                      2

subject to the two boundary conditions expressed in terms of surplus:

              Exit boundary:        S ( z, n )                  ,              Layoff boundary:              Sn (z, n)  0.             (13)
                                           ¡
The entry decision can be written as:          S ( z, n0 ) d 0 ( z )  c0 .


One-worker-one-firm models.          The Bellman equation (12) is a natural extension of expressions of firm
value found in earlier single worker job ladder models. In these settings, constant returns to scale pro-
duction imply that firms can be treated as arbitrary groups of one-worker-one-firm pairs, each with



                                                                    25
match output y(z). The surplus from such a firm-worker match in our model follows closely Postel-
Vinay and Robin (2002) and Lise and Robin (2017). It can be obtained as a special case of (12) when the
functions y and c are linear in n:32
                                                                                        ¢ S(z)
      S(z) = max            y ( z ) - b -  S ( z ) + q (  ) v  S ( z ) + (1 -  )                   (S(z) - S ) dHn (S ) - c(v; z) (14)
                   v 0                                                                     0

                                                   2 ( z )
                            + µ ( z ) Sz ( z ) +           Szz (z)                                                                     (15)
                                                    2

Surplus depends only on exogenous productivity z, and with one worker firms the unweighted and
employment weighted measures of firms are identical. The expected return to a vacancy is therefore
computed by integrating over Hn (S ) = H (z). In our framework Hn (S ) is an equilibrium outcome,
while here it coincides with the exogenous productivity distribution. Thus, the rank of a firm on the job
ladder is determined only by its productivity z.


4.2    Equilibrium

A stationary equilibrium with positive entry consists of: (i) a joint surplus function S(z, n); (ii) a vacancy
                                                                                          dn
policy v(z, n); (iii) a law of motion for firm level employment                           dt ( z, n );   (iv) a stationary distribution
of firms H (z, n); (v) vacancy and employment weighted distributions of marginal surplus Hv (Sn ) and
Hn (Sn ); (vi) a positive mass of entrants m0 , (vii) a vacancy meeting rate q( ) and conditional probability
of meeting an unemployed worker , such that:

  (i) Total surplus S(z, n) satisfies the HJB equation (12) and boundary conditions (13).

  (ii) The vacancy policy v(z, n) satisfies the first order condition:
                                                                               ¢   Sn ( z,n )
                    c v ( v ( z, n ); z, n ) = q (  )  Sn ( z, n ) + (1 -  )                    (Sn (z, n) - Sn ) dHn (Sn ) .
                                                                               0


 (iii) The law of motion for firm level employment is
                   
                   
                   
                       n
                    - dt                                                                                            n < nE (z)
        dn         
           (z, n) = q( )v(z, n)  + (1 - ) Hn (Sn (z, n)) - n  +  E ( )(1 - Hv (Sn (z, n)))                          n  n          
                                                                                                                        E ( z ), n L ( z )
        dt         
                    nL (z)-n
                   
                                                                                                                    n  n
                   
                          dt                                                                                            L ( z ),


   32 The comparison is clearest with Lise and Robin (2017) which features convex vacancy costs. To be precise in the com-
parison split (14) into three pieces. The value of the coalition is ( + )S(z) = y(z) - b + µ(z)Sz (z) + 2 (z)/2 Szz (z), cor-
responding to their equation (3). The vacancy decision can be split off and given by v(z) that satisfies cv (v(z), z) = q( )S(z),
                                                                   ¡            +
where the "expected value of a contact" is S(z) = S(z) + (1 - ) [S(z) - S(z )] hn (z )dz . These are their equations (6) and
(7), respectively.


                                                                     26
                                n
       where the notation       dt   denotes a jump of size n, and where the layoff and exit thresholds satisfy
                                                                                                                                                   dn
      Sn z, n L (z) = 0     ,        S z, n E (z) =               ,     Sz z, n E (z) = 0            ,       Sn z, n E (z) = 0            if          z, n E (z) < 0
                                                                                                                                                   dt
                       From (13)                                                                                    Smooth pasting


 (iv) The vacancy and employment weighted distributions of marginal surplus Hv (Sn ) and Hn (Sn ) are
      consistent with H (z, n):
                                       ¢                                                                 ¢
                                                v ( z, n )
                      Hv (Sn ) =           1[ Sn ( z,n )  Sn ]
                                                           dH (z, n) ,                         v=              v(z, n)dH (z, n)
                                                     v
                                ¢                                                                        ¢
                                                n ( z, n )
                      Hn (Sn ) = 1[Sn (z,n)Sn ]            dH (z, n) ,                        n=               n(z, n)dH (z, n)
                                                    n

 (v) The measure of firms H (z, n) is stationary, and admits a density function h(z, n) that satisfies:

                      dn                                                                      2               ( z )2
           0=-           ( z, n ) h ( z, n )         -      µ ( z ) h ( z, n )           +                           h ( z, n )       + m0 0 (z) (n)
                 n    dt                                  z                                    z2              2

      where  is the Dirac delta "function" which is zero everywhere except n = n0 where it is infinite.33

 (vi) Free-entry implies that the entry condition holds with equality, which determines entry m0 :
                                                                        ¢
                                                                 c0 =       S ( z, n0 ) d 0 ( z ),

(vii) The vacancy meeting rate q( ) and conditional probability of meeting an unemployed worker 
                                                                                                                                               ¡
      are consistent with the aggregate matching function given unemployment (u = n -                                                              n dH (n, z))
                                                 ¡
      and aggregate vacancies (v =                   v(z, n)dH (z, n)).

The numerical procedure to compute the equilibrium of the model is described in Appendix F.


4.3   Vacancy policy

From (12), the first order condition for the firm's vacancy decision gives
                                                                                                              ¢     Sn
      q( ) R(Sn (z, n)) = cv (v; z, n)          ,    where            R ( Sn ) =  Sn + (1 -  )                             Sn - Sn dHn Sn                 (16)
                                                                                                                0

The return on a vacancy is independent of v, and is a strictly increasing and strictly convex function of
only marginal surplus:

      R (Sn ) = [ + (1 - ) Hn (Sn )] · 1 +                        (1 -  ) h n ( Sn ) · 0                 ,               R ( Sn ) = (1 -  ) h n ( Sn )

                      Surplus on each hire                 Surplus on additional hires= 0
  33 Fornotational brevity we have slightly abused notation by writing the Kolmogorov-Forward equation in the space of
Schwarz distributions.


                                                                            27
Since the function c is convex in v and c(0; z, n) = 0, optimal vacancies are uniquely determined. On
the intensive margin, a rise in Sn increases the return to hiring an unemployed or employed worker one-
for-one. On the extensive margin, increasing Sn widens the set of firms from which the firm will poach,
increasing the probability of a hire by (1 - )hn (Sn ), but hiring from these additional firms yields zero
additional value as the target firm's marginal surplus associated with the worker is close to that of the
poaching firm.


4.4     Endogenous hiring cost

The literature on firm dynamics models employment adjustment costs parametrically. Search frictions
and the job ladder induce, instead, an endogenous hiring cost function which depends on both equilib-
rium market tightness and on the rank of the firm on the job ladder.
      The hiring rate per vacancy for a firm with marginal surplus Sn (z, n) is p = q( )[ + (1 - ) Hn (Sn )].
Attaining h hires therefore requires h/ p vacancies and costs C (h, n, z, Sn ), given by
                                                                                                           
                                                                                     h
                C h, z, n, Sn = c v h, Sn ; z, n            =      c                                  ; z, n  .           (17)
                                                                                                             
                                                                       q( )  + (1 - ) Hn (Sn )

The reduced form hiring cost function implied by the model is convex in h and decreasing in marginal
surplus. It is also determined by two equilibrium objects: overall market tightness via q( ) and the
macroeconomic distribution of marginal surplus Hn (Sn ). The cost function (17) therefore makes clear
the role of frictions and on-the-job search as endogenous sources of adjustment cost.34


4.5     Hire and separation policies

Properties of S(z, n). It is useful to establish some properties of the joint surplus function under stan-
dard assumptions on technologies. Suppose (i) productivity follows a geometric Brownian motion with
µ(z) = µ · z, (z) =  · z, (ii) the vacancy cost function is isoelastic in vacancies only c(v) = c0 v1+ , and
(iii) the production function satisfies yz > 0, yn < 0, ynn < 0, yzn > 0.35 In Appendix D we show that
under these assumptions P1 - P3 hold:
(P1) S is increasing and concave in employment: Sn > 0, Snn < 0
(P2) S is increasing in productivity: Sz > 0

   34 Compare this cost function, for example, to the standard convex adjustment cost in firm dynamics models, which depends

only on the net growth rate but not equilibrium objects, or to the effective firm-level employment adjustment cost functions in
the directed search model of Kaas and Kircher (2015) or the random search model of Gavazza, Mongey, and Violante (2018)
which do not feature on the job search and so depend on the distribution of firms in the economy only through the `price' q( ).
   35 All of which are satisfied by y ( z, n ) = zn with   (0, 1), the functional form assumed in our quantitative analysis.



                                                              28
        ( z, n )                      (z H , n)        ( z, n )                                      ( z, n )
                                                                                    (z M , n)

                                           U×n                                           U×n                                           U×n


                                                                                                                                 (z L , n)



         0                                        n     0                                       n     0                                      n
                    nE (z)   nL (z)                                nE (z)
                                                                          nL (z)




             Exit     Hire   Layoff     Exit                Exit   Hire    Layoff    Exit                               Exit

               (a) High productivity                        (b) Medium productivity                             (c) Low productivity

                       Figure 3: Values of exit, hiring and layoff for fixed levels of productivity z



(P3) S is supermodular in productivity and labor: Szn > 0

Optimal policies.            Figure 3 exploits these properties to characterize the firm's policies for alternative
levels of productivity. The red dashed line describes the value of hiring minus the scrap value: (z, n) -
. The lower blue dashed line extending from the origin gives the total value of unemployment to the
firms' employees: U × n. The exit threshold nE ( z ) is determined by their intersection. At this point the

per worker value net of  is equal to the value unemployment: ((z, nE ( z )) -  ) / n = U . As opposed

to this condition on average values, the layoff threshold nL ( z ) equates the marginal value to U .

      The solid red line is the upper envelope describing the pre-separation/exit value (z, n) =
1{ n < n L (z)}
                max{nU , (z, n) -  } + 1{nnL (z)}
                                                   ( z, n                                                     
                                                          L ( z )) + ( n - n L ( z ))U . For example, if n > n L ( z ),

the firm fires (n - nL ( z )) incumbents who each receive U . The joint value, given by the solid red line, is

therefore given by
                                                ( z, n ) =  ( z, n                   
                                                                   L ( z )) + ( n - n L ( z )) U .

Panel (b) shows that under a lower productivity, the exit and layoff regions extend, while the hiring
region shrinks. At an even lower z L < z M it is optimal for the firm to exit for all n (panel (c)).


4.6     Worker reallocation

The model enables us to decompose firms' job flows (i.e. growth) into the four worker flows discussed
in the introduction. Firm job growth in the hiring region is given by
                         dn        v ( z, n )
                            = q( )             + (1 - ) Hn (Sn (z, n)) -  +  E ( ) H v (Sn (z, n)) .
                          n            n
                                                      UE+ EE+                                             EU + EE-

      Under assumptions (i)-(iii) stated above, we can also prove (see Appendix D):

                                                                          29
                        Gross flow rates
                                                                 dn
                                                  Sn > 0         n    =0        Sn = 0

  qv(z, n                               
         E ) [  + (1 -  ) G ( Sn ( z, n E ))]
                                                                                       + E

                                                EE+


                               qv(z, n                                                   EE-
                                      E )


                                                UE
                                                                                         
                                                                                         EU
                                                                                               n
                                                  nE (z)         nZG ( z )      nL (z)

                  Figure 4: Gross worker flows by employment level, for given productivity
Notes: The solid red curve represents total separations ( EU + EE- ) and the dashed red horizontal line exogenous quits EU .
The green curve represents total hires (UE + EE+ ) and the dashed green curve hires from unemployment (UE).


(P4) Net employment growth dn/n is increasing with productivity z and decreasing with size n.

    Figure 4 illustrates how the four worker flows which determine net firm growth vary with n for a
given level of z. Consider a firm that is at the layoff frontier, n = nL ( z ). Marginal surplus is zero so

the firm posts zero vacancies and shrinks due to exogenous separations and poaching. Conditional on
a meeting, any worker employed in that firm leaves ( H v (0) = 1), and so separations occur at rate  +
 E ( ). As the firm shrinks, decreasing returns in production cause the firm's marginal surplus to increase
(P1). In terms of outflows, the firm loses fewer workers to competitors. In terms of inflows, the firm posts
vacancies which always generate hires from unemployment and, as marginal surplus increases further,
hires from employment too. Firms shrink towards nZG ( z ) where gross flows are positive but there is

zero growth. For any given productivity z, the firm with the highest marginal surplus has the smallest
size compatible with operating, i.e. size n                                       
                                           E ( z ), and grows quickly away from n E ( z ) with high vacancy

posting and net poaching.
    Moreover, if c(v; z, n) = c(v, Sn ), then:
  (1) Rates of EE- and EE+ are, respectively, decreasing and increasing in the firm's growth rate. Faster
      growing firms have higher rates of net-poaching: ( EE+ - EE- ).
  (2) Share of hires from unemployment decreases (from employment increases) in firm growth rate.
  (3) Share of separations to unemployment increases (to employment decreases) in firm growth rate.



                                                            30
                     z                                                    z
                                         dn = 0                                              dn = 0
                                                                                 Hire & JC
                                                    Hire                                     Hire & JD
                                                    Layoff                                                  Hire / Layoff

                                                                                              Layoff & JD
                                    Stay & Layoff
                                                                                                              Stay / Exit




                                                                                             Exit
                 0                                           n        0                                       n

                         (a) No endogenous exit ( = 0)                        (b) Endogenous exit ( > 0)

                            Figure 5: Exit, layoff and no-growth frontiers in the (n, z)-space
Notes: This figure plots exit, layoff and no-growth frontiers for two cases: without and with positive scrap value. It also
includes examples of hypothetical firm paths, in each case keeping productivity fixed. A firm (black dot) that begins in the
layoff region jumps to the layoff frontier, firing n - nS ( z ) workers. Subsequent declines in productivity smoothly move the
firm along the layoff frontier until, possibly, exit. A firm that is located in the hiring region smoothly converges toward the
dn = 0 line by growing or shrinking.


The intuition is simply that fast growing firms have high marginal surplus. For example, the pattern in
(2) can be observed from Figure 4. As one moves leftward along the x-axis, Sn and firm's growth rate
increases and EE+ as a the share of total hires increases goes up as well.
      We conclude by noting that this type of analysis on the composition of hires by firm size and produc-
tivity cannot be performed in directed search models. As explained in the Introduction, in that class of
models, the composition of hires at the firm level is indeterminate.


4.7     Firm dynamics

Combining the characterization above with properties P1 - P4, we can fully theoretically represent
firm reallocation (exit), job reallocation (net growth), and worker reallocation (hires and separations)
in (n, z)-space. Figure 5 attains this by describing the functions that determine the stay/exit frontier
n                                                                     
 E ( z ), hire/layoff frontier n L ( z ), and the zero growth locus n ZG ( z ).

      Panel (a) considers the model without a scrap value such that there is no endogenous exit. We can
tightly characterize the layoff frontier. From (13) the layoff frontier has slope dz/dn = -Snn /Szn . Given
properties P1 and P3, the frontier is therefore positively sloped. To understand firm dynamics to the left
of this frontier, note that fractionally to the left Sn  0, vacancy posting is low and the firm shrinks due
to EE- and EU flows. The zero growth locus along which dn = 0 must therefore be located strictly to the
left of the layoff frontier. To the right of the zero-growth locus, firms hire but lose even more workers,


                                                                 31
and so experience net job destruction ( JD ). To the left of the zero-growth locus, marginal surplus is
sufficiently large that firms are successful in hiring and retaining workers to experience net job creation
( JC ), but some endogenous separations through quits also occur. Thus, the model generates both hires
for shrinking firms and endogenous separations for growing firms. To the right of the frontier, firms
layoff workers, destroying jobs en masse, jumping back to the frontier.
      Panel (b) introduces a positive scrap value and endogenous exit. First, consider ignoring smooth-
pasting conditions. In this case the exit frontier would have gradient dz/dn = -Sn /Sz . Since Snn < 0
(P1) and Sz > 0, the frontier would have a minimum when Sn = 0. The exit frontier therefore crosses the
layoff frontier at its lowest point, increasing on either side.
      Now let's consider how incorporating smooth pasting conditions affects exit. A necessary condition
for optimal exit is that Sn = 0 on the boundary: if marginal surplus was positive, the firm would not
want to exit. Since Sn = 0 on the layoff boundary and by (P1) S is strictly concave in n then it cannot be
the case that Sn is zero again in the hiring region. This has two implications. First, firms cannot be exiting
along the downward sloping section of the exit boundary in the Hire & JC region. This is consistent with
employment dynamics as in this region firms drift to the right: dn/n > 0. Second, firms cannot be
located in the Hire & JD region below the z at which nZG ( z ) crosses the exit frontier. A firm located here

would be drifting toward exit with Sn > 0, and exit with Sn > 0 is sub-optimal. As a result, to the right
of the intersection of the zero-growth locus and the S(z, n) =  locus, the exit frontier is flat.36
      The stationary distribution of firms in the economy has support along the layoff frontier, and to its
left. The distribution has zero mass along the left exit frontier. Growing firms do not exit, but shrink-
ing firms may experience productivity shocks that force them to crossing the horizontal section of the
S(z, n) = 0 exit frontier. All firms--except those on the layoff frontier--post vacancies, and hire workers
both from employment and unemployment,and lose workers both to employment and unemployment.
      The results derived in Section 4.6 regarding gross flows fully describe employment dynamics of the
firm when interior to these boundaries.37


4.8     Frictionless limits

The frictionless limit of our economy is identical to that of a competitive, Hopenhayn-style model of
firm dynamics with no dispersion in the marginal product of labor. Absent job-to-job mobility, this limit

   36 Note that the sufficient condition for this flat exit boundary to exist is that the S = 0 locus lies strictly below the dn = 0
                                                                                           n
locus. This is always the case, since if Sn = 0 the firm must always be shrinking and Snz > 0 (P3). Therefore, a higher Sn such
that the firm is not shrinking must be associated with a strictly higher z.
   37 One can think of Figure 4 as describing gross firm hiring along a straight horizontal line drawn in the ( n, z ) space of Figure

5 and running from the exit to the layoff frontier.


                                                                 32
cannot be obtained. This theoretical limiting behavior benchmarks our exercise in Section 6.2 where we
quantify the output effects of labor market frictions. In the rest of this section we offer an intuition for
these results. The formal proof is in Appendix E.


Frictionless limit without on-the-job-search.               Let A be matching efficiency, the scalar in front of the
matching function, and take A  . Unemployment decreases and, without on-the-job search, firms
can only hire from the shrinking pool of unemployed workers. From the perspective of the firm, the
increase in A raises meeting rates, while the decrease in unemployment reduces meeting rates. In equi-
librium these two forces exactly offset because the free entry condition uniquely pins down q( A), inde-
pendently of A. With q unaffected by the increase in A, the firm problem is unaltered, so firm employ-
ment dynamics are unchanged and, conditional on age, the dispersion in the marginal product of labor
is unchanged.38 Positive dispersion in marginal products is not a property of a frictionless competitive
economy, but that of a competitive economy with adjustment costs. We now show that

Frictionless limit with on-the-job search. As A   unemployment decreases but, with on-the-job
search, firms can still hire from the non-shrinking pool of employed workers. Worker search efficiency,
therefore, becomes constant, while aggregate feasibility ensures finite vacancies, so q( A) = A(s/v)-(1-)
increases in A. The increase in q( A) accelerates labor reallocation from low to high marginal surplus
firms. With decreasing returns to scale, marginal surplus increases at firms that lose workers, and de-
creases at the firms that poach them. The limit features the hallmark of a competitive model: zero
dispersion in marginal surplus. Job-to-job mobility is the key equalizing force.39
    In the limit firm behavior is described by the following Bellman equation
                                                              S        2 ( z ) 2 S
                      S(z) = max y(z, n) - bn + µ(z)            (z) +              (z)      ,   S(z)                        (18)
                                  n                           z         2  z2

which makes clear the key properties of the limit. Without dispersion in marginal surpluses the on-the-
job search terms drop out. The allocation is as if firms choose their optimal size each instant, where these
hires are realized through immediate job-to-job reallocation. The only state variable is therefore z, and
the productivity-size distribution is degenerate along (z, n (z)), where yn (z, n (z)) = b, and marginal
products are equalized. Firm exit is determined by a cut-off rule on productivity z. For new firms, the

   38 As A increases the only change in the distribution of marginal products in the economy comes from the shifting age
composition of firms as entry increases.
   39 The proof requires characterization of the limiting behavior of the entire general equilibrium. This involves (i) the Bell-

man equation of the coalition, and (ii) the Kolmogorov-Forward equation of the distribution of coalitions. These two partial
differential equations are coupled through the equilibrium distribution of marginal surplus and the firm vacancy policy. Given
this complexity, we keep the proof manageable by assuming some additional structure. In particular, we assume that the entry
productivity distribution has a sufficiently fat tail.


                                                               33
                 Parameter                                         Value     Target
                     Discount rate                                  0.004    5% annual real interest rate
                     Elasticity of matches w.r.t. vacancies            0.5   Petrongolo and Pissarides (2001)
                     Scrap value                                      250    Normalization (= 1/)
                 c   Scalar in the cost of vacancies                  100    Normalization
                 m   Number of active firms                   (1-0.06)/22    Average firm size (BDS)

                                        Table 1: Externally chosen parameters


value of jumping from n0 to n (z) upon entry is finite, positive, and still depends on market tightness  .
    Thus in the limit the model is isomorphic to Hopenhayn (1992) with respect to job reallocation and
firm exit. The only conceptual difference between the frictionless limit and Hopenhayn (1992) is that
free-entry determines  in the former, while it pins down the wage in the latter.



5    Estimation

We estimate the model on U.S. data. Because the model is set and solved in continuous time, we can
construct correctly time aggregated measures at any desired frequency.
    We make the following functional form assumptions.                       The vacancy cost function is c(v, n) =
    v  +1
c   n       v as in Kaas and Kircher (2015), such that the per vacancy cost is increasing in the vacancy rate.
The production function is y(z, n) = zn . The matching function is Cobb-Douglas with vacancy elasticity
: a worker meets a vacancy at rate p( ) = A  and a vacancy meets a worker at rate q( ) = A -(1- ) .
The distribution of entrant productivity draws is Pareto with a minimum of one and shape parameter  .
We add exogenous firm exit at rate d.
    We set two parameters exogenously and normalize three, as summarized by Table 1. The discount
rate  implies an annual real interest rate of five percent. The elasticity of the matching function  = 0.5
is based on standard values in the literature. Without loss of generality we normalize the scrap value, 
and the scalar in the vacancy posting cost, c.40 The entry cost ce is always pinned down by an average
firm size of 22 in 2016 (U.S. Census Business Dynamics Statistics; BDS). We first identify a number of
active firms m that delivers an average firm size of 22 when there is a unit measure of workers and an
unemployment rate of six percent: m = (1 - 0.06)/22 = 0.043. While m is an equilibrium outcome,
the fact that a higher m decreases the value of entry through a tighter labor market implies that there is
always a unique ce that satisfies the free-entry condition under m = m.
   40 Increasing the scrap value shifts up the exit frontier. Since productivity follows a geometric Brownian motion increasing

the exit frontier simply increases mean productivity, so normalizing the scrap value is isomorphic to normalizing productivity
which we are obviously free to do. The first order condition for vacancies obtained from (12) will have c multiply the marginal
cost of a vacancy and A multiply the marginal benefit of a vacancy. We therefore cannot identify c from A.


                                                              34
5.1   Internally estimated - Minimum Distance

We estimate the 11 remaining parameters to minimize the objective function

              G (  ) = m - m (  ) W-1 m - m (  )                  ,    = µ, d,  ,  , n0 , , , A,  , , b ,

where m is a vector of empirical moments and m() are their model counterpart. The matrix W contains
squares of the data moments on the main diagonal and zeros elsewhere.41 We target 11 moments that are
relatively standard to firm dynamics and frictional labor market literatures. While  is jointly estimated,
some moments are particularly informative about some parameters. We briefly outline our logic then
study identification more formally. Table 2 summarizes the estimated parameter values and the model
fit with respect to the targeted moments.

Firm dynamics. The negative drift of productivity, µ, is informed by the exit rate of firms. The larger
the drift, the faster firms hit the exit threshold. However, most of these firms that exit are small. The
exogenous exit rate d induces large firms to exit and is informed by the employment-weighted exit rate.
The standard deviation of productivity shocks, , is informed by cross-sectional dispersion in TFP, while
the shape of the productivity distribution for entrants,  , affects productivity dispersion among young
firms (Decker, Haltiwanger, Jarmin, and Miranda, 2018).42 The size of initial firms n0 is informed by the
job creation rate of age one firms. Given a distribution of entrant productivity, a smaller n0 implies firms
start further to the left of the zero growth locus, implying a faster rate of job creation. A narrower span
of control parameter allows for fewer large firms, so  is informed by the employment share of firms
with more than 500 employees. Finally, curvature in vacancy costs, , is informed by cross-sectional
dispersion in annual employment growth (Elsby and Michaels, 2013). Conditional on , more convexity
lowers responsiveness to productivity shocks, reducing dispersion in growth rates. We note that the data
ask for both decreasing returns to scale and convexity in vacancy costs.43

Frictional labor market.        Matching efficiency, A, is set to match the monthly UE rate. If matching is
more efficient, workers find jobs faster. The relative search efficiency of employed workers,  , is then set
to match the ratio of monthly EE rate to UE rate. The exogenous idiosyncratic separation rate  maps
into the monthly EU hazard. Finally, we set b to target a standard value for the flow value of leisure
relative to average output per worker (Shimer, 2005).

   41 Our  moments are taken from various data sources and in most instances we cannot compute variances of the moments,
let alone covariances with other moments.
    42 A natural alternative would have been to target the productivity gap between entrants (younger than 1 year old) and

incumbents. The model does well in this respect. At the estimated parameter vector, this gap is 27 (35) percent in the model
(data) (Gavazza, Mongey, and Violante, 2018).
    43 Similar degrees of convexity in vacancy costs have been estimated by Kaas and Kircher (2015) and Lise and Robin (2017).



                                                             35
        Parameter                                    Value    Moment                                   Model     Data
           µ        Mean of productivity shocks      -0.004   Exit rate (unweighted)                     0.084   0.076
           d        Exogenous exit rate               0.001   Exit Rate (employment weighted)            0.019   0.020
                    Std. of productivity shocks       0.054   Std. deviation of log TFP                  0.484   0.500
                    Shape of entry distribution       3.735   Std. deviation of log TFP (age 1-5)        0.362   0.400
           n0       Size of entrants                  2.058   Job creation rate at age 1                 0.237   0.244
                    Curvature in production           0.587   Employment share 500+                      0.551   0.518
                    Curvature of vacancy cost         6.023   Std. deviation of employment growth        0.337   0.420
           A        Matching efficiency               0.157   UE rate                                    0.243   0.242
                    Search efficiency of employed     0.142   EE rate / UE rate                          0.068   0.076
                    Exogenous separation rate         0.017   EU rate                                    0.018   0.016
           b        Flow value of leisure             0.295   Value of leisure to average output         0.367   0.400

                              Table 2: Estimated parameters and targeted moments
Notes: Exit rates and size distribution of firms are from HP-filtered Census BDS data between 2013­2016, which refer to firms
(not establishments) and are annual. Moments specific to productivity dynamics and dispersion in productivity are taken from
Decker, Haltiwanger, Jarmin, and Miranda (2018) (cross-sectional dispersion). The standard deviation of annual growth rates
is taken from Elsby and Michaels (2013). The UE, EE and EU monthly mobility rates are averages of HP-filtered CPS data
between 2013­2016, estimated on matched micro data for workers 16 years and older. The flow value of leisure to average
output of 40 percent based on the average replacement rate reported in Shimer (2005).


5.2    Identification
To illustrate the identification of the model's parameters, we conduct two exercises. First, we demon-
strate that, in a sizable hypercube around the estimated value of our 11-dimension parameter vector, the
model is globally identified. Our argument proceeds parameter by parameter. We move each parameter
i in steps in a wide range around i . Fixing i we re-optimize all other parameters -i to minimize
                                                         (  ,  ) plotted as a function of  , traces a
G (-i , i ). We argue that the model is identified if G - i i i                           i

steep "U" with a minimum at i . Figure 6 plots this exercise and gives us confidence that our parameter
vector is a global minimum.This is a straight-forward exercise for showing global identification.
      Second, we show that our argument for identification is valid locally around  . We discussed how
each parameter is especially informed by a particular moment, despite the model being jointly identified.
To support this argument, Figure 7 plots each one of the 11 moments as a function of the corresponding
parameter in Table 2, keeping all other parameters at their estimated values. All panels show significant
variation in the moment of interest as a function of its respective parameter.


5.3    Non-targeted moments

The aim of our theory is to describe the mechanics behind the reallocation of workers, in particular
poaching flows, across the distribution of firms. Before exploring the importance of poaching flows
directly we show that the model is consistent with data on (i) the distribution of firms, (ii) job and
worker flows across the distribution, (iii) vacancy rates and vacancy yields, and (iv) the composition of
hires and separations in response to firm-level productivity shocks.

                                                              36
                Minimum distance




                                                                              Minimum distance




                                                                                                                                                      Minimum distance




                                                                                                                                                                                                                                  Minimum distance
                                   0.4                                                           0.4                                                                     0.4                                                                         0.4
                                   0.3                                                           0.3                                                                     0.3                                                                         0.3
                                   0.2                                                           0.2                                                                     0.2                                                                         0.2
                                   0.1                                                           0.1                                                                     0.1                                                                         0.1

                                             -8     -6         -4                                         0.1       0.2        0.3       0.4                                      2         4     6        8       10 12                                  0.02       0.04       0.06     0.08
                                                                         -3
                                                                 10
                Minimum distance




                                                                              Minimum distance




                                                                                                                                                      Minimum distance




                                                                                                                                                                                                                                  Minimum distance
                                   0.4                                                           0.4                                                                     0.4                                                                         0.4
                                   0.3                                                           0.3                                                                     0.3                                                                         0.3
                                   0.2                                                           0.2                                                                     0.2                                                                         0.2
                                   0.1                                                           0.1                                                                     0.1                                                                         0.1

                                            0.1 0.15 0.2 0.25                                                   0.01             0.02                                                 0.5        0.6           0.7          0.8                                  1              2          3
                                                                                                                                                                                                                                                                                       10 -3
                Minimum distance




                                                                              Minimum distance




                                                                                                                                                      Minimum distance
                                   0.4                                                           0.4                                                                     0.4
                                   0.3                                                           0.3                                                                     0.3
                                   0.2                                                           0.2                                                                     0.2
                                   0.1                                                           0.1                                                                     0.1

                                         0.05 0.1 0.15 0.2 0.25                                           2            4             6         8                                  1         2         3        4        5



                                                                                                              Figure 6: Global identification
Notes For each parameter i  {µ, . . . , b}, the black line plots the minima of the minimum distance function G i               =
G (-i , i ). when i is fixed at i (plotted on the x-axis), and minimization is with respect to all other parameters -i . The red
vertical line marks the estimated value i listed in Table 2
                                    50




                                                                                                  50




                                                                                                                                                                          50




                                                                                                                                                                                                                                                      50
                                    -50 0




                                                                                                  -50 0




                                                                                                                                                                          -50 0




                                                                                                                                                                                                                                                      -50 0




                                      -10    -8    -6     -4        -2                                        0.2          0.4       0.6       0.8                                    5         10        15       20                                         0.02       0.04   0.06     0.08
                                                                 10 -3
                                    50




                                                                                                  50




                                                                                                                                                                          50




                                                                                                                                                                                                                                                      50
                                    -50 0




                                                                                                  -50 0




                                                                                                                                                                          -50 0




                                                                                                                                                                                                                                                      -50 0




                                            0.1    0.2     0.3       0.4                                        0.01             0.02          0.03                               0.2           0.4        0.6          0.8                                          1          2          3
                                                                                                                                                                                                                                                                                       10 -3
                                    50




                                                                                                  50




                                                                                                                                                                          50
                                    -50 0




                                                                                                  -50 0




                                                                                                                                                                          -50 0




                                             0.1         0.2         0.3                                        2          4             6      8                                       2         4            6            8



                                   Figure 7: How informative specific moments are for individual parameters
Notes This figure plots the relationship between each parameter i  {µ, . . . , b} and the moment aligned with the parameter
in Table 2. For each panel, the x-axis plots alternative values of the parameter. The y-axis plots the change in the corresponding
moment in the steady state of the model obtained when all other parameters are as in Table 2.




                                                                                                                                                    37
 A. Distributions of firms and employment            B. Model dynamics of employment-productivity

 Group       A. Firms       B. Employment
           Model   Data     Model   Data
 A. By firm size
 0-19      0.909   0.881    0.182   0.180
 20-49     0.053   0.075    0.069   0.097
 50-249    0.032   0.036    0.133   0.154
 250-499   0.004   0.004    0.065   0.057
 500+      0.003   0.004    0.551   0.512
 A. By firm age
 0-1       0.158   0.142    0.020   0.038
 2-3       0.134   0.100    0.024   0.036
 4-5       0.110   0.084    0.027   0.034
 6-10      0.198   0.187    0.072   0.083
 11+       0.400   0.487    0.856   0.808




                              Figure 8: Distribution of firms in data and model



1. Distribution of firms.    Figure 8A shows that the model reproduces the skewed firm distribution. By
size, in both data and model, around 90 percent of firms are small (less than 20 employees), but these
account for only around 18 percent of employment. Symmetrically, firms with more than 500 employees
represent around 0.4 percent of firms, but more than 50 percent of employment. By age, less than half of
firms are older than 10 years, but these account for more than 80 percent of employment.
   Figure 8B plots the distribution of firms over size and productivity at ages 1, 5, 10 and 21+ firms.
Output is higher when the correlation between employment and productivity is higher. In our model
search frictions impede a perfect correlation and, thus, reduce output relative to the frictionless bench-
mark. Firms all start at n0 , but with a sizable dispersion in productivity. After a year the correlation
between productivity and size is still low. Firms continue to grow rapidly during the first five years,
while productivity gradually drifts down. Despite this rapid growth, there is still a significant disper-
sion in employment conditional on productivity. As firms get older, the productivity-size correlation
increases, while the exit and layoff frontiers compress the dispersion in size conditional on productivity
from the left and right, respectively. These frontiers are clearly delineated in (n, z) space, verifying our
theoretical characterization of (n, z)-space (Figure 5).

2. Firm, job and worker reallocation.       Table 3 shows that the model matches the key fact that worker
reallocation rates are around three times as large as job reallocation rates. This difference is generated



                                                     38
                            A. Job reallocation                B. Worker reallocation           C. Firm reallocation
                    Job creation       Job destruction        Hires           Separations               Exit
                   Model     Data      Model      Data    Model    Data      Model      Data    Model          Data
         A. By firm size
         0-19       0.045    0.049      0.038     0.038    0.116   0.122     0.109      0.110   0.023          0.020
         20-49      0.029    0.033      0.029     0.029    0.104   0.106     0.105      0.102   0.003          0.009
         50-249     0.031    0.031      0.031     0.027    0.105   0.102     0.105      0.097   0.003          0.008
         250-499    0.032    0.031      0.033     0.025    0.105   0.101     0.107      0.096   0.003          0.006
         500+       0.029    0.029      0.031     0.024    0.103   0.087     0.106      0.084   0.003          0.002
         A. By firm age
         0-1        0.161    0.161      0.024     0.038    0.233   0.212     0.096      0.140   0.016          0.024
         2-3        0.049    0.049      0.030     0.051    0.121   0.150     0.102      0.144   0.023          0.033
         4-5        0.042    0.040      0.032     0.044    0.115   0.134     0.104      0.130   0.025          0.025
         6-10       0.035    0.035      0.032     0.037    0.109   0.125     0.106      0.121   0.025          0.019
         11+        0.028    0.026      0.033     0.024    0.102   0.086     0.107      0.084   0.020          0.013

                             Table 3: Job, worker and firm reallocation by size and age
Notes: Data: Census BDS firm data for annual job creation, job destruction and exit. Quarterly rates constructed by dividing
by four. Census J2J firm data for quarterly hiring and separation rates. Authors aggregate data into bins given in table which
reflect the granularity of J2J data. Census J2J separations (hires) include separations to (hires from) non-employment. Model:
Time aggregated to a quarterly frequency.


entirely by the presence of job-to-job mobility. That the model appears to generate a steady-state level of
replacement hiring consistent with the data positions it well to understand the importance of job-to-job
mobility in the Great Recession.
    In the cross-section, job flows display a degree of the empirical pattern of `up-or-out' dynamics. Job
creation and exit rates peak for the young firms, albeit for exit the pattern is not as pronounced as in
the data. The model also accounts for job creation by age. In the data (model) 18 percent (16 percent) of
all jobs are created by new firm births and 26 percent (25 percent) by firms aged 1-10. We conclude that
our framework accounts for the distribution of firms across age and size, job flows across these types of
firms, as well as entry and exit dynamics.
    Turning to worker flows, the data hiring rates display a negative relationship with both firm age and
firm size, but the slope with respect to age is much more pronounced. In line with these facts, hiring
rates are strongly decreasing in age whereas the rate at which gross flows decline with size is much more
moderate.

3. Vacancy rates and yields. As pointed out by Davis, Faberman, and Haltiwanger (2013), the rate at
which firms fill their vacancies varies systematically in the cross-section: firms with larger hiring rates
also have higher filling rates. Our model shares this implication. We compare the model to BLS micro-
data in Figure 9A, taking the same approach to data and model as Davis, Faberman, and Haltiwanger



                                                             39
       A. Vacancy rates and yields by gross hires                                              B. Decomposing growth

                                                                                   Moment                   BFGT (2019)   Model
                                                                                   A. Net flows
                                                                                     From/to employment            0.72     0.90
                                                                                     From/to unemployment          0.28     0.10

                                                                                   B. Gross flows
                                                                                   Increasing hires
                                                                                      From employment              0.44     0.51
                                                                                      From unemployment            0.14     0.10
                                                                                   Decreasing separations
                                                                                      To employment                0.28     0.39
                                                                                      To unemployment              0.14       --




                             Figure 9: Vacancy filling and decomposing response to shocks
Notes Panel A. Data: Establishment-month observations in JOLTS microdata 2002-2018 are pooled in bins, where bins are
determined by net monthly growth rate, and have a width of 1 percent. Growth rates computed as in DFH. Within bin b, total
hires hb , total vacancies vb , total employment nb are computed. From these, the gross hiring rate hb /nb , implied daily filling rate
f b and implied daily vacancy posting rate vrb = vb /(vb + nb ) are computed using the daily recruiting model of DFH. Model:
The filling rate in the model is f (n, z) = q( )[ + (1 - ) F (n, z)]. The daily vacancy rate is vr (n, z) = v(n, z)/(v(n, z) + n).
Points plotted are logs of these variables, differenced about the bin representing a one percent net growth rate. Panel B. Data:
Authors calculations from Table 8 of Bagger, Fontaine, Galenianos, and Trapeznikova (2019). Model: This column describes the
response of firm employment to a 20 percent increase in productivity in the model, split into each margin. Aggregating across
firms, the table gives the percentage of the increase in net job creation due to changes in different hiring margins. For example,
89.6 percent of the increase in net job creation is due to increased net poaching: ( EE+ - EE- ).


(2013).44 First we bin firms by their net growth rate, then within bins compute the average hiring rate h,
vacancy rate v and filling rate f of vacancies:
                           h ( z, n )                      v ( z, n )
            h ( z, n ) =                ,   v ( z, n ) =                ,    f ( z, n ) = q     + (1 - ) Hn (Sn (z, n)) .
                               n                               n
The model replicates the key empirical observations of DFH: (i) both the vacancy rate and the filling rate
are increasing in the hiring rate, (ii) the relationships are essentially log-linear, and (iii) with respect to
the hiring rate, the filling rate is much more elastic than the vacancy rate.
    In the model firms with high marginal surplus have higher hiring rates, post more vacancies and
fill them more quickly as they poach from more firms. The slope of the vacancy rate is mediated by the
degree of convexity of the vacancy cost . The fact that the model matches the data along this dimensions
gives us more confidence on the estimated value for this parameter. In our model, on-the-job search is
entirely responsible for the positive slope in the filling rate. Note, however, that in the data, nearly 80
percent of increases in the hiring rate are driven by changes in the filling rate, whereas in the model this
   44 Data is our own computations from BLS JOLTS microdata, in which we extend the sample period of Davis, Faberman,

and Haltiwanger (2013) from 2002-2006 to 2002-2018. The filling rate and vacancy rate are the daily filling rate and daily vacancy
flow rate implied by the model of daily hiring used in their paper.


                                                                        40
effect accounts for just above 60 percent. We conclude that there is residual scope for other sources of
firm's search effort margins, collectively interpreted as recruiting intensity by DFH and Gavazza, Mongey,
and Violante (2018).

4. Firm-level response to productivity shocks The cross-sectional relationships documented above do
not address the extent to which the employment growth of a firm is attained through more hires from un-
employment, more poaching hires, fewer poaching separations or fewer separations to unemployment.
Our theory has sharp qualitative predictions for this decomposition of growth into changes in constituent
gross flows (Figure 4). A recent paper using Danish registry data by Bagger, Fontaine, Galenianos, and
Trapeznikova (2019) decomposes the response of firm-level net employment following a permanent value-
added shock into these margins. Their key finding is that job creation is achieved predominantly through
increasing poaching inflows and decreasing poaching outflows.45
      We replicate the exercise underlying the empirics of Bagger, Fontaine, Galenianos, and Trapeznikova
(2019) and find that the model shares this central result. Table 9B shows that in Danish data 72 percent
of the net increase in employment following a value added shock is due to increasing net poaching, and
only 28 percent is due to increasing net hiring from unemployment. The model shares this feature, with
the bulk of the growth owing to increased net poaching. In terms of gross flows, around 60 percent of
growth comes from increasing hires and 40 percent from decreasing separations. Of these, poaching
hires from employment plays the dominant role in increased hiring.46



6     Three applications
We now exploit our model parameterized to the US labor market to address three questions that require
a model featuring proper notions of both firm dynamics and worker dynamics.


6.1     Net poaching by firm characteristics

The first question we ask is: who poaches from whom? What does the model tell us with respect to firms'
key characteristics that determine their rank on the job ladder? The direct answer is: marginal surplus.
Figure 10A plots the distribution of Sn together with the net poaching rate as a function of marginal
surplus. The CDF reveals that the equilibrium density h(Sn ) displays quite a lot of mass in the middle

   45 The data burden on producing these results is beyond what is available in the U.S. Two ingredients are necessary: high

frequency data on (i) on job-to-job flows, (ii) firm value-added and employment. In the U.S., the LEHD contains the former,
but revenue data--which can be used to proxy for value added under certain assumptions--is only available annually in the
LBD. Data of this quality is, however, available in France and Sweden, for example.
   46 In the model the constant EU rate away from the layoff frontier means that separations can only fall on the EE margin.



                                                            41
                                Figure 10: Net poaching and marginal surplus distribution
Notes: Panel A. Net poaching rate p(Sn ) by log marginal surplus Sn and the CDF of log marginal surplus. Panel B. Decompo-
sition of the change in net poaching rate as Sn rises into three components: (i) higher vacancies (red line), (ii) more poaching
hires due to higher rank on the job ladder (green line), and (iii) lower poaching separations due to higher rank on the job ladder
(blue line).


and relatively long tails. As expected, net poaching is strictly increasing in Sn with a marked `S shape'.
What explains this particular shape? Figure 10B helps answering this questions.
    Under our assumptions on vacancy costs, the vacancy rate of the firm (v = v/n) depends only on
marginal surplus.47 The net poaching rate is:
                                                                                                             ¢   Sn                    1/
                                               E                                        1/
p(Sn ) = v(Sn )q( )(1 - ) Hn (Sn ) -  ( ) H v (Sn )            ,    v ( Sn ) = q (  )         Sn + (1 -  )            Sn - u dHn (u)        .
                                                                                                             0

As Sn rises net poaching increases through three channels: (i) a higher return to vacancies leads to higher
vacancy posting, increasing EE hires ( v(Sn )); (ii) conditional on any vacancy policy a greater fraction
of meetings result in a hire ( Hn (Sn )); (iii) firm incumbents bump into fewer vacancies that result in an
EE quit ( H v (Sn )). Figure 10B plots these three forces using the following decomposition
                            ¢   Sn
                    E                v(u)                                 Hn (u)                H v (u)
      p ( Sn ) -        =                 q( )(1 - ) Hn (u) + q( )(1 - )         v(u) -  E ( )                               du.
                            0        u                                     u                     u
                p (0)                    Increasing  v(Sn )             Increasing  Hn (Sn )         Decreasing  H v (Sn )

    Firms with very low marginal surplus basically do not hire and lose all their employees who are
successful in their search on the job, so net poaching for them approaches - E . In the range of log Sn
between zero and two--any rise in marginal surplus increases net poaching almost entirely through
changes in marginal surplus rank. For a given percentage change in Sn , firms climb the ranks of the
job ladder especially fast in the middle of the distribution and this is reflected in the high slope of net

       see this note that with c(v, n)  (v/n) v, marginal cost is cv (v, n)  (v/n) and, as characterized in Section 4, the
   47 To

marginal benefit of a vacancy depends only on Sn .


                                                               42
                                    Figure 11: Net poaching rates by size and age


poaching in that range (left panel).48 The vacancy rate initially rises slowly but high marginal surplus
firms want to grow fast and in order to achieve high growth post lots of vacancies.


Size and age. We now project this relationship between net poaching and marginal surplus onto ob-
servables in order to compare the model to empirical patterns documented by Haltiwanger, Hyatt, Kahn,
and McEntarfer (2018). A key result is a negligible gradient of net poaching by size, but a steep gradient
by age as young poach from old. Figure 11 shows that the model matches these patterns quite well. Size
is not a particularly good predictor of where a firm sits on the marginal surplus job ladder. Consider a
vertical slice of Figure 5. At a given size some firms are highly productive, have a high Sn , have positive
net poaching and create jobs on net. Meanwhile some firms are less productive, have a low Sn , negative
net poaching and destroy jobs on net. In contrast, young firms are on average small and productive,
sitting to the left of dn = 0 and having not yet had time to grow and are high in the marginal surplus job
ladder. They therefore display large, positive net poaching rates.
    Figure 12 plots marginal surplus and net poaching as a function of two other observable firm char-
acteristics, labor productivity and net employment growth rate. The model predicts a much higher
gradient between these two variables and net poaching rates compared to size and age. Marginal sur-

   48 H and Hv are different distributions, but have strikingly similar properties given that vacancies are increasing in marginal
       n
surplus and, under our cost function, scale with n conditional on Sn .


                                                               43
                  Figure 12: Additional determinants of marginal surplus and net poaching


plus is highly correlated with the static marginal product of labor, and the latter is proportional to the
average product under our functional form for y(z, n).49 Finally, as documented in Table 8B, firms grow
mostly through hires from employment. Thus, the model implies a tight positive relation between net
growth rate and net poaching rate.


6.2     Misallocation cost of labor market frictions

Next, we ask the model to quantify the misallocation costs of search frictions. Recall that frictionless
limits do not make sense in models (i) with OJS but without DRS because they predict that the most
productive firm would hire the entire labor force, or (ii) with DRS but without OJS because, as explained
in Section 4.8, in these environments one does not recover a competitive economy in the limit.
      In our counterfactual we shift the value of matching efficiency A holding all other parameters fixed
at our baseline calibration. In each case, we resolve the model and recompute key moments of interest.
In Figure 13A we focus our quantitative analysis on the range for A between -50% and +50% of our
point estimate, which roughly corresponds to observed differences in job finding rates across developed
countries (Engbom, 2017b), but Figure 13B plots model outcomes for a wider range as well.
      As frictions vanish, unemployment falls, the dispersion of marginal products across firms shrinks
and the correlation between size and productivity rises. Doubling match efficiency (and roughly dou-
bling the UE rate) would increase aggregate output by 15 percent (7 percent net of the value of leisure).
      To isolate the role of misallocation, we decompose the change in output into the component due to
the allocation of workers across firms, and the component due to more employment in the economy as a


   49 One generalization of the model that would weaken this relation is the addition of heterogeneity in the scale of production

parameter , as in (Gavazza, Mongey, and Violante, 2018). This would create an additional source of cross-sectional variation
in marginal surplus that is orthogonal to z.


                                                               44
      A. Changes in A to half, double UE rate                        B. Large changes in match efficiency

                                                   0.30                                          0.4


                                                   0.20                                          0.3

                      Baseline    Half    Double
                                 UE/U     UE/U     0.10                                          0.2

   log A                --       -0.47     0.56
  UE/U rate            0.22       0.11      0.44   0.00                                          0.1
                                                          -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8             -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8
  EE/ E rate           0.016     0.008     0.032
  u rate               0.069     0.153     0.028
  corr (n, z)          0.822     0.755     0.888     1                                           0.4

   log Y                --       -0.231   0.152                                                  0.2
   log TFP              --       -0.175   0.126    0.9
   log TFP/ log Y       --       75.8%    82.9%                                                   0
                                                   0.8
                                                                                                -0.2
                                                                                                                                 Output
                                                                                                                                 TFP
                                                   0.7                                          -0.4
                                                          -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8             -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8



                                  Figure 13: Effect of increasing match efficiency



whole (the scale effect). Imposing an aggregate production function Y = Z¯
                                                                         n , then across steady states
                                                                          ¢
                                                                                         n   
                         log Y =  log Z +  log ¯
                                               n              ,   Z :=               z          dH (n, z).
                                                                              N ×Z       ¯
                                                                                         n

The TFP term Z captures misallocation and is constant if the distribution of employment across pro-
ductive units is constant. Lower misallocation accounts for over 80 percent of the increase in output.
Interestingly, the relationship between frictions and output is concave because the unemployment rate is
convex in match efficiency. Hence doubling frictions leads to a larger output loss, relative to the symmet-
ric case, because of a stronger scale effect. Nonetheless, for both higher and lower labor market frictions
the dominant channel determining output is higher or lower TFP due to labor misallocation.


6.3     Firm and worker dynamics in the Great Recession

Two of the defining features of the U.S. Great Recession were: (i) a strong decline in firm entry, and (ii)
a sharp reduction in job-to-job worker reallocation associated with a failure of the job ladder. Firm entry
(measured as the number of firms less than 1 year old in the BDS) dropped by 25-30 percent between
2007 and 2009 and since then it remained below trend (Siemer, 2014). The EE rate also fell around 25-30
percent over the same period (Shigeru, Moscarini, and Postel-Vinay, 2019; Haltiwanger, Hyatt, Kahn,
and McEntarfer, 2018).


                                                             45
   Figure 14: Entry and job-to-job hiring rates over the Great Recession: Aggregate and Cross-section
Notes Both panels are constructed from the same data at the metro level. Establishment entry and number of establishments
are from the Census BDS data, and used to construct establishment entry rate. Job-to-job hires and employment are from the
Census J2J data, and used to construct EE hire rate. The data cover the subset of states that participate in these Census data
release programs. These cover more than half of the US population.


    The decline in job to job transitions implied a marked slowdown of worker movements up the ladder.
Haltiwanger, Hyatt, Kahn, and McEntarfer (2018) document a decline in net poaching of high wage
firms, those who are presumably at the top of the job ladder. Similarly, Moscarini and Postel-Vinay
(2016) use a structural model to rank firms on the job ladder and estimate that high-rank firms curtailed
their demand for new labor in the recession. As a result, the process of upgrading to better jobs, through
job-to-job quits from low-rank to high-rank firms slowed down considerably. In short, as they put it: the
job ladder failed, starting from the upper rungs.
    These two facts have not been connected in the literature. Our environment suggests a natural mech-
anism to establish a causal link between the two. New entrants and young firms account for a substantial
share of vacancies and have higher marginal surplus than other firms in the economy. Thus they account
for a large fraction of the poaching of employed workers. Following a drop in the number of entrants,
poaching would fall at the top of the ladder which reduces worker reallocation through the middle of
the ladder, and so on down to unemployment.
    Figure 14 shows that drawing this link is also consistent with the cross-region patterns. We combine
newly released Census J 2 J data with Census BDS data at the metro level. The time-series decline in entry
and job-to-job mobility is mirrored in the cross-section of metropolitan labor markets: metro areas with
larger decline in establishment entry were associated with larger decline in job-to-job mobility.
    The aggregate shock that best describes the Great Recession is one that worsens financial frictions.
To proxy for a financial shock in our framework, we solve the model under an unexpected temporary


                                                             46
                   Figure 15: Response of aggregates following a discount rate shock



increase in the discount rate  (as in Hall, 2017). We calibrate the initial jump and the rate of convergence
of  to match the 5 ppt increase in the unemployment rate and the six years it took to return to pre-
recession levels. Appendix F provides more details on the computation.
   Figure 15 describes the response of aggregates to the shock. The direct effect of the shock is to lower
the valuation of future revenues at all firms. As a result, both average and marginal surplus fall, leading
to an increase in EU separations from incumbents as well as from a spike in firm exit. Symmetrically, de-
clining marginal surplus reduces the return on vacancies (17): vacancies collapse, job creation contracts,
and so UE hires decrease. The combination of higher layoff rates and lower job finding rates induces
the observed dynamics of unemployment. Young firms, which have a disproportionate fraction of their
present value of revenues in the future, are especially hard hit, causing entry to collapses by almost 20
percent.
   We illustrate the link between firm dynamics and the frictional labor market by plotting the dy-
namics of the job ladder in Figure 16. The top left panel shows that the job-to-job mobility rate drops
upon impact and slowly recovers. The size of the drop is in line with the data. As young firms are


                                                    47
                     Figure 16: Response of job ladder following a discount rate shock



disproportionately affected and have high-marginal surpluses, the share of vacancies originating from
high-marginal surplus firms drops substantially. The decline of vacancies is much less pronounced in
other regions of the ladder because of a general equilibrium rise in the rate at which vacancies get filled.
With less vacancies and more unemployed workers, the aggregate vacancy yield rises. As in the data,
the vacancy yield grows much more for small firms (Moscarini and Postel-Vinay, 2016).
   The shifting vacancy distribution causes net poaching to collapse at high-marginal surplus firms and
grow at low-marginal surplus firms. This compositional effect reduces the probability that a worker
moves to a high-marginal surplus firm relative to a low-marginal surplus firm causing the observed
`failure' of the job ladder.
   The collapse in the job ladder grinds down aggregate productivity persistently. Consistent with the
data, aggregate output per worker increases for a short period. Initially, as low-productive firms shed
more workers than high-productive firms, and as average firm size falls, output per worker increases,
reflecting a short-lived cleansing effect of the recession. However, throughout the recession and its slow
recovery, job-to-job worker flows towards high-marginal surplus firms slow down, exacerbating the


                                                    48
misallocation that arises from labor market frictions. The result is a persistent decline in productivity.
Note that, even after unemployment is back to trend, a decade after the onset of the recession, TFP is still
2.5 percent below steady state. The recovery of aggregate productivity is sluggish, with the scars of the
recession encoded in the slow moving dynamics of the employment-weighted firm distribution.



7   Conclusion

We have set out a new and tractable framework to jointly study firm dynamics and worker reallocation.
Consistent with the data--and novel with respect to existing multi-worker firm dynamics models with
random search--firms hire from both employment and unemployment. In the limit as frictions vanish,
our economy converges to a standard competitive firm dynamics model, in contrast to existing mod-
els with constant returns to scale in production where in the limit the most productive firm employs
the whole workforce. This limiting behavior allowed us to estimate the productivity loss from labor
misallocation due to labor market frictions.
    The model features a marginal surplus ladder. Firms with higher marginal surplus attract workers
more easily, and thus post more vacancies and grow faster. According to the model, value added per
worker, firm growth, and age are tightly connected to marginal surplus, whereas firm size is only weakly
correlated. The model, estimated on US micro data on firm dynamics, job reallocation and worker flows,
produces the observed patterns of net poaching by size and age. Finally, the model offers a natural
interpretation for the collapse of the job ladder during the Great Recession: the sharp drop in firm entry
reduced the poaching from young and productive units and this weaker pull from the top trickled-down
and muted poaching across the entire job ladder.
    There are three natural directions to expand the research agenda. First, incorporating wage deter-
mination into the model. In Bilal, Engbom, Mongey, and Violante (2019) we make a first step in this
direction. We plan to analyze data on the evolution of the wage distribution at the firm level (frequency
and size of wage cuts, correlation of wage changes across workers, etc.) in order to discriminate between
alternative protocols.
    Second, adding aggregate uncertainty in order to analyze the cyclicality of labor market flows and
of net poaching. As shown, we can compute transitional dynamics very efficiently. Thus, exploiting the
impulse response as a numerical derivative (as in Boppart, Krusell, and Mitman, 2018) seems the most
direct way to study aggregate fluctuations.
    Finally, we applied our model to the US economy, but publicly available data from other countries
(e.g., France, Germany, Italy, Sweden) would allow to compute poaching statistics by many additional


                                                    49
firm characteristics. An interesting question is whether differences in stylized facts arise across countries
and whether such differences can be interpreted as the result of heterogeneity in the degree of labor
market frictions, institutions, technology, or other factors.
   Because of the contemporaneous presence of a well defined notion of firm boundaries (through de-
creasing returns in technology or downward sloping demand) and a comprehensive model of workers'
frictional reallocation across firms, our framework can be potentially useful to study a number of ques-
tions in macroeconomics, labor and trade.




                                                     50
References
A CEMOGLU , D. (2001): "Good jobs versus Bad Jobs," Journal of Labor Economics, 19(1), 1­21.

A CEMOGLU , D.,   AND   W. B. H AWKINS (2014): "Search with Multi-Worker Firms," Theoretical Economics, 9(3), 583­
  628.

A RELLANO , C., Y. B AI , AND P. K EHOE (2016): "Financial Frictions and Fluctuations in Volatility," NBER Working
  Paper 22990, National Bureau of Economic Research.

A UDOLY, R. (2019): "Firm Dynamics and Random Search over the Business Cycle," Discussion paper, University
  College London.

B AGGER , J., F. F ONTAINE , M. G ALENIANOS , AND I. T RAPEZNIKOVA (2019): "The Dynamics of Firm Employment:
   Evidence from Denmark," Discussion paper, Royal Holloway, University of London.

B ILAL , A., N. E NGBOM , S. M ONGEY, AND G. L. V IOLANTE (2019): "A Note on Wage Determination in Bilal-
   Engbom-Mongey-Violante (2019)," Discussion paper, Princeton University.

B OPPART, T., P. K RUSELL , AND K. M ITMAN (2018): "Exploiting MIT Shocks in Heterogeneous-agent Economies:
   the Impulse Response as a Numerical Derivative," Journal of Economic Dynamics and Control, 89, 68­92.

B OROVICKOVÁ , K. (2016): "Job flows, Worker Flows and Labor Market Policies," Discussion paper, New York
   University.

B RÜGEMANN , B., P. G AUTIER , AND G. M ENZIO (2018): "Intra firm bargaining and Shapley values," The Review of
   Economic Studies, 86(2), 564­592.

B URDETT, K., AND D. M ORTENSEN (1998): "Wage Differentials, Employer Size, and Unemployment," International
   Economic Review, 39(2), 257­273.

C LEMENTI , G., AND D. PALAZZO (2010): "Entry, Exit, Firm Dynamics, and Aggregate Fluctuations," Discussion
   paper, New York University.

C OLES , M., AND D. M ORTENSEN (2016): "Equilibrium Labor Turnover, Firm Growth, and Unemployment,"
  Econometrica, 84, 347­363.

D AVIS , S. J., R. J. FABERMAN , AND J. C. H ALTIWANGER (2013): "The Establishment-Level Behavior of Vacancies
  and Hiring," Quarterly Journal of Economics, 128(2), 581­622.

D ECKER , R. A., J. C. H ALTIWANGER , R. S. J ARMIN , AND J. M IRANDA (2018): "Changing Business Dynamism and
  Productivity: Shocks vs Responsiveness," NBER Working Paper 24236, National Bureau of Economic Research.

D IAMOND , P. A., AND E. M ASKIN (1979): "An Equilibrium Analysis of Search and Breach of Contract, I: Steady
   States," Bell Journal of Economics, 10(1), 282­316.

E LSBY, M., AND A. G OTTFRIES (2019): "Firm Dynamics, On the Job Search and Labor Market Fluctuations,"
   Discussion paper, University of Edinburgh.

E LSBY, M. W. L., AND R. M ICHAELS (2013): "Marginal Jobs, Heterogeneous Firms, and Unemployment Flows,"
   American Economic Journal: Macroeconomics, 5(1), 1­48.

E NGBOM , N. (2017a): "Firm and Worker Dynamics in an Aging Labor Market," Discussion paper, New York
   University.

       (2017b): "Worker Flows and Wage Growth over the Life-Cycle: A Cross-Country Analysis," Discussion
  paper, New York University.

                                                        51
F UJITA , S., AND M. N AKAJIMA (2016): "Worker Flows and Job Flows: A Quantitative Investigation," Review of
   Economic Dynamics, 22, 1­20.

G AVAZZA , A., S. M ONGEY,     AND   G. L. V IOLANTE (2018): "Aggregate Recruiting Intensity," American Economic
  Review, 108(8), 2088­2127.

G OUIN -B ONENFANT, E. (2018): "Productivity Dispersion, Between-Firm Competition, and the Labor Share," Dis-
  cussion paper, University of California San Diego.

H ALL , R. E. (2017): "High discounts and high unemployment," American Economic Review, 107(2), 305­30.

H ALTIWANGER , J. C., H. R. H YATT, L. B. K AHN , AND E. M C E NTARFER (2018): "Cyclical Job Ladders by Firm
  Size and Firm Wage," American Economic Journal: Macroeconomics, 10(2), 52­85.

H AWKINS , W. B. (2015): "Bargaining with commitment between workers and large firms," Review of Economic
  Dynamics, 18(2), 350­364.

H OPENHAYN , H., AND R. R OGERSON (1993): "Job Turnover and Policy Evaluation: A General Equilibrium Anal-
  ysis," Journal of Political Economy, 101(5), 915­938.

H OPENHAYN , H. A. (1992): "Entry, Exit, and Firm Dynamics in Long Run Equilibrium," Econometrica, 60(5), 1127­
  50.

J AROSCH , G. (2015): "Searching for Job Security and the Consequences of Job Loss," Discussion paper, Princeton
   University.

K AAS , L., AND P. K IRCHER (2015): "Efficient Firm Dynamics in a Frictional Labor Market," American Economic
  Review, 105(10), 3030­60.

K IYOTAKI , N.,   AND   R. L AGOS (2007): "A Model of Job and Worker Flows," Journal of Political Economy, 115(5),
   770­819.

K LETTE , T., AND S. K ORTUM (2004): "Innovating Firms and Aggregate Innovation," Journal of Political Economy,
   vol. 112, no. 5](5), 986­1018.

L ENTZ , R., AND D. M ORTENSEN (2012): "Labor Market Friction, Firm Heterogeneity, and Aggregate Employment
   and Productivity," Discussion paper, University of Wisconsin.

L INDENLAUB , I., AND F. P OSTEL -V INAY (2016): "Multidimensional Sorting Under Random Search," Discussion
   paper, Yale University.

L ISE , J., AND J.-M. R OBIN (2017): "The Macrodynamics of Sorting between Workers and Firms," American Eco-
   nomic Review, 107(4), 1104­1135.

L UCAS , R. E. (1978): "On the Size Distribution of Business Firms," The Bell Journal of Economics, 9(2), 508.

L UTTMER , E. G. (2010): "Models of Growth and Firm Heterogeneity," Annual Review of Economics, 2(1), 547­576.

L UTTMER , E. G. J. (2011): "On the Mechanics of Firm Growth," Review of Economic Studies, 78(3), 1042­1068.

M AC L EOD , W. B., AND J. M. M ALCOMSON (1989): "Implicit Contracts, Incentive Compatibility, and Involuntary
  Unemployment," Econometrica: Journal of the Econometric Society, pp. 447­480.

M ALCOMSON , J. M. (1999): "Individual Employment Contracts," Handbook of Labor Economics, 3, 2291­2372.

M ENZIO , G., AND S. S HI (2011): "Efficient Search On the Job and the Business Cycle," Journal of Political Economy,
  119(3), 468­510.

                                                          52
M OSCARINI , G., AND F. P OSTEL -V INAY (2013): "Stochastic Search Equilibrium," Review of Economic Studies, 80(4),
  1545­1581.

       (2016): "Did the Job Ladder Fail after the Great Recession?," Journal of Labor Economics, 34(S1), S55­S93.

P OSTEL -V INAY, F., AND J.-M. R OBIN (2002): "Equilibrium Wage Dispersion with Worker and Employer Hetero-
   geneity," Econometrica, 70(6), 2295­2350.

P OSTEL -V INAY, F., AND H. T URON (2010): "On-the-job Search, Productivity Shocks, and the Individual Earnings
   Process," International Economic Review, 51(3), 599­629.

S CHAAL , E. (2017): "Uncertainty and Unemployment," Econometrica, 85(6), 1675­721.
       
S EDLÁ CEK , P. (2014): "Lost Generations of Firms and Aggregate Labor Market Dynamics," Discussion paper,
   University of Bonn.

S HIGERU , F., G. M OSCARINI , AND F. P OSTEL -V INAY (2019): "Measuring Employer-to-Employer Reallocation,"
   Discussion paper, Yale University.

S HIMER , R. (2005): "The Cyclical Behavior of Equilibrium Unemployment and Vacancies," American Economic
   Review, 95(1), 25­49.

S IEMER , M. (2014): "Firm Entry and Employment Dynamics in the Great Recession," Finance and Economics
   Discussion Series 2014-56, Board of Governors of the Federal Reserve System.

S TOLE , L. A., AND J. Z WIEBEL (1996): "Intrafirm Bargaining under Non-Binding Contracts," Review of Economic
   Studies, 63(3), 375­410.




                                                        53
                                                   A PPENDIX
This Appendix is organized as follows. Section A studies the case of a hire from unemployment where
the internal firm negotiation involves multiple workers. Section B lays out the notation for the fully
dynamic model. Section C provides extensive details on the derivation of the joint surplus (z, n).
Section D provides a characterization of the surplus function. Section E derives the limiting behavior of
our economy when frictions vanish. Section F details the algorithms used in the paper to compute and
estimate the model.

A UE hire when the internal renegotiation involves with multiple workers

In this section, we demonstrate that the case with one worker analyzed in the main text is not a special
case and describe internal renegotiation with multiple workers. It is sufficient to consider the case of two
incumbent workers, n = 2. Without loss of generality, assume that the second worker is paid more than
the first, w2 > w1 . As in the approach taken earlier, suppose the firm has posted a vacancy that has met
an unemployed worker. We have three cases to consider which illustrate how the firm may use a worker
outside the firm to sequentially reduce wages of workers inside the firm.
    First, the firm hires without renegotiation if:

          y ( z , 3 ) - w1 - w2 - b > y ( z , 2 ) - w1 - b    ,       y ( z , 3 ) - w1 - w2 - b > y ( z , 2 ) - w1 - w2 .

                       No credible threat to w2                                   Optimal to hire under (w1 , w2 )
Hiring with current wages is preferred to replacing the most expensive incumbent--there is no credible
threat--, and given no renegotiation, hiring is optimal. Since w2 > w1 , no credible threat to worker 2
implies no credible threat to worker 1.
Second, the firm hires with renegotiation with worker 2 if:
                                                                                                                                   
y ( z , 2 ) - w1 - b > y ( z , 3 ) - w1 - w2 - b > y ( z , 2 ) - w2 - b       ,    y ( z , 3 ) - w1 - w2 - b > y ( z , 2 ) - w1 - w2 .

                    Credible threat for worker 2 only                                                                        )
                                                                                                Optimal to hire under (w1 , w2
                                                                                                           ),
The threat is credible for worker 2, but is not for worker 1, and, conditional on renegotiating to (w1 , w2
hiring is optimal.
Third, the firm hires with renegotiation with both workers if:
                                                                                                                                   
y ( z , 2 ) - w1 - b > y ( z , 2 ) - w2 - b > y ( z , 3 ) - w1 - w2 - b       ,    y ( z , 3 ) - w1 - w2 - b > y ( z , 2 ) - w1 - w2 .

                     Credible threat for both workers                                                                     , w )
                                                                                                 Optimal to hire under (w1   2

In all three cases, the optimal hiring condition can be written as:

                                                     ( z, 3) -  ( z, 2) > U .                                                     (19)

                                                                  1
This last inequality does not depend on the order of the internal negotiation between firm and work-
ers. In conclusion, the distribution of wages among incumbents again determines the patterns of wage
renegotiation, but is immaterial for the sufficient condition for hiring.
     Assumption (A-LC-c) that was not present in the one worker example plays a role here. Sup-
pose that the renegotiated wage for worker 2 is pushed all the way down to b, making her indiffer-
ent between staying and quitting. Worker 1 could transfer a negligible amount to worker 2 in ex-
change of her quitting, which would raise the firm's marginal product and, possibly, remove its own
threat. This is problematic for the representation because in this latter case the hiring condition becomes
y(z, 2) - y(z, 1) - w1 - b > y(z, 1) - w1 , distinct from (19). Thus, to know whether a firm hires or not,
one would need to know the wage distribution inside the firm. (A-LC-c) is sufficient to rule out transfers
among workers and to prevent this scenario from happening.
     Note that, this transfer scheme between workers occurring during the internal negotiation changes
the joint value, and hence one can think of (A-LC-c) as being subsumed into (A-IN) already.


B      Notation for dynamic model

We first specify the value function of an individual worker i in a firm with arbitrary state x: V ( x, i ). We
then specify the value function of the firm: J ( x ). Combining all workers' value functions with that of
the firm we define the joint value: ( x ). We then apply the assumptions from Section 2.2 which allow
us to reduce ( x ) to only the number of workers and productivity of the firm, (z, n). Finally we take the
continuous work force limit to derive a Hamilton-Jacobi-Bellman (HJB) equation for (z, n) Applying
the definition of total surplus used above, we obtain a HJB equation in S(z, n) which we use to construct
the equilibrium.

B.1         Worker value function: V

As in the static example, let U be the value of unemployment. It is convenient to define separately
worker i's value when employed at firm x before the quit, layoff and exit decisions, V ( x, i ), and their
value after these decisions, V ( x, i ).50


Value of unemployment.              Let hU ( x ) denote how the state of firm x is updated when it hires an un-
employed worker.51 Let A denote the set of firms making job offers that an unemployed worker would

    50 Interms of Figure 1, the value V is computed after the first stage of the flow chart, and the value V after the second stage,
in the case that the firm stays in operation.
    51 For example, size would be update from n to n + 1 and possibly some of the incumbent wages would be bargained down.



                                                                 2
accept. The value of unemployment U therefore satisfies
                                                      ¢
                                                U
                                 U = b +  (  )                  [V (hU ( x ) , i ) - U ] dHv ( x )
                                                          x A

where Hv is the vacancy-weighted distribution of firms. If x / A, then the worker remains unemployed.


Stage I.    To relate the value of the worker pre separation, V ( x, i ), to that post separation, V ( x, i ), we
require the following notation regarding firm and co-worker actions. Since workers do not form `unions'
within the firm, all of these actions are taken as given by worker i.

    - Let ( x )  {0, 1} denote the exit decision of firm, and E = { x : ( x ) = 1} the set of x's for which
      the firm exits.

    - Let ( x )  {0, 1}n(x) be a vector of zeros and ones of length n( x ), with generic entry                               i ( x ),

      that characterizes the firm's decision to lay off incumbent worker i  {1, . . . , n( x )}, and
      L = {( x, i ) : i ( x ) = 1} the set of ( x, i ) such that worker ( x, i ) is laid off.

    - Let qU ( x )  {0, 1}n(x) be a vector of length n( x ), with generic entry qU
                                                                                 i ( x ) that characterizes an
      incumbent workers' decisions to quit, and QU =                        ( x , i ) : qU
                                                                                         i ( x ) = 1 the set of ( x , i ) such that
      worker ( x, i ) quits into unemployment.

    - Let  ( x ) = (1 - ( x ))  (1 - qU ( x )) be an element-wise product vector that identifies workers that
      are kept in the firm, and S = L  QU = {( x, i ) : i ( x ) = 0}, the set of ( x, i ) such that worker ( x, i )
      separates into unemployment.

    - Let s( x,  ( x )) denote how the state of firm x is updated when workers identified by  ( x ) are kept.
      This includes any renegotiation.

Given these sets and functions, the pre separation value V ( x, i ) satisfies:

                 V ( x, i ) = ( x )U +(1 - ( x )) I{(x,i)/ S} V ( s ( x ,  ( x )), i ) +       I{(x,i)S} U
                               Exit                        Continuing employment           Separations and Quits


Stage II.    It is helpful to characterize the value of employment post separation decisions, V ( x, i ), in
terms of the three distinct types of events described in Figure 2. First, the value changes due to `Direct'
labor markets shocks to worker i, VD ( x, i ). These include her match being destroyed exogenously or
meeting a new potential employer. Second, the value changes due to labor market shocks hitting other
workers in the firm, VI ( x, i ), including their matches being exogenously destroyed or them meeting new

                                                                  3
potential employers. These events have an `Indirect' impact on worker i. Third, the value changes due to
events on the `Firm' side, VF ( x, i ), including the firm contacting new workers and receiving productivity
shocks. Combining events and exploiting the fact that in continuous time they are mutually exclusive,
we obtain the following, where w ( x, i ) is the wage paid to worker i:

                             V ( x, i ) = w ( x, i ) + VD ( x, i ) + VI ( x, i ) + VF ( x, i ) .

    We note that the wage function w( x, i ) includes the transfers between worker i and the firm that
may occur at the stage of vacancy posting (after separations and before the labor market opens), as
discussed in Section 3.3 in the context of the static example. These transfers can depend on the entire
wage distribution inside the firm which is subsumed in the state vector x.


Direct events.     We first characterize changes in value due to labor market shocks directly to worker i
in firm x, VD ( x, i ). Exogenous separation shocks arrive at rate  and draws of outside offers arrive at
rate  E ( ) from the vacancy-weighted distribution of firms Hv . If worker i receives a sufficiently good
outside offer from x , she quits to the new firm. We denote by Q E ( x, i ) the set of such quit-firms x for
i. Otherwise, the worker remains with the current firm but with an updated contract. Therefore VD ( x, i )
satisfies
                                                           ¢
            VD ( x, i ) =  [U - V ( x, i )]     +  E ( )                         V h E x, i, x , i - V ( x, i ) dHv x
                                                               x Q E ( x,i )

                         Exogenous separation                                             EE Quit
                                                           ¢
                                                +  E ( )                         V r x, i, x , i - V ( x, i ) dHv x ,
                                                               x/ Q E ( x ,i )

                                                                                         Retention

where h E ( x, i, x ) describes how the state of a poaching firm x gets updated when it hires worker i from
firm x. Similarly, r ( x, i, x ) updates x when--after meeting firm x --worker i in firm x is retained and
renegotiates its value. In all functions with three arguments ( x, i, x ), the first argument denotes the
origin firm, the second identifies the worker, and the third the potential destination firm.


Indirect events. We next characterize changes in value due to the same labor market shocks hitting
other workers in firm x, VI ( x, i ). The value VI ( x, i ) satisfies




                                                                 4
                    n( x )                                                             ¢
    VI ( x, i ) =             [ V (d( x, j), i ) - V ( x, i )]   +  ( )      E
                                                                                           x Q E ( x, j)
                                                                                                            V q E x, j, x , i - V ( x, i ) dHv x
                    j =i

                                  Exogenous separation                                                               EE Quit
                                                                                       ¢
                                                                 +  E ( )                                   V r x, j, x , i - V ( x, i ) dHv x     ,
                                                                                           x/ Q E ( x, j)

                                                                                                                    Retention

where d( x, j) updates x when worker j exogenously separates, and q E ( x, j, x ) when worker j quits to
firm x .


Firm events.         Finally, we characterize changes in value due to events that directly impact the firm and
hence indirectly its workers, VF ( x, i ). Taking as given the firm's vacancy posting policy v( x ) and other
actions, VF ( x, i ) satisfies

            VF ( x, i ) =

            UE Hire                 q( )v ( x ) [V (hU ( x ) , i ) - V ( x, i )] · I{ xA}

           UE Threat                +q( )v ( x ) [V (tU ( x ) , i ) - V ( x, i )] · I{x/ A}
                                                                 ¢
             EE Hire                + (1 -  ) q (  ) v ( x )                           V h E x , i , x , i - V ( x, i ) dHn x , i
                                                                     x Q E ( x ,i )
                                                                 ¢
           EE Threat                + (1 -  ) q (  ) v ( x )                           V t E x , i , x , i - V ( x, i ) dHn x , i
                                                                     x/ Q E ( x ,i )
               Shock                +  z [V , V ] ( x , i )

where tU ( x ) updates x when an unemployed worker is met and not hired, but could be possibly used as
a threat in firm x. Similarly, t E ( x , i , x ) updates x when worker i employed at firm x is met, not hired,
but could be used as a threat. And, with a slight abuse of notation, Hn ( x , i ) gives the joint distribution
of firms x and worker types within firms i .
    Finally, z [V , V ] ( x, i ) identifies the contribution of productivity shocks z to the Bellman equation.
At this stage we only require that the productivity process is Markovian with an infinitesimal generator.
Later we will specialize this to a diffusion process dzt = µ(zt )dt + (zt )dWt such that

                                                       V (( x, z + dz) , i ) - V ( x, z, i )
               z [V , V ] ( x, i ) = µ (z) lim
                                                  dz0                 dz
                                              2
                                               (z)      V (( x, z + dz) , i ) + V (( x, z - dz) , i ) - 2V ( x, z, i )
                                        +           lim                                                                                            (20)
                                                2 dz0                                dz2

In the case that V = V , this becomes the standard expression for a diffusion featuring the first and second


                                                                                 5
derivatives of V with respect to z: z [V ]( x, i ) = µ(z)Vz ( x, z, i ) + 2
                                                                          1
                                                                            (z)2 Vzz ( x, z, i ).52
    In the event productivity changes or n ( x ) changes because of exogenous labor market events, the
worker will want to reassess whether to stay with the firm or not. Additionally, the firm may want to
reassess whether to exit or fire some workers. Bold values V capture any case where the state changes.

B.2    Firm value function: J

Consistent with the notation we used for workers' values, let J ( x ) and J ( x ) be the values of the firm at
the corresponding points of an interval dt. For now, we take the vacancy creation decision v ( x ) as given.
At the end of the section we describe the expected value of an entrant firm.


Stage I. Consistent with the first stage worker value function, we define the firm value before the
exit/layoff/quit decision, where we recall that  is the firm's value of exit, or scrap value:

                                        J ( x ) = ( x )  + [1 - ( x )] J (s ( x,  ( x ))) .


Stage II.     Given a vacancy policy v ( x ), let J ( x ) be the value of a firm with state x after the layoff/quit,
exit. It is convenient to split the value of the firm, as we did for the worker, into three components

                                      n( x )
                  J (x) = y (x) -      wi ( x , i )           +               JW ( x )       +         JF ( x ) - c ( v ( x ) , x )   .
                                      i =1

                                   Flow profits                         Workforce events          Firm events net of vacancy costs


    For a given policy v( x ) there is a set of associated transfers between workers and the firm which, as
for the worker value function, are implicit in the wage function w( x, i ).
    The component JW ( x ) is given by

                          JW ( x ) =
                                                  n( x )
                   Destruction                     [ J (d(x, i)) - J (x)]
                                                  i =1
                                                           n( x ) ¢
                        EE Quit                +  ( )  E
                                                                      x Q E ( x,i )
                                                                                        J q E x, i, x      - J ( x ) dHv x
                                                           i =1
                                                           n( x ) ¢
                      Retention                +  ( )  E
                                                                      x/ Q E ( x ,i )
                                                                                        J r x, i, x      - J ( x ) dHv x .
                                                           i =1


   52 Note that in (20) we abuse notation and write the state as ( x, z ) with some redundancy since z is clearly a member of x.

We also note that we are not constrained to a diffusion process. We could also consider a Poisson process where, at exogenous
rate  , z jumps according to the transition density (z, z ): z [V , V ] ( x, i ) =  [z  Z V (( x, z ) , i )  (z , z) - V ( x, z, i )].


                                                                              6
The component JF ( x ) is given by

                  JF ( x ) =

             UE Hire           q( )v ( x ) [ J (hU ( x )) - J ( x )] · I{ xA}

          UE Threat            + q( )v ( x ) [ J (tU ( x )) - J ( x )] · I{x/ A}
                                                          ¢
                EE Hire        + (1 -  ) q (  ) v ( x )                         J hE x , i , x   - J ( x ) dHn x , i
                                                              x Q E ( x ,i )
                                                          ¢
           EE Threat           + (1 -  ) q (  ) v ( x )                         J tE x , i , x   - J ( x ) dHn x , i
                                                              x/ Q E ( x ,i )
                 Shock         + z [ J , J ] ( x )

   It is useful to recall that, in continuous time at most one contact is made per instant. That is, either
one worker is exogenously separated, or one worker is contacted by another firm, or one worker is met
by posting vacancies (at rate q( )v( x )), or a shock hits the firm. Note also that we have bold J 's in each
line since after any of these events, the firm may want to layoff some workers or exit, and workers may
want to quit.


Entry. The expected value of an entrant firm is
                                                               ¢
                                              J0 = -c0 +            J ( x0 ) d 0 ( z0 )                                (21)

where x0 is the state of the entrant firm which includes only the random productivity value z0 drawn
from 0 since we assumed the initial number of workers is 0. The argument of the integral is J , which
incorporates the firm's decision to exit or operate after observing z0 . Entry occurs when J0 > 0.




                                                                   7
C      Derivation of the joint value function 
                                                                                                                  n( x )
We define the joint value of the firm and its employed workers  ( x ) := J ( x ) + i=1 V ( x, i ). We also
                                                                                                      n( x )
define the joint value before exit/quit/layoff decisions:  ( x ) := J ( x ) + i=1 V ( x, i ).

C.1     Combinining worker and firm values

In this section, we show that summing firm and worker values, then applying these definitions delivers
the following Bellman equation for the joint value:

        ( x ) = y ( x ) - c (v ( x ) , x )                                                                                         (22)
                         n( x )
Destruction          +     [ (d(x, i)) + U -  (x)]
                         i =1
                                  n( x ) ¢
  Retention               E
                     +  ( )                  x/ Q E ( x ,i )
                                                                r x, i, x          -  ( x ) dHv x
                                  i =1
                                  n( x ) ¢
      EE Quit        +  E ( )                x Q E ( x,i )
                                                                q E x, i, x          + V h E x, i, x , i -  ( x ) dHv x
                                  i =1
    UE Hire          + q( )v ( x ) [ (hU ( x )) - U -  ( x )] · I{xA}
 UE Threat           + q( )v ( x ) [ (tU ( x )) -  ( x )] · I{x/ A}
                                                       ¢
      EE Hire        + (1 -  ) q (  ) v ( x )                                 hE x , i , x   - V h E x , i , x , i -  ( x ) dHn x , i
                                                           x Q E ( x ,i )
                                                       ¢
 EE Threat           + (1 -  ) q (  ) v ( x )                                 tE x , i , x   -  ( x ) dHn x , i
                                                           x/ Q E ( x ,i )
       Shock         +  z [ ,  ] ( x ) .

Note that this joint value is only written in terms of other joint values and worker values. However, it
involves both firm and worker decisions through the sets A, Q E and the vacancy policy, v( x ).




                                                                               8
Derivation.    We start by computing the sum of the workers' values at a particular firm. Summing
values of all the employed workers

                       n( x )                  n( x )
                                V ( x, i ) =     w ( x, i )
                       i =1                     i =1
                                                    n( x )
                 Destructions                  +      [U - V (x, i)]
                                                    i =1
                                                            n( x ) ¢
                       Retentions              +        E
                                                                       x/ Q E ( x ,i )
                                                                                         V r x, i, x , i - V ( x, i ) dHv x
                                                            i =1
                                                            n( x ) ¢
                          EE Quits             +        E
                                                                       x Q E ( x,i )
                                                                                         V h E x, i, x    - V ( x, i ) dHv x
                                                            i =1
                                                    n( x )
                  Incumbents                   +     VI (x, i)
                                                    i =1
                                                    n( x )
                                  Firm         +     VD (x, i)
                                                    i =1

   where the indirect term due to incumbents can be written as:
              n( x )
                VI (x, i)              =
               i =1
                                           n( x ) n( x )
              Destructions                    [V (d(x, j), i) - V (x, i)]
                                           i =1 j = i
                                               n( x ) n( x )           ¢
                Retentions                 +                       E
                                                                           x/ Q E ( x, j)
                                                                                            V r x, j, x , i - V ( x, i ) dHv x
                                               i =1 j = i
                                               n( x ) n( x )           ¢
                   EE Quits                +                       E
                                                                           x Q E ( x, j)
                                                                                            V q E x, j, x , i - V ( x, i ) dHv x
                                               i =1 j = i

   and the indirect term due to the firm can be written as:




                                                                                     9
       n( x )
         VF (x, i)         =
       i =1
                                                      n( x )
            UE Hires                  qv ( x )          [V (hU (x) , i) - V (x, i)] · I{xA}
                                                       i =1
                                                          n( x )
        UE Threats                    +qv ( x )            [V (tU (x) , i) - V (x, i)] · I{x/ A}
                                                          i =1
                                                                      n( x ) ¢
                EE Hires              +qv ( x ) (1 - )                           x Q E ( x ,i )
                                                                                                    V h E x , i , x , i - V ( x, i ) dHn x , i
                                                                        i =1
                                                                      n( x ) ¢
         EE Threats                   +qv ( x ) (1 - )                           x/ Q E ( x ,i )
                                                                                                    V t E x , i , x , i - V ( x, i ) dHn x , i
                                                                        i =1
                                           n( x )
                 Shocks               +     z [V , V ](x, i)
                                           i =1

We now collect terms.


Destructions.        When worker i separates from firm x, the sum of the changes in values of all employed
workers at its own firm is given by:

                                                                                                     n( x )
                        Destructions =  [U - V ( x, i )] +                                             [V (d(x, i), j) - V (x, j)]
                                                                                                      j =i
                                                                               n( x )                         n( x )
                                                        =  U+                   V ( d ( x , i ), j ) -  V ( x , j )
                                                                               j =i                           j =1


Retentions.        When i renegotiates at firm x, the sum of the changes in values of all employed workers at
its own firm is given by:
                               ¢
  Retentions =  E                                    V r x, i, x , i - V ( x, i ) dHv x
                                   x/ Q E ( x ,i )
                                            ¢                    n( x )
                                   + E
                                                x
                                                                   
                                                 / Q E ( x ,i ) j = i
                                                                          V r x, i, x , j - V ( x, j) dHv x

                               ¢                                                          n( x )                           n( x )
                    =      E
                                   x/ Q E ( x ,i )
                                                      V r x, i, x , i +                            V r x, i, x , j -        V ( x, j)   dHv x
                                                                                           j =i                            j =1
                               ¢                      n( x )                                       n( x )
                    =      E
                                   x/ Q E ( x ,i )
                                                               V r x, i, x , j -                    V ( x, j)          dHv x
                                                       j =1                                        j =1




                                                                                        10
Quits.    Similarly, when i quits firm x, the sum of the changes in values of all employed workers at its
own firm is given by:
                            ¢                                                             n( x )                           n( x )
         EE Quits =     E
                                  x  Q ( x ,i )
                                                      V h E x, i, x , i +                          V q E x, i, x , j -      V ( x, j)        dHv x
                                                                                           j =i                            j =1


Combining terms.         Before summing up all these terms, define for convenience the total worker value:

                     n( x )
         V ( x ) =    w ( x, i )
                     i =1
                         n( x )                       n( x )                            n( x )
Destructions         +               U+                        V ( d ( x , i ), j ) -    V ( x, j)
                         i =1                         j =i                              j =1
                                  n( x ) ¢                         n( x )                                n( x )
  Retentions         +        E
                                             x/ Q E ( x ,i )
                                                                            V r x, i, x , j -              V ( x, j)    dHv x
                                   i =1                             j =i                                 j =1
                                  n( x ) ¢                                                           n( x )                         n( x )
   EE Quits          +        E
                                             x Q E ( x,i )
                                                                   V h E x, i, x , i +                        V q E x, i, x , j -    V ( x, j)   dHv x
                                   i =1                                                               j =i                          j =1
                                             n( x )
   UE Hires          +qv ( x )                [V (hU (x) , i) - V (x, i)] · I{xA}
                                             i =1
                                             n( x )
 UE Threats          +qv ( x )                [V (tU (x) , i) - V (x, i)] · I{x/ A}
                                             i =1
                                                          n( x ) ¢
    EE Hires         +qv ( x ) (1 - )                                x Q E ( x ,i )
                                                                                       V h E x , i , x , i - V ( x, i ) dHn x , i
                                                          i =1
                                                          n( x ) ¢
  EE Threats         +qv ( x ) (1 - )                                x/ Q E ( x ,i )
                                                                                       V t E x , i , x , i - V ( x, i ) dHn x , i
                                                          i =1
                         n( x )
     Shocks          +       z [V , V ](x, i)
                         i =1




                                                                                        11
Now sum, up all the previous terms, collect terms and use the definition of V ( x ):

                      n( x )
         V ( x ) =     w ( x, i )
                      i =1
                          n( x )                    n( x )
   Destructions       +              U+               V ( d ( x , i ), j ) - V ( x )
                          i =1                       j =i
                                   n( x ) ¢                      n( x )
     Retentions       + E                     x/ Q E ( x ,i )
                                                                  V            r x, i, x , j - V ( x ) dHv x
                                   i =1                           j =i
                                   n( x ) ¢                                                   n( x )
      EE Quits        +        E
                                              x Q E ( x,i )
                                                                 V h E x, i, x , i +          V         q E x, i, x , j - V ( x ) dHv x
                                   i =1                                                       j =i
                                                n( x )
      UE Hires        +qv ( x )                   V ( hU ( x ) , i ) - V ( x )             · I{xA}
                                                 i =1
                                                n( x )
    UE Threats        +qv ( x )                   V ( tU ( x ) , i ) - V ( x )            · I{ x / A}
                                                 i =1
                                                         ¢                     n( x )
       EE Hires       +qv ( x ) (1 - )
                                                             x Q E ( x ,i )
                                                                                V       h E x , i , x , i - V ( x ) dHn x , i
                                                                                i =1
                                                         ¢                     n( x )
    EE Threats        +qv ( x ) (1 - )
                                                             x/ Q E ( x ,i )
                                                                                V       t E x , i , x , i - V ( x ) dHn x , i
                                                                                i =1
         Shocks       +z [V , V ]( x )




                                                                                 12
Adding this last equation to the Bellman equation for J ( x ) yields

      ( x )    = y ( x ) - c (v ( x ) , x )
                        n( x )                                         n( x )
Destructions        +             J (d( x, i )) + U +                      V ( d ( x , i ), j ) - J ( x ) - V ( x )
                        i =1                                              j =i
                             n( x ) ¢                                                   n( x )
 Retentions         + E                   x/ Q E ( x ,i )
                                                             J r x, i, x            +   V          r x, i, x , j - J ( x ) - V ( x ) dHv x
                             i =1                                                       j =i
                             n( x ) ¢                                                                                 n( x )
   EE Quits         +    E
                                          x Q E ( x,i )
                                                             J q E x, i, x            + V h E x, i, x , i +            V           q E x, i, x , j - J ( x ) - V ( x ) dHv x
                             i =1                                                                                      j =i
                                                                    n( x )
   UE Hires         +qv ( x )  J (hU ( x )) +                        V ( hU ( x ) , i ) - J ( x ) - V ( x )           · I{ xA}
                                                                    i =1
                                                                   n( x )
 UE Threats         +qv ( x )  J (tU ( x )) +                        V ( tU ( x ) , i ) - J ( x ) - V ( x )          · I{ x / A}
                                                                   i =1
                                                    ¢                                                   n( x )
   EE Hires         +qv ( x ) (1 - )
                                                        x Q E ( x ,i )
                                                                             J hE x , i , x         +    V       h E x , i , x , i - J ( x ) - V ( x ) dHn x , i
                                                                                                         i =1
                                                    ¢                                                   n( x )
 EE Threats         +qv ( x ) (1 - )
                                                        x/ Q E ( x ,i )
                                                                             J tE x , i , x        +    V        t E x , i , x , i - J ( x ) - V ( x ) dHn x , i
                                                                                                        i =1
     Shocks         +z [ J + V , J + V ]( x ) - J ( x ) - V ( x )

Collecting terms and using the definition of  :

          ( x )     = y ( x ) - c (v ( x ) , x )
                                 n( x )
    Destructions           +        [ (d(x, i)) + U -  (x)]
                                 i =1
                                      n( x ) ¢
      Retentions           + E                   x/ Q E ( x ,i )
                                                                      r x, i, x             -  ( x ) dHv x
                                      i =1
                                      n( x ) ¢
       EE Quits            +      E
                                                 x Q E ( x,i )
                                                                      q E x, i, x                + V h E x, i, x , i -  ( x ) dHv x
                                      i =1
       UE Hires            +qv ( x )  [ (hU ( x )) - U -  ( x )] · I{ xA}
     UE Threats            +qv ( x )  [ (tU ( x )) -  ( x )] · I{ x/ A}
                                                            ¢
       EE Hires            +qv ( x ) (1 - )                                        hE x , i , x              - V h E x , i , x , i -  ( x ) dHn x , i
                                                                x Q E ( x ,i )
                                                            ¢
     EE Threats            +qv ( x ) (1 - )                                        tE x , i , x             -  ( x ) dHn x , i
                                                                x/ Q E ( x ,i )
         Shocks            +z [, ]( x )




                                                                                        13
  C.2   Value sharing

  To make progress on (22), we begin by stating seven intermediate results, conditions (C-RT)-(C-E) which
  we prove from the assumptions listed in Section 2.2. These results establish how worker values V in (22)
  evolve in the six cases of hiring, retention, layoff, quits, exit and vacancy creation. Next, we apply
  conditions (C-RT)-(C-E) to (22).
     To highlight the structure of the argument, we note a key implication our zero-sum game assumption
  (A-IN): during internal negotiation, any value lost to one party must accrue to the other. This feature is
  obvious in the static model, and extends readily to our dynamic environment. In other words, the joint
  value of the firm plus its incumbent workers is invariant during the negotiation. We use this property
  extensively in the proof. This generalizes pairwise efficient bargaining--commonly used in one-worker
  firm models with linear production--to an environment with multi-worker firms and decreasing returns
  in production.
     We now state the seven conditions that we apply to (22). In section C.3 below, we prove how each of
  them is implied by the assumptions of Section 2.2.

(C-RT) Retentions and Threats. First, if firm x meets an unemployed worker and the worker is not hired
        but only used as a threat, then the joint value of coalition x does not change since threats only
        redistribute value within the coalition. Second, when firm x uses employed worker i from firm x
        as a threat, the joint value of coalition x does not change. Third, when firm x meets worker i at x
        and the worker is retained by firm x , the joint value of coalition x does not change. Formally,

                    r x ,i ,x      = ( x ) ,      (tU ( x )) = ( x )    ,    tE x , i , x         =  ( x ).

        Respectively, these imply that the Retention, UE Threat and EE Threat components of (22) are equal
        to zero.

(C-UE) UE Hires. An unemployed worker that meets firm x is hired when x  A. This set consists of firms
        that have a joint value after hiring that is higher than the pre-hire joint value plus the outside value
        of the hired worker. Due to the take-leave offer, the new hire receives her outside value, which is
        the value of unemployment:

                              A = { x |(hU ( x )) - ( x )  U } ,       V ( hU ( x ) , i ) = U .


(C-EE) EE Hires. An employed worker i at firm x that meets firm x is hired when x  Q E ( x , i ). This set



                                                       14
       consists of firms that have a higher marginal joint value than that of the current firm:

                     QE x , i   = x  hE x , i , x               -  ( x )  ( x ) -  q E x , i , x                  .

       Due to the take-leave offer, the new hire receives her outside value, which is the marginal joint
       value at her current firm:

                                     V hE x , i , x        =  x -  qE x , i , x                 .


(C-EU) EU Quits and Layoffs. An employed worker i at firm x quits to unemployment when ( x, i )  QU .
       This set consist of states x such that the marginal joint value is less than the value of unemployment:

                                       QU =            ( x , i )  s q1 ( x , i ) + U >  s q0 ( x , i )    ,

                    where       sq1 ( x, i ) = s ( x, (1 - [qU ,-i ( x ) ; qU ,i ( x ) = 1])  (1 - ( x ))) ,

                                sq0 ( x, i ) = s ( x, (1 - [qU ,-i ( x ) ; qU ,i ( x ) = 0])  (1 - ( x ))) .

       The first expression captures when worker i quits, and the second where worker i does not. Simi-
       larly, an EU layoff will be chosen by the firm when ( x, i )  L:

                                           L =           ( x, i )  (s 1 ( x, i )) + U >  (s 0 ( x, i )) ,
                      where         s 1 ( x , i ) = s ( x , (1 - [ ( x ) ;   i   ( x ) = 1])  (1 - qU ( x ))) ,
                                    s 0 ( x , i ) = s ( x , (1 - [ ( x ) ;   i   ( x ) = 0])  (1 - qU ( x ))) .

       The first expression captures when worker i is laid off, and the second when worker i is not.

 (C-X) Exit. A firm x exits when x  E . This set consists of the states in which the total outside value of
       the firm and its workers is larger than the joint value of operation:

                                E = x  + n (s ( x,  ( x ))) · U >  (s ( x,  ( x ))) .


 (C-V) Vacancies. The expected return to a matched vacancy R( x ) depends only on the joint value, and
       so the firm's optimal vacancy policy v( x ) depends only on the joint value. The policy v( x ) solves

                                                 max q( )vR( x ) - c (v, x ) ,
                                                   v




                                                              15
        where the expected return to a matched vacancy is

        R( x ) =  [ (hU ( x )) -  ( x ) - U ] · I{ xA}

                      Return from unemployed worker match
                           ¢
              + (1 -  )                          hE x , i , x       -  (x) -  x -  qE x , i , x         dHn x , i .
                               x Q E ( x ,i )

                                                           Expected return from employed worker match


(C-E) Entry. A firm enters if and only if
                                                  ¢
                                                       ( x0 ) d 0 ( z )  c0 + n0 U .


Summarizing (C). The substantive result is that all firm and worker decisions and employed workers'
values can be expressed in terms of joint value  and exogenous worker outside option U .

C.3     Proof of Conditions (C)
C.3.1    Proof of C-UE and C-RT (UE Hires and UE Threats)

In this subsection, we consider a meeting between a firm x and an unemployed worker. Following A-IN
and A-EN, the firm internally renegotiates according to a zero-sum game with its incumbent workers
and makes a take-leave offer to the new worker. Intuitively, having the worker "at the door" is identical
to having her hired at value U for the firm and for all incumbent workers: the firm can always make new
take-leave offers to its incumbents after hiring the new worker. Hence, we expect the firm to make one
take-leave offer to the new worker and its incumbents at the time of the meeting, and not make a new,
different offer to is incumbents afer hiring has taken place.
    We start by showing this equivalence formally. To do so, when meeting an unemployed worker, we
let the firm conduct internal renegotiation with its incumbent workers and make an offer to the new
worker. Then, we let a second round of internal offers take place after the hiring. We introduce some
notation to keep track of values throughout the internal and external negotiations. To fix ideas, we
denote by (IR1) the first round of internal negotiation, pre-external negotiation. We denote by (IR2) the
second round of internal negotiation, post-hire.
    Post-hire and post-internal negotiation (IR2) values are denoted with double stars. Post-internal-




                                                               16
negotiation (IR1) but pre-external-negotiation values are denoted with stars.

                                                     n( x )
                                       := J  +         Vj + Vi
                                                      j =1
                                                   n( x )
                                        := J  +      Vj
                                                    j =1
                                                  n( x )
                                         := J +    Vj
                                                  j =1

   Proceeding by backward induction, under A-EN the firm makes a take-it-or-leave-it offer to the un-
employed worker, therefore
                                                Vi = U

   We now divide the proof in several steps. We start by proving that for all incumbent workers j =
1...n( x ), Vj = Vj . We then use A-IN to argue that  = . Once these claims have been proven, we
move on to proving C-UE (UE Hires) and the part of for threats from unemployment C-RT (UE Threats).
Finally, we show that our microfoundations for the renegotiation game deliver A-IN.


Claim 1:   For all incumbents workers j = 1...n( x ), we have Vj = Vj .


   We proceed by backwards induction using our assumptions A-EN and A-IN. Immediately after (IR1)
has taken place, only the following events can happen:

  1. Hire/not-hire

        · Either the worker is hired from unemployment (H),

        · Or the worker is not hired from unemployment (NH)

  2. Possible new round of internal negotiation (IR2). This possible second round of internal negotia-
     tion (now including the newly hired worker) leads to values Vj .

   We focus on subgame perfect equilibria in this multi-stage game. Therefore, after (IR1), workers
perfectly anticipate what the outcome of the hire/not-hire stage will be. That is, after (IR1), they know
perfectly what hiring decision (H or NH) the firm will make. Now suppose that internal renegotiation
(IR2) actually happens after the hire/not-hire decision, that is, that for some incumbent worker j 
{1, ..., n( x )}, Vj = Vj . Note that the firm has no incentives to accept a change in the new worker's
value to anything above U , so by A-MC her value does not change in the second round (IR2).

                                                   17
   We construct the rest of the proof by contradiction. Consider for a contradiction an incumbent worker
j whose value changed in (IR2). Because of A-MC, her value can change only in the following cases:

   · The firm has a credible threat to fire worker j, in which case Vj < Vj

   · Worker j has a credible threat to quit, in which case Vj > Vj

   In addition, those credible threats can lead to a different outcome than in (IR1), and thus Vj = Vj ,
only if the threat on either side was not available in (IR1). If that same threat was available in the first
round (IR1), then the outcome of the bargaining (IR1) would have been Vj .
   Recall that both incumbent worker j and the firm understand and anticipate which hire/not-hire
decision the firm will make after the first round (IR1). They also understand and anticipate that, in case
of hire, the value of the new worker will remain U in the second round (IR2).
   Therefore, the firm can credibly threaten to hire the new worker in the first round if and only if it actually
hires her after the first round (IR1) is over. This implies that the firm can credibly threaten worker to fire
j in the second round (IR2), by A-LC, if and only if it could credibly threaten her with hiring the new
worker in the first round of internal renegotiation (IR1). This in turn entails that any credible threat the firm
can make in the second round (IR2) was already available in the first round.
   On the worker side, quitting into unemployment is a credible threat when her value is below the
value of unemployment. So this threat does not change between the first round (IR1) and the second
round (IR2), because the equilibrium value to that worker will always be above the value of unemploy-
ment.
   In sum, the set of credible threats both to the firm and to worker j does not change between the initial
round of internal renegotiation (IR1) and the post-hiring-decision round (IR2). This finally implies that
the outcome of the initial round of internal renegotiation (IR1) for any incumbent j remains unchanged
in the second round (IR2), that is:
                                                   Vj = Vj

which proves Claim 1.
   We can now move on to proving C-UE.


Proof of C-UE.    Using the definitions of  and , we can write

                                                  n( x )                   n( x )
                              -  = J  +                    Vj + Vi - J +    Vj
                                                  j =1                     j =1




                                                           18
Now using Vi = U , we obtain

                                                 n( x )                       n( x )
                               -  = J  +                  Vj - J +             Vj          +U
                                                  j =1                        j =1

Using Claim 1: Vj = Vj , and adding and subtracting J  we obtain

                                                               n( x )                  n( x )
                           
                              -  = [J        
                                           -J ]+ J + 
                                                                        Vj   - J+       Vj      +U
                                                               j =1                    j =1

Subsituting in the definition of  and of  ,

                                    -  = [ J  - J  ] + [ - ] + U

Finally recall that internal renegotiation is (1) individually rational, and (2) is a zero-sum game, according
to A-IN. Thus, all incumbent workers remain in the coalition after internal renegotiation, and the joint
value is unchanged:  = . Using  = 

                                            -  = [ J  - J  ] + U

which can be re-written

                                           J  - J  = [ - ] - U

Now under A-LC, the firm will only hire if its value after hiring is higher than its value after internal
renegotiation: J  - J   0. This inequality requires

                                                          -   U

                                            (hU ( x )) -  ( x )  U

The firm does not hire when its value of hiring is below its value of renegotiation J  < J  . This inequality
implies
                                                 -  < U

When the firm does not hire, we obtain using again A-IN and  = :

                                                 -  < U

which finally implies
                                         (hU ( x )) -  (tU ( x )) < U


                                                          19
   Now, we argue that conditional on not hiring,  =  = , where in this case  denotes the
value of the coalition without hiring, and thus does not include the value of the unemployed worker. Just
as before, this is a direct consequence from A-IN and that the internal renegotiation game is zero-sum.
   Therefore:
                                               (tU ( x )) = ( x )

We have therefore shown C-UE and part of C-RT (UE Hires and UE Threats): An unemployed worker
that meets x is hired whenx  QU , where

                                     A = x  (hU ( x )) -  ( x )  U

and upon joining the firm, has value
                                              V (hU ( x, i )) = U .

and
                                              (tU ( x )) = ( x ).

C.3.2   Proof of C-EE and C-RT (EE Hires, EE Threats and Retentions)

Consider firm x that has met worker i at firm x . We first seek to determine Q E ( x , i ). Under A-IN
and A-EN, upon meeting an employed worker, internal negotiation may take place at the poaching firm
x, and x makes a take-it-or-leave-it offer. Internal negotiation may take place at x with all workers
including i .
   Proceeding by backward induction, we again define intermediate values but here at x , noting that
q E ( x , i , x ) gives the number of employees in x if the worker leaves:

                                                   n(q E ( x ,i ,x ))
                                         = J+                           Vj + Vi
                                                         j =1
                                                    n(q E ( x ,i ,x ))
                                          
                                         =J +   
                                                                         Vj + Vi
                                                           j =1
                                                      n(q E ( x ,i ,x ))
                                        = J  +                             Vj
                                                             j =1


Note, in the second line we are describing the values of the firm in renegotiation where i stays with the
firm, so Vi is the outcome of internal negotiation. In the third line we consider the firm having lost the
worker. Under A-EN the firm will respond to an offer V from x with

                                                   Vi = V

                                                        20
The same result as in Claim 1 from section C.3.1 obtains: under A-EN and A-IN, the values accepted by
the incumbent workers after the internal renegotiation Vj                                   will be equal to the values they receive after
                                                                                        j
the external negotiation Vj , that is
                               j
                                                                     Vj = Vj

The argument are exactly the same.
   Using these two results and the above definitions

                                   n(q E ( x ,i ,x ))                         n(q E ( x ,i ,x ))
            -  = J  +                                   Vj - J +                                   Vj + Vi
                                         j =1                                       j =1
                                                    n(q E ( x ,i ,x ))                                           n(q E ( x ,i ,x ))
                     = J  + J  - J  +                                    Vj + Vi - Vi - J +                                           Vj + Vi
                                                           j =1                                                        j =1
                                                        n(q E ( x ,i ,x ))                              n(q E ( x ,i ,x ))
                     = [ J  - J  ] + J  +                                    Vj + Vi - J +                                   Vj + Vi      - Vi
                                                              j =1                                            j =1

                     = [ J  - J  ] + [ - ] - Vi
                     = [ J  - J  ] + [ - ] - V

In this setup, A-IN again implies that any value lost to the firm must accrue to its workers, while any
value lost to a worker must accrue either to the firm, or to another worker, which we earlier formulated
as "the joint value stays constant before and after an internal negotiation". Mathematically, this statement
translates into
                                                                      = 

Subsituting into the equation that we obtained above  -  = [ J  - J  ] + [ - ] - V , we obtain

                                                     -  = [ J  - J  ] - V

   Now under A-LC, the firm x will only try to keep the worker if J  > J  , which requires

                                                                                      -   V

                                           r(x , i , x -  qE x , i , x                                V

This determined the maximum value that x can offer to the worker to retain them. Knowing that firm
x can counter at most with V =  (r ( x , i , x ) -  (q E ( x , i , x )), then will firm x successfully poach the
worker?
   First, note that the bargaining protocol implies that x firm will offer V if it is making an offer, since


                                                                             21
it need not offer more. For firm x the argument may proceed identically to the case of unemployment,
simply replacing U with V . The result is that the firm will hire only if

                                            hE x , i , x         -  (x)  V

or
                          hE x , i , x       -  (x)   r(x , i , x) -  qE x , i , x

      Finally, when firm x does not hire, the same argument as in Claim 32 in Section C.3.1 applies:  =
 = . This observation implies
                                               (t E ( x , i , x )) = ( x )

Similarly, the same argument as in Claim 2 implies that when firm x does not lose its worker,  =
 = , thereby implying
                                                (r ( x , i , x )) = ( x )

      The combination of these conditions deliver C-UE and part of C-RT (EE Hires, EE Threats and Re-
tention):

     1. The quit set of an employed worker is determined by


                      QE x , i    =     x  hE x , i , x       -  (x)   x -  qE x , i , x


     2. The worker's value of being hired from employment from firm x is

                                       V (h E ( x, x , i )) =  x -  q E x , i , x


     3. Worker i s value of being retained at x after meeting x is53

                                       V (r ( x , i , x ), i ) =  h E x , i , x   -  (x)


     4. The joint value of the potential poaching firm x when the worker is not hired does not change:

                                                   (t E ( x , i , x )) = ( x )




     53 Because
             offers are made at no cost, both firms always make an offer, even when they know that they cannot retain/hire
the worker in equilibrium. This is exactly the same as in Postel-Vinay Robin (2002).


                                                            22
   5. The joint value of the potential poached firm x does not change when the worker stays:

                                                     (r ( x , i , x )) = ( x )

C.3.3   Proof of C-EU (EU Quits and layoffs)

We first show that

                      L = ( x , i )  ( s ( x , (1 - [ ( x ) ;   i   ( x ) = 1])  (1 - qU ( x ))) , i ) + U

                                    >  ( s ( x , (1 - [ ( x ) ;      i   ( x ) = 0])  (1 - qU ( x ))) , i )

from the firm side, then that

                  QU = ( x, i )  (s ( x, (1 - ( x ))  (1 - [qU,-i ( x ) ; qU,i ( x ) = 1])) , i ) + U

                                  >  (s ( x, (1 - ( x ))  (1 - [qU,-i ( x ) ; qU,i ( x ) = 0])) , i )

on the worker side.


Part 1: Firm side     Consider a firm x who is considering laying off worker i for whom qU ,i ( x ) = 0. As
above, we start with definitions, noting that n (s ( x, (1 - [ ( x ) ;               i   ( x ) = 1])  (1 - qU ( x )))) is the number
of workers if i is laid off.
                                                            n(s(·))
                                                 = J+                      Vj + Vi
                                                                j =1
                                                                n(s(·))
                                                  
                                                 =J +    
                                                                            Vj + Vi
                                                                    j =1
                                                                 n(s(·))
                                                = J  +                      Vj
                                                                     j =1

Note that in the first line the coalition has still worker i in it. In the second line, the firm and the worker
i have negotiated (and internal negotiation has determined Vi which is what i will get if they stay in the
firm). In the third line, the worker has been fired and another round of negotiation has occurred among
incumbents.
    The same result as in Claim 1 from section C.3.1 obtains: under A-BP, the values accepted by the
incumbent workers after the internal renegotiation Vj will be equal to the values they receive after the
external negotiation Vj , that is Vj = Vj .



                                                                23
    Using this result and the above definitions

                                                  n(s(·))                         n(s(·))
                     -  = J  +                              Vj - J +                        Vj + Vi
                                                   j =1                            j =1
                                                                 n(s(·))                                      n(s(·))
                                    = J  - J  + J  +                       Vj + Vi - Vi - J +                           Vj + Vi
                                                                  j =1                                          j =1
                                                                   n(s(·))                            n(s(·))
                                    = [J          
                                               -J ]+ J +     
                                                                             Vj    + Vi       - J+              Vj + Vi - Vi
                                                                    j =1                               j =1

                                    = [ J  - J  ] + [ - ] - Vi

Using again A-IN to conclude that  = , we obtain

                                                           -  = [ J  - J  ] - Vi

Now under A-LC, the firm x will only layoff the worker if J  > J  , which requires

                                                                  -  < Vi

As long as Vi > U the worker would be willing to transfer value to the firm to avoid being laid off,
implying
                                                                  -  < U .

which we can re-write

 ( s ( x , (1 - [ ( x ) ;   i   ( x ) = 1])  (1 - qU ( x ))) , i ) + U >  (s ( x, (1 - [ ( x ) ;                   i   ( x ) = 0])  (1 - qU ( x ))) , i )

where the LHS is  + U (under the layoff) and the RHS is . This concludes the proof for the firm
side.


Part 2:       Worker side Consider worker i in firm x who is considering quitting to un-
employment for whom                     i   (x)      =      0.      As above, we start with definitions, noting that




                                                                             24
n (s ( x, (1 - ( x ))  (1 - [qU ,-i ( x ) ; qU ,i ( x ) = 1]))) is the number of workers if i quits. As before,

                                                              n(s(·))
                                                  = J+                  Vj + Vi
                                                                j =1
                                                                n(s(·))
                                                   = J  +                   Vj + Vi
                                                                 j =1
                                                                 n(s(·))
                                                 = J  +                       Vj
                                                                     j =1

The same result as in Claim 1 from section C.3.1 obtains Vj = Vj .
    Using this result and the above definitions

                                        n(s(·))                      n(s(·))
                   -  = J  +                      Vj - J +                     Vj + Vi
                                         j =1                          j =1
                                                    n(s(·))                                      n(s(·))
                            = J  + J  - J  +                  Vj + Vi - Vi - J +                           Vj + Vi
                                                     j =1                                          j =1
                                                      n(s(·))                            n(s(·))
                            = [ J  - J  ] + J  +                Vj + Vi - J +                      Vj + Vi - Vi
                                                       j =1                               j =1

                            = [ J  - J  ] + [ - ] - Vi

Again,  =  from A-IN, so that

                                                 -  = [ J  - J  ] - Vi

Now under A-LC, worker i will quit into unemployment iff Vi < U , which requires

                                                J  - J  + [ -  ] < U

As long as J  < J  , the firm is willing to transfer value to worker i to retain her. Therefore, worker i
quits into unemployment iff the previous inequality holds at J  = J  , i.e.

                                                      -  < U

Therefore, the worker quits iff

                           (s ( x, (1 - ( x ))  (1 - [qU ,-i ( x ) ; qU ,i ( x ) = 1])) , i ) + U

                           >  (s ( x, (1 - ( x ))  (1 - [qU,-i ( x ) ; qU,i ( x ) = 0])) , i )



                                                                25
which concludes the proof of the worker side. This delivers C-EU.

C.3.4   Proof of C-X (Exit)

Consider a firm x who contemplates exit after all endogenous quits and layoffs, thus when its employ-
ment is n (s ( x,  ( x ))). As before we define values conditional on exiting:

                                                                   n(s(·))
                                                     = J+                    Vj
                                                                    j =1
                                                                    n(s(·))
                                                    = J  +                    Vj
                                                                      j =1

                                                   = J  + 0

Notice that the joint value after exit is simply the value of the firm, since all other workers have left
because of exit. We can compute:

                                                                 n(s(·))
                               -  = J  - J +                               Vj
                                                                   j =1
                                                                                       n(s(·))
              (add and subtract J  )          = [ J  - J  ] + J  - J +                           Vj
                                                                                         j =1
                            n(s(·))                                           n(s(·))                    n(s(·))          n(s(·))
        (add and subtract             Vj )    = [J         
                                                        -J ]+ J +      
                                                                                          Vj      - J+             Vj -             Vj
                              j =1                                                j =1                    j =1             j =1
                                                                                          n(s(·))
               (definition of ,  ) = [ J  - J  ] + [ - ] -                                          Vj
                                                                                           j =1

Again,  =  from A-IN, so that

                                                                                n(s(·))
                                              -  = [ J  - J  ] -                          Vj
                                                                                  j =1

   The firm exits iff J   J  , that is,   J  . This is equivalent to

                                                                     n(s(·))
                                                  -   -                           Vj
                                                                       j =1

   Using again that  = J  = , the firm exits iff

                                                         n(s(·))
                                                     +             Vj  
                                                          j =1




                                                              26
    Since any worker is better off under Vi  U than unemployed, all workers are willing to take a value
                                n(s(·))
cut down to U if    -  j=1                Vj because then the firm can credibly exit.
    This implies that the firm exits if and only if

                                     -  (s ( x,  ( x ))) + n (s ( x,  ( x ))) U  0

    This proves C-X (Exit): the set of x such that the firm exits is given by

                                E = x  + n (s ( x,  ( x ))) · U   (s ( x,  ( x )))

C.3.5       Proof of C-V (Vacancies)

We split the proof in two steps. First, we show that workers are collectively willing to transfer value
to the firm in exchange for the joint value-maximizing vacancy policy function. Second, we show that
a single worker can create a system of transfers that achieves the same outcome. These transfers are
equivalent to wage renegotiation, which explains why we have subsumed them in the wage function
w( x, i ) in the equations above. Similarly to wages, these transfers drop out from the expression for the
joint value.


Part 1: Collective transfers In this step, we show that workers are collectively better off transferring
value to the firm in exchange of the firm posting the joint value-maximizing amount of vacancies.
    The vacancy posting decision v J that maximizes firm value is:
                                                                       ¢
cv v J ( x ) , n ( x )
                       =  [ J (hU ( x )) - J ( x )] · I{xA} + (1 - )                         J hE x , i , x   - J ( x ) dHn x , i .
          q                                                                x Q E ( x ,i )


Similarly, define v be the policy that maximizes the value of the coalition, and vV be the policy that
                                                                 
maximizes the value of all the employees. Let  , J  , V be the value of the coalition, firm and all workers
under the v , for   , J , V . We now prove our claim in several steps.

                                                                                                  J
    Part 1-(a) Collective value gains.         The policy v will lead to V                   V + [ J J - J  ] where J J - J   0.

                                                                                                                   
    Proof: By construction  is greater than  J :    J . By definition:  = J  + V , and  J =
        J                                                                                     J
J J + V . Use those definitions to obtain inequality J  + V                    J J + V , which can be re-arranged into
            J
V - V  J J - J  . Since J J is the value under the optimal policy for J , then J J  J  . The above then
implies that
                                                        J
                                                V - V  J J - J  0

                                                            27
This implies that workers would be prepared to transfer T = J J - J   0 to the firm in order for the firm
to pursue policy v instead of v J . This concludes the proof of Part 1-(a).

                                        V
   Part 1-(b) Infeasibility of V . There does not exist an incentive-compatible transfer from workers
                            V
to firm that will lead to V .


   Proof: Suppose workers consider transferring even more to induce the firm to follow policy vV that
                                                                                                               
maximizes their value. By construction   V . Using definitions for each of these, then J  + V                     
       V                                                 V                                V
J V + V . Rearranging this: J  - J V  V - V . Since V is the value under the optimal policy for V ,
       V      
then V  V . The above then implies that

                                                                            V             
                                                        J - JV  V - V                         0

Taking v as a baseline, the above implies that a change to vV causes a loss of J  - J V to the firm, which
                                V           
is more than the gain of V - V                 to the workers. This implies that workers could transfer all of their
gains under vV to the firm, but the firm would still not choose vV over v . This concludes the proof of
Part 1-(b).

                                     
   Part 1-(c) Optimality of V . There does not exist an incentive-compatible transfer from workers to
                                               V
firm that will lead to V            V ,V            .


   Proof: Call such a policy vV  . Then:   V  , and by definitions
                                                                                                     
                                                                                                 V
                                                        J + V               JV + V
                                                                                       
                                                                                   V             
                                                        J - JV              V             -V
                                                                  
                                          V                   V            
Since by definition V        V ,V                  , then V          - V  0. Therefore

                                                                                
                                                                            V             
                                                        J - JV  V                  -V  0
                                                                                                        
Taking v as a baseline, the above implies that a change to vV causes a loss of J  - J V to the firm, which
                                 
                             V            
is more than the gain of V          - V to the workers. This concludes the proof of Part 1-(c).


   Part 1-(d) Conclusion.           In summary, it is optimal for workers to transfer exactly T = J J - J  to the
firm, in order for the firm to pursue v instead of v J . Further transfers to the firm would be required to


                                                                           28
have the firm pursue a better policy for workers, but this is exceedingly costly to the firm and the workers
are unwilling to make a transfer to cover these costs. This concludes the proof of Step 1: Collective
transfers.


Part 2: Individual transfers In this step, we show that a single, randomly drawn worker can construct
a system of transfers that induces the firm to post v instead of v J , while leaving all agents better off.
   Within dt, consider the single, randomly drawn worker j0 . Consider the following system of trans-
fers. Worker j0 makes a transfer J J - J  to the firm, in exchange of what (i) the firm posts v instead of
                                                                                                      J
v J , and (ii) the worker gets a wage increase that gives her all the differential surplus V - V .
   Following the same steps as in Part 1: Collective transfers, the firm gets J  + [ J J - J  ] = J J and is
hence indifferent. Similarly, workers j = j0 do not get any value change, and are thus indifferent Finally,
worker j0 gets a value increase of
                                                                J
                                                    [V - V ] - [ J J - J  ]  0

where the inequality similarly follows from Part 1: Collective transfers. This concludes the proof of Part
2: Individual transfers.


Conclusion. The previous arguments show that a single worker has an incentive to and can induce the
firm to post v . Notice also that the same argument holds starting from any vacancy policy function
v = v J together with a value of the firm J . Thus, even if some worker induces the firm to post a different
vacancy policy function which is not v any other worker has an incentive to induce the firm to post v .
Therefore, in equilibrium, the firm posts v , which concludes the proof of C-V.

C.4     Applying Conditions (C)

Having established that Assumption (A) can be used to prove Conditions (C), we now apply conditions
(C) to the Bellman equation for the joint value. The goal of this section is to show that for x  E c the
complement of the exit set, we can considerably simplify the recursion for the joint value:

         ( x ) = y (z( x ), n ( x )) - c (v ( x ) , n ( x ) , z( x ))
                            n( x )
Destructions           -     [ (x) -  (d(x, i)) - U ]
                            i =1
   UE Hires            +qv ( x )  [ (hU ( x )) -  ( x ) - U ] · I{xA}
                                           ¢
      EE Hires         +qv ( x ) (1 - )                          hE x , i , x   -  (x) -  x -  qE x , i , x   dHn x , i
                                               x Q E ( x ,i )
       Shocks          +  [ ,  ]


                                                                    29
with the sets

                          QU = ( x, i )  (s ( x, (1 - ( x ))  (1 - [qU,-i ( x ) ; qU,i ( x ) = 1])) , i ) + U

                                             >  (s ( x, (1 - ( x ))  (1 - [qU,-i ( x ) ; qU,i ( x ) = 0])) , i )

                             L = ( x , i )  ( s ( x , (1 - [ ( x ) ;         i   ( x ) = 1])  (1 - qU ( x ))) , i ) + U

                                             >  ( s ( x , (1 - [ ( x ) ;         i   ( x ) = 0])  (1 - qU ( x ))) , i )

                             E = x  + n (s( x,  ( x ))) · U  (s( x,  ( x )))

                            A = x  (hU ( x )) -  ( x )  U

                  QE x , i     =     x  hE x , i , x              -  (x)   x -  qE x , i , x


and--as per (C-V)--the vacancy policy v ( x ) is given by the solution to the following:

cv (v ( x ) , n ( x ))
                         =  [ (hU ( x )) -  ( x )] · I{xA}
          q
                                       ¢
                         + (1 -  )                            hE x , i , x              -  (x) -  x -  qE x , i , x                            dHn x , i
                                           x Q E ( x ,i )

In continuous time, the exit decision is captured by x  E . The Bellman equation above holds exactly
for x  E c . Exit is accounted for in the "bold" continuation values, which all include the possible exit
decision should the firm's state fall into E after an event.
    We first proceed one term at the time, working through (B.4.1) exogenous destructions, (B.4.2) re-
tentions, (B.4.3) EE (poached) quits, (B.4.4) UE hires, (B.4.5) UE threats, (B.4.6) EE (poached) hires, and
(B.4.7) EE threats.

C.4.1     Exogenous destructions

                                                n( x )                      n(d( x,i ))
                         Destructions =                   J (d( x, i )) +                 V ( d ( x , i ), j ) + U -  ( x )
                                                i =1                             j =1
                                                n( x )
                                            =     [ (d(x, i)) + U -  (x)]
                                                i =1




                                                                                                         n(d( x,i ))
where we simply have used the definition  (d( x, i )) := J (d( x, i )) +  j=1                                          V ( d ( x , i ), j ).




                                                                       30
C.4.2   Retentions

                                       n( x ) ¢                                            n( x )
         Retentions =  E                          x/ Q E ( x ,i )
                                                                    J r x, i, x       +     V              r x, i, x , j -  ( x ) dHv x
                                       i =1                                                 j =i
                                       n( x ) ¢
                             =     E
                                                  x/ Q E ( x ,i )
                                                                     r x, i, x         -  ( x ) dHv x
                                       i =1

                                                                                                                             n( x )
where we simply have used the definition  (r ( x, i, x )) = J (r ( x, i, x )) +  j=i V (r ( x, i, x ) , j). Now
using the result in C-RT that
                                                                     r x, i, x         = ( x )

we obtain that
                                                                       Retentions = 0

C.4.3   EE Quits
                  n( x ) ¢                                                                                     n( x )
EE Quits =    E
                             x Q E ( x,i )
                                              J q E x, i, x             + V q E x, i, x , i +                  V        q E x, i, x , j -  ( x ) dHv x
                  i =1                                                                                         j =i

Now by definition

                                                                                           n(q E ( x,i,x ))
                               q E x, i, x                  = J q E x, i, x          +                        V q E x, i, x , j
                                                                                                    j =1
                                                                                           n( x )
                                                            = J q E x, i, x          +     V               q E x, i, x , j
                                                                                           j =i

Using this last equality in the term in square brackets

                                       n( x ) ¢
           EE Quits =  E                          x Q E ( x,i )
                                                                     q E x, i, x           -  ( x ) + V q E x, i, x , i               dHv x
                                       i =1

Using C-EE, the value going to the poached worker is V (q E ( x, i, x )) =  ( x ) -  (q E ( x, i, x )). Substi-
tuting this into the last equation, we observe that the term in the square brackets is zero, and so

                                                                        EE Quits = 0

C.4.4 UE Hires
                                                                                  n( x )
                      UE Hires = qv ( x )  J (hU ( x )) +                           V ( hU ( x ) , i ) -  ( x )              · I{xA}
                                                                                  i =1




                                                                              31
Now by definition

                                                              n(hU ( x ))
                         (hU ( x )) = J (hU ( x )) +                        V ( hU ( x ) , i )
                                                                 i =1
                                                              n( x )
                                          = J (hU ( x )) +     V ( hU ( x ) , i ) + V ( hU ( x ) , i )
                                                              i =1

and so, re-arranging,

                                            n( x )
                        J (hU ( x )) +        V (hU (x) , i) =  (hU (x)) - V (hU (x) , i)
                                             i =1

Substituting this last equation into the term in the square brackets of the first equation,

                     UE Hires = qv ( x )  [ (hU ( x )) -  ( x ) - V (hU ( x ) , i )] · I{ xA}

Following C-UE, the value going to the hired worker is V (hU ( x ) , i ) = U . Substituting in:

                          UE Hires = qv ( x )  [ (hU ( x )) -  ( x ) - U ] · I{ xA}

C.4.5   UE Threats

                                                                        n( x )
                UE Threats = qv ( x )  J (tU ( x )) +                    V ( tU ( x ) , i ) -  ( x )     · I{ x / A}
                                                                        i =1

Using the definition of (tU ( x )), we can re-write this term as

                           UE Threats = qv ( x )  [ (tU ( x )) - ( x )] · I{ x/ A}


Now using our result in condition C-UE that  (tU ( x )) = ( x ), we can conclude that

                                                        UE Threats = 0

C.4.6   EE Hires
                                ¢                                                n( x )
   EE Hires = qv ( x ) (1 - )
                                    x Q E ( x ,i )
                                                     J hE x , i , x         +    V        h E x , i , x , i -  ( x ) dHn x , i
                                                                                 i =1




                                                                32
Now by definition

                                                                        n(h E ( x ,i ,x ))
             hE x , i , x          = J hE x , i , x                 +                        V hE x , i , x , i
                                                                              i =1
                                                                          n( x )
                                   = J hE x , i , x                   +    V           hE x , i , x , i         + V hE x , i , x , i
                                                                           i =1

which can be re-arranged into

                                        n( x )
              J hE x , i , x        +   V           hE x , i , x , i =  hE x , i , x                          - V hE x , i , x , i
                                        i =1

Using this in the term in the square brackets
                                        ¢
      EE Hires = qv ( x ) (1 - )                               hE x , i , x                  -  (x) - V hE x , i , x , i          dHn x , i
                                            x Q E ( x ,i )

Under C-EE, the value going to the hired worker is V (h E ( x , i , x ) , i ) =  ( x ) -  (q E ( x , i , x )). Substi-
tuting this in:
                               ¢
EE Hires = qv ( x ) (1 - )                             hE x , i , x                  -  (x) -  x -  qE x , i , x                          dHn x , i
                                   x Q E ( x ,i )


C.4.7    EE Threats

                                        ¢                                                        n( x )
EE Threats = qv ( x ) (1 - )
                                            x/ Q E ( x ,i )
                                                              J tE x , i , x                 +   V        t E x , i , x , i - J ( x ) - V ( x ) dHn x , i
                                                                                                 i =1

Using the definition of (t E ( x , i , x )), we obtain
                                                               ¢
              EE Threats = qv ( x ) (1 - )                                            tE x , i , x            - ( x ) dHn x , i
                                                                   x/ Q E ( x ,i )

Now using the result in condition C-RT that  (t E ( x , i , x )) = ( x ), we obtain that

                                                               EE Threats = 0

C.5     Reducing the state space

Now that we obtained the simplified recursion, we are in a position to argue that the only payoff-relevant
states are (z, n), and that the details of the within-firm contractual structure do not affect allocations. The
goal of this section is to show that we can express the joint values pre- and post- separation and exit




                                                                            33
decisions as follows. First, the exit and separation decisions are characterized by

          (z, n) = I{(z,n)E }             + nU            + I{(z,n)QU } (z, n - 1) + U + I{(z,n)/ QU E }  ( z, n ), (23)

      where      E =        n, z  + nU > (z, n) ,

               QU =         z, n  ( z, n - 1) + U >  ( z, n ) .

The first expression is the value of exit. A firm that does not exit, chooses whether to separate with a
worker or not. If separating with a worker, the firm re-enters (23) with (z, n - 1), having dispatched
with a worker with value U , and again choosing whether to exit, fire another worker, or continue. Iter-
ating on this procedure delivers

                                  (z, n) = max  + nU , max (z, n - s) + sU .                                                  (24)
                                                                     s[0,...,n]

    Second, the post-exit/separation decision joint value is given by the Bellman equation

    (z, n) = max y (z, n) - c (v, n, z)
                      v 0

Destruction +         n          ( z, n - 1) + U -  ( z, n )

   UE Hire +          q( )v · I{(z,n)A} ·  (z, n + 1) -  (z, n) + U
                                         ¢
    EE Hire +         (1 -  ) q (  ) v                          [ (z, n + 1) -  (z, n)] -  z , n -  z , n - 1                    dHn z , n
                                             (z,n)Q E (z ,n )
      Shock +          z [ ,  ] ( z, n ) ,

 where        A =      z, n  ( z, n + 1)   ( z, n ) + U ,

 QE z , n       =      z, n  ( z, n + 1) -  ( z, n )   z , n -  z , n - 1                        .

Finally, firms enter if and only if                   ¢
                                                            ( z, 0) d 0 ( z )  c e .                                          (25)

This condition pins down the entry rate per unit of time.54


    We proceed in three steps. First, we isolate (z, n) in the state vector x by writing x = (z, n, ) where
 collects all other terms in x. Second, we introduce functions that update  following events to the firm
and worker. Third, we argue that  is a redundant state. This delivers the final Bellman equation for the
joint value function for the discrete workforce model, equation (25).

                            ¡                                                                ¡
  54 Recallthat J0 = -ce + J ( x0 )d(z0 ). Given (z0 , 0) = J (z0 , 0), we have J0 = -ce +       (z0 , 0)d(z0 ). Free-entry implies
J0 = 0, which delivers (25).


                                                                    34
C.5.1    Isolate (z, n) in the state vector

It is immediate that x should contain at least the pair (z, n). Call everything else . Then we express
x = (z, n, ). Making this substitution into the above conditions:

   ( z, n,  ) = y ( z, n ) - c ( v ( z, n,  ) , n )
                            n( x )
Destructions            -    [ (z, n, ) -  (d (z, n, , i)) - U ]
                            i =1
   UE Hires             +qv (z, n, )  [ (hU (z, n, )) -  (z, n, ) - U ] · I{(z,n,)A}
                                                ¢
    EE Hires            +qv (z, n, ) (1 - )                                   h E z , n ,  , i , z, n,          -  ( z, n,  )
                                                    (z,n,)Q E (n ,z , ,i )

                                                                             -  z , n ,  , i -  q E n , z ,  , i , z, n, 
                                                                              · dHn z , n ,  , i
        Shocks          +z [, ](z, n, )

with sets

              QU =       (z, n, , i )  (s (z, n, , (1 - (z, n, ))  (1 - [qU,-i (z, n, ) ; qU,i (z, n, ) = 1])) , i ) + U


                                         >  (s (z, n, , (1 - (z, n, ))  (1 - [qU,-i (z, n, ) ; qU,i (z, n, ) = 0])) , i )


                  L=     ( z, n, , i )  ( s ( z, n, , (1 - [ ( z, n,  ) ;     i   (z, n, ) = 1])  (1 - qU (z, n, ))) , i ) + U


                                         >  ( s ( z, n, , (1 - [ ( z, n,  ) ;          i   (z, n, ) = 0])  (1 - qU (z, n, ))) , i )

                  E = z, n,   + n (s(z, n, ,  (z, n, ))) · U  (s(z, n, ,  (z, n, )))

                 A=      z, n,   (hU (z, n, )) -  (z, n, )  U


QE z , n ,  , i     =    z, n,   h E z , n ,  , i , z, n,              -  ( z, n,  )   n , z ,  , i -  q E z , n ,  , i , z, n, 




                                                                  35
and vacancy posting

 c v ( v ( z, n,  ) , z, n )
                               =  [ (hU (z, n, )) -  (z, n, )] · I{(z,n,)A}
               q
                                              ¢
                                  + (1 -  )                                   h E z , n ,  , i , z, n,    -  ( z, n,  )
                                                  (z,n,)Q E (z ,n , ,i )

                                                                           -  z , n ,  , i -  q E n , z ,  , i , z, n, 
                                                                            · dHn z , n ,  , i

Finally, note that the contribution of shocks writes explicitly

                                                                     (zt+dt , nt+dt , t+dt )
                                       z [, ] = lim Et
                                                         dt0                  dt

To avoid introducing too much stochastic calculus notation, we will show that  is a redundant state
under the special case that shocks z follow a multi-point Poisson jump process. The logic of the proof
with other stochastic processes would be exactly the same, at the expense of more notation. In the
Poisson case, we have

                                  z [, ] =  (z) Ez ( , n,  (z, n, ,  )) - (z, n, )

where  (z) is the intensity at which the Poisson shocks hit, and  is a random variable following the
distribution of those shocks conditional on arrival and conditional on the initial productivity z.




                                                                    36
C.5.2    Introduce functions that update the residual 

We define the following functions given that we know how n changes in each of the cases

                                                            s(z, n, ,  (z, n, )) = (N (z, n, ), z, s (z, n, ))

                                                                          d (z, n, , i ) = (n - 1, z, d (z, n, , i ))
                                                                                                                                      
s (z, n, , (1 - (z, n, ))  (1 - [qU ,-i (z, n, ) ; qU ,i (z, n, ) = 1])) = (N (z, n, ) - 1 (z, n, ), z, 1 (z, n, , i ))
                                                                                                                       
s (z, n, , (1 - (z, n, ))  (1 - [qU ,-i (z, n, ) ; qU ,i (z, n, ) = 0])) = (N (z, n, ), z, 0 (z, n, , i ))
                                                                                                            
    s ( z, n, , (1 - [ ( z, n,  ) ;   i   (z, n, ) = 1])  (1 - qU (z, n, ))) = (N (z, n, ) - 1 (z, n, ), z, 1 (z, n, , i ))
                                                                                               
    s ( z, n, , (1 - [ ( z, n,  ) ;   i   (z, n, ) = 0])  (1 - qU (z, n, ))) = (N (z, n, ), z, 0 (z, n, , i ))
                                                                                                                 
                                                                          hU ( z, n,  ) =             n + 1, z, hU (z, n, )
                                                                                                                 
                                                         h E z ,  , i , z, n, , n           =         n + 1, z, h E z , n ,  , i , z, n, 
                                                                                                                    
                                                         q E z , n ,  , i , z, n,           =         n - 1, z , q E n , z ,  , i , z, n, 
                                                                                                     1
                                                                Hn z , n ,  , i             =          Hn z , n , 
                                                                                                     n
                                                                                                             
                                                                      gz ( z, n, ,  ) =                , n, gz ( z, n, ,  )

The above uses the function N (z, n, ), which gives the number of workers the firm retains after endoge-
nous quits and layoffs. It solves

                                      N (z, n, ) = arg max (k, z, ) + (n - k)U
                                                            k {0,...,n}


In addition, 1 (z, n, ), 1 (z, n, )  {0, 1}. 1 (z, n, ) = 0 if                        i ( z, n,  )   = 1. Similarly, 1 (z, n, ) = 0 if
qU ,i (z, n, ) = 1. Using these definitions in the Bellman equation above:

   ( z, n,  ) = y ( z, n ) - c ( v ( z, n,  ) , z, n )
                          n( x )
Destructions          -     [ (z, n, ) -  (n - 1, z, s (z, n, , i)) - U ]
                           i =1
   UE Hires           +qv (z, n, )   n + 1, z, hU
                                                
                                                  (z, n, ) -  (z, n, ) - U · I{(z,n,)A}
                                                  ¢
                                                                                    n + 1, z, h E z , n ,  , i , z, n,            -  ( z, n,  )
                                                                                                       
    EE Hires          +qv (z, n, ) (1 - )
                                                      (z,n,)Q E (n   , z ,  ,i )

                                                                           -  z , n ,  , i -  n - 1, z , qE z , n ,  , i , z, n, 

                                                                                   · dHn z , n ,  , i
        Shocks        +  ( z )Ez   , n , gz
                                          
                                            ( z, n, ,  ) -  ( z, n,  )




                                                                     37
and sets

                          E = z, n,   + N (z, n, ) · U  (N (z, n, ), z, s (z, n, ))

                     QU =       (z, n, , i ) (N (z, n, ) - 1 (z, n, ), z, 1
                                                                          
                                                                            (z, n, , i )) + U


                                                  > (N (z, n, ), z, 0
                                                                    
                                                                      (z, n, , i ))


                          L=    ( z , n ,  , i )  ( N ( z , n ,  ) - 1 ( z , n ,  ) , z , 1
                                                                                          
                                                                                            (z, n, , i )) + U


                                                  >  ( N ( z , n ,  ) , z , 0
                                                                            
                                                                              (z, n, , i ))


                                z, n,   n + 1, z, hU (z, n, ) -  (z, n, )  U
                                                              
                      A=


        QE z , n ,  , i         z, n,   n + 1, z, h E z, n, , z , n ,  , i               -  ( z, n,  )
                                                               
                            =


                                                    z , n ,  , i -  n - 1, z , p z , n ,  , i , z, n, 


and the definition
                                  N (z, n, ) = arg max (k, z, ) + (n - k)U
                                                              k {0,...,n}

and vacancy posting

c v ( v ( z, n,  ) , z, n )
                            =   n + 1, z, hU
                                           
                                             (z, n, ) -  (z, n, ) · I{(z,n,)A}
              q
                                  ¢
                                                                    n + 1, z, h E z, n, , n , z ,  , i          -  ( z, n,  )
                                                                                    
                     + (1 -  )
                                      (z,n,)Q E (z   , n ,  ,i )

                                                                            -  z , n ,  , i -  n - 1, z , qE z , n ,  , i , z, n, 

                                                                                · dHn z , n ,  , i

C.5.3    Argue that (, i ) are a redundant state

The system above defines a functional fixed point equation. Inspection of the Bellman equation reveals
that  has no direct impact on the flow payoff, continuation values, or mobility sets. Its only impact
is through the dependence of  on . This observation implies that  is a redundant state, and can be
removed from the fixed point equation. The same argument ensures that the worker index i is redundant
as well.

                                                                     38
C.5.4    Bellman equation without (, i )
We can re-write our Bellman equation for (z, n)  E c as:

     ( z, n )    = y ( z, n ) - c ( v ( z, n ) , n )
                            n
Destructions          -  [ (z, n) -  (n - 1, z) - U ]
                          i =1
                              n   ¢
 Retentions           +   E
                                                        [ (z, n) -  (z, n)] dHv x
                            i =1 (n ,z )R(z,n)
   UE Hires           +qv (z, n)  [ (n + 1, z) -  (z, n) - U ] · I{(z,n)A}
                                                  ¢
   EE Hires           +qv (z, n) (1 - )                                  [ (n + 1, z) -  (z, n)] -  z , n -  n - 1, z    d Hn z , n
                                                      (z,n)Q E (z ,n )

        Shocks        +z [, ](z, n)

with the sets

                                  Ec =        z, n (N (z, n))   + N (z, n)U


                       L = QU =               z, n (N (z, n), z) - (N (z, n) - 1, z)  U


                                  A=          z, n  (n + 1, z) -  (z, n)  U


                    QE z , n          =       z, n  (n + 1, z) -  (z, n)   z , n -  n - 1, z


and the definition
                                              N (z, n) = arg max (k, z) + (n - k)U
                                                                     k {0,...,n}

and the vacancy policy function:

c v ( v ( z, n ) , z, n )
                          =  [ (n + 1, z) -  (z, n)] · I{(z,n)A}
            q
                                      ¢
                     + (1 -  )                                 [ (n + 1, z) -  (z, n)] -  z , n -  n - 1, z             d Hn n , z
                                          (z,n)Q E (z ,n )


C.5.5    Expressing "bold" values

In this step we express "bold" values ­ that encode the optimal quit, layoff and exit decisions ­ as simple
functions of non-bold values.




                                                                            39
   From the definition of the exit and quit sets E , QU , we can express:


                    (z, n) = max         ( z, n ) ,          (n - 1, z) + U                 ,  + nU
                                        Operate       Separate one worker and re-evaluate     Exit


We can iterate on this equation. To see the logic, consider the first few steps.


   (z, n) = max         (z, n) , (n - 1, z) + U ,  + nU


             = max (z, n) , max (n - 1, z) , (n - 2, z) + U ,  + (n - 1)U                             + U ,  + nU


                 = max (z, n) , (n - 1, z) + U , (n - 2, z) + 2U ,  + (n - 1)U + U ,  + nU


                 = max (z, n) , (n - 1, z) + U , (n - 2, z) + 2U ,  + nU


By recursion, it is easy to see that


                     (z, n) = max        (N (z, n), z) + (n - N (z, n)) · U ,  + nU


                               = max        max (k, z) + (n - k )U ,  + nU
                                          k {0,...,n}


where recall that
                                  N (z, n) = arg max (k, z) + (n - k)U
                                                  k {0,...,n}


C.6   Continuous workforce limit

Up to this point the economy has featured a continuum of firms, but an integer-valued workforce. We
now take the continuous workforce limit by defining the `size' of a worker--which is 1 in the integer
case--and taking the limit as this approaches zero. Specifically, denote the "size" of a worker by , such
that n = N  where N is the old integer number of workers. Now define  (z, n) := (z, n/), and
likewise define y (z, n) := y(z, n/) and c (v, n, z) := c(v/, n/, z). We also define b := b/ and
 :=  /. These imply, for example, that (z, N ) =  (z, N ). Substituting these terms into (24) and
(25), and taking the limit   0, while holding n = N  fixed, we would obtain a version of (26) in
which all functions have the  super-script notation. We also specialize the productivity to a diffusion
process dzt = µ(zt )dt + (zt )dWt .



                                                          40
     The result is the joint value representation of section 2.3: a Hamilton-Jacobi-Bellman (HJB) equation
  for the joint value conditional on the firm and its workers operating:

               (z, n) = max         y ( z, n ) - c ( v, n, z )                                            (26)
                            v 0
                   Destruction      -  n [  n ( z, n ) - U ]
                      UE Hire       +  q (  ) v [  n ( z, n ) - U ]
                                                         ¢
                       EE Hire      +(1 - )q( )v              max n (z, n) - n (n , z ) , 0 dHn z , n

                                                               ( z )2
                         Shock      + µ ( z )  z ( z, n ) +           zz (z, n).
                                                                2

  Boundary conditions for the firm and its workers operating require the state to be interior to the exit and
  separation boundaries:

                               Exit boundary:          (z, n)   + nU ,

                            Layoff boundary:            n ( z, n )  U

  Note the absence of  terms. Since the value we track is that of a hiring firm subject to boundary
  conditions, then  = . This admits the simplification of `Shock' terms we noted when discussing (20).


     We proceed in three steps:

(A.5.1) Define worker size and the renormalization

(A.5.2) Take the limit as worker size goes to zero

(A.5.3) Introduce a continuous productivity process.

  C.6.1    Define worker size and the renormalization

  We denote the "size" of a worker by . That is, we currently have an integer work-force n  {1, 2, 3, . . . }.
  We now consider m  {, 2, 3, . . . }. So then n = m/. We use this to make the following normaliza-
  tions:

                                                               m
                                                ( z, m ) =       ,z
                                                               
                                                              m
                                               Y ( z, m ) = y   ,z
                                                              
                                                              v m
                                               C ( z, m ) = c  , ,z
                                                               


                                                                 41
   These definition imply

                                                     ( z, n ) =  ( n , z )

                                                     y ( z, n ) = Y ( n , z )

                                                   c ( v, z, n ) = C ( v , n , z )

   In addition, the value of unemployment solves

                                                              U = b

   Define
                                                                b   U
                                                          U=      =
                                                                    
   and
                                                         
                                                              =
                                                         
   Substituting these definitions into the Bellman equation, we obtain

 (n, z) = max      Y ( n , z ) - C ( v , n , z )
            v  0
                        ( n , z ) -  ( n  - , z )
   Destructions    -n                             -U
                                    
                        ( n  + , z ) -  ( n , z )
      UE Hires     +qv                             - U · I{(n,z)A}
                                    
                                   ¢
                                                           ( n  + , z ) -  ( n , z )  ( n , z ) -  ( n  - , z )
       EE Hires    +qv (1 - )                                                       -                           d Hn n , z
                                       (n,z)Q E (n ,z )                                           
         Shocks    +z [ ,  ] (n, z)

    with the set definitions

                           E=      n , z       max         ( k , z ) + ( n  - k  ) U <  + n  U
                                            k {0,...,n}

                                             ( n  + , z ) -  ( n , z )
                         A=        n , z                               U
                                                      

                                             ( n , z ) -  ( n  - , z )
                       QU =        n , z                               U
                                                         

                                             ( n  + , z ) -  ( n , z )   ( n , z ) -  ( n  - , z )
               Q E n , z       =   n , z                               
                                                                                     




                                                                 42
and the definition:

                     (n, z) = max                  max         ( k , z ) + ( n  - k  ) U ,  + n  U
                                               k {0,...,n}


C.6.2   Continuous limit as worker size goes to zero

Now we take the limit   0, holding m = n fixed. We note v = lim0 v. We see derivatives
                                    
appear. We denote m (z, m) =         m ( z, m ).



   First, we note that the following limit obtains:


                          (z, m) = max              max  (k, z) + (m - k )U ,  + mU
                                                   k [0,m]


In particular, the exit set limits to


                               E=       z, m max  (k, z) + (m - k )U <  + mU
                                              k [0,m]


In equilibrium, the  (z, m) terns on the right-hand-side of the Bellman equation are the result of endoge-
nous quits, layoffs and hires. Because our continuous time assumption has been made before we take the
limit to a continuous workforce limit, we need only consider those changes in the workforce one at a
time. Hence, for any (z, m)  Interior(E c  A), the interior of the continuation set, there is always  > 0:
such that for any   :
                                              ( m ± , z ) =  ( m ± , z )

Using this observation in the Bellman equation, we can obtain derivatives on the right-hand-side. We
obtain, for pairs (z, n) in the interior of the continuation set (z, n)  Interior(E c  A):

            (z, m) = max          Y ( z, m ) - C ( v, z, m )
                         v 0
               Destructions       -  m [  m ( z, m ) - U ]
                   UE Hires       +qv [m (z, m) - U ] · I{(z,m)A}
                                                   ¢
                   EE Hires       + q v (1 -  )                           m (z, m) - m (m , z ) d Hn m , z
                                                       (z,m)Q E (m ,z )

                      Shocks      +z [ ,  ] (z, n)




                                                               43
with the set definitions

                                E=   z, m max  (k, z) + (n - k )U <  + mU
                                          k [0,m]


                             A=      z, m  m ( z, m )  U


                           QU =      z, m  m ( z, m )  U    = A , the complement of A


                     QE z , m    =   z, m  m ( z, m ) -  m ( m , z )  0


and the definition

                        (z, m) = max      max  (k, z) + (m - k )U ,  + mU
                                          k[0,m]


Note that now, the only place where  enters in the Bellman equation is the contribution of shocks. To
replace it with  , we need to apply the same argument to z as the one we applied to n. We thus need to
specialize to a continuous productivity process.

C.6.3   Continuous productivity process

We now specialize to a continuous productivity process, as this makes the formulation of the problem
very economical. It allows to simplify the contribution of productivity shocks and get rid of the remain-
ing "bold" notation. We suppose that productivity follows a diffusion process:

                                         dzt = µ(zt )dt + (zt )dWt

In this case, for any (z, m) in the interior of the continuation set, productivity shocks in the interval
[t, t + dt] cannot move the firm towards a region in which it would endogenously separate or exit, when
dt is small enough. In this case, we can write the following, where we have also replaced the Q E set with




                                                     44
the max operator:

           (z, m) = max                Y ( z, m ) - C ( v, z, m )
                       v 0
              Destructions             -  m [  m ( z, m ) - U ]
                 UE Hires              +qv [m (z, m) - U ]
                                                       ¢
                  EE Hires             +qv (1 - )            max      m (z, m) - m (z , m ) , 0 d Hn m , z

                                                                  ( z )2
                    Shocks             + µ ( z )  z ( z, m ) +           zz (z, m)
                                                                   2
                               s.t.

                    No Exit             ( z, m )   + m U

           No Separations               m ( z, m )  U



   To make the notation more comparable, we slightly abuse notation and use the same letters as before,
but now for the continuous workforce case. We obtain finally:

            (z, n) = max                y ( z, n ) - c ( v, z, n )
                        v 0
               Destructions             -  n [  n ( z, n ) - U ]
                    UE Hires            +qv [n (z, n) - U ]
                                                         ¢
                    EE Hires            +qv (1 - )           max n (z, n) - n (z , n ) , 0 d Hn z , n

                                                                   ( z )2
                      Shocks            + µ ( z )  z ( z, n ) +           zz (z, n)
                                                                    2
                                s.t.

                     No Exit            (z, n)   + nU

            No Separations               n ( z, n )  U



When the coalition hits n (z, n) = U , it endogenous separates worker to stay on that frontier. It exits
when it hits the frontier (z, n) =  + nU .
   In addition to these "value-pasting" boundary conditions, optimality implies necessary "smooth-
pasting" boundary conditions (see Stokey 2008): z (z, n) = 0 if the firm actually exits at (z, n) following
productivity shocks, and n (z, n) = 0 if the firm actually exits at (z, n) following changes in size. These


                                                                 45
are necessary and sufficient for the definition of our problem (Brekke Oksendal 1990). Its general formu-
lation terms of optimal switching between three regimes (operation, layoffs, exit) on the entire positive
quadrant, can be made as a system of Hamilton-Jacobi-Bellman-Variational-Inequality (see Pham 2009),
which we present here for completeness :


    max    -  (z, n) + max -n[n (z, n) - U ] + qv [n (z, n) - U ]
                            v 0
                        ¢
                                                                                         ( z )2
           +qv (1 - )       max n (z, n) - n (z , n ) , 0 d Hn z , n + µ(z)z (z, n) +           zz (z, n) ;
                                                                                          2

             + nU - (z, n) ; max (z, k) + (n - k )U - (z, n)         =0    ,    ( z , n )  R2
                                                                                            +
                                  k [0,n]




                                                   46
D       Characterization of surplus function

First define the surplus as S(z, n) = (z, n) - nU . Given that U = b, this implies that S(z, n) =
(z, n) - nb. We also have that Sn (z, n) = n (z, n) - U . Combining these with the Bellman equation
for :

                              S(z, n) = max y(z, n) - c(v, z, n) - nb
                                               v 0
                                          + [ q  v -  n ] Sn ( z, n )
                                                           ¢     Sn ( z,n )
                                          + q (1 -  ) v                       [Sn (z, n) - s]dHn (s)
                                                             0
                                                                      2 ( z )
                                          + µ ( z ) Sz ( z, n ) +             Szz (z, n)
                                                                       2

where we sligtly abuse notation and use Hn (s) to also denote here the employment-weighted cumulative
distribution function of marginal surpluses. The value-pasting conditions become

                                                     S ( z, n )  

                                                     Sn ( z, n )  0

     We now make a number of assumptions to characterize the surplus. They are not all strictly necessary
for each individual comparative static, but for convenience of exposition we present them all at the same
time.

     · The production function y(z, n) satisfies ylog z , yn , ylog z,n > 0 > ynn .

     · Productivity follows a geometric Brownian motion µ(z) = µz and (z) = z.

     · Vacancy costs depend only on v and are isoelastic: c(v) = c0 v1+ .

     · The surplus function is twice continuously differentiable up to the boundary of the continuation
        region.

     We now proceed to show the comparative statics discussed in the main text.

D.1     S is increasing in n

The no-endogenous-separations condition Sn  0 immediately implies that the surplus is increasing in
n.




                                                            47
D.2   S is increasing in z

Re-write the problem in terms of x = log z. Denote with a slight abuse of notation y( x, n) = y(e x , n).
Then, as a function of ( x, n), the joint surplus solves

                                         S( x, n) = max y( x, n) - c(v) - nb
                                                         v 0
                                                    + [ q  v -  n ] Sn ( x , n )
                                                    + q(1 - )vH (Sn ( x, n))
                                                                          2
                                                    + µ-      Sx ( x, n) + Sxx ( x, n)
                                                            2              2
                                                                    ¡s
where we integrated by parts, and denoted H (s) =                      0   Hn (r )dr. Denote  ( x, n) = Sx ( x, n). Differentiate
the Bellman equation w.r.t. x and use the envelope theorem to obtain

                     ( x, n) = y x ( x, n)

                                     +         q(1 - ) Hn (Sn ( x, n)) + q v ( x, n) - n  n ( x, n)
                                                          2
                                     + µ x ( x, n) +         xx ( x, n)
                                                          2

Now consider the stochastic process defined by

                           dxt = µdt + dWt

                           dnt =              q(1 - ) Hn (Sn ( xt , nt )) + q v ( xt , nt ) - nt dt                         (27)

This correponds to the true stochastic process for productivity, but a hypothetical process for employ-
ment, that in general differes from the realized one. We can now use the Feynman-Kac formula (Pham
2009) to go back to the sequential formulation:
                       ¢   T
         ( x, n) = E           e-t y x ( xt , nt ) + e-T  ( x T , n T ) x0 = x, n0 = n, { xt , nt } follows (27)
                       0


and where T is the hitting time of either the separation of exit region. By assumption, y x > 0, so the
contribution of the first part is always positive. On the exit region, smooth-pasting requires that  = 0.
In the interior of the separation region,  = 0. Under our regularity assumption, we thus get  = 0 on
the layoff boundary. Thus,
                                ¢    T
              ( x, n) = E                e-t y x ( xt , nt )dt x0 = x, n0 = n, { xt , nt } follows (27) > 0
                                 0




                                                                  48
which concludes the proof.

D.3     S is concave in n

Denote s(z, n) = Sn (z, n). Differentiate the Bellman equation w.r.t. n on the interior of the domain, use
the envelope theorem and integrate by parts to obtain:

                        (  +  ) s ( z, n ) = y n ( z, n ) - b
                                            +       q + q(1 - ) Hn (s(z, n)) v (z, n) - n]sn (z, n)
                                                                       2 ( z )
                                            + µ ( z ) s z ( z, n ) +           szz (z, n)
                                                                        2

Recall that
                                   (1 + )c0 [v (z, n)] = qs(z, n) + q(1 - )H (s(z, n))

In particular, differentiating w.r.t. n,

                         (1 + )c0 [v (z, n)]-1 vn ( z, n ) = q  + q (1 -  ) Hn ( s ( z, n )) sn ( z, n )


and so
                                           vn ( z, n )    + (1 - ) Hn (s(z, n)) sn (z, n)
                                            
                                                       =
                                           v ( z, n )     + (1 - ) H (s(z, n)) s(z, n)
                     H (s)
where H (s) =         s       1. Now denote  (z, n) = sn (z, n) = Snn (z, n). Differentiate the recursion for s w.r.t.
n to obtain

                  + 2 - q(1 - ) Hn (s(z, n)v (z, n)sn (z, n) - q[ + (1 - ) Hn (s(z, n))vn ( z, n )  ( z, n )


         = ynn (z, n)
         +            + (1 - ) Hn (s(z, n) v (z, n) - n] n (z, n)
                                   2 ( z )
         + µ ( z )  z ( z, n ) +            zz (z, n)
                                    2
Now define the "effective discount rate"

R(z, n, sn (z, n))    =  + 2 - q(1 - ) Hn (s(z, n)v (z, n)sn (z, n) - q[ + (1 - ) Hn (s(z, n))]vn ( z, n )
                                                                         + (1 - ) Hn (s(z, n))  + (1 - ) Hn (s(z, n))
                      =  + 2 - qv (z, n)sn (z, n) (1 - ) Hn (s(z, n)) +
                                                                                 s ( z, n )       + (1 - ) H (s(z, n))
                                                                                             P ( z,n ) >0




                                                                   49
where the second equality uses the expression for vn derived above. Define the stochastic process


                           dzt = µ(zt )dt + (zt )dWt

                         dnt =                        q(1 - ) Hn (Sn (zt , nt )) + q v (zt , nt ) - nt dt                                     (28)

As before, we can use the Feynman-Kac formula to obtain
                                 ¢    T         ¡t                                                ¡T
            ( z, n ) = E                   e-    0   R(z ,n , (z ,n ))d
                                                                          ynn (zt , nt )dt + e-   0    R(z ,n , (z ,n ))d T
                                                                                                                               (z T , n T )
                                  0


                                                                                      z0 = z, n0 = n, {zt , nt } follows (28)


for T the first hitting time of the exit/separation region. The contribution of the first term is always
negative. Note that  enters in the effective discount rate. Inside the separation region and in the exit
regions,  = 0. We restrict attention to twice continuously differentiable functions, so  = 0 on the exit
and separation frontiers. Then
                       ¢     T        ¡t
       ( z, n ) = E              e-    0   R(z ,n , (z ,n ))d
                                                                  ynn (zt , nt )dt z0 = z, n0 = n, {zt , nt } follows (28) < 0
                         0


which concludes the proof.

D.4    S is supermodular in (log z, n)

Denote again s( x, n) = Sn ( x, n), where x = log z. Recall

                    ( + )s( x, n) = yn ( x, n) - b
                                                     +      q + q(1 - ) Hn (s( x, n) v ( x, n) - n]sn ( x, n)
                                                                          2
                                                     + µs x ( x, n) +       s xx ( x, n)
                                                                          2

and that
                                 (1 + )c0 [v ( x, n)] = qs( x, n) + q(1 - )H (s( x, n))

In particular, differentiating w.r.t. x,

                                                vx ( x, n)    + (1 - ) Hn (s( x, n)) s x ( x, n)
                                                 
                                                           =
                                                v ( x, n)     + (1 - ) H (s( x, n)) s( x, n)




                                                                            50
Now denote  ( x, n) = s x ( x, n) = Sxn ( x, n). Differentiate the recursion for s( x, n) w.r.t. x to obtain


                    +  - q(1 - ) Hn (s( x, n)v ( x, n)s x ( x, n) - q[ + (1 - ) Hn (s( x, n))vx ( x, n)  ( x, n)


           = ynx ( x, n)
           +         + (1 - ) Hn (s( x, n) v ( x, n) - n] n ( x, n)
                                2
           + µ x ( x, n) +         xx ( x, n)
                                2
As before, define the "effective discount rate"

R( x, n, s x ( x, n))   =  +  - q(1 - ) Hn (s( x, n)v ( x, n)s x ( x, n) - q[ + (1 - ) Hn (s( x, n))]vx ( x, n)
                                                                              + (1 - ) Hn (s( x, n))  + (1 - ) Hn (s( x, n))
                        =  +  - qv ( x, n)s x ( x, n) (1 - ) Hn (s( x, n)) +
                                                                                     s( x, n)           + (1 - ) H (s( x, n))
                                                                                                                 P ( x ,n ) >0

 where the second equality uses the expression for vn derived above. As before, define the stochastic

process

                              dxt = µdt + dWt

                              dnt =                     q(1 - ) Hn (Sn (e xt , nt )) + q v ( xt , nt ) - nt dt                                       (29)

As before, we can use the Feynman-Kac formula to obtain
                                   ¢     T         ¡t                                                   ¡T
              ( x, n) = E                    e-     0   R( x ,n , ( x ,n ))d
                                                                               ynx ( xt , nt )dt + e-   0    R( x ,n , ( x ,n ))d T
                                                                                                                                       ( xT , nT )
                                     0


                                                                                           x0 = z, n0 = n, { xt , nt } follows (29)


for T the first hitting time of the exit/separation region. The contribution of the first term is always
positive. Inside the separation region and in the exit regions,  = 0. We restrict attention to twice
continuously differentiable functions, so  = 0 on the exit and separation frontiers. Then
                               ¢     T        ¡t
           ( x, n) = E                   e-    0   R( x ,n , ( x ,n ))d
                                                                          ynx ( xt , nt )dt x0 = z, n0 = n, { xt , nt } follows (29)
                                 0


which concludes the proof.




                                                                                 51
D.5   Net employment growth

Net employment growth in the continuation region is

          dnt
                = q  + (1 - ) Hn (Sn (z, n)) v (z, n) -  E (1 - Hv (Sn (z, n)))n - n  g(z, n)
           dt

Using the expression above for v (z, n):

                          q1+1/                                                                    1/
       g ( z, n ) =                  + (1 - ) Hn (Sn (z, n))     Sn (z, n) + (1 - )H (Sn (z, n))
                      [(1 + )c0 ]1/
                      - E (1 - Hv (Sn (z, n)))n - n

From the previous comparative statics on Sn (z, n), it is straightforward to see that g(z, n) is increasing in
log z and decreasing in n.




                                                      52
E      Frictionless limits
E.1     Setup

Frictional problem. Start by recalling the Bellman equation for the joint surplus in the frictional case:

                              S(z, n) = max y(z, n) - nb - c(v) - nSn (z, n)
                                                 v
                                                                        ¢    Sn
                                           + qv Sn + (1 - )                       Hn (s)ds
                                                                         0
                                           + LS
                                   s.t.        S  0, Sn  0

where Hn is the employment-weighted cumulative distribution function of marginal surpluses. L is the
differential operator that encodes the continuation value from productivity shocks. For instance, for a
                                    ( z )2
diffusion, LS = µ(z)Sz (z, n) +      2 Szz ( z, n ).   Recall that  =             u
                                                                             u +  (1- u )
                                                                                            is the probability that a vacancy
meets an unemployed worker, and q is the vacancy meeting rate.
      Note that we abstracted from exogenous separations for simplicity, but endogenous separations
when S(n, z) < 0 still occur: denote by  the aggregate endogenous separation rate.
      Inside the continuation region, the density function h(z, n) of the distribution of firms by productivity
and size is determined by the stationary KFE

                                                     
                                      0 = -            h ( z , n ) g ( z , n ) + L h
                                                     n

where L is the formal adjoint of the operator L, and

                 g(z, n) = qv (z, n)  + (1 - ) Hn (Sn (z, n)) - U n 1 - Hv (Sn (z, n))                                   (30)

is the growth of employment, U is the meeting rate from unemployment, and  the relative search
efficiency of the employed.
      Finally, the mass of entrant firms m0 is determined by the free-entry condition

                                          ce = EEntry [max{S(z, n0 ), 0}]                                                (31)

where EEntry is the expectation operator under the productivity (hence surplus) distribution for entrants.
The surplus is a function of m0 through the vacancy meeting rate q( ), since  is increasing in m0 .




                                                             53
Functional forms.      For ease of exposition, we consider isoelastic vacancy cost functions

                                                      c 0 1+ 
                                            c(v) =        v ,
                                                     1+

and normalize c0 = 1, but the result does not depend on the particular functional form nor on the
normalization. Also, we specialize to a Cobb-Douglas matching function m(s, v) = As  v1-  , where A is
match efficiency, a proxy for labor market frictions.


Comparative statics.      We consider the following limits when match efficiency A  .

  1. No on-the-job-search:  = 0

  2. On-the-job search:  > 0

                                                                                                       B
Notation.     We write B  C when there are two strictly positive numbers r0 , r1 such that 0 < r0      C  r1 ,
                                                                                                           
                                                                                                        1/
as A  +. We write B  C for a first-order Taylor expansion. Denote ||Sn || =              ESteady-state Sn    ,
where ESteady-state denotes the expectation under the steady-state distribution of marginal surpluses, and
is also the Lebesgue 1/-norm of Sn under the steady-state probability measure.

E.2     No on-the-job search

Since  = 0,  = 1. From the FOC for vacancies,
                                                               1/
                                             v (z, n) = qSn         .

using this optimality condition in the value function of hiring firms:

                                                                   1      1
                                                            
                              S(z, n) = y(z, n) - nb +                  1+ 
                                                              · q 1+  S n   + LS
                                                           1+
                                   s.t.     S  0, Sn  0

which now only depends on q as the sole aggregate. Hence, free-entry (31) uniquely pins down q to
the same value irrespectively of A. It follows that the value function always satisfies the same Bellman
equation, irrespectively of A. From the value function, S and Sn converge to finite values throughout the
state space. Hence, throughout the state space, marginal surpluses Sn (z, n) remain identical at a given
pair (z, n) as A varies. Moreover, the endogenous separation rate  always remains finite.
      We now study how aggregates v, u,  evolve along this limiting path. For this, it is useful to note that,
by aggregate feasibility both m0 and v must remain finite, otherwise entry costs and vacancy costs would
blow up.

                                                      54
E.2.1     Aggregates in the limit

Integrating both sides of the FOC for vacancies under the firm distribution, and given the finite mass of
entrant firms, aggregate vacancies are

                                             v = m0 q1/ ||Sn ||1/ ,

which implies that ||Sn || remains finite in the limit. Since the endogenous separation rate  is finite, the
                             
unemployment rate is u       U
                                 =  A-1  -(1- ) . Tightness satisfies

                                        v  m0
                                    =         · A 1-  A1/  - / ||Sn ||1/
                                        u  

so that
                                             1+       m0 1+ 
                                                        A  ||Sn ||1/ .
                                                      
Since m0 , , and ||Sn || are finite,  diverges with A. Therefore, U diverges as well.

E.2.2     Invariant distribution of marginal surpluses

We now turn to the invariant distribution h(z, n). After substituting optimal vacancies into (30) evaluated
at  = 1 -  = 0, one obtains that the growth of employment in the hiring region is:
                                                                1/
                                            g(z, n) = q qSn           .

The only term in the right-hand side ­ hires from unemployment ­ stays constant at finite values through-
out the state space. There are no losses to employment because there is no on-the-job search. Employ-
ment losses arise only when the coalition hits the endogenous separation region or the exit region.
   Hence, the law of motion of employment is independent from A. Thus, the steady-state distribution
h(z, n) is also independent from A, so is the distribution of Sn .

E.2.3     Summary

Summarizing this case: as A  , even though unemployment vanishes, the allocations in the search
model without on-the-job search do not converge to those of a competitive firm-dynamics model. The
free entry condition requires the vacancy meeting rate q to remain finite and thus a non degenerate dis-
persion of marginal products of labor survives even in the limit. In contrast, in the competitive bench-
mark, marginal products of labor are equalized across firms.




                                                        55
E.3     On-the-job search with a fat-tailed entry distribution

We now turn to the case in which on-the-job search remains positive at some fixed value  > 0, and thus
 < 1. We follow the same logic as before, with some additional steps due to on-the-job search. To keep
the arguments manageable, we introduce an additional assumption.
      We require the entry productivity distribution to have a "fat enough" tail. We make the common as-
sumption of an unbounded productivity support for the productivity distribution at entry, and assume
that the production function is such that the optimal frictionless size grows without bound as produc-
tivity becomes large, at rate that is larger than the decay of the entry distribution. More precisely, we
assume that
                                    lim      arg max y(z, n) - bn hEntry (z, n0 ) = +
                                    z+             n

This is satisfied for the production function y(z, n) = zn and the entry distribution hEntry (z, n0 )  z-
                                                    1
in our numerical implementation, when              1-    -   -1. In section E.4 below, we show that we can relax
this assumption if we replace it with a "spousal" or "godfather" shock assumption.
      The value function writes:

                               S(z, n) = max y(z, n) - nb - c(v) + qvR(Sn ) + LS
                                                   v
                                     s.t.       S  0, Sn  0.

where                                                                   ¢    Sn
                                            R ( Sn ) =  Sn + (1 -  )              Hn (s)ds
                                                                         0

is the return to a vacancy. The growth of employment is

                    g(z, n) = qv (z, n) [ + (1 - ) Hn (Sn (z, n))] - U n 1 - Hv (Sn (z, n))


E.3.1    Aggregates in the limit

Because of the employed jobseekers and because vacancies remain finite by aggregate feasibility, market
tightness  remains finite as A  .55 Thus, both q and U diverge with A.
      We restrict attention to the economically meaningful case in which (1) output remains finite and
strictly positive in the limit, and (2) firms remain active on average for a strictly positive time period in
the limit.56 (1) implies that the mass of active firms m0 also remains finite. (2) implies that the rate at which
   55 Strictly speaking, free-entry then ensures that theta is pinned down to a strictly positive value. This proof is more lengthy

but does not require any additional assumptions and is available upon request.
   56 These restrictions can be seen as a guess and verify strategy. Both restrictions will hold in the limiting economy that

obtains.


                                                                56
                                                                                                     
workers separate into unemployment limits to a positive constant . Since u                           U
                                                                                                       ,   the unemployment
rate (as well as ) converges to zero. Moreover, since

                                                   v = m0 q1/ || R (Sn ) ||1/ ,

|| R (Sn ) || goes to zero at the same rate at which A diverges.

E.3.2     Invariant distribution of marginal surpluses

We now show that the distribution of marginal surpluses degenerates to a single value on the support
of the invariant distribution.
   From the KFE equation, the growth of employment inside the continuation region is:
                                                                         1/
                    g(z, n) = q ( + (1 - ) Hn (Sn )) · qR(Sn )                - nU  1 - Hv (Sn (z, n))

Using the expression for v and u in the limit, we obtain that
                                                    1+ 
                                                  q                      1

                                                    U
                                                         -1
                                                        m0  || R(Sn )||-  .
                                                   

Using this expression and recalling that in the limit  = 0 and that v =  ,
                                                                              1/
                                     U       -1                    R ( Sn )
                        g ( z, n )   ·      m0    Hn (Sn )                         -  n 1 - Hv (Sn )       .
                                                                || R(Sn )||

Since U diverges, at the points in the state space that have positive employment in steady state the
bracket must vanish in the limit, i.e.

                                  -1
                                 m0  Hn (Sn ) R(Sn )1/ = n 1 - Hv (Sn ) || R(Sn )||1/

Now suppose for a contradiction that Hn , the cumulative distribution function of Sn , converges point-
                                                 .57 Whenever H  > 0, it must be that R ( S ) > 0, a
wise to a non-degenerate limiting distribution Hn              n                           n

contradiction since the RHS of that expression is always zero. In other words R(Sn ) = 0 on every point
on the state space, which implies that the invariant distribution of marginal surpluses concentrates on a
strip {z, n (z)}z where the limiting marginal surplus is equalized.58 We denote Sn
                                                                                  its common limit.



E.3.3                        on the limiting strip
          Unique value for Sn

                                               . We need to guess the following:
We now characterize the limiting behavior of Sn
  57 So   the probability measure of Sn in the cross-section would converge in distribution to a non-degenerate limit.
  58 We    can argue that it is such a strip using the concavity properties shown in Appendix D.


                                                                57
 ( ) n (z) = arg maxn y(z, n) - bn .

We will verify ( ) below. From the concavity of marginal surplus, we have

                                        S(z, n0 )  S(z, n (z)) + Sn (z, n (z)) × (n0 - n (z))

Now, recall that Sn (z, n (z))  Sn
                                  is equalized in the limit, and so is a constant. Therefore, in the limit,

                                                                                           ,
we obtain an upper bound to the value of entry that involves the limiting marginal suplus Sn
        ¢                                          ¢                                            ¢
                                                                                            
             S ( z, n0 ) h   Entry
                                     (z, n0 )dz        S(z, n (z))h   Entry
                                                                              (z, n0 )dz + Sn       (n0 - n (z))hEntry (z, n0 )dz

                                       > 0. Then, from our assumption on the entry distribution, we
Now suppose for a contradiction that Sn
obtain that                                            ¢
                                                            n (z)hEntry (z, n0 )dz = +.

Therefore, using the previous inequality, we obtain that the value of entry must be negative infinity in
the limit:                                         ¢
                                                           S(z, n0 )hEntry (z, n0 )dz  -,

                                                                                                    = 0.
This arbitrarily large negative value of entry contradicts free-entry. Therefore, it must be that Sn
                                                       reflects that firms are in excess supply relative to
   Intuitively, a strictly positive marginal surplus Sn
the amount of workers. The fat tail assumption then implies that this excess supply translates into a very
negative value of entry, which cannot be an equilibrium in which firms enter freely.

E.3.4   Limiting value function

The value function evaluated on the strip {z, n (z)}z ­ where Sn = 0 in the limit ­ converges to the
solution of

                                     S(z, n (z))  y(z, n (z)) - n (z)b
                                                                   S                2 ( z ) 2 S
                                                       + µ(z)         (z, n (z)) +              (z, n (z))
                                                                   z                 2  z2
                                                              S(z, n (z))  0

where recall that the continuation term vanishes for incumbent firms. We have made explicit the genera-
tor L. Recall that the candidate limiting competitive economy has a value function that depends only on
z. However, the continuation value terms here contain partial derivatives w.r.t. z, not total derivatives.
To argue that it is enough to focus on the value function evaluated on the strip, we must show that the



                                                                        58
partial derivatives approximate the total derivatives in the limit. To see this, compute

                             dS(z, n (z))   S             S             dn (z)
                                          =   (z, n (z)) + (z, n (z)) ·
                                 dz         z             n               dz
                                                            dn (z)
But now recall that    S
                       n ( z, n ( z ))    0. In addition,     dz     stays finite by definition of n (z). Therefore, as
A  ,

                                            dS(z, n (z))  S
                                                            (z, n (z))
                                                dz        z

Therefore, in the limit, the exit behavior of an existing firm can be described by the firm's realized value:

                                          S(z)  S(z, n (z))

                                         S(z) = y(z, n (z)) - n (z)b + LS(z)

                                                    S(z)  0

E.3.5     Optimal size

We now characterize the optimal size of incumbents in the limit and verify ( ). We note that, for a small
period of time dt, away from the exit cutoff and close to the optimal size,

                          S ( z, n )        y(z, n) - bn dt + e-dt E S(zdt , n (zdt )|z0 = z

because the other contributions in n - n (z) scale with ||Sn || = 0. Therefore,

                                          Sn (z, n (z))       yn (z, n (z)) - b dt

and so it must be that yn (z, n (z)) = b. This confirms guess ( ).59

E.3.6     Summary

With on-the-job search, as A  +, the value function converges to the one of the Hopenhayn model.
The mass of active firms converges to some finite value. Free-entry pins down the mass of firms, and
converges to a condition that differs from the Hopenhayn model's. There is an additional term that stems
from the value gains that entrant realize along their (very fast) growth towards their optimal size. The
equilibrating variable is the limiting market tightness, that governs the size of these gains.




  59 To make this argument strictly formal, differentiate the Bellman equation and represent marginal surplus as an integral
with the Feynan-Kac formula as in Appendix D. The derivation details are available upon request.


                                                            59
E.4     On-the-job search with godfather shocks

We can relax the assumption on the entry distribution if we replace it with a "spousal" or "godfather"
shock assumption. The alternative assumption is to assume that, at rate G U , a worker's spouse finds
a job in a different location, forcing the worker to switch firms and accept any job offer. Because these
relocation shocks follow from spouses' job contacts, the rate at which they affect workers scales with the
overall contact rate U .
      We will consider the limit when the fraction of hires from spousal shocks is small, G  0. Formally,
we take A   first, and next G  0. The derivations follow closely those in the previous section (E.3).
      The value function writes:

              S(z, n) = max y(z, n) - nb - c(v)
                              v
                                                ¢    Sn
                                                                          G U (1 - u)
                          + qv Sn + (1 - )                Hn (s)ds +                  Sn     - G U nSn
                                                 0                           qv
                          + LS
                   s.t.     S  0, Sn  0.

Define the return to a vacancy as
                                                      ¢       Sn
                                                                                G U (1 - u)
                           R ( Sn ) =  Sn + (1 -  )                Hn (s)ds +               Sn
                                                          0                        qv

The growth of employment becomes

                                                       G U (1 - u )
g(z, n) = qv (z, n)  + (1 - ) Hn (Sn (z, n)) +                      - U n 1 - Hv (Sn (z, n)) - G U n
                                                          qv

E.4.1    Aggregates in the limit

The same arguments as in section E.3 apply. Because of the employed jobseekers and because vacancies
remain finite by aggregate feasibility, market tightness  remains finite as A  . Thus, both q and U
diverge with A.
      Here too, we restrict attention to the economically meaningful case in which (1) output remains fi-
nite and strictly positive in the limit, and (2) firms remain active on average for a strictly positive time
period in the limit. (1) implies that the mass of active firms m0 also remains finite. (2) implies that the
                                                                                                         
rate at which workers separate into unemployment limits to a positive constant . Since u                 U
                                                                                                           ,   the




                                                               60
unemployment rate (as well as ) converges to zero. Moreover, since

                                                   v = m0 q1/ || R (Sn ) ||1/ ,

|| R (Sn ) || goes to zero at the same rate at which A diverges.

E.4.2     Invariant distribution of marginal surpluses

We now show that the distribution of marginal surpluses degenerates to a single value on the support
of the invariant distribution.
   From the KFE equation, the growth of employment inside the continuation region is:

                                              G  (1 - u)                            1/
 g(z, n) = q  + (1 - ) Hn (Sn ) +                                    · qR(Sn )           - nU  (1 - Hv (Sn (z, n)) + G
                                                  v

Using the expression for v and u in the limit, we again obtain that
                                                  1+ 
                                                  q                                  1
                                                             -1
                                                            m0  || R(Sn )||-  .
                                                   U

Using this expression and recalling that in the limit  = 0 and that v =  ,
                                                                                    1/
                              -1                                         R ( Sn )
               g(z, n)  U ·  m0  Hn (Sn ) + G                                             -  n 1 - Hv (Sn ) + G   .
                                                                      || R(Sn )||

Since U diverges, at the points in the state space that have positive employment in steady state the
bracket must vanish in the limit, i.e.
                                                                      1/
                            -1                            R ( Sn )
                           m0  Hn (Sn ) + G                                = n 1 - Hv (Sn ) + G
                                                       || R(Sn )||

Now consider the limit in which the spousal shocks are small, G  0. Then we obtain
                                                                     1/
                                    -1                R ( Sn )
                                   m0  Hn (Sn )                           = n 1 - Hv (Sn )
                                                   || R(Sn )||

Now suppose for a contradiction that Hn , the cumulative distribution function of Sn , converges point-
                                                 .60 Then || R ( S ) || converges to a non-zero value.
wise to a non-degenerate limiting distribution Hn                 n

Consider a firm at the top of the distribution, such that 1 - Hv (Sn ) = 0. For such firm R(Sn ) > 0. With a
non-degenerate distribution, the left-hand-side cannot be zero in the limit, a contradiction.
   We have again shown that the invariant distribution of marginal surpluses concentrates on a strip


  60 So   the probability measure of Sn in the cross-section would converge in distribution to a non-degenerate limit.


                                                                     61
{z, n (z)}z where the limiting marginal surplus is equalized.61 We denote Sn
                                                                            its common limit. In addi-

tion, to a second order, Sn (z, n (z)) = Sn
                                           + O (G )



E.4.3                        on the limiting strip, and finite value for labor market tightness 
          Unique value for Sn

To pin down labor market tightness, we return to the maximized value. Given that firms jump to their
                                          for each term that corresponds to a jump. We arrive at the
optimal size, we can evaluate R(Sn ) at Sn
following expression62 up to a second order in G ,

                         S(z, n) = y(z, n) - nb
                                                                                     1+ 
                                                                  +  G  (  )
                                                    0 Sn + 0 I0 Sn                    
                                     +                                                      - G ( )n
                                       1+                        
                                     + LS

                
where 0 =        , I0    0 and ( ) = U Sn
                                        .

   For the value of entry to remain finite, it must be that ( ) remains finite as A  +, for any G > 0.
Since ( ) = U Sn
                and U  + , S  0 up to a second order in  G .
                            n

   Using free-entry again, we can now draw two additional conclusions. First, G converges to a
constant as G  0. That constant may be positive, but may also be zero. Denote that constant

                                                  w - b  lim  G  0
                                                              G 0

Define also                                                                       1+ 
                                                              0          w-b       
                                         C f (w,  ) = - lim                             .
                                                         G 0 1 +          
Substituting these definitions into the Bellman equation, we obtain

                                         S(z, n) = y(z, n) - nw - C f + LS .




  61 We   can argue that it is such a strip using the concavity properties shown in Appendix D.
  62 The   details of the derivation are available upon request.


                                                               62
E.4.4   Limiting value function

The value function evaluated on the strip {z, n (z)}z ­ where Sn = 0 in the limit ­ converges to the
solution of

                          S(z, n (z))  y(z, n (z)) - n (z)w - C f
                                                      S                2 ( z ) 2 S
                                             + µ(z)      (z, n (z)) +              (z, n (z))
                                                      z                 2  z2
                                                 S(z, n (z))  0

where recall that the continuation term vanishes for incumbent firms. We have made explicit the genera-
tor L. Recall that the candidate limiting competitive economy has a value function that depends only on
z. However, the continuation value terms here contain partial derivatives w.r.t. z, not total derivatives.
To argue that it is enough to focus on the value function evaluated on the strip, we must show that the
partial derivatives approximate the total derivatives in the limit. To see this, compute

                           dS(z, n (z))   S             S             dn (z)
                                        =   (z, n (z)) + (z, n (z)) ·
                               dz         z             n               dz
                                                           dn (z)
But now recall that   S
                      n ( z, n ( z ))    0. In addition,     dz     stays finite by definition of n (z). Therefore, as
A  ,

                                           dS(z, n (z))  S
                                                           (z, n (z))
                                               dz        z

Therefore, in the limit, the exit behavior of an existing firm can be described by the firm's realized value:

                                   S(z)  S(z, n (z))

                                 S(z) = y(z, n (z)) - n (z)w - C f + LS(z)

                                                S(z)  0

E.4.5   Optimal size

We now characterize the optimal size of incumbents in the limit. We note that, for a small period of time
dt, away from the exit cutoff and close to the optimal size,

                        S ( z, n )         y(z, n) - wn dt + e-dt E S(zdt , n (zdt )|z0 = z

because the other contributions in n - n (z) scale with ||Sn || = 0. Therefore,

                                        Sn (z, n (z))       yn (z, n (z)) - w dt


                                                           63
and so it must be that yn (z, n (z)) = w.

E.4.6   Summary

With on-the-job search, as A  +, the value function converges to one of the Hopenhayn model, and
a wage w  b. The mass of active firms converges to some finite value. Free-entry pins down the mass
of firms, and converges to a condition that differs from the Hopenhayn model's. There is an additional
term that stems from the value gains that entrant realize along their (very fast) growth towards their
optimal size.
                                                                                               very
   The presence of godfather shocks requires coalitions to pay the limiting marginal surplus Sn
frequently as they hire (or lose) many workers each instant. This extra value spending reduces the
                                  goes to zero in the limit, but coalitions must pay this small cost more
optimal size of a coalition. As Sn
and more frequently, the total cost per worker stays finite. As a result, the frictionless limit resembles
the Hopenhayn economy, but with an endogenous cost of labor that reflects marginal surplus spending
by coalitions. This endogenous cost of labor plays the role of a limiting wage. Similarly, part of that
marginal surplus spending results in an endogenous contribution to the fixed cost.




                                                   64
F    Algorithm

Recall that the problem facing the coalition is to optimally separate, exit and post vacancies such as to
maximize the joint coalition value,

      (z, n) = max                y ( z, n ) -  n [  n ( z, n ) - U ]                                           (32)
                       v 0
                                                               ¢
                  + q  [  n ( z, n ) - U ] + (1 -  )                 max n (n, z) - n n , z , 0 dHn n , z   v

                  - c ( v, n )
                                                2 ( z )
                  + µ ( z )  z ( z, n ) +               zz (z, n)
                                                 2
           s.t.

       (z, n)  nU + 

       n ( z, n )  U

    We can rewrite the term under the integral sign in (32) to integrate directly over n = n (n , z )
                                    ¢    n ( n,z )
                                                     [n (n, z) - U ] - n - U dHn n
                                      U

where we used the fact that the lower bound of the support must be U , since n  U and the upper
bound is given by the fact that a firm only hires if n  n (n, z), and we added and subtracted U in the
integrand. Since n  [U , n (n, z)] implies n - U  [0, n (n, z) - U ], we can integrate over n - U
and adjust the bounds
                             ¢     n ( n , z ) -U
                                                    [n (n, z) - U ] - n - U dHn n - U
                              0




                                                                    65
   We can hence restate the problem (32) as

 (z, n) = max                    y ( z, n ) -  n [  n ( z, n ) - U ]                                                                                                            (33)
                         v 0
                                                                      ¢         n ( n , z ) -U
                  + q  [  n ( z, n ) - U ] + (1 -  )                                             [n (n, z) - U ] - n - U dHn n - U                                              v
                                                                           0

                  - c ( v, n )
                                                       2 ( z )
                  + µ ( z )  z ( z, n ) +                      zz (z, n)
                                                        2
       s.t.

   (z, n)  nU + 

   n ( z, n )  U

   Let S (z, n) be the surplus of the coalition, S (z, n) =  (z, n) - nU . Note that Sz (z, n) = z (z, n),
Szz (z, n) = zz (z, n) and Sn (z, n) = n (z, n) - U . Substituting this in problem (33),

                         S (z, n) = max                       y (z, n) - nSn (z, n)
                                                   v 0
                                                                                         ¢     Sn ( z,n )
                                           + q  Sn ( z, n ) + (1 -  )                                       Sn (z, n) - Sn dHn Sn                                   v
                                                                                           0

                                           - c ( v, n )
                                                                           2 ( z )
                                           + µ ( z ) Sz ( z, n ) +                 Szz (z, n) - nU
                                                                            2
                               s.t.

                          S ( z, n )  

                         Sn ( z, n )  0

   Integrate by parts the expected value of a vacancy conditional on meeting an employed worker
      ¢    Sn ( z,n )                                                                                                            Sn ( z,n )        ¢   Sn ( z,n )
                        Sn (z, n) - Sn dHn Sn                    =     Sn (z, n) - Sn Hn Sn                                                    +                    Hn Sn dSn
       0                                                                                                                         0                 0
                                                                 = [Sn (z, n) - Sn (z, n)] Hn (Sn (z, n))
                                                                                                                             ¢    Sn ( z,n )
                                                                 - [Sn (z, n) - 0] Hn (0) +                                                    Hn Sn dSn
                                                                                                                             0

The second term on the second line is equal to zero since the constraint on the firms' problem Sn (z, n)  0
implies that the distribution of marginal surpluses at other firms must also be zero at zero
                                 ¢        Sn ( z,n )                                                   ¢        Sn ( z,n )
                                                        Sn (z, n) - Sn dHn Sn =                                              Hn Sn dSn
                                      0                                                                     0



                                                                                    66
                                                                                         ¡x
Recall that we defined H ( x ) as the integral of the cdf Hn : H ( x ) =                  0   Hn (u) du
                              ¢     Sn ( z,n )
                                                  Sn (z, n) - Sn dHn Sn = H (Sn (z, n))
                                0

Substituting this into the Bellman equation

                             S (z, n) = max                      y (z, n) - nSn (z, n)
                                                       v 0
                                                  + q [Sn (z, n) + (1 - ) H (Sn (z, n))] v
                                                  - c ( v, n )
                                                                            2 ( z )
                                                  + µ ( z ) Sz ( z, n ) +           Szz (z, n) - nU
                                                                             2
                                       s.t.

                              S ( z, n )  0

                             Sn ( z, n )  0

                                                                                v
   We assume that the vacancy cost satisfies c (v, n) = c                       n    v, where c is iso-elastic with elasticity .
Define the function H ( x ) by H ( x ) = q [ x + (1 - ) H ( x )]. Substituting this into problem (33)

                             S (z, n) = max                      y (z, n) - nSn (z, n)
                                                        v 0
                                                  + H (Sn (z, n)) v - c (v, n)
                                                                          2 ( z )
                                                  + µ ( z ) Sz ( z, n ) +         Szz (z, n) - nU
                                                                           2
                                                                                 v
Since c (v/n) is iso-elastic in (v/n), cv (v, n) = ( + 1) c                      n   .63 Along with the first order condition
cv (v, n) = H (Sn (z, n)), this implies

                                                 v    1                   1
                        c ( v, n ) = c             v=    c v ( v, n ) v =    H (Sn (z, n)) v
                                                 n    +1                  +1

Therefore the total value of vacancy posting is

                                                         
                            H (Sn (z, n)) v - c (v, n) =    H (Sn (z, n)) v
                                                         +1
                                                                            v
                            H (Sn (z, n)) v - c (v, n) =    H (Sn (z, n))     n
                                                         +1                 n




  63
                                                       v           c v
                                              cv = c     +c =          + 1 c = (  + 1) c
                                                       n           c n



                                                                    67
             v             v                   v         1
                                                         +1 H ( S n
                      
Letting c    n   =   1+    n    and using c    n    =                      (z, n)) then

                                                   v                      1
                                                     =  -1/ H (Sn (z, n)) 
                                                   n

and                                                                             1
                                                                -                +1
                                  H (Sn (z, n)) v - c (v, n) =     H (Sn (z, n))  n
                                                               +1
Substituting this into the Bellman equation

                                 S (z, n) = y (z, n) - nSn (z, n)
                                                            1
                                                 -                         +1
                                              +          H (Sn (z, n))  n
                                                +1
                                                                      2 ( z )
                                              + µ ( z ) Sz ( z, n ) +         Szz (z, n) - nU
                                                                       2

Collecting terms and recognizing that U = b,

                                S (z, n) = y (z, n) - bn                                                      (34)
                                                         1                           +1
                                                        -
                                                     H (Sn (z, n))                   
                                          +                                               -  Sn ( z, n ) n
                                                    +1  Sn ( z, n )
                                                                            2 ( z )
                                          + µ ( z ) Sz ( z, n ) +                   Szz (z, n)
                                                                             2

subject to

                                     S ( z, n )  0

                                    Sn ( z, n )  0

                                H (Sn (z, n)) = q [Sn (z, n) + (1 - ) H (Sn (z, n))]
                                                      ¢     Sn ( z,n )
                                H (Sn (z, n)) =                          Hn (s) ds
                                                        0


F.1   Algorithm

The algorithm consists of three steps, implemented in MATLAB called from master file MAIN.m.


Step 0: Construct an initial guess.        Start by constructing a nz × nn grid for log productivity and log size.
Let  = y(z, n) - bn denote the stacked (nz  nn ) × 1 vector of flow payoffs on this grid. Guess an initial
surplus S0 on this grid (a (nz  nn ) × 1 column vector); a distribution of firms over productivity and size
h0 (a (nz  nn ) × 1 column vector); aggregate finding rates q0 and 0 ; and an efficiency-weighted share of



                                                                     68
unemployed searchers,  0 . Construct marginal surplus. Construct exit regions, separation regions and
the vacancy policy. File InitialGuess.m does this.


Step I: Iterate to convergence the coalition's problem for given aggregate states. For t  1, given
qt-1 ,  t-1 , ht-1 and St-1 , solve the coalition's problem to update the coalition value to St . The solution
to the coalition's surplus function is obtained in an inner iteration  . Denote by St, the surplus in outer
iteration t during inner iteration  , initiated with St,0 = St ; Tn (z, n) a (nz  nn ) × (nz  nn ) matrix such that
 t,                         t,
Sn  = Tn (z, n)St, , where Sn  is the stacked (nz  nn ) × 1 vector of derivatives of S w.r.t. n during outer
                                                                                t,                   t,
iteration t and inner iteration  ; Tz a (nz  nn ) × (nz  nn ) matrix such that Sz  = Tz St, , where Sz  is the
stacked (nz  nn ) × 1 vector of derivatives of S w.r.t. z during outer iteration t and inner iteration  ; and
                                              t,                    t,
Tzz a (nz  nn ) × (nz  nn ) matrix such that Szz = Tzz St, , where Szz is the stacked (nz  nn ) × 1 vector of
second derivatives of S w.r.t. z during outer iteration t and inner iteration  . Note that the matrix Tn (z, n)
depends on (z, n) in the sense that the approximation is done either forward or backward depending on
the endogenous drift for n at (z, n) (note that the drift of and innovations to z are independent of (z, n)).
Within each outer iteration t, we iteratively update St-1, for   1 following equation (34) based on
                                             +1
                                                                                  
                          1      t-1, -1     
                     H   -      Sn                                             2
      + 1                                                                                          1 t-1, -1
                                                                                      t-1,
                1-                                - 1
                                                     
                                                      .  Tn ( z , n ) - µ Tz -   Tzz S       = +    S
                  +1              t-1, -1
                                 Sn                                            2                   
                                                                                                   +1
                                                                          t-1, -1                          t-1, -1
where  is the step size, . denotes the element-by-element product, and H Sn
                                                                                                   
                                                                                                        / Sn       is
a (nz  nn ) × (nz  nn ) matrix constructed using the previous iteration's derivative of S stacked (nz 
nn ) times in the column dimension. The step size cannot be too large for the problem to converge.
These iterations are performed by iterating on  until convergence by file IndividualBehavior.m, and
the solution is assigned as the updated St . We also obtain from the converged solution the updated
separation, exit and a vacancy policies.


Step II: Iterate to convergence the aggregate states for given individual behavior.              Given updated
individual behavior in outer iteration t, obtain through iteration in an inner loop  the distribution of
firms ht , the aggregate meeting rates qt and t , the share of unemployed searchers  t , the distribution
                                  t , and the distribution of vacancies over marginal surplus H t . File
of workers over marginal surplus Hn                                                            v

AggregateBehavior.m proceeds to do this in four steps.
   Initiate each aggregate object with the previous outer iteration solution, xt-1,0 = xt-1 . Then:
                                                                           t-1,
   Step II-a. Update the distribution of workers over marginal surplus to Hn    given a distribution of
firms ht-1, -1 and marginal surplus Sn
                                     t , where the latter was obtained in Step I above. This is done by




                                                           69
file CdfG.m.
                                                                             t-1,
      Step II-b. Update the distribution of vacancies over marginal surplus Hv    given a distribution of
firms ht-1, -1 , the vacancy policy vt and the ranking of firms in marginal surplus space. This is done by
file CdfF.m.
      Step II-c. Update the finding rates qt-1, , t-1, and  t-1, that is consistent with the vacancy policy vt
and the distribution of firms ht-1, -1 . This is done by file HazardRates.m.
                        t-1,    t-1, t-1,
      Step II-d. Given Hn    , Hv   ,q    , t-1, and  t-1, , update the distribution of firms ht-1, follow-
ing the Kolmogorov forward equation in steady-state. This is executed by file Distribution.m.
      Iterate over the four sub-steps Step II-a­Step II-d until convergence and assign the updated aggregate
states qt , t ,  t and ht . We subsequently return to step Step I and iterate on step Step I­Step II until both
the surplus function and the aggregate states have converged.

F.2     Estimation

The criterion function that we minimize is highly-dimensional and potentially has many local minima.
Furthermore, the equilibrium does not exist for some regions of the parameter space. For example, if
the drift in productivity is not sufficiently negative, there is no ergodic distribution for productivity.
For these reasons, using a sequential hill-climbing optimizer that updates its initial guess sequentially
through a gradient-based method is prohibitive. Our solution is to use an algorithm that we can easily
parallelize, that efficiently explores the parameter space, and for which we can ignore cases with no
equilibrium.
      We set up a hyper-cube in the parameter space and then initialize a Sobol sequence to explore it.
A Sobol sequence is a quasi-random low-discrepancy sequence that maintains a maximum dispersion
in each dimension and far outperforms standard random number generators. We then partition the
sequence and submit each partition to a separate CPU on a high performance computer (HPC). From
each evaluation of the parameter hyper-cube, we save the vector of model moments. We then collect
them, splice them all together, and choose the one that minimizes the criterion function. Starting with
wide bounds on the parameters, we run this procedure a number of times, shrinking the hyper-cube step
by step until we achieve the global minimum.
      Compared to standard optimizers, this procedure has the advantage that, as a byproduct of the esti-
mation, we can learn a lot about model identification. From an optimizer one may retrieve the moments
of the model only along the path of the parameter vector chosen by the algorithm. In our case, we retrieve
tens of thousands of evaluations, knowing that the low-discrepancy property of the Sobol sequence im-
plies that for an interval of any one parameter, the remaining parameters are drawn uniformly. Plotting

                                                       70
each single moment against parameters therefore shows the effect of a parameter on a certain moment,
conditional on local draws of all other parameters.




                                                      71
