                                 NBER WORKING PAPER SERIES




               A GENERAL STOCHASTIC VOLATILITY MODEL FOR THE
            PRICING AND FORECASTING OF INTEREST RATE DERIVATIVES

                                          Anders B. Trolle
                                         Eduardo S. Schwartz

                                         Working Paper 12337
                                 http://www.nber.org/papers/w12337


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       June 2006




We thank Francis Longstaff and seminar participants at UCLA Anderson School of Management for
comments. Eduardo Schwartz: UCLA Anderson School of Management, 110 Westwood Plaza, Los Angeles,
CA 90095-1481. E-mail: eduardo.schwartz@anderson.ucla.edu. Anders Trolle: Copenhagen Business
School, Solbjerg Plads 3, A5, DK-2000 Frederiksberg, Denmark. E-mail: abt.fi@cbs.dk. The views
expressed herein are those of the author(s) and do not necessarily reflect the views of the National Bureau
of Economic Research.

©2006 by Anders B. Trolle and Eduardo S. Schwartz. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
A General Stochastic Volatility Model for the Pricing and Forecasting of Interest Rate
Derivatives
Anders B. Trolle and Eduardo S. Schwartz
NBER Working Paper No. 12337
June 2006
JEL No. E43, G13

                                           ABSTRACT

We develop a tractable and flexible stochastic volatility multi-factor model of the term structure of
interest rates. It features correlations between innovations to forward rates and volatilities,
quasi-analytical prices of zero-coupon bond options and dynamics of the forward rate curve, under
both the actual and risk-neutral measure, in terms of a finite-dimensional affine state vector. The
model has a very good fit to an extensive panel data set of interest rates, swaptions and caps. In
particular, the model matches the implied cap skews and the dynamics of implied volatilities. The
model also performs well in forecasting interest rates and derivatives.

Anders B. Trolle
Copenhagen Business School
Solbjerg Plads 3, A5
DK-2000 Frederiksberg
DENMARK
abt.fi@cbs.dk

Eduardo S. Schwartz
UCLA Anderson School of Mangement
110 Westwood Plaza
Los Angeles, CA 90095-1481
and NBER
eduardo.schwartz@anderson.ucla.edu
1    Introduction

In this paper we develop a stochastic volatility multi-factor model of the term structure of
interest rates based on the Heath, Jarrow, and Morton (1992) (HJM, henceforth) framework.
The model has N factors driving the forward rate curve with each factor exhibiting stochastic
volatility. The model allows for hump-shaped innovations to the forward rate curve. It also
allows for correlations between innovations to forward rates and stochastic volatility which
implies that the model has N × 2 factors driving interest rate derivatives, except if correlations
are perfect. The model has quasi-analytical zero-coupon bond option (and therefore cap) prices
based on transform techniques, while coupon bond option (and therefore swaption) prices can
be obtained using well known and accurate approximations. In our model the dynamics of
the forward rate curve under the risk neutral measure can be described in terms of a finite
number of state variables which jointly follow an affine diffusion process. This facilitates
pricing of more complex interest rate derivatives by Monte Carlo simulations. We apply the
flexible “extended affine” market price of risk specification developed by Cheredito, Filipovic,
and Kimmel (2003). This implies that the state vector also follows an affine diffusion process
under the actual measure which facilitates econometric estimation.
    We estimate the model for N = 1, 2 and 3 using an extensive panel data set consisting
of 7 years of weekly observations of LIBOR and swap rates, at-the-money-forward (ATMF,
henceforth) swaptions, ATMF caps and, for the second half of the sample, non-ATMF caps
(i.e. cap skews). To our knowledge this is the most extensive data set, in terms of the
range of instruments included, that has been used in the empirical term structure literature to
date. The estimation procedure is quasi maximum likelihood in conjunction with the extended
Kalman filter.
    The empirical part contains a number of contributions. Firstly, we show that for N =3
the model has a very good fit to both interest rates and interest rate derivatives. This is
consistent with principal component analyses which show that three factors are necessary to
capture the variation in the term structure (see e.g. Litterman and Scheinkman (1991)), and
that a number of additional factors unrelated to the term structure are needed to explain
the variation in ATMF swaptions (Heidari and Wu (2003)), ATMF caps (Collin-Dufresne
and Goldstein (2002a)) and non-ATMF caps (Li and Zhao (2006)). It is also consistent with
Andersen and Benzoni (2005) who show that realized interest rate volatility is driven by




                                                1
multiple unspanned factors.1
       Secondly, we address the relative valuation of swaptions and caps by re-estimating the N =3
model separately on swaptions and caps, and pricing caps and swaptions out-of-sample. We
find that, according to our model, swaptions were mostly undervalued relative to caps during
the first third of the sample. However, since then swaption and cap prices appear largely
consistent with each other.
       Thirdly, we highlight the importance of incorporating correlations between innovations to
the term structure and the volatility factors. In the data we observe downward sloping cap
skews in terms of log-normal implied volatilities with low strike, in-the-money caps trading
at higher log-normal implied volatilities than high strike, out-of-the-money caps. We also
observe that changes in log-normal implied volatilities are moderately negatively correlated
with changes in the underlying forward rates, while changes in normal implied volatilities
for swaptions and caps are moderately positively correlated with changes in the underlying
forward rates.2 In our model both the steepness of the implied cap skews and the dynamics
of implied volatilities depend critically on the correlation parameters and the model is able to
match both features of the data accurately. The fact that the correlation parameters which
are consistent with implied volatilities across moneyness are also consistent with the dynamics
of implied volatilities across time provides strong support for a correlation-based explanation
for the implied cap skews.
       Fourthly, as part of the estimation we obtain estimates of the market prices of risk associ-
ated with both the term structure factors and the volatility factors. This in turn facilitates use
of the model for forecasting interest rates and interest rate derivatives in a consistent fashion.
We show that our model performs well in this respect, especially at longer horizons. Crucial
to this positive result is our use of the “extended affine” market price of risk specification. To
our knowledge, this is the first paper that documents the ability of dynamic term structure
   1
       They analyze the US Treasury market, but their analysis most likely also holds for the LIBOR and swap
markets due to the very high correlation between Treasury rates and LIBOR/swap rates of similar maturities.
   2
       In this paper the term “log-normal implied volatility” is the volatility parameter which, plugged into the
log-normal (or Black (1976)) pricing formula, matches a given price. The term “normal implied volatility” is
the volatility parameter which, plugged into the normal pricing formula, matches a given price. For ATMF
swaptions or caplets, the relation between the two is approximately given by σN = σLN F (t, T ), where σN is the

                                                                                           pF (t, T )K, where K
normal implied volatility, σLN is the log-normal implied volatility and F (t, T ) is the underlying forward rate.
For non-ATMF swaptions and caplets the relation is approximately given by σN = σLN
is the the strike. See Blyth and Uglum (1999) and Zhou (2003).



                                                         2
models to forecast interest rate derivatives.3
       Our model is related to the stochastic volatility LIBOR market models of Han (2004)
and Jarrow, Li, and Zhao (2004). Han (2004) estimates his model on swaptions data, while
Jarrow, Li, and Zhao (2004) estimate their model on cap skew data. In their models, condi-
tional on the volatility factors, forward LIBOR rates are log-normally distributed, and forward
swap rates are approximately log-normally distributed (under the appropriate forward mea-
sures). In contrast, in our model, conditional on the volatility factors, forward LIBOR and
swap rates are approximately normally distributed (under the appropriate forward measures).
More importantly, they impose zero correlations between innovations to forward LIBOR rates
and volatility factors. The zero-correlation assumption implies that the forward LIBOR rate
distributions have fatter tails than the log-normal distribution, and their models predict im-
plied volatility smiles rather than the implied volatility skews that we observe.4 To capture
the implied skews, Jarrow, Li, and Zhao (2004) add jumps with large negative mean jump
sizes to the forward rate processes. The problem with the jump-based explanation for the
implied cap skews, however, is that in the data we do not observe jumps even close to the
magnitude necessary to fit the skews.5 Furthermore, the zero-correlation assumption implies
that their models counter-factually predict that changes in log-normal implied volatilities are
close to uncorrelated with changes in the underlying forward rates.6 It might seem logical,
then, to extend the stochastic volatility LIBOR market model to non-zero correlations between
innovations to forward LIBOR rates and stochastic volatility. Unfortunately, such a model is
   3
       Cheredito, Filipovic, and Kimmel (2003) show that stochastic volatility term structure models with “ex-
tended affine” market price of risk specifications performs well in terms of forecasting interest rates. Collin-
Dufresne, Goldstein, and Jones (2003) show that they also perform well in terms of forecasting realized volatil-
ities. Neither study discuss interest rate derivatives.
   4
       In contrast, in our model, a zero correlation assumption would imply that the forward LIBOR rate dis-
tributions have fatter tails than the normal distribution and the model would predict very steep log-normal
implied skews – steeper than observed in the data.
   5
       Jarrow, Li, and Zhao (2004) argue that this could be due to extremely large jump risk premia, but the size
of these risk premia seems implausible.
   6
       In Han (2004)’s analysis this problem with the zero-correlation assumption is not apparent since his data
set covers a period where interest rates were fairly stable. In contrast, Jarrow, Li, and Zhao (2004) report that
the state variable that drives most of the stochastic volatility is strongly negatively correlated with interest rates
despite the zero correlation assumption in their model. Note that in our model, a zero correlation assumption
would imply that changes in normal implied volatilities were close to uncorrelated with changes in the underlying
forward rates.



                                                          3
intractable.7 The ease with which we can incorporate non-zero correlations is one reason we
prefer to work with instantaneous forward rates within the HJM framework. Another reason
is the ability to obtain a finite dimensional affine model of the evolution of the forward rate
curve.
       Our model is also related to Casassus, Collin-Dufresne, and Goldstein (2005), who develop
a stochastic volatility Hull and White (1990) model, which is a special case of our model.
Using implied cap skew data on a single date, they also document the importance of allowing
for non-zero correlation between innovations to forward rates and stochastic volatility.8
       Other papers which use interest rate derivatives for estimating dynamic term structure
models include Umantsev (2001), who use swaptions, and Bikbov and Chernov (2004), who
use options on Eurodollar futures. These papers estimate traditional three-factor affine models
which do not have sufficient flexibility to match the extensive data set used in this paper.
Furthermore, in these models it is very difficult to generate “unspanned stochastic volatility”
which arises naturally in our model.9
       The paper is structured as follows. Section 2 sets up a general stochastic volatility term
structure model. Section 3 discusses the data and the estimation procedure. Section 4 discusses
the models’ fit to the term structure and derivatives and the relative valuation of swaptions
and caps. Section 5 highlights the role of the correlation parameters in matching the implied
cap skews and the dynamics of implied volatilities. Section 6 discusses the models’ forecasts
of the term structure and derivatives. Section 7 concludes.
   7
       The reason why non-zero correlation undermines the tractability of a stochastic volatility LIBOR market
model is that the dynamics of the volatility process becomes dependent on forward rates under the forward
measure. See Wu and Zhang (2005) for more on this and the approximations necessary to retain analytical
tractability, even with non-zero correlation.
   8
       Andersen and Brotherton-Ratciffe (2005) develop a CEV-type LIBOR market model with stochastic volatil-
ity that also has zero correlations between innovations to forward rates and volatility factors. Pricing of caps
and swaptions relies on a number of fairly involved approximations, and they make no attempt to test their
model on a panel data set of interest rate derivatives.
   9
       See Collin-Dufresne and Goldstein (2002a) for the parameter restrictions that are necessary in order for
traditional three-factor affine models to exhibit “unspanned stochastic volatility”.




                                                          4
2     A general stochastic volatility term structure model

2.1   The model under the risk-neutral measure

Let f (t, T ) denote the time-t instantaneous forward interest rate for risk-free borrowing and
lending at time T . We model the forward rate dynamics as
                                         N
                                         X                 p
           df (t, T ) = µf (t, T )dt +         σf,i (t, T ) vi (t)dWiQ (t)                        (1)
                                         i=1
                                                                          q                
                                                   p
             dvi (t) = κi (θi − vi (t))dt + σi         vi (t) ρi dWiQ (t) + 1 − ρ2i dZiQ (t) ,    (2)


i = 1, ..., N , where WiQ (t) and ZiQ (t) denote independent standard Wiener processes under
the risk-neutral measure Q. The model differs from traditional HJM models by incorporating
stochastic volatility, which is imperfectly correlated with forward rates. The model has N
factors driving the forward rate curve and N × 2 factors driving interest rate derivatives,
and the model features some degree of “unspanned stochastic volatility” by construction,
except in the special cases ρ = −1 or ρ = 1. For N =1, the model can be seen as the fixed
income counterpart to the Heston (1993) model, which has been used extensively in the equity
derivative literature.
    Heath, Jarrow, and Morton (1992) show that absence of arbitrage implies that the drift
term in (1) is given by
                                          N
                                          X                          Z       T
                          µf (t, T ) =          vi (t)σf,i (t, T )               σf,i (t, u)du.   (3)
                                          i=1                            t


Hence, the dynamics of f (t, T ) under the risk-neutral probability measure is completely deter-
mined by the initial forward rate curve, the forward rate volatility functions and the volatility
state variables.
    To keep the model flexible yet analytically tractable, we specify the forward rate volatility
functions σf,i (t, T ) in the following time-homogeneous way

                           σf,i (t, T ) = (α0,i + α1,i (T − t))e−γi (T −t) .                      (4)

This specification nests a number of interesting special cases. With N =1 and α1,1 = 0, we
get the stochastic volatility version of the Hull and White (1990) model analyzed by Casassus,
Collin-Dufresne, and Goldstein (2005). When also γ1 = 0 we obtain a stochastic volatility
version of the continuous-time Ho and Lee (1986) model.

                                                       5
   Note that α0,i , α1,i , θi and σi are not simultaneously identified, see e.g. the discussion
of invariant affine transformations in Dai and Singleton (2000). In our empirical analysis we
normalize θi to one to achieve identification.
   In the following proposition we show that the dynamics of the forward curve can be de-
scribed in terms of a finite number of state variables which jointly follow an affine diffusion pro-
cess. This extends the results in Ritchkin and Chuang (1999) and Chiarella and Kwon (2003)
to a stochastic volatility setting.

Proposition 1 The time-t instantaneous forward interest rate for risk-free borrowing and
lending at time T , f (t, T ), is given by
                                       N
                                       X                           N X
                                                                   X 6
             f (t, T ) = f (0, T ) +         Bxi (T − t)xi (t) +             Bφj,i (T − t)φj,i (t),    (5)
                                       i=1                         i=1 j=1

where

           Bxi (τ ) = (α0i + α1i τ )e−γi τ                                                             (6)

         Bφ1,i (τ ) = α1i e−γi τ                                                                       (7)
                                       
                      α1i 1         α0i
         Bφ2,i (τ ) =            +        (α0i + α1i τ )e−γi τ                                         (8)
                       γi γi α1i
                                                                           
                           α0i α1i 1       α0i       α1i α1i              α21i 2 −2γi τ
         Bφ3,i (τ ) = −                  +         +           + 2α0i τ +     τ e                      (9)
                             γi       γi α1i         γi     γi            γi
                                       
                      α21i 1        α0i
         Bφ4,i (τ ) =            +        e−γi τ                                                      (10)
                       γi γi α1i
                                                    
                        α1i α1i
         Bφ5,i (τ ) = −             + 2α0i + 2α1i τ e−2γi τ                                           (11)
                         γi      γi
                        α2
         Bφ6,i (τ ) = − 1i e−2γi τ                                                                    (12)
                         γi
and the state variables evolve according to
                                                            p
                              dxi (t) = −γi xi (t)dt +          vi (t)dWiQ (t)                        (13)

                             dφ1,i (t) = (xi (t) − γi φ1,i (t))dt                                     (14)

                             dφ2,i (t) = (vi (t) − γi φ2,i (t))dt                                     (15)

                             dφ3,i (t) = (vi (t) − 2γi φ3,i (t))dt                                    (16)

                             dφ4,i (t) = (φ2,i (t) − γi φ4,i (t))dt                                   (17)

                             dφ5,i (t) = (φ3,i (t) − 2γi φ5,i (t))dt                                  (18)

                             dφ6,i (t) = (2φ5,i (t) − 2γi φ6,i (t))dt,                                (19)

                                                     6
subject to xi (0) = φ1,i (0) = ... = φ6,i (0) = 0.

Proof: See Appendix A.
The dynamics of the forward curve depends on N × 8 state variables but there are only N × 2
sources of risk, as there are no stochastic terms in the φ1,i (t),...,φ6,i (t) processes. These are
“auxiliary” state variables which simply reflect the path information of xi (t) and vi (t). The
model falls within the affine class of dynamic term structure models of Duffie and Kan (1996)
and inherits all the nice analytical features of that class. The model is time-inhomogeneous,
as the dynamics of the forward rate curve depends on the initial forward rate curve. In section
3 we make the model time-homogeneous for the purpose of econometric estimation.


2.2     Prices of zero-coupon bonds and bond options

The time-t price of a zero-coupon bond maturing at time T , P (t, T ), is given by
                            Z T                
        P (t, T ) ≡ exp −            f (t, u)du
                                  t
                                                                                        
                       P (0, T )       XN                      N X
                                                                X 6                      
                  =              exp        Bxi (T − t)xi (t) +     Bφj,i (T − t)φj,i (t)        (20)
                       P (0, t)                                                         
                                        i=1                    i=1 j=1

where
                                                            
                α1i     1      α0i      −γi τ
                                                        −γi τ
 Bxi (τ ) =                +           e      − 1 + τe                                            (21)
                γi      γi α1i
                α1i −γi τ       
Bφ1,i (τ ) =          e    −1                                                                     (22)
                γi
                                                                          
                  α1i 2 1         α0i         1     α0i     −γi τ
                                                                          −γi τ
Bφ2,i (τ ) =                   +                 +        e       − 1 + τe                        (23)
                  γi       γi α1i             γi α1i
                                                                                                
                  α1i     α1i      α0i      α20i     −2γτ            α1i           −2γτ   α1i 2 −2γτ
Bφ3,i (τ ) =    − 2             +       +          (e     − 1) +         + α0i τ e      +    τ e (24)
                  γi      2γ 2      γ      2α1i                       γ                    2
                                   
                  α1i 2 1         α0i                
Bφ4,i (τ ) =                   +          e−γi τ − 1                                              (25)
                  γi       γi α1i
                                                                  
                  α1i     α1i              −2γτ                 −2γτ
Bφ5,i (τ ) =    − 2            + α0i (e          − 1) + α1i τ e                                   (26)
                  γi       γ
                        
                  1 α1i 2 −2γi τ
Bφ6,i (τ ) =    −            (e        − 1).                                                      (27)
                  2 γi

It follows that the dynamics of P (t, T ) is given by
                                            N
                                            X            p
                      dP (t, T )
                                 = r(t)dt +   Bxi (T − t) vi (t)dWiQ (t).                        (28)
                       P (t, T )
                                              i=1


                                                     7
   To price options on zero-coupon bonds we follow Collin-Dufresne and Goldstein (2003),
who extend the analysis in Duffie, Pan, and Singleton (2000) to HJM models, and introduce
the transform
                                                 h                  R T0
                                                                                                     i
                          ψ(u, t, T0 , T1 ) = EtQ e−                 t     rs ds ulog(P (T0 ,T1 ))
                                                                               e                         .         (29)

This transform has an exponentially affine solution as demonstrated in the following proposi-
tion

Proposition 2 The transform in (29) is given by
                                              P   N
            ψ(u, t, T0 , T1 ) = eM (T0 −t)+       i=1   Ni (T0 −t)vi (t)+ulog(P (t,T1 ))+(1−u)log(P (t,T0 ))
                                                                                                               ,   (30)

where M (τ ) and Ni (τ ) solve the following system of ODEs
                       N
                       X
       dM (τ )
                   =         Ni (τ )κi θi                                                                          (31)
        dτ
                       i=1
       dNi (τ )                                                                     1
                   = Ni (τ ) (−κi + σi ρi (uBxi (T1 − T0 + τ ) + (1 − u)Bxi (τ ))) + Ni (τ )2 σi2
         dτ                                                                         2
                      1 2                                1                      
                     + (u − u)Bxi (T1 − T0 + τ )2 +         (1 − u)2 − (1 − u) Bxi (τ )2
                      2                                  2
                     +u(1 − u)Bxi (T1 − T0 + τ )Bxi (τ )                                          (32)

subject to the boundary conditions M (0) = 0 and Ni (0) = 0.

Proof: See Appendix A.


   As in Duffie, Pan, and Singleton (2000) and Collin-Dufresne and Goldstein (2003), we can
now price options on zero-coupon bonds by applying the Fourier inversion theorem.

Proposition 3 The time-t price a European put option expiring at time T0 with strike K on
a zero-coupon bond maturing at time T1 , P(t, T0 , T1 , K), is given by

                         P(t, T0 , T1 , K) = KG0,1 (log(K)) − G1,1 (log(K)),                                       (33)
            √
where i =       −1 and Ga,b (y) is defined as
                                                        Z                                          
                         ψ(a, t, T0 , T1 ) 1                    ∞   Im ψ(a + iub, t, T0 , T1 )e−iuy
              Ga,b (y) =                  −                                                           du.          (34)
                                2           π               0                   u




                                                                     8
Proof: See Appendix A.


       For estimation we will use LIBOR rates, swap rates, caps and swaptions. LIBOR and
swap rates are straightforward to compute from the zero-coupon curve. A cap is a portfolio
of caplets. A caplet is a call option on a LIBOR rate but can also be valued as a (scaled)
European put option on a zero-coupon bond and can therefore be priced using Proposition 3.
A payer swaption is a call option on a swap rate but can also can be valued as a European
put option on a coupon bond. No analytical expressions exist for European coupon bond
options in the general affine framework, but a number of accurate approximations have been
developed. We apply the stochastic duration approach developed by Wei (1997) for one-factor
models and extended to multi-factor models by Munk (1999). This approximation is fast
and has been shown to be accurate for ATMF options, which is what we use for estimation,
see Munk (1999) and Singleton and Umantsev (2002).10 The idea of the stochastic duration
approach is to approximate a European option on a coupon bond with a (scaled) European
option on a zero-coupon bond with maturity equal to the stochastic duration of the coupon
bond. Therefore, swaptions can also be priced using Proposition 3. Appendix A contains the
pricing formulas for LIBOR rates, swap rates, caps and swaptions.


2.3       Implications for implied volatilities

Our model is expressed in terms of instantaneous forward rates. In contrast, LIBOR market
models (Miltersen, Sandmann, and Sondermann (1997) and Brace, Gatarek, and Musiela (1997))
are expressed in terms of forward LIBOR rates, while swap market models (Jamshidian (1997))
are expressed in terms of forward swap rates. In this section we relate our model to these com-
peting frameworks popular in the financial industry. We also obtain very intuitive formulas
for the ATMF implied volatilities for swaptions and caplets generated by our model.11
       Applying Ito’s Lemma to the forward swap rate (see (72) in Appendix A) and switching
  10
       Other approximation schemes have been developed by Collin-Dufresne and Goldstein (2002b), Singleton
and Umantsev (2002) and Schrager and Pelsser (2005). However, these tend to be slower than the stochastic
duration approach and hence not well suited for this paper, where a very large number number of swaptions
needs to be computed for each evaluation of the likelihood function.
  11
       To keep the discussion brief we will focus on the dynamics of forward swap rates and ATMF swaption
implied volatilities. However, since a forward LIBOR rate can be seen as a particular forward swap rate the
analysis also applies to the dynamics of forward LIBOR rates and ATMF caplet implied volatilities.




                                                      9
to the forward swap measure under which forward swap rates are martingales (see Jamshid-
ian (1997)), we obtain
                                                                               
                                      N
                                      X            n
                                                   X                                p                Tm ,Tn
                  dS(t, Tm , Tn ) =                       ζj (t)Bxi (Tj − t)          vi (t)dWiQ            (t)           (35)
                                      i=1         j=m

                  P (t,Tm )                              P (t,Tj )
where ζm (t) =   P V BP (t) , ζj (t) = −νS(t, Tm , Tn ) P V BP (t) for j = m + 1, ..., n                            − 1, ζn (t) =
                                                     Pn
−(1 + νS(t, Tm , Tn )) PPV(t,Tn)
                           BP (t) and P V BP (t) = ν     j=m+1 P (t, Tj ). Furthermore,                             the dynamics
of vi (t) under the forward swap measure is given by
                                                                                                              
                                                                                n
                                                                                X
                   dvi (t) = κi (θi − vi (t)) + vi (t)σi ρi ν                          ξj (t)Bxi (Tj − t) dt
                                                                               j=m+1
                                                                                 q                             
                                          p                        Tm ,Tn                           Tm ,Tn
                                    +σi       vi (t)       ρi dWiQ        (t) +       1−   ρ2i dZiQ        (t)              (36)

                      P (t,Tj )           Tm ,Tn                     Tm ,Tn
where ξj (t) =       P V BP (t) .   WiQ            (t) and ZiQ                (t) denote independent standard Wiener
processes under the forward swap measure QTm ,Tn .
       While instantaneous forward rates are normally distributed conditional on the volatility
state variables, the same does not hold for forward swap rates, since the ζj (t) terms are
stochastic. Also, the process of vi (t) is non-affine under the forward swap measure due to the
ξj (t) terms. However, we can obtain an approximate and affine expression for the dynamics of
the forward swap rate by replacing ζj (t) and ξj (t) with their their time t expected values, which
are simply their time t values since these are martingales under the forward swap measure.12
Therefore, conditional on the volatility state variables, forward swap (and LIBOR) rates are
approximately normally distributed in our model. This is in contrast to the LIBOR and swap
market models where forward swap (and LIBOR) rates are typically (either approximately or
exactly) log-normally distributed.
       We can make a second approximation by replacing vi (t) with its time t expected value. In
this case, given time t information, S(Tm , Tn ) is normally distributed
                                                                       p       
                        S(Tm , Tn ) ∼ N S(t, Tm , Tn ), σN (t, Tm , Tn ) Tm − t                                             (37)

  12
       Due to the fact that P V BP (t), which is the numeraire associated with the forward swap measure, appears
in the denominators of these terms. A similar approach is followed by Schrager and Pelsser (2005) in a general
affine model. They argue that the approximation is very accurate since ζj (t) and ξj (t) typically have low
variances.




                                                                   10
where
                                                                                 2                      1/2
                                      Z          N
                                              Tm X        n
                                                          X
                               1                                                          Tm ,Tn
   σN (t, Tm , Tn ) =                                         ζj (t)Bxi (Tj − u) EtQ             vi (u)]du
                                                                                                   [e             .   (38)
                             Tm − t       t     i=1       j=m

An approximate price of the (Tm − t)–into–(Tn − Tm ) swaption (i.e. an option expiring at Tm
on a swap for the period Tm to Tn ) can be obtained by inserting (38) in the normal swaption
pricing formula. Monte Carlo evidence (not reported) shows this to be reasonably accurate for
ATMF swaptions.13 Therefore we can view σN (t, Tm , Tn ) as a reasonably accurate expression
of the normal implied ATMF swaption volatility generated by our model. The corresponding
log-normal implied ATMF swaption volatility is approximately given by
                                                                  σN (t, Tm , Tn )
                                      σLN (t, Tm , Tn ) =                          .                                  (39)
                                                                   S(t, Tm , Tn )
       These expressions yield several insights. Firstly, (38) and (39) directly link the volatility
state variables in our model to the ATMF normal and log-normal implied volatilities. A
positive vi (t)-shock naturally increases normal and log-normal implied volatility. However,
since σN (t, Tm , Tn ) equals the square root of the average expected instantaneous variance of
the forward swap rate over the life of the swaptions14 and since a vi (t)-shock is expected to
die out over time, the effect on implied volatilities will tend to decrease with the length of
the option. Other things being equal, the effect on longer options will be larger for the more
persistent volatility state variables.
       Secondly, shocks to the term structure have only an indirect effect on σN (t, Tm , Tn ) through
the ζj (t) and ξj (t) terms. This effect is small for reasonable parameter values. In contrast,
shocks to the term structure have a direct effect on σLN (t, Tm , Tn ) through the underlying
forward rate. Therefore, in our model the normal implied volatility surface is almost exclusively
driven by the volatility factors, while the log-normal implied volatility surface is driven by both
the term structure and volatility factors.
       Thirdly, and related, without correlations between innovations to the term structure and
volatility factors, the model predicts that changes in normal implied volatilities are close
  13
       For N = 3 and typical parameter estimates reported in Section 4, the pricing errors range from –2 percent
to 3 percent of the true price. Note that this way of pricing swaptions is extremely fast requiring only a single
numerical integration. Therefore, it can be used in the initial stages of an optimization procedure to obtain a
set of parameter estimates which can subsequently be refined with a more accurate approximation such as the
stochastic duration approach.
  14
       Where the expectation is taken under the forward swap measure.


                                                                 11
to uncorrelated with changes in the underlying forward rates, while changes in log-normal
implied volatilities are quite strongly negatively correlated with changes in the underlying
forward rates. However, with positive correlation parameters the model predicts positive (less
negative) correlations between normal (log-normal) implied volatility changes and forward rate
changes, more in line with what we see in the data.


2.4      Market price of risk specifications

For estimation we also need the dynamics of the state vector under the actual probability
measure P which are obtained by specifying the market prices of risk, ΛW,i and ΛZ,i that link
the Wiener processes under Q and P through

                                 dWiP (t) = dWiQ (t) − ΛW,i (t)dt                                         (40)

                                  dZiP (t) = dZiQ (t) − ΛZ,i (t)dt.                                       (41)

We apply the “extended affine” market price of risk specification suggested by Cheredito,
Filipovic, and Kimmel (2003) and Collin-Dufresne, Goldstein, and Jones (2003). This is the
most flexible market price of risk specification that preserves the affine structure of the state
vector under the change of measure. In our setting the “extended affine” specification is given
by

                        λW,i0 + λW,ix xi (t) + λW,iv vi (t)
          ΛW,i (t) =                p                                                                     (42)
                                        vi (t)
                           1      λZ,i0 + λZ,iv vi (t) − ρi (λW,i0 + λW,ix xi (t) + λW,iv vi (t))
           ΛZ,i (t) =   q                                     p                                   .       (43)
                          1 − ρ2i                               vi (t)

which implies that the dynamics of xi (t) and vi (t) under P are given by
                                                             p
            dxi (t) =  ηiP + κPx,i xi (t) + κPxv,i vi (t) dt + vi (t)dWiP (t)                             (44)
                                                                      q             
                                                 p
            dvi (t) = κPi (θiP − vi (t))dt + σi vi (t) ρi dWiP (t) + 1 − ρ2i dZiP (t) ,                   (45)

                                                                                                κi θi +σi λZ,i0
where ηiP = λW,i0 , κPx,i = (λW,ix − γi ), κPxv,i = λW,iv , κPi = κi − σi λZ,iv and θiP =              κP
                                                                                                                .
                                                                                                        i
Obviously the dynamics of φ1,i (t),...,φ6,i (t) do not change since these contain no stochastic
terms.
     The traditional “completely affine” specification, see e.g. Dai and Singleton (2000), is
obtained by setting λW,i0 = λW,ix = λZ,i0 = 0, while the “essentially affine” specification,



                                                    12
see e.g. Dai and Singleton (2002) and Duffee (2002), is obtained by setting λZ,i0 = 0.15 In
                                             κ i θi
both cases we have that θiP =                κP
                                                    .   The advantage of the “extended affine” specification is
                                                i
that one can adjust the mean reversion speed and the long run level of the volatility processes
independently of each other when changing measures. In contrast, with the “completely affine”
and “essentially affine” specifications, adjusting the mean reversion speed necessarily changes
the long run level by a given amount.
         The “extended affine” specification is only valid provided that vi (t) does not attain its
boundary value of zero under both Q or P . Therefore, we have to impose the following
boundary non-attainment conditions16

                                                           2κi θi ≥ σi2                                                     (46)

                                                         2κPi θiP        ≥ σi2                                              (47)


3         Estimation approach

3.1         Data

Our data set consists of weekly observations of LIBOR/swap term structures and log-normal
implied ATMF swaption and cap volatilities from August 21, 1998 (i.e. just prior to the LTCM
crisis) to July 8, 2005. In the latter half of the the sample from January 4, 2002 to July 8,
2005 we also have weekly observations on the log-normal implied cap skews. All observations
are closing mid-quotes on Fridays and are obtained from Bloomberg.17
         The LIBOR/swap term structures consist of LIBOR rates with maturities of 3mth, 6mth
and 9mth and swap rates with maturities 1yr, 2yr, 3yr, 5yr, 7yr, 10yr and 15yr. The term
structure data is displayed in Figure 1.

                                                                                 pǫ + v (t)dW
    15
         Strictly speaking, in our setting the “essentially affine” specification coincides with the “completely
                                                                                                Q
affine” specification. However we could allow dxi (t) = · · · dt +                     i        i (t),   in which case ΛW,i (t) =
λW,iO +λW,ix xi (t)+λW,iv vi (t)
              √                    and the statement in the text would be exactly correct. See Cheredito, Filipovic,
                  ǫ+vi (t)
and Kimmel (2003) for more on the this.
    16
         Intuitively, if vi (t) were zero, we would have an infinite market price of risk despite zero volatility, rep-
resenting an arbitrage opportunity. The boundary non-attainment conditions ensure that the market price of
risk stays finite, although they can become arbitrarily large. The boundary non-attainment conditions must be
satisfied under both P and Q for the measures to the equivalent. See Cheredito, Filipovic, and Kimmel (2003)
for a further discussion.
    17
         Note that we are implicitly assuming homogeneous credit quality across the LIBOR, swap, swaption and
cap markets since all cash-flows are discounted using the same discount factors.


                                                                    13
      The swaptions have underlying swap maturities of 1yr, 2yr, 3yr, 5yr, 7yr and 10yr (called
“tenors”) and option maturities of 1mth, 3mth, 6mth, 1yr, 2yr, 3yr and 5yr, i.e. a total of 42
swaptions. The strikes on the ATMF swaptions are simply the forward rates on the underlying
swaps. Figure 2 displays the swaption data.
      The caps have length 1yr, 2yr, 3yr, 4yr, 5yr, 7yr and 10yr. The strikes on the ATMF caps
are the swap rates on the swaps with payments that corresponds to those of the caps. The
skew data consists of implied volatilities on caps with fixed strikes of 1.5, 2.0, 3.0, 4.0, 5.0, 6.0
and 7.0 percent. We define “moneyness” of a given cap as the ratio between its strike and the
strike on the ATMF cap of the same length. Therefore, those caps with moneyness larger than
one are out-of-the-money (OTM), while those with moneyness less than one are in-the-money
(ITM). Rather than work with caps with fixed strikes (and time-varying moneyness), we will
work with caps with fixed moneyness (and time-varying strikes) between 0.80 and 1.20. The
strike on a cap with a given moneyness is obtained by cubic-spline interpolation. Figure 3
displays the cap data, while Figure 4 displays the cap skew data. The missing data in the
time series of skews for the 1yr and 2yr caps is due to the fact that very low interest rates
have made a full skew unavailable in some periods (we refrain from extrapolating outside the
range of implied volatilities that are available and only use full skews to give equal weight to
OTM and ITM caps). Furthermore, we have eliminated a few observations where there were
obvious mistakes in the reported implied volatilities.
      We calibrate a forward rate curve on each observation date using the following Nelson and
Siegel (1987) parametrization

                         f (t, T ) = β0 + β1 e−γ1 (T −t) + β2 (T − t)e−γ2 (T −t) .                    (48)

The parameters are recalibrated on each observation date by minimizing the mean squared
percentage differences between the observed LIBOR and swap rates on that date and those
implied (48). Based on the forward rate curves (or, rather, the associated zero-coupon curves)
we compute swaption and cap prices from the log-normal (or Black (1976)) pricing formulas.


3.2      The Kalman filter

We estimate the model with the (extended) Kalman filter.18 This involves writing the model
in state space form, which consists of a measurement equation and a transition equation. The
 18
      Duffee and Stanton (2004) compare several estimation methods in the context of estimating affine term
structure models, namely Efficient Method of Moments (EMM), Simulated Maximum likelihood (SML) and


                                                     14
measurement equation describes the relationship between observable variables and the latent
state variables. It is given by

                                   yt = h(Xt ) + ut ,       ut ∼ iid. N (0, S),                                  (49)

where yt is a vector consisting of observable quantities, Xt is the state vector, h is the pricing
function, and ut is a vector of iid. Gaussian measurement errors with covariance matrix S.
The Xt -vector is given by

                      Xt = (x1 (t), ..., xN (t), φ1,1 (t), ..., φ6,N (t), v1 (t), ..., vN (t))′ .                (50)

       The yt -vector consist of the LIBOR/swap term structure and the derivatives prices. The LI-
BOR and swap rates are non-linearly related to x1 (t), ..., xN (t) and φ1,1 (t), ..., φ6,N (t) through
                                                                                  P (0,T )
(20). For estimation we replace f (0, T ) with ϕ in (5) and                       P (0,t)    with exp {−ϕ(T − t)} in
(20) and estimate ϕ as part of the estimation procedure. This reduces the model to a time-
homogeneous affine term structure model where ϕ is the infinite-maturity forward rate.19
       The derivatives prices are non-linearly related to v1 (t), ..., vN (t) through (30) and (33).
Since we price derivatives based on the actual forward rate curves, derivatives prices are
independent of the x(t) and φ(t) state variables. This has the advantage that an imperfect
fit to the forward rate curve does not get reflected in derivatives prices, which in turn should
provide us with a cleaner estimate of the volatility processes.20 Since derivatives prices vary
strongly across maturities of the options, maturities of the underlying LIBOR or swap rates
as well as moneyness, we divide derivatives prices by their vegas, i.e. their sensitivities to
variations in log-normal volatilities. With this scaling, the derivatives prices have comparable
magnitudes.21

Quasi Maximum likelihood (QML) in conjunction with the Kalman filter. Their conclusion is that the latter
procedure is preferable due to its better finite sample properties. Computational considerations also speak in
favor of the QML/Kalman filter approach, since the inclusion of derivatives in the estimation makes even this
otherwise simple procedure computationally intensive. Estimating the model with the more complex EMM or
SML procedures would be extremely time-consuming, if not impossible.
  19
       A similar approach is taken by de Jong and Santa-Clara (1999) in their estimation of HJM models.
  20
       When the cap skew data is included in the estimation, the dimension of the yt -vector varies over time. This
does not present a problem, however, since the Kalman filter easily handles missing observations.
  21
       This is very similar to fitting the model to log-normal implied volatilities but is much faster, since computing
implied volatilities requires a numerical inversion for each swaption and cap, which would add an extra layer of
complexity to the likelihood function.



                                                            15
       To reduce the number of parameters in S, we make the conventional assumption that the
measurement errors are cross-sectionally uncorrelated (that is, S is diagonal). Furthermore,
we assume that one variance applies to all measurement errors for interest rates, and that
another variance applies to all measurement errors for scaled derivatives prices.
       The transition equation describes the discrete-time dynamics of the state vector implied
by the continuous-time processes (44), (45), (14)-(19), i = 1, ..., N ,

               Xt+1 = Φ(Xt ) + wt+1 ,        wt+1 iid., E[wt+1 ] = 0, Var[wt+1 ] = Q(Xt ).                   (51)

Since Xt follows an affine diffusion, we have that Φ(Xt ) = Φ0 + ΦX Xt and Q(Xt ) = Q0 +
PN
  i=1 Qv,i vt,i , where Φ0 , ΦX , Q0 and Qv,i are known in closed form (see e.g. Fisher and

Gilles (1996)). The disturbance vector wt+1 is iid. but not Gaussian.
       To apply the Kalman filter, which is designed for linear Gaussian state space models, to
(49) and (51), we need to linearize the h-function in (49) and make the assumption that
the disturbance term wt in (51) is Gaussian. With these modifications we can apply the
(extended) Kalman filter to (49) and (51) and in the process obtain the likelihood function (for
completeness the (extended) Kalman filter recursions are stated in Appendix B. Harvey (1989)
and Hamilton (1994) are classic references).22


3.3       Numerical issues

The log-likelihood function is maximized by initially using the Nelder-Mead algorithm and later
switching to the gradient-based BFGS algorithm. The optimization is repeated with several
different plausible initial parameter guesses to minimize the risk of not reaching the global
optimum. The ODEs (31) and (32) are solved with a standard fourth-order Runge-Kutta
algorithm, and the integral (34) is evaluated with the Gauss-Legendre quadrature formula,
using 20 integration points and truncating the integral at 8000. For the model with N =3
estimated on the entire data set, each evaluation of the likelihood function requires calculating
60,480 swaption prices and 514,336 caplet prices,23 underscoring the need for fast pricing
  22
       The use of a Gaussian distribution to approximate the true distribution of wt+1 makes this a QML procedure.
While QML estimation has been shown to be consistent in many settings, it is in fact not consistent when used
in conjunction with the Kalman filter (see. e.g. Lund (1997)). However, the Monte Carlo studies in Duffee and
Stanton (2004) and in several other papers show the inconsistency problem to be of minor importance in the
context of term structure estimation.
  23
       In the sample there are a total of 15,120 swaptions, 43,560 caplets constituting 2520 ATMF caps and
85,024 caplets constituting 4640 non-ATMF caps. Furthermore, the derivative (82) in Appendix B is computed


                                                         16
routines.


4     Estimation results

4.1    Parameter estimates

We start by estimating our model for N =1 (i.e. one term structure factor and one volatility
factor), N =2 (i.e. two term structure factors and two volatility factors) and N =3 (i.e. three
term structure factors and three volatility factors) on the entire data set. We also re-estimate
the model for N =3 on the swaption and cap data separately and price caps and swaptions
out-of-sample to address the relative valuation of swaptions and caps.
    The five sets of parameter estimates are given in Table 1 and 2. For all the models the
estimates of α0,i , α1,i and γi imply that all the forward rate volatility functions are hump
shaped, with σf,1 (t, T ) affecting the entire forward rate curve, σf,2 (t, T ) affecting only the
short end of the curve and σf,3 (t, T ) affecting mainly the intermediate part of the curve. This
is consistent with principal component analyses of the yield curve, which find that the three
dominant factors are the “level”, “slope” and “curvature” factors. Panel A in Figure 5 displays
the forward rate volatility functions in case of the N =3 swaption and cap model.
    For all the models the first volatility factor is more persistent than the second volatility
factor under the risk-neutral measure. Interestingly, the third volatility factor is the least
persistent for the N =3 swaption and cap model and swaption model but the most persistent
for the N =3 cap model. The volatility factors are always less persistent under the actual
measure than under the risk-neutral measure. Panel B in Figure 5 displays the volatility state
variables in case of the N =3 swaption and cap model.
    As discussed in Section 2.1, the long-run means of the volatility factors under Q are not
identified and set to one. All models with N ≥ 2 have at least one volatility factor with a
long run mean higher than one under P . For square-root processes the “completely affine” risk
premium specification necessarily implies either faster mean reversion and lower long run mean
or slower mean reversion and higher long run mean under P than under Q. The combination
of faster mean reversion and higher long run mean is only possible with the “extended affine”
risk premium specification.
    In all the estimations, the boundary non-attainment condition is binding for all the volatil-

numerically so we need to reprice the swaptions and caplets for small perturbations of v1 (t), v2 (t) and v3 (t).



                                                        17
ity processes under Q but not under P . We have re-estimated the models with the “completely
affine” market price of risk specification, which does not impose the boundary non-attainment
condition. This yields slightly lower κi -estimates and somewhat higher σi -estimates. How-
ever, the models’ pricing performances are largely unchanged. Therefore, the improvement in
the model’s time series fit that comes from using the “extended affine” market price of risk
specification does not come at the expense of a noticeable poorer cross-sectional fit. This is
consistent with the results reported by Cheredito, Filipovic, and Kimmel (2003) in the context
of term structure estimation.
   For all the models, the correlation parameters are positive, and at least one correlation
parameter is significantly different from zero. This is consistent with the preliminary observa-
tions made earlier in the paper that non-zero correlations were crucial for matching the implied
cap skews and the dynamics of implied volatilities. We return to the role of the correlation
parameters in Section 5.
   In general the Q-parameters are much more precisely estimated than the P -parameters,
which is not surprising given the relatively short time-series. Particularly the P -parameters
in the dynamics of the xi (t) state variables are very imprecisely estimated.


4.2    Interpretation of factors

As discussed in Section 2.3, variations in the normal implied volatilities are almost exclusively
driven by variations in the volatility factors, while variations in the log-normal implied volatil-
ities are driven by variations in both the term structure and volatility factors. To provide
intuition about the dynamics of the model, Figure 6 shows the impact on the log-normal im-
plied swaption volatility surface from one-standard deviation shocks to x1 (t), x2 (t), x3 (t), v1 (t),
v2 (t) and v3 (t) in case of the N =3 swaption and cap model, assuming that the zero-coupon
curve and v1 (t), v2 (t) and v3 (t) are initially equal to their sample averages.
   Our model allows for a rich set of shocks to the implied volatility surface. The effect of a
shock to a term structure factor depends on the impact on the forward swap rates underlying
the swaptions. A x1 (t)-shock decreases the entire implied volatility surface with a slight inverse
hump shaped impact along the option dimension for short swaps and along the swap dimension
for short options. A x2 (t)-shock mainly decreases the implied volatility of short options on
short swaps, and the effect quickly diminishes with the length of the option and the length of
the swap. Compared with a x1 (t)-shock, a x3 (t)-shock has a more pronounced inverse hump



                                                  18
shaped impact along the option dimension for short swaps and along the swap dimension for
short options.
      The effect of a shock to a volatility factor depends on the impact on the instantaneous
volatilities of the forward swap rates underlying the swaptions and the persistence of the volatil-
ity shock. A v1 (t)-shock is moderately persistent and increases the instantaneous volatility of
all forward swap rates. The result is an increase in the entire implied volatility surface, with
the implied volatilities of short options on longer swaps increasing the most. A v2 (t)-shock is
less persistent and mainly affects the instantaneous volatility of short swaps with short forward
starts. The result is that only short options on short swaps are affected. A v3 (t)-shock is very
persistent and mainly affects the instantaneous volatility of intermediate forward swaps (short
swaps with intermediate forward starts or intermediate swaps with short forward starts). The
result is a hump shaped impact along the option dimension for short swaps along the swap
dimension for short options.
      For completeness Figure 7, Panel A, B and C shows the impact on the log-normal implied
ATMF cap volatilities from one-standard deviation shocks to x1 (t), x2 (t), x3 (t), v1 (t), v2 (t)
and v3 (t).24 These are similar to the impact on implied volatilities of swaptions with short
tenors.


4.3      Overall comparisons of models

For each of the estimated models, we compute the fitted LIBOR and swap rates and swaption
and cap prices based on the filtered state variables. For the LIBOR and swap rates, we
take the pricing errors to be the differences between the fitted and actual interest rates. For
the swaptions and caps, we take the pricing errors to be the differences between the fitted
and actual prices divided by the actual prices. By taking the square root of the average
of the squared pricing errors at each date, we construct time-series of root mean squared
errors (RMSEs) of LIBOR/swap rates, ATMF swaptions, ATMF caps and non-ATMF caps.
Averaging these series over time produces the overall RMSEs.
      We make pairwise comparisons between the models’ pricing performance using the ap-
proach of Diebold and Mariano (1995). Suppose two models generate time-series of root mean
squared cap pricing errors RM SE1,cap (t) and RM SE2,cap (t). We then compute the mean
of the difference RM SE2,cap (t) − RM SE1,cap (t) and the associated t-statistics. A signifi-
 24
      We discuss Panel D, E and F below.



                                                19
cantly negative mean implies that model two has a significantly better fit to caps than model
one (according to the RMSE criterion). When computing the t-statistics we use Newey and
West (1987) standard errors with 12 lags to correct for heteroscedasticity and autocorrela-
tion.25
       Table 3 displays the average RMSEs for LIBOR/swap rates, ATMF swaptions, ATMF
caps and non-ATMF caps for each of the five models, and Table 4 makes pairwise comparisons
between the models. For the swaption and cap models, the fit improves with the number of
factors and the decreases in average RMSEs between the N =2 and N =1 models and between
the N =3 and N =2 models are generally strongly significant. These results are consistent
with principal component analyses, which show that three factors are necessary to capture the
variation in the term structure (see e.g. Litterman and Scheinkman (1991)) and that addi-
tional factors unrelated to the term structure are necessary to capture the variation in ATMF
swaptions (Heidari and Wu (2003)), ATMF caps (Collin-Dufresne and Goldstein (2002a)) and
non-ATMF caps (Li and Zhao (2006)).
       The N =3 swaption model has a superior fit to swaptions, but an inferior (out-of-sample)
fit to caps than the N =3 swaption and cap model. The converse holds for the N =3 cap model,
which has a superior fit to caps but an inferior (out-of-sample) fit to swaptions compared to the
N =3 swaption and cap model. It appears that removing swaptions from the estimation has
a bigger impact than removing caps, which to some extent has to do with the fact that there
are more swaptions than caps in the sample, making the estimation procedure focus more on
matching the swaption prices than cap prices when both are included in the estimation.


4.4       In-sample fit

We now take a closer look at the fit of the N =3 models. Figure 8 displays the time series
of the RMSEs of LIBOR/swap rates, ATMF swaptions, ATMF caps and non-ATMF caps for
the N =3 swaption model (dotted lines) and the N =3 cap model (solid lines). The RMSE
measure takes both variations and biases in the pricing errors into account. To see if the
pricing errors for the individual interest rates and derivatives prices deviate systematically
from zero, Tables 5 – 8 report the mean valuation errors and associated t-statistics for the
LIBOR/swap rates, ATMF swaptions, ATMF caps and non-ATMF caps, respectively, for all
the N =3 models. In this section we focus on the in-sample fit while in the next section we
  25
       The results are robust to variations in the lag length.



                                                          20
focus on the out-of-sample fit.
       The in-sample swaption RMSE (dotted line, Panel B) reaches about 15 percent in Septem-
ber 1998 during the LTCM crisis. Longstaff, Santa-Clara, and Schwartz (2001) and Han (2004)
also report a significant increase in swaption pricing errors during this period. The in-sample
swaption RMSE reaches about ten percent in July 2003, when a large increase in interest rates
from record low levels caused massive MBS driven convexity hedging that also seems to have
caused temporary dislocations in the derivatives market. Apart from these two episodes the
RMSE fluctuates in a range between two to six percent. The RMSE is comparable to that
reported by Han (2004) for his preferred model with four term structure factors and three
volatility factors during the sample period which overlaps with ours. Note, however, that we
include a larger number of swaptions than his study. In particular, our data set includes 1mth
and 3mth options and 10yr underlying swaps, which are not present in his data set. And it is
precisely these swaptions on the “edges” of the volatility surface that are the most difficult to
fit.
       The in-sample ATMF cap RMSE (solid line, Panel C) also spikes in September 1998.
Otherwise it mostly fluctuates between one and two percent. The in-sample non-ATMF RMSE
(solid line, Panel D) also fluctuates in this range, although it breaks out of the range towards
the end of the sample. The RMSE is significantly lower than for the preferred model in Jarrow,
Li, and Zhao (2004) with three term structure factors, three volatility factors and jumps during
the sample period which overlaps with ours (they report that the RMSE fluctuates around
five percent during this period).
       For the N =3 swaption and cap model the average swaption errors range from -3.41 to
3.39 percent, the average ATMF cap errors range from 3.08 and 0.12 percent and the average
non-ATMF cap errors range from -4.17 to 4.15 percent. Quite a few of the pricing errors are
statistically significant.
       For the N =3 swaption model the range of average swaption errors narrows to -2.84 to 2.52
percent. To put these numbers into perspective, the mean pricing errors reported by Longstaff,
Santa-Clara, and Schwartz (2001) for their four-factor string market model estimated on swap-
tions, although for a different sample period and with their model re-calibrated at every date,
lie in a range from -5.37 to 5.62 percent.
       For the N =3 cap model, the range of average pricing errors narrows to -0.01 to 0.40
percent for ATMF caps and -1.51 to 1.59 percent for non-ATMF caps. To put these numbers
into perspective, the mean pricing errors reported by Jarrow, Li, and Zhao (2004) for their

                                                21
preferred model estimated on cap skew data, although not for exactly the same sample period,
lie in a range from -6.88 percent to 7.13 percent. Note also that for the N =3 cap model, far
fewer of the average cap errors are statistically significant.
       Finally, we briefly comment on the in-sample fit to interest rates. The RMSEs fluctuate in
a range between one and 10 basis points, and the average errors are within a few basis points
with no apparent differences between the models.
       Figures 9 – 11 displays the average of the actual and fitted term structure, normal implied
swaption volatility surface and normal implied ATMF cap term structure, respectively, in case
of the N =3 swaption and cap model.26 The actual and fitted term structure is indistinguishable
from each other, and the fit to implied volatilities are also very close.
       As discussed by Dai and Singleton (2002), the fitted data depends not only on the properties
of a model but also on the properties of the historical data used for estimation. Therefore,
comparing the properties of the fitted data to the actual data may in some instances yield
misleading conclusions regarding the adequacy of a model. A “cleaner” way of evaluating a
model is to simulate data from the model and compare the properties of the simulated data to
the actual data. We therefore simulate 1000 samples of term structures and implied volatilities
from the N =3 swaption and cap model. Each sample consists of 360 weekly observations
similar to our original data set. From these we obtain the small-sample distributions of the
average term structure, average swaption volatility surface and average ATMF cap volatility
term structure generated by the model. The means and 95 percent confidence intervals of these
distributions are also displayed in Figures 9 – 11. The means of the small-sample distributions
are close to the means of the actual data, and the means of the actual data are certainly well
within the 95 percent confidence intervals of the small-sample distributions. This underscores
the very good fit of our model.


4.5       Out-of-sample fit – the relative valuation of caps and swaptions

We now turn to the out-of-sample fit to swaptions and caps, i.e. the fit to caps for the
N =3 swaption model and the fit to swaptions for the N =3 cap model. We are particularly
interested in whether caps and swaption are priced consistently with each other. In Figure 8
the out-of-sample swaptions RMSE (solid line, Panel B) and out-of-sample cap RMSEs (dotted
  26
       We display the simulated derivatives data in terms of normal rather than log-normal implied volatilities
since the normal implied volatilities exhibit a more pronounced hump-shape that most dynamic term structure
models have difficulties matching.


                                                       22
lines, Panel C and D) are larger most of the time than their in-sample counterparts. This is
particularly the case in the first third of the sample.
       For the N =3 swaption model, the average cap errors are negative and significantly so for
all caps. This means that market prices of caps have been higher on average than the prices
implied by swaptions. In other words, there has been a tendency for caps to be overvalued
relative to swaptions.
       For the N =3 cap model, the average swaption errors are significantly positive for swaptions
with underlying swap maturities of 1yr, 2yr and 3yr (except for the 1mth–into–1yr swaption)
and significantly negative for swaptions with underlying swap maturities of 7yr and 10yr.
However, the out-of-sample results are probably most reliable for swaptions with combined
swap and option maturity not exceeding ten years, which is the maximum cap maturity in
the sample. If we limit our attention to these swaptions, 25 out of 34 have positive mean
pricing errors, and the mean across all 34 swaptions is 3.51 percent. Therefore, market prices
of swaptions have generally been lower on average than the prices implied by caps. In other
words, there has been a tendency for swaptions to be undervalued relative to caps consistent
with the conclusions from the N =3 swaption model.
       Interestingly, Longstaff, Santa-Clara, and Schwartz (2001) reach the opposite conclusion
that the market has on average undervalued caps relative to swaptions, while Han (2004) finds
little mis-valuation on average for his preferred stochastic volatility model. These differing
conclusions may to some extent be attributed to differences in models. But they may also
be attributed to differences in samples, since, as we discuss next, there appear to be large
variations in the relative valuation.
       Figure 12 shows the average (out-of-sample) swaption valuation errors according to the
N =3 cap model (the solid line) and the average (out-of-sample) cap valuation errors according
to the N =3 swaption model (the dotted line for ATMF caps and the broken line for non-ATMF
caps) at each date. The figure highlights that the relative valuation between caps and swaptions
fluctuates over time. According to our model, swaptions were generally overvalued relative
to caps during the LTCM crisis. Subsequently the situation reverses, and for an extended
period from mid-1999 to mid-2000 swaptions appear generally undervalued relative to caps.27
However, since then there appear to be little systematic mis-valuation in the aggregate between
swaptions and caps.
  27
       Han (2004) also finds that for his preferred model, swaptions were undervalued relative to caps during this
period and he cites media reports that many hedge funds and proprietary traders shared this sentiment.


                                                         23
5     The role of the interest rate – volatility correlations

5.1    Matching the implied cap skews

As discussed in Section 2.3, conditional on the volatility factors, forward LIBOR and swap
rates are approximately normally distributed in our model (under the appropriate forward
measure). Suppose the correlation between innovations to the forward curve and volatilities
were zero. In that case the forward LIBOR rate distributions would have fatter tails than
the normal distribution, and the model would predict strongly downward sloping cap skews in
terms of log-normal implied volatilities, with ITM caps trading at higher log-normal implied
volatilities than OTM caps. Although this is qualitatively consistent with the data, the implied
cap skews predicted by such a model will be too steep. However, the skewness of the forward
LIBOR rate distributions and hence the steepness of the implied cap skews depend on the
correlation parameters. To illustrate this, Figure 7, Panel D, E and F shows the derivatives of
the differences between non-ATMF and ATMF log-normal implied volatilities with respect to
the correlation parameters. The results are for the N =3 swaption and cap model, assuming
that the zero-coupon curve and v1 (t), v2 (t) and v3 (t) are initially equal to their sample averages.
In all cases, increasing the correlation parameters decreases the log-normal implied volatilities
of ITM caps relative to OTM caps which decreases the steepness of the implied cap skews.
Considering Panel A, B and C it is not surprising that ρ1 mainly affects the implied skews of
long-term caps, ρ2 mainly affects the implied skews of short-term caps while ρ3 has the largest
effect on implied skews of intermediate-maturity caps.
    Figure 13 shows the average fit to the actual implied cap skews (solid lines) for the N =3 cap
model (dash-dotted lines) and the N =3 cap model re-estimated with the correlation parameters
restricted to zero (dotted lines). We see that with zero correlations the model produces implied
skews that are too steep on average. In contrast, with non-zero correlations the model has an
almost perfect fit to the implied skews on average. The picture is basically the same for the
N =3 swaption and cap model (not shown) although this model tends to slightly overestimate
the average steepness of the implied skews, particularly for caps of intermediate maturities.


5.2    Matching the dynamics of implied volatilities

Figure 14, Panel A shows the correlations between changes in log-normal implied swaption
volatilities and changes in the underlying forward swap rates. For all the swaptions the cor-



                                                 24
relations are negative, more so for longer swaptions. Panel D shows the correlations using
normal rather than log-normal implied swaption volatilities. In this case, all the correlations
are positive.28
       As discussed in Section 2.3, our model with zero correlation between innovations to the
forward curve and volatilities would predict that changes in normal implied swaption volatilities
were close to uncorrelated with changes in the underlying forward rates, and that changes in
log-normal implied swaption volatilities were quite strongly negatively correlated with changes
in the underlying forward rates. However, with non-zero correlations the model should be able
to match the actual dynamics of implied volatilities more closely.
       To see if this is the case for the N =3 swaption and cap model we use the simulated samples
discussed in Section 4.4. For each sample, we compute correlations between changes in normal
and log-normal implied volatilities and changes in the underlying forward rates. This way we
obtain the small-sample distributions of the correlation coefficients generated by the model.
Panel B and E in Figure 14 display the means of these distributions, while Panel C and F
display the 95 percent confidence intervals. The model has a very good fit to the normal
implied volatility correlations. The means of the small-sample distributions are generally
close to the actual correlations and the actual correlations are in any case well within the 95
percent confidence bands. The model has a reasonable fit to the log-normal implied volatility
correlations. The model does tend to generate too negative correlations but for most of the
swaptions the actual correlations are within the 95 percent confidence bands.


5.3       Statistical significance of the correlation parameters

The previous two subsections show that incorporating non-zero correlations has important
practical implications for the ability of the model to match the implied cap skew and the
dynamics of implied volatilities. Here we investigate if incorporating non-zero correlations is
important from a statistical point of view. We re-estimate the N =3 models with the three cor-
relation parameters restricted to zero. This yields restricted log-likelihood values of -33096.7,
-18952.7 and -5523.3 for the 3SC, 3S and 3C models, respectively. The corresponding unre-
stricted log-likelihood values from Table 1 and 2 are -32887.5, -18947.9 and -3919.2, respec-
tively. Therefore, the likelihood ratio test statistics of the zero-correlation restriction are 418.4,
  28
       These stylized facts are quite robust. For instance, computing the correlations using only the first half
or the second half of the sample yield similar results. These stylized facts also hold for caps but to avoid an
overload of figures we concentrate on swaptions in this section.


                                                        25
9.6 and 3208.2 for the 3SC, 3S and 3C models, respectively. These should be compared with
the critical values of a χ2 (3)-distribution which are 7.81 at the five percent level and 11.34
at the one percent level. For the N =3 swaption and cap model and the N =3 cap model we
strongly reject the zero-correlation restriction. However, for the N =3 swaption model we just
barely reject the zero-correlation restriction at conventional levels.29 The difference is that the
former two models include cap skew data in the estimation which implies that the correlation
parameters can be identified from both the variation in implied volatilities across both mon-
eyness and across time. In the latter model cap skew data is not included and the correlation
parameters can only be identified from the variation in implied volatilities across time. We can
therefore conclude that the variation in implied volatilities across moneyness provides much
stronger identification of the correlation parameters than the variation in implied volatilities
across time.


6         Forecasting interest rates and derivatives

So far we have been concerned with the fit of the models, which mainly depend on the dynamics
under the risk-neutral measure. In this section we turn to the forecasting performances of the
models, which depend critically on the dynamics under the actual measure. We forecast the
term structure and interest rate derivatives using our five estimated models. To evaluate
the quality of the forecasts we also include the benchmarks that interest rates and derivatives
prices follow a random walk, that is, the best forecast of future term structures and derivatives
prices are today’s term structure and derivatives prices.30
         We consider forecast horizons of 4, 8 and 16 weeks. For the non-ATMF caps, we exclude the
1yr caps, as there are too few observations to reliably evaluate forecasts, especially at longer
horizons. All forecasts are in-sample. For the LIBOR and swap rates, we take the forecast
    29
         This is consistent with the fact that in Table 1 and 2 the standard errors on the correlation parameters
are higher for the N =3 swaption model than for the other two models. The reason why the zero-correlation
restriction is more strongly rejected for the N =3 cap model than the N =3 swaption and cap model is that the
unrestricted N =3 cap model has a closer fit to the implied cap skews causing a larger decline in the likelihood
value when imposing the zero-correlation restriction.
    30
         We could include more sophisticated benchmarks but the random walk is a standard benchmark in the
forecasting literature. Since we are forecasting prices of newly issued derivatives, the random walk benchmark
seems valid at shorter horizons despite the fact that it does imply positive probabilities of negative prices of
non-negative contingent claims, which would present an arbitrage opportunity.



                                                         26
errors to be the difference between the predicted and actual interest rate changes. For the
swaptions and caps, we take the forecast errors to be the difference between the predicted and
actual percentage price changes. For each forecast horizon we construct time-series of RMSEs
of LIBOR/swap rates, ATMF swaptions, ATMF caps and non-ATMF caps. Averaging these
series over time produces the overall forecasting RMSEs.
    Table 9 displays the overall forecasting RMSEs for each of the five models at each of the
three forecasting horizons, and Table 10 makes pairwise comparisons of forecasting perfor-
mance using the Diebold and Mariano (1995) approach outlined in section 4.3.
    For the swaption and cap models the forecasting performance generally improves with the
number of factors with the decreases in average RMSEs largest between the N =2 and N =1
models. Even the N =1 swaption and cap model beats the random walk benchmarks for both
interest rates and derivatives, and for the N =3 swaption and cap model the improvement over
the random walk benchmarks is strongly significant for the term structure and ATMF caps.
    The N =3 swaption model outperforms the N =3 swaption and cap model in terms of
forecasting swaptions but produces worse (out-of-sample) forecasts of caps. The N =3 cap
model outperforms the N =3 swaption and cap model in terms of forecasting ATMF caps but
produces worse (out-of-sample) forecasts of swaptions.
    We have also estimated the models with the “completely affine” market price of risk specifi-
cation. These models produce significantly worse forecasts for derivatives, especially at longer
horizons. The reason is that these models generally do not match the long run means of the
volatility state variables under the actual measure. The added flexibility of the “extended
affine” market price of risk specification therefore seems crucial for producing good forecasts
of derivatives.


7    Conclusion

We have developed a flexible stochastic volatility multi-factor model of the term structure
of interest rates. It features possibly hump-shaped innovations to the forward rate curve
and correlations between innovations to forward rates and stochastic volatility (i.e. partially
unspanned stochastic volatility). The model is highly tractable with quasi-analytical prices of
zero-coupon bond options and dynamics of the forward rate curve, under both the actual and
risk-neutral measure, in terms of a finite-dimensional affine state vector.
    We estimate the model by quasi maximum likelihood in conjunction with the extended


                                               27
Kalman filter on an extensive panel data set of LIBOR and swap rates, ATMF swaptions,
ATMF caps and, for the second half of the sample, non-ATMF caps (i.e. cap skews). With
three term structure factors and three volatility factors the model has a very good fit to
the data. Re-estimating the model on swaptions and caps separately and pricing caps and
swaptions out-of-sample reveals that swaptions were mostly undervalued relative to caps during
the first third of the sample (at least relative to our model). However, since then swaption
and cap prices appear largely consistent with each other.
       A key result is the ability of the model to match the implied cap skews and the dynamics of
implied volatilities. This hinges on the correlations between innovations to forward rates and
stochastic volatility. In relation to estimating the correlations we show that the variation in
implied volatilities across moneyness provides much stronger identification of the correlation
parameters than the variation in implied volatilities across time.
       Finally, the model performs well in terms of forecasting interest rates and interest rate
derivatives. Crucial to this result is the use of the flexible “extended affine” market price of
risk specification.
       Our model has many applications. Firstly, the ease with which the risk-neutral dynamics of
the forward rate curve can be simulated makes it useful for pricing more complex interest rate
derivatives by Monte Carlo simulations. We believe that the model will be particular useful
for valuation of mortgage-backed securities due to its careful modeling of stochastic volatility,
which is a key determinant of the value of the prepayment option.31
       Secondly, the good forecasting performance of the model, combined with the ease with
which the actual dynamics of the forward rate curve can be simulated, suggests that it will be
useful in value-at-risk applications involving portfolios of interest rate derivatives.
       Thirdly, the model can be extended to price commodity futures and options in a stochastic
volatility HJM framework. These applications are the subject of ongoing research.




  31
       Many existing MBS pricing models have difficulties matching the implied volatility skews, which in turn
lead them to misprice deep-discount MBSs with significantly out-of-the-money prepayment options. The fact
that our model has a good fit to the implied cap skews presumably makes it easier to match MBS prices across
coupons.


                                                       28
Appendix A

Proof of Proposition 1

Given (4), (3) becomes
                                            
                                           α0i  −γi (T −t)                α α
                 N
                 X          α0i α1i 1                                           0i 1i
µf (t, T ) =         vi (t)              +       e          − e−2γi (T −t) −          (T − t)e−2γi (T −t)
                              γi      γi α1i                                     γi
                 i=1
                                                                      α2                         
                   α21i 1       α0i            −γi (T −t)   −2γi (T −t)     1i         2 −2γi (T −t)
                 +          +         (T − t) e           −e             −     (T − t) e               (52)
                    γi γi α1i                                              γi

Straightforward, if slightly tedious, calculations show that
                                                  Z       t                           N Z
                                                                                      X          t               p
               f (t, T ) = f (0, T ) +                        µf (s, T )ds +                         σf,i (s, T ) vi (s)dWiQ (s)   (53)
                                                      0                               i=1   0
                                                  N
                                                  X                                         N X
                                                                                            X 6
                             = f (0, T ) +                    Bxi (T − t)xi (t) +                         Bφj,i (T − t)φj,i (t)    (54)
                                                  i=1                                           i=1 j=1

where Bxi (T − t) and Bφj,i (T − t), j = 1, ..., 6 are given in the text and
                                                      Z tp
                                       xi (t) =                         vi (s)e−γi (t−s) dWiQ (s)                                  (55)
                                                              0
                                                      Z tp
                                   φ1,i (t) =                           vi (s)(t − s)e−γi (t−s) dWiQ (s)                           (56)
                                                              0
                                                      Z           t
                                   φ2,i (t) =                         vi (s)e−γi (t−s) ds                                          (57)
                                                              0
                                                      Z           t
                                   φ3,i (t) =                         vi (s)e−2γi (t−s) ds                                         (58)
                                                              0
                                                      Z           t
                                   φ4,i (t) =                         vi (s)(t − s)e−γi (t−s) ds                                   (59)
                                                              0
                                                      Z           t
                                   φ5,i (t) =                         vi (s)(t − s)e−2γi (t−s) ds                                  (60)
                                                              0
                                                      Z           t
                                   φ6,i (t) =                         vi (s)(t − s)2 e−2γi (t−s) ds                                (61)
                                                              0

Applying Itô’s Lemma to these expressions gives the dynamics stated in the text.


Proof of Proposition 2

The proof is similar to those Duffie, Pan, and Singleton (2000) and Collin-Dufresne and Gold-
stein (2003). We can rewrite (29) as
                         R   t
                                                              h                   RT0
                                                                                                                   i
                    e−       0 rs ds   ψ(u, t, T0 , T1 ) = EtQ e−                  0    rs ds
                                                                                                ψ(u, T0 , T0 , T1 ) .              (62)

                                                                             29
since

                                   ψ(u, T0 , T0 , T1 ) = eulog(P (T0 ,T1 ))                           (63)

Therefore, the proof consist of showing that the process
                                                  R   t
                                    η(t) ≡ e−           r ds
                                                      0 s       ψ(u, t, T0 , T1 ).                    (64)

is a martingale under Q. To this end we conjecture that ψ(u, t, T0 , T1 ) is of the form (30).
Applying Ito’s Lemma to η(t) and setting the drift to zero shows that η(t) is a martingale
provided M (τ ) and Ni (τ ) satisfy (31)–(32). Furthermore, (63) holds provided that M (0) = 0
and Ni (0) = 0.


Proof of Proposition 3

Again, we follow Duffie, Pan, and Singleton (2000) and Collin-Dufresne and Goldstein (2003).
The time-t price a European put option expiring at time T0 with strike K on a zero-coupon
bond maturing at time T1 , P(t, T0 , T1 , K), is given by
                                       h    T0     R                                       i
                P(t, T0 , T1 , K) = EtQ e− t r(s)ds (K − P (T0 , T1 ))1P (T0 ,T1 )<K
                                         h     T0       R                         i
                                  = KEtQ e− t r(s)ds 1log(P (T0 ,T1 ))<log(K) −
                                       h    T0     R                                           i
                                    EtQ e− t r(s)ds elog(P (T0 ,T1 )) 1log(P (T0 ,T1 ))<log(K)

                                   = KG0,1 (log(K)) − G1,1 (log(K)),                                  (65)

where
                                  h      R T0
                                                                                                 i
                    Ga,b (y) = EtQ e−     t     r(s)ds alog(P (T0 ,T1 ))
                                                        e                    1blog(P (T0 ,T1 ))<y .   (66)

To evaluate Ga,b (y) note that its Fourier transform is given by
                                     Z
                        Ga,b (y) =       eiuy dGa,b (y)
                                       R
                                          h    T0           R              i
                                 = EtQ e− t rs ds e(a+iub)log(P (T0 ,T1 ))

                                       = ψ(a + iub, t, T0 , T1 ),                                     (67)
            √
where i =   −1. Applying the Fourier inversion theorem we have
                                           Z                                
                       ψ(a, t, T0 , T1 ) 1 ∞ Im ψ(a + iub, t, T0 , T1 )e−iuy
            Ga,b (y) =                  −                                      du.                    (68)
                              2           π 0            u

                                                                30
LIBOR and swap rates

The time-t LIBOR rate for the period t to T is given by

                                                         1 − P (t, T )
                                          L(t, T ) =                     .                                (69)
                                                        (T − t)P (t, T )

Similarly the time-t forward LIBOR rate for the period T1 to T2 is given by

                                                        P (t, T1 ) − P (t, T2 )
                                     L(t, T1 , T2 ) =                           .                         (70)
                                                        (T2 − T1 )P (t, T2 )

       In the following, consider a period length ν and a set of dates Tj = t + νj, j = 1, ..., n. The
time-t swap rate for the period t to Tn and fixed-leg payments at T1 , ..., Tn 32 is given by

                                                         1 − P (t, Tn )
                                         S(t, Tn ) =     Pn              .                                (71)
                                                        ν j=1 P (t, Tj )

Similarly, the time-t forward swap rate for the period Tm to Tn and fixed-leg payments at
Tm+1 , ..., Tn is given by
                                                        P (t, Tm ) − P (t, Tn )
                                    S(t, Tm , Tn ) =      P                     .                         (72)
                                                        ν nj=m+1 P (t, Tj )

Cap prices

A cap with payments at T2 , ..., Tn consists of n − 1 caplets expiring at these dates.33 A caplet
expiring at Tj with strike K is a call option on the LIBOR rate L(t, Tj − ν, Tj ) with the payoff

                                         χ = ν (L(Tj − ν, Tj ) − K)+                                      (73)

where K is the strike. This payoff is fixed at time Tj − ν. Easy manipulations show that the
price of the caplet at time Tj − ν equals (1 + νK) European put options, expiring at time
Tj − ν with strike 1/(1 + νK) written on a zero-coupon bond maturing at time Tj . The caplet
price at time t < Tj − ν is therefore given as
                                                                                            
                                                                                       1
                  Cpl(t, Tj − ν, Tj , Xt , K) = (1 + νK)P t, Tj − ν, Tj ,                        .        (74)
                                                                                    1 + νK
  32
       Market convention for USD swaps is semi-annual fixed-leg payments (but quarterly floating-leg payments).
Therefore ν = 1/2 in swap rate calculations. To ease notation we assume a constant period length between
payment dates. In practice, USD LIBOR derivatives (swaps and caps) are quoted on an Actual/360 basis and
in all computations in the paper we take into account the slightly varying period length between reset dates.
  33
       Market convention for USD caps is quarterly payments. Therefore ν = 1/4 in cap and caplet price calcula-
tions. Furthermore, market convention is to exclude the first caplet expiring at T1 from the cap since its cash
flow is known at time t.


                                                         31
   The time-t price of a cap with strike R and payments at T2 , ..., Tn is the sum of the prices
of the n − 1 underlying caplets
                                                  n
                                                  X
                          Cap(t, Tn , Xt , R) =         Cpl(t, Tj − ν, Tj , Xt , R).                 (75)
                                                  j=2

   When the strike R equals the the time-t forward swap rate for the period T1 to Tn with
fixed-leg payments at T2 , ..., Tn the cap price equals the floor price and the cap and floor are
at-the-money-forward.


Swaption prices by the stochastic duration approach

The time-t value of a forward payer swap for the period Tm to Tn with fixed-leg payments at
Tm+1 , ..., Tn and fixed rate K is given by
                                                                           n
                                                                           X
                   V (t, Tm , Tn ) = P (t, Tm ) − P (t, Tn ) − Kν                 P (t, Tj ).        (76)
                                                                          j=m+1

   A payer swaption is an option to enter into a payer swap with a given fixed rate. A
(Tm − t)–into–(Tn − Tm ) payer swaption, i.e. an option expiring at Tm on a payer swap for
the period Tm to Tn , with strike K has a payoff at Tm of
                                                                                               +
                                                                           n
                                                                           X
              χ = V (Tm , Tm , Tn )+ = 1 − P (Tm , Tn ) − Kν                    P (Tm , Tj ) .     (77)
                                                                         j=m+1

Hence, a payer swaption can be viewed as a put option with strike 1 on a coupon bond with
coupon rate K. In the following we let P c (t) denote the time-t value of this coupon bond.
That is,
                                                n
                                                X
                                      c
                                    P (t) =             Y (Tj )P (t, Tj ),                           (78)
                                               j=m+1

where Y (Tj ) = Kν for j = m + 1, ..., n − 1 and Y (Tn ) = 1 + Kν.
   The stochastic duration D(t) of a coupon bond is the maturity of the zero-coupon which has
the same relative volatility as the coupon bond. The stochastic duration of P c (t) is therefore
given implicitly as the solution to
                                                                                       2
                   N
                   X                           N
                                               X                 n
                                                                 X
                         vi (t)Bxi (D(t))2 =         vi (t)            wj Bxi (Tj − t) ,           (79)
                   i=1                         i=1              j=m+1




                                                      32
where wj =       P   n
                       Y (Tj )P (t,Tj )
                     j=m+1 Y (Tj )P (t,Tj )
                                              . D(t) must be found numerically, but exist and is unique if
Bxi (τ ) is uniformly decreasing, see Munk (1999).34
       Wei (1997) and Munk (1999) suggest approximating an option on a coupon bond option
with an (scaled) option on a zero-coupon bond with maturity equal to the stochastic duration
of the coupon bond. Let Swpn(t, Tm , Tn , K) denote the time-t price of a (Tm −t)–into–(Tn −Tm )
payer swaption with strike K. According to Wei (1997) and Munk (1999) this swaption price
is approximately given by
                                                                              
                                  Swpn(t, Tm , Tn , K) = ζP t, Tm , D(t), ζ −1 ,                           (80)

                   P c (t)
where ζ =      P (t,t+D(t))   is a scaling factor.


Appendix B

Let X̂t = Et [Xt ] and X̂t|t−1 = Et−1 [Xt ] denote expectations of Xt (respectively including
and excluding yt ) and let Pt and Pt|t−1 denote the corresponding estimation error covariance
matrices. Linearizing the h-function in (49) around X̂t|t−1 we obtain

                   yt = (h(X̂t|t−1 ) − Ht′ X̂t|t−1 ) + Ht′ Xt + ut ,               ut ∼ iid. N (0, S),     (81)

where
                                                       δh(Xt )
                                               Ht′ =                           .                           (82)
                                                        δXt′     Xt =X̂t|t−1

Assuming wt in (51) is Gaussian we obtain

                          Xt+1 = Φ0 + ΦX Xt + wt+1 ,                wt+1 ∼ iid. N (0, Qt ).                (83)

The Kalman filter applied to (81) and (83) yields

                                                X̂t+1|t = Φ0 + ΦX X̂t                                      (84)

                                                Pt+1|t = ΦX Pt Φ′X + Qt                                    (85)

and

                                    X̂t+1 = X̂t+1|t + Pt+1|t Ht′ Ft−1 ǫt                                   (86)

                                     Pt+1 = Pt+1|t − Pt+1|t Ht′ Ft−1 Ht Pt+1|t ,                           (87)
  34
       At the parameter estimates reported in Table 1 and 2 some Bxi (τ ) exhibit a tiny hump for very short
maturities. However, over the relevant range of maturities all Bxi (τ ) are indeed uniformly decreasing.


                                                             33
where

                                    ǫt = yt+1 − h(X̂t+1|t )                                  (88)

                                    Ft = Ht Pt+1|t Ht′ + S.                                  (89)

   The log-likelihood function is constructed from (88) and (89):
                                              T               T
                             NT         1X            1 X ′ −1
                    logL = −    log2π −    log|Ft | −    ǫt Ft ǫt ,                          (90)
                              2         2             2
                                             i=1             i=1

where T is the number of observations and N is the dimension of yt . We follow standard
practice in the literature and initialize the Kalman filter at the unconditional values of X̂t|t−1
and Pt|t−1 .




                                                  34
                          N =1                       N =2                              N =3
                    Swaptions+caps          Swaptions+caps                         Swaptions+caps
                          i=1              i=1               i=2         i=1            i=2          i=3
 κi                      0.0553           0.3694            1.0364      0.5509         1.0187       0.1330
                         (0.0039)         (0.0035)          (0.0142)    (0.0058)       (0.0159)     (0.0034)

 σi                      0.3325           0.8595            1.4397      1.0497         1.4274       0.5157
                         (0.0091)         (0.0226)          (0.0544)    (0.0365)       (0.0432)     (0.0301)

 α0,i                    0.0045           0.0006            0.0004      0.0000         0.0020       −0.0097
                         (0.0001)         (0.0000)          (0.0002)    (0.0001)       (0.0001)     (0.0003)

 α1,i                    0.0131           0.0071            0.0437      0.0046         0.0265       0.0323
                         (0.0004)         (0.0001)          (0.0006)    (0.0001)       (0.0003)     (0.0010)

 γi                      0.3341           0.2643            1.3279      0.1777         1.1623       0.8282
                         (0.0011)         (0.0008)          (0.0101)    (0.0016)       (0.0072)     (0.0028)

 ρi                      0.4615           0.2086            0.3125      0.3270         0.2268       0.1777
                         (0.0320)         (0.0280)          (0.0222)    (0.0415)       (0.0161)     (0.0555)

 κPx,i                   0.9767           1.0108            0.2358      0.7677         0.5650       0.8739
                         (0.5280)         (0.4010)          (0.3762)    (0.6107)       (0.4014)     (0.3014)

 κPxv,i                  3.4479           0.7650            1.0406      0.0988         1.7115       1.6425
                         (2.4111)         (0.8154)          (0.9727)    (1.0023)       (0.8517)     (0.6079)

 ηiP                     1.1964          −0.0500            0.3369     −1.1288         0.8528       1.0453
                         (1.9715)         (1.5427)          (0.4361)    (2.0856)       (0.6002)     (0.3243)

 κPi                     2.1476           1.8247            3.4793      2.3698         3.1794       1.7372
                         (0.3593)         (0.4561)          (0.9697)    (0.7844)       (0.7459)     (0.1383)

 θiP                     0.7542           1.9447            0.3890      2.1070         0.7875       0.6330
                         (0.0566)         (0.2324)          (0.1047)    (0.2777)       (0.1341)     (0.2171)

 ϕ                       0.0832                  0.0706                                0.0680
                         (0.0003)                (0.0002)                              (0.0003)

 σrates                  0.0054                  0.0011                                0.0004
                         (0.0000)                (0.0000)                              (0.0000)

 σderiv                  0.0288                  0.0166                                0.0126
                         (0.0001)                (0.0000)                              (0.0000)

 Log-likelihood         -58681.5                -41464.7                              -32887.5
Notes: Maximum-likelihood estimates with outer-product standard errors in parentheses. σrates denotes the
standard deviation of interest rate measurement errors and σderiv denotes the standard deviation of swaption
and cap price measurement errors. θi is normalized to one.

                                    Table 1: Parameter estimates




                                                      35
                                        N =3                                         N =3
                                     Swaptions                                       caps
                          i=1           i=2           i=3              i=1           i=2          i=3
 κi                      0.4462        1.4196        0.2997          0.2169        0.5214        0.8340
                         (0.0055)      (0.0249)      (0.0061)        (0.0236)      (0.0529)      (0.0374)

 σi                      0.9447        1.6850        0.7742          0.6586        1.0212        1.2915
                         (0.0303)      (0.0530)      (0.0302)        (0.0329)      (0.0498)      (0.0484)

 α0,i                   −0.0000        0.0018       −0.0084          0.0000        0.0014       −0.0085
                         (0.0001)      (0.0001)      (0.0003)        (0.0001)      (0.0001)      (0.0002)

 α1,i                    0.0045        0.0191        0.0255          0.0037        0.0320        0.0272
                         (0.0001)      (0.0002)      (0.0006)        (0.0001)      (0.0014)      (0.0006)

 γi                      0.1791        1.0337        0.7733          0.1605        1.4515        0.6568
                         (0.0016)      (0.0062)      (0.0038)        (0.0028)      (0.0176)      (0.0065)

 ρi                      0.2720        0.2127        0.2446          0.0035        0.0011        0.6951
                         (0.0759)      (0.0512)      (0.1073)        (0.0480)      (0.0128)      (0.0112)

 κPx,i                   0.7410        0.4469        0.6343          0.6389        0.7539        1.1133
                         (0.5811)      (0.3970)      (0.3483)        (0.4059)      (0.4392)      (0.6281)

 κPxv,i                  0.0405        1.2582        1.1604         −0.1765        1.6694        1.1955
                         (1.0299)      (0.7289)      (0.9510)        (0.3673)      (0.6164)      (0.8149)

 ηiP                    −1.1188        1.1248        1.1100         −0.9336        0.7892        1.3072
                         (2.4353)      (0.9697)      (0.3525)        (0.7350)      (0.4881)      (0.9074)

 κPi                     2.2788        3.4535        1.6181          1.4594        3.4202        3.2223
                         (0.6564)      (0.6868)      (0.3609)        (0.2192)      (0.3376)      (0.7326)

 θiP                     2.1379        1.3648        0.8107          1.4235        0.7880        1.2602
                         (0.2818)      (0.1982)      (0.1683)        (0.1706)      (0.0994)      (0.2255)

 ϕ                                     0.0681                                      0.0668
                                       (0.0002)                                    (0.0006)

 σrates                                0.0004                                      0.0004
                                       (0.0000)                                    (0.0000)

 σderiv                                0.0109                                      0.0071
                                       (0.0000)                                    (0.0000)

 Log-likelihood                       -18947.9                                     -3919.2
Notes: Maximum-likelihood estimates with outer-product standard errors in parentheses. σrates denotes the
standard deviation of interest rate measurement errors and σderiv denotes the standard deviation of swaption
and cap price measurement errors. θi is normalized to one.

                                Table 2: Parameter estimates (cont.)




                                                    36
                                                                  Model
                              1SC               2SC               3SC                3S                3C
 Interest rates              47.35              8.32              2.97              3.02              2.79
 ATMF swaptions              10.45              6.37              4.32              3.79             12.28
 ATMF caps                    7.66              4.17              3.97              6.63              1.38
 Non-ATMF caps                6.36              4.74              3.56              5.66              2.31
Notes: Mean of root mean squared pricing errors for interest rates and derivatives. For interest rates the pricing
errors are the differences between the fitted and actual interest rates. For swaptions and caps the pricing errors
are the differences between the fitted and actual prices divided by the actual prices. “1SC” denotes the N =1
swaption and cap model, “2SC” denotes the N =2 swaption and cap model, “3SC” denotes the N =3 swaption
and cap model, “3S” denotes the N =3 swaption model and “3C” denotes the N =3 cap model. Interest rate
pricing errors are measured in basis points while derivatives pricing errors are measured in percentages.

                                           Table 3: In-sample fit




                                                       37
                                                         Model comparisons
                           2SC vs. 1SC           3SC vs. 2SC            3S vs. 3SC            3C vs. 3SC
 Interest rates             −39.03∗∗∗              −5.36∗∗∗                 0.05                 −0.18
                             (−9.07)               (−9.06)                  (0.79)               (−1.02)

 ATMF swaptions              −4.08 ∗∗∗             −2.05 ∗∗∗             −0.53∗∗∗               7.96 ∗∗∗
                             (−16.07)              (−13.43)              (−9.13)                (9.55)

 ATMF caps                   −3.50∗∗∗                −0.20                2.66 ∗∗∗             −2.59∗∗∗
                             (−6.70)                 (−0.67)              (9.01)               (−5.13)

 Non-ATMF caps               −1.62∗∗∗              −1.19∗∗∗               2.10 ∗∗∗             −1.25∗∗∗
                             (−2.59)               (−4.42)                (8.96)               (−4.98)

Notes: Pairwise comparisons of the models’ fit using the Diebold and Mariano (1995) approach. The table
reports the mean differences in RMSEs with associated t-statistics in parentheses. The t-statistics are computed
using Newey and West (1987) standard errors with 12 lags. “1SC” denotes the N =1 swaption and cap model,
“2SC” denotes the N =2 swaption and cap model, “3SC” denotes the N =3 swaption and cap model, “3S”
denotes the N =3 swaption model and “3C” denotes the N =3 cap model. Interest rate pricing errors are
measured in basis points while derivatives pricing errors are measured in percentages.

                           Table 4: Statistical comparisons of in-sample fit




                                                      38
                         N =3                               N =3                            N =3
                   Swaptions+caps                       Swaptions                           Caps
 3mth                    −0.93                             −1.40∗∗                         −0.60
                         (−1.45)                           (−2.29)                         (−0.87)

 6mth                   −0.72 ∗                             −0.55                         −0.95∗∗
                        (−1.73)                             (−1.27)                       (−2.40)

 9mth                   0.86 ∗∗                            1.23 ∗∗∗                         0.65 ∗
                        (2.10)                             (2.98)                           (1.75)

 1yr                    1.94 ∗∗∗                           2.26 ∗∗∗                        1.95 ∗∗∗
                        (4.22)                             (5.02)                         (4.56)

 2yr                   −1.72∗∗∗                         −1.95∗∗∗                          −1.35∗∗∗
                       (−3.84)                          (−4.19)                           (−3.02)

 3yr                     −0.53                             −0.85∗∗                         −0.63∗
                         (−1.42)                           (−2.25)                         (−1.85)

 5yr                      0.59                               0.59                           0.26
                          (1.08)                            (1.12)                          (0.55)

 7yr                      0.11                               0.22                           0.30
                          (0.28)                            (0.54)                          (1.13)

 10yr                     0.24                               0.29                          0.66 ∗∗∗
                          (1.20)                            (1.38)                        (2.90)

 15yr                    −0.15                              −0.14                          −0.47
                         (−0.20)                            (−0.19)                        (−0.92)

Notes: The table reports the mean pricing errors for the individual LIBOR and swap rates for each of the three
N =3 models. The pricing errors are defined as the differences between the fitted rates and the actual rates and
are reported in basis points. T -statistics computed from Newey and West (1987) standard errors with 12 lags
are in parentheses. Each statistic is computed using 360 weekly observations from August 21, 1998 to July 8,
2005.

                   Table 5: Summary statistics for LIBOR and swap rate errors




                                                      39
 Tenor                                                 Option length
                1mth          3mth          6mth              1yr             2yr         3yr             5yr
                                                   N =3, Swaptions+caps
 1yr          −3.41∗∗∗       2.52 ∗∗∗      3.39 ∗∗∗        3.16 ∗∗∗         2.74 ∗∗∗    1.92 ∗∗∗         0.48
              (−4.37)        (3.66)       (4.75)           (6.67)          (6.46)      (4.21)            (0.67)

 2yr            −0.24          0.52        2.39 ∗∗∗        3.35      ∗∗∗    2.95 ∗∗∗    2.34 ∗∗∗        1.51 ∗∗
                (−0.34)       (1.09)      (5.56)           (10.07)         (9.39)      (7.02)           (2.32)

 3yr             0.40        −0.13          0.63           1.86 ∗∗∗         1.65 ∗∗∗    1.33 ∗∗∗         0.92
                (0.45)       (−0.19)        (1.27)         (5.13)          (5.96)      (3.82)            (1.32)

 5yr            −0.73       −2.19∗∗∗     −1.69∗∗∗            0.02            0.56        0.41            0.14
                (−0.85)     (−3.47)      (−3.47)             (0.04)          (1.28)      (0.75)          (0.18)

 7yr            1.73 ∗∗      −0.39         −0.58             0.59            0.43       −0.14           −0.95
               (2.20)        (−0.76)       (−1.61)           (1.22)          (0.82)     (−0.22)         (−1.16)

 10yr          3.11 ∗∗∗        0.35        −0.41             0.13           −0.92      −2.06∗∗∗        −3.36∗∗∗
               (3.25)         (0.58)       (−0.86)           (0.26)         (−1.51)    (−2.93)         (−4.09)

                                                      N =3, Swaptions
 1yr          −2.84∗∗∗         0.80        −0.15         −1.73∗∗∗          −2.00∗∗∗    −1.38∗∗          −0.93
              (−4.04)         (1.19)       (−0.20)      (−3.08)            (−3.71)     (−2.54)          (−1.19)

 2yr             0.37          0.09        0.92 ∗∗∗        0.88 ∗∗∗          0.51       0.81 ∗∗          1.09
                (0.66)        (0.30)      (3.08)           (3.10)            (1.50)     (2.13)           (1.56)

 3yr            1.54 ∗∗        0.34         0.42           0.96 ∗∗∗         0.74 ∗∗∗    1.02 ∗∗∗         1.27 ∗
               (2.15)         (0.71)        (1.42)         (3.33)          (2.63)      (2.68)           (1.75)

 5yr             0.04       −1.70∗∗∗     −1.47∗∗∗            0.00            0.71 ∗      0.99 ∗          1.09
                (0.04)      (−2.90)      (−3.46)             (0.00)         (1.80)      (1.91)           (1.45)

 7yr            1.80 ∗∗      −0.41         −0.66∗            0.51            0.72        0.58            0.07
               (2.14)        (−0.76)      (−1.95)            (1.23)          (1.55)      (1.02)          (0.10)

 10yr           2.52 ∗∗      −0.21        −0.90∗∗           −0.17           −0.70      −1.37∗∗         −2.40∗∗∗
               (2.50)        (−0.32)      (−2.11)           (−0.40)         (−1.31)    (−2.13)         (−3.27)

                                                        N =3, Caps
 1yr          −5.54∗∗∗        2.32 ∗       5.54 ∗∗∗        8.67      ∗∗∗   11.14 ∗∗∗    9.11     ∗∗∗    3.79 ∗∗∗
              (−4.65)         (1.87)      (5.17)           (12.06)         (15.92)     (11.08)         (5.16)

 2yr           5.43 ∗∗∗      7.08 ∗∗∗     10.17∗∗∗         12.65∗∗∗        12.06 ∗∗∗    8.71 ∗∗∗        3.87 ∗∗∗
               (2.88)        (4.16)       (6.53)           (9.73)          (11.54)     (8.42)          (4.63)

 3yr           8.64 ∗∗∗      8.47 ∗∗∗      9.72 ∗∗∗        11.22∗∗∗         9.07 ∗∗∗    5.65 ∗∗∗        2.10 ∗∗
               (3.31)        (3.62)       (4.76)           (6.98)          (7.74)      (5.24)           (2.44)

 5yr             1.27          0.05         0.75             2.28            1.08       −0.80           −1.38
                (0.43)        (0.02)        (0.33)           (1.19)          (0.75)     (−0.63)         (−1.32)

 7yr            −4.79       −6.32∗∗       −6.03∗∗          −4.52∗∗         −4.79∗∗∗    −5.41∗∗∗        −4.22∗∗∗
                (−1.61)     (−2.37)       (−2.55)          (−2.20)         (−2.89)     (−3.75)         (−3.45)

 10yr         −10.77∗∗∗    −12.53∗∗∗     −12.43∗∗∗      −10.81∗∗∗          −10.22∗∗∗   −9.83∗∗∗        −7.26∗∗∗
              (−3.50)       (−4.55)       (−5.03)          (−4.91)         (−5.56)     (−5.99)         (−5.04)

Notes: The table reports the mean pricing errors for the individual ATMF swaptions for each of the three N =3
models. The pricing errors are defined as the differences between the fitted and actual prices divided by the
actual prices and are reported in percentages. T -statistics computed from Newey and West (1987) standard
errors with 12 lags are in parentheses. Each statistic is computed using 360 weekly observations from August
21, 1998 to July 8, 2005.

                Table 6: Summary statistics for ATMF swaption valuation errors

                                                      40
                        N =3                              N =3                           N =3
                  Swaptions+caps                      Swaptions                           Caps
 1yr                    0.12                           −2.15∗∗                            0.40
                        (0.15)                         (−2.01)                            (0.96)

 2yr                  −2.14∗∗∗                        −6.07∗∗∗                           −0.01
                      (−3.43)                         (−7.41)                            (−0.06)

 3yr                  −2.89∗∗∗                        −6.78∗∗∗                          0.30 ∗∗∗
                      (−4.43)                         (−7.85)                           (4.52)

 4yr                  −3.08∗∗∗                        −6.69∗∗∗                           0.33 ∗∗
                      (−4.38)                         (−7.55)                           (2.38)

 5yr                  −2.92∗∗∗                        −6.26∗∗∗                            0.19
                      (−3.80)                         (−6.81)                             (1.19)

 7yr                  −1.95∗∗                         −4.93∗∗∗                            0.17
                      (−2.46)                         (−5.47)                             (0.75)

 10yr                  −0.67                          −3.48∗∗∗                            0.39
                       (−0.76)                        (−3.66)                             (1.36)

Notes: The table reports the mean pricing errors for the individual ATMF caps for each of the three N =3
models. The pricing errors are defined as the differences between the fitted and actual prices divided by the
actual prices and are reported in percentages. T -statistics computed from Newey and West (1987) standard
errors with 12 lags are in parentheses. Each statistic is computed using 360 weekly observations from August
21, 1998 to July 8, 2005.

                   Table 7: Summary statistics for ATMF cap valuation errors




                                                     41
 Moneyness                                                     Cap length
                       1yr          2yr          3yr              4yr          5yr        7yr        10yr
                                                   N =3, Swaptions+caps
 0.80                 0.22         0.11         0.25             0.11         0.20      0.56 ∗∗∗    1.31 ∗∗∗
                      (0.80)       (0.35)       (1.12)           (0.76)       (1.36)   (3.38)      (4.94)

 0.90                 0.20        −0.46        −0.20            −0.22∗        0.03      0.61 ∗∗∗    1.44 ∗∗∗
                      (0.51)      (−1.58)      (−1.25)          (−1.80)       (0.24)   (3.04)      (4.40)

 1.00                1.55 ∗∗∗    −1.06∗∗∗     −0.73∗∗∗         −0.69∗∗∗      −0.28       0.30       1.50 ∗∗∗
                    (2.73)       (−3.46)      (−4.85)          (−3.93)       (−1.40)     (1.14)    (3.17)

 1.10                 2.77 ∗     −2.19∗∗∗     −1.76∗∗∗         −1.58∗∗∗     −0.96∗∗∗    −0.22       1.51 ∗∗∗
                     (1.74)      (−4.36)      (−6.66)          (−6.52)      (−3.33)     (−0.60)    (2.90)

 1.20                 4.15       −4.17∗∗∗     −3.64      ∗∗∗   −2.83∗∗∗     −2.53∗∗∗   −1.20∗∗∗      0.12
                      (1.17)     (−6.37)      (−11.52)         (−6.41)      (−6.66)    (−3.08)       (0.17)

                                                          N =3, Swaptions
 0.80                 0.02       −1.39∗∗∗     −1.56∗∗∗         −1.70∗∗∗     −1.57∗∗∗   −1.15∗∗∗     −0.40
                      (0.04)     (−3.66)      (−5.77)          (−8.24)      (−7.88)    (−5.43)      (−1.37)

 0.90                −0.23       −2.60∗∗∗     −2.60∗∗∗          −2.58 ∗∗∗ −2.25 ∗∗∗ −1.58∗∗∗       −0.73∗∗
                     (−0.36)     (−6.36)      (−9.42)          (−12.05)     (−10.72)   (−6.29)     (−2.05)

 1.00                 0.38       −4.04∗∗∗     −3.85 ∗∗∗ −3.67 ∗∗∗ −3.16 ∗∗∗ −2.42∗∗∗               −1.19∗∗
                      (0.37)     (−8.45)      (−12.35)         (−15.23)     (−12.20)   (−7.96)     (−2.41)

 1.10                −0.29       −6.16∗∗∗     −5.65 ∗∗∗ −5.27 ∗∗∗ −4.47 ∗∗∗ −3.49∗∗∗               −1.76∗∗∗
                     (−0.18)     (−9.75)      (−14.64)         (−18.62)     (−13.97)   (−8.43)     (−3.32)

 1.20                −1.01       −9.17 ∗∗∗ −8.36 ∗∗∗ −7.21 ∗∗∗ −6.66 ∗∗∗ −5.09 ∗∗∗ −3.69∗∗∗
                     (−0.34)     (−11.48)     (−17.47)         (−15.35)     (−17.51)   (−11.08)    (−5.15)

                                                               N =3, Caps
 0.80                0.24 ∗∗       0.07         0.24            −0.04        −0.17      −0.22∗       0.29
                     (2.02)        (0.27)       (1.00)          (−0.28)      (−1.39)   (−1.87)       (1.53)

 0.90                 0.05        −0.32         0.16             0.01        −0.02      −0.05       0.39 ∗∗∗
                      (0.32)      (−1.12)       (0.80)           (0.09)      (−0.31)    (−0.66)    (2.72)

 1.00                 0.48       −0.55∗∗∗      0.31 ∗∗∗          0.24         0.28      −0.03        0.48 ∗
                      (1.41)     (−3.22)      (5.11)             (1.31)       (1.51)    (−0.18)     (1.77)

 1.10                 1.29       −0.88∗∗∗      0.44 ∗∗           0.48         0.54      −0.04       0.62 ∗∗
                      (0.82)     (−3.90)       (1.97)            (1.29)       (1.36)    (−0.11)     (2.41)

 1.20                 1.59       −1.51∗∗∗       0.31             0.76         0.31      −0.26       −0.54
                      (0.46)     (−3.70)        (0.73)           (1.17)       (0.46)    (−0.72)     (−1.11)

Notes: The table reports the mean pricing errors for the individual in-the-money and out-of-the-money caps for
each of the three N =3 models. The pricing errors are defined as the differences between the fitted and actual
prices divided by the actual prices and are reported in percentages. T -statistics computed from Newey and
West (1987) standard errors with 12 lags are in parentheses. Each statistic is computed using a maximum of
184 weekly observations from January 4, 2002 to July 8, 2005.

                 Table 8: Summary statistics for non-ATMF cap valuation errors




                                                        42
                                                                 Model
                                         1SC         2SC          3SC           3S          3C          RW
 Interest rates          4wks           21.17        20.70       20.65        20.76       20.66        22.27
                         8wks           32.50        31.29       31.38        31.67       31.35        34.83
                         16wks          51.23        47.95       47.97        48.77       47.66        55.15

 ATMF swaptions          4wks            7.72        7.75         7.77        7.75         8.01         7.72
                         8wks           10.67        10.59       10.63        10.58       11.27        10.83
                         16wks          14.00        13.54       13.58        13.46       14.79        14.56

 ATMF caps               4wks            7.83        7.81         7.75        7.78         7.66         8.01
                         8wks           10.69        10.53       10.34        10.40       10.08        11.13
                         16wks          14.68        14.17       13.72        13.81       13.24        15.79

 Non-ATMF caps           4wks            7.42        7.43         7.43        7.47         7.49         7.54
                         8wks           10.27        10.19       10.18        10.25       10.27        10.50
                         16wks          14.47        14.02       13.85        13.98       13.74        14.47
Notes: Mean of root mean squared forecating errors. For interest rates the forecast errors are the differences
between the predicted and actual interest rate changes. For swaptions and caps the forecast errors are the
differences between the predicted and actual percentage price changes. “1SC” denotes the N =1 swaption and
cap model, “2SC” denotes the N =2 swaption and cap model, “3SC” denotes the N =3 swaption and cap model,
“3S” denotes the N =3 swaption model, “3C” denotes the N =3 cap model, and “RW” denotes the random walk
model for interest rates and derivatives prices. Interest rate forecast errors are measured in basis points while
derivative forecast errors are measured in percentages.

                                    Table 9: Forecasting performance




                                                       43
                                                                Model comparisons
                                       2SC vs.       3SC vs.         3S vs.         3C vs.        RW vs.
                                         1SC            2SC           3SC            3SC            3SC
 Interest rates         4wks            −0.48          −0.05          0.11           0.01         1.62 ∗∗∗
                                        (−1.34)       (−0.24)         (1.62)         (0.06)       (3.26)

                        8wks            −1.21           0.08          0.29 ∗        −0.03         3.45 ∗∗∗
                                        (−1.31)        (0.15)        (1.87)         (−0.10)       (2.73)

                        16wks           −3.27           0.01         0.80 ∗∗        −0.31         7.18 ∗∗∗
                                        (−1.63)        (0.01)        (2.12)         (−0.38)       (2.75)

 ATMF swaptions         4wks             0.03           0.03         −0.02           0.24          −0.05
                                         (0.38)        (1.32)        (−0.98)         (1.30)        (−0.28)

                        8wks            −0.08           0.04         −0.05           0.64           0.19
                                        (−0.56)        (0.99)        (−1.46)         (1.31)        (0.45)

                        16wks          −0.47∗           0.04        −0.12∗∗          1.21           0.98
                                       (−1.73)         (0.48)       (−2.18)          (1.05)        (1.10)

 ATMF caps              4wks            −0.02          −0.05          0.03          −0.09          0.26 ∗
                                        (−0.24)       (−1.38)         (0.93)        (−1.13)        (1.92)

                        8wks            −0.15        −0.19∗∗          0.06          −0.26         0.78 ∗∗∗
                                        (−0.75)      (−1.97)          (1.02)        (−1.59)       (2.69)

                        16wks           −0.51        −0.45∗∗          0.09          −0.48         2.07 ∗∗∗
                                        (−1.36)      (−2.43)          (1.14)        (−1.62)       (3.31)

 Non-ATMF caps          4wks             0.01           0.00          0.04           0.06           0.11
                                         (0.12)        (0.04)         (1.01)         (0.52)        (0.60)

                        8wks            −0.08          −0.01          0.07           0.08           0.32
                                        (−0.43)       (−0.09)         (0.87)         (0.35)        (0.77)

                        16wks           −0.45          −0.18          0.13          −0.11           0.62
                                        (−1.22)       (−0.89)         (0.92)        (−0.29)        (0.70)

Notes: Pairwise comparisons of the models’ forecasting performance using the Diebold and Mariano (1995)
approach. The table reports the mean differences in RMSEs with associated t-statistics in parentheses. The
t-statistics are computed using Newey and West (1987) standard errors with 12 lags. “1SC” denotes the N =1
swaption and cap model, “2SC” denotes the N =2 swaption and cap model, “3SC” denotes the N =3 swaption
and cap model, “3S” denotes the N =3 swaption model, “3C” denotes the N =3 cap model, and “RW” denotes
the random walk model for interest rates and derivatives prices. Interest rate forecast errors are measured in
basis points while derivative forecast errors are measured in percentages.

                   Table 10: Statistical comparisons of forecasting performance




                                                     44
replacemen




             0.09

             0.08

             0.07

             0.06

             0.05

             0.04

             0.03

             0.02

             0.01

                0                                                                            15
             Jan98
                     Jan00                                                         10

                               Jan02                                          7
                                                                          5
                                         Jan04                        3       LIBOR/swap maturity
                                                                  2
                                                              1
                                                   Jan06 0.25


Figure 1: Time series of LIBOR and swap rates
Each time series consists of 360 weekly observations from August 21, 1998 to July 8, 2005. Source: Bloomberg.




                                                     45
          Panel A: 1yr-tenor swaption                               Panel B: 2yr-tenor swaption



  0.8
                                                          0.6
  0.6
                                                          0.4
  0.4

  0.2                                                     0.2

                                                5                                                       5
 Jan98                                                Jan98
      Jan00                            3                        Jan00                          3
           Jan02                   2                                 Jan02                 2
                Jan04            1 Option                                 Jan04          1 Option
                     Jan06         maturity                                    Jan06       maturity



          Panel C: 3yr-tenor swaption                              Panel D: 5yr-tenor swaption



                                                          0.5
  0.6
                                                          0.4
  0.4                                                     0.3
                                                          0.2
  0.2
                                                          0.1
                                                5                                                       5
 Jan98                                                Jan98
      Jan00                              3                      Jan00                            3
           Jan02                    2                                Jan02                 2
                Jan04             1 Option                                Jan04          1 Option
                     Jan06          maturity                                   Jan06       maturity



          Panel E: 7yr-tenor swaption                              Panel F: 10yr-tenor swaption



                                                          0.4
  0.4
                                                          0.3
  0.3

  0.2                                                     0.2

  0.1                                                     0.1
                                                5                                                       5
 Jan98                                                Jan98
      Jan00                              3                      Jan00                            3
           Jan02                    2                                Jan02                   2
                Jan04             1 Option                                Jan04          1   Option
                     Jan06          maturity                                   Jan06         maturity

Figure 2: Time series of log-normal implied ATMF swaption volatilities
Each time series consists of 360 weekly observations from August 21, 1998 to July 8, 2005. Source: Bloomberg.



                                                     46
             0.6


             0.5


             0.4


             0.3


             0.2


            0.1
                                                                                             10
           Jan98
                     Jan00                                                         7

                               Jan02                                        5
                                                                        4
                                         Jan04                      3       Cap maturity
                                                                2
                                                   Jan06    1


Figure 3: Time series of log-normal implied ATMF cap volatilities
Each time series consists of 360 weekly observations from August 21, 1998 to July 8, 2005. Source: Bloomberg.




                                                     47
             Panel A: 1yr cap skew                                   Panel B: 2yr cap skew



 0.05                                                   0.05

    0                                                      0

 -0.05                                        0.8       -0.05                                           0.8
Oct01                                    0.9           Oct01                                     0.9
      Oct02                           1                      Oct02                           1
           Oct03                 1.1 Moneyness                    Oct03                 1.1 Moneyness
                Oct04                                                  Oct04
                     Oct05   1.2                                            Oct05   1.2


             Panel C: 3yr cap skew                                  Panel D: 4yr cap skew



  0.05                                                  0.05

    0                                                      0

 -0.05                                           0.8    -0.05                                           0.8
Oct01                                      0.9         Oct01                                     0.9
      Oct02                           1                      Oct02                           1
           Oct03                 1.1 Moneyness                    Oct03                 1.1 Moneyness
                Oct04                                                  Oct04
                     Oct05   1.2                                            Oct05   1.2


             Panel E: 5yr cap skew                                   Panel F: 7yr cap skew



  0.05                                                  0.05

    0                                                      0

 -0.05                                           0.8    -0.05                                           0.8
Oct01                                      0.9         Oct01                                     0.9
      Oct02                           1                      Oct02                           1
           Oct03                 1.1 Moneyness                    Oct03                 1.1 Moneyness
                Oct04                                                  Oct04
                     Oct05   1.2                                            Oct05   1.2


             Panel G: 10yr cap skew



  0.05

    0

 -0.05                                           0.8
Oct01                                      0.9
      Oct02                             1
           Oct03                   1.1 Moneyness
                Oct04
                     Oct05   1.2


Figure 4: Time series of log-normal implied cap skews
The skews are the differences between the implied volatilities across moneyness and the implied volatilities
of the corresponding ATMF caps. “Moneyness” of a given cap is defined as the ratio between its strike and
the strike on the ATMF cap with the same maturity. Each time series consists of a maximum of 184 weekly
observations from January 4, 2002 to July 8, 2005. Source: Bloomberg.
                        Panel A: σf,i (τ )                                         Panel B: vi (t)
0.012                                                               5


  0.01
                                                                    4

0.008
                                                                    3

0.006
                                                                    2
0.004

                                                                    1
0.002


     0                                                              0
         0   2      4     6     8     10     12     14   16        Jan98   Jan00       Jan02     Jan04      Jan06



Figure 5: σf,i (τ ) and vi (t) for the N =3 swaption and cap model
Panel A displays σf,i (τ ) and Panel B displays vi (t). ’—’ denote σf,1 (τ ) and v1 (t), ’– · –’ denote σf,2 (τ ) and
v2 (t), and ’· · · ’ denote σf,3 (τ ) and v3 (t).




                                                              49
                  Panel A: Response to v1 (t)-shock                       Panel D: Response to x1 (t)-shock



             8                                                       0

             6
                                                                    -2
  Percent




                                                          Percent
             4
                                                                    -4
             2

             0                                        5             -6                                        5
            1 2                                                     1 2
                  3                              3                        3                              3
                      5                       2                               5                       2
                            7              1 Option                                 7              1 Option
                          Tenor   10   0                                          Tenor   10   0



                  Panel B: Response to v2 (t)-shock                       Panel E: Response to x2 (t)-shock



                                                                     0
            10
                                                                    -2
  Percent




                                                          Percent




             5
                                                                    -4

             0                                        5             -6                                        5
            1 2                                                     1 2
                  3                              3                        3                              3
                      5                       2                               5                       2
                            7              1 Option                                 7              1 Option
                          Tenor   10   0                                          Tenor   10   0



                  Panel C: Response to v3 (t)-shock                       Panel F: Response to x3 (t)-shock



             4                                                       0

             3
                                                                    -2
                                                          Percent
  Percent




             2
                                                                    -4
             1

             0                                        5             -6                                        5
            1 2                                                     1 2
                  3                              3                      3                                3
                      5                       2                               5                       2
                            7              1 Option                                 7              1 Option
                          Tenor   10   0                                          Tenor   10   0



Figure 6: Dynamics of the log-normal implied swaption volatility surface
Panel A, B and C show the impact on the log-normal implied swaption volatility surface from one-standard
deviation shocks to v1 (t), v2 (t) and v3 (t), respectively. Panel D, E and F show the impact on the log-normal
implied swaption volatility surface from one-standard deviation shocks to x1 (t), x2 (t) and x3 (t), respectively.
We assume that the zero-coupon curve and v1 (t), v2 (t) and v3 (t) are initially equal to their sample averages.
The responses are computed on the basis of the parameter estimates for the N =3 swaption and caps model.
        Panel A: Response to x1 (t) and v1 (t) shocks                                            AT M F )/∂ρ
                                                                               Panel D: ∂(σLN − σLN         1
          3
               2
               1                                                        1

               0                                                       0.5
    Percent




                                                             Percent
              -1                                                        0
              -2                                                   -0.5
              -3
                                                                       -1                                             1.2
              -4                                                       1 2                                      1.1
                                                                              3 4
                                                                                  5                          1
              -5                                                                      7                0.9 Moneyness
                   1   2   3   4 5        7     10                           Cap maturity   10   0.8
                               Cap maturity

                                                                                                  AT M F )/∂ρ
                                                                                Panel E: ∂(σLN − σLN
        Panel B: Response to x2 (t) and v2 (t) shocks                                                        2
         10


                                                                        4
               5
                                                                        2
    Percent




                                                             Percent




                                                                        0

               0                                                        -2

                                                                       -4                                             1.2
                                                                       1 2                                      1.1
                                                                              3 4
                                                                                  5                          1
              -5                                                                      7                0.9 Moneyness
                   1   2   3   4 5        7     10                           Cap maturity   10   0.8
                               Cap maturity

        Panel C: Response to x3 (t) and v3 (t) shocks                                            AT M F )/∂ρ
                                                                               Panel F: ∂(σLN − σLN         3
          3
               2
               1                                                        1

              0                                                        0.5
    Percent




                                                             Percent




              -1                                                        0
              -2                                                   -0.5
              -3
                                                                       -1                                             1.2
              -4                                                       1 2                                      1.1
                                                                              3 4
                                                                                  5                          1
              -5                                                                      7                0.9 Moneyness
                   1   2   3   4 5        7     10                           Cap maturity   10   0.8
                               Cap maturity

Figure 7: Dynamics of the log-normal implied cap skew volatility surface
Panel A, B and C show the impact on log-normal implied ATMF cap volatilities from one-standard deviation
shocks to x1 (t) and v1 (t), x2 (t) and v2 (t), and x3 (t) and v3 (t), respectively. ’—’ denotes shocks to xi (t) and
’– · –’ denotes shocks to vi (t). Panel D, E and F show the derivatives of the differences between non-ATMF
and ATMF log-normal implied volatilities with respect to ρ1 , ρ2 and ρ3 , respectively. We assume that the
zero-coupon curve and v1 (t), v2 (t) and v3 (t) are initially equal to their sample averages. The responses are
computed on the basis of the parameter estimates for the N =3 swaption and caps model.
                       Panel A: RMSE of interest rates                  PanelB: RMSE of ATMF swaption prices
                 15                                                     35

                                                                        30

                                                                        25
                 10
  Basis points




                                                              Percent
                                                                        20

                                                                        15
                  5
                                                                        10

                                                                         5

                  0                                                      0
                 Jan98     Jan00   Jan02    Jan04   Jan06               Jan98   Jan00   Jan02   Jan04   Jan06




                      Panel C: RMSE of ATMF cap prices                   Panel D: RMSE of non-ATMF cap prices
                 20                                                     20



                 15                                                     15
  Percent




                                                              Percent




                 10                                                     10



                  5                                                      5



                  0                                                      0
                 Jan98     Jan00   Jan02    Jan04   Jan06               Oct01   Oct02   Oct03   Oct04   Oct05



Figure 8: Time-series of RMSEs for interest rates, swaptions and caps
Panel A shows RMSEs of the basis point differences between the actual and fitted interest rates. Panel B shows
RMSEs of the percentage differences between the actual and fitted ATMF swaption prices. Panel C shows
RMSEs of the percentage differences between the actual and fitted ATMF cap prices. Panel D shows RMSEs
of the percentage differences between the actual and fitted non-ATMF cap prices. ’· · · ’ denotes the RMSEs of
the N =3 model fitted to term structures and swaptions. ’—’ denotes the RMSEs of the N =3 model fitted to
term structures and caps. In panel A-C each time series consists of 360 weekly observations from August 21,
1998 to July 8, 2005. In panel D each time series consists of 184 weekly observations from January 4, 2002 to
July 8, 2005.




                                                         52
Panel A: Mean actual and fitted term structure Panel B: Mean simulated term structure
  0.08                                        0.08

  0.07                                                       0.07

  0.06                                                       0.06

  0.05                                                       0.05

  0.04                                                       0.04

  0.03                                                       0.03

  0.02                                                       0.02

  0.01                                                       0.01
     0.251 2 3       5     7       10             15             0.251 2 3      5    7        10            15

 Figure 9: Means of actual, fitted and simulated term structures
 Panel A shows the means of the actual (’—’) and fitted (’– · –’) term structures in the case of the N =3 swaptions
 and caps model. Means are computed over 360 weekly observations from August 21, 1998 to July 8, 2005. In
 Panel B we first simulate 1000 term structure samples each of length of 360. We then compute the mean term
 structure for each sample to obtain the small-sample distribution of the mean term structure generated by the
 model. Panel B shows the mean (’—’) and the 2.5 and 97.5 percentiles (’· · · ’) of this distribution.




                                                        53
                       Panel A: Mean actual implied vols                              Panel B: Mean fitted implied vols




                 120                                                            120
  Basis points




                                                                 Basis points
                 100                                                            100


                  80                                                             80

                                                            5                                                              5
                  1 2                                                            1 2
                      3                                3                             3                                3
                            5                      2                                       5                      2
                                   7             1 Option                                         7             1 Option
                                Tenor   10   0                                                 Tenor   10   0




                   Panel C: Mean simulated implied vols                               Panel D: 95% confidence intervals




                 120                                                            120
  Basis points




                                                                 Basis points




                 100                                                            100


                  80                                                            80

                                                            5                                                              5
                  1 2                                                            1 2
                      3                                3                             3                                3
                            5                      2                                       5                      2
                                   7             1 Option                                         7             1 Option
                                Tenor   10   0                                                 Tenor   10   0



Figure 10: Means of actual, fitted and simulated normal implied swaption volatility surfaces
Panel A shows the mean of the actual normal implied volatility surface. Panel B shows the mean of the fitted
normal implied volatility surface in the case of the N =3 swaptions and caps model. Means are computed
over 360 weekly observations from August 21, 1998 to July 8, 2005. In Panel C and D we first simulate
1000 samples, each of length of 360, of normal implied swaption volatility surfaces. We then compute the
mean volatility surface for each sample to obtain the small-sample distribution of the mean volatility surface
generated by the model. Panel C shows the mean of this distribution while Panel D shows the 2.5 and 97.5
percentiles of this distribution.




                                                                54
             Panel A: Mean actual and fitted implied vols                         Panel B: Mean simulated implied vols
              130                                                           130

                  120                                                       120

                  110                                                       110
   Basis points




                                                             Basis points
                  100                                                       100

                   90                                                        90

                   80                                                        80

                   70                                                       70

                        1   2   3   4 5        7   10                              1   2   3   4 5        7       10
                                    Cap maturity                                               Cap maturity

Figure 11: Means of actual, fitted and simulated normal implied cap volatilities
Panel A shows the means of the actual (’—’) and fitted (’– · –’) normal implied ATMF cap volatilities in the
case of the N =3 swaptions and caps model. Means are computed over 360 weekly observations from August 21,
1998 to July 8, 2005. In Panel B we first simulate 1000 samples, each of length of 360, of normal implied ATMF
cap volatilities. We then compute the mean volatilities for each sample to obtain the small-sample distribution
of the mean volatilities generated by the model. Panel B shows the mean (’—’) and the 2.5 and 97.5 percentiles
(’· · · ’) of this distribution.




                                                        55
                       30




                       20




                       10
             Percent




                        0




                       -10




                       -20




                       -30
                        Jan98       Jan00             Jan02              Jan04             Jan06



Figure 12: Time-series of mis-valuations of caps and swaptions
’—’ denotes the average ATMF swaption valuation errors at each date according to the N =3 model estimated
on caps. In this case averages are taken over swaptions with combined swap and option maturities not exceeding
ten years. ’· · · ’ denotes the average ATMF cap valuation errors and ’– –’ denotes the average non-ATMF cap
valuation errors at each date according to the N =3 model estimated on swaptions.




                                                     56
               Panel A: 1yr cap skew                                    Panel B: 2yr cap skew

 0.04                                                      0.04

 0.02                                                      0.02

    0                                                         0

-0.02                                                     -0.02

        0.8     0.9      1          1.1       1.2                 0.8     0.9      1          1.1       1.2
                      Moneyness                                                 Moneyness
               Panel C: 3yr cap skew                                    Panel D: 4yr cap skew

 0.04                                                      0.04

 0.02                                                      0.02

    0                                                         0

-0.02                                                     -0.02

        0.8     0.9      1          1.1       1.2                 0.8     0.9      1          1.1       1.2
                      Moneyness                                                 Moneyness
               Panel E: 5yr cap skew                                    Panel F: 7yr cap skew

 0.04                                                      0.04

 0.02                                                      0.02

    0                                                         0

-0.02                                                     -0.02

        0.8     0.9      1          1.1       1.2                 0.8     0.9      1          1.1       1.2
                      Moneyness                                                 Moneyness
              Panel G: 10yr cap skew

 0.04

 0.02

    0

-0.02

        0.8     0.9      1          1.1       1.2
                      Moneyness


Figure 13: Average fit to log-normal implied cap skews
’—’ denotes the average of the actual skews. ’– · –’ denotes the average of the fitted skews for the N =3 model
estimated on caps data. ’· · · ’ denotes the average of the fitted skews for the N =3 model estimated on caps
data with the correlation parameters restricted to zero. The skews are the differences between the implied
volatilities across moneyness and the implied volatilities of the corresponding ATMF caps. “Moneyness” of a
given cap is defined as the ratio between its strike and the strike on the ATMF cap with the same maturity.
Averages are taken over a maximum of 184 weekly observations from January 4, 2002 to July 8, 2005. Data
source: Bloomberg.
             Panel A: Actual ρ(∆σLN , ∆F )                          Panel D: Actual ρ(∆σN , ∆F )



    1                                                      1

  0.5                                                    0.5

    0                                                     0

  -0.5                                                  -0.5

   -1                                            5       -1                                              5
   1 2                                                   1 2
         3                                3                  3                                     3
               5                       2                             5                       2
                     7              1 Option                                7             1 Option
                   Tenor   10   0                                        Tenor   10   0



     Panel B: Mean simulated ρ(∆σLN , ∆F )                     Panel E: Mean simulated ρ(∆σN , ∆F )



    1                                                      1

  0.5                                                    0.5

    0                                                     0

  -0.5                                                  -0.5

   -1                                            5       -1                                              5
   1 2                                                   1 2
         3                                3                  3                                     3
               5                       2                             5                       2
                     7              1 Option                               7              1 Option
                   Tenor   10   0                                        Tenor   10   0



    Panel C: 95% conf. int. of ρ(∆σLN , ∆F )                   Panel F: 95% conf. int. of ρ(∆σN , ∆F )



    1                                                      1

  0.5                                                    0.5

    0                                                     0

  -0.5                                                  -0.5

   -1                                            5       -1                                              5
   1 2                                                   1 2
         3                                3                  3                                  3
               5                       2                             5                       2
                     7              1 Option                               7              1 Option
                   Tenor   10   0                                        Tenor   10   0



Figure 14: Reproducing the implied volatility – interest rate correlations
Panel A shows the actual correlations between changes in log-normal implied swaption volatilities and changes
in the underlying forward swap rates, ρ(∆σLN , ∆F ). Panel D shows the actual correlations between changes
in normal implied swaption volatilities and changes in the underlying forward swap rates, ρ(∆σN , ∆F ). Each
correlation is computed using 360 weekly observations from August 21, 1998 to July 8, 2005. In Panel B, C,
E and F we first simulate 1000 samples, each of length of 360, of log-normal and normal implied swaption
volatilities and the underlying forward swap rates. We then compute ρ(∆σLN , ∆F ) and ρ(∆σN , ∆F ) for each
sample to obtain the small-sample distributions of the correlation parameters generated by the model. Panel B
and C show the mean and 2.5 and 97.5 percentiles, respectively, of the ρ(∆σLN , ∆F )-distributions while Panel
E and F show the mean and 2.5 and 97.5 percentiles, respectively, of the ρ(∆σN , ∆F )-distributions.
References

Andersen, L. and R. Brotherton-Ratciffe (2005): “Extended Libor market models
    with stochastic volatility,” Journal of Computational Finance, 9.

Andersen, T. G. and L. Benzoni (2005): “Can bonds hedge volatility risk in the U.S.
    treasury market? A specification test for affine term structure models,” Working paper,
    Kellogg School of Management, Northwestern University.

Bikbov, R. and M. Chernov (2004): “Term structure and volatility: Lessons from the
    Eurodollar markets,” Working paper, Columbia University.

Black, F. (1976): “The pricing of commodity contracts,” Journal of Financial Economics,
    3:167–179.

Blyth, S. and J. Uglum (1999): “Rates of skew,” Risk.

Brace, A., D. Gatarek, and M. Musiela (1997): “The market model of interest rate
    dynamics,” Mathematical Finance, 7:127–155.

Casassus, J., P. Collin-Dufresne, and R. Goldstein (2005): “Unspanned stochastic
    volatility and fixed income derivatives pricing,” Journal of Banking and Finance, 29:2723–
    2749.

Cheredito, P., D. Filipovic, and R. Kimmel (2003): “Market price of risk specifica-
    tions for affine models: Theory and evidence,” Working paper, Princeton University,
    forthcoming in Journal of Financial Economics.

Chiarella, C. and O. K. Kwon (2003): “Finite dimensional affine realisations of HJM
    models in terms of forward rates and yields,” Review of Derivatives Research, 5:129–155.

Collin-Dufresne, P. and R. Goldstein (2002a):             “Do bonds span the fixed income
    markets? Theory and evidence for unspanned stochastic volatility,” Journal of Finance,
    57:1685–1730.

            (2002b): “Pricing swaption within an affine framework,” Journal of Derivatives,
    pages 1–18.

            (2003): “Generalizing the affine framework to HJM and random field models,”
    Working paper, U.C. Berkeley.

                                             59
Collin-Dufresne, P., R. Goldstein, and C. Jones (2003): “Identification and estima-
    tion of ’maximal’ affine term structure models: An application to stochastic volatility,”
    Working paper, U.C. Berkeley.

Dai, Q. and K. Singleton (2000): “Specification analysis of affine term structure models,”
    Journal of Finance, 55:1943–1978.

              (2002): “Expectations puzzles, time-varying risk premia, and affine models of the
    term structure,” Journal of Financial Economics, 63:415–442.

de Jong, F. and P. Santa-Clara (1999): “The dynamics of the forward interest rate curve:
    A formulation with state variables,” Journal of Financial and Quantitative Analysis,
    34:131–157.

Diebold, F. and R. Mariano (1995): “Comparing predctive accuracy,” Journal of Business
    and Economic Statistics, 13:253–263.

Duffee, G. (2002): “Term premia and interest rate forecasts in affine models,” Journal of
    Finance, 57:405–443.

Duffee, G. and R. Stanton (2004):            “Estimation of dynamic term structure models,”
    Working paper, U.C. Berkeley.

Duffie, D. and R. Kan (1996): “A yield-factor model of interest rates,” Mathematical
    Finance, 6:379–406.

Duffie, D., J. Pan, and K. Singleton (2000): “Transform analysis and asset pricing for
    affine jump-diffusions,” Econometrica, 68:1343–1376.

Fisher, M. and C. Gilles (1996):           “Estimating exponential-affine models of the term
    structure,” Working paper, Federal Reserve Board.

Hamilton, J. D. (1994): Time Series Analysis, Princeton University Press, Princeton, New
    Jersey.

Han, B. (2004): “Stochastic volatilities and correlations of bond yields,” Working paper,
    Ohio State University.

Harvey, A. C. (1989): Forecasting, Structural Time Series Models and the Kalman Filter,
    Cambridge University Press.

                                               60
Heath, D., R. Jarrow, and A. Morton (1992): “Bond pricing and the term structure
    of interest rates: A new methodology for contingent claims valuation,” Econometrica,
    60:77–105.

Heidari, M. and L. Wu (2003): “Are interest rate derivatives spanned by the term structure
    of interest rates?,” Journal of Fixed Income, 13:75–86.

Heston, S. (1993): “A closed form solution for options with stochastic volatility,” Review of
    Financial Studies, 6:327–343.

Ho, T. and S. Lee (1986): “Term structure movements and pricing interest rate contingent
    claims,” Journal of Finance, 41:1011–1029.

Hull, J. and A. White (1990):         “Pricing interest-rate-derivative securities,” Review of
    Financial Studies, 3:573–592.

Jamshidian, F. (1997):        “Libor and swap market models and measures,” Finance and
    Stochastics, 1:293–330.

Jarrow, R., H. Li, and F. Zhao (2004):           “Interest rate caps ’smile’ too! But can the
    LIBOR market models capture it?,” Working paper, Cornell University, forthcoming in
    Journal of Finance.

Li, H. and F. Zhao (2006): “Unspanned stochastic volatlity: Evidence from hedging interest
    rate drivatives,” Journal of Finance, 61:341–378.

Litterman, R. and J. Scheinkman (1991):            “Common factors affecting bond returns,”
    Journal of Fixed Income, 1:54–61.

Longstaff, F., P. Santa-Clara, and E. Schwartz (2001): “The relative valuation of
    caps and swaptions: Theory and evidence,” Journal of Finance, 56:2067–2109.

Lund, J. (1997): “Econometric analysis of continuous-time arbitrage-free models of the term
    structure of interest rates,” Working paper, Aarhus School of Business.

Miltersen, K., K. Sandmann, and D. Sondermann (1997): “Closed form solutions for
    term structure derivatives with log-normal interest rates,” Journal of Finance, 52:409–
    430.



                                              61
Munk, C. (1999): “Stochastic duration and fast coupon bond option pricing in multi-factor
    models,” Review of Derivatives Research, 3:157–181.

Nelson, C. and A. Siegel (1987): “Parsimonious modeling of yield curves.,” Journal of
    Business, 60:473–489.

Newey, W. and K. West (1987): “A simple, positive semi-definit, heteroscedasticity and
    autocorrelation consistent covariance matrix,” Econometrica, 55:703–708.

Ritchkin, P. and I. Chuang (1999): “Interest rate option pricing with volatility humps,”
    Review of Derivatives Research, 3:237–262.

Schrager, D. and A. Pelsser (2005): “Pricing swaption in affine term structure models,”
    Working paper, Erasmus University, forthcoming in Mathematical Finance.

Singleton, K. and L. Umantsev (2002): “Pricing coupon-bond options and swaptions in
    affine term structure models,” Mathematical Finance, 12:427–446.

Umantsev, L. (2001): “Econometric analysis of European LIBOR-based options within affine
    term structure models,” Ph.D. dissertation, Stanford University.

Wei, J. (1997): “A simple approach to bond option pricing,” Journal of Futures Markets,
    17:131–160.

Wu, L. and F. Zhang (2005): “Fast swaption pricing under a market model with stochastic
    volatility,” Working paper, Hong Kong University of Science and Technology.

Zhou, F. (2003): “Black smirks,” Risk.




                                            62
