                                      NBER WORKING PAPER SERIES




                MONETARY EXCHANGE IN OVER-THE-COUNTER MARKETS:
A THEORY OF SPECULATIVE BUBBLES, THE FED MODEL, AND SELF-FULFILLING LIQUIDITY CRISES

                                                 Ricardo Lagos
                                                Shengxing Zhang

                                              Working Paper 21528
                                      http://www.nber.org/papers/w21528


                            NATIONAL BUREAU OF ECONOMIC RESEARCH
                                     1050 Massachusetts Avenue
                                       Cambridge, MA 02138
                                          September 2015




       Lagos thanks the support from the C.V. Starr Center for Applied Economics at NYU. Zhang thanks
       the support from the Centre for Macroeconomics at LSE. The views expressed herein are those of
       the authors and do not necessarily reflect the views of the National Bureau of Economic Research.

       NBER working papers are circulated for discussion and comment purposes. They have not been peer-
       reviewed or been subject to the review by the NBER Board of Directors that accompanies official
       NBER publications.

       © 2015 by Ricardo Lagos and Shengxing Zhang. All rights reserved. Short sections of text, not to
       exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
       © notice, is given to the source.
Monetary Exchange in Over-the-Counter Markets: A Theory of Speculative Bubbles, the Fed
Model, and Self-fulfilling Liquidity Crises
Ricardo Lagos and Shengxing Zhang
NBER Working Paper No. 21528
September 2015
JEL No. D83,E31,E52,E58,G12

                                              ABSTRACT

We develop a model of monetary exchange in over-the-counter markets to study the effects of monetary
policy on asset prices and standard measures of financial liquidity, such as bid-ask spreads, trade volume,
and the incentives of dealers to supply immediacy, both by participating in the market-making activity
and by holding asset inventories on their own account. The theory predicts that asset prices carry a
speculative premium that reflects the asset's marketability and depends on monetary policy as well
as the microstructure of the market where it is traded. These liquidity considerations imply a positive
correlation between the real yield on stocks and the nominal yield on Treasury bonds---an empirical
observation long regarded anomalous. The theory also exhibits rational expectations equilibria with
recurring belief driven events that resemble liquidity crises, i.e., times of sharp persistent declines
in asset prices, trade volume, and dealer participation in market-making activity, accompanied by large
increases in spreads and abnormally long trading delays.


Ricardo Lagos
Department of Economics
New York University
19 West Fourth Street
New York, NY 10014
and NBER
ricardo.lagos@nyu.edu

Shengxing Zhang
Department of Economics
London School of Economics
oo7zsx@gmail.com
1    Introduction

We develop a monetary model of financial exchange in over-the-counter (OTC) markets and use
it to show how the details of the market microstructure and the quantity of money (i ) shape
the performance of OTC markets (e.g., as gauged by standard measures of market liquidity),
(ii ) generate speculative bubbles, (iii ) explain the positive correlation between the nominal
yield on Treasury bonds and the real yield on stocks (the basis for the so-called “Fed Model” of
equity valuation that is popular among financial practitioners), and (iv ) give rise to recurring
belief driven events that resemble liquidity crises.
    Specifically, we consider a setting in which a financial asset that yields a dividend flow of
consumption goods (e.g., an equity or a real bond) is traded by investors who have time-varying
heterogeneous valuations for the dividend. In order to achieve the gains from trade that arise
from their heterogeneous private valuations, investors participate in a bilateral market with
random search that is intermediated by specialized dealers who have access to a competitive
interdealer market. In the bilateral market, which has all the stylized features of a typical
OTC market structure, investors and dealers seek to trade the financial asset using fiat money
as a medium of exchange. Periodically, dealers and investors are also able to rebalance their
portfolios in a frictionless (Walrasian) market.
    First, we use the theory to study the role that the quantity of money plays in shaping
asset prices in particular and the performance of OTC markets more generally. Since money
serves as means of payment in financial transactions, the quantity of real balances affects the
equilibrium allocation of the asset. Anticipated inflation reduces real balances and distorts the
asset allocation by causing too many assets to remain in the hands of investors with relatively
low valuations.
    Second, we show that in a monetary equilibrium the asset price is larger than the expected
present discounted value that any agent assigns to the dividend stream. The difference between
the transaction price and the highest individual valuation is a “speculative premium” that
investors are willing to pay because they anticipate capital gains from reselling the asset to
investors with higher valuations in the future. We show that the speculative premium and the
asset price depend on the market structure where the asset is traded, e.g., both the premium
and the asset price are decreasing in the effective bargaining power of dealers in the OTC
market, as captured by the product of their trading probability and bargaining power in bilateral



                                                   2
transactions with investors. This theoretical result is consistent with the behavior of illiquidity
premia in response to variations in measures of trading activity documented in the recent
empirical literature.
   Third, we show how monetary policy affects speculative motives and the resulting specu-
lative premium. An increase in anticipated inflation reduces the real money balances used to
finance asset trading, which limits the ability of high-valuation traders to purchase the asset
from low-valuation traders. As a result, the speculative premium and the real asset price are
decreasing in the rate of expected inflation. This simple mechanism rationalizes the positive
correlation between the real yield on stocks and the nominal yield on Treasury bonds—an em-
pirical observation long regarded anomalous and that, for lack of an alternative theory, has
been attributed to money illusion since the 1970s. We also use the model to study the effects of
monetary policy on standard measures of financial liquidity of OTC markets, such as the size of
bid-ask spreads, the volume of trade, and the incentives of dealers to supply immediacy, both
by choosing to participate in the market-making activity, as well as by holding asset inventories
on their own account.
   Fourth, we show that a version of the model in which dealer participation in market-making
activities is endogenous exhibits rational expectations equilibria with recurring belief driven
events that resemble liquidity crises in which liquidity “dries up” and speculative bubbles
“burst.” Along a typical equilibrium path, there are times when dealers withdraw from market
making, which makes the assets that they intermediate difficult to trade, causing their prices
and trade volume to fall abruptly at the same time that there is a sharp increase in trading
delays and spreads.
   The rest of the paper is organized as follows. Section 2 presents the model. Section 3
describes the efficient allocation. Equilibrium is characterized in Section 4. Section 5 analyzes
the effects of monetary policy and OTC frictions on asset prices. Section 6 shows how monetary
policy and OTC frictions influence standard measures of market liquidity, such as liquidity
provision by dealers, trade volume, and bid-ask spreads. In Section 7 we show that asset prices
typically exceed the expected present discounted value that any agent assigns to the dividend
stream by an amount that reflects a speculative premium. In that section we also show that the
size of this speculative premium declines with inflation and with the degree of OTC frictions.
In Section 8 we endogenize the supply of intermediation services and the length of the trading
delays. In Section 9 we show that our model can offer a novel theoretical foundation for the


                                                3
“Fed Model”—a construct popular among practitioners and policymakers that is based on the
documented positive correlation between nominal bond yields and real equity yields. In Section
10 we use the extension with endogenous trading delays to show that the same forces that
generate speculative bubbles can naturally give rise to dynamic rational-expectations equilibria
that exhibit episodes that resemble liquidity crises and market crashes. This paper is related to
three areas of research: search-theoretic models of money, search-theoretic models of financial
trade in OTC markets, and resale-option theories of asset-price bubbles. Section 11 places our
theoretical contribution in the context of this related literature. Section 12 concludes. The
appendix contains all proofs.


2    The model

Time is represented by a sequence of periods indexed by t = 0, 1, .... Each time-period is
divided into two subperiods where different activities take place. There is a continuum of
infinitely lived agents called investors, each identified with a point in the set I = [0, 1]. There
is also a continuum of infinitely lived agents called dealers, each identified with a point in the
set D = [0, v], where v ∈ R+ . All agents discount payoffs across periods with the same factor,
β ∈ (0, 1). In every period there is a continuum of productive units (or trees) with measure
As ∈ R++ . Every productive tree yields an exogenous dividend yt ∈ R+ of a perishable
consumption good at the end of the first subperiod of period t. (Each tree yields the same
dividend as every other tree, so yt is also the aggregate dividend.) At the beginning of every
period t, every tree is subject to an independent idiosyncratic shock that renders it permanently
unproductive with probability 1 − π ∈ [0, 1) (unproductive trees physically disappear). If a tree
remains productive, its dividend in period t + 1 is yt+1 = γt+1 yt where γt+1 is a nonnegative
random variable with cumulative distribution function Γ, i.e., Pr (γt+1 ≤ γ) = Γ (γ), and mean
γ̄ ∈ (0, (βπ)−1 ). The time-t dividend becomes known to all agents at the beginning of period
t, and at that time each tree that failed is replaced by a new tree that yields dividend yt in the
initial period and follows the same stochastic process as other productive trees thereafter (the
dividend of the initial set of trees, y0 ∈ R++ , is given at t = 0). In the second subperiod of
every period, every agent has access to a linear production technology that transforms a unit
of the agent’s effort into a unit of another kind of perishable homogeneous consumption good.
    Each productive tree has outstanding one durable and perfectly divisible equity share that
represents the bearer’s ownership of the tree and confers him the right to collect the dividends.

                                                4
At the beginning of every period t ≥ 1, each investor receives an endowment of (1 − π) As equity
shares corresponding to the new trees created in that period. When a tree fails, its equity share
disappears with the tree. There is a second financial instrument, money, which is intrinsically
useless (it is not an argument of any utility or production function, and unlike equity, ownership
of money does not constitute a right to collect any resources). The stock of money at time t is
denoted Am                                m                        m       m
         t . The initial stock of money, A0 ∈ R++ , is given, and At+1 = µAt , with µ ∈ R++ .
A monetary authority injects or withdraws money via lump-sum transfers or taxes to investors
in the second subperiod of every period. At the beginning of period t = 0, each investor is
endowed with a portfolio of equity shares and money. All financial instruments are perfectly
recognizable, cannot be forged, and can be traded among agents in every subperiod.
    In the second subperiod of every period, all agents can trade the consumption good produced
in that subperiod, equity shares, and money, in a spot Walrasian market. In the first subperiod
of every period, trading is organized as follows: Investors and dealers can trade equity shares
and money in a random bilateral OTC market, while dealers can also trade equity shares and
money with other dealers in a spot Walrasian interdealer market. We use α ∈ [0, 1] to denote the
probability that an individual investor is able to contact another investor in the OTC market.
Once the two investors have contacted each other, the pair negotiates a trade involving equity
shares and money. We assume that, with probability η ∈ [0, 1], the terms of the trade are
chosen by the investor who values the equity dividend the most, and by the other investor with
complementary probability.1 After the transaction has been completed, the investors part ways.
Similarly, we use δ ∈ [0, min (v, 1 − α)] to denote the probability that an individual investor is
able to make contact with a dealer in the OTC market. The probability that a dealer contacts
an investor is δ/v ≡ κ ∈ [0, 1]. Once a dealer and an investor have contacted each other, the
pair negotiates the quantity of equity shares that the dealer will buy from, or sell to the investor
in exchange for money. We assume that the terms of the trade between an investor and a dealer
in the OTC market are chosen by the investor with probability θ ∈ [0, 1], and by the dealer with
probability 1 − θ. After the transaction has been completed, the dealer and the investor part
ways.2 The timing assumption is that the round of OTC trade between investors and dealers
takes place in the first subperiod of a typical period t, and ends before trees yield dividends.
Hence equity is traded cum dividend in the OTC market (and in the interdealer market) of the
    1
      In the event that both investors value the dividend the same, each gets selected to make a take-it-or-leave it
offer with equal probability.
    2
      See Zhang (2012) for an OTC model with long-term relationships between investors and dealers.


                                                         5
first subperiod, but ex dividend in the Walrasian market of the second subperiod. We assume
that agents cannot make binding commitments, that there is no enforcement, and that histories
of actions are private in a way that precludes any borrowing and lending, so any trade must
be quid pro quo. This assumption and the structure of preferences described below create the
need for a medium of exchange.3
    An individual dealer’s preferences are given by
                                                    ∞
                                                    X
                                              Ed0         β t (ctd − htd )
                                                    t=0

where ctd is his consumption of the homogeneous good that is produced, traded and consumed
in the second subperiod of period t, and htd is the utility cost from exerting htd units of effort
to produce this good. The expectation operator Ed0 is with respect to the probability measure
induced by the dividend process and the random trading process in the OTC market. Dealers
get no utility from the dividend good.4 An individual investor’s preferences are given by
                                              ∞
                                              X
                                         E0         β t (εti yti + cti − hti )
                                              t=0

where yti is the quantity of the dividend good that investor i consumes at the end of the first
subperiod of period t, cti is his consumption of the homogeneous good that is produced, traded
and consumed in the second subperiod of period t, and hti is the utility cost from exerting hti
units of effort to produce this good. The variable εti denotes the realization of a preference shock
that is distributed independently over time and across agents, with a differentiable cumulative
                                                                    R
distribution function G on the support [εL , εH ] ⊆ [0, ∞], and ε̄ = εdG (ε). Investor i learns
his realization εti at the beginning of period t, before the OTC trading round. The expectation
operator E0 is with respect to the probability measure induced by the dividend process, the
investor’s preference shock and the random trading process in the OTC market.
   3
     Notice that under these conditions there cannot exist a futures market for fruit, so an agent who wishes
to consume the fruit dividend must be holding the equity share at the time the dividend is paid. A similar
assumption is typically made in search models of financial OTC trade, e.g., see Duffie et al. (2005) and Lagos
and Rocheteau (2009).
   4
     This assumption implies that dealers have no direct consumption motive for holding the equity share. It is
easy to relax, but it is the standard benchmark in the search-based OTC literature, e.g., see Duffie et al. (2005)
and Lagos and Rocheteau (2009), Lagos, Rocheteau and Weill (2011), and Weill (2007).




                                                            6
3       Efficiency

Consider a social planner who wishes to maximize the sum of all agents’ expected discounted
utilities, subject to the same meeting frictions that agents face in the decentralized formulation.
Specifically, in the first subperiod of every period, the planner can only reallocate assets within
the pairs of the measure α of investors who have contacted each other directly, and among all
dealers and the measure δ of investors chosen at random from the rest of the population. Let
Bt ⊆ I denote the subset of investors who get a bilateral trading opportunity with another
investor in the OTC market of period t. For any i ∈ Bt , let b (i) ∈ Bt denote investor i’s partner
                                      R
in the bilateral meeting. Notice that Bt di = α is the measure of investors who have an OTC
                                    R
meeting with another investor, and Bt I{i≤b(i)} di = α/2 is the total number of direct bilateral
transactions between investors in the OTC market. We restrict attention to symmetric alloca-
tions (identical agents receive equal treatment). Let ctD and htD denote a dealer’s consumption
and production of the homogeneous consumption good in the second subperiod of period t. Let
ctI (ε) and htI (ε) denote consumption and production of the homogeneous consumption good
in the second subperiod of period t by an investor with idiosyncratic preference type ε. Let
ãtD denote the beginning-of-period-t (before depreciation) equity holding of a dealer, and let
a0tD denote the equity holding of a dealer at the end of the first subperiod of period t (after
OTC trade). Let ãtI denote the beginning-of-period-t (before depreciation and endowment)
asset holding of an investor. Finally, let atij (εi , εj ) denote the post-trade equity holding of an
investor i with preference type εi who has a direct bilateral trade opportunity with an investor j
with preference type εj , and let a0tI denote a measure on F ([εL , εH ]), the Borel σ-field defined on
[εL , εH ]. The measure a0tI is interpreted as the distribution of post-trade asset holdings among
investors with different preference types who contacted a dealer in the first subperiod of period
t. With this notation, the planner’s problem consists of choosing a nonnegative allocation,
   (                                                                                    )∞
                                                                
             0                        0
     ãtD , atD , ctD , htD , ãtI , atI , atib(i) (εi , εb(i) )  , ctI (εi ) , htI (εi )     , (1)
                                                                        i∈Bt                        εi ,εb(i) ∈[εL ,εH ]   t=0

to maximize
   ∞
        " Z
   X                                             Z   εH
E0    βt δ                   εyt a0tI   (dε) +            [(1 − α − δ) εyt atI + ctI (ε) − htI (ε)] dG (ε) + v(ctD − htD )
    t=0          [εL ,εH ]                        εL
    Z     Z Z                                                                                                      #
                             h                                                         i
+               I{i≤b(i)}        εi atib(i) (εi , εb(i) ) + εb(i) atb(i)i (εb(i) , εi ) yt dG (εi ) dG(εb(i) )di
     Bt


                                                                    7
(the expectation operator E0 is with respect to the probability measure induced by the dividend
process) subject to
                                                         
                   atib(i) εi , εb(i) + atb(i)i εb(i) , εi ≤ 2atI                                         (2)
                                            vãtD + ãtI ≤ As                                             (3)
                                       Z
                             va0tD + δ              a0tI (dε) ≤ vatD + δatI                               (4)
                                          [εL ,εH ]
                            Z εH                                Z εH
                                  ctI (ε) dG (ε) + vctD ≤            htI (ε) dG (ε) + vhtD                (5)
                             εL                               εL
                                                    atD = πãtD                                           (6)
                                                     atI = πãtI + (1 − π) As .                           (7)

Proposition 1 The efficient allocation satisfies the following three conditions for every t: (a)
ãtD = (As − ãtI )/v = As /v, (b) atib(i) εi , εb(i) = I{εb(i) <εi } 2atI + I{εb(i) =εi } ao for all i ∈ Bt ,
                                                     

with ao ∈ [0, 2atI ], and (c) a0ti (E) = I{εH ∈E} [π/δ + (1 − π)] As , where I{εH ∈E} is an indicator
function that takes the value 1 if εH ∈ E, and 0 otherwise, for any E ∈ F ([εL , εH ]).

    According to Proposition 1, the efficient allocation is characterized by the following three
properties: (a) only dealers carry equity between periods, (b) in bilateral direct trades between
investors, all the equity shares are allocated to the highest valuation investor, and (c) among
those investors who have a trading opportunity with a dealer, only those with the highest
preference type hold equity shares at the end of the first subperiod.


4    Equilibrium

We begin with the formulation of the individual dealer’s optimization problem during a typical
period. Let VtD (at ) denote the maximum expected discounted payoff of a dealer who enters
the OTC round of period t with portfolio at ≡ (am    s         D
                                                t , at ). Let Wt (at ) denote the maximum
expected discounted payoff of a dealer who is holding portfolio at at the beginning of the second
subperiod of period t. Let φm                                  s
                            t be the real price of money, and φt be the real ex dividend price
of equity in the second subperiod of period t (both expressed in terms of the second-subperiod




                                                      8
consumption good). Then,

                              WtD (at ) =                                         D
                                                                                           
                                                 max              ct − ht + βEt Vt+1 (at+1 )     (8)
                                              ct ,ht ,ãt+1

                      s.t. ct + φt ãt+1 ≤ ht + φt at ,
                                  ct , ht ∈ R+ , ãt+1 ∈ R2+
                                  at+1 = ãm           s
                                                          
                                              t+1 , πãt+1 ,


where Et is the conditional expectation over the next-period realization of the dividend, φt ≡
(φm    s              m       s
                                 
  t , φt ), ãt+1 ≡ ãt+1 , ãt+1 , and φt at denotes the dot product of φt and at .
   Let ŴtD (at ) denote the maximum expected discounted payoff of a dealer with portfolio at
in the first subperiod of period t, conditional on not having contacted an investor in the OTC
market. Since the unmatched dealer can still access the interdealer market,

                                        ŴtD (at ) = max
                                                     m s
                                                         WtD (âm     s
                                                                t , ât )                        (9)
                                                          ât ,ât

                                s.t. âm        s    m       s
                                       t + pt ât ≤ at + pt at ,

                                            âm     s
                                              t , ât ∈ R+ ,


where pt is the dollar price of equity in the interdealer market of period t.
   Next consider the situation of a dealer who enters the OTC round of trade of period t with
portfolio atd , and contacts an investor with portfolio ati and preference type ε in the OTC
market. With probability θ the terms of trade are determined by a take-it-or-leave-it offer by
the investor, and the resulting post-trade portfolios of the investor and the dealer are denoted

                               [am                          s
                                 i∗ (ati , atd , ε; ψ t ), ai∗ (ati , atd , ε; ψ t )]

                               [am                         s
                                 d (ati , atd , ε; ψ t ), ad (ati , atd , ε; ψ t )],


respectively, where ψ t ≡ (1/pt , φt ). With probability 1 − θ the terms of trade are determined
by a take-it-or-leave-it offer by the dealer, and the resulting post-trade portfolios of the investor
and the dealer are

                              [am                         s
                                i (ati , atd , ε; ψ t ), ai (ati , atd , ε; ψ t )]

                              [am                          s
                                d∗ (ati , atd , ε; ψ t ), ad∗ (ati , atd , ε; ψ t )],




                                                          9
respectively.5 We can now write the value function of a dealer who enters the OTC round of
trade of period t with portfolio atd ,
                        Z
         Vt (atd ) = κθ ŴtD [am
           D                                                s
                                  d (ati , atd , ε; ψ t ), ad (ati , adt , ε; ψ t )] dHt (ati , ε)
                              Z
                   + κ (1 − θ) ŴtD [am                              s
                                          d∗ (ati , atd , ε; ψ t ), ad∗ (ati , atd , ε; ψ t )] dHt (ati , ε)

                           + (1 − κ) ŴtD (atd ) ,                                                                            (10)

where Ht is the joint cumulative distribution function over the preference types and portfolios
held by the random investor whom the dealer may contact in the OTC market of period t.
       We now analyze the investor’s problem in a typical period. Let VtI (ati , ε) denote the
maximum expected discounted payoff of an investor who has preference type ε and is holding
portfolio ati ≡ (am     s                                                        I
                  ti , ati ) at the beginning of the OTC round of period t. Let Wt (at ) denote the
maximum expected discounted payoff of an investor who is holding portfolio at at the beginning
of the second subperiod of period t (after the trees have borne dividends). Then,
                                                        Z                      
                        I                                    I         0      0
                                                                         
                     Wt (at ) = max        ct − ht + βEt Vt+1 at+1 , ε dG(ε )                                                 (11)
                                               ct ,ht ,ãt+1

                     s.t. ct + φt ãt+1 ≤ ht + φt at + Tt
                                    ct , ht ∈ R+ , ãt+1 ∈ R2+
                                    at+1 = (ãm        s              s
                                              t+1 , πãt+1 + (1 − π) A ),


where Tt is the real value of the time-t lump-sum monetary transfer (tax, if negative). Since ε is
i.i.d. over time, WtI (at ) is independent of ε and the portfolio that each investor chooses to carry
into period t + 1 is independent of ε. Consequently, in what follows we can write dHt (ati , ε) =
dFtI (ati ) dG (ε), where FtI is the joint cumulative distribution function of investors’ money and
equity holdings at the beginning of the OTC round of period-t.
       Consider a bilateral meeting in the OTC trading round of period t, between an investor i
with portfolio ati and preference type εi , and an investor j with portfolio atj and preference
type εj . Let η̃ (εi , εj ) ≡ ηI{εj <εi } + (1 − η) I{εi <εj } + (1/2) I{εi =εj } denote the probability that
the investor with preference type εi has the power to make a take-it-or-leave-it offer in a bilateral
trade with an investor with preference type εj . When investor i makes the take-it-or-leave-it
   5
       In what follows, we will sometimes use am              m                          s             s
                                               ti∗ to denote ai∗ (ati , atd , ε; ψ t ), atd to denote ad (ati , ati , ε; ψ t ), etc.




                                                                 10
offer to investor j, the resulting post-trade portfolios of investors i and j are denoted

                               [am                                  s
                                 i∗ (ati , atj , εi , εj ; ψ t ) , ai∗ (ati , atj , εi , εj ; ψ t )]

                               [am                                 s
                                 j (atj , ati , εj , εi ; ψ t ) , aj (atj , ati , εj , εi ; ψ t )],


respectively. With probability 1 − η̃ (εi , εj ) the terms of trade are determined by a take-it-or-
leave-it offer by investor j, and the resulting post-trade portfolios of investors i and j are

                              [am                                 s
                                i (ati , atj , εi , εj ; ψ t ) , ai (ati , atj , εi , εj ; ψ t )]

                              [am                                   s
                                j ∗ (atj , ati , εj , εi ; ψ t ) , aj ∗ (atj , ati , εj , εi ; ψ t )],


respectively.6 We can now write the value function of an investor who enters the OTC round
of period t with portfolio ait and preference type εi ,
                             Z
             I
           Vt (ati , εi ) = δ θ {εi yt asi∗ (ati , atd , εi ; ψ t ) +

                          WtI [am                             s                             D
                                 ∗ (ati , atd , εi ; ψ t ) , ai∗ (ati , atd , εi ; ψ t )] dFt (atd )
                              Zi
                          + δ (1 − θ) {εi yt asi (ati , atd , εi ; ψ t ) +

                          WtI [am (ati , atd , εi ; ψ t ) , asi (ati , atd , εi ; ψ t )] dFtD (atd )
                              Zi
                          + α η̃ (εi , εj ) {εi yt asi∗ (ati , atj , εi , εj ; ψ t ) +

                          WtI [am                                  s
                                 ∗ (ati , atj , εi , εj ; ψ t ) , ai∗ (ati , atj , εi , εj ; ψ t )] dHt (atj , εj )
                              Zi
                          + α [1 − η̃ (εi , εj )] {εi yt asi (ati , atj , εi , εj ; ψ t ) +

                          WtI [am                                 s
                                i (ati , atj , εi , εj ; ψ t ) , ai (ati , atj , εi , εj ; ψ t )] dHt (atj , εj )

                          + (1 − α − δ) εi yt asti + WtI (ati ) ,
                                                                     
                                                                                                                              (12)

where FtD is the cumulative distribution function over portfolios held by the random dealer
whom the dealer may contact in the OTC market of period t. Next, we characterize the
outcomes of trades in the OTC and the interdealer markets.
          The maximization problem (9) represents the portfolio problem of a dealer who did not
contact an investor in the OTC market of period t. The solution is summarized as follows:

      6
       In what follows, we will sometimes use am
                                               ti∗                   to denote am
                                                                                i∗ (ati , atj , εi , εj ; ψ t ),   astj   to denote
asj   (atj , ati , εj , εi ; ψ t ), etc.




                                                                11
Lemma 1 A dealer who enters period t with portfolio at and does not contact an investor,
enters the second subperiod with portfolio (âm      s         m                s
                                              td , âtd ) ≡ (âd (at ; ψ t ), âd (at ; ψ t )), given by
                                                                               s      1 m
                              if pt φm      s
                                                                               at +   pt at              if pt φm
                                                                                                                 t < φt
                                                                                                                       s
         
          =0                        t < φt
âm    =   ∈ [0, am       s          m
                  t + pt at ] if pt φt = φt
                                            s                and    âstd   =   as +   1
                                                                                       pt (at
                                                                                             m   − âm           m
                                                                                                     td ) if pt φt = φt
                                                                                                                       s
  td
               m      s           s       m                                    t                             s       m
           = at + pt at       if φt < pt φt                                     0                         if φt < pt φt ,
         

and his maximum expected discounted payoff is

                                    ŴtD (at ) = φ̄t (am       s      D
                                                       t + pt at ) + Wt (0)                                           (13)

where φ̄t ≡ max (φm    s
                  t , φt /pt ), and


                              WtD (0) = max                                    D
                                                                                        
                                                             −φt ãt+1 + βEt Vt+1 (at+1 )                             (14)
                                           ãt+1 ∈R2+

                             s.t. at+1 = (ãm        s
                                            t+1 , πãt+1 ).


       If pt φm    s
              t < φt , then a dealer who holds any cash in the interdealer market can use a dollar
to buy 1/pt equity shares, and the net return from this trade equals φst /pt (the real value of the
equities in the Walrasian market of the second subperiod of period t) minus φm (the real cost
of the trading strategy), which is strictly positive. Hence, it is optimal for the dealer to sell all
his cash for equity if pt φm    s                   s       m
                           t < φt . Conversely, if φt < pt φt , it is optimal for the dealer to sell
any equity holdings he may have and carry only cash into the second subperiod of period t.
       Consider the bargaining problem between an investor with preference type ε and portfolio
(am     s
  ti , ati )   who contacts a dealer with portfolio (am     s
                                                      td , atd ) in the OTC market of period t. With
probability θ the investor has the power to make a take-it-or-leave-it offer to the dealer. The
investor chooses post-trade portfolios for himself, (am      s                            m s
                                                      ti∗ , ati∗ ), and for the dealer, (atd , atd ), by
solving
                                                         εyt asti∗ + WtI (am      s
                                                                                         
                                        max                                ti∗ , ati∗ )
                                   am  ,as ,am ,as
                                    ti∗ ti∗ td td

                         s.t. am      m         s      s       m     m         s     s
                               ti∗ + atd + pt (ati∗ + atd ) ≤ ati + atd + pt (ati + atd )

                                           ŴtD (am     s        D m s
                                                  td , atd ) ≥ Ŵt (atd , atd )

                                        am      s      m s
                                         ti∗ , ati∗ , atd , atd ∈ R+ .


The first constraint requires that the combined value of the post-trade portfolios held by the
investor and the dealer cannot exceed the combined value of their pre-trade portfolios. The
second constraint is the dealer’s individual rationality constraint.

                                                               12
    With complementary probability 1−θ, the dealer has the power to make a take-it-or-leave-it
offer to the investor. The dealer chooses post-trade portfolios for himself, (am      s
                                                                               td∗ , atd∗ ), and for
the investor, (am     s
                ti , ati ), by solving


                                               max              ŴtD (am      s
                                                                       td∗ , atd∗ )
                                         am    s    m     s
                                          ti ,ati ,atd∗ ,atd∗


                      s.t. am     m          s     s        m     m         s     s
                            ti + atd∗ + pt (ati + atd∗ ) ≤ ati + atd + pt (ati + atd )

                                εyt asti + WtI (am     s           s     I   m s
                                                 ti , ati ) ≥ εyt ati + Wt (ati , ati )

                                     am     s     m      s
                                      ti , ati , atd∗ , atd∗ ∈ R+ .


The first constraint requires that the combined value of the pre-trade portfolios is enough to
finance the post-trade portfolios. The second constraint is the investor’s individual rationality
constraint. The following result summarizes the outcome of the bargaining game between an
investor and a dealer.

Lemma 2 Consider the bargaining problem between an investor i with portfolio (am     s
                                                                               ti , ati ) and
preference type ε, and a dealer d with portfolio (am     s
                                                   td , atd ) in the OTC market of period t.


(i ) With probability θ the investor chooses the terms of trade, and in this case the investor
      exits the meeting with post-trade portfolio (am       s
                                                    ti∗ , ati∗ ) given by

                                                                                          1 m
                                                                                                              if ε∗t < ε
                                                                  s
                                     if ε∗t < ε                   ati +                  pt ati
             
              =0
         m             m        s             ∗           s                               1                            ∗
        ati∗    ∈ [0, ati + pt ati ] if ε = εt  and ati∗ =           as +                 pt (ati
                                                                                                 m   − am
                                                                                                        ti∗ ) if ε = εt
                    m       s                 ∗                   ti
                = ati + pt ati       if ε < εt                       0                                        if ε < ε∗t
             

      where
                                                                 pt φm    s
                                                                     t − φt
                                                      ε∗t ≡                 .                                          (15)
                                                                      yt
      The dealer’s portfolio (am     s
                               td , atd ) that results from trading with the investor is given by

                                                                                       1 m
                         am         m        s
                          td ∈ [0, atd + pt atd ]           and        astd = astd +     (a − am
                                                                                               td ) .
                                                                                       pt td

(ii ) With probability 1 − θ the dealer chooses the terms of trade, and in this case the investor
      exits the meeting with post-trade portfolio (am     s
                                                    ti , ati ) given by
                                                                 
                                     if ε∗t < ε
                                                                      s
                                                                  ati +
                                                                                             1     m
                                                                                          pot (ε) ati         if ε∗t < ε
             
              =0                                                
         am
          ti    ∈ [0, am        s
                       ti + pt ati ] if ε = ε∗t and asti =          asti +                1       m
                                                                                          pt (ati −     am
                                                                                                         ti ) if ε = εt
                                                                                                                       ∗
                    m      o      s           ∗
                = ati + pt (ε) ati if ε < εt                                                                  if ε < ε∗t
                                                                
                                                                  0


                                                                13
         where
                                                         εyt + φst                 εyt + φst
                                                                       
                                       pot (ε)   ≡                          pt =             .                  (16)
                                                         ε∗t yt + φst                φmt
         The dealer’s portfolio (am      s
                                  td∗ , atd∗ ) that results from trading with the investor is given by

                                                                         am
                                
                                                                                      ∗
                                 ∈ [0, am
                                                   s      o
                                           td + pt atd + [pt (ε) − pt ] pot (ε) ] if εt < ε
                                                                            ti

                           am
                            td∗    ∈ [0, am + pt astd ]                           if ε = ε∗t
                                 ∈ [0, atd
                                          m + p as + [p − po (ε)] as ]           if ε < ε∗t
                                           td     t td     t     t        ti

         and                                                            m
                                                          o (ε) − p ] ati − am ]
                                  
                                     s
                                   atd +
                                             1 m
                                             pt [atd + [p t        t  o
                                                                     pt (ε)   td∗                if ε∗t < ε
                        astd∗   =   astd +   1     m      m
                                             pt (atd − atd∗ )                                    if ε = ε∗t
                                   as +     1     m            o      s    m                    if ε < ε∗t .
                                  
                                      td     pt [atd + [pt − pt (ε)] ati − atd∗ ]

       To interpret the results in Lemma 2, observe that (15) defines the preference type of the
“marginal investor.” That is, investors with preference type ε < ε∗t want to sell equity for cash,
investors with preference type ε > ε∗t want to buy equity with cash, and the marginal investors
with preference type ε = ε∗t are indifferent between buying or selling equity, as they have no
gain from trading in the OTC market.7 Consider an investor who has drawn preference type
ε and meets a dealer in period t. If pt φm          s                        ∗
                                         t < εyt + φt , or equivalently, if εt < ε, then the
real value of a dollar to the investor is φm
                                           t (the amount of second-subperiod goods he can buy
in the following centralized market), which is smaller than (εyt + φst ) /pt , namely the value to
the investor of the (cum-dividend) equity position that can be purchased with a dollar in the
interdealer market. Naturally, in this case the bargaining outcome is that the investor sells all
his cash and uses it to purchase equity, regardless of whether the dealer or the investor has the
bargaining power. Formally, in Lemma 2, am      m          ∗                           ∗
                                         ti∗ = ati = 0 if εt < ε. Analogously, if ε < εt , then
the investor sells all his equity for cash, both when he makes the offer, and when the dealer
makes the offer (i.e., asti∗ = asti = 0 if ε < ε∗t in the lemma). If ε = ε∗t , the investor is indifferent
between holding equity or cash; there are no gains from trade between him and the dealer.
       The quantity of equity shares the investor gets for his cash holdings when ε∗t < ε, and the
amount of cash that he gets for his equity shares when ε < ε∗t , however, do depend on whether
the investor or the dealer has the bargaining power. If the investor has the bargaining power, he
can effectively trade money for equity at the interdealer market price, pt , i.e., he pays pt dollars
per share when he buys equity, and gets pt dollars per share when he sells equity. Formally,
   7
    Another way to interpret (15) is that given ε∗t , pt φm    ∗       s
                                                          t = εt yt + φt is the cum dividend real value of equity to
the marginal investor in period t.


                                                             14
in Lemma 2, asti∗ = asti +            1 m
                                      pt ati   if ε∗t < ε, and am      m        s          ∗
                                                                ti∗ = ati + pt ati if ε < εt . If the dealer has
the bargaining power, he offers less favorable terms of trade to the investor. Effectively, the
bargaining outcome implies that the dealer lets the investor trade at pot (ε) dollars per share,
rather than pt dollars per share. Notice that ∂pot (ε) /∂ε > 0, so investors with higher preference
types face a higher dollar price per share. Also, note that pot (ε) > pt if and only if ε∗t < ε.
Thus the dealer charges pot (ε) > pt dollars per share to an investor who wishes to buy equity
(i.e., an investor with ε∗t < ε), and pays pot (ε) < pt dollars per share to an investor who wishes
to sell equity (an investor with ε < ε∗t ). In other words, in a meeting where the dealer has the
bargaining power, pot (ε) is the nominal bid price for investors who want to sell equity, or the
nominal ask price for investors who want to buy equity. In terms of the lemma, this is why
asti = asti +      1     m
                pot (ε) ati   if ε∗t < ε, and am     m     o      s          ∗
                                               ti = ati + pt (ε) ati if ε < εt .
    The indeterminacy in the dealer’s portfolio follows from the fact that after having traded
with the investor, the dealer can immediately retrade in the interdealer market, so all the dealer
cares about is the value of his own combined post-trade portfolio. In fact, as the following
corollary shows, the post-trade value of the dealer and the investor portfolios are uniquely
pinned down.

Corollary 1 Consider the bargaining problem between an investor i with portfolio (am     s
                                                                                   ti , ati ) and
preference type ε, and a dealer d with portfolio (am     s
                                                   td , atd ) in the OTC market of period t.


(i ) With probability θ the investor chooses the terms of trade, and in this case the dollar value
       of the investor’s and the dealer’s post-trade portfolios are, respectively,

                                                   am         s      m        s
                                                    ti∗ + pt ati∗ = ati + pt ati

                                                     am        s     m        s
                                                      td + pt atd = atd + pt atd .


(ii ) With probability 1 − θ the dealer chooses the terms of trade, and in this case the dollar
       value of the investor’s and the dealer’s post-trade portfolios are, respectively,
                                                                          am
                                       (
                          m        s     am
                                          ti + pt asti − [pot (ε) − pt ] poti(ε) if ε∗t ≤ ε
                        ati + pt ati =                                    t
                                         am         s             o
                                          ti + pt ati − [pt − pt (ε)] ati
                                                                          s      if ε < ε∗t
                                                                          am
                                       (
                       m         s       am
                                          td + pt astd + [pot (ε) − pt ] poti(ε) if ε∗t ≤ ε
                      atd∗ + pt atd∗ =                                     t
                                         am         s             o
                                          td + pt atd + [pt − pt (ε)] ati
                                                                           s     if ε < ε∗t .



                                                              15
    Corollary 1 shows that the dealer extracts a transaction fee from the investor only when he
has the bargaining power. For example, when the dealer encounters an investor with ε > ε∗t
                                                                                             (ε−ε∗t )yt
who wishes to purchase x shares, the dealer extracts pot (ε) − pt =                          ε∗t yt +φst pt   dollars per share
                                                             (ε−ε∗t )yt
purchased by the investor, for a total fee of                ε∗t yt +φst pt x
                                                                   dollars. In Lemma 2 and Corollary 1,
                                ∗      s                                    (ε−ε∗t )yt m
                                          
                                ε  y +φ
x = asti − asti = po1(ε) am
                          ti =
                                 t t
                                 εyt +φs
                                        t   1 m
                                            pt ati , so the total fee equals εyt +φs ati dollars. Similarly,
                    t                       t                                                     t
when the dealer encounters an investor with ε < ε∗t who wishes to sell asti shares, the dealer
                          (ε∗t −ε)yt
extracts pt − pot (ε) =   ε∗t yt +φst pt   dollars per share sold by the investor.
    Consider a bilateral meeting in the OTC trading round of period t, between an investor i
with portfolio ati and preference type εi , and an investor j with portfolio atj and preference
type εj . With probability η̃ (εi , εj ), investor i has the power to make a take-it-or-leave-it offer
to investor j, and in that event investor i chooses an offer of post-trade portfolios for himself,
(am      s                            m s
  ti∗ , ati∗ ), and for investor j, (atj , atj ), by solving


                                                         εi yt asti∗ + WtI (am      s
                                                                                        
                                           max                               ti∗ , ati∗ )
                                   am  ,a ,a ,as
                                           s  m
                                    ti∗ ti∗ tj tj


                                           s.t. am      m     m     m
                                                 ti∗ + atj ≤ ati + atj

                                                asti∗ + astj ≤ asti + astj
                             εj yt astj + WtI (am     s             s     I m s
                                                tj , atj ) ≥ εj yt atj + Wt (atj , atj )

                                      am      s      m s
                                       ti∗ , ati∗ , atj , atj ∈ R+ .


The first two constraints imply that in a bilateral meeting the two investors can (only) reallocate
money and assets between themselves. The third constraint ensures that it is individually
rational for investor j to accept i’s offer. The following result summarizes the outcome of the
bargaining game between two investors.

Lemma 3 Consider the bargaining problem between an investor i with portfolio (am     s
                                                                               ti , ati ) and
preference type εi , and an investor j with portfolio (am     s
                                                        tj , atj ) and preference type εj in the OTC
market of period t. Suppose that investor i has the power to choose the terms of trade, then his




                                                              16
post-trade portfolio is ati∗ = (am       s
                                  ti∗ , ati∗ ) with
                                    h m                i
                           s + min       ati         s
                      = a               o       , a                                     if εj < εi
                     h ti             hpt (ε j)     tj
                    
                    
                                           a m            i             h m           ii
                                                                          ati
              asti∗    ∈ asti − min po (ε    tj
                                                   , asti , asti + min po (ε   , astj    if εj = εi
                                           t j)                           t j)
                    
                                    h   a  m           i
                       = asti − min po (ε   tj
                                                 , asti                                  if εi < εj
                    
                    
                                         t j)
                                     h                       i
                           m              o          s      m
                       ati − min pt (εj )atj , ati              if εj < εi
                      
                      
                m          m     o            s         s
              ati∗ =     ati + pt (εjh) (ati − ati∗ ) i if εj = εi
                      
                       am + min po (εj )as , am
                      
                                                                 if εi < εj ,
                                 ti             t         ti    tj


and investor j’s post-trade portfolio is atj = (am     s           s     s     s     s        m
                                                 tj , atj ), with atj = atj + ati − ati∗ and atj =
am     m     m
 tj + ati − ati∗ .


    In Lemma 3, if εj < εi , then investor i wishes to purchase all of investor j’s equity. Since
he has all the bargaining power, investor i sets the terms of trade at pot (εj ) dollars per equity
share, i.e., the dollar price of equity that makes investor j just indifferent between selling equity
for dollars or not. The quantity of equity that investor i is able to purchase will depend on his
money holdings, am        m     o       s                                                       s
                 ti . If ati ≥ pt (εj )atj , then he buys all of investor j’s equity holdings, atj , in
exchange for pot (εj )astj dollars. If am     o       s
                                        ti < pt (εj )atj , then i gives investor j all his money holdings,
                           am
am
 ti , in exchange for
                              ti
                         pot (εj )    equity shares. Conversely, if εi < εj , then investor i wishes to sell all
of his equity to investor j. Similarly, the quantity of equity that investor i will sell to investor
j depends on j’s money holdings, am        m     o       s
                                  tj . If atj ≥ pt (εj )ati , then j buys all of investor i’s equity
holdings, asti , in exchange for pot (εj )asti dollars. If am     o       s
                                                            tj < pt (εj )ati , then j gives investor i all his
                                                     am
money holdings, am
                 tj , in exchange for                o
                                                        tj
                                                    pt (εj )   equity shares.
    The bargaining outcomes can be substituted in the value functions (10) and (12) to obtain
the following result.

Lemma 4 Let Am           s
                 It and AIt denote the quantity of money and shares held by all investors
at the beginning of the OTC round of period t, respectively, i.e., Am
                                                                         R m I
                                                                    It =  ati dFt (ati ) and
  s
      R s     I
AIt = ati dFt (ati ).

(i ) The value function of a dealer who enters the OTC round of period t with portfolio atd =
       (am     s
         td , atd ) is given by


                                          VtD (am     s            m        s        D
                                                td , atd ) = φ̄t (atd + pt atd ) + Vt (0)                  (17)


                                                                 17
         where
                                         "                                                                                 #
                                                                                                 ε∗t
                                                       εH
                                                            (ε − ε∗t ) yt                              (ε∗t − ε) yt
                                                   Z                                         Z
         VtD   (0) ≡ κ (1 − θ) φ̄t           Am
                                              It                          dG (ε) + pt AsIt                           dG (ε) +WtD (0) .
                                                   ε∗t       εyt + φst                       εL         ε∗t yt + φst

(ii ) The value function of an investor who enters the OTC round of period t with portfolio
         ati = (am     s
                 ti , ati ) and preference type εi is given by


          VtI (am     s            m m                   s   s
                ti , ati , εi ) = φt ati + (εi yt + φt ) ati + Wt (0)
                                                                      I

                                               (εi − ε∗t ) yt m m
                                + δθI{ε∗t ≤εi } ∗            φ a + δθI{εi <ε∗t } (ε∗t − εi ) yt asti
                                                εt yt + φst t ti
                                                   (εi − εj ) yt
                                    Z
                                + α I{εj ≤εi } η                  min [φm    m               s    s
                                                                          t ati , (εj yt + φt ) AIt ] dG (εj )
                                                    εj yt + φst
                                                            (εj − εi ) yt
                                    Z
                                + α I{εi <εj } (1 − η)                    min [φm      m              s   s
                                                                                   t AIt , (εj yt + φt ) ati ] dG (εj ) (18)
                                                             εj yt + φst

         where I{ε∗t ≤εi } is an indicator function that takes the value 1 if ε∗t ≤ εi , and 0 otherwise.

       Notice that the first term on the right side of VtD (0) is the expected fee earned by a dealer
in the OTC market of period t (the term inside the square bracket on the right side of VtD (0)
is the expected fee earned by a dealer when he makes an offer to an investor whose preference
type, ε, is a random draw from G). To interpret (18), notice that the first line represents the
value to the investor of holding the portfolio of money and equity until the end of the period.
The remaining four terms represent the expected net gains from trading. For example, the
                                                                                       (εi −ε∗t )yt m m
factor that multiplies the indicator function I{ε∗t ≤εi } , i.e., δθ                    ε∗t yt +φst φt ati ,    is the expected net
gain to the investor from exchanging money for shares in a trade with a dealer in the OTC
market, and the factor that multiplies the indicator function I{εi <ε∗t } , i.e., δθ (ε∗t − εi ) yt asti , is
the expected net gain to the investor from exchanging shares for money in a trade with a dealer
in the OTC market.8 The last two terms on the right side of (18) represent the expected net
   8
    Conditional on having drawn εi ≥ ε∗t , the investor contacts a dealer with probability δ and has the bargaining
power with probability θ. In this case the investor sells am              1 m
                                                           ti dollars for pt ati shares, and his net payoff from this
transaction is
                                   1 m                                φm                     (εi − ε∗t ) yt m m
                  (εi yt + φst )      ati − φm  m              s
                                             t ati = (εi yt + φt ) ∗
                                                                        t
                                                                              am − φ m
                                                                            s ti
                                                                                        m
                                                                                     t ati =               φt ati .
                                   pt                             εt yt + φ t                 ε∗t yt + φst
Conditional on having drawn εi < ε∗t , the investor contacts a dealer with probability δ and has the bargaining
power with probability θ. In this case the investor sells asti shares for pt dollars each. The investor’s net payoff
                                                           ∗
from this transaction is φm     s              s    s                   s
                          t pt ati − (εi yt + φt ) ati = (εt − εi ) yt ati .




                                                                      18
gains from trading with another investor in the OTC market.9
       The following result uses Lemma 4 to characterize the solutions to the portfolio problems
that a typical dealer and a typical investor solve in the second subperiod of period t.

Lemma 5 Let ãm        s          m        s
                                              
              t+1d , ãt+1d and ãt+1i , ãt+1i denote the portfolios chosen by a dealer and
an investor, respectively, in the second subperiod of period t. The first-order necessary and
sufficient conditions for optimization that these portfolios must satisfy are

                                                φm            m      s
                                                                                              
                                                 t ≥ βEt max φt+1 , φt+1 /pt+1                                                            (19)
                                                   φst ≥ βπEt max pt+1 φm      s
                                                                                              
                                                                        t+1 , φt+1                                                        (20)

and
                                  "
                                                  (εi − ε∗t+1 )yt+1
                                                   εH
                                               Z
                   φm
                    t      ≥ βEt 1 + δθ            ∗             s dG (εi )
                                            ε∗t+1 εt+1 yt+1 + φt+1
                               Z εH                      Z εH                                   #
                                                                (εi − εj ) yt+1                   m
                           + αη  φm am            
                                                                             s dG (εi ) dG (εj ) φt+1                                     (21)
                                   t+1 t+1i
                                     s
                                                s
                                            −φt+1     1
                                                           εj   ε  y
                                                                  j t+1 +  φ t+1
                                      A                  yt+1
                                       It+1


                                 "                      Z   ε∗t+1
                 φst   ≥   βπEt φst+1     + ε̄ + δθ                  (ε∗t+1 − εi )dG (εi )
                                                           εL
                                              φm    m
                                                             
                                               t+1 AIt+1         1
                                                           s
                                                                                                                    #
                                      Z
                                                a s      −φt+1 yt+1
                                                                         Z   εj                               
                                                  t+1i
                       + α (1 − η)                                                (εj − εi ) dG (εi ) dG (εj ) yt+1                       (22)
                                        εL                                  εL

where (19) holds with “=” if ãm                                  s
                               t+1d > 0, (20) holds with “=” if ãt+1d > 0, (21) holds with “=”
if ãm                                      s
     t+1i > 0, and (22) holds with “=” if ãt+1i > 0.
   9
     Consider the penultimate term: with probability α the investor contacts another investor in the OTC market,
if the other investor’s preference type, εj , is smaller than εi , then the investor with preference type εi has the
bargaining power with probability η and he spends min [am          o        s                             m    o          s
                                                             ti , pt (εj ) AIt ] dollars purchasing min [ati /pt (εj ) , AIt ]
equity shares from the other investor, for a net gain from trade equal to
                                                                                      (εi − εj ) yt
        (εi yt + φst ) min [am    o          s       m       m     o        s
                             ti /pt (εj ) , AIt ] − φt min [ati , pt (εj ) AIt ] =                  min [φm  m              s   s
                                                                                                          t ati , (εj yt + φt )AIt ] .
                                                                                       εj yt + φst
Similarly, with probability α the investor contacts another investor in the OTC market, and if the other investor’s
preference type, εj , is larger than εi , then the investor with preference type εi has the bargaining power with
probability 1 − η and he sells min [Am      o         s                                        m     o        s
                                      It /pt (εj ) , ati ] equity shares in exchange for min [AIt , pt (εj ) ati ] dollars, for
a net gain from trade equal to
                                                                                      (εj − εi ) yt
        φm       m     o        s                s         m    o          s
         t min [AIt , pt (εj ) ati ] − (εi yt + φt ) min [AIt /pt (εj ) , ati ] =                   min [φm  m              s    s
                                                                                                          t AIt , (εj yt + φt ) ati ] .
                                                                                       εj yt + φst



                                                                       19
    Condition (19) is a dealer’s Euler equation for money. The left side is the real cost of
purchasing a dollar (in terms of the homogeneous good) in the second subperiod of period t.
The right side is the discounted expected gain from this marginal dollar in the following period,
i.e., the dealer can choose to hold on to the dollar until the second subperiod of t + 1 to obtain
φm
 t+1 homogeneous consumption goods, or he can sell the dollar in the interdealer market of the
following OTC round for 1/pt+1 equity shares, each of which will be worth φst+1 homogeneous
goods in the second subperiod of t + 1. Naturally, the dealer will choose the best of these two
trading strategies. The dealer holds no money overnight if the left side of (19) exceeds the right
side. Condition (20) is a dealer’s Euler equation for equity shares. The left side is the real cost
of purchasing a share (in terms of the homogeneous good) in the second subperiod of t. The
right side is the discounted expected gain from this marginal share in the following period, i.e.,
the tree remains productive with probability π, and in that event the dealer can sell the share
in the interdealer market of the following OTC round for pt+1 dollars, each of which will be
worth φm
       t+1 homogeneous goods in the second subperiod of t + 1, or he can choose to hold on to
the share until the second subperiod of period t + 1 to obtain φst+1 homogeneous consumption
goods. The dealer holds no equity overnight if the left side of (20) exceeds the right side.
    Condition (21) is the investor’s Euler equation for money. The left side is the real cost
of purchasing a dollar in the second subperiod of period t. The right side is the discounted
expected benefit from carrying this additional dollar into the following period, which consists of
three components: (i ) the expected benefit from holding the dollar until the second subperiod
of period t + 1 (i.e., if the investor does not spend the dollar in the OTC market), (ii ) the
expected gain from using the dollar to purchase equity from a dealer in the OTC market of
period t + 1, and (iii ) the expected gain from using the dollar to purchase equity from another
investor in the OTC market of period t + 1. To interpret (21), it is useful to rewrite it as

                                                     εi yt+1 + φst+1
                                                                                      
        m          m                    ∗                                 m          ∗
                                            
      φt ≥ βEt φt+1 + δθ 1 − G εt+1 E                                − φt+1 εi ≥ εt+1
                                                           pt+1
                                       εi yt+1 + φst+1
                                                                                                  
                m   m       s                                 m                m     m       s
          + αωt+1 (at+1i , AIt+1 )ηE                      − φt+1 (εi , εj ) ∈ Ωt+1 (at+1i , AIt+1 )
                                           pot+1 (εj )

where Et denotes the conditional expectation of yt+1 , E [·|·] denotes the conditional expectation
of (εi , εj ), and for any (am       s         2
                             t+1i , at+1j ) ∈ R+ ,
                             n                                                            o
                                                  2
          Ωm  (am
                   , as
           t+1 t+1i t+1j ) =  (ε  ,
                                 i jε ) ∈ [ε ,
                                            L Hε ]  : ε j < εi and am
                                                                    t+1i < po
                                                                               (ε
                                                                            t+1 j ) as
                                                                                     t+1j




                                                     20
     m (am , as
                             RR
and ωt+1 t+1i t+1j ) ≡            I{(εi ,εj )∈Ωm     m      s
                                               t+1 (at+1i ,at+1j )}
                                                                    dG (εi ) dG (εj ). With probability δθ[1 −
G(ε∗t+1 )], the investor contacts a dealer in the OTC market, has bargaining power, and wishes
                                                                                          1
to purchase equity. In this event, he uses the marginal dollar worth φm
                                                                      t+1 to purchase pt+1 equity
shares each of which yields expected utility from the dividend equal to E εi |εi ≥ ε∗t+1 yt+1 , and
                                                                                       

a resale value of φst+1 homogeneous goods in the second subperiod of t + 1. With probability α,
                                                                         m (am , As
investor, call him i, contacts another investor, e.g., investor j. Then ωt+1 t+1i It+1 )η denotes
the joint probability that i’s preference type is higher than j’s (so i acts as a buyer of equity),
and i has bargaining power (which happens with conditional probability η), and the bilateral
gains from trade are constrained by i’s money holdings (which given i’s money holdings, am
                                                                                         t+1i ,
and j’s equity holdings, AsIt+1 , at the time of the trade, occurs if the bilateral dollar price of
equity is large enough, i.e., if j’s individual valuation of equity, εj , is large enough). In this
event, carrying an additional dollar into period t + 1 helps investor i reap gains from trade in
the bilateral trade with the other investor, and i’s expected gain from trading the marginal
                                                                                                             1
dollar is the (conditional expected) value of the additional equity he purchases, i.e.,                  pot+1 (εj )
equity shares each worth εi yt+1 + φst+1 , minus the value of the dollar, φm
                                                                           t+1 .
    Condition (22) is the investor’s Euler equation for equity. To interpret this condition it is
useful to rewrite it as

φst ≥ βπEt ε̄yt+1 + φst+1 + δθG ε∗t+1 E pt+1 φm                         s            ∗
                                                                                    
                                                      t+1 − εi yt+1 + φt+1 |εi ≤ εt+1
        s
            (ast+1i , Am
                                        o          m                 s
                                                                                        s    s       m
                                                                                                             
    + αωt+1            It+1 ) (1 − η) E pt+1 (εj ) φt+1 − εi yt+1 + φt+1 |(εi , εj ) ∈ Ωt+1 (at+1i , AIt+1 )


where for any (ast+1i , am          2
                          t+1j ) ∈ R+ ,
                                  n                                                              o
                                                         2
        Ωst+1 (ast+1i , am                                               o          s       m
                         t+1j ) = (εi , εj ) ∈ [εL , εH ] : εi < εj and pt+1 (εj ) at+1i < at+1j

     s (as       m
                             RR
and ωt+1 t+1i , at+1j ) ≡         I{(εi ,εj )∈Ωst+1 (ast+1i ,am
                                                              t+1j )}
                                                                      dG (εi ) dG (εj ). The left side is the real
cost of purchasing an additional equity share in the second subperiod of t. The right side is
the discounted expected benefit from carrying an additional equity share into the following
period, which consists of three terms. First, ε̄yt+1 + φst+1 , the expected benefit of holding the
equity share until the end of period t + 1 (i.e., if the investor does not sell the equity in the OTC
market). Second, with probability δθG(ε∗t+1 ), the investor contacts a dealer in the OTC market,
has bargaining power, and wishes to sell equity. In this event, he obtains pt+1 φmt+1 dollars
for selling the marginal equity share which he expects to value E εi yt+1 + φt+1 |εi ≤ ε∗t+1 .
                                                                             s
                                                                                           

Finally, with probability α investor i contacts another investor j in the OTC market. Then

                                                      21
 s (as       m
ωt+1 t+1i , AIt+1 ) (1 − η) denotes the joint probability that i’s preference type is lower than j’s
(so i acts as a seller of equity), and i has bargaining power (which happens with conditional
probability 1−η), and the bilateral gains from trade are constrained by i’s equity holdings (which
given i’s equity holdings, ast+1i , and j’s money holdings, Am
                                                             It+1 , at the time of the trade, occurs
if the bilateral dollar price of equity is low enough, i.e., if j’s individual valuation of equity, εj ,
is low enough). In this event, an additional equity share helps investor i reap gains from trade
in the bilateral trade with the other investor, and i’s expected gain from trading the marginal
share is the (conditional expected) value of the real balances he receives, i.e., pot+1 (εj ) φm
                                                                                               t+1 ,
minus the (conditional expected) value of the equity share he sells, i.e., εi yt+1 + φst+1 .
    Let Am            s
          Dt+1 and ADt+1 denote the quantities of money and equity shares, respectively, held by
all dealers at the beginning of the OTC round of period t+1, i.e., Am
                                                                              R m        D
                                                                    Dt+1 = v at+1d dFt+1 (at+1d ),
and AsDt+1 = v ast+1d dFt+1D (a                m          s
                 R
                                 t+1d ). Let ÃDt+1 and ÃDt+1 denote the total quantities of money

and shares held by all dealers at the end of period t, i.e., Am        m         s          s
                                                              Dt+1 = ÃDt+1 and ADt+1 = π ÃDt+1 .
Similarly, let Ãm          s
                 It+1 and ÃIt+1 denote the total quantities of money and shares held by all in-
vestors at the end of period t, i.e., Am        m         s          s               s        m
                                       It+1 = ÃIt+1 and AIt+1 = π ÃIt+1 + (1 − π) A . Let ĀDt
and ĀsDt denote the quantity of money and shares held after the OTC round of trade of period
t by all the dealers who are able to trade in the first subperiod. Similarly, let Ām        s
                                                                                    It and ĀIt
denote the quantity of money and shares held after the OTC round of trade of period t by all
the investors who are able to trade in the first subperiod. For k = s, m,
                      Z
           ĀDt = κvθ âkd [ād (ati , atd , ε; ψ t ) ; ψ t ] dFtD (atd ) dFtI (ati ) dG (ε)
             k

                            Z
                + κv (1 − θ) âkd [ād∗ (ati , atd , ε; ψ t ) ; ψ t ] dFtD (atd ) dFtI (ati ) dG (ε)
                           Z
                + (1 − κ) v âkd (atd ; ψ t )dFtD (atd )

and
                   Z h                                                                  i
      ĀkIt   =δ         θaki∗ (ati , atd , ε; ψ t ) + (1 − θ) aki (ati , atd , ε; ψ t ) dFtD (atd ) dFtI (ati ) dG (ε)

where ād (ati , atd , ε; ψ t ) ≡ (am                         s
                                    d (ati , atd , ε; ψ t ), ad (ati , atd , ε; ψ t )). We are now ready to define
equilibrium.

Definition 1 An equilibrium is a sequence of terms of trade in the OTC market

                                  {hātd , ātd∗ , âtd id∈D , hāti∗ , āti , ati∗ , ati ii∈I }∞
                                                                                                t=0 ,


                                                                 22
as given in Lemma 1, Lemma 2, and Lemma 3, together with a sequence of asset holdings

                             {hat+1d , ãt+1d id∈D , hat+1i , ãt+1i ii∈I }∞
                                                                           t=0


and prices {ψ t }∞              m s ∞
                 t=0 ≡ {1/pt , φt , φt }t=0 , such that for all t, (i) the asset allocation solves the
individual optimization problems (8) and (11) taking prices as given, and (ii) prices are such
that all Walrasian markets clear, i.e., ÃsDt+1 + ÃsIt+1 = As (the end-of-period-t Walrasian
market for equity), Ãm        m       m
                      Dt+1 + ÃIt+1 = At+1 (the end-of-period-t Walrasian market for money),
and ĀkDt + ĀkIt = AkDt + δAkIt for k = s, m (the period-t OTC interdealer market for equity and
money). An equilibrium is “monetary” if φm
                                         t > 0 for all t, and “nonmonetary” otherwise.


   In what follows, we specialize the analysis to stationary equilibria. That is, equilibria in
which asset holdings are constant over time, i.e., AsDt = AsD and AsIt = AsI , real asset prices
are time-invariant functions of the aggregate dividend, i.e., φst = φs yt , pt φm     s     s
                                                                                t ≡ φ̄t = φ̄ yt ,
φm  m               m m                                                  ∗     s   s   ∗
 t AIt = Zyt , and φt ADt = ZD yt . Hence, in a stationary equilibrium, εt = φ̄ − φ ≡ ε ,
φst+1 /φst = φ̄st+1 /φ̄st = γt+1 , φm   m
                                    t /φt+1 = µ/γt+1 , and pt+1 /pt = µ. Throughout the analysis we
let β̄ ≡ βγ̄ and maintain the assumption µ > β̄, but the following proposition considers the
limiting case µ → β̄.

Proposition 2 The allocation implemented by the stationary monetary equilibrium converges
to the symmetric efficient allocation as µ → β̄.

        B denote the nominal price in the second subperiod of period t of an N -period risk-
   Let qt,k
free pure-discount nominal bond that matures in period t + k, for k = 0, 1, 2, ..., N (so k is
the number of periods until the bond matures). Assume that the bond is illiquid in the sense
that it cannot be traded in the OTC market. Then in a stationary monetary equilibrium,
 B = (β̄/µ)k , and
qt,k
                                                    µ − β̄
                                               ι=                                                (23)
                                                      β̄
is the time-t nominal yield to maturity of the bond with k periods until maturity. Thus, the
optimal monetary policy described in Proposition 2 in which the money supply grows at rate β̄
can be interpreted as a policy that implements the Friedman rule, i.e., ι = 0 for all contingencies
at all dates.




                                                    23
4.1    Pure-dealer OTC market

In this section we consider the case with α = 0, i.e., a market in which all OTC trade is
intermediated by dealers and there is no direct bilateral trade among investors. For the analysis
that follows, it is convenient to define
            "                               #                              "                      #
                  (1 − δθ) 1 − β̄π (ε̂ − ε̄)                                  δθ 1 − β̄π (ε̄ − εL )
     µ̂ ≡ β̄ 1 +                                         and      µ̄ ≡ β̄ 1 +                           (24)
                              ε̂                                               β̄π ε̄ + 1 − β̄π εL

where ε̂ ∈ [ε̄, εH ] is the unique solution to
                                                     Z   ε̂
                                      ε̄ − ε̂ + δθ            G (ε) dε = 0.                              (25)
                                                     εL

Lemma 6 (in the appendix) establishes that µ̂ < µ̄. The following proposition summarizes the
equilibrium set.

Proposition 3 Assume α = 0. (i) A nonmonetary equilibrium exists for any parametrization.
(ii) There is no stationary monetary equilibrium if µ ≥ µ̄. (iii) In the nonmonetary equilibrium,
AsI = As − AsD = As (only investors hold equity shares), there is no trade in the OTC market,
and the equity price in the Walrasian market is

                                                                      β̄π
                                    φst = φs yt , with φs =                 ε̄.                          (26)
                                                                    1 − β̄π

(iv) If µ ∈ (β̄, µ̄), then there is one stationary monetary equilibrium; asset holdings of dealers
and investors at the beginning of the OTC round of period t are Am        m    m
                                                                    Dt = At − AIt = 0 and

                                          = πAs
                                         
                                                       if β̄ < µ < µ̂
                           s      s    s
                          AD = A − AI      ∈ [0, πAs ] if µ = µ̂
                                           =0          if µ̂ < µ < µ̄,
                                         

and asset prices are
                                          
                                               β̄π
                                                   ε∗
                                              1−β̄π h
                                                                                        if β̄ < µ ≤ µ̂
                φst = φs yt , with φs =        β̄π                R ε∗              i                    (27)
                                          
                                              1−β̄π
                                                     ε̄   + δθ     εL    G (ε) dε       if µ̂ < µ < µ̄
                φ̄st = φ̄s yt , with φ̄s = ε∗ + φs                                                       (28)
                            yt
               φmt =Z m                                                                                  (29)
                          At
                       φ̄ s
                 p t = Am                                                                                (30)
                        Z t

                                                         24
where
                                             AsD + δG(ε∗ )AsI
                       Z=                      1
                                                              R εH     1         ,               (31)
                            δθ [1 − G(ε∗ )] ε∗ +φs + δ (1 − θ) ε∗    ε+φs dG (ε)

and for any µ ∈ β̄, µ̄ , ε∗ ∈ (εL , εH ) is the unique solution to
                      

                                     Rε
                             1 − β̄π ε∗H [1 − G (ε)] dε            µ − β̄
                             h               R ε∗       i        −        = 0.                   (32)
                     ε∗ + β̄π ε̄ − ε∗ + δθ εL G (ε) dε I{µ̂<µ}      β̄δθ

                                          β̄π                                             β̄π
(v) (a) As µ → µ̄, ε∗ → εL and φst →          ε̄y .
                                         1−β̄π t
                                                      (b) As µ → β̄, ε∗ → εH and φst →        ε y.
                                                                                         1−β̄π H t


   In the nonmonetary equilibrium, dealers are inactive and equity shares are held only by
investors. With no valued money, investors and dealers cannot exploit the gains from trade
that arise from the heterogeneity in preference types in the first subperiod of every period,
                                                β̄π
and the equilibrium real asset price, φs =     1−β̄π
                                                     ε̄y,   is equal to the expected discounted value
of the dividend stream since the equity share is not traded. (Shares can be traded in the
Walrasian market of the second subperiod, but gains from trade at that stage are nil.) The
stationary monetary equilibrium exists only if the inflation rate is not too high, i.e., if µ < µ̄.
In the monetary equilibrium, the marginal preference type, ε∗ , which according to Lemma 2
partitions the set of investors into those who buy and those who sell the asset when they meet
a dealer in the OTC market, is characterized in part (iv ) of Proposition 3. In the OTC market,
investors with ε < ε∗ who contact dealers sell all their equity holdings for money, while investors
with ε > ε∗ who contact dealers spend all their money buying equity. Thus unlike what happens
in the nonmonetary equilibrium, the OTC market is active in the monetary equilibrium, and
it is easy to show that the marginal type, ε∗ , is strictly decreasing in the rate of inflation, i.e.,
∂ε∗
                           
 ∂µ < 0 both for µ ∈ β̄, µ̂ , and for µ ∈ (µ̂, µ̄) (see Corollary 2 in the appendix). Intuitively, the
real value of money falls as µ increases, and the marginal investor type, ε∗ , decreases, reflecting
the fact that under the higher inflation rate, the investor that was marginal under the lower
inflation rate is no longer indifferent between carrying cash and equity out of the OTC market
(he prefers equity).
   According to Proposition 3, φs yt < (φs + ε∗ )yt = pt φm
                                                          t in the monetary equilibrium, so
Lemma 1 implies that dealers hold no equity shares at the end of the OTC round: all equity is
held by investors, in particular, by those investors who carried equity into the period but were
unable to contact a dealer, and by those investors who purchased equity shares from dealers.
After the round of OTC trade, all the money supply is held by the investors who carried cash

                                                  25
into the period but were unable to contact a dealer, by the investors who sold equity shares
to dealers, and by those dealers who had bargaining power in the OTC negotiations or carried
equity into the OTC market. A feature of the monetary equilibrium is that dealers never hold
money overnight: at the beginning of every period t, the money supply is all in the hands of
investors, i.e., Am           m     m 10 The reason is that access to the interdealer market
                  Dt = 0 and AIt = At .
allows dealers to intermediate assets without having to carry cash. Whether it is investors
or dealers who hold the equity overnight, depends on the inflation rate: if it is low, i.e., if
µ ∈ (β̄, µ̂), then only dealers hold equity shares overnight, that is, ÃsDt+1 = As and ÃsIt+1 = 0
for all t. Conversely, if the inflation rate is high, i.e., if µ ∈ (µ̂, µ̄), then at the end of every
period t, all equity shares are in the hands of investors, i.e., ÃsDt+1 = 0 and ÃsIt+1 = As .
To understand this result, it is useful to inspect the Euler equations for equity shares. In a
stationary equilibrium, (20) reduces to

                                                 s
                                          1 ≥ βπRD (ε∗ ) , “ = ” if ÃsDt+1 > 0,                                      (33)

where
                                                max pt+1 φm       s
                                                                      
                                  s       ∗                t+1 , φt+1     ε∗ + φ s
                                 RD   (ε ) ≡ Et           s             =          γ̄.
                                                       φt                    φs
Dealers do not wish to hold equity overnight if (33) holds with strict inequality. The equilibrium
                                                   s (ε∗ ), consists of the expected capital gain
return to a dealer from holding equity overnight, RD
from purchasing equity in the second subperiod and reselling it in the OTC market of the
following period. Similarly, in a stationary equilibrium (22) reduces to

                                          1 ≥ βπRIs (ε∗ ) , “ = ” if ÃsIt+1 > 0,                                     (34)

where
                          h            R ε∗              i
                           ε̄ + φs + δθ εL (ε∗ − ε)dG (ε) yt+1
         RIs (ε∗ ) ≡ Et
                                                   φs yt
                                    φ̄s                      ε̄∗l + φs                                ε̄∗h + φs
                                                                               
                            ∗
                    = G (ε ) δθ s γ̄ + [(1 − δ) + δ (1 − θ)]           γ̄            + [1 − G(ε∗ )]             γ̄,
                               φ                                 φs                                       φs
          R ε∗                            R εH
ε̄∗l ≡     εL    ε dG(ε)
                   G(ε∗ ) , and ε̄
                                   ∗h ≡
                                              ε∗
                                                      dG(ε)
                                                   ε 1−G(ε ∗ ) . Investors do not wish to hold equity overnight if

(34) holds with strict inequality. The equilibrium expected return to an investor from holding
equity overnight, RIs (ε∗ ), can be thought of as a weighted average of four gross returns. The
  10
       In a stationary equilibrium, (19) becomes µφ̄s > β̄ max φ̄s , φs = β̄ φ̄s .
                                                                       



                                                               26
         φ̄s
first,   φs γ̄,   is the expected capital gain of an investor who sells equity in the OTC market at the
interdealer market price (φ̄s ), which is what occurs with probability G (ε∗ ) δθ, i.e., when the
investor draws a preference type lower than ε∗ (so he wishes to sell in the OTC market), contacts
                                                                        ε̄∗l +φs
a dealer, and has the bargaining power. The second,                        φs γ̄,   is the expected equity return to
an investor who wishes to sell in the OTC market but fails to contact a dealer, which occurs
with probability G(ε∗ ) (1 − δ). In this case the expected equity payoff consists of the expected
value of the period dividend conditional on wanting to sell, Et ε̄∗l yt+1 , and the expected resale
                                                                                                               ε̄∗l +φs
value of the equity in the following Walrasian round of trade, Et φs yt+1 . The third, also                       φs γ̄,
is the expected capital gain of an investor who sells equity in the OTC market at the dealer’s
expected bid price, Et (ε̄∗l + φs )yt+1 , that (in expected value) reaps all the gains from trade
from an investor who wishes to sell, an event that occurs with probability G (ε∗ ) δθ, i.e., when
the investor draws a preference type lower than ε∗ (so he wishes to sell in the OTC market),
                                                                                            ε̄∗h +φs
contacts a dealer, and the dealer has the bargaining power. The fourth,                        φs γ̄,   is the expected
equity return of an investor who does not wish to sell in the OTC market and therefore keeps
the equity share for a full period, which occurs with probability 1 − G(ε∗ ). In this case the
expected equity payoff consists of the expected value of the period dividend conditional on not
wanting to sell, Et ε̄∗h yt+1 , and the resale value of the equity in the following Walrasian round
of trade, Et φs yt+1 .
    From (33) and (34), dealers hold all equity shares overnight (i.e., ÃsDt+1 = As and ÃsIt+1 = 0)
if and only if RIs (ε∗ ) < RD
                            s (ε∗ ), i.e., if and only if ε̄ + δθG (ε∗ ) (ε∗ − ε̄∗l ) < ε∗ . This condition

is equivalent to
                                                       Z   ε∗
                                             ε̄ + δθ            G (ε) dε < ε∗ ,
                                                       εL

which is in turn equivalent to ε̂ <          ε∗ ,   where ε̂ is defined by (25). Intuitively then, all equity
is held by dealers overnight if the marginal preference type that partitions investors between
buyers and sellers is large enough (larger than ε̂), else all equity is held by investors overnight,
and strictly speaking, dealers only provide brokerage services in the OTC market.11
  11
     To get more intuition, write RIs (ε∗ ) = [ε̄ + δθG (ε∗ ) (ε∗ − ε̄∗l ) + φs ]γ̄/φs and notice that ∂RIs (ε∗ ) /∂ε∗ =
δθG (ε∗ ) γ̄/φs < γ̄/φs = ∂RD
                            s
                              (ε∗ ) /∂ε∗ and

   εL + φ s       s                     ε̄ + φs      [δθεH + (1 − δθ) ε̄] + φs                             εH + φ s
       s
            γ̄ = RD (εL ) < RIs (εL ) =      s
                                                γ̄ <             s
                                                                               γ̄ = RIs (εH ) < RD
                                                                                                 s
                                                                                                   (εH ) =          γ̄.
     φ                                     φ                   φ                                             φs
This reasoning is in terms of ε∗ while Proposition 3 is stated in terms of µ, but there is a monotonic relationship
between µ and ε∗ . In the proof of this proposition it is shown that ε̂ < ε∗ if and only if µ < µ̂.




                                                                27
    Given the marginal preference type, ε∗ , part (iv ) of Proposition 3 gives all asset prices in
closed form. The real price of equity (in terms of the homogeneous consumption good) in the
Walrasian round of trade, φst , is given by (32). The dollar price of equity in the OTC market,
pt , is given by (30). The real price of money (in terms of the homogeneous consumption good)
in the Walrasian round of trade, φm
                                  t , is given by (29). The real price of equity (in terms of the
homogeneous consumption good) in the OTC market, pt φm     s
                                                     t = φ̄ yt is given by (28).
    Finally, part (v )(a) states that as the rate of money creation rises toward µ̄, ε∗ approaches
the lower bound of the type distribution, εL , so no investor wishes to sell equity in the OTC
market, and as a result the allocations and prices of the monetary equilibrium approach those
of the nonmonetary equilibrium. Part (v )(b) states that as the rate of money creation falls
toward β̄, ε∗ increases toward the upper bound of the type distribution, εH , so only investors
with the highest preference type purchase equity in the OTC market (all other investors wish
to sell it).

4.2    Non-intermediated OTC market

In this section we consider the case with δ = 0, i.e., a market in which there are no specialized
dealers and all OTC trade is conducted bilaterally among investors. Let
                           "       Z εH Z εH                               #
                                               εi − εj
                    µ̃ ≡ β̄ 1 + αη                  βπ
                                                          dG (εi ) dG (εj ) ,                  (35)
                                    εL   εj  εj + 1−βπ ε̄
and define the function ϕ : [εL , εH ] → R by
                                      Z ε Z εj
                            ϕ (ε) ≡            (εj − εi ) dG (εi ) dG (εj ) .
                                         εL   εL

Proposition 4 Assume δ = 0. (i) Dealers are inactive in any equilibrium, and a nonmonetary
equilibrium exists for any parametrization. (ii) There is no stationary monetary equilibrium if
µ ≥ µ̃. (iii) In the nonmonetary equilibrium there is no trade in the OTC market, and the
equity price in the Walrasian market is
                                                       β̄π
                                              φs =           ε̄y.
                                                     1 − β̄π
(iv) If µ ∈ (β̄, µ̃), then there is one stationary monetary equilibrium and asset prices are
                                                       β̄π
                          φst = φs yt , with φs =            [ε̄ + α (1 − η) ϕ (εc )]          (36)
                                                     1 − β̄π
                                  yt
                         φm
                          t =Z
                                  Am
                                   t


                                                      28
where
                                              Z = (εc + φs ) As ,                                     (37)

and for any µ ∈ β̄, µ̃ , εc ∈ (εL , εH ) is the unique solution to
                           

         Z εH Z εH
                               (1 − β̄π) (εi − εj )                               µ − β̄
                                                          c
                                                              dG (εi ) dG (εj ) −        = 0.         (38)
          εc   εj   (1 − β̄π)εj + β̄π [ε̄ + α (1 − η) ϕ (ε )]                      β̄αη
                                                     β̄π
(v) (a) As µ → µ̃, εc → εL and φst →                     ε̄y .
                                                    1−β̄π t
                                                                 (b) As µ → β̄, εc → εH and φst →
 β̄π
1−β̄π
        [ε̄ + α (1 − η) ϕ (εH )] yt .

    The interdealer market is inactive when δ = 0, and so are dealers. A stationary monetary
equilibrium does not exist if the inflation rate is too large, i.e., if µ ≥ µ̃, and in this case there
is no equity trade and the equity price is equal to the expected discounted present value of
the dividend. If the inflation rate is low enough, i.e., µ ∈ (β̄, µ̃), then a unique stationary
equilibrium exists. In this case an investor i starts every period t with a portfolio of money and
equity, and he is randomly matched with another investor j during the OTC round of trade.
If i’s preference shock is larger than j’s, i.e., if εj < εi , then i will want to purchase all of j’s
equity holdings. Whether he is able to do so depends the quantity of assets that j holds, which
in equilibrium equals As , and the dollar price that i has to pay for the equity. In turn, the
dollar price will depend on whether investor i or investor j has the bargaining power. If i has
the power (this happens with probability η), then the dollar price he pays j for each unit of
                         εj yt +φst
equity is pot (εj ) =       φm      , and since i holds Am
                                                         t dollars in equilibrium, he can afford to buy all
                              t
                            εj yt +φst s
of j’s equity only      if φm A ≤ At , or equivalently, if (εj + φs ) As ≤ Z which using (37) can
                                              m
                                 t
be rewritten as εj       ≤ εc . Thus as µ falls, real balances and εc increase, and the investor who
wishes to buy equity and has the bargaining power, is cash constrained in a smaller fraction of
the bilateral meetings. The value of money depends on the gains from trade of the relatively
high valuation investors who buy equity. The equity price (36) on the other hand, reflects the
gains from trade of the relatively low valuation investors who sell equity in bilateral transactions
(α (1 − η) ϕ (εc ) captures the expected gain from selling equity to another investor in the OTC
round).


5       Asset prices

In this section we study the properties of the equilibrium asset prices in Proposition 3 and
Proposition 4. In particular, we focus on how they depend on monetary policy and the degree

                                                      29
of OTC frictions as captured by the parameters that regulate trading frequency and the relative
bargaining strengths of the various traders.

5.1    Inflation

In a pure-dealer OTC market, the real price of equity in a monetary equilibrium is in part
determined by the option available to low-valuation investors to resell the equity to high-
valuation investors. As µ increases, equilibrium real money balances fall and the marginal
investor type, ε∗ , decreases reflecting the fact that under the higher inflation rate, the investor
type that was marginal under the lower inflation rate is no longer indifferent between carrying
cash and equity out of the OTC market (he prefers equity). Since the marginal investor who
prices the equity in the OTC market has a lower valuation, the value of the resale option is
smaller, which in turn makes the real equity price (both φs and φ̄s ) smaller. As expected, the
real value of money, φm
                      t , also declines with the rate of inflation. These arguments are formalized
in Proposition 5. The top row of Figure 1 illustrates the time paths of the ex-dividend equity
price, φst , real balances φm  m                         m
                            t At , and the price level, φt for different values of µ.


Proposition 5 Consider the formulation with α = 0. In the stationary monetary equilibrium:
(i) ∂φs /∂µ < 0, (ii) ∂ φ̄s /∂µ < 0, (iii) ∂Z/∂µ < 0 and ∂φm
                                                           t /∂µ < 0.


   In a non-intermediated OTC market, the real price of equity in a monetary equilibrium is
also in part determined by the option available to low-valuation investors to resell the equity
to high-valuation investors. A higher inflation rate causes real money balances to decline. This
reduction in real balances enlarges the set of joint realizations of preference types in bilateral
meetings in which the cash constraint binds for high-valuation buyers. In turn, this reduces
the value of the marginal preference type, εc , of the buyer who is just able to purchase all of
the equity from a seller in a bilateral meeting in which the seller has the bargaining power.
The result is that ex ante, the period before the OTC round, investors anticipate that the
expected gains from selling equity in the OTC market are smaller, and this manifests itself as
a smaller equity price in the centralized round of trade. The following proposition formalizes
this intuition.

Proposition 6 Consider the formulation with δ = 0. In the stationary monetary equilibrium:
(i) ∂φs /∂µ < 0, (ii) ∂Z/∂µ < 0 and ∂φm
                                      t /∂µ < 0.



                                                 30
5.2         OTC frictions: trading delays and market power

In a pure-dealer OTC market, δθ is an investor’s effective bargaining power in negotiations
with dealers. A larger δθ implies a larger gain from trade for low-valuation investors when they
off-load the asset onto dealers in the OTC market. This in turn makes investors more willing to
hold equity shares in the centralized market of the previous period, since they anticipate larger
gains from selling the equity in case they were to draw a relatively low preference type in the
following OTC round. As a result, real equity prices, φs and φ̄s , are increasing in δ and θ. This
finding is consistent with the behavior of the illiquidity premia in response to variations in the
measures of liquidity documented by Ang et al. (2013). If δ increases, money becomes more
valuable (both Z and φm
                      t increase), provided we focus on a regime in which only investors carry
equity overnight.12 Proposition 7 formalizes these ideas. The bottom row of Figure 1 illustrates
the time paths of the ex-dividend equity price, φst , real balances φm  m                         m
                                                                     t At , and the price level, φt
for two different values of δ.

Proposition 7 Consider the formulation with α = 0. In the stationary monetary equilibrium:
(i) ∂φs /∂ (δθ) > 0, (ii) ∂ φ̄s /∂ (δθ) > 0, (iii) ∂Z/∂δ > 0 and ∂φm
                                                                   t /∂δ > 0, for µ ∈ (µ̂, µ̄).


         The following proposition establishes that in a non-intermediated OTC market, the value of
holding equity increases with the bilateral meeting probability, as this increases the probability
that the investor may find an opportunity to sell the asset to another investor with higher
valuation. Similarly, the value of money increases with α as this increases the probability the
investor may be able to use money to buy equity if he were to meet a counterparty with lower
valuation.

Proposition 8 Consider the formulation with δ = 0. In the stationary monetary equilibrium:
(i) ∂φs /∂α > 0, (ii) ∂Z/∂α > 0 and ∂φm
                                      t /∂α > 0.


6          Financial liquidity

In this section we use the theory to study the determinants of standard measures of market
liquidity: liquidity provision by dealers, trade volume, and bid-ask spreads. Broker-dealers
in OTC markets provide liquidity (immediacy) to investors by finding them counterparties
    12
         Real balances can actually fall with δ for µ ∈ (β̄, µ̂).



                                                               31
for trade, and/or by trading with them out of their own account, effectively becoming their
counterparty. Trade volume is a manifestation of the ability of the OTC market to reallocate
assets across investors. Bid-ask spreads constitute the main out-of-pocket transaction cost
that investors bear in OTC markets. Section 6.1 focuses on dealers’ decisions to hold asset
inventories with the purpose of becoming trade counterparties for investors. Section 6.2 focuses
on the determinants of trade volume. Bid-ask spreads are analyzed in Section 6.3.

6.1    Liquidity provision by dealers

To simplify the exposition, here we focus on the formulation with α = 0. The following result
characterizes the effect of inflation on dealers’ provision of liquidity by accumulating assets.

Proposition 9 Consider the formulation with α = 0. In the stationary monetary equilibrium:
(i) dealers’ provision of liquidity by accumulating assets, i.e., AsD , is nonincreasing in the
inflation rate. (ii) For any µ close to β̄, dealers’ provision of liquidity by accumulating assets is
nonmonotonic in δθ, i.e., AsD = 0 for δθ close to 0 and close to 1, but AsD > 0 for intermediate
values of δθ.

To understand part (i ) of Proposition 9, recall the discussion that followed Proposition 3. The
expected return from holding equity is larger for investors than for dealers with high inflation
(µ > µ̂) because in that case the expected resale value of equity in the OTC market is relatively
low, and dealers only buy equity to resell in the OTC market, while investors also buy it with
the expectation of getting utility from the dividend flow. For low inflation (µ < µ̂), dealers
value equity more than investors because the OTC resale value is high and they have a higher
probability of making capital gains from reselling than investors, and this trading advantage
more than compensates for the fact that investors enjoy the additional utility from the dividend
flow. Part (ii ) of Proposition 9 states that given a low enough rate of inflation, dealers’ incentives
to hold equity inventories overnight depend nonmonotonically on the degree of OTC frictions
as measured by δθ. In particular, dealers will not hold inventories if δθ is either very small or
very large. If δθ is close to zero, few investors contact the interdealer market, and this makes
the equity price in the OTC market very low, which in turn implies too small a capital gain
to induce dealers to hold equity overnight. Conversely, if δθ is close to one, a dealer has no
trading advantage over an investor in the OTC market and since the investor gets utility from
the dividend while the dealer does not, the investor has a higher willingness to pay for the asset

                                                  32
in the centralized market than the dealer, and therefore it is investors and not dealers who
carry the asset overnight into the OTC market.

6.2    Volume

First consider the case with α = 0. According to Lemma 2, any investor with ε < ε∗t who has a
trading opportunity in the OTC market, sells all his equity. Hence in a stationary equilibrium,
the quantity of assets sold by investors to dealers in the OTC market is Q− = δG (ε∗ ) AsI . From
Lemma 2 we also know that an investor with ε > ε∗t who contacts a dealer will buy equity, and
that the quantity he buys depends on whether the investor or the dealer has the bargaining
power. If the investor has the bargaining power then he purchases Am
                                                                   t /pt equity shares. Thus
the volume of assets traded by such investors is Q+∗ = δθ [1 − G (ε∗ )] Am
                                                                         t /pt . If instead the
dealer has the bargaining power, then the investor purchases Am     o
                                                               t /pt (ε) equity shares. Therefore
                                                                 ε
the volume of assets traded by such investors is Q+ = δ (1 − θ) ε∗H [Am    o
                                                               R
                                                                      t /pt (ε)] dG (ε). The total
quantity of equity shares traded in the OTC market is V = Q− + Q+∗ + Q+ , or equivalently13

                                   V = π ÃsD + 2δG (ε∗ ) (As − π ÃsD ).                                 (39)

Trade volume V depends on µ and θ only indirectly, through ε∗ . A decrease in µ or an increase
in θ, increases the expected return to holding money, which makes more investors willing to sell
equity for money in the OTC market, i.e., ε∗ increases and so does trade volume. The indirect
(through ε∗ ) positive effect on V of an increase in the investors’ trade probability δ is similar to
an increase in θ, but in addition, δ directly increases trade volume since with a higher δ more
investors are able to trade in the OTC market. These results are summarized in the following
proposition.

Proposition 10 Consider the formulation with α = 0. In the stationary monetary equilibrium:
(i) ∂V/∂µ < 0, (ii) ∂V/∂θ > 0 and ∂V/∂δ > 0.

    Next consider the formulation with δ = 0. According to Lemma 3, the quantity traded
in a meeting between two investors depends on whether the buyer or the seller of equity
has the bargaining power. Suppose that investor i has preference type εi and investor j
  13
     To obtain (39) we used the clearing condition for the interdealer market, AsD +Q− = Q+ +Q+∗ which implies
V =Q− + Q+∗ + Q+ = AsD + 2Q− . Also, note that V is trade volume in the OTC market, but since every equity
share traded in the first subperiod gets retraded in the second subperiod, total trade volume in the whole time
period equals 2V.


                                                      33
has preference type εj < εi . If investor i (in this case the buyer) makes the offer, then
                                                     Z
he purchases min {Am   o          s                                    s
                   t /pt (εj ) , A } = I{εc <εj } εj +φs + I{εj ≤εc } A equity shares. Conversely,
if investor j has the bargaining power, then investor i purchases min {Am   o          s
                                                                        t /pt (εi ) , A } =
              Z                 s
I{εc <εi } εi +φs + I{εi ≤εc } A equity shares. Hence the total quantity of equity shares traded in the

OTC market is
                  ( "Z                                                                                       #
                           εc                                       εH           εH
                                                                                  ε c + φs
                                                                Z            Z
            Ṽ = α η            [1 − G (εj )] dG (εj ) +                                   dG (εi ) dG (εj )
                          εL                                       εc        εj   ε j + φs
                                εc                            εH        εi
                                                                             εc + φ s
                          Z                              Z         Z                                  
              + (1 − η)              G (εi ) dG (εi ) +                               dG (εj ) dG (εi ) As .
                               εL                         εc        εL       εi + φ s
In trades where the investor with no bargaining power has preference type ε < εc , all the equity
holdings of the seller, As , are traded. In meetings where the investor with no bargaining power
                                                                                                          Z         (εc +φs )As
has preference type ε > εc , the cash constraint of the buyer binds, and only                          εj +φs    =    εj +φs
equity shares are traded. Notice that inflation only affects Ṽ indirectly, through its                          effect on εc
(or equivalently, real balances, Z). Higher inflation reduces the value of real balances and this
implies that the cash constraint will bind in more trades, causing trade volume to decline along
the intensive margin (i.e., by reducing the quantity of equity traded in trades in which the agent
with no bargaining power has relatively high valuation for the dividend). An increase in the
contact probability α increases Ṽ along the extensive margin (more meetings among investors
naturally result in larger trade volume), but an increase in α also increases real balances and
therefore induces an increase in trade volume along the intensive margin. This intuition is
formalized in the following proposition.

Proposition 11 Consider the formulation with δ = 0. In the stationary monetary equilibrium:
(i) ∂ Ṽ/∂µ < 0, and (ii) ∂ Ṽ/∂α > 0.

6.3     Spreads

Focus on the formulation with α = 0. Corollary 1 shows that when dealers with bargaining
power execute trades on behalf of their investors, they charge an ask price pot (ε) > pt to investors
with ε > ε∗ who wish to buy equity, and pay a bid price pot (ε) < pt to investors with ε < ε∗
who wish to sell equity. Thus in any transaction with an investor with preference type ε, the
dealer earns a nominal spread Stm (ε) = |pot (ε) − pt |. Define the real spread S (ε) = Stm (ε) /pt ,
i.e.,
                                                              |ε − ε∗ |
                                                 S (ε) =                .
                                                              ε∗ + φ s

                                                          34
                                     R
The average real spread is S̄ =          S (ε) dG (ε), i.e.,
                                     "Z                                                    #
                                          ε∗                           εH
                             1
                                                                   Z
                      S̄ = ∗                   (ε∗ − ε) dG (ε) +            (ε − ε∗ ) dG (ε) .
                          ε + φs         εL                        ε∗

The change in the average spread in response to changes in µ, δ or θ, are ambiguous in general.
The reason is that S (ε) is decreasing in ε∗ for buyers with ε > ε∗ , but may be increasing in ε∗
for investors who wish to sell (i.e., those with ε < ε∗ ).


7     Speculation

According to Proposition 3 and Proposition 4, in a monetary equilibrium the equity price, φs ,
is larger than the expected present discounted value that any agent assigns to the dividend
stream, i.e., φ̂st ≡ β̄π/(1 − β̄π) ε̄yt . It is commonplace to define the fundamental value of
                                 

the asset to be the expected present discounted value of the dividend stream, and to call any
transaction value in excess of this fundamental value, a bubble. One could argue, of course, that
the relevant notion of “fundamental value” should be calculated through market aggregation
of diverse investor valuations, and taking into account the monetary policy stance as well as all
the details of the market structure in which the asset is traded (such as the frequency of trading
opportunities and the degree of market power of financial intermediaries) which ultimately also
factor into the asset price in equilibrium. In any case, to avoid semantic controversies, we
follow Harrison and Kreps (1978) and call the value of the asset in excess of the expected
present discounted value of the dividend, i.e., φst − φ̂st , the speculative premium which investors
are willing to pay in anticipation of the capital gains they will reap when reselling the asset
to investors with higher valuations in the future.14 Like Harrison and Kreps (1978), we say
that investors exhibit speculative behavior if the right to resell a stock makes them willing to
pay more for it than they would pay if obliged to hold it forever. Investors exhibit speculative
behavior in the sense that they buy with the expectation to resell, and naturally the asset price
incorporates the value of this option to resell: investors are willing to pay more for the asset
than they would pay if obliged to hold it forever.
   14
      To clarify, our notion of speculative premium corresponds to the notion of speculative bubble that is used
in the modern literature on bubbles. See, e.g., Barlevy (2007), Brunnermeier (2003), Scheinkman and Xiong
(2003a,b), Scheinkman (2013), and Xiong (2013), who discuss Harrison and Kreps (1978) in the context of what
is generally known as the resale-option theory of bubbles.




                                                        35
   Consider the case pure-dealer case (i.e., α = 0). According to Proposition 3, in a monetary
equilibrium the speculative premium is Pt = Pyt , where
                              ( β̄π
                                 1−β̄π
                                       (ε∗ − ε̄)      if β̄ < µ ≤ µ̂
                          P=      β̄π    R ε∗

                                 1−β̄π
                                       δθ εL G (ε) dε if µ̂ < µ < µ̄.

The speculative premium is positive in any monetary equilibrium, i.e., Pt ≥ 0, with “=” only if
µ = µ̄. Since ∂ε∗ /∂µ < 0 (Corollary 2), it is immediate that the speculative premium is decreas-
ing in the rate of inflation. Intuitively, anticipated inflation reduces the real money balances
used to finance asset trading, which limits the ability of high-valuation traders to purchase
the asset from low-valuation traders. As a result, the speculative premium is decreasing in µ.
Since ∂ε∗ /∂ (δθ) > 0 (see the proof of Proposition 7), the speculative premium is increasing
in δ and θ. Intuitively, the speculative premium is the value of the option to resell the equity
to a higher valuation investor in the future, and the value of this resale option to the investor
increases with the probability δ that the investor gets a trading opportunity in an OTC trading
round and with the probability θ that he can capture the gains from trade in those trades.
Interestingly, notice that the signs of these effects are exactly the opposite than they are for
trade volume. So in low-inflation regimes, the model predicts large trade volume and a large
speculative premium. Figure 2 illustrates the time path of the speculative premium Pt for two
values of µ. The following proposition summarizes these results.

Proposition 12 Consider the formulation with α = 0. In the stationary monetary equilibrium:
(i) ∂P/∂µ < 0, and (ii) ∂P/∂ (δθ) > 0.

   Consider a non-intermediated OTC market (i.e., δ = 0). According to Proposition 4, in a
monetary equilibrium the speculative premium is P̃t = P̃yt , where

                                            β̄π
                                   P̃ =           α (1 − η) ϕ (εc ) .
                                          1 − β̄π

Again, P̃t ≥ 0, with “=” only if µ = µ̄. Higher inflation reduces real balances and therefore
εc , which reduces the expected resale value of equity in the OTC market, so P̃ decreases with
inflation. An increase in the trade probability α has a positive direct effect on P̃ (increase in the
meeting probability) and also an indirect positive effect (α increases εc which in turn increases
P̃). These effects are summarized below.



                                                   36
Proposition 13 Consider the formulation with δ = 0. In the stationary monetary equilibrium:
(i) ∂ P̃/∂µ < 0, and (ii) ∂P/∂α > 0.

         Notice that together, Proposition 7 and Proposition 10 (or alternatively, Proposition 8 and
Proposition 11) imply that changes in the trading probability will generate a positive correlation
between trade volume and the size of the speculative premium. The same is true of changes
in the bargaining power in the context of a pure-dealer OTC market. The positive correlation
between trade volume and the size of speculative premia is a feature of historical episodes that
are usually regarded as bubbles—a point emphasized by Scheinkman and Xiong (2003a, 2003b)
and Scheinkman (2013). In the following section we show that a natural extension of our model
can give rise to recurring episodes of large speculative bubbles supported by high trade volume,
followed by sudden large persistent collapses in trade volume and asset prices.


8         Endogenous trading delays

In this section we endogenize the supply of intermediation services and the length of the trading
delays by allowing for free entry of dealers. This formalizes the notion that a dealer’s profit
depends on the competition for order flow that he faces from other dealers.
         In this section we use δ to denote a continuously differentiable function of the measure of
dealers in the market, v, i.e., δ : R+ → [0, 1], and let κ (v) ≡ δ (v) /v. We assume δ 0 (v) > 0,
κ0 (v) < 0, and δ 00 (v) < 0. We also specify δ(0) = limv→∞ κ (v) = 0, and limv→∞ δ (v) = κ (0) =
1. These assumptions capture the notion that if the measure of dealers, v, is larger, then each
investor contacts dealers faster, while the order flow for each individual dealer decreases.15
There is a large measure of dealers who can choose to participate in the market. Dealers who
wish to provide intermediation services in the OTC market of period t + 1 must incur a real
resource cost kt in the second subperiod of period t, i.e., right before they can participate in
the OTC round of trade. This entry cost is in terms of the homogeneous good and represents
the ongoing expenses of running the dealership business. To keep the environment stationary,
we assume kt = kyt for some k ∈ R++ .
    15
         The matching function δ (v) = 1 − e−v is an example that satisfies the maintained assumptions.




                                                          37
8.1    Efficiency

With the notation introduced in Section 3, the planner’s problem for the economy with free
entry (and α = 0) consists of choosing a nonnegative allocation
                   n                                                                                o∞
                    vt , ãtD , a0tD , ctD , htD , ãtI , a0tI , [ctI (εi ) , htI (εi )]ε∈[εL ,εH ]    ,
                                                                                                  t=0

to maximize
                            ∞
                                         "       Z
                            X
                       E0            t
                                  β δ (vt )                  εyt a0tI (dε) + [1 − δ (vt )] ε̄yt atI
                            t=0                  [εL ,εH ]
                                                                                           #
                            Z   εH
                        +            [ctI (ε) − htI (ε)] dG (ε) + (ctD − htD )vt
                             εL

subject to

                                                     vt ãtD + ãtI ≤ As                                   (40)
                                             Z
                        vt a0tD + δ (vt )     a0tI (dε) ≤ vt atD + δ (vt ) atI                             (41)
                                             [εL ,εH ]
                Z εH                                      Z εH
                     ctI (ε) dG (ε) + ctD vt + kt vt+1 ≤        htI (ε) dG (ε) + vt htD ,                  (42)
                  εL                                                     εL

(6) and (7). The following proposition characterizes the solution to the planner’s problem.

Proposition 14 The efficient allocation for the model with free entry of dealers has

               −kyt + βEt δ 0 (vt+1 ) (εH − ε̄) yt+1 (1 − π) As ≤ 0, “ = ” if vt+1 > 0,                    (43)

ãtD = (As − ãtI )/vt = As /vt , and a0ti (E) = I{εH ∈E} [π/δ (vt ) + (1 − π)] As , where I{εH ∈E} is an
indicator function that takes the value 1 if εH ∈ E, and 0 otherwise, for any E ∈ F ([εL , εH ]).

8.2    Equilibrium

An equilibrium with free entry is characterized by the same equations that characterize an
equilibrium in the baseline model of Section 2 (replacing δ with δ (vt ) and κ with κ (vt )),
plus the following condition, which must hold in an equilibrium in which dealers are free to
participate in the OTC of any period t

                                  WtD (0) − kt ≤ 0, with “ = ” if vt+1 > 0.                                (44)


                                                               38
For each t, the free-entry condition (44) can be used to determine the additional unknown vt+1 .
Lemma 8 in the appendix shows that (44) can be written as

                                    Φt+1 − kt ≤ 0, with “ = ” if vt+1 > 0                                       (45)

for all t, where
                                                             "Z
                                                                  ε∗t+1
                                                                           (ε∗t+1 −ε)yt+1         s
              Φt+1 ≡ βEt κ (vt+1 ) (1 − θ) φ̄t+1                          ε∗t+1 yt+1 +φst+1 pt+1 AIt+1 dG (ε)
                                                                εL
                                                                   #
                        Z   εH
                                 (ε−ε∗t+1 )yt+1 m
                    +             εyt+1 +φst+1 AIt+1 dG (ε)                                                     (46)
                        ε∗t+1

is a dealer’s discounted expected income from intermediation in the OTC market of period t+1.
                                                                                      1      m
In order to interpret Φt+1 , it is useful to define Qt+1 (ε) ≡                    pot+1 (ε) AIt+1 ,

                                           ε∗t+1
                                                                     dG (ε)
                                       Z
                             b
                            St+1   ≡               [pt+1 − pot+1 (ε)]AIt+1
                                                                    G ε∗t+1
                                                                            
                                      εL
                                     Z εH
                             a                                            dG (ε)
                            St+1   ≡       [pot+1 (ε) − pt+1 ]Qt+1 (ε)             ,
                                       ∗
                                      εt+1                             1 − G ε∗t+1

where pot+1 (ε) (defined in (16)) is the nominal equity price that an investor faces when trading
with a dealer with bargaining power. (So pot+1 (ε) is a nominal bid price for investors with
ε < ε∗ , and the nominal ask price for investors with ε > ε∗ .) With this notation, (46) can be
written as
                                         n                           a o
             Φt+1 = βEt κ (vt+1 ) (1 − θ) G ε∗t+1 St+1 + 1 − G ε∗t+1 St+1
                                                  b    
                                                                           φ̄t+1 .

   Consider a dealer who has the bargaining power in a meeting with a random investor with
preference type ε < ε∗t+1 . In equilibrium, this investor wishes to sell the AsIt+1 equity shares that
he is holding to the dealer, who pays the investor pot+1 (ε) dollars per share, therefore earning
pt+1 −pot+1 (ε) dollars per share, for a total intermediation profit equal to pt+1 − pot+1 (ε) AsIt+1
                                                                                             

                b
dollars. Hence St+1 is the expected value of the dealer’s nominal profit from intermediation,
conditional on having contacted an investor who wants to sell equity. Next consider a dealer who
has the bargaining power in a meeting with a random investor with preference type ε > ε∗t+1 . In
equilibrium, this investor wishes to use spend all his money holdings, Am
                                                                        It+1 , to purchase shares
from the dealer. The dealer charges the investor pot+1 (ε) dollars per share, so at this price the
investor wishes to buy Qt+1 (ε) shares from the dealer. The dealer earns pot+1 (ε) − pt+1 dollars

                                                              39
per share in this transaction, for a total intermediation profit equal to pot+1 (ε) − pt+1 Qt+1 (ε)
                                                                                         

                a is the expected value of the dealer’s nominal profit from intermediation, con-
dollars. Hence St+1
ditional on having contacted an investor who wants to buy equity. Since the dealer can rebalance
his portfolio of equity and cash freely in the interdealer market, the expected real value of his
                               a φ̄
profit from intermediation is St+1                                                       b
                                    t+1 , conditional on having contacted a buyer, and St+1 φ̄t+1

conditional on having met a seller. Hence βEt G ε∗t+1 St+1     + 1 − G ε∗t+1 St+1
                                                         b                 a
                                                                                     φ̄t+1 is the
discounted expected real income from intermediation to a dealer in period t + 1, conditional
on his contacting an investor in the OTC market (with probability κ (vt+1 )), and conditional
on the dealer having the bargaining power in the bilateral negotiation with the investor (with
probability 1 − θ).
   To simplify the exposition hereafter we specialize the analysis to the pure-dealer model with
α = 0. We also focus on stationary equilibria, that is, equilibria in which the measure of dealers
and asset holdings are constant over time, i.e., vt = v, AsDt = AsD , and AsIt = AsI , real asset
prices are time-invariant functions of the aggregate dividend, i.e., φst = φs yt , pt φm     s     s
                                                                                       t ≡ φ̄t = φ̄ yt ,
φm  m               m m                                                  ∗     s   s   ∗
 t AIt = Zyt , and φt ADt = ZD yt . Hence, in a stationary equilibrium, εt = φ̄ − φ ≡ ε ,
φst+1 /φst = φ̄st+1 /φ̄st = γt+1 , φm   m
                                    t /φt+1 = µ/γt+1 , and pt+1 /pt = µ, and Φt = Φ for all t. We
again let β̄ ≡ βγ̄ and maintain the assumption µ > β̄, but the following proposition considers
the limiting case µ → β̄. A stationary equilibrium with entry is summarized by a sequence
of nominal prices {φm                                           s s
                                                                       
                    t , pt }, a sequence of real asset prices, φt , φ̄t , a pair of money holdings
(Am    m                                s
  D , AI ), a pair of equity holdings (AD , A), a sequence of real balances, {Zyt }, and a threshold
ε∗ that satisfy the conditions reported in Proposition 3 (with δ replaced by δ (v)), together with
a number of active dealers, v, that satisfies (47)

                                  Φ̄ − k ≤ 0, with “ = ” if v > 0,                                  (47)

where                                "                                                        #
                                           Z   ε∗                        Z   εH
                                                                                  ε−ε∗
                Φ̄ ≡ β̄κ (v) (1 − θ) AsI            (ε∗ − ε)dG (ε) + Z            ε+φs   dG (ε) .   (48)
                                           εL                            ε∗


Proposition 15 Assume k < β̄ (1 − θ) (εH − ε̄) (1 − π) As . The allocation implemented by
the stationary monetary equilibrium converges to the symmetric efficient allocation as µ → β̄,
                                                                         −κ0 (v)v
provided the bargaining power of dealers satisfies 1 − θ = 1 −            κ(v) .


   Proposition 15 establishes that with dealer entry, the Friedman rule achieves efficiency


                                                       40
only if the Hosios (1990) condition is satisfied.16 Under the Hosios condition, the share of
the gain from trade that is apportioned by dealers in bilateral meetings, 1 − θ, equals the
elasticity of the aggregate number of meetings with respect to the number of participating
dealers, 1 + κ0 (v) v/κ (v) (i.e., the contribution that the marginal dealer makes to the matching
process). Thus, generically, deviations from the Friedman rule could be welfare enhancing in
the absence of other policies designed to restore the efficiency of the dealers’ entry decision.


9         The Fed Model and the Modigliani-Cohn hypothesis

The high inflation of the 1970s stimulated researchers to ask whether stocks are a good hedge
against inflation. In a well-known paper, Fama and Schwert (1977) found that, contrary to
long-held beliefs, common stocks were rather perverse as hedges against inflation. They found
that common stock returns were negatively related to the expected inflation rate during the
1953-71 period, and that they also seemed to be negatively related to the unexpected inflation
rate.17 In line with these observations, in the late 1970s Modigliani and Cohn (1979) pointed
out that the ratio of market value to profits of firms had declined consistently since the late
1960s. They observed that this fact was consistent with investors who capitalize equity earnings
using a nominal interest rate instead of a real one, and settled on this kind of money illusion as
the most reasonable explanation. More recently, Sharpe (2002), Asness (2000), Lansing (2004)
and many others have documented that yields on stocks (e.g., as measured by the dividend-
price ratio) are highly correlated with nominal bond yields.18 Since stocks are claims to cash
flows from real capital and inflation is the main driver of nominal interest rates, this correlation
has proven difficult to rationalize with conventional asset pricing theory.19
         Theory aside, this correlation has led financial practitioners to adopt the so-called Fed Model
of equity valuation to calculate the “correct” price of stocks.20 In its simplest form, the Fed
    16
      This is a standard result in the monetary search literature, see, e.g., Berentsen et al. (2007).
    17
      At the time of Fama and Schwert’s writing, Lintner (1975), Jaffe and Mandelker (1976), Bodie (1976), and
Nelson (1976) had offered similar empirical evidence. Cagan (1974) is an early effort to study these issues using
some historical records.
   18
      Along similar lines, Bordo and Wheelock (2007) review the histories of major 20th century stock market
booms in the United States and nine other countries. They find that booms usually arose when inflation was below
its long-run average, and that booms typically ended when inflation began to rise and/or monetary authorities
tightened policy in response to rising or a threatened rise in inflation. Ritter and Warr (2002) argue that the
decline in inflation was a major factor leading to the bull market of 1982-1999.
   19
      See the discussions in Ritter and Warr (2002), Asness (2003), and Campbell and Vuolteenaho (2004).
   20
      Sharpe (2002), Asness (2003), and Feinman (2005) discuss the popularity of the Fed Model among Wall
Street analysts and strategists.


                                                       41
Model says that, because stocks and nominal Treasury bonds compete for space in investors’
portfolios, their yields should be positively correlated. That is, if the yield on bonds rises, then
the yield on stocks must also rise to maintain the competitiveness of stocks vis a vis bonds.
Practitioners use this reasoning to argue that the yield on nominal bonds (plus a risk premium
to account for the relative riskiness of stocks) defines a “normal” yield on stocks: if the measured
stock yield is below this normal yield, then stocks are considered overpriced; if the measured
stock yield is above this normal yield, then stocks are considered underpriced.21
    The relationship between equity prices and monetary policy also appears to have been clear
in the minds of policymakers. Alan Greenspan, for example, famously held the view that stock
market booms are more likely to occur when inflation is low. He saw a dilemma in the use of
monetary policy to defuse stock market booms:

           “We have very great difficulty in monetary policy when we confront stock market bub-
      bles. That is because, to the extent that we are successful in keeping product price inflation
      down, history tells us that price-earnings ratios under those conditions go through the roof.
      What is really needed to keep stock market bubbles from occurring is a lot of product price
      inflation, which historically has tended to undercut stock markets almost everywhere. There
      is a clear trade-off. If monetary policy succeeds in one, it fails in the other. Now, unless
      we have the capability of playing in between and managing to know exactly when to push
      a little here and to pull a little there, it is not obvious to me that there is a simple set of
      monetary policy solutions that deflate the bubble.” (Alan Greenspan, FOMC transcript,
      September 24, 1996, pp. 30-31.)

    To fix ideas, consider a standard Lucas (1978) economy in which a risk-neutral investor with
discount rate β prices a tree that is subject to a shock that renders it permanently unproductive
with probability 1 − π. Conditional on remaining productive, the tree yields real dividend Dt ,
  21
     The term Fed Model appears to have been first used by securities strategist Ed Yardeni in 1997 following
the publication of the Federal Reserve Humphrey-Hawkins Report for July 1997. In Section 2 (“Economic and
Financial Developments in 1997”), a chart plotted the time series for the earnings-price ratio of the S&P 500
against the 10-year constant-maturity nominal treasury yield and reported: “The run-up in stock prices in the
spring was bolstered by unexpectedly strong corporate profits for the first quarter. Still, the ratio of prices in
the S&P 500 to consensus estimates of earnings over the coming twelve months has risen further from levels that
were already unusually high. Changes in this ratio have often been inversely related to changes in long-term
Treasury yields, but this year’s stock price gains were not matched by a significant net decline in interest rates.
As a result, the yield on ten-year Treasury notes now exceeds the ratio of twelve-month-ahead earnings to prices
by the largest amount since 1991, when earnings were depressed by the economic slowdown.”



                                                        42
with Dt+1 = γt+1 Dt , where γt+1 is a nonnegative random variable with mean γ̄ ∈ (0, (βπ)−1 ).
The real price of an equity share of the tree is

                                                          β̄π
                                                Pts =           Dt .
                                                        1 − β̄π
If we set Dt = ε̄yt , this is just the equity price in the nonmonetary equilibrium of Proposition
3. We can use this expression to obtain

                                             D̄t+1
                                                   = (1 + r) − γ̄π,                                            (49)
                                              Pts

where D̄t+1 ≡ γ̄πDt denotes the expected dividend (conditional only on the tree having survived
period t) and 1 + r = 1/β is the real risk-free rate. Condition (49) is known as the “Gordon
growth model” (e.g., Gordon (1962), Williams (1938)). The left side is the dividend (or stock)
yield, which is equal to the real risk-free rate, 1 + r, minus the expected growth rate of the
real dividend, D̄t+1 /Dt = γ̄π. All the variables in (49) are real. In particular, since a rational
investor’s Euler equation equates the expected real equity return to the risk-free real interest
                s                   s      (P s +yt+1 )
rate, i.e., Et Rt+1 = 1 + r, where Rt+1 ≡ π t+1P s      , the investor uses the real interest rate
                                                              t
r to discount future dividends.22 According to the narrative behind the Fed Model, however,
investors allocate their portfolio between stocks and nominal long-term bonds by comparing
the expected real return on equity to the expected nominal bond yield, i.e., they use the wrong
                    s
Euler equation, Et Rt+1 = 1 + ι. This leads to

                                             D̄t+1
                                                   = (1 + ι) − γ̄π,
                                              Pts

which “explains” the positive relation between the nominal bond yield ι = (µ − β̄)/β̄ and the
stock yield D̄t+1 /Pts by saying that investors suffer from money illusion in the sense that they
discount future real dividends using the nominal rate, ι, rather than the real rate, r. This is the
Modigliani-Cohn hypothesis. Financial analysts are often ambivalent toward the Fed Model.
On the one hand, “it works” empirically. On the other hand, they are reluctant to recommend
it to clients because the conventional logic behind it is fundamentally flawed; it is inconsistent
with investor rationality.23
  22
     As before, Et is the expectation over yt+1 , conditional on the information available in period t, as well as on
the tree surviving period t + 1.
  23
     For example, Feinman (2005) (Chief Economist at Deutsche Management Americas in New York) writes:
“If interest rates are to be brought into the calculus at all, they should be real rates, not nominal. This is not


                                                         43
    Despite much skepticism, however, the Modigliani-Cohn hypothesis remains the leading
explanation for the positive correlation between stock yields and nominal bond yields, and
for the empirical success of the Fed Model. Campbell and Vuolteenaho (2004) empirically
decompose the S&P500 stock yield into three components: (i ) a rational forecast of long-run
expected dividend growth, (ii ) a subjective risk premium (identified from a cross-sectional
regression), and (iii ) a residual “mispricing term.” They evaluate three hypotheses for why
low stock prices coincide with high inflation: (1) High inflation coincides with low expected
dividend growth. (2) High inflation coincides with a high (subjective) risk premium. (3)
Investors suffer from money illusion. Campbell and Vuolteenaho (2004) assess these hypotheses
by regressing the three components of the dividend yield (the expected dividend growth, risk
premium, and the residual mispricing term) on an exponentially smoothed moving average of
inflation. The regression coefficient of expected dividend growth on inflation is positive and
large, so the raw correlation between inflation and expected dividend growth is not negative
as required by the first hypothesis. The regression coefficient of the risk premium on inflation
is negative but small, indicating that the risk premium is not increasing with inflation as
required by the second hypothesis. Thus, Campbell and Vuolteenaho (2004) reject the two
conventional rational hypotheses for the positive correlation between the dividend yield and
inflation. The regression coefficient of the residual mispricing term on inflation is positive,
large, and statistically significant. Moreover, the R2 on this regression is 77.90, indicating
that inflation accounts for about 80% of the variability in the mispricing term. Based on
this evidence, Campbell and Vuolteenaho (2004) conclude that the positive correlation of the
to deny that equity prices seem to be set as if investors are comparing equity yields with nominal interest rates.
But this just demonstrates the error of money illusion. It should not be construed as recommending that error.”
Similarly, Asness (2003) writes: “Historically S&P 500 earnings-price ratio and 10-Year Treasury Rate have
been strongly related... The correlation of these two series over this period [1965-2001] is an impressive +0.81.
I am far from unique in presenting a graph like figure 1. It’s a rare Wall Street strategist that in the course of
justifying the Fed Model (or similar analytic) does not pull out a version of this figure... If you are trying to
explain why price-earning ratios are where they are, based on investors behaving in a similar manner in the past
(errors and all), then feel free to use the Fed Model (hopefully modified for volatility as in this paper), but do
not confuse that with a tool for making long-term recommendations to investors.” Siegel (2002): “It is true that
bonds are the major asset class that competes with stocks in an investor’s portfolio, so one might expect that
low interest rates would be favorable to stocks. But since in the long run low interest rates are caused by low
inflation, the rate of growth of nominal earnings, which depends in large part on the rate of inflation, will be
lower also. Over long periods of time, changes in the inflation rate cause changes in earnings growth of the same
magnitude and do not change the valuation of stocks.” See also Ritter and Warr (2002). Modigliani and Cohn
(1979) themselves expressed some skepticism about their money illusion hypothesis: “. . . we readily admit that
our conclusion is indeed hard to swallow—and especially hard for those of us who have been preaching the gospel
of efficient markets. It is hard to accept the hypothesis of a long-lasting, systematic mistake in a well-organized
market manned by a large force of alert and knowledgeable people.”


                                                        44
dividend yield with inflation is mostly due to the mispricing term, i.e., stocks appear to be
undervalued by conventional measures when inflation is high.24 In the remainder of this section
we show our theory offers a novel explanation for this finding: the effects that inflation has on
asset prices through the liquidity (or resalability) channel. The new explanation we propose will
be transparent because our theory does not assume irrational investors that suffer from money
illusion and it abstracts from the other channels through which high inflation may depress real
asset prices, such as the possibility that it may adversely affect firms’ profitability or riskiness.25
       Consider the pure-dealer version of the model analyzed in Proposition 3 (the main idea
would not change if we consider the nonintermediated market structure of Proposition 4). The
equilibrium equity price is
                                                         β̄π
                                               φst =            (ι) yt
                                                       1 − β̄π
                                  R ε∗
where  (ι) ≡ max{ε∗ , ε̄+δθ       εL    G (ε) dε}. Since ε∗ is decreasing in the growth rate of the money
supply, µ, and the nominal bond yield, ι, is increasing in µ, we have 0 (ι) < 0. Let ȳt+1 ≡ γ̄πyt
denote the expected dividend (conditional only on the tree having survived period t). The log
dividend yield is
                             log ȳt+1 − log φst = log [(1 + r) − γ̄π] − log  (ι) ,                           (50)

and it is increasing in the nominal yield, ι. Thus, (50) rationalizes the Fed Model, despite the
  24
      To the extent that these types of studies do not fully control for risk, the results may confound the impact
of risk attitudes and attribute them to some anomaly such as money illusion. Cohen et al. (2005) revisit the
robustness of the results of Campbell and Vuolteenaho (2004) by further controlling for changes in the risk
premium. They exploit the fact that if the equity premium is high for risk-related reasons, then there is a cross-
sectional implication, namely that high-beta stocks should outperform low-beta stocks in such periods. The
Modigliani-Cohn hypothesis, on the other hand, implies that inflation-driven mispricing will apply to all stocks
equally, causing all stocks to be equally underpriced when inflation is high. Cohen et al. (2005) show the latter
is the case and interpret this as further confirmation of the Modigliani-Cohn hypothesis. Bekaert and Engstrom
(2010) find the bulk of the contribution to the covariance between equity and bond yields comes from the
positive comovements between expected inflation and a residual term, just like Campbell and Vuolteenaho (2004).
However, Bekaert and Engstrom (2010) claim that this is due to a correlation between expected inflation and
two plausible proxies for rational time-varying risk premia: a measure of economic uncertainty (the uncertainty
among professional forecasters regarding real GDP growth) and a consumption-based measure of risk aversion.
Thus, they offer a rational channel that could potentially explain why the Fed model “works:” their explanation
is that high expected inflation coincides with periods of high risk aversion and/or economic uncertainty, which
conflicts with Campbell and Vuolteenaho (2004) and Cohen et al. (2005). The papers differ on the specifics of
how they measure equity risk premia and on the sample period (Bekaert and Engstrom focus on the post-war
subsample while Campbell and Vuolteenaho and Cohen et al. go back to 1930s). Bekaert and Engstrom (2010)
conclude that “Using this data set alone, it is likely hard to definitively exclude the money illusion story in favor
of our story.”
   25
      Basak and Yan (2010).explore the asset pricing implications of the money illusion hypothesis and Campbell
et al. (2014) focus on the monetary policy drivers of the riskiness of bonds and equities.



                                                          45
fact that agents do not suffer from money illusion (they discount payoffs using the risk-free real
rate 1 + r), risk premia do not change (since agents are risk-neutral here), and the expected
growth rate of the dividend, γ̄π, is unaffected by monetary considerations. Notice that this is
true even if δθ = 1, i.e., even as OTC frictions faced by investors vanish. Many of the studies
that document the positive correlation between stock yields and nominal bond yields use index
stocks typically traded in markets usually regarded as frictionless, such as the New York Stock
Exchange. All the same, our theoretical mechanism operates even if investors are able to trade
stocks with no trading delays (i.e., δ = 1) and no intermediation fees (i.e., θ = 1).26


10      Liquidity crises and market crashes

In this section we show that the model of Section 8 admits dynamic rational-expectations
equilibria that exhibit episodes that resemble “liquidity crises” and “market crashes,” and we
use the model to explore the scope for welfare enhancing monetary interventions. The basic
idea is to construct equilibria with random belief-driven oscillations in asset prices and standard
measures of market liquidity, such as trade volume, spreads, execution delays borne by investors,
and liquidity provision by dealers (both by matching buyers and sellers as well as by holding
asset inventories on their own account). To this end, we construct stationary sunspot equilibria
in the model with a pure-dealer OTC market and endogenous entry of dealers.27
  26
      There is a literature that focuses on the effects of inflation on real prices of assets that trade in markets
were trading delays and intermediation costs are substantial, such as housing. For example, Brunnermeier and
Julliard (2008) decompose the housing price-rent ratio in the UK into three components: expected future returns
on housing investment, rent growth rates, and a mispricing component. They find that inflation and nominal
interest rates explain a large share of the time series variation in the mispricing term, and that through this
term, a reduction in inflation can generate substantial increases in housing prices. Like the literature discussed
in this section, they attribute this mispricing term to money illusion. Motivated by similar observations, Piazzesi
and Schneider (2008) develop a housing model with investors who suffer from money illusion (they believe that
changes in nominal interest rates reflect changes in real interest rates) and investors who understand the Fisher
equation (i.e., that bond returns are given by the nominal rate minus expected inflation). Since borrowing
is assumed to be backed by real estate, disagreement about real rates among investors increases house prices.
Through this mechanism, inflation shocks can cause house-price booms.
   27
      Our sunspot equilibria are of course in the spirit of Cass and Shell (1983). Such equilibria are quite common
in monetary models: Lagos and Wright (2003) study dynamic equilibria in the baseline Lagos and Wright (2005)
model and find a rich set of dynamic equilibria, including cycles and sunspot equilibria. Rocheteau and Wright
(2013) find sunspot equilibria in a nonmonetary version of Lagos and Wright (2005) in which consumers use
equity shares on a Lucas tree to pay for consumption goods, e.g., as in Lagos (2010), and in which there is free
entry of producers. In the context of the search-based literature on OTC financial markets, dynamic equilibria
are studied in Lagos and Rocheteau (2009) and Lagos et al. (2011), where equilibrium is unique and converges
monotonically to the unique steady state. Lagos and Rocheteau (2009) find that for some parametrizations, a
version of their model in which the number of dealers is determined endogenously by an entry condition delivers
multiple steady states.


                                                        46
   Suppose that in the second subperiod of period t, all agents observe the realization Xt+1 ∈ X
of an extraneous random variable, a “sunspot” that evolves according to a Markov chain, with
                                           P
σij = Pr (Xt+1 = j|Xt = i) ∈ (0, 1), where    j∈X σij = 1 for each i ∈ X. It can be shown
                                                                                                       p φ̃m −φ̃s
that in this formulation the marginal investor type in the OTC market is ε∗t = t tyt t , where
φ̃kt ≡ EXt+1 φkt |Xt , for k = m, s. We explore the existence of equilibria in which allocations
                   

and prices are time invariant functions of the aggregate dividend and the sunspot. That is,
equilibria in which for all t such that Xt+1 = j ∈ X, vt+1 = vj , AsDt+1 = AsDj , and AsIt+1 = AsIj ,
with φst = φsj yt , pt φm    o    o       m m      m m                           ∗       o     s    ∗
                        t ≡ φt = φj yt , φt AIt = φt At = Zj yt , and therefore εt+1 = φ̃j − φ̃j ≡ εj ,
where φ̃oj ≡ i∈X σji φoi and φ̃sj ≡ i∈X σji φsi . (As usual, dealers never hold money overnight.)
             P                         P

The Euler equations for real balances and equity between any two periods t and t + 1 with
Xt+1 = i are
                                  "                                    #
                                                        ε − ε∗i
                                                  Z εH
                               β̄
                          Zi =      1 + δ (vi ) θ                 dG(ε) Z̃i                                         (51)
                               µ                   ε∗i ε∗i + φ̃si
                                   "                                Z ∗                       !#
                                                                                  εi
                          φsi    = β̄π   φ̃si   + max   ε∗i , ε̄   + δ (vi ) θ         G (ε) dε    ,                (52)
                                                                                 εL


                                 A stationary sunspot equilibrium is a vector (vi , Z̃i , φ̃si , AsDi , AsIi , ε∗i )i∈X
              P
where Z̃i ≡       j∈X σij Zj .
that satisfies
                                        "                                   #
                                                             ε − ε∗j
                                                      Z εH
                             β̄ X
                      Z̃i =         σij 1 + δ (vj ) θ         ∗ + φ̃s
                                                                      dG(ε) Z̃j                                     (53)
                             µ                         ε∗   ε j     j
                                j∈X                     j
                                         "                               Z ε∗         !#
                                 X                                          j
                      φ̃si = β̄π     σij φ̃sj + max ε∗j , ε̄ + δ (vj ) θ      G (ε) dε   ,                          (54)
                                   j∈X                                                 εL


with
                                                 AsDj + δ (vj ) G(ε∗j )AsIj
                  Z̃j =                                                   Rε                                        (55)
                       δ (vj ) θ[1 − G(ε∗j )] ε∗ +1 φ̃s + δ (vj ) (1 − θ) ε∗H ε+1φ̃s dG (ε)
                                                 j    j                    j        j
                                           "       Z ε∗                         Z εH                #
                                   δ (vj )              j                             ε−ε ∗
                   k = β̄ (1 − θ)            AsIj         (ε∗j − ε)dG (ε) + Z̃j           j
                                                                                      ε+φ̃sj
                                                                                             dG (ε)                 (56)
                                     vj              εL                          ε∗j
                       (                                       R ε∗
                  s        (1 − π) As if ε̄ + δ (vj ) θ εLj G (ε) dε ≤ ε∗j
                 AIj =                                              R ε∗                                            (57)
                           As              if ε∗j < ε̄ + δ (vj ) θ εLj G (ε) dε
                 AsDj = As − AsIj .                                                                                 (58)

Conditions (53) and (54) are obtained from (51) and (52) by multiplying the latter through by

                                                              47
                                                                             
                                                                       yt+1
                        β = (0.99)1/365                         γ̄ = E        = (1.04)1/365
                                                                       yt       
                        ε ∼ U [0.01, 20]                        Σ=   SD yt+1yt−yt = √0.12
                                                                                       365
                                                                        1/365
                        δ (v) = 1 − e−(0.1)v                    π = (0.9)
                        k = 0.1                                 θ = 0.5
                        yt+1 = µ̄ext+1 yt                       µ = (1.03)1/365
                        xt+1 ∼ N −Σ2 /2, Σ2                     σ00 = (0.996)1/365 ; σ11 ≈ 1
                                             


                      Table 1: Parametrization for stationary sunspot equilibrium

σji , summing over all i ∈ X, and relabeling the subindices.28 For any t and t + 1, suppose that
Xt = i and Xt+1 = j, then the equilibrium growth rates of asset prices are

                 φst+1   φsj         φ̄st+1   φ̄sj         φmt    Zi µ          pt+1   Zi φ̄sj
                       =     γ t+1 ,        =      γ t+1 ,      =         , and      =         µ.
                  φst    φsi           φ̄st   φ̄si         φm
                                                            t+1   Zj γt+1        pt    Zj φ̄si
That is, asset prices follow the dynamic paths implied by the growth rates of the dividend and
the money supply, but the paths themselves are shifted by sunspots.
       Although the economy is admittedly stylized, we nonetheless calibrate the critical param-
eters in order to explore the ability of the theory to generate episodes that resemble liquidity
crises for reasonable parametrizations. We think of a model period as being a day. The discount
factor, β, is chosen so that the annual real risk-free rate equals 1%. The dividend growth rate
is independently lognormally distributed over time, with mean 1.04 and standard deviation
0.12 (per annum), e.g., as in Lettau and Ludvigson (2005). We choose π so that a tree has a
90% chance of remaining productive each year. The dealer’s bargaining power is set to 1/2.
When the measure of active dealers is v, the probability that an investor contacts a dealer
in the OTC market is δ (v) = 1 − e−(0.1)v . The entry cost for dealers is 1% of the average
valuation of the aggregate dividend, i.e., k = 0.1. The growth rate of the money supply is 3%
per year. Finally, we let X = {0, 1}, and identify i = 0 with “normal times” and j = 1 with the
“liquidity-crisis state.” The sunspot is a rare event: both σ00 and σ11 are chosen very close to
1. The parametrization is summarized in Table 1.
       Table 2 reports the key equilibrium variables during normal times and in the liquidity-crisis
state. Figure 3 displays a typical equilibrium path of our daily model simulated for 100 years.
The market starts in the normal state, and the sunspot switches to the liquidity-crisis state in
  28
       It is convenient to define sunspot equilibrium in terms of the conditional expectations of the equity prices,
(Z̃i , φ̃si )i∈X , rather than the realized equity prices, (Zi , φsi )i∈X , but given the former, the latter are immediate
from (51) and (52).


                                                           48
                      φs0 /φs1   δ (v0 )   δ (v1 )   Z0 /Z1   ε∗0 /ε∗1   AsD0   AsD1
                       1.17       0.87      0.04      12.9     2.90       1      0

                             Table 2: Stationary sunspot equilibrium


the first day of year 50. On that day the stock market falls by 17%, as illustrated by the top
left panel. (The lighter path shown in the top left, bottom middle, and bottom right panels
is the path the variable would have followed if the sunspot had not switched.) On the same
day, dealers withdraw from market making and this causes the daily trading probability for
an investor to fall from 90% to 4%, as illustrated by the top middle panel. The right panel
in the top row shows that dealer’s also stop supplying liquidity by carrying assets overnight,
which exacerbates the misallocation of the asset. In the bottom row, the left panel shows that
the average real spread per dollar traded, S̄t , increases drastically, and the middle panel shows
that trade volume collapses abruptly when the crisis hits. The right panel in the bottom row
shows the behavior of real balances. In sum, Figure 3 shows time series with the hallmarks of
a liquidity crisis: a sharp sudden decline in marketmaking and trade volume accompanied by
a sharp sudden increase in trading delays and spreads, at the same time that there is a sharp
sudden crash in asset prices. In layman words: liquidity dries up and the bubble bursts.
     The rationale behind the sunspot equilibrium goes as follows. Dealers withdraw from market
making because they expect low profit from the intermediation business. This makes trading
more difficult for investors (trading delays increase), so real balances, which investors use as
means of payment in financial transactions, fall. As a result, investors with high asset valuations
cannot afford to buy as much equity from low valuation investors. This causes the equity price
to crash, and in turn, lower equity prices, lower trading activity, and lower real balances all
validate the dealer’s decision to withdraw from markets. The self-referential nature of market
liquidity is critical, both in terms of the ability of investors to find counterparties for trade, as
well as the endogenous value of the means of payment (in this case fiat money).


11      Related literature

From a methodological standpoint, the model we develop in this paper bridges the search-
theoretic monetary literature that has largely focused on macro issues, and the search-theoretic
financial OTC literature that focuses on micro considerations in the market microstructure



                                                     49
tradition. Specifically, we embed an OTC financial trading arrangement similar to Duffie et
al. (2005) into a Lagos and Wright (2005) economy. Despite several common ingredients with
those papers, our formulation is different from previous work along two important dimensions.
   In the standard formulations of the Lagos-Wright framework, money (and sometimes other
assets) are used as payment instruments to purchase consumption goods in bilateral markets
mediated by search. We instead posit that money is used as a medium of exchange in OTC
markets for financial assets. In the standard monetary model, money and other liquid assets
help to allocate goods from producers to consumers, while in our current formulation, money
helps to allocate financial assets among traders with heterogeneous valuations. This shift in
the nature of the gains from trade offers a different perspective that delivers novel insights on
the interaction between monetary policy and financial markets. For example, from a normative
standpoint, the new angle emphasizes a new angle on the welfare cost of inflation that is
associated to the distortion of the optimal allocation of financial assets across high and low
valuation investors when real balances scarce. From a positive angle, it explains the positive
correlation between nominal bond yields and real equity yields, something that the conventional
formulation in which monetary or real assets are used to buy consumption goods cannot do.
   As a model of financial trade, an appealing feature of Duffie et al. (2005) is its realistic OTC
market structure consisting of an interdealer market and bilateral negotiated trades between
investors, and between investors and dealers. In Duffie et al. (2005), agents who wish to buy
assets pay sellers with linear-utility transfers. In addition, utility transfers from buyers to sellers
are unconstrained, so effectively there is no bound to what buyers can afford to purchase in
financial transactions. Our formulation keeps the appealing market structure of Duffie et al.
(2005) but improves upon its stylized model of financial transactions by considering traders who
face standard budget constraints and use fiat money to purchase assets. These modifications
make the standard OTC formulation amenable to general equilibrium analysis and deliver a
natural transmission mechanism through which monetary policy influences asset prices and the
standard measures of financial liquidity that are the main focus of the micro strand of the OTC
literature.
   Our work is related to previous studies, e.g., Geromichalos et al. (2007), Jacquet and Tan
(2010), Lagos and Rocheteau (2008), Lagos (2010a, 2010b, 2011), Lester et al. (2012), Nosal and
Rocheteau (2013), that introduce a real asset that can (at least to some degree) be used along
with money as a medium of exchange for consumption goods in variants of Lagos and Wright


                                                  50
(2005). These papers identify the liquidity value of the asset with its usefulness in exchange, and
find that when the asset is valuable as a medium of exchange, this manifests itself as a “liquidity
premium” that makes the real asset price higher than the expected present discounted value
of its financial dividend. High anticipated inflation reduces real money balances; this tightens
bilateral trading constraints, which in turn increases the liquidity value and the real price of the
asset. In contrast, we find that real asset prices are decreasing in the rate of anticipated inflation.
There are some models that also build on Lagos and Wright (2005) where agents can use a real
asset as collateral to borrow money that they subsequently use to purchase consumption goods.
In those models, anticipated inflation reduces the demand for real balances which can in turn
reduce the real price of the collateral asset needed to borrow money (see, e.g., He et al., 2012,
and Li and Li, 2012). The difference is that in our setup inflation reduces the real asset price
by constraining the reallocation of the financial asset from investors with low valuations to
investors with relatively high valuations.29
    We share with two recent papers, Geromichalos and Herrenbrueck (2012) and Trejos and
Wright (2012), the general interest in bringing models of OTC trade in financial markets within
the realm of modern monetary general equilibrium theory. Trejos and Wright (2012) offer an
in-depth analysis of a model that nests Duffie et al. (2005) and the prototypical “second
generation” monetary search model with divisible goods, indivisible money and unit upper
bound on individual money holdings (e.g., Shi, 1995 or Trejos and Wright, 1995). Trejos and
Wright emphasize the different nature of the gains from trade in both classes of models. In
monetary models agents value consumption goods differently and use assets to buy goods, while
in Duffie et al. (2005) agents trade because they value assets differently, and goods which are
valued the same by all investors are used to pay for asset purchases. In our formulation there
are gains from trading assets, as in Duffie et al. (2005), but agents pay with money, as in
standard monetary models. Another difference with Trejos and Wright (2012) is that rather
than assuming indivisible assets and unit upper bound on individual asset holdings as in Shi
(1995), Trejos and Wright (1995) and Duffie et al. (2005), we work with divisible assets and
unrestricted portfolios, as in Lagos and Wright (2005) and Lagos and Rocheteau (2009).
    Geromichalos and Herrenbrueck (2012) extend Lagos and Wright (2005) by incorporating
  29
     In the model that we have developed here, money is the only asset used as means of payment. It would be
straightforward, however, to enrich the asset structure so that investors may choose to carry other real assets
that can be used as means of payment in the OTC market, e.g., along the lines of Lagos and Rocheteau (2008)
or Lagos (2010a, 2010b, 2011). As long as money is valued in equilibrium, we anticipate that the main results
emphasized here would continue to hold.


                                                      51
a real asset that by assumption cannot be used to purchase goods in the decentralized market
(as usual, at the end of every period agents choose next-period money and asset portfolios in
a centralized market). The twist is that at the very beginning of every period, agents learn
whether they will want to buy or sell consumption goods in the subsequent decentralized market
and at that point they have access to a bilateral search market where they can retrade money
and assets. This market allows agents to rebalance their positions depending on their need for
money, e.g., those who will be buyers seek to buy money and sell assets. So although assets
cannot be directly used to purchase consumption goods as in Geromichalos et al. (2007) or Lagos
and Rocheteau (2008), agents can use assets to buy goods indirectly, i.e., by exchanging them
for cash in the additional bilateral trading round at the beginning of the period. Geromichalos
and Herrenbrueck use the model to revisit the link between asset prices and inflation. Their core
results (they have several others) are similar to those obtained in models where the asset can be
used directly as a medium of exchange for consumption goods, i.e., the asset carries a liquidity
premium and higher inflation increases the real asset price in the centralized market. There
are relevant differences between our work and Geromichalos and Herrenbrueck (2012). In our
setup money allows agents to exploit gains from trading assets (as in Duffie et al.) rather than
consumption goods (as in the money literature), which is why we instead find that inflation
reduces asset prices. Also, we consider an OTC market with dealers who act as intermediaries,
which allows us to study the effect of monetary policy on bid-ask spreads and dealers’ incentives
to supply liquidity services—the dimensions of financial liquidity that search-based theories of
OTC markets seek to explain.
   The fact that the equilibrium asset price is larger than the expected present discounted value
that any agent assigns to the dividend stream is reminiscent of the literature on speculative
trading that can be traced back to Harrison and Kreps (1978). As in Harrison and Kreps
and more recent work, e.g., Scheinkman and Xiong (2003a, 2003b) and Scheinkman (2013),
speculation in our model arises because traders have heterogeneous asset valuations that change
over time: investors are willing to pay for the asset more than the present discounted value that
they assign to the dividend stream, in anticipation of the capital gain they expect to obtain
when reselling the asset to higher-valuation investors in the future. In terms of differences, in the
work of Harrison and Kreps or Scheinkman and Xiong, traders have heterogeneous stubborn
beliefs about the stochastic dividend process, and their motive for trading is that they all
believe (at least some of them mistakenly) that by trading the asset they can profit at the


                                                 52
expense of others. In our formulation traders simply have stochastic heterogeneous valuations
for the dividend, as in Duffie et al. (2005). Our model offers a new angle on the speculative
premium embedded in the asset price, by showing how it depends on the underlying financial
market structure and the prevailing monetary policy that jointly determine the likelihood and
profitability of future resale opportunities. Through this mechanism our theory can generate
a positive correlation between trade volume and the size of speculative premia, a key stylized
fact that the theory of Scheinkman and Xiong (2003b) also explains. In terms of differences,
we are able to construct dynamic belief-driven equilibria in which recurring episodes of large
speculative bubbles supported by high trade volume are followed by sudden large persistent
collapses in trade volume and asset prices.


12      Conclusion

We have developed a model in which money is used as a medium of exchange in financial
transactions that take place in over-the-counter markets. In any monetary equilibrium the real
asset price contains a speculative premium that is positively related to the quantity of real
money balances and therefore negatively correlated with anticipated inflation and the long-
term nominal interest rate. As a result, the asset price generically exceeds the expected present
discounted value that any agent assigns to the dividend stream. We have shown that this
simple mechanism rationalizes the positive correlation between the real yield on stocks and the
nominal yield on Treasury bonds—an empirical observation long regarded anomalous. We have
also used the model to study how monetary considerations and the microstructure of the market
where the asset is traded jointly determine the standard measures of financial liquidity of OTC
markets, such as the size of bid-ask spreads, the volume of trade, and the incentives of dealers
to supply immediacy, both by choosing to participate in the market-making activity, as well
as by holding asset inventories on their own account. We have shown that there exist multiple
equilibria as well as dynamic equilibria that resemble expectation driven “market crashes”
or “liquidity crises” in which market liquidity suddenly dries up: dealers drastically reduce
their market-making activity, trade volume drops, bid-ask spreads widen, and asset prices fall
abruptly.
     We conclude by mentioning what we think are two promising avenues for future work. First,
given that the model can generate inefficient liquidity crises, it would be interesting to explore
the scope for welfare enhancing monetary policy, both conventional, e.g., by changing inflation

                                               53
and nominal rates, and unconventional, e.g., by issuing fiat money to purchase assets whose
markets have suddenly become illiquid. Second, the model could be useful to interpret the
behavior of asset prices in OTC markets. Recently Ang et al. (2013) have analyzed a large cross
section of OTC-traded common stocks from 1977 through 2008 and find that equity returns are
increasing in the proportion of non-trading days (i.e., days in which the stock was not traded)
and decreasing in the trade volume of the stock. They interpret these findings through the lens
of asset pricing theories that emphasize differences in investors’ individual valuations (e.g., due
to differences in opinions about the fundamentals) and limits on short sales. Our theory also
has heterogeneous valuations, but in addition, it is explicit about the search and bargaining
frictions that are defining characteristics of OTC markets. It is also consistent with the behavior
of the illiquidity premia in response to variations in the measures of liquidity documented by
Ang et al. (2013): In the stationary monetary equilibrium the expected financial return on the
equity, (φst+1 +yt+1 )/φst , is decreasing with δ (see Proposition 7). The theory we have developed
also has sharp implications about how the effect of monetary policy on asset prices depends on
the microstructure of the market. For instance, it predicts that the speculative premium, and
therefore the typical residual mispricing term, should be larger and more responsive to inflation
in markets that are more liquid from an investor standpoint, i.e., markets where investors are
able to trade fast and face narrow spreads.




                                                54
A     Proofs

Proof of Proposition 1. The choice variable a0tD does not appear in the Planner’s objective
function, so a0tD = 0 at an optimum. Also, (5) must bind for every t at an optimum, so the
planner’s problem is equivalent to
                                              ∞
                                                       " Z
                                              X
                   max                   E0          βt δ                   εa0tI (dε) + (1 − α − δ) ε̄atI
       {ãtD ,ãtI ,atib(i) ,a0tI }∞
                                   t=0                          [εL ,εH ]
                                               t=0
           Z       Z Z             h                                                                     
                                                                                   i                
       +                  I{i≤b(i)} εi atib(i) εi , εb(i) + εb(i) atb(i)i εb(i) , εi dG (εi ) dG εb(i) di yt
             Bt
                                                                             Z
                            s.t. (2), (3), (6), (7) and δ                                 a0tI (dε) ≤ vatD + δatI .
                                                                              [εL ,εH ]

Let W ∗ denote the maximum value of this problem. Then clearly, W ∗ ≤ W̄ ∗ , where
                                                ∞
                                               X              Z    Z Z
               ∗                                           t
                                                                              I{i≤b(i)} max ε, ε0 2ãtI dG (ε) dG ε0 di
                                                                                                                   
           W̄ =            max ∞ E0                    β
                      {ãtD ,ãtI }t=0                          Bt
                                                 t=0
                                                              
                   + εH (vãtD + δãtI ) + (1 − α − δ) ε̄ãtI πyt + w,

s.t. (3), where w ≡ [αεB + δεH + (1 − α − δ) ε̄] (1 − π) As E0 ∞     t
                                                              P         
                                                                t=0 β yt and
                                  Z Z
                                       max ε, ε0 dG (ε) dG ε0 .
                                                              
                            εB ≡

Rearrange the expression for W̄ ∗ and substitute (3) (at equality) to obtain
                      (∞                                                              )
                        X
      W̄ ∗ = max∞
                   E0       β t {εH As + [αεB + δεH + (1 − α − δ) ε̄ − εH ] ãtI } πyt + w
                   {ãtI }t=0
                                         t=0
                                                                                                         ∞
                                                                                                                      !
                                                                                                         X
                                                                                                s               t
               = {πεH + (1 − π) [αεB + δεH + (1 − α − δ) ε̄]} A                                     E0         β yt       .
                                                                                                         t=0

The allocation ãtD = As /v, ãtI = 0, and atib(i) εi , εb(i) = I{εb(i) <εi } 2atI + I{εb(i) =εi } ao , where
                                                             

ao ∈ [0, 2atI ], together with the Dirac measure defined in the statement of the proposition,
achieve W̄ ∗ and therefore solve the Planner’s problem.

Proof of Lemma 1. Notice that (8) can be written as

                                                       WtD (at ) = φt at + WtD (0)                                            (59)


                                                                             55
with WtD (0) given by (14). With (59), (9) is equivalent to

       ŴtD (at ) = max
                    m s
                        [φm   m    s s        m       s     m        s          m        s      D
                          t ât + φt ât + ξ(at + pt at − ât − pt ât ) + ςm ât + ςs ât ] + Wt (0)
                      ât ,ât

where ξ is a Lagrange multiplier on the budget constraint âm        s    m       s
                                                            t + pt ât ≤ at + pt at , and ςm and
ςs are the multipliers on the nonnegativity constraints âm           s
                                                          t ≥ 0 and ât ≥ 0. The corresponding
first-order necessary and sufficient conditions for âm       s
                                                      t and ât are


                                                              −ξ + φm
                                                                    t + ςm = 0                                      (60)
                                                             −ξpt + φst + ςs = 0                                    (61)
                                           ξ(am       s     m        s
                                              t + pt at − ât − pt ât ) = 0.                                       (62)

Clearly âm     s                                     m    s
          t = ât = 0 is the solution if and only if at = at = 0, but more generally the solution
could take one of three forms: (i ) ςs = 0 < ςm , (ii ) ςs = ςm = 0, or (iii ) ςm = 0 < ςs . In
                                                                1 m
case (i ), (60)-(62) imply âm        s    s
                             t = 0, ât = at +                  pt at , and   pt φm    s
                                                                                  t < φt . In case (ii ), (60)-(62) imply
                                           1
âm        m       s      s    s
  t ∈ [0, at + pt at ], ât = at +         pt   (am
                                                  t −       âm
                                                              t ), and φt
                                                                          s   = p t φm
                                                                                     t . In case (iii ), (60)-(62) imply
âst = 0, âm    m       s        s       m                         m        s
            t = at + pt at , and φt < pt φt . The expressions for âtd and âtd in Lemma 1 follow
from these three cases. The value function (13) is obtained by substituting the optimal portfolio
(âm      s
   td , âtd ) into (9).


Proof of Lemma 2. (i ) Notice that (11) can be written as

                                                WtI (at ) = φt at + WtI (0)                                         (63)

where
                                                                 Z                                         
                       WtI       (0) = Tt + max             βEt         I
                                                                      Vt+1 (at+1 , ε) dG (ε)   − φt ãt+1
                                           ãt+1 ∈R2+

                     s.t. at+1 = (ãm        s              s
                                    t+1 , πãt+1 + (1 − π) A ).


With (13) and (63) the problem of the investor when he makes the ultimatum offer becomes

                                           max          [εyt asti∗ + φm  m      s s
                                                                      t ati∗ + φt ati∗ ]
                                      am  ,as ,am ,as
                                       ti∗ ti∗ td td


                           s.t. am      m         s      s       m     m         s     s
                                 ti∗ + atd + pt (ati∗ + atd ) ≤ ati + atd + pt (ati + atd )

                                                   am        s     m        s
                                                    td + pt atd ≥ atd + pt atd

                                           am      s      m s
                                            ti∗ , ati∗ , atd , atd ∈ R+ .


                                                                  56
The corresponding Lagrangian is

                         L = (φm    m       m             s    s          s
                               t + ςi − ξ) ati∗ + (εyt + φt + ςi − ξpt ) ati∗

                           + (ρ + ςdm − ξ) am            s          s
                                            td + (ρpt + ςd − ξpt ) atd + K,

where K ≡ ξ [am     m         s     s           m        s
              ti + atd + pt (ati + atd )] − ρ (atd + pt atd ), ξ ∈ R+ is the Lagrange multiplier asso-
ciated with the budget constraint, ρ ∈ R+ is the multiplier on the dealer’s individual rationality
constraint, and ςim , ςis , ςdm , ςds ∈ R+ are the multipliers for the nonnegativity constraints on am
                                                                                                     ti∗ ,
asti∗ , am     s
         td , atd , respectively. The first-order necessary and sufficient conditions are

                                               φm    m
                                                t + ςi − ξ = 0                                       (64)
                                        εyt + φst + ςis − ξpt = 0                                    (65)
                                                 ρ + ςdm − ξ = 0                                     (66)
                                             ρpt + ςds − ξpt = 0                                     (67)

and the complementary slackness conditions

                  ξ {am     m         s     s        m      m         s      s
                      ti + atd + pt (ati + atd ) − [ati∗ + atd + pt (ati∗ + atd )]} = 0              (68)
                                                  ρ [am        s      m        s
                                                      td + pt atd − (atd + pt atd )] = 0             (69)
                                                                           ςim am
                                                                                ti∗ = 0              (70)
                                                                            ςis asti∗ = 0            (71)
                                                                            ςdm am
                                                                                 td = 0              (72)
                                                                             ςds astd = 0.           (73)

First, notice that ξ > 0 at an optimum. To see this, assume the contrary, i.e., ξ = 0. Then
(65) implies εyt + φst = −ςis ≤ 0 which is a contradiction since εyt + φst > 0. If ρ > 0, then (69)
implies
                                       am        s     m        s
                                        td + pt atd = atd + pt atd .                                 (74)

If instead ρ = 0, then (66) and (67) imply ςdm = ξ > 0 and ςds = ξpt > 0, which (using (72)
and (73)) in turn imply am     s                                       m        s
                         td = atd = 0. This can only be a solution if atd + pt atd = 0 (since
am        s     m        s
 td + pt atd ≥ atd + pt atd must hold at an optimum) in which case (74) also holds. Thus, we
conclude that (74) must always hold at an optimum (and with ρ > 0 unless am        s
                                                                          td + pt atd = 0).
Since ξ > 0, (68) and (74) imply

                                      am         s      m        s
                                       ti∗ + pt ati∗ = ati + pt ati .                                (75)

                                                    57
   From (74) it is immediate that if am       s             m     s                   m       s
                                      td +pt atd = 0, then atd = atd = 0. So suppose atd +pt atd >
0. In this case ςdm and ςds cannot both be strictly positive. (To see this, assume the contrary,
i.e., that ςdm > 0 and ςds > 0. Then (72) and (73) imply am     s
                                                          td = atd = 0, and (74) implies
am        s                                                                   s    m
 td + pt atd = 0, a contradiction.) Moreover, conditions (66) and (67) imply ςd = ςd pt , so
ςds = ςdm = 0 must hold at an optimum. Hence when making the ultimatum offer, the investor
is indifferent between offering the dealer any nonnegative pair (am     s
                                                                  td , atd ) that satisfies (74).
   From (75) it is immediate that am      s           m        s                   m        s
                                   ti∗ = ati∗ = 0 if ati + pt ati = 0. So suppose ati + pt ati > 0.
In this case ςim and ςis cannot both be strictly positive (if they were, then (70) and (71) would
imply am      s                                      m        s
       ti∗ = ati∗ = 0, and in turn (75) would imply ati + pt ati = 0, a contradiction). There are
three possible cases: (a) ςis = 0 < ςim , (b) ςis = ςim = 0, or (c) ςim = 0 < ςis . In every case, (64)
and (65) imply
                                      εyt + φst + ςis = pt φm        m
                                                            t + p t ςi .                            (76)

In case (a), (70) implies am                      s      m         s
                           ti∗ = 0, (75) implies ati∗ = ati /pt + ati , and (76) implies that ε must
satisfy ε > ε∗t , where ε∗t is as defined in (15). In case (b), (76) implies that ε must satisfy ε = ε∗t
and the investor is indifferent between making any offer that leaves him with a nonnegative
post-trade portfolio (am      s                                                     s
                       ti∗ , ati∗ ) that satisfies (75). In case (c), (71) implies ati∗ = 0, (75) implies
am      m        s                                              ∗
 ti∗ = ati + pt ati , and (76) implies that ε must satisfy ε < εt . The first, second, and third lines
on the right side of the expressions for am      s      m         s
                                          ti∗ , ati∗ , atd , and atd in part (i ) of the statement of the
lemma correspond cases (a), (b), and (c), respectively.
   (ii ) With (13) and (63) the problem of the dealer when it is his turn to make the ultimatum
offer is equivalent to
                                            max              φ̄t [am         s
                                                                   td∗ + pt atd∗ ]
                                      am    s    m     s
                                       ti ,ati ,atd∗ ,atd∗

                     s.t. am     m          s     s        m     m         s     s
                           ti + atd∗ + pt (ati + atd∗ ) ≤ ati + atd + pt (ati + atd )               (77)
                                φm  m            s    s     m m             s    s
                                 t ati + (εyt + φt ) ati ≥ φt ati + (εyt + φt ) ati                 (78)
                                      am     s     m      s
                                       ti , ati , atd∗ , atd∗ ∈ R+ .

The corresponding Lagrangian is

                   L0 = (φ̄t + ςdm − ξ)am                s         s
                                        td∗ + (φ̄t pt + ςd − ξpt )atd∗
                                                                                   0
                         + (ρφm    m       m               s      s          s
                              t + ςi − ξ) ati + [ρ (εyt + φt ) + ςi − ξpt ] ati + K ,

where K 0 ≡ ξ [am     m         s     s           m m             s    s
                ti + atd + pt (ati + atd )] − ρ [φt ati + (εyt + φt ) ati ], ξ ∈ R+ is the Lagrange
multiplier associated with the budget constraint, ρ ∈ R+ is the multiplier on the investor’s

                                                             58
individual rationality constraint, and ςim , ςis , ςdm , ςds ∈ R+ are the multipliers for the nonnega-
tivity constraints on am     s     m      s
                       ti , ati , atd∗ , atd∗ , respectively. The first-order necessary and sufficient
conditions are

                                                 φ̄t + ςdm − ξ = 0                                (79)
                                              φ̄t pt + ςds − ξpt = 0                              (80)
                                               ρφm    m
                                                 t + ςi − ξ = 0                                   (81)
                                     ρ (εyt + φst ) + ςis − ξpt = 0                               (82)

and the complementary slackness conditions

                  ξ {am     m         s     s        m     m          s     s
                      ti + atd + pt (ati + atd ) − [ati + atd∗ + pt (ati + atd∗ )]} = 0           (83)
                        ρ {φm  m           s    s      m m             s    s
                            t ati + (εy + φt ) ati − [φt ati + (εyt + φt ) ati ]} = 0             (84)
                                                                            ςim am
                                                                                 ti = 0           (85)
                                                                             ςis asti = 0         (86)
                                                                           ςdm am
                                                                                td∗ = 0           (87)
                                                                            ςds astd∗ = 0.        (88)

   First, notice that ξ > 0 at an optimum. To see this, note that if ξ = 0 then (79) implies
φ̄t + ςdm = 0 which is a contradiction since the left side is strictly positive (φ̄t > 0 and ςdm ≥ 0
in a monetary equilibrium). Hence, at an optimum,

                       am     m          s     s        m     m         s     s
                        ti + atd∗ + pt (ati + atd∗ ) = ati + atd + pt (ati + atd ).               (89)

Second, observe that conditions (79) and (80), imply pt ςdm = ςds , so ςdm and ςds have the same
sign, i.e., either both are positive or both are zero.
   If ρ = 0, then (81) and (82) imply ςim = ξ > 0 and ςis = ξpt > 0, which (using (85) and (86))
in turn imply am     s
               ti = ati = 0. From the buyer’s individual rationality constraint (78) it follows
that this can be a solution only if φm  m           s    s                                m     s
                                     t ati +(εyt + φt ) ati = 0, or equivalently only if ati = ati = 0.
To obtain (am      s                               m    s                      m      s
            td∗ , atd∗ ), consider two cases: (a) ςd = ςd = 0, in which case (atd∗ , atd∗ ) need only
satisfy am         s      m        s            m          s                     m      s
         td∗ + pt atd∗ = atd + pt atd , or (b) ςd > 0 and ςd > 0, in which case atd∗ = atd∗ = 0,
which according to (77), is only possible if am     s
                                              td = atd = 0. It is easy to see that the solution
for case (a) can be obtained from the expressions for am     s     m          s
                                                       ti , ati , atd∗ , and atd∗ in part (ii ) of the



                                                   59
statement of the lemma simply by setting am     s
                                          ti = ati = 0, and the solution for case (b) can be
obtained similarly, by setting am     s     m     s
                                ti = ati = atd = atd = 0.
    If ρ > 0, then (84) implies

                           φm  m            s    s     m m            s    s
                            t ati + (εyt + φt ) ati = φt ati + (εy + φt ) ati .                        (90)

There are eight possible configurations of to be considered: [Configuration 1] ςis = ςdm = ςds = 0 <
ςim . In this case (85) implies am                                   m         ∗                    s
                                 ti = 0. Conditions (79)-(82) imply ςi = (ε − εt ) φ̄t yt / (εyt + φt ),
and therefore ε∗t < ε. Then from (89) and (90) it follows that
                                               ∗
                                               εt yt + φst 1 m
                                                          
                                asti = asti +               a
                                                εyt + φst pt ti

and (am      s
      td∗ , atd∗ ) is any nonnegative pair that satisfies

                                                                 (ε − ε∗t ) yt m
                             am         s      m        s
                              td∗ + pt atd∗ = atd + pt atd +                  a .
                                                                  εyt + φst ti

[Configuration 2] ςim = ςis = ςdm = ςds = 0. In this case conditions (79)-(82) imply ε = ε∗t , and
(89) and (90) yield

                                         am        s     m        s
                                          ti + pt ati = ati + pt ati                                   (91)
                                      am         s      m        s
                                       td∗ + pt atd∗ = atd + pt atd .                                  (92)

Hence the dealer is indifferent between making any offer (am     s     m      s                 m s
                                                           ti , ati , atd∗ , atd∗ ) such that (ati , ati ) ∈
R+ satisfies (91), and (am      s                                             m    m    s        s
                         td∗ , atd∗ ) ∈ R+ satisfies (92). [Configuration 3] ςi = ςd = ςd = 0 < ςi .
In this case condition (86) implies asti = 0. Conditions (81) and (82) imply ςis = (ε∗t − ε) yt ρ,
and therefore ε < ε∗t . Then from (89) and (90) it follows that
                                                     εyt + φst
                                       am     m
                                        ti = ati +                pt asti
                                                     ε∗t yt + φst

and (am      s
      td∗ , atd∗ ) is any nonnegative pair that satisfies

                                                                (ε∗t − ε) yt
                            am         s      m        s
                             td∗ + pt atd∗ = atd + pt atd +                   pt asti .
                                                                 ε∗t yt + φst

[Configuration 4] ςdm = ςds = 0, 0 < ςim and 0 < ςis . In this case conditions (85) and (86) imply
am     s                                                     m     s              m      s
 ti = ati = 0, which according to (90), is only possible if ati = ati = 0. Then (atd∗ , atd∗ ) is any
nonnegative pair that satisfies (92). [Configuration 5] ςis = 0 < ςim , 0 < ςdm and 0 < ςds . In this


                                                     60
case conditions (85), (87) and (88) imply am     m      s
                                           ti = atd∗ = atd∗ = 0. Conditions (81) and (82) imply
ε∗t < ε. Then from (89) and (90) it follows that the following condition must hold:

                                                (ε − ε∗t ) yt
                                                                 
                          s    1 m                                  1 m
                         atd + atd = −                                  ati .
                               pt           (ε − ε∗t ) yt + pt φm
                                                                t   p t

The term on the left side of the equality is nonnegative and the term on the right side of the
equality is nonpositive (since ε∗t < ε), so this condition can hold only if am     m     s
                                                                             ti = atd = atd = 0.
Therefore (89) implies asti = asti . [Configuration 6] ςim = ςis = 0, 0 < ςdm and 0 < ςds . In this case
conditions (87) and (88) imply am      s                                            ∗
                                td∗ = atd∗ = 0. Conditions (81) and (82) imply ε = εt , and in
turn conditions (89) and (90) imply am        s                         m     s
                                     td + pt atd = 0, or equivalently, atd = atd = 0 must hold,
and (am     s                                                                    m        s        s
      ti , ati ) is any nonnegative pair that satisfies (91). [Configuration 7] ςi = 0 < ςi , 0 < ςd
and 0 < ςds . In this case conditions (86)-(88) imply asti = am      s
                                                              td∗ = atd∗ = 0. Conditions (81) and
(82) imply ε < ε∗t . Then from (89) and (90) it follows that the following condition must hold:

                                                          ∗
                                 φm   m        s                     s
                                  t (atd + pt atd ) = − (εt − ε) yt ati .


The term on the left side of the equality is nonnegative and the term on the right side of the
equality is nonpositive (since ε < ε∗t ), so this condition can hold only if φm   m        s       s
                                                                              t (atd + pt atd ) = ati =
0. Therefore (90) implies am     m                           m        s        s          s
                           ti = ati . [Configuration 8] 0 < ςi , 0 < ςi , 0 < ςd and 0 < ςd . In
this case conditions (85)-(88) imply am     s     m      s
                                      ti = ati = atd∗ = atd∗ = 0, which according to (89) is only
possible, and the only possible solution if am     s     m     s
                                             ti = ati = atd = atd = 0. To conclude, notice that
the solutions for Configurations 1, 2, and 3, correspond to the first, second, and third lines of
the expressions for am     s     m          s
                     ti , ati , atd∗ , and atd∗ in part (ii ) of the statement of the lemma. Similarly,
the solution for Configuration 5 corresponds to the first line of the expressions for am     s     m
                                                                                       ti , ati , atd∗ ,
and astd∗ in part (ii ) of the statement of the lemma, with am     m     s
                                                             ti = atd = atd = 0. The solution
for Configuration 6 corresponds to the second line of the expressions for am     s     m          s
                                                                           ti , ati , atd∗ , and atd∗
in part (ii ) of the statement of the lemma, with am     s
                                                   td = atd = 0. The solution for Configuration
7 corresponds to the third line of the expressions for am     s     m          s
                                                        ti , ati , atd∗ , and atd∗ in part (ii ) of the
statement of the lemma, with φm   m        s       s
                              t (atd + pt atd ) = ati = 0. Finally, it is easy to see that the
solution for Configuration 4 can be obtained from the expressions for am     s     m          s
                                                                       ti , ati , atd∗ , and atd∗ in
part (ii ) of the statement of the lemma simply by setting am     s
                                                            ti = ati = 0, and the solution for
case Configuration 8 can be obtained similarly, by setting am     s     m     s
                                                            ti = ati = atd = atd = 0.


Proof of Lemma 3. With (63) investor i’s problem when choosing his take-it-or-leave it offer


                                                   61
to investor j reduces to
                                    max          [(εi yt + φst ) asti∗ + φm  m
                                                                          t ati∗ ]
                               am  ,as ,am ,as
                                ti∗ ti∗ tj tj


                                    s.t. am      m     m     m
                                          ti∗ + atj ≤ ati + atj

                                         asti∗ + astj ≤ asti + astj
                         εj yt astj + φm  m     s s            s     m m      s s
                                       t atj + φt atj ≥ εj yt atj + φt atj + φt atj

                                 am      s      m s
                                  ti∗ , ati∗ , atj , atj ∈ R+ .


If φm            s      s       s     s
    t = 0, then ati∗ = ati and atj = atj (the bargaining outcome is no trade between investors
i and j) so suppose φm
                     t > 0 for the rest of the proof. The Lagrangian corresponding to investor
i’s problem is

                  L = (φm    m    m    m              s     s      s  s
                        t + ςi − ξ ) ati∗ + (εi yt + φt + ςi − ξ ) ati∗

                    + ρφm     m     m
                                       atj + ρ (εj yt + φst ) + ςjs − ξ s astj + K 00 ,
                                       m                               
                         t + ςj − ξ


where K 00 ≡ ξ m (am     m       s s      s               s     m m      s s       m
                   ti + atj ) + ξ (ati + atj ) − ρ(εj yt atj + φt atj + φt atj ), ξ ∈ R+ is the multiplier
associated with the bilateral constraint on money holdings, ξ s ∈ R+ is the multiplier associated
with the bilateral constraint on equity holdings, ρ ∈ R+ is the multiplier on investor j’s indi-
vidual rationality constraint, and ςim , ςis , ςjm , ςjs ∈ R+ are the multipliers for the nonnegativity
constraints on am      s      m     s
                ti∗ , ati∗ , atj , atj , respectively. The first-order necessary and sufficient conditions
are

                                                  φm    m    m
                                                   t + ςi − ξ = 0                                    (93)
                                           εi yt + φst + ςis − ξ s = 0                               (94)
                                                 ρφm    m    m
                                                   t + ςj − ξ = 0                                    (95)
                                      ρ (εj yt + φst ) + ςjs − ξ s = 0                               (96)




                                                       62
and the complementary slackness conditions

                                                        ξ m (am     m     m      m
                                                              ti + atj − ati∗ − atj ) = 0                    (97)
                                                         ξ s (asti + astj − asti∗ − astj ) = 0               (98)
                      ρ(εj yt astj + φm  m     s s            s     m m      s s
                                      t atj + φt atj − εj yt atj − φt atj − φt atj ) = 0                     (99)
                                                                                ςim am
                                                                                     ti∗ = 0               (100)
                                                                                 ςis asti∗ = 0             (101)
                                                                                 ςjm am
                                                                                      tj = 0               (102)
                                                                                  ςjs astj = 0.            (103)

    If ξ m = 0, (93) implies 0 < φm     m                           s
                                  t = −ςi ≤ 0, a contradiction. If ξ = 0, (94) implies
0 < εi yt + φst = −ςis ≤ 0, another contradiction. Hence ξ m > 0 and ξ s > 0, so (97) and (98)
imply

                                            am      m     m     m
                                             ti∗ + atj = ati + atj                                         (104)
                                            asti∗ + astj = asti + astj .                                   (105)

    If ρ = 0, (95) and (96) imply ςjm = ξ m > 0 and ςjs = ξ s > 0, and (102) and (103) imply
am     s
 tj = atj = 0. From investor’s j individual rationality constraint, this can only be a solution
if am     s                                                     m      s         m s
    tj = atj = 0, and if this is the case (97) and (98) imply (ati∗ , ati∗ ) = (ati , ati ). Hereafter
suppose ρ > 0 which using (99) implies

                           φm  m              s s       m m               s s
                            t atj + (εj yt + φt )atj = φt atj + (εj yt + φt )atj .                         (106)

    If ςim > 0 and ςjm > 0, (100) and (102) imply am      m
                                                   ti∗ = atj = 0 which by (104), is only possible
if am     m                               s     s                       s      s
    ti = atj = 0. But then (106) implies atj = atj , and (105) implies ati∗ = ati . Similarly, if
ςis > 0 and ςjs > 0, (101) and (103) imply asti∗ = astj = 0 which by (105), is only possible if
asti = astj = 0. But then (106) implies am     m                       m      m        m
                                         tj = atj , and (104) implies ati∗ = ati . If ςi > 0 and
ςis > 0, then (100) and (101) imply am      s
                                     ti∗ = ati∗ = 0, and according to (104), (105) and (106), this
is only possible if am     s                                                  m s            m s
                     ti = ati = 0. Conditions (104) and (105) in turn imply (atj , atj ) = (atj , atj ).
Similarly, if ςjm > 0 and ςjs > 0, then (102) and (103) imply am     s
                                                               tj = atj = 0, and according
to (106) this is only possible if am     s
                                   tj = atj = 0. Conditions (104) and (105) in turn imply
(am      s         m s
  ti∗ , ati∗ ) = (ati , ati ). So far we have simply verified that there is no trade between investors i
and j, i.e., (am      s         m s              m s            m s             m     m           s     s
               ti∗ , ati∗ ) = (ati , ati ) and (atj , atj ) = (atj , atj ), if ati = atj = 0, or ati = atj = 0, or


                                                        63
am     s           m     s                                                   m s m s
 ti = ati = 0, or atj = atj = 0. Thus there are seven binding patterns for (ςi , ςi , ςj , ςj ) that
remain to be considered.
    (i ) ςim = ςis = ςjm = ςjs = 0. Conditions (93)-(96) imply that this case is only possible if
εi = εj , and conditions (104), (105) and (106), imply that the solution consists of any pair of
post trade portfolios (am      s           m s
                        ti∗ , ati∗ ) and (atj , atj ) that satisfy

                           εj yt + φst s
               am     m
                tj = atj −             (ati − asti∗ )
                               φmt
               m       m   εj yt + φst s
              ati∗ = ati +             (ati − asti∗ )
                               φmt
               atj = ati + atj − asti∗
                s      s    s

                                       φm                             φm
                                                                                
               s         s               t     m s      s               t     m s
              ati∗ ∈ ati − min                a , a , ati + min              a ,a      .
                                   εj yt + φst tj ti              εj yt + φst ti tj

    (ii ) ςis = ςjm = ςjs = 0 < ςim . Condition (100) implies am
                                                               ti∗ = 0, and from (104) we obtain
am     m     m
 tj = ati + atj . Then condition (106) yields

                                                             φmt
                                         astj = astj −              am
                                                         εj yt + φst ti

and condition (105) implies
                                                             φmt
                                        asti∗ = asti +              am .
                                                         εj yt + φst ti
Notice that ςjs = 0 requires astj ≥ 0 which is equivalent to

                                         φm  m              s    s
                                          t ati ≤ (εj yt + φt ) atj .

                                                         φm
Conditions (93)-(96) imply ςim = (εi − εj ) yt εj ytt+φs , so ςim > 0 requires εj < εi .
                                                              t
    (iii ) ςim = ςjm = ςjs = 0 < ςis . Condition (101) implies asti∗ = 0, and from (105) we obtain
astj = asti + astj . Then condition (106) yields

                                                         εj yt + φst s
                                         am     m
                                          tj = atj −                ati
                                                             φmt

and condition (104) implies
                                                         εj yt + φst s
                                        am      m
                                         ti∗ = ati +                ati .
                                                             φmt
Notice that ςjm = 0 requires am
                              tj ≥ 0 which is equivalent to


                                         (εj yt + φst ) asti ≤ φm  m
                                                                t atj .


                                                      64
Conditions (93)-(96) imply ςis = (εj − εi ) yt , so ςis > 0 requires εi < εj .
   (iv ) ςim = ςis = ςjs = 0 < ςjm . Condition (102) implies am
                                                              tj = 0, and from (104) we obtain
am      m     m
 ti∗ = ati + atj . Then (105) and (106) imply

                                                           φmt
                                       astj = astj +              am
                                                       εj yt + φst tj
                                                           φmt
                                      asti∗   = asti −            am .
                                                       εj yt + φst tj
Notice that ςis = 0 requires asti∗ ≥ 0 which is equivalent to

                                       φm  m              s    s
                                        t atj ≤ (εj yt + φt ) ati .

                                                      φm
Conditions (93)-(96) imply ςjm = (εj − εi ) yt εj ytt+φs , so ςjm > 0 requires εi < εj .
                                                           t
   (v ) ςim = ςis = ςjm = 0 < ςjs . Condition (103) implies astj = 0, and from (105) we obtain
asti∗ = asti + astj . Then (104) and (106) imply

                                                      εj yt + φst s
                                       am     m
                                        tj = atj +               atj
                                                          φmt
                                                      εj yt + φst s
                                      am
                                       ti∗    = am
                                                 ti −            atj .
                                                          φmt

Notice that ςim = 0 requires am
                              ti∗ ≥ 0 which is equivalent to


                                       (εj yt + φst ) astj ≤ φm  m
                                                              t ati .


Conditions (93)-(96) imply ςjs = (εi − εj ) yt , so ςjs > 0 requires εj < εi .
   (vi ) ςim , ςjs ∈ R++ and ςis = ςjm = 0. In this case, conditions (100) and (103) give am
                                                                                           ti∗ =
astj = 0, and (104) and (105) imply am     m     m       s      s     s
                                     tj = ati + atj and ati∗ = ati + atj . Condition (106) implies
the following restriction must be satisfied

                                       φm  m              s s
                                        t ati = (εj yt + φt )atj .


Conditions (93)-(96) imply ςim = (ρ − 1) φm      s                                    s        m
                                          t and ςj = (εi − εj ) yt −(ρ − 1) (εj yt + φt ), so ςi > 0
requires ρ > 1, and ςjs requires εj < εi .
   (vii ) ςim = ςjs = 0 and ςis , ςjm ∈ R++ . In this case, conditions (101) and (102) give asti∗ =
am                                  m      m     m       s     s     s
 tj = 0, and (104) and (105) imply ati∗ = ati + atj and atj = ati + atj . Condition (106) implies
the following restriction must be satisfied

                                       φm  m              s s
                                        t atj = (εj yt + φt )ati .


                                                      65
Conditions (93)-(96) imply ςjm = (1 − ρ) φm      s                                    s        m
                                          t and ςi = (εj − εi ) yt −(1 − ρ) (εj yt + φt ), so ςj > 0
requires ρ ∈ (0, 1), and ςis > 0 requires εi < εj .

Proof of Lemma 4. (i ) With Lemma 1, (10) becomes
                                Z
             D  m s
           Vt (atd , atd ) = κθ φ̄t [am         s      m        s
                                       td + pt atd − (atd + pt atd )] dHt (ati , ε)
                                      Z
                           + κ (1 − θ) φ̄t [am         s        m         s
                                             td∗ + pt atd∗ − (atd + pt atd )] dHt (ati , ε)

                                   + φ̄t (am        s       D
                                           td + pt atd ) + Wt (0)


where we have used the more compact notation introduced in Lemma 2, i.e., akti∗ ≡ aki∗ (ati , atd , ε; ψ t ),
aktd ≡ akd (ati , atd , ε; ψ t ), akti ≡ aki (ati , atd , ε; ψ t ), and aktd∗ ≡ akd∗ (ati , atd , ε; ψ t ), for k = m, s. Use
Corollary 1 to arrive at

                                                        (ε∗t − ε) yt                    (ε − ε∗t ) yt m
                                       Z                                                               
    VtD   (am     s
            td , atd )   = κ (1 − θ)       φ̄t I{ε<ε∗t } ∗               s
                                                                     pt ati + I{ε∗t ≤ε}              a dHt (ati , ε)
                                                         εt yt + φst                     εyt + φst ti
                         + φ̄t (am        s       D
                                 td + pt atd ) + Wt (0)


where I{ε<ε∗t } is an indicator function that takes the value 1 if ε < ε∗t , and 0 otherwise. To
obtain (17), use the fact that dHt (ati , ε) = dFtI (ati ) dG (ε).
    (ii ) With (63) and the notation introduced in Lemma 2 and Lemma 3, (12) becomes
                               Z
     Vt (ati , ati , εi ) = δθ [φm
       I   m s                            m       m                s    s        s      D
                                    t (ati∗ − ati ) + (εi yt + φt ) (ati∗ − ati )] dFt (atd )
                                     Z
                          + δ (1 − θ) [φm        m      m                 s    s     s        D
                                             t (ati − ati ) + (εi yt + φt ) (ati − ati )] dFt (atd )
                              Z
                          + α η̃ (εi , εj ) [φm    m       m                s      s      s
                                               t (ati∗ − ati ) + (εi yt + φt ) (ati∗ − ati )] dHt (atj , εj )
                              Z
                          + α [1 − η̃ (εi , εj )] [φm    m      m                  s   s      s
                                                     t (ati − ati ) + (εi yt + φt ) (ati − ati )] dHt (atj , εj )

                           + φm  m              s    s     I
                              t ati + (εi yt + φt ) ati + Wt (0) .


Use η̃ (εi , εj ) ≡ ηI{εj <εi } +(1 − η) I{εi <εj } +(1/2) I{εi =εj } and substitute the bargaining outcomes




                                                             66
reported in Lemma 2 and Lemma 3 to obtain
                                                   (εi − ε∗t ) yt m m
             VtI (am     s
                   ti , ati , εi ) = δθI{ε∗t ≤εi } ∗              φ a + δθI{εi <ε∗t } (ε∗t − εi ) yt asti
                                                    εt yt + φst t ti
                                         Z Z              
                                               I{εj ≤εi } −φm
                                                                          o       s    m
                                   + αη                          t min pt (εj )atj , ati
                                                          n m            o
                                                              ati
                                   + (εi yt + φst ) min po (ε      , as
                                                                      tj    dFtI (atj ) dG (εj )
                                                              t j)
                                                 Z Z               
                                                         I{εi <εj } φm
                                                                               o        s  m
                                   + α (1 − η)                         t min pt (εj )ati , atj
                                                          n am          o
                                                s
                                   − (εi yt + φt ) min po (εj ) , ati dFtI (atj ) dG (εj )
                                                               tj     s
                                                                  t


                                    + φm  m              s    s     I
                                       t ati + (εi yt + φt ) ati + Wt (0) .                                                 (107)

From (11), we anticipate that as in Lagos and Wright (2005), the beginning-of-period distri-
bution of assets across investors will be degenerate, i.e., (am       s          m       s
                                                              t+1j , at+1j ) = (AIt+1 , AIt+1 ) for all
j ∈ I, so (107) can be written as (18).

Proof of Lemma 5. With Lemma 4, the dealer’s problem in the second subperiod of period
t, (14), becomes

 WtD (0) = max                (−φm                m        s                      s           D
                                                                                    
                                 t + βEt φ̄t+1 )ãt+1 + (−φt + βπEt φ̄t+1 pt+1 )ãt+1 + βEt Vt+1 (0) . (108)
             ãt+1 ∈R2+

From (18),
Z                                               Z
    I    m     s                    m    m
                                                     εi yt+1 + φst+1 ast+1 dG (εi ) + Wt+1
                                                                                       I
                                                                    
  Vt+1 at+1 , at+1 , εi dG (εi ) = φt+1 at+1 +                                             (0)

                                                      εi − ε∗t+1 yt+1 m m
                                     Z                          
                                 + δθ I{ε∗t+1 ≤εi } ∗                  φ a dG (εi )
                                                   εt+1 yt+1 + φst+1 t+1 t+1
                                     Z
                                 + δθ I{εi <ε∗t+1 } ε∗t+1 − εi yt+1 ast+1 dG (εi )
                                                                

                                                                   (εi − εj ) yt+1 m m
                                      Z                        Z
                                 + αη  φm am            
                                                                               s φt+1 at+1 dG (εi ) dG (εj )
                                          t+1 t+1
                                            s     −φst+1
                                                      A
                                                           1
                                                                εj εj yt+1 + φt+1
                                                                      yt+1
                                                        It+1
                                                      m    m
                                                      φt+1 at+1
                                                                      
                                              Z
                                                        As
                                                                −φst+1 y 1    Z
                                                                        t+1
                                       + αη              It+1
                                                                                    (εi − εj ) yt+1 AsIt+1 dG (εi ) dG (εj )
                                                                               εj
                                                                                           εj
                                                                                                (εj − εi ) yt+1 m m
                                                         Z                             Z
                                       + α (1 − η)            φm     m                                         φ A       dG (εi ) dG (εj )
                                                                                                εj yt+1 + φst+1 t+1 It+1
                                                                              
                                                               t+1 AIt+1
                                                                 as
                                                                         −φst+1 y 1
                                                                  t+1             t+1
                                                               m m             
                                                               φt+1 AIt+1
                                                         Z
                                                                  as
                                                                          −φst+1 y 1     Z   εj
                                                                                   t+1
                                                                                                  (εj − εi ) yt+1 ast+1 dG (εi ) dG (εj )
                                                                    t+1
                                       + α (1 − η)


                                                                 67
so the investor’s problem (11) can be written as in (63), with
                        (                  "
                                                                     εi − ε∗t+1 yt+1
                                                       Z                       
       I                       m m
    Wt (0) = mmax         − φt ãt+1 + βEt 1 + δθ I{ε∗t+1 ≤εi } ∗                     dG (εi )
              ãt+1 ∈R+                                             εt+1 yt+1 + φst+1
                                            (εi − εj ) yt+1
                  Z                     Z                                    
                                                                                m   m
            + αη φm am
                                   
                                                         s dG (εi ) dG (εj ) φt+1 ãt+1
                      t+1 t+1
                        s
                                s
                              −φt+1   1    ε  y
                                         εj j t+1  +   φ t+1
                           A              yt+1
                             It+1
                           φm     m
                                         
                                ã
                            t+1 t+1
                                    −φst+1 y 1
                   Z                                  Z                                                   #)
                             As             t+1
            + αη              It+1
                                                             (εi − εj ) yt+1 dG (εi ) dG (εj ) AsIt+1
                                                        εj
                            (                           " Z
                                − φst ãst+1 + βEt                     εi yt+1 + φst+1 dG (εi )
                                                                                      
            + smax
               ãt+1 ∈R+
                   Z
                       I{εi <ε∗t+1 } ε∗t+1 − εi yt+1 dG (εi )
                                               
            + δθ
                                        φm    m
                                                        
                                         t+1 AIt+1    s     1
                              Z
                                           as
                                                   −φ t+1 yt+1
                                                                   Z    εj                                   
                                                                             (εj − εi ) yt+1 dG (εi ) dG (εj ) ast+1
                                            t+1
            + α (1 − η)
                                                                                                                           #)
                                                                       εj
                                                                            (εj − εi ) yt+1
                              Z                                    Z
            + α (1 − η)             φm    m                                                 dG (εi ) dG (εj ) φm    m
                                                                                                               t+1 AIt+1
                                                                            εj yt+1 + φst+1
                                                       
                                     t+1 AIt+1                1
                                       as
                                               −φst+1       yt+1
                                        t+1
                        I
            + Tt + βEt Wt+1 (0) ,                                                                                           (109)

where ast+1 = πãst+1 + (1 − π) As . The first-order necessary and sufficient conditions for op-
timization of (108) are (19) and (20). The first-order necessary and sufficient conditions for
optimization of (109) are (21) and (22).

Proof of Proposition 2. In a stationary equilibrium, the dealer’s Euler equations in Lemma
5 become

                                             µ ≥ β̄, “ = ” if ãm
                                                                t+1d > 0
                                                     β̄π ∗
                                            φs ≥           ε , “ = ” if ãst+1d > 0.
                                                   1 − β̄π
The maintained assumption µ > β̄ implies ãm
                                           t+1d = 0. Similarly, in a stationary monetary
equilibrium the investor’s Euler equations in Lemma 5 become
                                 "
                                                εi − ε∗
                                         Z εH
                           µ = β̄ 1 + δθ         ∗    s
                                                        dG (εi )
                                           ε∗ ε + φ
                                   Z εH Z εH                            #
                                              εi − εj
                             + αη                     dG (εi ) dG (εj )                                                     (110)
                                    εc   εj  εj + φ s


                                                                       68
                                "        Z ε∗                                     #
                        s β̄π                   ∗                               c
                 φ ≥             ε̄ + δθ      (ε − εi )dG (εi ) + α (1 − η) ϕ (ε )
                        1 − β̄π           εL
                                 Rε Rε
where εc ≡ Z/AsI − φs , ϕ (ε) ≡ εL εLj (εj − εi ) dG (εi ) dG (εj ), and the second condition holds
with “=” if ãst+1i > 0. Together, the dealer’s and the investor’s Euler equations for equity imply
                                (            Z ε∗                                     )
                s      β̄π          ∗               ∗                               c
              φ =            max ε , ε̄ + δθ      (ε − εi )dG (εi ) + α (1 − η) ϕ (ε ) .       (111)
                     1 − β̄π                  εL


As µ → β̄, (110) implies
                      εi − ε∗
                 Z εH                       Z εH Z εH
                                                      εi − εj
              δθ       ∗    s
                              dG (εi ) + αη                    dG (εi ) dG (εj ) → 0,
                  ε∗ ε + φ                   εc   εj  εj + φ s

a condition that can only hold if ε∗ → εH and εc → εH . The fact that ε∗ → εH means that
among investors who contact dealers, only those with preference type εH purchase equity. The
fact that εc → εH implies that in bilateral trades between investors, the investor with the higher
valuation purchases all his counterparty’s equity holdings (the investor who wishes to buy is
never constrained by his real money balances as µ → β̄). Finally, as µ → β̄,

                         β̄π                                                       β̄π
              φs →             max {εH , ε̄ + δθ(εH − ε̄) + α (1 − η) ϕ (εH )} =         εH ,
                       1 − β̄π                                                   1 − β̄π
so ãst+1d = As for all t, i.e., only dealers hold equity overnight.

Lemma 6 Consider µ̂ and µ̄ as defined in (24). Then µ̂ < µ̄.
                                                                                              (1−δθ)(ε̂−ε̄)
Proof of Lemma 6. Define Υ (ζ) : R → R by Υ (ζ) ≡ β̄ 1 + δθ(1 − β̄π)ζ . Let ζ̂ ≡                    δθε̂
                  ε̄−εL
and ζ̄ ≡                    ,
                        so that µ̂ = Υ(ζ̂) and µ̄ = Υ(ζ̄). Since Υ is strictly increasing, µ̂ < µ̄ if
           β̄π ε̄+(1−β̄π)εL
                                                     Rε                    Rε
and only if ζ̂ < ζ̄. With (25) and the fact that ε̄ ≡ εLH εdG (ε) = εH − εLH G (ε) dε,
                                                  R εH
                                                    ε̂  [1 − G (ε)] dε
                                           ζ̂ =           R ε̂         ,
                                                  ε̄ + δθ εL G (ε) dε

so clearly,                              R εH
                                          εL    [1 − G (ε)] dε       ε̄ − εL
                                  ζ̂ <                           =           < ζ̄.
                                                    ε̄                   ε̄
Hence µ̂ < µ̄.




                                                         69
Lemma 7 In a stationary equilibrium, the interdealer market clearing condition ĀsDt + ĀsIt =
AsDt + δAsIt is equivalent to
                                              Z εH             
                ∗      s      Z                        s     Z
    δθ [1 − G(ε )] AI + ∗           + δ (1 − θ)       AI +          dG (ε) = AsD + δAsI .                                  (112)
                           ε + φs                ε∗        ε + φs

Proof of Lemma 7. Use δ = κv in ĀsDt + ĀsIt = AsDt + δAsIt to obtain
    Z
   θ {âsd [ād (ati , atd , ε; ψ t ) ; ψ t ] + asi∗ (ati , atd , ε; ψ t )} dFtD (atd ) dFtI (ati ) dG (ε)
              Z
   + (1 − θ) {âsd [ād∗ (ati , atd , ε; ψ t ) ; ψ t ] + asi (ati , atd , ε; ψ t )} dFtD (atd ) dFtI (ati ) dG (ε)
                                                       (1 − κ) v
      Z                       Z                                      Z
         s      D                   s      I
    = atd dFt (atd ) + ati dFt (ati ) +                                   [astd − âsd (atd ; ψ t )] dFtD (atd ) . (113)
                                                             δ

Since φst = φs yt < ε∗ yt + φs yt = φ̄s yt ≡ pt φm
                                                 t in a stationary equilibrium, Lemma 1 implies


             âsd [ād (ati , atd , ε; ψ t ) ; ψ t ] = âsd [ād∗ (ati , atd , ε; ψ t ) ; ψ t ] = âsd (atd ; ψ t ) = 0.   (114)

                                             asti dFtI (ati ) = AsI and v          astd dFtD (atd ) = AsD , (113) becomes
                                         R                                     R
With (114) and the fact that
                                         Z
                 AsD   +   δAsI   = δθ    asi∗ (ati , atd , ε; ψ t )dFtD (atd ) dFtI (ati ) dG (ε)
                                               Z
                                  + δ (1 − θ) asi (ati , atd , ε; ψ t )dFtD (atd ) dFtI (ati ) dG (ε) .                    (115)

From Lemma 2,
                                                                    
                                                                 1 m
                   asi∗ (ati , atd , ε; ψ t ) = I{ε∗ <ε}      + ati + I{ε=ε∗ } asi∗
                                                                asti
                                                                pt
                                                                 ∗
                                                                  ε + φs 1 m
                                                                             
                    asi (ati , atd , ε; ψ t ) = I{ε∗ <ε} asti +            a     + I{ε=ε∗ } asi
                                                                  ε + φs pt ti

where asi∗ , asi ∈ [0, asti + am
                               ti /pt ], so (115) becomes
                                                   Z εH       ∗
                                                               ε + φs 1 m
                                                                          
                 ∗      s     1 m                         s
 δθ [1 − G(ε )] AI + AIt + δ (1 − θ)                     AI +            A dG (ε) = AsD + δAsI .
                             pt                      ε∗         ε + φs pt It

Finally, use the fact that in a stationary equilibrium, φm  m                m     s
                                                         t AIt = Zyt and pt φt = φ̄ yt =
(ε∗ + φs ) yt , to arrive at the expression in the statement of the lemma.

Proof of Proposition 3. In an equilibrium with no money (or no valued money), there is
no trade in the OTC market. The first-order conditions for a dealer d and an investor i in the

                                                                  70
time-t Walrasian market are

                          φst ≥ βπEt φst+1 , “ = ” if ãst+1d > 0
                          φst ≥ βπEt ε̄yt+1 + φst+1 , “ = ” if ãst+1i > 0.
                                                      


In a stationary equilibrium, Et (φst+1 /φst ) = γ̄, and βγ̄π < 1 is a maintained assumption, so
                                                                                        β̄π
no dealer holds equity. The Walrasian market for equity can only clear if φs =         1−β̄π
                                                                                             ε̄.   This
establishes parts (i ) and (iii ) in the statement of the proposition.
   Next, we turn to monetary equilibria. With α = 0, in a stationary equilibrium (19)-(22)
become

                      µ ≥ β̄, “ = ” if ãm
                                         t+1d > 0                                                  (116)
                     φs ≥ β̄π φ̄s , “ = ” if ãst+1d > 0                                           (117)
                                         R εH
                                          ε∗ [1 − G (ε)] dε
                                                           
                          β̄
                      1≥       1 + δθ                         , “ = ” if ãm
                                                                           t+1i > 0                (118)
                          µ                   ε∗ + φ s
                                     "         Z ε∗         #
                      s      β̄π
                     φ ≥               ε̄ + δθ      G (ε) dε , “ = ” if ãst+1i > 0.               (119)
                          1 − β̄π                εL


(In (116) we have used the fact that φ̄s = ε∗ + φs > φs .) Under our maintained assumption
β̄ < µ, (116) implies ãm
                        t+1d = ZD = 0, so (118) must hold with equality for some investor in a
monetary equilibrium. Thus, in order to find a monetary equilibrium there are three possible
equilibrium configurations to consider depending on the binding patterns of the complementary
slackness conditions (117) and (119). The market-clearing condition, ĀsDt + ĀsIt = AsDt + δAsIt
must hold for all three configurations. Lemma 7 shows that this condition can be written as
(112) and this condition can be rearranged to deliver (31). The rest of the proof proceeds in
three steps.
   Step 1: Try to construct a stationary monetary equilibrium with ãst+1d = 0 for all d ∈ D,
and ãst+1i > 0 for some i ∈ I. The equilibrium conditions for this case are (112) together with

                                φs > β̄π φ̄s                                                       (120)
                                                  R εH
                                                   ε∗ [1 − G (ε)] dε
                                                                    
                                     β̄
                                 1=       1 + δθ                                                   (121)
                                     µ                 ε∗ + φ s
                                              "         Z ε∗          #
                                        β̄π
                                φs =            ε̄ + δθ      G (ε) dε                              (122)
                                     1 − β̄π             εL




                                                    71
and

                                 ãm
                                   t+1d = 0 for all d ∈ D                                                 (123)
                                 ãm
                                   t+1i ≥ 0, with “ > ” for some i ∈ I                                    (124)
                                 ãst+1d = 0 for all d ∈ D                                                (125)
                                 ãst+1i ≥ 0, with “ > ” for some i ∈ I.                                  (126)

Conditions (121) and (122) are to be solved for the two unknowns ε∗ and φs . Substitute (122)
into (121) to obtain
                                             R εH                        
                              β̄              ε∗ h[1  − G  (ε)] dε
                           1=     1 + δθ                    R ε∗         i                               (127)
                              µ           ∗
                                         ε + β̄π
                                                    ε̄ + δθ      G (ε) dε
                                                   1−β̄π                  εL

which is a single equation in ε∗ . Define
                                        R εH
                                             x [1 − G (ε)] dε                  µ − β̄
                                 T (x) ≡                                  −                               (128)
                                             1
                                                 x + 1−β̄πβ̄π T̂ (x)            β̄δθ
                                           1−β̄π

with                                                         Z   x
                                    T̂ (x) ≡ ε̄ − x + δθ             G (ε) dε,                            (129)
                                                              εL

and notice that ε∗ solves (127) if and only if it satisfies T (ε∗ ) = 0. T is a continuous real-valued
function on [εL , εH ], with

                                                   ε̄ − εL               µ − β̄
                                     T (εL ) =                       −          ,
                                                 εL +    β̄π
                                                              ε̄          β̄δθ
                                                        1−β̄π
                                                   µ − β̄
                                    T (εH ) = −           < 0,
                                                    β̄δθ
and                           n          h                     io R             n              o
                                   β̄π
                                           ε̄+δθ εx G(ε)dε +[ xεH [1−G(ε)]dε] 1+ 1−
                                                                                  β̄π
                                                 R
                      [1−G(x)] x+ 1−                                                    δθG(x)
            0                        β̄π                                            β̄π
          T (x) =   −                         n    L
                                                          h                 io2                    < 0.
                                                    β̄π
                                                            ε̄+δθ εx G(ε)dε
                                                                 R
                                                x+ 1− β̄π        L

Hence if T (εL ) > 0, or equivalently, if µ < µ̄ (with µ̄ is as defined in (24)) then there exists a
unique ε∗ ∈ (εL , εH ) that satisfies T (ε∗ ) = 0 (and ε∗ ↓ εL as µ ↑ µ̄). Once we know ε∗ , φs is
given by (122). Given ε∗ and φs , the values of Z, φ̄s , φm
                                                          t and pt are obtained using (31) (with
AsI = As and AsD = 0), (28), (29) and (30). To conclude this step, notice that for this case to
be an equilibrium (120) must hold, or equivalently, using φ̄s = ε∗ + φs and (122), it must be


                                                      72
that T̂ (ε∗ ) > 0, where T̂ is the continuous function on [εL , εH ] defined in (129). Notice that
T̂ 0 (x) = − [1 − δθG (x)] < 0, and T̂ (εH ) = − (1 − δθ) (εH − ε̄) < 0 < ε̄ − εL = T̂ (εL ), so there
exists a unique ε̂ ∈ (εL , εH ) such that T̂ (ε̂) = 0. (Since T̂ (ε̄) > 0, and T̂ 0 < 0, it follows that
ε̄ < ε̂.) Then T̂ 0 (x) < 0 implies T̂ (ε∗ ) ≥ 0 if and only if ε∗ ≤ ε̂, with “=” for ε∗ = ε̂. With
(128), we know that ε∗ < ε̂ if and only if T (ε̂) < 0 = T (ε∗ ), i.e., if and only if
                       "                      Rε                       #
                                    δθ 1 − β̄π ε̂ H [1 − G (ε)] dε
                     β̄ 1 +                             R ε̂              < µ.
                              β̄π ε̄ + 1 − β̄π ε̂ + β̄πδθ εL G (ε) dε
                                           R εH
Since T̂ (ε̂) = (1 − δθ) (ε̄ − ε̂) + δθ      ε̂   [1 − G (ε)] dε = 0, this last condition is equivalent to
µ̂ < µ, where µ̂ is as defined in (24). The allocations and asset prices described in this step
correspond to those in the statement of the proposition for the case with µ ∈ (µ̂, µ̄).
   Step 2: Try to construct a stationary monetary equilibrium with ast+1d > 0 for some d ∈ D,
and ast+1i = 0 for all i ∈ I. The equilibrium conditions are (112), (121), (123), (124), together
with

                      φs = β̄π φ̄s                                                                  (130)
                                       "                             #
                                                       ε∗
                               β̄π
                                                   Z
                      φs >           ε̄ + δθ                G (ε) dε , “ = ” if ãst+1i > 0.        (131)
                             1 − β̄π                 εL



                                ãst+1d ≥ 0, with “ > ” for some d ∈ D                              (132)
                                ãst+1i = 0, for all i ∈ I.                                         (133)

The conditions (121) and (130) are to be solved for ε∗ and φs . First use φ̄s = ε∗ + φs in (130)
to obtain
                                                              β̄π ∗
                                                  φs =              ε .                             (134)
                                                            1 − β̄π
Substitute (134) in (121) to obtain
                                  "              Rε                 #
                               β̄      δθ 1 − β̄π ε∗H [1 − G (ε)] dε
                          1=        1+                                                              (135)
                               µ                   ε∗

which is a single equation in ε∗ . Define
                                                      R εH
                                           1 − β̄π     x      [1 − G (ε)] dε µ − β̄
                             R (x) ≡                                        −                       (136)
                                                             x                β̄δθ


                                                             73
and notice that ε∗ solves (135) if and only if it satisfies R (ε∗ ) = 0. R is a continuous real-valued
function on [εL , εH ], with
                                                   
                                           1 − β̄π (ε̄ − εL ) µ − β̄
                                R (εL ) =                    −
                                                   εL          β̄δθ
                                            µ − β̄
                                R (εH ) = −
                                             β̄δθ
and                                                     R εH
                           0          [1 − G (x)] x +   x [1   − G (ε)] dε
                         R (x) = −                    1                      < 0.
                                                    1−β̄π
                                                          x2
Hence if R (εL ) > 0, or equivalently, if
                                    "                          #
                                          δθ 1 − β̄π (ε̄ − εL )
                               µ < β̄ 1 +                         ≡ µo
                                                   εL

then there exists a unique ε∗ ∈ (εL , εH ) that satisfies R (ε∗ ) = 0 (and ε∗ ↓ εL as µ ↑ µo ).
Having solved for ε∗ , φs is obtained from (134). Given ε∗ and φs , the values of Z, φ̄s , φm
                                                                                            t and
pt are obtained using (31) (with AsD = As − AsI = πAs ), (28), (29) and (30). Notice that for
this case to be an equilibrium (131) must hold, or equivalently, using (134), it must be that
T̂ (ε∗ ) < 0, which is in turn equivalent to ε̂ < ε∗ . With (136), we know that ε̂ < ε∗ if and only
if R (ε∗ ) = 0 < R (ε̂), i.e., if and only if
                                     "               Rε                  #
                                           δθ 1 − β̄π ε̂ H [1 − G (ε)] dε
                              µ < β̄ 1 +                                    ,
                                                         ε̂

which using the fact that T̂ (ε̂) = 0, can be written as µ < µ̂. To summarize, the prices
and allocations constructed in this step constitute a stationary monetary equilibrium provided
µ ∈ (β̄, min (µ̂, µo )). To conclude this step, we show that µ̂ < µ̄ < µo , which together with
the previous step will mean that there is no stationary monetary equilibrium for µ ≥ µ̄ (thus
establishing part (ii ) in the statement of the proposition). It is clear that µ̄ < µo , and we know
that µ̂ < µ̄ from Lemma 6. Therefore the allocations and asset prices described in this step
correspond to those in the statement of the proposition for the case with µ ∈ (β̄, min (µ̂, µo )) =
(β̄, µ̂).
     Step 3: Try to construct a stationary monetary equilibrium with ãst+1d > 0 for some d ∈ D,
and ãst+1i > 0 for some i ∈ I. The equilibrium conditions are (112), (121), (122), (123), (124),
and (130) with

               ãst+1i ≥ 0 and ãst+1d ≥ 0, with “ > ” for some i ∈ I or some d ∈ I.

                                                   74
Notice that ε∗ and φs are obtained as in Step 2. Now, however, (122) must also hold, which
together with (134) implies that
                                                             Z   ε∗
                                                    ∗
                                       0 = ε̄ − ε + δθ                G (ε) dε
                                                               εL

or equivalently, (since the right side is just T̂ (ε∗ )), that ε∗ = ε̂. In other words, this condition
requires R (ε̂) = T̂ (ε̂), or equivalently, we must have µ = µ̂. As before, the market-clearing
condition (31) is used to obtain Z, while (28), (29), and (30) imply φ̄s , φm
                                                                            t , and pt , respectively.
The allocations and asset prices described in this step correspond to those in the statement of
the proposition for the case with µ = µ̂.
   Combined, Steps 1-3 prove part (iv ) in the statement of the proposition. Part (v )(a) is
immediate from (122) and (128), and part (v )(b) from (134) and (136).

Corollary 2 The marginal type, ε∗ , characterized in Proposition 3 is strictly decreasing in the
                          ∗
rate of inflation, i.e., ∂ε
                         ∂µ < 0 both for µ ∈ (β̄, µ̂), and for µ ∈ (µ̂, µ̄).

Proof of Corollary 2. For µ ∈ β̄, µ̂ , implicitly differentiate R (ε∗ ) = 0 (with R given by
                                    

(136)), and for µ ∈ (µ̂, µ̄), implicitly differentiate T (ε∗ ) = 0 (with T given by (128)) to obtain
                                             ε∗
                            
                   ∂ε ∗      − β̄δθ(1−β̄π)[1−G(ε∗ )]+µ−β̄
                                                                      if β̄ < µ < µ̂
                         =
                                             R εH
                                         β̄δθ ε∗ [1−G(ε)]dε
                   ∂µ        − n1+β̄δθh πG(ε∗ ) + 1−G(ε∗ ) io(µ−β̄ )2 if µ̂ < µ < µ̄.
                            
                                            1−β̄π       µ−β̄


Clearly, ∂ε∗ /∂µ < 0 for µ ∈ (β̄, µ̂), and for µ ∈ (µ̂, µ̄).

Proof of Proposition 4. With δ = 0, in any stationary equilibrium the Euler equations for
a dealer d obtained in Lemma 5 reduce to

                                    µ ≥ β̄, with “ = ” if ãm
                                                            t+1d > 0

                                   φs ≥ β̄πφs , with “ = ” if ãm
                                                                t+1d > 0.

The maintained assumptions µ > β̄ and β̄π < 1, and the fact that the equity will be valued
in any equilibrium imply ãm        m
                           t+1d = ãt+1d = 0 for all d ∈ D. Since dealers are inactive in any
stationary equilibrium, we focus on investors for the remainder of the proof. In an equilibrium
with no money (or no valued money), there is no trade in the OTC market. The first-order
condition for an investor i in the time-t Walrasian market is

                              φst ≥ βπEt ε̄yt+1 + φst+1 , “ = ” if ãst+1i > 0.
                                                       


                                                        75
                                                                                                                     β̄π
In a stationary equilibrium the Walrasian market for equity can only clear if φst =                                      ε̄y .
                                                                                                                    1−β̄π t
                                                                                                                                 This
establishes parts (i ) and (iii ) in the statement of the proposition. In a stationary monetary
equilibrium the Euler equations for an investor obtained in Lemma 5 reduce to
                        "        Z εH Z εH                             #
                                            εi − εj
                  µ = β̄ 1 + αη                      dG (εi ) dG (εj )                                                           (137)
                                   εc   εj  ε j + φs
                                             Z εc Z εj                              
                  s      β̄π
                 φ =           ε̄ + α (1 − η)           (εj − εi ) dG (εi ) dG (εj )                                             (138)
                      1 − β̄π                   εL   εL

where
                                                                    Z
                                                            εc ≡       − φs .                                                    (139)
                                                                    As
Condition (137) can be substituted into (138) to obtain a single equation in the unknown εc ,
namely T̄ (εc ) = 0, where T̄ : [εL , εH ] → R is defined by
                  Z εH Z εH
        c                                         εi −εj
   T̄ (ε ) ≡ β̄αη                 β̄π
                                       h        R εc R εj                                         i dG (εi ) dG (εj )   + β̄ − µ.
                     εc       εj   εj + 1−β̄π ε̄+α(1−η)            εL    εL (εj −εi )dG(εi )dG(εj )



Notice that T̄ (εH ) = β̄ − µ < 0 and
                                   Z εH Z               εH
                                                                  εi − εj
                   T̄ (εL ) = β̄αη                                                 dG (εi ) dG (εj ) + β̄ − µ,
                                                                         β̄π
                                             εL        εj       εj +    1−β̄π
                                                                              ε̄

so since T̄ is continuous, a stationary monetary equilibrium exists if µ < µ̃ with µ̃ defined as in
(35). In addition,
                          "        Z   εH
           0   c                            εi −εc           0 c
         T̄ (ε ) = − β̄αη                   εc +φs dG (εi ) G (ε )
                                   εc
                                                                                                                           #
                                                   εH           εH (ε −ε ) R εc (εc −ε)dG(ε)G0 (εc )
                     (β̄α)2 πη (1 − η)
                                               Z            Z
                                                                     i  j   ε
                   +                                                               L
                                                                                   (εj +φs )2
                                                                                                       dG (εi ) dG (εj )
                          1 − β̄π                 εc         εj

is negative, so a stationary monetary equilibrium exists if and only if µ < µ̃, and there cannot
be more than one stationary monetary equilibrium. Condition (36) is just (138), condition (38)
is T̄ (εc ) = 0, and (37) follows from (139). This establishes parts (ii ) and (iv ). Part (v ) is
immediate from (38).

Proof of Proposition 5. Recall that ∂ε∗ /∂µ < 0 (Corollary 2). (i ) From (27),

                          ∂φs     β̄π h                                  i ∂ε∗
                              =         I{β̄<µ≤µ̂} + I{µ̂<µ<µ̄} δθG (ε∗ )      < 0.
                          ∂µ    1 − β̄π                                    ∂µ

                                                                     76
(ii ) Condition (28) implies ∂ φ̄s /∂µ = ∂ε∗ /∂µ + ∂φs /∂µ < 0. (iii ) Differentiate (31) to obtain
                                                                                            2       
                                                                    s       ∂φs R εH ε∗ +φs
                                                                                     
    ∂Z            G0 (ε∗ )AsI + G0 (ε∗ )(ε∗ +φs )+θ[1−G(ε∗ )] 1+ ∂φ∗  +(1−θ)   ∗    ∗      s    dG(ε)                    Z
                                                                 ∂ε          ∂ε   ε     ε+φ                          (ε∗ +φs )2
        = δZ                                                   AsD +δG(ε∗ )AsI                                                    > 0.
    ∂ε∗
                                                                                                                                      (140)
Hence ∂Z/∂µ = (∂Z/∂ε∗ )(∂ε∗ /∂µ) < 0. From (29), ∂φm             m
                                                   t /∂µ = (yt /At ) ∂Z/∂µ < 0.


Proof of Proposition 6. First, notice that ∂εc /∂µ = 1/T̄ 0 (εc ) < 0, where T̄ (·) is the mapping
defined in the proof of Proposition 4. (i ) Differentiate (36) to obtain
                                                                         εc
                       ∂φs     β̄π                                                                    ∂εc
                                                                     Z
                           =         α (1 − η) G0 (εc )                        (εc − εi ) dG (εi )        < 0.
                       ∂µ    1 − β̄π                                   εL                             ∂µ

(ii ) From (37), ∂Z/∂µ = (∂εc /∂µ + ∂φs /∂µ)As < 0, and since Z = φm  m         m
                                                                   t At /yt , ∂φt /∂µ =
(∂Z/∂µ) (yt /Am
              t ) < 0.


Proof of Proposition 7. From condition (32),
                                  µ−β̄ ∗
      ∂ε∗                          δθ [ε + β̄π (ε̄ −  ε∗ ) I{µ̂<µ} ]
            =                                                                                                        > 0.            (141)
     ∂ (δθ)   β̄δθ(1 − β̄π) [1 − G (ε∗ )] + (µ − β̄) 1 + β̄π [δθG (ε∗ ) − 1] I{µ̂<µ}

(i ) From (36),
                               
                                    β̄π ∂ε∗
                   ∂φs         
                                   1−β̄π ∂(δθ)
                                                   >0                                              if β̄ < µ ≤ µ̂
                           =        β̄π
                                         hR ∗
                                             ε                                     ∂ε∗
                                                                                         i
                 ∂ (δθ)        
                                   1−β̄π    εL    G (ε) dε + δθG (ε∗ ) ∂(δθ) > 0 if µ̂ < µ < µ̄.

(ii ) From (28), ∂ φ̄s /∂ (δθ) = ∂ε∗ /∂ (δθ) + ∂φs /∂ (δθ) > 0. (iii ) For µ ∈ (µ̂, µ̄), (31) im-
plies ∂Z/∂δ = (∂Z/∂ε∗ ) (∂ε∗ /∂δ) > 0 (the sign follows from (140) and (141)), and therefore
∂φm                     m
  t /∂δ = (∂Z/∂δ) (yt /At ) > 0.


Proof of Proposition 8. Implicit differentiation of T̄ (εc ) = 0 implies
                                    R εH R ε      η(1−β̄π)(εi −εj )[(1−β̄π)εj +β̄π ε̄]
                                             H
                                      εc                                              2 dG(εi )dG(εj )
 ∂εc                                       εj
                                                 {(1−β̄π)εj +β̄π[ε̄+α(1−η)ϕ(εc )]}
     =                αη(1−β̄π)(εi −εj )                                        β̄πα2 η(1−η)(1−β̄π)(εi −εj )ϕ0 (εc )
                                                                                                                                      > 0.
 ∂α      R εH
          εc    (1−β̄π)εc +β̄π[ε̄+α(1−η)ϕ(εc )]
                                                                Rε
                                                dG(εi )G0 (εc )+ εcH
                                                                       Rε
                                                                         εj
                                                                           H
                                                                                                                   2 dG(εi )dG(εj )
                                                                               { (1−β̄π)εj +β̄π[ε̄+α(1−η)ϕ(εc )]}

(i ) Differentiate (36) to arrive at
                                                Z εc
                  ∂φs   β̄π (1 − η)                                               c
                                                                                   
                                         c             c                     c ∂ε
                      =              ϕ (ε ) + α      (ε − εi ) dG (εi ) dG (ε )       > 0.
                  ∂α      1 − β̄π                εL                             ∂α


                                                                  77
(ii ) From (37),
                                                     ∂εc ∂φs
                                                               
                                        ∂Z
                                           =            +           As > 0,
                                        ∂α           ∂α   ∂α
and since Z = φm  m                         m
               t At /yt , it follows that ∂φt /∂α > 0.


Proof of Proposition 9. (i ) The result is immediate from the expression for AsD in Proposition
3. (ii ) From (24) and (25),
                                                                          ε̂
                                                    (1 − δθ) ε̄                     ε̂ − ε̄
                                                                                             
                     ∂ µ̂
                                                                      Z
                                       
                          = β̄ 1 − β̄π                                   G (ε) dε −               .
                   ∂ (δθ)                        [1 − δθG (ε̂)] ε̂2   εL               ε̂

Notice that ∂ µ̂/∂ (δθ) approaches a positive value as δθ → 0, and a negative value as δθ → 1.
Also, µ̂ → β̄ both when δθ → 0, and when δθ → 1. Hence µ > β̄ = limδθ→0 µ̂ = limδθ→1 µ̂ for a
range of values of δθ close to 0 and a range of values of δθ close to 1. For those ranges of values
of δθ, AsD = 0. In between those ranges there must exist values of δθ such that µ < µ̂ which
implies AsD > 0.

Proof of Proposition 10. (i ) Differentiate (39) to get
                                   ∂V                             ∂ε∗
                                      = 2δG0 (ε∗ ) (As − π ÃsD )     < 0,
                                   ∂µ                             ∂µ
where the inequality follows from Corollary 2. (ii ) From (39),
                              ∂V                             ∂ε∗
                                 = 2δG0 (ε∗ ) (As − π ÃsD )
                              ∂θ                             ∂θ
                                                              ∗
                                    
                              ∂V          ∗        0 ∗ ∂ε
                                 = 2 G (ε ) + δG (ε )            (As − π ÃsD )
                              ∂δ                           ∂δ

and both are positive since ∂ε∗ /∂ (δθ) > 0 (see (141)).

Proof of Proposition 10. Rewrite Ṽ as
                       Z εc
              Ṽ = αAs      {η [1 − G (εi )] + (1 − η) G (εi )} dG (εi )
                        εL
                       Z εH
                     s                                           ε c + φs
                 + αA       {η [1 − G (εi )] + (1 − η) G (εi )}           dG (εi ) .
                        εc                                       εi + φ s
Differentiate to obtain
                              εH
             ∂ Ṽ                                                               ∂ εc + φ s
                          Z                                                               
                  = αAs            {η [1 − G (εi )] + (1 − η) G (εi )}                       dG (εi ) ,
             ∂εc           εc                                                  ∂εc εi + φs


                                                         78
where                                                               s
                             ∂ ε c + φs     εi + φs + (εi − εc ) ∂φ
                                       
                                                                 ∂εc s
                                          =                 2         A > 0 for εi > εc .
                            ∂εc εi + φs                   s
                                                  (εi + φ )
Hence, ∂ Ṽ/∂εc > 0. Thus ∂ Ṽ/∂µ = (∂ Ṽ/∂εc ) (∂εc /∂µ) < 0, since ∂εc /∂µ < 0 (see proof
of Proposition 6), which establishes (i ). For part (ii ), simply notice that ∂ Ṽ/∂α = Ṽ/α +
(∂ Ṽ/∂εc ) (∂εc /∂α) > 0.

Proof of Proposition 12. (i ) For β̄ < µ ≤ µ̂, ∂P/∂µ = β̄π/(1 − β̄π) (∂ε∗ /∂µ) < 0, and for
                                                                         

µ̂ < µ < µ̄, ∂P/∂µ = β̄π/(1 − β̄π) δθG (ε∗ ) (∂ε∗ /∂µ) < 0. (ii ) For β̄ < µ ≤ µ̂, ∂P/∂ (δθ) =
                                     

  β̄π/(1 − β̄π) (∂ε∗ /∂ (δθ)) > 0, and for µ̂ < µ < µ̄, ∂P/∂µ = β̄π/(1 − β̄π) {δθG (ε∗ ) [∂ε∗ /∂ (δθ)]+
                                                                          
R ε∗
  εL G (ε) dε} > 0.


Proof of Proposition 13. (i ) ∂ P̃/∂µ = β̄π/(1 − β̄π) α (1 − η) ϕ0 (εc ) (∂εc /∂µ) < 0. (ii )
                                                            

∂ P̃/∂α = β̄π/(1 − β̄π) (1 − η) {αϕ0 (εc ) (∂εc /∂α) + ϕ (εc )} > 0.
                      


Proof of Proposition 14. The choice variable a0tD does not appear in the Planner’s objective
function, so a0tD = 0 at an optimum. Since (42) must bind for every t at an optimum, the
planner’s problem is equivalent to
                                                   ∞
                                                               (         Z                                                         )
                                                   X
        ∗∗
    W        =             max ∞ E0              β         t
                                                               δ (vt )               εa0tI    (dε) + [1 − δ (vt )] ε̄atI − kvt+1       yt
                  {vt ,ãtD ,ãtI ,a0tI }t=0 t=0                         [εL ,εH ]

                                                                                         0
                                                                         R
subject to (6), (7), (40) and (41). Clearly,                                 [εL ,εH ] εatI   (dε) ≤ εH and (41) must bind at an
optimum, so        W ∗∗     ≤    W̄ ∗∗ ,    where
                                                   ∞
                                                   X
             ∗∗
        W̄        =         max              E0          β t {[vt atD + δ (vt ) atI ] εH + [1 − δ (vt )] ε̄atI − kvt+1 } yt
                      {vt ,ãtD ,ãtI }∞
                                       t=0         t=0
                                            ∞
                                            X
                  =      max           E0          β t {[πεH + (1 − π) {δ (vt ) εH + [1 − δ (vt )] ε̄}] As
                      {vt ,ãtI }∞
                                 t=0         t=0
                  − [1 − δ (vt )] (εH − ε̄) πãtI − kvt+1 } yt
                                X∞
                  = max ∞
                            E0      β t {[πεH + (1 − π) {δ (vt ) εH + [1 − δ (vt )] ε̄}] As − kvt+1 } yt
                      {vt }t=0
                                       t=0
                          ∞
                          X
                                 β t [πεH + (1 − π) {δ (vt∗ ) εH + [1 − δ (vt∗ )] ε̄}] As − kvt+1
                                                                                              ∗
                                    
                  = E0                                                                            yt ,
                           t=0

where the maximization in the first line is subject to (6), (7) and (40) (which must bind
at an optimum), the second line has been obtained by substituting these constraints into the

                                                                             79
objective function, and {vt∗ } in the last line denotes the sequence of vt characterized by (43). The
allocation in the statement of the proposition achieves W̄ ∗∗ and therefore solves the Planner’s
problem.

Lemma 8 In any equilibrium, the free-entry condition (44) can be written as (45).

Proof of Lemma 8. With (14), the left side of condition (44) can be written as

                                         D
                                            am   , πast+1 − φm am   + φst ast+1 − kt .
                                                                             
                       max         βEt Vt+1  t+1             t  t+1
                 (am
                   t+1 ,at+1 )∈R+
                         s      2



And with (17), this last expression becomes

                         βEt φ̄t+1 − φm
                                        m                       s
                                                                     s         D
        max                           t at+1 + βπEt φ̄t+1 pt+1 − φt at+1 + βEt Vt+1 (0) − kt ,                       (142)
    t+1 ,at+1 )∈R+
  (am     s      2



where
                                     "                                                                                               #
                                             Z   εH                                           Z   ε∗t+1
  D                                                   (ε−ε∗t+1 )yt+1                                      (ε∗t+1 −ε)yt+1
Vt+1 (0) ≡ κ (vt+1 ) (1 − θ) φ̄t+1 Am
                                    It+1              εyt+1 +φst+1     dG (ε) + pt+1 AsIt+1               ε∗t+1 yt+1 +φst+1 dG (ε)
                                              ε∗t+1                                           εL
               D
         + max Wt+1 (0) − kt , 0

is as in Lemma 4, except for the last term, which reflects the fact that the dealer has to bear
cost k in order to participate in the OTC market of the following period. In equilibrium, the
dealer optimization (conditions (19) and (20)) implies

                                βEt φ̄t+1 − φm
                                                m
                                                at+1 + βπEt φ̄t+1 pt+1 − φst ast+1 = 0.
                                                                                
                   max                       t
               t+1 ,at+1 )∈R+
             (am     s      2

                            D
Also, (44) implies max Wt+1      (0) − kt , 0 = 0. Hence (142) reduces to Φt+1 − kt , with Φt+1 as
defined below (45).

Proof of Proposition 15. Consider a stationary equilibrium with free entry (for the model
with α = 0). As µ → β̄, (32) implies
                                    R εH
                                     ε∗ [1 − G (ε)] dε
                               h               R ε∗        i        →0
                      ε∗ + βπ ε̄ − ε∗ + δ (v) θ εL G (ε) dε I{µ̂<µ}

which in turn implies ε∗ → εH . The dealer’s and the investor’s Euler equations for equity in
Lemma 5 imply                              (                                     )
                                                              Z ε∗
                                  β̄π
                           φs =         max ε∗ , ε̄ + δ (v) θ      (ε∗ − ε)dG (ε) ,
                                1 − β̄π                        εL


                                                         80
                    n                 R ε∗              o
and as ε∗ → εH , max ε∗ , ε̄ + δ (v) θ εL (ε∗ − ε)dG (ε) → max {εH , ε̄ + δ (v) θ(εH − ε̄)} = εH ,
so ÃsD → As , i.e., only dealers hold equity overnight. Thus, from (48), Φ̄ − k → Π (v), where

                           Π (v) ≡ β̄κ (v) (1 − θ) (εH − ε̄) (1 − π) As − k.

Notice that

                  lim Π (v) = −k < 0 < β̄ (1 − θ) (εH − ε̄) (1 − π) As − k = Π (0)
                 v→∞

and Π0 (v) = β̄κ0 (v) (1 − θ) (εH − ε̄) (1 − π) As < 0, so there exists a unique v ∈ (0, ∞) that
satisfies Π (v) = 0. To conclude, we only need to show that under the hypothesis of the
proposition, Π (v) = 0 is equivalent to (43). Notice that δ 00 (v) < 0 implies κ (v) = δ (v) /v ≤
δ 0 (0) for any v ≥ 0. In particular, for v = 0 this implies 1 ≤ δ 0 (0). Hence

              0 < β̄ (1 − θ) (εH − ε̄) (1 − π) As − k ≤ β̄δ 0 (0) (εH − ε̄) (1 − π) As − k

which means that v > 0 in the Planner’s solution. Then (43) must hold with equality and the
optimal v satisfies
                                  β̄δ 0 (v) (εH − ε̄) (1 − π) As − k = 0.                                  (143)
                                                                     0          δ 0 (v)
Finally, notice that δ 0 (v) = κ (v) + κ0 (v) v, so if 1 − θ = 1 − −κκ(v)
                                                                       (v)v
                                                                            =   κ(v)      then (143) is identical
to Π (v) = 0.




                                                    81
References

 [1] Ang, Andrew, Assaf A. Shtauber, and Paul C. Tetlock. “Asset Pricing in the Dark: The
    Cross Section of OTC Stocks.” NBER Working Paper 19309, August 2013.

 [2] Asness, Clifford. “Stocks versus Bonds: Explaining the Equity Risk Premium.” Financial
    Analysts Journal 56(2) (March/April 2000): 96-113.

 [3] Asness, Clifford. “Fight the Fed Model: The Relationship between Future Returns and
    Stock and Bond Market Yields.” Journal of Portfolio Management 30(1) (Fall 2003): 11-
    24.

 [4] Barlevy, Gadi. “Economic Theory and Asset Bubbles.” Federal Reserve Bank of Chicago
    Economic Perspectives 31(3) (Quarter 3 2007): 44-59.

 [5] Basak, Suleyman, and Hongjun Yan. “Equilibrium Asset Prices and Investor Behaviour in
    the Presence of Money Illusion.” Review of Economic Studies 77(3) (July 2010): 914-936.

 [6] Bekaert, Geert, and Eric Engstrom. “Inflation and the Stock Market: Understanding the
    Fed Model.” Journal of Monetary Economics 57(3) (April 2010): 278-294

 [7] Berentsen, Aleksander, Guillaume Rocheteau, and Shouyong Shi. “Friedman Meets Hosios:
    Efficiency in Search Models of Money.” Economic Journal 117(516) (January 2007): 174-
    195.

 [8] Bodie, Zvi. “Common Stocks as a Hedge Against Inflation.” Journal of Finance 31(2)
    (May 1976): 459-470.

 [9] Bordo, Michael, and David C. Wheelock. “Stock Market Booms and Monetary Policy in
    the 20th Century.” Federal Reserve Bank of St. Louis Review 89(2) (March/April 2007):
    91-122.

[10] Brunnermeier, Markus K. “bubbles.” In The New Palgrave Dictionary of Economics, edited
    by S. Durlauf and L. Blume. Basingstoke: Palgrave Macmillan, 2008.

[11] Brunnermeier, Markus K., and Christian Julliard. “Money Illusion and Housing Frenzies.”
    Review of Financial Studies 21(1) (January 2008): 135-180.



                                            82
[12] Cagan, Phillip. “Common Stock Values and Inflation—The Historical Record of Many
    Countries.” National Bureau of Economic Research Supplement to NBER Report Thirteen
    (March 1974): 1-10.

[13] Campbell, John Y., and Tuomo Vuolteenaho. “Inflation Illusion and Stock Prices.” Amer-
    ican Economic Review 94(2) (May 2004): 19-23.

[14] Campbell, John Y., Carolin Pflueger, and Luis M. Viceira. “Monetary Policy Drivers of
    Bond and Equity Risks.” NBER Working Paper 20070, April 2014.

[15] Cass, David, and Karl Shell. “Do Sunspots Matter?” Journal of Political Economy 91(2)
    (April 1983): 193-227.

[16] Cohen, Randolph B., Christopher Polk, and Tuomo Vuolteenaho. “Money Illusion in the
    Stock Market: The Modigliani-Cohn Hypothesis.” Quarterly Journal of Economics 120(2)
    (May 2005): 639-668.

[17] Duffie, Darrell, Nicolae Gârleanu, and Lasse Heje Pedersen. “Over-the-Counter Markets.”
    Econometrica 73(6) (November 2005): 1815-1847.

[18] Fama, Eugene F., and G. William Schwert. “Asset Returns and Inflation.” Journal of
    Financial Economics 5(2) (November 1977): 115-146.

[19] Feinman, Joshua N. “Inflation Illusion and the (Mis)Pricing of Assets and Liabilities.”
    Journal of Investing 14(2) (Summer 2005): 29-36.

[20] Ferraris, Leo, and Makoto Watanabe. “Collateral Fluctuations in a Monetary Economy.”
    Journal of Economic Theory 146(5) (September 2011): 1915-1940.

[21] Geromichalos, Athanasios, and Lucas Herrenbrueck. “Monetary Policy, Asset Prices, and
    Liquidity in Over-the-Counter Markets.” UC Davis, mimeo, 2012.

[22] Geromichalos, Athanasios, Juan M. Licari and José Suárez-Lledo. “Asset Prices and Mon-
    etary Policy.” Review of Economic Dynamics 10(4) (October 2007): 761-779.

[23] Gordon, Myron J. The Investment, Financing, and Valuation of the Corporation. Irwin,
    Homewood, IL, 1962.



                                             83
[24] Harrison, J. Michael, and David M. Kreps. “Speculative Investor Behavior in a Stock
    Market with Heterogeneous Expectations.” Quarterly Journal of Economics 92(2) (May
    1978): 323-336.

[25] He, Chao, Randall Wright, and Yu Zhu. “Housing and Liquidity.” University of Wisconsin,
    mimeo, 2012.

[26] Hosios, Arthur J. “On the Efficiency of Matching and Related Models of Search and Un-
    employment.” Review of Economic Studies 57(2) (April 1990): 279-298.

[27] Jacquet, Nicolas L. and Serene Tan. “Money and Asset Prices with Uninsurable Risks.”
    Journal of Monetary Economics 59(8) (December 2012): 784-797.

[28] Jaffe, Jeffrey and Gershon Mandelker. “The ‘Fisher Effect’ for Risky Assets: An Empirical
    Investigation.” Journal of Finance 31(2) (May 1976): 447-458.

[29] Lagos, Ricardo. “Some Results on the Optimality and Implementation of the Friedman
    Rule in the Search Theory of Money.” Journal of Economic Theory 145(4) (July 2010):
    1508-1524.

[30] Lagos, Ricardo. “Asset Prices and Liquidity in an Exchange Economy.” Journal of Mone-
    tary Economics 57(8) (November 2010): 913-930.

[31] Lagos, Ricardo. “Asset Prices, Liquidity, and Monetary Policy in an Exchange Economy.”
    Journal of Money, Credit and Banking 43(7) (October 2011): 521-552.

[32] Lagos, Ricardo, and Guillaume Rocheteau. “Money and Capital as Competing Media of
    Exchange.” Journal of Economic Theory 142(1) (September 2008): 247-258.

[33] Lagos, Ricardo, and Guillaume Rocheteau. “Liquidity in Asset Markets with Search Fric-
    tions.” Econometrica 77(2) (March 2009): 403-426.

[34] Lagos, Ricardo, Guillaume Rocheteau, and Pierre-Olivier Weill. “Crises and Liquidity in
    Over-the-Counter Markets.” Journal of Economic Theory 146(6) (November 2011): 2169-
    2205.

[35] Lagos, Ricardo, and Randall Wright. “Dynamics, Cycles and Sunspot Equilibria in ‘Gen-
    uinely Dynamic, Fundamentally Disaggregative’ Models of Money.” Journal of Economic
    Theory 109(2) (April 2003): 156-171.

                                             84
[36] Lagos, Ricardo, and Randall Wright. “A Unified Framework for Monetary Theory and
    Policy Analysis.” Journal of Political Economy 113(3) (June 2005): 463-484.

[37] Lansing, Kevin J. “Inflation-Induced Valuation Errors in the Stock Market.” Federal Re-
    serve Bank of San Francisco Economic Letter 30 (November 2004): 1-3.

[38] Lester, Benjamin, Andrew Postlewaite, and Randall Wright. “Information, Liquidity, Asset
    Prices, and Monetary Policy.” Review of Economic Studies 79 (3) (July 2012): 1208-1238.

[39] Lettau, Martin, and Sydney C. Ludvigson. “Expected Returns and Expected Dividend
    Growth.” Journal of Financial Economics 76(3) (June 2005): 583-626.

[40] Li, Ying-Syuan, and Yiting Li. “Liquidity, Asset Prices, and Credit Constraints.” National
    Taiwan University, mimeo, 2012.

[41] Lintner, John. “Inflation and Security Returns.” Papers and Proceedings of the Thirty-
    Third Annual Meeting of the American Finance Association, San Francisco, California,
    December 28-30, 1974. Journal of Finance 30(2) (May 1975): 259-280.

[42] Lucas, Robert E., Jr. “Asset Prices in an Exchange Economy.” Econometrica 46(6)
    (November 1978): 1426-1445.

[43] Modigliani, Franco, and Richard A. Cohn. “Inflation, Rational Valuation and the Market.”
    Financial Analysts Journal (March/April 1979): 24-44.

[44] Nelson, Charles R. “Inflation and Rates of Return on Common Stocks.” Journal of Finance
    31(2) (May 1976): 471-483.

[45] Nosal, Ed, and Guillaume Rocheteau. “Pairwise Trades, Asset Prices, and Monetary Pol-
    icy.” Journal of Economic Dynamics and Control 37(1) (January 2013): 1-17.

[46] Ritter, Jay R., and Richard S. Warr. “The Decline of Inflation and the Bull Market of
    1982—1999.” Journal of Financial and Quantitative Analysis 37(1) (March 2002): 29-61.

[47] Rocheteau, Guillaume, and Randall Wright. “Liquidity and Asset-Market Dynamics.”
    Journal of Monetary Economics 60(2) (March 2013): 275-294.

[48] Scheinkman, José A. “Speculation, Trading and Bubbles.” Princeton University Economic
    Theory Center, Research Paper No. 050-2013 (April 2013).

                                              85
[49] Scheinkman, José A., and Wei Xiong. “Heterogeneous Beliefs, Speculation and Trading in
    Financial Markets.” Lectures in Mathematics, Paris-Princeton Lectures in Mathematical
    Finance 2003, edited by Tomasz R. Bielecki, Tomas Björk, Monique Jeanblanc, Marek
    Rutkowski, José A. Scheinkman, and Wei Xiong, Springer, 2003.

[50] Scheinkman, José A., and Wei Xiong. “Overconfidence and Speculative Bubbles.” Journal
    of Political Economy 111(6) (December 2003): 1183-1219.

[51] Schneider, Martin, and Monika Piazzesi. “Inflation Illusion, Credit, and Asset Prices.” In
    Asset Prices and Monetary Policy edited by John Y. Campbell. University of Chicago
    Press, 2008.

[52] Sharpe, Steven A. “Reexamining Stock Valuation and Inflation: The Implications of An-
    alysts’ Earnings Forecasts.” Review of Economics and Statistics 84(4) (November 2002),
    632–648.

[53] Shi, Shouyong. “Money and Prices: A Model of Search and Bargaining.” Journal of Eco-
    nomic Theory (67) 2 (December 1995): 467-496.

[54] Siegel, Jeremy J. “The Rise in Stock Valuations and Future Equity Returns.” Journal of
    Investment Consulting (Summer 2002).

[55] Trejos, Alberto, and Randall Wright. “Search, Bargaining, Money, and Prices.” Journal of
    Political Economy 103(1) (February 1995): 118-141.

[56] Trejos, Alberto, and Randall Wright. “Money and Finance: An Integrated Approach.”
    University of Wisconsin, mimeo, 2012.

[57] Williams, John Burr. The Theory of Investment Value. Harvard University Press, Cam-
    bridge, MA, 1938.

[58] Xiong, Wei. “Bubbles, Crises and Heterogeneous Beliefs.” NBER working paper 18905,
    March 2013.

[59] Zhang, Shengxing. “Liquidity Misallocation in an Over-The-Counter Market.” NYU
    mimeo, 2012.




                                              86
                            5                       Equity prices (ex dividend, daily)                                               7                        Real balances                                                   −4                      Nominal price level
                    x 10                                                                                                      x 10                                                                                     x 10
            12                                                                                                            8                                                                                        8
                                     µ = β̄                                                                                              µ = β̄ + c                                                                                µ < γ̄
                                     µ = µ̂                                                                                              µ = β̄ + 10c                                                                              µ = γ̄
                                                                                                                          7                                                                                        7
                                                                                                                                                                                                                                   µ > γ̄
            10

                                                                                                                          6                                                                                        6

                8
                                                                                                                          5                                                                                        5



                6                                                                                                         4                                                                                        4




     φ ts
                                                                                                                                                                                                          1/φ tm




                                                                                                              φ tm A tm
                                                                                                                          3                                                                                        3
                4

                                                                                                                          2                                                                                        2

                2
                                                                                                                          1                                                                                        1



                0                                                                                                         0                                                                                        0
                    0            10           20    30     40       50       60     70    80    90    100                     0          10    20       30   40        50       60   70   80   90   100                0           10       20   30   40       50       60   70   80   90   100
                                                                t (years)                                                                                           t (years)                                                                               t (years)




87
                        5                          Equity prices (ex dividend, daily)                                                6                            Real balances                                               −5                      Nominal price level
                x 10                                                                                                              x 10                                                                                     x 10
            7                                                                                                             2                                                                                        8
                                δ = 0.18                                                                                                  δ = 0.59                                                                                  δ = 0.50
                                δ = 0.83                                                                                1.8               δ = 0.67                                                                                  δ = 0.78
                                                                                                                                                                                                                   7
            6

                                                                                                                        1.6
                                                                                                                                                                                                                   6
            5                                                                                                           1.4

                                                                                                                                                                                                                   5
                                                                                                                        1.2
            4

                                                                                                                          1                                                                                        4




     φ ts
                                                                                                                                                                                                          1/φ tm




                                                                                                            φ tm A tm
            3
                                                                                                                        0.8
                                                                                                                                                                                                                   3


            2                                                                                                           0.6
                                                                                                                                                                                                                   2
                                                                                                                        0.4

            1
                                                                                                                                                                                                                   1
                                                                                                                        0.2


            0                                                                                                             0                                                                                        0
                0               10        20       30     40       50       60     70    80    90    100                      0          10    20       30   40        50       60   70   80   90   100                0           10       20   30    40      50       60   70   80   90   100
                                                                t (years)                                                                                           t (years)                                                                               t (years)



        Figure 1: Effects of monetary policy and market structure on equity prices, real money balances, and the price level
                             5                      Speculative premium
                          x 10
                   6
                                 µ = β̄
                                 µ = µ̂
                   5




                   4




                   3




88
     P t = φ ts − φ̂ ts
                   2




                   1




                   0
                       0         10       20   30     40       50       60      70   80   90   100
                                                           t (years)
                                                Figure 2: Speculative premium
                                       Equity prices (ex dividend, daily)                                             Investor‘s trading probability in the OTC market                                              Dealers‘ overnight asset holding
            12                                                                                         1                                                                                         1


                                                                                                      0.9                                                                                       0.9

            10
                                                                                                      0.8                                                                                       0.8


                                                                                                      0.7                                                                                       0.7
             8

                                                                                                      0.6                                                                                       0.6




                                                                                                                                                                                       t
                                                                                                                                                                                     s
             6                                                                                        0.5                                                                                       0.5




     φ ts
                                                                                                                                                                                    AD




                                                                                            δ(v t )
                                                                                                      0.4                                                                                       0.4

             4
                                                                                                      0.3                                                                                       0.3


                                                                                                      0.2                                                                                       0.2
             2

                                                                                                      0.1                                                                                       0.1


             0                                                                                         0                                                                                         0
                 0           10   20   30     40       50       60     70   80   90   100                   0    10   20     30      40      50       60    70      80   90   100                     0   10   20   30     40      50       60    70   80   90   100
                                                    t (years)                                                                             t (years)                                                                             t (years)




89
                        −4                   Average real spread                                                      Trade volume (value, in terms of numeraire good)                                                      Real balances
                     x 10
            1.5                                                                                        12                                                                                       12




            1.4                                                                                        10                                                                                       10




            1.3                                                                                         8                                                                                        8




            1.2                                                                                         6                                                                                        6




     S̄ t
                                                                                             φ̄ tsV t
                                                                                                                                                                                    φ tm A tm




            1.1                                                                                         4                                                                                        4




             1                                                                                          2                                                                                        2




            0.9                                                                                         0                                                                                        0
                  0          10   20   30      40      50       60     70   80   90   100                   0    10   20     30      40      50       60     70     80   90   100                    0    10   20   30     40      50       60    70   80   90   100
                                                    t (years)                                                                             t (years)                                                                             t (years)



                                                                                                                Figure 3: Liquidity crisis
