                                NBER WORKING PAPER SERIES




                            LIQUIDITY AND TRADING DYNAMICS

                                         Veronica Guerrieri
                                         Guido Lorenzoni

                                        Working Paper 13204
                                http://www.nber.org/papers/w13204


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      June 2007




We thank for helpful comments Daron Acemoglu, Fernando Alvarez, Marios Angeletos, Boragan
Aruoba, Gabriele Camera, Ricardo Cavalcanti, Chris Edmond, Ricardo Lagos, Robert Lucas, David
Marshall, Robert Shimer, Nancy Stokey, Christopher Waller, Ivàn Werning, Randall Wright, and seminar
participants at MIT, Cleveland Fed (Summer Workshop on Money, Banking, and Payments), University
of Maryland, University of Notre Dame, Bank of Italy, AEA Meetings (Chicago), Chicago Fed, Stanford
University, the Philadelphia Fed Monetary Macro Workshop, UCLA, San Francisco Fed, St. Louis
Fed, and University of Chicago GSB. The views expressed herein are those of the author(s) and do
not necessarily reflect the views of the National Bureau of Economic Research.

© 2007 by Veronica Guerrieri and Guido Lorenzoni. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Liquidity and Trading Dynamics
Veronica Guerrieri and Guido Lorenzoni
NBER Working Paper No. 13204
June 2007
JEL No. D83,E41,E44

                                              ABSTRACT

How do financial frictions affect the response of an economy to aggregate shocks? In this paper, we
address this question, focusing on liquidity constraints and uninsurable idiosyncratic risk. We consider
a search model where agents use liquid assets to smooth individual income shocks. We show that the
response of this economy to aggregate shocks depends on the rate of return on liquid assets. In economies
where liquid assets pay a low return, agents hold smaller liquid reserves and the response of the economy
tends to be larger. In this case, agents expect to be liquidity constrained and, due to a self-insurance
motive, their consumption decisions are more sensitive to changes in expected income. On the other
hand, in economies where liquid assets pay a large return, agents hold larger reserves and their consumption
decisions are more insulated from income uncertainty. Therefore, aggregate shocks tend to have larger
effects if liquid assets pay a lower rate of return.

Veronica Guerrieri
University of Chicago
GSB
vguerrie@chicagogsb.edu

Guido Lorenzoni
MIT Department of Economics
E52-251C
50 Memorial Drive
Cambridge, MA 02142
and NBER
glorenzo@mit.edu
1        Introduction

In times of economic distress, the demand for liquid assets typically increases. Facing the
prospect of temporary shortfalls in revenues, agents tend to hold on to their reserves of cash,
government bonds, and other safe assets as a form of self-insurance. An observation consistent
with this type of behavior is that the precautionary motive in consumption decisions is coun-
tercyclical.1 A further symptom of a countercyclical demand for liquidity can be identified in
the path of several measures of liquidity premia.2 In extreme episodes, such as financial market
crises, this type of behavior takes the form of an outright “flight to liquidity.” What are the
aggregate implications of a countercyclical demand for liquidity? Can it amplify the response
of economic activity to exogenous shocks? In this paper, we explore these questions in a general
equilibrium model with a single liquid asset and decentralized production and exchange. We
find that the answer depends on the total supply of liquid assets. In economies where liquid
assets are relatively abundant, a negative aggregate shock leads to a mechanical reduction in
activity, but there is no additional eﬀect due to the agents’ self-insurance motive. In economies
where, instead, liquid assets are relatively scarce, the aggregate shock has a magnified eﬀect
on the economy, as agents reduce their consumption in an attempt to protect their reserves.
        Our amplification mechanism is driven by a form of complementarity in trading decisions.
An agent is less willing to spend his liquid assets when he expects other agents to spend less.
This happens because, in that case, it is harder for him to rebuild his reserves by selling goods
to other agents. The idea that “the diﬃculty of coordination of trade” may contribute to
aggregate volatility goes back, at least, to Diamond (1982, 1984). The contribution of our
paper is to show that the presence of this coordination problem depends in a crucial way on
the supply of liquid assets. In particular, when they are relatively abundant, the coordination
element vanishes.
        We consider a model of decentralized trade in the tradition of search models of money.
There is a large number of households, each with one consumer and one producer. Consumers
and producers from diﬀerent households meet and trade in spatially separated islands. In each
island the gains from trade are determined by a local productivity shock. Agents make their
trading decisions (consumption and production) without observing the shock realized in the
island visited by their partners. Our focus is on whether trading decisions in a given island
    1
        See Parker and Preston (2005).
    2
        See Krishnamurthy (2002) and Longstaﬀ (2004) and papers reviewed in Cochrane (2005).


                                                       1
are aﬀected by agents’ expectations regarding the level of trading in other islands. This is the
sense in which there is a “coordination problem” in our model.
   Agents are anonymous and, thus, credit arrangements are not feasible. The government
issues a fixed supply of interest-bearing notes, “money,” which are used for transactions. These
notes pay a constant interest rate which is financed by lump-sum taxation. As we will see,
the equilibrium value of real money balances is an increasing function of the rate of return
chosen by the government. Therefore, a regime with a high rate of return, is labeled a regime
of “abundant liquidity,” while one with a low rate of return is one of “scarce liquidity.” To
derive our main analytical results, we focus on two extreme cases. In the first one, the rate of
return is equal to the inverse of the agents’ discount factor. This is a “Friedman rule” regime
and, in this case, real balances are large and the economy achieves the first-best allocation. In
the second one, the rate of return and the value of real balances are so low that agents expect
to be liquidity constrained for any realization of the idiosyncratic shocks. We refer to this case
as a “fully constrained” regime.
   Our first result is that under the Friedman rule the quantity traded in each island is indepen-
dent of what happens in other islands. This result follows from an assumption of separability
in preferences and from the fact that, in the Friedman rule regime, agents are fully insured
against idiosyncratic shocks. This makes the marginal value of money constant, allowing the
consumer and the producer from the same household to make their trading decisions indepen-
dently. Away from the Friedman rule, instead, the decisions of the two agents are linked. The
consumer needs to forecast the earnings of the producer to evaluate the household’s marginal
value of money, while the producer needs to forecast the consumer’s outlays.
   Next, we look at the aggregate implications of these “linkages.” We consider an aggregate
shock which shifts the distribution of island-specific productivities, reducing the probability of
low realizations and increasing that of high realizations (a first-order stochastic increase). The
aggregate shock is publicly observed. Under both regimes, there is a positive compositional
eﬀect: as more islands have high productivity, aggregate output increases. However, in the
Friedman rule regime, there is no feedback from this aggregate increase in output to the level
of trading in an island with a given local shock. In the fully constrained regime, instead,
the linkage between the trading decisions in diﬀerent islands generates an additional eﬀect on
trading and output. A good aggregate shock increases the probability of high earnings for the
producer. This induces the consumer to increase spending and reduce the household’s liquid


                                                2
reserves. At the same time, the producer expects his partner to spend more, and this increases
his incentive to produce. These two eﬀects imply that a higher level of aggregate activity
induces higher levels of activity in each individual island. This increase is further magnified
once we take into account general equilibrium eﬀects. Using a simple calibrated version of our
economy, we show that this leads to a sizeable degree of amplification of aggregate shocks.
   The crucial diﬀerence between the two financial regimes is the role of expectations in the
trading decisions of individual agents. To further clarify this diﬀerence, we also consider the
case where the aggregate distribution of island-specific shocks is not perfectly known at the
beginning of each period, and agents observe a public signal regarding this distribution. In the
Friedman rule regime, the public signal has no eﬀect on aggregate activity, given that trading
decisions are solely based on local shocks, which are observable. In the fully constrained regime,
on the other hand, a favorable public signal tends to increase aggregate activity due to the
eﬀect of the signal on agents’ expectations.
   This paper is related to the vast literature on search models of money, going back to
Diamond (1984) and Kiyotaki and Wright (1989). In particular, our model allows for divisible
money and we use the Lagos and Wright (2005) approach to simplify the analysis. In Lagos
and Wright (2005) agents alternate trading in a decentralized market to trading in a centralized
competitive market. The combination of quasi-linear preferences and a periodic access to a
centralized market ensures that the distribution of money holdings across agents is degenerate
when they enter the decentralized market. Here we use these same two ingredients, with a
modified periodic structure. In our model, agents have access to a centralized market every
three periods. The extra period of decentralized trading is necessary to make the self-insurance
motive matter for trading decisions in the decentralized market of the previous period. This is
at the core of our amplification mechanism. A three-period structure is also used by Berentsen,
Camera and Waller (2005) to study the short-run neutrality of money. They show that, away
from the Friedman rule, random monetary injections can be non-neutral, since they have a
diﬀerential eﬀect on agents with heterogeneous money holdings. Although very diﬀerent in the
objective, their analysis also relies on the lack of consumption insurance. Finally, our model
is related to Rocheteau and Wright (2005) for the use of competitive pricing à la Lucas and
Prescott (1974) in a search model of money.
   The paper is also related to the large literature exploring the relation between financial fric-
tions and aggregate volatility, including Bernanke and Gertler (1989), Bencivenga and Smith


                                                3
(1991), Acemoglu and Zilibotti (1997), Kiyotaki and Moore (1997). In particular, Kiyotaki and
Moore (2001) also address this issue from the point of view of limited liquidity supply. Their
paper emphasizes a diﬀerent channel by which limited liquidity can aﬀect the transmission of
aggregate shocks, focusing on the eﬀects on investment and capital accumulation.
    The rest of the paper is organized as follows. In Section 2, we introduce our environment
and solve for the first-best allocation of resources. In Section 3, we define and characterize
the competitive equilibrium. Section 4 addresses the main question of the paper, that is, how
the economy reacts to an aggregate shock. Section 5 present some numerical exercises on the
amplification result and on the behavior of liquidity premia. Section 6 discusses the extension
with imperfect information and public signals and versions of the model with alternative sources
of liquidity supply. Section 7 concludes. The appendix contains all the proofs not in the text.


2    The Model

The economy is populated by a continuum of infinitely-lived households, composed of two
agents, a consumer and a producer. Each household has an initial endowment M of perfectly
divisible notes issued by the government, “money.” Time is discrete and each period agents
produce and consume a single, perishable consumption good. The economy has a simple
periodic structure: each time period t is divided into three sub-periods, s = 1, 2, 3. We will
call them “periods,” whenever there is no risk of confusion.
    In periods 1 and 2, the consumer and the producer from each household travel to spatially
separated markets, or islands, where they interact with consumers and producers from other
households. Each island has a competitive market, as in Lucas and Prescott (1974). Trading
is characterized by anonymity, therefore the only type of trades that are feasible are spot
exchanges of goods for money. There is a continuum of islands and each island receives the same
mass of consumers and producers in both periods 1 and 2. The assignment of agents to islands
is random and satisfies a law of large numbers, so that each island receives a representative
sample of consumers and producers. The consumer and the producer from the same household
do not communicate during periods 1 and 2. However, at the end of each period, they meet
and share money holdings and information. In period 3, all consumers and producers trade in
a single centralized market.
    In period 1 of time t, the producer from household j, located in island k, has access to the



                                               4
linear technology
                                                   j
                                                  y1,t = θkt njt

where ytj is output, njt is labor eﬀort, and θkt is the island-specific productivity. The productivity
θkt is randomly drawn from a distribution with cumulative distribution function F (·) and
              £ ¤
support Θ = 0, θ . It is realized after producers and consumers have reached island k and
is observed only by the agents in the island. A law of large numbers applies, so F (·) also
represents the distribution of productivity shocks across islands. It will be useful to assume
that F (·) has an atom at 0, i.e., F (0) > 0, and is continuous on (0, θ]. For the moment, we
look at an economy with no aggregate shocks. In Section 4, we will introduce aggregate shocks
by allowing for shifts in the distribution F (·).
      In periods 2 and 3, the producer of household j has a fixed endowment of consumption
        j             j
goods, y2,t = e2 and y3,t = e3 . We will assume that the value of e3 is large, so as to ensure
that equilibrium consumption in period 3 is strictly positive for all households.
      The household’s preferences are represented by the utility function
                            "∞                                            #
                             X ³ j                 j         j        j
                                                                         ´
                          E      β t u(c1,t ) − v(nt ) + U (c2,t ) + c3,t ,
                                  t=0

where cjs,t is consumption in period (s, t) and β ∈ (0, 1) is the discount factor. The functions
u and U are increasing and strictly concave, and the function v, representing the disutility of
eﬀort, is increasing and convex. All of them have continuous first and second derivatives. A
number of other assumptions will be useful in the analysis. Both u and U satisfy standard
Inada conditions and v satisfies the condition limn→n̄ v0 (n) = ∞. The function u is bounded
below, with u (0) = 0, and there is a σ > 0 such that −u00 (c) c/u0 (c) ∈ [σ, 1) for all c ≥ 0.
Finally, the function U satisfies −U 00 (c) c/U 0 (c) ≤ 1 for all c ≥ 0. We will discuss the role of
these assumptions when they are needed in the analysis.
      The fact that in period 3 consumers and producers trade in a centralized market and
have linear utility is essential for tractability. This allows us to derive an equilibrium with a
degenerate distribution of money balances at the beginning of period (1, t), as in Lagos and
Wright (2005).3
      Finally, we need to specify the monetary regime. At the end of each period 3, the govern-
ment levies a lump-sum tax T and pays a (gross) rate of return R on the net money balances
  3
      See Shi (1997) for a diﬀerent approach to obtain a degenerate distribution of money holdings.


                                                        5
held by each household. In order to focus on equilibria with stationary nominal prices, we
focus on regimes with constant money supply M . We characterize a monetary regime using
the two parameters R and M , and set T so as to satisfy the government budget constraint

                                                             M = R (M − T ) .

In this paper, we make no attempt to explain the government’s choice of the monetary regime,
but we simply explore the eﬀect of diﬀerent regimes on equilibrium behavior.
      Notice that we allow for R S 1.4 The assumption of interest-paying money balances is a
general way of introducing a government-supplied liquid asset. In the case R > 1 the asset
resembles a nominal government bond, while in the case R < 1 it looks more like money
subject to a positive inflation tax. In Section 6.2, we discuss a number of alternative ways of
interpreting the liquid asset in our model.

2.1      First-best allocation

The first-best allocation provides a useful benchmark for the rest of the analysis. Consider a
social planner who can choose the labor eﬀort and the consumption of the households. Given
that there is no capital, there is no real intertemporal link between periods. Therefore, we can
look at a static planner problem which only includes periods s = 1, 2, 3.
      Each household is characterized by a pair (θ, θ̃), where the first element represents the
shock in the producer’s island and the second represents the one in the consumer’s island. An
allocation is given by consumption functions {cs (θ, θ̃)}s∈{1,2,3} and an eﬀort function n(θ, θ̃).
The planner chooses an allocation that maximizes the ex-ante utility of the representative
household
                Z    θ   Z   θ   ³                                                         ´
                                  u(c1 (θ, θ̃)) − v(n(θ, θ̃)) + U (c2 (θ, θ̃)) + c3 (θ, θ̃) dF (θ) dF (θ̃),
                 0       0

subject to the economy’s resource constraints. In period 1, there is one resource constraint for
each island θ5                             Z                               Z
                                                 θ                             θ
                                                     c1 (θ̃, θ)dF (θ̃) ≤           y1 (θ, θ̃)dF (θ̃),
                                             0                             0
where y1 (θ, θ̃) = θn(θ, θ̃). In period s = 2, 3, the resource constraint is
                                  Z θZ θ
                                          cs (θ, θ̃)dF (θ) dF (θ̃) ≤ es .
                                                     0   0
  4
      When R < 1, T is negative and corresponds to a lump-sum subsidy.
  5
      From now on, “island θ” is short for “an island with productivity shock θ.”


                                                                      6
The resource constraints for periods 1 and 2 reflect the assumption that each island receives a
representative sample of consumers and producers.
    The following proposition characterizes the optimal allocation.

Proposition 1 The optimal allocation in period 1 is given by n(θ, θ̃) = nF B (θ) and c1 (θ̃, θ) =
y1 (θ, θ̃) = y1F B (θ) for all (θ, θ̃) ∈ Θ2 , where y1F B (θ) and nF B (θ) satisfy
                                        ¡         ¢     ¡        ¢
                                     θu0 y1F B (θ) = v 0 nF B (θ) ,                             (1)

and y1F B (θ) = θnF B (θ), for all θ ∈ Θ. Optimal consumption in period 2 is c2 (θ, θ̃) = e2 for all
(θ, θ̃) ∈ Θ2 .

    Due to the separability of the utility function, the optimal labor eﬀort of a producer located
in island θ depends only on the productivity θ and is not aﬀected by the shock of any other
island. Furthermore, it is easy to show that output is greater in islands with larger θ. These
two results are summarized in the following lemma.

Lemma 1 The first-best level of output in island θ, y1F B (θ), is independent of the economy-
wide distribution of productivity shocks F (·). The function y1F B (θ) is increasing in θ.

    Moreover, notice that, at the optimum, c2 is constant across households, that is, households
are fully insured against the shocks θ and θ̃. Finally, given linearity, the consumption levels
in period 3 are not pinned down, as consumers are indiﬀerent among any profile c3 (θ, θ̃), with
E[c3 (θ, θ̃)] = e3 .


3     Equilibrium

We turn now to the definition and characterization of the competitive equilibrium. We con-
centrate on steady-state equilibria where prices, the allocation and the distribution of money
are independent of time. Hence, from now on we drop the time index t.
    We begin by characterizing optimal individual behavior for given prices. Money is the
numeraire, p1 (θ) denotes the price of goods in period 1 in island θ, and p2 and p3 denote
the prices in periods 2 and 3. Consider a household with an initial stock of money m at the
beginning of period 1. The consumer travels to island θ̃ and consumes c1 (θ̃). Since money



                                                     7
holdings are non-negative, his budget constraint and liquidity constraint in period 1 are

                                      m1 (θ̃) + p1 (θ̃)c1 (θ̃) ≤ m,

                                                      m1 (θ̃) ≥ 0,

where m1 (θ̃) denotes the consumer’s money holdings at the end of period 1. In the meantime,
the producer, located in island θ, produces and sells y1 (θ) = θn(θ). At the end of period 1,
the consumer and the producer get back together, and pool their money holdings. Therefore,
in period 2 the consumer’s constraints are

                           m2 (θ, θ̃) + p2 c2 (θ, θ̃) ≤ m1 (θ̃) + p1 (θ) θn(θ),

                                         m2 (θ, θ̃) ≥ 0,

where consumption, c2 (θ, θ̃), and end-of-period money holdings, m2 (θ, θ̃), are now contingent
on both shocks θ and θ̃. Finally, in period 3, the consumer and the producer are located in the
same island and the revenues p3 e3 are immediately available. Moreover, the household has to
pay the nominal tax T . The constraints are now

                       m3 (θ, θ̃) + p3 c3 (θ, θ̃) ≤ m2 (θ, θ̃) + p2 e2 + p3 e3 − T,

                                     m3 (θ, θ̃) ≥ 0.

    Let V (m) denote the expected utility of a household with nominal balances m at the
beginning of period 1, facing prices {p1 (θ)}θ∈Θ , p2 , p3 in all periods. The household’s problem
is then characterized by the Bellman equation
                                    Z θZ θ
              V (m) =        max           [u(c1 (θ̃)) − v (n (θ)) + U (c2 (θ, θ̃)) +                       (2)
                              {cs },{ms },n 0    0
                                                +c3 (θ, θ̃) + βV (Rm3 (θ, θ̃))]dF (θ)dF (θ̃),

subject to the budget constraints and liquidity constraints introduced above. The solution to
this problem gives us optimal quantities as a function of the initial money balances m, which
we denote by c1 (θ, m), c2 (θ, θ̃, m), etc.
    We are now in a position to define a steady-state competitive equilibrium, where prices,
quantities and the distribution of money balances are stationary.
                                                                      ©                     ª
Definition 1 A steady-state competitive equilibrium is given by prices {p1 (θ)}θ∈Θ , p2 , p3 ,
a distribution of money holdings with c.d.f. H (·) and support M, and an allocation {n (θ, m) ,
c1 (θ, m), c2 (θ, θ̃, m), c3 (θ, θ̃, m), m1 (θ, m) , m2 (θ, θ̃, m), m3 (θ, θ̃, m)}θ∈Θ,θ̃∈Θ,m∈M such that:

                                                       8
  (i) the allocation solves problem (2) for each m ∈ M;

 (ii) markets clear6
                           Z                                                      Z
                                   c1 (θ, m)dH (m) = θ                                    n(θ, m)dH (m) for all θ ∈ Θ,
                               M                                                      M
                           Z    Z      θ   Z   θ
                                                   cs (θ, θ̃, m)dF (θ̃)dF (θ)dH (m) = es for s = 2, 3;
                           M       0       0

(iii) the distribution H (m) satisfies
                                                   Z       Z   θ   Z
                               H (m) =                                                               dF (θ̃)dF (θ)dH (m̃) .
                                                   M       0           {m̃:Rm3 (θ,θ̃,m̃)≤m}


       Condition (iii) ensures that the distribution H (·) is stationary. As we will see below, we
can focus on equilibria where the distribution of money balances is degenerate at m = M .
Therefore, from now on we drop the argument m from the equilibrium allocations.
       In order to characterize the equilibrium behavior, it is useful to derive the household’s
first order conditions. From problem (2) we obtain the three Euler equations (with respective
complementary slackness conditions)
                                   Z
             0              p1 (θ̃) θ 0
             u (c1 (θ̃)) ≥             U (c2 (θ, θ̃))dF (θ)   (m1 (θ̃) ≥ 0) for all θ̃ ∈ Θ,                                    (3)
                              p2    0
                            p2
         U 0 (c2 (θ, θ̃)) ≥                                  (m2 (θ, θ̃) ≥ 0) for all (θ, θ̃) ∈ Θ2 ,                           (4)
                            p3
                        1 ≥ p3 βRV 0 (Rm3 (θ, θ̃))          (m3 (θ, θ̃) ≥ 0) for all (θ, θ̃) ∈ Θ2 ,                            (5)

the optimality condition for labor supply
                                                               Z       θ
                       0            p1 (θ)
                      v (n (θ)) = θ                                        U 0 (c2 (θ, θ̃))dF (θ̃)            for all θ ∈ Θ,   (6)
                                      p2                           0

and the envelope condition
                                                                            Z     θ
                                                       0                              u0 (c1 (θ̃))
                                                   V (m) =                                         dF (θ̃).                    (7)
                                                                              0         p1 (θ̃)
       Our assumptions allow us to simplify the equilibrium characterization as follows. First, the
assumption that F (·) has an atom at 0, together with the Inada condition for U , implies that
m1 (θ̃) > 0 for all θ̃. All consumers keep some positive money reserves in period 1, to insure
   6
    The market clearing conditions reflect the assumption that each island receive a representative sample of
consumers and producers. Thanks to Walras’ law we can omit the market clearing conditions for the money
market.


                                                                                      9
against the risk that their producers make zero revenues. This guarantees that condition (3)
always holds as an equality.7
       Next, condition (5) shows why we obtain equilibria with a degenerate distribution of money
balances, as in Lagos and Wright (2005). Given that the supply of money is constant at M , a
steady state equilibrium with a degenerate distribution H (·) must satisfy

                                   Rm3 (θ, θ̃) = M for all (θ, θ̃) ∈ Θ2 .

In equilibrium, all agents adjust their consumption in period 3, so as to reach the same level of
m3 , irrespective of their current shocks. This immediately implies that m3 (θ, θ̃) > 0, so that
(5) holds as an equality for all pairs (θ, θ̃). Notice that the assumptions that utility is linear
in period 3 and that e3 is large are crucial to ensure that the left-hand side of (5) is constant,
confirming that this behavior is optimal.8
       This leaves us with condition (4). In general, this condition can be either binding or slack
for diﬀerent pairs (θ, θ̃), depending on the parameters of the model. However, we are able to
give a full characterization of the equilibrium by looking at specific monetary regimes, namely,
by making assumptions about the rate of return R. First, we look at equilibria where the
liquidity constraint m2 (θ, θ̃) ≥ 0 is never binding. We will show that this case arises when
R = 1/β, that is, in a monetary regime that follows the Friedman rule. Second, we look at
equilibria where the constraint m2 (θ, θ̃) ≥ 0 is binding for all pairs (θ, θ̃). We will show that
this case arises whenever the rate of return is suﬃciently low, i.e., when R ≤ R̂, for a given
cutoﬀ R̂ ∈ (0, 1/β).
       These two polar cases provide two analytically tractable benchmarks, which illustrate well
the mechanism at the core of our model. The quantitative analysis in Section 5 also considers
the case of economies with R ∈ (R̂, 1/β), where the liquidity constraint in period 2 is binding
for a subset of agents.

3.1      Unconstrained equilibrium

We begin by considering “unconstrained equilibria,” that is, equilibria where the liquidity
constraint is never binding. In this case, condition (4) always holds as an equality. Combining
   7
    In Section 5.2 and in Appendix B, we relax the assumption F (0) > 0.
   8
    When R < 1/β, all steady-state equilibria are characterized by a degenerate distribution of money holdings.
One can show that, in this case, the value function V is strictly concave in any steady-state equilibrium. This,
together with (5) implies that m3 is constant across households.



                                                      10
conditions (3)-(5) and (7) then gives
                                                      Z     θ
                                  u0 (c1 (θ̃))                  u0 (c1 (θ))
                                               = βR                         dF (θ).                     (8)
                                    p1 (θ̃)             0         p1 (θ)

Taking expectations with respect to θ̃ on both sides, shows that a necessary condition to
obtain an unconstrained equilibrium is βR = 1. The following proposition shows that, indeed,
βR = 1 is both necessary and suﬃcient for an unconstrained equilibrium. Moreover, under
this monetary regime the equilibrium achieves an eﬃcient allocation.9

Proposition 2 An unconstrained equilibrium exists if and only if R = 1/β and achieves a
first-best allocation. In all unconstrained equilibria, the prices are

                                p1 (θ) = κu0 (y1F B (θ)) for all θ ∈ Θ,                                 (9)

                                   p2 = κU 0 (e2 ),                                                    (10)

                                   p3 = κ,                                                             (11)

for some κ ∈ (0, κ̂], where
                                                            M
                                 κ̂ ≡                                                .                 (12)
                                        u0 (y1F B (θ))y1F B (θ)     + U 0 (e2 ) e2
       To capture the logic behind the eﬃciency result, consider a consumer and a producer
located in island θ. Using condition (4) and market clearing, we can rewrite the consumer’s
Euler equation (3) as10
                                                                 p1 (θ)
                                             u0 (y1 (θ)) =              ,                              (13)
                                                                  p3
and the producer’s optimality condition (6) as
                                      µ       ¶
                                     0 y1 (θ)      p1 (θ)
                                   v            =θ        .                                            (14)
                                          θ         p3
These two equations describe, respectively, the demand and the supply of consumption goods
on island θ, as a function of the price p1 (θ). Jointly, they determine the equilibrium values of
p1 (θ) and y1 (θ).
       Conditions (13) and (14) highlight that, under the Friedman rule, a consumer and a pro-
ducer in island θ do not need to forecast the income/spending of their partners when making
   9
     See Rocheteau and Wright (2005) for a general discussion of the eﬃciency of the Friedman rule in a wide
class of search models of money.
  10
     Whenever we look at a consumer and producer located in the same island θ, the consumer’s optimality
conditions are given by (3)-(5), with the role of θ and θ̃ inverted.


                                                       11
their trading decisions, given that their marginal value of money is constant and equal to 1/p3 .
This implies that trading in island θ is essentially independent of trading decisions in all other
islands. We will see that this is no longer true when we move to a constrained equilibrium.
Conditions (13) and (14) can be easily manipulated to obtain the planner’s first order condi-
tion (1).
       It is possible to prove that the unconstrained equilibrium allocation is unique, but the
price levels are indeterminate, since κ in (9)-(11) can be anywhere in the interval (0, κ̂].11
This implies that the real value of the money supply M is indeterminate. However, the upper
bound κ̂ determines a lower bound for the real value of M . In particular, given our focus
on the liquidity constraint in period 2, we derive explicitly the upper bound for M/p2 in the
following corollary.

Corollary 1 In an unconstrained equilibrium M/p2 satisfies
                                       M         u0 (y1F B (θ))
                                          ≥ e2 +                y1 (θ).                                 (15)
                                       p2           U 0 (e2 )
       The fact that real value of money is large in period 2 ensures that all households can aﬀord
to consume c2 (θ, θ̃) = e2 , irrespective of the shocks θ and θ̃, thus achieving full insurance.

3.2      Fully constrained equilibrium

We now turn to the case where the liquidity constraint is always binding in period 2, that is,
m2 (θ, θ̃) = 0 for all pairs (θ, θ̃). The following proposition shows that this type of equilibrium
arises when R is suﬃciently low. We refer to it as a “fully constrained equilibrium.”

Proposition 3 There is a cutoﬀ R̂ ∈ (0, 1/β) such that a fully constrained equilibrium exists
if and only if R ≤ R̂.

       Let us illustrate the main steps of the equilibrium construction. Combining the consumer’s
budget constraints in periods 1 and 2 gives
                                             M    p1 (θ̃)           p1 (θ)
                              c2 (θ, θ̃) =      −         c1 (θ̃) +        y1 (θ) ,                     (16)
                                             p2    p2                 p2
where we use the fact that all agents begin period 1 with m = M and end period 2 with
m2 (θ, θ̃) = 0. Notice that now households are not fully insured and their consumption in
period 2 depends both on the consumer’s and on the producer’s shock in period 1.
  11
     This indeterminacy can be eliminated using a “fiscal rule” under which the government commits to set the
real value of the lump sum tax T /p3 .


                                                        12
    Integrating both sides of (16) over θ and θ̃, and using market clearing in periods 1 and 2,
we obtain a simple “quantity-theory” equation

                                                       p2 e2 = M.                                    (17)

It is easy to show that in any equilibrium the choice of M only aﬀects nominal variables, but
has no real eﬀect. Therefore, we choose the convenient normalization M = e2 , which, in a fully
constrained equilibrium, implies p2 = 1.
    As in the unconstrained case, let us focus on a consumer and a producer in island θ. The
previous steps imply that we can rewrite the consumer’s Euler equation (3) as
                                          Z   θ      ³                                   ´
                   u0 (y1 (θ)) = p1 (θ)           U 0 e2 − p1 (θ) y1 (θ) + p1 (θ̃)y1 (θ̃) dF (θ̃),   (18)
                                          0

and the producer’s optimality condition (6) as
               µ       ¶           Z θ ³                                   ´
              0 y1 (θ)                  0
            v            = θp1 (θ)    U e2 − p1 (θ̃)y1 (θ̃) + p1 (θ) y1 (θ) dF (θ̃).                 (19)
                   θ                0

The demand and supply equations (18) and (19) correspond to (13) and (14) in the uncon-
strained case and show that the equilibrium values of p1 (θ) and y1 (θ) are now dependent
on prices and quantities in all other islands. This highlights the “linkages” between trading
decisions in island θ and trading decisions in other islands, which arise when liquidity con-
straints are binding in period 2. In this case, consumers and producers need to forecast the
level of trading in other islands to evaluate their expected marginal value of money, and thus
their willingness to trade at each price p1 (θ). These linkages will play a crucial role when we
introduce aggregate shocks in the next section.
    Equations (18) and (19) define two functional equations in p1 (·) and y1 (·). In the proof
of Proposition 3, we show that this pair of functional equations has a unique solution. To
do so, we define x(θ) ≡ p1 (θ)y1 (θ) and we analyze a fixed point problem in terms of the
function x (·). The fixed point is found using a contraction mapping argument. Here we make
use of the assumption that the elasticity of u0 (c) is bounded in [σ, 1). Proposition 3 can be
proved under weaker conditions, using a diﬀerent type of fixed point theorem. However, the
contraction mapping approach laid out here will be essential in deriving our amplification result
in Section 4. An interesting corollary of Proposition 3 is that the fully constrained equilibrium
allocation is the same for all R ≤ R̂. The only equilibrium variable that changes with R is the
price level p3 .

                                                            13
   The following lemma establishes two monotonicity results for real and nominal income in
period 1, which will be useful in studying the eﬀects of aggregate shocks.

Lemma 2 In a fully constrained equilibrium, both y1 (θ) and p1 (θ)y1 (θ) are monotone increas-
ing in θ.

   Finally, comparing (15) and (17) shows that real money supply in period 2 is smaller in
the fully constrained equilibrium than in any unconstrained equilibrium. The intuition behind
this result is that a lower rate of return on money reduces agents’ incentive to save. This tends
to increase nominal prices and reduces the equilibrium value of real money balances. This
result also explains why we label the monetary regime with R ≤ R̂ as one of “scarce liquidity,”
and the Friedman rule regime as one of “abundant liquidity.” We will return to this issue in
Section 6.2.

3.3   Liquidity premium

Let us extend our model by introducing an illiquid asset in zero net supply. This simple
extension allows us to define a liquidity premium. The illiquid asset is traded at the beginning
of period 1, before the idiosyncratic shocks θ are realized, and it represents a claim to 1 unit
of money in period 3. It is illiquid in the sense that it cannot be carried by consumers to the
islands they visit in periods 1 and 2. Denote by q its price in terms of money (the numeraire).
Households choose illiquid asset holdings b at the beginning of period 1 and their budget
constraints in periods 1 and 3 become

                       m1 (θ̃) + p1 (θ̃)c1 (θ̃) ≤ m − qb,

                   m3 (θ, θ̃) + p3 c3 (θ, θ̃) ≤ m2 (θ, θ̃) + p2 e2 + p3 e3 + b − T,

while the budget constraint in period 2 is unaﬀected. The optimality condition for b can be
written as             Z                                    Z       Z
                            θ                                   θ       θ
                                u0 (c1 (θ̃))
                   q                         dF (θ̃) = βR                   V 0 (Rm3 ) dF (θ)dF (θ̃).
                        0         p1 (θ̃)                   0       0

Combining it with the envelope condition (7), we obtain

                                                      q = βR.                                           (20)

Since the illiquid asset is in zero net supply, the equilibrium analysis is unchanged.


                                                            14
    Notice that the gross nominal return on money between periods 1 and 3 is 1, while that
on the illiquid asset is equal to 1/q. Hence, 1/q − 1 represents the liquidity premium in our
economy. It follows from (20) that, under the Friedman rule, q = 1 and the liquidity premium
is zero. In this case, the return on the illiquid asset is exactly the same as that of the liquid
asset because agents are perfectly insured. Whenever R < 1/β, the liquidity premium is
positive. In particular, in a fully constrained economy, the liquidity premium is above some
cutoﬀ 1/(β R̂) − 1. Agents are all liquidity constrained in period 2 and are willing to pay a
lower price for the illiquid asset, because they are concerned about consumption volatility in
period 2, when the illiquid asset cannot be used.


4     Aggregate Shocks

We now turn to the main question of the paper: how does output respond to aggregate shocks
when liquidity is scarce or abundant? In this section, we compare analytically the eﬀect of
an aggregate shock in the unconstrained and fully constrained regimes derived above and we
identify an amplification mechanism which is only present in the fully constrained case. In
the next section, we will present numerical examples in order to evaluate the quantitative
significance of the amplification eﬀect and to study the intermediate cases with R ∈ (R̂, 1/β).

4.1   A decomposition

First, we introduce aggregate uncertainty in the model by introducing an aggregate shock ζ t ,
which is realized and publicly revealed at the beginning of each period. We assume that ζ t is
i.i.d. with cumulative distribution function G(·) continuous on the support [ζ, ζ]. Conditional
on ζ t , the cross-sectional distribution of the productivity shocks θkt is F (·|ζ t ). Assume that
F (θ|ζ) is continuous and non-increasing in ζ, for each θ. This implies that a distribution with
a higher ζ first-order stochastically dominates a distribution with lower ζ.
    We assume i.i.d. aggregate shocks and we focus on simple stationary equilibria, defined
along the lines of Definition 1, where the distribution of money balances at the beginning of
period 1 is degenerate. Prices and allocations now depend not only on the current idiosyncratic
shocks, but also on the current aggregate shock ζ, and are denoted by p1 (θ, ζ), c1 (θ, ζ), etc.
In Appendix B we present the characterization of the equilibrium with aggregate shocks. In
particular, both propositions 2 and 3 are easily extended to this case. The only noticeable



                                                15
diﬀerence is that the definition of the cutoﬀ R̂ needs to be modified so as to ensure that in a
fully constrained equilibrium agents are constrained for all realizations of ζ.
   Given that output in periods 2 and 3 is exogenous, we focus on aggregate output in period 1,
which is equal to
                                               Z      θ
                                  Y1 (ζ) ≡                y1 (θ, ζ) dF (θ|ζ) .                       (21)
                                                  0
In particular, we look at the proportional response of output to a small aggregate shock,
d ln Y1 /dζ. This measure can be decomposed as follows
                                  Rθ                                 Rθ
                      d ln Y1     0    y1 (θ, ζ) ∂f∂ζ
                                                   (θ|ζ)
                                                         dθ           0
                                                                          ∂y1 (θ,ζ)
                                                                            ∂ζ      dF   (θ|ζ)
                              =                                  +                               .   (22)
                         dζ                  Y1                                  Y1

The first member on the right-hand side represents the mechanical eﬀect of having a larger
number of islands with high productivity. This eﬀect is positive both in the unconstrained and
in the fully constrained economy, given that output is increasing in θ in both regimes as shown
by Lemmas 1 and 2. We call this the “own-productivity eﬀect.” The second member captures
the endogenous response of output for each given level of θ, and is at the core of our analysis.
We call it the “expected income eﬀect,” for reasons that will be apparent below.

4.2   The expected income eﬀect

Consider first an unconstrained equilibrium. In this case, the economy achieves the first-best
allocation and, as we know from Lemma 1, output in island θ is independent of the economy-
wide distribution of productivity. Therefore, ∂y1 (θ, ζ) /∂ζ = 0 and the expected income eﬀect
is absent.
   Next, consider the case of a fully constrained equilibrium. The following proposition shows
that, in this case, output in each island is increasing in ζ, for any given realization of the local
productivity shock θ. This implies that the expected income eﬀect is positive.

Proposition 4 Consider a fully constrained equilibrium of the economy with aggregate shocks.
For each θ > 0, the output y1 (θ, ζ) is increasing in ζ.

   To understand the mechanism behind this eﬀect, it is useful to consider the following
partial equilibrium exercise. Let us focus on island θ and take as given p1 (θ̃, ζ) and y1 (θ̃, ζ)
for all θ̃ 6= θ. Rewriting the demand and supply equations (18) and (19) for the economy with



                                                           16
aggregate shocks gives
                                                                Z    θ
                                  0
                                 u (y1 (θ, ζ)) = p1 (θ, ζ)               U 0 (c2 (θ̃, θ, ζ))dF (θ̃|ζ),        (23)
                                                                 0
                                 µ                ¶                  Z    θ
                             0        y1 (θ, ζ)
                         v                            = θp1 (θ, ζ)            U 0 (c2 (θ, θ̃, ζ))dF (θ̃|ζ),   (24)
                                          θ                           0
where
                         c2 (θ̃, θ, ζ) = e2 − p1 (θ, ζ) y1 (θ, ζ) + p1 (θ̃, ζ)y1 (θ̃, ζ),

and the symmetric expression holds for c2 (θ̃, θ, ζ). Lemma 2 shows that p1 (θ, ζ) y1 (θ, ζ) is an
increasing function of θ. It follows that U 0 (c2 (θ̃, θ; ζ)) is decreasing in θ̃, while U 0 (c2 (θ, θ̃; ζ)) is
increasing in θ̃. Hence, when ζ increases the integral on the right-hand side of (23) decreases,
while the integral on the right-hand side of (24) increases.12 On the demand side, the intuition
is that when a liquidity constrained consumer expects higher income from his partner, his
marginal value of money decreases. Then, he reduces his reserves and increases consumption
for any given price p1 (θ). On the supply side, when a producer expects higher spending by his
partner, he faces a negative income eﬀect and, hence produces more for any given p1 (θ). The
first eﬀect shifts the demand curve to the right, the second shifts the supply curve to the right.
The combination of the two implies that equilibrium output in island θ increases.
       On top of this partial equilibrium mechanism, there is a general equilibrium feed-back due
to the endogenous response of prices and quantities in the islands θ̃ 6= θ. This magnifies the
initial eﬀect. As the nominal value of output in all other islands increases, there is a further
increase in the marginal value of money for the consumers and a further decrease for the
producers, leading to an additional increase in output.
       Summing up, the mechanism identified in Proposition 4 tends to magnify the output re-
sponse to aggregate shocks in a fully constrained economy. This amplification eﬀect is driven
by the agents’ expectations regarding nominal income in other islands.
       Notice that the proof of Proposition 4 is the only place where we use the assumption that
the elasticity of U 0 (c) is smaller or equal than 1. In particular, this condition is suﬃcient to
establish that the labor supply in each island is positively sloped, which, in turns, is suﬃcient
to obtain our result. When we turn to numerical examples, we will see that the result survives
for elasticities larger than 1.
  12
   Recall that an increase in ζ leads to a shift of the distribution of θ in the sense of first order stochastic
dominance.


                                                                 17
   Going back to equation (22), we have established that the expected income eﬀect is zero
in the unconstrained case and positive in the constrained one. However, this is not suﬃcient
to establish that output volatility is greater in the constrained economy, since we have not yet
compared the relative magnitude of the own-productivity eﬀects, which are positive in both
cases. A special example where the comparison is unambiguous is the case of a binary shock
for θ, where the own-productivity eﬀect is identical in the two cases.
   Let θ have a binary distribution on {0, θ}. Let ζ ∈ [0, 1] represent the probability of the
high realization θ. In this case, the output response to a positive aggregate shock is always
higher when liquidity is scarce.

Lemma 3 When θ has a binary distribution on {0, θ} the response of output to the aggregate
shock ζ, d ln Y1 /dζ, is greater in a fully constrained equilibrium relative to an unconstrained
equilibrium.

   Consider first an unconstrained equilibrium and let y U
                                                         1 denote output in island θ. Output

is zero in the island where θ = 0. Moreover, from Lemma 1 we know that y U is independent
of ζ. Therefore, aggregate output is equal to Y1 (ζ) = ζy U , and

                                         d ln Y1 (ζ)  1
                                                     = .                                   (25)
                                             dζ       ζ

Next, consider a fully constrained equilibrium and let y C
                                                         1 (ζ) denote output in island θ. Aggre-

gate output is now equal to Y1 (ζ) = ζy C
                                        1 (ζ) and we have

                                   d ln Y1 (ζ)  1 d ln yC
                                                        1 (ζ)
                                               = +            .                            (26)
                                       dζ       ζ     dζ

The second element on the right-hand side of (26) is positive by Proposition 4. Therefore,
comparing (25) and (26) immediately shows that the output response is larger in the fully
constrained economy.
   Apart from specific examples, it is generally diﬃcult to compare the relative size of the
own-productivity eﬀect in the two regimes. In fact, it is possible to construct examples where
this eﬀect is larger in the unconstrained economy and where it is strong enough to dominate
the expected income eﬀect. Therefore, to evaluate the significance of the mechanism identified
in Proposition 4, we turn to a basic quantitative exercise.




                                               18
5         Numerical Examples

In this section, we present some numerical examples that show that, under reasonable para-
metrizations, the amplification eﬀect identified above is sizeable and leads to higher volatility
in economies with lower supply of liquid assets. To compute these examples, we generalize
our theory to monetary regimes with R ∈ (R̂, 1/β), where the liquidity constraint is binding
for a subset of realizations (θ, θ̃). The characterization of the equilibrium for this intermediate
region is in Appendix B.

5.1         Parameters

We interpret each sequence of three sub-periods as a year, and set the discount factor β equal
to 0.96. The instantaneous utility functions in periods 1 and 2 are u (c) = c1−σ1 / (1 − σ 1 )
and U (c) = c1−σ2 / (1 − σ 2 ). The disutility of labor eﬀort is linear, v (n) = n. The island
specific shock θ has a discrete uniform distribution, with 10 equally spaced realizations on the
interval [0, θ].
         Given isoelastic preferences, it is possible to show that if θ, e2 , and e3 are scaled by appro-
priate factors, one obtains equilibria which are equivalent in terms of all the measures we will
look at (output volatility, nominal incomes, etc). Therefore, we normalize e2 = 1.
         The coeﬃcient of relative risk aversion σ 2 is set equal to 1. The parameters σ 1 and e3
are chosen to obtain a realistic economy-wide demand for the liquid asset. In particular,
we interpret the liquid asset in a narrow sense as money balances (M1, i.e., currency and
demand deposits) and match the empirical relation between money velocity and the nominal
interest rate. This approach makes our simple calibration comparable to those in Lagos and
Wright (2005) and Craig and Rocheteau (2007), which, in turns, follow Lucas (2000). In the
data, money velocity is defined as the ratio of M1 to nominal GDP and the nominal interest
rate is measured by the short-term commercial paper rate. In the model, money velocity is
                ³R                                   ´
                   θ
measured as M/ 0 p1 (θ) y1 (θ) dF (θ) + p2 e2 + p3 e3 .13 To derive the nominal interest rate
in the model, we use a result derived in Section 6.2, which shows that our model is equivalent
to a model with non-interest-bearing money, where money growth and inflation are constant
and equal to γ. In that setup, the real rate of return on money balances is equal to R = 1/γ,
the inverse of the inflation rate, and the real rate of return on the illiquid asset (treasury
    13
         For simplicity, we calibrate parameters using the model with no aggregate shock.



                                                          19
                                      0.5


                                     0.45


                                      0.4


                                     0.35
                    money velocity

                                      0.3


                                     0.25


                                      0.2


                                     0.15


                                      0.1
                                            0   0.02   0.04   0.06     0.08       0.1   0.12   0.14   0.16
                                                               nominal interest rate




                                     Figure 1: Money velocity and nominal interest rates


bills) is equal to 1/β. Therefore, the nominal interest rate is equal to 1 + i = γ/β = (βR)−1 .
This shows that the Friedman rule regime corresponds, as it should, to i = 0, while a fully
constrained regime corresponds to i > ı̂, where ı̂ = (β R̂)−1 − 1.14
    Finally, the value of θ is chosen so that average nominal income is equal in periods 1 and
           Rθ
2, that is, 0 p1 (θ)y1 (θ)dF (θ) = p2 e2 , in a baseline scenario where the nominal interest rate is
i = 5%. The parameters we obtain are σ 1 = 0.294, e3 = 9.021, and θ = 1.904. Figure 1 shows
the relation between money velocity and the nominal interest rate in the data (scatter plot)
and in the model (solid line).

5.2    Amplification

We can now illustrate the main result of the paper, by looking at the eﬀect of aggregate shocks
in economies with diﬀerent levels of i (or R). We consider a positive aggregate shock that
reduces the probability of θ = 0 by 0.009 and increases proportionally the probability of all
positive realizations of θ. If we interpret θ = 0 as an unemployment state, this shock reduces its
probability from 0.10 to 0.091. The size of the aggregate shock is chosen so that it increases Y1
  14
     For each value of i in the empirical time-series, we evaluate the equilibrium value of money velocity. We
choose σ1 and e3 to minimize the quadratic distance between money velocity in the data and the model-generated
series. We use US annual data for the sample period 1900-2000, as in Lucas (2000).



                                                                      20
                       0.035


                        0.03


                       0.025
                                                               Fully constrained equilibrium

                        0.02
                 ∆Y1
                  Y1
                       0.015


                        0.01


                       0.005        Friedman Rule



                          0
                               0   0.2      0.4      0.6      0.8         1          1.2       1.4
                                                    i = 1/(βR) − 1



                   Figure 2: The aggregate output response in diﬀerent regimes


by 1% under the Friedman rule. The equilibrium is computed assuming that the two aggregate
shocks have equal probability.
       Figure 2 shows the proportional response of Y1 for diﬀerent levels of the nominal interest
rate i. Notice that the output response is about three times larger in the fully constrained
economy, that is, when i ≥ ı̂ (R ≤ R̂), relative to the Friedman rule regime, where i = 0
(R = 1/β). In the parametrization presented, the fully constrained regime is achieved for high
levels of i, around 90%–basically an hyperinflation scenario. However, a sizeable amplification
eﬀect is also present for moderate inflation rates. For example, when the nominal interest rate
is 15% the output response is more than 40% larger than under the Friedman rule.
       Figure 3 illustrates the expected income eﬀect identified in Proposition 4. The two panels
illustrate how output varies across islands in the two polar regimes. Under the Friedman rule,
in panel (a), output per island is independent of the aggregate shock, since the expected income
eﬀect is absent. In the fully constrained regime, in panel (b), the output of each island θ is
greater after a high aggregate shock.15
       We can then perform some simple comparative statics exercises. In particular, we look at
  15
     To make the figure easier to read, we consider here a bigger aggregate shock, which reduces the probability
of θ = 0 by 0.09 (which generates a 10% output response in the Friedman rule regime).




                                                       21
                                   (a) Friedman rule                          (b) Fully constrained equilibrium
                 10                                                 1.4
                                                                                       low shock
                                                                    1.2                high shock
                 8
                                                                     1

                 6
            y1                                                    y10.8

                                                                    0.6
                 4

                                                                    0.4
                 2
                                                                    0.2


                 0                                                   0
                      0      0.5           1           1.5   2            0      0.5          1         1.5       2
                                          θ                                                   θ



                          Figure 3: Island-specific output and local productivity shocks


the eﬀect of changing σ 1 and σ 2 on equilibrium volatility. Figure 4 shows the proportional
output response for diﬀerent values of these parameters, plotted against the nominal interest
rate i. Panel (a) shows that economies with σ 1 closer to 1, display smaller aggregate volatility.
To understand the mechanism behind this figure, notice that the coeﬃcient σ 1 determines
the elasticity of demand for local goods in island θ. When σ 1 is closer to 1, diﬀerences in
productivity θ have a smaller eﬀect on nominal income, p1 (θ)y1 (θ), since changes in output
are compensated by close to proportional changes in prices.16 This reduces nominal income
volatility across islands, dampening the strength of the expected income eﬀect. The eﬀects of
changing σ 2 are shown in panel (b). Increasing agents’ risk aversion in period 2 strengthens
the agents’ self-insurance motive, thus magnifying the expected income eﬀect. Therefore, for
higher values of σ 2 , the amplification is more pronounced.17
       As a further exercise, let us relax the assumption that the distribution of θ has positive
mass at zero. That assumption was made to ensure that money holdings are always positive
at the end of period 1, m1 (θ) > 0 for all θ, so that we could focus our attention on the role of
the liquidity constraint in period 2. Consider now the case where the realizations of θ lie in the
         £ ¤
interval θ, θ , with θ > 0. The equilibrium characterization for this general case is discussed
in Appendix B. In particular, suppose θ is still a discrete uniform (with 10 realizations), but
  16
     The presence of a positive mass of islands with θ = 0, means that some degree of income volatility is present
even in the limit case σ 1 = 1.
  17
     The example with σ2 = 2 shows that the assumption σ2 ≤ 1 is not necessary for our amplification result.
In fact, amplification is stronger for larger values of σ2 .


                                                             22
                                                (a)
                  0.04


                  0.03                                            σ 1=0.3
            ∆Y1
             Y1                                                  σ 1=0.7
                  0.02


                                                                 σ 1=0.9
                  0.01


                    0
                         0   0.2   0.4    0.6          0.8   1         1.2         1.4
                                         i = 1/(βR) − 1
                                                 (b)
                  0.04
                                                                           σ 2=2

                  0.03                                                 σ 2=1
            ∆Y1
             Y1                                                      σ 2=0.5
                  0.02


                  0.01


                    0
                         0   0.2   0.4    0.6          0.8   1         1.2         1.4
                                         i = 1/(βR) − 1



Figure 4: Comparative statics: the output response for diﬀerent values of σ 1 and σ 2




                                                23
                     0.3



                    0.25



                     0.2
              ∆Y1
               Y1
                    0.15



                     0.1



                    0.05



                      0
                           0   0.1     0.2     0.3      0.4        0.5   0.6     0.7     0.8
                                                  i = 1/(βR) − 1



            Figure 5: Output response with binding liquidity constraints in period 1


θ = 0.25. The remaining parameters and the form of the aggregate shock are unchanged.
Figure 5 plots the output response to a positive aggregate shock in this case. Amplification
is still present for all i > 0. The possibility of a binding liquidity constraint in period 1
generates an interesting non-monotonicity in the relation between the monetary regime and
output volatility. For low levels of i, the liquidity constraint in period 1 is not binding, and
our eﬀect generates amplification as in the benchmark case. However, when i is high enough,
around 12%, the period 1 liquidity constraint starts to bind for consumers in islands with high
productivity. This dampens the response of consumption, since some consumers are eﬀectively
against a cash-in-advance constraint, reducing the amplification eﬀect. As in the baseline
model, there is a cutoﬀ ı̂, around 65%, above which changes in i have no further eﬀect on the
real allocation. At this point, there is still a sizable degree of amplification.18

5.3    Countercyclical liquidity premia

Next, let us look at the response of the liquidity premium to aggregate shocks. Our numerical
example shows an interesting additional implication of the model: the same mechanism behind
  18
    In the example presented, for i ≥ ı̂, 40% of the consumers are constrained in period 1. It is also possible
to construct examples where, for suﬃciently high values of i, all consumers are constrained in period 1. In that
case, the amplification eﬀect disappears as i becomes high enough.



                                                      24
the amplification result tends to make the liquidity premium countercyclical.
       Let us go back to the extended version of the model presented in Section 3.3, where we
introduced an illiquid asset, in zero net supply. Let us assume that the illiquid asset is traded
after the realization of ζ.19 Therefore, the price of the illiquid asset is a function of ζ. By
combining the appropriate optimality and envelope conditions, we obtain
                                                            Rζ Rθ      u0 (y1 (θ,ζ̃))
                                                    βR        ζ    0     p1 (θ,ζ̃)
                                                                                      dF (θ|ζ̃)dg(ζ̃)
                                          q (ζ) =                 Rθ                                          .                                    (27)
                                                                    u0 (y1 (θ,ζ))
                                                                  0   p1 (θ,ζ) dF (θ|ζ)

Consider first an unconstrained economy. An immediate extension of equation (8) shows that
q (ζ) = 1, as in the case of no aggregate shocks. Therefore, the liquidity premium is zero and is
independent of ζ. In a fully constrained economy, combining the consumers’ Euler equations
in the three periods and the envelope condition, we get
                          Z     θ                                       Z     ζ   Z   θ
                                    u0 (c(θ, ζ))                                          u0 (c(θ, ζ̃))
                                                 dF (θ|ζ) > βR                                          dF (θ|ζ)dg(ζ̃).
                            0        p1 (θ, ζ)                            ζ       0        p1 (θ, ζ̃)

This implies that the liquidity premium 1/q (ζ) − 1 is always positive and, in general, varies
with ζ. It is interesting to explore whether we can say anything about the correlation of the
liquidity premium and the aggregate shock.
       Figure 6 plots the liquidity premium conditional on the two aggregate shocks, for diﬀerent
values of i, and shows that the liquidity premium is countercyclical in our example.20 To
understand the underlying mechanism, notice that the liquidity premium is countercyclical
whenever the derivative of 1/q (ζ) with respect to ζ is negative. Given (27), this is equivalent
    hR 0                      i
      θ
to d 0 u p(y11(θ,ζ)
               (θ,ζ))
                      dF (θ|ζ) /dζ < 0. A useful decomposition is then:

        "Z                                   #                                                                    ³                   ´
                                                 Z                                                   Z                u0 (y1 (θ,ζ))
  d           θ
                  u0 (y1 (θ, ζ))                        θ
                                                            u0 (y1 (θ, ζ)) ∂f (θ|ζ)                       θ   ∂         p1 (θ,ζ)
                                    dF (θ|ζ) =                                                dθ +                                        dF (θ|ζ). (28)
  dζ      0         p1 (θ, ζ)                       0         p1 (θ, ζ)               ∂ζ              0                  ∂ζ

When ζ increases, there are two eﬀects on the liquidity premium, related to the two eﬀects
on aggregate output analyzed in Section 4. On the one hand, there is an “own-productivity
eﬀect,” represented by the first term of (28), that tends to increase the liquidity premium.
If there are more islands with higher productivity, there will be more trade on average and
  19
     It is easy to show that if we allow agents to trade the illiquid asset before the realization of ζ its price would
be equal to βR.
  20
     As for Figure 3, we consider here a larger aggregate shock (which reduces the probability of θ = 0 by 0.09),
to make the figure easier to read.


                                                                         25
                                         0.8
                                                          low shock
                                                          high shock
                                         0.7
                                                          expected income effect

                                         0.6



                     liquidity premium
                                         0.5


                                         0.4


                                         0.3


                                         0.2


                                         0.1


                                          0
                                               0   0.1      0.2     0.3     0.4    0.5   0.6   0.7   0.8
                                                                     i = 1/(βR) − 1



                                                         Figure 6: Liquidity premium


agents will need more liquid assets. On the other hand, there is an “expected income” eﬀect,
represented by the second term of (28). In a given island θ, consumers expect higher income
and reduce their demand for liquidity. This increases consumption and reduces their marginal
utility in period 1, driving down the liquidity premium. Notice that the prices p1 (θ, ζ) are
also adjusting when ζ changes, which makes it hard to derive unambiguous analytical results.
However, for all the parameter combinations we have tried, this second eﬀect is positive. In
Figure 6, this eﬀect is illustrated by the dotted line labeled “expected income eﬀect,” and is
suﬃciently strong so as to generate a countercyclical liquidity premium.


6     Extensions
6.1   News shocks

Consider now an economy where the aggregate shock ζ is not observed by the households in
period 1. Instead, they all observe a public signal ξ ∈ [ξ, ξ], which is drawn at the beginning
of each period, together with the aggregate shock ζ, from a continuous distribution with joint
density function g (ζ, ξ).
    Take an agent located in an island with productivity θ, his posterior density regarding ζ



                                                                           26
can be derived using Bayes’ rule:

                                                    f (θ|ζ) g (ζ, ξ)
                                    g (ζ|ξ, θ) = R                        .
                                                   ζ
                                                  ζ  f (θ| ζ̃)g(ζ̃, ξ)dζ̃

The distribution g (ζ|ξ, θ) is then used to derive the agent’s posterior beliefs regarding θ̃ in the
island where his partner is located
                                                  Z   ζ
                                  F (θ̃|ξ, θ) =               F (θ̃|ζ)g (ζ|ξ, θ) dζ.
                                                  ζ


We will make the assumption that F (θ̃|ξ, θ) is non-decreasing in ξ, for any pair (θ, θ̃). This
means, that conditional on θ, the signal ξ is “good news” for θ̃, in the sense of Milgrom (1981).
We also make the natural assumption that F (θ̃|ξ, θ) is non-decreasing in θ. In period 2, the
actual shock ζ is publicly revealed.
       In this environment, we study a stationary equilibrium, along the lines of Definition 1, where
the distribution of money holdings at the beginning of period 1 is degenerate and prices and
allocations depend on idiosyncratic shocks and on the aggregate shocks ξ and ζ. In particular,
prices and quantities in period 1, p1 (θ, ξ) and y1 (θ, ξ), depend only on θ and ξ, given that ζ
is not in the information set of the households in that period. Aggregate output in period 1
becomes                                           Z       θ
                                   Y1 (ζ, ξ) ≡                y1 (θ, ξ) dF (θ|ζ) .                  (29)
                                                      0
We can now look separately at the output response to the productivity shock ζ and to the
news shock ξ. In particular, next proposition shows that the output response to ζ is positive
both in an unconstrained and in a fully constrained equilibrium, while the output response to
the signal ξ is positive only in the fully constrained case.21

Proposition 5 Consider the economy with imperfect information regarding the aggregate shock.
In an unconstrained equilibrium ∂Y1 (ζ, ξ)/∂ζ > 0 and ∂Y1 (ζ, ξ)/∂ξ = 0. In a fully constrained
equilibrium ∂Y1 (ζ, ξ)/∂ζ > 0 and ∂Y1 (ζ, ξ)/∂ξ > 0.

       This result is not surprising, in light of the analysis in the previous section. Compare
the expression for aggregate output under imperfect information (29) with the correspondent
expression in the case of full information (21). By definition, the productivity shock ζ aﬀects
  21
   The analysis in Appendix B can be easily extended to the case of the economy with aggregate shocks and
imperfect information.


                                                              27
the distribution of idiosyncratic shocks F (·|ζ) in both cases. However, the trading decisions
in island θ are aﬀected only by the agents’ expectations about that distribution, which, in
the case of imperfect information, are driven by the signal ξ. It follows that the eﬀect of ζ
is analogous to the own-productivity eﬀect, while the eﬀect of ξ is analogous to the expected
income eﬀect. The advantage of an environment with imperfect information, is that these two
eﬀects can be disentangled. In particular, our amplification mechanism is captured by the
output response to ξ. When liquidity is abundant, as we know from Proposition 1, output in
island θ is independent of the economy-wide distribution of productivity and does not respond
to ξ. The result that the output response to ξ is positive when liquidity is scarce is a natural
extension of Proposition 4. In island θ, trading is higher the more optimistic agents are about
trading in all other islands. The only diﬀerence is how expectations are formed. The perceived
distribution of productivities for an agent in island θ depends now on the signal ξ, instead
that on the actual ζ. A positive signal ξ makes both consumers and producers in island θ
more optimistic about trading in other islands, even if the underlying ζ is unchanged. This
highlights that expectations are at the core of our amplification result.

6.2      Alternative sources of liquidity

There are several alternative ways of introducing a liquid asset in our environment, which lead
to formally equivalent models. A sketch of these diﬀerent approaches can help the interpreta-
tion of our results.
   Constant money growth. Assume that money pays no interest, and there is a constant
money growth rate γ, that is,
                                         Mt+1 = γMt .

Monetary injections take place at the end of period 3, and the government budget constraint
is now
                                       Mt+1 = Mt − Tt ,

where the lump-sum tax/subsidy Tt is time-varying. It is possible to prove that this economy
is formally equivalent, in real terms, to our baseline economy. More specifically, given an
equilibrium of the economy with interest-bearing notes, there exists an economy with constant
money growth that achieves the same equilibrium allocation in real terms. The converse also
applies. The argument for this result goes as follows. Take an equilibrium of the baseline


                                               28
economy, with rate of return R, and equilibrium prices p1 (θ), p2 , p3 . In an economy with
constant money growth γ = R−1 , we can construct an equilibrium with an identical allocation
in terms of consumption and labor supply, where the prices are time-varying and equal to
p̃1,t (θ) = γ t p1 (θ), p̃2,t = γ t p2 , and p̃3,t = γ t p3 . In Appendix C, we provide further details on
how this equilibrium is constructed. Here, we just remark that the inflation rate between any
pair of periods (s, t) and (s, t + 1) is equal to γ, so that the real rate of return on money is
equal to 1/γ and thus, by construction, to R.
    Lucas trees. Consider an economy with a fixed endowment of “trees,” as in Lucas (1978),
paying a constant real dividend d > 0 in every period 3. The total supply of trees is normalized
to 1. In this case, we can derive an equivalence result with the baseline economy by restricting
R to the interval (0, 1/β]. Consider an equilibrium of the economy with interest-bearing notes.
Then, there is an equivalent Lucas tree economy where d is equal to the real value of the
tax in period 3, T /p3 , and the household’s endowment in period 3 is equal to e3 − d. In
the corresponding equilibrium, consumption and labor supply are identical and the price of
trees in terms of consumption goods are given by Q1 (θ) = M/p1 (θ), Q2 = M/p2 and Q3 =
(M − T ) /p3 . Note that the rate of return of the trees between periods (3, t) and (3, t + 1) is
                                          Q3 + d    M
                                                 =      ,
                                           Q3      M −T
which, by construction, is equal to R. Appendix C describes in detail the equilibrium allocation.
    In the Lucas tree version of our model, the analogues of Propositions 2 and 3 can be stated
as follows.

Proposition 6 In the Lucas tree economy, there exist two cutoﬀs dC and dU , with dC < dU ,
such that if d ≥ dU there exists an unconstrained equilibrium and if d ≤ dC there exists a fully
constrained equilibrium.

    This result gives an additional reason for labeling our two polar cases as “abundant” and
“scarce” liquidity. The unconstrained equilibrium arises when the supply of the real asset,
captured by the dividend d, is large, and the fully constrained equilibrium arises in the opposite
case. Notice that, given the model parameters, it is possible that dC ≤ 0. In this case, no
Lucas tree economy achieves a fully constrained equilibrium, given that d > 0. Whether dC is
positive or negative depends on whether R̂ is greater or smaller than 1, and, in general, both
cases are possible.

                                                   29
         There is a common element among the various approaches considered: the real value of
the flow of transfers associated to the liquid asset in period 3. In our baseline economy, this
corresponds to the net interest payments on the net money balances (R − 1) (M − T ) /p3 ,
which, by the government budget constraint, is equal to T /p3 . In the constant money growth
economy, this is equal to Tt /p̃3,t and, in the Lucas tree economy, it corresponds to d. Given
that local markets are Walrasian, the essential distortion in our economy is the limited ability
of agents to do intertemporal trade. A consumer meeting a producer in periods 1 or 2 would be
willing to transfer future resources in period 3 in exchange for current consumption. However,
as credit contracts are not available, he is not able to promise repayment. The presence of the
liquid asset allows him to circumvent this problem, since he can transfer his asset holdings to
the producer. The equilibrium value of the liquid asset depends on the value of the real payoﬀs
associated to it. The larger this payoﬀ, the larger the equilibrium value of the asset.22


7         Concluding Remarks

In this paper we have analyzed how diﬀerent liquidity/monetary regimes aﬀect the response of
an economy to aggregate shocks. When liquid assets are scarce and agents are more likely to be
liquidity constrained, the response of the economy is magnified. In this case, a complementarity
in agents’ trading decisions arises endogenously and amplifies the initial eﬀect of the shock.
         Our mechanism is driven by the combination of risk aversion, idiosyncratic uncertainty,
and decentralized trade. All three ingredients are necessary for the mechanism to operate.
Risk aversion and idiosyncratic risk give rise to an insurance problem. Decentralized trade,
together with the anonymity assumption, implies that agents can only self-insure using their
money holdings.23 A nice feature of our setup is that simply by changing the real rate of return
on money, we move from an environment in which idiosyncratic risk is perfectly insurable
(Friedman rule) to an environment in which idiosyncratic risk is completely uninsurable (fully
constrained regime). In this sense, the mechanism identified in this paper speaks more broadly
about the eﬀects of uninsurable idiosyncratic risk on aggregate behavior.
         If we interpret our liquid asset strictly as a monetary instrument, as we did in our quantita-
tive examples of Section 5, an immediate implication of our model is that high inflation regimes
    22
     The idea that public liquidity allows consumers to overcome lack of commitment in financial contracts is
explored in Woodford (1990) and Holmstrom and Tirole (1998).
  23
     Reed and Waller (2006) also point out the risk sharing implications of diﬀerent monetary regimes in a model
à la Lagos and Wright (2005).


                                                      30
tend to exhibit higher real volatility. Looking at the empirical relation between inflation rates
and aggregate volatility, across countries and across time, it is indeed possible to find a positive
correlation. Even though it is clearly hard to establish the direction of causality, this corre-
lation is consistent with our mechanism. Our results also show that high inflation is socially
costly because it undermines the role of monetary savings as a form of self-insurance. From
this point of view, the policy implications of our model are straightforward. Implementing the
Friedman rule is optimal and, as a side product, delivers lower aggregate volatility. Notice that
this result relies on the availability of lump-sum taxes. The study of optimal monetary policy
with distortionary taxation in our setup remains a topic for future research.24
    Under a broader interpretation of liquid assets, our paper is related to the literature on the
aggregate implications of imperfect risk sharing. This literature has focused on the eﬀects of
imperfect risk sharing for capital accumulation, asset prices, and the welfare cost of business
cycles. Our result points to a potential eﬀect on the response of output to aggregate shocks.
It would be interesting to explore the presence and quantitative significance of our mechanism
in a Bewley (1977) type economy with aggregate shocks, such as the one studied in Krusell
and Smith (1989).25
    Finally, the coordination mechanism identified in our model could have relevant implica-
tions for the study of financial markets. In particular, one could replace the trading of goods
in our model with trading of risky financial assets, as in recent search models of financial
transactions, such as Duﬃe, Garleanu, and Pedersen (2005) and Lagos and Rocheteau (2006).
This approach could be used to study the behavior of liquidity premia and trading volumes in
periods of financial turmoil.




  24
     Aruoba and Chugh (2006) show that, with distortionary taxation, the Friedman rule is not optimal in a
model à la Lagos and Wright (2005).
  25
     In Krusell and Smith (1989) the entire capital stock of the economy is a liquid asset and the presence of
uninsurable idiosyncratic risk has minor eﬀects on aggregate dynamics. To explore our mechanism, it would be
interesting to assume that only a fraction of capital income is liquid.


                                                     31
Appendix
A. Proofs for Section 3
Proof of Proposition 1
For each θ > 0 we obtain the first order conditions

                                           u0 (c1 (θ̃, θ))f (θ) = λ1 (θ) ,
                                            v 0 (n(θ, θ̃))f (θ) = θλ1 (θ) ,

where λ1 (θ) is the Lagrange multipliers for the resource constraints in island θ. These conditions show
that the optimal c1 (θ̃, θ) and n(θ, θ̃) are independent of θ̃. Then, by market clearing c1 (θ̃, θ) = y1 (θ, θ̃)
for all θ̃, and we denote this quantity y1F B (θ). Let nF B (θ) denote n(θ, θ̃). Then, the resource constraint
in island θ becomes y1F B (θ) = θnF B (θ). Combining it with the first order conditions above gives (1).
Moreover, the first order condition with respect to c2 (θ, θ̃) gives U 0 (c2 (θ, θ̃)) = λ2 , which implies that
c2 is constant across households. The resource constraint in period 2 requires c2 (θ, θ̃) = e2 .

Proof of Lemma 1
The first part is an immediate corollary of Proposition 1. The second part follows from applying the
implicit function theorem to the planner’s optimality condition

                                           θu0 (y1F B (θ)) = v 0 (y1F B (θ)/θ).

Proof of Proposition 2
We proved in the text that βR = 1 is a necessary condition for the existence of an unconstrained equi-
librium. Suﬃciency will be proved as the last step. First, we prove that any unconstrained equilibrium
achieves a first-best allocation. Since (4) holds as an equality for all (θ, θ̃), it follows that c2 (θ, θ̃) is
constant. Then, market clearing requires that c2 (θ, θ̃) be equal to e2 for all (θ, θ̃). Substituting in (3)
(for a consumer in island θ) and (6), and given that (3) holds as an equality, we obtain

                                           p1 (θ) 0                            p1 (θ) 0
                           u0 (c1 (θ)) =         U (e2 ),    v 0 (n (θ)) = θ         U (e2 ).
                                            p2                                   p2
These two conditions, and market clearing in island θ, imply that

                                              θu0 (y1 (θ)) = v 0 (n (θ)) ,

where y1 (θ) = θn(θ), which corresponds to the planner optimality condition (1). Therefore, labor
supply and consumption in periods 1 and 2 are first-best eﬃcient. Since any consumption allocation in
period 3 is consistent with first-best eﬃciency, this completes the argument.
     Next, we prove that equilibrium prices must take the form (9)-(11), with κ ≤ κ̂. The consumers’
first order conditions immediately imply that (9)-(11) must hold for some κ > 0. To show that κ
is smaller than a cutoﬀ κ̂ and to derive the value of the cutoﬀ, we need to complete the equilibrium
characterization, by deriving consumption in period 3 and money holdings. Substituting the prices (9)-
(11) and first-best consumption in periods 1 and 2 in the consumer’s budget constraints, and imposing
the stationarity conditions m = M and m3 (θ, θ̃) = M/R, we obtain

                        m1 (θ̃) = M − κu0 (y1F B (θ̃))y1F B (θ̃),                                          (30)
                       m2 (θ, θ̃) = m1 (θ̃) + κu0 (y1F B (θ))y1F B (θ) − κU 0 (e2 ) e2 ,                   (31)
                         M/R = m2 (θ, θ̃) + κU 0 (e2 ) e2 + κ(e3 − c3 (θ, θ̃)) − T.                        (32)


                                                            32
For each pair (θ, θ̃), conditions (30)-(32), together with the government budget constraint, can be solved
to derive m1 (θ̃), m2 (θ, θ̃) and c3 (θ, θ̃). In particular, we obtain

                           c3 (θ, θ̃) = e3 − u0 (y1F B (θ̃))y1F B (θ̃) + u0 (y1F B (θ))y1F B (θ),           (33)

which is independent of κ and strictly positive, given our assumption that e3 is large. It remains to
check that m1 (θ̃) and m2 (θ, θ̃) are non-negative for all pairs (θ, θ̃). From (30) and (31), this requires
that
                            h                       i
                     κ max u0 (y1F B (θ̃))y1F B (θ̃) ≤ M,                                              (34)
                        θ̃
                            h                                                                i
                     κ max u0 (y1F B (θ̃))y1F B (θ̃) − u0 (y1F B (θ))y1F B (θ) + U 0 (e2 ) e2 ≤ M.     (35)
                          θ,θ̃

Lemma 1 together with the assumption cu00 (c) /u0 (c) ≤ 1 guarantees that u0 (y1F B (θ))y1F B (θ) is increas-
ing in θ. Notice that y1F B (0) = 0 and p1 (0) = κu0 (y1F B (0)) = ∞, so p1 (0) y1F B (0) is not well defined. We
adopt the natural convention that p1 (0)y1F B (0) = 0. It follows that a necessary and suﬃcient condition
for (34) and (35) is κ ≤ κ̂ where κ̂ is defined in (12).
     Finally, we prove that the condition R = 1/β is suﬃcient for an unconstrained equilibrium to exist.
To do so, we construct an equilibrium with prices (9)-(11). From the argument above, we know that
labor supply and consumption in periods 1 and 2 must be at their first-best level, and consumption in
period 3 must be equal to (33). Choosing any κ ≤ κ̂ ensures that money holdings are non-negative.
It is straightforward to check that this allocation satisfies market clearing and that it is individually
optimal, given that it satisfies the first order conditions (3)-(6).

Proof of Corollary 1
The statement follows immediately from the condition κ ≤ κ̂, the definition of κ̂ (12) and the pricing
condition (10).

Preliminary Results for Proposition 3
In order to prove Proposition 3, it is useful to prove several preliminary lemmas. These results will also
be useful to prove Proposition 4.
    The following lemmas allow us to establish that the system of functional equations (18)-(19) has a
unique solution, (p1 (·), y1 (·)). To do so, we define a fixed point problem for the function x(·). Recall
from the text that x(θ) ≡ p1 (θ)y1 (θ). To save on notation, in the lemmas we drop the period index and
use p(θ) and y(θ).
    Notice that, in an island where θ = 0, output is zero and, from condition (18), the price p (0) may
be infinity. Hence, nominal income in island 0 may be not well defined. The natural solution is to
set x(0) = 0. Moreover, non-negativity of consumption in period 2 requires that £x (θ)¤ ≤ e2 for all θ.
Therefore, we restrict attention to the set of measurable, bounded functions x : 0, θ → [0, e2 ] that
satisfy x (0) = 0, which we denote by X.

Lemma 4 Given θ > 0 and a function x ∈ X, there exists a unique pair (p, y) which solves the system
of equations
                                                    Z   θ      ³               ´
                                      u0 (y) − p            U 0 e2 − py + x(θ̃) dF (θ̃) = 0,                (36)
                                                    0
                                      ³y ´          Z   θ      ³               ´
                                 v0          − θp           U 0 e2 − x(θ̃) + py dF (θ̃) = 0.                (37)
                                       θ            0

The pair (p, y) satisfies py ∈ [0, e2 ].

                                                                   33
    Proof. We proceed in two steps, first we prove existence, then uniqueness.

    Step 1. Existence. For a given p ∈ (0, ∞), it is easy to show that there is a unique y which solves
(36) and a unique y which solves (37), which we denote, respectively, by y D (p) and y S (p). Finding a
solution to (36)-(37), is equivalent to finding a p that solves

                                                           y D (p) − y S (p) = 0.                             (38)

It is straightforward to prove that y D (p) and y S (p) are continuous on (0, ∞). We now prove that
they satisfy four properties: (a) py D (p) < e2 for all p ∈ (0, ∞), (b) y S (p) < θn̄ for all p ∈ (0, ∞),
(c) lim supp→0 y D (p) = ∞, and (d) lim supp→∞ py S (p) = ∞. Notice that x (0) = 0 with positive
probability, so the Inada condition for U can be used to prove property (a). Similarly, to prove
property (b), we can use the assumption limn→n̄ v 0 (n) = ∞. To prove (c) notice that (a) implies
lim supp→0 py D (p) ≤ e2 . If lim supp→0 py D (p) = e2 , then, we immediately have lim supp→0 y D (p) = ∞.
If, instead, lim supp→0 py D (p) < e2 , then there exists a K ∈ (0, e2 ) and an > 0 such that py D (p) < K
                                                                   ³                   ´
for all p ∈ (0, ). Since U 0 is decreasing, this implies that U 0 e2 − py D (p) + x(θ̃) is bounded above
by U 0 (e2 − K) < ∞ for all p ∈ (0, ), which implies
                                            Z       θ      ³                     ´
                                  lim p                 U 0 e2 − py D (p) + x(θ̃) dF (θ̃) = 0.
                                 p→0            0
                                   ¡       ¢
Using (36), this requires limp→0 u0 y D (p) = 0 and, hence, limp→0 y D (p) = ∞. To prove property (d),
                                                                               S
suppose, ³by contradiction, that
                              ´ there exist a K > 0 and a P > 0, such that py (p) ≤ K for all p ≥ P .
Then U 0 e2 − x(θ̃) + py S (p) is bounded below by U 0 (e2 + K) > 0 for all p ∈ (P, ∞), which implies

                                            Z       θ      ³                     ´
                                 lim p                  U 0 e2 − x(θ̃) + py S (p) dF (θ̃) = ∞.                (39)
                                p→∞             0

Moreover, since 0 ≤ py S (p) ≤ K for all p ≥ P , it follows that limp→∞ y S (p) = 0 and thus
                                                ¡          ¢
                                         lim v 0 y S (p) /θ < ∞.                                              (40)
                                                         p→∞

Using equation (37), conditions (39) and (40) lead to a¡ contradiction, completing  ¢          the proof of (d).
Properties (a) and (d) immediately imply lim supp→∞ py S (p) − py D (p) = ∞, while (b) and (c)
                     ¡                 ¢
imply lim supp→0 y D (p) − y S (p) = ∞. It follows that there exists a pair (p0 , p00 ), with p0 < p00 , such
that y D (p0 ) − y S (p0 ) > 0 and y D (p00 ) − y S (p00 ) < 0. By the intermediate value theorem there exists a
p which solves (38). Property (a) immediately implies that py ∈ [0, e2 ], where y = y D (p) = y S (p).

    Step 2. Uniqueness. Let p̂ be a zero of (38), and ŷ = y D (p̂) = y S (p̂). To show uniqueness, it is
suﬃcient to show that dy D (p) /dp − dy S (p) /dp < 0 at p = p̂. Applying the implicit function theorem
gives
                     ∙ D        ¸       R θ 0 ¡ D¢                  Rθ     ¡ ¢
                       dy (p)            0
                                           U c̃2 dF (θ̃) − p̂ŷ 0 U 00 c̃D  2 dF (θ̃)
                                      =                      R      ¡    ¢            ,
                          dp                                   θ
                                               u00 (ŷ) + p̂2 0 U 00 c̃D
                                                                       2 dF (θ̃)
                                 p=p̂

where c̃D
        2 = e2 − p̂ŷ + x(θ̃) and

                         ∙              ¸                Rθ         ¡ ¢               Rθ      ¡ ¢
                             dy S (p)                     0
                                                              U 0 c̃S2 dF (θ̃) + p̂ŷ 0 U 00 c̃S2 dF (θ̃)
                                                    =                              Rθ     ¡ ¢             .
                               dp       p=p̂                  v 00 (ŷ/θ) /θ2 − p̂2 0 U 00 c̃S2 dF (θ̃)



                                                                       34
where c̃S2 = e2 − x(θ̃) + p̂ŷ. Using (36)-(37), the required inequality can then be rewritten as
                       Ã               Z θ                   !                 Ã               Z θ                  !
            v 00 (ŷ/θ) u0 (ŷ)                 ¡    ¢              v 0
                                                                        (ŷ/θ)                         ¡    ¢
                                − p̂ŷ      U 00 c̃D
                                                   2 dF (θ̃) −                  u00 (ŷ) + p̂2     U 00 c̃D
                                                                                                          2 dF (θ̃)
                 θ2       p̂            0                               θp̂                     0
                                            Z θ
                                                     ¡ ¢
                                        +p̂      U 00 c̃S2 dF (θ̃) (u0 (ŷ) + ŷu00 (ŷ)) > 0.
                                                 0

The first two terms on the left-hand side are positive. The assumption that u0 has elasticity smaller
than or equal to 1 implies that also the last term is positive, completing the argument.

Lemma 5 Given a function x ∈ X, for any θ > 0 let (p (θ) , y (θ)) be the unique pair solving the system
(36)-(37) and define z (θ) ≡ p (θ) y (θ). The function z (θ) is monotone increasing.

    Proof. Define the two functions
                                                                    Z       θ      ³              ´
                          h1 (z, y; θ) ≡ u0 (y)y − z                            U 0 e2 − z + x(θ̃) dF (θ̃),
                                                                        0
                                                         ³y ´ y             Z       θ      ³              ´
                                                     0
                          h2 (z, y; θ) ≡ v                        −z                    U 0 e2 − x(θ̃) + z dF (θ̃),
                                                          θ   θ                 0

which correspond to the left-hand sides of (36) and (37) multiplied, respectively, by y and y/θ. Lemma
4 ensures that for each θ > 0 there is a unique positive pair (z (θ) , y (θ)) which satisfies

                                                 h1 (z (θ) , y (θ) ; θ) = 0,
                                                 h2 (z (θ) , y (θ) ; θ) = 0.

Applying the implicit function theorem, gives
                                                                  ∂h1   ∂h2              ∂h2   ∂h1
                                                     0            ∂y    ∂θ          −    ∂y    ∂θ
                                                 z (θ) =          ∂h1   ∂h2              ∂h2   ∂h1
                                                                                                     .                  (41)
                                                                  ∂z    ∂y          −    ∂z    ∂y

To prove the lemma it is suﬃcient to show that z 0 (θ) > 0 for all θ ∈ (0, θ]. Using z and y as shorthand
for z (θ) and y (θ), the numerator on the right-hand side of (41) can be written as
                                 y h ³y ´          ³y ´ y i
                              − 2 v0        + v 00          [u0 (y) + u00 (y)y] ,
                                θ       θ           θ θ
and the denominator can be written, after some algebra, as
                              Z   θ       ³              ´
      [u0 (y) + u00 (y)y] z           U 00 e2 − x(θ̃) + z dF (θ̃) +                                                     (42)
                              0
          h ³y ´      ³ ´ i Z θ     ³              ´         y2 h          ³y ´                 ³ y ´i
             0      00 y y z
         + v     +v             U 00 e2 − z + x(θ̃) dF (θ̃) + 2 u00 (y)v 0      θ − u0 (y) v 00        .
               θ       θ θ θ 0                               zθ             θ                     θ
The assumption that u0 has elasticity smaller than 1 ensures that both numerator and denominator are
negative, completing the proof.

    We can now define a map T from the space X into itself.

Definition 2 Given a function x ∈ X, for any θ > 0 let (p (θ) , y (θ)) be the unique pair solving the
system (36)-(37). Define a map T : X → X as follows. Set (T x) (θ) = p (θ) y (θ) if θ > 0 and
(T x) (θ) = 0 if θ = 0.

                                                                        35
    The following lemmas prove monotonicity and discounting for the map T . These properties will be
used to find a fixed point of T . In turns, this fixed point will be used to construct the equilibrium in
Proposition 3.
                                                                  ¡    ¢     ¡    ¢
Lemma 6 Take any x0 , x1 ∈ X, with x1 (θ) ≥ x0 (θ) for all θ. Then T x1 (θ) ≥ T x0 (θ) for all θ.
                        £ ¤
    Proof. For each θ̃ ∈ 0, θ and α ∈ [0, 1], define

                                               x(θ̃, α) ≡ x0 (θ̃) + α∆(θ̃),

where ∆(θ̃) ≡ x1 (θ̃) − x0 (θ̃) ≥ 0. Notice that x(θ̃, 0) = x0 (θ̃) and x(θ̃, 1) = x1 (θ̃). Fix a value for θ and
define the two functions
                                                   Z θ ³                       ´
                      h1 (z, y; α) ≡ yu0 (y) − z        U 0 e2 − z + x(θ̃, α) dF (θ̃),
                                                                  0
                                               ³y ´ y                 Z       θ      ³                 ´
                                           0
                      h2 (z, y; α) ≡ v                          −z                U 0 e2 − x(θ̃, α) + z dF (θ̃).
                                                   θ        θ             0

Applying Lemma 4, for each α ∈ [0, 1] we can find a unique positive pair (z (α) , y (α)) that satisfies

                                          h1 (z (α) , y (α) ; α) = 0,
                                          h2 (z (α) , y (α) ; α) = 0.

We are abusing notation in the definition of h1 (·, ·; α) , h2 (·, ·; α) , z (α) , and y (α), given that the same
symbols were used above to define functions of θ. Here we¡ keep¢ θ constant throughout          ¡    ¢ the proof,
so no confusion should arise. Notice that, by construction, T x0 (θ) = z (0) and T x1 (θ) = z (1).
Therefore, to prove our statement it is suﬃcient to show that z 0 (α) ≥ 0 for all α ∈ [0, 1].
    Applying the implicit function theorem, we obtain
                                                                ∂h1   ∂h2             ∂h2   ∂h1
                                                                ∂y    ∂α          −   ∂y    ∂α
                                          z 0 (α) =             ∂h1   ∂h2             ∂h2   ∂h1
                                                                                                  .                (43)
                                                                ∂z    ∂y          −   ∂z    ∂y

Using z and y as shorthand for z (α) and y (α), the numerator on the right-hand side of (43) can be
written as
                                               Z       θ       ³                 ´
                       [u0 (y) + u00 (y)y] z               U 00 e2 − x(θ̃, α) + z ∆(θ̃)dF (θ̃) +
                                                   0

                          z h 0 ³y ´      ³ ´ iZ θ     ³                 ´
                                        00 y y
                         + v         +v            U 00 e2 − z + x(θ̃, α) ∆(θ̃)dF (θ̃).
                          θ      θ         θ θ 0

The denominator takes a form analogous to (42). Again, the assumption that u0 has elasticity smaller
than 1, ensures that both the numerator and the denominator are negative, completing the argument.


    Before proving the discounting property, it is convenient to restrict the space X to the space X̃ of
functions bounded in [0, z] for an appropriate z < e2 . The following lemma shows that the map T maps
X̃ into itself, and that any fixed point of T in X must lie in X̃.

Lemma 7 There exists a z < e2 , such that if x ∈ X then (T x) (θ) ≤ z for all θ.




                                                                      36
    Proof. Set x (0) = 0 and x (θ) = e2 for all θ > 0. Setting x (.) = x (.) and θ = θ, equations
(36)-(37) take the form

                            u0 (y) = p [F (0) U 0 (e2 − py) + (1 − F (0)) U 0 (2e2 − py)] ,
                           ¡     ¢
                         v y/θ = θp [F (0) U 0 (e2 + py) + (1 − F (0)) U 0 (py)] .
                          0


Let (p̂, ŷ) denote the pair solving these equations, and let z ≡ p̂ŷ. Since F (0) > 0 and U satisfies the
Inada condition, limc→0 U 0 (c) = ∞, inspecting the first equation shows that z < e2 . Now take any
x ∈ X. Since x (θ) ≤ x (θ) for  ¡ ¢all θ, Lemma 6 implies that (T x) (θ) ≤ (T x) (θ). Moreover, Lemma 5
implies that (T x) (θ) ≤ (T x) θ = z. Combining these inequalities we obtain (T x) (θ) ≤ z.

Lemma 8 There exists a δ ∈ (0, 1) such that the map T satisfies the discounting property: for any
x0 , x1 ∈ X̃ such that x1 (θ) = x0 (θ) + a for some a > 0, the follow inequality holds
                               ¯¡ 1 ¢        ¡   ¢ ¯                    £ ¤
                               ¯ T x (θ) − T x0 (θ)¯ ≤ δa for all θ ∈ 0, θ .

    Proof. Proceeding as in the proof of Lemma 6, define

                                                 x(θ̃, α) ≡ x0 (θ̃) + α∆(θ̃),

where now ∆(θ̃) = a for all θ̃. After some algebra, we obtain
                                          ³         00
                                                           ´        ³          00
                                                                                        ´
                                            1 + yuu
                                                       (y)
                                                    0 (y)    A + 1 + nv     v
                                                                                  (n)
                                                                              0 (n)        B
                   z 0 (α) = ³         00 (y)
                                              ´        ³         00 (n)
                                                                        ´              00 (n)
                                                                                                           a,   (44)
                                                                                                yu00 (y)
                                1 + yu
                                     u0 (y)     A + 1 + nv    v 0 (n)     B + nv    v 0 (n) −    u0 (y)


where y and n are shorthand for y(α) and y (α) /θ and
                                        Rθ     ³                       ´
                                  z (α) 0 U 00 e2 − x(θ̃, α) + z (α) dF (θ̃)
                        A = − R            ³                        ´         ,
                                       θ 0
                                      0
                                        U    e2 − x( θ̃, α) + z (α)   dF (θ̃)
                                        Rθ     ³                       ´
                                  z (α) 0 U 00 e2 − z (α) + x(θ̃, α) dF (θ̃)
                        B = − R            ³                        ´         .
                                       θ 0
                                      0
                                        U e2 − z (α) + x(θ̃, α) dF (θ̃)

Now, given that z (α) and x(θ̃, α) are both in [0, z] and z < e2 , and given that U has continuous first
and second derivatives on (0, ∞), it follows that both A and B are bounded above. We can then find a
uniform upper bound on both A and B, independent of α and of the functions x0 and x1 chosen. Let
C be this upper bound. Given that u00 (y) ≤ 0, then
                      µ              ¶     µ               ¶    µ               ¶
                            yu00 (y)             nv 00 (n)            nv 00 (n)
                        1+ 0           A+ 1+ 0               B ≤ 2+ 0             C.
                              u (y)               v (n)                v (n)

Therefore, (44) implies
                                       µ                                         ¶−1
                                  0         nv 00 (n) /v 0 (n) − yu00 (y)/u0 (y)
                                z (α) ≤ 1 +                                          a.
                                                 (2 + nv 00 (n) /v 0 (n)) C

Recall that σ > 0 is a lower bound for −yu00 (y)/u0 (y). Then

                              nv 00 (n) /v 0 (n) − yu00 (y)/u0 (y)   −yu00 (y)/u0 (y)    σ
                                                                   ≥                  ≥    .
                                   (2 + nv 00 (n) /v 0 (n)) C              2C           2C

                                                               37
Setting
                                                     1
                                           δ≡               < 1,
                                                1 + σ/ (2C)
it follows that
                                                 z 0 (α) ≤ δa
for all α ∈ [0,¡ 1]. ¢Integrating both ¡sides¢of the last inequality over [0, 1], gives z (1) − z (0) ≤ δa. By
construction T x1 (θ) = z (1) and T x0 (θ) = z (0), completing the proof.

Proof of Proposition 3
We first uniquely characterize prices and allocations in a fully constrained equilibrium. Next, we will
use this characterization to prove our claim. The argument in the text and the preliminary results
above show that if there exists an equilibrium with m2 (θ, θ̃) = 0 for all θ and θ̃, then p1 (θ) and y1 (θ)
must solve the functional equations (18)-(19). To find the equilibrium pair (p1 (θ) , y1 (θ)) we first find
a fixed point of the map T defined above (Definition 2). Lemmas 6 and 8 show that T is a map
from a space of bounded functions into itself and satisfies the assumptions of Blackwell’s theorem.
Therefore, a fixed point exists and is unique. Let x denote the fixed point, then Lemma 4 shows that
we can find two functions p1 (θ) and y1 (θ) that satisfy (36)-(37). Since x (θ) is a fixed point of T we
have x (θ) = p1 (θ) y1 (θ), and substituting in (36)-(37) shows that (18)-(19) are satisfied. Therefore,
in a fully constrained equilibrium p1 (θ) and y1 (θ) are uniquely determined, and so is labor supply
n(θ) = y1 (θ)/θ. Moreover, from the budget constraint and the market clearing condition in period 2,
consumption in period 2 is uniquely determined by c2 (θ, θ̃) = e2 − p1 (θ̃)y1 (θ̃) + p1 (θ) y1 (θ). The price
p2 is equal to 1, as argued in the text. From the consumer’s budget constraint in period 3 and the
government budget constraint we obtain c3 = e3 . Combining the Euler equations (3) and (5) and the
envelope condition (7), p3 is uniquely pinned down by
                                          Z θZ θ
                                 1
                                   = βR          U 0 (c2 (θ, θ̃))dF (θ)dF (θ̃).                          (45)
                                p3         0   0

Finally, equilibrium money holdings are m1 (θ) = M − p1 (θ)y1 (θ), m2 (θ, θ̃) = 0, and m3 (θ, θ̃) = M/R.
   Define the cutoﬀ
                                     1          U 0 (c2 (θ, θ))
                                R̂ ≡ R R                                .
                                     β θ θ U 0 (c (θ, θ̃))dF (θ)dF (θ̃)
                                        0 0      2

The only optimality condition that remains to be checked is the Euler equation in period 2, (4). Given
the definition of c2 (θ, θ̃), Lemma 5 implies that it is an increasing function of θ and a decreasing function
of θ̃. It follows that a necessary and suﬃcient condition for (4) to hold for all (θ, θ̃) is
                                                                 1
                                             U 0 (c2 (θ, θ)) ≥      .                                    (46)
                                                                 p3
Substituting the expression (45) for 1/p3 on the right-hand side, this condition is equivalent to R ≤ R̂.
Therefore, if an unconstrained equilibrium exists, since c2 (θ, θ̃) is uniquely determined, condition (46)
implies that R ≤ R̂, proving necessity. If R ≤ R̂, the previous steps show how to construct a fully
constrained equilibrium, proving suﬃciency.

Proof of Lemma 2
The second part of the Lemma follows immediately from Lemma 5. For the first part, we start from
the same functions h1 (z, y; θ) and h2 (z, y; θ) defined in the proof of Lemma 5 and apply the implicit
function theorem to get
                                                 ∂h2 ∂h1    ∂h1 ∂h2
                                                  ∂z ∂θ − ∂z ∂θ
                                       y 0 (θ) = ∂h 1 ∂h2   ∂h2 ∂h1
                                                                    .                             (47)
                                                  ∂z ∂y − ∂z ∂y


                                                      38
To complete the proof of the lemma it is suﬃcient to show that y 0 (θ) > 0 for all θ ∈ (0, θ]. Using z and
y as shorthand for z (θ) and y (θ), the numerator on the right-hand side of (47) can be written as
                               "                                                                  #
       y h 0 ³y ´      ³ ´ i Z θ           ³           ´          Z θ ³                  ´
                     00 y y             00                              0
          v       +v             z    U e2 − z + x(θ̃) dF (θ̃) −       U e2 − z + x(θ̃) dF (θ̃) ,
       θ2     θ          θ θ        0                               0


showing that it is negative. Finally, the denominator is equal to (42) and is negative as we have argued
in the proof of Lemma 5, completing the argument.

B. Derivations and proofs for Sections 4 and 5
Equilibrium with aggregate shocks
General characterization. In a stationary equilibrium with aggregate shocks the optimality condi-
tions (3)-(6), take the following form:
                                                 Z
                                     p1 (θ̃, ζ) θ 0
                 u0 (c1 (θ̃, ζ)) ≥                     U (c2 (θ, θ̃, ζ))dF (θ|ζ) (m1 (θ̃, ζ) ≥ 0) for all θ̃, ζ,                                   (48)
                                      p2 (ζ) 0
                                         p2 (ζ)
                 U 0 (c2 (θ, θ̃, ζ)) ≥                                      (m2 (θ, θ̃, ζ) ≥ 0) for all θ, θ̃, ζ,                                  (49)
                                           p3
                                Z ζZ θ 0
                                          u (c1 (θ, ζ̃))
                 1 = βRp3                                 dF (θ)dG(ζ̃),                                                                            (50)
                                  ζ   0      p1 (θ, ζ̃)
                                                   Z
                                     θp1 (θ, ζ) θ 0
                 v 0 (n (θ, ζ)) =                       U (c2 (θ, θ̃, ζ))dF (θ̃|ζ) for all θ, ζ,                                                   (51)
                                        p2 (ζ)       0

where (50) is derived by substituting the envelope condition (7) in the analog of (5). Notice that
condition (50) shows that, with i.i.d. shocks, p3 is independent of the aggregate shock ζ. An equilibrium
is given by prices and allocations that satisfy (51) to (50), together with the market clearing conditions
and the budget constraints:

                            m1 (θ̃, ζ) + p1 (θ̃, ζ)c1 (θ̃, ζ) = M,
                            m2 (θ, θ̃, ζ) + p2 (ζ) c2 (θ, θ̃, ζ) = m1 (θ̃, ζ) + p1 (θ, ζ) y1 (θ, ζ) ,
                            M/R + p3 c3 (θ, θ̃, ζ) = p3 e3 + m2 (θ, θ̃, ζ) + p2 (ζ) e2 − T.

    To compute an equilibrium it is suﬃcient to find prices and quantities solving the system formed
by (51), the market clearing condition c1 (θ, ζ) = θn(θ, ζ) for all θ, ζ, and equations
                             ( µ             ¶            Z                           )
            0                   0     M          p1 (θ, ζ) θ 0
          u (c1 (θ, ζ)) = max u                ,            U (c2 (θ̃, θ, ζ))dF (θ̃|ζ) for all θ, ζ,
                                   p1 (θ, ζ)      p2 (ζ) 0
                            (                                                                               µ             ¶)
                                 M       p1 (θ̃, ζ)              p1 (θ, ζ)                                       p2 (ζ)
      c2 (θ, θ̃, ζ) = min              −            c1 (θ̃, ζ) +           c1 (θ, ζ), U 0−1                                    for all θ, θ̃, ζ,
                                p2 (ζ)    p2 (ζ)                  p2 (ζ)                                          p3
                                      Z     θ   Z       θ
                                                            c2 (θ, θ̃, ζ)dF (θ)dF (θ̃) = e2 for all ζ,
                                        0           0
and
                                                              Z    ζ   Z   θ
                                      1                                        u0 (c1 (θ, ζ))
                                         = βR                                                 dF (θ|ζ)dG (ζ) .
                                      p3                       ζ       0         p1 (θ, ζ)


                                                                                  39
This system is written in general form, allowing for cases where the constraints m1 (θ, ζ) ≥ 0 and
m2 (θ, θ̃, ζ) ≥ 0 are binding only for a subset of, respectively, Θ and Θ2 . Therefore, we can use it
to compute equilibria for: (i) economies with R ∈ (R̂, 1/β) where the liquidity constraint in period
2 is non-binding for some pairs (θ, θ̃), and (ii) economies where the assumption F (0) > 0 is relaxed,
allowing for a binding liquidity constraint in period 1 for some θ. This system is used to compute all
the equilibria in Section 5.
    Unconstrained and fully constrained equilibria. The characterization of an unconstrained
equilibrium is straightforward, thanks to Lemma 1, which shows that the first-best allocation in period
1 is independent of the distribution F (·|ζ). Let us discuss the construction of a fully constrained
equilibrium for the economy with aggregate shocks (under the usual assumption F (0|ζ) > 0). Now,
a fully constrained equilibrium is one where m2 (θ, θ̃, ζ) = 0 for all θ, θ̃ and ζ . In such an equilibrium
p2 (ζ) is independent of ζ and equal to M/e2 , as in the case of no aggregate shocks. Therefore, we can
define a system of functional equations analogous to (18)-(19), for each ζ. Proceeding as in the proof of
Proposition 3, we can then find equilibrium functions p1 (·, ζ) and y1 (·, ζ) for each value of ζ separately.
The distribution of ζ only matters for the determination of p3 and for the cutoﬀ R̂, which is now
                                                   ©                 ª
                                 1           minζ U 0 (c2 (θ, θ, ζ))
                             R̂ ≡ R R R                                         ,
                                 β ζ θ θ U 0 (c (θ, θ̃, ζ))dF (θ)dF (θ̃)dG(ζ)
                                          ζ   0    0       2


where c2 (θ, θ̃, ζ) = e2 − p1 (θ̃, ζ)y1 (θ̃, ζ) + p1 (θ, ζ)y(θ, ζ).

Proof of Proposition 4
The proof proceeds in three steps. The first two steps prove that, for each θ, the nominal income in
island θ is increasing with the aggregate shock ζ, that is, x (θ, ζ) is increasing in ζ, where x(θ, ζ) ≡
p1 (θ, ζ)y1 (θ, ζ). Using this result, the third step shows that y1 (θ, ζ) is increasing in ζ. Consider two
values ζ I and ζ II , with ζ II > ζ I . Denote, respectively, by TI and TII the maps defined in Definition 2
under the distributions F (θ|ζ I ) and F (θ|ζ II ). Let xI and xII be the fixed points of TI and TII . That
is, xI (θ) ≡ x(θ, ζ I ) and xII (θ) ≡ x(θ, ζ II ) for all θ. Again, to save on notation, we drop the period
index for y1 .

   Step 1. Let the function x0 be defined as x0 = TII xI . In this step, we want to prove that
x (θ) > xI (θ) for all θ > 0. We will prove it pointwise for each θ. Fix θ > 0 and define the functions
 0

                                                           Z       θ
                         h1 (z, y; ζ) ≡ yu0 (y) − z                    U 0 (e2 − z + xI (θ̃))dF (θ̃|ζ),
                                                               0
                                                  ³y ´ y           Z       θ
                         h2 (z, y; ζ) ≡ v 0                −z                  U 0 (e2 − xI (θ̃) + z)dF (θ̃|ζ),
                                                   θ   θ               0

for ζ ∈ [ζ I , ζ II ]. Lemma 4 implies that we can find a unique pair (z (ζ) , y (ζ)) that satisfies

                                              h1 (z (ζ) , y (ζ) ; ζ) = 0,
                                              h2 (z (ζ) , y (ζ) ; ζ) = 0.

Once more, we are abusing notation in the definition of h1 (·, ·; ζ) , h2 (·, ·; ζ) , z (ζ) , and y (ζ). However,
as θ is kept constant, there is no room for confusion. Notice that z(ζ I ) = xI (θ), since xI is a fixed
point of TI , and z(ζ II ) = x0 (θ), by construction. Therefore, to prove our statement we need to show
that z(ζ II ) > z(ζ I ). It is suﬃcient to show that z 0 (ζ) > 0 for all ζ ∈ [ζ I , ζ II ]. Applying the implicit
function theorem gives
                                                    ∂h1 ∂h2   ∂h2 ∂h1
                                                    ∂y ∂ζ − ∂y ∂ζ
                                          z 0 (ζ) = ∂h1 ∂h2 ∂h2 ∂h1 .                                        (52)
                                                    ∂z ∂y − ∂z ∂y


                                                               40
Notice that xI (θ̃) is monotone increasing in θ̃, by Lemma 5, and U is strictly concave. Therefore,
U 0 (e2 −z+xI (θ̃)) is decreasing in θ̃ and U 0 (e2 −xI (θ̃)+z) is increasing in θ̃. By the properties of first-order
                          Rθ                                                           Rθ
stochastic dominance, 0 U 0 (e2 − z + xI (θ̃))dF (θ̃|ζ) is decreasing in ζ and 0 U 0 (e2 − xI (θ̃) + z)dF (θ̃|ζ)
is increasing in ζ. This implies that ∂h1 /∂ζ > 0 and ∂h2 /∂ζ < 0. Using y as shorthand for y (ζ), the
numerator on the right-hand side of (52) is, with the usual notation,
                                                  ∂h2     1 h 0 ³y´         ³ y ´ y i ∂h
                                                                                        1
                             [u0 (y) + yu00 (y)]      −      v       + v 00               .
                                                  ∂ζ      θ      θ            θ θ ∂ζ
The denominator is the analogue of (42). Once more, the assumption that yu00 (y) /u0 (y) ≥ −1 ensures
that both numerator and denominator are negative, completing the argument.

     Step 2. Define the sequence of functions (x0 , x1 , ...) in X, using the recursion xj+1 = TII xj . Since,
by step 1, x0 ≥ xI (where by x0 ≥ xI we mean x0 (θ) ≥ xI (θ) for all θ > 0) and, by Lemma 6, TII
is a monotone operator, it follows that this sequence is monotone, with xj+1 ≥ xj . Moreover, TII is a
contraction by Lemmas 6 and 8, so this sequence has a limit point, which coincides with the fixed point
xII . This implies that xII ≥ x0 and, together with the result in step 1, shows that xII > xI , as we
wanted to prove.

    Step 3. Fix θ > 0 and, with the usual abuse of notation, define the functions
                                               Z θ
                    h1 (z, y; ζ) ≡ yu0 (y) − z     U 0 (e2 − z + x(θ̃, ζ))dF (θ̃|ζ),
                                                             0
                                               ³y ´ y            Z    θ
                                           0
                       h2 (z, y; ζ) ≡ v                    −z             U 0 (e2 − x(θ̃, ζ) + z)dF (θ̃|ζ).
                                                   θ   θ          0

Notice the diﬀerence with the definitions of h1 and h2 in step 1, now x(θ̃, ζ) replaces xI (θ̃). The
functions z (ζ) and y (ζ) are defined in the usual way. Applying the implicit function theorem, we get
                                                           ∂h2   ∂h1          ∂h1   ∂h2
                                               0           ∂z    ∂ζ       −   ∂z    ∂ζ
                                           y (ζ) =         ∂h1   ∂h2          ∂h2   ∂h1
                                                                                          .
                                                           ∂z    ∂y       −   ∂z    ∂y

To evaluate the numerator, notice that
                  Z θ                                      Z θ
      ∂h1
            = −       U 0 (e2 − z + x(θ̃, ζ))dF (θ̃|ζ) + z     U 00 (e2 − z + x(θ̃, ζ))dF (θ̃|ζ) < 0,
      ∂z           0                                        0
                  Z θ                                      Z θ
      ∂h2
            = −       U 0 (e2 − x(θ̃, ζ) + z)dF (θ̃|ζ) − z     U 00 (e2 − x(θ̃, ζ) + z)dF (θ̃|ζ) ≤
      ∂z           0                                        0
                  Z θh                                                                       i
            ≤ −        U 0 (e2 − x(θ̃, ζ) + z) + (e2 − x(θ̃, ζ) + z)U 00 (e2 − x(θ̃, ζ) + z) dF (θ̃|ζ) ≤ 0,
                      0

where the last inequality follows from the assumption that U 0 has elasticity less than or equal to 1 (this
is the only place where this assumption is used). Furthermore, notice that
                Z θ                                                  Z θ
      ∂h1                                    ∂x(θ̃, ζ)                                           ∂f (θ̃|ζ)
           = −z     U 00 (e2 − z + x(θ̃, ζ))           dF (θ̃|ζ) − z     U 0 (e2 − z + x(θ̃, ζ))           dθ̃ > 0
       ∂ζ         0                            ∂ζ                     0                            ∂ζ
where the first element is positive from steps 1 and 2, and the second element is positive because ζ leads
to a first order stochastic increase in θ̃ and U 0 (e2 − z + x(θ̃, ζ)) is decreasing in θ̃. A similar reasoning
shows that
                Z θ                                               Z θ
       ∂h2           00                   ∂x(θ̃, ζ)                                           ∂f (θ̃|ζ)
            =z      U (e2 − x(θ̃, ζ) + z)           dF (θ̃|ζ) + z     U 0 (e2 − x(θ̃, ζ) + z)           dθ̃ < 0.
        ∂ζ       0                          ∂ζ                     0                            ∂ζ

                                                                 41
Putting together the four inequalities just derived shows that the numerator is negative. The denomi-
nator takes the usual form, analogous to (42), and is negative. This completes the proof.

C. Results and proofs for Section 6
Proof of Proposition 5
From expression (29) it is immediate to obtain
                                                                       Z     θ
                                             ∂Y1 (ζ, ξ)                                      ∂f (θ|ζ)
                                                                  =              y1 (θ, ξ)            dθ,
                                                ∂ζ                       0                     ∂ζ
                                                                       Z     θ
                                             ∂Y1 (ζ, ξ)                          ∂y1 (θ, ξ)
                                                                  =                         dF (θ|ζ) .
                                                ∂ξ                       0          ∂ξ

    In the case of an unconstrained equilibrium, with R = 1/β, the analogue of Proposition 2 can
be easily derived, showing that ∂y1 (θ, ξ)/∂ξ = 0 and ∂y1 (θ, ξ)/∂θ > 0. These properties imply that
∂Y1 (ζ, ξ)/∂ζ > 0 and ∂Y1 (ζ, ξ)/∂ξ = 0.
    Consider a fully constrained equilibrium, with R < R̂. For each value of ξ, the functions p1 (θ, ξ)
and y1 (θ, ξ) can be derived solving the following system of functional equations, analogous to (23)-(24):
                                                  Z     θ
               0
              u (y1 (θ, ξ)) = p1 (θ, ξ)                     U 0 (e2 − p1 (θ, ξ) y1 (θ, ξ) + p1 (θ̃, ξ)y1 (θ̃, ξ))dF (θ̃|ξ, θ),
                                                    0
              µ               ¶                     Z       θ
                  y1 (θ, ξ)
         v0                         = θp1 (θ, ξ)                U 0 (e2 − p1 (θ̃, ξ)y1 (θ̃, ξ) + p1 (θ, ξ) y1 (θ, ξ))dF (θ̃|ξ, θ).
                      θ                                 0

The only formal diﬀerence between these and (23)-(24) is that the distribution F (θ̃|ξ, θ) depends also
on θ. However, this does not aﬀect any of the steps of Proposition 3 (there is only a minor diﬀerence
in the proof of the analogue of Lemma 5, details available on request). Therefore, this system has a
unique solution for each ξ. Next, following the steps of Lemma 2 and Proposition 4, we can show that
y1 (θ, ξ) is increasing in θ and ξ. This implies that ∂Y1 (ζ, ξ)/∂ζ > 0 and ∂Y1 (ζ, ξ)/∂ξ > 0.

Mapping with alternative models of liquidity supply
Constant money growth. Let p1 (θ) , p2 , p3 , m1 (θ), m2 (θ, θ̃), m3 (θ, θ̃), and c1 (θ), c2 (θ, θ̃), c3 (θ, θ̃) be
prices, money balances, and consumption levels in a stationary equilibrium of the economy with interest-
bearing notes. To construct the corresponding equilibrium of the constant money growth economy, let
M0 = M , γ = R−1 and Tt = T /γ t . As in the text, set the prices

                                                  p̃1,t (θ) = γ t p1 (θ) ,
                                                       p̃s,t = γ t ps , for s = 2, 3.

Take the same consumption functions of the economy with interest-bearing notes and set the money
balance functions as follows

                        m̃1,t (θ) = γ t m1 (θ),             m̃2,t (θ, θ̃) = γ t m2 (θ, θ̃),        m̃3,t (θ, θ̃) = Mt+1 .

The household’s budget constraints, for a household beginning with Mt on date t, are now

                                  m̃1,t (θ̃) + p̃1,t (θ̃)c1 (θ̃) = Mt ,
                              m̃2,t (θ, θ̃) + p̃2,t c2 (θ, θ̃) = m̃1,t (θ̃) + p̃1,t (θ) y1 (θ),
                              m̃3,t (θ, θ̃) + p̃3,t c3 (θ, θ̃) = p̃3,t y3 + m̃2,t (θ, θ̃) + p̃2,t y2 − Tt .

                                                                             42
Some algebra shows that they are satisfied. Moreover, all intertemporal prices are unchanged, as
p̃1,t (θ) /p̃2,t = p1 (θ)/p2 , p̃2,t /p̃3,t = p2 /p3 and
                                         p̃3,t     1 p̃3,t         p3
                                                 =             =R        .
                                     p̃1,t+1 (θ)   γ p̃1,t (θ)    p1 (θ)
Substituting these prices in the household’s first order conditions shows that the allocation is individually
optimal, completing the equilibrium construction.

    Lucas trees. Starting with an equilibrium of the baseline economy, set the prices as in the text:
                                     M             M            M −T
                           Q1 (θ) =        , Q2 =      , Q3 =         .
                                    p1 (θ)          p2            p3
Let h1 , h2 and h3 denote holdings of the real asset and set their values to
                                m1 (θ)                m2 (θ, θ̃)
                          h1 (θ) =     , h2 (θ, θ̃) =            , h3 (θ, θ̃) = 1.
                                  M                     M
The household’s budget constraints, for a household beginning with 1 unit of the real asset on date t,
are:
                     Q1 (θ̃)h1 (θ̃) + c1 (θ̃) = Q1 (θ̃),
                    Q2 h2 (θ, θ̃) + c2 (θ, θ̃) = Q2 h1 (θ̃) + Q2 (y1 (θ)/Q1 (θ)) ,
                    Q3 h3 (θ, θ̃) + c̃3 (θ, θ̃) = e3 − d + (Q3 + d) (h2 (θ, θ̃) + e2 /Q2 ).
Some algebra shows that these constraints are satisfied. Moreover, it can be checked that all the
household optimality conditions are satisfied, given that all intertemporal prices are unchanged.

Proof of Proposition 6
To prove these two results, we exploit the mapping between the baseline economy and the Lucas tree
economy derived above. Consider the baseline economy with interest-bearing notes. Let κ̂ be defined
as in Proposition 2, for a given value of T . Proposition 2 ensures that for any κ ≤ κ̂ there exists an
unconstrained equilibrium of the baseline economy with R = 1/β. Define the cutoﬀ dU as
                                                          T
                                                  dU ≡       .
                                                          κ̂
Then, for any d ≥ dU , we can find the correspondent unconstrained equilibrium in a Lucas tree economy
with d = T /κ.
    For the second part, recall that Proposition 3 ensures that we can find a fully constrained equilibrium
of the baseline economy for any R ≤ R̂. In that case, using (45) and the normalization M = e2 , real
balances in period 3 are:
                                               M
                                                     = e2 Rφ,
                                                p3
where
                                        Z θZ θ
                                  φ≡β           U 0 (c2 (θ, θ̃))dF (θ) dF (θ̃).
                                          0   0
Notice that φ is a constant which is equal in all fully constrained equilibria (in particular, it is indepen-
dent of R). Using the government budget constraint, this implies that for each R ≤ R̂ the equilibrium
real value of the tax T is given by T /p3 = (R − 1) φe2 . Define
                                              dC ≡ (R̂ − 1)φe2 .
For any d ≤ dC , we can find the correspondent fully constrained equilibrium in a Lucas tree economy,
with d = (R − 1) φe2 .



                                                      43
References

 [1] Acemoglu, Daron and Fabrizio Zilibotti, “Was Prometheus Unbounded by Chance? Risk,
    Diversification and Growth,” Journal of Political Economy, 1997, 105, 709-751.

 [2] Aruoba, S. Borogan and Sanjay K. Chugh, “Optimal Fiscal and Monetary Policy When
    Money is Essential,” FRB International Finance Discussion Paper No. 880, 2006.

 [3] Bencivenga, Valerie and Bruce Smith, “Financial Intermediation and Endogenous
    Growth,” Review of Economic Studies, 1991, 58, 195-209.

 [4] Berentsen, Aleksander, Camera, Gabriele and Christopher Waller, “The Distribution Of
    Money Balances And The Nonneutrality Of Money,” International Economic Review,
    2005, 46, 465-486.

 [5] Bernanke, Ben and Mark Gertler, “Agency Costs, Net Worth, and Business Fluctuations,”
    American Economic Review, 1989, 79, 14-31.

 [6] Bewley, Truman, “The Permanent Income Hypothesis: A Theoretical Formulation,” Jour-
    nal of Economic Theory, 1977, 16, 252-292.

 [7] Cochrane, John, “Asset Pricing Program Review: Liquidity, Trading and Asset Prices,”
    Winter 2005 NBER reporter.

 [8] Craig, Ben and Guillaume Rocheteau, “Inflation and Welfare: a Search Approach,” 2007,
    mimeo.

 [9] Diamond, Peter, “Aggregate Demand Management in Search Equilibrium,” Journal of
    Political Economy, 1982, 90, 881-94.

[10] Diamond, Peter, “Money in Search Equilibrium,” Econometrica, 1984, 52, 1-20.

[11] Duﬃe, Darrell, Nicolae Garleanu and Lasse Heje Pedersen, “Over-the-counter markets,”
    Econometrica, 2005, 73, 1815-1847.

[12] Holmstrom, Bengt and Jean Tirole, “Private and Public Supply of Liquidity,” Journal of
    Political Economy, 1998, 106, 1-40.




                                            44
[13] Krishnamurthy, Arvind, “The Bond/Old-Bond Spread,” Journal of Financial Economics,
    2002, 66, 463-506.

[14] Kiyotaki, Nobuhiro and John H. Moore, “Credit Cycles,” Journal of Political Economy,
    1997, 105, 211-248.

[15] Kiyotaki, Nobuhiro and John H. Moore, “Liquidity, Business Cycles and Monetary Pol-
    icy,” 2001, mimeo, Princeton University.

[16] Kiyotaki, Nobuhiro and Randall Wright, “On Money as a Medium of Exchange,” Journal
    of Political Economy, 1989, 97, 927-954.

[17] Krusell, Per and Anthony A. Smith, Jr., “Income and Wealth Heterogeneity in the Macro-
    economy,” The Journal of Political Economy, 1998, 106, 867-896.

[18] Lagos, Ricardo and Randall Wright, “A Unified Framework of Money Theory and Policy
    Analysis,” Journal of Political Economy, 2005, 113, 463-484.

[19] Lagos, Ricardo and Guillaume Rocheteau, “Search in Asset Markets,” Federal Reserve
    Bank of Minneapolis Staﬀ Report 375, 2006.

[20] Longstaﬀ, Francis, “The Flight-to-Liquidity Premium in U.S. Treasury Bond Prices,”
    Journal of Business, 2004, 77, 511-526.

[21] Lucas, Robert and Edward Prescott, “Equilibrium Search and Unemployment,” Journal
    of Political Economy, 1974, 7, 188-209.

[22] Lucas, Robert, “Asset Prices in an Exchange Economy,” Econometrica, 1978, 46, 1429—
    1444.

[23] Lucas, Robert, “Inflation and Welfare,” Econometrica, 2000, 68, 247-274.

[24] Milgrom, Paul, “Good News and Bad News: Representation Theorems and Applications,”
    Bell Journal of Economics, 1981, 12, 380-91.

[25] Parker, Jonathan and Bruce Preston, “Precautionary Saving and Consumption Fluctua-
    tions,” American Economic Review, 2005, 95, 1119-43.

[26] Reed, Robert and Christopher Waller, “Money and Risk Sharing,” Journal of Money,
    Credit, and Banking, 2006, 38, 6, 1599-1618.

                                               45
[27] Rocheteau, Guillaume and Randall Wright, “Money in Competitive Equilibrium, in Search
    Equilibrium, and in Competitive Search Equilibrium,” Econometrica, 2005, 73, 175-202.

[28] Shi, Shouyong, “A Divisible Search Model of Fiat Money,” Econometrica, 1997, 65, 75-102.

[29] Woodford, Michael, “Public Debt as Private Liquidity,” American Economic Review, 1990,
    77, 2, 93-98.




                                             46
