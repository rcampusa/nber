                                NBER WORKING PAPER SERIES




            OPTIMAL PROGRESSIVITY WITH AGE-DEPENDENT TAXATION

                                        Jonathan Heathcote
                                         Kjetil Storesletten
                                        Giovanni L. Violante

                                        Working Paper 25617
                                http://www.nber.org/papers/w25617


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     February 2019




We are grateful to Ricardo Cioffi for outstanding research assistance. We thank Andrés Erosa, Mark
Huggett, Axelle Ferriere, Guy Laroque, Magne Mogstad, Facundo Piguillem, Nicola Pavoni, various
seminar participants, and two anonymous referees for comments. Kjetil Storesletten acknowledges
support from the European Research Council (ERC Advanced Grant IPCDP-324085), as well as from
Oslo Fiscal Studies. The views expressed herein are those of the authors and not necessarily those
of the Federal Reserve Bank of Minneapolis or the Federal Reserve System or the National Bureau
of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2019 by Jonathan Heathcote, Kjetil Storesletten, and Giovanni L. Violante. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Optimal Progressivity with Age-Dependent Taxation
Jonathan Heathcote, Kjetil Storesletten, and Giovanni L. Violante
NBER Working Paper No. 25617
February 2019
JEL No. E20,H2,H21,H31,H41

                                             ABSTRACT

This paper studies optimal taxation of earnings when the degree of tax progressivity is allowed to vary
with age. The setting is an overlapping-generations model that incorporates irreversible skill investment,
flexible labor supply, ex-ante heterogeneity in the disutility of work and the cost of skill acquisition,
partially insurable wage risk, and a life cycle productivity profile. An analytically tractable version
of the model without intertemporal trade is used to characterize and quantify the salient trade-offs
in tax design. The key results are that progressivity should be U-shaped in age and that the average
marginal tax rate should be increasing and concave in age. These findings are confirmed in a version
of the model with borrowing and saving that we solve numerically.


Jonathan Heathcote                                  Giovanni L. Violante
Federal Reserve Bank of Minneapolis                 Department of Economics
Research Department                                 Princeton University
90 Hennepin Ave.                                    Julis Romo Rabinowitz Building
Minneapolis, MN 55401                               Princeton, NJ 08540
heathcote@minneapolisfed.org                        and NBER
                                                    glv2@princeton.edu
Kjetil Storesletten
Department of Economics
University of Oslo
P.O. Box 1095 Blindern
0317 Oslo
Norway
kjetil.storesletten@econ.uio.no
1 Introduction
A central problem in public finance is to design a tax and transfer system to pay for public goods
and provide insurance to unfortunate individuals while minimally distorting labor supply and
investments in physical and human capital. One potentially important tool for mitigating tax
distortions is “tagging”: letting tax rates depend on observable, immutable, or hard-to-modify
personal characteristics. This idea was proposed first by Akerlof (1978) and has recently gained
new attention in the policy debate (see, for example, Banks and Diamond, 2010). Age is one
such characteristic.
   The purpose of this paper is to study optimal labor income taxation in a setting in which
the parameters of the tax system are allowed to vary with age. We do not study fully optimal
Mirrleesian tax system design. Rather, we restrict attention to the parametric class of income
tax and transfer systems given by

                                        T (y) = y − λy1−τ ,                                        (1)

where y is gross income and T (y) is taxes net of transfers. The parameter τ controls the pro-
gressivity of the tax system, with τ = 0 corresponding to a flat tax rate and τ > 0 (τ < 0)
implying a progressive (regressive) tax and transfer system. Conditional on τ, the parameter λ
controls the level of taxation. This class of tax systems has a long tradition in public finance; see,
for example, Musgrave (1959), Jakobsson (1976), Kakwani (1977) and, more recently, Bénabou
(2000, 2002) and Heathcote, Storesletten, and Violante (2017).
    The key innovation in the present paper is to let the parameters λ and τ in eq. (1) be condi-
tioned on age, so that both the level and the progressivity of the tax schedule can be made age
dependent.
   In Heathcote et al. (2017), we document that the parametric class in eq. (1) provides a re-
markably good approximation to the actual tax and transfer scheme in the US for households
aged 25-60. In particular, eq. (1) implies that after-tax earnings y − T (y) should be a log-linear
function of pre-tax earnings y. Using data from the Panel Study of Income Dynamics (PSID),
Heathcote et al. (2017) show that a linear regression of the logarithm of post-government earn-
ings on the logarithm of pre-government earnings yields a very good fit, with an R2 of 0.93:
when plotting average post-government against pre-government earnings for each percentile
of the sample, the relationship is virtually log-linear.
    In that paper, we did not investigate whether the current tax/transfer system de facto features
elements of age dependence in progressivity. For example, one may think that certain transfers
(e.g., UI benefits, child benefits) and certain provisions (e.g., mortgage interest and medical


                                                  1
                                                    0.5
                                                                                       US constant
                                                    0.4
                                                                                       US age varying




                           US Progressivity ( US)
                                                    0.3



                                                    0.2



                                                    0.1



                                                      0



                                                    -0.1
                                                        25   30   35   40         45   50     55        60
                                                                            Age

Figure 1: The coefficient τ estimated from a regression of log disposable income y − T (y) on log gross
income y, where intercept and slope are both allowed to vary with age. The straight line is the estimated
τ US = 0.181 when age dependence is not allowed in the regression. See Heathcote et al. (2017) for
details on the 2000-2006 PSID data used in this estimation, and on the construction of y and T (y) at the
household level.


expenditure deductibility) would effectively induce some age dependence. We have therefore
repeated our previous estimation, allowing the intercept and slope parameters to both depend
on age. Figure 1 plots the estimated τ for each age group together with the estimated age-
invariant τ US = 0.181. The main finding is that there is no significant age dependence in
progressivity embedded in the current US system.
   The aim of this paper is to explore whether there is scope for improving the current US tax
and transfer system by introducing explicit age dependence. Our environment, which closely
follows Heathcote et al. (2017), is an overlapping-generations model in which individuals care
about consumption, leisure, and a publicly provided good. Individuals make an irreversible
skill investment when young and make a labor-leisure choice in each period of working life.
People differ ex ante in their learning ability and in their willingness to work. Those with higher
learning ability invest in higher skills, and those with a lower utility cost of effort work more
hours. Skills are imperfect substitutes, and the price of skills is an equilibrium outcome. Deter-
ministic life-cycle profiles for labor productivity and for the disutility of work generate system-
atic age variation in average wages, hours, and consumption. During working life, individuals
face idiosyncratic shocks to their productivity that can only be partially insured privately. The
uninsurable (and permanent) component of these wage shocks passes through to consumption,
generating a rising age profile for within-cohort consumption inequality, as in the data.
  Tax progressivity compresses ex post dispersion in consumption. Thus, the social insurance
embedded in the tax and transfer system partially offsets inequality in initial conditions and


                                                                            2
also provides a substitute for missing private insurance against life-cycle shocks. However,
tax progressivity discourages labor supply and skill investment. Because the skill choice is
determined by the after-tax return, the tax system affects the equilibrium skill distribution and,
therefore, pre-tax skill prices.
   Most of our analysis focuses on a version of the model in which there are no markets for
intertemporal borrowing and lending. In this environment, we are able to derive a closed-form
solution for an equally-weighted steady-state social welfare function, which we use to build
intuition about the drivers of optimal age variation in tax progressivity. Toward the end of the
paper, we extend the analysis to allow for life-cycle borrowing and lending. In this case, we
must solve for equilibrium allocations numerically, but the optimal policy turns out to be quite
similar.
   A first result is that, for any age profile for τ, the optimal age profile for the tax level param-
eter λ (which controls the average level of taxation) equates average consumption by age. This
convenient separation between the roles of λ and τ arises because under our balanced-growth-
consistent utility specification, λ has no impact on either skill investment or labor supply.
   The shape of the optimal age profile for the tax progressivity parameter τ trades off two key
forces.
   First, age is informative about the dispersion of productivity. Dispersion in productivity is in-
creasing with age because individuals face permanent idiosyncratic shocks that cumulate over
the life cycle. To the extent that these shocks are privately uninsurable, they will translate into
increasing consumption dispersion with age. The planner has an incentive to target redistribu-
tion where inequality is concentrated, namely among the old. This uninsurable risk channel is a
force for having progressivity increase with age.
   Second, age is informative about average earnings, since wages net of the disutility of work
are increasing during the first decades of working life. Given a generally progressive tax sys-
tem, an age-increasing earnings profile will imply increasing marginal tax rates. In order to
smooth marginal tax rates over the life cycle, the planner has an incentive to have progressivity
decline with age. This force for declining progressivity is amplified by the result that average tax
rates optimally rise with age (via a declining profile for λ) in order to smooth average consump-
tion over the life cycle. Having progressivity decline with age allows the planner to smooth
marginal tax rates even as average tax rates rise. We call this mechanism the life cycle channel.
   Our quantitative analysis, with the model calibrated to the US economy, implies that, on
their own, life-cycle accumulation of uninsurable risk and life-cycle variation in productivity
each call for significant variation in tax progressivity over the life cycle. When both factors are
combined, the two effects roughly offset, implying an optimal profile for progressivity τ that is


                                                  3
U-shaped in age.
   Because skill investment is irreversible, a tax reform induces a transition. In the economy
without borrowing and lending we are able to compute the full transitional dynamics for the
Ramsey planner who can vary tax parameters freely by both time and age. Here, the plan-
ner has an incentive to set a high value for progressivity for existing cohorts who have al-
ready made their skill investment decisions, while keeping progressivity low for new skill-
investment-elastic generations. Throughout the transition, the average level of progressivity
changes, but the age profile within each cohort remains U-shaped.
   In this benchmark economy without intertemporal trade, part of the gains from age-dependent
taxation accrue because the planner lets the average tax rate increase with age in order to
redistribute from the (more productive) old to the (less productive) young. If households
could smooth consumption independently via borrowing and lending, this rationale for an
age-varying tax system would presumably be weakened. How would this change the optimal
age profile for progressivity?
   To answer this question, we extend our model to allow households to trade a bond in zero
net supply. We then solve numerically for allocations and for the optimal age-dependent tax
system under various borrowing limits. Our simulations confirm the intuition that, with very
loose liquidity constraints, the life cycle channel vanishes. However, when we calibrate the
value for the borrowing limit based on data from the Survey of Consumer Finances, the optimal
age profile for τ is quite close to the one for the baseline economy without intertemporal trade.
The welfare gains of moving from the current age-invariant tax system to the optimal age-
varying one are now around 2% of lifetime consumption.
   Finally, we note that this U shape in the age profile for optimal progressivity becomes flatter
in two empirically relevant cases. First, when the labor supply elasticity rises with age as work-
ers approach retirement (in the spirit of Ndiaye, 2017). Second, when part of the hump-shaped
age profile for household consumption in the data is explained by changing demographics. In
this case, a portion of consumption variation by age is efficient, weakening the motive for re-
distribution across age groups.


Related Literature. We are not the first to study motives for age dependence in the optimal
design of tax schedules. Several antecedents of ours follow the Ramsey tradition. Erosa and
Gervais (2002) analyze optimal taxation in a life-cycle economy without any sources of within-
cohort heterogeneity (i.e., all inequality is between age groups). They focus on models in which
the age dependence in average tax rates is driven by the fact that the Frisch elasticity of labor
supply varies over the life cycle. This channel depends on preference specifications. In our


                                                4
baseline model, we have abstracted from this channel by choosing a specification in which the
Frisch elasticity is constant, but in an extension we allow the Frisch to vary with age. Conesa
et al. (2009) study optimal taxation within a Gouveia-Strauss class of non-linear tax functions.
While more flexible than ours, this class of functions is less analytically tractable. They do not
explicitly model age dependence, but they point out that a positive tax on capital income can
stand in for age-dependent taxes because the age profile of wealth is correlated with that of
productivity. Karabarbounis (2017) explores optimal age-varying taxation numerically using
the same functional form for the net tax and transfer system as we do. However, he restricts
attention to optimal age variation in the λ parameter – which controls the level of taxes – while
assuming an age-invariant value for the progressivity parameter τ. We find additional welfare
gains from allowing both parameters to depend on age.
   A more recent literature studies the role of age variation in the Mirrleesian optimal taxation
framework. Three papers are especially related to our work. The first is by Weinzierl (2011),
who focuses on the rising age profile of wages, and on how these profiles differ across skill
groups. His key finding, namely that optimal average and marginal tax rates are both rising
with age, is qualitatively similar to ours when the only operational channel is life-cycle produc-
tivity. The second related paper is Farhi and Werning (2013), who analyze taxation in a dynamic
life-cycle economy. They focus on the role of persistent productivity shocks. In their numerical
example, the fully optimal history-dependent tax schedule displays the same qualitative fea-
tures as our model when our risk channel is the only one operative: average wedges increase
with age, average labor earnings are falling with age, and average consumption is constant.
These findings are mirrored in the work of Golosov et al. (2016), who focus on the additional
effect of skewness of wage shocks. Ndiaye (2017) extends Farhi and Werning to allow for a dis-
crete retirement choice, which reduces optimal marginal tax rates around the age of retirement
when labor supply is relatively elastic.
    More recently, the Mirrleesian strand of the optimal tax literature has begun incorporating
endogenous human capital accumulation into the optimal design problem.1 Most closely re-
lated to ours are the papers by Best and Kleven (2013) and Stantcheva (2017). Best and Kleven
(2013) extend the canonical Mirrleesian framework to incorporate endogenous on-the-job learn-
ing in a simple two-period model where working more hours increases productivity through-
out one’s career. This mechanism makes the labor supply elasticity lower for the young (whose
return to work also accrues in the future) and offers an argument for decreasing marginal taxes
with age. In our paper, we abstract from learning by working and highlight the role of skill
acquisition before entry in the labor market.
  1 See,   for example, Kapička (2015) and Findeisen and Sachs (2016).



                                                          5
   Stantcheva (2017) studies optimal Mirrleesian taxation over the life cycle in a model in which
individuals can endogenously accumulate human capital by spending on education. Her model
and analysis differs from ours in several respects. First, she studies the role of human capital
in increasing or reducing wage risk, while risk is independent of skill in our model. Second,
she shows that to implement the constrained efficient allocation one needs policy tools that
directly target the skill investment margin, such as education subsidies or income-contingent
loans, while we focus exclusively on the design of the tax/transfer system.
    Interestingly, recent contributions in this literature have demonstrated that indexing tax
rates by age can capture most of the potential welfare gains from fully optimal, history-dependent
policies (e.g., Farhi and Werning 2013; Golosov et al., 2016; Stantcheva, 2017; and Weinzierl,
2011).
   With respect to this existing set of results, our contribution is threefold. First, we offer a
closed-form expression for social welfare as a function of the vector {τa } and the structural
parameters of the model describing preferences, technology, ex ante heterogeneity, and ex post
uncertainty. Each term in our welfare expression has an economic interpretation and embodies
one of the channels shaping the optimal progressivity trade-off discussed above. Second, we
find that the life-cycle channel is quantitatively most important in the first half of the working
life, when average wages are rising fast, while the uninsurable risk matters more later in life as
permanent shocks cumulate. This distinction explains our novel result that optimal progressiv-
ity is U-shaped in age. Third, we identify a new motive for age variation in taxation that hinges
on the presence of endogenous and irreversible skill investment and that operates only during
the transition.
   The paper proceeds as follows. Sections 2 and 3 lay out the economic environment and
solve for the competitive equilibrium given a tax policy. Section 4 discusses the social welfare
function and Section 5 derives analytical properties of optimal taxes in steady state and during
the transition. Section 6 studies the quantitative implications of allowing for age variation in
taxes and calculates the welfare gain of introducing such fiscal tools. Section 7 develops the
extension of the model with intertemporal trade. Section 8 concludes.


2 Economic environment
Demographics: The model has a standard overlapping-generations structure. Agents enter the
economy at age a = 0 and live for A periods. The total population is of mass one, and thus each
age group is of mass 1/A. There are no intergenerational links. We index agents by i ∈ [0, 1].
To simplify notation, we will abstract from time subscripts until we explore the transition from


                                                6
one tax system to another in Section 5.2.
Life cycle: Upon birth, individuals have a chance to invest in skills si . Once the individual has
chosen si , he or she enters the labor market. The individual provides hi ≥ 0 hours of labor
supply, consumes a private good ci , and enjoys a publicly provided good G.2 Each period he or
she faces stochastic fluctuations in labor productivity zi .
Preferences: Expected lifetime utility over private consumption, hours worked, publicly pro-
vided goods, and skill investment effort for individual i is given by
                                                                  A −1
                                                          1−β
                            Ui = −vi (si ) + E0                     ∑      β a ui (cia , hia , G ),              (2)
                                                         1 − βA     a=0

where β ≤ 1 is the discount factor, common to all individuals, and the expectation is taken over
future idiosyncratic productivity shocks, whose process is described below. The disutility of
the initial skill investment si ≥ 0 takes the form

                                                     (κi )−1/ψ
                                         vi ( si ) =           (si )1+1/ψ ,                                      (3)
                                                     1 + 1/ψ

where the parameter ψ ≥ 0 controls the elasticity of skill investment with respect to the marginal
return to skill, and κi ≥ 0 is an individual-specific parameter that determines the utility cost of
acquiring skills. The larger is κi , the smaller is the cost, so one can think of κi as indexing innate
learning ability. We assume that κi ∼ Exp ( η ), an exponential distribution with parameter η.
As we demonstrate below, exponentially distributed ability yields Pareto right tails in the equi-
librium wage and earnings distributions. Skill investment decisions are irreversible, and thus
skills are fixed through the life cycle.3
    The period utility function ui is

                                                   exp [(1 + σ) ( ϕ̄ a + ϕi )]
                 ui (cia , hia , G ) = log cia −                               (hia )1+σ + χ log G,              (4)
                                                            1+σ

where exp [(1 + σ) ( ϕi + ϕ̄ a )] scales the disutility of work effort. The profile { ϕ̄ a } aA=−01 captures
the common and deterministic evolution in the disutility of work as individuals             age.
                                                                                                The pa-
                                                                                    vϕ
rameter ϕi is a fixed individual effect that is normally distributed: ϕi ∼ N 2 , v ϕ , where v ϕ
   2G   has two possible interpretations. The first is that it is a pure public good, such as national defense or the
judicial system. The second is that it is an excludable good produced by the government, such as public education,
that is distributed uniformly across households.
   3 The baseline model in Heathcote et al. (2017) assumes reversible skill investment. Given reversible investment,

the skill investment decision is essentially static, whereas in the present model it will be a dynamic decision.


                                                            7
denotes the cross-sectional variance. We assume that κi and ϕi are uncorrelated. The parame-
ter σ > 0 determines aversion to hours fluctuations. Finally, χ ≥ 0 measures the taste for the
publicly provided good G relative to private consumption.
Technology: Output Y is a constant elasticity of substitution aggregate of effective hours sup-
plied by the continuum of skill types s ∈ [0, ∞),

                                        ˆ       ∞                                        θ
                                                                         θ −1            θ −1
                                  Y=                 [ N̄ (s) · m (s)]     θ    ds              ,           (5)
                                             0

where θ > 1 is the elasticity of substitution across skill types, N̄ (s) denotes average effective
hours worked by individuals of skill type s, and m(s) is the density of individuals with skill
type s. Note that all skill levels enter symmetrically in the production technology, and thus any
equilibrium differences in skill prices will reflect relative scarcity.
Labor productivity and earnings: Log individual labor efficiency zia is the sum of three orthog-
onal components, x a , αia , and ε ia ,
                                        zia = x a + αia + ε ia .                              (6)

The first component x a captures the deterministic age profile of labor productivity, common
for all individuals. The second component αia captures idiosyncratic shocks that cannot be
insured privately, and follows the unit root process αia = αi,a−1 + ωia , with i.i.d. innovation
                   
ωia ∼ N − v2ω , vω and initial value αi0 = 0. The third component ε ia captures idiosyncratic
shocks that can be insured privately. The only property of the time series process for ε ia that
will matter for our welfare expressions and optimal taxation results is the age profile for the
cross-sectional variance, vε,a . For expositional simplicity we will therefore assume, without loss
of generality, that shocks to ε are drawn independently over time from a Normal distribution,
ε ia ∼ N (−vε,a /2, vε,a ), where vε,a captures the variance at age a.
     A standard law of large numbers ensures that none of the individual-level shocks induce
any aggregate uncertainty in the economy.
   Individual earnings yia are, therefore, the product of four components:

                   yia = p(si ) ×                exp( x a )        × exp(αia + ε ia ) × hia .               (7)
                         | {z }                  | {z }              |    {z       }   |{z}
                         skill price   age-productivity profile          labor market shocks        hours


The first component p(si ) is the equilibrium price for the type of labor supplied by an indi-
vidual with skills si ; the second component is the life-cycle profile of average labor efficiency;
the third component is individual stochastic labor efficiency; and the fourth component is the
number of hours worked by the individual. Thus, individual earnings are determined by (i)

                                                              8
skill investments made before labor market entry, in turn reflecting innate learning ability κi ;
(ii) productivity that grows exogenously with experience; (iii) fortune in labor market outcomes
determined by the realization of idiosyncratic efficiency shocks; and (iv) work effort, reflecting,
in part, innate and age-varying taste for leisure, defined by ϕi and ϕ̄ a . Taxation affects the
equilibrium pre-tax earnings distribution by changing skill investment choices, and thus skill
prices, and by changing labor supply decisions.
Financial assets: We adopt a simplified version of the partial-insurance structure developed
in Heathcote et al. (2014a). There is a full set of state-contingent claims for each realization
of the ε shock, implying that variation in ε is fully insurable. These claims are traded within
the period. Let Bia (E) and Q (E) denote the quantity and the price, respectively, of insurance
claims purchased that pay one unit of consumption if and only if ε ∈ E ⊆ R.4 In Section 7 we
introduce borrowing and lending, solve for the equilibrium numerically, and explore how this
alternative market structure changes optimal tax policy.5
Labor and goods markets: The final consumption good and all types of labor services are
traded in competitive markets. The final good is the numéraire of the economy.
Government: The government runs a tax and transfer scheme and provides each household
with an amount of goods or services equal to G. This public good can only be provided by
the government, which transforms final goods into G one for one. Let g denote government
expenditures as a fraction of aggregate output (i.e., G = gY).
   Let Ta (y) be the net tax owed at income level y by age group a. We study optimal policies
within the class of tax and transfer schemes defined by the function

                                               Ta (y) = y − λa y1−τa ,                                                (8)

where the parameters τa and λa are specific to age group a. The specification of eq. (8) with
age-invariant parameters has a long tradition in public finance dating back to Feldstein, 1969.
Recently, Bénabou, 2000 and 2002 and Heathcote et al., 2014 and 2017 demonstrated its tractabil-
ity in the context of equilibrium macroeconomic models. Heathcote and Tsujiyama (2016) have
shown that in a static environment, this functional form can closely approximate the fully opti-
mal Mirrleesian policy.
   4 An   alternative way to decentralize insurance with respect to ε is to assume that individuals belong to large
families and that shocks to α are common across members of a given family, while shocks to ε are purely idiosyn-
cratic and thus can be pooled within the family.
    5 In Heathcote et al. (2014), we allowed agents to trade a single non-contingent bond and showed that there is

an equilibrium in which this bond is not traded, given that idiosyncratic wage shocks follow a unit root process.
This result does not generalize to the present model because age variation in efficiency and disutility ( x a , ϕ̄ a ) and
in the tax parameters τa and λ a introduces motives for intertemporal borrowing and lending.

                                                            9
   The parameter τa determines the degree of progressivity of the tax system and is the key
object of interest in our analysis. There are two ways to see why τa is a natural index of pro-
gressivity. First, eq. (8) implies the following mapping between individual disposable (post-
government) earnings ỹ and pre-government earnings y:

                                          ỹ = λa y1−τa .                                      (9)

Thus, (1 − τa ) measures the elasticity of disposable to pre-tax income. Second, a tax scheme is
commonly labeled progressive (regressive) if the ratio of marginal to average tax rates is larger
(smaller) than one for every level of income y. Within our class, we have

                                       1 − Ta′ (y)
                                                   = 1 − τa .                                 (10)
                                     1 − Ta (y) /y

When τa > 0, marginal rates always exceed average rates, and the tax system is therefore
progressive. Conversely, when τa < 0, the tax system is regressive. The case τa = 0 implies that
marginal and average tax rates are equal: the system is a flat tax with rate 1 − λa .
    Given τa , the second parameter, λa , shifts the tax function and determines the average level
                                                                           1
of taxation in the economy. At the break-even income level y0a = (λa ) τa > 0, the average tax
rate is zero and the marginal tax rate is τa for that age group. If the system is progressive
(regressive), then at every income level below (above) y0a , the average tax rate is negative and
households obtain a net transfer from the government. Thus, this function is best seen as a tax
and transfer schedule, a property that has implications for the empirical measurement of τa . The
income-weighted average marginal tax rate (MTR) at age a given this tax and transfer schedule
is
                                                     (yia )1−τa di
                                                       ´
                             MTRa = 1 − λa (1 − τa ) ´             .                          (11)
                                                         yia di
   The government must run a balanced budget, and the government budget constraint is
therefore
                       A −1 ˆ          A −1 ˆ h                    i
                     g ∑      yia di = ∑        yia − λa (yia )1−τa di.          (12)
                            a=0           a=0

The government chooses g and the sequences {τa , λa } aA=−01, with one instrument being deter-
mined residually by eq. (12). Since the budget constraint holds at the aggregate level (not at the
level of each age group), the government can redistribute both within and between age groups.
   The rate of transformation between private and public consumption is one, and thus the
aggregate resource constraint for the economy (recall population has measure 1 so aggregates



                                                10
equal averages) is
                                                        A −1 ˆ 1
                                               1
                                        Y = G+          ∑          cia di.                      (13)
                                               A        a=0   0


2.1 Individual problem
At age a = 0, the individual chooses a skill level, given her idiosyncratic draw (κi , ϕi ). Com-
bining eqs. (2) and (3), the first-order necessary and sufficient condition for the skill choice
is
                                    1                A −1
                     ∂vi (si )      si ψ     1−β              a ∂ui ( cia , hia , G )
                               =         =           E 0 ∑ β                          .         (14)
                       ∂si          κi       1−β A
                                                         a=0            ∂si
Thus, the marginal disutility of skill investment for an individual with learning ability κi must
equal the discounted present value of the corresponding expected benefits in the form of higher
lifetime wages. Recall that initial skill investments are irreversible, and thus older agents cannot
supplement or unwind past skill investments.
   At the beginning of every period of working life a, the innovation ωia to the random walk
shock αia is realized. Then, the insurance markets against the ε ia shocks open and the individual
buys insurance claims B (·). Finally, ε ia is realized, insurance claims pay out, and the individual
chooses hours hia , receives wage payments, and chooses consumption expenditures cia . Thus,
the individual budget constraint in the middle of the period, when the insurance purchases are
made, is                             ˆ
                                                Q (ε) Bia (ε) dε = 0,                           (15)
                                            E
and the budget constraint at the end of the period, after the realization of ε ia , is

                        cia = λa [ p(si ) exp ( x a + αia + ε ia ) hia ]1−τa + B(ε ia ).        (16)

     Given an initial skill choice si , the problem for an agent is to choose insurance purchases,
consumption, and hours worked in order to maximize lifetime utility (2) subject to sequences
of budget constraints (15)-(16), taking as given the process for efficiency units described in eq.
(6). In addition, agents face non-negativity constraints on consumption and hours worked.


3 Equilibrium
We now adopt a recursive formulation to define a stationary competitive equilibrium for our
economy. The state vector for the skill accumulation decision at age a = 0 is just the pair of fixed


                                                       11
individual effects (κ, ϕ). At subsequent ages, the state vector for the beginning-of-the-period
decision when insurance claims are purchased is ( ϕ, s, a, α). The individual state vector for the
end-of-period consumption and labor supply decisions is ( ϕ, s, a, α, ε).6 Note that age is a state
variable for two reasons: (i) labor productivity and the disutility of work vary with age, and (ii)
the parameters of the tax system potentially vary with age. What makes the model tractable, in
spite of all the heterogeneity and risk it features, is that all the individual states are exogenous.
   We now define a stationary recursive competitive equilibrium for our economy. Stationarity
requires that equilibrium skill prices are constant over time, which in turn requires an invariant
skill distribution m(s). A stationary skill distribution is consistent with a time-invariant tax
schedule, which is the focus of our steady-state welfare analysis. However, when we later
consider optimal once-and-for-all tax reforms and incorporate the transition from the current
tax system, the economy-wide skill distribution will vary deterministically over time. In that
case, an additional assumption is required to preserve tractability. We turn to the transition case
in Section 5.2.
    Given a tax/transfer system ({τa } , {λa }), a stationary recursive competitive equilibrium for our
economy is a public good provision level g, asset prices Q (·), skill prices p (s), decision rules
s (κ, ϕ), c ( ϕ, s, a, α, ε), h ( ϕ, s, a, α, ε), and B (·; ϕ, s, a, α), effective hours by skill N̄ (s), and a skill
density m(s) such that:

   1. Households solve the problem described in Section 2.1, and s (κ, ϕ), c ( ϕ, s, a, α, ε), h ( ϕ, s, a, α, ε),
      and B (·; ϕ, s, a, α) are the associated decision rules.

   2. Labor markets for each skill type clear and p (s) is the value of the marginal product from
      an additional unit of effective hours of skill type s:

                                                                           1
                                                                  Y          θ
                                              p(s ) =                            .
                                                            N̄ (s) · m(s)

   3. The skill density m(s) is consistent with individual decisions.

   4. Insurance markets clear, and the prices Q (·) are equal to the probabilities that the realiza-
      tion for ε is in the corresponding set.

   5. The government budget is balanced: g satisfies eq. (12).

   6 Sinceequilibrium insurance payouts B(ε; ϕ, s, a, α) are a known function of all the other individual states, in
what follows we omit them from the state vector.




                                                         12
   By Walras’ law, the goods market clears and eq. (13) holds.
   Propositions 1 and 2 below describe the equilibrium allocations and skill prices in closed
form. The benefits from analytical tractability will be evident in Propositions 3 and 4, where we
derive a set of results for optimal taxation based on a closed-form expression for social welfare.
Proposition 1 [hours and consumption]. The equilibrium allocations of hours worked and consump-
tion are given by
                                                           
                         log(1 − τa )                1 − τa         1
     log h ( ϕ, a, ε) =               − ϕ̄ a − ϕ +            ε−        Ca ,                      (17)
                            1+σ                      σ + τa      σ + τa
                                                                                          
                                                                 log(1 − τa )
   log c ( ϕ, s, a, α) = log λa + (1 − τa ) log p(s) + x a + α +              − ( ϕ̄ a + ϕ) + C a (18)
                                                                    1+σ

   where C a = (vε,a /2) · (1 − τa ) (1 − 2τa − στa ) /(σ + τa ).
   With logarithmic utility and zero individual wealth, the income and substitution effects on
labor supply from differences in skill levels s, experience x a , and uninsurable shocks α exactly
offset, and hours worked are therefore independent of (s, x a , α) and of λa (the level of taxation)
and depend on age only through the age-dependent progressivity rate τa and the constant C a .
The hours allocation is composed of four terms. The first term captures the effect of taxes
on labor supply in the absence of within-age heterogeneity. This can be interpreted as the
hours of a “representative agent”of age a. This term depends on age through progressivity and
disutility of work, and is decreasing in both arguments. The second captures the fact that a
higher disutility of work leads an agent to choose lower hours. The third term captures the
response of hours worked to an insurable shock ε. Note that it has no income effect precisely
because it is insurable. The response here is proportional to the tax-modified Frisch elasticity
(1 − τa )/(σ + τa ). This elasticity collapses to the standard Frisch elasticity 1/σ when τa = 0.
Note that a progressive system (τa > 0) dampens the response of hours to insurable shocks. The
fourth term captures the welfare-improving effect of insurable wage variation. As illustrated
by Heathcote et al. (2008), greater dispersion of insurable shocks allows agents to work more
when they are more productive and take more leisure when they are less productive, thereby
raising average productivity, average leisure, and welfare. Progressivity weakens this effect
because it reduces the covariance between hours and wages.
    Consumption is increasing in the skill price p(s), in the predictable component of labor
efficiency x a , and in the uninsurable stochastic component of wages α. Since hours worked
are decreasing in the disutility of work ( ϕ̄ a + ϕ), so are earnings and consumption. The re-
distributive role of progressive taxation is evident from the fact that a larger τa shrinks the
pass-through to consumption from heterogeneity in initial conditions s and ϕ and from real-

                                                   13
izations of uninsurable shocks α and efficiency units x a . A lower level of taxation (higher λa )
increases consumption. Insurable variation in productivity has a positive level effect on av-
erage consumption in addition to average leisure. Again, higher progressivity weakens this
effect. Because of the assumed separability between consumption and leisure in preferences,
consumption is independent of the insurable shock ε.

Proposition 2 [skill price and skill choice]. In a stationary recursive equilibrium, skill prices are
given by
                                    log p(s) = π0 (τ̄ ) + π1 (τ̄ ) · s,                                    (19)
                                                        
                                                    1− β
where τ̄ is discounted average progressivity, τ̄ = 1− β A ∑ aA=−01 β a τa , and π1 (τ̄ ) and π0 (τ̄ ) are given
by

                            η    1              ψ
                                  1+ ψ        −
              π1 (τ̄ ) =      (1 − τ̄ ) 1+ψ                                                               (20)
                          θ                                              
                          1     1              1 − τ̄                       θ
              π0 (τ̄ ) =               ψ log            − log (η ) + log          .                       (21)
                         θ−1 1+ψ                 θ                         θ−1

   The skill investment allocation is given by

                                                                 hη               i    ψ
                                                      ψ                               1+ ψ
                           s (κ ) = [(1 − τ̄ ) π1 (τ̄ )] · κ =        (1 − τ̄ )              · κ,         (22)
                                                                  θ
                                                                                      1             ψ
and the equilibrium skill density m(s) is exponential with parameter η 1+ψ [θ/ (1 − τ̄ )] 1+ψ .
   Note, first, that the log of the equilibrium skill price takes a “Mincerian” form in the sense
that it is an affine function of s. The constant π0 (τ̄ ) is the base log price of the lowest skill level
(s = 0), and π1 (τ̄ ) is the pre-tax marginal return to skill.
   Eq. (20) indicates that higher average progressivity increases the equilibrium pre-tax marginal
return π1 (τ̄ ). The reason is that increasing progressivity compresses the skill distribution to-
ward zero, and as high skill types become more scarce, imperfect substitutability in production
drives up the pre-tax return to skill. Thus, our model features a “Stiglitz effect” (Stiglitz 1985).
The larger is ψ, the more sensitive is skill investment to a given increase in τ̄, and thus the larger
is the increase in the pre-tax skill premium.
    Note that the only aspect of the policy sequence ({ τa } , {λa }) that matters for the skill in-
vestment decision and the skill price function is discounted average progressivity, τ̄. Moreover,
skill investment is also independent of initial heterogeneity v ϕ , of the age profiles ({ x a } , { ϕ̄ a }),
and of risk (vω , {vε,a }). The logic is that, with log utility, the welfare gain from additional skill
investment is proportional to the log change in earnings such investment would induce, and


                                                      14
this log change is independent of all idiosyncratic states.
Corollary 2.1 [distribution of skill prices]. In a stationary equilibrium, the distribution of log skill
premia π1 (τ̄ ) · s(κ ) is exponential with parameter θ. Thus, the cross-sectional variance of log skill prices
is
                                                               1
                                            var (log p(s)) =     .
                                                              θ2
The distribution of skill prices p(s) in levels is Pareto with scale (lower bound) parameter exp(π0 (τ̄ ))
and Pareto parameter θ.
     Log skill premia are exponentially distributed because the log skill price is affine in skill s
(eq. 19) and skills retain the exponential shape of the distribution of learning ability κ (eq. 22). It
is interesting that inequality in skill prices is independent of the policy sequence ({ τa } , {λa }).
The reason is that progressivity sets in motion two offsetting forces. On the one hand, as dis-
cussed earlier, higher progressivity increases the equilibrium skill premium π1 (τ̄ ), which tends
to raise inequality in skill prices (the Stiglitz effect). On the other hand, higher progressivity
compresses the distribution of skill quantities. These two forces exactly cancel out under our
specification of preferences and technology.
   Since the exponent of an exponentially distributed random variable is Pareto, the distribu-
tion of skill prices in levels is Pareto with parameter θ. More complementarity (lower theta)
across skills in production stretches further the tail of the wage distribution as the most skilled,
and scarcest workers, command a higher premium. The other stochastic components of wages
(and hours worked) are lognormal, and thus the equilibrium distributions of wages, earnings,
and consumption are Pareto-lognormal. In particular, because the Pareto component domi-
nates at the top, it has a Pareto right tail, a robust feature of their empirical counterparts (see,
e.g., Atkinson et al., 2011).
    We now describe how taxation affects aggregate quantities in our model.

Corollary 2.2 [aggregate quantities]. Average hours worked, average effective hours and average
output are given by H ({τa }) = A1 ∑ aA=−01 H ( a, τa ) , N̄ ({τa }) = A1 ∑aA=−01 N (a, τa ) , and Y ({τa }) =




                                                      15
1
A   ∑ aA=−01 Y ( a, τa ) , where

            H ( a, τa ) = E [h ( ϕ, a, ε)]                                                                                 (23)
                                                                      "                                            #
                                        1                                 (1 − τa ) (2τa + σ (1 + τa )) vε,a
                          = (1 − τa ) 1+σ · exp (− ϕ̄ a ) · exp                                              .
                                                                                    (σ + τa )2           2
            N ( a, τa ) = E [exp( x a + α + ε)h ( ϕ, a, ε)]                                                                (24)
                                            "                                                                !         #
                                        1                                  1 − τa                                vε,a
                          = (1 − τa ) 1+σ · exp x a − ϕ̄ a +                          2
                                                                                          (σ + 2τa + στa )            .
                                                                          (σ + τa )                               2
             Y ( a, τa ) = E [ p (s)] · N ( a, τa ) ,                                                                      (25)

with E [ p ( s)] = exp (π0 (τ̄ )) · θ/ ( θ − 1).


4 Social welfare function
The baseline utilitarian social welfare function we use to evaluate alternative policies puts equal
weight on all agents within a cohort. In our context, where agents have different disutilities of
work effort, we define equal weights to mean that the planner cares equally about the utility
from consumption of all agents. Thus, the contribution to social welfare from any given cohort
is the within-cohort average value of remaining expected lifetime utility, where eq. (2) defines
individual expected lifetime utility at age zero. The overlapping-generations structure of the
model also requires us to take a stand on how the government weights cohorts that enter the
economy at different dates. We assume that the planner discounts lifetime utility of future
generations at the same rate β as individuals discount utility over the life cycle.
   We start by focusing
                        on optimal steady-state policy, defined as the optimal time-invariant
policy {τa , λa } aA=−01 , G that maximizes welfare in the associated steady state. In a steady state,
expected lifetime utility is identical for each cohort. Moreover, given the assumption that the
planner discounts across generations at rate β, average social welfare W ss ({τa , λa } , g) is simply
equal to average utility in a cross section:

                                            A −1
                 ss               1
              W ({τa , λa } ,G) =           ∑      E [u (c ( ϕ, s, a, α) , h ( ϕ, a, ε) , G )] − E [v (s(κ ), κ )] ,       (26)
                                  A         a=0

where the first expectation is taken with respect to the equilibrium cross-sectional distribution
of ( ϕ, s, α, ε) conditional on a, and the second expectation is with respect to the
                                                                                   cross-sectional
                                                                                                 
distribution of (s, κ ). The “Ramsey problem” of the government is to choose { τa , λa } aA=−01 , G
in order to maximize (26) subject to the government budget constraint (12), where lifetime

                                                                16
utilities are given by (2), equilibrium allocations are given by (17) and (18), and equilibrium
skill prices are given by (19).
   In Section 5.2 we will consider time-varying policies that maximize welfare incorporating
transition from the current tax system. In particular, we will assume an unanticipated policy
change at date t = 0 from a pre-existing age- and time-invariant policy to a new policy regime
in which the new policy parameters can vary freely by both age and time. The irreversibility of
the existing stock of skills induces transitional dynamics toward the new steady state.
    There are two special cases in which policies that maximize steady-state welfare are identical
– in welfare terms – to those that maximize welfare incorporating transition. The first is the
case in which β → 1. In this case, there is a transition to the new steady state, but because the
planner is perfectly patient, existing cohorts receive zero weight in social welfare relative to the
planner’s concern for future cohorts. Thus, the planner effectively seeks to maximize steady-
state welfare.7 In particular, note that when β = 1, social welfare is simply expected lifetime
utility for a cohort entering in the new steady state, U ss . Then note that in the expression for
                                      1− β
lifetime utility (eq. 2), the weight 1− β A β a → A1 as β → 1.
  The second special case in which incorporating transition makes no difference is the case in
which skills are perfect substitutes (θ → ∞) so that there is no skill investment in equilibrium.
In this case, transition in response to a change in the tax system is instantaneous, and social
welfare incorporating transition is therefore equal to average period utility in the cross section
– that is, equal to steady-state welfare.8


5 Optimal age-dependent taxes: characterization
For ease of exposition, it is convenient to begin by abstracting from transitional dynamics and to
consider optimal policy design in steady state with β = 1. This approach also has the advantage
that we can derive a number of analytical results for optimal taxation. Recall that given β =
1, transition is irrelevant for welfare, so the policy that is optimal in steady state can also be
interpreted as a policy that maximizes welfare incorporating transition.
   7 Notethat here we are assuming that under the optimal policy the economy does indeed converge to a steady
state.
   8 An additional way to achieve an instantaneous transition to the new steady state is to assume that skill in-

vestment is fully reversible at any age and date. In our view, irreversible skill investment is the more realistic
case.




                                                       17
5.1        Steady-state welfare
We start by characterizing the optimal choices of g and { λa } for any given sequence of age-
dependent progressivity { τa }.
Proposition 3 [optimal g and { λa }]. For any given sequence {τa }: (i) The optimal share of govern-
ment expenditure in output g∗ is given by

                                                      χ
                                              g∗ =       .
                                                     1+χ

(ii) The optimal sequence {λ∗a } equalizes average consumption across age groups.
   Part (i) re-establishes a result in Heathcote et al. (2017) in our more general environment
with an age-dependent tax system. The optimal fraction of output devoted to public goods is
independent of how much inequality there is in the economy and independent of the progres-
sivity of the tax system. It depends only on households’ relative taste for the public good χ.
Since neither g nor λa appear in the equilibrium allocations for hours worked or skill invest-
ment, changing g will not affect aggregate income or its distribution across households. As a
consequence, the government’s only concern in choosing g is to optimally divide output be-
tween private and public consumption, exactly as in a version of our economy without any
heterogeneity (i.e., the “representative agent economy” in Heathote et al., 2017). In particular,
the planner chooses public spending so as to equate the marginal rate of substitution between
private and public consumption to the marginal rate of transformation between the two goods,
the so-called Samuelson condition.9
   The result in part (ii) states that the planner modulates the level of taxation for each age
group {λa } in order to equate the marginal utility of average consumption across age groups.
Due to the separability in preferences between consumption and leisure, this implies that aver-
age consumption is equated across age groups. Thus, through the choice for the sequence { λa },
the government can effectively replicate the role of life-cycle borrowing and saving, absent in
the model by assumption, in smoothing predictable life-cycle income variation.
   One can substitute the optimal decisions for g∗ and {λ∗a } along with the closed-form expres-
sions described above for equilibrium allocations into the expression for steady-state welfare,
W ss (eq. 26). One can then express welfare analytically as a function of model parameters and
  9 See,for example, Kaplow (2004) for an extended discussion of the Samuelson rule for optimal public good
provision and its optimal financing.




                                                    18
of the vector of age-dependent progressivity {τa } as follows:

                           A −1
                       1               1 − τa
  W ss ({τa }) = −         ∑                                                                                                         (27)
                       A   a=0
                                       1+σ
                                       | {z }
                                  Disutility of labor
                                         (                                                                                       )
                                             A −1                  1                               τa (1 + σ̂a )    1        vε,a
                     + (1 + χ) log           ∑      (1 − τa )     1+ σ   · exp x a − ϕ̄ a +               2
                                                                                                                 +
                                             a=0                                                        σ̂a        σ̂a        2
                                         |                                               {z                                          }
                                                                              Effective hours worked N̄a
                                             "                                                                 θ (1+ψ) !#
                                    1                                                           1          θ
                     +(1 + χ)                  ψ log (1 − τ̄ ) + log
                              (1 + ψ)(θ − 1)                                                   ηθ ψ       θ−1
                              |                               {z                                                             }
                                     Productivity from skill investment: log(average skill price) = log(E [ p(s)])
                                                        A −1                                      
                         ψ 1 − τ̄   1                                                1 − τa      1 − τa
                     −            +                     ∑         log 1 −                     +
                       1+ψ θ        A                   a=0
                                                                                       θ           θ
                       |  {z    }                             |                          {z              }
                       Avg. education cost                               Consumption dispersion across skills
                                             A −1
                                         1        1                      
                                     −       ∑      (1 − τa )2 v ϕ + avω                                  .
                                         A   a=0 |2          {z          }
                     Cons. dispersion due to uninsurable risk and preference heterogeneity


   Each term in this welfare expression can be given an intuitive economic interpretation (de-
scribed in the bracket below each term), along the lines of the analysis contained in Heathcote et
al. (2017). The following proposition establishes some properties of W ss ({ τa }) and of optimal
age-dependent progressivity.
Proposition 4 [optimal age dependent progressivity]. The steady state social welfare function
W ss ({τa }) is differentiable and globally concave in τa provided that σ is sufficiently large (a sufficient
condition is that σ ≥ 2). Moreover:
(i) The necessary and sufficient first-order condition ∂W ss ({ τa }) /∂τa = 0 implicitly determining the
optimal τa∗ can be stated analytically as:

                                  1        1                               1
                    0 =                  − + (1 − τa∗ ) v ϕ + avω +             +                                                    (28)
                             θ − 1 + τa∗   θ                             1+σ
                                                         
                                   1+χ           1        1      ψ
                             −                          −
                                   θ − 1 1 − τ̄ ({ τa }) θ 1 + ψ
                                                    ∗
                                      "                              #
                                 1+χ          1         σ+1 3 ∗            N ( a, τa∗ )
                             −                     +             τ  v
                                                                   a ε,a                ,
                                 1+σ       1 − τa∗     σ + τa∗             N̄ ({ τa∗ })

(ii) The optimal sequence {τa∗ } is age invariant if the following three conditions simultaneously hold:


                                                                  19
(1) uninsurable risk does not change over the life cycle (vω = 0), (2) insurable risk does not change over
the life cycle (vε,a is constant), and (3) the age profile for efficiency net of work disutility { x a − ϕ̄ a } is
constant.
(iii) Relative to the parameterization described in (ii), introducing permanent uninsurable risk (vω > 0)
translates into an optimal profile {τa∗ } that is increasing in age.
(iv) Relative to the parameterization described in (ii), if the variance of insurable risk increases with age
(vε,a+1 > vε,a ) and τa∗ > 0 at some age a, then τa∗+1 < τa∗ .
(v) Relative to the parameterization described in (ii), introducing age variation in efficiency net of disutil-
ity { x a − ϕ̄ a } translates into an optimal profile {τa∗ } that is the mirror image of the profile for { x a − ϕ̄ a }.
   The Appendix contains a formal proof of this proposition. In what follows, we offer some
intuition for results (ii)-(v).
   (ii) In this special case, the first-order condition simplifies to an expression where age a
does not appear, hence τa∗ is constant.10 Without loss of generality, to simplify the exposition,
consider the case θ → ∞ and vε,a = 0 for which case the first-order condition simpifies to
                                                                                
                                                    ∗   1                  1+χ          1
                                    0 = (1 − τ ) v ϕ +     −                                .
                                                       1+σ                 1+σ       1 − τ∗

where τ ∗ is the optimal age-invariant τ. It is immediate that τ ∗ is increasing in preference
heterogeneity v ϕ and is decreasing in the taste for the public good χ. Note that when v ϕ = 0,
τ ∗ = −χ. As we show in Heathcote et al. (2017), in this representative agent version of the
model (without any source of ex ante or ex post heterogeneity), a regressive tax system allows
for a positive average tax rate (which finances G) while ensuring that the representative agent
faces a zero marginal rate in equilibrium.
   (iii) Now consider the role of uninsurable risk. To isolate this force, we focus on the case
in which this is the only source of heterogeneity and χ = 0. The first-order condition (28) then
simplifies to                                                                                  
                                                                                      − 1+σ σ
                                                         1              (1 − τa∗ )              
                           0 = (1 − τa∗ ) avω +             1 −
                                                                                          1 .
                                                                                                 
                                                        1+σ                               1
                                                                     A−1 ∑ jA=−01 1 − τj∗
                                                                                             + σ



When vω > 0, the first term is increasing in age a, and to satisfy the first-order condition,
τa∗ must therefore be rising in age (so as to reduce the first term and make the second term
more negative). The intuition is that permanent uninsurable risk cumulates with age and the
planner wants to provide more within-group risk sharing at ages when uninsurable risk is
  10 Note   that as β → 1, τ̄ → A−1 ∑ jA=−01 τa .


                                                                20
larger. Therefore, when vω > 0, optimal progressivity increases with age, ceteris paribus. We
label this force the uninsurable risk channel.
   (iv) Now consider the role of insurable risk. Assume the other conditions of part (ii) of
Proposition 4 are satisfied. The social welfare first-order condition (28) is then
                                                "                            3              #
                                1          1+χ           1            σ+1                           N ( a, τa∗ )
          0 = (1 − τa∗ ) v ϕ +     −                          +                      τa∗ vε,a                    .
                               1+σ         1+σ        1 − τa∗         σ + τa∗                       N̄ ({τa })

First, suppose vε,a is constant to isolate the role of age-invariant insurable wage variation. It is
immediate that there is no motive for age variation in τa , (i.e., τa∗ = τ ∗ ). In addition, if τ ∗ > 0
(τ ∗ < 0), then increasing the level of insurable risk will reduce (increase) optimal progressivity.
The intuition is that when dispersion in insurable risk increases, the cost of setting τ away from
zero and distorting efficient labor supply allocations increases.
    Now, consider the impact of insurable risk that increases with age between age a and a + 1,
vε,a+1 > vε,a . Suppose parameter values are such that τa∗ is positive, and consider the optimal
value for progressivity at age a + 1, τa∗+1 . It is clear that the derivative of the social welfare
function at a + 1 evaluated at τa∗ is negative (since N ( a, τa∗ ) and vε,a are both increasing in a).
We have already established that the social welfare expression is concave in τa for each age a.
It follows that the optimal degree of progressivity at age a + 1 must be less than at age a, (i.e.,
τa∗+1 < τa∗ ), so that the {τa∗ } profile is downward-sloping between a and a + 1. The intuition is
that when the dispersion of the insurable risk increases with age, the cost of setting τa positive
and thereby distorting labor supply increases with age. We label this force the insurable risk
channel.
    (v) Now consider the role of the life-cycle profiles of efficiency units and the disutility of
work. What matters is the shape of the net profile, { x a − ϕ̄ a }. To isolate the impact of this model
ingredient, we eliminate all sources of within-age heterogeneity (θ → ∞, v ϕ = vε,a = vω = 0).
The optimal value for τ at age a, τa∗ , is then the solution to the following simplified version of
the first-order condition (28), where we have substituted in the expression for effective hours
(23):
                                                                                        1+ σ
                                                                                            σ

                                         (1 + χ) exp ( x a − ϕ̄ a )             
                    1 − τa∗ = 
                                                       1
                                                                                 
                                                                                 
                                        A −1             1+ σ                  
                                     1
                                 A ∑ j=0 1 − τj
                                   −                  ∗       · exp x j − ϕ̄ a
                                                                     
                                             exp 1+σ σ ( x a − ϕ̄ a )
                             = (1 + χ )                                   .
                                        A−1 ∑ jA=−01 exp 1+σ σ x j − ϕ̄ j


                                                   21
This optimality condition illustrates that ceteris paribus, the optimal τa∗ is lower the larger is x a −
ϕ̄ a . Moreover, this effect is stronger the higher is the Frisch elasticity (i.e., the lower is σ). The
intuition is that, absent age variation in τ, hours worked will be independent of productivity
given our utility function and tax system. The planner can increase aggregate labor productivity
and welfare by having agents working longer hours when they are more productive and it
is less costly for them to supply labor. When the profile for x a − ϕ̄ a is upward sloping, this
introduces a force for having progressivity decline with age. We label this force the life-cycle
channel.
    Another way to understand this result is that the planner wants to smooth both consump-
tion and the labor wedge (and thus the effective marginal tax rate) over the life cycle. Earnings
                                                                                      1
in this version of the model are given by y a = exp( x a − ϕ̄ a )(1 − τa ) 1+σ . When x a − ϕ̄ a and
thus earnings are increasing with age, the planner optimally chooses to let λa decrease with
age in order to equate consumption across age groups. The effective marginal tax rate at age a
is 1 − λa (1 − τa )y− τa
                    a . Given a positive and age-invariant τa , having λ a decrease with age and
y a increase with age would imply increasing marginal tax rates. But the planner can smooth
marginal tax rates by simultaneously letting τa decrease with age. This result is formalized in
the following corollary.
Corollary 4.1 [optimal age-dependent taxation with life cycle only]. Assume that θ → ∞, and
v ϕ = vε,a = vω = 0 so that the only heterogeneity in the economy is between ages and is driven by the
profile for { x a − ϕ̄ a } . Then the optimal profiles {τa∗ , λ∗a } implement the first best. In particular, they
equate both the labor wedge and consumption across age groups. The labor wedge is equal to one at all
ages (the marginal tax rate is zero). The average value for τa , A−1 ∑ aA=−01 τa∗ , is equal to −χ.
   In light of this last set of results on the role of the life cycle, it is clear that the life-cycle
productivity channel would be weaker if we introduced opportunities for intertemporal trade.
In particular, if households could borrow and lend freely, then hours would tend to naturally
covary positively with productivity over the life cycle, even absent age variation in τa . Similarly,
the more easily consumption can be smoothed intertemporally through markets, the less λa
needs to vary across ages.11 In Section 7 we allow individuals to access a non-state-contingent
bond subject to a credit limit and explore this issue quantitatively.
  11 This
        effect also would not necessarily be operative if the age-wage profile were endogenous. Examples of
endogenous age-wage profiles are models with learning by doing, as in Imai and Keane (2004), and models in
which skill investments take time away from work, as in Ben-Porath (1967).




                                                       22
5.2 Welfare with discounting and transitional dynamics
The steady-state welfare expression is tractable, making it easy to understand the various forces
driving age variation in tax parameters. However, a complete welfare analysis requires incorpo-
rating discounting and the transition because skill investment is an irreversible and a dynamic
forward-looking decision. Because of this irreversibility, a standard issue inherent in models
with sunk investments arises: in the short run, the government will be tempted to heavily tax
high-skill individuals because such taxation is not distortionary ex post. This result is related to
the temptation to tax initial physical capital in the neoclassical growth model.12 In our context,
the question is: how does this force affect optimal progressivity?
   We therefore now assume β < 1 and consider an unanticipated policy change at date t =
0 from a pre-existing age- and time-invariant policy Γ−1 = (λ−1 , τ−1 , G−1 ) to a new policy
regime in which the new policy parameters can vary freely by both age and time. Let Γt =
{λa,t+ a , τa,t+ a , Gt+ a } aA=−01 denote the tax and spending policy that will apply to the cohort born
at date t, and let Ut (Γt ) denote the corresponding expected lifetime utility.
    Social welfare can be written as
                                                                                                  
                                                        −1                          ∞
            W { Γt } ∞   t=−( A−1) ;Γ−1 ≡ (1 − β)
                                                       ∑       βt Utold (Γt ;Γ−1 ) + ∑ βt Ut (Γt ) . (29)
                                                        t=−( A−1)                        t =0


   The superscript “old” distinguishes the existing cohorts (t < 0) already alive at the time of
the reform – whose skill investments were made under the old age-invariant policy Γ−1 – from
future cohorts (t ≥ 0) whose skill investments are made under the new optimal system. Note
that remaining lifetime utility Utold for the old does not include any skill investment costs. Those
investments were made in the past and are sunk from the point of view of the government
choosing a new policy.
    To preserve tractability, we need to make one additional assumption relative to the base-
line model, namely that production is segregated across islands defined by birth cohort. This
assumption is required because each cohort now faces a potentially cohort-specific profile for
progressivity, and thus the distribution for skill investment will be cohort-specific. The segre-
gation assumption ensures that the distribution of skills within each age-group island is always
exponential.13 There is still a single economy-wide government budget constraint, so the plan-
  12 Hassler et al. (2008) explain how it is also present in a model where growth is driven by human capital

accumulation.
  13 Note that the key to tractability when analyzing the market for skills is that the distribution of skills is expo-

nential (see Proposition 2). The problem with having different cohorts working in the same labor market would
be that different cohorts potentially make human capital investments, implying different skill distributions, and
a combined overall distribution of skills that would no longer be exponential (the sum of exponential random


                                                          23
ner can use the tax and transfer system to reshuffle resources across islands.
   The equilibrium hours worked and consumption allocations in this version of the economy
are analogous to those described above for the steady-state version, with the only difference
being that the fiscal policy parameters in eqs. (17)-(18) are now indexed by both age and time.
Skill investment decisions are modified as follows. Let
                                              "                             #
                                                 (1 − β ) A − 1 j
                                                                                            (30)
                                                (1 − β A ) j∑
                               τ̄a,t = E t− a                  β τj,t− a+ j
                                                            =0


denote the expected discounted sequence for progressivity for the cohort entering the economy
                                                                                    (1− β )
at date t − a. Note that for t − a < 0, τ̄a,t = τ−1 , while for t − a ≥ 0, τ̄a,t = (1− β A ) ∑ jA=−01 β j τj,t− a+ j.
    Skill investment choices and skill prices for any cohort are given by the same expressions
as in the baseline model, except that both are now cohort-specific and depend on the expected
sequence for progressivity τ̄a,t . Because skill investment choices are irreversible, unanticipated
changes to the tax system have no impact on the skill distribution or skill prices for cohorts
entering before date 0.                                      n                           o                ∞
                                                                                 1
    The Ramsey problem for the planner is now to choose {λa,t+ a , τa,t+ a } aA=−max {0,− t}              t=−( A−1)
and   { Gt } ∞
             t =0   to maximize (29) given the expressions for equilibrium allocations and the govern-
ment budget constraint.
    How does incorporating transition change the optimal policy prescription? First, our steady-
state characterizations for optimal spending and for the optimal tax level parameters {λa,t }
extend directly to the transition case.
Proposition 5 [optimal age-dependent taxation with transition]. Taking the transition into ac-
count, the optimal tax system has the following properties:
                                         
(i) At every date t, the optimal sequence λ∗a,t equalizes average consumption across age groups.
(ii) The optimal output share of government expenditures gt∗ is constant and given by

                                                            χ
                                                   gt∗ =       .
                                                           1+χ

   The logic for part (i) is that, as in the steady state, the λa,t parameters have no effect on labor
supply or skill investment. The intuition for part (ii) is related: given that the average level of
taxation does not affect output, it is optimal to set the level of government spending to equate
the marginal utilities of public and private consumption.
    To characterize the impact of incorporating transition on the optimal age profile of progres-
sivity, we now focus on a special case of the model in which heterogeneity in skills is the only
variables is not an exponential).

                                                         24
source of heterogeneity. This strips out other sources of age variation in optimal progressivity
and allows us to focus on incentives of the planner to exploit the fact that past skill investments
are sunk and therefore are insensitive to changes in the tax system. This adds a new driver
shaping optimal progressivity, which we label the sunk skill investment channel. To obtain the
sharpest characterization of this effect, we also assume inelastic labor supply.
Proposition 6 [optimal taxation with transition and inelastic labor supply].
If (i) v ϕ = vω = vε,a = 0, (ii) the age profiles for efficiency and disutility of work are flat, and (iii)
                                                                                           ∗ = 1 for all
σ → ∞ (labor supply is inelastic), then the optimal policy has the following properties: τa,t
a > t, and τ0∗+ j,t+ j = τ0,t
                          ∗ < 1 for all j = 1, .., A − 1 and for all t ≥ 0.


   This result states that it is optimal to impose maximally progressive taxes on all cohorts who
entered the economy before the tax reform at date 0, whose past skill investments are sunk.
This eliminates within-age-group consumption inequality for these cohorts, without imposing
any distortions. For cohorts who enter the economy after the reform, optimal progressivity is
constant over the life cycle and less than one. It is not optimal to push progressivity to the max-
imum because for these cohorts, progressivity reduces skill investment. Why is progressivity
constant over the life cycle? Consider the trade-offs from a marginal increase in τ1,t+1 relative to
τ0,t , starting from a flat profile. Skill investment at t is less sensitive by a factor β to τ1,t+1 relative
to τ0,t (see eq. 30). At the same time, the gain in terms of reduced consumption inequality from
increasing τ1,t+1 relative to τ0,t is also discounted by a factor β, since it enters social welfare at
t + 1 rather than at t.14
   The characterization in Proposition 6 parallels the well known result that in models with
physical capital, the Ramsey planner wants a declining path for capital taxes in order to expro-
priate existing sunk capital without excessively discouraging new investment. In our economy,
the planner effectively expropriates the returns to past skill investments, without discouraging
future skill investment. However, the key to achieving this, in the context of our overlapping-
generations economy, is to have progressivity vary by cohort, rather than by time, because
human capital is non-tradable, and the age of the potential human capital investor perfectly
delineates whether or not the investment is sunk.
    The optimal policy described in Proposition 6 dictates very different optimal progressiv-
ity values for cohorts entering the economy before versus after the reform. We have also ex-
plored the optimal policy when the planner can allow progressivity to vary by age but not by
time/cohort. In particular, suppose that at the time of tax reform, the planner has to choose a
single age profile {τa } that will apply at every future date. We retain the assumption that the
  14 Note that while optimal progressivity is constant within each cohort, it potentially varies across cohorts during

transition.


                                                         25
              Parameter      Description                                      Value
                  A          Years of working life                              35
                   β         Discount factor                                   0.97
                   σ         Inverse of Frisch elasticity                        2
                   χ         Relative taste for public good                   0.233
                   θ         Elasticity of substitution across skills         3.124
                  ψ          Elasticity of skill investment to return          0.65
                  vϕ         Heterogeneity in disutility of work              0.036
                  vω         Variance of uninsurable productivity shock       0.058
                 vε0         Initial variance in insurable productivity       0.090
                 ∆vε         Growth in variance of insurable productivity     0.044
                { xa }       Age profile for productivity                   See Fig. 2
                { ϕ̄ a }     Age profile for disutility of work             See Fig. 2
                 τ US        US rate of progressivity                         0.181

                           Table 1: Model parameterization (period = 1 year)


other fiscal parameter λa,t can vary freely by age and time. The key result in this case is that
when β < 1, and given the parametric assumptions listed in Proposition 6, the optimal policy
incorporating transition features an increasing profile for τa . Given Proposition 6, this result
should come as no surprise: an increasing age profile for τa is a poor man’s approximation
to the ideal policy, which dictates high progressivity for the pre-existing old cohorts and low
progressivity for new young cohorts.
    In the next section, we will numerically explore optimal taxation incorporating transition in
a full version of the model.


6 Quantitative analysis
In this section, we describe the model parameterization and explore the quantitative implica-
tions of the theory. We begin with the problem of the planner that maximizes steady-state wel-
fare as in Section 5. Next, we solve for the optimal age-dependent tax system that incorporates
discounting and transitional dynamics.


6.1 Parameterization
The parameterization strategy closely follows Heathcote et al. (2017). The model period is one
year. Some of the parameters are set outside the model. For our steady-state analysis, we focus
on the case β = 1, since in this case ignoring transition is innocuous. When we move to explore
transition, we set β = 0.97, so that the path for policy and allocations during transition matters

                                                  26
for social welfare.
    Households live for A = 36 years, envisioning an age range between 25 and 60. The mo-
tivation for this choice is that our focus is on the design of a tax and transfer system for the
working-age population. In Section 7, we extend the analysis to a case with exogenous retire-
ment.15 The preference weight on the public good χ is identified directly from the size of the
US government as a share of GDP, assuming that the observed level of public consumption is
optimal: given gUS = 0.19, we obtain χ = 0.233.16 For calibration, we need to approximate the
current US tax and transfer system. Based on the estimates of Heathcote et al. (2017), we set
τ US = 0.181.17 Given τ US and gUS , we then set λUS such that the budget is balanced. We set
σ = 2, a value broadly consistent with the microeconomic evidence on the Frisch elasticity (see,
e.g., Keane, 2011).
    Other parameters are structurally estimated. In Heathcote et al. (2017), we show that one
can identify and estimate the elasticity of substitution between skills θ, preference heterogene-
ity v ϕ , and the variances of wage risk vω , {vε,a }, using cross-sectional within-age variances and
covariances of male wages, male hours, and equivalized household consumption, which we
measure from the the Panel Study of Income Dynamics (PSID) and the Consumer Expendi-
ture Survey (CEX) for survey years 2000-2006. The identification follows from the closed-form
expressions for wages, hours, and consumption derived above.
   15 See Ndiaye (2017) for an analysis of optimal age-dependent taxation in a model that incorporates the retire-

ment decision.
   16 Heathcote et al. (2017) show that the fraction of output devoted to public goods is also χ when it is chosen
                                                                                              1+ χ
by the median voter in the economy.
   17 For this exercise, Heathcote et al. (2017) use data from the PSID for survey years 2000-2006, in combination

with the NBER’s TAXSIM program. They restrict attention to households aged 25-60 with positive labor income.
When measuring pre-government gross household income, Heathcote et al. (2017) include labor earnings, private
transfers (alimony, child support, help from relatives, miscellaneous transfers, private retirement income, annu-
ities, and other retirement income), plus income from interest, dividends, and rents. To construct taxable income,
for each household in the data they compute the four major categories of itemized deductions in the US tax code
— medical expenses, mortgage interest, state taxes paid, and charitable contributions – and subtract them from
gross income. Post-government income equals pre-government income plus public cash transfers (AFDC/TANF,
SSI and other welfare receipts, Social Security benefits, unemployment benefits, workers’ compensation, and vet-
erans’ pensions), minus federal, payroll, and state income taxes. Transfers are measured directly from the PSID,
while taxes are computed using TAXSIM.




                                                       27
                                                 2.5                                                                          2.5

                                                         Hourly Wages                                                                  Efficiency
                                                         Hours Worked                                                                  Disutility
                                                                                                                                       Net




                      Age Profile (age 25 = 1)




                                                                                                   Age Profile (age 25 = 1)
                                                  2                                                                            2




                                                 1.5                                                                          1.5




                                                  1                                                                            1




                                                 0.5                                                                          0.5
                                                    25   30   35   40     45   50   55   60                                      25   30    35      40     45   50   55   60
                                                                        Age                                                                              Age


Figure 2: Left panel: life-cycle profiles of individual wages and hours. Right panel: implied profiles for
xa , ϕ̄ a , and xa − ϕ̄ a .


   To give a flavor of the identification, consider the following four moments:

                                                  1
                                                          var a (log wia ) =
                                                     + vω a + vε,a                                                                                                             (31)
                                                  θ2
                                                                   2
                                                         1 − τ US
                              var a (log hia ) = v ϕ +                 vε,a
                                                         σ + τ US
                                                          2          1
                                                                               
                                                        US
                              var a (log cia ) = 1 − τ          v ϕ + 2 + vω a
                                                                        θ
                                                        US  
                                                    1−τ
                     cov a (log hia , log wia ) =              vε,a
                                                    σ + τ US

   The moments cov a (log hia , log wia ) observed at ages a = 0, ..., A − 1 identify {vε,a }. Since
in the data the profile for this variance increases nearly linearly with age, we freely estimate
the initial variance at age 25, vε,0 , and then impose linearity. From var a (log hia ) we then iden-
tify v ϕ . The value for var0 (log ci0 ) identifies θ. Then, the change in var a (log wia ) over the life
cycle identifies vω . This is just one of the many possible combinations of moments that yield
identification. Our formal estimation procedure also allows for classical measurement error
in all variables and is based on an estimator that minimizes the distance between age-specific
covariances in the model and the data. See Heathcote et al. (2017) for additional details.
    The parameter ψ controls the elasticity of the return to skills π1 to τ̄ and θ, where the return
to skills is increasing in progressivity and decreasing in skill substitutability (see eq. 20). In
Heathcote et al. (2017), we exploit changes in π1 , τ, and θ over time, which we can measure
from PSID data between the early 1970s and the early 2000s, to estimate ψ.
   The only additions relative to the parameterization in Heathcote et al. (2017) are the age
profiles for productivity and the disutility of work. We estimate the life-cycle profile of individ-


                                                                                              28
                                  1.8                                                                      0.8


                                  1.6                                                                      0.7


                                  1.4                                                                      0.6




                                                                                        Variance of Logs
                                                                Hours
                                  1.2                                                                      0.5
                                                                Wages

                        Average
                                                                Earnings
                                   1                                                                       0.4
                                                                Consumption

                                  0.8                                                                      0.3


                                  0.6                                                                      0.2


                                  0.4                                                                      0.1


                                  0.2                                                                       0
                                     25   30   35   40         45   50   55   60                             25   30   35   40         45   50   55   60
                                                         Age                                                                     Age


            Figure 3: Means (left panel) and variances of logs (right panel) over the life cycle


ual hourly wages and hours from our same PSID sample for years 2000-2006. The left panel of
Figure 2 plots both profiles, interpolated using a cubic function of age. The wage profile maps
directly into the efficiency profile { x a } . Given { x a } and the other parameter values, from the
expression for average hours worked by age, eq. (24), we can residually recover the profile for
disutility of work { ϕ̄ a } .
  The right panel of Figure 2 plots the implied profiles for { x a } and { ϕ̄ a } and for { x a − ϕ̄ a } ,
which is the one relevant for optimal age dependence in progressivity. Note that this latter age
profile is strongly hump shaped, a feature that will be quantitatively important.18 .
   Table 1 summarizes the parameter values. Figure 3 shows that the implied means and vari-
ances of logarithms for wages, hours, earnings, and consumption by age align well with the
ones estimated from cross-sectional data (see, e.g., Heathcote et al., 2014).


6.2 Results: steady-state welfare
In line with the analytical results in Section 4, we start by analyzing optimal taxation from a
steady-state welfare point of view.
    Recall that Proposition 4 identified three different forces that shape the optimal age profile
of tax progressivity in steady state: uninsurable risk, insurable risk, and life-cycle variation in
productivity and preferences. To understand the quantitative role of each of these forces, we
start from an economy where none of these channels is active, the one described in point (ii) of
  18 Itis worth noting that our approach to identifying { ϕ̄ a } hinges on our assumption of no intertemporal bor-
rowing and lending. If households could perfectly smooth consumption by borrowing and lending, one would
naturally expect covariation between hours and wages over the life cycle, implying a smaller role for ϕ̄ a in gener-
ating age variation in hours worked. We will therefore also study optimal policy abstracting from age variation in
preferences for work


                                                                                   29
Proposition 4.

6.2.1 Channels that do not induce age dependence

Figure 4 illustrates optimal progressivity by age {τa∗ } and the implied income-weighted average
marginal tax rate (left panels) together with age profiles for earnings, hours, and consumption
(right panels).
   The top two panels represent optimal policy in a representative-agent version of our econ-
omy, with all sources of heterogeneity shut down, that is, θ = ∞, v ϕ = vε,a = vω = 0, { x a } , { ϕ̄ a }
constant, and β = 1. In this economy, τ ∗ = −χ.
    Next, in the middle panels, we add heterogeneity in the disutility of work by setting v ϕ to its
estimated value. Since this form of initial heterogeneity translates into consumption dispersion,
the planner wants to increase progressivity to redistribute from the lucky individuals born with
a low disutility of work to the unlucky ones who have a higher disutility and who thus work
and earn less. Since this form of heterogeneity is innate and does not vary by age, optimal
progressivity remains flat.
   In the bottom two panels, we activate skill investment by setting θ to its estimated value
and thus introduce heterogeneity in skills. The optimal {τa∗ } profile remains flat but further
increases in value. Two contrasting forces emerge when we add skill investment: on the one
hand, the planner can encourage skill accumulation via a less progressive tax system. On the
other hand, the utilitarian planner also wants to reduce consumption inequality generated by
heterogeneity in skills, and to do so, it must choose a more progressive system. Given our
parameter values, this latter force dominates, pushing up optimal progressivity.
   Next, we introduce the channels that induce age dependence in optimal progressivity.

6.2.2 Uninsurable risk channel

Part (iii) of Proposition 4 states that because uninsurable risk in the form of permanent shocks
cumulates over the life cycle, the planner has an incentive to increase tax progressivity with
age. To introduce this effect, we set the amount of uninsurable risk, vω , to its calibrated value.
The top panels of Figure 5 illustrate that adding uninsurable risk has two effects on the profile
for optimal progressivity. First, the average level of progressivity rises. Second, as expected,
the progressivity profile becomes upward sloping.
   Introducing uninsurable risk also leads to an upward-sloping age profile for the income-
weighted average marginal tax rate. This result is reminiscent of findings in the recent literature
on dynamic Mirrleesian optimal taxation, according to which, when income shocks are persis-
tent, the optimal average effective marginal tax rate has a positive drift over the life cycle. Farhi

                                                   30
                             0.4                                                              1.8

                                                                                                                                Earnings
                                                                                              1.7
                             0.3                       Marginal Tax Rate                                                        Consumption
                                                                                              1.6                               Hours

                             0.2                                                              1.5
             Progressivity




                                                                                Y, C, and H
                                                                                              1.4
                             0.1

                                                                                              1.3

                               0
                                                                                              1.2


                             -0.1                                                             1.1


                                                                                               1
                             -0.2
                                                                                              0.9


                             -0.3                                                             0.8
                                 25   30   35   40         45   50   55    60                    25   30   35   40         45    50   55      60
                                                     Age                                                             Age


                             0.4                                                              1.8

                                                                                                                                Earnings
                                                                                              1.7
                             0.3                       Marginal Tax Rate                                                        Consumption
                                                                                              1.6                               Hours

                             0.2                                                              1.5
             Progressivity




                                                                                Y, C, and H


                                                                                              1.4
                             0.1

                                                                                              1.3

                               0
                                                                                              1.2


                             -0.1                                                             1.1


                                                                                               1
                             -0.2
                                                                                              0.9


                             -0.3                                                             0.8
                                 25   30   35   40         45   50   55    60                    25   30   35   40         45    50   55      60
                                                     Age                                                             Age


                             0.4                                                              1.8

                                                                                                                                Earnings
                                                                                              1.7
                             0.3                                                                                                Consumption
                                                                                              1.6                               Hours

                             0.2                                                              1.5
             Progressivity




                                                                                Y, C, and H




                                                                                              1.4
                             0.1

                                                                                              1.3

                               0
                                                                                              1.2


                             -0.1                                                             1.1

                                                Marginal Tax Rate                              1
                             -0.2
                                                                                              0.9


                             -0.3                                                             0.8
                                 25   30   35   40         45   50   55    60                    25   30   35   40         45    50   55      60
                                                     Age                                                             Age




Figure 4: Left panels: optimal progressivity and income weighted average marginal tax rate. Right
panels: average earnings (Y), hours (H), and consumption (C) by age. Top two panels: Representative-
agent model. Middle two panels: previous case plus heterogeneity in disutility of work. Bottom two
panels: previous case plus heterogeneity from skill investment.

                                                                                   31
                           0.4                                                             1.8

                                                                                                                             Earnings
                                                                                           1.7
                           0.3                                                                                               Consumption
                                                                                           1.6                               Hours

                           0.2                                                             1.5
           Progressivity




                                                                             Y, C, and H
                                                                                           1.4
                           0.1

                                                                                           1.3

                             0
                                                                                           1.2


                           -0.1                                                            1.1

                                               Marginal Tax Rate                            1
                           -0.2
                                                                                           0.9


                           -0.3                                                            0.8
                               25   30   35   40         45   50   55   60                    25   30   35   40         45    50   55      60
                                                   Age                                                            Age


                           0.4                                                             1.8

                                                                                                                             Earnings
                                                                                           1.7
                           0.3                                                                                               Consumption
                                                                                           1.6                               Hours

                           0.2                                                             1.5
           Progressivity




                                                                             Y, C, and H




                                                                                           1.4
                           0.1

                                                                                           1.3

                             0
                                                                                           1.2


                           -0.1                                                            1.1
                                               Marginal Tax Rate
                                                                                            1
                           -0.2
                                                                                           0.9


                           -0.3                                                            0.8
                               25   30   35   40         45   50   55   60                    25   30   35   40         45    50   55      60
                                                   Age                                                            Age




Figure 5: Left panels: optimal progressivity and income-weighted average marginal tax rate. Right
panels: average earnings (Y), hours (H), and consumption (C) by age. Top two panels: previous case
plus uninsurable risk. Bottom two panels: Previous case plus insurable risk.




                                                                             32
and Werning (2013) analyze Mirrlees taxation in a dynamic life-cycle economy in which aver-
age productivity does not vary with age.19 In their numerical example, plotted in their Figure 2,
the optimal history-dependent allocation is qualitatively similar to the allocation in our Figure
5: the average effective marginal tax rate is increasing in age, average output is decreasing in
age, and average consumption is invariant to age.20


6.2.3 Insurable risk channel

According to part (iv) of Proposition 4, if the variance of insurable wage risk vε,a increases with
age, the planner has an incentive to tilt the schedule for optimal progressivity downward. The
bottom panels of Figure 5 illustrate that when we introduce our estimates for insurable risk,
the profile of optimal progressivity does indeed tilt in a clockwise direction. As a result, the
life-cycle profiles for hours and earnings become flatter.


6.2.4 Life-cycle channel

We now add the last motive for age-varying progressivity identified in Proposition 4: age-
varying profiles for labor efficiency and the disutility of work. Figure 6 plots two cases. In
the top panels, the productivity and disutility profiles { x a } and { ϕ̄ a } are both switched on.
Recall that these two ingredients enter the expression for social welfare only via their net effect,
{ x a − ϕ̄ a }. In the bottom panels, only the labor productivity profile { x a } is active.
     Recall that the profile for { x a − ϕ̄ a } is generally increasing and strongly hump-shaped (see
Figure 2). Thus, optimal progressivity becomes both flatter and more U-shaped when this life-
cycle channel is activated, relative to the same economy without age variation in wages or
preferences (see the bottom panels of Figure 5). The intuition is that life-cycle earnings have
a pronounced hump shape in this calibration. To counteract earnings inequality by age and
equate average consumption across age groups, the planner sets a U-shaped age profile for
λa . Absent age variation in τa , this would translate into a strongly hump-shaped profile for
average marginal tax rates. By simultaneously setting a U-shaped profile for τa , the planner can
moderate the average marginal tax rate at peak productivity years. The desire to smooth taxes
by age is familiar from the dynamic Mirrlees literature (Farhi and Werning, 2012). The bottom
panels of Figure 6 show that the life-cycle channel is weaker when we shut down age variation
in preferences.
  19 They also assume no endogenous skill accumulation, no preference heterogeneity and no valued government
expenditures.
  20 Golosov et al. (2016) show that with negatively skewed log-income shocks, the positive drift in the labor

wedge is stronger in the left tail of the income distribution.



                                                     33
                            0.4                                                              1


                                                                                            0.9
                                                                                                        Earnings
                            0.3                                                                         Consumption
                                                                                            0.8         Hours
                            0.2                                                             0.7
            Progressivity




                                                                              Y, C, and H
                                                                                            0.6
                            0.1

                                                                                            0.5

                              0
                                                                                            0.4


                            -0.1                                                            0.3


                                                                                            0.2
                                                    Marginal Tax Rate
                            -0.2
                                                                                            0.1


                            -0.3                                                             0
                                25   30   35   40         45   50   55   60                   25   30     35   40         45   50   55   60
                                                    Age                                                             Age


                            0.4                                                             1.8



                            0.3                                                             1.6



                            0.2
                                                                                            1.4
            Progressivity




                                                                              Y, C, and H




                            0.1
                                                                                            1.2


                              0
                                                                                             1


                            -0.1
                                                     Marginal Tax Rate                      0.8
                                                                                                                          Earnings
                            -0.2                                                                                          Consumption
                                                                                            0.6                           Hours

                            -0.3
                                25   30   35   40         45   50   55   60                   25   30     35   40         45   50   55   60
                                                    Age                                                             Age




Figure 6: Left panels: optimal progressivity and income-weighted average marginal tax rate. Previous
case plus life-cycle channel, that is, all channels operational with steady-state welfare. Right panels:
average earnings (Y), hours (H), and consumption (C) by age. Top panels: age profile for disutility of
work as estimated. Bottom panels: age profile for disutility of work constant.




                                                                              34
                                             0.6



                                             0.4



                                             0.2




                         Marginal Tax Rate
                                               0



                                             -0.2                                           Age 25
                                                                                            Age 45
                                             -0.4                                           Age 60
                                                                                            Actual US
                                             -0.6



                                             -0.8
                                                    0.5   1    1.5   2    2.5    3    3.5      4    4.5   5
                                                              Pre-gov. Income (average = 1)

Figure 7: Marginal tax rates at different ages for the optimal age-dependent policy with β = 1 (i.e., those
that maximize steady-state welfare).


   All channels are now operative, so this economy (the one with age variation in ϕ̄ a ) should
be viewed as our benchmark when focusing on steady-state welfare. Note, however, that the
quantitative importance of the life-cycle channel is sensitive to the assumed market structure.
As we will see in Section 7, allowing for borrowing and lending dampens this channel.


6.2.5 Optimal age-dependent marginal tax rates

Figure 7 plots the marginal tax rates implied by the tax system described in the top panels
of Figure 6 for three age groups. The optimal age-dependent tax system dictates essentially a
flat tax for middle-aged workers and a highly progressive schedule for young and old. Thus
progressivity is high for young and old, but for different reasons: it provides social insurance
against labor market risk to the old and it provides redistribution without distorting life-cycle
labor supply incentives to the young.
   Note that even though the degree of optimal progressivity is lower for the old than for the
young (the curve is flatter for the old), marginal (and average) tax rates are much higher for the
old for a wide income range. Mechanically, this reflects the fact that the old face smaller values
for λa in order to redistribute income to the young and thereby equalize consumption across
ages. When evaluating the optimal tax system at the endogenous distribution of earnings, the
income-weighted average marginal tax rate – calculated across individuals in each age group –
is increasing in age (Figure 6).




                                                                         35
                                                 Benchmark US BL         Natural BL

                (λ∗ , τ ∗ ) constant                  0.10       0.16       0.18

                λ∗ age-varying, τ ∗ constant          1.69       1.07       0.67

                λ∗ constant, τ ∗ age-varying          2.10       1.63       1.36

                (λ∗ , τ ∗ ) age-varying               2.42       1.76       1.38

Table 2: All numbers in the table are welfare gains expressed as additional lifetime consumption (per-
centage points) relative to the existing tax/transfer system. The column labeled “Benchmark” refers to
the benchmark economy without intertemporal trade (autarky). The column “US BL” refers to the econ-
omy with borrowing and lending under the calibrated borrowing limit for the US economy (two times
annual earnings). The column labeled “Natural BL” refers to the economy with borrowing and lending
under the natural borrowing limit. These last two economies are solved in general equilibrium.


6.2.6 Welfare gains from tax reforms

We now present the welfare gains of switching from the existing tax/transfer system to the
optimal age-dependent system. As with all the results presented to this point, we focus on the
case β = 1, so that we can safely ignore transition when comparing different tax systems.
     We begin by reporting the gains of switching to the optimal age-invariant system. Next we
consider the gains of switching to a system where we allow for age variation in λa but not in
τa . Then we explore the opposite configuration. Finally, we compute the gains from switching
to the fully age-dependent system. All these welfare gains refer to steady-state welfare and are
computed in terms of lifetime consumption-equivalent variation. The first column of Table 2
summarizes these results.
  The welfare gains of moving from the existing tax system (with τ US = 0.181) to the opti-
mal age-invariant tax schedule are small. Moving to the optimal age-varying system delivers
welfare gains of 2.4% of consumption. A large portion of this welfare gain arises from endow-
ing the planner with the ability to use the tax system to redistribute across age groups, so as
to equate expected consumption by age. In particular, the specification in which λ can vary
freely by age but τ cannot achieves around 2/3 of the maximum welfare gains from tax re-
form. However, our baseline parameterization likely exaggerates the potential welfare gains
from redistribution across age groups, for two reasons. First, it assumes age-invariant utility
from consumption: introducing age-varying utility would imply smaller potential gains from
redistribution across age groups. We study this case in the Section 6.4. Second, our baseline
parameterization assumes no borrowing and lending, giving the government a crucial role in


                                                 36
smoothing consumption over the life-cycle. We extend the model to intertemporal trade in
Section 7.


6.3 Results: transitional dynamics
We now compute the age-dependent tax system that maximizes welfare taking into account
transitional dynamics and the sunk investment channel, that is, the fact that cohorts born before
the reform cannot adjust skills in response to a surprise change in the tax system. In particular,
consider a tax reform at date 0 that implements a flexible age- and time-specific tax policy
{λa,t , τa,t , Gt } for a = 0, ..., A − 1 and for t = 0, ..., ∞. We set the annual discount factor to
β = 0.97.
    The importance of the sunk investment channel depends on the tax system in place in the
initial steady state. We assume that this system features the age-invariant value for progressiv-
ity τ US = 0.181 and the age-invariant λUS that balances the budget given gUS .
    We emphasize that this is an ambitious exercise because there are a large number of policy
parameters to optimize. Doing so is only feasible because, conditional on the tax parameters,
equilibrium allocations can be characterized in closed form. In addition, the problem is simpli-
fied because, by virtue of Proposition 5, the planner will optimally set { λa,t } such that (i) con-
sumption is equalized across age groups at each date, and (ii) the ratio of government spending
to output is always equal to χ/(1 + χ). To economize slightly on the number of policy param-
eters to solve for, we assume a three-year period length with each cohort active for A = 12
periods and adjust other parameters accordingly.21
    We plot optimal policy for three parameterizations. The first (Figure 8) corresponds to the
case described in Proposition 6 with inelastic labor supply and no sources of heterogeneity
besides differences in skills. The second (Figure 9) is identical except that we introduce flexible
labor supply. The third parameterization (Figure 10) is our baseline incorporating all sources
of heterogeneity (but with β = 0.97 rather than β = 1). In all plots, each different colored line
plots the sequence for {τa,t+ a } for a particular cohort. The line starts at the date t that the cohort
enters the economy and ends at t + 11. Lines for cohorts that entered the economy prior to the
reform at date 0 are shorter: there is a single point for the cohort that entered at t = −11.
    Consider first the case in which skill is the only source of heterogeneity and labor supply
is inelastic. Figure 8 offers a visual illustration of Proposition 6. The planner sets τa,t = 1
for cohorts entering prior to the reform, and for cohorts entering post-reform, progressivity is
constant over the life cycle. In this example, there is also very little variation in progressivity
  21 We assume that the economy converges to a new steady state within 156 periods and thus solve for 12 × 156 =
1, 872 values for τa,t .


                                                      37
                                                    1

                                                                                                     Born at t = -11
                                                   0.9
                                                                                                     Born at t = -9
                                                                                                     Born at t = -6
                                                   0.8
                                                                                                     Born at t = -3
                                                                                                     Born at t = 0




                         Progressivity by Cohort
                                                   0.7
                                                                                                     Born at t = 3
                                                                                                     Born at t = 6
                                                   0.6
                                                                                                     Born at t = 9
                                                                                                     Born at t = 12
                                                   0.5
                                                                                                     Born at t = 15

                                                   0.4


                                                   0.3


                                                   0.2


                                                   0.1


                                                    0
                                                         0   5   10             15              20      25             30
                                                                      Time (period = 3 years)


Figure 8: Optimal age and time dependent progressivity incorporating transition. Skills are the only
source of heterogeneity. Labor supply is inelastic. β = 0.97.


across cohorts, but that result is a numerical accident and reflects the fact that the value for
optimal progressivity in the final steady state is not far from the estimated value for the United
States.
    When we introduce flexible labor supply (Figure 9), the optimal policy still involves rela-
tively high values for progressivity for cohorts entering prior to the reform and lower values
for cohorts entering after the reform. However, flexible labor supply does change the picture
in two ways. First, it is no longer optimal to set τa,t = 1 for cohorts entering prior to the re-
form because even though the skill investments for these cohorts are sunk, cohort labor supply
still responds negatively to progressivity. Second, the cohort-specific profiles for τa,t are gen-
erally upward sloping (rather than flat) until all the cohorts alive at the time of the reform
have exited the economy. The logic for this result is that aggregate output gradually increases
during the post-reform transition, as successive cohorts make skill investments given expected
progressivity values τ̄a,t that are much lower than in the pre-reform steady state. As output in-
creases over time, the planner gradually becomes less focused on stimulating additional output
(via low values for progressivity) and more focused on reducing inequality (via high values
for progressivity). Thus, during transition, optimal progressivity increases both within cohorts
(the upward-sloping profiles) and between profiles (each successive cohort’s profile starts at a
higher level).22
  22 Theplanner’s first-order conditions can be used to establish the result that age profiles for progressivity are
upward sloping when output is rising. Contemplate a candidate optimal policy with the property τ0,t = τ1,t+1
such that the first-order condition for τ0,t (eq. A26) is satisfied. Now consider the first-order condition for τ1,t+1.
Substituting eq. (A28) into eq. (A27), it is clear that on the margin, it will be welfare improving to increase τ1,t+1
above τ0,t if and only if the second term on the right-hand side of eq. (A27) is positive, which will be the case when
Yt < Yt+1 . Thus, if a cohort will live through a period of rising output, it will optimally face an increasing age


                                                                             38
                                                    0.2
                                                                                                            Born at t = -11
                                                                                                            Born at t = -9
                                                   0.15                                                     Born at t = -6
                                                                                                            Born at t = -3
                                                                                                            Born at t = 0
                                                    0.1




                         Progressivity by Cohort
                                                                                                            Born at t = 3
                                                                                                            Born at t = 6
                                                                                                            Born at t = 9
                                                   0.05
                                                                                                            Born at t = 12
                                                                                                            Born at t = 15
                                                      0



                                                   -0.05



                                                    -0.1



                                                   -0.15
                                                           0   5   10             15              20   25                     30
                                                                        Time (period = 3 years)


Figure 9: Optimal age and time dependent progressivity incorporating transition. Skills are the only
source of heterogeneity. Labor supply is elastic. β = 0.97.


    Now consider optimal policy incorporating transition for the baseline model. The optimal
policy now looks like a mix of Figures 6 and 9. For any given cohort, the optimal profile {τa,t+ a }
is U-shaped, as in Figure 6. Moving across cohorts, it is clear that on average, progressivity is
higher for cohorts entering prior to the reform and lower for cohorts entering later. In addition,
progressivity generally increases modestly over time post-reform.


6.4 Extension I: age variation in the taste for consumption
In this section, we generalize our baseline model by introducing life-cycle variation in the taste
for consumption. The most straightforward way to interpret this additional model ingredient –
and the one we will use to calibrate this version of the model – is that household consumption
demand changes as individuals form couples, have children, and children age and eventually
leave to form households of their own.
    The implication for the planner is that a portion of consumption variation over the life cy-
cle is efficient. This reduces the desire to redistribute across ages through λa , which, in turn,
weakens the life-cycle channel that induces a U-shaped optimal profile for τa .
  We modify our period utility function to

                                                                             exp [(1 + σ) ( ϕ̄ a + ϕi )]
     ui (cia , hia , G ) = exp((1 + σ)γa ) log cia −                                                     (hia )1+σ + χ log G,      (32)
                                                                                      1+σ

where γa > 0 shifts the marginal utility of consumption at age a. Consumption and hours
allocations for this model are:
profile for progressivity.


                                                                               39
                                                0.4                                                         Born at t = -11
                                                                                                            Born at t = -9
                                               0.35                                                         Born at t = -6
                                                                                                            Born at t = -3
                                                                                                            Born at t = 0
                                                0.3
                                                                                                            Born at t = 3




                     Progressivity by Cohort
                                                                                                            Born at t = 6
                                               0.25
                                                                                                            Born at t = 9
                                                                                                            Born at t = 12
                                                0.2                                                         Born at t = 15

                                               0.15


                                                0.1


                                               0.05


                                                  0


                                               -0.05
                                                       0   5       10             15              20   25                     30
                                                                        Time (period = 3 years)


Figure 10: Optimal age and time varying progressivity incorporating transition. Baseline calibration.
β = 0.97.



                                                                                                   
                                                                    log(1 − τa )
log c ( ϕ, s, a, α) = log λa + (1 − τa ) log p(s, τ̄ ) + x a + α +               − ( ϕ + ϕ̄ a − γa ) + C a
                                                                       1+σ
                                                                  
                      log(1 − τa )                          1 − τa         1
  log h ( ϕ, a, ε) =               − ( ϕ + ϕ̄ a − γa ) +             ε−          Ca .
                         1+σ                                σ + τa       σ + τa

   A higher value for γa implies a higher marginal value of a unit of consumption and thus
a higher optimal consumption level. The age-dependent utility shifter γa also affects the in-
dividual labor supply decision: at ages when γa is high, individuals choose to work more in
order to consume more. As a result, γa enters the two terms in the welfare function that capture
the average disutility of work and the effective hours worked by each skill type. Moreover, γa
shifts the relative marginal utility of consumption across ages, and as a result, it modifies the
cost of consumption dispersion between and within skill types, the last two terms of the welfare
function.
   Following the same steps we delineated to construct the steady-state welfare expression in
the baseline economy, we obtain an analogous welfare expression for the model with life-cycle
variation in the taste for consumption. The modified expression for steady-state welfare for the
case β = 1 is in the Appendix.
   We now turn to the parameterization of this model. From the expressions for equilibrium
individual allocations, it is immediate that γa and ϕ̄ a cannot be separately identified from
data on hours worked or consumption. We therefore resort to the interpretation of the term
(1 + σ)(γa − γa−1 ) as the log change in the consumption equivalence scale between ages a − 1
and a due to changes in family size. Given σ = 2, we estimate the age profile for γa from

                                                                               40
                                  0.4                                                             1

                                                                                                 0.9
                                  0.3
                                                                                                 0.8

                                  0.2                                                            0.7


                  Progressivity




                                                                                   Y, C, and H
                                                                                                 0.6
                                  0.1
                                                                                                 0.5
                                    0
                                                                                                 0.4

                                  -0.1                                                           0.3                   Earnings
                                                     Marginal Tax Rate                                                 Consumption
                                                                                                 0.2
                                  -0.2                                                                                 Hours
                                                                                                 0.1

                                  -0.3                                                            0
                                      25   30   35   40   45   50   55   60                        25   30   35   40   45   50   55   60
                                                      Age                                                          Age

   Figure 11: Optimal age-dependent progressivity with age variation in the taste for consumption.


Fernandez-Villaverde and Krueger (2011), who compute an average across the most commonly
used equivalence scales. Then, given the vector {γa }, we estimate { ϕ̄ a } residually from the age
profile for hours worked, as under the baseline calibration.
    The Fernandez-Villaverde and Krueger equivalence scale increases by roughly 25% from
age 25 to age 50 and declines moderately thereafter. The implied estimated path for the utility
shifter γa follows a similar profile. From the viewpoint of the planner who has to set tax rates
optimally, older households should now receive higher consumption. Relative to the bench-
mark case, the planner therefore redistributes less across ages and, as a consequence, chooses
flatter profiles for both λa and τa . This implies smaller potential welfare gains from moving to
an age-varying tax system. Figure 11 depicts optimal age-dependent progressivity in this case.


6.5 Extension II: age variation in the Frisch elasticity
In this section, we allow older workers’ labor supply to become more elastic to changes in after-
tax wages as they approach full retirement.
    As reported by Blundell et al. (2016), direct evidence on labor supply elasticities around
retirement is scarce. The few estimates cited in their survey suggest that the Frisch elasticity
may be up to three times higher at ages 60-65 compared to age 45.
   We now explore the impact of higher labor supply elasticities at older ages for the optimal
profile of progressivity. We model age-varying elasticities in a simple mechanical fashion, as-
suming that the Frisch elasticity is constant at a value of 0.5 up to age 45 and then increases
linearly to reach 1.5 at age 60. Figure 12 illustrates that this increase in the elasticity eliminates
the rise in optimal progressivity after age 45. For example, in the baseline (Figure 6) τ60  ∗ = 0.17,

whereas in this extension, it is roughly zero. Thus, this late-in-life labor supply elasticity channel is

                                                                              41
                                                                                                           1
                                0.4                                                                                                        Earnings
                                                                                                          0.9
                                                                                                                                           Consumption
                                                                                                          0.8
                                0.3                                                                                                        Hours
                                                                                                          0.7
                                0.2
                Progressivity




                                                                                            Y, C, and H
                                                                                                          0.6

                                0.1                                                                       0.5

                                                                                                          0.4
                                  0
                                                                                                          0.3

                                -0.1                                                                      0.2
                                                              Marginal Tax Rate
                                                                                                          0.1
                                -0.2
                                                                                                           0
                                   25   30   35   40         45    50    55       60                        25   30   35   40         45   50    55      60
                                                       Age                                                                      Age


Figure 12: Optimal age-dependent progressivity when the Frisch elasticity of labor supply increases
after age 45.


quite powerful in moderating the rise in optimal progressivity for the elderly.
   Relative to the baseline model, old age earnings are now higher, reflecting the impact of
lower progressivity. The planner therefore has a stronger incentive to reduce λa at older ages in
order to redistribute to younger households and equate consumption across age groups. While
a lower τa tends to lower marginal tax rates at older ages, a lower λa tends to raise them, with
the net result that the average marginal tax rate is basically unchanged relative to the baseline
model.


7 Introducing borrowing and lending
The main limitation of the benchmark model is that, to preserve analytical tractability, we shut
down borrowing and lending. The risk sharing allowed in the model against insurable shocks
offers some private redistribution within age groups, but only the planner can redistribute re-
sources across age groups. Thus, one driver of age variation in optimal taxation is the planner’s
desire to facilitate intertemporal consumption smoothing.
   The key concern is that, if private saving and borrowing were allowed, households would
use financial markets to smooth consumption intertemporally, and the life-cycle channel in the
design of optimal taxes would therefore be weakened. The extent to which the optimal policy
will change will depend on the generosity of borrowing limits.
   In this section, we extend the benchmark model by allowing households to trade a risk-free
bond in zero net supply, with the interest rate r determined in the stationary equilibrium of the
model. At the same time, we shut down insurable risk (i.e., we set vε,a = 0). In this model,
wealth b is a state variable for the individual, and the steady state features a non-degenerate


                                                                                       42
wealth distribution. As a result, the equilibrium and the optimal age-dependent tax system
have to be computed numerically. The optimal tax problem is rather complicated since in prin-
ciple one has to choose a vector of A = 36 values for τa , one for each age, in order to maximize
equilibrium welfare.
   Having introduced wealth and savings, we now need to decide how to tax them. Exploring
the optimal differential taxation of earnings versus savings is beyond the scope of the paper.
We therefore simply assume that taxable income at age a includes capital income rbia but that
savings bi,a+1 − bia are tax deductible. Thus, the parametric tax/transfer function now applies to
taxable income p(si ) exp( x a + αia )hia + rbia − (bi,a+1 − bia ), and the individual budget constraint
becomes
                     cia = λa [ p(si ) exp( x a + αia )hia + (1 + r )bia − bi,a+1 ]1−τa .

This assumption is convenient because it allows us to retain a closed-form solution for the
equilibrium skill price function p(s). Note that this tax specification also has the property that
the planner effectively taxes consumption in a progressive fashion.
   We also need to specify borrowing limits. We assume that the borrowing limit for individual
i at age a can be written as
                                  bi,a+1 ≥ −b̄a · p(si ) exp(αia − ϕi ),

where {b̄a } are age-varying parameters. Note that this specification implies that borrowing
limits are proportional to the idiosyncratic components of individual wages and preferences.
Every other element of the baseline model is unchanged.
   The dynamic program of a working-age household characterizing optimal consumption/saving
and labor supply decisions now has five state variables: age a, skills s, disutility of work ϕ, pro-
ductivity α, and wealth b. Given the form of the borrowing constraint, however, it is possible to
characterize optimal individual saving and labor supply decisions by solving a simpler house-
hold problem with only two states: age a and normalized wealth, defined as wealth b relative
to the adjustment factor p(s) exp (α − ϕ) (see Appendix B for details).


7.1 Parameterization
The parameterization is the same as the one in Table 1, with the exception that the variances of
the insurable risk terms are zero at each age. The discount factor is fixed at β = 1. The only new
parameters are the age-dependent borrowing limits. When the borrowing limit parameters {b̄a }
are set to zero at all ages, the wealth distribution is degenerate at zero, since assets are in zero net
supply. In this case, the equilibrium coincides with the one of the benchmark model (modulo
the absence of insurable risk). The loosest possible limits are natural borrowing constraints: in

                                                     43
this case, the only binding constraint over the life cycle is biA ≥ 0, that is, a no-Ponzi condition
stating that the household cannot die with negative wealth.
   To set borrowing limits that realistically capture how much consumer credit households can
access, we adopt the following strategy. We use cross-sectional data from the Survey of Con-
sumer Finances (SCF) for the year 2012 (2013 survey) for households aged 25-60, as in the
model. The SCF has information on credit limits on all credit cards and on home equity lines of
credit. We begin by adding up all these limits.
   The SCF also contains information on the residual value of existing installment loans for
vehicles, boats, and other durables, and on residual values of other loans, such as borrowing
against IRAs. We multiply the value of these loans by a factor of two to reflect the fact that, on
average, households are halfway through their repayment.
   We sum up these two numbers obtained from credit limits and existing loans, and express
this total borrowing limit as a fraction of household labor income. This approach suggests that
almost 20% of US households have a credit limit of zero. Conditional on borrowing, the median
credit limit is about half annual earnings. However, it is plausible that some households could
access additional credit if they wanted to do so. With this in mind, and in the interests of
exploring a parameterization in which fairly extensive borrowing and saving is possible, we set
the age-specific credit limit to 1.5 times annual household earnings at the corresponding age,
which corresponds to roughly the 90th percentile of the distribution of our estimated credit
limits.
   Finally, to keep the Ramsey problem of the government manageable, instead of optimizing
over the full vector of τa for each age, we approximate the τa function with a Chebyshev poly-
nomial of order two and optimize over its three coefficients.23 Moreover, we assume that the
planner maximizes steady-state welfare, which is reasonable given our assumption that β = 1.


7.2 Results
Figure 13 plots age profiles for wages, hours worked, and consumption (left panel) and for
wealth (right panel) in the economy with τ US and with the US credit limit. Overall, these paths
are not much different from those in our baseline economy (recall Figure 3), which is reassuring.
The age profile for wealth illustrates that young households borrow extensively against future
earnings. After age 45, when the productivity profile levels off, they become net savers and
start lending to the young.
   Figure 14 summarizes our findings on the optimal tax scheme in this extended economy
with intertemporal trade. The top three panels consider the case in which the gross interest rate
 23 We   have verified that polynomials of order three yield only negligible additional welfare gains.

                                                         44
                              1.8                                                                       0.8

                                                                                                                      Wealth to Income Ratio
                              1.6
                                                                                                        0.6


                              1.4
                                                                                                        0.4
                                                                Wages




                                                                                        Wealth/Income
                              1.2
                                                                Hours
                   Averages

                                                                                                        0.2
                                                                Earnings
                               1
                                                                Consumption
                                                                                                          0
                              0.8

                                                                                                        -0.2
                              0.6


                                                                                                        -0.4
                              0.4


                              0.2                                                                       -0.6
                                 25   30   35   40         45    50   55      60                            25   30      35    40         45   50   55   60
                                                     Age                                                                            Age


Figure 13: Left panel: means of wages, earnings, consumption, and hours worked over the life cycle.
Right panel: average wealth-income ratio over the life cycle.


is fixed exogenously at R = 1. The bottom three panels consider the case in which the interest
rate is endogenous and adjusts to clear the market for bonds. In each case, three parameter-
izations are plotted: one “risk only” in which the life-cycle profiles { x a } and { ϕ̄ a } are flat; a
second “life cycle only” in which the variance of life-cycle productivity shocks is set to zero;
and a third “risk + life cycle” which corresponds to the baseline parameterization. Each panel
has three lines, corresponding to three alternative assumptions on the scope for borrowing:
zero borrowing, the calibrated borrowing limit for the US economy, and the natural borrowing
limit.24
   Risk only. The left panels of Figure 14 illustrate that, absent systematic life-cycle earnings
variation, allowing for intertemporal borrowing and lending has little impact on the optimal
age profile for progressivity. In each case, the optimal profile for τa is driven by the uninsurable
risk channel, which calls for progressivity to increase with age.
   Life cycle only. Consider now the models in which there are no productivity shocks (mid-
dle panels). Recall from Proposition 4 that absent idiosyncratic risk (either uninsurable or in-
surable), the only motive for introducing age variation in the tax system in the autarkic version
of the economy was to enable the planner to equate consumption across age groups. But when
households can borrow and lend, they will use the bond to consumption-smooth predictable
life-cycle variation in earnings. In fact, if R is fixed exogenously and equal to 1/β = 1 (middle
panel in the top row of Figure 14), then given a sufficiently loose borrowing limit, agents will
use the bond to achieve constant consumption over the life cycle, absent any age variation in
  24 In
      the endogenous interest rate economy, given that bonds are in zero net supply, ruling out borrowing also
implies no saving in equilibrium. In the exogenous interest rate economy, we rule out borrowing, but allow saving.

                                                                                   45
                                                                          Exogenous Interest Rate (R=1)
                               Risk Only                                        Life Cycle Only                                     Risk + Life Cycle
                   0.5                                             0.5                                                  0.5

                                                                                           Zero BL                                            Zero BL
                   0.4                                             0.4                                                  0.4
                                                                                           Natural BL                                         Natural BL
                                                                                           US BL                                              US BL
                   0.3                                             0.3                                                  0.3


                   0.2                                             0.2                                                  0.2
         Optimal




                                                         Optimal




                                                                                                              Optimal
                   0.1                                             0.1                                                  0.1


                     0               Zero BL                         0                                                    0

                                     Natural BL
                   -0.1                                            -0.1                                                 -0.1
                                     US BL

                   -0.2                                            -0.2                                                 -0.2
                          30    40         50       60                       30      40        50        60                    30        40        50        60
                                 Age                                                  Age                                                 Age
                                                                            Endogenous Interest Rate
                               Risk Only                                        Life Cycle Only                                     Risk + Life Cycle
                   0.5                                             0.5                                                  0.5

                                                                                            Zero BL                                             Zero BL
                   0.4                                             0.4                      Natural BL                  0.4                     Natural BL
                                                                                            US BL                                               US BL
                   0.3                                             0.3                                                  0.3


                   0.2                                             0.2                                                  0.2
         Optimal




                                                         Optimal




                                                                                                              Optimal
                   0.1                                             0.1                                                  0.1


                     0                 Zero BL                       0                                                    0

                                       Natural BL
                   -0.1                US BL                       -0.1                                                 -0.1


                   -0.2                                            -0.2                                                 -0.2
                          30    40         50       60                       30      40        50        60                    30        40        50        60
                                 Age                                                  Age                                                 Age

Figure 14: Economy with intertemporal trade. Left panels: uninsurable risk channel only. Middle pan-
els: life-cycle channel only. Right panels: both channels active. In each panel, the three lines correspond
to a zero borrowing limit, an ad hoc borrowing limit estimated from SCF data, and the natural borrowing
limit. In the top row, the interest rate is set exogenously so that R = β−1 = 1. In the bottom row, the
interest rate clears the bond market.


the return to saving induced by age variation in tax parameters. Because a constant consump-
tion profile is exactly what the planner wants, the planner has no incentive to introduce any
such age variation. This explains why, in the natural borrowing limit case, the profile for τa∗ is
flat.
   When we endogenize the interest rate, the optimal τa profile in the same specification (life
cycle only, natural borrowing limit –the middle panel in the bottom row) looks quite different
and now declines significantly over the life cycle. This reflects a new channel mediating the
optimal age profile for progressivity, which we label the interest rate channel. Under the natu-
ral borrowing limit, every agent is on her Euler equation throughout the life cycle. Given our
calibrated parameter values – and in particular, a generally increasing age profile for average
earnings – the equilibrium market-clearing interest rate is positive and thus exceeds the house-

                                                                                          46
hold’s rate of time preference. It follows that, absent age variation in either λa or τa , households
would choose positive consumption growth over the life cycle. However, as in every economy
we have considered, the planner wants to equate consumption across age groups. To achieve
this, it must choose profiles for λa and τa with the property that the after-tax interest rate is re-
duced to zero at each age. It can achieve this by choosing a declining path for λa , that depresses
after-tax returns. Given a decreasing profile for λa , it is also optimal to have τa decrease in age
in order to avoid a rising labor wedge.
   When borrowing and lending are ruled out, the optimal profile for progressivity in the life-
cycle-only economy is driven entirely by the life-cycle channel and is U-shaped and mirrors
(inversely) the efficiency net of work disutility profile. Under the US borrowing limits, the
progressivity profiles are intermediate between those under the autarky and natural borrowing
constraint extremes. The optimal profile in the endogenous interest rate case is more downward
sloping than when the interest rate is fixed at zero because the interest rate channel is operative
in this case.
    Risk + life cycle. When both the risk and life-cycle channels are present (right panels),
as in the baseline model specification plotted in the right panels the optimal profile for τa is
always a compromise, roughly averaging the profiles dictated by the uninsurable risk channel
(left panels) and the life-cycle and interest rate channels (middle panels).
    In autarky, the age profiles for τa∗ essentially coincide with the one in our benchmark model
(Figure 6, top left panel), modulo the absence of insurable risk in this parameterization. Un-
der the calibrated US borrowing limit, the optimal profiles are remarkably close to those in
autarky, suggesting that our previous analysis of the tractable autarkic case offers qualitatively
and quantitatively relevant guidance on how taxation should vary by age. At the same time,
when we impose very loose borrowing limits, the optimal policies look quite different from
autarky and vary dramatically between the exogenous and endogenous interest rate cases.


7.3 Retirement Saving
One may be concerned that optimal progressivity in the economy calibrated to US credit limits
is similar to that in autarky because we have abstracted from retirement. With a retirement
phase in the life-cycle, the saving motive during working life might be stronger, which in turn
might weaken the importance of borrowing constraints.
    We therefore add a retirement phase to the model, which we solve in partial equilibrium
( βR = 1). We assume exogenous retirement at age A − 1, corresponding to age 60, and extend
the life cycle by 20 years to age 80. During this retirement period, each worker i is entitled to a
pension proportional to a proxy for lifetime earnings given by yiR = p(si ) exp( x A−1 + αi,A−1 −

                                                 47
                                                                               Exogenous Interest Rate (R=1)
                                       Risk Only                                     Life Cycle Only                                   Risk + Life Cycle
                    0.8                                                 0.8                                                0.8

                                Zero BL                                              Zero BL                                           Zero BL
                    0.6         Natural BL                              0.6          Natural BL                            0.6         Natural BL
                                US BL                                                US BL                                             US BL
                    0.4                                                 0.4                                                0.4
          Optimal




                                                              Optimal




                                                                                                                 Optimal
                    0.2                                                 0.2                                                0.2



                      0                                                   0                                                  0



                    -0.2                                                -0.2                                               -0.2



                    -0.4                                                -0.4                                               -0.4
                           30     40     50    60   70   80                     30    40   50     60   70   80                    30    40   50     60     70   80
                                         Age                                               Age                                               Age

Figure 15: Economy with intertemporal trade and a retirement period. Left panel: uninsurable risk
channel only. Middle panel: life-cycle channel only. Right panel: both channels active. In each panel, the
three lines correspond to a zero borrowing limit, an ad hoc borrowing limit estimated from SCF data,
and the natural borrowing limit. The interest rate is set exogenously so that R = β−1 = 1.


ϕ̄ A−1 − ϕi ). This proxy is proportional to the worker’s productivity at the end of her career
and, through the disutility of work terms, it also contains a proxy for average hours over the
working life (recall Corollary 2.2).25
  The government takes this pension function as given and chooses how to tax pensions,
subject to the same functional form for the tax schedule that applies to individuals of working
age. Thus, the individual during retirement receives after-tax pension income λa (yiR )1−τa .26
   Figure 15 illustrates this case. First, note that the profile for progressivity is flat during re-
tirement because there is no active source of age dependence: retirees face no risk, and the
pension baseline yiR is constant. Because there are no distortions to labor supply during retire-
ment, one might be tempted to conjecture that the optimal τa in retirement would approach one.
However, tax progressivity in retirement still disincentivizes skill investment, since progressiv-
ity diminishes the payoff from higher skills in terms of higher pension income. The higher
is progressivity in retirement, the smaller are the marginal welfare gains from additional con-
sumption compression, while the disincentive effects on skill investment are linear in τa . Thus,
as Figure 15 illustrates, it is not optimal to push progressivity to the maximum possible value at
retirement: τa jumps discretely as labor supply distortions disappear but stays well below one.
    During working life, the optimal path for τa retains the U shape of the one in the economy
  25 While    pensions depend on idiosyncratic preference and productivity components, we maintain our assump-
tion that net taxes before retirement are a function only of labor earnings y.
   26 In this extension, we set χ = 0. Given this choice, pension outlays are similar in size to government consump-

tion in the baseline model. Recall that while the value for χ affects the level of optimal progressivity, it does not
induce age variation in optimal progressivity.


                                                                                            48
without retirement (compare Figure 15 to the top panel of Figure 14). However, the overall
level of progressivity is now lower. Thus the planner offsets the disincentive effects on skill
investment arising from high values for τa in the retirement phase of life by choosing lower
values for τa during the working phase of life.


7.4 Welfare from tax reform with intertemporal trade
The last two columns of Table 2 summarize the welfare gains from switching to the optimal tax
system under the US and natural borrowing limits in the endogenous interest rate case. Under
the US borrowing limit, the gains from moving to an age-dependent tax system are somewhat
smaller than in the autarky case but are still substantial at around 1.8% of lifetime consumption.
Under the natural borrowing limit, welfare gains shrink further to about half of the gains in
autarky. As expected, the bulk of these gains can be obtained even with an age-invariant λ.


8 Conclusions
This paper has developed an equilibrium framework to study the optimal degree of progres-
sivity in the tax and transfer system over the life cycle. Building on Heathcote et al. (2017), the
main innovation in this paper is to allow for age-dependent tax progressivity. When calibrat-
ing the analytically tractable economy without intertemporal trade to the US we find that the
optimal age profile for tax progressivity is U-shaped, while the average marginal tax is increas-
ing and concave in age. This U shape survives, but is moderated, in a more realistic version
of the model with borrowing and saving and calibrated credit constraints. In this economy,
the welfare gains of switching from the current age-invariant tax and transfer system to the
optimal age-dependent system are around 1.8% of lifetime consumption. The optimal system
and the corresponding welfare gains are sensitive to the extent of age variation in the taste for
consumption and leisure, and to the pattern of age variation in the elasticity of labor supply.
   We conclude the paper with a short discussion of elements not included in our model that
may be relevant for age dependency in the optimal tax system.
   One shortcoming of our analysis is the assumption that the age-wage profile is exogenous.
Various authors have argued that the age-wage profile is instead endogenous, and reflects hu-
man capital investments and learning-by-doing over the life cycle (Ben Porath, 1967; Imai and
Keane, 2004). Such endogeneity could potentially have interesting implications for optimal
taxation (Keane, 2011).
   Our model with borrowing and lending integrates taxation of wealth within our baseline


                                                49
two parameter tax and transfer system. Introducing a separate and potentially age-varying
tax on savings would give the planner direct control over the return to saving. This additional
instrument would weaken the interest rate channel, a force that induces progressivity to decline
with age. An even more ambitious direction for future research would be to introduce capital
explicitly as an input to production, and to explore a comprehensive joint analysis of optimal
labor and capital taxation.
   To maintain tractability we modeled the cost of skill acquisition as a utility cost. However,
some of the costs of acquiring skills are in the form of time or money. A richer model of skill
investment costs would better situate the model to address policy issues involving trade-offs be-
tween tax progressivity and education subsidies (see e.g. Bovenberg and Jacobs 2005; Krueger
and Ludwig 2016; Stantcheva 2017).
   Finally, one could enrich our model of the life cycle and to address the extent to which age
variation in marriage rates and fertility choices calls for age variation in the optimal tax and
transfer system. Later in the life-cycle, age variation in taxation can potentially substitute for
missing private markets against longevity risk in the spirit of Hosseini and Shourideh (2017).
    While all these extensions will add new trade-offs and possibly affect quantitative predic-
tions about optimal taxation, the qualitative forces motivating age variation in tax progressivity
we have described will remain salient.




References
A KERLOF, G. A. (1978): “The Economics of ‘Tagging’ as Applied to the Optimal Income Tax, Welfare
  Programs, and Manpower Planning,” American Economic Review, 68(1), 8–19.

ATKINSON , A. B., T. P IKETTY,    AND    E. S AEZ (2011): “Top Incomes in the Long Run of History,” Journal
  of Economic Literature, 49(1), 3–71.

B ANKS , J.,   AND   P. D IAMOND (2010): “The Base for Direct Taxation,” in Dimensions of Tax Design: The
  Mirrlees Review, ed. by J. Mirrlees, S. Adam, T. Besley, R. Blundell, S. Bond, R. Chote, M. Gammie,
  P. Johnson, G. Myles, and J. Poterba. Oxford University Press, Oxford.

B EN -P ORATH , Y. (1967): “The Production of Human Capital and the Life Cycle of Earnings,” Journal of
  Political Economy, 75(4, Part 1), 352–365.




                                                      50
B ÉNABOU , R. (2000): “Unequal Societies: Income Distribution and the Social Contract,” American Eco-
  nomic Review, 90(1), 96–129.

        (2002): “Tax and Education Policy in a Heterogeneous-Agent Economy: What Levels of Redis-
  tribution Maximize Growth and Efficiency?,” Econometrica, 70(2), 481–517.

B EST, M. C.,   AND   H. J. K LEVEN (2013): “Optimal Income Taxation with Career Effects of Work Effort,”
  Mimeo, Princeton University.

B LUNDELL , R., E. F RENCH ,     AND    G. T ETLOW (2016): “Retirement Incentives and Labor Supply,” in
  Handbook of the Economics of Population Aging, vol. 1, pp. 457–566. Elsevier.

B OVENBERG , L.,     AND   B. J ACOBS (2005): “Redistribution and Education Subsidies are Siamese Twins,”
  Journal of Public Economics, 89(11-12), 2005–2035.

C ONESA , J. C., S. K ITAO , AND D. K RUEGER (2009): “Taxing Capital? Not a Bad Idea after All!,” American
  Economic Review, 99(1), 25–48.

E ROSA , A.,   AND   M. G ERVAIS (2002): “Optimal Taxation in Life-Cycle Economies,” Journal of Economic
  Theory, 105(2), 338–369.

FARHI , E.,   AND   I. W ERNING (2013): “Insurance and Taxation over the Life Cycle,” Review of Economic
  Studies, 80(2), 596–635.

F ELDSTEIN , M. S. (1969): “The Effects of Taxation on Risk Taking,” Journal of Political Economy, 77(5),
  755–764.

F ERNANDEZ -V ILLAVERDE , J.,     AND   D. K RUEGER (2011): “Consumption and Saving over the Life Cycle:
  How Important are Consumer Durables?,” Macroeconomic Dynamics, 15(5).

F INDEISEN , S.,   AND   D. S ACHS (2016): “Education and Optimal Dynamic Taxation: The Role of Income-
  Contingent Student Loans,” Journal of Public Economics, 138(1), 1–21.

G OLOSOV, M., M. T ROSHKIN ,      AND   A. T SYVINSKI (2016): “Redistribution and Social Insurance,” Ameri-
  can Economic Review, 106(2), 359–386.

H ASSLER , J., P. K RUSELL , K. S TORESLETTEN ,     AND     F. Z ILIBOTTI (2008): “On the Optimal Timing of
  Capital Taxation,” Journal of Monetary Economics, 55(4), 692–709.

H EATHCOTE , J., K. S TORESLETTEN ,       AND   G. L. V IOLANTE (2008): “Insurance and Opportunities: A
  Welfare Analysis of Labor Market Risk,” Journal of Monetary Economics, 55(3), 501–525.

        (2014): “Consumption and Labor Supply with Partial Insurance: An Analytical Framework,”
  American Economic Review, 104(7), 2075–2126.

                                                       51
          (2017): “Optimal Tax Progressivity: An Analytical Framework,” Quarterly Journal of Economics.

H EATHCOTE , J.,      AND   H. T SUJIYAMA (2016): “Optimal Income Taxation: Mirrlees Meets Ramsey,”
  Mimeo.

H OSSEINI , R.,     AND   A. S HOURIDEH (2017): “Retirement Financing: An Optimal Reform Approach,”
  Mimeo, CMU.

I MAI , S.,   AND   M. P. K EANE (2004): “Intertemporal Labor Supply and Human Capital Accumulation,”
  International Economic Review, 45(2), 601–641.

J AKOBSSON , U. (1976): “On the Measurement of the Degree of Progression,” Journal of Public Economics,
  5(1-2), 161–168.

K AKWANI , N. C. (1977): “Measurement of Tax Progressivity: An International Comparison,” Economic
  Journal, 87(345), 71–80.

K API ČKA , M. (2015): “Optimal Mirrleesian Taxation in a Ben-Porath Economy,” American Economic Jour-
  nal: Macroeconomics, 7(2), 219–248.

K APLOW, L. (2004): “On the (Ir) relevance of Distribution and Labor Supply Distortion to Government
  policy,” Journal of Economic Perspectives, 18(4), 159–175.

K ARABARBOUNIS , M. (2016): “A Road Map for Efficiently Taxing Heterogeneous Agents,” American
  Economic Journal: Macroeconomics, 8(2), 182–214.

K EANE , M. P. (2011): “Labor Supply and Taxes: A Survey,” Journal of Economic Literature, 49(4), 961–1075.

K RUEGER , D.,      AND   A. L UDWIG (2016): “On the Optimal Provision of Social Insurance: Progressive
  Taxation versus Education Subsidies in General Equilibrium,” Journal of Monetary Economics, 77, 72–
  98.

M USGRAVE , R. A. (1959): The Theory of Public Finance: A Study in Public Economy. New York: McGraw-
  Hill.

N DIAYE , A. (2017): “Flexible Retirement and Optimal Taxation,” Mimeo, Northwestern University.

S TANTCHEVA , S. (forthcoming): “Optimal Taxation and Human Capital Policies over the Life Cycle,”
  Journal of Political Economy.

S TIGLITZ , J. E. (1985): “Equilibrium Wage Distributions,” Economic Journal, 95(379), 595–618.

W EINZIERL , M. (2011): “The Surprising Power of Age-Dependent Taxes,” Review of Economic Studies,
  78(4), 1490–1518.


                                                     52
                                                           A PPENDIX


A       Proofs
This appendix proves all of the results in the main body of the paper.


A.1      Proof of Proposition 1 [hours and consumption]
We only sketch this proof, since it follows the ones in Heathcote et al. (2014, 2017), which contain more
comprehensive versions. We solve the model by segmenting production on “islands” indexed by age a
and by the uninsurable triplet ( ϕ, α, s) . The ( a, ϕ, α, s) island planner’s problem, taking the island-specific
skill prices p(s, τ̄ ) and the aggregate fiscal variables ( G, {λ a } , {τa }) as given, is
                                        ˆ                                                                
                                                        exp [(1 + σ) ( ϕ + ϕ̄ a )]
                          max                 log c a −                            ha (ε)1+σ + χ log G        dFε
                          {c a ,h a }                           1+σ

subject to the island-level resource constraint (the equivalent of the no-bond-trading assumption):
                                              ˆ
                              ca = λa              exp [(1 − τa ) ( p(s, τ̄ ) + xa + α a + ε)] ha (ε)1−τa dFε .



    The first-order conditions with respect to c a and ha (ε) are, respectively,

                                           1
                                        c−
                                         a   = M
  exp [(1 + σ) ( ϕ + ϕ̄ a )] h(ε)σ                = Mλ a (1 − τa ) exp (( p(s, τ̄ ) + xa + α) (1 − τa )) exp (ε(1 − τa )) h(ε)−τa

where M is the multiplier on the island resource constraint. Combining the two conditions gives
                                                                                                             
            − σ+1τa                    1         (1 + σ )                                             (1 − τa )
  h( ε) = c a         (λ a (1 − τa )) σ+τa exp −           ( ϕ + ϕ̄ a ) exp ( p(s, τ̄ ) + α + xa + ε)                         (A1)
                                                 (σ + τa )                                            (σ + τa )


    Note that from the first-order conditions, c a is the same for all agents on the island, and as such it
cannot depend on ε. Using this fact, and substituting (A1) into the planner’s island-specific resource




                                                                        53
constraint, yields
                                                                                      
                          − 1−τa                         (1 − τa ) (1 + σ)
                                                       1− τa
          ca    =             (1 − τa ))
                    λ a c a σ+τa (λ a           exp −  σ + τa              ( ϕ + ϕ̄ a ) ·
                                                             (σ + τa )
                                                                                                       
                                                                                              (1 − τa )2
                  ˆ
                    exp [(1 − τa ) ( p(s, τ̄ ) + xa + α a + ε)] exp ( p(s, τ̄ ) + α + xa + ε)               dFε .
                                                                                              (σ + τa )

After a few steps of algebra, one obtains the expression for allocations in Proposition 1.


A.2            Proof of Proposition 2 [skill price and skill choice]
                                                             κ −1/ψ
The education cost is given by v ( s) =       (s)1+1/ψ , where κ is exponentially distributed, κ ∼ η exp (−ηκ ).
                                                            1+1/ψ
Recall from eq. (14) in the main text that the optimality condition for skill investment is

                                   s  ψ1                                 A −1
                       ′                                     1−β                         ∂u (c ( ϕ, α, s; λ a , τa , τ̄ ) , h ( ϕ; τa ) , g)
                      v ( s) =               = E0                             ∑     βa                                                       .   (A2)
                                    κ                       1 − βA            a=0                               ∂s

The skill level s affects only the consumption allocation (not the hours allocation) and only through the
skill price p. With some abuse of notation, we denote the skill price as a function of the entire sequence
{τa }; p ( s; {τa }) and we later show that p is a function of only s and τ̄ . Hence, using (18), (A2) can be
simplified as
                                                  s  ψ1           A −1
                                                                                             ∂ log p ( s; {τa })
                                                                =   ∑      βa (1 − τa )                          .
                                                   κ                a=0                             ∂s

We now guess that the skill price function is log-linear in the skill choice,

                                                 log p ( s; {τa }) = π0 ({τa }) + π1 ({τa }) · s,                                                (A3)

which implies that the skill allocation has the form27

                                                                                                             ψ
                                                   s(κ; { τa }) = [π1 ({τa }) · (1 − τ̄ )] · κ,                                                  (A4)

where τ̄ can be interpreted as a discounted expected progressivity rate,
                                                                                           ∞
                                                                               1−β
                                                                τ̄ ≡
                                                                              1 − βA         ∑ βa τa .
                                                                                             a=0
  27 To   see this, note that per assumption ∂ log p (s; {τa }) /∂s = π1 ({τa }), so (A2) can be written as
                                         s1                                   ∞
                                                  ψ

                                             κ
                                                         = (1 − βδ)            ∑ (βδ)a (1 − τa ) π1 ({τa })
                                                                               a =0
                                                                                                                          !
                                                                                                       ∞
                                                                                                                 a
                                                         = π1 ({τa }) 1 − (1 − βδ)                    ∑ (βδ)         τa       .
                                                                                                      a =0




                                                                                    54
    We henceforth write p as a function of s and the effective progresivity rate, τ̄. Since the exponential
distribution is closed under scaling, skills inherit the exponential density shape from κ, with parameter
ζ ≡ η [(1 − τ̄ ) π1 ({τa })] −ψ , and its density is m (s) = ζ exp (−ζs) . We now turn to the production side
of the economy. Effective hours worked N̄ are independent of skill type s (see Proposition 1). Aggregate
output is therefore
                                                        ˆ          ∞                                θ −θ 1
                                                                                        θ −1
                                              Y=                        [ N̄ · m (s)]     θ
                                                                                               ds              .
                                                                0

The (log of the) hourly skill price p ( s, τ̄ ) is the (log of the) marginal product of an extra effective hour
supplied by a worker with skill s, or
                                                             
                                                     ∂Y          1       1
                        log p ( s, τ̄ ) = log                   = log Y − log [ N̄ · m (s)]                                                                  (A5)
                                               ∂ [ N̄ · m(s)]    θ       θ
                                                 
                                          1        Y       1       ζ
                                        =   log          − log ζ + s.
                                          θ        N̄      θ       θ

                                                                                                                                         [(1 − τ̄ ) π1 ({τa })]−ψ ,
                                                                                                                           ζ         η
Equating coefficients across equations (A3) and ( A5) implies π1 ({τa }) =                                                 θ     =   θ
which yields
                                                                           η  1+1 ψ
                                                                                                      − 1+ψψ
                                              π1 ({τa }) =                              (1 − τ̄ )                                                            (A6)
                                                                             θ
and thus the equilibrium density of s is

                                                                    1+ψψ                                              1+ψψ !
                                             1           θ                                       1               θ
                           m ( s) = ( η )   1+ ψ                             exp − (η )         1+ ψ                          s .                            (A7)
                                                       1 − τ̄                                                  1 − τ̄

Similarly, the base skill price is
                                                                           η
                                       1                   Y            log θ         ψ
                           π0 ({τa }) = log                          −           +           log (1 − τ̄ ) .                                                 (A8)
                                       θ                   N̄          θ (1 + ψ ) θ (1 + ψ )

We derive a fully structural expression for π0 ({τa }) below in the proof of Corollary 2.2 when we solve for
Y and N̄ explicitly. From now on, we drop the vector notation {τa } and simply express the equilibrium
functions as functions of τ̄, (i.e., s (κ, τ̄ ), π1 (τ̄ ), and π0 (τ̄ )).


A.3       Proof of Corollary 2.1 [distribution of skill prices]
The log of the skill premium for an agent with ability κ is

                                                                                                                        η
                                π1 (τ̄ ) · s(κ; τ̄ ) = π1 (τ̄ ) · [(1 − τ̄ ) π1 (τ̄ )]ψ · κ =                             · κ,
                                                                                                                        θ




                                                                             55
where the first equality uses (A4), and the second equality follows from (A6). Thus, log skill premia are
exponentially distributed with parameter θ. The variance of log skill prices is
                                                                                                η 2               1
                     var (log p(s; τ̄ )) = var (π0 (τ̄ ) + π1 (τ̄ ) · s(κ; τ̄ )) =                      var(κ ) =      .
                                                                                                 θ                  θ2

Since log skill premia are exponentially distributed, the distribution of skill prices in levels is Pareto. The
scale (lower bound) parameter is exp(π0 (τ̄ )), and the Pareto parameter is θ.


A.4      Proof of Corollary 2.2 [aggregate quantities]
From eq. (17) and the assumption that ϕ and ε are independent, aggregate hours worked by individuals
of age a are
                                                                       ˆ ˆ
                    H ( a, τa ) = E [ h ( ϕ, ε, a; τa )] =     h ( ϕ, ε, a; τa ) dF ( ϕ) dFa (ε)                            (A9)
                                                                                                !
                                              log(1 − τa )       (1 − τa (1 + b     σa )) vε,a
                                  = exp                        −                         ·                                 (A10)
                                          (1 + σ̂a ) (1 − τa )            σa )2
                                                                         (b                 2
                                              
                                                  ε
                                     ˆ                      ˆ
                                    · exp           dFa (ε) exp (− ( ϕ + ϕ̄ a )) dF ( ϕ)
                                                 b
                                                 σa
                                                                                                  
                                               1                          τa (1 + σ̂a )       1 vε,a
                                  = (1 − τa ) · exp (− ϕ̄ a ) · exp
                                             1 + σ                                        −            .
                                                                                σ̂a2         σ̂a   2

Since α, ε, and ϕ are independent,
                          h               ithat N ( a, τa ) = exp( xa ) · E [exp(α)] · E [ exp(ε)h ( ϕ, ε, a; τa )] =
                                   it follows
                     1
                                 τa (1+ σ̂a )        1    vε,a
exp ( xa ) (1 − τa ) 1+σ exp         σ̂a2
                                                +   σ̂a    2     , and therefore

                                                                             vε,a
                                                N ( a, τa ) = exp( xa +           ) · H ( a, τa ) .                        (A11)
                                                                             b
                                                                             σa


    Finally, average output of age group a is given by

                 Y ( a, τa , τ̄ ) = E ( y ( ϕ, α, ε, a; τa , τ̄ )) = E [ p ( s; τ̄ ) exp ( xa + α) h ( ϕ, ε, a; τa )]
                                 = E [ p (s; τ̄ )] · N ( a, τa ) ,

where

                   E [ p ( s; τ̄ )] = E [ exp (π0 (τ̄ ) + π1 (τ̄ ) s)]
                                                         n      η  o                    θ
                                    = exp (π0 (τ̄ )) · E exp           ·κ = exp (π0 (τ̄ ))     .
                                                                    θ                      θ−1




                                                                       56
Thus:
                                         "           θ −θ 1       ψ                  1    #
                                               θ              1 − τ̄ (1+ψ)(θ −1) 1 (1+ψ)(θ −1)
                Y ( a, τa , τ̄ ) =
                                              θ−1                θ                η
                                                                                                       
                                                       1                         τa (1 + σ̂a )     1 vε,a
                                         · (1 − τa ) 1+σ   exp ( xa − ϕ̄ a ) +                 +            .
                                                                                      σ̂a2        σ̂a   2




A.5     Proof of Proposition 3 [optimal choice of g and {˘a }]
It is useful to begin by computing
                                         ˆ
               Ỹ ( a, τa , τ̄ ) :=         (yi,a )1−τa di = K ( a, τa , τ̄ )
                                                                                                             
                                                                 vω         (1 − τa ) (1 − τa (1 + b
                                                                                                   σa )) vε,a
                                         · exp −τa (1 − τa ) a        +
                                                                  2                      σ̂a              2

where, after some tedious algebra, one obtains
                                              1− τa
                                                                                            vϕ 
                K ( a, τa , τ̄ ) = (1 − τa ) 1+σ exp (1 − τa ) ( xa − ϕ̄ a ) − τa (1 − τa )
                                                                                              2
                                                              1θ−−τ1a   1−τa
                                                ψ 1− τa    1             θ (1+ψ)(θ −1)       θ
                                   · (1 − τ̄ ) 1+ψ θ −1                ·               ·            .
                                                          θ−1            η               θ + τa − 1


   It is also useful, for what follows, to define the shorthand notation

                                      ū ( a, λ a , τa ) : = u (c ( ϕ, s, a, α) , h ( ϕ, a, ε)) ,
                                              v̄ (τ̄ ) : = E [ v ( s(κ, τ̄ ), κ )] .



   Recall that welfare in steady state is given by

                                              A −1
                                          1
             W ss ( g, {λ a , τa }) =         ∑ E [u (c ( ϕ, s, a, α) , h ( ϕ, a, ε) , G)] − E [v (s(κ, τ̄ ), κ )] .
                                          A   a=0




                                                                  57
Thus, the Ramsey planner’s problem can be written as
                                                                                                                          !
                                                              A −1                                    A −1
                                                          1
               max W ss ( g, {λ a , τa }) =                    ∑     ū ( a, λ a , τa ) + χ log   g   ∑ Y (a, τa , τ̄ )       − v̄ (τ̄ )
             { g,λ a ,τa }                                A    a=0                                    a=0
                                                          subject to                                                                       (A12)
                             A −1                                         A −1
                     1                                                1
                             ∑      λ a Ỹ ( a, τa , τ̄ ) = (1 − g)        ∑ Y (a, τa , τ̄ ) .
                     A       a=0                                      A    a=0



   Letting ϑ denote the multiplier on the government budget constraint, and recognizing that ∂ū ( a, λ a , τa ) /∂λ a =
λ− 1   from (18), the first-order condition with respect to λ a yields
 a

                                                              1
                                                                 = ϑ · Ỹ ( a, τa , τ̄ ) .                                                 (A13)
                                                              λa

Since Ca = λ a Ỹ ( a, τa , τ̄ ), this first order condition implies that average consumption is equalized across
ages:
                                                                                   A −1
                                                                               1
                                                  ϑ −1 = C = (1 − g)               ∑ Y (a, τa , τ̄ ) .                                     (A14)
                                                                               A   a=0


   Consider now the first-order condition with respect to g:

                                                                        A −1
                                                          χ    1
                                                          g
                                                            =ϑ
                                                               A          ∑ Y (a, τa , τ̄ ) .
                                                                        a=0


Using ( A14) in the above equation yields
                                                                             χ
                                                                     g∗ =       .
                                                                            1+χ




A.6        Proof of Proposition 4 [optimal age-dependent progressivity]
To derive the exact analytical expression for the social welfare function in steady state, we analyze each
of its components one at a time. The first term in ( A12) can be written as
                                                   ˆ ˆ ˆ
                     ū ( a, λ a , τa , τ̄ ) =                log c ( a, ϕ, α, s; λ a , τa , τ̄ ) dFs dFαa dFϕ

                                                              exp ((1 + σ) ( ϕ + ϕ̄ a )) h ( ϕ, ε, a; τa )1+σ
                                                        ˆ ˆ
                                                    −                                                         dFϕ dFεa .
                                                                               1+σ




                                                                           58
Note that average log consumption for age group a is

                       E [ log c ( a, ϕ, α a , s; λ a , τa , τ̄ ) | a]
                  = {E [log c ( a, ϕ, α a , s; λ a , τa , τ̄ ) |a] − log C ( a, λ a , τa , τ̄ )} + log C ( a, λ a , τa , τ̄ )

where

                    E [log c ( a, ϕ, α a , s; λ a , τa , τ̄ ) | a]
                                             v a v                                             1 − τa
                                                    ω            ϕ
                  = log λ a + (1 − τa ) −                 −          + (1 − τa ) ( xa − ϕ̄ a ) +        log(1 − τa )
                                                    2           2                                1+σ
                                  (1 − τa (1 + b     σa )) vε,a
                    + (1 − τa )                               ·      + (1 − τa ) E [log p ( s; τ̄ )]
                                             b
                                             σa                    2

and

      E [log p ( s; τ̄ )] = π0 (τ̄ ) + π1 (τ̄ ) E [ s]
                                                                                                           
                                     ψ                                      1              θ     1         1
                π0 (τ̄ ) =                      log (1 − τ̄ ) +                       log     +     log
                            ( 1 + ψ ) ( θ − 1)                  ( 1 + ψ ) ( θ − 1)         η    θ−1       θ−1
                              1                     h              i  ψ
                                η 1+ ψ               ψ    η              1+ ψ          1
         π1 (τ̄ ) E [ s] =              (1 − τ̄ )− 1+ψ       (1 − τ̄ )        · η −1 = .
                                θ                         θ                            θ


   Thus:

    E [log c ( a, ϕ, α a , s; λ a , τa , τ̄ ) | a]
                            v a v  1 − τ                                                                       (1 − τa (1 + b
                                                                                                                              σa )) vε,a
                                             ϕ
  = log λ a − (1 − τa ) ω +                        +        a
                                                              log(1 − τa ) + (1 − τa ) ( xa − ϕ̄ a ) + (1 − τa )                   ·
                                2           2          1+σ                                                               b
                                                                                                                         σa          2
                                                                            
          ψ (1 − τa )                                    (1 − τa )          θ
    +                        log (1 − τ̄ ) +                           log
      ( 1 + ψ ) ( θ − 1)                            ( 1 + ψ ) ( θ − 1)      η
                                                       
      (1 − τa )               1                           1
    +             log                  + (1 − τa )             .
        θ−1                θ−1                            θ


   Moreover:
                                                                                                     
                                                             vω                  1 − τa (1 + bσa ) vε
       log C ( a, λ a , τa , τ̄ ) = log λ a − τa (1 − τa ) a     + (1 − τa )
                                                              2                         b
                                                                                        σa         2
                                      1 − τa
                                    +         log (1 − τa ) + (1 − τa ) ( xa − ϕ̄ a )
                                      1+σ
                                                   vϕ         (1 − τa ) ψ
                                    −τa (1 − τa )     +                       log (1 − τ̄ )
                                                   2      ( 1 + ψ ) ( θ − 1)
                                                                                                               
                                      1 − τa          1                 1 − τa              θ                θ
                                    +         log              +                    log        + log                  .
                                       θ−1          θ−1          ( 1 + ψ ) ( θ − 1)         η            θ + τa − 1


                                                                         59
   Therefore, the difference between these two terms is

                             E [log c ( a, ϕ, α a , s; λ a , τa , τ̄ ) | a] − log C ( a, λ a , τa , τ̄ )
                                                                                                       
                                          2 vω a          v ϕ  1 − τa                           θ
                           = − (1 − τa )             +            +             − log                      .
                                               2           2               θ              θ + τa − 1

and combining all these terms gives

             A −1          A −1                v a v  1 − τ                                 
         1           1                           2ω    ϕ      a             θ
             ∑ ūa = A     ∑        − (1 − τa )     +    +      − log                + log C ( a) .
         A   a=0           a=0                    2   2    θ            θ + τa − 1


   Average disutility of hours worked in age group a is

                                  exp ((1 + σ) ( ϕ + ϕ̄ a )) h ( ϕ, ε, a; τa )1+σ
                             ˆ ˆ
                                                                                  dFϕ dFεa
                                                     1+σ
                           1 − τa
                                    ˆ
                         =            exp ((1 + σ) ( ϕ + ϕ̄ a )) exp(− (1 + σ) ( ϕ + ϕ̄ a ))dFϕ
                            1+σ
                             ˆ                                           
                                             1+σ                   1+σ
                           ·     exp −                C a exp              ε    dFεa
                                          σ (1 − τa )
                                          b                           b
                                                                      σ
                           1 − τa
                         =         .
                            1+σ

The average cost of skill investment in each cohort of newborns is
                                                                                                
                                                                               ψ        1 − τ̄
                                                     ˆ
                                        v̄ (τ̄ ) =           v (κ; τ̄ ) dFκ =                        .
                                                                              1+ψ         θ
                                                                                   
Combining these components, and noting that as β → 1 the constant (1 − β) / 1 − β A → 1/A, we can
rewrite the social welfare function (up to a constant) only as a function of {τa } as
                                                                            !
                               A −1                                 A −1
                           1
    W ss ( g, {τa }) =         ∑      ū a − v̄ + χ log         g   ∑ Ya
                           A   a=0                                  a=0
                               A −1        v a v  1 − τ                                       
                           1                  ω      ϕ   2       a             θ
                    =    ∑ − (1 − τa ) 2 + 2 + θ − log θ + τa − 1 + log C (a)
                           A
                        a=0
                                                         
                        1 A−1 1 − τa          ψ      1 − τ̄                     A −1
                      − ∑             −                       + χ log g + χ log ∑ Ya
                        A a=0 1 + σ         1+ψ         θ                       a=0
                        A −1                                                      
                      1                    2 vω a   vϕ      1 − τa             θ
                               − (1 − τa )                         − log                 + log (1 − g)
                      A a∑
                    =                             +      +
                         =0                   2     2         θ            θ + τa − 1
                                                         
                        1 A−1 1 − τa          ψ      1 − τ̄                           A −1
                      − ∑             −                       + χ log g + (1 + χ) log ∑ Ya ,
                        A a=0 1 + σ         1+ψ         θ                             a=0



                                                                       60
where the last step above uses eq. ( A14), which combines the optimality condition for λ a (stating that
consumption is equalized across ages) and the government budget constraint.
   Substituting the expression for Ya (25) into the above expression for W ss ( g, {λ a , τa }), we arrive at

                                                                    A −1
                                                               1                   1 − τa
     W ss ( g, {τa }) = log (1 − g) + χ log g −                     ∑                                                                            (A15)
                                                               A    a=0             1+σ
                                                                                   | {z }
                                                                           Disutility of labor
                                             (                                                                                           )
                                                 A −1                    1                                 τa (1 + σ̂a )    1        vε,a
                         + (1 + χ) log               ∑   (1 − τa )      1+ σ   · exp xa − ϕ̄ a +                         +
                                                 a=0                                                            σ̂a2       σ̂a        2
                                             |                                                   {z                                          }
                                                                                         Effective hours N̄a
                                                 "                                                                       θ (1+ψ) !#
                                        1                                                               1           θ
                         +(1 + χ)                  ψ log (1 − τ̄ ) + log
                                  (1 + ψ)(θ − 1)                                                       ηθ ψ        θ−1
                                  |                               {z                                                                 }
                                                         Productivity: log (average skill price ) = log ( E [ p( s,τ̄ )])
                                                             A −1                                      
                             ψ 1 − τ̄   1                                                 1 − τa      1 − τa
                         −            +                       ∑         log 1 −                    +
                           1+ψ θ        A                     a=0                           θ           θ
                           |  {z    }                               |                         {z              }
                           Avg. education cost                          Cost of consumption dispersion across skills
                                             A −1
                                         1        1                      
                                     −           ∑  (1 − τa )2 v ϕ + avω                                   .
                                         A   a=0 |2          {z          }
                         Cons. dispersion due to unins. shocks and preference heterogeneity


Each term in this welfare function has the economic interpretation described under each bracket. For
more details, see Heathcote et al. (2017). This welfare expression is only a function of g and {τa } . The
optimal choice of the public good yields g∗ = χ/ (1 + χ), which proves statement (i) of the proposition.
Substituting this optimal choice back into ( A15) yields an expression for welfare that is only a func-
tion of the sequence {τa }. Given the sequence of optimal age-dependent progressivity obtained from
maximizing ( A15), the optimal sequence of {λ a } can be recovered residually from ( A13) .
                                                                                                               ∂W ss
   Taking the first-order condition of ( A15) with respect to τa (i.e., setting                                 ∂τa    = 0), we arrive at eq.
(28) in the main text. Standard algebra yields the second-order condition

             ∂2 W ss                 1                                    
                       = −                       2
                                                     − v ϕ + avω
              ∂2 τa         (θ − 1 + τa )
                                                    a
                              1+χ           ψ       δβ2
                          −
                               θ−1        1 + ψ (1 − τ̄ )2
                                     "                                                #
                              1+χ         Na          1                  3 σ − 2τa
                          −                    ·             + ( σ + 1)              vε,a
                              1+σ         N̄      (1 − τa )2              (σ + τa )4
                                                                    !          
                              1+χ            1        1+σ 3               1          Na 1 ∂Na
                          +                      +              τa vε,a      1−               .
                              1+σ         1 − τa     σ + τa               N̄         N̄ A ∂τa




                                                                    61
                                                                                                        ∂Na
Clearly, the first two terms are negative. The last term is always negative since N̄ A ≥ Na and         ∂τa   < 0,
recall eq. (23). Therefore, a sufficient condition for the third term to be negative is that σ ≥ 2. This
establishes that the social welfare function is globally concave in {τa } when σ ≥ 2, so the first-order
condition (A16) is necessary and sufficient to characterize the optimal τa .
    (i) Simple differentiation establishes that this optimality condition is

                                      1        1                               1
                            0 =              − + (1 − τa ) v ϕ + avω +              +                     (A16)
                                  θ − 1 + τa   θ                              1+σ
                                                       
                                       1+χ       1      1     ψ
                                  −                   −           βa
                                        θ − 1 1 − τ̄    θ 1+ψ
                                           "                             #
                                      1+χ        1          σ+1 3              N ( a, τa )
                                  −                   +              τa vε,a               ,
                                      1+σ      1 − τa      σ + τa              N̄ ({τa })

where the expressions for N ( a, τa ) and N̄ ({τa }) are given in Corollary 2.2.
    (ii) By inspecting (A16), it is immediate to see that age a does not enter as an argument in the first-
order condition provided that vω = 0, the sequences {vεa } and { xa − ϕ̄ a } are constant, and one of the
following conditions is satisfied: either β → 1 or θ → ∞. Therefore, the sequence of optimal τa must be
independent of age in this case. As a consequence, Ỹ ( a) is age-invariant, and hence, from the first-order
condition ( A13), the optimal λ∗a must also be independent of age.
    (iii) Relative to the benchmark in (ii), when vω > 0, the optimal τa∗ is increasing with age since a
larger value for avω must be balanced by a lower value for (1 − τa ).
    (iv) Relative to the benchmark in (ii), when vε,a increasing in age between age a and a + 1, it is easy
to see that τa∗ > τa∗+1 .
    (v) Relative to the benchmark in (ii), the optimal τa∗ is increasing with age also when β < 1 and
θ < ∞. To see this, note that the term on the second line,
                                                                   
                                           1 + χ 1 − βδ 1       1        ψ
                                   −                          −             ( β) a ,
                                           θ − 1 1 − δ 1 − τ̄   θ       1+ψ

is negative and increasing in a when β < 1 and τ̄ ≥ 0. Thus, when a increases, the other terms must fall.
                                                  
Note that the terms θ −11+τa , (1 − τa ) v ϕ + avω , and the term in the third line are all decreasing in τa . It
follows that τa must increase with age.
    (vi) Relative to the benchmark in (ii), when { xa − ϕ̄ a } is increasing with age N ( a) / N̄ is increasing
in age in the last term of (A16). Thus, a lower value of (1 − τa )−1 is needed to counterbalance this force,
which implies that the optimal τa∗ is decreasing in age.




                                                         62
A.7        Proof of Corollary 4.1 [optimal age-dependent taxation with life cycle
           only]
When individuals differ only by age, the equilibrium expressions for hours and earnings simplify to

                                                                               1
                                    h( a) = exp(− ϕ a )(1 − τa ) 1+σ ,                                      (A17)
                                                                                                  1
                               w( a)h( a) = Na (τa ) = exp( xa − ϕ a )(1 − τa )                  1+ σ   .   (A18)



    Under the assumptions stated in the corollary, the first-order condition for optimal progressivity at
age a is
                                                                    Na (τa∗ )
                                          1 − τa∗ = (1 + χ)                      .                          (A19)
                                                                 N (τ̄ ({τa∗ }))


    Equations (A18) and (A19) combined imply

                                                                                   1+σ σ
                                                           exp( xa − ϕ̄ a )
                                      1 − τa∗   = (1 + χ )                                   .              (A20)
                                                           N (τ̄ ({τa∗ }))


    Recall that the planner wants to choose the sequence {λ a } to equate consumption across age groups.
Thus, it will set λ∗a subject to
                                                                       ∗
                                            c( a) = λ∗a Na (τa∗ )1−τa = C,

which implies
                                                                 C
                                                  λ∗a =                    .
                                                          Na (τa∗ )1−τa
                                                                       ∗




    The intratemporal first-order condition at age a is

                          λ a (1 − τa ) (w( a)h( a)) −τa w( a)
                                                               = exp (− (1 + σ) ϕ̄ a ) h( a)σ ,
                                           C

and since w( a)h( a) = Na (τa ), the labor wedge in this intratemporal first-order condition is

                                          LWa = λ a (1 − τa ) Na (τa )−τa                                   (A21)
                                                    C
                                              =          (1 − τa ).
                                                Na (τa )




                                                            63
   Now plug the expression for Na (τa ) (A18) and the solution for (1 − τa∗ ) (A20) into ( A21) , which gives

                                                                     1+χ
                                                        LWa =                    C,
                                                                 N (τ̄ ({τa∗ }))

which demonstrates that the labor wedge is independent of age. Moreover, from the resource constraint
and the optimal public good provision condition, we know that

                                                 C (1 + χ) = Y = N (τ̄ ({τa∗ })),

which implies that LWa = 1 (i.e., the effective marginal tax rate is zero).
   Because the optimal tax and transfer scheme leaves labor supply undistorted and equates consump-
tion across age groups, it implements the first-best allocation.
   Finally, from eq. ( A21) , imposing LWa = 1 and averaging across age groups gives

                                                 A −1                             A −1
                                             1                                1
                                      Y=         ∑      Na (τa ({τa∗ })) =        ∑      C (1 − τa∗ ).
                                             A   a=0                          A   a=0



                 C        1
   Then, using   Y   =   1+ χ ,   we get the expression for the optimal average degree of tax progressivity,

                                                               A −1
                                                           1
                                                               ∑      τa∗ = −χ.
                                                           A   a=0




A.8     Proof of Proposition 5 [optimal age dependent taxation with transition]
First, note that the derivations and expressions for equilibrium allocations, conditional on a given fiscal
policy, are identical to those in the proofs of Propositions 1 and 2 and Corollaries 2.1 and 2.2. The analysis
only differs once we start constructing the expression for social welfare because allocations and policies
now vary by time. Define

                                       Ya,t = E [ pa,t (s; τ̄a,t ) exp( xa + α)ha,t ( ϕ, ε; τa,t )]

                                                             Ca,t = λ a,t Ỹa,t

where                                      h                                                        i
                                                                                               1− τ
                                  Ỹa,t = E ( pa,t (s; τ̄a,t ) exp( xa + α)ha,t ( ϕ, ε; τa,t )) a,t ,




                                                                      64
and let
                                                                      A −1
                                                                 1
                                                      Yt =
                                                                 A    ∑ Ya,t
                                                                      a=0
                                                                      A −1
                                                                 1
                                                      Ỹt =
                                                                 A    ∑ Ỹa,t
                                                                      a=0

denote the corresponding population averages.
      The government budget constraint can be written as

                                                                      A −1
                                                                  1
                                                (1 − gt ) Yt =         ∑      λ a,t Ỹa,t .                                (A22)
                                                                  A    a=0



      Given the allocations described, we can assemble the components of social welfare in eq. (29).
                                                                                                            1− β a
      Expected utility from consumption for age group a at date t (ignoring the term                       1− β A
                                                                                                                  β   in eq. (2),
which pre-multiplies all the utility components involving consumption, hours, and public consumption)
is

     E [log c a,t ( ϕ, α, s; λ a,t , τa,t , τ̄a,t )] = {E [log c a,t ( ϕ, α, s)] − log Ca,t } + log Ca,t                    (A23)
                                                                       v a v                                           
                                                                     2     ω        ϕ                  1 − τa,t      1 − τa,t
                                                     = −(1 − τa,t )            +       + log 1 −                  +
                                                                           2       2                      θ             θ
                                                + log λ a,t + log Ỹa,t .



      Expected utility from public good provision is

                                                          χ log ( gt Yt ) .                                                (A24)



      Expected disutility from hours worked for age group a at date t is
                                                                                   
                                 exp [(1 + σ) ( ϕ̄ a + ϕ)]                     1+ σ      1 − τa,t
                              −E                           ha,t ( ϕ, ε; τa,t )        =−          .
                                         1+σ                                              1+σ


      The expected utility contribution from skill investment for age group a at date t is
                                        "                      #                   
                                      κ −(1/ψ)           1+1/ψ       ψ    1 − τ̄a,t
                                   −E          s(τ̄a,t )         =−                   .
                                      1 + 1/ψ                       1+ψ      θ




                                                                65
   We can now compute total welfare for the planner, as of date 0, using eqs. (2) and (29).
   Note first that the policy parameters λ a,t only appear in the terms involving expected utility from
consumption and the government budget constraint. Let ζ t denote the multiplier on this constraint (eq.
A22).
   The first-order condition with respect to λ a,t is

                                            1                      Ca,t
                                                 = ζ t Ỹa,t = ζ t       ,
                                           λ a,t                   λ a,t

which implies
                                                             1
                                                   Ca,t =       .
                                                             ζt
Thus, given Ỹa,t (which is independent of λ a,t ), the policy parameter λ a,t is set so that average consump-
tion for age group a is independent of age and only varies with time. This value for Ca,t is uniquely
pinned down from the government budget constraint, given a value for gt :

                                           Ca,t = Ct = (1 − gt )Yt ,                                    (A25)

which implies
                                                        (1 − gt )Yt
                                              λ a,t =               .
                                                           Ỹa,t


   With the expression for Ca,t in eq. (A25) substituted into the first row of eq. (A23), λ a,t no longer
appears in any of the terms in social welfare.
   Now consider the optimality condition for gt . Note that gt appears in the form χ log gt in the contri-
bution from publicly provided goods (eq. A24) and in the form log(1 − gt ) in the contribution from the
level of average private consumption. The first-order condition with respect to gt immediately implies
                   χ
the result gt =   1+ χ .



A.9      Proof of Proposition 6 [optimal taxation with transition and inelastic
        labor supply]
We now write out all the terms in social welfare explicitly. To start with, we allow for flexible labor
supply (σ < ∞). In order to economize on space, we assume people live for only two periods: the
generalization to A > 1 is straightforward.
   The date t component of social welfare in the expression eq. (29) (ignoring the terms χ log gt and
log(1 − gt ), which do not involve any τa,t parameters) is




                                                        66
                                                                                                 
             1−β                  1 − τ1,t          1 − τ1,t     1 − τ1,t                 1
                       log 1 −                 +               −          + (1 + χ) log     (Y0,t + Y1,t )
             1 − β2                   θ                θ          1+σ                     2
                                                                                                    
                1−β                  1 − τ0,t         1 − τ0,t     1 − τ0,t                  1
           +             log 1 −                 +               −          + (1 + χ) log      (Y0,t + Y1,t )
               1 − β2                   θ                  θ        1+σ                      2
                                                   
                           1− β
               ψ  1 − 1− β2 (τ0,t + βEt [ τ1,t+1 ]) 
           −                                             ,
             1+ψ                    θ

where the first line reflects the contribution to welfare from the old, and the second and third lines the
contribution from the young.
   Output of the young and old at t is given by

                                                                                   1
                                                      Y0,t = (1 − τ0,t ) 1+σ · E t [ p0,t ]
                                                                                   1
                                                      Y1,t = (1 − τ1,t ) 1+σ · E t−1 [ p1,t ],

where
                                                                                                                     ψ                        
                                                        θ −θ 1             (1 − β )                             (1+ ψ )(θ −1)        1
                                               θ                      1−             (τ
                                                                            (1− β2 ) 0,t
                                                                                           + βEt [τ1,t+1 ])                        1 (1+ψ)(θ −1) 
      E t [ p0,t ] = E t [ p1,t+1 ] =                                                                                                         .
                                               θ−1                                      θ                                          η


                    1
Note that Yt =  (Y0,t + Y1,t ) depends on τ0,t , Et [τ1,t+1 ], τ1,t and Et−1 [τ1,t ].
                    2
   At t = 0 (the time of the reform), only three tax parameters (τ0,0 , τ1,1 , τ1,0 ) affect contemporaneous
output:

                                            −σ                                     1   ∂E0 [ p0,0 ]
                        1
                   1 − 1+σ (1 − τ0,0 )            E0 [ p0,0 ] + (1 − τ0,0 ) 1+σ
                                           1+ σ
∂ log Y0                                                                                 ∂τ0,0
               =                                                                                      : young adjust hours & skill inv. at t = 0
  ∂τ0,0            2                                      Y0
                                 1     ∂E0 [ p1,1 ]
                   1 (1 − τ1,1 )
                                1+ σ
∂ log Y0                                 ∂τ1,1
               =                                      : young adjust skill investment at t = 0 in response to τ1,1
  ∂τ1,1            2           Y0
                                            −σ
                        1
∂ log Y0           1 − 1+σ (1 − τ1,0 ) 1+σ E −1 [ p1,0 (τ−1 )]
               =                                               : old adjust hours at t = 0
  ∂τ1,0            2                   Y0

In contrast, for a generic date t > 0, output depends on four different parameters:




                                                                              67
                                         −σ                                  1   ∂E [ p0,t ]
                     1
               1 − 1+σ (1 − τ0,t )                E [ p0,t ] + (1 − τ0,t ) 1+σ
                                         1+ σ
∂ log Yt                                                                          ∂τ0,t
           =                                                                                   : young adjust hours & skill inv. at t
  ∂τ0,t        2                                      Yt
                              1     ∂E [ p0,t ]
               1 (1 − τ0,t )
                             1+ σ
∂ log Yt                             ∂τ1,t +1
           =                                       : young adjust skill investment at t
∂τ1,t+1        2           Yt
                                         −σ                                  1   ∂E [ p1,t ]
                     1
               1 − 1+σ (1 − τ1,t )                E [ p1,t ] + (1 − τ1,t ) 1+σ
                                         1+ σ
∂ log Yt                                                                          ∂τ1,t
           =                                                                                   : old adjust hours at t & skill inv. at t − 1
  ∂τ1,t        2                                      Yt
                              1     ∂E [ p1,t ]
               1 (1 − τ1,t )
                             1+ σ
∂ log Yt                             ∂τ0,t −1
           =                                       : old adjust hours at t & skill inv. at t − 1
∂τ0,t−1        2           Yt


   Thus, in general τ0,t affects both Yt and Yt+1 , while τ1,t affects Yt and Yt−1 .
   Consider the generic first-order condition for τ0,t for all t ≥ 0. We have

                                                                       
                                                 1−β               ∂ log Yt
                                                      2
                                                          (1 + χ )                                               :   effect on old at t
                                                1−β                  ∂τ0,t
                                                                        
                                                                    1− β
                  1
    1−β                    1  1             ∂ log Yt         ψ     1− β2
+       2
                 θ       − +    + ( 1 + χ)             +                                                       :   effect on young at t
    1−β       1−
                  1− τ0,t   θ 1+σ              ∂τ0,t       1+ψ          θ
                    θ
                                                                        
                                          1−β                  ∂ log Yt+1
                                   +β                (1 + χ )                                                    :   effect on old at t + 1
                                         1 − β2                   ∂τ0,t
                                                                        
                                          1−β                  ∂ log Yt+1
                                   +β                ( 1 + χ )                                                   :   effect on young at t + 1
                                         1 − β2                   ∂τ0,t
                                                                                                                = 0



   The terms here are readily interpretable. Increasing τ0,t reduces skill investment at t, which reduces
output at t + 1. This reduces welfare for young and old at t + 1 (the last two lines). Increasing τ0,t also
reduces output at t, both through the skill investment channel, and by reducing the labor supply of
the young. This accounts for the first line and the term involving output in the second line. Finally,
increasing τ0,t compresses consumption inequality among the young at t, reduces hours worked by the
young at t, and reduces skill investment costs by the young at t. These are the remaining terms in the
second line.




                                                                        68
   Now consider the generic first-order condition for τ1,t+1 for t ≥ 0. This condition is
                                                                                
                                                                    1−β∂ log Yt
                                                             (1 + χ )                                        : effect on old at t
                                                                    1 − β2
                                                                       ∂τ1,t+1
                                                                    1− β  
                               
                       1−β                    ∂ log Yt      ψ  1− β2 
                  +                 ( 1 + χ )          + β                                                   :      effect on young at t
                       1 − β2                 ∂τ1,t+1      1+ψ          θ
                                                                              
                         1
         1−β                             1        1              ∂ log Y t +1 
    +β                   θ          − +              + (1 + χ )                                            :      effect on old at t + 1
         1 − β2     1−
                          1− τ1,t +1      θ      1 + σ              ∂τ1,t+1
                              θ
                                                                            
                                               1−β                ∂ log Yt+1
                                        +β               (1 + χ )                                            :      effect on young at t + 1
                                              1 − β2                ∂τ1,t+1


   We can write these two first-order conditions more compactly as
                                                                                                                                
                              ∂ log Yt    ∂ log Yt+1                   ψ 1                          1         1   1
            2( 1 + χ )                 +β                           +      +                                 − +                       =0           (A26)
                                ∂τ0,t        ∂τ0,t                    1+ψθ                    (θ − 1 + τ0,t ) θ 1 + σ



                                                                                                                               
                       ∂ log Yt    ∂ log Yt+1                 ψ 1                                1          1   1
      2( 1 + χ )                +β                        +β      +β                                       − +                         =0           (A27)
                       ∂τ1,t+1       ∂τ1,t+1                 1+ψθ                         (θ − 1 + τ1,t+1 ) θ 1 + σ


   Now note that
                                                                     −σ                              1      ∂E [ p0,t ]                      1     ∂E [ p1,t +1 ]
                                           1
                             1 − 1+σ (1 − τ0,t )                           E [ p0,t ] + (1 − τ0,t ) 1+σ                      1 (1 − τ1,t+1 )
                                                                    1+ σ                                                                    1+ σ
    ∂ log Yt    ∂ log Yt+1                                                                                   ∂τ0,t                                    ∂τ0,t
             +β            =                                                                                              +β
      ∂τ0,t        ∂τ0,t     2                                                   Yt                                          2           Yt+1
                                                1     ∂E [ p0,t ]                                     −σ                                     1     ∂E [ p1,t +1 ]
                                                                                  1
                         1 (1 − τ0,t )                                 1 − 1+σ (1 − τ1,t+1 )                 E [ p1,t+1 ] + (1 − τ1,t+1 ) 1+σ
                                               1+ σ                                                  1+ σ
∂ log Yt    ∂ log Yt+1                                ∂τ1,t +1                                                                                      ∂τ1,t +1
         +β            =                                            +β
∂τ1,t+1       ∂τ1,t+1    2           Yt                                2                                              Yt+1

                                   ∂E [ p1,t+1 ]   ∂E [ p0,t ]    ∂E [ p1,t+1 ]    ∂E [ p0,t ]
                                                 =             =β               =β
                                    ∂τ1,t+1         ∂τ1,t+1          ∂τ0,t          ∂τ0,t
which jointly imply
                                                                                                                       −σ                 −σ !
 ∂ log Yt    ∂ log Yt+1                ∂ log Yt    ∂ log Yt+1                        1                      (1 − τ0,t ) 1+σ   (1 − τ1,t+1 ) 1+σ
          +β            =β                      +β                               +β     E [ p0,t ]                          −
 ∂τ1,t+1       ∂τ1,t+1                   ∂τ0,t        ∂τ0,t                         1+σ                          Yt                Yt+1
                                                                                                                                             (A28)


   Now consider the case with inelastic labor supply, so that σ → ∞. The second term on the right-hand
side of the above equation drops out. Then substituting this equation into the first-order condition for


                                                                            69
τ1,t+1 (eq. A27), it is clear that the first-order conditions for τ0,t and τ1,t+1 are exactly symmetric, except
that all the terms in the latter are multiplied by β.
   It follows that the optimal value for τ0,t is equal to the optimal value for τ1,t+1 . Note, finally, that
the optimal value for these policy parameters must be strictly less than one. The reason is that from the
first-order condition eq. (A26), the marginal value of consumption compression at τ0,t = 1 is zero, while
the marginal cost in terms of reduced skill investment and output is strictly positive.
   Now consider the optimal choice for τ1,0 , progressivity for the old at the time of the tax reform, which
is the only choice we have not explored so far. The first-order condition here is
                                                                         
                            1         1   1              ∂ log Y0                           ∂ log Y0
                                     − +      + (1 + χ )                      + (1 + χ )             = 0,
                      (θ − 1 + τ1,0 ) θ 1 + σ              ∂τ1,0                              ∂τ1,0

where                                                                −σ
                                                    1
                                    ∂ log Y0   1 − 1+σ (1 − τ1,0 ) 1+σ E −1 [ p1,0 ]
                                             =
                                      ∂τ1,0    2              Yt
Here, an increase in τ1,0 reduces consumption inequality among the old and reduces the old’s labor
supply, which translates into reduced output and thus consumption and government spending for both
the young and the old at date 0.
   With inelastic labor supply, the first-order condition simplifies further to

                                                     1         1
                                                              − = 0,
                                               (θ − 1 + τ1,0 ) θ

which immediately implies τ1,0 = 1.


A.10      Extension to age variation in the taste for leisure
By following the same steps of the proof of Proposition 1, we arrive at the new allocations:
                                                                                       
                                      log(1 − τa )                             1 − τa              1
                   log h ( ϕ, a, ε) =              − ( ϕ + ϕ̄ a − γa ) +                    ε−          Ca ,     (A29)
                                         1+σ                                   σ + τa            σ + τa

                                                                                                     
                                                                      log(1 − τa )
   log c ( ϕ, s, a, α) = log λ a + (1 − τa ) log p(s, τ̄ ) + xa + α +              − ( ϕ + ϕ̄ a − γa ) + C a .   (A30)
                                                                         1+σ


   The equilibrium skill prices p(s, τ̄ ) remain unchanged. By following the same derivations needed to
obtain the steady-state welfare expression (27), we arrive at:




                                                          70
                    A −1
                1       1 − τa
W ({τa }) = −       ∑          exp ((1 + σ) γa )                                                                                 (A31)
                A   a=0 |1 + σ    {z          }
                               Disutility of labor
                                (                                                                                            )
                                    A −1                1                                     τa (1 + σ̂a )    1         vε,a
           + (1 + χ) log            ∑      (1 − τa )   1+ σ   · exp xa − ϕ̄ a + γa +                 2
                                                                                                            +
                                    a=0                                                            σ̂a        σ̂a         2
                                |                                               {z                                               }
                                                                    Effective hours worked N̄a
                                   "                                                               θ (1+ψ) !#
                          1                                                        1           θ
           +(1 + χ)                  ψ log (1 − τ̄ ) + log
                    (1 + ψ)(θ − 1)                                                ηθ ψ        θ−1
                    |                               {z                                                           }
                               Productivity of skill investment: log(average skill price ) = log( E [ p( s )])
                                              A −1                                                         
               ψ 1 − τ̄   1                                                                   1 − τa      1 − τa
           −
             1+ψ θ
                        +
                          A                   ∑ exp ((1 + σ) γa )              log 1 −
                                                                                                θ
                                                                                                       +
                                                                                                            θ
             |  {z    }                       a=0                          |                      {z              }
                Avg. education cost                                              Consumption dispersion across skills
                        A −1
                    1                                  1                              
             −
                    A   ∑ exp ((1 + σ) γa ) · 2 (|1 − τa )2 {zv ϕ + avω }
                    a=0
           Cons. dispersion due to uninsurable risk and preference heterogeneity




                                                              71
B      Extension to borrowing and saving
This appendix describes the extension of the benchmark model to an economy where households are
allowed to trade a risk-free bond in zero net supply.


B.1      Economic Environment
The economic environment is virtually identical to the one in the main text. We therefore only highlight
what differs.
Financial assets: The main difference from the benchmark model consists of the ability of households
to save inha risk-free asset
                         i b with gross return R = 1 + r. Short positions are allowed up to an exogenous
             p(s,τ̄ ) exp(α a )
limit −b̄a       exp( ϕ)
                                  , where b̄ A = 0, that is, a no-Ponzi condition stating that the household cannot
die with negative wealth needs to hold. Assets are in zero net supply, (i.e. B = 0). Thus, when b̄a = 0 for
all a, the only equilibrium is autarky, and the benchmark model becomes a special case of this general
model.

Government: We assume that the tax base is total income net of saving, (i.e., expenditures), or

                                  mi,a = p(si , τ̄ ) exp( xi,a + αi,a )hi,a + rbi,a − (bi,a+1 − bi,a ).            (B1)

As we will see, this assumption is convenient because it allows us to simplify the model and retain
the closed-form solution for the equilibrium skill price function p(s, τ̄ ). The tax and transfer scheme is
defined as in the main text, that is,
                                                        Ta (mi,a ) = mi,a − λ a m1i,a−τa .                         (B2)

We abstract from the possibility that the government can issue debt or save. The government budget
constraint therefore reads as

                                       1   A −1 ˆ
                                                                  1   A −1 ˆ   h                         i
                                   g       ∑        yi,a di a =       ∑            mi,a − λ a (mi,a )1−τa di a .   (B3)
                                       A   a=0                    A   a=0




                                                                          72
B.2      Solution to the household problem
The agent chooses skills at age a = 0. Abstract from this choice for now and consider an individual with
skill level s. After the skill choice, the household solves
                                                    A −1                                                                
                                            1−β                  a                 exp [(1 + σ) ( ϕ̄ a + ϕ)] 1+σ
                       max E0                         ∑      β           log c a −                          ha + χ log G
                    { b a+1 } aA=−01       1 − βA     a=0                                   1+σ
                    s.t.
           c a = λ a [ p(s, τ̄ ) exp( xa + α a )ha + Rba − ba+1 ]1−τa

and                                                                                                
                                                                             p ( s, τ̄ ) exp (α a )
                                                ba+1 ≥ −b̄a                                           .                        (B4)
                                                                                   exp ( ϕ)


   The first-order condition for hours worked and the Euler equation are

          (1 − τa ) p(s, τ̄ ) exp( xa + α a )
                                                        = exp [(1 + σ) ( ϕ̄ a + ϕ)] hσa
      p(s, τ̄ ) exp( xa + α a )ha + Rba − ba+1
                                                                                                                  
                       (1 − τa )                                                           (1 − τa+1 )
                                                        ≥ βRE a
      p(s, τ̄ ) exp( xa + α a )ha + Rba − ba+1                    p(s, τ̄ ) exp( xa+1 + α a+1 )ha+1 + Rba+1 − ba+2
                                                                                                    
                                                                              p ( s, τ̄ ) exp (α a )
                                                        = if ba+1 > −b̄a                               .
                                                                                    exp ( ϕ)


   Define transformations of endogenous variables as follows:

                                                   ĥa = ha · exp ( ϕ)                                                         (B5)
                                                                  exp ( ϕ)
                                                   b̂a = ba ·                                                                  (B6)
                                                              exp (α a ) p ( s, τ̄ )
                                                                     exp ( ϕ)
                                               b̂∗a+1 = ba+1 ·                                                                 (B7)
                                                                exp (α a ) p ( s, τ̄ )
                                                                        b̂∗a+1
                                               b̂a+1 =                                                                         (B8)
                                                                     exp (ω a+1 )


   With some algebra, it can easily be shown that the two first-order conditions can be rewritten in terms




                                                                              73
of these transformed variables as

       (1 − τa ) exp( xa )
                                      = exp [(1 + σ) ϕ̄ a ] ĥσa
    exp( xa )ĥa + Rb̂a − b̂∗a+1
                                                                                                                                       
                                                                       
                 1                                     1 − τa+1                                          1
                                      ≥ βR                                  Ea                                                       
    exp( xa )ĥa + Rb̂a − b̂∗a+1                        1 − τa                     exp (ω a+1 ) exp( xa+1 )ĥa+1 +   Rb̂a+1 − b̂∗a+2
                                      =        if b̂∗a+1 ≥ −b̄a .



    The advantage of writing the first-order conditions in this way is that age a and transformed wealth
b̂a are the only idiosyncratic states. We can use a backstepping algorithm starting from the known fact
that b̂ A = 0.                                                                                                           
    In particular, from the household problem, we obtain policy functions ĥa b̂a ; τa , b̂∗a+1 b̂a ; {τa } , ĉ a b̂a ; {τa } ,
where ĉ a := exp( xa )ĥa + Rb̂a − b̂∗a+1 . From these decisions, by rescaling back to the original states, we
can obtain:
                                                                                     
                ha (ba ; ϕ, τa ) = ĥa b̂a · exp (α a ) · p (s, τ̄ ) exp (− ϕ) ; τa exp (− ϕ)
                                                                                                                               
   ba+1 (ba ; α a , s, ϕ, {τa }) = exp (α a ) · p ( s, τ̄ ) exp (− ϕ) · b̂∗a+1 b̂a · exp (α a ) · p ( s, τ̄ ) exp (− ϕ) ; {τa }
                                                                                                1−τa
     c a (ba ; α a , s, ϕ, {τa }) = λ a [ p ( s, τ̄ ) exp (α a ) exp (− ϕ)]1−τa ĉ a b̂a ; {τa }       ,

where the last one is obtained residually from the budget constraint.


B.3      The wealth distribution
Suppose we have come up with an interest rate such that

                                                       A −1 ˆ                 
                                                       ∑               b̂∗a+1 b̂a dFb̂a = 0,
                                                       a=0      b̂ a


if so, it can be shown that the true bond market clears, that is,

                                A −1 ˆ        ˆ ˆ ˆ
                                ∑                          ba+1 (ba ; α a , s, ϕ, ø)dFs dFα0 dFϕ dFba = 0.
                                a=0      ba   s   αa   ϕ



    If we denote the distribution for an individual of age a µ a (b̂; {τa }), we know that µ0 (b̂ = 0) = 1; that
is, all the mass is at b = 0 (individuals are born with zero wealth). We can therefore easily initiate the
recursion and move forward using the household’s policy functions.



                                                                             74
B.4     Welfare
The planner maximizes welfare:
                                                                                                     !
                                                              A −1                            A −1
                                                          1
                                      W ( g, λ a , τa ) =      ∑     ū a − v̄ + χ log   g·   ∑ Ya
                                                          A    a=0                            a=0

              ψ     1− τ̄
                            
where v̄ =   1+ ψ    θ          is the average education cost for the newborn cohort and the period utility term is
                                             ˆ                                                
                                                                 exp [(1 + σ) ( ϕ̄ a + ϕ)] 1+σ
                                    ū a =         log (ci,a ) −                          hi,a di a ,
                                                                          1+σ




B.5     Computation
To find the optimal tax function, we start by setting g = χ/(1 + χ), the optimal solution, and approxi-
mate the τa function with a Chebyshev polynomial of order two. We then maximize the welfare function
with respect to the three parameters of the Chebyshev polynomial. The formal algorithm is as follows:

   1. Guess coefficients of Chebyshev polynomial { p j }2j=0 .

   2. Evaluate the Chebyshev polynomial to get the full vector {τa }aA=−01 :

       (a) Guess an interest rate, R .
       (b) Given R and {τa } aA=−01, solve the household problem using the endogenous grid method .
       (c) Compute the asset distribution {µ a (b̂)}aA=−01 and total asset demand .
       (d) If asset demand is zero go to 3, otherwise update R and go back to 2b .

   3. Given the solution to the household problem, compute welfare .

   4. If welfare is maximized, stop; otherwise, update { p j }2j=0 and go back to 2 .

   To solve the household problem, we use a grid with 50 points on [−b̄a , bmax ] with bmax = 10 (further
increasing the number of grid points or bmax has no effect on results). To compute the asset distribution,
we use the histogram method on the same grid used for the household problem with 3,000 grid points.
Finally, we approximate the ω distribution using Gaussian quadrature with nine Gauss-Hermite nodes.




                                                                      75
