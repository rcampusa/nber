                                 NBER WORKING PAPER SERIES




                  HEDONIC PRICES AND IMPLICIT MARKETS:
      ESTIMATING MARGINAL WILLINGNESS TO PAY FOR DIFFERENTIATED
               PRODUCTS WITHOUT INSTRUMENTAL VARIABLES

                                           Kelly C. Bishop
                                         Christopher Timmins

                                         Working Paper 17611
                                 http://www.nber.org/papers/w17611


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                     November 2011




We thank the seminar/conference participants at the AERE/ASSA Annual Meetings, Camp Resources,
Iowa State University, Montana State University, Syracuse University, the Triangle Resource and
Environmental Economics Workshop, the UEA/RSAI Annual Meetings, the University of Wisconsin,
the University of Stirling, the University of Aberdeen, LSE Center for Economic Performance, and
Econometric Society Summer Meetings for their helpful comments and suggestions. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2011 by Kelly C. Bishop and Christopher Timmins. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Hedonic Prices and Implicit Markets: Estimating Marginal Willingness to Pay for Differentiated
Products Without Instrumental Variables
Kelly C. Bishop and Christopher Timmins
NBER Working Paper No. 17611
November 2011
JEL No. Q51,R0

                                             ABSTRACT

The hedonic model of Rosen (1974) has become a workhorse for valuing the characteristics of differentiated
products despite a number of well-documented econometric problems. For example, Bartik (1987)
and Epple (1987) each describe a source of endogeneity in the second stage of Rosen's procedure that
has proven difficult to overcome. In this paper, we propose a new approach for recovering the marginal
willingness-to-pay function that altogether avoids these endogeneity problems. Applying this estimator
to data on large changes in violent crime rates, we find that marginal willingness-to-pay increases
by ten cents with each additional violent crime per 100,000 residents.


Kelly C. Bishop
Olin Business School
Washington University in St. Louis
Box 1133, 1 Brookings Drive
St. Louis, MO 63130
kbishop@wustl.edu

Christopher Timmins
Department of Economics
Duke University
209 Social Sciences Building
P.O. Box 90097
Durham, NC 27708-0097
and NBER
christopher.timmins@duke.edu
1       Introduction

Dating back to the work of Court (1939), Grilliches (1961), and Lancaster (1966), hedonic
techniques have been used to estimate the implicit prices associated with the attributes of
differentiated products. Rosen’s (1974) seminal work proposed a theoretical structure for
the hedonic regression and a two-stage procedure for the recovery of marginal willingness-to-
pay (MWTP) functions of heterogeneous individuals for the characteristics of differentiated
products. Importantly, his two-stage approach allowed for two sources of preference hetero-
geneity: individuals’ MWTP functions could differ with (i) their individual attributes and (ii)
the quantity of the product attribute that they consume. The latter is particularly important
when considering non-marginal policy changes (i.e., any change that is large enough to alter
the individual’s willingness to pay at the margin). The two-stage procedure suggested by
Rosen (and further developed by subsequent authors) uses variation in implicit prices (ob-
tained either by employing data from multiple markets or by allowing for non-linearity in the
hedonic price function) to identify the MWTP function.

        With Rosen (1974) as a backdrop, the property value hedonic model has become the
workhorse for valuing local public goods and environmental amenities, despite a number of
well-known and well-documented econometric problems.1 Our concern in this paper is with
an important problem that arises in the second stage of Rosen’s two-step procedure. In
separate papers, Bartik (1987) and Epple (1987) describe a source of endogeneity that is
difficult to overcome using standard exclusion restriction arguments. Specifically, they note
that unless the hedonic price function is linear, the hedonic price of a product attribute
varies systematically with the quantity consumed. The researcher therefore faces a difficult
endogeneity problem in the estimation of Rosen’s second stage. Moreover, because of the
    1
    See Taylor (2003) and Palmquist (2005) for a comprehensive discussion. Some of these problems arise in
the first stage of Rosen’s two-step procedure; for example, omitted variables that may be correlated with the
local attribute of interest. There is a large and growing literature that describes both quasi-experimental and
structural solutions to this problem (see Parmeter and Pope (2009) for a discussion).


                                                      2
equilibrium features of the hedonic model, there are very few natural exclusion restrictions
that one can use to solve this endogeneity problem. In particular, within-market supply-side
shifters – the typical instrument of choice when estimating a demand equation – are not valid
in this context. This has generally left researchers to choose from a variety of weak instrument
strategies or instruments based on cross-market preference homogeneity assumptions that may
be difficult to justify. With a few exceptions, the hedonics literature has subsequently ignored
Rosen’s second stage, focusing instead on recovering estimates of the hedonic price function
and valuing only marginal changes in amenities.2,3

       In this paper, we propose an estimation procedure for the recovery of the structural pa-
rameters underlying the MWTP function that avoids the Bartik-Epple endogeneity problem
altogether. We do this by exploiting the relationship between the quantity of the amenity
being consumed and the attributes of the individuals doing the consumption. That such a
relationship should exist in hedonic equilibrium goes back to the idea of “stratification” found
in Ellickson (1971), which became the basis for estimable Tiebout sorting models.4 Our pro-
posed method is identified even in a single-market setting, given a flexible representation of
the hedonic price function and a parametric representation of the MWTP function. Impor-
tantly, our procedure is computationally simple and easy to implement. Moreover, it does
not require any more in terms of data or assumptions than does the standard hedonic model.
   2
     See, for example, Black (1999), Gayer, Hamilton, and Viscusi (2000), Bui and Mayer (2003), Davis (2004),
Figlio and Lucas (2004), Chay and Greenstone (2005), Linden and Rockoff (2008), Pope (2008), Greenstone
and Gallagher (2008), Bajari, Cooley, Kim, and Timmins (2011), and Gamper-Rabindran, Mastromonaco,
and Timmins (2011).
   3
     Deacon et al. (1998) noted that “To date no hedonic model with site specific environmental amenities
has successfully estimated the second stage marginal willingness to pay function.” Since that time, a number
of papers have examined the problem of recovering preferences from hedonic estimates. Bajari and Benkard
(2005) avoid the Bartik-Epple endogeneity problem by relying on strong parametric assumptions on utility
that turn Rosen’s second-stage from an estimation problem into a preference-inversion procedure. We report
results based on their suggested procedure in our application. Ekeland, Heckman, and Nesheim (2004) provide
an alternative approach to recovering MWTP that imposes very little in terms of parametric restrictions, but
requires an additive separability assumption in the MWTP specification. Heckman, Matzkin, and Nesheim
(2010) illustrate conditions under which non-separable utility functions may be non-parametrically identified
(in both single and multiple markets) and propose a non-parametric estimator.
   4
     See, for example, Epple, Filimon and Romer (1984), Epple and Romano (1998), Epple and Platt (1998),
and Epple and Sieg (1999).


                                                     3
     To demonstrate the usefulness of this approach, we implement our estimation procedure
using data on large changes in violent crime rates in the San Francisco Bay Metropolitan Area
over the period 1994 to 2000. We find that recovering the full MWTP function is economically
important; an individual’s marginal willingness to pay to avoid an incident of violent crime
(measured by cases per 100,000 residents) increases by 10 cents with each additional incident.
Non-marginal reductions in crime of the sort seen in San Francisco and the rest of the nation
during the 1990s therefore have the potential to significantly affect MWTP. We find that
naive estimators, which ignore this effect, yield estimates of total willingness to pay for crime
reductions in San Francisco that are significantly biased. Similar problems are likely to arise
in other settings where policy changes are not marginal – e.g., air quality, school reform, and
hazardous waste site remediation.

     This paper proceeds as follows. Section 2 describes the endogeneity problem discussed
by Bartik (1987) and Epple (1987) and reiterates the intuition for why the problem has been
so difficult to solve with standard exclusion restrictions. Section 3 describes our alternative
estimation procedure in detail. Section 4 describes the data used in our application – hous-
ing transactions data from the San Francisco Metropolitan Area combined with violent and
property crime data from the RAND California Database. Section 5 reports the results of
applying our estimator to these data. Section 6 calculates the welfare effects from the actual
non-marginal changes in crime faced by a subset of homeowners and compares these welfare
effects with those calculated with alternative procedures in the existing literature. Finally,
Section 7 concludes.




                                               4
2       Why Has It Been So Difficult To Recover The MWTP

        Function?

In their respective 1987 articles, Epple and Bartik each discuss the econometric problems
induced by the equilibrium sorting process that underlies the formation of the hedonic price
function. In particular, unobserved determinants of tastes affect both the quantity of an
amenity that an individual consumes and (if the hedonic price function is not linear) the
hedonic price of the attribute.5 In a regression like the one described in the second stage
of Rosen’s two-step procedure, the quantity of the amenity that an individual consumes will
therefore be endogenous. Moreover, the exclusion restrictions typically used to estimate a
demand system (i.e., using supplier attributes as instruments) will not work because, in ad-
dition to affecting the quantity of amenity and the hedonic price paid for it, the unobservable
component of preferences also determines the supplier from whom the individual purchases.
Supplier attributes, which might naturally be used to trace-out the demand function, are
therefore correlated with the unobserved determinants of MWTP because of the sorting pro-
cess underlying the hedonic equilibrium.

        To make these ideas concrete, consider the following simple example which is based on
Epple’s model. We begin with the quadratic hedonic price function given by:


                                                             β2 2
(1)                              P (Zi ; β) = β0 + β1 Zi +     Z + i
                                                             2 i

where i = 1, . . . , N indexes houses, P (Zi ; β) measures the price of house i, and Zi measures
the level of the amenity associated with house i (for the sake of illustration, we ignore other
    5
     The linear hedonic price function assumes that attributes can be unbundled and repackaged in any com-
bination without affecting their marginal value (e.g., the marginal value of another bedroom is the same
regardless of how many bedrooms a house already has). In most empirical settings, this assumption is unre-
alistic.



                                                    5
amenities and house attributes). For now, we consider data from just a single market, but
allow for multi-market data in the following section. The linear price gradient associated with
this hedonic price function is:

                                                    ∂P (Zi ; β)
(2)                                P 0 (Zi ; β) ≡               = β1 + β2 Zi
                                                       ∂Zi

where P 0 (Zi ; β) denotes the implicit price of Zi .

       The second stage of Rosen’s procedure seeks to recover the coefficients of demand (or
marginal willingness to pay) and supply (or marginal willingness to accept) functions for the
attribute Z from the first-order conditions of the equilibrium relationships:6


(3)                        P 0 (Zid ; β) = α1 + α2 Zid + α3 Xid + νid       (demand)




(4)                          P 0 (Zis ; β) = γ1 + γ2 Zis + γ3 Xis + νis     (supply)


where Xid and Xis represent attributes of the buyers and sellers of house i, respectively. νid
and νis similarly represent unobserved idiosyncratic shocks to tastes and marginal costs.

       The problem we consider in this paper arises from the fact that Zid must necessarily be
correlated with νid because of the hedonic sorting process. This is easily shown in the following
equation. Noting that Zi = Zid in hedonic equilibrium and combining Equations (2) and (3)
yields:

                                            1
(5)                               Zi =            [(α1 − β1 ) + α3 Xid + νid ]
                                         β2 − α 2
   6
     This MWTP function is consistent with the underlying             indirect utility function given by: Ui = α0 +
α1 Zid + 21 α2 (Zid )2 + α3 Xid Zid + νi Zid + Ii − P (Zid ; β) where Ii is the income of household i. This marginal
                                                               
                                                                                                                
willingness to accept function is consistent with the underlying profit function given by: Πi = P (Zis ; β) −
γ0 − γ1 Zis − 12 γ2 (Zis )2 − γ3 Xis Zis − νis Zis .



                                                         6
       Equation (5) makes explicit that Zi will be correlated with νid .7 Therefore, in order to
estimate Equation (3) directly, the literature has sought an instrument for Zid .

       The typical approach to estimating demand functions with endogenous quantities uses
supply function shifters. The problem with that approach in this context, however, is that
hedonic sorting induces a correlation between νid and Xis . Put differently, νid determines the
supplier from whom individual i purchases, so that Xis cannot be used to instrument for Zid .

       In three respective papers, Epple (1987), Bartik (1987), and Kahn and Lang (1988)
propose alternative instrumental variables strategies to deal with this problem. Bartik, for
example, suggests instrumenting for Zid with market indicator variables. Kahn and Lang
suggest a similar instrument of market indicators interacted with household demographic
attributes. The intuition for these strategies is that differences in the distribution of suppliers
across markets will provide an exogenous source of variation in the equilibrium quantity of the
amenity chosen by each individual. The problem with these approaches is that they require
strong assumptions about cross-market preference homogeneity and the instrument may not
induce sufficient variation in the endogenous variable. Ekeland, Heckman, and Nesheim (2004)
propose an alternative instrumental variables approach to overcome the endogeneity problem.
They show that due to the non-linearity of the hedonic model, the conditional expectation
of Zid given Xid may be used to instrument for Zid . This instrumentation strategy does not
require assumptions about cross-market preference homogeneity and may be used in a single-
market setting. Our proposed estimation strategy differs from these previous approaches as
we avoid instrumental variables altogether. Our strategy is the subject of Section 3.
  7
      It is clear that Zi will be correlated with νid even when we allow for data coming from multiple markets.




                                                       7
3     Model and Estimation

In this section, we describe an alternative econometric approach, which avoids this difficult
endogeneity problem altogether, while not imposing strong assumptions on the shape of pref-
erences. Beginning with Rosen, the traditional approach has been to equate the implicit
price of the amenity Z (from the estimation of the hedonic price function) to its marginal
benefit (which is a function of Z) and use the resulting expression as the estimating equation.
The majority of the literature following Rosen has retained this framework while proposing
corrective strategies to deal with the endogeneity of Z. We note that while the first-order
conditions for hedonic equilibrium provide a set of equations that will hold in equilibrium,
nothing requires us to write the estimating equation in this manner. While this representation
does provide an intuitive interpretation of utility maximization, it is the “marginal cost equals
marginal benefit” econometric specification itself which has created the endogeneity problem
that has plagued this literature for decades.

     Returning to the basic structure of the hedonic model, there is no fundamental endo-
geneity problem. When choosing how much of the amenity Z to consume, individuals take
the hedonic price function as given and choose Zi to maximize utility based on their in-
dividual preferences. These preferences are determined by a vector of observed individual
characteristics, Xid , and unobserved taste shifters, νid . As νid and Xid are typically assumed
to be orthogonal in the hedonic model, we are left with a familiar econometric modeling en-
vironment: an endogenous outcome variable, Zi , which is a function of a vector of exogenous
variables, Xid , and an econometric error, νid . Intuitively, our approach finds the parameters of
the MWTP function that maximize the likelihood of observing each household’s chosen Zi .

     We first consider the case in which a closed-form solution for Zi exists and the estimation
approach is intuitive and simple. In the general case of our model, where a closed-form for
Zi may not exist, we show that by using a simple change-of-variables technique it is still

                                                8
straightforward to compute the likelihood of observing Zi . Also in this section, we provide
evidence of our estimator’s small sample properties with Monte Carlo simulation results.



3.1     The Simple Model: When a Closed-Form Solution for Z Exists

In this subsection, we consider a special case of the general model in which Zi may be easily
isolated in the first-order condition for utility maximization. While our proposed estimator is
applicable to a much richer specification of the model (as discussed in Section 3.2), we present
this simplified case first as the estimation strategy is extremely transparent.

      Consider the simple, linear-quadratic model where the hedonic price function is given
by:

                                                                 β2,j 2
(6)                           P (Zi,j ; β) = β0 + β1,j Zi,j +        Z + i,j
                                                                  2 i,j

and i indexes houses and j indexes markets (defined by space or time). The hedonic price
gradient for market j is therefore:

                                                 ∂P (Zi,j ; β)
(7)                           P 0 (Zi,j ; β) ≡                 = β1,j + β2,j Zi,j
                                                    ∂Zi,j

where P 0 (Zi,j ; β) denotes the implicit price of Zi,j .

      Specifying the household’s indirect utility as:

                                               1
        U (Zi,j , Xid ; α) = α0,j + α1,j Zi,j + α2 Zi,j
                                                    2                      d
                                                        + α3,j Xid Zi,j + νi,j
                                                                                                      
(8)                                                                            Zi,j + Ii − P (Z, ; β)
                                               2

where Ii represents household i’s income, we arrive at the following first-order condition for




                                                        9
Zi,j :


(9)                        α1,j + α2 Zi,j + α3,j Xid + νi,j
                                                        d
                                                            − β1,j − β2,j Zi,j = 0



    The traditional estimation strategy associated with Rosen would first recover an estimate
                   
of β1,j + β2,j Zi,j from the estimated price gradient, isolate this term on the left hand side
of Equation (9), and estimate the resulting regression equation (i.e., the MWTP function),
          d
treating νi,j as the regression error, in a separate second stage:


                             β1,j + β2,j Zi,j = α1,j + α2 Zi,j + α3,j Xid + νi,j
                                                                             d
                                             
(10)



         Our approach is to alternatively rearrange Equation (9) such that the single endogenous
variable, Zi,j , is isolated on the left:

                                   α1,j − β1,j        α3,j                 1
(11)                    Zi,j = (               )+(           )Xid + (          )ν d
                                   β2,j − α2       β2,j − α2          β2,j − α2 i,j


         Equation (11) describes how the consumption of the amenity Z varies with observable
household characteristics, Xid , unobservable preference shocks, νi,j
                                                                  d
                                                                      , and parameters of the
hedonic price function, {β1,j , β2,j }. This equation contains all of the information necessary
to recover the parameters describing individual preferences, {α1,j , α2 , α3,j , σ}. Using hats
to indicate that {β
                  d1,j , β2,j } are known from the first-stage estimation of the hedonic price
                         d

function, we may write:

                                   α1,j − β
                                          d1,j        α3,j                 1
(12)                    Zi,j = (               )+(           )Xid + (             d
                                                                                )νi,j
                                   β2,j − α2
                                   d               β2,j − α2
                                                   d                  β2,j − α2
                                                                      d


                                                    d
         Making the distributional assumption that νi,j ∼ N (0, σ 2 ), Zi,j is then distributed nor-


                                                      10
                          α1,j −βd             α
mally with mean ((               1,j
                                     )   + ( βd3,j )Xid )) and standard deviation ( β2,jσ−α2 ). This reveals a
                            2,j −α2
                           βd                  −α
                                              2,j   2

straightforward Maximum Likelihood approach for estimating the remaining parameters.8 In
particular, we find the vector of parameters, {α1,j , α2 , α3,j , σ}, that maximizes the likelihood
of the observed vector {Zi,j }N                                  N             d
                              i=1 . This likelihood is given by Πi=1 `(Zi,j , Xi ; α, σ) where:


(13)
                                   1                   1                  α1,j − β
                                                                                 d1,j        α3,j
 `(Zi,j , Xid ; α, σ) =                  √ exp{−        σ   2
                                                              (Z i,j − ((             )+(           )Xid ))2 }
                          ( βdσ−α       ) 2π     2( βd −α )
                                                     2,j  2
                                                                          β2,j − α2
                                                                          d               β2,j − α2
                                                                                          d
                             2,j    2




3.1.1     Indirect Least Squares


It is worth considering the very special case of this model when estimation is particularly
straightforward: the case where the structural parameters may be recovered using a least-
squares estimation.

       As an example, consider the specification above with exactly two markets. In this case,
Equation (12) may be estimated using an extremely transparent indirect least squares (ILS)
procedure. With the same number of equations as unknown structural parameters,9 it be-
comes a simple matter to recover the structural parameters {α1,j , α2 , α3,j , σ} from the
reduced-form parameters {θ0,j , θ1,j , σu,j } (which are recovered using OLS for each market j)
by exploiting the unique mapping between the two sets:

                                     α1,j − β
                                            d1,j      α3,j              1
(14)                      Zi,j = (               )+(       ) Xid + (           d
                                                                             )νi,j
                                     β −α            β −α            β −α
                                    | 2,j{z 2 } | 2,j{z 2 }        | 2,j {z 2 }
                                     d               d               d
                                            θ0,j           θ1,j                 ui,j

   8
     Kahn and Lang (1988) suggest estimating a restricted version of Equation (12) via non-linear least squares.
However, their estimator requires the strong cross-market homogeneity assumption that all of the utility
parameters are constant across markets. Additionally, their proposed estimator is only applicable for the
subset of cases where a closed-form solution for Z exists and does not generalize to the cases we present in
Section 3.2.
   9
     Let L denote the number of elements
                                             in X and J denote the number of markets. The reduced-form
estimation returns
                     J ∗ (L  + 1) + J   parameters. The number of structural parameters in Equation (12) is
 J ∗ (L + 1) + 2 . Therefore, for J = 1, this model is underidentified (given the linear price gradient). For
J = 2, it is exactly identified. For J ≥ 3, the model is overidentified.

                                                           11
         With more than two markets, one could add richer heterogeneity to the MWTP function
(e.g., by parameterizing either the slope of the MWTP function or the variance of ν) in order
to take advantage of all available information.10



3.2        The General Model: When a Closed-Form Solution for Z May

           Not Exist

We now consider a more general form of the model, in which we do not rely on finding a
closed-form solution for Zi,j . The lack of a closed-form solution will be the case for most
non-linear gradient specifications (including the log-linear gradient specification that we use
in our application in Section 5).11 In this case, we are still able to estimate the model using
Maximum Likelihood with a simple change-of-variables technique.

                                        d
         Consider first the case where νi,j is an additively-separable error that enters households’
linear MWTP functions and does not enter the hedonic price function. In this case, finding a
                          d
closed-form solution for νi,j is trivial. We show that by employing a basic change of variables
(from Z to ν d ), a closed-form solution for νi,j
                                              d
                                                  is sufficient for forming the likelihood of observing
Zi,j .

         In the following example, we impose no parametric assumption on the price function,
P (Zi,j ; β), and show how it may no longer be possible to rearrange the first-order condition
  10
     One could also use this additional information with a more general estimation strategy to overidentify
the model’s parameters.
  11
     As a general rule, one should not expect the hedonic price gradient to be linear. Additionally, specifying the
MWTP to be linear is not inconsistent with a nonlinear price gradient in equilibrium; as clearly demonstrated
by Ekeland, Heckman, and Nesheim (2004), a linear MWTP function alone does not imply a linear price
gradient. For the equilibrium price gradient to be linear (with demand- and supply-side heterogeneity), it
would not only require that consumers have a perfectly linear MWTP function, but also that suppliers have
a perfectly linear marginal willingness-to-accept function and that shocks to both preferences and profits are
exactly normal. A key insight of the Ekeland, Heckman, and Nesheim paper is that very minor perturbations
of any of these conditions will lead to substantial non-linearity in the resulting equilibrium price gradient.




                                                        12
to isolate Zi,j :


(15)                       α1,j + α2 Zi,j + α3,j Xid + νi,j
                                                        d
                                                            − P 0 (Zi,j ; β) = 0



                                                                                          d
       However, in this case we are still able to easily find a closed-form solution for νi,j :


(16)                          d
                             νi,j = P 0 (Zi,j ; β) − α1,j − α2 Zi,j − α3,j Xid



                                                  d
       Making the distributional assumption that νi,j ∼ N (0, σ 2 ) and using a textbook applica-
tion of a change of variables, it is straightforward to form the likelihood ΠN             d
                                                                             i=1 `(Zi,j , Xi ; α, σ)

where:

                                                                     d
                                                 1      1          ∂νi,j
(17)                     `(Zi,j , Xid ; α, σ) = √ exp{− 2 (νi,j
                                                            d 2
                                                                )}
                                               σ 2π    2σ          ∂Zi,j


       To implement this Maximum Likelihood procedure, we only need to calculate the value
    d                                                        b and X d ) and the determinant
of νi,j consistent with the observed value of Zi,j (given α, β,     i

of the Jacobian associated with the change of variables (i.e., we do not need to solve the
differential equation for Zi,j ). Respectively, these terms are given by:


(18)                          d
                             νi,j = P 0 (Zi,j ; β)
                                                b − α1,j − α2 Zi,j − α3,j X d
                                                                           i




and:

                                        d
                                      ∂νi,j
(19)                                        = |P 00 (Zi,j ; β)
                                                            b − α2 |
                                      ∂Zi,j


       In practice, finding the vector of parameters that maximizes the likelihood is straight-



                                                    13
forward and may even be reduced to a one-dimensional numerical optimization problem.12

       The model presented thus far is one where Zi,j is a scalar amenity. However, our approach
may be easily extended to estimate models that consider a K-dimensional vector of amenities
                 1           K
denoted Zi,j = [Zi,j , ..., Zi,j ]. Assuming that the elements of the vector ν di,j are distributed
jointly normal with mean zero and variance-covariance matrix Σ, the likelihood may be
formed employing the change-of-variables technique without the need to solve the differential
equations for Zi,j . This likelihood is given by:

                                                                                0
                                                     −K     − 12
                                                                          ν di,j Σ−1 ν di,j ∂(νi,j
                                                                                               d1           dK
                                                                                                   , ..., νi,j   )
(20)       `(Zi,j , Xid , ν di,j ; α, Σ)   = (2π)     2   |Σ|       exp{−                  }     1           K
                                                                                  2          ∂(Zi,j , ..., Zi,j )

where:
                                                                                                     
                                  ∂P (Zi,j ;β)                            1,1
                     d1
                   νi,j              1
                                  ∂Zi,j       
                                                        1
                                                      α1,j            α2         ···  α21,K       1      1
                                                                                                 Zi,j  α3,j 
                    .  
                       ..  =       ..        .   .
                                              −  ..  −  ..                       ...    ..    .   .  d
                                                                                                   .   . 
(21)      ν di,j = 
                                   .                                                  .   .  −  .  Xi
                                                                                                     
                                ∂P (Zi,j ;β)
                      dK
                     νi,j         ∂Z K
                                                  α K
                                                   1,j     α2K,1                    · · · α2K,K      K
                                                                                                   Zi,j     K
                                                                                                           α3,j
                                           i,j




       Finally, while the MWTP function specified thus far has been both linear and additively
                                       d
separable in the idiosyncratic shock, νi,j , richer specifications of the MWTP function may
be estimated using our framework. Our estimator simply requires that one is able to isolate
                          d
the idiosyncratic shock, νi,j . For example, (returning to a scalar amenity, Z) if the MWTP
function were given by:13


(22)                                        P 0 (Zi,j ; β) = Zi,j
                                                              α2
                                                                  (Xid )α3,j νi,j
                                                                              d


  12
      Concentrating the likelihood function given by Equation (17) allows for a single-dimensional search over
α2 . For each iteration of the likelihood (i.e., for each guess of α2 ), the likelihood-maximizing values of α1,j
and α3,j may be recovered through the least-squares regression of P 0 (Zi,j ; β)
                                                                                             
                                                                                 b −α b2 Zi,j on market indicators
                                                                                  PN
and Xid , while the likelihood-maximizing value of σ 2 may be recovered as N1 i=1 (νi,j   d 2
                                                                                             ) .
   13
      In this case, the underlying indirect utility function would be given by: U (Zi,j , Xid ; α) =
           α2 +1
( α21+1 ) Zi,j   (Xid )α3,j νi,j
                             d
                                 + (Ii − P (Zi,j ; β)).



                                                                14
      d
then νi,j may be recovered as:


                                            d       P 0 (Zi,j ; β)
                                                                b
(23)                                       νi,j   = α2
                                                   Zi,j (Xid )α3,j

   d
 ∂νi,j
 ∂Zi,j
          may be recovered as:


                                 d
                               ∂νi,j                b − α2 Z −1 P 0 (Zi,j ; β)
                                       P 00 (Zi,j ; β)                      b
                                                                i,j
(24)                                 =                 α2
                               ∂Zi,j                 Zi,j (Xid )α3,j

and the likelihood may be formed using the change-of-variables technique.

         It is important to note that the contribution of this paper is to illustrate a new estimation
approach that avoids the traditional endogeneity problems that have plagued the literature.
As the formal identification of the hedonic model has been discussed in detail in Brown and
Rosen (1982), Mendelsohn (1985), and particularly, Ekeland, Heckman, and Nesheim (2004)
and Heckman, Matzkin, and Nesheim (2010), we instead provide an informal discussion of
identification, as the nature of our estimator allows for easy illustration of what data features
pin down the parameters of the MWTP function.

         Consider the model with linear MWTP outlined earlier in this section. When the MWTP
intercept (α1 ), the coefficients on X d (α3 ), and the MWTP variance (σ 2 ) are common across
markets, they are identified by the mean Z, the covariance between Z and X d , and the variance
of Z, respectively. Four sources of variation identify the slope of the MWTP function. The
first source is the sensitivity of mean Z to changes in the price gradient across markets. The
second source is the sensitivity of the variance of Z to changes in the price gradient across
markets. The third source is the sensitivity of the covariance of Z and X to changes in
the price gradient across markets. The final, fourth source is the nonlinearity of the price
gradient; Z will not be distributed normally when the gradient is nonlinear creating additional
identifying variation (particularly if Z is allowed to have market-specific distributions).

                                                       15
       When the intercept of the MWTP function is allowed to vary by market, the variation
in mean Z across markets is used to identify the market-specific intercepts of the MWTP
function and is no longer available to identify the slope of MWTP. In this case, higher levels
of mean Z are associated with higher market-specific values for α1,j , all else equal. A similar
logic applies when the coefficients on X d are allowed to vary by market and differences in
the covariance between Z and X d are used to identify {α3,j }Jj=1 or when the variance of ν d
is allowed to vary by market and variance of Z is used to identify {σj2 }Jj=1 . Finally, when all
of the parameters of the MWTP function are allowed to vary by market, this is analogous to
multiple single-market cases and the non-linearity of the price gradient is the only remaining
source of identification of the MWTP slope. This is consistent with the established wisdom in
the hedonic literature - one either needs a non-linear hedonic price gradient or multi-market
data to recover the full MWTP function.



3.3      Monte Carlo Evidence

In this subsection, we provide Monte Carlo evidence on the performance of our proposed
estimator. We begin with Monte Carlo simulations of the simplest two-market model. From
this starting point, we increase the number of markets and increase the level of heterogeneity
in both the market-specific gradient intercepts and slopes. Finally, we allow the MWTP
intercept to vary by market.

       For the first simulations, the hedonic gradient is given by:


(25)                                P 0 (Zi,j ; β) = β1,j + β2,j Zi,j


and the first-order condition for utility maximization is given by:


(26)                                            d
                                α1 + α2 Zi,j + νi,j − P 0 (Zi,j ; β) = 0

                                                   16
yielding the MWTP function:


(27)                              P 0 (Zi,j ; β) = α1 + α2 Zi,j + νi,j
                                                                   d




and optimal consumption of Z:

                                           α1 − β1,j          1
(28)                            Zi,j = (             )+(          )ν d
                                           β2,j − α2     β2,j − α2 i,j


       We allow the number of markets to take on the following values: j = {2, 5, 10, 50}.
We specify that β1,j = 2 + η1 and β2,j = 0.7 + η2 where η1 ∼ γ1 ∗ U (−0.3, 0.3) and η2 ∼ γ2 ∗
U (−0.15, 0.15). γ is allowed to take on the following values: γ1 = {1, 2, 3} and γ2 = {0, 1, 2, 3}.

       In all cases, we keep the total number of observations fixed at n = 5, 000 with observations
per market given by nj . The number of Monte Carlo repetitions per experiment is 1, 000. We
set the structural parameters to the following “true” values: α1 =3, α2 = − 0.3, and σ=0.5.

       The results in Table (1) show that there is very little bias in the finite samples, even
in the case of only two markets with limited information coming from each market. The
standard deviations of the estimated parameters are small relative to the parameters and,
more importantly, the efficiency of the estimator is increasing in both market size and level
of gradient heterogeneity.

       For comparison, we run the same set of Monte Carlo experiments using the traditional
two-step Rosen framework. Results are presented in Table (2). As expected, the estimator
performs poorly, particularly when it comes to recovering the slope of the MWTP function,
α2 . In all cases (even with 50 markets and maximum gradient heterogeneity across markets),
both the MWTP intercept (α1 ) and the standard deviation of the preference shock (σ) are
significantly biased downwards. In addition, the MWTP slope is always biased upwards (as
expected); in all but two of the experiments, the mean value of the slope takes on a positive

                                                   17
                       Table 1: Bishop-Timmins Results (common α1 )

                   (“true” parameter values: α1 = 3, α2 = −0.3, σ = 0.5)
                           mean(α1 ) mean(α2 )       mean(σ) std(α1 )     std(α2 )   std(σ)
     j = 2, γ1 = 1, γ2 = 0  3.0035    -0.3036         0.5015 0.0709       0.0706     0.0357
     j = 2, γ1 = 2, γ2 = 0  3.0004    -0.3006         0.5000 0.0354       0.0347     0.0182
     j = 2, γ1 = 3, γ2 = 0  3.0000    -0.3001         0.4998 0.0241       0.0231     0.0127
     j = 2, γ1 = γ2 = 1     3.0015    -0.3016         0.5005 0.0460       0.0452     0.0233
     j = 2, γ1 = γ2 = 2     3.0002    -0.3003         0.4999 0.0240       0.0222     0.0124
     j = 2, γ1 = γ2 = 3     3.0000    -0.3001         0.4997 0.0171       0.0146     0.0091
     j = 5, γ1 = γ2 = 1     3.0002    -0.3003         0.4999 0.0342       0.0331     0.0175
     j = 5, γ1 = γ2 = 2     2.9998    -0.2999         0.4997 0.0182       0.0159     0.0097
     j = 5, γ1 = γ2 = 3     2.9998    -0.2999         0.4997 0.0133       0.0100     0.0074
     j = 10, γ1 = γ2 = 1    3.0002    -0.3003         0.4998 0.0309       0.0296     0.0158
     j = 10, γ1 = γ2 = 2    2.9998    -0.2999         0.4997 0.0166       0.0141     0.0089
     j = 10, γ1 = γ2 = 3    2.9998    -0.2999         0.4997 0.0123       0.0087     0.0069
     j = 50, γ1 = γ2 = 1    3.0000    -0.3001         0.4998 0.0285       0.0271     0.0147
     j = 50, γ1 = γ2 = 2    2.9998    -0.2999         0.4996 0.0155       0.0128     0.0084
     j = 50, γ1 = γ2 = 3    2.9998    -0.2999         0.4996 0.0117       0.0078     0.0066



value (implying an upward sloping demand curve).

     Finally, we return to our estimator and run a set of experiments where the MWTP
intercept, α1 , is allowed to vary across markets. We specify that α1,j ∼ U (2, 4), while keeping
α2 = −0.3 and σ = 0.5. Note that in this specification, we require heterogeneity in the
the slope of the gradients across markets and do not estimate the cases where γ2 = 0. Our
estimator performs well in each case, including the case with only two markets and minimum
gradient heterogeneity. The results from these experiments are presented in Table (3).




                                               18
                       Table 2: Rosen Results (common α1 )

              (“true” parameter values: α1 = 3, α2 = −0.3, σ = 0.5)
                      mean(α1 ) mean(α2 )     mean(σ) std(α1 )     std(α2 )   std(σ)
j = 2, γ1 = 1, γ2 = 0  2.0385    0.6615        0.0980 0.0026       0.0026     0.0003
j = 2, γ1 = 2, γ2 = 0  2.1381    0.5619        0.1857 0.0044       0.0042     0.0009
j = 2, γ1 = 3, γ2 = 0  2.2649    0.4350        0.2572 0.0053       0.0049     0.0017
j = 2, γ1 = γ2 = 1     2.0802    0.6129        0.1455 0.0035       0.0036     0.0007
j = 2, γ1 = γ2 = 2     2.2557    0.4224        0.2598 0.0055       0.0049     0.0019
j = 2, γ1 = γ2 = 3     2.4299    0.2332        0.3369 0.0068       0.0050     0.0029
j = 5, γ1 = γ2 = 1     2.1492    0.5381        0.1984 0.0048       0.0047     0.0012
j = 5, γ1 = γ2 = 2     2.4131    0.2525        0.3299 0.0068       0.0052     0.0028
j = 5, γ1 = γ2 = 3     2.6150    0.0358        0.4022 0.0079       0.0047     0.0038
j = 10, γ1 = γ2 = 1    2.1774    0.5076        0.2163 0.0050       0.0049     0.0014
j = 10, γ1 = γ2 = 2    2.4654    0.1963        0.3501 0.0071       0.0051     0.0031
j = 10, γ1 = γ2 = 3    2.6669    -0.0187       0.4185 0.0081       0.0045     0.0040
j = 50, γ1 = γ2 = 1    2.2022    0.4807        0.2309 0.0053       0.0050     0.0015
j = 50, γ1 = γ2 = 2    2.5067    0.1519        0.3652 0.0073       0.0050     0.0033
j = 50, γ1 = γ2 = 3    2.7046    -0.0582       0.4299 0.0082       0.0043     0.0042



              Table 3: Bishop-Timmins Results (market-specific α1,j )

                  (“true” parameter values: α2 = −0.3, σ = 0.5)
                                  mean(α2 ) mean(σ)    std(α2 )   std(σ)
          j   = 2, γ1 = γ2 = 1     -0.3531   0.5263    0.2406     0.1209
          j   = 2, γ1 = γ2 = 2     -0.3139   0.5066    0.1028     0.0524
          j   = 2, γ1 = γ2 = 3     -0.3068   0.5031    0.0662     0.0345
          j   = 5, γ1 = γ2 = 1     -0.3277   0.5134    0.1535     0.0775
          j   = 5, γ1 = γ2 = 2     -0.3084   0.5037    0.0693     0.0359
          j   = 5, γ1 = γ2 = 3     -0.3045   0.5018    0.0431     0.0233
          j   = 10, γ1 = γ2 = 1    -0.3221   0.5103    0.1335     0.0675
          j   = 10, γ1 = γ2 = 2    -0.3068   0.5027    0.0606     0.0316
          j   = 10, γ1 = γ2 = 3    -0.3036   0.5012    0.0370     0.0204
          j   = 50, γ1 = γ2 = 1    -0.3193   0.5069    0.1220     0.0616
          j   = 50, γ1 = γ2 = 2    -0.3061   0.5003    0.0554     0.0290
          j   = 50, γ1 = γ2 = 3    -0.3033   0.4990    0.0333     0.0186




                                        19
4     Data

We apply our estimator to valuing the willingness to pay to avoid violent crime in the San
Francisco Metropolitan Area over the period 1994 to 2000. Further details and results of this
application are discussed in Sections 5 and 6.

      In the first stage of our estimation, we recover the parameters of the hedonic price
function for each year of our sample. In the second stage of our estimation, we recover the
structural parameters of the linear MWTP function, allowing MWTP to vary with demo-
graphic characteristics. Finally, to demonstrate the policy implications of various hedonic
estimators, we consider the non-marginal policy analysis of the observed changes in crime for
the one year period of 1999 to 2000.

      To estimate these specifications, we employ a varied set of data from multiple sources.
These data and our sample cuts are discussed below.



4.1     Property Transactions Data

The real estate transactions data that we employ covers six counties of the San Francisco
Bay Area (Alameda, Contra Costa, Marin, San Francisco, San Mateo, and Santa Clara) over
the period 1994 to 2000. This dataset (used under a licensing agreement with DataQuick,
Inc.) includes dates, prices, loan amounts, and buyers’, sellers’, and lenders’ names for all
transactions. In addition, for the final observed transaction of each single-family property,
the dataset includes housing characteristics such as exact street address, square footage, year
built, lot size, number of bedrooms, and number of bathrooms.

      Additional data cuts are made in order to deal with the fact that DataQuick only reports
housing characteristics at the time of the final observed transaction, but we need to use housing


                                               20
characteristics from all transactions as controls in our hedonic price regressions.14 First, to
control for land sales or total re-builds, we drop all transactions where “year built” is missing
or later than the observed transaction date. Second, to control for major improvements or
degradations, we drop any property with an observed average appreciation or depreciation
rate exceeding the county- and year- specific mean price change by more than 50 percentage
points (in either direction). Additionally, we drop any property that moves more than 40
percentile points (in either direction) between transactions in the overall county- and year-
specific distribution of price. We drop transactions where the price is missing or zero and,
after using the consumer price index to convert all transaction prices into 2000 dollars, we
drop one percent of observations from each tail of the price distribution to minimize the effect
of outliers. As we merge the pollution data using the property’s geographic coordinates, we
drop properties where latitude and longitude are missing. Finally, we drop houses with more
than three observed transactions over the 7 year sample and drop multiple sales within a
given year.15

       This yields a final sample of 403,036 transactions. Table (4) reports the summary statis-
tics for the property transactions data.



4.2      Household Demographic Data

For our demographic characteristics, we use information on the race and income of buyers
recorded on mortgage applications and published in accordance with the Home Mortgage
Disclosure Act (HMDA) of 1975. The HMDA data also describe the mortgage lender’s name,
the loan amount, the year, and the property’s census tract. As the variables of lender name,
  14
    Approximately fifty-five percent of observed sales are the only observed sale for the property.
  15
    To maintain a fairly homogenous sample (i.e., properties that would be competing in the same housing
market), we make the additional sample cuts. We drop houses where “year built” is less than 1850, “lot
size” is greater than 3 acres, “square footage” is zero or greater than 10,000 square feet, total “number of
bathrooms” is greater than 10, total “number of bedrooms” is greater than 10, total “number of rooms” is
missing or greater than 15, and “number of stories” is missing or greater than 3.

                                                    21
                        Table 4: Property Transactions Summary Statistics

                Variable                                              Mean     Std. Dev.
                Price (constant 2000 dollars)                       345,823.00 192,210.00
                Year Built                                            1966.64          23.16
                Lot Size (sq. ft)                                    6,453.55        7,927.96
                Square Footage                                        1662.76         671.69
                Number Bathrooms                                        2.07           0.73
                Number Bedrooms                                         3.01           1.09
                Property Crimes (per 100,000 residents)              1,803.43         771.48
                Violent Crimes (per 100,000 residents)                445.69          241.19



loan amount, year, and census tract are also available in the DataQuick data, we are able to
merge the buyer characteristics data with the property transactions data using the algorithm
described in Bayer et. al. (2011).16 We drop all households where either race or income is
missing.

       Table (5) reports the summary statistics for the sample of buyers in both the full sample
and in the restricted, 1999-only sample. This restricted sample will be used in the policy
analysis that demonstrates the implications of valuing non-marginal changes in violent crime
rates.



4.3      Violent Crime Data

The violent crime rate that we employ comes from the RAND California database and is
defined as the number of incidents per 100,000 residents.17 Violent crime is reported for each
  16
     Using this algorithm, we are able to uniquely match approximately eighty percent of all housing trans-
actions to buyers in the HMDA dataset. The characteristics of the final sample of buyers and houses is
remarkably close to those found in IPUMS samples. See Bayer et. al. (2011) for examples and further
discussion.
  17
     In the data, violent crime is defined as “crimes against people, including homicide, forcible rape, robbery,
and aggravated assault.”


                                                       22
                Table 5: Buyer Summary Statistics (Full- and 1999- Samples)

                                     Full Sample                   1999 Sample
                                    (n = 262, 498)                 (n = 49, 438)
              Variable             Mean     Std. Dev.            Mean      Std. Dev.
              Price             354,002.90 193,464.20 372,028.60             200,698.10
              Violent Crime        445.46        242.24         369.06         171.67
              Income            111,312.90 111,607.30 111,338.40              87,321.00
              White                 0.63           0.48          0.61            0.49
              Asian                 0.24           0.42          0.25            0.43
              Black                 0.04           0.19          0.03            0.18
              Hispanic              0.10           0.30          0.11            0.31
              Prices and incomes are expressed in constant 2000 dollars. The violent crime
              rate is per 100,000 residents.



of the 80 cities in the San Francisco Metropolitan Area for each year of our data. Figure (1)
illustrates the locations of these cities.

    Figure 1: Locations of Crime-reporting Cities within the San Francisco Metro Area




     For our analysis, we impute a violent crime rate for each individual house using an

                                                  23
inverse distance-squared weighted average of the crime rate in each city.18 As a control in our
hedonic regressions, we also create an analogous measure of property crime rates from the
RAND California database.19,20 Table (4) provides summary statistics for both violent crime
and property crime at the level of the house. Table (5) provides summary statistics for our
variable of interest, violent crime, at the level of the buyer.

       We see a significant amount of variation (both cross-sectional and time-series) in our key
variable of interest, violent crime. Figures (2) and (3) illustrate the distribution of violent
crime rates and the time-trend of mean violent crime rates, respectively. The declining trend
observed in the San Francisco Metropolitan Area is consistent with the decreases in violent
crime observed in most of the US over the same period.

        Figure 2: Distribution of Violent Crime Rates (Incidents per 100,000 Residents)




  18
     Distance is computed using the Great Circle estimator, geographic coordinates of city centroids, and
geographic coordinates of each house.
  19
     Property crime is defined as “crimes against property, including burglary and motor vehicle theft.”
  20
     We use the property crime rate as a control in our hedonic estimation and focus attention on violent
crimes in our valuation exercise, as violent crimes are less likely to be subject to systematic under-reporting
(Gibbons (2004)).


                                                      24
       Figure 3: Time Variation in Violent Crime Rates (Incidents per 100,000 Residents)




5       Results


5.1      Hedonic Price Function

In this subsection, we discuss the results from the estimation of a log-linear hedonic price
function. Separately for each year, 1994 to 2000, we regress the log of sales price on housing
attributes and tract-level fixed effects. Regression results are reported in Table (6), with each
row representing a separate annual regression. In the vast majority of cases, hedonic price
estimates have the expected sign and magnitude.21

       For discussion purposes, we calculate the implicit price of each attribute at the mean
housing price of $345, 823, given in 2000 dollars, and annualize these implicit prices by multi-
  21
    An exception is the sign on property crime, which exhibits a counterintuitive positive sign in 1994 and
1996. This is not surprising as property crime is usually considered to be under-reported (unlike violent crime,
which we focus on in our analysis). If underreporting is more severe in low-price neighborhoods, this could
the coefficient to be biased upwards.


                                                      25
                             Table 6: Hedonic Price Function Estimates


      Year Built     Lot Size   Sq. Footage Bathrooms Bedrooms Prop. Crime Violent Crime
1994 8.26E-04*** 6.47061E-06*** 3.45E-04*** 6.00E-03** 0.0348*** -4.77E-05*** -2.65E-04***
      (9.36E-05) (2.57963E-07) (3.24E-06) (2.77E-03) (1.69E-03) (5.81E-06)     (2.40E-05)
1995 8.19E-04*** 6.63532E-06*** 3.49E-04*** 9.51E-03*** 0.0370*** -1.04E-05                    -5.04E-04***
      (1.09E-04) (2.95071E-07) (4.76E-06) (3.53E-03) (1.93E-03) (6.92E-06)                      (3.30E-05)
1996 7.41E-04*** 6.53443E-06*** 3.58E-04*** 0.0136*** 0.0432*** -1.64E-05**                    -4.64E-04***
      (8.85E-05) (3.3423E-07) (4.29E-06) (3.24E-03) (1.69E-03) (7.50E-06)                       (3.05E-05)
1997 4.40E-04*** 7.12735E-06*** 3.57E-04*** 0.0186*** 0.0430*** 8.05E-07                       -6.04E-04***
      (7.61E-05) (2.64862E-07) (4.62E-06) (3.03E-03) (1.67E-03) (8.48E-06)                      (2.95E-05)
1998 2.34E-04*** 7.05921E-06*** 3.56E-04*** 0.0251*** 0.0430*** 1.13E-04***                    -9.73E-04***
      (8.55E-05) (3.33583E-07) (6.01E-06) (3.59E-03) (2.03E-03) (9.16E-06)                      (3.98E-05)
1999 9.28E-05 7.38838E-06*** 3.55E-04*** 0.0211*** 0.0451*** 6.18E-05***                       -1.01E-03***
     (7.99E-05) (2.52938E-07) (3.30E-06) (2.51E-03) (1.37E-03) (9.68E-06)                       (3.35E-05)
2000 3.86E-04*** 8.016E-06*** 3.35E-04*** 0.0246*** 0.0431*** 1.32E-04***                      -1.22E-03***
      (8.55E-05) (3.6165E-07) (4.24E-06) (2.97E-03) (1.71E-03) (1.03E-05)                       (4.74E-05)
Dependent variable is the log of sales price. Data are mean-differenced to remove 830 tract-level fixed effects.
Significance is indicated by: ***(0.01), **(0.05), and *(0.10).



plying them by 0.05.22 The implicit price of an additional square foot of lot size is, on average,
11 cents per year in 1994. The implicit price of an additional square foot of living space is
$5.97 per year in 1994. These prices vary somewhat, but are relatively stable over time. Also
in 1994, an additional bathroom costs $103.75 per year, while an additional bedroom costs
$602.37 per year. The implicit prices of bedrooms and bathrooms vary somewhat over time,
while the effect of year built varies a great deal over time (both in magnitude and sign).

     Our amenity of interest, violent crime, exhibits an intuitive negative effect on housing
prices that is statistically significant. Over the period of our sample, we see this effect in-
creasing over time. In 1994, the implicit price of additional unit of violent crime is −$4.59,
while in 2000 it is −$21.07. Table (7) reports the year-to-year variation in the implicit price
  22
     These measures of implicit price are those that often used as simple, marginal measures of willingness to
pay in the existing literature.



                                                      26
of violent crime.

                      Table 7: Variation in the Implicit Price of Violent Crime

                                         Year       Implicit Price
                                         1994           -4.59
                                         1995           -8.71
                                         1996           -8.02
                                         1997          -10.44
                                         1998          -16.82
                                         1999          -17.48
                                         2000          -21.07




5.2       MWTP Function

In this subsection, we report the results from our procedure for recovering estimates of the
MWTP function using the first-stage hedonic price function estimates and data on individual
home buyers. With the log-linear specification for the hedonic price function, a closed-form
solution for Zi,j cannot be recovered and we employ a change of variables from Z to ν d . We
specify a linear MWTP function and allow the intercept of the MWTP function to vary by
year by including a set of year dummies in our estimation:


                                                                      0
(29)                          P 0 (V Ci,t ; β) = α1,t + α2 V Ci,t + Xid α3 + νi,t
                                                                              d




where:


                                                 d
(30)                                            νi,t ∼ N (0, σ 2 )


and Xid is a vector comprised of income (in thousands of 2000 dollars) and a vector of race
dummies (Asian-Pacific Islander, black, Hispanic, and white).23
 23
      White is the excluded race.

                                                       27
     The first column of Table (8) reports the results from our estimator. First, consider the
coefficient on violent crime, α2 , which reveals the amount by which the individual’s MWTP
to avoid violent crime changes with an increase in this disamenity. Intuitively, this coefficient
should be negative, indicating that the MWTP to avoid violent crime increases as the rate of
violent crime increases (consistent with a demand curve for public safety that is downward
sloping). We find this to be the case with our model; each additional incident per 100,000
residents raises MWTP to avoid violent crime by 10 cents. As we show in Section 6, this has
important implications for the value ascribed to large reductions in violent crime rates like
those witnessed over the period of our sample.

     Looking at the the remaining coefficient estimates derived using our model, an increase
in income of $1,000 per year increases MWTP to avoid violent crime by 5.8 cents (consistent
with public safety being a normal good). Considering differences in MWTP by race, the
excluded group (Whites) has the highest mean MWTP to avoid violent crime. Our model
suggests that Asian-Pacific Islanders have a slightly lower mean MWTP (as indicated by their
positive intercept shift of $2.84). Blacks have the lowest mean MWTP to avoid violent crime,
followed by Hispanics.

     For the sake of comparison, the second column of Table (8) reports the results from the
traditional Rosen estimation approach. These results are strikingly different from the results
presented in the first column. In contrast to our estimator, estimates from the Rosen model
suggest that increases in violent crime reduce the MWTP to avoid violent crime (indicating
that the demand curve for public safety is upward sloping). This is exactly the direction of
bias suggested by both Bartik and Epple and leads to upwardly biased estimates of the welfare
associated with non-marginal reductions in violent crime (which we show in Section 6). Ad-
ditionally, while the coefficient on income is of the same sign, the magnitude is much smaller.
Finally, race does not appear to play an economically significant role in the estimates derived
using the Rosen estimation approach (although the coefficients are statistically significant).

                                               28
                             Table 8: MWTP Function Estimates

                                            Bishop-Timmins              Rosen
                     Violent Crime               -0.1008              3.51E-03
                                               (3.66E-03)            (1.05E-04)
                     Income (/1000)              -0.0581               -0.0252
                                               (4.88E-03)            (2.75E-03)
                     Asian                        2.8352               0.0949
                                                (0.1868)              (0.0337)
                     Black                       25.0498               1.9942
                                                (0.9251)              (0.0684)
                     Hispanic                    13.9813               1.1989
                                                (0.5706)              (0.0748)
                     Constant                    54.1218               -3.3790
                                                (1.6280)              (0.3542)
                     1995 dummy                  -6.2501               -2.2899
                                                  0.5187               0.4489
                     1996 dummy                 -11.8685               -1.5536
                                                  0.5090               0.4167
                     1997 dummy                 -12.8032               -3.1074
                                                  0.5172               0.3957
                     1998 dummy                 -18.4337               -7.2178
                                                  0.6021               0.4639
                     1999 dummy                 -27.1906               -7.5220
                                                  0.7219               0.4835
                     2000 dummy                 -29.8092              -10.7238
                                                  0.8100               0.6091
                     σν                          23.8670                  –
                                                  0.8092                  –
                   All coefficients are significant at the 1% level of significance.


6    Measuring the Welfare Implications of a Non-Marginal

     Change in Violent Crime Rates

As is clear from our data description, the San Francisco Metropolitan Area experienced a
large and persistent reduction in average violent crime rates over the course of our sample


                                                   29
period. Similar reductions have been observed in numerous other cities across the US. Out of
the 25 cities that he considers, Levitt (2004) ranks San Francisco 12th in terms of the size of
the reduction in homicides experienced between 1991 - 2001. This change in the violent crime
rate represents a significant improvement on average and is, importantly, non-marginal.24

       There is a large and growing literature aimed at valuing the benefits of crime reductions
(with, for example, the goal of conducting cost-benefit analysis of police force expansions).
This literature was recently surveyed by Heaton (2010). He notes that the property value
hedonic technique is valuable for recovering the intangible costs of crime (e.g., lost quality
of life for fear of victimization or effective loss of public space). Such intangibles are likely
to be particularly important for measuring the costs of violent crime (a point emphasized by
Linden and Rockoff (2008) with respect to sexual offenses).

       For this welfare analysis, we consider the set of all individuals who purchased a house in
1999 (summary statistics describing these individuals is given in Table (5)). We then measure
the value of the crime changes that these individuals actually experienced between 1999 and
2000. It is highly likely that these individuals still occupy the same residence in 2000 and, as
we show in this section, the changes that occurred over this year were substantial enough that
proper identification of the MWTP function becomes important in measuring their change in
welfare. In particular, Figure (4) illustrates the distribution of changes in violent crime rates
experienced by this set of households. The 1999 data allows us to consider the welfare changes
associated with both reductions and increases in crime; approximately sixty percent of these
households experienced reductions in violent crime during this period while the remaining
forty percent experienced increases in violent crime.
  24
    Levitt (2004) discusses six factors that he argues were not responsible for these declines, including economic
growth and reduced unemployment, shifting age and racial demographics, changes in policing strategies,
changes in gun control laws and laws controlling concealed weapons, and changes in capital punishment. He
argues instead that there is a strong case to be made for the role of increasing size of the police force, increased
incarceration rats, declines in the crack epidemic, and the legalization of abortion twenty years prior. The
relative importance of each of these factors is still a contentious topic. See, for example, Blumstein and
Wallman (2006).


                                                        30
      Figure 4: Distribution of One-Year Violent Crime Rate Changes for 1999 Buyers




     For the purposes of illustration, we report valuations based on three different estimation
strategies: (i) Bishop-Timmins, (ii) Rosen, and (iii) horizontal MWTP. The third approach
assigns a constant willingness to pay to each individual equal to the slope of the hedonic price
function at their observed housing choice. As the utility function is assumed to be linear
in Z (i.e., the MWTP function is constant in Z), this approach corresponds to either the
“inversion” procedure outlined in Bajari and Benkard (2005) or to the Rosen (1974) model
where the endogeneity problem is trivially solved by assuming that the MWTP function
doesn’t depend on Z. In this case, the welfare effects may be calculated as the area of the
rectangle under the horizontal MWTP, with the width given by the experienced change in
violent crime. For the first two strategies, the value associated with a change in the violent

                                              31
crime rate is calculated as the area of the trapezoid under the MWTP function over the width
of the experienced change in violent crime.

       We report results separately for the sixty percent of buyers who experienced a reduction
in their violent crime rate and for the remaining forty percent of buyers who experienced an
increase in Table (9).25 Note that the large standard deviations of WTP illustrate skewness
of the distributions, versus individuals experiencing counterintuitive (positive) signs on their
WTP.

                    Table 9: WTP for Non-Marginal Changes in Violent Crime

                                        Buyers with Reductions          Buyers with Increases
                                             (n = 29, 953)                  (n = 19, 485)
                                        Average    Std. Dev.            Average Std. Dev.
                                         WTP          WTP                WTP         WTP

              Bishop-Timmins             269.57          328.26         -980.69        1896.06
              Rosen                      401.15          543.86         -581.88        679.76
              Horizontal MWTP            395.83          532.83         -595.31        710.78



       The bias from improperly accounting for the effect of a non-marginal change in violent
crime on MWTP is evident. Consider first the case of crime reductions. The Rosen model and
horizontal MWTP yield estimates of the average WTP for observed reductions that are 1.49
times greater than our model, implying an almost fifty-percent upward bias. The direction
of the bias is reversed when we consider increases in the rates of violent crime. Here, the
alternative models yield estimates of average WTP for observed crime reductions that are
only 0.59 of our estimate. These differences are far from trivial and would have an important
impacts on any cost-benefit analysis.
  25
    In the calculations for buyers experiencing a decrease in violent crime, we restrict the marginal willingness
to pay curve to be non-positive. This has little effect on the welfare implications; our average willingness to
pay without this restriction is 243.68.




                                                       32
7        Conclusion

Researchers regularly ascribe downward sloping demand curves to households for goods rang-
ing from breakfast cereals to BMWs. In fact, recovering the price elasticity of demand for such
goods constitutes one of the main activities undertaken by applied microeconomists. How-
ever, because of the difficult endogeneity problems associated with the recovery of the MWTP
function using the hedonic technique, the same flexibility has generally not been applied to
household demand for local public goods and amenities. Instead, applications of the hedo-
nic method have tended to focus only on the first-stage hedonic price regression; recovering
parameters that only yield valid welfare estimates for marginal policies. In order to prop-
erly evaluate the welfare effects associated with larger policies, the researcher must recover
the structural parameters of the MWTP function. In this paper, we propose an estimation
approach for the recovery of these parameters, while avoiding the endogeneity problems so
commonly associated with the hedonic model.

     We show that there is no fundamental endogeneity problem in the hedonic model; the
endogeneity problems are largely manufactured and are a result of framing Rosen’s second
stage regression in terms of marginal cost (implicit attribute price) equaling marginal benefit
(marginal utility from consuming the amenity in question). We instead rearrange the informa-
tion provided by the hedonic equilibrium and arrive at a simple modeling environment with
a single endogenous outcome variable, a vector of exogenous variables, and an econometric
error.

     Estimation of the model is straightforward and consists of a standard Maximum Like-
lihood procedure which employs a textbook change-of-variables technique. In a restricted
version of the model, a closed-form solution for the amenity of interest may be found analyt-
ically and the change of variables is not required. Estimation in the simplest version of the
model may even be reduced to an indirect least squares procedure, exploiting the one-to-one

                                              33
mapping between the structural and reduced-form parameters. Like the Rosen model, our
approach is (i) quite intuitive, as it is derived from the first-order condition for utility max-
imization, (ii) able to incorporate rich individual- and market- level heterogeneity, and (iii)
computationally light and easy to implement. Additionally, our model requires no more in
terms of data than the standard hedonic model.

     Using a series of Monte Carlo experiments, we demonstrate that our proposed estimator
presents very little bias in finite samples. Applying our model to data on violent crime
rates in California’s Bay Area, we find that properly accounting for the shape of the MWTP
function has important implications for measuring the welfare effects of non-marginal changes
in violent crime. Considering the welfare effects associated with the observed one-year change
in crime for those households that purchased a house in 1999, we find that alternative modeling
procedures overstate benefits (for those households which experienced a decrease in violent
crime) by fifty percent relative to our approach and understate costs (for those households
which experienced an increase in violent crime) by forty percent relative to our approach.
These differences are both statistically and economically significant and consequential for
cost-benefit analyses of policies that may have large impacts on future crime rates.




                                               34
References
Bajari, P., and C.L. Benkard. 2005. “Demand Estimation with Heterogeneous Consumers

  and Unobserved Product Characteristics: A Hedonic Approach.” Journal of Political Economy,

  113(6): 1239–1276.

Bajari, P., J. Cooley, K. Kim, and C. Timmins. 2010. “A Theory-Based Approach to Hedonic

  Price Regressions with Time-Varying Unobserved Product Attributes: The Price of Pollution.”

  American Economic Review, forthcoming.

Bartik, T.J. 1987. “The Estimation of Demand Parameters in Hedonic Price Models.” The Journal

  of Political Economy, 95(1): 81–88.

Bayer, P., R. McMillan, A. Murphy, and C. Timmins. 2010. “A Dynamic Model of Demand

  for Houses and Neighborhoods.” Working Paper, Duke University.

Bishop, K.C., and A.D. Murphy. 2011. “Estimating the Willingness to Pay to Avoid Violent

  Crime: A Dynamic Approach.” American Economic Review, 101(3): 625–629.

Black, S.E. 1999. “Do Better Schools Matter? Parental Valuation of Elementary Education.”

  Quarterly Journal of Economics, 114(2): 577–599.

Blumstein, A., and J. Wallman. 2006. “The Crime Drop and Beyond.” Annual Review of Law

  and Social Science, 2: 125–146.

Bui, L.T.M., and C.J. Mayer. 2003. “Regulation and Capitalization of Environmental Ameni-

  ties: Evidence From the Toxic Release Inventory in Massachusetts.” Review of Economics and

  Statistics, 85(3): 693–708.

Chay, K.Y., and M. Greenstone. 2005. “Does Air Quality Matter? Evidence from the Housing

  Market.” Journal of Political Economy, 113(2).

Court, A. T. 1939. “Hedonic Price Indexes with Automotive Examples.” In The Dynamics of

  Automobile Demand. New York: General Motors.

                                              35
Davis, L.W. 2004. “The Effect of Health Risk on Housing Values: Evidence from a Cancer Cluster.”

  The American Economic Review, 94(5): 1693–1704.

Ekeland, I., J.J. Heckman, and L. Nesheim. 2004. “Identification and Estimation of Hedonic

  Models.” Journal of Political Economy, 112(1): S60–S109.

Ellickson, B. 1971. “Jurisdictional Fragmentation and Residential Choice.” The American Eco-

  nomic Review, 61(2): 334–339.

Epple, D., and G.J. Platt. 1998. “Equilibrium and Local Redistribution in an Urban Econ-

  omy When Households Differ in Both Preferences and Incomes.” Journal of Urban Economics,

  43(1): 23–51.

Epple, D., and R.E. Romano. 1998. “Competition Between Private and Public Schools, Vouchers,

  and Peer-Group Effects.” The American Economic Review, 88(1): 33–62.

Epple, D. 1987. “Hedonic Prices and Implicit Markets: Estimating Demand and Supply Functions

  for Differentiated Products.” The Journal of Political Economy, 95(1): 59–80.

Epple, D., and H. Sieg. 1999. “Estimating Equilibrium Models of Local Jurisdictions.” Journal

  of Political Economy, 107: 645–681.

Epple, D., R. Filimon, and T. Romer. 1984. “Equilibrium Among Local Jurisdictions: Towards

  an Integrated Approach of Voting and Residential Choice.” Journal of Public Economics, 24: 281–

  304.

Figlio, D.N., and M.E. Lucas. 2004. “Whats in a Grade? School Report Cards and the Housing

  Market.” The American Economic Review, 94(3): 591–604.

Gamper-Rabindran, S., R. Mastromonaco, and C. Timmins. 2011. “Valuing the Benefits

  of Superfund Site Remediation: Three Approaches to Measuring Localized Externalities.” NBER

  Working Paper No. 16655.




                                               36
Gayer, T., J.T. Hamilton, and W.K. Viscusi. 2000. “Private Values of Risk Tradeoffs at

  Superfund Sites: Housing Market Evidence on Learning About Risk.” Review of Economics and

  Statistics, 82(3): 439–451.

Gibbons, S. 2004. “The Costs of Urban Property Crime.” The Economic Journal, 114(499): F441–

  F463.

Greenstone, M., and J. Gallagher. 2008. “Does Hazardous Waste Matter? Evidence from the

  Housing Market and the Superfund Program.” The Quarterly Journal of Economics, 123(3): 951–

  1003.

Griliches, Z. 1961. “Hedonic Price Indexes for Automobiles: An Econometric of Quality Change.”

  NBER Chapters - The Price Statistics of the Federal Government: Review, Appraisal, and Rec-

  ommendations, 173–196.

Heaton, P. 2010. “Hidden in Plain Sight: What the Cost of Crime Research Can Tell Us About

  Investing in Police.” RAND Center on Quality, Occasional Policing Paper.

Heckman, J.J., R.L. Matzkin, and L. Nesheim 2010. “Nonparametric Identification and Es-

  timation of Nonadditive Hedonic Models.” Econometrica, 78(5):1569–1591.

Kahn, S., and K. Lang 1988. “Efficient Estimation of Structural Hedonic Systems.” International

  Economic Review, 157–166.

Lancaster, K.J. 1966. “A New Approach to Consumer Theory.” The Journal of Political Economy,

  74(2): 132–157.

Levitt, S.D. 2004. “Understanding Why Crime Fell in the 1990s: Four Factors that Explain the

  Decline and Six that Do Not.” The Journal of Economic Perspectives, 18(1): 163–190.

Linden, L., and J.E. Rockoff. 2008. “Estimates of the Impact of Crime Risk on Property Values

  from Megan’s Laws.” The American Economic Review, 98(3): 1103–1127.




                                              37
Palmquist, R. B. 2005. “Property Value Models.” In The Handbook of Environmental Economics.

  Vol. 2, , ed. K. Goran-Maler and J. R. Vincent. Elsevier.

Parmenter, C.F., and J.C. Pope. 2009. “Quasi-Experiments and Hedonic Property Value Meth-

  ods.” In Handbook on Experimental Economics and the Environment. , ed. J. A. List and M. K.

  Price. Edward Elgar Publishers.

Pope, J.C. 2008. “Buyer Information and the Hedonic: The Impact of a Seller Disclosure on the

  Implicit Price for Airport Noise.” Journal of Urban Economics, 63(2): 498–516.

Rosen, S. 1974. “Hedonic Prices and Implicit Markets: Product Differentiation in Pure Competi-

  tion.” Journal of Political Economy, 82(1): 34.

Sieg, H., V.K. Smith, H.S. Banzhaf, and R. Walsh. 2004. “Estimating the General Equilib-

  rium Benefits of Large Changes in Spatially Delineated Public Goods.” International Economic

  Review, 45: 1047–1077.

Taylor, L.O. 2003. “The Hedonic Method.” In A Primer on Nonmarket Valuation of the Environ-

  ment. , ed. T. Brown P. Champ and K. Boyle. Dordrecht: Kluwer Academic Publishers.




                                                38
