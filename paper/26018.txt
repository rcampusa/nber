                             NBER WORKING PAPER SERIES




         GVCS AND TRADE ELASTICITIES WITH MULTISTAGE PRODUCTION

                                      Robert C. Johnson
                                      Andreas Moxnes

                                     Working Paper 26018
                             http://www.nber.org/papers/w26018


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    June 2019




We thank Lorenzo Caliendo, Thibault Fally, Kjetil Storesletten, and Kei-Mu Yi for helpful
comments, as well as seminar participants at Dartmouth College, the Einaudi Institute for
Economics and Finance, Purdue University, the University of Colorado, the University of
Michigan, the University of Oslo, the World Bank, the 2012 Philadelphia Federal Reserve Trade
Workshop, the 2013 ASSA/AEA Meetings, the 2013 NBER ITI Spring Meetings, the 2013
Rocky Mountain Empirical Trade Conference, the 2013 Barcelona GSE Summer Forum, and the
2014 ECARES/CAGE/CEPR Conference on Global Fragmentation and Trade Policy. This paper
previously circulated under the title: "Technology, Trade Costs, and the Pattern of Trade with
Multistage Production." The views expressed herein are those of the authors and do not
necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Robert C. Johnson and Andreas Moxnes. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
GVCs and Trade Elasticities with Multistage Production
Robert C. Johnson and Andreas Moxnes
NBER Working Paper No. 26018
June 2019
JEL No. F1

                                            ABSTRACT

We build a quantitative model of trade with multistage manufacturing value chains, which
features iceberg trade costs and technology differences across both goods and production stages.
We estimate technology and trade costs via the simulated method of moments, matching bilateral
shipments of final goods and inputs. Applying the model, we investigate how comparative
advantage and trade costs shape the structure of global value chains and trade flows. As the level
of trade costs falls, we show that the elasticity of bilateral trade to trade costs increases, due to the
endogenous reorganization of value chains (increased export platform production). Surprisingly,
however, the elasticity of world trade to trade costs is not magnified by multistage production.


Robert C. Johnson
University of Notre Dame
Department of Economics
3060 Jenkins Nanovic Hall
Notre Dame, IN 46556
and NBER
rjohns24@nd.edu

Andreas Moxnes
Department of Economics
University of Oslo
P.O box 1095 Blindern
0317 OSLO
NORWAY
and CEPR
andreamo@econ.uio.no
Global value chains (GVCs) are widely recognized as important conduits of international trade.
Nonetheless, the exact definition of "value chain" is often elusive. Appealing to plain language,
a chain is a sequence of connected elements. A value chain then is a sequence of connected
production stages, in which value is added stage-by-stage to produce final goods. In a global value
chain, these sequential production stages are sliced up and allocated across countries to minimize
production costs, giving rise to international trade in inputs and final goods.
    While this sequential, multistage description of global value chains is very general, the default
approach to incorporating GVCs into quantitative trade models is instead quite particular. Specif-
ically, the default is to assume that there is a roundabout input loop in the production process.1
The roundabout assumption requires that inputs and final goods are interchangeable ­ they are
produced with identical technologies, and output may be flexibly used either as an intermediate
input or consumed as a final good. Though tractable and useful for many purposes, models that
feature roundabout production fail to capture two basic forces that govern the structure of trade via
global value chains.
    First, countries differ in the cost at which they can perform individual production stages [Dixit
and Grossman (1982); Sanyal (1983); Yi (2003)].2 Some countries have comparative advantage
in downstream stages (e.g., manufacturing assembly in China), while others have comparative ad-
vantage in upstream stages (e.g., electronic components in Japan). Therefore, within-sector com-
parative advantage across stages influences production and trade patterns, in addition to traditional
comparative advantage across goods and sectors.
    Second, trade costs may be particularly burdensome when production takes the sequential,
multistage form. As inputs are shipped from country to country through the chain, trade costs
are paid multiple times. Further, ad valorem trade costs (proportional to the gross value of goods
shipped) are higher in absolute terms for the output of downstream stages, since the value of output
accumulates along the value chain. These trade costs have a big impact on decisions about where
to locate downstream production stages, because they are large relative to the cost savings from
locating downstream stages in low wage or high productivity locations. As emphasized by Yi
(2003, 2010), this aspect of multistage production may magnify the elasticity of trade flows to
frictions.
    In this paper, we build a quantitative model of trade with multistage production to study the
role of comparative advantage and trade costs in shaping global value chains, trade patterns,
and the elasticity of trade to frictions. The model features two sectors (manufacturing and non-

   1 See de Gortari (2019) for a comprehensive discussion of the relationship between roundabout and sequential

models, which emphasizes the role of specialized input suppliers in multistage-type models.
   2 Dixit and Grossman (1982) emphasize comparative advantage based on differences in factor endowments within

a multistage production process. As in Sanyal (1983) and Yi (2003), we focus on technological differences (Ricardian
comparative advantage).

                                                         2
manufacturing), with many goods in each sector. Production of each manufactured good requires
a discrete number of sequential stages, while non-manufactured goods are produced via a conven-
tional Ricardian production process. In both sectors, manufactured and non-manufactured goods
from home and abroad are also used as inputs in production, via a roundabout production loop.
Thus, the model features input linkages across both countries and sectors, with both sequential and
non-sequential value chains side by side.
     To study the quantitative properties of the model, we estimate technology parameters and bi-
lateral trade costs using a simulated method of moments procedure, matching bilateral trade flows
of final goods and inputs in the model and data.3 We then assess the response of value chains and
trade flows to changes in technology and trade costs via counterfactual experiments.
     One barrier to this estimation and counterfactual analysis is that multistage models are com-
putationally burdensome in high dimensional environments (e.g., with many countries). The basic
problem is that equilibrium outcomes are discontinuous in parameters, because the number of num-
ber of goods and/or production stages is discrete. This is a familiar problem in Ricardian models,
which is compounded in our multistage context.4
     To overcome this challenge, we apply a smoothing technique from the discrete choice litera-
ture, where similar issues arise in simulating choice probabilities [McFadden (1989)]. Specifically,
we solve for an approximate equilibrium in the model, in which discrete (binary) sourcing choices
are approximated by continuous (logit-type) functions of prices. With this technique, we are able
to solve the model using standard, gradient-based optimization procedures in a multi-country en-
vironment, which in turn facilitates simulated method of moments estimation of the parameters.
This new procedure allows a tighter mapping between theory and data than previous approaches
to quantifying multistage models (e.g., Yi (2010)), so it paves the way for use of the multistage
models in future applications.5
     Applying this procedure, we estimate technology and trade cost parameters for 37 industrial
and emerging market countries, plus a composite rest-of-the-world region, using data from John-
son and Noguera (2017). Our estimates show that there are substantial cross-country differences
in relative productivity (comparative advantage) across stages. For example, we find that Vietnam
has a strong comparative advantage in downstream production, whereas Chile has a comparative

     3 Remaining model parameters are calibrated to match various data targets, including final expenditure by sector

and country, value-added to output ratios by sector, total GDP by country, and so on.
     4 In a two-country Ricardian model, Dornbusch et al. (1977) solve this problem by assuming that there is a con-

tinuum of goods. Because the continuum assumption alone is not enough in multi-country models, Eaton and Kortum
(2002) develop a probabilistic approach to analyzing Ricardian models. Antràs and de Gortari (2016) adopt informa-
tion assumptions to apply the Eaton-Kortum idea in the multistage context, as we discuss further below.
     5 Yi (2010) calibrates a related multistage model for the US and two Canadian regions using a mixture of data (on

production, labor allocations, income, etc.) and parameter restrictions (e.g., equal productivity levels across stages).
Yi (2010) also measures trade costs from auxiliary data, while we estimate trade costs to match trade shares.

                                                           3
advantage in upstream production. These differences in comparative advantage induce special-
ization, such that the export composition of countries with downstream comparative advantage is
tilted toward final goods relative to inputs. We also find that estimated international trade costs are
large in our multistage model (on the order of 350%), comparable in magnitude to estimated trade
costs in standard gravity models.
     Turning to trade elasticities, we start by characterizing bilateral trade elasticities for manufac-
turing in the model. Though our multistage model does not admit an exact gravity representation of
trade flows, we interpret simulated data from our model through the lens of the gravity equation in
order to compute elasticities that are comparable to estimates in the literature. Unlike CES-gravity
models, our model generates endogenous, heterogeneous elasticities of bilateral trade to bilateral
trade costs, which vary across country pairs, for final goods versus inputs, and as the level of trade
costs change.6
     As the level of trade costs falls (holding relative bilateral trade costs constant), we show that
the average bilateral trade elasticity rises. This reflects a mixture of two forces. First, the elasticity
of both final goods and input trade to bilateral trade costs rises. Because bilateral trade costs are
a function of distance, this implies that trade flows become more geographically concentrated as
the level of trade costs falls. Second, the decline in trade costs induces changes in the composition
of trade, leading input trade to expand relative to final goods trade. Because input trade is more
sensitive to trade costs than trade in final goods (this result is an endogenous outcome in the model,
not a primitive assumption), the rise of input trade also raises the implied elasticity of trade to trade
costs overall.
     Both these bilateral elasticity results are fundamentally driven by the endogenous reorganiza-
tion of value chains in response to falling trade frictions. Specifically, as trade costs fall, export
platform production ­ in which inputs sold by country i to country j are re-exported (embedded in
finished goods) to third destinations ­ increases. Moreover, the choice of where to set up export
platforms is highly sensitive to trade costs: export platforms for value chains originating in country
i are disproportionately located in countries j for which iceberg trade costs are low. Thus, as the
importance of export platform production rises, the sensitivity of input trade to trade costs rises.
     To evaluate the response of global trade to trade costs, we examine the elasticity of world
trade to world GDP in the manufacturing sector. This analysis echos Yi (2003), which argued that
multistage production explained the large, nonlinear increase in trade relative to GDP in response
to declines in trade costs. Revisiting this idea, we compare the elasticity of trade to GDP in our
multistage model to two benchmarks. The first benchmark is a counterfactual in our own model,

    6 While most of our analysis focuses on how the average bilateral elasticity depends on the level of trade costs, we
also discuss implications of heterogeneity in bilateral elasticities for estimation of gravity regressions. Specifically, in
Section 3.1.2, we quantify the heterogeneous coefficients bias embedded in gravity estimates of trade elasticities.

                                                             4
in which we lower trade costs but do not allow agents to reoptimize the location of production
stages in response. The second benchmark is obtained from a multi-sector Eaton-Kortum model
with roundabout input-output linkages across sectors, similar to Caliendo and Parro (2015).7 We
show that the ratio of manufacturing world trade to GDP rises non-linearly in all three cases, and
that this nonlinearity is actually strongest in the Caliendo-Parro benchmark. This result prima facie
contradicts the argument in Yi (2003). We argue this apparent contradiction is driven by the choice
of benchmark model: we compare the multistage model to a roundabout model with input trade,
while Yi compares a multistage model to models without any input trade. Our takeaway is that
inputs magnify the the rise of trade to GDP as trade costs fall, but the particular form (multistage
or roundabout) that input trade takes has relatively little impact on the aggregate trade response.
     Our paper is obviously related to an active literature on input sourcing in general, and to
work on multistage production in particular. Dixit and Grossman (1982) and Sanyal (1983) pi-
oneered trade models with a continuum of production stages, which have been recently extended
by Costinot et al. (2013) and Fally and Hillberry (2018). We instead adopt a model with a dis-
crete number of stages, as in Yi (2003, 2010), Markusen and Venables (2007), and Baldwin and
Venables (2013).8
     A recent (contemporaneous) contribution by Antràs and de Gortari (2016) is also closely re-
lated to our work. Antràs and de Gortari study two variants of multistage trade models. They
first analyze optimal stage locations for single value chains with many countries and stages, using
computational techniques for solving high dimensional combinatorial problems. They then pivot
to a second quantitative model with a small number of discrete stages, similar to our paper. In
this model, they restrict the information that decision makers possess ­ assuming they only know
particular features of the distribution of costs of production, not realized values ­ as they locate
production stages. This probabilistic treatment is an analog to the Eaton and Kortum (2002) ap-
proach to Ricardian models.9 This solution technique is one key difference between their paper
and ours; Rather than relying on ex ante information and functional form assumptions to enable
closed form aggregation ("smooth out" discontinuities in the model), we instead apply an ex post
computational technique to smooth the equilibrium conditions directly. Importantly, because our

     7 We calibrate this benchmark model to match the equilibrium in our multistage model exactly, so we compute

elasticities using different models that fit the exact same set of (simulated) data.
     8 Arkolakis and Ramanarayanan (2009) and Bridgman (2008, 2012) also study models with discrete numbers of

stages, but they lack the the sequential stage allocation problem that is central to our analysis.
     9 Antràs and de Gortari have two alternative characterizations of uncertainty about the costs of locating production

stages, which yield the same aggregate results. The first is that the unit cost for the entire value chain is uncertain,
drawn from a Fréchet distribution with location parameter that depends on wages and technology levels in all countries
in that value chain. The second is that firms face uncertainty about upstream productivity when they make decisions
about where to locate their production stage ­ i.e., firms know their own productivity and the productivity of suppliers
one stage upstream, but have imperfect information about suppliers further than one stage upstream, where uncertainty
is again characterized by draws from the Fréchet distribution.

                                                           5
approach does not require particular information or functional form assumptions, it is applicable
to models where Eaton-Kortum style aggregation fails.10 A second major difference between our
papers concerns their quantitative focus. Antràs and de Gortari analyze the relationship between
geography (centrality) and downstream location in value chains, and gains from trade due to mul-
tistage production. In contrast, we place primary emphasis on trade elasticities, as in Yi (2003,
2010).
     The paper proceeds as follows. We describe the model in Section 1. In Section 2, we discuss
how we calibrate and estimate model parameters, and we describe the technology and trade cost
estimates. We analyze trade elasticities in Section 3, and Section 4 concludes.


1     Framework
We start this section by laying out the basic elements of our multistage model, describing the
economic environment first and defining the model equilibrium. We then discuss how we solve the
model numerically, since the model does not admit an analytic solution.


1.1     Economic Environment
Consider a world economy with many countries and two sectors. Countries are indexed by i, j, k 
{1, . . . , C} and sectors are denoted by m and n, standing for manufacturing and non-manufacturing
(including agriculture, natural resources, and services) respectively. Within each sector, there is a
unit continuum of goods indexed by z. By way of notation, we put country labels in the superscript
and good and sector labels in parentheses. We also assume that all goods and factor markets are
perfectly competitive.

Manufacturing The manufacturing sector features a discrete multistage production process, as
in Yi (2003, 2010). Each good requires s  {1, . . . , S} production stages to be completed sequen-
tially, and subscripts on each variable index the production stage.
     Production in stage 1 uses labor and a composite input, and we assume the production function
for good z in sector m is:

                          qi            i            i
                           1 (z, m) = T1 (z, m)1 (m)X (z, m)     l1 (z, m)1-1 (m) ,
                                                            1 (m) i
                                                                                                                 (1)


    10 Beyondthe multistage application that we pursue, the discrete choice technique is applicable to many potential
computational trade models. For example, one could use the same approach to solve high dimensional Ricardian
models without assuming productivity is distributed according to the Fréchet distribution, or relaxing assumptions
about functional forms and the structure of competition that enable Fréchet aggregation.

                                                         6
where T1i (z, m) is the good-specific productivity of country i in manufacturing stage 1, l1i (z, m)

and X i (z, m) are the quantities of labor and the composite input used in production, 1 (m) is the
share of the composite input in production in stage 1, and 1 (m) = (1 - 1 (m))1-1 (m) 1 (m)1 is
a normalization.
    Production at stages s > 1 requires labor and output from stage s - 1 as in intermediate input,
and the production function is given by:

                          qi            i            i
                           s (z, m) = Ts (z, m)s (m)xs-1 (z, m)     ls (z, m)1-s (m) ,
                                                               s (m) i
                                                                                                                      (2)

where Tsi (z, m) is productivity in stage s, xsi (z, m) is the quantity of the stage s - 1 input used,
                                                -1
 i
ls (z, m) is labor used, s (m) is the cost share attached to the stage s - 1 input, and s (m) is again a
parameter normalization.11
     Output in each stage may be produced in any location, but every time output is shipped between
countries it incurs a bilateral, sector-specific, ad valorem iceberg trade cost  i j (m).12

Non-manufacturing The non-manufacturing sector features Ricardian production and trade, as
in Eaton and Kortum (2002). Production of good z in sector n requires labor and the composite
intermediate input:
                       qi (z, n) = T i (z, n)(n)X i (z, n) (n) l i (z, n)1- (n) .         (3)

where T i (z, n) is productivity, l i (z, n) and X i (z, n) are the quantities of labor and the composite
input used in production,  (n) is the share of the composite input in production, and (n) is a
parameter normalization. Each non-manufacturing good can be produced in any location, and
shipping from source to destination incurs bilateral, ad valorem iceberg trade cost  i j (n), which
may differ from the trade cost for manufactured goods.

Aggregation Within each sector, goods are aggregated to form non-traded composites Qi (m) and
Qi (n), which are sold to final consumers and used to form the composite input.13 Each sector-level


    11 Following Yi (2010), we adopt Cobb-Douglas production functions for stage output. This functional form fa-

cilitates calibration, but alternative functional forms are feasible. Further, we do not explicitly include capital in the
model. Including endogenous capital stocks, as inYi (2003), would be a straightforward extension of the model.
    12 Extensions in which trade costs differ for final versus intermediate goods are feasible. This exenstion would allow

one to consider the effects of input tariff liberalization in the model. Further, extensions with per unit trade costs, as
in Irarrazabal et al. (2015), are also interesting. In particular, our iceberg formulation assumes that the proportional
burden of trade costs is constant for all stages, but that the absolute value of trade costs incurred is higher for latter
stages because the value of output is larger. In constrast, per unit trade costs would imply that the proportional burden
of trade costs is lower for later stages.
    13 One can think of this aggregation step as an additional production stage with zero value added, or one can embed

the aggregation directly into preferences and production functions. We choose the former route, but this choice has no
consequences.

                                                            7
composite is a Cobb-Douglas combination individual goods:

                                                      1
                                 Qi (m) = exp                 ~i (z, m))dz
                                                          log(q                                      (4)
                                                   0
                                                    1
                                 Qi (n) = exp               ~i (z, n))dz ,
                                                        log(q                                        (5)
                                                  0


where q  ~i (z, m) and q
                       ~i (z, n) are the quantities of each good purchased (from low cost sources at
home or abroad) by country i. For manufacturing, q       ~i (z, m) represents purchases of stage S goods.
    These sector-level composite goods are combined to form an aggregate final good and the
composite input. The aggregate final good is given by F i = Ai F i (m)i F i (n)1-i , where F i (m)
and F i (n) denote the amount of the sector-level composite good that is sold to final consumers,
i is a country-specific manufacturing expenditure share, and Ai = (1 - i )1-i ii . The com-
                                                                      1 i             1 i
posite input is given by X i = BX i (m) X i (n)1- , with X i = 0       X (z, m)dz + 0  X (z, n)dz and B =
         1- 
(1 -  )         . Finally, adding up requires that Q (m) = F (m)+ X (m) and Q (n) = F i (n)+ X i (n).
                                                       i          i       i          i



Households Consumers supply labor inelastically to firms and consume the composite final good
Fi . The consumer budget constraint is: wi Li = PF i F i + T Bi , where wi is the wage, Li is the labor

endowment, PF i is the price of the final composite, and T Bi is the nominal trade balance. The trade

balance appears here in the budget constraint, since we treat it as an exogenous nominal transfer
necessary to equate income and expenditure for each country.


1.2       Model Equilibrium
To solve for an equilibrium, we need to describe the optimal sourcing decisions. We then define
price indexes, collect market clearing conditions, and define the equilibrium.

Input Sourcing For non-manufacturing, this amounts to determining who the low cost suppliers
are for each good to each destination. If p j (z, n) is the potential factory gate price that country
j could supply non-manufacturing good z, and p jk (z, n) =  jk (n) p j (z, n) is the delivered price in
country k, then realized price of good (z, n) in destination k is:

                                       ~k (z, n) = min p jk (z, n).
                                       p                                                             (6)
                                                          j


The potential price at which j can supply non-manufacturing good z is itself given by p j (z, n) =
               j
(w j )1- (n) (PX ) (n)     j
       T j (z,n)
                       ,
                 where PX is the price of the composite input (defined below).
   For manufacturing, we need to solve for the optimal assignment of stages to countries for
production of all goods purchased by each destination, where the assignment of stages to countries

                                                      8
                                                                              j
depends on the destination in which that good is consumed. If ps (z, m) is the potential factory gate
                                                                           jk                  j
price that country j could supply stage-s of manufactured good z, and ps (z, m) =  jk (m) ps (z, m)
is the delivered price in destination k inclusive of trade costs, then optimal sourcing implies that
the realized price in destination k is:

                                               ~k
                                               p                 jk
                                                 s (z, m) = min ps (z, m).                                  (7)
                                                            j


For stages s > 1, the potential factory gate price at which country i can supply stage s output is:

                                           j
                         (w j )1-s (m) ( p
                                         ~s-1 (z, m))s (m)                j                ij
          psj (z, m) =                 j
                                                                 with   ~s-1 (z, m) = min ps-1 (z, m).
                                                                        p                                   (8)
                                    Ts (z, m)                                          i


At stage s = 1, the potential factory gate price of output from country i is:

                                                      (wi )1-1 (m) (PXi )1 (m)
                                      pi
                                       1 (z, m) =                              ,                            (9)
                                                             T1i (z, m)

where PX i is again the composite input price.

    This sourcing problem has a recursive structure. The price at which k actually purchases stage
s output for good (z, m) is the minimum of the set of possible prices at which each country j could
deliver that output, conditional on country j choosing the minimum cost source its own purchases
of stage s - 1 output. Potential supply prices for stage s - 1 inputs in turn depend on optimal
sourcing further upstream, at stage s - 2. And so on. Finally, at stage 1, input supply prices depend
on the composite input price in country in each country, which itself is a function of the realized
prices (given optimal sourcing) of stage S output. This structure gives rise to a combinatorial
stage location problem, inside a general equilibrium problem. For each manufactured good and
purchasing country, there are CS possible combinations of the value chain.

Price Indexes and Market Clearing Given Equation 4, the price of the manufacturing com-
                            1
posite good is Pi (m) = exp 0      ~i (z, m))dz , and the price of the non-manufacturing com-
                              log( p
                                  1
posite good is Pi (n) = exp             ~i (z, n))dz .
                                 0 log( p                      Then, the price indexes for F i and X i are PF
                                                                                                            i =

(Pi (m))i (Pi (n))1-i and      i = Pi (m) Pi (n)1- .
                              PX




                                                           9
    The market clearing conditions for output are:

                                                                        ij                   kj
                        qi           ij
                                         ~ j (z, m)1( pS (z, m)  pS (z, m)  k = i),
                         S (z, m) =   (m)q                                                                             (10)
                                       j

               qi           ij   j           ij         kj
                s (z, m) =   (m)xs (z, m)1( ps (z, m)  ps (z, m)  k = i) for 1  s < S,                                 (11)
                               j

                          qi (z, n) =   i j (n)q
                                               ~ j (z, n)1( pi j (z, n)  pk j (z, n)  k = i).                          (12)
                                           j


Market clearing conditions for the composite input and the labor market are:

                                                      1                          1
                                       Xi =               X i (z, n)dz +             X i (z, m)dz,                     (13)
                                                  0                          0
                                                      1                       1
                                           Li =           l i (z, n)dz +              i
                                                                                     ls (z, m)dz.                      (14)
                                                  0                          0


Equilibrium Given parameters {i ,  (s),  , T1i (z, m), T2i (z, m), T i (z, n),  i j (m),  i j (n), Li , T Bi }, an
equilibrium is a collection of prices {wi , p      ~i1 (z, m), p ~i2 (z, m), p~i (z, n), Pi (m), Pi (n), PX  i , Pi }, aggre-
                                                                                                                  F
                   i  i   i         i       i           i         i         i
gate quantities {F , X , Q (m), Q (n), F (m), F (n), X (m), X (n)}, and production, sourcing, and
input use decisions {X i (z, n), X i (z, m), l i (z, n), lsi (z, m), qi (z, n), q ~i (z, n), qi          i
                                                                                              s (z, m), xs (z, m), q~i
                                                                                                                     2 (z, m)}
such that producers maximize profits, consumers maximize real final expenditure subject to their
budget constraint, and product and labor markets clear.


1.3     Discussion
Prior to discussing how we translate this model into a quantitative framework for analysis, we
comment on two aspects of the model.
    First, the model features both sequential multistage production and roundabout production.
Roundabout production introduces a loop in the production process, which amplifies the ratio of
gross output to value added. That is, gross output will exceed value added both because multistage
production implies that inputs are produced and used up in the production process, but also because
production in each sector uses its own output as inputs. Roundabout production also gives rise
to input linkages across sectors in the model. We have assumed that sequential production is
confined to the manufacturing sector, and that all cross-sector input flows are non-sequential in
nature. Both these aspects of the model are important for how we calibrate the model to match the
data, discussed further below.
    Second, the multistage component of the model is essential to understanding the behavior of the
elasticity of trade flows to trade costs. One useful piece of intuition is that stages are more often co-
located in the same country when trade costs are high. This implies that the model behaves more


                                                                   10
like a standard single-stage (multi-sector) Ricardian model as trade costs rise. Since the single-
stage model features a constant partial elasticity of trade to changes in trade costs, the multistage
model will also feature a near constant partial trade elasticity at high levels of trade costs. Further,
it will also generate changes in trade and welfare that are similar to the Ricardian benchmark in
response to marginal changes in trade costs when trade costs are initially high.
    As trade costs fall, it is increasingly attractive to exploit cost differences and break up produc-
tion stages across countries. The ability to substitute over the location of individual stages, rather
than simply over the location of production for entire goods, tends to amplify the sensitivity of
trade to trade costs. The key mechanism is that trade costs are paid on the full value of stage out-
put, while cost savings of shifting the the location of a single stage of the production process apply
only to the value added at that stage. For downstream production stages, the value of gross output
­ and thus the trade cost paid for exporting downstream output ­ is large relative to the marginal
value added at that stage. This deters the formation of value chains in which inputs from home are
used abroad and the final good is re-exported, either back home or to third countries. Yi (2010)
refers to this as the "effective rate of protection" force.
    At intermediate levels of trade costs, the model economy features both standard Ricardian
trade, where consumers substitute across entire goods, and trade through multistage value chains
in which agents substitute over production locations for each stage. Therefore, the aggregate model
elasticity of trade to trade costs depends on the mix of Ricardian versus multistage trade. As trade
costs fall, the share of trade via multistage value chains rises, so we expect the elasticity of trade
to trade costs to rise as well.


1.4    Solving the Model
We describe solution of the model for the non-manufacturing sector and manufacturing sector
separately, since we treat them in somewhat different ways. While we continue to assume that
there is a continuum of goods in non-manufacturing, we introduce a discrete approximation to the
continuum of goods in manufacturing, following Yi (2003, 2010).

Non-Manufacturing As in Eaton and Kortum (2002), we assume that technology parameters
{T i (z, n)} independent draws from Fréchet distributions, which have shape parameter  (common
to all countries) and country-specific location parameters {T i (n)}. We can then solve for trade




                                                  11
shares and price indexes in closed form:

                                                                            j           -
                                          T j (n)  ji (n)(w j )1- (n) (PX ) (n)
                              ji (n) =                                                  - ,             (15)
                                                                               j
                                         j T    j (n)    ji (n)(w j )1- (n) (PX ) (n)
                                                                                              -1/
                                                                                   j      -
                                                                    j 1- (n)
                     i
                   P (n) = exp( / )        T      j         ji
                                                      (n)  (n)(w )              (PX ) (n)           .   (16)
                                            j


The ability to solve for the non-manufacturing equilibrium in closed form is useful, because it
facilitates computation of the full model equilibrium.

Manufacturing We assume that there are a large, finite number of manufactured goods, and let
r = {1, . . . , R} index individual goods. The equilibrium of the model is essentially the same as
described above, with r rather than z indexing goods in manufacturing and summations over this
set of goods replacing integrals where appropriate.
    As in Ricardian models with a finite number of goods, the equilibrium of this discretized model
is not continuous in the underlying parameters. This makes the model challenging to solve nu-
merically, and hence also to estimate the model parameters via simulated method of moments.
The standard approach to dealing with this complication would be to approximate the contin-
uum with a "large" number of goods, where "large" means a high enough value for R so that the
discretized model equilibrium conditions are sufficiently smooth to be accurately solved with stan-
dard (derivative-based) numerical methods.14 In our multi-country setting, this standard approach
is computationally burdensome, because we need to solve the combinatorial sourcing problem (de-
scribed above) for every good and destination country. Therefore, we adopt a different procedure
that allows us to use a "small" value for R.
    Noting the similarity between sourcing decisions in the model and consumer optimization in
discrete choice models, we borrow a smoothing technique developed to facilitate simulation of
choice probabilities in the discrete choice literature. Specifically, we draw on the logit-smoothed
accept-reject (AR) simulator, developed by McFadden (1989).15 The key observation is that ­
like simulated choice probabilities ­ sourcing decisions and hence trade shares are discontinuous.
These discontinuities are associated with the presence of indicator functions in the market clearing
conditions of the model. The logit-smoothed AR simulator approximates the indicator function




  14 For   example, Yi (2010) approximates the continuum using 1.5 million discrete goods.
  15 See   Train (2009) for a lucid presentation of accept-reject simulators.

                                                            12
with a continuous logit function, as in:
                                                                                            ij
                                                                                 e- ps (r,m)/
                              1( pi j
                                  s (r, m)        pk j
                                                   s (r, m)  k        = i)                       kj            ,     (17)
                                                                               k e- ps                (r,m)/


where  > 0 is a smoothing parameter that determines the accuracy of the approximation.16 Intu-
                                                                                            kj
itively, when country i is a relatively high cost supplier to j (near the max of the set { ps (r, m)}),
the logit function takes on a value near zero. In contrast, as country i's price falls relative to its
competitors, the logit function smoothly converges to one.
    With this assumption, the market clearing conditions for manufacturing in the smoothed, dis-
cretized model become:
                                                                                  ij
                                                                              e- pS (r,m)/
                               qi
                                S (r, m) =         ij        j
                                                           ~ (r, m)
                                                        (m)q                           kj                      ,     (18)
                                              j                            k    e- pS (r,m)/
                                                                       ij
                                                                   -
                                                                  e s r,m)/
                                                                     p    (
                      qi           ij   j
                       s (r, m) =   (m)xs (r, m)                         kj                       for 1  s < S.      (19)
                                     j                           k e- ps      (r,m)/


    Thus far, we have not said anything about manufacturing technology parameters {Tsi (z, m)}. To
reduce the dimensionality of the parameter space, we impose distributional assumptions on them,
so that we only need to estimate distribution parameters below. While our model can accommodate
many possible distributions, we follow Yi (2010) and assume that {Tsi (z, m)} are independent draws
from Fréchet distributions, which have shape parameter  (common to all countries, and identical
to the parameter in non-manufacturing) and country-stage-specific location parameters {Tsi (m)}.17

Solution Procedure A brief overview of the procedure we use to solve the model is as follows.
Given parameters {i ,  (s),  , T i (n), Tsi (m),  ,  i j (m),  i j (n)}, data {Li , T Bi }, productivity draws
{Tsi (r, m)}, and an initial guess for the vector of wages, we can solve for the optimal assignment of
stages to countries and equilibrium prices in manufacturing, along with equilibrium prices in non-
manufacturing. Given this, we then construct manufacturing and non-manufacturing production,
and thus labor demanded. An equilibrium vector of wages equates labor demand and labor supply,
as in Equation (14). We describe in detail an algorithm to solve the model in Appendix A.




   16 As   0, the logit function converges to the indicator function. The choice of  is guided by a trade-off between

accuracy and computational speed, and there is little guidance on the appropriate level of  in general. By trial and
error, we find that  = 0.1 yields a very good approximation to the exact equilibrium.
   17 One important difference relative to Yi (2010) is that we allow countries to have comparative advantage across

sectors, while Yi instead restricts the location of the productivity to be the same in all stages, as in Tsi (m) = T i (m).

                                                                 13
2       Model to Data
In this section, we describe how we fit the model in Section 1 to the data. We first describe how we
calibrate a subset of the parameters of the model and estimate the remainder via simulated method
of moments. We then describe our data source. We conclude with a description of the estimated
values for technology and trade cost parameters.


2.1     Fitting the Model
The free parameters in the model include technology parameters {Tsi (m), T i (n),  }, trade costs
{ i j (m),  i j (n)}, and share parameters in production functions and preferences {s (m), s (n),  , i }.
We mix calibration and estimation in pinning down these parameters.
     Thus far, we have not specified the number of production stages (S) in the model, but we must
take a stand on the number of stages to calibrate/estimate the remaining parameters. We assume
there are two production stages in manufacturing (S = 2), following Yi (2003, 2010).18 We also
need to choose a value for the number of manufacturing goods (R), which yields an acceptable
trade-off between simulation accuracy and computation time. In Monte Carlo simulations, we
have found that our estimation procedure is able to recover the true parameters of the model when
R = 20, 000, so we use this value.

2.1.1    Calibrated Parameters

We calibrate {s (m),  (n),  , i } to match production and expenditure data. The parameter i
is set to match the share of manufacturing in final expenditure in each country. The median
value of i is 0.24, with values that range from 0.17 to 0.43 across countries. In the baseline
calibration, we assume that  (m)  1 (m) = 2 (m) and set  (m) = 0.70 and  (n) = 0.41 to
match the ratio of value-added to output for the world as a whole in the manufacturing and non-
manufacturing, respectively.19 Given this, we calibrate  match input flows across manufacturing
and non-manufacturing sectors for the world.20 This yields  = 0.16, which means that the com-
    18 Antràs and de Gortari (2016) attempt to discriminate between models with 2 versus 3 stages based on model fit,

and find that two stages are sufficient to fit bilateral trade data.
    19 For each country, value added in manufacturing is equal to the wage bill: vai (m) = R wi (l i (r, m) + l i (r, m)) =
                                                                                                   r=1      1        2
(1 -  (m))goi (m), where goi (m) = R                   i                   i                                  i          i
                                       r=1 [ p1 (r, m)q1 (r, m)+ p2 (r, m)q2 (r, m)]. Then 1 -  (m) = i va (r, m)/ i go (m),
so we set  (m) to match the ratio of value-added to output in manufacturing for the world as a whole. While we could
allow  (m) to vary across countries, we have chosen not to do so for two reasons. First, while differences in value-
added to output ratios differ a lot between manufacturing and services, differences across countries within sectors are
more muted. Second, imposing a common value for  (m) across countries facilitates calibration of  .
    20 Let y(m) = y (m) + y (m) be the value of total world output in manufacturing, wherey (m) and y (m) denote
                   1         2                                                                         1          2
stage 1 and stage 2 output. Whereas y(m) is directly observable, y1 (m) and y2 (m) are not. In the model, y1 (m) =
 (m)y2 (m), so y(m) = (1 +  (m))y2 (m). Further, y2 (m) = i i PF             i Fi +       i X i , with    i X i =  (m)y (m) +
                                                                                      i PX             i PX            1
 (n)y(n), where y(n) is total world non-manufacturing output. Combining these observations, (1 +  (1))-1 y(m) =

                                                            14
posite input is composed primarily of non-manufacturing output.

2.1.2    Estimation of Technology and Trade Cost Parameters

In Section 1.4, we assumed that {Tsi (z, m), T i (z, n)} are independent draws from Fréchet distri-
butions. We set the common shape parameter in these distributions to  = 4.12, guided by Si-
monovska and Waugh (2014). We leave technology levels {Tsi (m), T i (n)} as parameters to be
estimated, and we set T11 (s) = T21 (s) = T 1 (n) = 1 so that technology levels are measured relative
to country 1.
     We parameterize trade costs by assuming that bilateral trade costs are a power function of
                                 (m)                         (n)
distance:  i j (m) =  j d i j        and  i j (n) =  d i j       , where d i j is the distance between country
i and country j, { j ,  } are a level parameters for trade costs, and  (m) and  (n) are sector-
specific elasticities of trade costs to distance.21 We set trade costs on domestic shipments to one in
all countries ( ii (m) =  ii (n) = 1).
     We estimate the parameters  = T1i (m), T2i (m), T i (n),  j ,  ,  (m),  (n) by minimizing the
distance between trade flows in the model and data, given data on expenditure in each market
{PFi F i }, trade balances {T Bi }, and labor endowments {Li }. Together, these data allow us to com-

pute wages as wi = PF     i F i + T Bi /Li , and we set w1 = 1 as our price normalization. Given wages

and a candidate parameter vector       ~ , we draw {Tsi (r, m)}, compute the model equilibrium, and form
a vector of moments based on trade shares.
     The first set of moments are based on bilateral trade shares for final manufactured goods. In
the model, the share of final goods purchased by destination j from source i as a share of final
expenditure in country j is equal to the probability that destination j sources stage 2 goods from
country i, because expenditure per good is constant. Employing the same smoothing procedure
described in Section 1.4, we compute these shares as:
                                                                    ij
                                      ij           1 R          e- p2 (r,m)/
                                      F (m) =                                     .                                 (20)
                                                   R r=1
                                                                         kj
                                                             k e- p2 (r,m)/
   The second set of moments are based on trade shares for manufactured inputs. Input shipments
from country i to j include both stage 1 goods and stage 2 goods destined for the composite input.

        i F i +   (m)   (m)                                                                                i i
i i PF                1+ (m) y(m) +   (n)y(n). Given parameters i ,  (m),  (n) and data y(m), y(n), PF F , this equa-
tion can be solved for  .
    21 We adopt a parsimonious specification for trade costs to limit the number of parameters that need to be estimated.

While the specification we choose is sufficient to fit the data well, a more flexible specification would be feasible. The
assumption that trade costs have a destination-specific component can be motivated in a number of ways. The most
obvious is that it captures differences in multilateral import protection. In relation to prior work, Eaton and Kortum
(2002) also assume that there is a destination-specific, but not source-specific, component of bilateral trade costs. We
omit source-specific effects (in part) to reduce the dimensionality of the parameter space for estimation.

                                                           15
Input shipments from i to j of sector m goods are:

                                 ij
           ij
                     R
                             e- p1 (r,m)/               j         j
  Inputs (m) =                        kj       [ (m) p2 (r, m)q2 (r, m)]
                    r=1    k   e- p1 (r,m)/
                                                                                    ij
                                                                  1 R           e- p2 (r,m)/           j
                                                                 +                       kj       [ PM M j ]. (21)
                                                                  R r=1       k   e- p2 (r,m)/

Then the share of inputs from source i in country j's total purchases of manufactured inputs is:
  ij              i j (m)
I (m) = Inputs        ij  . The third set of moments are based on trade shares in the non-manufacturing
            k Inputs (m)
sector, which can be computed in closed form as in Equation (15).
     Since the trade shares sum to one for each importer, we only use off diagonal trade shares
(i = j) for estimation. This gives us 3 N 2 - N moments to estimate (3N - 3) + N + 3 unknown
parameters. Letting  i j denote the vector of trade shares for pair i j, we stack log differences
between actual and simulated trade shares  i j () = ln  i j - ln      ^ i j () in a column vector  ().
The moment condition is then E [ (0 )] = 0, where 0 is the true value of  , so we estimate a          ^
that satisfies:
                                           ^ = arg min  ( )  ( )
                                                                                                                (22)

One point worth noting here is that the algorithm we use to solve this minimization problem ex-
ploits the existence of closed forms in non-manufacturing to speed computation, by estimating
non-manufacturing parameters via regression within the simulated MoM procedure for manufac-
turing parameters.

2.1.3      Data

We draw trade and input-output data from Johnson and Noguera (2017), covering forty-two major
countries. We select 37 countries in 2005 to include our analysis, and we construct a composite
rest-of-the-world region to close the world economy.22 Thus, C = 38 overall. Further, we aggregate
the data to the two-sector level, where manufacturing is category D in the ISIC (Revision 3.1)
classification and non-manufacturing includes all other sectors of the economy. Consistent with
the discussion above, we use data on aggregate final expenditure and the trade balance for each
country from this data. We also use data on bilateral shipments of final goods and inputs to form
trade shares, including each country's purchases from itself. In order to calibrate {s (m),  (n),  },

   22 Inthe original Johnson and Noguera (2017) data, there is no information on input use in the rest of the world
region. We extend the data here to close the world economy by imputing input linkages in the ROW. Details available
on request. Further, while data in Johnson and Noguera is available through 2009, we select 2005 for analysis to avoid
the impact of the 2008-2009 recession and trade collapse. In previous working papers, we have alternatively used data
from the World Input-Output Database, which returns essentially similar results.

                                                         16
we aggregate across countries (including the rest of the world) to compute world-level data on
sector-level value added, sector-level gross output, and cross-sector input shipments.
    Finally, we measure aggregate labor endowments data from Penn World Tables 9.0. We define
labor endowments {Li } in effective terms, equal to numbers of persons engaged (employment)
times the level of human capital, which is constructed based on estimates of educational attainment
and returns to schooling by the Penn World Tables. We also use bilateral distance data from CEPII
to estimate trade cost parameters.


2.2     Estimates for Trade Costs and Technology
In this section, we present estimates for trade costs and technology parameters. We also briefly
examine the role of comparative advantage in driving specialization across production stages, and
thus export composition.

Trade Costs Our estimate of the elasticity of trade costs to distance for the manufacturing sector
is  (m) = 0.25. Combining this distance elasticity with estimates of importer-specific levels of
trade costs ( j ), we compute implied iceberg frictions for manufacturing and plot the distribution
of trade costs across bilateral pairs in Figure 1. Clearly, estimated iceberg frictions are both large
on average (with median value of about 4.5) and very dispersed across partners. The high level of
these trade cost estimates is broadly in line with findings in the previous literature.23
    As one would expect, the level and heterogeneity in bilateral trade costs is tightly linked to
variation in sourcing shares. For one, the level of trade costs is highly correlated with the home
bias in each country's expenditure. Second, bilateral frictions are needed to match the wide vari-
ation in import shares across partners. To illustrate this variation in the data and model, we plot
intermediate and final goods trade shares in Figure 2, with true trade shares on the x-axis and sim-
ulated trade shares on the y-axis (both log scales). The model clearly fits these targeted moments
well.

Technology We present estimates for technology levels by stage for the 37 countries and the
composite region in Table 1. The columns labeled Stage 1 and Stage 2 present the geometric
means of T1i (z, m) and T2i (z, m) in each country, expressed relative to relative to Argentina.24 Across

   23 The  review by Anderson and van Wincoop (2004) argues that existing estimates implied that trade costs for a
representative industrialized country are near 170% ( = 2.7). Our sample includes emerging markets as well, where
trade costs are plausibly higher. Eaton and Kortum (2002) report estimated distance costs of roughly 300% for country
pairs in the 3000 to 6000 mile distance range.
    24 Since T i (z, m) is drawn from a Fréchet, the unweighted geometric mean is given by exp( / )T i (m)1/ , where
              s                                                                                        s
 here is the Euler-Mascheroni constant. Since we report means for each country relative to Argentina, the numbers
                                                        1/
reported in the table are effectively Tsi (m)/TsARG (m)    .

                                                         17
countries, productivity levels are highly correlated with real income per capita. Productivity levels
are also correlated across stages: countries with high absolute productivity in stage 1 tend to also
have high absolute productivity in stage 2. Despite this correlation, there are sizable cross-country
differences in relative productivity across stages.
    The final column in Table 1 reports the ratio of mean technology in stage 2 relative to stage 1 in
each country, where numbers greater than one indicate that a country has a technological compara-
tive advantage in stage 2 (downstream) production relative to Argentina. Countries are ordered by
comparative advantage in the table: Chile and South Africa at the top have comparative advantage
in the upstream stage, while Greece and Vietnam at the bottom have comparative advantage in the
downstream stage. Technological comparative advantage is naturally related to export composition
in the data. In Figure 3, we plot the share of final goods in exports against our estimates of relative
stage technologies. Though we do not directly target export composition in estimation, there is an
evident positive correlation between export composition and stage comparative advantage, wherein
countries with high productivity in stage 2 relative to stage 1 have higher shares of final goods in
their exports.

Comparative Advantage and Export Composition While technological comparative advan-
tage has an obvious influence on export composition, it is not the only determinant of it (e.g., trade
costs matter too). To isolate the role of technological comparative advantage in driving export
composition, we turn to a counterfactual simulation of the model in which we eliminate this com-
parative advantage, setting technology parameters to be equal across stages. Specifically, we set
counterfactual technology in each country and stage (T   ~si (m)) equal to the geometric mean across
        ~si (m) = T i (m) 1/2 T i (m) 1/2 for s  1, 2.
stages: T           1           2
    We compare export composition in the baseline estimated model and in this counterfactual
simulation in Figure 4. In Panel (a), we plot the share of final goods exports for each country in the
estimated model (with unequal stage technologies) versus the data as a benchmark; Unsurprisingly,
these are highly positively correlated, as expected based on Figure 3 above. In Panel (b), we plot
the share of final goods exports for each country from the counterfactual simulation, having re-
moved comparative advantage across stages, versus the data. As is evident, the positive correlation
between export composition in model and data largely disappears when we remove comparative
advantage. To reinforce this point, we plot the difference between export composition in the esti-
mated model and the counterfactual model versus estimated comparative advantage in Panel (c).
For countries with upstream comparative advantage, removing comparative advantage leads to
large increases in the share of final goods in their exports, while the opposite is true for countries
who have downstream comparative advantage. Thus, we conclude that technological comparative
advantage plays a significant role in explaining upstream vs. downstream specialization.


                                                  18
3      Trade Elasticities
In this section, we use counterfactual simulations to study trade elasticities in the model. We start
with a discussion about how bilateral elasticities vary with the level of trade costs, and then we
discuss global trade elasticities.


3.1      Bilateral Trade Elasticities
To compute bilateral trade elasticities in the multistage model that are comparable to existing
empirical estimates, we interpret our simulated data through the lens of a general gravity equation.
Following Head and Mayer (2014), let bilateral gross exports be given by X i j = GSi M j  i j , where
G is a (gravitational) constant, Si captures the supply capabilities of the exporter, and M j captures
                                                                       ij
characteristics of the import market. The parameter  i j = ( i j )- is the level of bilateral (iceberg)
trade frictions raised to the power - i j , where  i j is the elasticity of trade flows to frictions.
     In standard applications of the gravity equation,  i j is a constant ­ as in  i j =  for all i and j
­ pinned down by the elasticity of substitution in the CES-Armington model or the Fréchet shape
parameter in an Eaton-Kortum model. We relax this assumption by allowing the elasticity to vary
by country pair, while maintaining the assumption that it is symmetric within each country pair
( i j =  ji ) and that there are no domestic trade costs (ii = 1). Then, we solve for the bilateral
trade elasticity as follows:
                                                            i j X ji
                                                    ln X  X ii X j j
                                        i j =  ji =                  .                                (23)
                                                      ln ( j  ji )
                                                           i

This approach to computing bilateral elasticities is the analog to the ratio-type estimation of trade
costs, developed by Head and Ries (2001). Our application of it is similar to Caliendo and Parro
(2015), who use measured barriers to trade (e.g., tariffs) and ratios of observed trade flows to
estimate trade elasticities.
    We compute elasticities using simulated trade data for a sequence of counterfactual equilibria in
the multistage model, which differ only in terms of the level of trade costs. Starting from baseline
trade cost estimates {        ^ i j (m), ^ i j (n)}, we consider counterfactual equilibria with trade costs equal
to {   ^ i j (m),  ^ i j (n)}, where   1 is a scaling factor that raises or lowers the level of trade costs
relative to the baseline estimates.25 For each equilibrium, we use simulated trade flows and trade
costs to compute bilateral elasticities, using Equation (23).



    25 Prior
           to changing trade costs, we close the exogenous aggregate trade imbalances and re-compute the baseline
equilibrium with balanced trade (holding all other parameters at their baseline values). We then maintain balanced
trade as we compute counterfactual equilibria and compare each of these counterfactuals to this initial balanced trade
equilibrium.

                                                         19
Results In Figure 5, we plot mean values of  i j for the manufacturing sector in the set of coun-
terfactual equilibria, where the mean level of trade costs in each equilibrium is on the x-axis. In
the baseline equilibrium, the mean trade elasticity is roughly 3.9, close to standard values in the
literature. Bilateral elasticities also vary across trade partners in the cross-section: the 10th and
90th percentiles for bilateral gravity elasticities are about 3.6 and 4.2 in the baseline equilibrium.
     As the level of trade costs falls (rises) from their estimated level, the mean elasticity rises (falls)
in the model. This inverse correlation between the trade elasticity and the level of trade costs is
the multistage magnification effect in action: bilateral trade appears to become more sensitive to
trade frictions as the level of trade costs falls and the extent of value chain fragmentation rises.
Quantitatively, a decline in trade costs from 550% ( = 6.5) to 200% ( = 3.5) raises the mean
elasticity from about 3.84 to 3.98.26 Thus, while the multistage magnification effect is present in
the model, we think it reasonable to say that it is modest in size.
     Underlying this average elasticity result, there is heterogeneity in elasticities across final goods
versus inputs. We estimate elasticities using Equation (23) for final goods and inputs separately,
and then plot the the mean values in Figure 6. The first point to note is that the elasticity for inputs
is endogenously larger than for final goods in the model. This reflects the fact that most input
trade dominated by stage 1 goods, which are more sensitive to trade costs than stage 2 goods.27
Given that trade frictions increase with distance, this implies that input trade is concentrated among
geographically proximate trade partners, relative to trade in final goods. The second point to note
is that both the elasticities of input trade and final trade rise as trade costs fall. That said, the rise in
the input elasticity is about 30% larger than the rise in the final trade elasticity. Though different in
magnitude, these increases are intimately linked to one another ­ as GVC stages are reorganized
in response to falling trade costs, both the pattern of input and final goods trade changes. In order
to better understand bilateral trade elasticities, we now turn to unpacking these changes.

3.1.1    Unpacking GVC Adjustments

To analyze GVC adjustments in response to falling trade costs, we focus on exports of stage 1
goods. Conceptually, it is useful to distinguish between two types of stage 1 trade. On the one
hand, some stage 1 goods are shipped to foreign countries and then embodied in stage 2 goods that
are directly absorbed there. In this type of value chain, stages are fragmented across countries, but
stage 1 imports are not used to produce exports. On the other hand, some stage 1 goods are shipped
to foreign countries and then embodied in stage 2 goods that are exported, either back home or to
   26 While this may first appear like a radically large (45%) decline in trade frictions, a decline in iceberg frictions

on the order of 30-40% is needed to rationalize the growth of world trade since 1970 [Jacks et al. (2011), Johnson and
Noguera (2017)].
   27 To clarify, inputs here include both stage 1 goods, which are all used as inputs, and stage 2 goods dedicated to

production of the composite input. Stage 1 goods constitute the bulk of input trade for manufacturing.

                                                          20
third countries.
    Building on this distinction between different types of global value chains, we can decompose
stage 1 exports from country i to j as follows:

                                         ij             ij                  ij
                                      EX1 (m) = EX1 (m, j) + EX1 (m, k = j)                                                   (24)

                      ij
The first term EX1 (m, j) is the value of stage 1 exports from i that are used to produce stage 2
goods that are absorbed directly in j, and is given by:
                                              ij                                                  jj
             ij
                                R
                                       e- p1 (r,m)/                j                       e- p2 (r,m)/
           EX1 (m,    j) =                         lj                      ~ j (z, m)
                                                              (m) p2 (r, m)q                           lj                 .
                                r=1   l e- p1 (r,m)/                                      l e- pS (r,m)/
                           ij
The second term EX1 (m, k = j) is the value of stage 1 exports from i that are used to produce stage
2 goods that are exported by j:
                                              ij                                                                jk
     ij
                            R
                                       e- p1 (r,m)/                 jk        j                             e- p2 (r,m)/
   EX1 (m, k =     j) =                            lj         (m)                     ~k (z, m)
                                                                         (m) p2 (r, m)q                              lk       .
                           r=1 k= j   l e- p1 (r,m)/                                                   l e- pS (r,m)/

In plain English, this term captures how much "round-trip trade" occurs between i and j ­ i selling
stage 1 inputs to j that are embedded in stage 2 goods sold back to i ­ as well as the role of j as
an "export platform" for value chains that originate from country i. Reflecting this breakdown, we
              ij                 ij           ij
can write EX1 (m, k = j) = EX1 (m, i) + EX1 (m, k = i, j), where first term is round-trip trade and
the second is export platform trade.
    As discussed in Section 1.3, trade costs deter organizing the value chain in a way that involves
stage 2 being performed in a country where neither stage 1 is performed, nor where stage 2 output
is consumed. The reason is that the cost savings of locating stage 2 abroad, rather than at home or
where stage 2 output is consumed, will tend to be small relative to the gross trade costs incurred
in exporting stage 2 output. Lower trade costs make it more profitable to exploit cost differences
in locating stage 2 production. As a result, we should expect to see an increase in both round-trip
and export platform trade in stage 1 goods as trade costs fall.
    Building on these ideas, we plot the share of stage 1 exports that are absorbed in the destination,
embedded in round-trip trade, or embedded in platform exports against the mean level of trade
costs in each counterfactual equilibrium in Figure 7. When trade costs are high, stage 1 trade is
dominated by input shipments that are absorbed in the destination. As trade costs fall, a larger
share of stage 1 goods is dedicated to round-trip trade and platform exporting.28 In particular, the
   28 Focusing on the levels, round-trip trade is relatively uncommon in the model. In our data, this type of trade only
occurs in substantial amounts among the lowest trade cost pairs (e.g., France-Germany, US-Canada, China-Korea,
etc.).

                                                              21
rise in stage 1 inputs dedicated to platform exporting comes at the expense of direct absorption of
stage 1 inputs.
     This rise in platform exporting is important for understanding how the elasticity of input trade
behaves in the model. Across bilateral export destinations in the cross-section, stage 1 inputs
dedicated to platform exports fall off quickly with respect to bilateral trade costs. That is, export
platforms for value chains originating in country i tend to be located in countries j for which  i j (m)
is low (e.g., countries that are close to country i itself). As the level of trade costs falls and platform
exporting increases, the composition of stage 1 exports thus shifts toward the type of trade that is
more sensitive to trade costs. The result is that the measured elasticity of trade increases.
     To illustrate these mechanics, we turn to Figure 8. For each equilibrium in our model, we bin
country pairs based on the quintiles of the distribution of bilateral trade costs. Because relative
trade costs are fixed in the counterfactuals, the mapping from country pairs to quintile is stable
across equilibria. For each quintile q, we compute log stage 1 trade broken down by destination
                              ij                           ij
use, given by ln(i jq EX1 (m, j)) and ln(i jq EX1 (m, k = j)), where this second summation
pools round-trip and platform exports. We plot these values against the log of the mean trade cost
in each quintile in Figure 8, for both the highest and lowest trade cost equilibria.
     The slope of the line that connects the quintile values for each series corresponds (roughly
speaking) to the magnitude of the bilateral elasticity for each type of trade. In both equilibria,
stage 1 exports associated with round-trip trade and platform exporting fall off faster with respect to
bilateral trade costs than do stage 1 exports that are absorbed in the destination. Further, comparing
the right figure to the left, as trade costs fall, stage 1 exports dedicated to round-trip and export
platform trade rise relative to those absorbed in the destination. The average response of stage 1
exports with respect to distance (again, roughly speaking) is the weighted mean slope of the two
series. The mean slope is evidently higher in the low trade cost equilibrium, primarily because
round-trip and platform trade becomes more important for low trade cost partners as trade costs
fall. In the end, this endogenous supply chain re-organization drives the rise in the overall bilateral
trade elasticity as trade costs fall.

3.1.2       Gravity Regressions

In this section, we briefly draw out additional implications of our results for interpretation of
gravity regressions. In our model, the bilateral elasticity of trade to trade costs is heterogeneous. If
one ignores this heterogeneity, and instead uses estimation methods that impose constant bilateral
elasticities, the resulting elasticity estimates will suffer from heterogeneous coefficient bias (as in
a random coefficients model).29

   29 See   Appendix A in Card (1999) for a succinct discussion of OLS estimation of random coefficient models.

                                                          22
    To fix ideas, consider the standard gravity regression:

                                      ln X i j = ln Si + ln M j -  ln  i j +  i j ,                                 (25)

where ln Si and ln M j can be absorbed by exporter and importer specific fixed effects, and  i j is
a residual. The researcher typically treats ordinary least squares (OLS) estimates of  from this
equation as informative about the average elasticity of bilateral trade to trade costs. Importantly,
this interpretation is not correct in our model.
    Using the auxiliary gravity model with heterogeneous elasticities from above, we can write the
residual as  i j = -[ i j -  ] ln  i j +  i j , where  i j is a residual.30 Because  i j is heterogeneous,  i j
will generally be correlated with ln  i j . In turn, the OLS estimate of  from Equation 25, defined
here as   ^OLS , will be a biased estimate of the true mean elasticity             ¯ i j = E ( i j ). If the bilateral
elasticity  i j is higher for pairs with higher trade costs, then          ^OLS will be biased away from zero.
    In our baseline equilibrium,       ^OLS = 4.26, which is larger than the mean elasticity               ¯ i j = 3.90.
Thus, the gravity elasticity is inflated by heterogeneity bias, by about 10%.31 Further, we note that
the extent of this bias is not constant as we vary the level of trade costs, because the underlying
heterogeneous elasticities themselves change as the level of trade costs changes. We illustrate this
in Figure 9. In Panel (a), we plot estimates of         ^OLS in counterfactual simulated data for different
levels of trade costs, similar previous figures. As is evident, there is a U-shape in the estimates:
 ^OLS rises as trade costs fall, and as they rise, relative to baseline. In Panel (b), we plot the value
of the heterogeneous coefficients bias, defined as          ^OLS -  ¯ i j . The bias falls as trade costs decline,
but the decline is non-linear ­ the bias is roughly constant as trade costs fall from baseline, but
rises steeply as trade costs rise from baseline. To frame these results differently, note that                         ¯ij
rises monotonically as trade costs decline. The gravity estimate of the trade cost elasticity (                     ^OLS )
only reveals the rise in   ¯ i j as trade costs fall from baseline. As trade costs rise form baseline, the
heterogeneous coefficients bias is sufficiently strong to lead            ^OLS to rise, even though      ¯ i j is falling
over this interval.
    Finally, we emphasize that these results have further interesting implications for interpreting
the "distance puzzle" ­ the empirical fact that estimated distance elasticities have not declined over
time, despite seemingly obvious declines in trade costs [Disdier and Head (2008)]. In our model,

   30 Pushing  back one level, recall that we imposed  i j =  ji to measure bilateral elasticities. Deviations from this
assumption are implicitly included in  i j .
   31 This result is related to Yi (2010), who argues that multistage production explains the puzzlingly large impact of

the national border ­ "the border effect" ­ on US-Canada trade. Nonetheless, the results are not directly comparable.
The exercise in Yi (2010) computes the border effect using simulated data from models with and without multistage
production, and it compares them to estimates from the true data. Our discussion of heterogeneous coefficient bias
here uses only data from the simulated multistage model. Thus, we are quantifying pure econometric bias, rather than
comparing multistage to non-multistage models.

                                                           23
log trade costs are: ln  i j = ln  j +  (m) ln d i j . Thus, the reduced form gravity distance elasticity
equals   (m), where we treat  (m) as a fundamental constant from the model. In our model,
regression estimates of the distance elasticity thus inherit the behavior of     ^OLS . Further, the non-
monotone behavior of     ^OLS means that one ought to interpret historical and prospective declines in
trade costs somewhat differently. Our results suggest that the distance puzzle in historical data is
indeed a puzzle: our model predicts that historical declines in trade costs (from previously higher
levels to their current estimated level) would tend to drive the distance elasticity toward zero,
which is not what one sees in data. On the flip side, as trade costs continue to decline from their
current levels, our model suggests that the distance elasticity ought to start rising again, reflecting
the fundamental role of fragmentation in leading to geographic concentration in trade. Thus, for
prospective (rather than historical) declines in trade costs, the model generates a "distance puzzle"
because the level of trade costs have fallen. Broadly, all these results suggestion that significant
caution is warranted in interpreting gravity regression estimates as evidence for/against changes in
the elasticity of trade costs to frictions.


3.2    World Trade Elasticity
We now turn to the elasticity of trade at the global level. To focus our discussion, we study how
the ratio manufacturing trade to manufacturing GDP changes with the level of trade costs. This
intentionally mimics the influential analysis of the role of multistage production in explaining the
rise of world trade by Yi (2003). In a nutshell, Yi argued that multistage models magnify the
response of aggregate trade to declines in trade costs, due to the fact that declines in trade costs
trigger fragmentation of production stages across countries. Thus, he argues the multistage model
plays an important role in explaining the large, non-linear rise in trade relative to GDP as trade
costs gradually declined in the second half of the twentieth century. This point (in our view) has
become "conventional wisdom" in the trade literature, so we revisit it here.
    To assess the role of multistage production, we need to compare the response of trade in our
model to benchmarks that shut down the multistage mechanism. We consider two reasonable
benchmarks. The first benchmark is a restricted version of our own model, in which we shut down
the ability of agents to reallocate stages across countries (from the estimated baseline equilibrium)
as trade costs change. Put differently, it is our model with stage locations locked in place where
they are initially located in the baseline equilibrium.
    The second benchmark we use is an alternative model: the multi-sector Eaton-Kortum model
with an input-output structure, as articulated by Caliendo and Parro (2015) (henceforth, we refer to
this as the "EK-CP model"). We parameterize the initial equilibrium in this model so that it exactly
matches simulated data on bilateral trade shares, income, sector-level production and expenditure,


                                                   24
and sector-level input cost shares from our multistage model. We set the Fréchet technology shape
parameters in the manufacturing to 4.26, based on the OLS gravity regression in simulated data
from the multistage model.32 Following Dekle et al. (2008), we compute exact changes in the
model's endogenous variables for different levels of trade costs. Additional specification, calibra-
tion, and solution details are discussed in Appendix B.
    In Figure 10, we plot the ratio of manufacturing exports to manufacturing GDP against the level
of trade costs in counterfactual equilibria (as in previous sections) for the three models. Like Yi
(2003), our multistage model yields a non-linear increase in the ratio in response to linear declines
in trade cost ­ i.e., the curve is convex, such that marginal changes in trade costs have larger
impacts on the trade to GDP ratio as the level of trade costs falls. However, the two alternative
benchmark models also yield the same non-linearity in trade. Reorganization of GVC production
staging does magnify the response of trade somewhat, as evidenced by the gap between the fixed
stage location and full model simulations. This gap is relatively small, though. Furthermore, the
EK-CP model actually yields larger increases in trade relative to GDP than does the multistage
model as trade costs decline, though again the gap is not particularly large. Thus, we conclude
that multistage production does not substantially magnify the response of trade to declines in trade
costs.
    This result prima facie contradicts the major quantitative takeaway from Yi (2003), and thus
begs for explanation. Our explanation of this apparent contradiction boils down the observation
that "the benchmark model matters." In particular, we compare the response of trade in our multi-
stage model to two models that include input trade, with different microeconomic forces governing
input use and trade. In contrast, Yi (2003) compares a multistage model to a single-stage model
without input trade. This distinction is important. In a model without input trade, there is no scope
for double counting in gross trade data, because goods (at most) cross borders once en route from
source to destination. In contrast, models with input trade ­ either the multistage model or the EK-
CP model ­ allow for goods to cross borders multiple times as they move through the production
process, which inflates the value of gross trade relative to GDP in the model.
    One way to read the results in Yi (2003) is that they point out that the double counting generated
by input trade is important in explaining trade growth. That is, the multistage model in Yi (2003)
generates larger increases in trade relative to GDP than the single-stage model (without input trade)
precisely because it generates double counting in trade. While we agree on this point, it does not
follow that multistage production itself ­ as opposed to other ways of modeling input trade (e.g.,
roundabout production) ­ is essential for explaining increases in trade relative to GDP. In our
analysis, we compare our multistage model to two models that both allow for double counting,
and thus they all generate inflated values for gross trade relative to GDP as trade costs fall. The
  32 The   Fréchet shape parameter is 4.12 for the non-manufacturing sector, identical to our calibration in Section 2.

                                                           25
punchline then is that input trade, not multistage production per se, magnifies the growth of trade
in response to declining trade costs.


4    Conclusion
Despite substantial academic and policy interest in the rise of global value chains, few quantitative
models incorporate multistage value chains. In contrast, this paper puts the decision to collocate
or fragment production stages at center stage. This allows us to quantify the role of technology
and trade costs in driving fragmentation and the role of value chain structure in shaping trade
elasticities.
    We found that there are sizable differences in upstream versus downstream comparative advan-
tage across countries, and that these are an important driver of the final versus input composition
of exports. We also found that the response of value chain structure to frictions plays an important
role in determining the endogenous bilateral elasticity of input trade. As trade costs decline, the
input trade elasticity rises, leading the bilateral trade elasticity to increase as well. Nonetheless,
the multistage model generates aggregate world trade elasticities that are quantitatively similar to
more standard Ricardian models with input trade.
    Digging beneath these aggregate results, global value chains play an interesting conceptual
role in explaining how trade costs map into trade flows. Changes in trade frictions induce value
chain re-organization, leading to the growth of more complex export platform sourcing strategies.
This points to a broader message: multistage models generate a variety of predictions regarding
the micro-structure of value chains that have yet to be explored fully. We expect that combining
the type of model we have written down here with micro-data on value chain structure would be a
fruitful path for future empirical work.




                                                 26
References
Anderson, James E. and Eric van Wincoop, "Trade Costs," Journal of Economic Literature,
 2004, XLII, 691­751.

Antràs, Pol and Alonso de Gortari, "On the Geography of Global Value Chains," 2016. Unpub-
 lished Manuscript, Harvard University.

Arkolakis, Costas and Anath Ramanarayanan, "Vertical Specialization and International Busi-
  ness Cycle Synchronization," Scandinavian Journal of Economics, 2009, 111 (4), 655­680.

Baldwin, Richard and Anthony Venables, "Spiders and Snakes: Offshoring and Agglomeration
  in the Global Economy," Journal of International Economics, 2013, 90 (2), 245­254.

Bridgman, Benjamin, "Energy Prices and the Expansion of World Trade," Review of Economic
  Dynamics, 2008, 11, 904­916.

  , "The Rise of Vertical Specialization," Journal of International Economics, 2012, 86, 133­140.

Caliendo, Lorenzo and Fernando Parro, "Estimates of the Trade and Welfare Effects of
  NAFTA," Review of Economic Studies, 2015, 82 (1), 1­44.

Card, David, "The Causal Effect of Education on Earnings," in Orley Ashenfelter and David Card,
  eds., Handbook of Labor Economics, Vol. 3, Elsevier Science B.V., 1999, chapter 30, pp. 1801­
  1863.

Costinot, Arnaud, Jonathan Vogel, and Sue Wang, "An Elementary Theory of Global Supply
  Chains," Review of Economic Studies, 2013, 80 (1), 109­144.

de Gortari, Alonso, "Disentangling Global Value Chains," 2019.         Unpublished Manuscript,
  Princeton University.

Dekle, Robert, Jonathan Eaton, and Samuel Kortum, "Global Rebalancing with Gravity: Mea-
  suring the Burden of Adjustment," IMF Staff Papers, 2008, 55 (3), 511­540.

Disdier, Anne-Celia and Keith Head, "The Puzzling Persistence of the Distance Effect on Bilat-
  eral Trade," The Review of Economics and Statistics, 2008, 90 (1), 37­48.

Dixit, Avinash K. and Gene M. Grossman, "Trade and Protection with Multistage Production,"
  Review of Economic Studies, 1982, 49 (2), 583­594.




                                               27
Dornbusch, Rudiger, Stanley Fischer, and Paul A. Samuelson, "Comparative Advantage, Trade,
  and Payments in a Ricardian Model with a Continuum of Goods," The American Economic
  Review, 1977, 67 (5), 823­839.

Eaton, Jonathan and Samuel Kortum, "Technology, Geography, and Trade," Econometrica,
  2002, 70 (5), 1741­1779.

Fally, Thibault and Russell Hillberry, "A Coasian Model of International Production Chains,"
  Journal of International Economics, 2018, 114, 299­315.

Head, Keith and John Ries, "Increasing Returns versus National Product Differentiation as an
 Explanation for the Pattern of U.S.-Canada Trade," The American Economic Review, 2001, 91
 (4), 858­876.

   and Thierry Mayer, "Gravity Equations: Workhorse, Toolkit, and Cookbook," in Gita
  Gopinath, Elhanan Helpman, and Kenneth Rogoff, eds., Handbook of International Economics,
  Vol. 4, Elsevier B.V., 2014, chapter 3, pp. 131­195.

Irarrazabal, Alfonso, Andreas Moxnes, and Luca David Opromolla, "The Tip of the Iceberg:
  A Quantitative Framework for Estimating Trade Costs," Review of Economics and Statistics,
  2015, 97 (4), 777­792.

Jacks, David S., Christopher Meissner, and Denis Novy, "Trade Booms, Trade Busts, and Trade
  Costs," Journal of International Economics, 2011, 83, 185­201.

Johnson, Robert C. and Guillermo Noguera, "A Portrait of Trade in Value Added over Four
  Decades," The Review of Economics and Statistics, December 2017, 99 (5), 896­911.

Markusen, James R. and Anthony J. Venables, "Interacting Factor Endowments and Trade
 Costs: A Multi-Country, Multi-Good Approach to Trade Theory," Journal of International Eco-
 nomics, 2007, 73 (2), 333­354.

McFadden, Daniel, "A Method of Simulated Moments for Estimation of Discrete Response Mod-
 els without Numerical Integration," Econometrica, 1989, 57, 995­1026.

Sanyal, Kalyan K., "Vertical Specialization in a Ricardian Model with a Continuum of Stages of
  Production," Economica, 1983, 50 (197), 71­78.

Simonovska, Ina and Michael Waugh, "The Elasticity of Trade: Estimates and Evidence," Jour-
  nal of International Economics, 2014, 92 (1), 34­50.



                                             28
Train, Kenneth, Discrete Choice Methods with Simulation, second ed., New York: Cambridge
  University Press, 2009.

Yi, Kei-Mu, "Can Vertical Specialization Explain the Growth of World Trade?," Journal of Politi-
  cal Economy, 2003, 111, 52­102.

  , "Can Multistage Production Explain the Home Bias in Trade?," The American Economic Re-
  view, 2010, 100 (1), 364­393.




                                              29
                                      Table 1: Estimated Manufacturing Technology

                                                                                                                   Stage2
                                                      Abbreviation               Stage 1        Stage 2            Stage1
                      Rest of World                      RoW                      2.61           1.94               0.74
                      Chile                              CHL                      1.28           1.13               0.88
                      South Africa                       ZAF                      1.55           1.49               0.96
                      Argentina                          ARG                      1.00           1.00               1.00
                      United States                      USA                      3.49           3.66               1.05
                      Australia                          AUS                      2.22           2.40               1.08
                      Belgium                            BEL                      2.24           2.50               1.12
                      Canada                             CAN                      2.01           2.28               1.14
                      Japan                              JPN                      2.77           3.46               1.25
                      Romania                            ROM                      0.65           0.93               1.42
                      France                             FRA                      2.25           3.23               1.43
                      China                              CHN                      1.20           1.74               1.45
                      Germany                            DEU                      2.19           3.34               1.53
                      Brazil                             BRA                      1.24           1.92               1.55
                      Netherlands                        NLD                      1.55           2.43               1.57
                      Switzerland                        CHE                      1.78           2.81               1.58
                      Spain                              ESP                      1.82           2.91               1.60
                      Israel                              ISR                     1.19           1.94               1.62
                      Sweden                             SWE                      1.75           3.02               1.72
                      South Korea                        KOR                      1.69           2.93               1.73
                      Finland                            FIN                      1.57           2.76               1.76
                      Norway                             NOR                      1.48           2.66               1.80
                      Italy                               ITA                     2.00           3.62               1.81
                      Denmark                            DNK                      1.41           2.70               1.91
                      Hungary                            HUN                      0.94           1.80               1.91
                      Poland                             POL                      0.95           1.85               1.95
                      Austria                            AUT                      1.44           2.89               2.01
                      United Kingdom                     GBR                      1.33           2.69               2.03
                      Mexico                             MEX                      1.07           2.30               2.14
                      New Zealand                        NZL                      1.18           2.53               2.14
                      Indonesia                          IDN                      0.63           1.35               2.14
                      Ireland                            IRL                      1.46           3.19               2.18
                      Portugal                           PRT                      1.06           2.35               2.23
                      Thailand                           THA                      0.73           1.66               2.26
                      Turkey                             TUR                      1.01           2.63               2.61
                      India                              IND                      0.53           1.50               2.81
                      Greece                             GRC                      0.72           2.28               3.14
                      Vietnam                           VNM                       0.23           1.06               4.56
Note: Columns labeled Stage 1 and Stage 2 report the geometric mean of the Fréchet distribution for each manufacturing stage, relative to the
geometric mean of the Argentina's distribution. Relative productivity (Stage 2/Stage 1) measures comparative advantage across stages relative to
Argentina's comparative advantage. Countries are ordered by relative stage 2 productivity (last column).



                                                                       30
                  Figure 1: Distribution of Estimated Bilateral Iceberg Trade Costs for Manufacturing


                                          150




                                          100
                              Frequency




                                           50




                                            0
                                                0   1       2   3      4   5     6   7    8   9        10 11 12 13 14 15 16

                                                                                                                                     (m)
Note: Histogram displays the distribution of estimated values for bilateral manufacturing trade costs:  i j (m) =  j d i j , where d i j is bilateral
              j                                                                                             i j
distance and  is an importer-specific level. The point estimate for  (m) is 0.25. The median value of  (m) is 4.49 and the mean is 4.85.




                                          Figure 2: Manufacturing Trade Shares in Model and Data
                                          (a) Final Goods                                                                      (b) Inputs

           1                                                                                            1



          0.1                                                                                          0.1



          0.01                                                                                         0.01
 Model




                                                                                              Model




         0.001                                                                                        0.001



         0.0001                                                                                       0.0001



         1e-05                                                                                        1e-05



         1e-06                                                                                        1e-06
             1e-06    1e-05          0.0001         0.001       0.01       0.1       1                    1e-06   1e-05   0.0001   0.001    0.01   0.1   1
                                                    Data                                                                           Data


Note: Fitted trade shares from the estimated model are on the y-axis, and target shares from data are on the x-axis. Axes are log scale, because the
objective function minimizes log differences in trade shares in model versus data. Dashed line represents 45-degree line,




                                                                                         31
                  Figure 3: Comparative Advantage across Stages and Export Composition

                                                            0.8
                                                                                                                        VNM

                                                            0.7
                             Final Goods Share of Exports




                                                                                        CHN
                                                            0.6
                                                                                                DNK      TUR
                                                                                                   MEX
                                                                                                   NZL
                                                                                                     THA
                                                                                           ESP      IRL
                                                            0.5                         FRA
                                                                                          DEU ITA
                                                                                        ROM          PRT      GRC
                                                                                                HUN
                                                                                                  GBR
                                                                                     JPN NLD
                                                                                           CHE
                                                                                             SWEPOL
                                                                                             KOR IDN       IND
                                                                                  CAN
                                                                                  BEL             AUT
                                                                                USA       BRA
                                                            0.4     RoW          AUS         FIN
                                                                            ARG            ISRNOR
                                                            0.3

                                                                           ZAF
                                                            0.2           CHL


                                                            0.1
                                                               -2   -1      0       1     2        3   4      5     6         7


Note: The y-axis reports the share of final goods in manufacturing exports in the data. The x-axis reports the log difference between estimated
stage 2 and stage 1 Fréchet location parameters for manufacturing in the multistage model: ln T2i (m) - ln T1i (m).




                                                                                              32
                      Figure 4: Quantifying the Role of Stage Comparative Advantage in Export Composition
                                                                                                                           (b) Counterfactual Export Composition without Stage Compar-
                              (a) Export Composition in Data and Model                                                     ative Advantage

                     0.8                                                                                                        0.7


                     0.7                                                                                        VNM                                              RoW
                                                                                                                                0.6
                                                                                                                                                                   USA
                                                                IND
                     0.6                                      BRA GBR THA                                                                                                   JPN            CHN
                                                                              TUR                                               0.5                                           DEU
                                                                 KOR ITA
                                                                IDN    IRL      CHN                                                                                   BRA
                                                              USA DEU MEX                                                                                                   ITA
                                                                  JPN                                                                                                     GBR
    Simulated Data




                     0.5                                                                                                                                                KOR
                                                                                                                                                                          NLDFRA
                                                               AUT
                                                                 SWE    ESP  DNK                                                                                               ESP
                                                                   NLDGRC                                                       0.4
                                                                           NZL
                                                                      FRA
                                                                    PRT                                                                                             SWE IRL
                                                                                                                                                                   IND
                                                                                                                                                              AUS IDN
                     0.4
                                                        NOR FIN POL
                                                            RoW CHE HUN                                                                                              CHE THA DNK
                                                                                                                                0.3                              AUT          TUR
                                                                                                                                                                            MEX
                     0.3                                        AUS                                                                           ZAF
                                                                      CAN                                                                                 NOR FIN CAN
                                                                                                                                        CHL                       BEL
                                                                                                                                                                    POLHUN NZL
                                                        ISR                                                                     0.2                                    PRT
                     0.2                   ZAF
                                                                                                                                                          ISR
                                                                     BEL                                                        0.1
                     0.1             CHL
                                                                                                                                                                              ROM
                                                                                ROM                                                                                            GRC
                                                            ARG                                                                                            ARG                                         VNM
                       0                                                                                                         0
                        0.1      0.2             0.3           0.4          0.5           0.6         0.7         0.8             0.1   0.2         0.3         0.4          0.5     0.6         0.7    0.8
                                                                     Data                                                                                             Data


(c) Change in Export Composition due to Elimination of Stage
Comparative Advantage

                     0.3
                                RoW
                     0.2

                     0.1               CHL   BEL
                                         ZAF
                                            AUS
                                           USA
                       0                  ARG JPNROM
                                                 FRA
                                             CAN   DEU
                                                  CHN
                                                    NLD
                                                    CHE
                                                    ESP
                     -0.1                            ISRITA
                                                   BRA FIN
                                                       SWE
                                                       KOR
                                                        NOR
                                                          HUN
                                                            GBR
                                                          POL
                                                          DNK
                                                            AUT
                     -0.2                                     IRL
                                                             IDN
                                                             NZL
                                                               PRT
                                                             MEX
                                                                     IND
                                                               THA TUR
                     -0.3

                     -0.4                                                                       GRC

                     -0.5

                     -0.6

                     -0.7                                                                                       VNM
                         -2     -1          0           1        2          3         4         5           6         7



Note: In Panel (b), we plot simulated data from the model with counterfactual productivity in manufacturing equalized across stages, set to
~si (m) = T i (m)                1/2                   1/2
T          1                            T2i (m)              for s  1, 2. Panel (c) plots differences between the share of final goods in exports for this counterfactual simulation
and the baseline simulated data against technological comparative advantage in stage 2 production (ln T2i (m) - ln T1i (m)).




                                                                                                                      33
                     Figure 5: Mean Gravity Trade Elasticity for Multistage Manufacturing


                                4.02

                                  4

                                3.98

                                3.96

                                3.94
                         Mean




                                3.92

                                 3.9

                                3.88

                                3.86

                                3.84

                                3.82
                                       3    3.5         4        4.5         5         5.5        6         6.5         7
                                                                         Mean
Note: Figure reports the simple mean (with 95% confidence interval) of the bilateral gravity elasticities  i j , defined in Equation (23), for equilibria
of the multistage model with different levels of trade costs. The mean level of trade costs in each equilibrium is on the x-axis. Vertical dashed line
indicates baseline equilibrium with estimated trade costs.



                       Figure 6: Mean Gravity Trade Elasticity for Final Goods vs. Inputs


                                4.15
                                                                                                      Inputs
                                                                                                      Final goods
                                 4.1




                                4.05
                         Mean




                                  4




                                3.95




                                 3.9
                                       3    3.5         4        4.5         5         5.5        6         6.5         7
                                                                         Mean
Note: Figure reports the simple mean of the bilateral gravity elasticities  i j computed for final goods and inputs separately. The mean level of
trade costs in each equilibrium is on the x-axis. Vertical dashed line indicates baseline equilibrium with estimated trade costs.




                                                                          34
                           Figure 7: Decomposition of Stage 1 Exports by Destination Use


                                                      0.8
                                                                            Absorbed in Destination
                                                      0.7                   Platform Exports
                                                                            Roundtrip Exports
                                                      0.6
                             Share of Stage 1 Trade



                                                      0.5


                                                      0.4


                                                      0.3


                                                      0.2


                                                      0.1


                                                          0
                                                              3           3.5          4             4.5          5   5.5         6         6.5         7


Note: "Absorbed in destination" is the share of bilateral stage 1 exports that are embodied in stage 2 goods absorbed in the destination. "Platform
exports" is the share of bilateral stage 1 exports that are embodied in stage 2 goods that are exported to third destinations. "Roundtrip exports" is
the share of bilateral stage 1 exports that are embodied in stage 2 goods that are exported back to the stage 1 source. The mean level of trade costs
in each equilibrium is on the x-axis.



     Figure 8: Decomposition of Stage 1 Exports by Destination Use and Bilateral Trade Costs
                              (a) High Trade Costs                                                                                            (b) Low Trade Costs

        8                                                                                                                   8

        7                                                                                                                   7

        6                                                                                                                   6

        5                                                                                                                   5

        4                                                                                                                   4

        3                                                                                                                   3

        2                                                                                                                   2

        1                                                                                                                   1

        0            Absorbed in Destination                                                                                0         Absorbed in Destination
                     Platform + Roundtrip Exports                                                                                     Platform + Roundtrip Exports
        -1                                                                                                              -1
         0.2   0.4   0.6   0.8                        1       1.2   1.4    1.6   1.8       2   2.2    2.4   2.6          0.2    0.4   0.6   0.8   1   1.2   1.4   1.6   1.8   2   2.2   2.4   2.6



Note: Each point in the figure represents the mean trade cost and log value of stage 1 exports broken down by destination use for country pairs
in a given quintile of the distribution of bilateral trade costs. Formally, for quintile q the data on the y-axis are: (i) Absorbed in Destination =
             ij                                                              ij
ln(i jq EX1 (m, j)), and (ii) Platform + Roundtrip Exports = ln(i jq EX1 (m, k = j)). On the x-axis, we record the log of mean trade costs within
                                 1        i j
                         ¯ (q) = Q i jq  , where Q here represents the number of observations in quintile q (1/5 the sample size). The left figure
each quintile, given by 
is for data from an equilibrium with "high trade costs" (mean  near 6.5) and the right reports results from an equilibrium with "low trade costs"
(mean tau near 3.5).



                                                                                                             35
                Figure 9: Bias in Gravity Regression Estimate of Mean Trade Cost Elasticity
                                                                                                        (b) Difference between Gravity Regression Estimate of Trade
    (a) Gravity Regression Estimate of Trade Cost Elasticity                                            Cost Elasticity and Mean Bilateral Elasticity

     4.34                                                                                                    0.5

     4.33                                                                                                   0.48

     4.32
                                                                                                            0.46

     4.31
                                                                                                            0.44
      4.3
                                                                                                            0.42
     4.29
                                                                                                             0.4
     4.28
                                                                                                            0.38
     4.27

                                                                                                            0.36
     4.26

     4.25                                                                                                   0.34

     4.24                                                                                                   0.32
            3   3.5       4                            4.5        5         5.5       6   6.5   7                  3   3.5   4     4.5       5   5.5   6   6.5   7
                                                                Mean                                                                     Mean

Note: Panel (a) plots estimates of     ^OLS from Equation 25 in simulated data. Panel (b) plots the difference between ^OLS and the mean bilateral
elasticity (¯ i j ) in simulated data. The mean level of trade costs in each equilibrium is on the x-axis. Vertical dashed line indicates baseline
equilibrium with estimated trade costs.




                                  Figure 10: Ratio of Manufacturing Trade to GDP for the World


                                                      0.7
                                                                                                        Multistage model
                                                     0.65
                                                                                                        Multistage model
                                                      0.6                                               with fixed stage locations
                         World export to GDP ratio




                                                                                                        EK-CP Ricardian model
                                                     0.55

                                                      0.5

                                                     0.45

                                                      0.4

                                                     0.35

                                                      0.3

                                                     0.25

                                                      0.2
                                                            3         3.5         4       4.5       5      5.5         6     6.5         7
                                                                                                Mean
Note: World export to GDP ratio is the ratio of world manufacturing trade to world manufacturing GDP. The ratio is reported for the multistage
model, the multistage model with fixed stage locations (no re-optimization of stage locations from baseline equilibrium), and a Ricardian model
with input-output linkages (EK-CP model). The mean level of trade costs in each equilibrium is on the x-axis. Vertical dashed line indicates baseline
equilibrium with estimated trade costs.




                                                                                                36
A      Solving the Model
In this appendix, we provide details concerning the algorithms we use to solve the model.
      Picking up on the discussion in Section 1.4, we solve a discrete approximation to the model
with a continuum of manufacturing goods, using a smoothing technique borrowed from the discrete
choice literature in the process. We proceed here assuming that we know the model parameters
{i ,  (s),  , T i (n), Tsi (m),  ,  i j (m),  i j (n)}, have realized productivity draws {Tsi (r, m)} for r =
1, . . . , R in hand, and data on exogenous factor endowments and trade balances {Li , T Bi }.
      For a given an initial value for the vector of wages {wi }, we solve for the optimal assignment of
stages to countries and hence prices of manufactured goods { p           ~k
                                                                          2 (r, m)}. One complication in doing
so is that the composite input price PX         i is a function of these prices, and simultaneously the cost

of producing manufactured goods depends on PX              i itself. In addition, Pi is also a function Pi (n),
                                                                                     X
which depends on production costs in the non-manufacturing sector and PX                i due to the input loop.

In the end, this problem has a fixed point structure.
      Starting with a guess for the vector of composite input prices {P          Xi }, we calculate the the opti-

mized stage 1 input price that would prevail in each country j if it were to produce stage 2 output:

                                                                                     1- (m)    X      (m)
                j                                                               wi             P i
              ~1 (r, m) = min  i j (m) pi
              p                         1 (r, m),   with         pi
                                                                  1 (r, m) =                                .
                           i                                                          T1i (r, m)
Then we compute the optimized price at which country k purchases stage 2 goods, given decisions
optimized decisions at stage 1:


                                                                                1- (m)        j           (m)
                                                                           wj                ~1 (r, m)
                                                                                             p
                                     j                       j
          ~k
          p                jk
            2 (r, m) = min  (m) p2 (r, m) ,      with    p2 (r, m) =                     j
                                                                                                                .
                         j                                                            T2 (r, m)

              ~k
This yields { p                          i
               2 (r, m)}, assuming that PX is the composite input price, and tracing backwards the
optimal location of stage 2 and stage 1 production for serving each destination k.
                                                       1
    With these prices, we construct Pi (m) = exp R              ~k
                                                         r log( p2 (r, m)) , and use Equation (16) to
compute Pi (n). With these, we construct an updated value for the composite input price: P      ¨X
                                                                                                 i =

Pi (m) Pi (n)1- . We iterate on these steps until P ¨X
                                                     i =P Xi.

    Having converged on a value for PX    i , we can easily compute the solution for all equilibrium

prices, as well as the allocation of stages to countries for manufactured goods. The next step is to




                                                        37
compute equilibrium quantities. Total demand for the sector-level composite goods is given by:

                                 Pk (m)Qk (m) = k PF
                                                   k k     k k
                                                     F +  PX X
                           Pk (n)Qk (n) = (1 - k )PF
                                                   k k           k k
                                                     F + (1 -  )PX X .

Since we have taken the wage as given and treat the trade balance as an exogenous parameter, we
can compute final demand as PF  k F k = wk Lk - T Bi . We cannot immediately compute expenditure

on the composite input, because we do not yet know X k . However, we can solve for it as follows.
                   k , we can compute Pk (m)Qk (m) andPk (n)Qk (n). Demand for stage 2 goods in
Given a guess for X
manufacturing in destination k is then:

                                                       1 k        k
                                         k             R P (m)Q (m)
                                        ~ (r, m) =
                                        q                           .
                                                          ~k
                                                          p2 (r, m)

Tracing these demands back to the countries that supply those goods, the quantity of stage 2 goods
produced in each source j is:
                                                                              jk
                           j                 jk        k             e- p2 (r,m)/
                          q2 (r, m) =             (m)q
                                                     ~ (r, m)                      jk       .
                                        k                           k e- p2 (r,m)/

Given this stage 2 production in country j, demand for stage 1 inputs in country j is:

                                                            j         j
                                   j                 (s) p2 (r, m)q2 (r, m)
                                  x1 (r, m) =                   j
                                                                                        .
                                                            ~1 (r, m)
                                                            p

These input demands allow us to then solve for the quantity of each stage 1 good supplied by
country i as:
                                                         ij
                        i            ij    j         e- p1 (r,m)/
                       q1 (r, m) =   (m)x1 (r, m)           kj      .
                                   j                k e- p1 (r,m)/
Finally, we can compute an updated value for demand for the composite input:


                ¨i = 1
                X             (m) pi1(r, m)qi1(r, m) +  (n)   i j (n)P j (n)Q j (n)             ,
                      i
                     PX      r                                            j

                                                                                             ¨i = X
where  i j (n) is computed as in Equation (15). We iterate on this fixed point problem until X     i.
Upon convergence, we have the entire equilibrium for a given wage vector.
   Lastly, we need to check whether the wage vector clears the labor market. We can calculate




                                                           38
labor demand as:
                              1
                i
               LD (w) =           l i (z, n)dz +  l1
                                                   i           i
                                                     (r, m) + l2 (r, m)
                          0                    r
                        1
                      = i (1 -  (n))   i j (n)P j (n)Q j (n)
                       w             j
                                   1
                              +      i
                                       (1 -  (m))  pi         i           i         i
                                                    1 (r, m) q1 (r, m) + p2 (r, m) q2 (r, m)
                                   w              r

                                                                           i (w) = Li for i =
The equilibrium wage vector then sets labor demand equal to labor supply: LD
2, .., N (where market 1 is dropped appealing to Walras' law).


B     Ricardian Trade Model with Input-Output Linkages
This appendix describes the benchmark two-sector Ricardian model against which we evaluate the
multistage model. We present the key equilibrium conditions here and refer the reader to Caliendo
and Parro (2015) for details regarding this class of models.
    We define E i (m) and E i (n) to be total spending on final goods plus intermediates goods from
the manufacturing and non-manufacturing sectors. Otherwise, the notation used here matches that
use in the main text, with slight (obvious) modifications in the meaning of variables as necessary.
For example, ci (s) denotes unit costs and Pi (s) denotes an aggregate price level of an aggregate of
sector s goods, but the functional forms are different here than in the main text reflecting differences




                                                        39
between this model and the multistage model. The equilibrium of the model can be written as:

                                                                                       i                 i        (m)
                          ci (m) = (wi )1- (m) Pi (m) (m) Pi (n)1- (m)                                                   (26)
                                                                                                                 (n)
                            ci (n) = (wi )1- (n) Pi (m) (n) Pi (n)1- (n)                                                 (27)
                                                                                                              -1/¯ (m)
                           i                                  j               j            ji   -¯ (m)
                          P (m) =             T                   (m) c (m) (m)                                          (28)
                                                  j
                                                                                                             -1/¯ (n)
                               i                                  j               j        ji   -¯ (n)
                           P (n) =                T                   (n) c (n) (n)                                      (29)
                                                      j
                                                                                                    -¯ (m)
                                        ij          ci (m) i j (m)    i
                                        (m) = T (m)                                                                      (30)
                                                        P j (m)
                                                                                                   -¯ (n)
                                         ij          ci (n) i j (n)       i
                                         (n) = T (n)                                                                     (31)
                                                         P j (n)
                          E i (m) =   i (s) (s) E i (s) + T Bi (s) + i PF
                                                                        i i
                                                                          F                                              (32)
                                              s
                    E i (n) = (1 -  i (s)) (s) E i (s) + T Bi (s) + (1 - i )PF
                                                                             i i
                                                                               F                                         (33)
                                   s
                                                  E i (m) =   i j (m)E j (m)                                             (34)
                                                                              j

                                                      E (n) =   i j (n)E j (n)
                                                          i
                                                                                                                         (35)
                                                                              j
                                                                           i i
                                                                          PF F = wi L i                                  (36)

There are several new parameters here. The parameters { i (m),  (n)} are Cobb-Douglas input
shares, equal to the share of input expenditure that each sector dedicates to inputs from sector m.
The parameter   ¯ (s) is a sector-specific trade elasticity. The parameters  (s) and i are defined as
in the main text. Lastly, note that the equilibrium above features balanced trade, to be consistent
with the balanced trade assumption imposed in simulations of the multistage model.
    Following Dekle et al. (2008), the equilibrium system of equations can be re-written in terms
of changes relative to an initial equilibrium. Defining x   ^ x x , where x is the value of a variable in




                                                                                  40
the new equilibrium and x is the value in the initial equilibrium, the equilibrium in changes is:

                                                                                                                (m)
                                                         ^ i (m) i (m) P
                                             ^ i )1- (m) P
                                   ^i (m) = (w
                                   c                                   ^ i (n)1- i (m)                                           (37)
                                                                                                               (n)
                                                 ^ i )1- (n) P
                                       ^i (n) = (w
                                       c                                 ^ i (n)1- (n)
                                                             ^ i (m) (n) P                                                       (38)
                                                                                                               -1/¯ (m)
                                                                                                     -¯ (m)
                             ^i
                             P (m) =                           ji      ^ (m) c
                                                                    (m)T    j
                                                                             ^ (m) (m)   j   ^ ji                                (39)
                                                  j
                                                                                                              -1/¯ (n)
                                                                                                    -¯ (n)
                                  ^i
                                P (n) =                             ji      ^ (n) c
                                                                         (n)T   j        j
                                                                                  ^ (n) (n)  ^ ji                                (40)
                                                      j
                                                                                                     -¯ (m)
                                                ij   ^ i   ^i (m)
                                                           c       ^ i j (m)
                                              ^
                                               (m) = T (m)                                                                       (41)
                                                               ^ j (m)
                                                               P
                                                                                                    -¯ (n)
                                                                 ^i (n)
                                                         ^ i (n) c
                                                                         ^ i j (n)
                                                  ^ij
                                                   (n) = T                                                                       (42)
                                                                     ^ j (n)
                                                                     P
                                                                                                         i
                  E i (m)E
                         ^ i (m) =   i (s) (s) E i (s)E
                                                      ^ i (s) + T Bi (s)T^B (s) + i PF
                                                                                     i i i i
                                                                                       F PF F                                    (43)
                                          s
                                                                                                     i
        E i (n)E
               ^ i (n) = (1 -  i (s)) (s) E i (s)E
                                                 ^ i (s) + T Bi (s)T^B (s) + (1 - i )PF
                                                                                      i i i i
                                                                                        F PF F                                   (44)
                            s
                                       E i (m)E
                                              ^ i (m) =   i j (m)E j (m)^ i j (m)E
                                                                                 ^ j (m)                                         (45)
                                                                            j

                                         E (n)E (n) =   i j (n)E j (n)
                                              i           ^i          ^ i j (n)E
                                                                               ^ j (n)                                           (46)
                                                                                j
                                                                     i i i i
                                                                    PF F PF F = wi Li w
                                                                                      ^ iL
                                                                                         ^ i.                                    (47)

    In all simulations, we assume that labor input is fixed in all countries L                        ^ i = 1, and changes in
trade costs (   ^ i j (s)) and technology (T          ^ j (s)) are exogenous forcing variables. This leaves 10 + 2N 2
endogenous variables {w            ^ i , PF      ^i (s), P
                                          i F i, c        ^ i (s), E
                                                                   ^ i (s),  i j (s)} and 10 + 2N 2 equations, before choos-
ing a normalization.33
    To solve for these endogenous variables, we need parameters { ,                              ¯ (s),  i (m),  (n),  (s)} and
values for {wi Li , PF    i F i , T Bi , E (s),  i j (s)} in an initial equilibrium. We set these parameters based

on simulated data generated by the multistage model ­ i.e., we treat equilibrium values from our
estimated model as data, which implies that we start simulations from an "observationally equiva-
lent" equilibrium in the multistage model and Ricardian models. We need {PF                               i F i , E i (s),  i j (s)} in

the balanced trade equilibrium of the multistage model, plus values for the structural parameters
{ ,  ¯ (s),  i (m),  (n),  (s)}, to compute changes in equilibrium variables. We now describe the

   33 Note that we treat nominal final expenditure PF  i F i as one variable, hence the wide-hat notation on Pi F i . We do
                                                                                                              F
not need to separate the final price level and real final expenditure to compute the counterfactuals that interest us.

                                                                                    41
details regarding how we obtain values for these parameters.
    Reading values for {PF  i F i , E i (s),  i j (s)} from our simulated data is completely straightforward.

Further, { (s), i } are set to the same values as in the multistage model. The parameter  i (m) for
sector m (the manufacturing sector) is equal to the value of inputs from sector m used by sector m
as a share of total input use by sector m. Denoting the value of stage s output produced by country
i in sector m as yis (m), then total input use by sector m is equal to use of stage 1 inputs by stage
2, which are equal to  (m)yi    2 (m), plus use of the composite input, which is equal to  (m)y1 (m).
                                                                                                        i

Then all stage 1 inputs used by stage 2 in sector m originate from sector m, but only a fraction ( )
of the composite input originates from sector m. This implies that:

                                   i      (m)yi                i
                                              2 (m) +   (m)y1 (m)
                                   (m) =
                                          (m)yi              i
                                                2 (m) +  (m)y1 (m)

The value of this parameter varies across countries to the extent that the mix of stage 1 versus stage
2 output varies across countries. Turning to  (n), sector n uses sector m inputs only embodied in
the composite input, and the composite input itself is the only input in production. Therefore,
 (n) =  from the multistage model.
    Finally, turning to trade elasticities, we obtain ¯ (m) = 4.26 for the manufacturing sector by
regressing simulated sector-level bilateral trade from the multistage model on log bilateral trade
costs, controlling for importer and exporter fixed effects, as in Section 3.1.2. We then set   ¯ (n) =
4.12 for non-manufacturing, which is identical to the multistage model.




                                                     42
