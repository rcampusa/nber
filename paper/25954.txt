                              NBER WORKING PAPER SERIES




          IMPERFECT COMPETITION, COMPENSATING DIFFERENTIALS AND
                  RENT SHARING IN THE U.S. LABOR MARKET

                                        Thibaut Lamadon
                                        Magne Mogstad
                                         Bradley Setzler

                                       Working Paper 25954
                               http://www.nber.org/papers/w25954


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                           June 2019, Revised December 2020




The opinions expressed in this paper are those of the authors alone and do not reflect the views of
the Internal Revenue Service, the U.S. Treasury Department, or the National Bureau of Economic
Research. This work is a component of a larger project on income risk in the United States,
conducted through the SOI Joint Statistical Research Program. We are grateful to Raj Chetty,
Nathan Hendren, Danny Yagan and Owen Zidar for help and guidance in using the IRS data. We
also appreciate the constructive comments and suggestions from Thomas Lemieux, three
anonymous referees, Neele Balke, Stephane Bonhomme, Derek Neal, and discussants and
participants at various conferences and seminars. Mogstad and Setzler acknowledge funding from
NSF Grant SES-1851808, the Washington Center for Equitable Growth, and the Norwegian
Research Council.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Thibaut Lamadon, Magne Mogstad, and Bradley Setzler. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Imperfect Competition, Compensating Differentials and Rent Sharing in the U.S. Labor Market
Thibaut Lamadon, Magne Mogstad, and Bradley Setzler
NBER Working Paper No. 25954
June 2019, Revised December 2020
JEL No. J20,J30,J42

                                         ABSTRACT

We quantify the importance of imperfect competition in the U.S. labor market by estimating the
size of rents earned by American firms and workers from ongoing employment relationships. To
this end, we construct a matched employer-employee panel data set by combining the universe of
U.S. business and worker tax records for the period 2001-2015. Using this panel data, we identify
and estimate an equilibrium model of the labor market with two-sided heterogeneity where
workers view firms as imperfect substitutes because of heterogeneous preferences over non-wage
job characteristics. The model allows us to draw inference about imperfect competition,
compensating differentials and rent sharing. We also use the model to quantify the relevance of
non-wage job characteristics and imperfect competition for inequality and tax policy, to assess
the economic determinants of worker sorting, and to offer a unifying explanation of key empirical
features of the U.S. labor market.

Thibaut Lamadon                                 Bradley Setzler
Department of Economics                         Department of Economics
University of Chicago                           University of Chicago
1126 East 59th Street                           1126 East 59th Street
Chicago, IL 60637                               Chicago, IL 60637
and NBER                                        bradley.setzler@gmail.com
lamadon@uchicago.edu

Magne Mogstad
Department of Economics
University of Chicago
1126 East 59th Street
Chicago, IL 60637
and NBER
magne.mogstad@gmail.com




A data appendix is available at http://www.nber.org/data-appendix/w25954
1    Introduction
How pervasive is imperfect competition in the labor market? Arguably, this question is really
about the size of rents earned by employers and workers from ongoing employment relationships
(Manning, 2011). In the textbook model of a competitive labor market, the law of one price
holds and there should exist a single market compensation for a given quality of a worker, no
matter which employer she works for. If labor markets are imperfectly competitive, however,
the employer or worker or both may also earn rents from an existing employment relationship.
If a worker gets rents, the loss of the current job makes the worker worse off--an identical job
cannot be found at zero cost. If an employer gets rents, the employer will be worse off if a
worker leaves ­ the marginal product is above the wage and worker replacement is costly.
    To draw inference about imperfect competition in the labor market, it therefore seems nat-
ural to measure the size of rents earned by employers and workers. However, these rents are
not directly observed, and recovering them from data has proven difficult for several reasons.
One challenge is that observationally equivalent workers could be paid differentially because of
unobserved skill differences, not imperfect competition (see e.g. Abowd et al., 1999; Gibbons
et al., 2005). Another challenge is that observed wages may not necessarily reflect the full com-
pensation that individuals receive from working in a given firm. Indeed, both survey data (e.g.,
Hamermesh, 1999; Pierce, 2001; Maestas et al., 2018) and experimental studies (e.g., Mas and
Pallais, 2017; Wiswall and Zafar, 2017) suggest that workers may be willing to sacrifice higher
wages for better non-wage job characteristics or amenities when making firm choices. Thus,
firm-specific wage premiums could reflect unfavorable amenities, not imperfect competition.
    The primary goal of our paper is to address these challenges and quantify the importance
of imperfect competition in the U.S. labor market by estimating the size of rents earned by
American firms and workers from ongoing employment relationships. To this end, we construct
a matched employer-employee panel data set by combining the universe of U.S. business and
worker tax records for the period 2001-2015. Using this panel data, we identify and estimate
a model of the labor market that allows us to draw inference about imperfect competition,
compensating differentials and rent sharing. We also use the model to quantify the relevance of
non-wage job characteristics and imperfect competition for inequality and tax policy, to assess
the economic determinants of worker sorting, and to offer a unifying explanation of key empirical
features of the U.S. labor market.
    In Section 2, we develop the equilibrium model of the labor market. This model builds
on work by Rosen (1986), Boal and Ransom (1997), Bhaskar et al. (2002), Manning (2003),
and Card et al. (2018). Competitive labor market theory requires firms to be wage takers so
that labor supply to the individual firm is perfectly elastic. The evidence that idiosyncratic
productivity shocks to a firm transmit to the earnings of its workers is at odds with this theory
(see e.g. Guiso et al., 2005). To allow labor supply to be imperfectly elastic, we let employers
compete with one another for workers who have heterogeneous preferences over amenities. Since
we allow these amenities to be unobserved to the analyst, they can include a wide range of
characteristics, such as distance of the firm from the worker's home, flexibility in the work



                                               1
schedules, the type of tasks performed, the effort required to perform these tasks, the social
environment in the workplace, and so on.1
    The importance of workplace amenities has long been recognized in the theory of compen-
sating differentials (Rosen, 1986). This is a theory of vertical differentiation: some employers
offer better amenities than others. Employers that offer favorable amenities attract labor at
lower than average wages, whereas employers offering unfavorable amenities pay premiums as
offsetting compensation in order to attract labor. Our model combines this vertical differen-
tiation with a horizontal employer differentiation: workers have different preferences over the
same workplace amenities. As a result of this preference heterogeneity, the employer faces an
upward sloping supply curve for labor, implying wages are an increasing function of firm size.
We assume employers do not observe the idiosyncratic taste for amenities of any given worker.
This information asymmetry implies employers cannot price discriminate with respect to work-
ers' reservation values. Instead, if a firm becomes more productive and thus wants to increase
its size, the employer needs to offer higher wages to all workers of a given type. As a result, the
equilibrium allocation of workers to firms creates surplus or rents to inframarginal workers.
    The size of rents depends on the slope of the labor supply curve facing the firm. The
steeper the labor supply curve, the more important amenities are for workers' choices of firms
as compared to wages. Therefore, imperfect competition as measured by rents increases in the
progressivity of labor income taxes and in the variability of the idiosyncratic taste for amenities.
However, the existence of rents does not imply the equilibrium allocation of workers is inefficient.
In our model, the market allocation will be inefficient if the firms differ in wage-setting power,
and, thus, in the ability to mark down wages relative to the marginal product of labor. To allow
for such differences, we let workers view firms as closer substitutes in some markets than others.
This structure on the workers' preferences captures that workplace characteristics are likely to
vary systematically across firms depending on location and industry.
    In Section 3, we describe the business and worker tax records, which provides us with panel
data on the outcomes and characteristics of U.S. firms and workers. The firm data contain
information on revenues and expenditures on intermediate inputs as well as industry codes and
geographical identifiers. We merge the firm data set with worker tax records, creating the
matched employer-employee panel data. The key variables we draw from worker tax returns are
the number of employees and their annual earnings at each employer.
    In Section 4, we demonstrate how the model is identified from the data. To increase our
confidence in the empirical findings from the model, we allow for rich unobserved heterogeneity
across workers with respect to preferences and productivity and between firms in terms of
technology and amenities. Even so, it is possible to prove identification of the parameters of
interest given the panel data of workers and firms. For example, the rents earned by workers
can be measured given data on earnings and the elasticity of the labor supply curve specific to
the firm. These elasticities can be recovered from estimates of the pass-through of firm shocks
   1 There is limited empirical evidence on which non-wage characteristics matter the most. However, survey data

from Maestas et al. (2018) point to the importance of flexibility in work schedules, the type of tasks performed,
and the amount of effort required. The analysis of Marinescu and Rathelot (2018) suggests distance of the firm
from the workers' home may be important.


                                                       2
to incumbent workers' earnings. As another example, the correlation structure in a worker's
taste for amenities can be identified by comparing estimates of the pass-through rates of shocks
specific to the firm versus common to the market. Estimates of worker effects, firm effects and
worker sorting allow us to recover the productivity of workers, the compensating differentials
due to the vertical differentiation of firms, and the extent to which preferences for amenities vary
by worker productivity. To determine whether productive workers and firms are complements,
we take advantage of the estimated interaction coefficients between worker and firm effects
recovered from changes in earnings when workers move between employers.
    The model yields four key findings that we discuss in Section 6. First, there is a significant
amount of rents and imperfect competition in the U.S. labor market due to horizontal employer
differentiation. Workers are, on average, willing to pay 13 percent of their wages to stay in the
current jobs. Comparing these worker rents to those earned by employers suggests that total
rents are divided relatively equally between firms and workers. Second, the evidence of small firm
effects does not imply that labor markets are competitive or that rents are negligible. Instead,
firm effects are small because productive firms tend to have good amenities, which pushes
down the wages that these firms have to pay. As a result of these compensating differentials,
firms contribute much less to earnings inequality than what is predicted by the variance of
firm productivity only. Third, the primary reason why better workers are sorting into better
firms is production complementarities, not heterogeneous tastes for workplace amenities. These
complementarities are key to explain the significant inequality contribution from worker sorting.
Fourth, the monopsonistic labor market creates significant misallocation of workers to firms. We
estimate that a tax reform which would eliminate labor and tax wedges would increase total
welfare by 5 percent and total output by 3 percent.
    The insights from our paper contribute to a large and growing literature on firms and labor
market inequality, reviewed in Card et al. (2018). A number of studies show that trends in
wage dispersion closely track trends in productivity dispersion across industries and workplaces
(Faggio et al., 2010; Dunne et al., 2004; Barth et al., 2016). While this correlation might reflect
that some of the productivity differences across firms spill over to wages, it could also be driven
by changes in the degree to which workers of different quality sort into different firms (see e.g.
Murphy and Topel, 1990; Gibbons and Katz, 1992; Abowd et al., 1999; Gibbons et al., 2005).
To address the sorting issue, a growing body of work has taken advantage of matched employer-
employee data. Some studies use this data to estimate the pass-through of changes in the value
added of a firm to the wages of its workers, while controlling for time-invariant firm and worker
heterogeneity.2 These studies typically report estimates of pass-through rates in the range of
0.05-0.20. We complement this work by providing evidence of the pass-through rates for a broad
   2 See e.g. Guiso et al. (2005), Card et al. (2013), Card et al., 2018, Carlsson et al. (2016), Balke and Lamadon

(2020), and Friedrich et al. (2019). A concern with this approach is that measures of firm productivity may reflect
a number of factors. Some studies have therefore examined the pass-through of specific, observable changes. For
example, Van Reenen (1996) studies how innovation affects firms' profit and workers' wages. He also investigated
patents as a source of variation, but found them to be weakly correlated with profits. Building on this insight,
Kline et al. (2019) studies the incidence of patents that are predicted to be valuable. A related literature has
examined the wage and productivity effects of adoption of new technology in firms (see Akerman et al., 2015,
and the references therein).



                                                        3
set of firms in the U.S. with a variety of empirical approaches, and by showing how the estimated
pass-through of firm and market level shocks can be used to draw inferences about imperfect
competition, rents, and allocative inefficiency.
    Another set of studies use the matched employer-employee data to estimate the additive
worker and firm effects wage model proposed by Abowd et al. (1999).3 We complement this
work by extending the Abowd et al. (1999) model to allow for firm-worker interactions and
time-varying firm effects, relating firm effects to compensating differentials due to the vertical
differentiation of firms, inferring the extent to which preferences for amenities vary by worker
productivity, and clarifying the contribution of firm productivity shocks to earnings inequality.
    Our paper also relates to a literature that tries to measure the role of compensating differ-
entials for wage-setting and earnings inequality. This literature is reviewed in Taber and Vejlin
(2020) and Sorkin (2018). Much of the existing evidence comes from hedonic regressions of
earnings on one or more observable non-wage characteristics of jobs, employers, or industries,
interpreting the regression coefficients as the market prices of those amenities. Typical estimates
of these coefficients are small in magnitude and sometimes of the wrong sign (Bonhomme and
Jolivet, 2009). However, these estimates could be severely biased, either due to correlations be-
tween observed amenities and unobserved firm characteristics or because of assortative matching
(on unobservables) between workers and firms (see e.g. the discussion in Ekeland et al., 2004).
Several recent studies have used panel data in an attempt to address these concerns. Like
us, Taber and Vejlin (2020), Lavetti and Schmutte (2017), and Sorkin (2018) take advantage
of matched longitudinal employer-employee data to allow for unobserved heterogeneity across
firms.
    Our paper differs from the existing literature on compensating differentials in several ways.
One important difference is that amenities, in our model, create both vertical and horizontal
employer differentiation. The latter generates imperfect competition, wage-setting power and
rents; the former acts as standard compensating differentials. By comparison, compensating
differentials have typically been analyzed in models with perfect competition or search frictions
(see e.g. Mortensen, 2003). Our paper also allows for ex-ante worker heterogeneity in produc-
tivity and preferences which generates sorting between firms and workers, in contrast to, for
example, Sorkin (2018). Our estimates suggest that worker heterogeneity and sorting are em-
pirically important features of the U.S. labor market which are necessary to take into account
to understand the determinants of earnings inequality. By taking our model to the data, we are
able to quantify the relative importance of amenities versus production complementarities for
worker sorting and earnings inequality. Lastly, our paper differs in that we move beyond the
impact of amenities on wages and worker sorting, examining also the implications for tax policy
and allocative efficiency. In our model, wages are taxed but the (idiosyncratic taste for) ameni-
   3 Song et al. (2018) and Sorkin (2018) provide estimates using the approach of Abowd et al. (1999) for the

U.S. A recent literature addresses the concern that estimates of firm effects will be biased upward and estimates
of worker sorting will be biased downward when using the approach of Abowd et al. (1999) due to limited worker
mobility across firms. Our main estimates use the bias-correction approach of Bonhomme et al. (2019) while
alternative bias-correction approaches by Andrews et al. (2008) and Kline et al. (2020) are considered in our
Online Supplement. See Bonhomme et al. (2020) for a comparison of bias-correction procedures using data from
various countries.



                                                       4
ties are not. Thus, progressive taxation on labor income may distort the worker's decision of
which firm and market to work in. We analyze, theoretically and empirically, the consequences
of this distortion and how changes in the tax system may help improve the allocation of workers
to firms.4


2     Model of the labor market
This section develops a model of the labor market where employers compete with one another
for workers who have heterogeneous preferences over non-wage job characteristics or amenities.

2.1     Agents, preferences and technology
The economy is composed of a large number of workers indexed by i and a large set of firms
indexed by j = 1, ..., J . Each firm belongs to a market r(j ). Let Jr denote the set of firms
in market r. We will rely on the approximation that firms employ many workers and that
each market has many firms. For tractability, we assume that workers, firms and markets face
exogenous birth-death processes which ensure stationarity in the productivity distributions of
workers, firms and markets.

Worker productivity and preferences

Workers are heterogeneous both in preferences and productivity. Workers are characterized by
a permanent skill Xi . In period t, worker i with skill Xi has the following preferences over
alternative firms j and earnings W :

                               uit (j, W ) = log  W  + log Gj (Xi ) +  -1        ijt


where Gj (X ) denotes the value that workers of quality X are expected to get from the amenities
that firm j offers, and ijt denotes worker i's idiosyncratic taste for the amenities of firm j . The
parameters (, ) describe the tax function that maps wages to income available for consumption.
Subection 5.3 shows that this parsimonious tax function well-approximates the US tax system.
    This specification of preferences allows for the possibility that workers view firms as imperfect
substitutes. Fixing worker quality X , the preference term Gj (X ) gives rise to vertical employer
differentiation: some employers offer good amenities while other employers have bad amenities.
Our preference specification combines this vertical differentiation with horizontal employer dif-
ferentiation: workers are heterogeneous in their preferences over the same firm. This horizontal
differentiation has two distinct sources. The first is that Gj (X ) varies freely across values of
X . Thus, we permit systematic heterogeneity in the preferences for a given firm depending on
the permanent component of worker productivity. The second is the idiosyncratic taste compo-
nent ijt . The importance of this second source of horizontal differentiation is governed by the
    4 Tax theory in the Mirrlees (1971) tradition generally assumes the labor markets are perfectly competitive. A

notable exception is Cahuc and Laroque (2014) who develop a model for optimal taxation under monopsonistic
markets. See also Powell and Shan (2012) and Powell (2012) who argue that marginal tax rates distort the
relative value of amenities to wages. There is also a literature that considers tax design in situations with search
frictions. See Yazici and Sleet (2017) and the references therein.


                                                         5
parameter  , which tells us the variability across workers in the idiosyncratic taste for a given
firm. Formally, this parameter is proportional to the inverse of the standard deviation of ijt in
log-dollars.
    We assume that ( i1t , ..., iJt )  it  ( | it-1 , Xi ) follows a Markov process with indepen-
dent innovations across individuals with the same productivity X . This assumption does not
imply strong restrictions on the copula (and, by extension, the patterns of mobility by worker
quality) over time. We assume, however, that the (cross-sectional) distribution of it has a
nested logit structure in each period:                                              r
                                                                              ijt
                             F(   it )   = exp -                         e-   r      .
                                                       r          j Jr

This structure allows the preferences of a given worker to be correlated across alternatives within
each nest. In the empirical analysis, we specify the nest as the combination of industry and
region, and refer to it as a market. The parameter r measures the degree of independence in a
worker's taste for the alternative firms within market r, i.e. r = 1 - corr( ijt , ij t ) if r(j ) =
r(j ) = r. Thus, r = 0 if each worker views firms within the same market as perfect substitutes,
while r = 1 if the worker views these firms as completely independent alternatives.

Firm productivity and technology

Importantly, we let firms differ not only in workplace amenities but also in terms of productivity
and technology. We start by introducing the total efficiency units of labor at the firm:

                                         Ljt =      X j · Djt (X )dX,


where X j tells us the efficiency of a worker of quality X in firm j . The component Djt (X ) is
the mass of workers with productivity X demanded by the firm.
   The revenues Yjt generated by firm j in period t is determined by the production function
                                                               1-r(j )
                                              Yjt = Ajt Ljt

where Ajt is the firm's productivity (TFP), and 1 - r(j ) is the market-specific returns to scale
that depends on the total efficiency units of labor (reflecting both the quality and quantity of
labor). This specification of the revenue production function abstracts from capital, or equiva-
lently, assumes that capital can be rented at some fixed price. However, the specification does
not require the product market to be competitive. As shown in Online Appendix A.5, it is
possible to derive the same specification of the revenue production function (and, by extension,
labor demand) if firms have price-setting power in the product market.
    It is useful to express the productivity component Ajt as:

                              Ajt                  ~jt = P r(j ) Z r(j )t P
                                         = Ar(j )t A                      ~j Z
                                                                             ~jt


where Ar(j )t , P r(j ) , and Z r(j )t represent the overall, the permanent and the time-varying com-
ponents of productivity that are shared by all firms in market r, while A         ~jt , P
                                                                                        ~j and Z
                                                                                               ~jt de-


                                                           6
note the overall, the permanent and the time-varying components that are specific to firm
j . Let Wjt (X ) denote the wage that firm j offers to workers of quality X in period t and
Bjt = Wjt (X )Djt (X )dX denote the wage bill of the firm, i.e. the total sum of wages paid to
its workers. The profit of the firm is then given by jt = Yjt - Bjt .

2.2     Information, wages and equilibrium
We consider an environment where all labor is hired in a spot market and ijt is private in-
formation to the worker. Hence, the wage may depend on the worker's attributes X , but not
her value of ijt . Given the set of offered wages Wt = {Wjt (X )}j =1,...,J by all firms, worker i
chooses a firm j to maximize her utility uit in each period:

                                          j (i, t)  arg max uit (j, Wjt (Xi )).                                               (1)
                                                          j


We introduce a wage index at the level of the market r defined by:
                                                                    r
                                                                                          
                                                                                          r
                           Irt (X )                   1/ Gj (X )1/ Wj t (X )                                                  (2)
                                             j Jr


from which we can derive the probability that an individual of type X chooses to work at firm
j given all offered wages in the economy:
                                                                                                                
                                                    Ir(j )t (X )           1/           1/     Wjt (X )         r (j )
            P r[j (i, t)=j |Xi =X, Wt ] =                        
                                                                                Gj (X )                                   .
                                                     r Ir t (X )                              Ir(j )t (X )

We consider an equilibrium where the firm views itself as infinitesimal within the market.5 Thus,
given the total mass of workers N and the stationary cross-sectional distributions of X , MX (X ),
employer j considers the following firm-specific labor supply curve when setting wages Wjt (X ):

                                                                                                             
                                      Ir(j )t (X )                      1/             1/       W            r (j )
               Sjt (X, W )  N MX (X )              
                                                                             Gj (X )                                  .
                                       r Ir t (X )                                          Ir(j )t (X )
This means the firm ignores the negligible effect of changing its own wages on the market level
wage index Irt (X ). Then each firm chooses labor demand Djt (X ) by setting wages Wjt (X ) for
each type of worker X to maximize profits subject to labor supply Sjt (X, W ):
                                                                     1-r(j )
              jt =       max        Ajt        X j Djt (X )dX                    -     Wjt (X )Djt (X )dX
                      {Wjt (X )}X

                                    s.t. Djt (X )=Sjt (X, Wjt (X ))              for all t, j, X                              (3)

From this environment, the definition of equilibrium naturally follows:

Definition 1. Given firm characteristics (r(j ) , Ajt , j )j,t , worker distributions N, MX (·), pref-
erence parameters (, r , Gj (·)) and tax parameters (,  ), we define the equilibrium as the
   5 See Berger et al. (2019) for an analysis of strategic interactions in the firms' wage setting. See also Jarosch

et al. (2019), who develop a search framework with large firms.


                                                              7
worker decisions j (i, t), market level wage indices Irt (X ), firm-specific labor supply curves
Sjt (X, W ), wages Wjt (X ) and labor demand Djt (X ) such that:
    i. Workers choose firms that maximize their utility, as defined in equation (1).
   ii. Firms choose labor demand Djt (X ) by setting wages Wjt (X ) for each worker quality X
       to maximize profits subject to the labor supply constraint Sjt (X, W ), as described in
       equation (3).
  iii. The market level wage indices Irt (X ) are generated from the workers' optimal decisions
       j (i, t), as described in equation (2).
In Lemma 2 in Online Appendix A.1, we show the uniqueness of the equilibrium which proves
useful in the estimation of the model and is needed for the counterfactual analysis.

2.3    Sorting in equilibrium
To understand how workers may sort in our model, it is important to restrict the relation-
ship between amenities Gj (X ), permanent productivity components (P r(j ) , P ~j ), and technology
(j , r(j ) ). As a result, our model permits multiple sources of systematic sorting of worker
quality and firm productivity in equilibrium.
    One source of sorting is that we allow workers of different quality X to be differentially
productive across different firms j . In particular, if more productive firms have greater (lower)
 in the production function, the marginal product of high quality workers is relatively high
(low) at more productive firms, so that worker quality and firm productivity are complements
(substitutes) in production. Empirically, we will find evidence that more productive firms have
greater  and, therefore, conclude that worker quality is complementary with firm productivity.
Thus, firms with high productivity offer relatively high wages to workers with high X , which
contributes to a disproportionate employment of high ability workers in productive firms.
    A second source of systematic worker sorting is captured by the amenity term Gj (X ) in
the preference specification. This specification allows the valuation of the amenities of a given
firm to vary freely across worker quality X , and it allows the valuation of amenities for a given
worker quality X to vary freely across firms. Empirically, we will find that productive firms
tend to have better amenities, and that high ability workers tend to value amenities more than
low ability workers. This contributes to a disproportionate employment of high quality workers
in productive firms.
    When assessing the sorting patterns, it is important to observe that our model does not
imply that the most productive firms (either in terms of A or ) hire all workers (in total or of
a given quality X ) in the economy. One reason for this is we find that the labor supply curve is
upward-sloping ( < ), so the marginal cost of labor is increasing in the number of workers.
Another reason is that we find that firms face diminishing returns to scale in labor (1 - r < 1),
which implies that the marginal product of labor is decreasing in the number of workers.

2.4    Structural equations
As shown in Proposition 1 in Online Appendix A.1, our model delivers the following structural
equations for wages, value added and wage bill for firm j  Jr :

                                                8
                                                        1             1
                            ~) = j x + cr - r hj +
                  wj (x, a, a                               a+            a
                                                                          ~                       (4)
                                                    1 + r       1 + r /r
                                                 1 +          1 + /r
                            ~) = (1 - r )hj +
                     yj (a, a                             a+            a
                                                                        ~                         (5)
                                              (1 + r  )      1 + r /r
                                                      1 +          1 + /r
                            ~) = cr + (1 - r )hj +
                     bj (a, a                                 a+            a
                                                                            ~                     (6)
                                                    (1 + r  )    1 + r /r

where we use lower case letters to denote logs (e.g. x  log X ), cr is a market-specific constant
that is equal to log (1-  r )/r
                         1+/r     and hj is the solution to a fixed point equation that involves
all firms' amenity terms (see Lemma 3 in Online Appendix A.1). These equations describe how
the potential outcomes of workers and firms are determined, that is, they tell us the realization
of wj (x), bj , and yj that would have been experienced had worker productivity x, firm TFP a     ~
and market TFP a been exogenously set. Note that these potential outcomes depend on time
implicitly through time variation in firm and market TFP.
    The equations in (4)-(6) show that wj (x, a, a ~), bj (a, a
                                                              ~), and yj (a, a
                                                                             ~) depend on the same
four components: the constant cr , the component of productivity that is specific to the firm a  ~,
the component of productivity that is common to firms in the same market a, and an amenity
component hj . Comparing the wage equation to the other structural equations, we see that
          ~) also depends on the worker's own productivity x. Moreover, workers with the same
wj (x, a, a
productivity are paid differentially depending on the firm-specific parameter j . As expected, if
a firm j becomes more productive (a   ~ or a increase) then yj (a, a
                                                                   ~) increases. Because firm j has
become more productive, it will demand more labor, raising wj (x, a, a    ~) and bj (a, a
                                                                                        ~).
    Combining the structural equations (4)-(6), we also obtain the log efficiency units of labor,
                                                               /r
                           j (a, a
                                 ~)   = hj +             a+          a
                                                                     ~                            (7)
                                               (1 + r  )    1 + r /r

where hj can be interpreted as the efficiency units of labor the firm would have if a
                                                                                    ~ and a were
exogenously set to zero. This "TFP-neutral" notion of the total efficiency of labor depends on
the quality and quantify of the workforce, which can be seen by decomposing hj as,
                                                 
                                hj = log E Xi j(i,t) | j (i, t)=j +g j .

                                                    xj


The component g j is a weighted average of the X -specific amenities of firm j . It captures the
vertical differentiation of firms. All else equal, a greater g j raises the size of the firm, thus
increasing its wage bill and value added. At the same time, better amenities push down the
wages that these firms have to pay their workers, lowering wj (x). The other component of hj is
the average quality of the workers in the firm x
                                               ¯j , reflecting sorting of workers to firms. If Gj (X )
increases by the same rate for each X in a given firm j , then g j increases while xj is unaffected.
Hence, xj captures that some firms may have relatively good amenities for some worker types.
All else equal, better co-workers raise the total labor efficiency of the firm's workforce. With
decreasing return to scale in labor (1 - r(j ) < 1), this also lowers the wages that firm j pays
to a given worker.


                                                    9
    Another important feature of the structural equations (4)-(6) is that they are log additive in
the arguments j x, hj , a, and a
                               ~. This log additivity is useful for several reasons. First, it makes
it straightforward to quantify the relative importance of the determinants of worker and firm
outcomes. Second, it forges a direct link between the structural wage equation and the fixed
effect models discussed in Section 5.4. This link will help interpret the sources of variation in
log earnings through the lens of the model. Third, it makes it possible to prove identification of
the parameters of the model, as shown in Section 4.

2.5    Rents, compensating differentials, and allocative inefficiencies
We conclude the presentation of the model by defining the rents that workers and employers earn
from ongoing employment relationships and explaining how these quantities relate to reservation
wages, compensating differentials, and allocative inefficiencies.

Worker rents

In our model, rents are due to the idiosyncratic taste component ijt that gives rise to horizontal
differentiation of firms, upward sloping labor supply curves, and employer wage-setting power.
We assumed that employers do not observe the idiosyncratic taste for amenities of any given
worker. This information asymmetry implies that firms cannot price-discriminate with respect
to workers' reservation wages. As a result, the equilibrium allocation of workers to firms creates
surpluses or rents for inframarginal workers, defined as the excess return over that required to
change a decision, as in Rosen (1986). In our model, worker rents may exist at both the firm
and the market level:
                                                          w
Result 1. We define the firm level rents of worker i, Rit   , as the surplus she derives from
                                                                                           w
being inframarginal at her current choice of firm. Given her equilibrium choice j (i, t), Rit is
implicitly defined by:
                                                       w
                    uit (j (i, t), Wj (i,t),t (Xi ) - Rit ) = max uit (j , Wj ,t (Xi )).
                                                              j =j (i,t)


As shown in Lemma 4 in Online Appendix A.2, expected worker rents at the firm level are:
                          w                        1
                      E [Rit |j (i, t)=j ] =              E [Wjt (Xi )|j (i, t)=j ] .
                                               1 + /r(j )


                                                            wm
Result 2. We define the market level rents of worker i, Rit    , as the surplus derived from
being inframarginal at her current choice of market. Given her equilibrium choice of market
              wm
r(j (i, t)), Rit is implicitly defined by:
                                                  wm
               uit (j (i, t), Wj (i,t),t (Xi ) - Rit )=          max               uit (j , Wj ,t (Xi )).
                                                          j | r (j )=r (j (i,t))


As shown in Lemma 4 in Online Appendix A.2, expected worker rents at the market level are:
                             wm                       1
                         E [Rit |j (i, t)=j ] =         E [Wjt (Xi )|j (i, t)=j ]
                                                   1 + 


                                                      10
Market level rents exceed firm level rents whenever the next best firm is in the same market
as the current choice of firm. If the preferences of a given worker are independent across firms
within each market, then the next best firm will almost surely be in a different market. If, on
the other hand, these preferences are correlated then there could well exist other firms within
the same market that are close substitutes to the current firm. The next best firm may then be
in the same market as the current choice of firm, in which case Rit  wm
                                                                         will exceed Rit
                                                                                      w
                                                                                         .
    To interpret the measure of firm level rents and link it to compensating differentials, it is
useful to express Rit
                    w
                       in terms of reservation wages. The worker's reservation wage for her current
choice of firm is defined as the lowest wage at which she would be willing to continue working in
this firm. Substituting in preferences in the above definition of Ritw
                                                                       for a worker whose current
firm is j and next best option is j , it follows that:
                                                    w
     log Wj (i,t),t (Xi ) - log Wj (i,t),t (Xi ) - Rit = log Wj (i,t),t (Xi ) -           log Wj   (i,t),t (Xi )

        current wage            reservation wage              current wage           wage at best outside option
                                                1/             1                        1/             1
                                         + log Gj (i,t) (Xi )e     ij (i,t)t
                                                                               - log Gj   (i,t) (Xi )e
                                                                                                           ij (i,t)t



                                                   current amenities             amenities at best outside option


The average worker choosing firm j may be far from the margin of indifference and would
maintain the same choice even if her current firm offered significantly lower wages. The same
holds true for the average worker choosing any other firm. The difference between the reservation
wage and the actual wage is the rent earned by a person at her current choice of firm.

Compensating differentials

By definition, marginal workers are indifferent between the current choice of firm and the next
best option. They earn no rents as their reservation wages equal the actual wages paid by
their current firms. By solving for reservation wages among marginal workers, it becomes clear
that equilibrium wage differentials are informative about the preferences for amenities of these
marginal workers. Another way of saying this is that the equilibrium allocation of workers to
firms is such that utility gains (or losses) of marginal workers due to the amenities of their firms
are exactly offset by wage differentials. Thus, wage differentials across firms for the same worker
define the equalizing or compensating differentials:

Result 3. Consider worker i of type X whose current firm is j and best outside option is j
                                                   w
and who is marginal at the current firm (that is, Rit = 0). The compensating differential
between j and j for a worker of type X is then defined as,

                          CDjj t (X )    = uit (j , Wjt (X )) - uit (j, Wjt (X ))
                                         =    log Wj t (X ) - log Wjt (X )
                                         =    (j - j )x + j t - jt

where the second equality comes the fact that worker i is marginal, and the last equality follows



                                                       11
from equation (4) and defining the firm effect jt as,

                                                1                 1
                         jt  cr - r hj +           ar(j ),t +          a
                                                                       ~jt                        (8)
                                            1 + r             1 + r /r


For any two firms j and j , there exists a distribution of compensating differentials. This
distribution arises because of differences in technology across firms. If j does not vary across
firms, there is only one compensating differential per employer. It is given by the firm effect
jt , which is paid to all workers independent of their productivity.

Employer rents

The equilibrium allocation of workers to firms may also create surpluses or rents for employers.
The employer rents arise because of the additional profit the firm can extract by taking advantage
of its wage-setting power. To measure employer rents, we therefore compare the profit jt the
firm actually earns to what it would have earned if the employer solved the firm's problem under
the assumption that the labor supply it faced was perfectly elastic. In other words, wages, profits
                                  pt                                                     pt
and employment are such that Djt     (X ) solves the firm's profit maximization given Wjt   (X ):
                                                          1-r(j )
         pt
         jt =         max        Ajt          pt
                                       X j · Djt (X )dX             -    pt
                                                                        Djt         pt
                                                                            (X ) · Wjt (X )dX,
                {    pt
                    Djt (X )}X
                           pt        pt
             s.t. Sjt (X, Wjt (X ))=Djt (X ) for all t, j, X

The only difference in the firm's problem in this counterfactual environment is that the firm does
not take into account its wage-setting power through the upward-sloping labor supply curve. In
other words, the firm behaves as if it faces a perfectly elastic labor supply curve, i.e. as if it was
                                                                   ptm        ptm
a "price taker"; thus the superscript pt. Similarly we define Wjt      (X ), Djt  (X ), and ptmjt   as
the equilibrium outcome when all firms in a market act as price takers.
                                                               f                      fm
Result 4. We define the employer rents at the firm level Rjt     and at market level Rjt  as the
additional profit that firm j in market r derives from the presence of inframarginal workers:
                                                                          (1- )
                                                                                   
                                                                             r
                                                                        - r +
                f                    r (r +  )                                r 
               Rjt    = jt -   = 1 -
                                  pt
                                  jt
                                                                                    jt
                                     r + r      r + 
                                                                             (1-r )
                                                                                      
                                                                         -
                                  1 - r (r +  )                               1+r 
               fm                                                                      jt
              Rjt     = jt - ptm
                             jt =
                                       r + r    r + 

where the latter equality in each equation is shown in Lemmas 5 and 6 in Online Appendix A.3.

   To understand how and why employer rents may differ at the firm and the market level,
recall that r measures the degree of independence in a worker's taste for the alternative firms
within market r. If r = 1, the worker views these firms as completely independent alternatives,
and the rents at the firm level equals the rents at the market level. In contrast, if r = 0 then


                                                  12
each worker views firms within the same market as perfect substitutes. In this case, firms do
not get any rents from imperfect competition at either the firm or the market level. For values
of  between 0 and 1, the rents at the market level will strictly exceed the rents at the firm level.
                                             f         fm
      It is important to observe that Rjt       and Rjt    do not necessarily represent ex-ante rents.
Suppose, for example, that each employer initially chooses the amenities offered to the workers
by deciding on the firm's location, the working conditions, or both. Next, the employers compete
with one another for the workers who have heterogeneous preferences over the chosen amenities.
These heterogeneous preferences give rise to wage-setting power which employers can use to
extract additional profits or rents. Of course, the existence of such ex-post rents could simply
be returns to costly choices of amenities.
      Empirically, it is difficult to credibly distinguish between ex-ante and ex-post employer rents.
It would require information (or assumptions) about how firms choose and pay for the amenities
offered to workers. Given our data, we are severely limited in the ability to distinguish between
ex-ante and ex-post rents. Instead, we assume firms are endowed with a fixed set of amenities,
or, more precisely, we restrict amenities to be fixed over the estimation window. It is important
to note what is not restricted under this assumption. First, it does not restrict whether or how
amenities Gj (X ) relate to the technology parameters r(j ) , j or the productivity components
P~j , P r(j ) . Second, it neither imposes nor precludes that employers initially choose amenities to
maximize profits. Indeed, it is straightforward to show that permitting firms to initially choose
amenities would not affect any of our estimates. Nor would it matter for the interpretation of
                                       f        fm
any result other than whether Rjt         and Rjt   should be viewed as ex-ante or ex-post rents.

Wedges and allocative inefficiencies

We conclude the model section by investigating the questions of whether and in what situations
the equilibrium allocation of workers to firms will be inefficient. We here present the key
results, and refer to Online Appendix A.4 for details and derivations. To draw conclusions about
allocative inefficiencies, we compare the allocation and outcomes in the monopsonistic labor
market to those that would arise in a competitive (Walrasian) labor market. By a competitive
market, we mean that there are no taxes ( =  = 1) and that all firms act as price takers, as if
they faced perfectly elastic labor supply curves. This comparison allows us to draw inferences
about allocative inefficiencies within and between markets.
    Within each market, there is a tax wedge that arises because  < 1. It is the only source
of allocative inefficiency, distorting the worker's ranking of firms in favor of those with better
amenities. As a result, firms with better amenities can hire workers at relatively low wages,
and, therefore, get too many workers as compared to the allocation in the competitive labor
market. Between markets, allocative inefficiencies may arise not only because of the tax wedge
but also due to differences in labor wedges across markets. To understand the latter source of
inefficiencies, consider the special case when  = 1,  > 0 and r is non-zero but the same across
all markets. In this case, taxes are proportional but there are still labor wedges and rents in
the economy. However, the labor wedges will be the same across all markets. As a consequence,
the monopsonistic market allocation of workers to firms is identical to the allocation one would


                                                 13
obtain in the competitive equilibrium. A corollary of this result is that tax wedges are the only
source of allocative inefficiencies if one assumes a standard logit structure on the distribution of
 it (as in, for example, Card et al., 2018).
    With the nested logit structure on the distribution of it , allocative inefficiencies across
markets may arise because r can vary across markets, implying that workers may view firms
as closer substitutes in some markets than others. This will create differences across markets in
the wage-setting power of firms, and so in their abilities to mark down wages. Markets facing
an elastic labor supply curve (i.e. low value of r ) will have relatively high wages and, as a
result, attract too many workers compared to the allocation in the competitive equilibrium.
Progressive taxation will amplify any differences in r across markets, leading to an even larger
misallocation of workers to firms.
    To improve the allocation of workers to firms, the government can change the tax system in
two ways. First, a less progressive tax system (i.e. increase ) may reduce the misallocation that
arises from the tax wedge. Second, letting  vary across markets may improve the allocation
of workers by counteracting differences in the wage-setting power of firms. After estimating
the parameters of the model, we perform counterfactuals that quantify the impacts of such tax
reforms on the equilibrium allocation and outcomes, including earnings, output and welfare. In
interpreting these results, it is important to note that we assume firms initially choose amenities
Gj (X ), but do not change Gj (X ) in response to counterfactuals. With better data on, and an
instrument for, amenities, it would be interesting to extend this analysis to allow for firms to
adjust amenities in response to these counterfactuals.


3     Data sources and sample selection
3.1    Data sources
Our empirical analyses are based on a matched employer-employee panel data set with infor-
mation on the characteristics and outcomes of U.S. workers and firms. This data is constructed
by linking U.S. Treasury business tax filings with worker-level filings for the years 2001-2015.
Below, we briefly describe data sources, sample selection, and key variables, while details about
data construction and the definition of each of the variables are given in Online Appendix B.
     Business tax returns include balance sheet and other information from Forms 1120 (C-
corporations), 1120S (S-corporations), and 1065 (partnerships). The key variables that we draw
on from the business tax filings are the firm's employer identification number (EIN) and its value
added, commuting zone, and industry code. Value added is the difference between receipts and
the cost of goods sold. Commuting zone is constructed using the ZIP code of the firm's business
filing address. Industry is defined as the first two digits of the firm's NAICS code. In our
baseline specification, we define a market as the combination of an industry and a commuting
zone, with alternative market definitions provided in sensitivity checks. We will occasionally
aggregate these markets into "broad markets" according to the combination of Census regions
(Midwest, Northeast, South, and West) and broad sectors (Goods and Services).
     Earnings data are based on taxable remuneration for labor services reported on Form W-2


                                                14
for direct employees and on Form 1099 for independent contractors. Earnings include wages and
salaries, bonuses, tips, exercised stock options, and other sources of income deemed taxable by
the IRS. These forms are filed by the firm on behalf of the worker and provide the firm-worker
link. All monetary variables are expressed in 2015 dollars, adjusting for inflation using the CPI.

3.2     Sample selection
In each year, we start with all individuals aged 25-60 who are linked to at least one employer.
Next, we define the worker's firm as the EIN that pays her the greatest direct (W-2) earnings
in that year. This definition of a firm conforms to previous research using the U.S. business tax
records (see, e.g., Song et al., 2018). The EIN defines a corporate unit for tax and accounting
purposes. It is a more aggregated concept than an establishment, which is the level of analysis
considered in recent research on U.S. Census data (see, e.g., Barth et al., 2016), but a less
aggregated concept than a parent corporation. As a robustness check, we investigated the
sensitivity of the estimated firm wage premiums to restricting the sample to EINs that appear
to have a single primary establishment. These are EINs for which the majority of workers live
in the same commuting zone. It is reassuring to find that the estimated firm wage premiums do
not materially change when we use this restricted sample.
    Since we do not observe hours worked or a direct measure of full-time employment, we
follow the literature by including only workers for whom annual earnings are above a minimum
threshold (see, e.g., Song et al., 2018). In the baseline specification, this threshold is equal
to $15,000 per year (in 2015 dollars), which is approximately what people would earn if they
worked full-time at the federal minimum wage. As a robustness check presented in our Online
Supplement, we investigate the sensitivity of our results to other choices of a minimum earnings
threshold.6 We further restrict the sample to firms with non-missing value added, commuting
zone, and industry. The full sample includes 447.5 (39.2) million annual observations on 89.6
(6.5) million unique workers (firms).
    In parts of the analysis, we consider two distinct subsamples. The first subsample, which
we refer to as the stayers sample, restricts the full sample to workers observed with the same
employer for eight consecutive years. This restriction is needed to allow for a flexible specification
of how the worker's earnings evolve over time. Specifically, we omit the first and last years
of these spells (to avoid concerns over workers exiting and entering employment during the
year, confounding the measure of annual earnings) and analyze the remaining six-year spells.
Furthermore, the stayers sample is restricted to employers that do not change commuting zone
or industry during those eight years. Lastly, we restrict the stayers sample to firms with at least
10 such stayers and markets with at least 10 such firms, which helps to ensure sufficient sample
size to perform the analyses at both the firm and the market level. The stayers sample includes
35.1 (6.5) million spells on 10.3 (1.5) million unique workers (firms).
    The second subsample, which we refer to as the movers sample, restricts the full sample
  6 As another robustness check, we have also performed this analysis with Norwegian administrative data in

which hourly wages are observed. Reassuringly, we find broadly similar results using annual earnings or hourly
wages.



                                                     15
to workers observed at multiple firms.7 That is, it is not the same EIN that pays the worker
the greatest direct (W-2) earnings in all years. Following previous work, we also restrict the
movers sample to firms with at least two movers. This restriction might help reduce limited
mobility bias and makes it easier to compare the estimates of firm effects across methods (as
the approach of Kline et al. 2020 requires at least two movers per firm).8 The movers sample
includes 32.1 (3.6) million unique workers (firms).
    Online Appendix Table A.1 compares the size of the baseline, the stayers, and the movers
samples. Detailed summary statistics of these samples of linked firms and worker are given
in Online Appendix Table A.2. The samples are broadly similar, both in the distribution of
earnings but also in firm level variables such as value added, wage bill, size, and the distribution
across regions and sectors. The most noticeable differences are that the stayers have, on average,
somewhat higher earnings and tend to work in firms with higher value added.


4     Identification
We now describe how to take our model to the data, providing a formal identification argument
while summarizing, in Online Appendix Table A.3, the parameters needed to recover a given
quantity of interest and the moments used to identify these parameters. Our results reveal that
many of these quantities do not require knowledge of all the structural parameters. Thus, some
of our findings may be considered more reliable than others.

4.1     Rents of workers and employers
It follows from Results 1, 2 and 4 that the expected rents of workers and employers depend on
the parameters (, r , r ) and the data (Yit , Wit , jit , rit ). Our identification argument therefore
proceeds by showing how these parameters can be identified from the panel data on workers and
firms. However, before we present the formal identification argument, it is useful to consider
what one can and cannot identify directly from an ideal experiment. This consideration clarifies
the necessary assumptions even with an ideal experiment and the additional ones needed in the
absence of such an experiment.

Ideal experiment

To see how one may recover (, r , r ), consider the structural equations (4)-(6) that express
value added yj (a, a  ~) and wages wj (x, a, a
                                             ~) as functions of primitives that are fixed over time
         ~j , gj (x), xi ) and those that vary over time (a, a
 = (pr , p                                                   ~). Suppose we observed and were able
to exogenously change both a     ~, the component of productivity that is specific to a firm, and a
                                                                                                  ¯,
the component of productivity that is common to all firms in a market. As evident from the
structural equations (4)-(5), exogenous changes in a    ~ and a ¯ affect both the firm's value added
   7 Note that, since workers who are not in the movers sample are not necessarily stayers for 8 consecutive years

(e.g., due to a year in which earnings at the primary employer are below the full-time equivalence threshold, or
aging in or out of the sample), the stayers sample is not the same as the non-movers sample.
   8 See our Online Supplement for such a comparison and an analysis of limited mobility bias.




                                                       16
yj (¯  ~) and the wages it offers to workers of a given quality wj (x, a, a
    a, a                                                                  ~):

                                                          -1
                            wj (x, a, a
                                      ~)    yj (a, a
                                                   ~)                  1
                                                               =           r
                                a~            a ~                  1 + /r
                                                          -1
                            wj (x, a, a
                                      ~)    yj (a, a
                                                   ~)                 1
                                                               =        
                                a             a                    1 + 

where we refer to r and  as the firm level and market level pass-through rates.
    Since  is a known (or pre-estimated) tax parameter,  and r(j ) can be identified from
these two equations. In this ideal experiment, the pass-through to wj (x, a, a   ~) of an a induced
change in yj (a, a
                 ~) would identify  . Given this parameter, the pass-through to wj (x, a, a ~) of an
                           ~) would identify r(j ) . Finally, equations (5)-(6) imply,
~ induced change in yj (a, a
a
                                                                                /r
                E [yjt - bjt |j  Jr ]   = -cr = - log(1 - r ) - log                        .             (9)
                                                                              1 + /r

Since E [yjt - bjt |j  Jr ] can be estimated directly from the data, and  is known, it follows that
r is identified given (, r ), which are in turn identified from (r , ). Thus, the key challenge
for identifying (, r , r ) is to identify (r , ).
     While it is not feasible to perform such an ideal experiment, it is possible to achieve iden-
tification of (, r , r ) either by using the panel data to construct internal instruments or by
finding external instruments.

Identification using internal panel instruments

In order to identify (r , ), our baseline specification relies on so-called "internal" instruments,
i.e., instruments implied by model restrictions. To this end, we specify a process for the pro-
ductivity shocks to firms. Suppose that firm productivity evolves as a unit root process at both
the firm level and market level:9

                            a
                            ~jt   = p    ~jt ,
                                    ~j + z         where       z
                                                               ~jt = z
                                                                     ~jt-1 + u
                                                                             ~jt                        (10)
                            art   = pr + z rt ,    where       z rt = z rt-1 + urt                      (11)

To ensure relevance of the internal instrument we first assume that such shocks are present:
Assumption 1.a. The variance of innovation shocks at the firm and market levels are strictly
          2        2
positive, u
          ~,r > 0, u
                   ¯ > 0.

We also allow for measurement error jt in the observed value added in the form of a transitory
component with finite time dependence, i.e., yjt = yj (ar(j )t , a
                                                                 ~jt ) + jt . It is necessary to invoke
some restrictions on the relationships between the primitives. Denoting the history of time-
varying unobservables at time t by t  {u  ~jt , urt , ijt }i,j,r,t t , we assume the following:
Assumption 1.b. The value added measurement error terms jt are i) independent of T ,
E[jt |T ] = 0, and ii) have finite time dependence, E[jt jt |T ] = 0 if |t - t |  2.
   9 The assumption on the unit root process for productivity can be replaced by any process with persistence

beyond the persistence of the measurement error in value added.


                                                     17
We also allow for measurement errors vit in earnings, i.e., wit = wj (i,t) (xi , ar(j (i,t))t , a
                                                                                                ~j (i,t)t )+ vit .
We then make the following assumption:

Assumption 1.c. The wage measurement error vit is drawn independently of firm measurement
error and T , E[vit |jT , ..., j 1 , T ] = 0 .

Under assumptions 1.b and 1.c, we derive in Online Appendix C.1 the following moment condi-
tions which identify (r , ):
                  E [~    ~it+e -w
                     yjt (w      ~it-e - r (~
                                            yjt+e -y
                                                   ~jt-e )) |Si =1, j (i)=j  Jr ] = 0                        (12)
                E y rt wrt+e -wrt-e -  y rt+e -y rt-e                |Si =1, j (i)=j  Jr = 0                 (13)

for e  2, e  3, where y rt  E [yjt |Si =1, j (i, t)=j  Jr ] and wrt  E [wit |Si =1, j (i)=j  Jr ] are
market level means, w~it = wit - wrt and y~jt = yjt - y rt are deviations from market level means,
and Si =1 denotes a worker who does not change firms between t - e and t + e. These moment
conditions are equivalent to regressions of long-differences in log earnings on long-differences in
log value added, instrumented by short differences in log value added. In addition assumption
1.a ensures the rank condition and consequently the identifiability of these parameters.
    It is important to observe what is and is not being restricted by assumptions 1.b and 1.c
that deliver the internal instruments. First, these assumptions permit arbitrary correlation
between the components of . Thus, our model allows for rich heterogeneity of both firms and
workers, and systematic sorting of different workers into different firms. However, assumption
1.b implies that worker-specific innovations to productivity are independent across coworkers
and orthogonal both to innovations to firm productivity and to idiosyncratic taste realizations.
Moreover, worker-specific wage measurement error is independent of the choice of firm, and,
thus, does not matter for worker mobility. This is key to identifying the pass-through rates of
firm shocks by looking at changes over time in the earnings of incumbent workers.

Identification using external instruments

As a robustness check of the results based on the internal instruments, we will also be using
"external" instruments, i.e., instruments based on data other than or external to the data gen-
erating process of our model. As explained in detail in Online Appendix C.2, the advantage of
external instruments is that they allow us to relax the assumption on the joint process of ameni-
ties, firm productivity, and measurement error in value added. In particular, we can allow both
firm-specific and market-specific amenities to vary over time as well as unrestricted dependence
in the value added measurement error.

4.2     Quality of workers and technology and amenities of firms
To draw inferences about compensating differentials and the sources of wage inequality, we need
to recover the quality of workers as well as the technology and amenities of firms. To do so, we
start with equations (4) and (8), which show that the variation in log earnings can be decomposed
into firm effects (jt ), interactions between worker quality (x) and firm complementarities (j ),


                                                       18
and the pass-through of productivity shocks from firms to workers. In this subsection, we
demonstrate how to use the observed changes in earnings for workers moving across firms to
separately identify each of these components. We next combine these results with equation (7)
and the parameters (, r , r , ) identified in the previous subsection to decompose the variation
in firm effects into the time-varying TFP components at the firm-level (a~jt ) and the market-level
(art ) as well as the amenity component (hj ). Lastly, we use equations (10) and (11) to recover
the permanent components of TFP at the firm-level (p   ~j ) and market-level (pr ), respectively, as
well as the variances of TFP shocks at the firm-level (u  ~ ) and market-level (u ).
                                                          2                       2

     The first step of our identification argument is to recover the time-invariant firm-specific
earnings premium j as well as the firm-worker interaction parameters j using the earnings of
movers. To do so, we remove time-varying firm and market level components of earnings, which
allows us to express the expected earnings of worker i in firm j in terms of only xi , j , and j :
                                                                                     
                    1                 r                                            
                                                                                   
      E  wit -        (y - y r1 ) +       yjt - y
                                         (~     ~j 1 )              j (i, t)=j  Jr  = j xi + j    (14)
                 1 +  rt            r +                                            
                                    a
                                   wit


where we refer to wit
                   a
                      as adjusted log earnings,, and for j  Jr we define the firm fixed effect as:
                                                       1        r
                             j  cr - r hj +              p
                                                         ~r +      p
                                                                   ¯j .                           (15)
                                                    1 +       r + 

This derivation is presented in Online Appendix C.4. The fixed effect j is the common wage
intercept in the firm that can be attributed to permanent productivity and amenities. The
structure of the adjusted log earnings equation (14) matches the model of earnings of Bonhomme
et al. (2019). As described in their paper, under the rank condition that workers moving to a
firm are not of the exact same quality as workers moving from the firm:

                   E [xi |j (i, t)=j, j (i, t+1)=j ] = E [xi |j (i, t)=j , j (i, t+1)=j ] .

                                              wa -
Given (j , j ), xi is identified from E itj(i,t   j (i,t)
                                                    )
                                                           i . The estimates of xi and j allow us to
construct the total efficiency units of labor for each firm, which together with the time varying
part of the wage premium at the firm give us a linear system of equations in hj , a        ~jt and a¯rt
for each firm and time. Using the process assumptions on a            ~jt and a
                                                                              ~rt and the market level
normlization of pj , we can then identify (pr , p
                                                ~j , u  ~ , u ). See Online Appendix C.4 for details.
                                                        2    2



4.3    Amenities and worker preferences
To make inference about welfare and to perform counterfactuals, it is necessary to also recover
the preference terms Gj (X ). This is done through a revealed preference argument: Holding
wages fixed, firms with favorable amenities (for a given type of worker) are able to attract more
workers (of that type). Conditional on wages, the size and composition of firms and markets
should therefore be informative about unobserved amenities.
   We formalize this intuition in Lemma 8 in Online Appendix C.5, showing that Gj (X ) can


                                                     19
be identified from data on the allocation of workers to firms and markets. Using the probability
that workers choose to work for firm j conditional on selecting market r, P r [j (i, t)=j |X, r=r(j )],
we consider two firms j and j in the same market r. The differences in size and composition of
these firms depend on the gaps in wages and amenities:
                                                               r      P r [j (i, t)=j | X, r(j )=r]
    ((j - j )xi + j - j ) + log Gj (X ) - log Gj (X ) =          log
                                                                     P r [j (i, t)=j | X, r(j )=r]
               wage gap                      amenity gap
                                                                               relative size by worker type


where r / is the inverse (pre-tax) firm-specific labor supply elasticity. Since both the wage gap
and the within-market elasticity are already identified, we can recover the value of amenities up
to a common market factor by comparing the size and composition of firms. Comparing firms
across markets allows us to pin down the common market factor.


5     Estimation procedure, parameter estimates and fit
The estimation procedure follows closely the identification arguments laid out in Section 4 and
summarized in Online Appendix Table A.3, mostly replacing the population moments with
their sample counterparts. In the estimation, however, we impose a few additional restrictions
on the heterogeneity of workers, firms and markets. These restrictions are not necessary for
identification, but they help reduce the number of parameters to estimate. We now describe
these restrictions before presenting the parameter estimates, assessing the fit of the model, and
examining overidentifying restrictions.

5.1    Empirical specification
We begin by restricting the market-specific parameters r and r to be the same within broad
markets (as defined in Section 3). The restriction on r means the scale parameter can vary freely
across, but not within, broad regions and sectors of the economy. The assumption on r restricts
the nested logit structure of the preferences. Recall that the parameter r measures the degree
of independence in a worker's taste for alternative firms within the nest. We specified the nest as
the combination of commuting zone and two-digit industry. We now restrict the parameter r to
be the same for all nests within each broad market. As a result, labor wedges may vary across,
but not within, broad regions and sectors. In Online Appendix Table A.5, we demonstrate that
the estimates of (, r , r ) and rent shares are robust to alternative definitions of nests, such as
states instead of commuting zones and three-digit rather than two-digit industries.
    A second set of restrictions is that we draw the firm-specific components j and j from
a discrete distribution. We follow Bonhomme et al. (2019) in using a two-step grouped fixed-
effects estimation, which consists of a classification and an estimation step. In a first step, firms
are classified into groups indexed by k based on the empirical earnings distribution using the
k-means clustering algorithm. The k-means classification groups together firms whose earnings
distributions are most similar.10 Then, in a second step, we estimate the parameters k(j ) and
 10 Here,   we follow Bonhomme et al. (2019). Concretely, we use a weighted k-means algorithm with 100 randomly



                                                       20
k(j ) . In the baseline specification, we assume there exist 10 firm types. We view the assumption
of discrete heterogeneity as a technique for dimensionality reduction in the estimation. It is
reassuring to find that the estimates of firm effects do not change materially if we instead allow
for 20, 30, 40 or 50 firm types (see our Online Supplement).
     Lastly, we also make the following discreteness assumption for the systematic components
of firm amenities:
                                                      ~ j Gk(j ) (X ),
                                     Gj (X ) = Gr(j ) G

where we define the firm class k (j ) within market r using the classification discussed above
interacted with the market. This multiplicative structure reduces the number of parameters we
need to estimate while allowing for systematic differences in amenities across firms and markets
(G~ j , Gr(j ) ) and heterogeneous tastes according to the quality of the worker Gk(j ) (X ). As a result,
amenities may still generate sorting of better workers to productive firms, and compensating
differentials may still vary across firms, markets and workers, and heterogeneity in amenities.
For estimation purposes, we take advantage of the derivations in Online Appendix C.5, which
express the preference components (Gr(j ) G    ~ j Gk(j ) (X )) as functions of the size and composition
of firms and markets. In this estimation of Gj (X ), we discretize the distribution of X into 10
points of support by ranking the estimated values of X and evenly grouping workers into 10
bins. We also group markets into 10 different market types based on their realized empirical
distribution of earnings, using the same k-means algorithm as discussed above.

5.2     Estimates of the pass-through rates
Before we present the estimates of the pass-through rates, it is useful to better understand the
sources of the identification and to visually assess the underlying assumptions. To do so, recall
that the estimating equations (12)-(13) include fixed effects for time, firm and market. Thus,
we are effectively looking within markets and firms while eliminating common changes over
time in the labor market or the economy more generally. In other words, the estimation of the
pass-through is effectively done through difference-in-differences (DiD).

Difference-in-difference interpretation of estimator

To be concrete, consider first the DiD representation for the market level pass-through rate,
. Let y rt denote market level average log value added and wrt denote market level average
log earnings for the sample of stayers in market r. Suppose for simplicity the workers can be
assigned to two groups of firms: one half has y r(i)t = + and the other half has y r(i)t = - .
Conditioning on stayers (Si = 1) at firms in region r (j (i, t) = j  Jr ), we have,

                                E [wrt+e - wrt-e |+ ] - E [wrt+e - wrt-e |- ]
                          =
                                E y rt+e - y rt-e |+ - E y rt+e - y rt-e |-

where e is time relative to t. Under an assumption of common underlying trends between the
generated starting values. We use the firms' empirical distributions of log earnings on a grid of 10 percentiles of
the overall log-earnings distribution.




                                                        21
                                                                                               0.15




                                                                                                      Log Earnings Difference (Dashed)
                                      0.3
          Log VA Difference (Solid)
                                                                                               0.10

                                      0.2



                                                                                               0.05
                                      0.1




                                      0.0                                                      0.00




                                            -6   -3          0           3                6
                                                      Years from Event

           Figure 1: Difference-in-differences representation of the estimation procedure

Notes: This figure displays the mean differences in log value added (solid lines) and log earnings (dotted lines)
between firms that receive an above-median versus below-median log value added change at event time zero.
Results are presented for the measures of log value added and log earnings net of market interacted with year
effects (red lines) and for the averages of log value added and log earnings by market and year (blue lines). The
shaded area denotes the time periods during which the orthogonality condition need not hold in the
identification of the permanent pass-through rate.


y rt = + and y rt = - groups, the numerator gives the market level treatment effect on log
earnings, the denominator gives the market level treatment effect on log value added, and their
ratio gives the elasticity of earnings with respect to value added at the market level, .
    In Figure 1, we visualize and assess the DiD strategy at the market level. The blue line in
this figure is constructed as follows: In any given calendar year t, we i) order markets according
to the increase y rt ; ii) separate the firms at the median in the worker-weighted distribution
of y rt , letting the upper half constitute the treatment markets and the lower half the control
markets; and iii) plot the differences in y rt+e between these two groups in period e = 0 as well
as in the years before (e < 0) and after (e > 0). We perform these steps separately for various
calendar years, weighting each market by the number of workers. The solid (dashed) blue line
represents the difference in log value added (earnings) for the treatment and control markets.
    By construction, the treatment and control groups differ in the value added growth from
period t - 1 to period t. On average, markets in the treatment group experience about 13
percentage points larger growth in value added as compared to markets in the control group.
According to assumption 1.b, the growth in value added should be the sum of a permanent
component and a transitory, mean-reverting component. Due to the transitory component,
y rt could be correlated with y rt+e at e = -2, ..., 2. However, y rt should be orthogonal
to y rt+e in the periods before e = -2 and after e = 2. Consistent with this orthogonality
condition, the figure shows a very similar trend in log value added between the treatment and


                                                             22
control group at these periods. By similar reasoning, assumption 1.c implies that y rt should
be orthogonal to wrt+e in the periods before e = -2 and after e = 2. Consistent with
this orthogonality condition, the figure shows a very similar trend in log earnings between the
treatment and control group at these periods. Reassuringly, markets that experienced large
growth in value added in period 0 are no more or less likely to experience growth in value added
or earnings in periods -6 to -3 or in periods 3 to 6.
    The red lines of Figure 1 show how we obtain the firm level pass-through rate, r . These
lines are constructed using firm level deviations from market level averages. We plot value
added deviations y   ~jt  yjt - y rt (solid line) and earnings deviations w
                                                                          ~it  wit - wrt (dashed
line), splitting firms into the treatment and control groups at the median in the distribution of
~  yjt and weighting each firm by the number of workers. Reassuringly, we find that firms that
experienced large growth in value added in period 0 are no more or less likely to experience
growth in value added or earnings in periods -6 to -3 or in periods 3 to 6.

Estimates using internal instruments

The estimates in Table 1 complement the graphical evidence in Figure 1. In this table, we report
the estimated pass-through rates and the implied labor supply elasticities at both the firm and
market level. We directly implement the sample counterpart to equation (12) at the firm level
under the assumption that measurement errors follow an MA(1) process (e = 2, e = 3). We
allow r , and thus r , to vary by broad market, where a broad market is a set of markets. In
practice, we consider eight broad markets defined by a Census region and goods versus services
sectors (see Section 3). Similarly, we directly implement the sample counterpart to equation
(13) to estimate .
    In the first row of Panel A, we estimate that the average firm level pass-through rate r is
about 0.13 with a standard error of about 0.01. This suggests that the earnings of incumbent
workers increases by 1.3 percent if their firm experiences a 10 percent permanent increase in
value added, controlling for common shocks in the market. The firm level pass-through rate
implies a firm level (pre-tax) labor supply elasticity of about 6.5. This estimate implies that,
holding all other firms' wage offers fixed, a one percent increase in a firm's wage offer increases
that firm's employment by 6.5 percent.11
    In the first row of Panel B, we estimate that the market level pass-through rate  is about
0.18 with a standard error of about 0.03. This suggests that the earnings of incumbent workers
increases by 1.8 percent if all firms in their market experience a 10 percent permanent increase
in value added. This finding highlights the importance of distinguishing between shocks that
are specific to workers in a given firm versus those that are common to workers in a market.
The market level pass-through rate implies a market level (pre-tax) labor supply elasticity of
about 4.6. This estimate implies that, if all firms in a market increase their wage offers by one
percent, each firm's employment in the market increases by 4.6 percent.
  11 This estimate is at the upper end of the range of estimates found in a recent empirical literature. Card

et al. (2018) pick 4 as the preferred value in their calibration exercise. A related literature using experimentally
manipulated piece-rates for small tasks typically finds labor supply elasticities in the 2-6 range (Caldwell and



                                                        23
   Panel A.                                                               Firm-level Estimation
   Instrumental Variable                                      Passthrough (E[r ])     Implied LS Elasticity

   Internal instrument:                                                0.13                    6.52
   Lagged firm-level value added shock under MA(1) errors             (0.01)                  (0.56)

   External instrument:                                                0.14                    6.02
   Procurement auction shock at firm-level                            (0.05)                  (1.75)

   Panel B.                                                             Market-level Estimation
   Instrumental Variable                                        Passthrough ()        Implied LS Elasticity

   Internal instrument:                                                0.18                    4.57
   Lagged market-level value added shock under MA(1) errors           (0.03)                  (0.80)

   External instrument:                                                0.17                    5.00
   Shift-share industry value added shock                             (0.05)                  (1.68)


               Table 1: Estimates of pass-through rates and labor supply elasticities

Notes: This table summarizes estimates of the pass-through rates and pre-tax labor supply (LS) elasticities
when using internal or external instrumental variables. Panel A provides these estimates at the firm level, while
Panel B provides these estimates at the market level.


    In Online Appendix D.1, we provide a number of specification and robustness checks for the
pass-through estimates using internal instruments. First, we show that the firm level and market
level pass-through rates are not sensitive to using an MA(2) specification rather than an MA(1)
specification for the transitory shock process, which is consistent with previous work (see e.g.
Guiso et al. 2005; Friedrich et al. 2019). Second, when allowing for transitory shocks to value
added to also pass-through to earnings, we find very small pass-through rates of transitory shocks
while the pass-through rates for permanent shocks are not materially affected. Third, in Online
Appendix Figure A.1, we explore robustness of the pass-through estimates across subsamples of
workers, finding that the pass-through rates do not vary that much by the worker's age, previous
wage, gender, or tenure. Fourth, while value added is a natural measure of firm performance (see
the discussion by Guiso et al. 2005), it is reassuring to find that the estimates of the pass-through
rates are broadly similar if we measure firm performance by operating profits, earnings before
interest, tax and depreciation (EBITD), or value added net of reported depreciation of capital.
We also show that the estimated pass-through rates are in the same range as our baseline result
if we exclude multinational corporations or exclude the largest firms.
    Lastly, to compare with existing work (e.g., Guiso et al. 2005), we also consider estimating
the restricted specification that imposes r = , r. In our model, this is equivalent to imposing
r = 1, r, so that idiosyncratic worker preferences over firms are uncorrelated within markets.
The estimated pass-through rate is then 0.14, which is broadly similar to the existing literature
which ignores the distinction between firm and market shocks.
Oehlsen, 2018; Dube et al., 2020; Sokolova and Sorensen, 2018).




                                                       24
Estimates using external instruments

Our analyses so far have relied on statistical processes of earnings and value added. An advantage
of our approach is that it provides both a market level and a firm level instrument for each firm,
allowing us to draw inference for the entire population. While we have provided a number
of diagnostics and sensitivity checks which support our approach, the identifying assumptions
remain debatable. To examine the sensitivity of our results to the assumptions on the statistical
processes for value added and earnings ­ and thereby improve the quality and credibility of our
analyses ­ we now provide complementary analyses based on external instruments.
    To recover the firm level pass-through and labor supply elasticity, we take advantage of the
same research design as Kroft et al. (2020), except we apply it to our estimation sample and
parameters of interest. In particular, we examine how firms in the construction sector respond
to a plausibly exogenous shift in product demand through a DiD design that compares first-time
procurement auction winners to the firms that lose, both before and after the auction. Formally,
we consider as the treated group the firms that win their first procurement auction in year c
("cohort"). The control group is the set of firms that have not won an auction before c and
placed a bid at c but lost. Letting Dj,c denote an indicator for receiving the product demand
shock in year c and considering each time period e = -4, ..., 4 relative to c, we specify log mean
earnings with the firm regression,

    wj,c,e =         1 {e = e} µc,e +            1 {j = j } j        ,c   +            1 {e = e} Dj,c c,e         + j,c,e
                 e                          j                                   e =s
                                                                                                                   residual
               relative time fixed effect       firm fixed effect             treatment status by relative time


We report the average across c of the estimated c,e parameters, which can be interpreted as the
average treatment effect on the treated for those firms receiving an exogenous demand shock.
We use the same regression model to estimate the effects of an exogenous demand shock on log
value added. The ratio of the effects on log mean earnings and log value added is the passthrough
rate. Using this external instrument, we find in the second row of Panel A in Table 1 a firm
level pass-through rate of 0.14 and labor supply elasticity of about 6, which are very similar to
our baseline estimates under assumptions 1.b-1.c.
    In order to provide IV estimates of the market level pass-through and labor supply elasticity,
we follow Bartik (1991) and Blanchard and Katz (1992) in constructing a shift-share instrument.
Let cz denote a commuting zone and ind denote a 2-digit NAICS industry, and recall that a
market is defined by the pair (cz, ind) in our main specification. Let Y cz,ind,t denote the total
value added in the (cz, ind) at time t, and Y ind ,t  cz Y cz,ind,t denote aggregate industry
value added. Then, the shift-share value added shock to the commuting zone is constructed as
                                            Y cz,ind,t
   ind Scz,ind,t0 ind ,t , where Scz,ind,t     Y
                                                       is the exposure of the cz to a particular ind
                                                          cz,ind,t
                                                    ind
(the "share" component) and ind ,t  log Y ind ,t - log Y ind ,t- is the log change in industry value
added (the "shift" component). We measure the share component at the earliest period in the
sample and follow the internal instrument specification by considering a three-year difference in
the share component. Using this instrument, we find in the second row of Panel B in Table 1



                                                            25
a market level pass-through rate of 0.17 and labor supply elasticity of about 5, which are very
close to our baseline estimates under assumptions 1.b-1.c.

5.3    Estimates of the parameters needed to recover rents
Once we have estimates of firm level and market level pass-through rates (r , ) and tax pro-
gressivity , we can recover the model parameters (, r , r ) needed to identify rents. We begin
by estimating the tax progressivity parameter  as well as the proportional tax parameter 
outside the model. In each year, we regress log net household income (earnings plus other in-
come minus taxes) on log household gross income (earnings plus other income) for our sample.
The construction of these income measures is detailed in Online Appendix B. The intercept
from this regression gives us  while  is identified from the slope coefficient. We estimate  of
around 0.89 whereas  is estimated to be about 0.92.12 In a proportional tax-transfer system, 
is equal to one and (1 -  ) is the proportional effective tax rate. By contrast, if 0 <  < 1, then
the marginal effective tax rate is increasing in earnings. Thus, our estimate indicates modest
progressivity in the U.S. tax system. Online Appendix Figure A.2 shows how well our parsimo-
nious tax function approximates the effective tax rates implicit in the complex U.S. tax-transfer
system. Comparing predicted log net income from the regression to the observed log net income
across the distribution of log gross income, we find this specification provides an excellent fit.
    Armed with , we can identify (, r , r ) using the pre-tax labor supply elasticities at the firm
level and market level summarized in Table 1 and the equations in Section 4.1. We estimate the
(post-tax) market level labor supply elasticity  to be 4.99. This finding suggests considerable
variability across workers in the idiosyncratic tastes for firms. We estimate the average r across
markets to be 0.70. This implies a substantial correlation of about 0.5 in the idiosyncratic tastes
of workers across firms within the same industry and location. We estimate the average r
across markets to be 0.21. This indicates that returns to labor 1 - r are about 0.8 on average,
consistent with modestly diminishing returns.
    In Online Appendix Figure A.3(a), we report the estimates of (post-tax) firm level labor
supply elasticities from the main specification. On average, this elasticity is about 7.3. Behind
this average, however, there is important variation. Empirically, labor supply is most inelastic
in the goods sector (which has lower rates of unionization) and more elastic in the Northeast
(which has lower rates of right-to-work law coverage). These results are consistent with stronger
institutions that favor workers being associated with less wage-setting power of firms. However,
these are only correlational patterns and may not be given a causal interpretion.
    In Online Appendix Table A.5, we demonstrate that the estimates of (, r , r ) as well as
the rent shares are robust to various alternative market definitions. First, we demonstrate that
 and the average rent shares are robust to shutting down broad market heterogeneity (that is,
restricting r =  and r = ). Next, we demonstrate that the results are materially unchanged
when, instead of NAICS two-digit codes, we define the industry to be more aggregated (NAICS
supersectors) or less aggregated (NAICS three-digit). Lastly, we demonstrate that the results
 12 These   results mirror closely existing U.S. estimates of  and  (Guner et al., 2014, Heathcote et al., 2017).




                                                        26
are materially unchanged when, instead of commuting zones, we define the geographic units to
be more aggregated (states) or less aggregated (counties).

5.4     Worker heterogeneity, firm wage premiums and worker sorting
We estimate worker effects xi , firm wage premiums j (i) , and firm-worker interaction parameters
j (i) following closely Subsection 4.2. To do so, we first construct adjusted log earnings wita
                                                                                                using
equation (14) and the estimates of (, r , r , ) discussed in the previous subsection. Given13

the classification of firms into groups discussed above, we implement the estimating equations
provided in Online Appendix C.4 on wit   a
                                           in order to recover k(j ) , k(j ) for each group k . Then,
given (k , k ), we recover xi from equation (14), as described in Subsection 4.2.14
    Figure 2 summarizes the estimates (see our Online Supplement for further details). On the
y-axis, we plot the predicted log earnings for each firm type using the equation k + k xq , where
each quantile in the distribution of worker types xq is presented as a separate line. On the
x-axis, firm types are ordered in ascending order of mean log earnings. If k(j ) did not vary
across firm types k , the typical worker would not experience an upward slope when moving
from lower to higher firm types. We find a weakly positive slope, indicating some role for time-
invariant firm fixed effects. If k(j ) did not vary across firm types, then the lines in this plot
would have the same slope for lower and higher worker types. Instead, the results show clear
evidence that higher worker types experience a more positive slope across firm types. As shown
in Online Appendix C.4, the parameters governing nonlinearities are identified from comparing
the gains from moving from a low to a high type of firm for workers of different quality. As
evident from Figure 2, the gains from such a move are considerably larger for better workers.
For example, moving from the lowest to the highest type of firm increases earnings by 15, 47
and 80 percentage points for individuals at the 20, 50 and 80 percentiles of worker quality.
    To compare and interpret the estimates of xi , jt , and j , we re-arrange equation (14) so
that we can decompose log earnings as,

         wit = ¯(xi - x) + j (i,t),t - j (i,t) + j (i,t) + j (i,t) x + (j (i,t) - )(xi - x) +vit
                      x
                      ~i              ~j (i,t),t
                                                               ~j (i,t)
                                                                                         ij (i,t)




where   E j (i,t) and x  E [xi ]. This equation decomposes the earnings of worker i in period
t into four distinct components: x   ~i gives the direct effect of the quality of worker i (evaluated at
                     ~
the average firm), j (i,t),t is the firm premium, which is time varying due to the pass-through
of value added shocks,    ~j (i,t) represents the average effect of firm j (evaluated at the average
worker), ij (i,t) captures the interaction effect between firm j and worker i quality, and vit is
  13 In a preliminary step, we regress log-earnings on a full set of indicators for calendar years and a cubic

polynomial in age, where we follow Card et al. (2018) in restricting the age profile to be flat at age 40. Thus,
wit is log earnings net of age effects and common aggregate time trends. We verify that the two way fixed effect
estimates are nearly identical if jointly estimating the age and year effects with the firm and worker fixed effects.
  14 Note that 
                   k(j ) , k(j ) are estimated using the movers in the connected set of firms, while xi is estimated for
both movers and non-movers in this connected set. Since xi is estimated using an average over time for a given
worker, the estimated variance in xi may be upward-biased due to serial correlation in earnings measurement
errors or finite sample bias. In our Online Supplement, we derive and estimate the bias in the estimated variance
of xi for the case in which the error process is unit root plus MA(0), finding a small bias for our panel length.



                                                          27
                              1.0

                                                                                                                           Worker Quantile
    Predicted Log Earnings


                              0.5                                                                                             10
                                                                                                                              20
                                                                                                                              30
                              0.0                                                                                             40
                                                                                                                              50
                                                                                                                              60
                                                                                                                              70
                             -0.5                                                                                             80
                                                                                                                              90

                             -1.0


                                    1      2        3         4       5       6      7         8        9     10
                                        Firm Type (ordered by mean log earnings)

                                         Figure 2: Predicted log earnings from the estimated model
Notes: In this figure, we summarize the estimates of worker ability xi , time-invariant firm premiums k(j ) , and
firm-worker interactions k(j ) , for 10 firm groups k. On the y-axis, we plot the predicted log earnings for each
firm type using the estimated equation k + k · xq , where each quantile in the distribution of worker types xq
is presented as a separate line. On the x-axis, firm types are ordered in ascending order, where "lower" and
"higher" types refer to low and high mean log earnings.


the measurement error.
   Using this representation, we obtain a variance decomposition of log earnings:

 V ar(wit ) =                              V ar [~
                                                 xi ]             +       V ar ~j (i,t)        + 2Cov x
                                                                                                      ~i , ~j (i,t) +              V ar [vit ]
                                    i) Worker Quality: 71.6%                                                                 iv) Meas. Error: 10.0%
                                                                      ii) Firm Effects: 4.3%         iii) Sorting: 13.0%

                                    + V ar     ij (i,t)    + 2Cov x
                                                                  ~i + ~j (i,t) ,         ij (i,t)   + V ar ~j (i,t),t + 2Cov x
                                                                                                                              ~i , ~j (i,t),t

                                                          v) Interactions: 0.9%                              vi) Time-varying Effects: 0.3%


The first conclusion is that the most important determinant of earnings inequality is worker
quality, which explains about 72 percent of the variation in log earnings. The second conclusion
is that firm fixed effects explain around 4 percent of the variation in log earnings, with a standard
deviation of firm effects of about 0.12. In order to place the firm effect estimates in context, we
compare them to the literature on the effects of job displacement. The majority of these studies
focus on the US and find that long-run earnings losses from a job displacement are around 10-20
percent (see the survey by Couch and Placzek 2010).15 Thus, a job displacement has about
the same effect on earnings as moving to a firm that is one standard deviation lower in the
  15 For a recent example, Lachowska et al. (2020b) find hourly wage losses of 12 percent and earnings losses of

16 percent five years after a job displacement in data from Washington state.



                                                                                   28
bias-corrected firm effects distribution.
    The third conclusion is that the US economy is characterized by strong sorting of high quality
workers to high paying firms, with a correlation of 0.37 between worker and firm fixed effects.
Indeed, sorting explains about three times as much of the variation in log earnings as firm fixed
effects on their own. The fourth conclusion is that the dispersion of interaction effects across
firms explains about 1 percent of earnings inequality.16 The final conclusion is that the time-
varying component of firm effects due to the pass-through of TFP shocks at the firm level and
market level explains less than half of a percent of earnings inequality, indicating a small role
for the pass-through of shocks in cross-sectional earnings inequality.17
    In Online Appendix D.2, we discuss a number of specification checks. First, we consider
estimating the model when excluding firm-worker interactions (imposing j = ) or excluding
time-varying effects (imposing r =  = 0). Second, we assess the degree of limited mobility
bias in our data. Third, we consider increasing the number of groups in the k-means algorithm
from the baseline value of 10 up to 50 in increments of 10, finding that the estimates are not
sensitive to the number of groups. Fourth, we compare estimates for two distinct time periods,
finding that the variance decomposition estimates change little over time. Fifth, we consider
a number of checks on the reliability of the estimates of the interaction parameters j . These
include a comparison between our estimates and the interaction effects that arise due to observed
worker heterogeneity and a check against data on hourly wages instead of annual earnings.

5.5     Estimates of remaining parameters and overidentification checks
We conclude this section by discussing estimates of the remaining parameters. We recover TFP
and amenity components (~        aj,t , ar,t , hj ) from the estimates of (xi , j , j ) using the approach
explained in Subsection 4.2. Given estimated TFP and amenities, we can use them to construct
predicted values of firm effects, value added, efficiency units of labor, and wage bill. In Online
Appendix Figure A.4, we compare the observed and the predicted values of these variables in
order to examine the model fit. We make this comparison separately according to the actual and
predicted firm size.18 Because these moments are not directly targeted in the model estimation,
it is reassuring that the model fits them well.
     As an overidentification check, in Online Appendix Figure A.5, we take advantage of the
fact that there are two distinct methods to identify the amenity component hj . One possibility
is the baseline approach discussed in Subsection 4.2, which recovers it from the equation for
firm wage premiums. Another possibility is to use the fixed-point definition of hj as a function
of (P ~j , P r , Gj (X )), as shown in Lemma 3 in Online Appendix A.1. This definition comes
  16 Using a random effects approach, Woodcock (2015) also provides a decomposition with firm-worker interac-

tions in the US. He also finds that interactions explain less variation than firm effects. However, the approach
of Woodcock (2015) requires that match heterogeneity is purely idiosyncratic. By contrast, we find systematic
deviations from the linear model in a way that is structurally related to other sources of heterogeneity, such as
worker effects and firm effects.
  17 Similarly, Lachowska et al. (2020a) find that firm effects are highly persistent over time within firms when

re-estimating firm effects on two-year intervals in data from Washington state.
  18 Note that firm effects are targeted directly, while the relationship between firm effects and size is not, so

subfigure (b) in Online Appendix Figure A.4 is only untargeted in its relationship to firm size. The other
subfigures are untargeted in both dimensions.


                                                       29
                                                           Rents and Rent-shares
                                                        Firm-level          Market-level
                Workers' Rents:
                 Per-worker Dollars                   5,447      (395)     7,331     (1,234)
                 Share of Earnings                    13%        (1%)      18%        (3%)
                Firms' Rents:
                   Per-worker Dollars                 5,780     (1,547)    7,910     (1,737)
                   Share of Profits                   11%        (3%)      15%        (3%)

                Workers' Share of Rents               49%        (4%)       48%       (3%)


                 Table 2: Estimates of rents and rent sharing (national averages)
Notes: This table displays our main results on rents and rent-sharing. Standard errors are in parentheses and
are estimated using 40 block bootstrap draws in which the block is taken to be the market.


from the equilibrium constraint of the model, which we do not directly use in the baseline
estimation. Online Appendix Figure A.5 shows that the estimates of hj we obtain from solving
the equilibrium constraint of the model are very similar to the baseline estimates. This finding
increases our confidence in the moment conditions implied by our economic model.
    As another overidentification check, we combine the earnings equation (4) with the equation
for the wage bill (6) (instead of value added (5)) to estimate the firm-specific labor supply
elasticity using our internal instruments. This does not alter the conclusion that each firm
is facing an economically and statistically significant upward-sloping labor supply curve. In
other words, firms have considerable wage-setting power. In terms of magnitudes, we estimate
a firm-specific labor supply elasticity above 6 based on value added changes and around 5 based
on wage bill changes. Given the precision we have, however, one may want to be cautious in
drawing strong conclusions about meaningful differences between these point estimates.

6     Empirical insights from the model
We now present the empirical insights from the estimated model. These insights require an
explicit model of the labor market, and, thus, they may be susceptible to model misspecification.
As shown in Section 4, however, many of the insights do not require knowledge of all the
structural parameters. Thus, some of our findings may be considered more reliable than others.
To make this clear, we first present the findings that rely on the least assumptions and then
move to those that require additional restrictions on the functioning of the labor market.

6.1     Rents and and labor wedges
Table 2 presents estimates of the size of rents earned by American firms and workers from
ongoing employment relationships. We report national averages and refer to Online Appendix
Table A.7 for the market-specific results.


                                                      30
     We find evidence of a significant amount of rents and imperfect competition in the U.S. labor
market due to horizontal employer differentiation. At the firm level, we estimate that workers
are, on average, willing to pay 13 percent of their annual earnings to stay in their current jobs.
This corresponds to about $5,400 per worker. By comparison, firms earn, on average, 11 percent
of profits from rents (with profits being measured as value added minus the wage bill). This
amounts to about $5,800 per worker in the firm. Thus, we conclude that firm level rents from
imperfect competition in the labor market are split equally between employers and their workers.
     At the market level, we estimate that rents are considerably larger than firm level rents.
Workers are, on average, willing to pay about $7,300 (18 percent of their annual earnings) to
avoid having to work for a firm in a different market, which is almost $1,900 more than they
would pay to avoid having to work for a different firm in the same market. The relatively
large market level rents reflect that firms within the same market are more likely to be close
substitutes than firms in different markets. At the market level, rents are again split almost
evenly between firms and their workers.
     In order to place our estimate that a worker's firm level rents amount to 13 percent of annual
earnings in context, one may compare it to the literature on the effects of job displacement.
The majority of these studies focus on the US and find that long-run earnings losses from a
job displacement are around 10-20 percent (see the survey by Couch and Placzek 2010). For
example, Lachowska et al. (2020b) find hourly wage losses of 12 percent and earnings losses of 16
percent five years after a job displacement in data from Washington state. Thus, the magnitude
of firm rents due to imperfect competition is broadly comparable to estimates of wage loss due
to job displacement.
     In Online Appendix Figure A.3, we show that labor wedges are significant and vary substan-
tially across markets. On average, the marginal revenue product of labor is 15 percent higher
than the wage. Behind this average, however, there is important variation. Empirically, the
labor wedges are most pronounced in the goods sector (which have higher values of r ). In the
Western region of the U.S., for example, the labor wedge is 6 percentage points larger for firms
in the goods sector as compared to those in the service sectors.

6.2    Compensating differentials
The estimates of rents suggest the average American worker is far from the margin of indifference
in her choice of firm, and would maintain the same choice even if her current firm offered
significantly lower wages. In other words, the average worker considers amenities important to
her choice of firm. This finding does not, however, imply marginal workers view the amenities of
the current firm as much better or much worse than those offered by other firms. To gauge the
preferences for amenities of marginal workers, we estimate average compensating differentials.
    The estimates of the expected compensating differentials are displayed in Online Appendix
Figure A.6. To estimate these quantities, we randomly draw two firms, j and j , from the
overall distribution of firms (where each firm is drawn with probability proportional to its size).
Using result 3, we compute the compensating differential between j and j for a worker of given
quality x as j + xj - j - xj . We repeat this procedure for many draws of firms.


                                                31
    The solid horizontal line in Online Appendix Figure A.6 shows the mean absolute value of
compensating differentials for marginal workers. For two randomly drawn firms, the one with
worse amenities can be expected to pay an additional 18 percent in order to convince marginal
workers (of average quality) to accept the job. There is, however, considerable heterogeneity
in compensating differentials according to worker quality. The upward sloping solid line shows
how the expected compensating differential varies with worker quality. For high quality workers
(95th percentile in the national distribution), the expected compensating differential is as large
as 30 percent. By comparison, marginal workers of low quality (5th percentile in the national
distribution) require less than 10 percent additional pay to work in the firm with unfavorable
amenities.
    The dashed lines of Online Appendix Figure A.6 display the compensating differentials across
firms within a market. To compute these quantities, we use the same procedure as above, except
we now compare firms within each market. For two randomly drawn firms in the same market,
the one with worse amenities can be expected to pay an additional 14 percent in order to convince
marginal workers (of average quality) to accept the job. This suggests that three-quarters of
compensating differentials reflect differences in amenities within, rather than between, markets.

6.3     The importance of amenities and productivity for firm effects
As evident from equation (8), variation in the firm effects jt depends not only on the het-
erogeneity in firm amenities, but also on the differences in productivity across firms as well as
the covariance between productivity and amenities within firms. The reason is that firms have
wage-setting power, which generates a positive relationship between the firm's productivity and
the wages it pays. To quantify the importance of these sources, consider the decomposition,

                                                                 1            1
         V ar(j (i,t),t ) = V ar(cr - r hj (i,t) ) + V ar(          art +          a
                                                                                   ~j (i,t),t )
                                                             1 + r        1 + r /r
                                   Amenities
                                                                            TFP
                                                               1            1
                                 + 2Cov (cr - r hj (i,t) ,        art +          a
                                                                                 ~j (i,t),t )
                                                           1 + r        1 + r /r
                                                   Covariance between amenities and TFP


These components can be broken down between and within broad markets and, within broad
markets, further decomposed within and between markets.19
    The results from these decompositions are reported in Table 3.20 They suggest substantial
variation in amenities and productivity across firms. Interpreted in isolation, this heterogeneity
predicts a large inequality contribution from firm effects. However, productive firms tend to
have good amenities, which act as compensating differentials and push wages down in productive
firms. As a result, firm effects explain only a few percent of the overall variation in log earnings.
For example, firm effects within detailed markets explain 3.1 percent of the variation in log
   19 Recall that a broad market is a Census region interacted with a broad sector (goods or services), while a

market is a commuting zone interacted with a 2-digit NAICS industry.
   20 We find similar results qualitatively when using two way fixed effect estimation without bias-correction or

firm-worker interactions. Thus, the results in Table 3 are robust to alternative estimation procedures.



                                                       32
                                  Between Broad Markets                 Within Broad Markets
                                                                    Between                 Within
                                                                Detailed Markets       Detailed Markets
   Total                                     0.4%                       2.0%                  3.1%
   Decomposition:
     Amenity Differences                     16.0%                      7.8%                  7.1%
     TFP Differences                         15.5%                     11.9%                  8.6%
     Amenity-TFP Covariance                 -31.1%                     -17.7%                -12.6%


                    Table 3: Decomposition of the Variation in Firm Premiums
Notes: This table displays our estimates of the decomposition of time-varying firm premium variation in three
levels: variation between broad markets, between detailed markets (within broad markets), and between firms
(within detailed markets). Broad markets are defined as the combination of a Census region and broad sector,
and detailed markets are defined as the combination of industry times commuting zone. We decompose the
variation in time-varying firm premiums into the contributions from amenity differences, TFP differences, and
the covariance between amenity and TFP differences. All components are expressed as shares of log earnings
variation.


earnings, which is much less than predicted by the variances of firm productivity (8.6 percent)
and amenities (7.1 percent).
    The positive correlation between TFP and amenities gives a negative contribution to earnings
inequality, as indicated by the negative terms reported in the last row of Table 3. Since labor
supply is upward sloping, more productive firms must offer greater total compensation per
worker than smaller firms to achieve their optimal size. Since TFP and amenities are positively
correlated, high TFP firms disproportionately offer compensation through amenities rather than
wages. Thus, earnings inequality would be even greater if amenities were uncorrelated with TFP,
since high TFP firms would rely more heavily on paying higher wages instead of higher amenities.

6.4     Worker sorting
As summarized in Section 5.4 and discussed in greater detail in our Online Supplement, there
is positive sorting between worker and firm fixed effects, which contributes to inequality in
earnings. In Figure 3(a), we present the sorting of workers to firms in our data. In this figure,
firm types are ordered along the x-axis in ascending order of mean log earnings. On the y-axis,
we rank workers by their worker effects xi and divide them into five equally sized quintile groups.
The bars present the share of workers within each firm type belonging to each quintile group.
Figure 3(a) reveals that the highest quality workers are vastly overrepresented at the highest
paying firms. For example, in the lowest firm type, less than 10 percent of workers belong to the
top quality quintile group. By contrast, in the highest firm type, about 60 percent of workers
belong to the top group.
    To build confidence in the estimated pattern of sorting, we exploit that there are two distinct
methods to estimate sorting. One possibility is the baseline approach discussed in Subsection
4.2, which recovers worker and firm fixed effects from the equation for firm wage premiums (14)
and uses the allocation of workers to firms observed in the data. Another possibility is to use the
                                                                       ~j , P r , Gj (X )), as shown in
fixed-point definition of hj as a function of the estimated values of (P



                                                     33
                           100                                                                                                       100

    Share of Workers (%)




                                                                                                              Share of Workers (%)
                           75                                                                                                        75


                           50                                                                                                        50


                           25                                                                                                        25


                            0                                                                                                         0
                                   1      2       3     4     5     6       7       8       9       10                                     1     2       3     4     5     6     7       8       9       10
                                              Firm Type (ordered by mean log earnings)                                                               Firm Type (ordered by mean log earnings)

                                        Worker Effect Quintile     1    2       3       4       5                                              Worker Quality Quintile     1    2    3       4       5


                                       (a) Actual: Baseline Estimates                                     (b) Actual: Simulating from the Equilibrium Model

                           100                                                                                                       100
    Share of Workers (%)




                                                                                                              Share of Workers (%)
                           75                                                                                                        75


                           50                                                                                                        50


                           25                                                                                                        25


                            0                                                                                                         0
                                   1      2       3     4     5     6       7       8       9       10                                     1     2       3     4     5     6     7       8       9       10
                                           Firm Type (ordered by mean log earnings)                                                                  Firm Type (ordered by mean log earnings)

                                       Worker Quality Quintile      1    2      3       4       5                                              Worker Quality Quintile     1    2    3       4       5


                                       (c) Counterfactual: Shrink gj (x)                                                                        (d) Counterfactual: Shrink j

                                 Figure 3: Actual and counterfactual composition of the workforce by firm types
Notes: In this figure, we first compare the baseline estimates of the worker quality composition by firm type
from the equation for firm wage premiums (15) in subfigure (a) versus those estimated using the equilibrium
constraint by solving the fixed-point definition of hj as a function of (P~j , P r , Gj (X )), as shown in Lemma 3 in
Online Appendix A.1 then simulating the sorting of workers to firms (subfigure b). Then, we reduce the
heterogeneity across firms in amenities or production complementarities by replacing either gj (x) with
(1 - s) gj (x) + sg j or j with (1 - s) j + s, where g j = Ex [gj (x)],  = E [j ], then re-simulate the equilibrium.
Here, s  [0, 1] is the shrink rate with s = 0 corresponding to the baseline model. We report the quality of the
workforce by firm type for the counterfactual economies with s = 1   2
                                                                        for either amenities (subfigure c) or
production complementarities (subfigure d).


Lemma 3 in Online Appendix A.1, then simulate the allocation of worker quality to firm types
using only estimated model parameters. This approach relies on the equilibrium constraint
of the model, which we do not directly use in the baseline estimation. The results from this
simulation are presented in Figure 3(b). The strong similarity between Figures 3(a) and 3(b)
serves as an overidentification check that increases our confidence in the moment conditions
implied by our economic model.
    As discussed in Subsection 2.3, there are several possible reasons why better workers are
overrepresented in higher paying firms. One possible reason is that productive firms have better
amenities, and high ability workers may value amenities more than low ability workers. Another
possible reason is complementarities in production, which incentivizes better workers to sort into
productive firms. We now perform counterfactuals that help quantify the importance of these
distinct reasons for sorting.
    In the counterfactuals we consider, we reduce the heterogeneity across firms in amenities


                                                                                                         34
                                                                 (1)                   (2)           Difference
                                                             Monopsonistic          No Labor          between
                                                             Labor Market        or Tax Wedges      (1) and (2)
 Log of Expected Output                      log E[Yjt ]           11.38              11.41              0.03
 Total Welfare (log dollars)                                       12.16              12.21              0.05
 Sorting Correlation                         Cor(jt , xi )          0.44               0.47              0.03
                                                 r
 Labor Wedges                                1 +                   1.15               1.00              -0.15
 Worker Rents (as share of earnings):
                                               r
    Firm-level                               r +                  13.3%               12.4%            -0.9%
                                               1
    Market-level                             1+                   18.0%               16.7%            -1.3%

                   Table 4: Consequences of Eliminating Tax and Labor Wedges
Notes: This table compares the monopsonistic labor market to a counterfactual economy which differs in two
ways. First, we eliminate the tax wedge in the first order condition by setting the tax progressivity (1 - )
equal to zero. Second, we remove the labor wedges in the first order conditions of the firms by setting r equal
                         r
to the labor wedge 1 +      in each market r. After changing these parameters of the model, we solve for the
new equilibrium allocation and outcomes, including wages, output and welfare. Results are displayed for
output, welfare, the sorting correlation, the mean labor wedge, and worker rents.


or production complementarities by replacing either gj (x) with (1 - s) gj (x) + sg j or j with
(1 - s) j + s, where g j = Ex [gj (x)],  = E [j ]. Here, s  [0, 1] is the shrink rate with s = 0
corresponding to the baseline model. By reducing the heterogeneity in production complemen-
tarities, we are effectively making amenities more important for the allocation of workers to firm
(and vice versa). Keeping jt fixed at baseline values (s = 0), we solve for the counterfactual
allocation of workers to firms given the chosen counterfactual values of gj (x) or j .
    Figures 3(c) and 3(d) illustrate the importance of amenities versus production complementar-
ities for the sorting of workers to firms. Here, we solve the equilibrium counterfactual economies
with s = 1 2 for either amenities (subfigure c) or production complementarities (subfigure d). The
results suggest that production complementarities are the key reason why better workers are
sorting into higher paying firms. Online Appendix Figure A.7 complements these results by plot-
ting estimates of Corr(xi , j (i,t) ) and 2Cov (xi , j (i,t) ) for counterfactual economies with many
values of s. These findings indicate that production complementarities are the driving force of
the strong positive correlation between worker and firm effects and the significant inequality
contribution from worker sorting.

6.5     Progressive taxation and allocative efficiency
As shown in Section 2.5, the government can improve the allocation of workers to firms in
two ways. First, a less progressive tax system may reduce the misallocation that arise from
the tax wedge. Second, letting the tax rates vary across markets may improve allocation by
counteracting the differences in the wage-setting power of firms. We now use the estimated
model to perform a counterfactual that quantifies the impacts of such a tax reform on the
equilibrium allocation and outcomes, including wages, output and welfare.
   The counterfactual we consider involves two changes to the monopsonistic labor market.
First, we eliminate the tax wedge in the first order condition, which distorts the worker's ranking

                                                      35
of firms in favor of those with better amenities. This is done by setting the tax progressivity
(1 - ) equal to zero. Second, we remove the labor wedges in the first order conditions of the
firms. These wedges cause misallocation of workers across firms with different degrees of wage-
setting power. As proven in Lemma 7 in Online Appendix A.4, labor wedges can be eliminated
                                           r
by setting r equal to the labor wedge 1 +     in each market r. After changing these parameters
of the model, we solve for the new equilibrium allocation and outcomes, including wages, output
and welfare. For a set of wages {Wjt (X )}j,t and a tax policy (,  ), we define the welfare as:

                           Wt = E max uit j, (1 + t ) Wjt (Xi )
                                      j


where t is set so that profits and tax revenues are distributed among all the workers in pro-
portion to their earnings:
                                          1
                  t · E  Wjt (Xi ) =               jt + E Wj (Xi ) -  Wj (Xi ) ,
                                          N
                     redistribution                         government revenue
                                              profits


In other words, we redistribute profits and tax revenues in a non-distortionary way.
    The result are presented in Table 4. They suggest the monopsonistic labor market creates
significant misallocation of workers to firms. Eliminating labor and tax wedges increases total
welfare by 5 percent and total output by 3 percent. When we decompose this change by
performing the counterfactuals one at a time, we find that 4 percentage points of the welfare
gains are due to eliminating the labor wedge while the remaining 1 percentage point is due to
eliminating the tax wedge. We also find that removing these wedges would increase the sorting
of better workers to higher paying firms and lower the rents that workers earn from ongoing
employment relationships. When we decompose this change by performing the counterfactuals
one at a time, we find that nearly all of the change in sorting is due to eliminating the tax
wedge, with the labor wedge having a small impact on sorting.
    In interpreting these results, it is important to recall that we assume firms initially may
choose amenities gj (x), but they do not change gj (x) in in the counterfactuals. With better
data on, and an instrument for, amenities, it would be interesting to extend this analysis to
allow for firms to adjust amenities in response to these counterfactuals.

7    Conclusion
The goal of our paper was to quantify the importance of imperfect competition in the U.S. labor
market by estimating the size of rents earned by American firms and workers from ongoing
employment relationships. To this end, we constructed a matched employer-employee panel
data set by combining the universe of U.S. business and worker tax records for the period
2001-2015. Using this panel data, we identified and estimated an equilibrium model of the
labor market with two-sided heterogeneity where workers view firms as imperfect substitutes
because of heterogeneous preferences over non-wage job characteristics. The model allowed us
to draw inference about imperfect competition, compensating differentials and rent sharing.


                                                    36
We also used the model to quantify the relevance of non-wage job characteristics and imperfect
competition for inequality and tax policy, to assess the economic determinants of worker sorting,
and to offer a unifying explanation of key empirical features of the U.S. labor market.
    When considering the interpretation and generality of our study, we emphasize a few caveats
and extensions. One of these is that we focus on distortions in the allocation of workers to firms
and markets. However, tax and labor wedges may also distort the choices of whether and how
much to work. Related, we do not consider unemployment, and, as a result, we are reluctant to
draw conclusions about how imperfect competition matters for the impact of minimum wages.
Doing so is an important but challenging task, as it requires identification of the value of
non-employment and a non-linear supply curve. We also assume the labor market is a spot
market and, thus, we are unable to analyze the role of long-term contracts and firm insurance
against shocks.21 Furthermore, our structural model makes several simplifying assumptions,
partly because of data availability but also to prove identification. For example, we abstract
from observed heterogeneity in preferences and skills and, moreover, model individual behavior,
and hence do not consider any interdependencies between spouses in the choices of whether
and where to work.22 Moreover, we assume no mobility costs or search frictions, and we do
not explicitly model human capital investments or work experience. While incorporating these
features would be interesting, it would also present severe challenges to identification, especially
if one allows for two-sided heterogeneity. Additionally, we focus on the wage setting power of
firms, and the analyses do not incorporate that firms may have price-setting power in the product
market. Extending the model to allow for both forms of imperfect competition and how they
interact is an important avenue for future research.23 Lastly, we consider an equilibrium where
each firm views itself as infinitesimal within the market. This assumption is motivated by the
fact that very few firms in the U.S. have a large share of the local labor market (as measured
by commuting zone). Thus, optimizing firms would essentially ignore the negligible effect of
changing their own wages on the overall supply of workers to the market as a whole. However,
if labor markets are sufficiently segmented (geographically or by industry), it is possible that
strategic interactions can play an important role.24


References
Abowd, J. M., F. Kramarz, and D. N. Margolis (1999): "High Wage Workers and High
 Wage Firms," Econometrica, 67, 251­333.
Akerman, A., I. Gaarder, and M. Mogstad (2015): "The skill complementarity of broad-
 band internet," The Quarterly Journal of Economics, 130, 1781­1824.
Andrews, M. J., L. Gill, T. Schank, and R. Upward (2008): "High Wage Workers and
  21 See Balke and Lamadon (2020) for a model and empirical analysis of long-term contracts and firm insurance.
  22 Autor et al. (2019) and Blundell et al. (2016) estimate a life cycle model with two earners jointly making
consumption and labor supply decisions. Their findings suggest an important role for consumption smoothing
through household labor supply.
  23 Kroft et al. (2020) analyze imperfect competition in both the labor and the product market in the U.S.

construction industry.
  24 See Berger et al. (2019) for an analysis of strategic interactions in the firms' wage setting and Jarosch et al.

(2019) for a search framework with large firms.



                                                         37
  Low Wage Firms: Negative Assortative Matching or Limited Mobility Bias?" Journal of the
  Royal Statistical Society. Series A (Statistics in Society), 171, 673­697.
Autor, D., A. Kostøl, M. Mogstad, and B. Setzler (2019): "Disability Benefits, Con-
 sumption Insurance, and Household Labor Supply," American Economic Review, 109.
Balke, N. and T. Lamadon (2020): "Productivity Shocks, Long-Term Contracts and Earn-
 ings Dynamics," Working paper.
Barth, E., A. Bryson, J. C. Davis, and R. Freeman (2016): "It's where you work: In-
 creases in earnings dispersion across establishments and individuals in the US," Journal of
 Labor Economics, 34, S67­S97.
Bartik, T. J. (1991): "Who benefits from state and local economic development policies?" .
Berger, D. W., K. F. Herkenhoff, and S. Mongey (2019): "Labor Market Power,"
 Working Paper w25719, National Bureau of Economic Research.
Bhaskar, V., A. Manning, and T. To (2002): "Oligopsony and Monopsonistic Competition
 in Labor Markets," The Journal of Economic Perspectives, 16, 155­174.
Blanchard, O. J. and L. F. Katz (1992): "Regional Evolutions," Brookings Papers on
 Economic Activity, 1992, 1­75.
Blundell, R., M. Costa Dias, C. Meghir, and J. Shaw (2016): "Female Labor Supply,
 Human Capital, and Welfare Reform," Econometrica, 84, 1705­1753.
Boal, W. M. and M. R. Ransom (1997): "Monopsony in the labor market," Journal of
 Economic Literature, 35, 86­112.
Bonhomme, S., K. Holzheu, T. Lamadon, E. Manresa, M. Mogstad, and B. Setzler
 (2020): "How Much Should we Trust Estimates of Firm Effects and Worker Sorting?" Working
 Paper w27368, National Bureau of Economic Research.
Bonhomme, S. and G. Jolivet (2009): "The pervasive absence of compensating differentials,"
 Journal of Applied Econometrics, 24, 763­795.
Bonhomme, S., T. Lamadon, and E. Manresa (2019): "A Distributional Framework for
 Matched Employer Employee Data," Econometrica, 87, 699­739.
Cahuc, P. and G. Laroque (2014): "Optimal taxation and monopsonistic labor market: Does
 monopsony justify the minimum wage?" Journal of Public Economic Theory, 16, 259­273.
Caldwell, S. and E. Oehlsen (2018): "Monopsony and the Gender Wage Gap: Experimental
 Evidence from the Gig Economy," MIT Working Paper.
Card, D., A. R. Cardoso, J. Heining, and P. Kline (2018): "Firms and Labor Market
 Inequality: Evidence and Some Theory," Journal of Labor Economics, 36, S13­S70.
Card, D., F. Devicienti, and A. Maida (2013): "Rent-sharing, holdup, and wages: Evidence
 from matched panel data," The Review of Economic Studies, 81, 84­111.
Carlsson, M., J. Messina, and O. N. Skans (2016): "Wage adjustment and productivity
 shocks," The Economic Journal, 126, 1739­1773.
Couch, K. A. and D. W. Placzek (2010): "Earnings losses of displaced workers revisited,"
 American Economic Review, 100, 572­89.
Dube, A., A. Manning, and S. Naidu (2020): "Monopsony and employer mis-optimization
 explain why wages bunch at round numbers," Unpublished manuscript.
Dunne, T., L. Foster, J. Haltiwanger, and K. R. Troske (2004): "Wage and produc-
 tivity dispersion in United States manufacturing: The role of computer investment," Journal
 of Labor Economics, 22, 397­429.


                                            38
Ekeland, I., J. J. Heckman, and L. Nesheim (2004): "Identification and estimation of
 hedonic models," Journal of Political Economy, 112, S60­S109.
Faggio, G., K. G. Salvanes, and J. Van Reenen (2010): "The evolution of inequality in
  productivity and wages: panel data evidence," Industrial and Corporate Change, 19, 1919­
  1951.
Friedrich, B., L. Laun, C. Meghir, and L. Pistaferri (2019): "Earnings Dynamics and
 Firm-Level Shocks," Working Paper 25786, National Bureau of Economic Research.
Gibbons, R. and L. Katz (1992): "Does unmeasured ability explain inter-industry wage
 differentials?" The Review of Economic Studies, 59, 515­535.
Gibbons, R., L. F. Katz, T. Lemieux, and D. Parent (2005): "Comparative advantage,
 learning, and sectoral wage determination," Journal of Labor Economics, 23, 681­724.
Guiso, L., L. Pistaferri, and F. Schivardi (2005): "Insurance within the firm," Journal of
 Political Economy, 113, 1054­1087.
Guner, N., R. Kaygusuz, and G. Ventura (2014): "Income taxation of US households:
 Facts and parametric estimates," Review of Economic Dynamics, 17, 559­581.
Hamermesh, D. S. (1999): "Changing inequality in markets for workplace amenities," The
 Quarterly Journal of Economics, 114, 1085­1123.
Heathcote, J., K. Storesletten, and G. L. Violante (2017): "Optimal tax progressivity:
 An analytical framework," The Quarterly Journal of Economics, 132, 1693­1754.
Jarosch, G., J. S. Nimczik, and I. Sorkin (2019): "Granular search, market structure, and
  wages," NBER Working Paper w26239.
Kennan, J. (2001): "Uniqueness of positive fixed points for increasing concave functions on
 Rn: An elementary result," Review of Economic Dynamics, 4, 893­899.
Kline, P., N. Petkova, H. Williams, and O. Zidar (2019): "Who profits from patents?
 rent-sharing at innovative firms," The Quarterly Journal of Economics, 134, 1343­1404.
Kline, P., R. Saggio, and M. Sølvsten (2020): "Leave-out estimation of variance compo-
 nents," Econometrica, 88, 1859­1898.
Kroft, K., Y. Luo, M. Mogstad, and B. Setzler (2020): "Imperfect Competition and
 Rents in Labor and Product Markets: The Case of the Construction Industry," Working Paper
 w27325, National Bureau of Economic Research.
Lachowska, M., A. Mas, R. D. Saggio, and S. A. Woodbury (2020a): "Do firm effects
  drift? Evidence from Washington administrative data," Working Paper w26653, National
  Bureau of Economic Research.
Lachowska, M., A. Mas, and S. A. Woodbury (2020b): "Sources of displaced workers'
  long-term earnings losses," American Economic Review, 110, 3231­66.
Lasserre, J. B. (2001): "Global optimization with polynomials and the problem of moments,"
  SIAM Journal on Optimization, 11, 796­817.
Lavetti, K. and I. M. Schmutte (2017): "Estimating compensating wage differentials with
  endogenous job mobility," Working paper.
Maestas, N., K. J. Mullen, D. Powell, T. Von Wachter, and J. B. Wenger (2018):
 "The Value of Working Conditions in the United States and Implications for the Structure of
 Wages," Working Paper 25204, National Bureau of Economic Research.
Manning, A. (2003): Monopsony in motion: Imperfect competition in labor markets, Princeton
 University Press.



                                            39
------ (2011): "Imperfect competition in the labor market," Handbook of Labor Economics, 4,
  973­1041.
Marinescu, I. and R. Rathelot (2018): "Mismatch Unemployment and the Geography of
 Job Search," American Economic Journal: Macroeconomics, 10, 42­70.
Mas, A. and A. Pallais (2017): "Valuing alternative work arrangements," American Eco-
 nomic Review, 107, 3722­59.
Mirrlees, J. A. (1971): "An exploration in the theory of optimum income taxation," The
 Review of Economic Studies, 38, 175­208.
Mortensen, D. (2003): Wage dispersion: why are similar workers paid differently?, MIT Press.
Murphy, K. M. and R. H. Topel (1990): "Efficiency wages reconsidered: Theory and evi-
 dence," in Advances in the Theory and Measurement of Unemployment, Springer, 204­240.
Pierce, B. (2001): "Compensation Inequality," The Quarterly Journal of Economics, 116,
  1493­1525.
Powell, D. (2012): "Compensating Differentials and Income Taxes Are the Wages of Dangerous
 Jobs More Responsive to Tax Changes than the Wages of Safe Jobs?" Journal of Human
 Resources, 47, 1023­1054.
Powell, D. and H. Shan (2012): "Income taxes, compensating differentials, and occupa-
 tional choice: How taxes distort the wage-amenity decision," American Economic Journal:
 Economic Policy, 4, 224­47.
Rosen, S. (1986): "The Theory of Equalizing Differences," Handbook of Labor Economics, 1,
 641­692.
Sokolova, A. and T. Sorensen (2018): "Monopsony in labor markets: A meta-analysis,"
  IZA Discussion Paper.
Song, J., D. J. Price, F. Guvenen, N. Bloom, and T. von Wachter (2018): "Firming
  Up Inequality," The Quarterly Journal of Economics, 134, 1­50.
Sorkin, I. (2018): "Ranking Firms using Revealed Preference," The Quarterly Journal of Eco-
  nomics, 133, 1331­1393.
Taber, C. and R. Vejlin (2020): "Estimation of a Roy/Search/Compensating Differential
 Model of the Labor Market," Econometrica, 88, 1031­1069.
Van Reenen, J. (1996): "The creation and capture of rents: wages and innovation in a panel
 of UK companies," The Quarterly Journal of Economics, 111, 195­226.
Wiswall, M. and B. Zafar (2017): "Preference for the workplace, investment in human
 capital, and gender," The Quarterly Journal of Economics, 133, 457­507.
Woodcock, S. D. (2015): "Match effects," Research in Economics, 69, 100­121.
Yagan, D. (2015): "Capital tax reform and the real economy: The effects of the 2003 dividend
 tax cut," American Economic Review, 105, 3531­3563.
Yazici, H. and C. Sleet (2017): "Taxation, Redistribution and Frictional Labor Supply," in
 2017 Meeting Papers, Society for Economic Dynamics, 298.




                                            40
For Online Publication
A     Details on Model Solutions
A.1     Derivation of equilibrium wages
Given the nested logit preferences and a given set of wages Wt = {Wjt (X )}j =1..J we get that

                                                                                                   r(j )
                                                                         /r(j )
                                                  j Jr(j )   ( Gj (X ))           Wj t (X )/r(j)
         P r[j (i, t)=j |Xi =X, Wt ] =                                                                 r
                                                                             /r
                                              r         j Jr    ( Gj (X ))          Wj t (X )/r
                                                                        /r(j )
                                                         ( Gj (X ))        Wjt (X )/r(j)
                                          ×                               /r(j )
                                                     j Jr(j )   ( Gj (X ))       Wj t (X )/r(j)

and
                                                                                             r             
                             1                                          /r             /r 
      E [uit |Xi = X, Wt ] =  log                          ( Gj (X ))        (Wjt (X ))            + C  ,
                                          r         j Jr


where C is an unrecoverable constant. It is useful to introduce the following definition before
stating the Lemmas:

                                                     (1 - r )/r
                                         Cr                     .
                                                       1 + /r

Lemma 1. Assume that firms believe they are strategically small. That is, in the firm first
order condition, we impose that
                                              Irt (X )
                                                       = 0.
                                              Wjt (X )
We can then show that for firm j in market r

                                                           1+/r
                                                                            1-r
                                     Yjt = (Ajt ) 1+r /r (Hjt )                                               (16)
                                                                       1
                                                  -r
                               Wjt (X ) = Cr X j Hjt Ajt            1+r /r
                                                                                                              (17)
                                                          /r

                                     Ljt = Hjt Ajt      1+r /r
                                                                    ,                                         (18)

where Hjt is implicitly defined by

                                                                                             1
                                                                                          1+r /r
                             j (1+/r )                              /r      /r
              Hjt        X               Krt (X ) ( Gj (X ))               Cr  dX                  ,




                                                           1
and we define

                                                                         /r
                                        (Irt (X ))            1
            Krt (X )  N MX (X )                     
                                                                               ,
                                         r Ir t (X )      Irt (X )
                                                                                                       r /( )
                                                                                       r
                                                                                    - 1-     /r
                                                                            Yj t         r
             Irt (X )                 1/ Gj (X )1/ Cr X j Aj         t
                                                                                                                  .
                                                                            Aj t
                              j Jr


Proof. We start from the firm problem specified in the main text including the tax parameters.
Using shorthand r for r(j ), we have

                                                       1-r
             max         Ajt         X j Djt (X )dX             -     Wjt (X )Djt (X )dX
       {Wjt (X ),Djt (X )}
                                                                                                                  /r
                                                         (Irt (X ))                                    Wjt (X )
                         s.t. Djt (X ) = N MX (X )                    
                                                                                   Gj (X )1/  1/
                                                          r Ir t (X )                                  Irt (X )

and defining:
                                                                                          /r
                                                        Irt (X )                  1
                              Krt (X )  N MX (X )                  
                                                        r Ir t (X )           Irt (X )
We substitute in the labor supply function and take the first order condition with respect to
Wjt (X ):

                                                                                                                               r
                                                                                                                            - 1-
                                     1      Krt (X )                                  Yjt                                        r
     (1-r )X j     Wjt (X )/r -1 +                   Wjt (X )/r  /r Gj (X )/r Ajt
                 r                 Krt (X ) Wjt (X )                                 Ajt
                                                           1    Krt (X )
             =  /r Gj (X )/r   1+       Wjt (X )/r +                     Wjt (X )1+/r .
                                   r                   Krt (X ) Wjt (X )

                                     Irt (X )
Under the assumption that            Wjt (X )   = 0, the FOC then simplifies to

                                                                                             r
                                                                                          - 1-
                                                                                    Yjt        r
                             1+         Wjt (X ) = (1 - r )X j Ajt                                 ,
                                r                 r                                 Ajt

or                                                                              r
                                                                             - 1-
                                                        j            Yjt          r
                                      Wjt (X ) = Cr X Ajt                             .
                                                                     Ajt
Let's then turn to the output of the firm,

                                                                               1-r
                                                 /r
     Yjt /Ajt =       X j Krt (X ) ( Gj (X ))         Wjt (X )/r dX
                                                                                                       r /r
                                                                                                                      1-r
                                                                                                   -
                                                                /r                 /r     Yjt          1-r
             =          X j     1+/r
                                        Krt (X ) ( Gj (X ))          (Cr Ajt )                                dX 
                                                                                          Ajt




                                                            2
and so:
                                                                                            1-r
              1+r /r                                                    /r                                (1-r )/r
(Yjt /Ajt )             =          X j (1+/r ) Krt (X ) ( Gj (X ))              /r
                                                                               Cr  dX             (Ajt )             .


Introducing
                                                                                             1
                                                                                          1+r /r
                                                                    /r
                Hjt           X j (1+/r ) Krt (X ) ( Gj (X ))               /r
                                                                           Cr  dX                     ,


this simplifies to

                               1+r /r                   (1-r )(1+r /r )              (1-r )/r
                     (Yjt /Ajt )             = (Hjt )                          (Ajt )             ,
                                                         1+/r
                                                                           1-r
                                         Yjt = (Ajt )   1+r /r
                                                                  (Hjt )         .

Then we get for the wage:
                                                                           r
                                                                        - 1-
                                                         j        Yjt        r
                                      Wjt (X ) = Cr X Ajt
                                                                  Ajt
                                                                           1
                                                         -r (1+r /r )
                                               = Cr X j Hjt Ajt       .

In addition we have:

                                                /r
          Ljt =       X j Krt (X ) ( Gj (X ))        Wjt (X )/r dX
                                                                                 /r           /r
                                                             /r       -r
                =     X j (1+/r ) Krt (X ) ( Gj (X ))             Cr Hjt                (Ajt ) 1+r /r dX
                                                /r
                     1+r /r -r /r            1+r /r
                = Hjt                       Ajt
                            /r
                       1+r /r
                = Hjt Ajt     .




Lemma 2 (Uniqueness of Hjt ). The firm and time-specific equilibrium constants Hjt are
uniquely defined.

Proof. As we have established in Lemma 1, for firm j in market r, Hjt solves the following




                                                             3
system:
                                                                                                             r -1
                                                                                            /
                                                                        /r                    r
                                                                  -r                      1+ /
                                                                                                                
          Hjt =                                             
                                               X j  Gj (X )Cr Hj   t                  Aj    r
                                                                                              t
                                                                                                r


                         r           j Jr
                                                                                                   r -1
                                                                   /r          /r
                                                       -r 
                    ×                    X j  Gj (X )Cr Hj t            Aj   1+r /r
                                                                                 t
                                                                                                   
                             j Jr
                                                                                                              1
                                                                   /r                                      1+r /r
                                     × X j (1+/r )  Gj (X )Cr
                                                            
                                                                        N MX (X )dX                                 ,

where we replaced Krt (X ) and then Irt (X ) and finally Yjt with their expressions in terms of
Hjt . To show uniqueness we are going to show that H            ~ jt  (Hjt )r is unique. Using Ht =
 ~ 1t , ..., H
(H           ~ Jt ), it solves the following fixed point expression:

                                                                                                            r -1
                                                                                        /
                                                                        /r                r
           ~ jt =
           H                                                  ~ -
                                                X j  Gj (X )Cr Hj t
                                                                                      1+ /
                                                                                     Aj r   r                              (19)
                                                                                          t
                             r          j Jr
                                                                                                  r -1
                                                                   /r      /r
                                                          ~ -
                     ×                      X j  Gj (X )Cr Hj t          1+r /r
                                                                        Aj   t
                                                                                                  
                                 j Jr
                                                                                                             r
                                                                   /r                                      1+r /r
                                      × X j (1+/r )  Gj (X )Cr
                                                             
                                                                         N MX (X )dX

               = jt (Ht ).

We show that this expression satisfies the two conditions required to apply Theorem 1 of Kennan
(2001). We first look at the common part to all j terms given by
                                                                                                             r -1
                                                                                            /
                                                                        /r                    r
          ¯ t (X, Ht )  
                                                               ~ -
                                                 X j  Gj (X )Cr Hj t                 Aj
                                                                                          1+ /
                                                                                            r   r               
                                                                                              t
                                 r      j Jr


and we see that
                                                                                                                r -1
                                                                                                     /
                                                                                     /r                r
    ¯ t (X, µ · Ht ) = 
                                     µ-                             ~ -
                                                      X j  Gj (X )Cr Hj t
                                                                                                   1+ /
                                                                                                  Aj r   r              
                                                                                                       t
                             r                 j Jr

                        ¯
                    =µ       t (X, Ht ).




                                                           4
Hence we get that

                                                                         /r
jt (µ · Ht ) =      X j (1+/r ) ¯ t (X, µ · Ht )  Gj (X )Cr
                                                          

                                                                                           r -1
                                                                                /r                                    r
                                                                    /r                                              1+r /r
                                                ~ -
                   ×           X j  Gj (X )µ- Cr Hj t                         1+r /r
                                                                             Aj   t
                                                                                                  N MX (X )dX
                        j Jr
                    r /r                                                              /r
                =µ 1+r /r         X j (1+/r ) ¯ t (X, Ht )  Gj (X )Cr
                                                                    

                                                                                       r -1
                                                                           /r                                    r
                                                               /r                                              1+r /r
                                             ~ -
                   ×           X j  Gj (X )Cr Hj t                  Aj   1+r /r
                                                                         t
                                                                                              N MX (X )dX
                        j Jr
                    r /r
                =µ 1+r /r jt (Ht ).

Then for any 0 < µ < 1, r and j  Jr , given Ht > 0 such that t (Ht ) = Ht , where t (·) 
(1t (·), ..., Jt (·)), we have:

                                                       r    /
                                                            r
                                            ~ jt = µ 1+
                         jt (µ · Ht ) - µ · H                               ~ jt
                                                         r /r ·  (H ) - µ · H
                                                                jt t
                                                          r /r
                                                                 ~ jt - µ · H
                                                    = µ 1+r /r · H          ~ jt
                                                             r  /
                                                                r
                                                    = µ (µ 1+r /r -1 - 1) ·H
                                                                           ~ jt
                                                                    >0

                                                    > 0,

which means that we have shown that t (Ht ) - Ht is strictly "radially quasi-concave". The next
step is to show monotonicity. Consider H1t and H2t such that for a given j we have H~ 1jt = H
                                                                                            ~ 2jt
    ~ 1j t  H
and H       ~ 2j t for all other. Then we have that for all j , t, X and r = r(j ),

                                          /                                                                /
                                  /r        r                                                   /r           r
                     ~ -                1+ /                              ~ -                            1+ /
       X j  Gj (X )Cr H1j t            Aj r
                                            t
                                              r
                                                            X j  Gj (X )Cr H2j t                     Aj   t
                                                                                                           r   r




and for any r :
                                                  /                                                               /
                                   /r               r                                                     /r        r
            j             ~ -                   1+ /                          j                 ~ -             1+ /
        X        Gj (X )Cr H1j t        Aj      t
                                                  r   r
                                                                          X            Gj (X )Cr H2j t         Aj r
                                                                                                                    t
                                                                                                                      r
                                                                                                                             .
j Jr                                                              j Jr


Hence, summing over r and taking it to the power of minus one, this implies that ¯ t (X, H1t ) 




                                                           5
¯ t (X, H2t ). Then, since r  1 we also get that:


                                                      r -1
                                    /r       /r
                         ~ -                          
           X j  Gj (X )Cr H1j t          Aj1+r /r
                                              t
    j Jr
                                                                                             r -1
                                                                              /r      /r
                                                                ~ -
                                                  X j  Gj (X )Cr H2j t              1+r /r
                                                                                   Aj   t
                                                                                                    .
                                           j Jr


Combining the last two results and observing that the third term in the expression for jt (Ht )
is the same for H1t and H2t gives us that:

                                       jt (H1t )  jt (H2t )



                                          ~ 1j t  jt (H2t ) - H
                              jt (H1t ) - H                   ~ 2j t .

Since the last inequality holds for all j , we obtain the quasi-increasing property:

                                jt (H1t ) - H1t  jt (H2t ) - H2t .

The fact that the function is "radially quasi-concave" together with monotonicity gives unique-
ness of the fixed point by the theorem in Kennan (2001). This means that Ht is unique, and
hence that H~ jt is unique and finally that Hjt is unique.

Definition 2. We consider a sequence of increasingly larger economies indexed by an increasing
number of regions nr where nf
                            r = r n for some fixed r . In this sequence of economies we assume
                                   r
                                                                   -r(j ) /
                                                °j (X ) nf
that the amenities scale according to Gj (X ) = G                   for some fixed G °j (X ). We
                                                         r (j )
also assume that the mass of workers grows according to N = nr · n    ° = nr · nr · 
                                                                 ¯f · N             ¯·N°, where
¯ f is the average number of firms per region nf
n                                              r , and ¯ is the average of r .

Lemma 3. Here we establish that the unique solution for Hjt in the limit of a sequence of
growing economies is given by
                                                  /r      (r -1)
                                            ¯rt
                                 Hjt = Hj · A (1+r  ) (1+r /r )
                                                                ,




                                                  6
where Hj solves the following fixed point:

                                                                                                                                       1
                                                            /r                                              /r                      1+r /r
                        j      Ir0 (X )             1                         j   °j (X )C                         ¯ °
         Hj =       X                                                     X       G       r                          N MX (X )dX
                               I0 (X )           Ir0 (X )                                                          r
                                                       /r            /r

Ir0 (X )/r  Ej             °j (X )Cr
                      X j  G        -r
                                     Hj                         ~ 1+r /r
                                                                Ajt

                                         
                        ¯rt
   I0 (X )  Er Ir0 (X ) A 1+r 
                               .


Proof. Consider the expression for Hjt from the beginning of Lemma 2:
                                                                                                                   r -1
                                                                                               /
                                                                                  /r             r
                                                                      -r                     1+ /
                                                                                                                       
        Hjt =                                            
                                            X j  Gj (X )Cr Hj          t                    Aj r
                                                                                                 t
                                                                                                   r


                         r        j Jr
                                                                                                         r -1
                                                                          /r          /r
                                                  -r 
                    ×               X j  Gj (X )Cr Hj t                           Aj1+r /r
                                                                                        t
                                                                                                         
                             j Jr
                                                                                                                   1
                                                                          /r                                    1+r /r
                                × X j (1+/r )  Gj (X )Cr
                                                       
                                                                               N MX (X )dX                                .

                                                                r(j ) /
                                °                                                     ° = (nr nr   -1
                        r , r , Gj (X ) = nr (j )
Let's introduce nr and nf                  f
                                                                          Gj (X ) and N          ¯) N :

                                                                                                                       r -1
                                                                                                           /
                                                                                        /r                   r

     Hjt =      1              1                     °j (X )Cr
                                                X j  G       
                                                               Hj
                                                                              -r 
                                                                                                 Aj
                                                                                                         1+ /
                                                                                                           r   r               
                                                                               t                            t
                nr
                         r
                              nf
                               r     j Jr
                                                                                                         r -1
                                                                          /r         /r
                        1                °j (X )Cr
                                                  -r 
                ×                   X j  G         Hj t                        Aj  1+r /r
                                                                                    t
                                                                                                         
                        nf
                         r   j Jr
                                                                                                                   1
                                                                    /r     ¯ °                                  1+r /r
                                            °j (X )Cr
                             × X j (1+/r )  G       
                                                                             N MX (X )dX                                  .
                                                                           r

As the economy grows large, i.e. as nr grows to infinity, we end up with the following expression:

                                                                                                   /                   r       -1
                                                                                   /r                r
                                                j   °j (X )Cr
                                                               -                                 1+ /
     Hjt =         Er         Ej   Jr       X       G         Hj t r                        Aj     r
                                                                                                     t
                                                                                                       r




                                                                          /r            /r                      r -1
                 × Ej        Jr
                                         °j (X )C  H -r 
                                    X j  G                                       1+r /r
                                                                                Aj
                                                 r  j t                            t
                                                                                                                    1
                                                                    /r        ¯ °                                1+r /r
                                            °j (X )Cr
                             × X j (1+/r )  G       
                                                                                N MX (X )dX                                .
                                                                              r

Next we show that Hjt can indeed be expressed as stated in the Lemma. Let's assume that




                                                            7
                     /r        (r -1)
           ¯rt
Hjt = Hj · A (1+r  ) (1+r /r )
                               and show that it solves the problem. We first note that:

                                                                    /
                                                       /r             r
                   °j (X )C  H              -r                    1+ /
  Ej   Jr     X j  G       r  j              t                   Aj r
                                                                      t
                                                                        r




                                                                          /r                   /r         (r -1)      /r

            = Ej     Jr
                                  °j (X )Cr
                             X j  G        -r 
                                            Hj                                  ¯-
                                                                               ×Art
                                                                                   r /r (1+  ) (1+ / ) 1+ /
                                                                                           r      r r
                                                                                                      Aj t r r



                   /r                                                               /r        /r
             ¯rt
            =A 1+r 
                    Ej        Jr
                                                °j (X )Cr
                                           X j  G        -r 
                                                          Hj                             ~ 1+r /r
                                                                                         Aj t

                   /r
             ¯rt
            =A 1+r 
                    Ir0 (X )/r ,

                    ¯r(j )t A
where we used Ajt = A       ~jt . Hence


                                                            -1                /r                   r -1
Hjt =            Er       ¯ 1+r
                          A
                                  
                                     Ir 0 (X )                     ¯rt
                                                                 × A 1+r 
                                                                          Ir0 (X )/r
                           r t
                                                                                                 1
                                                             /r       ¯ °                     1+r /r
                             °j (X )C 
              × X j (1+/r )  G                                          N MX (X )dX
                                     r
                                                                      r
                                                                                                                         1
                                                            /r                                /r                      1+r /r
                 j    Ir0 (X )                 1                              j   °j (X )Cr
                                                                                                      ¯ °
                                                                                                      
       =     X                                                            X       G                     N MX (X )dX
                      I0 (X )               Ir0 (X )                                                  r
                                   r -1
               ¯rt
              ×A 1+r  1+r /r


                     /r           (r -1)
              ¯rt
       = Hj · A (1+r  ) (1+r /r )
                                  ,

where we used that Hj solves

                                                                                                                         1
                                                            /r                                /r                      1+r /r
                 j    Ir0 (X )                 1                              j   °j (X )Cr
                                                                                                   ¯ °
                                                                                                   
Hj =         X                                                            X       G                  N MX (X )dX
                      I0 (X )               Ir0 (X )                                               r

with
                                                                                              1/( )
                                    I0 (X )            Er    ¯ 1+r
                                                             A
                                                                          
                                                                               Ir 0 (X )              .
                                                              r t




   We can then establish the final result.

Proposition 1. The wage equation is given by

                                                                                  1           1
                          wj (x, a  ~) = cr + j x - r hj +
                                 ¯, a                                                  a
                                                                                       ~+        a
                                                                                                 ¯,
                                                                              1 + r /r    1 + r 

where
                                                          /r             
                                     hj =     jt   -            ~jt -
                                                                a            a
                                                                             ¯rt .
                                                       1 + r /r       1 + r 



                                                                          8
                                     /r                                                            /r      (r -1)

Proof. Recall Ljt = Hjt Ajt
                         1+r /r                             ¯rt
                                from Lemma 1 and Hjt = Hj · A (1+r  ) (1+r /r )
                                                                                from
Lemma 3. Then:

                                                   /r
                                hjt =        jt   -        ajt
                                                1 + r /r
                                                (r - 1)/r
                                         =                       a
                                                                 ¯rt + hj .
                                           (1 + r  ) (1 + r /r )

Hence, we get

                                               /r             
                                hj =        jt   -   ~jt -
                                                     a            a
                                                                  ¯rt
                                            1 + r /r       1 + r 
                                               /r             
                                jt   = hj +          a
                                                     ~jt +        a
                                                                  ¯rt
                                            1 + r /r       1 + r 
                                            j (¯
                                               art , a
                                                     ~jt ).

Next, we replace Hjt and Ajt in the expression for the wage from Lemma 1, Wjt (X ) =
                     1
        -r 1+r /r
Cr X j Hjt Ajt    , to get

                                                                   1              1
                     wjt (x) = cr + j x - r hj +                        a
                                                                        ~jt +        a
                                                                                     ¯rt
                                                               1 + r /r       1 + r 
                               wj (x, a
                                      ¯rt , a
                                            ~jt ).

Note that wjt (x) depends on time only through a
                                               ¯rt and a
                                                       ~jt .


Corollary 1. The firm demand is given by:
                                              1
                                                                             /r
                   N           Ir 0 ( X )A¯rt
                                           1+r 
                                                   1/
                                                      Gj ( X )1/
                                                                  W jt ( X )
         Djt (X ) = r MX (X )                                     1
                                                                                .
                   n                  I0 (X )        I (X )A  ¯ 1+r                r0       rt


Proof. As nr grows to infinity, we first note:

                                                                                             r
                                                                                          - 1-     /r
                     /r                     1/            1/          j            Yj t        r
          Irt (X )        =                      Gj (X )       Cr X       Aj   t
                                                                                   Aj t
                              j Jr
                                                                                             /r       /r
                             1+r  1
                              /r
                           ¯rt
                          =A                                       °j (X )Cr
                                                              X j  G        -r
                                                                             Hj                    ~ 1+r /r
                                                                                                   Aj t
                                  nf
                                   r              j Jr
                                /r
                           ¯rt
                          =A   1+r 
                                            Ir0 (X )/r
                                     1
                           ¯rt
                Irt (X ) = A 1+r 
                                  Ir0 (X ).




                                                                9
Firm demand can then be rewritten as:
                                                                                      r /
                                 (Irt (X ))                         Wjt (X )
           Djt (X ) = N MX (X )                 
                                                     Gj (X )1/  1/
                                  r Ir t (X )                       Irt (X )
                                                   1
                                                                                          /r
                      N            I r 0 ( X )A¯rt
                                                1+r 
                                                               1/
                                                                   Gj ( X )1/
                                                                               W jt ( X )
                     = r MX (X )                                               1
                                                                                             .
                      n                    I0 (X )                I (X )A  ¯ 1+r 
                                                                          r0       rt




   We also derive the other quantities of the model.

Corollary 2. The value added and wage bills are given by

                                                    1 +        1 + /r
                          yj (¯  ~) =(1 - r )hj +
                              a, a                         a
                                                           ¯+           a
                                                                        ~
                                                  1 + r       1 + r /r
                                                        1 +        1 + /r
                          bj (¯  ~) =cr + (1 - r )hj +
                              a, a                            a
                                                              ¯+           a
                                                                           ~.
                                                       1 + r      1 + r /r

Proof. We turn to expressing the value added at the firm:
                                           1+/r
                             1-r          1+r/
                      Yjt = Hjt  Ajt              r


                                           /r         (r -1)      1-r               1+/r
                                                                                   1+r/
                             =         ¯rt
                                  Hj · A (1+r  ) (1+r /r )                   ~jt
                                                                         ¯rt A
                                                                         A                 r



                                                 1 +                      1 + /r
                          yjt = (1 - r )hj +                     art +                  a
                                                                                        ~jt
                                                1 + r                    1 + r /r
                              yj (art , a
                                        ~jt )

and for the wage bill:



Bjt =      Wjt (X )Djt (X )dX
                                   1
                                                         /r
                     Ir0 ( X )A¯ 1+r 
                                          1/
                                             Gj ( X ) 1/
                                                                      /r N MX (X )
     =     Wjt (X )             rt                   1
                                                            (Wjt (X ))             dX
                           I0 (X )      I (X )A ¯ 1+r                       nr
                                                       r0        rt
                              1
                                                                 /r
                     ¯      1+r            1/        1/
     =      Ir0 (X )Art                    Gj (X )1 
                 I0 (X )                         ¯rt
                                         Ir0 (X )A 1+r 


                                                         1+/r          1+/r
                                       1+/r             1+r /r
                          -r
                × Cr X j Hj                     ~jt
                                                A                     ¯rt
                                                                      A 1+r 
                                                                             nr  °MX (X )dX
                                                                                ¯N
                                 1 +         1 + /r
 bjt = cr + (1 - r )hj +              a
                                      ¯rt +          a
                                                     ~jt
                                 1 +        1 + r /r
     = bj (art , a
                 ~jt ).



                                                            10
So, we get that:
                                             yj (¯  ~) - bj (¯
                                                 a, a        a, a
                                                                ~ ) = cr .



   Note that this gives us that the structural passthrough rate of the firm level shock is (with
abuse of notation):

                                                                    -1
                                  wj (¯
                                      a, a
                                         ~)            yj (¯
                                                           a, a
                                                              ~)                1
                                            ·                            =
                                   a  ¯                  a ¯                 1 + 
                                                                    -1
                                  wj (¯
                                      a, a
                                         ~)            yj (¯
                                                           a, a
                                                              ~)               r
                                            ·                            =        .
                                   a  ~                  a ~                 r + 

Corollary 3. Firm j worker composition does not depend on a
                                                          ¯ or a
                                                               ~.

Proof. Consider P r[X |j, t]:

        Pr[X |j, t] = Pr[X, j |t]/Pr[j |t]
                           Pr[j |X, t]Pr[X ]
                   =
                         Pr[j |X , t]MX (X )dX
                                                            /r                           /r
                              Ir0 (X )             1                °j (X )Wjt (X )
                              I0 (X )           Ir0 (X )            G                         MX (X )
                   =                                       /r                            /r
                          Ir0 (X )                                 °j (X )Wjt (X )
                          I0 ( X )
                                                  1
                                             Ir 0 ( X )            G                          MX (X )dX
                                                            /r                     /r
                             Ir0 (X )             1                    °j (X )
                             I0 (X )           Ir0 (X )            X j G                MX (X )
                   =                                       /r                      /r
                          Ir0 (X )                                       °(X
                          I0 ( X )
                                                  1
                                             Ir 0 ( X )            X   j G     )        MX (X )dX

                   = Pr[X |j ].




A.2     Worker rents
Lemma 4. We establish that for workers of type X working at firm j in market r at time t, the
                                            Wjt (X )                                                      Wjt (X )
average firm level rent is given by        1+/r           and the average market level rent is given by    1+ .

Proof. The average worker rent at the firm is defined as the difference between the worker's
willingness to accept W and the wage they actually get at firm j at time t, denoted by Wjt (X ).
The supply curve Sjt (X, W ) exactly defines the number of people willing to work at firm j at
some given wage W . Hence, the density of the willingness to accept among workers in firm j at
time t at wage Wjt (X ) is given by:

                                                 1         Sjt (X, W )
                                                                       .
                                         Sjt (X, Wjt (X ))   W



                                                             11
So we get the average value of the rent by taking the expectation with respect to that density

               w            w
              Rjt (X )  E [Rit | j (i, t) = j, Xi = X ]
                               Wjt (X )
                                                                         1         Sjt (X, W )
                      =                   (Wjt (X ) - W )                                      dW
                           0                                     Sjt (X, Wjt (X ))   W
                                              1
                                                                    1         Sjt (X, Wjt (X ))
                      = Wjt (X )                  (1 -  )                                       d
                                          0                 Sjt (X, Wjt (X ))        
                                              1
                                                             /r
                      = Wjt (X )                  (1 -  )       d
                                          0                 
                         Wjt (X )
                      =           ,
                        1 + /r

where the second to last step relies on the definition of Sjt (X, W ) and the fact that we assume
the presence of many firms in each market to show that Sjt (X, W ) =  /r Sjt (X, W ). We
can then take the average over the productivity levelsXi of the workers i in firm j  Jr at time
t to get:

                         w                        w
                     E [Rit | j (i, t) = j ] = E Rjt (Xi ) | j (i, t) = j
                                                             1
                                                    =           E [Wjt (Xi ) | j (i, t) = j ] .
                                                         1 + /r

Next we want to compute the integral of the market level supply curve for each worker of type
X . In contrast to the worker rent at the firm level, we want to shift the wages of all firms in a
given market for a given individual. This means that we want to shift both the current firm j
but also all other firms j in market r. Given the labor supply curve of firm j , we integrate by
scaling all wages in market r by  in [0, 1]. More precisely, we consider the demand realized by
the set of wages  1[j Jr ] Wjt (X )           jt
                                                   for a given market r. The supply curve of firm j in this
market as a function of the scaling factor  is then

                                                                                     /r      r
                                              j Jr        1/ Gj (X )1/ Wj t (X )
                 N · MX (X )                                                           /r         r
                                     r             j Jr      1/ Gj (X )1/ Wj t (X )
                                                                                  /r
                                                      1/ Gj (X )1/ Wjt (X )
                                     ×                                                 /r
                                                  j Jr     1/ Gj (X )1/ Wj t (X )
                  =   Sjt (X, Wjt (X )),

where we also used the assumption that there are many markets in the first denominator. Hence,
the density of the willingness to accept is given by

                                        1         
                                                     Sjt (X, Wjt (X ))
                                Sjt (X, Wjt (X )) 




                                                               12
and by the same logic as for the firm level we get

                                    wm           wm
                                   Rjt (X )  E [Rit | j (i, t) = j, Xi = X ]
                                                  Wjt (X )
                                              =            ,
                                                  1 + 

and can finally compute the market-level rent:

                            wm                       wm
                        E [Rit | j (i, t) = j ] = E Rjt (Xi ) | j (i, t) = j
                                                          1
                                                   =        E [Wjt (Xi ) | j (i, t) = j ] .
                                                       1 + 




A.3     Employer rents
Employer rents at the firm level

Lemma 5. We establish that the firm rent is given by
                                                                                         (1-r )/r
                                                                                                    
                                                                                     -
            f                               r (1 + /r )               /r                  1+r /r
           Rjt   = jt -    pt
                           jt         = 1 -                                                          jt .
                                            1 + r /r                1 + /r

Proof. The firm rent is defined as the difference between the profit that a firm would make if it
was a price taker and the profit in equilibrium. To get the price-taker profit we maximize

                                                                   1-r
           pt
           jt =        max
                       pt
                           Ajt                     pt
                                            X j · Djt (X )dX               -       pt
                                                                                  Wjt         pt
                                                                                      (X ) · Djt (X )dX,
                     {Djt (X )}


                 pt
taking the wage Wjt (X ) as given, and then equate demand with the supply equation. The first
order condition is                                                 r
                                                           pt   - 1- r
                                                         Yjt                 pt
                                  (1 - r ) Ajt X j                        = Wjt (X )
                                                         Ajt
                                       pt
                                      Cr

and the realized demand is given by

                                                                                      pt         /r
              pt                              Irt (X )             1/          1/
                                                                                    Wjt   (X )
             Djt (X )    = N · MX (X )                                  Gj (X )                        ,
                                               I (X )                                Irt (X )

where we use I (X )               r   Ir t (X ) , assumed constant due to the large number of markets.




                                                          13
We then get that

  pt                                         1-r
Yjt                     pt
     =           X j · Djt (X )dX
Ajt
                                                                                                                1-r
                                                                         pt           /r
                           Irt (X )                            /r      Wjt   (X )
      =          X j ·                       ( Gj (X ))                                       N MX (X )dX 
                            I (X )                                      Irt (X )
                                                                                                       r     /r             1-r
                                                                                              pt    - 1- r
                                                                      pt        j           Yjt
                           Irt (X )                            /r    Cr Ajt X                                                 
      =          X j ·                       ( Gj (X ))                                                           N MX (X )dX 
                            I (X )                                     Irt (X )             Ajt

                                        pt    -r /r
                 (1-r )/r             Yjt
      = (Ajt )
                                      Ajt
                                                                                        /r                        1-r
                                             
                           j      Irt (X )                       /r        X j Crpt
             ×         X                        ( Gj (X ))                                         N MX (X )dX
                                   I (X )                                  Irt (X )
                           (1-r )/r             pt      -r /r
           pt
          Cr                                  Yjt
      =       Ajt
          Cr                                  Ajt
                                                                                       /r                        1-r
                                             
                           j      Irt (X )                       /r        X j Cr
             ×         X                        ( Gj (X ))                                     N MX (X )dX
                                   I (X )                                  Irt (X )

and

                             pt     1+r /r                              (1-r )/r
                           Yjt                             pt
                                                          Cr                                (1-r )(1+r /r )
                                                    =         Ajt                       Hjt
                           Ajt                            Cr
                                                                    /r ·(1-r )
                                                           pt
                                               pt         Cr        1+r /r
                                             Yjt    =                               Yjt ,
                                                          Cr

which we replace to get the wage:
                                                                    r
                                                                 - 1-
                  pt                                    Y pt          r
                 Wjt   (X ) =       pt
                                   Cr  Ajt X j
                                                        Ajt
                                                                              /r
                                                         pt         -r (1+
                                                        Cr                    r /r )
                                                                                             -r
                               =    pt
                                   Cr  Ajt X j              Ajt                             Hjt
                                                        Cr
                                                 1                                                     /r
                                      pt                                          pt           -r (1+
                                     Cr       1+r /r
                                                                                 Cr                    r /r )
                                                                                                                  -r
                               =                               · Cr Ajt X j          Ajt                         Hjt
                                     Cr                                          Cr
                                                 1
                                      pt
                                     Cr       1+r /r
                               =                               Wjt (X ).
                                     Cr




                                                                     14
Similarly, we can express demand as
                                                           /r
                                               pt
                                  pt          Cr         1+r /r
                                 Djt (X ) =                        Djt (X )
                                              Cr

and the wage bill as:


                pt        pt         pt
               Bjt =     Wjt (X ) · Djt (X )dX
                                       1                               /r
                            pt                               pt
                           Cr       1+r /r
                                                            Cr       1+r /r
                   =                          Wjt (X ) ·                         Djt (X )dX
                           Cr                               Cr
                                  1+/r
                         pt
                        Cr       1+r /r
                   =                      Bjt .
                        Cr

                         1+/r
                               1-r
Next, we recall Yjt = Ajt
                       1+r /r
                              Hjt  and get that:


                        Bjt =      Wjt (X ) · Djt (X )dX
                                                            1
                                           -r
                           =       X j Cr Hjt (Ajt ) 1+r /r · Djt (X )dX
                                                                       1

                                    -r               1       Yjt     1-r
                           =    Cr Hjt   (Ajt )   1+r /r
                                                             Ajt
                                                    1                       /r
                                 -r
                           = Cr Hjt (Ajt ) 1+r /r Hjt (Ajt ) (1+r /r )
                           = Cr Yjt .

                           pt    pt pt
And similarly we get that Bjt = Cr Yjt . Finally, we can show:

                  jt - pt
                       jt
                                pt
                              Yjt     pt
                                   - Bjt
                          =1-
                    jt        Yjt - Bjt
                                                           /r ·(1-r )
                                          pt         pt
                                     1 - Cr         Cr     1+r /r
                                 =1-
                                     1 - Cr         Cr
                                                                                (1-r )/r
                                                                            -
                                     r (1 + /r )              /r                 1+r /r
                                 =1-
                                     1 + r /r               1 + /r

                                                                            (1-r )/r
                                                                                       
                                                                        -
                               r (1 + /r )                  /r               1+r /r
              jt - pt
                   jt    = 1 -                                                          jt .
                               1 + r /r                   1 + /r




                                                    15
Employer rents at the market level

Lemma 6. We establish that the market level rents for firm j  Jr is given by
                                                                                   (1-r )
                                                                                            
                                                                               -
                                           r (1 + /r )                /r            1+r 
            fm
           Rjt = jt - ptm
                      jt  = 1 -                                                              jt .
                                           1 + r /r                 1 + /r

Proof. Here we consider the case where all firms in a given market are price takers. In this case
we also get that the Irt (X ) change. The firm wage is still determined by the FOC:
                                                              r
                                                   ptm     - 1- r
                                           j
                                                 Yjt                   ptm
                         (1 - r )Ajt X                              = Wjt  (X ).
                                                  Ajt

However, the labor supply curve is no longer the same as in equilibrium since all firms change
their demand:

                                                ptm                                     /r
              ptm                              Irt  (X )                      1/ W
             Sjt  (X, W )    = N MX (X )                        Gj (X )1/    ptm               ,
                                                 I (X )                     Irt  (X )

where


                                                                              r /( )
                                                                         /r
                                                    /r
                  ptm
                 Irt  (X )              ( Gj (X ))          Wjptm
                                                               t (X )
                                                                                        .
                                 j Jr




                                                     16
                                   ptm
We insert these definitions into Yjt

  ptm                                    1-r
Yjt                  ptm
      =       X j · Djt  (X )dX
 Ajt
                                                                                                    1-r
                          ptm                                   ptm            /r
                         Irt  (X )                     /r      Wjt  (X )
      =       X j ·                        ( Gj (X ))           ptm                 N MX (X )dX 
                          I (X )                               Irt  (X )
                                                                                                  r     /r                    1-r
                          ptm                                                          ptm     - 1- r
                                                                                j    Yjt
      =
       
              X j ·
                         Irt  (X )
                                           ( Gj (X ))
                                                       /r    (1 - r )Ajt X                                    N MX (X )dX 
                                                                                                                          
                                                                  ptm
                          I (X )                                 Irt  (X )              Ajt

                                                                      1-r                                         
                                            ptm                                               /r                        ptm   -r /r
          (1-r )/r                         Irt  (X )                  /r        Crpt
                                                                                     X j                              Yjt
      = Ajt                   X j ·                        ( Gj (X ))            ptm               N MX (X )dX 
                                            I (X )                              Irt (X )                               Ajt

                                                                ptm     1+r /r
                                                              (Hjt      )
                                                                ptm     -r /r
          (1-r )/r         ptm       (1-r )(1+r /r )          Yjt
      = Ajt               Hjt
                                                               Ajt
  ptm
Yjt      (1-r )/r
          1+r /r   ptm               1-r
      = Ajt       Hjt
 Ajt
             1+/r
  ptm    1+r /r  ptm               1-r
Yjt   = Ajt     Hjt

and we get the wage equation:
                                                                                1
                              ptm                 ptm             -r
                             Wjt          pt
                                  (X ) = Cr  X j Hjt                         1+r /r
                                                                            Ajt     .

                                                         ptm
As in the baseline equilibrium we are left with finding Hjt  as a function of the market TFP
and amenities:
                                                                                                     1+     1
                           ptm                                                 /r                          r /r
                          Irt  (X )                     /r      Crpt
                                                                     X j
  ptm
 Hjt  =          X j ·                      ( Gj (X ))           ptm                N MX (X )dX                   .
                            I (X )                              Irt (X )




                                                         17
Note first that
                                                                         r /( )
                                                                 /r
                                         /r
  ptm
 Irt  (X ) =               ( Gj (X ))             Wjptm
                                                     t (X )
                                                                         
                  j Jr
                                                                                                                      r /( )
                                                                           -r      /r                    /r
                                         /r
          =                ( Gj (X ))                pt
                                                    Cr  X j       ptm
                                                                 Hj t                        (Aj t )   1+r /r         
                  j Jr
                                                                                                                            r /( )
                   pt                                                               -r       /r
                  Cr                                 /r                     ptm
                                                                                                                   /r
                                                                                                                            
          =                           ( Gj (X ))              Cr X j       Hj t                        (Aj t )   1+r /r
                  Cr
                               j Jr


                                                                    
                                             ptm            pt
                                                           Cr     1+r  1[j Jr ]
and next we want to show that          =    Hjt            Cr                            Hjt . To see this we observe that
 ~ ptm                                   ~ jt . Indeed
Hjt solves a very similar fixed point to H

                                                                                                                          1+ /
                                                                                                                             r
                                ptm                                                       /r                                  r    r

  ~ ptm =                      Irt  (X )                        /r        Crpt
                                                                               X j
  Hjt             X    j
                           ·                        ( Gj (X ))             ptm                    N MX (X )dX 
                                 I (X )                                   Irt  (X )
                          r 
               pt                     1[j Jr ]
              Cr        1+r /r
                                                     ptm
        =                                        jt Ht   ,
              Cr

where jt (·) is the operator defined in Lemma 2, equation (19) that defines Hjt as a fixed point.
For this operator we know that jt (Ht ) = H ~ jt is the unique fixed point. The next step is to
                                                                                                 r 
                                                                                      pt      - 1+ r  1[j Jr ]
                                                     ~ =                             Cr                               ~ ptm , is a fixed
check that Ht , defined such that its j component is Hjt                             Cr                               Hjt
point of the same operator jt (·).

                                           r         (1-r )r /r
                                pt      - 1+                          1[j Jr ]
                               Cr            r         1+r /r
                                                                                     ptm
         jt Ht =                                                                 jt Ht
                               Cr
                                           r         (1-r )r /r                                       r 
                                pt      - 1+                          1[j Jr ]              pt    - 1+   1[j Jr ]
                               Cr            r         1+r /r
                                                                                 ~ ptm     Cr          /  r       r
                           =                                                     Hjt
                               Cr                                                          Cr
                                           r         (1-r )r /r                   r 
                                pt      - 1+                          1[j Jr ]- 1+   1[j Jr ]
                               Cr            r         1+r /r                      /r        r
                                                                                                        ~ ptm
                           =                                                                            Hjt
                               Cr
                                           r 
                                pt      - 1+ r  1[j Jr ]
                               Cr                          ~ ptm
                           =                               Hjt
                               Cr
                            ~ jt ,
                           =H

hence Hjt = Hjt for all j and so we get that:

                                                                   
                                                          pt     1+r  1[j Jr ]
                                           ptm           Cr
                                          Hjt       =                                Hjt .
                                                         Cr




                                                                 18
So, we find for j  Jr that
                                                                          1
                     ptm                 ptm                 -r
                    Wjt          pt
                         (X ) = Cr  X j Hjt                        1+r /r
                                                                  Ajt
                                                                                       r 
                                                                               pt   - 1+
                                      pt       j    -r 1+r /r
                                                                  1
                                                                              Cr         r 
                                 =   Cr    X       Hjt Ajt
                                                                              Cr
                                                   1
                                          pt
                                         Cr      1+r 
                                 =                          Wjt (X )
                                         Cr

and then:
                                                                                      r /( )
                                                                                /r
                                                       /r
                  ptm
                 Irt  (X ) =             ( Gj (X ))             Wjptm
                                                                   t (X )
                                                                                      
                                 j Jr
                                             1
                                  pt
                                 Cr        1+r 
                             =                      Irt (X ).
                                 Cr

Next, let us rewrite the realized demand:

                           ptm                                         ptm          /r
             ptm          Irt  (X )                          /r       Wjt  (X )
            Djt  (X ) =                        ( Gj (X ))               ptm
                            I (X )                                     Irt  (X )
                                      
                           pt                                                                    /r
                          Cr        1+r 
                                                 Irt (X )                      /r     Wjt (X )
                     =                                          ( Gj (X ))
                          Cr                      I (X )                              Irt (X )
                                      
                           pt
                          Cr        1+r 
                     =                         Djt (X ).
                          Cr

We then go back and compute output and wage bills:

                                                                                1-r
                               ptm                         ptm
                             Yjt   = Ajt            X j · Djt  (X )dX
                                                    (1-r )
                                            pt
                                           Cr        1+r 
                                     =                          Yjt
                                           Cr
                              ptm           ptm         ptm
                             Bjt  =        Wjt  (X ) · Djt  (X )dX
                                        pt   ptm
                                     = Cr  Yjt   .




                                                       19
Finally, we establish that:

                   jt - ptm
                         jt
                                  ptm
                                Yjt      ptm
                                      - Bjt
                            =1-
                      jt          Yjt - Bjt
                                                             (1-r )
                                            pt        pt
                                       1 - Cr        Cr       1+r 
                                   =1-
                                       1 - Cr        Cr
                                                                                 (1-r )
                                                                             -
                                       r (1 + /r )             /r                 1+r 
                                   =1-
                                       1 + r /r              1 + /r

                                                                             (1-r )
                                                                                      
                                                                         -
                                    r (1 + /r )              /r               1+r 
               jt - ptm
                    jt        = 1 -                                                    jt .
                                    1 + r /r               1 + /r




A.4     Walrasian Equilibrium, Wedges, Tax Policy, and Welfare
Walrasian Equilibrium

We consider an equilibrium as defined by a set of wages Wjt
                                                         c
                                                            (X ) such that workers optimally
choose where to work given these wages, and firms optimally choose labor demand, also taking
these wages as given. In this equilibrium we make the tax system neutral  =  = 1.

                                                       1-r
                   max Ajt          X j Djt
                                         c
                                            (X )dX           -      c
                                                                   Wjt      c
                                                                       (X )Djt (X )dX
                 {Djt
                   c (X )
                         }

which gives the first order condition

                                                                   -r
                      (1 - r )X j Ajt         X j · Djt
                                                     c
                                                        (X )dX             c
                                                                        = Wjt (X )

or                                                                     r
                                                               c    - 1-
                               c                     j
                                                             Yjt         r
                              Wjt (X )   = (1 - r ) X Ajt                    .
                                                             Ajt
                                             pt
                                            Cr




                                                  20
We then solve for output
              1
    c
  Yjt       1-r
                  =       X j · Djt
                                 c
                                    (X )dX
  Ajt
                                                                                        c                    /r
                                                           c
                                                         (Irt (X ))                    Wjt (X )Gj (X )
                  =       X j N MX (X ) ·                                     
                                                                                   ·        c (X )                 dX
                                                         r
                                                               c (X ))
                                                             (Ir t
                                                                                           Irt
                                                                                                                                            r /r
                                                                       pt j                     /r                                  c   -
                              j
                                        c
                                      (Irt (X ))                      Cr X Gj (X )                                       /        Yjt       1-r
                  =       X       ·                          
                                                                ·         c (X )                        N MX (X )dX ×   Ajt r
                                      r
                                            c (X ))
                                          (Ir t
                                                                         Irt                                                      Ajt
                                                                             r /r
                                                               c         -
                       c 1+r /r              /               Yjt             1-r
                  =   Hjt                   Ajt r
                                                             Ajt


                                                        c
                                                      Yjt    (1-r )/r
                                                              1+r /r   c                       1-r
                                                          = Ajt       Hjt
                                                      Ajt
                                                                         1+/r
                                                        c    1+r /r  c                        1-r
                                                      Yjt = Ajt     Hjt                             ,

where we defined

                                                           c                             pt j               /r
                 c 1+/r                       j          (Irt (X ))                     Cr X Gj (X )
                Hjt                       X       ·                           
                                                                                   ·        c (X )                 N MX (X )dX,
                                                         r
                                                               c (X ))
                                                             (Ir t
                                                                                           Irt

giving the wage:

                                       c          pt j  c                              -r               1
                                      Wjt (X ) = Cr X  Hjt                                   (Ajt ) 1+r /r .

                                          (r -1)/r
                   c ¯ (1+r  )(1+r /r )
Next, using Hjt
             c
                = Hj Art                and following a similar proof to the main proposition
we find that
                           c                                                               1          1
                          wj (x, a  ~) = cpt + j x - r hc
                                 ¯, a                   j +                                     a
                                                                                                ~+        a
                                                                                                          ¯,
                                                                                       1 + r /r    1 + r 
where
                                                                                                                                     1
                                           c                                       /r                       /r                     1+r /r
                                          Ir 0 (X )                    1                      pt °                 °
      c
     Hj =           X j (1+/r )             c                        c                       Cr Gj (X )             N MX (X )dX
                                          I0 (X )                   Ir0 (X )                                      r
                                                                                                /r          r /
                                                                    -r       /r               1+r /r
 c
Ir 0 (X )   =     Ej Jr       °j (X )X j Cr
                              G           pt  c
                                             Hj                                        ~jt
                                                                                       A

                                                                1/
                              
  c
 I0 (X ) =        Er Ir
                      c
                        0 (X ) Art            1+r 
                                                                     .




                                                                              21
We can then get the allocation of workers to each firm given by
                                                                                1
                                                                                                              /r
                                                     c       ¯ 1+r                               c
                                                                                         Gj (X )Wjt (X )
        for j  Jr          c
                          Djt (X ) =      °MX (X )  Ir0 (X )Art
                                       nr N                                                              1
                                                                                                                    ,
                                                          c
                                                         I0 (X )                                ¯rt
                                                                                          c (X )A
                                                                                         Ir       1+r 
                                                                                            0


where we note that  does not enter.
   We first study the effect of market power on the allocation. This effect shows up in the
                                 /r
market-specific constant        1+/r .     In the case where r =  in all regions, the markdown only
acts as an overall economy markdown but does not affect allocation. To see this, we note that
when r =  the fixed point for hj reduces to the fixed-point of hp
                                                                j times a constant. Hence we
end up with only a scaling in the equilibrium equation but without distortion in the marginal
rate of substitution for workers across firms.
   In the case where r are not the same across regions, a wedge appears in the wage equation.
Consequently, this creates a wedge in the allocation. Correcting such misallocation can be
achieved by setting region-specific taxes r precisely to the inverse of the wedge, as discussed
below, which results in the planner's allocation.
   As shown below, we can also use the planner's solution to evaluate the effects of counterfac-
tual tax policies. The parameter  alone does not create a wedge in the wage equation, and it
does not affect the allocation, as all options are equally affected.

Defining wedges

To define wedges, we consider our wage index I and a within market wage W/I . We then look at
the decisions of firms to set wages, the decisions of workers to choose markets, and the decisions
of workers to choose particular firms within markets. We express each of these decisions in the
monopsonistic competition model, making clear the sources of wedges in each equation.
   The first wedge is a productivity wedge reflected in the wage equation:

                                             r(j )      -1                                  -r(j )
                     Wjt (X ) =        1+                      ·       X j (1 - r(j ) )Ajt Ljt           .
                                             
                                                                   marginal product of labor: Mjt (X )
                                    labor prod. wedge


   We next turn to the quantity of labor expression. For this we compute the log odds ratio
of choosing one firm versus another within a market. The allocation is identical in all respects
besides for the presence of the tax parameter  which acts as a preference wedge between
amenities and earnings. We have:
                                                                                                                          
       Pr[j (i, t) = j | {Wjt (X )}j =1,...,J , X, j  Jr ]               
 log                                                               =           log Gj (X ) +                  log
                                                                                                                  Wj (X ) 
       Pr[j (i, t) = j ; | {Wjt (X )}j =1,...,J , X, j  Jr ]           r(j )       Gj (X )                        Wj (X )
                                                                                                 pref wedge


   We now shift attention to the worker's problem and solution in the two types of labor



                                                          22
markets. It is useful to express wages using the wage index Irt (X ) from equation (2) as:

                      Pr[j (i, t)  Jr | {Wjt (X )}j =1,...,J , X ]                              Ir (X )
                log                                                    =                 log
                      Pr[j (i, t)  Jr | {Wjt (X )}j =1,...,J , X ]                              Ir (X )
                                                                           pref wedge

                                                                                        r(j )
   The results clarify two wedges: a producitivty wedge equal to 1 +                            and a marginal utility
of income wedge equal to .

Defining tax policy counterfactuals
                                                      1+/r
Lemma 7. Setting a tax policy with r =                 /r        and  = 1 achieves the competitive allocation
of workers to firms.
                           1+/r
Proof. We plug r =          /r         into the firm problem and show that it achieves the planner's
solution in this context. Recall from Lemma 3
                                                                                                                     1
                                                                  /r                      /r                      1+r /r
                                  Ir0 (X )               1                 °j (X ) C               °
    Hj =       X j (1+/r )                                                 G        r               N M (X )dX
                                  I0 (X )             Ir0 (X )                                    r
                                                        /r         /r

Ir0 (X )/r = Ej        °j (X )X j Cr
                       G            -r
                                     Hj                        ~ 1+r /r
                                                               Ajt

                                  
                      ¯rt
I0 (X ) = Er Ir0 (X ) A 1+r 
                             ,


where we notice that  Cr
                       
                         always appears together and under this particular policy we get that
   
r Cr               pt
     = (1 - r ) = Cr  . Hence, hj coincides exactly with hc
                                                          j while Ir 0 (X ) and I0 (X ) coincide
with Ir
      c
        0 (X ) and I0 (X ), respectively. We then see that this implies that Djt (X ) = Djt (X ). In
                    c                                                                    c

other words such policy achieves exactly the planner's allocation.

Defining welfare

We start by defining a measure of welfare given a set of wages and tax parameters. Recall that
the average utility that a worker enjoys for a given set of wages is given by:
                                                                                        r          
                      1                                      /r                /r 
   E [uit |Wt ] =      log                        ( Gj (X ))       (Wjt (X ))               + C  MX (X )dX,
                                   r       j Jr




                                                          23
where we normalize C to zero. The total tax revenue Rt and total firm profits t are given by:

            Rt =                      Djt (X ) Wjt (X ) -  Wjt (X ) dX
                          r    j Jr

                  =                   Djt (X )Wjt (X )dX -                        Djt (X ) Wjt (X ) dX
                          r    j Jr                                    r   j Jr
                               net
                  = Bt -      Bt
                                                                     1-r
            t =                    Ajt          X j · Djt (X )dX            -      Wjt (X ) · Djt (X )dX
                      r   j Jr

                  = Yt - Bt .

To take into account changes in tax revenue and firm profits across counterfactuals, we redis-
tribute t and Rt to workers in the form of a non-distortionary payment proportional to their
net wages, governed by t . This means that each worker receives t  Wjt (X ) in transfers. The
total transfer equals t + Rt and is given by

                                                 t  Wjt (X ) · Djt (X )dX = t + Rt
                                     r    j Jr
                                                                          net
                                                                      t B t   = t + Rt

and hence
                                                                      net
                                                          t + Rt + Bt
                                                 1 + t =          net
                                                                Bt
                                                          t + Bt
                                                        =     net
                                                           Bt
                                                           Yt
                                                        = net .
                                                          Bt

Thus, welfare is given by
                                                                                            r 
                   1                                                /r                /r          MX (X )dX
       Wt =         log                         ((1 + t ) Gj (X ))         (Wjt (X ))
                               r         j Jr

            =                 E [uit |Wt ]               +                      log(1 + t ).
                utility from net-wages and amenities         utility from redistributed profits and tax revenue


A.5    An extension with capital and monopolistic competition in the
       product market
We develop here a simple extension of the model with capital and monopolistic competition
in the product market. Without loss of generality, we derive the results here in the case of
homogeneous labor.


                                                             24
    Consider a firm with production function Q = AK  L1- , access to a local monopolistic
market with revenue curve Y = Q1- , hiring labor from a local labor supply curve L(W ) = W 
and renting capital at price r. Profit is given by:

                                        Q1- - LW - rK.

We first note that we can replace Q with the production function and get

                                               1-
                                   AK  L1-            - LW - rK.

Now we will show that considering perfect or monopolistic competition in the product mar-
ket gives rise to the same revenue function. We will focus directly on the revenue function
parameterized as
                                                ~ 1-
                                         Y = AK  L ~,

where ~  (1 - ) and ~   + -  . We then have the following Lagrangian for our problem:

                                 ~ 1-
                              AK  L ~ - LW - rK - µ(L - W  ).

We take the first order condition for K and get
                                                             1
                                               r            ~-1
                                                            
                                      K=                          ,
                                             ~AL1-
                                                  ~


which we then replace in
                                                       ~                                    1

              ~ 1-~                        r          ~-1
                                                      
                                                              1-~                  r       ~-1
          AK L        - LW - rK = A                         L         - LW - r
                                         ~AL1-
                                              ~                                  ~AL1-
                                                                                      ~
                                                                  ~
                                                  r              ~-1
                                                                 
                                  = (1 - ~)A                           L1-~
                                                                            - LW
                                                ~AL1-
                                                     ~
                                                         ~
                                                 r      ~-1
                                                                      ~ +~
                                  = (1 - ~)A                    L1- 1-~ - LW
                                                ~A
                                    ^ 1-
                                  = AL  ^
                                          - LW,

                                                                                           ~
                                                                                          ~-1
                                                                                          
                                                              ^  (1 - 
which is just a reinterpretation of the original problem with A                                      ~ +~
                                                                                                        ~.
                                                                                     r
                                                                      ~)A           A
                                                                                    ~           ,^   1-



B     Details on Data Sources and Sample Selection
All firm level variables are constructed from annual business tax returns over the years 2001-
2015: C-Corporations (Form 1120), S-Corporations (Form 1120-S), and Partnerships (Form
1065). Worker-level variables are constructed from annual tax returns over the years 2001-2015:
Direct employees (Form W-2), independent contractors (Form 1099), and household income and

                                                25
taxation (Form 1040).
   Variable Definitions:

   · Earnings: Reported on W-2 box 1 for each Taxpayer Identification Number (TIN). Each
     TIN is de-identified in our data.

   · Gross Household Income: We define gross household income as the sum of taxable
     wages and other income (line 22 on Form 1040) minus unemployment benefits (line 19
     on Form 1040) minus taxable Social Security benefits (line 20a on Form 1040) plus tax-
     exempt interest income (line 8b on Form 1040). We at times also consider this measure
     when subtracting off Schedule D capital gains (line 13 on Form 1040).

   · Federal Taxes on Household Income: This is given by the sum of two components.
     The first component is the sum of FICA Social Security taxes (given by 0.0620 times
     the minimum of the Social Security taxable earnings threshold, which varies by year, and
     taxable FICA earnings, which are reported on Box 3 of Form W-2) and FICA Medicare
     taxes (given by 0.0145 times Medicare earnings, which are reported on Box 5 of Form
     W-2). The second component is the sum of the amount of taxes owed (the difference
     between line 63 and line 74 on Form 1040, which is negative to indicate a refund) and the
     taxes already paid or withheld (the sum of lines 64, 65, 70, and 71 on Form 1040).

   · Net Household Income: We construct a measure of net household income as Gross
     Household Income minus Federal Taxes on Household Income plus two types of benefits:
     unemployment benefits (line 19 of Form 1040) and Social Security benefits (line 20a of
     Form 1040).

   · Employer: The Employer Identification Number (EIN) reported on W-2 for a given TIN.
     Each EIN is de-identified in our data.

   · Wage Bill: Sum of Earnings for a given EIN plus the sum of 1099-MISC, box 7 nonem-
     ployee compensation for a given EIN in year t.

   · Size: Number of FTE workers matched to an EIN in year t.

   · NAICS Code: The NAICS code is reported on line 21 on Schedule K of Form 1120 for
     C-corporations, line 2a Schedule B of Form 1120S for S-corporations, and Box A of form
     1065 for partnerships. We consider the first two digits to be the industry. We code invalid
     industries as missing.

   · Commuting Zone: This is formed by mapping the ZIP code from the business filing
     address of the EIN on Form 1120, 1120S, or 1065 to its commuting zone.

   · Value Added: Line 3 of Form 1120 for C-Corporations, Form 1120S for S-Corporations,
     and Form 1065 for partnerships. Line 3 is the difference between Revenues, reported on


                                              26
  Line 1c, and the Cost of Goods Sold, reported on Line 2. We replace non-positive value
  added with missing values.

    ­ For manufacturers (NAICS Codes beginning 31, 32, or 33) and miners (NAICS Codes
       beginning 212), Line 3 is equal to Value Added minus Production Wages, defined
       as wage compensation for workers directly involved in the production process, per
       Schedule A, Line 3 instructions. If we had access to data from Form 1125-A, Line 3,
       we could directly add back in these production wages to recover value added. Without
       1125-A, Line 3, we construct a measure of Production Wages as the difference between
       the Wage Bill and the Firm-reported Taxable Labor Compensation, defined below, as
       these differ conceptually only due to the inclusion of production wages in the Wage
       Bill.

· Value Added Net of Depreciation: Value Added minus Depreciation, where Depreci-
  ation is reported on Line 20 on Form 1120 for C-corporations, Line 14 on Form 1120S for
  S-corporations, and Line 16c on Form 1065 for partnerships.

· EBITD: We follow Kline et al. (2019) in defining Earnings Before Interest, Taxes, and
  Depreciation (EBITD) as the difference between total income and total deductions other
  than interest and depreciation. Total income is reported on Line 11 on Form 1120 for
  C-corporations, Line 1c on Form 1120S for S-corporations, and Line 1c on Form 1065 for
  Partnerships. Total deductions other than interest and depreciation are computed as Line
  27 minus Lines 18 and 20 on Form 1120 for C-corporations, Line 20 minus Lines 13 and
  14 on Firm 1120S for S-corporations, and Line 21 minus Lines 15 and 16c on Form 1065
  for partnerships.

· Operating Profits: We follow Kline et al. (2019), who use a similar approach to Yagan
  (2015), in defining Operating Profits as the sum of Lines 1c, 18, and 20, minus the sum of
  Lines 2 and 27 on Form 1120 for C-corporations,, the sum of Lines 1c, 13, and 15, minus
  the sum of Lines 2 and 20 on Form 1120S for S-corporations, and the sum of Lines 1c, 16,
  and 16c, minus the sum of Lines 2 and 21 on Form 1065 for partnerships.

· Firm-reported Taxable Labor Compensation: This is the sum of compensation
  of officers and salaries and wages, reported on Lines 12 and 13 on Form 1120 for C-
  corporations, Lines 7 and 8 on Form 1120S for S-corporations, and Lines 9 and 10 on
  Form 1065 for Partnerships.

· Firm-reported Non-taxable Labor Compensation: This is the sum of employer
  pension and employee benefit program contributions, reported on Lines 17 and 18 on
  Form 1120 for C-corporations, Lines 17 and 18 on form 1120S for S-corporations, and
  Lines 18 and 19 on Form 1065 for Partnerships.




                                          27
    · Multinational Firm: We define an EIN as a multinational in year t if it reports a non-
      zero foreign tax credit on Schedule J, Part I, Line 5a of Form 1120 or Form 1118, Schedule
      B, Part III, Line 6 of Form 1118 for a C-corporation in year t, or if it reports a positive
      Total Foreign Taxes Amount on Schedule K, Line 16l of of Form 1065 for a partnership in
      year t.

    · Tenure: For a given TIN, we define tenure at the EIN as the number of prior years in
      which the EIN was the highest-paying.

    · Age and Sex: Age at t is the difference between t and birth year reported on Data
      Master-1 (DM-1) from the Social Security Administration, and sex is the gender reported
      on DM-1 (see for further details on the DM-1 link).


C     Details on Identification, Estimation, and Robustness
C.1     Moment condition in the dynamic model
We now derive the identifying equations for the parameters of interest using the population
of workers that stay within the same firm over time (stayers). We seek to establish that the
following moment condition holds in the model:

                                           1
          E ~        ~it+ - w
            yj (i),t w      ~it- -             ~j (i),t+ - y
                                               y           ~j (i),t-         |Si =1 = 0
                                       1 + /r
                                             1
                E ¯
                  yj (i),t w
                           ¯it+   -w
                                   ¯it- -      ¯j (i),t+ - y
                                               y           ¯j (i),t-         |Si =1 = 0
                                          1 + 
                                                                      for   2,   3

which are the conditions of equation (12). We start by looking at each quantity using the
structure of the model:
                                                    t+
                                     1 + /r
                   ~it+ - y
                   y      ~j,t- =                          ~jt + j,t+ - j,t-
                                                           u
                                    1 + r /r
                                                t =t- +1
                                                                    t+
                                                        1
                   ~it+ - w
                   w      ~it- =vit+ - vi,t- +                               u
                                                                             ~jt
                                                    1 + r /r
                                                                  t =t- +1


and hence we get

                              1                                     1
       w      ~it- -
       ~it+ - w                  ~j (i),t+ - y
                                 y           ~j (i),t-     =-          (j,t+ - j,t- )
                          1 + /r                                1 + /r
                                                            + vit+ - vi,t-




                                               28
and

                                            1
                           ~
                           yj (i),t =            ~j (i),t + j,t - j,t-1
                                                 u
                                        1 + r /r

We combine these expressions to construct:

E ~        ~it+ - w
  yj (i),t w      ~it- -  y
                          ~j (i),t+ - y
                                      ~j (i),t-           |Si =1
              1                                           1
  =E               ~j (i),t + j,t - j,t-1
                   u                              -          (j,t+ - j,t- ) + vit+ - vi,t-        |Si =1
          1 + r /r                                    1 + /r

Given Assumption 1.b that E [jt j t |T ] =0 whenever |t - t |  2, it follows that whenever  
2 and   3, all cross-products between jt terms will be mean zero. Furthermore, E [jt |T ] =0
ensures that cross-product terms between u
                                         ~jt and jt are also mean zero. Finally the assumption
that the measurement error on wages is independent of all firm level variables, Assumption 1.c,
implies that all terms involving vit are also mean zero. Thus, provided that   2 or   3,

                                               1
         E ~        ~it+ - w
           yj (i),t w      ~it- -                 ~j (i),t+ - y
                                                  y           ~j (i),t-             |Si =1 = 0.
                                           1 + /r
As a result,     1
               1+/r   is identified as long as,

                           E ~        ~j (i),t+ - y
                             yj (i),t y           ~j (i),t-   |Si =1 > 0,

which is guaranteed by Assumption 1.a.
   A similar result can be established when replacing ~
                                                      yj (i),t with simply y j (i),t . The deriva-
tion of the second moment condition involving  follows from an identical derivation at the
market level:
                                                              t+
                                               1
                        ¯it+ - w
                        w      ¯it- =                                u
                                                                     ¯r(j (i)),d
                                           1 + r(j (i)) 
                                                           d=t- +1
                                                           t+
                                             1 + 
                        ¯jt+ - y
                        y      ¯jt- =                              u
                                                                   ¯r(j ),d
                                           1 + r(j ) 
                                                         d=t- +1


which cancel out differences to imply the moment condition:

                                               1
           E ¯        ¯it+ - w
             yj (i),t w      ¯it- -              ¯j (i),t+ - y
                                                 y           ¯j (i),t-             |Si =1 = 0.
                                            1 + 

Similarly, the rank condition is guaranteed by Assumption 1.a.




                                                  29
C.2     Moment conditions for external instruments
First, note that the wage equation with time-varying amenities is,

                                                              a
                                                              ¯r(i,t)t       a
                                                                             ~j (i,t)t
         wit = j (i,t) xi + cr(i,t) - r(i,t) hj (i,t)t +               +               + vit
                                                           1 + r(i,t)    1 + r(i,t) /r

In differences, this becomes,

                                                     ¯rt - a
                                                     a     ¯rt-   ~j (i)t - a
                                                                  a         ~j (i)t-
      wit - wit- = -r hj (i)t - hj (i)t- +                      +                    + vit - vit-
                                                      1 + r         1 + r /r

    Suppose we observe an instrument for firm level TFP a
                                                        ~, denoted Zjt
                                                                    a
                                                                    ~
                                                                       , satisfying the following
firm level condition:
                                           a
                                           ~
Assumption 1.d. The firm level instrument Zjt is relevant for firm level productivity changes,
E   ~j (i)t -a
    a                   a
                        ~
             ~j (i)t-e Zjt = 0, and exogenous of changes in firm level amenities hjt ,
E                       a
                        ~
    hj (i)t -hj (i)t-e Zjt = 0.

Furthermore, suppose we observe a market level instrument for market level TFP a, denoted
 a
Zrt , satisfying the following market level condition:
                                             a
Assumption 1.e. The market level instrument Zjt is relevant for market level productivity
changes, E (art -art-e ) Zrt
                          a
                             = 0, and exogenous of changes in market level amenities hrt ,
E               a
    hrt -hrt-e Zrt = 0.

Under assumptions 1.d and 1.e, and the independence assumption of the measurement errors,
1.b part i) and 1.c, equation (12) identifies r when replacing ~
                                                               yjt with Zjt
                                                                         a
                                                                         ~
                                                                            and equation (13)
identifies  when replacing y rt with Zrt
                                      a
                                         , respectively. The relevance of the instrument replaces
the long term dependence assumption of productivity guaranteed by assumption 1.a. The ex-
ogeneity restriction replaces the finite dependence assumption 1.b part ii) and the assumption
that amenities are fixed over time.
    Concretely, conditional on Si =1, j (i)=j  Jr , Assumption 1.d implies that,


                    E (w
                       ~it -w       ~
                                    a
                            ~it- ) Zjt           E      1
                                                     1+r /r      ajt -a
                                                                (~            ~
                                                                              a
                                                                      ~jt- ) Zjt
                                             =                                     = r
                    E (~
                       yjt -y       a
                                    ~
                            ~jt- ) Zjt           E    1+/r
                                                                 ajt -a
                                                                (~            a
                                                                              ~
                                                                      ~jt- ) Zjt
                                                     1+r /r


Furthermore, averaging across j  Jr , we have,

                                                 ¯rt - a
                                         ¯ rt- + a
                                  ¯ rt - h             ¯rt-
                  ¯rt - w
                  w     ¯rt- = -r h                          ¯rt - v
                                                            +v     ¯rt-
                                                  1 + r 

      ¯ rt  E [hjt |j  Jr ] and v
where h                         ¯rt  E [vit |j (i, t) = j  Jr ]. Thus, conditional on Si =1, Assump-




                                                      30
tion 1.e implies that,


                       E [(wrt -wrt- ) Zrt
                                         ¯
                                         a
                                            ]   E          1
                                                        1+r /r      art -a
                                                                   (¯            ¯
                                                                                 a
                                                                         ¯rt- ) Zrt
                                              =                                         =
                       E [(yrt -yrt- ) Zrt ]
                                        ¯
                                        a
                                                E        1+/r
                                                                    art -a
                                                                   (¯            a
                                                                                 ¯
                                                                         ¯rt- ) Zrt
                                                        1+r /r


C.3        Estimating the rest of the process parameters
In this section we describe the estimation procedure for a joint process of log earnings and value
added where both are unit root plus a MA term, and both transitory and permanent shocks to
value added passtrhough to log earnings. We estimate the pass-through process in two steps.
First, we estimate the parameters for the value added process. Second, we jointly estimate the
pass-through rates at the firm and market level and the parameters of the wage process for the
worker.
   For the value added process, we use a GMM approach where we put the full variance-
covariance in growth from a panel of 8-year spells for stayers. The matrix of moments uses the
growth at t = 3, 4, 5, 6, 7.1 This is in order to not use any data from the first (t = 1) and last
(t = 8) years of the spell. We do this because first and last years of a spell can be partial spells,
hence focusing on the middle alleviates the issue of not observing within-years dates for start
and end of job.
   So we construct a 5 × 5 matrix My from the data where the (p, q ) element is My (p, q ) =
Cov (yip , yiq ). We can construct the same moments matrix in the model as a function of
{ y , u ,  } which we denote My
                              
                                (p, q ;  y , u ,  ).We use as a matrix the diagonal matrix with
variance implied by joint normality across the yit . The weight associated with Cov (yip , yiq )
is then Wy (p, q ) = Cov (yip , yiq )2 + V ar(yip )V ar(yiq ).
   The estimator is the minimum distance estimator defined as:

                                   7    7
                                                                                              2
                     arg ymin                Wy (p, q ) My (p, q ;  y , u ,  ) - My (p, q )       .
                          ,u ,
                                  p=3 q =3

   In step 2 we construct two matrices each of size 5 × 5:

                                        Mw (p, q ) = Cov (wip , wiq )
                                       Mwy (p, q ) = Cov (wip , yiq ),

and we denote Mw
               
                 (p, q ;  w , µ ,  , ,  ) and Mwy
                                               
                                                  (p, q ;  w , µ ,  ) as the matrices constructed
from the model. These matrices are also functions of ( y , u ,  ) and we use the parameters
estimated in the first step. The weighting matrix is constructed in a similar way using diagonal
  1 In   the case of MA(1), one can also use t = 2, however we wanted to test for MA(2) as a robustness.




                                                         31
weights only and the joint normality assumption.

                        Ww (p, q ) = Cov (wip , wiq )2 + V ar(wip )V ar(wiq )
                      Wwy (p, q ) = Cov (wip , yiq )2 + V ar(wip )V ar(yiq )

Finally we do the following:

                               7   7
                                                                                               2
        arg      w
                  min                    Ww (p, q ) (Mw (p, q ;  w , µ ,  , ,  ) - Mw (p, q )) +
              p,q ; ,µ , ,,
                              p=3 q =3
                                                                                                    2
                                           Wwy (p, q ) Mwy (p, q ;  w , µ ,  , ,  ) - Mwy (p, q )       .

   In practice, all of these expressions are polynomials in the parameters. We solve the mini-
mization problem using global polynomial optimization as in Lasserre (2001). This allows us to
formally certify the global optimality of the solution.
   For inference, we use a joint bootstrap of My , Mw , Myw . We computed the bootstrap by
resampling at the commuting zone by industry level, representing about 2000 clusters. The
results are displayed in Online Appendix Table A.4.


C.4     Interacted fixed effect equation, firm specific TFP ajt and ameni-
        ties hj
Identification details

We consider the equation in the text,

                                 1                   r                j (i, t)=j
                    E wit -         yrt - y
                                   (¯     ¯r,1 ) -       yjt - y
                                                        (~     ~j,1 )                      .
                              1 +                  r +                  j  Jr

We assume that the initial condition for value added permanent component is a      ~j and
                                                                            ~j 1 = p
a         ¯r . We then get that
¯r(j )1 = p

                                                       1                     1
               wit = j xi + cr - r hj (i,t) +               a
                                                            ~j (i,t),t +        a
                                                                                ¯r(j (i,t)),t + vit
                                                   1 + r /r              1 + r 
                       1 + /r
      ~j,t
      y    -y
            ~j, 1 =             (~ajt - p ~j )
                      1 + r /r
                       1 + 
       ¯rt
       y   -y
            ¯r, 1   =         art - p
                             (¯      ¯r )
                      1 + r 

Given that the measurement error in yjt is mean zero and the same applies to vit even conditional
on mobility as given by assumptions 1.b and 1.c, we get that:

                         1                   r                j (i, t)=j
          E wit -           yrt - y
                           (¯     ¯r,1 ) -       yjt - y
                                                (~     ~j,1 )                        =  j x i + j ,
                      1 +                  r +                  j  Jr


                                                       32
where we define
                                                          1        r
                                j  cr - r hj +              p
                                                            ¯r +      p
                                                                      ~j .
                                                       1 +       r + 
We can identify j from data on the changes in earnings associated with these moves:

              E[wit
                 a
                    +1 |j (i, t)=j , j (i, t+1)=j ] - E[wit |j (i, t)=j, j (i, t+1)=j ]
                                                         a
                                                                                          j
                                                                                        =         (20)
              E[wit |j (i, t)=j , j (i, t+1)=j ] - E[wit+1 |j (i, t)=j, j (i, t+1)=j ]
                 a                                     a                                  j


as long as the denominator is non zero as ensured by the following assumption:

                      E [xi |j (i, t)=j, j (i, t+1)=j ] = E [xi |j (i, t)=j , j (i, t+1)=j ] .

Individual types xi are then also idenfitied from Assumption 1.c since
                                                      a
                                                     wit - j (i,t)
                                           xi = E                  i .
                                                         j (i,t)

Using such xi we can construct the exact workforce of each firm at each time and hence identidy
the total efficiency of labor at each firm given by:

                                         ljt = log     X j Djt (X )dX.

Since the production function paramters j is already known, we get an expression for ajt

                                            E [yjt - j ljt |j ] = ajt .

We can use this to construct art = E[ajt |j  Jr ] and a~jt = ajt - art . This then identifies the
permanent components p   ~j and p
                                ~r as well as the inovation variances u ~ and u
                                                                        2
                                                                               ¯ . The final step
                                                                               2

is to use the expression of j to back out hj .



Estimation details

Equation 14 and 20 make clear that the parameters governing nonlinearities are identified from
comparing the gains from moving from a low to a high type of firm for workers of different
quality. In practice, we simultaneously recover (j , j ) from the following moment condition:

                          a                      a
                         wit +1   j             wit   j
                  E             -          -        -          j (i, t)=j, j (i, t+1)=j    = 0.   (21)
                          j       j             j     j


This moment condition provides an instrumental variables representation where the interactions
between indicators for firm before the move and firm after the move can be interpreted as the
instruments and the parameters are ( 1
                                     1
                                       , ..., 1
                                              K
                                                ,1 , ..., K ). In practice, with 10 firm types, this
                                                 1        K




                                                        33
equation provides 100 moments and 20 unknown parameters. As a result, this can be interpreted
as an over-identified model. Following Bonhomme et al. (2019), estimation is implemented using
LIML on these moment conditions where the j are concentrated on the post-move time period
(in theory they can be estimated without imposing stationarity). To check the relevance of
these instruments, we compute the F-statistic corresponding to the first-stage regression, which
is 9288 with an R-squared of about 0.30.
                                                                                                       wa -
   Regaring the estimation of xi , we use a sample analog and compute x     1
                                                                       ^i = T    t
                                                                                   it   k(j (i,t))
                                                                                    k(j (i,t))     .
            ^   ^
In general, j , j would suffer from incidental parameter bias, even under the assumption that
j = 1, see Bonhomme et al. (2020). However we maintain the assumption that we have a small
set of discrete type that we estimate in a first step, aleviating such concern. Given j , j , we
have an unbiased estimate of xi under Assumption 1.c and the structure of the wage equation.
Yet, the plug-in estimator for the variance of xi can be biased and inconsistent even in the
asymptotic of large number of workers within each firm type. In the online supplement we make
the additional assumption that the measurement error in log-earning is the sum of unit root and
an MA(0) term. This allows to compute the implied bias in the plug in estimator of the variance
of xi in finite T . We find that such bais is very small in our context under such assumption.


C.5     Identification and estimation of Gj (X )
Lemma 8. We show that for all t, j  Jr , r, X we have:

                                                               1/                                        r /
       exp(jt )X j Gj (X ) = (P r[j (i, t)  Jr | X ])               (P r[j (i, t) = j | X, j (i, t)  Jr ])       .

Proof. We have that:


                                                                                       /r
                                                  1/ Gj (X )1/ exp(jt )X j
    P r[j (i, t) = j | X, j (i, t)  Jr ] =                                                  /r
                                             j Jr        1/ Gj (X )1/ exp(j t )X j
                                                                                                  /r         r
                                                    j Jr       1/ Gj (X )1/ exp(j t )X j
                P r[j (i, t)  Jr | X ] =                                                            /r           r
                                             r       j Jr       1/ Gj (X )1/ exp(j t )X j

                                              ¯ r (X )G
let's fix a given t and let's write Gj (X ) = G       ~ j (X ) where we impose the normalization that

                                                    1                      /r
                                         ~ j (X )  exp(j t )X j
                                      1/ G                                        =1
                             j Jr

                                                                        ¯ r (X ) = 1
                                                                        G
                                                                    r




                                                         34
then we get that

                                                                    1                     /r
                                                          ~ j (X )  exp(jt )X j
               P r[j (i, t) = j | X, j (i, t)  Jr ] =  1/ G
                                                    ¯ r (X )   
                           P r[j (i, t)  Jr | X ] = G

and hence

                                                         1/                                         r /
      exp(jt )X j Gj (X ) = (P r[j (i, t)  Jr | X ])           (P r[j (i, t) = j | X, j (i, t)  Jr ])

and since this is independent of the normalization, we get that this is true for all t.


   Next we explain the estimation procedure that relies on the expression that we just derived.
For estimation we are going to use a group structure both at the firm and at the market level.
For the firm grouping we use the one we obtained by classifying based on firm specific empirical
distribution of wages called k (j ). We follow a similar structure at the market level and group
based on the market level empirical distribution of earnings. We denote such classification by
m(r). At this point we think of the firm class k (j ) to be within market type m, hence when
using the classification for Section 5, we interact it with the market grouping.
   Using these two classifications we are going to rely on the fact that worker composition can
be estimated at the group level instead of trying to estimate a distribution for each individual
firm and market. Indeed in the model we have that:

                                      P r[X |j ] = P r[X |k (j )]
                                      P r[X |r] = P r[X |m(r)].

                                           ¯rG
Similarly to the Lemma we define Gj (X ) = G ~ j Gk(j ) (X ). Following the lemma we impose
                             ¯ r and G
the following constraints on G       ~j :

                                                   1                           /r
                                                   
                               ~ j Gk(j ) (X )
                            1/ G                       exp(j t )X j                   =1
                    j Jr

                                                                                ¯
                                                                                Gr =1
                                                                            r


We then directly apply the formula for Gj (X ) at the firm group level k (j ) within market
m(r(j ))):
                                                         1/                     r /
                                            P r[X |m]             P r[X |k ]
                       Gk (X ) = X -k                                                 .
                                             P r[X ]              P r[X |m]




                                                  35
Next we recover the j specific part by matching the size of each firm within its market:

                                                                                /r
                                    ~ /r              Gk(j ) (X ) exp(jt )X j
P r[j (i, t) = j | j (i, t)  Jr ] = G j                                               /r
                                                                                           P r[X |m(r)]dX
                                                      ~ j Gk(j ) (X ) exp(j t )X j
                                                      G
                                              j Jr


And similarly we get the market level constant by matching the market level size:

                                                                                 /r   r
                                                  ~ j Gk(j ) (X ) exp(j t )X j
                                                  G
                                           j Jr
                         ¯
P r[j (i, t)  Jr | X ] = Gr                                                                 r   N MX (X )dX
                                                                                      /r
                                                  ¯r G
                                                  G  ~ j Gk(j ) (X ) exp(j t )X j
                                     r     j Jr



D      Additional Robustness Checks
D.1      Pass-through estimation
The main results are displayed in Online Appendix Table A.4. Additional heterogeneity and
robustness analyses are presented in Online Appendix Figure A.1.
    We now provide evidence that the main results are not sensitive to alternative specifications.
First, we allow for greater persistence in the transitory shock process by considering a MA(2)
specification. This is accounted for by choosing  = 3,  = 4 in the empirical counterparts to
equations (12)-(13). Results are provided in the fourth column of Panel B in Online Appendix
Table A.4. Under an MA(2) specification of the transitory shock process, we estimate that the
average firm level pass-through rate r is 0.13 and the market level pass-through rate  is 0.18,
which are the same as our main findings from the MA(1) specification.
    Second, our specification of the earnings process allows permanent shocks to value added to
be transmitted to workers' earnings, whereas transitory firm shocks are not. As a specification
check, we allow transitory innovations to value added to transmit to workers' earnings. Results
are provided in the fourth column of Panel A in Online Appendix Table A.4. We find little if any
passthrough of transitory shocks. As a result, transitory shocks explain as little as 0.1 percent
of the variation in log earnings. This finding is consistent with previous work (see e.g. Guiso
et al. 2005; Friedrich et al. 2019). A possible interpretation of this finding is that transitory
changes in value added reflect measurement error that do not give rise to economic responses. In
the remainder of the paper, we will treat the transitory changes in value added as measurement
error and focus on the pass-through of the permanent shocks.
    Third, to compare with existing work, we also consider estimating the restricted specification
that imposes r = , r. This is equivalent to imposing r = 1, r, so that idiosyncratic worker
preferences over firms are uncorrelated within markets. These results are reported in the first
two columns of Panel A in Online Appendix Table A.4. The estimated pass-through rate is then
0.14, which is between our estimates of 0.13 at the firm level and 0.18 at the market level.
    Fourth, in Online Appendix Figure A.1, we explore robustness of the pass-through estimates


                                                     36
across subsamples of workers. Conditional on a full set of year times market fixed effects, we
find in subfigure (a) that the pass-through rates do not vary that much by the worker's age,
previous wage, or gender. Moreover, the pass-through rates do not change materially if we
restrict the sample to new workers who were first hired at the firm in the beginning of the eight
year employment spell versus those that have stayed in the firm for a longer time.
   Fifth, in subfigure (b) of in Online Appendix Figure A.1, we present results from several spec-
ification checks on firms. Following Guiso et al. (2005), our main measure of firm performance
is value added. They offer two reasons for using value added as a measure of firm performance:
value added is the variable that is directly subject to stochastic fluctuations, and firms have
discretionary power over the reporting of profits in balance sheets, which makes profits a less
reliable objective to assess. Nevertheless, it is reassuring to find that the estimates of the pass-
through rates are broadly similar if we measure firm performance by operating profits, earnings
before interest, tax and depreciation (EBITD), or value added net of reported depreciation of
capital. We also show that the estimated pass-through rate is in the same range as our base-
line result if we exclude multinational corporations (for which it can be difficult to accurately
measure value added) or exclude the largest firms (that are more likely to have multiple plants,
which may not necessarily have the same wage setting).


D.2     Firm and worker effect estimation
In Online Appendix Table A.6, we provide a number of specification checks. First, we consider
estimating the model when ignoring firm-worker interactions by imposing j =    ¯. The results
are presented in the second column of Table A.6. When interactions are ignored, the share of
earnings variation explained by worker quality increases by about two percentage points while
that explained by firm effects decreases from 4.3 percent to 3.0 percent. Sorting and time-
varying effects are little changed. We conclude that the estimated variance of firm effects is
downward-biased when ignoring firm-worker production complementarities.
   Second, we consider estimating the model when ignoring time-varying effects by imposing
r =  = 0. The results are presented in the third column of Table A.6. When time-varying
effects are ignored, the share of earnings variation explained by worker quality decreases by
about one percentage point while that explained by interactions increases by about half a per-
centage point. The variance of firm effects and sorting are little changed. We conclude that
there is little bias in the other terms in the variance decomposition when ignoring production
complementarities.
   Third, we consider estimating the model when ignoring both firm-worker interactions and
time-varying effects by imposing j = ¯ and r =  = 0. The results are presented in the fourth
column of Table A.6. The estimates for worker quality, firm effects, and sorting are similar to the
results when only ignoring firm-worker interactions. Note that specification is the same as the
model of Abowd et al. (1999) that has been estimated in a recent literature except that we use
a bias-corrected estimate, so we can compare this specification directly to other papers to learn


                                                37
about limited mobility bias. An extensive discussion of limited mobility bias and comparison to
the literature is available in our Online Supplement.
    In our Online Supplement, we provide additional robustness checks. We consider increasing
the number of groups k in the k-means algorithm from the baseline value of 10 up to 50 in
increments of 10, finding that the estimates are nearly identical across k . We also present
estimates for two different time periods (2001-2008 and 2008-2015), finding that the worker
quality, firm effects, and sorting components change little over time.


E     Online Appendix: Additional Tables and Figures

                                              Workers                              Firms
       Panel A.                                            Baseline Sample
                                   Unique     Observation-Years        Unique     Observation-Years
       Full Sample:              89,570,480          447,519,609      6,478,231           39,163,975
       Panel B.                                            Movers Sample
                                   Unique     Observation-Years        Unique     Observation-Years
       Movers Only:              32,070,390          207,990,422      3,559,678           23,321,807
       Panel C.                                            Stayers Sample
                                   Unique           6 Year Spells      Unique           6 Year Spells
       Complete Stayer Spells:   10,311,339             35,123,330    1,549,190              6,533,912
       10 Stayers per Firm:       6,297,042             20,354,024      144,412                597,912
       10 Firms per Market:       5,217,960             16,506,865      117,698                476,878


                                  Table A.1: Overview of the Sample
Notes: This table provides an overview of the full sample, movers sample, and stayers sample, including the
steps involved in defining the stayers sample.




                                                     38
                                                                                    Goods                                                 Services                                  All
                                                                Midwest     Northeast        South         West       Midwest     Northeast           South         West            All

Panel A.                                                                                                            Full Sample
Observation Counts:
   Number of FTE Worker-Years                                  42,908,008   26,699,951   40,312,311   31,585,748    69,044,540    62,386,621   103,227,384     71,355,046   447,519,609
   Number of Unique FTE Workers                                 9,318,707    6,088,530   10,215,128    7,712,759    17,314,497    15,167,028    26,519,284     17,949,625    89,570,480
   Number of Unique Firms with FTE Workers                        294,879      232,717      439,641      329,566     1,051,548     1,054,944     1,908,178      1,314,168     6,478,231
   Number of Unique Markets with FTE Workers                        1,508          264        1,774          910         4,092           744         4,909          2,492        16,141
Group Counts:
   Mean Number of FTE Workers per Firm                               22.1         17.8         16.1         16.3          10.4           9.7             9.5          9.6          11.4
   Mean Number of FTE Workers per Market                          2,012.9      6,856.7      1,586.3      2,539.3       1,221.0       5,723.0         1,492.8      2,097.7       1,915.1
   Mean Number of Firms per Market with FTE Workers                  91.3        384.9         98.3        156.0         117.4         588.2           156.6        217.7         167.6
Outcome Variables in Log $:
   Mean Log Wage for FTE Workers                                    10.76       10.81        10.70        10.81          10.61         10.74          10.62        10.70          10.69
   Mean Value Added for FTE Workers                                 17.36       16.80        16.68        16.64          16.18         16.04          15.94        16.07          16.31
Firm Aggregates in $1,000:
   Wage Bill per Worker                                              43.6        50.7          42.2         52.9          34.1         44.2            35.8          40.3          40.8
   Value Added per Worker                                            91.2       107.5          85.2         91.7          90.5        111.1            94.2          92.3          95.2

Panel B.                                                                                                           Movers Sample
Observation Counts:
  Number of FTE Mover-Years                                    17,455,849   11,543,303   18,066,928   15,513,020    31,643,497    28,390,782    50,052,742     35,324,301   207,990,422
  Number of Unique FTE Movers                                   4,124,895    2,829,881    4,819,645    3,876,182     7,723,804     6,662,132    11,904,098      8,321,469    32,070,390
  Number of Unique Firms with FTE Movers                          188,376      144,268      265,374      215,092       571,360       549,064     1,018,957        700,618     3,559,678
  Number of Unique Markets with FTE Movers                          1,457          261        1,747          872         3,899           739         4,766          2,342        15,586
Group Counts:
  Mean Number of FTE Movers per Firm with FTE Movers                 13.5         11.9         11.2         11.6           8.2           7.9            7.9           8.2           8.9
  Mean Number of Movers per Market with FTE Movers                  864.8      2,991.3        732.4      1,318.1         599.3       2,655.3          761.5       1,123.7         940.6
  Mean Number of Firms per Market with FTE Movers                    64.1        251.1         65.5        113.4          72.7         337.1           96.4         137.7         105.5
Outcome Variables in Log $:
  Mean Log Wage for FTE Movers                                     10.68        10.77        10.64        10.78          10.59        10.72           10.61        10.70          10.67
  Mean Value Added for FTE Movers                                  16.72        16.52        16.28        16.36          16.04        16.02           15.88        16.01          16.12

Panel C.                                                                                                           Stayers Sample
Sample Counts:
  Number of 8-year Worker-Firm Stayer Spells                    2,588,628    1,777,928    1,237,821    1,150,115     2,315,238     2,527,212     2,609,997      2,207,552    16,506,865
  Number of Unique FTE Stayers in Firms with 10 FTE Stayers       798,575      532,507      416,549      354,518       740,091       764,699       865,629        724,155     5,217,960
  Number of Unique Firms with 10 FTE Stayers                       13,884       10,896        9,409        9,767        18,083        19,475        19,626         16,185       117,698
  Number of Unique Markets with 10 Firms with 10 FTE Stayers          197          111          216          104           335           213           438            219         1,826
Outcome Variables in Log $:
  Mean Log Wage for FTE Stayers                                     10.95       10.99        10.97        10.99          10.90         11.01          10.96        11.05          10.97
  Mean Log Value Added for FTE Stayers                              18.04       17.56        17.46        16.56          17.45         17.23          17.89        17.93          17.61



                                            Table A.2: Detailed sample characteristics
Notes: This table provides a detailed examination of the full sample, movers sample, and stayers sample.




                                                                                 39
      Name                                                    Unique Parameters    Mean Estimate                          Moments of the Data
      Panel A. Rents and Scale
                                                                                                                                      yrt (w
                                                                                                                                    E[¯          ¯rt-
                                                                                                                                           ¯rt+ -w            )|Si =1]
      Idiosyncratic Taste Parameter                                   1                  4.99        Market Passthrough               yrt (y
                                                                                                                                    E[¯          ¯rt-
                                                                                                                                           ¯rt+ -y           )|Si =1]
                                                                                                                                      yjt (w
                                                                                                                                    E[~          ~it-
                                                                                                                                           ~it+ -w           )|Si =1,r(j )=r]
      Taste Correlation Parameter                   r                 8                  0.70        Net Passthrough                E[~ yjt (y~jt+ -y~jt- )|Si =1,r (j )=r ]
      Returns to Scale Parameter                    r                 8                  0.21        Labor Share                    E[bj (i,t) - yj (i,t) |r(j ) = r]

      Name                                                    Unique Parameters    Var. Estimate                          Moments of the Data
      Panel B. Firm and Worker Heterogeneity
                                                                                                                                              1
      Time-varying Firm Premium               jt                 10,669,602              0.02        Structural Wage Equation       E[wit - 1+  ¯r,t
                                                                                                                                                y
                                                                                                                                             r
      Firm-specific Technology Parameter      j                      10                  0.04                                           - r + y ~j,t |r(j ) = r]
      Worker Quality                          xi                 61,670,459              0.31        Wage Changes around Moves      E[wit+1 |j  j ] - E[wit |j  j ]




40
      Amenity Efficiency Units at Neutral TFP hj                  1,953,915              0.14                                       E[wit |j  j ] - E[wit+1 |j  j ]
                                                                                                                                                      
      Time-varying Firm-specific TFP                a
                                                    ~jt          10,669,602              0.14        Total Labor Input &            ljt = log      Xi j and jt
      Time-varying Market-specific TFP              art           111,829                0.12        Time-varying Firm Premium

      Name                                                    Unique Parameters    Var. Estimate                          Moments of the Data
      Panel C. Model Counterfactuals
      Preferences for amenities for:                gj (X )       6,974,519              0.20        Firm Size &                    Pr[j ]
      Firm j for workers of quality X                                                                Firm Composition &             Pr[x|k (j ) = k ]
      Market r for workers of quality X                                                              Market Composition             Pr[x|r(j ) = r]

                                         Table A.3: Quantities of Interest, Model Parameters and Targeted Moments
     Notes: This table displays the model parameters and the moments targeted in their estimation.
                                                             GMM Estimates of Joint Process
                                                        Firm Only                  Accounting for Markets
                                        Log Value Added         Log Earnings   Log Value Added     Log Earnings
 Panel A.                                                            Process: MA(1)
 Total Growth (Std. Dev.)                       0.31                 0.17             0.29              0.16
                                               (0.01)               (0.00)           (0.01)            (0.00)
 Permanent Shock (Std. Dev.)                    0.20                 0.10             0.17              0.10
                                               (0.01)               (0.00)           (0.01)            (0.00)
 Transitory Shock (Std. Dev.)                   0.18                 0.10             0.17              0.10
                                               (0.01)               (0.00)           (0.01)            (0.00)
 MA Coefficient, Lag 1                          0.09                 0.15             0.09              0.15
                                               (0.01)               (0.00)           (0.01)            (0.00)
 MA Coefficient, Lag 2                          0.00                 0.00             0.00              0.00
                                               (0.00)               (0.00)           (0.00)            (0.00)
 Permanent Passthrough Coefficient                                   0.14                               0.13
                                                                    (0.01)                             (0.01)
 Transitory Passthrough Coefficient                                 -0.01                               0.00
                                                                    (0.01)                             (0.00)
 Market Passthrough Coefficient                                                                         0.18
                                                                                                       (0.02)
 Panel B.                                                            Process: MA(2)
 Total Growth (Std. Dev.)                       0.31                 0.17             0.29              0.16
                                               (0.01)               (0.00)           (0.01)            (0.00)
 Permanent Shock (Std. Dev.)                    0.20                 0.10             0.17              0.10
                                               (0.01)               (0.00)           (0.00)            (0.00)
 Transitory Shock (Std. Dev.)                   0.17                 0.10             0.17              0.10
                                               (0.01)               (0.00)           (0.01)            (0.00)
 MA Coefficient, Lag 1                          0.05                 0.21             0.07              0.21
                                               (0.05)               (0.01)           (0.04)            (0.01)
 MA Coefficient, Lag 2                         -0.03                 0.04            -0.01              0.04
                                               (0.03)               (0.00)           (0.02)            (0.00)
 Permanent Passthrough Coefficient                                   0.15                               0.13
                                                                    (0.01)                             (0.01)
 Transitory Passthrough Coefficient                                 -0.02                               0.00
                                                                    (0.01)                             (0.00)
 Market Passthrough Coefficient                                                                         0.18
                                                                                                       (0.03)

              Table A.4: GMM estimates of the earnings and value added processes
Notes: This table displays the parameters of the joint processes of log value added and log earnings. These
results come from joint estimation of the earnings and value added processes under assumptions 1.a-1.c using
GMM. Columns 1-2 report results from the specification which imposes r =  ("Firm only"), while columns
3-4 report results from the specification which allows  to differ from r and r to vary across broad markets
("Accounting for Markets"). The top panel assumes the transitory components follow an MA(1) process. The
bottom panel permits the transitory components to follow an MA(2) process. Standard errors are estimated
using 40 block bootstrap draws in which the block is taken to be the market.




                                                        41
   0.25                                                                                  0.25



   0.20                                                                                  0.20



   0.15                                                                                  0.15



   0.10                                                                                  0.10



   0.05                                                                                  0.05



   0.00                                                                                  0.00

            All     Age > 45   Some Tenure      Men        High Wage High Wage Firm             All    Oper. profits   EBITD    VA - deprec. VA < 10B   No MNE   Size < 100



                    Passthrough         Firm Only     Net of Market                                         Passthrough           Firm Only     Net of Market



          (a) Heterogeneity across Worker Samples                                     (b) Heterogeneity across Firm Samples and Value
                                                                                      Added Measures

                  Figure A.1: Sample heterogeneity in pass-through rates of firm shocks
Notes: This figure displays heterogeneity in the GMM estimates of the pass-through rates of a firm shock, both
for the firm only model (imposing  =  ) and when removing market by year means (permitting  =  ).




                          12.0




                          11.5


                                                                                                                       Log Net Income
                          11.0                                                                                                 Observed
                                                                                                                               Predicted


                          10.5




                          10.0

                                 10.0               10.5              11.0        11.5          12.0
                                                           Log Gross Income Bin


                                                    Figure A.2: Fit of the Tax Function
Notes: In this figure, we display the log net income predicted by the tax function compared to the log net
income observed in the data.




                                                                                  42
 Firm-level Labor Supply Elasticity                                                                                                  1.3
                                        10


                                         8
                                      Mean                                                                                           1.2




                                                                                                                      Labor Wedge
                                         6                                                         West                                                                                             West
                                                                                                   Midwest                          Mean                                                            Midwest
                                                                                                   South                                                                                            South
                                         4                                                         Northeast                                                                                        Northeast
                                                                                                                                     1.1


                                         2


                                         0                                                                                             1
                                                 Goods                  Services                                                                    Goods                   Services
                                                         Broad Market                                                                                        Broad Market
                                                                                                                                                                                       r 
                                                (a) Labor Supply Elasticity           r 
                                                                                                                                                      (b) Labor Wedge 1 +              


                                      Figure A.3: Broad Market Heterogeneity in Labor Supply Elasticities and Labor Wedges

Notes: In this figure, we display the estimated (post-tax) firm level labor supply elasticity and labor wedge for
each of the 8 broad markets. The population-weighted means are represented by horizontal lines.




                                                                                    Market Count                                               Average of the           Workers' Share of Rents
                                                                                     (in 1,000)         Passthrough Rate                      Model Parameters          Firm-level Market-level
                                                                                                                                                                              Rw              Rwm
                                                                                   Workers   Firms      Market                       Firm           1 - 2
                                                                                                                                                        r      1 - r         Rw +Rf         Rwm +Rf m

 Baseline (NAICS 2-digit, commuting zone)                                             1.90    0.17             0.18                   0.13   4.99     0.51       0.79            0.52            0.50
 Shutdown broad market heterogeneity                                                  1.97    0.17             0.18                   0.13   5.06     0.48       0.79            0.52            0.51
     (r = , r = )
 Alternative detailed markets:
    Finer geography (county)                                                          0.54    0.05             0.19                   0.14   4.61     0.54       0.79            0.51            0.49
    Finer industry (NAICS 3-digit)                                                    0.65    0.06             0.19                   0.13   4.60     0.59       0.79            0.52            0.50
    Coarser geography (state)                                                        25.44    2.23             0.18                   0.13   5.00     0.52       0.79            0.53            0.50
    Coarser industry (NAICS supersector)                                              4.42    0.39             0.20                   0.13   4.28     0.66       0.79            0.53            0.51


Table A.5: Robustness of the Model Parameters and Rent Sharing Estimates to Alternative
Market Definitions
Notes: This table displays robustness of the estimated model parameters and rents to alternative definitions of
detailed markets.




                                                                                                43
                                                                                   Model Specifications
                                                                           Main            Alternatives
                                                                                   j = ¯   r =  = 0    j = ¯ and
                                                                                                       r =  = 0
 Share explained by:
   i) Worker Quality              V ar(~
                                       xi )                                71.6%   73.5%      70.4%         72.4%
   ii) Firm Effects               V ar(~j (i) )                             4.3%    3.0%       4.3%          3.2%
   iii) Sorting                   2Cov (~
                                        xi ,  ~j (i) )                     13.0%   12.8%      13.1%         12.9%
   iv) Interactions               V ar( ij ) + 2Cov (xi + j (i) , ij )      0.9%               1.2%
                                         a                     a
   v) Time-varying Effects        V ar(j  (i),t ) + 2Cov (xi , j (i),t )    0.3%    0.3%
 Sorting Correlation:             Cor(xi , j (i) )                          0.37    0.43        0.38         0.43
 Variance Explained:              R2                                        0.90    0.90        0.89         0.89
 Specification:
   Firm-Worker Interactions                                                                                     
   Time-varying Firm Effects                                                                                    


                            Table A.6: Decomposition of earnings inequality
Notes: This table presents the decomposition of log earnings variation into firm and worker effects using the
main specification described in the text, as well as alternative specifications that ignore firm-worker interactions
(j =  ¯), ignore time-varying effects (r =  = 0), and ignore both (j =       ¯ and r =  = 0). The analysis uses
both workers who move between firms and non-movers. All estimates are corrected for limited mobility bias
using the grouped fixed-effect method of Bonhomme et al. (2019).




                                                           44
                                      20

                                                                                                                              10.75


                                      18




                                                                                                         Mean Firm Effect
 Mean Log VA




                                                                                                                              10.70
                                      16                                                Observed                                                                             Observed
                                                                                        Predicted                                                                            Predicted



                                      14                                                                                      10.65




                                           2          4                     6       8                                                     2            4             6   8
                                                      Log Size                                                                                         Log Size

                                                     (a) Value Added                                                                              (b) Firm Effects


                                      8
 Mean Log Efficiency Units of Labor




                                                                                                                              18




                                                                                                         Mean Log Wage bill
                                      6

                                                                                                                              16

                                                                                        Observed                                                                             Observed
                                      4                                                 Predicted                                                                            Predicted

                                                                                                                              14


                                      2
                                                                                                                              12

                                           2          4                     6       8                                                 2            4                 6   8
                                                      Log Size                                                                                     Log Size

                                               (c) Efficiency Units of Labor                                                                       (d) Wage Bill

                                                          Figure A.4: Fit of the Model for Untargeted Moments
Notes: In this figure, we compare the observed and the predicted values of firm effects, value added, efficiency
units of labor, and wage bill. We make this comparison separately according to actual and predicted firm size.



                                                                      -50




                                                                      -52
                                                            Mean hj




                                                                      -54                                                                              Baseline
                                                                                                                                                       Equilibrium


                                                                      -56




                                                                      -58

                                                                                2         4                                    6              8
                                                                                          Log Size


Figure A.5: Estimates of the Amenity Components hj from the Wage Equation versus the
Equilibrium Constraint
Notes: In this figure, we plot the mean of hj across log size bins. We compare the baseline estimates of hj from
the equation for firm wage premiums (15), versus those estimated using the equilibrium constraint by solving
                                                   ~j , P
the fixed-point definition of hj as a function of (P    ¯r , Gj (X )), as shown in Lemma 3.




                                                                                                    45
                                                         Goods                                         Services
                                          Midwest    Northeast    South      West     Midwest       Northeast     South      West

  Panel A.                                                              Model Parameters
  Idyosinctratic taste parameter ( -1 )                                         0.200
                                                                                (0.044)
  Taste correlation parameter ()            0.844        0.694     0.719     0.924         0.649        0.563      0.744     0.619
                                           (0.179)      (0.153)   (0.160)   (0.182)       (0.141)      (0.109)    (0.246)   (0.117)
  Returns to scale (1 - )                   0.746        0.764     0.863     0.949         0.753        0.740      0.814     0.752
                                           (0.016)      (0.013)   (0.017)   (0.019)       (0.013)      (0.015)    (0.036)   (0.015)

  Panel B.                                                    Firm-level Rents and Rent Shares
  Workers' Rents:
    Per-worker Dollars                      6,802        6,681     5,737     8,906        4,234         4,847      5,009    4,805
                                             (770)        (723)     (720)     (867)        (502)         (803)    (1,295)    (684)
     Share of Earnings                       16%          13%       14%       17%           12%          11%        14%       12%
                                             (2%)         (1%)      (2%)      (2%)          (1%)         (2%)       (4%)      (2%)
  Firms' Rents:
     Per-worker Dollars                     4,041        4,198     7,465    20,069         3,531        3,097      6,915     3,018
                                           (1,243)      (1,130)   (2,681)   (6,323)       (1,004)      (1,305)    (5,650)   (1,060)
     Share of Profits                         8%           7%       17%       52%            6%           5%       12%         6%
                                             (3%)         (2%)      (6%)     (16%)          (2%)         (2%)     (10%)       (2%)
  Workers' Share of Rents                    63%          61%       43%       31%           55%          61%        42%       61%
                                             (4%)         (4%)      (5%)      (4%)          (4%)         (5%)       (9%)      (5%)

  Panel C.                                                   Market-level Rents and Rent Shares
  Workers' Rents:
    Per-worker Dollars                      7,837        9,102     7,572     9,506         6,115        7,935      6,422     7,230
                                           (1,319)      (1,532)   (1,274)   (1,600)       (1,029)      (1,335)    (1,081)   (1,217)
     Share of Earnings                       18%          18%       18%       18%           18%          18%        18%       18%
                                             (3%)         (3%)      (3%)      (3%)          (3%)         (3%)       (3%)      (3%)
  Firms' Rents:
     Per-worker Dollars                     4,940        6,311    10,000    20,846         5,734        5,897      9,363     5,153
                                           (1,140)      (1,350)   (2,267)   (5,787)       (1,351)      (1,786)    (4,218)   (1,433)
     Share of Profits                        10%          11%       23%       54%           10%           9%        16%       10%
                                             (2%)         (2%)      (5%)     (15%)          (2%)         (3%)       (7%)      (3%)
  Workers' Share of Rents                    61%          59%       43%       31%           52%          57%        41%       58%
                                             (3%)         (3%)      (4%)      (5%)          (3%)         (4%)       (8%)      (4%)


      Table A.7: Market Heterogeneity in Model Parameters and Rent Sharing Estimates
Notes: This table displays heterogeneity in the estimated model parameters and rents. These results
correspond to the specification which allows  to differ from  , and for r and r to vary across broad markets.
Standard errors are estimated using 40 block bootstrap draws in which the block is taken to be the market.




                                                            46
                                                                                                                                                                                          q

                               Mean Compensating Differential   0.3

                                                                                                                                                                             q


                                                                                                                                                                                          q
                                                                                                                                                                   q



                                                                0.2                                                               q                                          q



                                                                                                                      q                                            q                                         Overall
                                                                                                            q
                                                                                                                                  q                                                                          Within market
                                                                                                                      q
                                                                                                 q
                                                                                                            q

                                                                0.1         q
                                                                                       q
                                                                                       q
                                                                                                 q

                                                                            q




                                                                0.0
                                                                                       2                    4                     6                                          8
                                                                                                 Decile of Worker Effects

                                                                                                     Figure A.6: Compensating differentials
Notes: In this figure, we plot mean compensating differentials overall and within market. To do so, we
randomly draw a pair of firms (j, j ) with probability proportional to size. Each j is drawn from the full set of
firms when estimating overall compensating differentials and from the set of firms in the same market as j
when estimating within-market compensating differentials. Then, we estimate the compensating differential
between j and j for a worker of given quality xi = x by j + xj - j - xj . This figure plots the mean
absolute value of the compensating differentials across deciles of the xi distribution, where the horizontal lines
denote means across the distribution of xi .




                          18
                                                                                                                                                             0.5


                          16
 Sorting Covariance (%)




                                                                                                                                       Sorting Correlation




                                                                                                                                                             0.4
                          14
                                                                                                                      Parameter                                                                                              Parameter
                                                                                                                      Shrunk:                                                                                                Shrunk:
                          12                                                                                             gj(x)                                                                                                  gj(x)
                                                                                                                           j                                                                                                      j
                                                                                                                                                             0.3
                          10


                           8
                                                                                                                                                             0.2


                               0.0                                    0.1       0.2        0.3        0.4       0.5                                                    0.0       0.1      0.2          0.3     0.4   0.5
                                                                                Shrink Rate                                                                                                   Shrink Rate

                                                                                      (a) Sorting                                                                                      (b) Sorting Correlation

                                                                       Figure A.7: Worker sorting with counterfactual values of gj (x) and j
Notes: In this figure, we reduce the heterogeneity across firms in amenities or production complementarities by
replacing either gj (x) with (1 - s) gj (x) + sg
                                               ¯j or j with (1 - s) j + s¯, where g
                                                                                  ¯j = Ex [gj (x)], ¯ = E [j ]. Here,
s  [0, 1] is the shrink rate with s = 0 corresponding to the baseline model. We report the share of log earnings
variance explained by sorting (subfigure a) and the sorting correlation (subfigure b).




                                                                                                                                  47
